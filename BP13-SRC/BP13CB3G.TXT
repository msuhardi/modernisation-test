      **************************                                                
       IDENTIFICATION DIVISION.                                                 
      **************************                                                
       PROGRAM-ID.    BP13CB3G.                                                 
      *AUTHOR.        SANDEEP REDDY.                                            
      *DATE-WRITTEN.  10/06/2019.                                               
                                                                                
      * =========================================================== *           
      * SYSTEM OF COMMITMENT (BP13)                                 *           
      * =========================================================== *           
      *   OBJECTIVE   : 1) THIS PROGRAM UPDATE BP13K736 FOR THOSE   *           
      *                    CASES THAT ARE MATCHED FROM CPF.         *           
      *                 2) CREATES 3 REPORTS L94A, L94B & L94C      *           
      *                                                             *           
      *   INPUT FILES :                                             *           
      *   1.  AB02F945 -- RETURN FILE FROM CPF BOARD.               *           
      *   2.  BP13K736 -- 12 MONTHS INTEREST FROM CPF.              *           
      *                                                             *           
      *   OUTPUT FILES :                                            *           
      *   --------   SALES - NON EC REPORT -----                    *           
      *   1.  BP13L94A -- CASES WITH REJECTED GRNT & INTRST RECVRY  *           
      *   2.  BP13L94B -- CASES WITH PARTIAL GRANT & INTRST RECVRY  *           
      *   3.  BP13L94C -- CASES WITH MANUAL GRANT & INTRST RECVRY   *           
      *   4.  BP13L94H -- CASES WITH full GRANT & INTRST RECVRY EC=N*           
      *                                                             *           
      *   --------   SALES - EC  REPORT --------                    *           
      *   5.  BP13L94D -- CASES WITH REJECTED GRNT & INTRST RECVRY  *           
      *   6.  BP13L94E -- CASES WITH PARTIAL GRANT & INTRST RECVRY  *           
      *   7.  BP13L94F -- CASES WITH MANUAL GRANT & INTRST RECVRY   *           
      *   8.  BP13L94G -- CASES WITH full GRANT & INTRST RECVRY     *           
      *                                                             *           
      *   -----SRG - PRD NON - EC REPORT -------                    *           
      *   9.  BP13L94J -- CASES WITH MANUAL GRANT  & INTRST RECVRY  *           
      *                   FOR OFFICE CODE "PRD"                     *           
      *  10.  BP13L94K -- CASES WITH PARTIAL GRANT  & INTRST RECVRY *           
      *                   FOR OFFICE CODE "PRD" (EC=N)              *           
      *  11.  BP13L94L -- CASES WITH FULL GRANT  & INTRST RECVRY    *           
      *                   FOR OFFICE CODE "PRD" AND SRG GRANT       *           
      *  12.  BP13L94M -- CASES WITH REJECTED GRNT & INTRST RECVRY  *           
      *                   FOR OFFICE CODE "PRD"                     *           
      *                                                             *           
      *   -----SRG - PRD -EC REPORT -------------                   *           
      *  13.  BP13L94I -- CASES WITH REJECTED GRNT & INTRST RECVRY  *           
      *                   FOR OFFICE CODE "PRD"                     *           
      *                                                             *           
      *  14.  BP13FPRC -- PROCESSED RECORDS FROM K736               *           
      *  15.  BP13MAIL -- EMAIL                                     *           
      *                                                                         
      *                                                             *           
      * CHQ REQ     DATE     BY  DESCRIPTIONS                       *           
      * -------- ---------- ---- ---------------------------------- *           
      * BP137965 10/06/2019 SRG1 NEW PROGRAM                        *           
      * BP137936 17/10/2019 SRG1 CATER REPORT FOR ALL MANUAL CASES. *           
      * BP137503 23/10/2019 SRG1 CATER FOR 4 EC REPORTS.            *           
      * BP138045 05/11/2019 SRG1 FIX CPF AMT CALCULATION.           *           
      * BP138045 05/11/2019 PP11 CATER FOR FULL GRANT & INTEREST    *           
      *                          RECOVERY EC = N                    *           
      * BP138095 27/11/2019 SRG1 CATER FOR NEW EHG FIELDS DATA.     *           
      * BP138095 23/12/2019 SRG1 CHANGED LOGIC FOR MANUAL GRANT RPTS*           
      * BP138100 06/12/2019 PP11 CATER FOR REJECTED GRNT & INTRST   *           
      *                          RECVRY FOR OFFICE CODE "PRD"       *           
      * BP138176 20/02/2020 PP11 CATER FOR MANUAL  GRANT & INTEREST *           
      *                          RECVRY FOR OFFICE CODE "PRD"       *           
      * BP137780 29/02/2020 CT2  CATER FOR EHG RECOVERY             *           
      * BP138100 31/03/2020 PP11 CATER FOR PARTIAL GRANT & INTEREST *           
      *                          RECVRY FOR OFFICE CODE "PRD"       *           
      * BP138100 09/04/2020 PP11 CATER FOR PARTIAL GRANT & INTEREST *           
      *                          RECVRY FOR OFFICE CODE "PRD"       *           
      * BP138816 09/04/2020 PP11 CATER to update the email address  *           
      *                          for l94a,l94b,l94c,l94h report     *           
      * BP139175 07/09/2022 KAC1 ADDED HE_Jialing@hdb.gov.sg &      *           
      *                          Kathijah_Bee_ALI_MOHAMED@hdb.gov.sg*           
      *                          TO L94A,L94B,L94C AND L94H.        *           
      * BP138231 10/01/2023 PP11 CATER FOR FULL GRANT & INTEREST                
      *                          FOR SRG GRANT REPORT AND                       
      *                          HGT REG SRG PHG TUG ATG FSG                    
      * =========================================================== *           
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13K736 ASSIGN           TO BP13K736                         
                  ACCESS MODE               IS RANDOM                           
                  ORGANIZATION              IS INDEXED                          
                  RECORD KEY                IS K736-KEY-FLD                     
                  FILE STATUS               IS BP13K736-STATUS.                 
           SELECT AB02F945 ASSIGN           TO AB02F945.                        
                                                                                
           SELECT BP13L94A ASSIGN           TO BP13L94A.                        
           SELECT BP13L94B ASSIGN           TO BP13L94B.                        
           SELECT BP13L94C ASSIGN           TO BP13L94C.                        
           SELECT BP13L94D ASSIGN           TO BP13L94D.                        
           SELECT BP13L94E ASSIGN           TO BP13L94E.                        
           SELECT BP13L94F ASSIGN           TO BP13L94F.                        
           SELECT BP13L94G ASSIGN           TO BP13L94G.                        
           SELECT BP13L94H ASSIGN           TO BP13L94H.                        
           SELECT BP13L94I ASSIGN           TO BP13L94I.                        
           SELECT BP13L94J ASSIGN           TO BP13L94J.                        
           SELECT BP13L94K ASSIGN           TO BP13L94K.                        
           SELECT BP13L94L ASSIGN           TO BP13L94L.                        
           SELECT BP13L94M ASSIGN           TO BP13L94M.                        
           SELECT BP13FPRC ASSIGN           TO BP13FPRC.                        
           SELECT BP13MAIL ASSIGN           TO BP13MAIL.                        
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13K736                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K736.                                                           
                                                                                
       FD   AB02F945                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  300 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       COPY AB02F945.                                                           
                                                                                
       FD   BP13L94A                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94A-REC.                                                     
           05  WS-L94A-NUM-BSNESS-REF       PIC X(08).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94A-NUM-CPF-ACCT         PIC X(09).                          
           05  FILLER                       PIC X(04).                          
           05  WS-L94A-TXT-REMARKS          PIC X(80).                          
           05  FILLER                       PIC X(46).                          
                                                                                
       FD   BP13L94B                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94B-REC.                                                     
           05  WS-L94B-NUM-BSNESS-REF       PIC X(08).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94B-NUM-CPF-ACCT         PIC X(09).                          
           05  FILLER                       PIC X(17).                          
           05  WS-L94B-TAG-MANUAL-PROCESSD  PIC X(01).                          
           05  FILLER                       PIC X(02).                          
           05  WS-L94B-NUM-GRNT-IDN         PIC 9(09).                          
           05  FILLER                       PIC X(02).                          
           05  WS-L94B-AMT-RECOVERD-PRIN    PIC 9(09).99.                       
           05  FILLER                       PIC X(02).                          
           05  WS-L94B-AMT-RECOVERD-INTR    PIC 9(09).99.                       
           05  FILLER                       PIC X(02).                          
           05  WS-L94B-AMT-OS-PRIN          PIC 9(09).99.                       
           05  FILLER                       PIC X(02).                          
           05  WS-L94B-AMT-OS-INTR          PIC 9(09).99.                       
           05  FILLER                       PIC X(45).                          
                                                                                
       FD   BP13L94C                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94C-REC.                                                     
           05  WS-L94C-NUM-BSNESS-REF       PIC X(08).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94C-NUM-CPF-ACCT         PIC X(09).                          
           05  FILLER                       PIC X(04).                          
           05  WS-L94C-AMT-RECOVERD-PRIN    PIC 9(09).99.                       
           05  FILLER                       PIC X(02).                          
           05  WS-L94C-AMT-RECOVERD-INTR    PIC 9(09).99.                       
           05  FILLER                       PIC X(08).                          
           05  WS-L94C-ACCRUED-INTR-FRM-CYM PIC 9(06).                          
           05  FILLER                       PIC X(08).                          
           05  WS-L94C-ACCRUED-INTR-TO-CYM  PIC 9(06).                          
           05  FILLER                       PIC X(72).                          
                                                                                
       FD   BP13L94D                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94D-REC                  PIC X(150).                         
                                                                                
       FD   BP13L94E                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94E-REC                  PIC X(150).                         
                                                                                
       FD   BP13L94F                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94F-REC                  PIC X(150).                         
                                                                                
       FD   BP13L94G                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94G-REC.                                                     
           05  WS-L94G-NUM-BSNESS-REF       PIC X(08).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94G-NUM-CPF-ACCT         PIC X(09).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94G-AMT-RECOVERD-PRIN    PIC 9(09).99.                       
           05  FILLER                       PIC X(02).                          
           05  WS-L94G-AMT-RECOVERD-INTR    PIC 9(09).99.                       
           05  FILLER                       PIC X(101).                         
                                                                                
       FD   BP13L94H                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94H-REC.                                                     
           05  WS-L94H-NUM-BSNESS-REF       PIC X(08).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94H-NUM-CPF-ACCT         PIC X(09).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94H-AMT-RECOVERD-PRIN    PIC 9(09).99.                       
           05  FILLER                       PIC X(02).                          
           05  WS-L94H-AMT-RECOVERD-INTR    PIC 9(09).99.                       
           05  FILLER                       PIC X(101).                         
                                                                                
       FD   BP13L94I                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94I-REC.                                                     
           05  WS-L94I-NUM-BSNESS-REF       PIC X(08).                          
           05  FILLER                       PIC X(03).                          
           05  WS-L94I-NUM-HDB-REF          PIC X(11).                          
           05  FILLER                       PIC X(06).                          
           05  WS-L94I-NUM-CPF-ACCT         PIC X(09).                          
           05  FILLER                       PIC X(04).                          
           05  WS-L94I-TXT-REMARKS          PIC X(80).                          
           05  FILLER                       PIC X(29).                          
                                                                                
       FD  BP13FPRC                                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING  MODE  IS F.                                               
       01  BP13F736-PRCSED-REC              PIC X(1000).                        
                                                                                
       FD  BP13MAIL                                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING  MODE  IS F.                                               
       01  MAIL-PRTREC                      PIC X(150).                         
                                                                                
       FD   BP13L94J                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94J-REC                  PIC X(150).                         
                                                                                
       FD   BP13L94K                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94K-REC                  PIC X(150).                         
                                                                                
       FD   BP13L94L                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94L-REC                  PIC X(150).                         
                                                                                
       FD   BP13L94M                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  150 CHARACTERS                                     
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       01  WS-BP13L94M-REC                  PIC X(150).                         
                                                                                
      ************************                                                  
       WORKING-STORAGE SECTION.                                                 
      ************************                                                  
       01  WS-INDICATORS.                                                       
           05  WS-F945-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-K736-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94A-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94B-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94C-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94D-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94E-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94F-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94G-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94H-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94I-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94J-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94K-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94L-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-L94M-EOF                  PIC X(1) VALUE SPACE.               
           05  WS-K736-FND                  PIC X(1) VALUE SPACE.               
           05  WS-AMT-ADJUSTED              PIC X(1) VALUE SPACE.               
           05  BP13K736-STATUS              PIC 9(2) VALUE ZEROS.               
           05  WS-HINT-CHK-ERROR            PIC X(1) VALUE SPACE.               
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-CNT                       PIC 9(1) VALUE ZEROS.               
           05  WS-CTR                       PIC 9(1) VALUE ZEROS.               
           05  CNT-F945-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94A-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94B-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94C-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94D-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94E-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94F-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94G-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94H-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94I-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94J-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94K-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94L-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-L94M-READ                PIC 9(5) VALUE ZEROS.               
           05  CNT-K736-FND                 PIC 9(5) VALUE ZEROS.               
           05  WS-REWRITE-BP13K736          PIC 9(5) VALUE ZEROS.               
                                                                                
       01  WS-AMT                           PIC 9(9).99.                        
       01  WS-AMT1                          PIC 9(9)V99.                        
       01  WS-AMT2                          PIC 9(9)V99.                        
       01  WS-DATE                          PIC X(8) VALUE SPACES.              
       01  WS-CURRENT-DATE.                                                     
           02  WS-CURRENT-DATE1.                                                
               05  WS-DTE-CCYY              PIC X(4).                           
               05  WS-DTE-MM                PIC X(2).                           
               05  WS-DTE-DD                PIC X(2).                           
           02  WS-CURRENT-TIME              PIC X(9).                           
           02  FILLER                       PIC X(4).                           
                                                                                
       01  REPT-HEAD1.                                                          
           05 REPT-HEAD1A.                                                      
              10 FILLER                     PIC X(31)  VALUE                    
                 'Regn. No.  CPF A/C No.  Remarks'.                             
              10 FILLER                     PIC X(119) VALUE SPACES.            
           05 REPT-HEAD1B.                                                      
              10 FILLER                     PIC X(31)  VALUE                    
                 '=========  ===========  ======='.                             
              10 FILLER                     PIC X(119) VALUE SPACES.            
                                                                                
       01  REPT-HEAD2.                                                          
           05 REPT-HEAD2A.                                                      
              10 FILLER                PIC X(51)  VALUE                         
                 'Regn. No.  CPF A/C No.  Manual process  Grant-idn  '.         
              10 FILLER                PIC X(40)  VALUE                         
                 'Recoverd      Recoverd      Outstanding '.                    
              10 FILLER                PIC X(14)  VALUE                         
                 '  Outstanding '.                                              
              10 FILLER                PIC X(45) VALUE SPACES.                  
           05 REPT-HEAD2B.                                                      
              10 FILLER                PIC X(51)  VALUE                         
                 '                        Tag                        '.         
              10 FILLER                PIC X(40)  VALUE                         
                 'prin. amont   int. amont    prin. amont '.                    
              10 FILLER                PIC X(14)  VALUE                         
                 '  int. amont  '.                                              
              10 FILLER                PIC X(45)  VALUE SPACES.                 
           05 REPT-HEAD2C.                                                      
              10 FILLER                PIC X(51)  VALUE                         
                 '=========  ===========  ==============  =========  '.         
              10 FILLER                PIC X(40)  VALUE                         
                 '============  ============  ============'.                    
              10 FILLER                PIC X(14)  VALUE                         
                 '  ============'.                                              
              10 FILLER                PIC X(45)  VALUE SPACES.                 
                                                                                
       01  REPT-HEAD3.                                                          
           05 REPT-HEAD3A.                                                      
              10 FILLER                PIC X(49)  VALUE                         
                 'Regn. No.  CPF A/C No.  Recoverd      Recoverd   '.           
              10 FILLER                PIC X(50)  VALUE                         
                 '   Accrued int.  Accrued int.                     '.          
              10 FILLER                PIC X(51) VALUE SPACES.                  
           05 REPT-HEAD3B.                                                      
              10 FILLER                PIC X(49)  VALUE                         
                 '                        prin. amont   int. amont '.           
              10 FILLER                PIC X(50)  VALUE                         
                 '   frm cym dte   to cym dte                       '.          
              10 FILLER                PIC X(51)  VALUE SPACES.                 
           05 REPT-HEAD3C.                                                      
              10 FILLER                PIC X(49)  VALUE                         
                 '=========  ===========  ============  ==========='.           
              10 FILLER                PIC X(50)  VALUE                         
                 '=  ============  ============                     '.          
              10 FILLER                PIC X(51)  VALUE SPACES.                 
                                                                                
       01  REPT-HEAD4.                                                          
           05 REPT-HEAD4A.                                                      
              10 FILLER                PIC X(51)  VALUE                         
                 'Regn. No.  CPF A/C No.  Recoverd      Recoverd     '.         
              10 FILLER                PIC X(99) VALUE SPACES.                  
           05 REPT-HEAD4B.                                                      
              10 FILLER                PIC X(51)  VALUE                         
                 '                        prin. grant   int.         '.         
              10 FILLER                PIC X(99)  VALUE SPACES.                 
           05 REPT-HEAD4C.                                                      
              10 FILLER                PIC X(51)  VALUE                         
                 '=========  ===========  ===========   ===========  '.         
              10 FILLER                PIC X(99)  VALUE SPACES.                 
                                                                                
       01  REPT-HEAD5.                                                          
           05 REPT-HEAD5A.                                                      
              10 FILLER                     PIC X(48)  VALUE                    
                 'Regn. No.  HDB Ref number.  CPF A/C No.  Remarks'.            
              10 FILLER                     PIC X(102) VALUE SPACES.            
           05 REPT-HEAD5B.                                                      
              10 FILLER                     PIC X(48)  VALUE                    
                 '=========  ===============  ===========  ======='.            
              10 FILLER                     PIC X(102) VALUE SPACES.            
                                                                                
      *-------------------------------------------------------------            
      * LAYOUT BP13MAIL  -  DATASET FOR EMAIL                                   
      *-------------------------------------------------------------            
       01  MAIL-HDR1.                                                           
           05  FILLER          PIC X(12)  VALUE 'HELO SGPHDB1'.                 
           05  FILLER          PIC X(118) VALUE SPACES.                         
                                                                                
       01  MAIL-HDR2.                                                           
           05  FILLER          PIC X(11)  VALUE 'MAIL FROM:<'.                  
           05  MAIL-SENDID     PIC X(04)  VALUE 'OPCP'.                         
           05  FILLER          PIC X(09)  VALUE '@SGPHDB1>'.                    
           05  FILLER          PIC X(106) VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1A.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'CHONG_YENG_MUI@HDB.GOV.SG>'.                                    
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1B.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'SITI_ZAINAH_MISONEP@HDB.GOV.SG>'.                               
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1C.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'IVY_M_BALANAG@HDB.GOV.SG>'.                                     
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1D.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'PRISCILLA_YY_TAN@HDB.GOV.SG>'.                                  
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1E.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'SERENA_JM_TEH@HDB.GOV.SG>'.                                     
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1F.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'ONG_Sze_Meng@hdb.gov.sg>'.                                      
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1G.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               "Nor'ain_MOHAMAD_JOHAR@hdb.gov.sg>".                             
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1H.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'ENG_Siew_Yan@hdb.gov.sg>'.                                      
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1I.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'CHOO_Sock_Leng@hdb.gov.sg>'.                                    
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1J.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'Melvin_SH_LIM@hdb.gov.sg>'.                                     
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1K.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'CHOY_Miu_Yeng@hdb.gov.sg>'.                                     
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL2I.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'PEK_Siew_Peng@hdb.gov.sg>'.                                     
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL2J.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'HE_Jialing@hdb.gov.sg>'.                                        
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL2K.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'Kathijah_Bee_ALI_MOHAMED@hdb.gov.sg>'.                          
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL2.                                                           
           05  FILLER          PIC X(04)  VALUE 'DATA'.                         
           05  FILLER          PIC X(126) VALUE SPACES.                         
                                                                                
       01  MAIL-DTL3.                                                           
           05  FILLER          PIC X(05)  VALUE 'FROM:'.                        
           05  MAIL-SENDMAILID PIC X(26)  VALUE                                 
               'SOC System - Email Alert'.                                      
           05  FILLER          PIC X(99)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL4.                                                           
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'CHONG_YENG_MUI@HDB.GOV.SG>'.                                    
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5.                                                           
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'SITI_ZAINAH_MISONEP@HDB.GOV.SG>'.                               
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL6.                                                           
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'IVY_M_BALANAG@HDB.GOV.SG>'.                                     
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL7.                                                           
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'PRISCILLA_YY_TAN@HDB.GOV.SG>'.                                  
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL7A.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'Melvin_SH_LIM@hdb.gov.sg>'.                                     
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL7B.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'CHOY_Miu_Yeng@hdb.gov.sg>'.                                     
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL8.                                                           
           05  FILLER          PIC X(4)   VALUE 'CC:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'SERENA_JM_TEH@HDB.GOV.SG>'.                                     
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL9.                                                           
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'ONG_Sze_Meng@hdb.gov.sg>'.                                      
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL10.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               "Nor'ain_MOHAMAD_JOHAR@hdb.gov.sg>".                             
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL11.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'ENG_Siew_Yan@hdb.gov.sg>'.                                      
           05  FILLER          PIC X(66)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL11A.                                                         
           05  FILLER          PIC X(04)  VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'CHOO_Sock_Leng@hdb.gov.sg>'.                                    
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL11B.                                                         
           05  FILLER          PIC X(04)  VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'PEK_Siew_Peng@hdb.gov.sg>'.                                     
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL11C.                                                         
           05  FILLER          PIC X(04)  VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'HE_Jialing@hdb.gov.sg>'.                                        
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL11D.                                                         
           05  FILLER          PIC X(04)  VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'Kathijah_Bee_ALI_MOHAMED@hdb.gov.sg>'.                          
           05  FILLER          PIC X(61)  VALUE SPACES.                         
                                                                                
                                                                                
       01  MAIL-DTL12.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(20)  VALUE 'Cases with rejected '.         
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  MAIL-DTL12-EC   PIC X(04)  VALUE SPACES.                         
           05  FILLER          PIC X(70)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL13.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(19)  VALUE 'Cases with partial '.          
           05  FILLER          PIC X(08)  VALUE 'or null '.                     
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  MAIL-DTL13-EC   PIC X(20)  VALUE SPACES.                         
           05  FILLER          PIC X(43)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL14.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(18)  VALUE 'Cases with manual '.           
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  MAIL-DTL14-EC   PIC X(04)  VALUE SPACES.                         
           05  FILLER          PIC X(72)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL15.                                                          
           05 FILLER           PIC X(6)   VALUE 'DATE: '.                       
           05 MAIL-DATE        PIC X(10)  VALUE SPACES.                         
           05 FILLER           PIC X(114) VALUE SPACES.                         
                                                                                
       01  MAIL-DTL16.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(16)  VALUE 'Cases with full '.             
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  FILLER          PIC X(04)  VALUE '(EC)'.                         
           05  FILLER          PIC X(78)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL17.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(16)  VALUE 'Cases with full '.             
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  FILLER          PIC X(82)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL18.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(20)  VALUE 'Cases with rejected '.         
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  MAIL-DTL18-EC   PIC X(06)  VALUE ' (EC) '.                       
           05  FILLER          PIC X(16)  VALUE 'with off cde PRD'.             
           05  FILLER          PIC X(68)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL19.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(18)  VALUE 'Cases with manual '.           
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  FILLER          PIC X(16)  VALUE 'with off cde PRD'.             
           05  MAIL-DTL19-EC   PIC X(04)  VALUE SPACES.                         
           05  FILLER          PIC X(70)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL20.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(16)  VALUE 'Cases with full '.             
           05  FILLER          PIC X(17)  VALUE 'Grant & Interest '.            
           05  FILLER          PIC X(09)  VALUE 'recovery.'.                    
           05  FILLER          PIC X(16)  VALUE 'with off cde PRD'.             
           05  filler          PIC X(13)  VALUE 'for SRG grant'.                
           05  FILLER          PIC X(63)  VALUE SPACES.                         
                                                                                
       01  MAIL-SPACES         PIC X(150) VALUE SPACES.                         
       01  MAIL-END            PIC X      VALUE '.'.                            
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
      *----------*                                                              
       0000-MAIN.                                                               
      *----------*                                                              
           PERFORM 1000-OPEN-FILES          THRU 1000-EXIT.                     
           PERFORM 2000-READ-F945           THRU 2000-EXIT.                     
           PERFORM 3000-PROCESS-REC         THRU 3000-EXIT                      
             UNTIL WS-F945-EOF = 'Y'.                                           
           PERFORM 3300-WRITE-EMAIL         THRU 3300-EXIT.                     
           PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------*                                                        
       1000-OPEN-FILES.                                                         
      *----------------*                                                        
           OPEN INPUT  AB02F945                                                 
                I-O    BP13K736                                                 
                OUTPUT BP13L94A                                                 
                       BP13L94B                                                 
                       BP13L94C                                                 
                       BP13L94D                                                 
                       BP13L94E                                                 
                       BP13L94F                                                 
                       BP13L94G                                                 
                       BP13L94H                                                 
                       BP13L94I                                                 
                       BP13L94J                                                 
                       BP13L94K                                                 
                       BP13L94L                                                 
                       BP13L94M                                                 
                       BP13FPRC                                                 
                       BP13MAIL.                                                
                                                                                
           IF BP13K736-STATUS NOT = 0 AND 97                                    
              DISPLAY 'ERROR OPENING - BP13K736 : ' BP13K736-STATUS             
              MOVE BP13K736-STATUS          TO RETURN-CODE                      
              PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT                      
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE       TO WS-CURRENT-DATE.                 
           STRING WS-DTE-DD '/' WS-DTE-MM '/' WS-DTE-CCYY                       
                   DELIMITED BY SIZE INTO MAIL-DATE.                            
                                                                                
           WRITE WS-BP13L94A-REC            FROM REPT-HEAD1A.                   
           WRITE WS-BP13L94A-REC            FROM REPT-HEAD1B.                   
                                                                                
           WRITE WS-BP13L94B-REC            FROM REPT-HEAD2A.                   
           WRITE WS-BP13L94B-REC            FROM REPT-HEAD2B.                   
           WRITE WS-BP13L94B-REC            FROM REPT-HEAD2C.                   
                                                                                
           WRITE WS-BP13L94C-REC            FROM REPT-HEAD3A.                   
           WRITE WS-BP13L94C-REC            FROM REPT-HEAD3B.                   
           WRITE WS-BP13L94C-REC            FROM REPT-HEAD3C.                   
                                                                                
           WRITE WS-BP13L94D-REC            FROM REPT-HEAD1A.                   
           WRITE WS-BP13L94D-REC            FROM REPT-HEAD1B.                   
                                                                                
           WRITE WS-BP13L94E-REC            FROM REPT-HEAD2A.                   
           WRITE WS-BP13L94E-REC            FROM REPT-HEAD2B.                   
           WRITE WS-BP13L94E-REC            FROM REPT-HEAD2C.                   
                                                                                
           WRITE WS-BP13L94F-REC            FROM REPT-HEAD3A.                   
           WRITE WS-BP13L94F-REC            FROM REPT-HEAD3B.                   
           WRITE WS-BP13L94F-REC            FROM REPT-HEAD3C.                   
                                                                                
           WRITE WS-BP13L94G-REC            FROM REPT-HEAD4A.                   
           WRITE WS-BP13L94G-REC            FROM REPT-HEAD4B.                   
           WRITE WS-BP13L94G-REC            FROM REPT-HEAD4C.                   
                                                                                
           WRITE WS-BP13L94H-REC            FROM REPT-HEAD4A.                   
           WRITE WS-BP13L94H-REC            FROM REPT-HEAD4B.                   
           WRITE WS-BP13L94H-REC            FROM REPT-HEAD4C.                   
                                                                                
           WRITE WS-BP13L94I-REC            FROM REPT-HEAD5A.                   
           WRITE WS-BP13L94I-REC            FROM REPT-HEAD5B.                   
                                                                                
           WRITE WS-BP13L94J-REC            FROM REPT-HEAD3A.                   
           WRITE WS-BP13L94J-REC            FROM REPT-HEAD3B.                   
           WRITE WS-BP13L94J-REC            FROM REPT-HEAD3C.                   
                                                                                
           WRITE WS-BP13L94K-REC            FROM REPT-HEAD2A.                   
           WRITE WS-BP13L94K-REC            FROM REPT-HEAD2B.                   
           WRITE WS-BP13L94K-REC            FROM REPT-HEAD2C.                   
                                                                                
           WRITE WS-BP13L94L-REC            FROM REPT-HEAD4A.                   
           WRITE WS-BP13L94L-REC            FROM REPT-HEAD4B.                   
           WRITE WS-BP13L94L-REC            FROM REPT-HEAD4C.                   
                                                                                
           WRITE WS-BP13L94M-REC            FROM REPT-HEAD5A.                   
           WRITE WS-BP13L94M-REC            FROM REPT-HEAD5B.                   
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       2000-READ-F945.                                                          
      *---------------*                                                         
           READ AB02F945 AT END                                                 
                MOVE HIGH-VALUES            TO AB02F945-DETAIL-REC              
                MOVE 'Y'                    TO WS-F945-EOF                      
                GO TO 2000-EXIT.                                                
           ADD 1                            TO CNT-F945-READ.                   
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------*                                                       
       3000-PROCESS-REC.                                                        
      *-----------------*                                                       
           IF F945-CDE-REQ-STAT = '1'                                           
              PERFORM 3100-REWRITE-BP13K736 THRU 3100-EXIT                      
           END-IF                                                               
                                                                                
           PERFORM 3200-CREATE-RPTS         THRU 3200-EXIT.                     
           PERFORM 2000-READ-F945           THRU 2000-EXIT.                     
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------*                                                   
       3100-REWRITE-BP13K736.                                                   
      *---------------------*                                                   
           MOVE SPACES                       TO K736-KEY-FLD.                   
           MOVE F945-NUM-BSNESS-REF          TO K736-NUM-REGN.                  
           MOVE F945-NUM-CPF-ACCT            TO K736-NUM-NRIC.                  
                                                                                
           READ BP13K736.                                                       
           EVALUATE BP13K736-STATUS                                             
              WHEN 00                                                           
              WHEN 02                                                           
                 PERFORM 3150-REWRITE-BP13K736  THRU 3150-EXIT                  
                 ADD 1 TO CNT-K736-FND                                          
              WHEN 23                                                           
                 DISPLAY 'RECORD NOT FOUND IN BP13K736: ' K736-KEY-FLD          
              WHEN OTHER                                                        
                 DISPLAY 'ERROR READING BP13K736'                               
                 MOVE BP13K736-STATUS       TO RETURN-CODE                      
                 PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------*                                                   
       3150-REWRITE-BP13K736.                                                   
      *---------------------*                                                   
           IF K736-AMT-GRANT-EHG-COMP > 0                                       
              PERFORM 3160-MOVE-AMOUNT-CPF     THRU 3160-EXIT                   
           ELSE                                                                 
              PERFORM 3151-MOVE-AMOUNT-CPF     THRU 3151-EXIT                   
           END-IF.                                                              
                                                                                
           PERFORM 3151-MOVE-AMOUNT-CPF     THRU 3151-EXIT                      
                                                                                
           MOVE F945-AMT-RECOVERD-INTR      TO K736-AMT-RECOVER-INTR            
                                               K736-AMT-INT-CPF.                
           MOVE F945-AMT-RECOVERD-PRIN      TO K736-AMT-RECOVER-PRIN.           
           MOVE F945-TAG-MANUAL-PROCESSD    TO K736-NUM-MANUAL-CASE.            
           MOVE 'BP13CB3G'                  TO K736-NUM-USERID.                 
                                                                                
           IF K736-DTE-RECEIVE-CPF = SPACES                                     
              MOVE WS-CURRENT-DATE1         TO K736-DTE-RECEIVE-CPF             
           END-IF                                                               
           MOVE WS-CURRENT-DATE1            TO K736-DTE-UPDATE                  
           MOVE WS-CURRENT-TIME             TO K736-TME-UPDATE.                 
                                                                                
           REWRITE BP13K736-REC.                                                
                                                                                
           IF BP13K736-STATUS = 00 OR 02                                        
              ADD 1                         TO WS-REWRITE-BP13K736              
              WRITE BP13F736-PRCSED-REC   FROM BP13K736-REC                     
           ELSE                                                                 
              DISPLAY 'ERROR REWRITING BP13K736:' K736-KEY-FLD                  
              MOVE BP13K736-STATUS          TO RETURN-CODE                      
              PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT                      
           END-IF.                                                              
                                                                                
       3150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3151-MOVE-AMOUNT-CPF.                                                    
      *--------------------*                                                    
      *** PRIORITY OF GRANT TYPE 1.SHG -> 2.SUG -> 3.AHG                        
      *** EHG REPLACE SHG                                                       
                                                                                
           MOVE SPACES                      TO WS-AMT-ADJUSTED.                 
           MOVE ZEROS                       TO WS-AMT WS-AMT1 WS-AMT2           
                                               K736-AMT-GRANT-SHG-CPF           
                                               K736-AMT-GRANT-EHG-CPF           
                                               K736-AMT-GRANT-SUG-CPF           
                                               K736-AMT-GRANT-AHG-CPF           
                                               K736-AMT-GRANT-HGT-CPF           
                                               K736-AMT-GRANT-REG-CPF           
                                               K736-AMT-GRANT-SRG-CPF           
                                               K736-AMT-GRANT-PHG-CPF           
                                               K736-AMT-GRANT-TUG-CPF           
                                               K736-AMT-GRANT-ATG-CPF           
                                               K736-AMT-GRANT-FSG-CPF.          
                                                                                
           IF F945-AMT-RECOVERD-PRIN = ZEROS                                    
              CONTINUE                                                          
           ELSE                                                                 
              IF F945-AMT-RECOVERD-PRIN > ZEROS                                 
      *                                                                         
                 IF K736-AMT-GRANT-SHG-COMP > ZEROS                             
                    IF F945-AMT-RECOVERD-PRIN > K736-AMT-GRANT-SHG-COMP         
                       MOVE 'N'             TO WS-AMT-ADJUSTED                  
                       COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -              
                                          K736-AMT-GRANT-SHG-COMP               
                       MOVE K736-AMT-GRANT-SHG-COMP                             
                                            TO K736-AMT-GRANT-SHG-CPF           
                    ELSE                                                        
                       MOVE 'Y'             TO WS-AMT-ADJUSTED                  
                       MOVE F945-AMT-RECOVERD-PRIN                              
                                            TO K736-AMT-GRANT-SHG-CPF           
                    END-IF                                                      
                 ELSE                                                           
                   IF K736-AMT-GRANT-EHG-COMP > ZEROS                           
                    IF F945-AMT-RECOVERD-PRIN > K736-AMT-GRANT-EHG-COMP         
                       MOVE 'N'             TO WS-AMT-ADJUSTED                  
                       COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -              
                                          K736-AMT-GRANT-EHG-COMP               
                       MOVE K736-AMT-GRANT-EHG-COMP                             
                                            TO K736-AMT-GRANT-EHG-CPF           
                    ELSE                                                        
                       MOVE 'Y'             TO WS-AMT-ADJUSTED                  
                       MOVE F945-AMT-RECOVERD-PRIN                              
                                            TO K736-AMT-GRANT-EHG-CPF           
                    END-IF                                                      
                   ELSE                                                         
                     IF K736-AMT-GRANT-HGT-COMP > ZEROS                         
                      IF F945-AMT-RECOVERD-PRIN >                               
                                        K736-AMT-GRANT-HGT-COMP                 
                         MOVE 'N'             TO WS-AMT-ADJUSTED                
                         COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -            
                                            K736-AMT-GRANT-HGT-COMP             
                         MOVE K736-AMT-GRANT-EHG-COMP                           
                                              TO K736-AMT-GRANT-HGT-CPF         
                         MOVE 'H'             TO WS-HINT-CHK-ERROR              
                         PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                
                      ELSE                                                      
                         MOVE 'Y'             TO WS-AMT-ADJUSTED                
                         MOVE F945-AMT-RECOVERD-PRIN                            
                                              TO K736-AMT-GRANT-HGT-CPF         
                      END-IF                                                    
                     ELSE                                                       
                      IF K736-AMT-GRANT-REG-COMP > ZEROS                        
                          PERFORM 3153-VALIDATE-REG  THRU                       
                                  3153-EXIT                                     
                      ELSE                                                      
                        IF K736-AMT-GRANT-SRG-COMP > ZEROS                      
                            PERFORM 3154-VALIDATE-SRG  THRU                     
                                    3154-EXIT                                   
                        ELSE                                                    
                         IF K736-AMT-GRANT-PHG-COMP > ZEROS                     
                            PERFORM 3155-VALIDATE-PHG  THRU                     
                                    3155-EXIT                                   
                         ELSE                                                   
                          IF K736-AMT-GRANT-TUG-COMP > ZEROS                    
                             PERFORM 3156-VALIDATE-TUG  THRU                    
                                     3156-EXIT                                  
                          ELSE                                                  
                           IF K736-AMT-GRANT-ATG-COMP > ZEROS                   
                              PERFORM 3157-VALIDATE-ATG  THRU                   
                                      3157-EXIT                                 
                           ELSE                                                 
                            IF K736-AMT-GRANT-FSG-COMP > ZEROS                  
                               PERFORM 3158-VALIDATE-FSG  THRU                  
                                       3158-EXIT                                
                            END-IF                                              
                           END-IF                                               
                          END-IF                                                
                         END-IF                                                 
                        END-IF                                                  
                      END-IF                                                    
                     END-IF                                                     
                   END-IF                                                       
                 END-IF                                                         
      *                                                                         
      *                                                                         
                 IF WS-AMT-ADJUSTED = 'N'                                       
                    IF K736-AMT-GRANT-SUG-COMP = ZEROS AND                      
                       K736-AMT-GRANT-AHG-COMP = ZEROS                          
                       COMPUTE WS-AMT = F945-AMT-RECOVERD-PRIN                  
                                      - K736-AMT-GRANT-SHG-COMP                 
                       MOVE 'A'             TO WS-HINT-CHK-ERROR                
                       PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                  
                    END-IF                                                      
                 END-IF                                                         
      *                                                                         
                 IF K736-AMT-GRANT-SUG-COMP > ZEROS                             
                    IF WS-AMT-ADJUSTED = 'N'                                    
                       IF WS-AMT1 > K736-AMT-GRANT-SUG-COMP                     
                          MOVE 'N'          TO WS-AMT-ADJUSTED                  
                          COMPUTE WS-AMT2 =  WS-AMT1 -                          
                                             K736-AMT-GRANT-SUG-COMP            
                          MOVE K736-AMT-GRANT-SUG-COMP                          
                                            TO K736-AMT-GRANT-SUG-CPF           
                          MOVE ZEROS        TO WS-AMT1                          
                       ELSE                                                     
                          MOVE 'Y'          TO WS-AMT-ADJUSTED                  
                          MOVE WS-AMT1      TO K736-AMT-GRANT-SUG-CPF           
                       END-IF                                                   
                    ELSE                                                        
                       IF WS-AMT-ADJUSTED = SPACE                               
                          IF F945-AMT-RECOVERD-PRIN >                           
                             K736-AMT-GRANT-SUG-COMP                            
                             MOVE 'N'       TO WS-AMT-ADJUSTED                  
                             COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -        
                                                K736-AMT-GRANT-SUG-COMP         
                             MOVE K736-AMT-GRANT-SUG-COMP                       
                                            TO K736-AMT-GRANT-SUG-CPF           
                          ELSE                                                  
                             MOVE 'Y'       TO WS-AMT-ADJUSTED                  
                             MOVE F945-AMT-RECOVERD-PRIN                        
                                            TO K736-AMT-GRANT-SUG-CPF           
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
      *                                                                         
                 IF WS-AMT-ADJUSTED = 'N'                                       
                    IF K736-AMT-GRANT-SUG-COMP > ZEROS AND                      
                       K736-AMT-GRANT-AHG-COMP = ZEROS                          
                       IF WS-AMT1 > ZEROS                                       
                          MOVE WS-AMT1 TO WS-AMT                                
                          MOVE 'B'     TO WS-HINT-CHK-ERROR                     
                          PERFORM 3152-RECVR-ERROR THRU 3152-EXIT               
                       END-IF                                                   
                       IF WS-AMT2 > ZEROS                                       
                          MOVE WS-AMT2 TO WS-AMT                                
                          MOVE 'C'     TO WS-HINT-CHK-ERROR                     
                          PERFORM 3152-RECVR-ERROR THRU 3152-EXIT               
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
      *                                                                         
                 IF K736-AMT-GRANT-AHG-COMP > ZEROS                             
                    IF WS-AMT-ADJUSTED = 'N' AND WS-AMT2 > ZEROS                
                       IF WS-AMT2 > K736-AMT-GRANT-AHG-COMP                     
                          COMPUTE WS-AMT  =  WS-AMT2 -                          
                                             K736-AMT-GRANT-AHG-COMP            
                          MOVE 'D'          TO WS-HINT-CHK-ERROR                
                          PERFORM 3152-RECVR-ERROR THRU 3152-EXIT               
                       ELSE                                                     
                          MOVE WS-AMT2      TO K736-AMT-GRANT-AHG-CPF           
                       END-IF                                                   
                    ELSE                                                        
                       IF WS-AMT-ADJUSTED = 'N' AND WS-AMT1 > ZEROS             
                          IF WS-AMT1 > K736-AMT-GRANT-AHG-COMP                  
                             COMPUTE WS-AMT  =  WS-AMT1 -                       
                                                K736-AMT-GRANT-AHG-COMP         
                             MOVE 'E'       TO WS-HINT-CHK-ERROR                
                             PERFORM 3152-RECVR-ERROR THRU 3152-EXIT            
                          ELSE                                                  
                             MOVE WS-AMT1      TO K736-AMT-GRANT-AHG-CPF        
                          END-IF                                                
                       ELSE                                                     
                          IF WS-AMT-ADJUSTED = SPACES                           
                             IF F945-AMT-RECOVERD-PRIN >                        
                                K736-AMT-GRANT-AHG-COMP                         
                                COMPUTE WS-AMT = F945-AMT-RECOVERD-PRIN         
                                               - K736-AMT-GRANT-AHG-COMP        
                                MOVE 'F'    TO WS-HINT-CHK-ERROR                
                                PERFORM 3152-RECVR-ERROR THRU 3152-EXIT         
                             ELSE                                               
                                MOVE 'Y'       TO WS-AMT-ADJUSTED               
                                MOVE F945-AMT-RECOVERD-PRIN                     
                                               TO K736-AMT-GRANT-AHG-CPF        
                             END-IF                                             
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
                                                                                
                 IF WS-AMT-ADJUSTED = SPACES                                    
                    MOVE F945-AMT-RECOVERD-PRIN TO WS-AMT                       
                    MOVE 'G'                TO WS-HINT-CHK-ERROR                
                    PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                     
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3151-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3153-VALIDATE-REG.                                                       
      *--------------------*                                                    
           IF F945-AMT-RECOVERD-PRIN >                                          
                                K736-AMT-GRANT-REG-COMP                         
                 MOVE 'N'             TO WS-AMT-ADJUSTED                        
                 COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -                    
                                    K736-AMT-GRANT-REG-COMP                     
                 MOVE K736-AMT-GRANT-REG-COMP                                   
                                     TO K736-AMT-GRANT-REG-CPF                  
                 MOVE 'I'            TO WS-HINT-CHK-ERROR                       
                 PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                        
           ELSE                                                                 
                 MOVE 'Y'            TO WS-AMT-ADJUSTED                         
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                                    TO K736-AMT-GRANT-REG-CPF                   
           END-IF.                                                              
                                                                                
       3153-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3154-VALIDATE-SRG.                                                       
      *--------------------*                                                    
           IF F945-AMT-RECOVERD-PRIN >                                          
                                K736-AMT-GRANT-SRG-COMP                         
                 MOVE 'N'             TO WS-AMT-ADJUSTED                        
                 COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -                    
                                    K736-AMT-GRANT-SRG-COMP                     
                 MOVE K736-AMT-GRANT-SRG-COMP                                   
                                     TO K736-AMT-GRANT-SRG-CPF                  
                 MOVE 'I'            TO WS-HINT-CHK-ERROR                       
                 PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                        
           ELSE                                                                 
                 MOVE 'Y'            TO WS-AMT-ADJUSTED                         
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                                     TO K736-AMT-GRANT-SRG-CPF                  
           END-IF.                                                              
                                                                                
       3154-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3155-VALIDATE-PHG.                                                       
      *--------------------*                                                    
           IF F945-AMT-RECOVERD-PRIN >                                          
                                K736-AMT-GRANT-PHG-COMP                         
                 MOVE 'N'             TO WS-AMT-ADJUSTED                        
                 COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -                    
                                    K736-AMT-GRANT-PHG-COMP                     
                 MOVE K736-AMT-GRANT-PHG-COMP                                   
                                     TO K736-AMT-GRANT-PHG-CPF                  
                 MOVE 'I'            TO WS-HINT-CHK-ERROR                       
                 PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                        
           ELSE                                                                 
                 MOVE 'Y'            TO WS-AMT-ADJUSTED                         
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                                     TO K736-AMT-GRANT-PHG-CPF                  
           END-IF.                                                              
                                                                                
       3155-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3156-VALIDATE-TUG.                                                       
      *--------------------*                                                    
           IF F945-AMT-RECOVERD-PRIN >                                          
                                K736-AMT-GRANT-TUG-COMP                         
                 MOVE 'N'             TO WS-AMT-ADJUSTED                        
                 COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -                    
                                    K736-AMT-GRANT-TUG-COMP                     
                 MOVE K736-AMT-GRANT-TUG-COMP                                   
                                     TO K736-AMT-GRANT-TUG-CPF                  
                 MOVE 'I'            TO WS-HINT-CHK-ERROR                       
                 PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                        
           ELSE                                                                 
                 MOVE 'Y'            TO WS-AMT-ADJUSTED                         
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                                     TO K736-AMT-GRANT-TUG-CPF                  
           END-IF.                                                              
                                                                                
       3156-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3157-VALIDATE-ATG.                                                       
      *--------------------*                                                    
           IF F945-AMT-RECOVERD-PRIN >                                          
                                K736-AMT-GRANT-ATG-COMP                         
                 MOVE 'N'             TO WS-AMT-ADJUSTED                        
                 COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -                    
                                    K736-AMT-GRANT-ATG-COMP                     
                 MOVE K736-AMT-GRANT-ATG-COMP                                   
                                     TO K736-AMT-GRANT-ATG-CPF                  
                 MOVE 'I'            TO WS-HINT-CHK-ERROR                       
                 PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                        
           ELSE                                                                 
                 MOVE 'Y'            TO WS-AMT-ADJUSTED                         
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                                     TO K736-AMT-GRANT-ATG-CPF                  
           END-IF.                                                              
                                                                                
       3157-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3158-VALIDATE-FSG.                                                       
      *--------------------*                                                    
           IF F945-AMT-RECOVERD-PRIN >                                          
                                K736-AMT-GRANT-FSG-COMP                         
                 MOVE 'N'             TO WS-AMT-ADJUSTED                        
                 COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -                    
                                    K736-AMT-GRANT-FSG-COMP                     
                 MOVE K736-AMT-GRANT-FSG-COMP                                   
                                     TO K736-AMT-GRANT-FSG-CPF                  
                 MOVE 'I'            TO WS-HINT-CHK-ERROR                       
                 PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                        
           ELSE                                                                 
                 MOVE 'Y'            TO WS-AMT-ADJUSTED                         
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                                     TO K736-AMT-GRANT-FSG-CPF                  
           END-IF.                                                              
                                                                                
       3158-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3160-MOVE-AMOUNT-CPF.                                                    
      *--------------------*                                                    
      *** PRIORITY OF GRANT TYPE 1.EHG -> 2.SUG                                 
                                                                                
           MOVE SPACES                      TO WS-AMT-ADJUSTED.                 
           MOVE ZEROS                       TO WS-AMT WS-AMT1 WS-AMT2           
                                               K736-AMT-GRANT-EHG-CPF           
                                               K736-AMT-GRANT-SUG-CPF.          
                                                                                
           IF F945-AMT-RECOVERD-PRIN = ZEROS                                    
              CONTINUE                                                          
           ELSE                                                                 
              IF F945-AMT-RECOVERD-PRIN > ZEROS                                 
      *                                                                         
                 IF K736-AMT-GRANT-EHG-COMP > ZEROS                             
                    IF F945-AMT-RECOVERD-PRIN > K736-AMT-GRANT-EHG-COMP         
                       MOVE 'N'             TO WS-AMT-ADJUSTED                  
                       COMPUTE WS-AMT1 =  F945-AMT-RECOVERD-PRIN -              
                                          K736-AMT-GRANT-EHG-COMP               
                       MOVE K736-AMT-GRANT-EHG-COMP                             
                                            TO K736-AMT-GRANT-EHG-CPF           
                    ELSE                                                        
                       MOVE 'Y'             TO WS-AMT-ADJUSTED                  
                       MOVE F945-AMT-RECOVERD-PRIN                              
                                            TO K736-AMT-GRANT-EHG-CPF           
                    END-IF                                                      
                 END-IF                                                         
      *                                                                         
                 IF WS-AMT-ADJUSTED = 'N'                                       
                    IF K736-AMT-GRANT-SUG-COMP = ZEROS                          
                       COMPUTE WS-AMT = F945-AMT-RECOVERD-PRIN                  
                                      - K736-AMT-GRANT-EHG-COMP                 
                       MOVE 'H'             TO WS-HINT-CHK-ERROR                
                       PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                  
                    END-IF                                                      
                 END-IF                                                         
      *                                                                         
                 IF K736-AMT-GRANT-SUG-COMP > ZEROS                             
                    IF WS-AMT-ADJUSTED = 'N'                                    
                       IF WS-AMT1 > K736-AMT-GRANT-SUG-COMP                     
                          MOVE 'N'          TO WS-AMT-ADJUSTED                  
                          COMPUTE WS-AMT  =  WS-AMT1 -                          
                                             K736-AMT-GRANT-SUG-COMP            
                          MOVE 'I'             TO WS-HINT-CHK-ERROR             
                          PERFORM 3152-RECVR-ERROR THRU 3152-EXIT               
                       ELSE                                                     
                          MOVE 'Y'          TO WS-AMT-ADJUSTED                  
                          MOVE WS-AMT1      TO K736-AMT-GRANT-SUG-CPF           
                       END-IF                                                   
                    ELSE                                                        
                       IF WS-AMT-ADJUSTED = SPACE                               
                          IF F945-AMT-RECOVERD-PRIN >                           
                             K736-AMT-GRANT-SUG-COMP                            
                             COMPUTE WS-AMT  =  F945-AMT-RECOVERD-PRIN -        
                                                K736-AMT-GRANT-SUG-COMP         
                             MOVE 'J'             TO WS-HINT-CHK-ERROR          
                             PERFORM 3152-RECVR-ERROR THRU 3152-EXIT            
                          ELSE                                                  
                             MOVE 'Y'       TO WS-AMT-ADJUSTED                  
                             MOVE F945-AMT-RECOVERD-PRIN                        
                                            TO K736-AMT-GRANT-SUG-CPF           
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
      *                                                                         
                 IF WS-AMT-ADJUSTED = SPACES                                    
                    MOVE F945-AMT-RECOVERD-PRIN TO WS-AMT                       
                    MOVE 'K'                TO WS-HINT-CHK-ERROR                
                    PERFORM 3152-RECVR-ERROR THRU 3152-EXIT                     
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3160-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------*                                                       
       3152-RECVR-ERROR.                                                        
      *-----------------*                                                       
           DISPLAY 'REGN     : ' F945-NUM-BSNESS-REF                            
           DISPLAY 'NRIC     : ' F945-NUM-CPF-ACCT                              
           DISPLAY 'REC PRIN : ' F945-AMT-RECOVERD-PRIN                         
           DISPLAY 'GRNT TYP1: ' F945-CDE-GRNT-TYPE-1 '- AMT : '                
                   F945-AMT-GRNT-TYPE-1                                         
           DISPLAY 'GRNT TYP2: ' F945-CDE-GRNT-TYPE-2 '- AMT : '                
                   F945-AMT-GRNT-TYPE-2                                         
           DISPLAY 'GRNT TYP3: ' F945-CDE-GRNT-TYPE-3 '- AMT : '                
                   F945-AMT-GRNT-TYPE-3                                         
           DISPLAY 'RECOVERED PRINCIPAL AMOUNT IS MORE THAN EXPECTED - E        
      -            'XTRA AMOUNT : ' WS-AMT.                                     
           DISPLAY 'CHECK THE LOGIC ==> ' WS-HINT-CHK-ERROR                     
           MOVE 99                  TO RETURN-CODE.                             
           PERFORM 9000-CLOSE-FILES THRU 9000-EXIT.                             
                                                                                
       3152-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------*                                                        
       3200-CREATE-RPTS.                                                        
      *----------------*                                                        
           MOVE SPACES                      TO WS-BP13L94A-REC                  
                                               WS-BP13L94B-REC                  
                                               WS-BP13L94C-REC                  
                                               WS-BP13L94D-REC                  
                                               WS-BP13L94E-REC                  
                                               WS-BP13L94F-REC                  
                                               WS-BP13L94G-REC                  
                                               WS-BP13L94H-REC                  
                                               WS-BP13L94I-REC                  
                                               WS-BP13L94J-REC                  
                                               WS-BP13L94K-REC                  
                                               WS-BP13L94L-REC                  
                                               WS-BP13L94M-REC.                 
           INITIALIZE                          WS-BP13L94A-REC                  
                                               WS-BP13L94B-REC                  
                                               WS-BP13L94C-REC                  
                                               WS-BP13L94D-REC                  
                                               WS-BP13L94E-REC                  
                                               WS-BP13L94F-REC                  
                                               WS-BP13L94G-REC                  
                                               WS-BP13L94H-REC                  
                                               WS-BP13L94I-REC                  
                                               WS-BP13L94J-REC                  
                                               WS-BP13L94K-REC                  
                                               WS-BP13L94L-REC                  
                                               WS-BP13L94M-REC.                 
                                                                                
           IF F945-CDE-SYSID        = 'BP13' AND                                
              F945-CDE-OFC          = 'SS'   AND                                
             ((F945-CDE-GRNT-TYPE-1 = 'SHG' OR 'SUG' OR 'AHG' OR                
                                      'HGT' OR 'REG' OR 'SRG' OR                
                                      'PHG' OR 'TUG' OR 'ATG' OR                
                                      'FSG') OR                                 
              (F945-CDE-GRNT-TYPE-2 = 'SHG' OR 'SUG' OR 'AHG' OR                
                                      'HGT' OR 'REG' OR 'SRG' OR                
                                      'PHG' OR 'TUG' OR 'ATG' OR                
                                      'FSG' OR '   ')                           
           OR (F945-CDE-GRNT-TYPE-3 = 'SHG' OR 'SUG' OR 'AHG' OR                
                                      'HGT' OR 'REG' OR 'SRG' OR                
                                      'PHG' OR 'TUG' OR 'ATG' OR                
                                      'FSG' OR '   '))                          
                                                                                
              IF F945-CDE-REQ-STAT     = '2' AND                                
                 F945-TXT-REMARKS NOT  = SPACES                                 
                 MOVE F945-NUM-BSNESS-REF   TO WS-L94A-NUM-BSNESS-REF           
                 MOVE F945-NUM-CPF-ACCT     TO WS-L94A-NUM-CPF-ACCT             
                 MOVE F945-TXT-REMARKS      TO WS-L94A-TXT-REMARKS              
                 IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                          
                    WRITE WS-BP13L94A-REC                                       
                 ELSE                                                           
                   IF F945-TAG-EXEC-CONDO = 'Y ' OR ' Y'                        
                      WRITE WS-BP13L94D-REC FROM WS-BP13L94A-REC                
                   END-IF                                                       
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF (F945-CDE-REQ-STAT = '1' AND                                   
                  (F945-CDE-RECOVERY-STAT = '2' OR '3')) AND                    
                 ((F945-AMT-RECOVERD-PRIN NOT = ZEROS) OR                       
                  (F945-AMT-RECOVERD-INTR NOT = ZEROS) OR                       
                  (F945-DTE-ACCRUED-INTR-FRM-CYM NOT = SPACES AND ZEROS)        
                                                                  OR            
                  (F945-DTE-ACCRUED-INTR-TO-CYM NOT = SPACES AND ZEROS))        
                 MOVE F945-NUM-BSNESS-REF   TO WS-L94B-NUM-BSNESS-REF           
                 MOVE F945-NUM-CPF-ACCT     TO WS-L94B-NUM-CPF-ACCT             
                 MOVE F945-TAG-MANUAL-PROCESSD                                  
                   TO WS-L94B-TAG-MANUAL-PROCESSD                               
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                   TO WS-L94B-AMT-RECOVERD-PRIN                                 
                 MOVE F945-AMT-RECOVERD-INTR                                    
                   TO WS-L94B-AMT-RECOVERD-INTR                                 
                 MOVE F945-NUM-GRNT-IDN     TO WS-L94B-NUM-GRNT-IDN             
                 MOVE F945-AMT-OS-PRIN      TO WS-L94B-AMT-OS-PRIN              
                 MOVE F945-AMT-OS-INTR      TO WS-L94B-AMT-OS-INTR              
                 IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                          
                    WRITE WS-BP13L94B-REC                                       
                 ELSE                                                           
                   IF F945-TAG-EXEC-CONDO = 'Y ' OR ' Y'                        
                      WRITE WS-BP13L94E-REC FROM WS-BP13L94B-REC                
                   END-IF                                                       
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF F945-CDE-REQ-STAT = '1' AND                                    
                 F945-CDE-RECOVERY-STAT = '1'                                   
                 MOVE F945-NUM-BSNESS-REF   TO WS-L94G-NUM-BSNESS-REF           
                                               WS-L94H-NUM-BSNESS-REF           
                 MOVE F945-NUM-CPF-ACCT     TO WS-L94G-NUM-CPF-ACCT             
                                               WS-L94H-NUM-CPF-ACCT             
                 MOVE F945-AMT-RECOVERD-PRIN                                    
                   TO WS-L94G-AMT-RECOVERD-PRIN                                 
                      WS-L94H-AMT-RECOVERD-PRIN                                 
                 MOVE F945-AMT-RECOVERD-INTR                                    
                   TO WS-L94G-AMT-RECOVERD-INTR                                 
                      WS-L94H-AMT-RECOVERD-INTR                                 
                 IF F945-TAG-EXEC-CONDO = 'Y ' OR ' Y'                          
                    WRITE WS-BP13L94G-REC                                       
                 ELSE                                                           
                   IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                        
                      WRITE WS-BP13L94H-REC                                     
                   END-IF                                                       
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F945-TAG-MANUAL-PROCESSD = 'M' AND                                
              F945-CDE-OFC = 'SS'            AND                                
              F945-CDE-REQ-STAT = '1'                                           
              MOVE F945-NUM-BSNESS-REF   TO WS-L94C-NUM-BSNESS-REF              
              MOVE F945-NUM-CPF-ACCT     TO WS-L94C-NUM-CPF-ACCT                
              MOVE F945-AMT-RECOVERD-PRIN                                       
                TO WS-L94C-AMT-RECOVERD-PRIN                                    
              MOVE F945-AMT-RECOVERD-INTR                                       
                TO WS-L94C-AMT-RECOVERD-INTR                                    
              MOVE F945-DTE-ACCRUED-INTR-FRM-CYM                                
                TO WS-L94C-ACCRUED-INTR-FRM-CYM                                 
              MOVE F945-DTE-ACCRUED-INTR-TO-CYM                                 
                TO WS-L94C-ACCRUED-INTR-TO-CYM                                  
              IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                             
                 WRITE WS-BP13L94C-REC                                          
              ELSE                                                              
                IF F945-TAG-EXEC-CONDO = 'Y ' OR ' Y'                           
                   WRITE WS-BP13L94F-REC FROM WS-BP13L94C-REC                   
                END-IF                                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F945-TAG-MANUAL-PROCESSD = 'M' AND                                
              F945-CDE-OFC = 'PRD'           AND                                
              F945-CDE-REQ-STAT = '1'                                           
              MOVE F945-NUM-BSNESS-REF   TO WS-L94C-NUM-BSNESS-REF              
              MOVE F945-NUM-CPF-ACCT     TO WS-L94C-NUM-CPF-ACCT                
              MOVE F945-AMT-RECOVERD-PRIN                                       
                TO WS-L94C-AMT-RECOVERD-PRIN                                    
              MOVE F945-AMT-RECOVERD-INTR                                       
                TO WS-L94C-AMT-RECOVERD-INTR                                    
              MOVE F945-DTE-ACCRUED-INTR-FRM-CYM                                
                TO WS-L94C-ACCRUED-INTR-FRM-CYM                                 
              MOVE F945-DTE-ACCRUED-INTR-TO-CYM                                 
                TO WS-L94C-ACCRUED-INTR-TO-CYM                                  
              IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                             
                 WRITE WS-BP13L94J-REC FROM WS-BP13L94C-REC                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F945-CDE-SYSID        = 'BP13' AND                                
              F945-CDE-OFC          = 'PRD'                                     
              IF  F945-CDE-REQ-STAT = 2      AND                                
                  F945-TXT-REMARKS NOT  = SPACES                                
                   MOVE F945-NUM-BSNESS-REF   TO WS-L94I-NUM-BSNESS-REF         
                   MOVE F945-NUM-HDB-REF      TO WS-L94I-NUM-HDB-REF            
                   MOVE F945-NUM-CPF-ACCT     TO WS-L94I-NUM-CPF-ACCT           
                   MOVE F945-TXT-REMARKS      TO WS-L94I-TXT-REMARKS            
                   IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                        
                      WRITE WS-BP13L94M-REC FROM WS-BP13L94I-REC                
                   ELSE                                                         
                     IF F945-TAG-EXEC-CONDO = 'Y ' OR ' Y'                      
                        WRITE WS-BP13L94I-REC                                   
                     END-IF                                                     
                   END-IF                                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
            IF (F945-CDE-REQ-STAT = '1' AND                                     
                (F945-CDE-RECOVERY-STAT = '2' OR '3')) AND                      
                (F945-CDE-OFC          = 'PRD') AND                             
               ((F945-AMT-RECOVERD-PRIN NOT = ZEROS) OR                         
                (F945-AMT-RECOVERD-INTR NOT = ZEROS) OR                         
                (F945-DTE-ACCRUED-INTR-FRM-CYM NOT = SPACES AND ZEROS)          
                                                                OR              
                (F945-DTE-ACCRUED-INTR-TO-CYM NOT = SPACES AND ZEROS))          
               MOVE F945-NUM-BSNESS-REF   TO WS-L94B-NUM-BSNESS-REF             
               MOVE F945-NUM-CPF-ACCT     TO WS-L94B-NUM-CPF-ACCT               
               MOVE F945-TAG-MANUAL-PROCESSD                                    
                 TO WS-L94B-TAG-MANUAL-PROCESSD                                 
               MOVE F945-AMT-RECOVERD-PRIN                                      
                 TO WS-L94B-AMT-RECOVERD-PRIN                                   
               MOVE F945-AMT-RECOVERD-INTR                                      
                 TO WS-L94B-AMT-RECOVERD-INTR                                   
               MOVE F945-NUM-GRNT-IDN     TO WS-L94B-NUM-GRNT-IDN               
               MOVE F945-AMT-OS-PRIN      TO WS-L94B-AMT-OS-PRIN                
               MOVE F945-AMT-OS-INTR      TO WS-L94B-AMT-OS-INTR                
               IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                            
                  WRITE WS-BP13L94K-REC FROM WS-BP13L94B-REC                    
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F945-CDE-REQ-STAT = '1' AND                                      
               F945-CDE-RECOVERY-STAT = '1' AND                                 
               F945-CDE-OFC = 'PRD' AND                                         
               F945-CDE-GRNT-TYPE-1 = 'SRG'                                     
               MOVE F945-NUM-BSNESS-REF    TO WS-L94H-NUM-BSNESS-REF            
               MOVE F945-NUM-CPF-ACCT      TO WS-L94H-NUM-CPF-ACCT              
               MOVE F945-AMT-RECOVERD-PRIN TO WS-L94H-AMT-RECOVERD-PRIN         
               MOVE F945-AMT-RECOVERD-INTR TO WS-L94H-AMT-RECOVERD-INTR         
                                                                                
               IF F945-TAG-EXEC-CONDO = 'N ' OR ' N'                            
                  WRITE WS-BP13L94L-REC  FROM  WS-BP13L94H-REC                  
               END-IF                                                           
            END-IF.                                                             
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------*                                                        
       3300-WRITE-EMAIL.                                                        
      *----------------*                                                        
           CLOSE BP13L94A BP13L94B BP13L94C BP13L94D BP13L94E BP13L94F          
                 BP13L94G BP13L94H BP13L94I BP13L94J BP13L94K BP13L94L          
                 BP13L94M.                                                      
           OPEN INPUT BP13L94A BP13L94B BP13L94C BP13L94D BP13L94E              
                      BP13L94F BP13L94G BP13L94H BP13L94I BP13L94J              
                      BP13L94K BP13L94L BP13L94M.                               
           MOVE 'N'                         TO WS-L94A-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
                                                                                
           WRITE MAIL-PRTREC                FROM REPT-HEAD1A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD1B.                   
           PERFORM UNTIL WS-L94A-EOF = 'Y'                                      
              READ BP13L94A                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94A-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94A-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94A-READ > 2 AND WS-L94A-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94A-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94B-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD2A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD2B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD2C.                   
           PERFORM UNTIL WS-L94B-EOF = 'Y'                                      
              READ BP13L94B                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94B-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94B-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94B-READ > 3 AND WS-L94B-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94B-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94C-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD3A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD3B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD3C.                   
           PERFORM UNTIL WS-L94C-EOF = 'Y'                                      
              READ BP13L94C                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94C-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94C-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94C-READ > 3 AND WS-L94C-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94C-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94D-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD1A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD1B.                   
           PERFORM UNTIL WS-L94D-EOF = 'Y'                                      
              READ BP13L94D                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94D-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94D-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94D-READ > 3 AND WS-L94D-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94D-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94E-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD2A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD2B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD2C.                   
           PERFORM UNTIL WS-L94E-EOF = 'Y'                                      
              READ BP13L94E                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94E-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94E-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94E-READ > 3 AND WS-L94E-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94E-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94F-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD3A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD3B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD3C.                   
           PERFORM UNTIL WS-L94F-EOF = 'Y'                                      
              READ BP13L94F                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94F-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94F-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94F-READ > 3 AND WS-L94F-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94F-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94G-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD4A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4C.                   
           PERFORM UNTIL WS-L94G-EOF = 'Y'                                      
              READ BP13L94G                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94G-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94G-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94G-READ > 3 AND WS-L94G-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94G-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94H-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD4A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4C.                   
           PERFORM UNTIL WS-L94H-EOF = 'Y'                                      
              READ BP13L94H                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94H-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94H-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94H-READ > 3 AND WS-L94H-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94H-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94I-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
                                                                                
           WRITE MAIL-PRTREC                FROM REPT-HEAD5A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD5B.                   
           PERFORM UNTIL WS-L94I-EOF = 'Y'                                      
              READ BP13L94I                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94I-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94I-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94I-READ > 2 AND WS-L94I-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94I-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94J-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
                                                                                
           WRITE MAIL-PRTREC                FROM REPT-HEAD3A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD3B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD3C.                   
           PERFORM UNTIL WS-L94J-EOF = 'Y'                                      
              READ BP13L94J                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94J-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94J-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94J-READ > 3 AND WS-L94J-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94J-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94K-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD2A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD2B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD2C.                   
           PERFORM UNTIL WS-L94K-EOF = 'Y'                                      
              READ BP13L94K                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94K-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94K-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94K-READ > 3 AND WS-L94K-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94K-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94L-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD4A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4C.                   
           PERFORM UNTIL WS-L94L-EOF = 'Y'                                      
              READ BP13L94L                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94L-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94L-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94L-READ > 3 AND WS-L94L-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94L-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
           MOVE 'N'                         TO WS-L94M-EOF                      
           PERFORM 3350-WRITE-EMAIL-HEAD    THRU 3350-EXIT.                     
           WRITE MAIL-PRTREC                FROM REPT-HEAD4A.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4B.                   
           WRITE MAIL-PRTREC                FROM REPT-HEAD4C.                   
           PERFORM UNTIL WS-L94M-EOF = 'Y'                                      
              READ BP13L94M                                                     
                AT END                                                          
                   MOVE 'Y'                 TO WS-L94M-EOF                      
               NOT AT END                                                       
                   ADD 1                    TO CNT-L94M-READ                    
              END-READ                                                          
                                                                                
              IF CNT-L94M-READ > 3 AND WS-L94M-EOF = 'N'                        
                 WRITE MAIL-PRTREC          FROM WS-BP13L94M-REC                
              END-IF                                                            
           END-PERFORM.                                                         
           WRITE MAIL-PRTREC                FROM MAIL-END.                      
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------*                                                   
       3350-WRITE-EMAIL-HEAD.                                                   
      *---------------------*                                                   
           WRITE MAIL-PRTREC                FROM MAIL-HDR1.                     
           WRITE MAIL-PRTREC                FROM MAIL-HDR2.                     
           IF WS-L94A-EOF = 'N' OR WS-L94B-EOF = 'N' OR                         
              WS-L94C-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL1A                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1B                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1C                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1D                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1E                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1G                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1J                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1K                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2J                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2K                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL3                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL4                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL5                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL6                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL7                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL7A                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL7B                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL10                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL8                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL11C                    
              WRITE MAIL-PRTREC             FROM MAIL-DTL11D                    
           END-IF                                                               
           IF WS-L94D-EOF = 'N' OR WS-L94E-EOF = 'N' OR                         
              WS-L94F-EOF = 'N' OR WS-L94G-EOF = 'N' OR                         
              WS-L94I-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL1F                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1G                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1H                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL3                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL9                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL10                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL11                     
           END-IF                                                               
           IF WS-L94H-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL1A                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1B                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1C                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1D                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1E                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1G                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1J                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL1K                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2J                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2K                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL3                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL4                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL5                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL6                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL7                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL7A                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL7B                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL10                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL8                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL11C                    
              WRITE MAIL-PRTREC             FROM MAIL-DTL11D                    
           END-IF                                                               
           IF WS-L94J-EOF = 'N' OR                                              
              WS-L94K-EOF = 'N' OR WS-L94L-EOF = 'N' OR                         
              WS-L94M-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL1I                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2I                     
              WRITE MAIL-PRTREC             FROM MAIL-DTL2                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL3                      
              WRITE MAIL-PRTREC             FROM MAIL-DTL11A                    
              WRITE MAIL-PRTREC             FROM MAIL-DTL11B                    
           END-IF                                                               
           IF WS-L94A-EOF = 'N' OR WS-L94D-EOF = 'N'                            
              IF WS-L94D-EOF = 'N'                                              
                 MOVE '(EC)'                TO MAIL-DTL12-EC                    
              END-IF                                                            
              WRITE MAIL-PRTREC             FROM MAIL-DTL12                     
           END-IF.                                                              
           IF WS-L94B-EOF = 'N' OR WS-L94E-EOF = 'N' OR                         
              WS-L94K-EOF = 'N'                                                 
              IF WS-L94E-EOF = 'N'                                              
                 MOVE '(EC)'                TO MAIL-DTL13-EC                    
              END-IF                                                            
              IF WS-L94K-EOF = 'N'                                              
                 MOVE 'OFF CDE PRD'         TO MAIL-DTL13-EC                    
              END-IF                                                            
              WRITE MAIL-PRTREC             FROM MAIL-DTL13                     
           END-IF.                                                              
           IF WS-L94C-EOF = 'N' OR WS-L94F-EOF = 'N'                            
              IF WS-L94F-EOF = 'N'                                              
                 MOVE '(EC)'                TO MAIL-DTL14-EC                    
              END-IF                                                            
              WRITE MAIL-PRTREC             FROM MAIL-DTL14                     
           END-IF.                                                              
           IF WS-L94G-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL16                     
           END-IF.                                                              
           IF WS-L94H-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL17                     
           END-IF.                                                              
           IF WS-L94I-EOF = 'N' OR WS-L94M-EOF = 'N'                            
              IF WS-L94M-EOF = 'N'                                              
                 MOVE 'NONEC'               TO   MAIL-DTL18-EC                  
              END-IF                                                            
              WRITE MAIL-PRTREC             FROM MAIL-DTL18                     
           END-IF.                                                              
                                                                                
           IF WS-L94J-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL19                     
           END-IF.                                                              
           IF WS-L94L-EOF = 'N'                                                 
              WRITE MAIL-PRTREC             FROM MAIL-DTL20                     
           END-IF.                                                              
           WRITE MAIL-PRTREC                FROM MAIL-DTL15.                    
           WRITE MAIL-PRTREC                FROM MAIL-SPACES.                   
                                                                                
       3350-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------*                                                       
       9000-CLOSE-FILES.                                                        
      *-----------------*                                                       
           DISPLAY '******  BP13CB3G *************'.                            
           DISPLAY 'NO OF RECS READ FROM  AB02F945  : ' CNT-F945-READ.          
           DISPLAY 'NO OF RECS FOUND IN   BP13K736  : ' CNT-K736-FND.           
           DISPLAY 'NO OF RECS REWRITE TO BP13K736  : '                         
                                               WS-REWRITE-BP13K736.             
           CLOSE BP13K736                                                       
                 AB02F945                                                       
                 BP13L94A                                                       
                 BP13L94B                                                       
                 BP13L94C                                                       
                 BP13L94D                                                       
                 BP13L94E                                                       
                 BP13L94F                                                       
                 BP13L94G                                                       
                 BP13L94H                                                       
                 BP13L94I                                                       
                 BP13L94J                                                       
                 BP13L94K                                                       
                 BP13L94L                                                       
                 BP13L94M                                                       
                 BP13FPRC                                                       
                 BP13MAIL.                                                      
                                                                                
           IF BP13K736-STATUS NOT = 0 AND 97                                    
              DISPLAY ' CLOSING ERROR, BP13K736-STATUS ' BP13K736-STATUS        
              MOVE BP13K736-STATUS          TO RETURN-CODE.                     
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
