       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C175.                                                 
      *AUTHOR.        LLOYD CAPARRO.                                            
      *                                                                         
      ************************************************************              
      *                   SOC SYSTEM (SOC)                       *              
      *==========================================================*              
      * DATE WRITTEN      : 17 FEB 2005                          *              
      *                                                          *              
      * 1. OBJECTIVE      : PRINT 3 REPORTS                      *              
      *                                                          *              
      * 2. INPUT          : BP13F800 - BP13.F800.APPLN           *              
      *                     BP13K820 - BP13.K820.OCCUP           *              
      *                                                          *              
      * 3. OUTPUT         : P13L175A - HOUSE HOLD INCOME <= 2000 *              
      *                   : P13L175B - IDP SCHEME = LRT          *              
      *                   : P13L175C - HALF IDP = S              *              
      *==========================================================*              
      *  MODIFICATIONS:                                          *              
      *                                                          *              
      *  CHGE-NO  DATE       OIC  DESCRIPTION                    *              
      *  -------- ---------- ---- ------------------------------ *              
      *  BP132653 17/02/2005 CG7  NEW PROGRAM.                   *              
      *  BP132684 22/04/2005 SD10 TO READ BP13K820 TO GET OCCP   *              
      *                           DETAILS                        *              
      *                                                          *              
      ************************************************************              
                                                                                
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F800     ASSIGN        TO BP13F800.                       
                                                                                
           SELECT BP13K820     ASSIGN        TO BP13K820                        
                               ACCESS MODE   IS DYNAMIC                         
                               ORGANIZATION  IS INDEXED                         
                               RECORD KEY    IS K820-KEY-FLD                    
                               FILE STATUS   IS WS-K820-STATUS.                 
                                                                                
           SELECT P13L175A     ASSIGN        TO P13L175A.                       
                                                                                
           SELECT P13L175B     ASSIGN        TO P13L175B.                       
                                                                                
           SELECT P13L175C     ASSIGN        TO P13L175C.                       
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F800                                                             
                               BLOCK CONTAINS 0 RECORDS                         
                               RECORD CONTAINS 2000 CHARACTERS                  
                               RECORDING MODE IS F                              
                               LABEL RECORD IS STANDARD.                        
       COPY BP13F800.                                                           
                                                                                
       FD  BP13K820            RECORD CONTAINS 400 CHARACTERS.                  
       COPY BP13K820.                                                           
                                                                                
       FD  P13L175A                                                             
                               BLOCK CONTAINS 0 RECORDS                         
                               RECORD CONTAINS 132 CHARACTERS                   
                               RECORDING MODE IS F                              
                               LABEL RECORD IS STANDARD.                        
       01  P13L175A-REC                  PIC X(132).                            
                                                                                
       FD  P13L175B                                                             
                               BLOCK CONTAINS 0 RECORDS                         
                               RECORD CONTAINS 132 CHARACTERS                   
                               RECORDING MODE IS F                              
                               LABEL RECORD IS STANDARD.                        
       01  P13L175B-REC                  PIC X(132).                            
                                                                                
       FD  P13L175C                                                             
                               BLOCK CONTAINS 0 RECORDS                         
                               RECORD CONTAINS 132 CHARACTERS                   
                               RECORDING MODE IS F                              
                               LABEL RECORD IS STANDARD.                        
       01  P13L175C-REC                  PIC X(132).                            
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-REPORT1-HEADER1.                                                  
           05  FILLER                    PIC X(8)  VALUE 'P13L175A'.            
           05  FILLER                    PIC X(35) VALUE SPACES.                
           05  FILLER                    PIC X(37) VALUE                        
               'S Y S T E M  O F  C O M M I T M E N T'.                         
           05  FILLER                    PIC X(35) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.             
           05  RPT1-HDR-DATE             PIC X(10) VALUE SPACES.                
                                                                                
       01  WS-REPORT1-HEADER2.                                                  
           05  FILLER                    PIC X(45) VALUE SPACES.                
           05  FILLER                    PIC X(32) VALUE                        
               'REPORT FOR SUCCESSFUL APPLICANTS'.                              
           05  FILLER                    PIC X(38) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.             
           05  WS-RPT1-PAGE              PIC ZZZ9.                              
           05  FILLER                    PIC X(6)  VALUE SPACES.                
                                                                                
       01  WS-REPORT1-HEADER3.                                                  
           05  FILLER                    PIC X(48) VALUE SPACES.                
           05  FILLER                    PIC X(27) VALUE                        
               '(HOUSE HOLD INCOME <= 2000)'.                                   
           05  FILLER                    PIC X(31) VALUE SPACES.                
                                                                                
       01  WS-REPORT2-HEADER1.                                                  
           05  FILLER                    PIC X(8)  VALUE 'P13L175B'.            
           05  FILLER                    PIC X(35) VALUE SPACES.                
           05  FILLER                    PIC X(37) VALUE                        
               'S Y S T E M  O F  C O M M I T M E N T'.                         
           05  FILLER                    PIC X(9)  VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.             
           05  RPT2-HDR-DATE             PIC X(10) VALUE SPACES.                
                                                                                
       01  WS-REPORT2-HEADER2.                                                  
           05  FILLER                    PIC X(45) VALUE SPACES.                
           05  FILLER                    PIC X(32) VALUE                        
               'REPORT FOR SUCCESSFUL APPLICANTS'.                              
           05  FILLER                    PIC X(12) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.             
           05  WS-RPT2-PAGE              PIC ZZZ9.                              
           05  FILLER                    PIC X(6)  VALUE SPACES.                
                                                                                
       01  WS-REPORT2-HEADER3.                                                  
           05  FILLER                    PIC X(52) VALUE SPACES.                
           05  FILLER                    PIC X(18) VALUE                        
               '(IDP SCHEME = LRT)'.                                            
           05  FILLER                    PIC X(36) VALUE SPACES.                
                                                                                
       01  WS-REPORT3-HEADER1.                                                  
           05  FILLER                    PIC X(8)  VALUE 'P13L175C'.            
           05  FILLER                    PIC X(35) VALUE SPACES.                
           05  FILLER                    PIC X(37) VALUE                        
               'S Y S T E M  O F  C O M M I T M E N T'.                         
           05  FILLER                    PIC X(9)  VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.             
           05  RPT3-HDR-DATE             PIC X(10) VALUE SPACES.                
                                                                                
       01  WS-REPORT3-HEADER2.                                                  
           05  FILLER                    PIC X(45) VALUE SPACES.                
           05  FILLER                    PIC X(32) VALUE                        
               'REPORT FOR SUCCESSFUL APPLICANTS'.                              
           05  FILLER                    PIC X(12) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.             
           05  WS-RPT3-PAGE              PIC ZZZ9.                              
           05  FILLER                    PIC X(6)  VALUE SPACES.                
                                                                                
       01  WS-REPORT3-HEADER3.                                                  
           05  FILLER                    PIC X(54) VALUE SPACES.                
           05  FILLER                    PIC X(14) VALUE                        
               '(HALF IDP = S)'.                                                
           05  FILLER                    PIC X(38) VALUE SPACES.                
                                                                                
       01  WS-REPORT-DETAIL1.                                                   
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'S/N'.                 
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  FILLER                    PIC X(3)  VALUE 'NEW'.                 
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'FLAT'.                
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  FILLER                    PIC X(8)  VALUE 'REGN NO.'.            
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  FILLER                    PIC X(5)  VALUE 'ALLOC'.               
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(3)  VALUE 'IDP'.                 
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(8)  VALUE 'HALF-IDP'.            
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(3)  VALUE 'AGE'.                 
           05  FILLER                    PIC X(5)  VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'NRIC'.                
           05  FILLER                    PIC X(18) VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'NAME'.                
           05  FILLER                    PIC X(27) VALUE SPACES.                
           05  FILLER                    PIC X(3)  VALUE 'DOB'.                 
                                                                                
       01  WS-REPORT-DETAIL2.                                                   
           05  FILLER                    PIC X(11) VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'TOWN'.                
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'TYPE'.                
           05  FILLER                    PIC X(15) VALUE SPACES.                
           05  FILLER                    PIC X(6)  VALUE 'SCHEME'.              
           05  FILLER                    PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X(6)  VALUE 'SCHEME'.              
           05  FILLER                    PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X(6)  VALUE 'SCHEME'.              
                                                                                
       01  WS-REPORT-DATA.                                                      
           05  FILLER                    PIC X(2)  VALUE SPACES.                
           05  WS-SNO                    PIC ZZZZ9.                             
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  WS-NEW-TOWN               PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(5)  VALUE SPACES.                
           05  WS-FLAT-TYPE              PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X(5)  VALUE SPACES.                
           05  WS-REGN-NO                PIC X(8)  VALUE SPACES.                
           05  FILLER                    PIC X(5)  VALUE SPACES.                
           05  WS-ALLOC-SCH              PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(5)  VALUE SPACES.                
           05  WS-IDP-SCH                PIC X(3)  VALUE SPACES.                
           05  FILLER                    PIC X(5)  VALUE SPACES.                
           05  WS-HALF-IDP               PIC X(1)  VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE SPACES.                
           05  WS-OCCP-AGE               PIC ZZ9.                               
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  WS-OCCP-NRIC1             PIC X(9)  VALUE SPACES.                
           05  FILLER                    PIC X(2)  VALUE SPACES.                
           05  WS-OCCP-NAME1             PIC X(38) VALUE SPACES.                
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  WS-OCCP-DOB1              PIC X(10) VALUE SPACES.                
                                                                                
       01  WS-REPORT-DATA-2.                                                    
           05  FILLER                    PIC X(69) VALUE SPACES.                
           05  WS-OCCP-NRIC2             PIC X(9)  VALUE SPACES.                
           05  FILLER                    PIC X(2)  VALUE SPACES.                
           05  WS-OCCP-NAME2             PIC X(38) VALUE SPACES.                
           05  FILLER                    PIC X(3)  VALUE SPACES.                
           05  WS-OCCP-DOB2              PIC X(10) VALUE SPACES.                
                                                                                
       01  WS-BLANK-LINE                 PIC X(80) VALUE SPACES.                
                                                                                
       01  END-OF-FILE-FLAGS.                                                   
           05  WS-F800-EOF               PIC X     VALUE 'N'.                   
           05  WS-K820-EOF               PIC X     VALUE 'N'.                   
                                                                                
       01  FILE-STATUS.                                                         
           05  WS-K820-STATUS            PIC 9(2)  VALUE ZEROES.                
                                                                                
       01  COUNTERS.                                                            
           05  WS-F800-READ-CNT          PIC 9(6)  VALUE ZEROES.                
           05  WS-K820-READ-CNT          PIC 9(6)  VALUE ZEROES.                
           05  WS-K820-NOTFND-CTR        PIC 9(6)  VALUE ZEROES.                
           05  WS-175A-PAGE-CNT          PIC 9(4)  VALUE ZEROES.                
           05  WS-175B-PAGE-CNT          PIC 9(4)  VALUE ZEROES.                
           05  WS-175C-PAGE-CNT          PIC 9(4)  VALUE ZEROES.                
           05  WS-175A-LINE-CNT          PIC 9(6)  VALUE ZEROES.                
           05  WS-175B-LINE-CNT          PIC 9(6)  VALUE ZEROES.                
           05  WS-175C-LINE-CNT          PIC 9(6)  VALUE ZEROES.                
           05  WS-175A-WRITE-CNT         PIC 9(6)  VALUE ZEROES.                
           05  WS-175B-WRITE-CNT         PIC 9(6)  VALUE ZEROES.                
           05  WS-175C-WRITE-CNT         PIC 9(6)  VALUE ZEROES.                
                                                                                
       01  DATE-VARIABLES.                                                      
           05  WS-CURRENT-DATE.                                                 
               10  WS-CURRENT-DATE1          PIC X(8) VALUE SPACES.             
               10  WS-CURRENT-TIME           PIC X(9) VALUE SPACES.             
               10  WS-TIME REDEFINES WS-CURRENT-TIME.                           
                   15  WS-HHMMSSMS           PIC X(8).                          
                   15  WS-GM                 PIC X(1).                          
               10  FILLER                    PIC X(4) VALUE SPACES.             
                                                                                
           05  WS-CURR-DATE2                 PIC 9(08).                         
           05  WS-CURR-DATE-R REDEFINES WS-CURR-DATE2.                          
               10  WS-CCYY2                  PIC 9(4).                          
               10  WS-MMDD2.                                                    
                   15  WS-MM2                PIC 9(2).                          
                   15  WS-DD2                PIC 9(2).                          
                                                                                
       01  AGE-VARIABLES.                                                       
           05  WS-DTE-BIRTH.                                                    
               10  WS-DOB-CCYY           PIC 9(4)  VALUE ZEROES.                
               10  WS-DOB-MM             PIC 9(2)  VALUE ZEROES.                
               10  WS-DOB-DD             PIC 9(2)  VALUE ZEROES.                
           05  WS-AGE                    PIC 9(3)  VALUE ZEROES.                
           05  WS-DOB1                   PIC 9(8)  VALUE ZEROES.                
           05  WS-DOB2                   PIC 9(8)  VALUE ZEROES.                
           05  WS-CUR-CCYY               PIC 9(04) VALUE ZEROES.                
           05  WS-YNGST-DOB-NUM          PIC 9(8).                              
           05  WS-YNGST-DOB REDEFINES WS-YNGST-DOB-NUM.                         
               10  WS-YNGST-CCYY         PIC 9(4).                              
               10  WS-YNGST-MMDD         PIC 9(4).                              
                                                                                
       01  TEMPORARY-VARIABLES.                                                 
           05  WS-RUN-DATE               PIC X(10) VALUE SPACES.                
           05  WS-L175A-SNO              PIC 9(04) VALUE ZEROES.                
           05  WS-L175B-SNO              PIC 9(04) VALUE ZEROES.                
           05  WS-L175C-SNO              PIC 9(04) VALUE ZEROES.                
           05  WS-OCCP-NAME              PIC X(30) VALUE ZEROES.                
                                                                                
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *************************************************************             
       0000-MAIN.                                                               
      *************************************************************             
           PERFORM 1000-OPEN-ROUTINE THRU 1000-EXIT.                            
           PERFORM 2000-PROCESS-RECORDS THRU 2000-EXIT                          
             UNTIL WS-F800-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *************************************************************             
       1000-OPEN-ROUTINE.                                                       
      *************************************************************             
           OPEN INPUT  BP13F800                                                 
                       BP13K820                                                 
                OUTPUT P13L175A                                                 
                       P13L175B                                                 
                       P13L175C.                                                
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPEN ERROR, WS-K820-STATUS ' WS-K820-STATUS              
              MOVE WS-K820-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE    TO WS-CURRENT-DATE.                    
           MOVE WS-CURRENT-DATE1         TO WS-CURR-DATE2.                      
                                                                                
           STRING WS-CURRENT-DATE1(7:2) '/'                                     
                  WS-CURRENT-DATE1(5:2) '/'                                     
                  WS-CURRENT-DATE1(1:4)                                         
                  DELIMITED BY SIZE                                             
             INTO WS-RUN-DATE                                                   
                                                                                
           MOVE WS-RUN-DATE              TO RPT1-HDR-DATE                       
                                            RPT2-HDR-DATE                       
                                            RPT3-HDR-DATE.                      
                                                                                
           PERFORM 1100-READ-BP13F800 THRU 1100-EXIT.                           
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       1100-READ-BP13F800.                                                      
      *************************************************************             
           READ BP13F800                                                        
             AT END                                                             
                MOVE 'Y'                 TO WS-F800-EOF                         
                MOVE HIGH-VALUES         TO F800-NUM-REGN                       
            NOT AT END                                                          
                ADD 1                    TO WS-F800-READ-CNT                    
           END-READ.                                                            
                                                                                
       1100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       2000-PROCESS-RECORDS.                                                    
      *************************************************************             
           MOVE SPACES                   TO WS-REPORT-DATA                      
                                            WS-REPORT-DATA-2.                   
           INITIALIZE                       WS-REPORT-DATA                      
                                            WS-REPORT-DATA-2                    
                                            WS-K820-EOF.                        
                                                                                
           MOVE F800-NUM-NEW-TOWN        TO WS-NEW-TOWN.                        
           MOVE F800-NUM-FLAT-TYPE       TO WS-FLAT-TYPE.                       
           MOVE F800-NUM-REGN            TO WS-REGN-NO.                         
           MOVE F800-NUM-ALLO-SCHEME     TO WS-ALLOC-SCH.                       
           MOVE F800-NUM-IDP-SCHEME      TO WS-IDP-SCH.                         
           MOVE F800-NUM-HALF-IDP        TO WS-HALF-IDP.                        
                                                                                
           IF F800-AMT-HSE-INCOME NOT NUMERIC                                   
              MOVE ZEROES TO F800-AMT-HSE-INCOME                                
           END-IF.                                                              
                                                                                
           PERFORM 2100-START-BP13K820   THRU 2100-EXIT.                        
                                                                                
           IF F800-AMT-HSE-INCOME <= 2000                                       
              PERFORM 3000-PRINT-REPORT1 THRU 3000-EXIT                         
           END-IF.                                                              
                                                                                
           IF F800-NUM-IDP-SCHEME = 'LRT'                                       
              PERFORM 4000-PRINT-REPORT2 THRU 4000-EXIT                         
           END-IF.                                                              
                                                                                
           IF F800-NUM-HALF-IDP = 'S'                                           
              PERFORM 5000-PRINT-REPORT3 THRU 5000-EXIT                         
           END-IF.                                                              
                                                                                
           PERFORM 1100-READ-BP13F800 THRU 1100-EXIT.                           
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       2100-START-BP13K820.                                                     
      *************************************************************             
                                                                                
           MOVE SPACES                        TO K820-KEY-FLD.                  
           MOVE F800-NUM-REGN                 TO K820-NUM-REGN.                 
                                                                                
           START BP13K820 KEY >=  K820-KEY-FLD.                                 
                                                                                
           IF WS-K820-STATUS = 00                                               
              PERFORM 2200-READ-BP13K820 THRU 2200-EXIT                         
                UNTIL K820-NUM-REGN NOT = F800-NUM-REGN OR                      
                      WS-K820-EOF = 'Y'                                         
           ELSE                                                                 
              IF WS-K820-STATUS = 23                                            
                 MOVE 'Y'                TO WS-K820-EOF                         
                 DISPLAY 'RECORD NOTFND IN BP13K820: ' K820-NUM-REGN            
                 ADD 1                   TO WS-K820-NOTFND-CTR                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
       2100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       2200-READ-BP13K820.                                                      
      *************************************************************             
                                                                                
           READ BP13K820 NEXT                                                   
             AT END                                                             
                MOVE 'Y'                 TO WS-K820-EOF                         
                MOVE HIGH-VALUES         TO K820-NUM-REGN                       
           END-READ.                                                            
                                                                                
           IF K820-NUM-REGN = F800-NUM-REGN                                     
              PERFORM 2300-GET-OCCP-DETAILS THRU 2300-EXIT                      
              ADD 1                   TO WS-K820-READ-CNT                       
           ELSE                                                                 
              MOVE 'Y'                TO WS-K820-EOF                            
           END-IF.                                                              
                                                                                
       2200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       2300-GET-OCCP-DETAILS.                                                   
      *************************************************************             
                                                                                
           IF K820-NUM-RELATIONSHIP = '00'                                      
              MOVE K820-NUM-NRIC     TO WS-OCCP-NRIC1                           
              MOVE K820-NME-OCCP     TO WS-OCCP-NAME                            
              STRING WS-OCCP-NAME '(MAIN)'                                      
                     DELIMITED BY SIZE                                          
                INTO WS-OCCP-NAME1                                              
              MOVE K820-DTE-BIRTH    TO WS-DOB1                                 
              STRING K820-DTE-BIRTH(7:2) '/'                                    
                     K820-DTE-BIRTH(5:2) '/'                                    
                     K820-DTE-BIRTH(1:4)                                        
                     DELIMITED BY SIZE                                          
                INTO WS-OCCP-DOB1                                               
           END-IF.                                                              
                                                                                
           IF K820-NUM-RELATIONSHIP = '20' OR '09'                              
              MOVE K820-NUM-NRIC     TO WS-OCCP-NRIC2                           
              MOVE K820-NME-OCCP     TO WS-OCCP-NAME                            
              STRING WS-OCCP-NAME '(SPOUSE)'                                    
                     DELIMITED BY SIZE                                          
                INTO WS-OCCP-NAME2                                              
              MOVE K820-DTE-BIRTH    TO WS-DOB2                                 
              STRING K820-DTE-BIRTH(7:2) '/'                                    
                     K820-DTE-BIRTH(5:2) '/'                                    
                     K820-DTE-BIRTH(1:4)                                        
                     DELIMITED BY SIZE                                          
                INTO WS-OCCP-DOB2                                               
           END-IF.                                                              
                                                                                
           PERFORM 2400-GET-YOUNGEST-AGE THRU 2400-EXIT.                        
                                                                                
       2300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       2400-GET-YOUNGEST-AGE.                                                   
      *************************************************************             
                                                                                
           IF WS-DOB1 = SPACES OR LOW-VALUES OR ZERO                            
              MOVE '00000000'        TO WS-DOB1                                 
           END-IF.                                                              
                                                                                
           IF WS-DOB2 = SPACES OR LOW-VALUES OR ZERO                            
              MOVE '00000000'        TO WS-DOB2                                 
           END-IF.                                                              
                                                                                
           MOVE  ZERO                TO WS-YNGST-DOB-NUM.                       
                                                                                
           IF (WS-DOB1 NOT = '00000000') AND                                    
              (WS-DOB1 > WS-DOB2)                                               
               COMPUTE WS-YNGST-DOB-NUM = WS-DOB1                               
           ELSE                                                                 
               IF (WS-DOB2 NOT = '00000000') AND                                
                  (WS-DOB2 > WS-DOB1)                                           
                   COMPUTE WS-YNGST-DOB-NUM = WS-DOB2                           
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE ZERO                TO WS-AGE.                                  
           COMPUTE WS-AGE = WS-CCYY2 - WS-YNGST-CCYY.                           
           IF WS-MMDD2 < WS-YNGST-MMDD                                          
              COMPUTE WS-AGE = WS-AGE - 1                                       
           END-IF.                                                              
                                                                                
           MOVE WS-AGE              TO WS-OCCP-AGE.                             
                                                                                
       2400-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       3000-PRINT-REPORT1.                                                      
      *************************************************************             
           IF WS-175A-LINE-CNT > 80 OR                                          
              WS-175A-LINE-CNT = 0                                              
              ADD 1                 TO WS-175A-PAGE-CNT                         
              MOVE WS-175A-PAGE-CNT TO WS-RPT1-PAGE                             
                                                                                
              WRITE P13L175A-REC    FROM WS-REPORT1-HEADER1 AFTER PAGE          
              WRITE P13L175A-REC    FROM WS-REPORT1-HEADER2 AFTER 1             
              WRITE P13L175A-REC    FROM WS-REPORT1-HEADER3 AFTER 1             
              WRITE P13L175A-REC    FROM WS-BLANK-LINE AFTER 1                  
              WRITE P13L175A-REC    FROM WS-REPORT-DETAIL1 AFTER 1              
              WRITE P13L175A-REC    FROM WS-REPORT-DETAIL2 AFTER 1              
              WRITE P13L175A-REC    FROM WS-BLANK-LINE AFTER 1                  
                                                                                
              MOVE 7                TO WS-175A-LINE-CNT                         
           ELSE                                                                 
              ADD 1                 TO WS-L175A-SNO                             
              MOVE WS-L175A-SNO     TO WS-SNO                                   
              WRITE P13L175A-REC    FROM WS-REPORT-DATA   AFTER 1               
                                                                                
              ADD 1                 TO WS-175A-LINE-CNT                         
                                       WS-175A-WRITE-CNT                        
                                                                                
              IF WS-REPORT-DATA-2 NOT = SPACES                                  
                 WRITE P13L175A-REC    FROM WS-REPORT-DATA-2 AFTER 1            
                 ADD 1                 TO WS-175A-LINE-CNT                      
                                          WS-175A-WRITE-CNT                     
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       4000-PRINT-REPORT2.                                                      
      *************************************************************             
           IF WS-175B-LINE-CNT > 80 OR                                          
              WS-175B-LINE-CNT = 0                                              
              ADD 1                 TO WS-175B-PAGE-CNT                         
              MOVE WS-175B-PAGE-CNT TO WS-RPT2-PAGE                             
                                                                                
              WRITE P13L175B-REC    FROM WS-REPORT2-HEADER1 AFTER PAGE          
              WRITE P13L175B-REC    FROM WS-REPORT2-HEADER2 AFTER 1             
              WRITE P13L175B-REC    FROM WS-REPORT2-HEADER3 AFTER 1             
              WRITE P13L175B-REC    FROM WS-BLANK-LINE AFTER 1                  
              WRITE P13L175B-REC    FROM WS-REPORT-DETAIL1 AFTER 1              
              WRITE P13L175B-REC    FROM WS-REPORT-DETAIL2 AFTER 1              
              WRITE P13L175B-REC    FROM WS-BLANK-LINE AFTER 1                  
                                                                                
              MOVE 7                TO WS-175B-LINE-CNT                         
           ELSE                                                                 
              ADD 1                 TO WS-L175B-SNO                             
              MOVE WS-L175B-SNO     TO WS-SNO                                   
              WRITE P13L175B-REC    FROM WS-REPORT-DATA   AFTER 1               
                                                                                
              ADD 1                 TO WS-175B-LINE-CNT                         
                                       WS-175B-WRITE-CNT                        
                                                                                
              IF WS-REPORT-DATA-2 NOT = SPACES                                  
                 WRITE P13L175B-REC    FROM WS-REPORT-DATA-2 AFTER 1            
                 ADD 1                 TO WS-175B-LINE-CNT                      
                                          WS-175B-WRITE-CNT                     
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       5000-PRINT-REPORT3.                                                      
      *************************************************************             
           IF WS-175C-LINE-CNT > 80 OR                                          
              WS-175C-LINE-CNT = 0                                              
              ADD 1                 TO WS-175C-PAGE-CNT                         
              MOVE WS-175C-PAGE-CNT TO WS-RPT3-PAGE                             
                                                                                
              WRITE P13L175C-REC    FROM WS-REPORT3-HEADER1 AFTER PAGE          
              WRITE P13L175C-REC    FROM WS-REPORT3-HEADER2 AFTER 1             
              WRITE P13L175C-REC    FROM WS-REPORT3-HEADER3 AFTER 1             
              WRITE P13L175C-REC    FROM WS-BLANK-LINE AFTER 1                  
              WRITE P13L175C-REC    FROM WS-REPORT-DETAIL1 AFTER 1              
              WRITE P13L175C-REC    FROM WS-REPORT-DETAIL2 AFTER 1              
              WRITE P13L175C-REC    FROM WS-BLANK-LINE AFTER 1                  
                                                                                
              MOVE 7                TO WS-175C-LINE-CNT                         
           ELSE                                                                 
              ADD 1                 TO WS-L175C-SNO                             
              MOVE WS-L175C-SNO     TO WS-SNO                                   
              WRITE P13L175C-REC    FROM WS-REPORT-DATA   AFTER 1               
                                                                                
              ADD 1                 TO WS-175C-LINE-CNT                         
                                       WS-175C-WRITE-CNT                        
                                                                                
              IF WS-REPORT-DATA-2 NOT = SPACES                                  
                 WRITE P13L175C-REC    FROM WS-REPORT-DATA-2 AFTER 1            
                 ADD 1                 TO WS-175C-LINE-CNT                      
                                          WS-175C-WRITE-CNT                     
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       9000-CLOSE-ROUTINE.                                                      
      *************************************************************             
           DISPLAY '   '.                                                       
           DISPLAY 'RUN DATE : ' WS-RUN-DATE.                                   
           DISPLAY '*--------- BP13C175 CONTROL TOTAL ---------*'.              
           DISPLAY '   '.                                                       
           DISPLAY 'NO. OF READS FROM F800   : ' WS-F800-READ-CNT.              
           DISPLAY 'NO. OF READS FROM K820   : ' WS-K820-READ-CNT.              
           DISPLAY 'RECS WRITTEN TO P13L175A : ' WS-175A-WRITE-CNT.             
           DISPLAY 'RECS WRITTEN TO P13L175B : ' WS-175B-WRITE-CNT.             
           DISPLAY 'RECS WRITTEN TO P13L175C : ' WS-175C-WRITE-CNT.             
           DISPLAY '  '.                                                        
                                                                                
           CLOSE BP13F800                                                       
                 BP13K820                                                       
                 P13L175A                                                       
                 P13L175B                                                       
                 P13L175C.                                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
