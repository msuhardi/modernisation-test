       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    BP13CS06.                                         00020000
       AUTHOR.        PAULO CAMIA LEGASPI.                              00030000
      *DATE-WRITTEN.  01/06/2010.                                       00040000
                                                                        00050000
      *************************************************************     00060000
      *      SYSTEM OF COMMITMENT (BP13)                          *     00070000
      *===========================================================*     00080000
      *                                                           *     00090000
      *  OBJECTIVES: 1. TO NOTIFY APPLICANTS THRU EMAIL OF THE    *     00100000
      *                 RESULTS OF THE BALLOT AND THEIR SCHEDULED *     00110000
      *                 APPOINTMENT TO BOOK FLAT.                 *     00120000
      *              2. PROGRAM TO PUT MQ MESSAGE INTO QUEUE      *     00130000
      *                 WHICH CONTAINS CUSTOMER'S EMAIL ADDRESS,  *     00140000
      *                 QUEUE NO., APPT DATE/TIME TO BE SENT BY   *     00150000
      *                 THE JAVA INTERFACE.                       *     00160000
      *                                                           *     00170000
      *   PROGRAM LOGIC:                                          *     00180000
      *         PROCESS INPUT FILES                               *     00190000
      *         MQCONNECT TO QUEUE MANAGER                        *     00200000
      *         MQOPEN QUEUE                                      *     00210000
      *         MQPUT                                             *     00220000
      *         MQCLOSE QUEUE                                     *     00230000
      *         MQDISCONNECT FROM QUEUE MANAGER                   *     00240000
      *                                                           *     00250000
      *===========================================================*     00260000
      * MODIFICATIONS :                                           *     00270000
      *                                                           *     00280000
      * CHG REQ#    DATE    AUTHOR REMARKS                        *     00290000
      * -------- ---------- ------ ------------------------------ *     00300000
      * BP133920 01/06/2010  PCL3  NEW PROGRAM                    *     00310000
      * BP133950 24/08/2010  PCL3  TO ADD QUEUE-GRO AND NUM-WARD. *     00320000
      * BP134070 22/11/2010  CT2   TO ADD NUM-UNIT-OFFER          *     00330000
      * BP134481 16/04/2012  CT2   TO ADD E1/M1-M8 FOR EIP/MGPS   *     00340000
      * BP134553 07/06/2012  ESA1  TO CATER FOR MGPS              *     00350000
      * BP134900 06/06/2012  CT2   TO CATER FOR T1 TO T4, C1 TO C4*     00360000
      *                            EMAIL MSG.  TO CATER FOR NEW   *     00370000
      *                            FIELD LAUNCH-TXT.              *     00380000
      * BP135121 26/10/2013  CT2   TO CATER FOR B6 EMAIL MESSAGE  *     00390000
      * BP135607 28/01/2015  CT2   TO CATER FOR C5 EMAIL MESSAGE  *     00400000
      * BP136138 20/02/2016  CT2   TO CATER FOR I6 TO I9 EMAILS   *     00410000
      * BP136922 10/08/2017  ZDD1  TO CATER FOR R1 AND R2         *     00420000
      * BP137161 25/01/2018  ZDD1  TO CATER FOR SL                *     00430000
      * BP137570 14/11/2018  ZDD1  TO CATER FOR R3(SURVEY LETTER) *     00440000
      * BP138154 02/03/2020  CT2   TO CATER FOR UNSUCSS MGPS      *     00450000
      * BP138787 21/06/2021  PP11  TO CATER FOR APPMT TYPE BK     *     00460000
      * BP138814 13/07/2021  PP11  TO CATER FOR APPMT TYPE TP     *     00470000
      * BP139348 27/09/2022  PP11  TO CATER FOR APPMT TYPE BT     *     00471001
      * BP139549 27/04/2023  PP11  TO CATER FOR APPMT TYPE H2 AND H3    00472002
      * BP139663 13/07/2023  MRR5  TO CATER FOR APPMT TYPE L7/L8/L9     00473002
      * BP139776 20/10/2023  MRR5  TO CATER FOR APPMT TYPE LA/LB  *     00474002
      * BP139863 09/01/2024  EFAQ1 TO ADD E9 IN F23A-TYPE-APPMT   *     00475002
      * BP139960 20/03/2024  CT2   TO ADD LC LD IN F23A-TYPE-APPMT*     00476002
      *************************************************************     00480000
                                                                        00490000
       ENVIRONMENT DIVISION.                                            00500000
       CONFIGURATION SECTION.                                           00510000
       SOURCE-COMPUTER. IBM-3090.                                       00520000
       OBJECT-COMPUTER. IBM-3090.                                       00530000
       SPECIAL-NAMES.                                                   00540000
           SYSIN IS PARM-INPUT.                                         00550000
                                                                        00560000
       INPUT-OUTPUT SECTION.                                            00570000
       FILE-CONTROL.                                                    00580000
      *                                                                 00590000
           SELECT BP13F23A ASSIGN TO BP13F23A                           00600000
                  ORGANIZATION    IS SEQUENTIAL                         00610000
                  FILE STATUS     IS BP13F23A-STAT.                     00620000
                                                                        00630000
       DATA DIVISION.                                                   00640000
       FILE SECTION.                                                    00650000
                                                                        00660000
       FD  BP13F23A                                                     00670000
           RECORD CONTAINS 200 CHARACTERS                               00680000
           RECORDING MODE IS F.                                         00690000
       COPY BP13F23A.                                                   00700000
                                                                        00710000
       WORKING-STORAGE SECTION.                                         00720000
                                                                        00730000
      *----------------------------------------------------------*      00740000
      *  IMPORTANT!                                              *      00750000
      *  FOR PRODUCTION, QUEUE MANAGER IS 'MQP1'                 *      00760000
      *  FOR TESTING,    QUEUE MANAGER IS 'MQT1'                 *      00770000
      *----------------------------------------------------------*      00780000
       01  WS-QM-NAME               PIC X(48) VALUE 'MQP1'.             00790004
      *01  WS-QM-NAME               PIC X(48) VALUE 'MQT1'.             00800004
       01  WS-BP13Q-NAME            PIC X(48) VALUE SPACES.             00810000
                                                                        00820000
      *----------------------------------------------------------*      00830000
      *  OUTPUT QUEUE NAME TO CRIMSONLOGIC                       *      00840000
      *  FOR PROD, QUEUE NAME IS BP13.WIS.MDB.REQUESTQ           *      00850000
      *  FOR TESTING, QUEUE NAME IS BP13S.WIS.MDB.REQUESTQ       *      00860000
      *----------------------------------------------------------*      00870000
       01  WS-QUEUE-NAME   PIC X(48) VALUE 'BP13.WIS.MDB.REQUESTQ'.     00880004
      *01  WS-QUEUE-NAME   PIC X(48) VALUE 'BP13S.WIS.MDB.REQUESTQ'.    00890004
      *01  WS-QUEUE-NAME   PIC X(48) VALUE 'BP13T.WIS.MDB.REQUESTQ'.    00900000
                                                                        00910000
      *----------------------------------------------------------*      00920000
      *  MESSAGE LENGTH                                          *      00930000
      *----------------------------------------------------------*      00940000
       01  WS-MESSAGE-LENGTH        PIC 9(06) VALUE 368012.             00950000
                                                                        00960000
      *----------------------------------------------------------*      00970000
      *  MESSAGE                                                 *      00980000
      *----------------------------------------------------------*      00990000
       01  WS-SEND-MESSAGE.                                             01000000
           05  WS-MSG-CDE                   PIC X(03).                  01010000
           05  WS-FILLER-01                 PIC X(01).                  01020000
           05  WS-MSG-APPT-TYP              PIC X(02).                  01030000
           05  WS-FILLER-02                 PIC X(01).                  01040000
           05  WS-MSG-CTR                   PIC 9(04).                  01050000
           05  WS-FILLER-03                 PIC X(01).                  01060000
           05  WS-MSG OCCURS 2000 TIMES.                                01070000
               10  WS-MSG-EMAIL             PIC X(50).                  01080000
               10  WS-FILLER-04             PIC X(01).                  01090000
               10  WS-DTE-BALLOT            PIC X(06).                  01100000
               10  WS-FILLER-05             PIC X(01).                  01110000
               10  WS-MSG-FLAT-TYPE         PIC X(02).                  01120000
               10  WS-FILLER-06             PIC X(01).                  01130000
               10  WS-MSG-QUEUE-NO          PIC X(05).                  01140000
               10  WS-FILLER-07             PIC X(01).                  01150000
               10  WS-PROJ-NAME             PIC X(30).                  01160000
               10  WS-FILLER-08             PIC X(01).                  01170000
               10  WS-SEL-PERIOD            PIC X(20).                  01180000
               10  WS-FILLER-09             PIC X(01).                  01190000
               10  WS-MSG-REGN              PIC X(08).                  01200000
               10  WS-FILLER-10             PIC X(01).                  01210000
               10  WS-MSG-QUEUE-GRO         PIC X(05).                  01220000
               10  WS-FILLER-11             PIC X(01).                  01230000
               10  WS-MSG-WARD              PIC X(25).                  01240000
               10  WS-FILLER-12             PIC X(01).                  01250000
               10  WS-NUM-UNIT-OFFER        PIC X(04).                  01260000
               10  WS-FILLER-13             PIC X(01).                  01270000
               10  WS-MSG-FLAT-TYPE-P       PIC X(02).                  01280000
               10  WS-FILLER-14             PIC X(01).                  01290000
               10  WS-MSG-FLAT-TYPE-C       PIC X(02).                  01300000
               10  WS-FILLER-15             PIC X(01).                  01310000
               10  WS-MSG-ME-TAG            PIC X(01).                  01320000
               10  WS-FILLER-16             PIC X(01).                  01330000
               10  WS-MSG-LAUNCH-TXT        PIC X(10).                  01340000
               10  WS-FILLER-17             PIC X(01).                  01350000
                                                                        01360000
      *----------------------------------------------------------*      01370000
      *  OTHER VARIABLES                                         *      01380000
      *----------------------------------------------------------*      01390000
       01  WS-VARIABLES.                                                01400000
           05  WS-CTR               PIC 9(04).                          01410000
           05  WS-START             PIC 9(03).                          01420000
           05  WS-F23A-READ         PIC 9(05).                          01430000
                                                                        01440000
      *-------------------------------------------------------------    01450000
      *  MQI - TEMPORARY VARIABLES FOR ERROR CODES                      01460000
      *-------------------------------------------------------------    01470000
       01  BP13CS06-REC.                                                01480000
           05 CS06-REASON          PIC 9(4).                            01490000
           05 CS06-COMPLETION-CODE PIC 9(4).                            01500000
           05 CS06-ERR-MSG         PIC X(66).                           01510000
           05 FILLER               PIC X(27).                           01520000
                                                                        01530000
                                                                        01540000
      *----------------------------------------------------------*      01550000
      *              MQI STRUCTURE DECLARATION                   *      01560000
      *----------------------------------------------------------*      01570000
       01 MY-MQ-CONSTANTS.                                              01580000
          COPY CMQV.                                                    01590000
                                                                        01600000
       01 OBJECT-DESCRIPTOR.                                            01610000
          COPY CMQODV.                                                  01620000
                                                                        01630000
       01 MESSAGE-DESCRIPTOR.                                           01640000
          COPY CMQMDV.                                                  01650000
                                                                        01660000
      * PUT MESSAGE OPTIONS                                             01670000
       01 PMOPTIONS.                                                    01680000
          COPY CMQPMOV.                                                 01690000
                                                                        01700000
      *----------------------------------------------------------*      01710000
      * VARIABLE DESCRIPTION:                                    *      01720000
      * (1) HCONN                                                *      01730000
      *       - CONNECTION HANDLE - REPRESENTS THE CONNECTION TO *      01740000
      *         THE QUEUE MANAGER. VALUE IS RETURNED BY MQCONN   *      01750000
      *         AND SUBSEQUENTLY REFERENCED IN MQOPEN, MQPUT,    *      01760000
      *         MQCLOSE AND MQDISC                               *      01770000
      *                                                          *      01780000
      * (2) Q-HANDLE                                             *      01790000
      *       - ACCESS THAT HAS BEEN ESTABLISHED  TO THE OBJECT  *      01800000
      *         CONNECTION HANDLE - VALUE IS RETURNED BY MQOPEN  *      01810000
      *         AND SUBSEQUENTLY REFERENCED IN MQPUT AND MQCLOSE *      01820000
      *                                                          *      01830000
      * (3) OBJECT-DESCRIPTOR                                    *      01840000
      *       - THIS IDENTIFIES THE OBJECT TO BE OPENED          *      01850000
      *                                                          *      01860000
      * (4) OPTIONS                                              *      01870000
      *       WHEN USED IN MQOPEN                                *      01880000
      *       - OPTIONS THAT CONTROL THE ACTION OF MQOPEN        *      01890000
      *       - OPTIONS USED IN THIS PROGRAM:                    *      01900000
      *         MQOO-OUTPUT - THE QUEUE IS OPENED FOR USE WITH   *      01910000
      *                       SUBSEQUENT MQPUT CALL              *      01920000
      *         MQOO-FAIL-IF-QUIESCING - FORCES MQCALL TO FAIL   *      01930000
      *                       IF QUEUE MANAGER IS IN QUIESCING   *      01940000
      *                       STATE (I.E. PREPARING TO SHUTDOWN) *      01950000
      *                                                          *      01960000
      *       WHEN USED IN MQCLOSE                               *      01970000
      *       - OPTIONS THAT CONTROL THE ACTION OF MQCLOSE       *      01980000
      *       - OPTIONS USED IN THIS PROGRAM:                    *      01990000
      *         MQCO-NONE   - NO OPTIONAL CLOSE PROCESSING       *      02000000
      *                       REQUIRED                           *      02010000
      *                                                          *      02020000
      * (5) MESSAGE-DESCRIPTOR                                   *      02030000
      *       - THIS DESCRIBES THE ATTRIBUTES OF THE MESSAGE     *      02040000
      *         BEING SENT, AND RECEIVES INFO ABOUT THE MESSAGE  *      02050000
      *         AFTER THE PUT REQUEST IS COMPLETE                *      02060000
      *                                                          *      02070000
      * (6) PMOPTIONS (PUT MESSAGE OPTIONS)                      *      02080000
      *       - OPTIONS THAT CONTROL THE ACTION OF MQPUT         *      02090000
      *       - OPTION USED IN THIS PROGRAM:                     *      02100000
      *         MQMD-EXPIRY - MESSAGE LIFETIME. THE MESSAGE      *      02110000
      *                       BECOMES ELIGIBLE TO BE DISCARDED   *      02120000
      *                       IF IT HAS NOT BEEN REMOVED FROM    *      02130000
      *                       FROM THE QUEUE BEFORE THIS PERIOD  *      02140000
      *                       OF TIME ELAPSED                    *      02150000
      *                     - MUST BE SET TO MQEI_UNLIMITED      *      02160000
      *         MQMD-PERSISTENCE = MQPER-PERSISTENT              *      02170000
      *                                                          *      02180000
      * (7) BUFFER-LENGTH                                        *      02190000
      *       - LENGTH OF THE MESSAGE IN BUFFER                  *      02200000
      *                                                          *      02210000
      * (7) BUFFER                                               *      02220000
      *       - MESSAGE DATA                                     *      02230000
      *----------------------------------------------------------*      02240000
       01 HCONN                    PIC S9(9) BINARY.                    02250000
       01 Q-HANDLE                 PIC S9(9) BINARY.                    02260000
       01 OPTIONS                  PIC S9(9) BINARY.                    02270000
       01 COMPLETION-CODE          PIC S9(9) BINARY.                    02280000
       01 OPEN-CODE                PIC S9(9) BINARY.                    02290000
       01 CON-REASON               PIC S9(9) BINARY.                    02300000
       01 REASON                   PIC S9(9) BINARY.                    02310000
       01 MQMSGD                   PIC S9(9) BINARY.                    02320000
       01 BUFFER-LENGTH            PIC S9(9) BINARY.                    02330000
       01 BUFFER                   PIC X(368012).                       02340000
       01 QM-NAME                  PIC X(48) VALUE SPACES.              02350000
       01 TARGET-QUEUE             PIC X(48) VALUE SPACES.              02360000
                                                                        02370000
      *-------------------------------------------------------------    02380000
      *  FILE STATUS                                                    02390000
      *-------------------------------------------------------------    02400000
       01  WS-FILE-STAT.                                                02410000
           05 BP13F23A-STAT        PIC X(02)  VALUE SPACES.             02420000
                                                                        02430000
      *-------------------------------------------------------------    02440000
      *  FLAGS / SWITCHES                                               02450000
      *-------------------------------------------------------------    02460000
       01  WS-FLAGS.                                                    02470000
           05 F23A-EOF             PIC X(01) VALUE 'N'.                 02480000
           05 F23A-EMPTY           PIC X(01) VALUE 'N'.                 02490000
                                                                        02500000
      ****************************************************************  02510000
       PROCEDURE DIVISION.                                              02520000
      ****************************************************************  02530000
                                                                        02540000
      ********************                                              02550000
       0000-MAIN-PROCESS.                                               02560000
      ********************                                              02570000
                                                                        02580000
           PERFORM 0100-OPEN-FILES         THRU 0100-EXIT.              02590000
           PERFORM 0200-INITIALIZATION     THRU 0200-EXIT.              02600000
                                                                        02610000
           ACCEPT WS-BP13Q-NAME            FROM PARM-INPUT.             02620000
                                                                        02630000
           PERFORM 1000-CHECK-MESSAGE      THRU 1000-EXIT.              02640000
           MOVE F23A-TYPE-APPMT            TO WS-MSG-APPT-TYP.          02650000
           PERFORM 3000-PROCESS-BP13F23A   THRU 3000-EXIT               02660000
                   UNTIL F23A-EOF = 'Y'.                                02670000
           DISPLAY 'WS-SEND-MESSAGE : ' WS-SEND-MESSAGE.                02680000
           PERFORM 5300-MQ-PUT-MESSAGE     THRU 5300-EXIT.              02690000
           DISPLAY ' *** APPOINTMENT NOTIFICATION SENT!'                02700000
           PERFORM 5400-MQ-CLOSE           THRU 5400-EXIT.              02710000
           PERFORM 5500-MQ-DISCONNECT      THRU 5500-EXIT.              02720000
           PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT.              02730000
                                                                        02740000
           STOP RUN.                                                    02750000
                                                                        02760000
       0000-EXIT.                                                       02770000
           EXIT.                                                        02780000
                                                                        02790000
      ********************                                              02800000
       0100-OPEN-FILES.                                                 02810000
      ********************                                              02820000
                                                                        02830000
           DISPLAY ' ***** STARTING PROGRAM BP13CS06 . . . '.           02840000
           DISPLAY ' '.                                                 02850000
           OPEN    INPUT   BP13F23A.                                    02860000
                                                                        02870000
           IF  BP13F23A-STAT     NOT  =  00                             02880000
               DISPLAY ' OPEN ERROR BP13F23A'                           02890000
               DISPLAY 'BP13F23A-STAT = ' BP13F23A-STAT                 02900000
               MOVE     12                   TO RETURN-CODE             02910000
               PERFORM  9000-CLOSE-FILES     THRU 9000-EXIT.            02920000
                                                                        02930000
       0100-EXIT.                                                       02940000
           EXIT.                                                        02950000
                                                                        02960000
      **********************                                            02970000
       0200-INITIALIZATION.                                             02980000
      **********************                                            02990000
                                                                        03000000
           MOVE SPACES     TO WS-SEND-MESSAGE.                          03010000
           INITIALIZE         WS-SEND-MESSAGE.                          03020000
           MOVE ';'        TO WS-FILLER-01                              03030000
                              WS-FILLER-02                              03040000
                              WS-FILLER-03.                             03050000
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 2000       03060000
              MOVE ';'     TO WS-FILLER-04(WS-CTR)                      03070000
                              WS-FILLER-05(WS-CTR)                      03080000
                              WS-FILLER-06(WS-CTR)                      03090000
                              WS-FILLER-07(WS-CTR)                      03100000
                              WS-FILLER-08(WS-CTR)                      03110000
                              WS-FILLER-09(WS-CTR)                      03120000
                              WS-FILLER-10(WS-CTR)                      03130000
                              WS-FILLER-11(WS-CTR)                      03140000
                              WS-FILLER-12(WS-CTR)                      03150000
                              WS-FILLER-13(WS-CTR)                      03160000
                              WS-FILLER-14(WS-CTR)                      03170000
                              WS-FILLER-15(WS-CTR)                      03180000
                              WS-FILLER-16(WS-CTR)                      03190000
                              WS-FILLER-17(WS-CTR)                      03200000
           END-PERFORM.                                                 03210000
                                                                        03220000
           MOVE 'EML'      TO WS-MSG-CDE.                               03230000
                                                                        03240000
      *-----------------------------                                    03250000
      *  INITIAL READ OF INPUT FILES                                    03260000
      *-----------------------------                                    03270000
           READ BP13F23A                                                03280000
               AT END                                                   03290000
                   MOVE 'Y' TO F23A-EOF                                 03300000
                   MOVE 'Y' TO F23A-EMPTY                               03310000
                   DISPLAY ' *** '                                      03320000
                   DISPLAY ' *** NO RECORDS FOUND IN SMS FILE'          03330000
                   DISPLAY ' *** '.                                     03340000
                                                                        03350000
       0200-EXIT.                                                       03360000
           EXIT.                                                        03370000
                                                                        03380000
      ************************                                          03390000
       1000-CHECK-MESSAGE.                                              03400000
      ************************                                          03410000
                                                                        03420000
           IF F23A-EMPTY = 'Y'                                          03430000
               PERFORM 9000-CLOSE-FILES  THRU  9000-EXIT                03440000
           ELSE                                                         03450000
               PERFORM 5100-MQ-CONNECT   THRU  5100-EXIT                03460000
               PERFORM 5200-MQ-OPEN      THRU  5200-EXIT                03470000
           END-IF.                                                      03480000
                                                                        03490000
           MOVE SPACES                     TO BUFFER.                   03500000
                                                                        03510000
       1000-EXIT.                                                       03520000
           EXIT.                                                        03530000
                                                                        03540000
      ************************                                          03550000
       3000-PROCESS-BP13F23A.                                           03560000
      ************************                                          03570000
                                                                        03580000
           IF F23A-TYPE-APPMT = 'B1' OR 'B2' OR 'B3' OR 'B4' OR         03590000
                                'S1' OR 'S2' OR 'S3' OR 'S4' OR         03600000
                                'G1' OR 'G2' OR 'G3' OR 'G4' OR         03610000
                                'G5' OR 'G6' OR 'G7' OR 'G8' OR         03620000
                                'F1' OR 'F2' OR 'C1' OR 'C2' OR         03630000
                                'E1' OR 'M1' OR 'M2' OR 'M3' OR         03640000
                                'M4' OR 'M5' OR 'M6' OR 'M7' OR         03650000
                                'M8' OR 'G9' OR 'H1' OR 'M9' OR         03660000
                                'N1' OR 'B5' OR 'S5' OR 'E2' OR         03670000
                                'C1' OR 'C2' OR 'C3' OR 'C4' OR         03680000
                                'T1' OR 'T2' OR 'T3' OR 'T4' OR         03690000
                                'B6' OR 'NC' OR 'NF' OR 'I1' OR         03700000
                                'I2' OR 'I3' OR 'I4' OR 'I5' OR         03710000
                                'E3' OR 'J1' OR 'J2' OR 'J3' OR         03720000
                                'J4' OR 'J5' OR 'J6' OR 'J7' OR         03730000
                                'J8' OR 'C5' OR 'I6' OR 'I7' OR         03740000
                                'I8' OR 'I9' OR 'R1' OR 'R2' OR         03750000
                                'SL' OR 'R3' OR 'N2' OR 'N3' OR         03760000
                                'N4' OR 'N5' OR 'N6' OR 'N7' OR         03770000
                                'N8' OR 'N9' OR 'P1' OR 'P2' OR         03780000
                                'BK' OR 'TP' OR 'BT' OR 'H2' OR         03790002
                                'H3' OR 'L3' OR 'L4' OR 'L5' OR         03791002
                                'L6' OR 'L7' OR 'L8' OR 'L9' OR         03792002
                                'LA' OR 'LB' OR 'E9' OR 'LC' OR         03793002
                                'LD'                                    03794002
              PERFORM 3200-PASS-MSG              THRU 3200-EXIT         03800000
           END-IF.                                                      03810000
                                                                        03820000
           READ BP13F23A                                                03830000
               AT END                                                   03840000
                   MOVE 'Y' TO F23A-EOF.                                03850000
                                                                        03860000
       3000-EXIT.                                                       03870000
           EXIT.                                                        03880000
                                                                        03890000
      ****************************************************************  03900000
       3200-PASS-MSG.                                                   03910000
      ****************************************************************  03920000
                                                                        03930000
           ADD 1  TO WS-MSG-CTR.                                        03940000
                                                                        03950000
           MOVE F23A-NUM-REGN        TO WS-MSG-REGN (WS-MSG-CTR).       03960000
           MOVE F23A-NUM-FLAT-TYPE   TO WS-MSG-FLAT-TYPE(WS-MSG-CTR).   03970000
           MOVE F23A-NUM-FLAT-TYPE-PARENT                               03980000
                                     TO WS-MSG-FLAT-TYPE-P(WS-MSG-CTR). 03990000
           MOVE F23A-NUM-FLAT-TYPE-CHILD                                04000000
                                     TO WS-MSG-FLAT-TYPE-C(WS-MSG-CTR). 04010000
           MOVE F23A-DTE-BALLOT      TO WS-DTE-BALLOT(WS-MSG-CTR).      04020000
           MOVE F23A-NUM-PRJ-NME     TO WS-PROJ-NAME(WS-MSG-CTR).       04030000
           MOVE F23A-NUM-SEL-PERIOD  TO WS-SEL-PERIOD(WS-MSG-CTR).      04040000
           MOVE F23A-NUM-EMAIL       TO WS-MSG-EMAIL(WS-MSG-CTR).       04050000
           MOVE F23A-NUM-QUEUE       TO WS-MSG-QUEUE-NO(WS-MSG-CTR).    04060000
           MOVE F23A-NUM-QUEUE-GRO   TO WS-MSG-QUEUE-GRO(WS-MSG-CTR).   04070000
           MOVE F23A-NUM-WARD        TO WS-MSG-WARD(WS-MSG-CTR).        04080000
           MOVE F23A-NUM-UNIT-OFFER  TO WS-NUM-UNIT-OFFER(WS-MSG-CTR).  04090000
           MOVE F23A-NUM-MATURE-EST-TAG TO WS-MSG-ME-TAG(WS-MSG-CTR).   04100000
           IF F23A-TYPE-APPMT = 'SL'                                    04110000
              MOVE F23A-DTE-ACCEPTANCE      TO                          04120000
                                      WS-MSG-LAUNCH-TXT(WS-MSG-CTR)     04130000
           ELSE                                                         04140000
              MOVE F23A-TXT-NEXT-LAUNCH-LTR TO                          04150000
                                      WS-MSG-LAUNCH-TXT(WS-MSG-CTR)     04160000
           END-IF.                                                      04170000
                                                                        04180000
       3200-EXIT.                                                       04190000
           EXIT.                                                        04200000
                                                                        04210000
      ****************************************************************  04220000
       5100-MQ-CONNECT.                                                 04230000
      ****************************************************************  04240000
      *---------------------------------------------------------------  04250000
      *  SET THE QUEUE MANAGER NAME                                     04260000
      *---------------------------------------------------------------  04270000
           IF WS-BP13Q-NAME NOT = SPACES AND LOW-VALUES                 04280000
              MOVE WS-BP13Q-NAME           TO   QM-NAME                 04290000
           ELSE                                                         04300000
              MOVE WS-QM-NAME              TO   QM-NAME                 04310000
           END-IF.                                                      04320000
                                                                        04330000
      *---------------------------------------------------------------  04340000
      *   MQCONN                                                        04350000
      *---------------------------------------------------------------  04360000
           CALL 'MQCONN'                                                04370000
                USING QM-NAME, HCONN,                                   04380000
                COMPLETION-CODE, CON-REASON.                            04390000
                                                                        04400000
           IF COMPLETION-CODE  = MQCC-FAILED                            04410000
              MOVE CON-REASON              TO   CS06-REASON             04420000
              MOVE COMPLETION-CODE         TO   CS06-COMPLETION-CODE    04430000
              MOVE 'BP13CS06 MQCONN ERROR' TO   CS06-ERR-MSG            04440000
              PERFORM 9100-EXIT-MQCONN     THRU 9100-EXIT               04450000
           END-IF.                                                      04460000
                                                                        04470000
       5100-EXIT.                                                       04480000
           EXIT.                                                        04490000
                                                                        04500000
      ****************************************************************  04510000
       5200-MQ-OPEN.                                                    04520000
      ****************************************************************  04530000
      *---------------------------------------------------------------  04540000
      *  USE DEFAULT WS-QUEUE-NAME                                      04550000
      *---------------------------------------------------------------  04560000
                                                                        04570000
           MOVE  WS-QUEUE-NAME         TO MQOD-OBJECTNAME.              04580000
           ADD   MQOO-OUTPUT MQOO-FAIL-IF-QUIESCING                     04590000
                               GIVING OPTIONS.                          04600000
                                                                        04610000
      *---------------------------------------------------------------  04620000
      *   MQOPEN                                                        04630000
      *---------------------------------------------------------------  04640000
           CALL 'MQOPEN'                                                04650000
                USING HCONN, OBJECT-DESCRIPTOR,                         04660000
                OPTIONS, Q-HANDLE,                                      04670000
                OPEN-CODE, REASON.                                      04680000
                                                                        04690000
           IF REASON NOT =  MQRC-NONE                                   04700000
              MOVE REASON                     TO   CS06-REASON          04710000
              MOVE OPEN-CODE                  TO   CS06-COMPLETION-CODE 04720000
              MOVE 'MQOPEN ENDED WITH REASON CODE'                      04730000
                                              TO   CS06-ERR-MSG         04740000
              PERFORM 9100-EXIT-MQCONN        THRU 9100-EXIT            04750000
           END-IF.                                                      04760000
                                                                        04770000
       5200-EXIT.                                                       04780000
           EXIT.                                                        04790000
                                                                        04800000
      ***********************                                           04810000
       5300-MQ-PUT-MESSAGE.                                             04820000
      ***********************                                           04830000
                                                                        04840000
           MOVE WS-SEND-MESSAGE     TO BUFFER.                          04850000
                                                                        04860000
      *---------------------------------------------------------------  04870000
      *  SET UP MESSAGE DESCRIPTOR                                      04880000
      *---------------------------------------------------------------  04890000
           MOVE MQEI-UNLIMITED      TO MQMD-EXPIRY.                     04900000
           MOVE MQPER-PERSISTENT    TO MQMD-PERSISTENCE.                04910000
           MOVE MQFMT-STRING        TO MQMD-FORMAT.                     04920000
           MOVE WS-MESSAGE-LENGTH   TO BUFFER-LENGTH.                   04930000
      *---------------------------------------------------------------  04940000
      *   MQPUT                                                         04950000
      *---------------------------------------------------------------  04960000
                                                                        04970000
           CALL 'MQPUT'                                                 04980000
                USING HCONN, Q-HANDLE,                                  04990000
                      MESSAGE-DESCRIPTOR, PMOPTIONS,                    05000000
                      BUFFER-LENGTH, BUFFER,                            05010000
                      COMPLETION-CODE, REASON.                          05020000
                                                                        05030000
           IF REASON NOT =  MQRC-NONE                                   05040000
              MOVE REASON                  TO   CS06-REASON             05050000
              MOVE COMPLETION-CODE         TO   CS06-COMPLETION-CODE    05060000
              MOVE 'BP13CS06 MQPUT ERROR'  TO   CS06-ERR-MSG            05070000
              PERFORM 9100-EXIT-MQCONN     THRU 9100-EXIT               05080000
           END-IF.                                                      05090000
                                                                        05100000
       5300-EXIT.                                                       05110000
           EXIT.                                                        05120000
                                                                        05130000
      ****************************************************************  05140000
       5400-MQ-CLOSE.                                                   05150000
      ****************************************************************  05160000
                                                                        05170000
           MOVE MQCO-NONE TO OPTIONS.                                   05180000
                                                                        05190000
      *---------------------------------------------------------------  05200000
      *   MQCLOSE                                                       05210000
      *---------------------------------------------------------------  05220000
           CALL 'MQCLOSE'                                               05230000
                USING HCONN, Q-HANDLE, OPTIONS,                         05240000
                COMPLETION-CODE, REASON.                                05250000
                                                                        05260000
           IF REASON NOT =  MQRC-NONE                                   05270000
              MOVE REASON                   TO   CS06-REASON            05280000
              MOVE COMPLETION-CODE          TO   CS06-COMPLETION-CODE   05290000
              MOVE 'BP13CS06 MQCLOSE ERROR' TO   CS06-ERR-MSG           05300000
              PERFORM 9100-EXIT-MQCONN      THRU 9100-EXIT              05310000
           END-IF.                                                      05320000
                                                                        05330000
       5400-EXIT.                                                       05340000
           EXIT.                                                        05350000
                                                                        05360000
      ****************************************************************  05370000
       5500-MQ-DISCONNECT.                                              05380000
      ****************************************************************  05390000
      *---------------------------------------------------------------  05400000
      *  DISCONNECT FROM QUEUE MANAGER                                  05410000
      *---------------------------------------------------------------  05420000
           CALL 'MQDISC'                                                05430000
           USING HCONN, COMPLETION-CODE, REASON                         05440000
                                                                        05450000
           IF REASON NOT =  MQRC-NONE                                   05460000
              MOVE REASON                  TO   CS06-REASON             05470000
              MOVE COMPLETION-CODE         TO   CS06-COMPLETION-CODE    05480000
              MOVE 'BP13CS06 MQDISC ERROR' TO   CS06-ERR-MSG            05490000
              PERFORM 9100-EXIT-MQCONN     THRU 9100-EXIT               05500000
           END-IF.                                                      05510000
                                                                        05520000
       5500-EXIT.                                                       05530000
           EXIT.                                                        05540000
                                                                        05550000
                                                                        05560000
      ****************************************************************  05570000
       9000-CLOSE-FILES.                                                05580000
      ****************************************************************  05590000
                                                                        05600000
           CLOSE BP13F23A.                                              05610000
                                                                        05620000
           IF    RETURN-CODE NOT = ZERO                                 05630000
                 DISPLAY ' *** RETURN-CODE = ' RETURN-CODE ' ERROR'     05640000
           ELSE                                                         05650000
                 DISPLAY ' '                                            05660000
                 DISPLAY ' *** SUCCESSFUL EXECUTION OF BP13CS06.'       05670000
                 DISPLAY ' *** MESSAGE/S PUT INTO QUEUE SUCCESSFULLY!'  05680000
                 DISPLAY ' *** Q MANAGER : ' QM-NAME                    05690000
                 DISPLAY ' *** TARGET Q  : ' WS-QUEUE-NAME              05700000
                 DISPLAY ' '                                            05710000
           END-IF.                                                      05720000
                                                                        05730000
           STOP RUN.                                                    05740000
                                                                        05750000
       9000-EXIT.                                                       05760000
           EXIT.                                                        05770000
                                                                        05780000
      ****************************************************************  05790000
       9100-EXIT-MQCONN.                                                05800000
      ****************************************************************  05810000
                                                                        05820000
           DISPLAY ' *** PROGRAM ID:  BP13CS06 '                        05830000
           DISPLAY ' *** Q MANAGER : ' QM-NAME                          05840000
           DISPLAY ' *** TARGET Q  : ' WS-QUEUE-NAME                    05850000
           DISPLAY ' '                                                  05860000
           IF CS06-COMPLETION-CODE NOT = ZEROES AND LOW-VALUES          05870000
              DISPLAY ' *** MQ COMPLETION CODE: ' CS06-COMPLETION-CODE  05880000
              DISPLAY ' *** MQ REASON         : ' CS06-REASON           05890000
              DISPLAY ' *** MQ ERROR MSG      : ' CS06-ERR-MSG          05900000
              MOVE 99                    TO  RETURN-CODE                05910000
           END-IF.                                                      05920000
                                                                        05930000
           PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT.                05940000
                                                                        05950000
       9100-EXIT.                                                       05960000
           EXIT.                                                        05970000
                                                                        05980000
      ****************************************************************  05990000
      **********            END OF BP13CS06                 **********  06000000
      ****************************************************************  06010000
