       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID. BP13C979.                                                    
       AUTHOR. ROMAR ANDREW S MARALIT.                                          
      *DATE-WRITTEN. 17/01/2002.                                                
                                                                                
      *================================================================*        
      *                    SYSTEM OF COMMITMENT (BP13)                 *        
      *================================================================*        
      *  OBJECTIVE:  1.  TO PRINT REPORT ON MCPS CASE FOUND IN SOC/EC/ *        
      *                  RSL/SHOP.                                     *        
      *================================================================*        
      *  FILES DESCRIPTION:-                                           *        
      *                 ACCESS       REC                               *        
      *  DD NAME  I/O/E  MODE        LEN   KEY           REMARKS       *        
      *  -------  ----- ------       ---   ---           -------       *        
      * BP13F558    I   SEQ          600   F558-KEY-FLD  SEQ           *        
      * BP13K800    I   RANDOM       400   K800-NUM-REGN VSAM          *        
      * BP13K820    I   RANDOM       400   K820-KEY-FLD  VSAM          *        
      * BP13K943    I   RANDOM       200   K943-KEY-FLD  VSAM          *        
      * BP18K310    I   RANDOM       250   K310-KEY-FLD  VSAM          *        
      * BB24K110    I   RANDOM        50   K110-KEY-FLD  VSAM          *        
      * BB15K050    I   RANDOM       150   K050-KEY-FLD  VSAM          *        
      * BP13K730   I-O  RANDOM       500   K730-KEY-NEW  VSAM          *        
      * P13F558O    O   SEQ          600   F558-KEY-FLD  SEQ           *        
      * BP13L979    O   SEQ          132                 REPORT        *        
      *================================================================*        
      *  MODIFICATIONS :                                               *        
      *  CHGE REQ #  DATE         AUTHOR   REMARKS                     *        
      *  ----------  ----------   ------   --------------------------- *        
      *  BP131064    17/01/2002   RASM     NEW PROGRAM                 *        
      *  BP132818    14/02/2006   CKK7     CHANGE REF NO TO 8 BYTE     *        
      *================================================================*        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.  IBM-3090.                                              
       OBJECT-COMPUTER.  IBM-3090.                                              
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F558 ASSIGN TO BP13F558.                                  
                                                                                
           SELECT BP13L979 ASSIGN TO BP13L979.                                  
                                                                                
           SELECT P13F558O ASSIGN TO P13F558O.                                  
                                                                                
           SELECT BP13K730 ASSIGN TO BP13K730                                   
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K730-KEY-NEW                        
                           FILE STATUS   IS BP13K730-STATUS.                    
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K800-NUM-REGN                       
                           FILE STATUS   IS BP13K800-STATUS.                    
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K820-KEY-FLD                        
                           ALTERNATE RECORD KEY IS K820-NUM-NRIC                
                           FILE STATUS   IS BP13K820-STATUS.                    
                                                                                
           SELECT BP13K943 ASSIGN TO BP13K943                                   
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K943-KEY-FLD                        
                           ALTERNATE RECORD KEY IS K943-NUM-NRIC                
                           FILE STATUS   IS BP13K943-STATUS.                    
                                                                                
           SELECT BP18K310 ASSIGN TO BP18K310                                   
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K310-KEY-FLD                        
                           ALTERNATE RECORD KEY IS K310-NUM-NRIC                
                           FILE STATUS   IS BP18K310-STATUS.                    
                                                                                
           SELECT BB24K110 ASSIGN TO BB24K110                                   
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K110-KEY-FLD                        
                           FILE STATUS   IS BB24K110-STATUS.                    
                                                                                
           SELECT BB15K050 ASSIGN TO BB15K050                                   
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K050-KEY-FLD                        
                           ALTERNATE RECORD KEY IS K050-NUM-UIN                 
                           FILE STATUS   IS BB15K050-STATUS.                    
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F558     BLOCK  CONTAINS 0    RECORDS                           
                         RECORD CONTAINS 600  CHARACTERS                        
                         LABEL  RECORDS  ARE  STANDARD                          
                         RECORDING MODE IS F.                                   
       COPY BP13F558.                                                           
                                                                                
       FD   BP13L979     BLOCK  CONTAINS 0    RECORDS                           
                         RECORD CONTAINS 132  CHARACTERS                        
                         LABEL  RECORD   IS   OMITTED                           
                         DATA   RECORD   IS   BP13L979-REC                      
                         RECORDING MODE IS F.                                   
       01   BP13L979-REC                      PIC X(132).                       
                                                                                
       FD   P13F558O     BLOCK  CONTAINS 0    RECORDS                           
                         RECORD CONTAINS 600  CHARACTERS                        
                         LABEL  RECORDS  ARE  STANDARD                          
                         RECORDING MODE IS F.                                   
       01   P13F558O-REC.                                                       
            05 F558O-NUM-REGN                 PIC X(8).                         
            05 F558O-NUM-NRIC                 PIC X(9).                         
            05 FILLER                         PIC X(429).                       
            05 F558O-SOC-NUM-REGN             PIC X(8).                         
            05 F558O-EC-BF-TP-NUM-REGN        PIC X(8).                         
            05 F558O-EC-AF-TP-NUM-REGN        PIC X(8).                         
            05 F558O-RSL-NUM-CASE             PIC X(8).                         
            05 F558O-SHOP-NUM-SCH-ACC         PIC X(11).                        
            05 FILLER                         PIC X(111).                       
                                                                                
       FD   BP13K730     RECORD CONTAINS 500  CHARACTERS.                       
       COPY BP13K730.                                                           
                                                                                
       FD   BP13K800     RECORD CONTAINS 2000 CHARACTERS.                       
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820     RECORD CONTAINS 400  CHARACTERS.                       
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K943     RECORD CONTAINS 200  CHARACTERS.                       
       COPY BP13K943.                                                           
                                                                                
       FD   BP18K310     RECORD CONTAINS 250  CHARACTERS.                       
       COPY BP18K310.                                                           
                                                                                
       FD   BB24K110     RECORD CONTAINS  50  CHARACTERS.                       
       COPY BB24K110.                                                           
                                                                                
       FD   BB15K050     RECORD CONTAINS 150  CHARACTERS.                       
       COPY BB15K050.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-DTE-CCYYMMDD.                                                     
           05  WS-DTE-CC                      PIC X(2).                         
           05  WS-DTE-CURRENT.                                                  
               10  WS-DTE-YY                  PIC X(2).                         
               10  WS-DTE-MM                  PIC X(2).                         
               10  WS-DTE-DD                  PIC X(2).                         
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-DD                      PIC X(2).                         
           05  FILLER                         PIC X     VALUE '/'.              
           05  WS-SYS-MM                      PIC X(2).                         
           05  FILLER                         PIC X     VALUE '/'.              
           05  WS-SYS-CCYY.                                                     
               10  WS-SYS-CC                  PIC X(2).                         
               10  WS-SYS-YY                  PIC X(2).                         
                                                                                
       01  WS-FILE-FLAGS.                                                       
           05  WS-F558-EOF                    PIC X     VALUE 'N'.              
           05  WS-K110-EOF                    PIC X     VALUE 'N'.              
           05  WS-K050-EOF                    PIC X     VALUE 'N'.              
           05  BP13K730-STATUS                PIC 9(2)  VALUE ZEROS.            
           05  BP13K800-STATUS                PIC 9(2)  VALUE ZEROS.            
           05  BP13K820-STATUS                PIC 9(2)  VALUE ZEROS.            
           05  BP13K943-STATUS                PIC 9(2)  VALUE ZEROS.            
           05  BP18K310-STATUS                PIC 9(2)  VALUE ZEROS.            
           05  BB24K110-STATUS                PIC 9(2)  VALUE ZEROS.            
           05  BB15K050-STATUS                PIC 9(2)  VALUE ZEROS.            
           05  WS-K820-NOTFND                 PIC X     VALUE 'N'.              
               88 K820-NOTFND                           VALUE 'Y'.              
           05  WS-K943-NOTFND                 PIC X     VALUE 'N'.              
               88 K943-NOTFND                           VALUE 'Y'.              
           05  WS-K310-NOTFND                 PIC X     VALUE 'N'.              
               88 K310-NOTFND                           VALUE 'Y'.              
           05  WS-K110-NOTFND                 PIC X     VALUE 'N'.              
               88 K110-NOTFND                           VALUE 'Y'.              
           05  WS-K050-NOTFND                 PIC X     VALUE 'N'.              
               88 K050-NOTFND                           VALUE 'Y'.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-L979-CNT-PAGE               PIC 9(4)  VALUE ZEROS.            
           05  WS-L979-CNT-LINE               PIC 9(5)  VALUE 51.               
           05  WS-L979-CNT-REC                PIC 9(5)  VALUE ZEROS.            
           05  WS-F558-CNT-READ               PIC 9(5)  VALUE ZEROS.            
           05  WS-K730-CNT-UPDT               PIC 9(5)  VALUE ZEROS.            
           05  WS-K800-CNT-READ               PIC 9(5)  VALUE ZEROS.            
           05  WS-K820-CNT-READ               PIC 9(5)  VALUE ZEROS.            
           05  WS-K943-CNT-READ               PIC 9(5)  VALUE ZEROS.            
           05  WS-K310-CNT-READ               PIC 9(5)  VALUE ZEROS.            
           05  WS-K110-CNT-READ               PIC 9(5)  VALUE ZEROS.            
           05  WS-K050-CNT-READ               PIC 9(5)  VALUE ZEROS.            
           05  WS-F558O-CNT-WRT               PIC 9(5)  VALUE ZEROS.            
                                                                                
      *---------------------------------------------------------------*         
      *    BP13L979 REPORT LAYOUT.                                              
      *---------------------------------------------------------------*         
       01  L979-HEADING1.                                                       
           05  FILLER                         PIC X(14)                         
               VALUE 'BP13L979'.                                                
           05  FILLER                         PIC X(42) VALUE 'HDB3'.           
           05  FILLER                         PIC X(44)                         
               VALUE 'SYSTEM OF COMMITMENT'.                                    
           05  FILLER                         PIC X(7)  VALUE 'DATE : '.        
           05  L979-DTE-HDR-DD                PIC X(2).                         
           05  FILLER                         PIC X     VALUE '/'.              
           05  L979-DTE-HDR-MM                PIC X(2).                         
           05  FILLER                         PIC X     VALUE '/'.              
           05  L979-DTE-HDR-CC                PIC X(2).                         
           05  L979-DTE-HDR-YY                PIC X(5).                         
           05  FILLER                         PIC X(7)  VALUE 'PAGE : '.        
           05  L979-PAGE-NUM                  PIC ZZZ9.                         
           05  FILLER                         PIC X(2)                          
               VALUE SPACES.                                                    
                                                                                
       01  L979-HEADING2.                                                       
           05  FILLER                         PIC X(43) VALUE SPACES.           
           05  FILLER                         PIC X(47)                         
               VALUE 'MCPS PARENT/CHILD NRIC FOUND IN SOC/EC/RSL/SHOP'.         
           05  FILLER                         PIC X(42) VALUE SPACES.           
                                                                                
       01  L979-COL-HEADING1.                                                   
           05  FILLER                         PIC X(10) VALUE SPACES.           
           05  FILLER                         PIC X(05) VALUE ' S/NO'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(06) VALUE 'REF NO'.         
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09)                         
               VALUE '  NRIC   '.                                               
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(06) VALUE ' NT/FT'.         
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(08)                         
               VALUE 'SOC-OCCP'.                                                
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09)                         
               VALUE 'EC-B/F TP'.                                               
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09)                         
               VALUE 'EC-A/F TP'.                                               
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09)                         
               VALUE 'RSL-CASE#'.                                               
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(12)                         
               VALUE 'SHOP-SCH ACC'.                                            
           05  FILLER                         PIC X(09) VALUE SPACES.           
                                                                                
       01  L979-COL-HEADING2.                                                   
           05  FILLER                         PIC X(56) VALUE SPACES.           
           05  FILLER                         PIC X(08)                         
               VALUE 'BP13K820'.                                                
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09)                         
               VALUE ' BP18K310'.                                               
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09)                         
               VALUE ' BP13K943'.                                               
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09)                         
               VALUE ' BB24K110'.                                               
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(12)                         
               VALUE '  BB15K050  '.                                            
           05  FILLER                         PIC X(09) VALUE SPACES.           
                                                                                
       01  L979-HORIZONTAL-LINE.                                                
           05  FILLER                         PIC X(10) VALUE SPACES.           
           05  FILLER                         PIC X(05) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(06) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(06) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(08) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(09) VALUE ALL '-'.          
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  FILLER                         PIC X(12) VALUE ALL '-'.          
           05  FILLER                         PIC X(09) VALUE SPACES.           
                                                                                
       01  L979-DETAILS-LINE.                                                   
           05  FILLER                         PIC X(10) VALUE SPACES.           
           05  L979-NUM-SERIAL                PIC ZZZZZ.                        
           05  FILLER                         PIC X(04) VALUE SPACES.           
           05  L979-NUM-REF                   PIC X(8).                         
           05  FILLER                         PIC X(04) VALUE SPACES.           
           05  L979-NUM-NRIC                  PIC X(09).                        
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  L979-NUM-ZONE                  PIC X(03).                        
           05  FILLER                         PIC X(01) VALUE '/'.              
           05  L979-NUM-FLAT-TYPE             PIC X(02).                        
           05  FILLER                         PIC X(05) VALUE SPACES.           
           05  L979-SOC-NUM-REGN              PIC X(08).                        
           05  FILLER                         PIC X(06) VALUE SPACES.           
           05  L979-EC-BF-TP-NUM-REGN         PIC X(08).                        
           05  FILLER                         PIC X(06) VALUE SPACES.           
           05  L979-EC-AF-TP-NUM-REGN         PIC X(08).                        
           05  FILLER                         PIC X(06) VALUE SPACES.           
           05  L979-RSL-NUM-CASE              PIC X(08).                        
           05  FILLER                         PIC X(06) VALUE SPACES.           
           05  L979-SHOP-NUM-SCH-ACC          PIC X(11).                        
           05  FILLER                         PIC X(09) VALUE SPACES.           
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *----------------------------------------------------------------*        
       0000-CONTROL.                                                            
      *----------------------------------------------------------------*        
           PERFORM 1000-OPEN-FILES    THRU 1000-EXIT.                           
           PERFORM 2000-READ-BP13F558 THRU 2000-EXIT.                           
           PERFORM 3000-MAIN-ROUTINE  THRU 3000-EXIT                            
                   UNTIL WS-F558-EOF = 'Y'.                                     
           PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       1000-OPEN-FILES.                                                         
      *----------------------------------------------------------------*        
           OPEN INPUT  BP13F558                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                       BP13K943                                                 
                       BP18K310                                                 
                       BB24K110                                                 
                       BB15K050                                                 
                       BP13K730                                                 
                OUTPUT P13F558O                                                 
                       BP13L979.                                                
                                                                                
           IF BP13K730-STATUS NOT = 00 AND 97                                   
              DISPLAY "OPEN BP13K730 FAIL STATUS "  BP13K730-STATUS             
              MOVE BP13K730-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY "OPEN BP13K800 FAIL STATUS "  BP13K800-STATUS             
              MOVE BP13K800-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY "OPEN BP13K820 FAIL STATUS "  BP13K820-STATUS             
              MOVE BP13K820-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K943-STATUS NOT = 00 AND 97                                   
              DISPLAY "OPEN BP13K943 FAIL STATUS "  BP13K943-STATUS             
              MOVE BP13K943-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP18K310-STATUS NOT = 00 AND 97                                   
              DISPLAY "OPEN BP18K310 FAIL STATUS "  BP18K310-STATUS             
              MOVE BP18K310-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BB24K110-STATUS NOT = 00 AND 97                                   
              DISPLAY "OPEN BB24K110 FAIL STATUS "  BB24K110-STATUS             
              MOVE BB24K110-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BB15K050-STATUS NOT = 00 AND 97                                   
              DISPLAY "OPEN BB15K050 FAIL STATUS "  BB15K050-STATUS             
              MOVE BB15K050-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           ACCEPT WS-DTE-CCYYMMDD FROM DATE YYYYMMDD.                           
                                                                                
           MOVE WS-DTE-DD TO WS-SYS-DD L979-DTE-HDR-DD.                         
           MOVE WS-DTE-MM TO WS-SYS-MM L979-DTE-HDR-MM.                         
           MOVE WS-DTE-CC TO WS-SYS-CC L979-DTE-HDR-CC.                         
           MOVE WS-DTE-YY TO WS-SYS-YY L979-DTE-HDR-YY.                         
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       2000-READ-BP13F558.                                                      
      *----------------------------------------------------------------*        
           READ BP13F558 AT END                                                 
                         MOVE 'Y' TO WS-F558-EOF                                
                         GO TO 2000-EXIT                                        
           END-READ.                                                            
                                                                                
           ADD 1 TO WS-F558-CNT-READ.                                           
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3000-MAIN-ROUTINE.                                                       
      *----------------------------------------------------------------*        
           PERFORM 4000-READ-BP13K820 THRU 4000-EXIT                            
           IF K820-NOTFND                                                       
              PERFORM 4100-READ-BP13K943 THRU 4100-EXIT                         
              IF K943-NOTFND                                                    
                 PERFORM 4200-READ-BP18K310 THRU 4200-EXIT                      
                 IF K310-NOTFND                                                 
                    PERFORM 4300-READ-BB24K110 THRU 4300-EXIT                   
                    IF K110-NOTFND                                              
                       PERFORM 4400-READ-BB15K050 THRU 4400-EXIT                
                       IF K050-NOTFND                                           
                          DISPLAY 'MCPS NOT FOUND: ' F558-NUM-NRIC              
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F558 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4000-READ-BP13K820.                                                      
      *----------------------------------------------------------------*        
           MOVE SPACES                   TO K820-KEY-FLD.                       
           MOVE F558-NUM-NRIC            TO K820-NUM-NRIC.                      
           MOVE 'N'                      TO WS-K820-NOTFND.                     
                                                                                
           READ BP13K820 KEY IS K820-NUM-NRIC.                                  
                                                                                
           EVALUATE  BP13K820-STATUS                                            
              WHEN 00                                                           
              WHEN 02                                                           
                   ADD 1                 TO WS-K820-CNT-READ                    
                   PERFORM 4010-READ-BP13K800 THRU 4010-EXIT                    
                   IF (K800-NUM-STATUS = 'C') OR                                
                      (K800-NUM-SCH-ACC = SPACES OR LOW-VALUES)                 
                      CONTINUE                                                  
                   ELSE                                                         
                      MOVE BP13F558-REC  TO P13F558O-REC                        
                      MOVE SPACES        TO L979-DETAILS-LINE                   
                      MOVE K820-NUM-REGN TO L979-SOC-NUM-REGN                   
                                            F558O-SOC-NUM-REGN                  
                      PERFORM 5000-PRT-UPDT-RTN THRU 5000-EXIT                  
                   END-IF                                                       
              WHEN 23                                                           
                   MOVE 'Y'              TO WS-K820-NOTFND                      
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BP13K820 : ' BP13K820-STATUS             
                   DISPLAY 'NRIC TO BE UPDATED  : ' K820-NUM-NRIC               
                   MOVE BP13K820-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4010-READ-BP13K800.                                                      
      *----------------------------------------------------------------*        
           MOVE K820-NUM-REGN            TO K800-NUM-REGN.                      
                                                                                
           READ BP13K800 KEY IS K800-NUM-REGN.                                  
                                                                                
           EVALUATE  BP13K800-STATUS                                            
              WHEN 00                                                           
                   ADD 1                 TO WS-K800-CNT-READ                    
              WHEN 23                                                           
                   DISPLAY 'REC NOTFND BP13K800 : ' K800-NUM-REGN               
                   DISPLAY 'NRIC TO BE UPDATED  : ' K820-NUM-NRIC               
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BP13K800 : ' BP13K800-STATUS             
                   DISPLAY 'NRIC TO BE UPDATED  : ' K820-NUM-NRIC               
                   MOVE BP13K800-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4100-READ-BP13K943.                                                      
      *----------------------------------------------------------------*        
           MOVE SPACES                   TO K943-KEY-FLD.                       
           MOVE F558-NUM-NRIC            TO K943-NUM-NRIC.                      
           MOVE 'N'                      TO WS-K943-NOTFND.                     
                                                                                
           READ BP13K943 KEY IS K943-NUM-NRIC.                                  
                                                                                
           EVALUATE  BP13K943-STATUS                                            
              WHEN 00                                                           
              WHEN 02                                                           
                   ADD 1                 TO WS-K943-CNT-READ                    
                   MOVE BP13F558-REC     TO P13F558O-REC                        
                   MOVE SPACES           TO L979-DETAILS-LINE                   
                   MOVE K943-NUM-REGN    TO L979-EC-AF-TP-NUM-REGN              
                                            F558O-EC-AF-TP-NUM-REGN             
                   PERFORM 5000-PRT-UPDT-RTN THRU 5000-EXIT                     
              WHEN 23                                                           
                   MOVE 'Y'              TO WS-K943-NOTFND                      
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BP13K943 : ' BP13K943-STATUS             
                   DISPLAY 'NRIC TO BE UPDATED  : ' K943-NUM-NRIC               
                   MOVE BP13K943-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4200-READ-BP18K310.                                                      
      *----------------------------------------------------------------*        
           MOVE SPACES                   TO K310-KEY-FLD.                       
           MOVE F558-NUM-NRIC            TO K310-NUM-NRIC.                      
           MOVE 'N'                      TO WS-K310-NOTFND.                     
                                                                                
           READ BP18K310 KEY IS K310-NUM-NRIC.                                  
                                                                                
           EVALUATE  BP18K310-STATUS                                            
              WHEN 00                                                           
              WHEN 02                                                           
                   ADD 1                 TO WS-K310-CNT-READ                    
                   MOVE BP13F558-REC     TO P13F558O-REC                        
                   MOVE SPACES           TO L979-DETAILS-LINE                   
                   MOVE K310-NUM-REGN    TO L979-EC-BF-TP-NUM-REGN              
                                            F558O-EC-BF-TP-NUM-REGN             
                   PERFORM 5000-PRT-UPDT-RTN THRU 5000-EXIT                     
              WHEN 23                                                           
                   MOVE 'Y'              TO WS-K310-NOTFND                      
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BP18K310 : ' BP18K310-STATUS             
                   DISPLAY 'NRIC TO BE UPDATED  : ' K310-NUM-NRIC               
                   MOVE BP18K310-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4300-READ-BB24K110.                                                      
      *----------------------------------------------------------------*        
           MOVE 'N'                      TO WS-K110-EOF                         
                                            WS-K110-NOTFND.                     
           MOVE SPACES                   TO K110-KEY-FLD.                       
           MOVE F558-NUM-NRIC            TO K110-NUM-UIN.                       
                                                                                
           START BB24K110 KEY = K110-NUM-UIN.                                   
                                                                                
           EVALUATE BB24K110-STATUS                                             
              WHEN 00                                                           
                   PERFORM 4310-READNEXT-BB24K110 THRU 4310-EXIT                
                      UNTIL (K110-NUM-UIN NOT = F558-NUM-NRIC)                  
                         OR (WS-K110-EOF = 'Y')                                 
              WHEN 23                                                           
                   MOVE 'Y'              TO WS-K110-NOTFND                      
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BB24K110 : ' BB24K110-STATUS             
                   DISPLAY 'NRIC TO BE UPDATED  : ' K110-NUM-UIN                
                   MOVE BB24K110-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4310-READNEXT-BB24K110.                                                  
      *----------------------------------------------------------------*        
           READ BB24K110 NEXT AT END MOVE 'Y' TO WS-K110-EOF                    
                         GO TO 4310-EXIT.                                       
                                                                                
           EVALUATE BB24K110-STATUS                                             
              WHEN 00                                                           
              WHEN 02                                                           
                   IF (K110-NUM-UIN NOT = F558-NUM-NRIC)                        
                      MOVE 'Y'           TO WS-K110-EOF                         
                   ELSE                                                         
                      ADD 1              TO WS-K110-CNT-READ                    
                      MOVE BP13F558-REC  TO P13F558O-REC                        
                      MOVE SPACES        TO L979-DETAILS-LINE                   
                      MOVE K110-NUM-CASE TO L979-RSL-NUM-CASE                   
                                            F558O-RSL-NUM-CASE                  
                      PERFORM 5000-PRT-UPDT-RTN THRU 5000-EXIT                  
                   END-IF                                                       
              WHEN 23                                                           
                   MOVE 'Y'              TO WS-K110-EOF                         
                                            WS-K110-NOTFND                      
              WHEN OTHER                                                        
                   DISPLAY 'READNEXT ERROR BB24K110 : ' BB24K110-STATUS         
                   DISPLAY 'NRIC TO BE UPDATED : ' K110-NUM-UIN                 
                   MOVE BB24K110-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4310-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4400-READ-BB15K050.                                                      
      *----------------------------------------------------------------*        
           MOVE 'N'                      TO WS-K050-EOF                         
                                            WS-K050-NOTFND.                     
           MOVE SPACES                   TO K050-KEY-FLD.                       
           MOVE F558-NUM-NRIC            TO K050-NUM-UIN.                       
                                                                                
           START BB15K050 KEY = K050-NUM-UIN.                                   
                                                                                
           EVALUATE BB15K050-STATUS                                             
              WHEN 00                                                           
                   PERFORM 4410-READNEXT-BB15K050 THRU 4410-EXIT                
                      UNTIL (K050-NUM-UIN NOT = F558-NUM-NRIC)                  
                         OR (WS-K050-EOF = 'Y')                                 
              WHEN 23                                                           
                   MOVE 'Y'              TO WS-K050-NOTFND                      
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BB15K050 : ' BB15K050-STATUS             
                   DISPLAY 'NRIC TO BE UPDATED  : ' K050-NUM-UIN                
                   MOVE BB15K050-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4410-READNEXT-BB15K050.                                                  
      *----------------------------------------------------------------*        
           READ BB15K050 NEXT AT END MOVE 'Y' TO WS-K050-EOF                    
                         GO TO 4410-EXIT.                                       
                                                                                
           EVALUATE BB15K050-STATUS                                             
              WHEN 00                                                           
              WHEN 02                                                           
                   IF (K050-NUM-UIN NOT = F558-NUM-NRIC)                        
                      MOVE 'Y'           TO WS-K050-EOF                         
                   ELSE                                                         
                      ADD 1              TO WS-K050-CNT-READ                    
                      MOVE BP13F558-REC  TO P13F558O-REC                        
                      MOVE SPACES        TO L979-DETAILS-LINE                   
                      MOVE K050-NUM-SCH-ACC TO L979-SHOP-NUM-SCH-ACC            
                                               F558O-SHOP-NUM-SCH-ACC           
                      PERFORM 5000-PRT-UPDT-RTN THRU 5000-EXIT                  
                   END-IF                                                       
              WHEN 23                                                           
                   MOVE 'Y'              TO WS-K050-EOF                         
                                            WS-K050-NOTFND                      
              WHEN OTHER                                                        
                   DISPLAY 'READNEXT ERROR BB15K050 : ' BB15K050-STATUS         
                   DISPLAY 'NRIC TO BE UPDATED : ' K050-NUM-UIN                 
                   MOVE BB15K050-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       4410-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       5000-PRT-UPDT-RTN.                                                       
      *----------------------------------------------------------------*        
           WRITE P13F558O-REC.                                                  
           ADD 1                         TO WS-F558O-CNT-WRT.                   
                                                                                
           IF WS-L979-CNT-LINE > 50                                             
              PERFORM 5100-PRINT-HEADER  THRU 5100-EXIT                         
           END-IF.                                                              
                                                                                
           PERFORM 5200-PRINT-DETAILS    THRU 5200-EXIT.                        
      ***  PERFORM 6000-UPDATE-BP13K730  THRU 6000-EXIT.                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       5100-PRINT-HEADER.                                                       
      *----------------------------------------------------------------*        
      *----------------------------------------------------------------*        
      *  PRINTS THE PAGE HEADER.                                       *        
      *----------------------------------------------------------------*        
           ADD  1                        TO WS-L979-CNT-PAGE.                   
           MOVE WS-L979-CNT-PAGE         TO L979-PAGE-NUM.                      
           MOVE 1                        TO WS-L979-CNT-LINE.                   
                                                                                
           WRITE BP13L979-REC    FROM L979-HEADING1                             
                 AFTER ADVANCING PAGE.                                          
           WRITE BP13L979-REC    FROM L979-HEADING2                             
                 AFTER ADVANCING 1 LINE.                                        
           WRITE BP13L979-REC    FROM L979-COL-HEADING1                         
                 AFTER ADVANCING 2 LINES.                                       
           WRITE BP13L979-REC    FROM L979-COL-HEADING2                         
                 AFTER ADVANCING 1 LINES.                                       
           WRITE BP13L979-REC    FROM L979-HORIZONTAL-LINE                      
                 AFTER ADVANCING 1 LINE.                                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------------------------------------------------*        
       5200-PRINT-DETAILS.                                                      
      *----------------------------------------------------------------*        
      *----------------------------------------------------------------*        
      *  PRINTS THE DETAILS                                            *        
      *----------------------------------------------------------------*        
           ADD  1                        TO WS-L979-CNT-REC.                    
           MOVE WS-L979-CNT-REC          TO L979-NUM-SERIAL.                    
           MOVE F558-NUM-REF             TO L979-NUM-REF.                       
           MOVE F558-NUM-NRIC            TO L979-NUM-NRIC.                      
           MOVE F558-NUM-ZONE-NT-SOC     TO L979-NUM-ZONE.                      
           MOVE F558-NUM-FLAT-TY-SOC     TO L979-NUM-FLAT-TYPE.                 
                                                                                
           WRITE BP13L979-REC FROM L979-DETAILS-LINE                            
                 AFTER ADVANCING 1 LINE.                                        
                                                                                
           ADD 1                         TO WS-L979-CNT-LINE.                   
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       6000-UPDATE-BP13K730.                                                    
      *----------------------------------------------------------------*        
           MOVE F558-NUM-REF             TO K730-KEY-NEW.                       
                                                                                
           READ BP13K730 KEY IS K730-KEY-NEW.                                   
                                                                                
           EVALUATE  BP13K730-STATUS                                            
              WHEN 00                                                           
                   MOVE 'A'              TO K730-CDE-RESIDENT-HA1               
      ***          REWRITE BP13K730-REC                                         
                   ADD 1                 TO WS-K730-CNT-UPDT                    
              WHEN 23                                                           
                   DISPLAY 'BP13K730 RECORD NOT FOUND : ' K730-NUM-REGN         
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BP13K730 : ' BP13K730-STATUS             
                   DISPLAY 'REFNO TO BE UPDATED : ' K730-NUM-REGN               
                   MOVE BP13K730-STATUS  TO RETURN-CODE                         
                   GO TO 9000-CLOSE-FILES                                       
           END-EVALUATE.                                                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       9000-CLOSE-FILES.                                                        
      *----------------------------------------------------------------*        
                                                                                
           DISPLAY '                                 '.                         
           DISPLAY '+--------<< BP13C979 >>--------+ '.                         
           DISPLAY '          WS-SYSTEM-DATE       '.                         
           DISPLAY '+------------------------------+ '.                         
           DISPLAY 'NO. OF REC READ, BP13F558 = ' WS-F558-CNT-READ.             
           DISPLAY 'NO. OF REC READ, BP13K820 = ' WS-K820-CNT-READ.             
           DISPLAY 'NO. OF REC READ, BP13K800 = ' WS-K800-CNT-READ.             
           DISPLAY 'NO. OF REC READ, BP13K943 = ' WS-K943-CNT-READ.             
           DISPLAY 'NO. OF REC READ, BP18K310 = ' WS-K310-CNT-READ.             
           DISPLAY 'NO. OF REC READ, BB24K110 = ' WS-K110-CNT-READ.             
           DISPLAY 'NO. OF REC READ, BB15K050 = ' WS-K050-CNT-READ.             
           DISPLAY 'NO. OF REC UPDT, BP13K730 = ' WS-K730-CNT-UPDT.             
           DISPLAY 'NO. OF REC WRITTEN, P13F558O = ' WS-F558O-CNT-WRT.          
           DISPLAY 'NO. OF REC PRINTED, BP13L979 = ' WS-L979-CNT-REC.           
                                                                                
           CLOSE BP13F558                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13K943                                                       
                 BP18K310                                                       
                 BB24K110                                                       
                 BB15K050                                                       
                 BP13K730                                                       
                 P13F558O                                                       
                 BP13L979.                                                      
                                                                                
           IF BP13K730-STATUS NOT = 00 AND 97                                   
              DISPLAY "CLOSE BP13K730 FAIL STATUS "  BP13K730-STATUS            
              MOVE BP13K730-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY "CLOSE BP13K800 FAIL STATUS " BP13K800-STATUS             
              MOVE BP13K800-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY "CLOSE BP13K820 FAIL STATUS " BP13K820-STATUS             
              MOVE BP13K820-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K943-STATUS NOT = 00 AND 97                                   
              DISPLAY "CLOSE BP13K943 FAIL STATUS " BP13K943-STATUS             
              MOVE BP13K943-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP18K310-STATUS NOT = 00 AND 97                                   
              DISPLAY "CLOSE BP18K310 FAIL STATUS " BP18K310-STATUS             
              MOVE BP18K310-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BB24K110-STATUS NOT = 00 AND 97                                   
              DISPLAY "CLOSE BB24K110 FAIL STATUS " BB24K110-STATUS             
              MOVE BB24K110-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           IF BB15K050-STATUS NOT = 00 AND 97                                   
              DISPLAY "CLOSE BB15K050 FAIL STATUS " BB15K050-STATUS             
              MOVE BB15K050-STATUS     TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
      * >>>>>>>>>>>>>>>>>>>>>>> END OF BP13C979 <<<<<<<<<<<<<<<<<<<<<< *        
      *----------------------------------------------------------------*        
