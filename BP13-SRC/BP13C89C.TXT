       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C89C.                                                 
       AUTHOR.        LLOYD CAPARRO.                                            
       DATE-WRITTEN.  19/09/2005.                                               
                                                                                
      *************************************************************             
      *  SYSTEM NAME : SYSTEM OF COMMITMENT (BP13)                *             
      *===========================================================*             
      *  OBJECTIVE  :  PRINTING OF PRE E-CHECK REPORT PER SYSTEM  *             
      *                                                           *             
      *  INPUT      :  1.  BP13F740 - BP13.F740.MATUREBA          *             
      *                2.  BP08K000 - BP08.K000.SUMMARY           *             
      *                3.  BP08K001 - BP08.K001.DEBSNAP           *             
      *                4.  BP04K020 - BP04.K020.REASON            *             
      *                5.  BP08K002 - BP08.K002.SMSSNAP           *             
      *                6.  BP08K003 - BP08.K003.PPOSNAP           *             
      *                7.  BP08K004 - BP08.K004.ECSSNAP           *             
      *                8.  BP08K005 - BP08.K005.RDBSNAP           *             
      *                9.  BP08K006 - BP08.K006.RSLSNAP           *             
      *               10.  BP08K007 - BP08.K007.TRFSNAP           *             
      *               11.  BP08K008 - BP08.K008.MAMSNAP           *             
      *               12.  BP08K009 - BP08.K009.SLSSNAP           *             
      *               13.  BP08K010 - BP08.K010.SBTSNAP           *             
      *               14.  BP08K011 - BP08.K011.UTSSNAP           *             
      *               15.  BP08K012 - BP08.K012.SOCSNAP           *             
      *               16.  BP08K013 - BP08.K013.BEBTOSNP          *             
      *               17.  BP13K040 - BP13.K040.APPLSNAP          *             
      *               18.  BP13K042 - BP13.K042.OCCPSNAP          *             
      *               19.  BP13K060 - BP13.K060.CODETAB           *             
      *               20.  BP13K096 - BP13.K096.SECURITY          *             
      *               21.  BP13K800 - BP13.K800.APPLN             *             
      *               22.  BP13KB10 - BP13.KB10.CHKLIST1          *             
      *  OUTPUT     :  1.  BP13L89C - PRE E-CHECK REPORT          *             
      *                2.  P13L89CA - INTERNET CASES W/ PPO       *             
      *                3.  P13L89CB - CONTROL LIST FOR INTERNET   *             
      *                               APPLICATION AND PPO         *             
      *                                                           *             
      *===========================================================*             
      *  REVISION HISTORY :                                       *             
      *  CHGE-NO   OIC   DATE        DESCRIPTION                  *             
      *  --------  ----  ----------  ---------------------------- *             
      *  BP132747  CG7   19/09/2005  NEW PROGRAM                  *             
      *************************************************************             
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT BP13F740     ASSIGN       TO BP13F740.                        
                                                                                
           SELECT BP08K000     ASSIGN       TO BP08K000                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K000-KEY-FLD                     
                               FILE STATUS  IS WS-K000-STATUS.                  
                                                                                
           SELECT BP08K001     ASSIGN       TO BP08K001                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K001-KEY-FLD                     
                               FILE STATUS  IS WS-K001-STATUS.                  
                                                                                
           SELECT P04K020      ASSIGN       TO BP04K020                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K020-DEBAR-CODE                  
                               FILE STATUS  IS WS-K020-STATUS.                  
                                                                                
           SELECT BP08K002     ASSIGN       TO BP08K002                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K002-KEY-FLD                     
                               FILE STATUS  IS WS-K002-STATUS.                  
                                                                                
           SELECT BP08K003     ASSIGN       TO BP08K003                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K003-KEY-FLD                     
                               FILE STATUS  IS WS-K003-STATUS.                  
                                                                                
           SELECT BP08K004     ASSIGN       TO BP08K004                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K004-KEY-FLD                     
                               FILE STATUS  IS WS-K004-STATUS.                  
                                                                                
           SELECT BP08K005     ASSIGN       TO BP08K005                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K005-APPL-KEY-FLD                
                               FILE STATUS  IS WS-K005-STATUS.                  
                                                                                
           SELECT BP08K006     ASSIGN       TO BP08K006                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K006-KEY-FLD                     
                               FILE STATUS  IS WS-K006-STATUS.                  
                                                                                
           SELECT BP08K007     ASSIGN       TO BP08K007                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K007-KEY-FLD                     
                               FILE STATUS  IS WS-K007-STATUS.                  
                                                                                
           SELECT BP08K008     ASSIGN       TO BP08K008                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K008-KEY-FLD                     
                               FILE STATUS  IS WS-K008-STATUS.                  
                                                                                
           SELECT BP08K009     ASSIGN       TO BP08K009                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K009-KEY-FLD                     
                               FILE STATUS  IS WS-K009-STATUS.                  
                                                                                
           SELECT BP08K010     ASSIGN       TO BP08K010                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K010-APPL-KEY-FLD                
                               FILE STATUS  IS WS-K010-STATUS.                  
                                                                                
           SELECT BP08K011     ASSIGN       TO BP08K011                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K011-KEY-FLD                     
                               FILE STATUS  IS WS-K011-STATUS.                  
                                                                                
           SELECT BP08K012     ASSIGN       TO BP08K012                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K012-KEY-FLD                     
                               FILE STATUS  IS WS-K012-STATUS.                  
                                                                                
           SELECT BP08K013     ASSIGN       TO BP08K013                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K013-KEY-FLD                     
                               FILE STATUS  IS WS-K013-STATUS.                  
                                                                                
           SELECT BP13K040     ASSIGN       TO BP13K040                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K040-KEY-FLD                     
                               FILE STATUS  IS WS-K040-STATUS.                  
                                                                                
           SELECT BP13K042     ASSIGN       TO BP13K042                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K042-KEY-FLD                     
                               FILE STATUS  IS WS-K042-STATUS.                  
                                                                                
           SELECT BP13K060     ASSIGN       TO BP13K060                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K060-KEY-FLD                     
                               FILE STATUS  IS WS-K060-STATUS.                  
                                                                                
           SELECT BP13KB10     ASSIGN       TO BP13KB10                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS KB10-KEY-FLD                     
                               FILE STATUS  IS WS-KB10-STATUS.                  
                                                                                
           SELECT BP13K096     ASSIGN       TO BP13K096                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K096-NUM-KEY                     
                               FILE STATUS  IS WS-K096-STATUS.                  
                                                                                
           SELECT BP13K800     ASSIGN       TO BP13K800                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K800-NUM-REGN                    
                               FILE STATUS  IS WS-K800-STATUS.                  
                                                                                
           SELECT BP13L89C     ASSIGN       TO BP13L89C.                        
                                                                                
           SELECT P13L89CA     ASSIGN       TO P13L89CA.                        
                                                                                
           SELECT P13L89CB     ASSIGN       TO P13L89CB.                        
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F740           IS GLOBAL                                        
                               RECORD CONTAINS 500 CHARACTERS                   
                               LABEL RECORDS IS STANDARD                        
                               RECORDING MODE IS F.                             
       COPY BP13F740.                                                           
                                                                                
       FD   BP08K000           IS GLOBAL                                        
                               RECORD CONTAINS 800 CHARACTERS.                  
                                                                                
       COPY BP08K000.                                                           
                                                                                
       FD   BP08K001           IS GLOBAL                                        
                               RECORD CONTAINS 500 CHARACTERS.                  
                                                                                
       COPY BP08K001.                                                           
                                                                                
       FD   P04K020            IS GLOBAL                                        
                               RECORD CONTAINS 800 CHARACTERS.                  
                                                                                
       COPY P04K020.                                                            
                                                                                
       FD   BP08K002           IS GLOBAL                                        
                               RECORD CONTAINS 1000 CHARACTERS.                 
                                                                                
       COPY BP08K002.                                                           
                                                                                
       FD   BP08K003           IS GLOBAL                                        
                               RECORD CONTAINS 500 CHARACTERS.                  
                                                                                
       COPY BP08K003.                                                           
                                                                                
       FD   BP08K004           IS GLOBAL                                        
                               RECORD CONTAINS 500 CHARACTERS.                  
                                                                                
       COPY BP08K004.                                                           
                                                                                
       FD   BP08K005           IS GLOBAL                                        
                               RECORD CONTAINS 400 CHARACTERS.                  
                                                                                
       COPY BP08K005.                                                           
                                                                                
       FD   BP08K006           IS GLOBAL                                        
                               RECORD CONTAINS 1000 CHARACTERS.                 
                                                                                
       COPY BP08K006.                                                           
                                                                                
       FD   BP08K007           IS GLOBAL                                        
                               RECORD CONTAINS 800 CHARACTERS.                  
                                                                                
       COPY BP08K007.                                                           
                                                                                
       FD   BP08K008           IS GLOBAL                                        
                               RECORD CONTAINS 800 CHARACTERS.                  
                                                                                
       COPY BP08K008.                                                           
                                                                                
       FD   BP08K009           IS GLOBAL                                        
                               RECORD CONTAINS 500 CHARACTERS.                  
                                                                                
       COPY BP08K009.                                                           
                                                                                
       FD   BP08K010           IS GLOBAL                                        
                               RECORD CONTAINS 300 CHARACTERS.                  
                                                                                
       COPY BP08K010.                                                           
                                                                                
       FD   BP08K011           IS GLOBAL                                        
                               RECORD CONTAINS 500 CHARACTERS.                  
                                                                                
       COPY BP08K011.                                                           
                                                                                
       FD   BP08K012           IS GLOBAL                                        
                               RECORD CONTAINS 600 CHARACTERS.                  
                                                                                
       COPY BP08K012.                                                           
                                                                                
       FD   BP08K013           IS GLOBAL                                        
                               RECORD CONTAINS 600 CHARACTERS.                  
                                                                                
       COPY BP08K013.                                                           
                                                                                
       FD   BP13K040           IS GLOBAL                                        
                               RECORD CONTAINS 400 CHARACTERS.                  
                                                                                
       COPY BP13K040.                                                           
                                                                                
       FD   BP13K042           IS GLOBAL                                        
                               RECORD CONTAINS 700 CHARACTERS.                  
                                                                                
       COPY BP13K042.                                                           
                                                                                
       FD   BP13K060           IS GLOBAL                                        
                               RECORD CONTAINS 25 CHARACTERS.                   
                                                                                
       COPY BP13K060.                                                           
                                                                                
       FD   BP13KB10           IS GLOBAL                                        
                               RECORD CONTAINS 2000 CHARACTERS.                 
                                                                                
       COPY BP13KB10.                                                           
                                                                                
       FD   BP13K096           IS GLOBAL                                        
                               RECORD CONTAINS 200 CHARACTERS.                  
                                                                                
       COPY BP13K096.                                                           
                                                                                
       FD   BP13K800           IS GLOBAL                                        
                               RECORD CONTAINS 2000 CHARACTERS.                 
                                                                                
       COPY BP13K800.                                                           
                                                                                
       FD   BP13L89C                                                            
                               RECORD CONTAINS 133 CHARACTERS                   
                               LABEL RECORDS IS STANDARD                        
                               RECORDING MODE IS F.                             
       01  L89C-PRINT-REC                PIC X(133) GLOBAL.                     
                                                                                
       FD   P13L89CA                                                            
                               RECORD CONTAINS 132 CHARACTERS                   
                               LABEL RECORDS IS STANDARD                        
                               RECORDING MODE IS F.                             
       01   P13L89CA-REC                 PIC X(132) GLOBAL.                     
                                                                                
       FD   P13L89CB                                                            
                               RECORD CONTAINS 132  CHARACTERS                  
                               LABEL RECORDS IS STANDARD                        
                               RECORDING MODE IS F.                             
       01   P13L89CB-REC                 PIC X(132) GLOBAL.                     
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-FILE-STATUS-G GLOBAL.                                             
           05  WS-KB10-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K000-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K001-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K020-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K002-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K003-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K004-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K005-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K006-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K007-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K008-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K009-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K010-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K011-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K012-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K013-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K040-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K042-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K060-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K096-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K800-STATUS            PIC 9(02)  VALUE ZEROES.               
                                                                                
       01  WS-FILE-SWITCHES.                                                    
           05  WS-F740-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-REC-PROCESS            PIC X(01)  VALUE 'N'.                  
           05  WS-K800-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-KB10-FND               PIC X(01)  VALUE 'N'.                  
                                                                                
       01  WS-FILE-SWITCHES-G GLOBAL.                                           
           05  WS-K000-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K001-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K002-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K003-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K004-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K005-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K006-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K007-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K008-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K009-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K010-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K011-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K012-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K013-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K040-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K042-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-KB10-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-KB10-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-F740-PROCESS           PIC 9(08)  VALUE ZEROES.               
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F740-READ-CNT          PIC 9(08)  VALUE ZEROES.               
           05  WS-F740-BYPASS            PIC 9(08)  VALUE ZEROES.               
           05  WS-K000-NFND-CNT          PIC 9(08)  VALUE ZEROES.               
           05  WS-K000-DTE-TME           PIC X(16)  VALUE SPACES.               
                                                                                
       01  WS-VARIABLES-G GLOBAL.                                               
           05  WS-CURRENT-DATE           PIC X(08)  VALUE SPACES.               
           05  WS-TOT-PAGE-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-CASE-PAGE-CNT          PIC 9(03)  VALUE ZEROES.               
           05  WS-CURR-DATE              PIC X(10)  VALUE SPACES.               
           05  WS-RECORD-KEY.                                                   
               10  WS-REC-SYSID          PIC X(04)  VALUE SPACES.               
               10  WS-REC-ACCESS-KEY     PIC X(20)  VALUE SPACES.               
               10  WS-REC-DTE-TME.                                              
                   15  WS-REC-DTE        PIC X(08)  VALUE SPACES.               
                   15  WS-REC-TME        PIC X(08)  VALUE SPACES.               
               10  WS-REC-USERID         PIC X(08)  VALUE SPACES.               
           05  WS-REC-KEY-DTE            PIC X(10)  VALUE SPACES.               
           05  WS-REC-KEY-TME            PIC X(08)  VALUE SPACES.               
           05  WS-KB10-FND-CNT           PIC 9(08)  VALUE ZEROES.               
           05  WS-KB10-NFND-CNT          PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-LINE-ON-PAGE-A     PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-LINE-ON-PAGE-B     PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-PRINT-L830A        PIC 9(08)  VALUE 1.                    
           05  WS-CNT-PRINT-L830B        PIC 9(08)  VALUE 1.                    
           05  WS-CNT-WRITE-L830A        PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-WRITE-L830B        PIC 9(08)  VALUE ZEROES.               
           05  WS-NO-OF-PAGE-A           PIC 9(08)  VALUE ZEROES.               
           05  WS-NO-OF-PAGE-B           PIC 9(08)  VALUE ZEROES.               
           05  WS-TOT-LET-PRINT          PIC 9(06)  VALUE ZEROES.               
           05  WS-REC-SKIPPED            PIC 9(06)  VALUE ZEROES.               
           05  WS-FORM-PRTED             PIC 9(06)  VALUE ZEROES.               
           05  WS-HH                     PIC X(01)  VALUE SPACES.               
           05  WS-FT                     PIC X(01)  VALUE SPACES.               
                                                                                
      *-----------------------                                                  
      *  REPORTS PRINTED IN REGISTRATION SEQUENCE BUT                           
      *  CHECKLIST STORED AS REFERENCE NUMBER                                   
      *  USING BP13F740 TO ACCESS BY REF NO AND REGNO                           
      *-----------------------                                                  
       PROCEDURE DIVISION.                                                      
      ************************************************************              
       0000-MAIN.                                                               
      ************************************************************              
           PERFORM 1000-OPEN-ROUTINE THRU 1000-EXIT.                            
           PERFORM 2000-READ-BP13F740 THRU 2000-EXIT.                           
           PERFORM 3000-PROCESS-RECORD THRU 3000-EXIT                           
             UNTIL WS-F740-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ************************************************************              
       1000-OPEN-ROUTINE.                                                       
      ************************************************************              
           OPEN INPUT  BP13F740                                                 
                       BP08K000                                                 
                       BP08K001                                                 
                       P04K020                                                  
                       BP08K002                                                 
                       BP08K003                                                 
                       BP08K004                                                 
                       BP08K005                                                 
                       BP08K006                                                 
                       BP08K007                                                 
                       BP08K008                                                 
                       BP08K009                                                 
                       BP08K010                                                 
                       BP08K011                                                 
                       BP08K012                                                 
                       BP08K013                                                 
                       BP13K040                                                 
                       BP13K042                                                 
                       BP13K060                                                 
                       BP13K096                                                 
                       BP13K800                                                 
                       BP13KB10                                                 
                OUTPUT BP13L89C                                                 
                       P13L89CA                                                 
                       P13L89CB.                                                
                                                                                
           IF WS-K000-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K000 OPEN ERROR, STATUS ' WS-K000-STATUS             
              MOVE WS-K000-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K001-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K001 OPEN ERROR, STATUS ' WS-K001-STATUS             
              MOVE WS-K001-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K020-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP04K020 OPEN ERROR, STATUS ' WS-K020-STATUS             
              MOVE WS-K020-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K002-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K002 OPEN ERROR, STATUS ' WS-K002-STATUS             
              MOVE WS-K002-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K003-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K003 OPEN ERROR, STATUS ' WS-K003-STATUS             
              MOVE WS-K003-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K004-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K004 OPEN ERROR, STATUS ' WS-K004-STATUS             
              MOVE WS-K004-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K005-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K005 OPEN ERROR, STATUS ' WS-K005-STATUS             
              MOVE WS-K005-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K006-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K006 OPEN ERROR, STATUS ' WS-K006-STATUS             
              MOVE WS-K006-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K007-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K007 OPEN ERROR, STATUS ' WS-K007-STATUS             
              MOVE WS-K007-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K008-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K008 OPEN ERROR, STATUS ' WS-K008-STATUS             
              MOVE WS-K008-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K009-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K009 OPEN ERROR, STATUS ' WS-K009-STATUS             
              MOVE WS-K009-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K010 OPEN ERROR, STATUS ' WS-K010-STATUS             
              MOVE WS-K010-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K011-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K011 OPEN ERROR, STATUS ' WS-K011-STATUS             
              MOVE WS-K011-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K012-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K012 OPEN ERROR, STATUS ' WS-K012-STATUS             
              MOVE WS-K012-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K013-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K013 OPEN ERROR, STATUS ' WS-K013-STATUS             
              MOVE WS-K013-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K040-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K040 OPEN ERROR, STATUS ' WS-K040-STATUS             
              MOVE WS-K040-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K042-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K042 OPEN ERROR, STATUS ' WS-K042-STATUS             
              MOVE WS-K042-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K060-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP08K060 OPEN ERROR, STATUS ' WS-K060-STATUS             
              MOVE WS-K060-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-KB10-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13KB10 OPEN ERROR, STATUS ' WS-KB10-STATUS             
              MOVE WS-KB10-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K096-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K096 OPEN ERROR, STATUS ' WS-K096-STATUS             
              MOVE WS-K096-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 OPEN ERROR, STATUS ' WS-K800-STATUS             
              MOVE WS-K800-STATUS        TO RETURN-CODE                         
                                                                                
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE.                  
                                                                                
           STRING WS-CURRENT-DATE(7:2) '/'                                      
                  WS-CURRENT-DATE(5:2) '/'                                      
                  WS-CURRENT-DATE(1:4)                                          
                  DELIMITED BY SIZE                                             
             INTO WS-CURR-DATE.                                                 
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       2000-READ-BP13F740.                                                      
      ************************************************************              
           READ BP13F740                                                        
             AT END                                                             
                MOVE 'Y'                 TO WS-F740-EOF                         
            NOT AT END                                                          
                ADD 1                    TO WS-F740-READ-CNT                    
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       3000-PROCESS-RECORD.                                                     
      ************************************************************              
           PERFORM 3050-READ-BP13K800           THRU 3050-EXIT.                 
      *    PERFORM 3100-STARTBR-BP13KB10        THRU 3100-EXIT.                 
                                                                                
           IF WS-K800-FND = 'N'                                                 
      *       WS-KB10-FND = 'N'                                                 
              ADD 1 TO WS-F740-BYPASS                                           
              PERFORM 2000-READ-BP13F740 THRU 2000-EXIT                         
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE ZEROES                   TO WS-CASE-PAGE-CNT.                   
           MOVE SPACES                   TO WS-RECORD-KEY                       
                                            WS-K000-DTE-TME                     
                                            WS-REC-DTE-TME                      
           MOVE 'N'                      TO WS-K000-EOF                         
                                            WS-REC-PROCESS.                     
                                                                                
           PERFORM 4000-STARTBR-BP08K000 THRU 4000-EXIT.                        
                                                                                
           IF WS-RECORD-KEY NOT = SPACES                                        
              STRING WS-REC-DTE(7:2) '/'                                        
                     WS-REC-DTE(5:2) '/'                                        
                     WS-REC-DTE(1:4)                                            
                     DELIMITED BY SIZE                                          
                INTO WS-REC-KEY-DTE                                             
                                                                                
              STRING WS-REC-TME(1:2) ':'                                        
                     WS-REC-TME(3:2) ':'                                        
                     WS-REC-TME(5:2)                                            
                     DELIMITED BY SIZE                                          
                INTO WS-REC-KEY-TME                                             
                                                                                
              CALL 'BP13CR00'                                                   
              CALL 'BP13CR01'                                                   
              CALL 'BP13CR02'                                                   
              CALL 'BP13CR03'                                                   
              CALL 'BP13CR04'                                                   
              CALL 'BP13CR05'                                                   
              CALL 'BP13CR06'                                                   
              CALL 'BP13CR07'                                                   
              CALL 'BP13CR08'                                                   
              CALL 'BP13CR09'                                                   
              CALL 'BP13CR10'                                                   
              CALL 'BP13CR11'                                                   
              CALL 'BP13CR12'                                                   
              CALL 'BP13CR13'                                                   
              CALL 'BP13CR40'                                                   
              CALL 'BP13CR42'                                                   
              CALL 'BP13CR14'                                                   
                                                                                
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F740 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3050-READ-BP13K800.                                                      
      ************************************************************              
           MOVE F740-NUM-REGN TO K800-NUM-REGN.                                 
           READ BP13K800.                                                       
           EVALUATE WS-K800-STATUS                                              
             WHEN   00                                                          
                    IF K800-NUM-STATUS = 'C'                                    
                       MOVE 'N' TO WS-K800-FND                                  
                    ELSE                                                        
                       MOVE 'Y' TO WS-K800-FND                                  
                    END-IF                                                      
             WHEN   23                                                          
                    MOVE 'N' TO WS-K800-FND                                     
             WHEN   OTHER                                                       
                    DISPLAY 'READ BP13K800 ERROR ' K800-NUM-REGN                
                    DISPLAY 'STATUS ' WS-K800-STATUS                            
                    MOVE WS-K800-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       4000-STARTBR-BP08K000.                                                   
      ************************************************************              
           MOVE SPACES                   TO BP08K000-REC.                       
           INITIALIZE                       BP08K000-REC.                       
                                                                                
           MOVE 'BP13'                   TO K000-NUM-SYSID.                     
           MOVE F740-NUM-REF             TO K000-NUM-ACCESS-KEY(1:8).           
                                                                                
           START BP08K000 KEY >= K000-KEY-FLD.                                  
                                                                                
           EVALUATE WS-K000-STATUS                                              
               WHEN 00                                                          
                    PERFORM 4500-READNEXT-BP08K000 THRU 4500-EXIT               
                      UNTIL K000-NUM-ACCESS-KEY(1:8) NOT =                      
                                         F740-NUM-REF                           
                         OR WS-K000-EOF = 'Y'                                   
               WHEN 10                                                          
               WHEN 23                                                          
                    DISPLAY 'REGN NO. NOT FOUND IN BP08K000. REGN = '           
                            F740-NUM-REF                                        
               WHEN OTHER                                                       
                    DISPLAY 'READ ERROR BP08K000, STATUS '                      
                            WS-K000-STATUS                                      
                    MOVE WS-K000-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       4500-READNEXT-BP08K000.                                                  
      ************************************************************              
           READ BP08K000 NEXT RECORD.                                           
                                                                                
           EVALUATE WS-K000-STATUS                                              
               WHEN 00                                                          
                    IF K000-NUM-ACCESS-KEY(1:8) = F740-NUM-REF                  
                       MOVE 'Y'          TO WS-REC-PROCESS                      
                                                                                
                       STRING K000-DTE-SNAP                                     
                              K000-TME-SNAP                                     
                              DELIMITED BY SIZE                                 
                         INTO WS-K000-DTE-TME                                   
                                                                                
                       IF WS-K000-DTE-TME > WS-REC-DTE-TME                      
                          MOVE K000-KEY-FLD TO WS-RECORD-KEY                    
                       END-IF                                                   
                    ELSE                                                        
                       IF WS-REC-PROCESS = 'N'                                  
                          ADD 1          TO WS-K000-NFND-CNT                    
                       END-IF                                                   
                                                                                
                       MOVE 'Y'          TO WS-K000-EOF                         
                    END-IF                                                      
               WHEN 10                                                          
                    MOVE 'Y'             TO WS-K000-EOF                         
               WHEN 23                                                          
                    DISPLAY 'REGN NO. NOT FOUND IN BP08K000. REGN = '           
                            F740-NUM-REF                                        
                    MOVE 'Y'             TO WS-K000-EOF                         
               WHEN OTHER                                                       
                    DISPLAY 'READ NEXT ERROR BP08K000, STATUS '                 
                            WS-K000-STATUS                                      
                    MOVE WS-K000-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       9000-CLOSE-ROUTINE.                                                      
      ************************************************************              
           DISPLAY ' '.                                                         
           DISPLAY 'PROGRAM  : BP13C89C'.                                       
           DISPLAY 'RUN DATE : ' WS-CURR-DATE.                                  
           DISPLAY ' '.                                                         
           DISPLAY '        BP13C89C CONTROL TOTALS        '.                   
           DISPLAY '---------------------------------------'.                   
           DISPLAY ' NO. OF RECS READ      (F740) : ' WS-F740-READ-CNT.         
           DISPLAY ' NO. OF RECS BYPASS    (F740) : ' WS-F740-BYPASS.           
           DISPLAY ' NO. OF RECS PROCESS   (F740) : ' WS-F740-PROCESS.          
           DISPLAY ' '.                                                         
           DISPLAY ' NO. OF RECS FND       (KB10) : ' WS-KB10-FND-CNT.          
           DISPLAY ' NO. OF RECS NOT FND   (KB10) : ' WS-KB10-NFND-CNT.         
           DISPLAY ' '.                                                         
           DISPLAY ' NO. OF TOTAL LETTERS WRITTEN : ' WS-TOT-LET-PRINT.         
           DISPLAY ' NO. OF QUESTIONNAIRE PRINTED : ' WS-FORM-PRTED.            
           DISPLAY ' NO. OF RECS NOT FOUND (K000) : ' WS-K000-NFND-CNT.         
           DISPLAY ' NO. OF TOTAL PAGES WRITTEN   : ' WS-TOT-PAGE-CNT.          
           DISPLAY ' '.                                                         
                                                                                
           CLOSE BP13F740                                                       
                 BP08K000                                                       
                 BP08K001                                                       
                 P04K020                                                        
                 BP08K002                                                       
                 BP08K003                                                       
                 BP08K004                                                       
                 BP08K005                                                       
                 BP08K006                                                       
                 BP08K007                                                       
                 BP08K008                                                       
                 BP08K009                                                       
                 BP08K010                                                       
                 BP08K011                                                       
                 BP08K012                                                       
                 BP08K013                                                       
                 BP13K040                                                       
                 BP13K042                                                       
                 BP13K060                                                       
                 BP13KB10                                                       
                 BP13K096                                                       
                 BP13K800                                                       
                 BP13L89C                                                       
                 P13L89CA                                                       
                 P13L89CB.                                                      
                                                                                
           IF WS-K000-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K000, STATUS ' WS-K000-STATUS            
              MOVE WS-K000-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K001-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K001, STATUS ' WS-K001-STATUS            
              MOVE WS-K001-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K020-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP04K020, STATUS ' WS-K020-STATUS            
              MOVE WS-K020-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K002-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K002, STATUS ' WS-K002-STATUS            
              MOVE WS-K002-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K003-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K003, STATUS ' WS-K003-STATUS            
              MOVE WS-K003-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K004-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K004, STATUS ' WS-K004-STATUS            
              MOVE WS-K004-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K005-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K005, STATUS ' WS-K005-STATUS            
              MOVE WS-K005-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K006-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K006, STATUS ' WS-K006-STATUS            
              MOVE WS-K006-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K007-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K007, STATUS ' WS-K007-STATUS            
              MOVE WS-K007-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K008-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K008, STATUS ' WS-K008-STATUS            
              MOVE WS-K008-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K009-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K009, STATUS ' WS-K009-STATUS            
              MOVE WS-K009-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K010, STATUS ' WS-K010-STATUS            
              MOVE WS-K010-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K011-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K011, STATUS ' WS-K011-STATUS            
              MOVE WS-K011-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K012-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K012, STATUS ' WS-K012-STATUS            
              MOVE WS-K012-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K013-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP08K013, STATUS ' WS-K013-STATUS            
              MOVE WS-K013-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K040-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K040, STATUS ' WS-K040-STATUS            
              MOVE WS-K040-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K042-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K042, STATUS ' WS-K042-STATUS            
              MOVE WS-K042-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K060-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K060, STATUS ' WS-K060-STATUS            
              MOVE WS-K060-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-KB10-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13KB10, STATUS ' WS-KB10-STATUS            
              MOVE WS-KB10-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K096-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K096, STATUS ' WS-K096-STATUS            
              MOVE WS-K096-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K800, STATUS ' WS-K800-STATUS            
              MOVE WS-K800-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       COPY BP13CR00.                                                           
       COPY BP13CR01.                                                           
       COPY BP13CR02.                                                           
       COPY BP13CR03.                                                           
       COPY BP13CR04.                                                           
       COPY BP13CR05.                                                           
       COPY BP13CR06.                                                           
       COPY BP13CR07.                                                           
       COPY BP13CR08.                                                           
       COPY BP13CR09.                                                           
       COPY BP13CR10.                                                           
       COPY BP13CR11.                                                           
       COPY BP13CR12.                                                           
       COPY BP13CR13.                                                           
       COPY BP13CR40.                                                           
       COPY BP13CR42.                                                           
       COPY BP13CR14.                                                           
       END PROGRAM BP13C89C.                                                    
