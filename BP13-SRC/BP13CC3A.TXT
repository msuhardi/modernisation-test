      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
       PROGRAM-ID.    BP13CC3A.                                                 
      *AUTHOR.        JIANG BO.                                                 
      *DATE-WRITTEN.  11/06/2010.                                               
      *****************************************************************         
      *                                                               *         
      *  SYSTEM NAME  :    SYSTEM OF COMMITMENT   (SOC)               *         
      *                                                               *         
      *  SYSTEM ID    :    BP13                                       *         
      *                                                               *         
      *  OBJECTIVE    :                                               *         
      *                                                               *         
      *  INPUT FILES  :                                               *         
      *                                                               *         
      *  CHGE-NO  BY    DATE    DESCRIPTION                           *         
      *  -------- ---- -------- ------------------------------------  *         
      *  BP133172 JB8  20100611 CONVERT FROM BP13S038                 *         
      *  BP134033 JB8  20101110 TO INIT AMOUNT FIELDS                 *         
      *  BP134089 PCL3 20110209 TO CORRECT PRINTING OF FIN-YEAR       *         
      ******************************************************************        
                                                                                
                                                                                
      ***************************                                               
       ENVIRONMENT    DIVISION.                                                 
      ***************************                                               
                                                                                
       CONFIGURATION  SECTION.                                                  
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT SY02F001  ASSIGN        TO SY02F001.                          
           SELECT BP13FD38  ASSIGN        TO BP13FD38.                          
           SELECT BP13LC3A  ASSIGN        TO BP13LC3A.                          
                                                                                
      *******************                                                       
       DATA DIVISION.                                                           
      *******************                                                       
                                                                                
      *============*                                                            
       FILE SECTION.                                                            
      *============*                                                            
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD   BP13FD38                                                            
            RECORDING MODE  IS   F                                              
            RECORD CONTAINS 400  CHARACTERS.                                    
       COPY BP13FD38.                                                           
                                                                                
       FD   BP13LC3A                                                            
            RECORDING MODE   IS   F                                             
            RECORD CONTAINS  132  CHARACTERS.                                   
       01   BP13LC3A-REC     PIC  X(132).                                       
                                                                                
      *=======================*                                                 
       WORKING-STORAGE SECTION.                                                 
      *=======================*                                                 
                                                                                
       01  WS-VARIABLES.                                                        
           05  CNT-FD38-READ              PIC 9(8)   VALUE ZEROES.              
           05  CNT-FD00-READ              PIC 9(8)   VALUE ZEROES.              
           05  CNT-FD38A-WRITE            PIC 9(8)   VALUE ZEROES.              
           05  CNT-FD00-NOTFND            PIC 9(8)   VALUE ZEROES.              
           05  WS-KA10-STATUS             PIC 99     VALUE ZEROES.              
           05  WS-FD38-EOF                PIC X(01)  VALUE SPACES.              
               88  FD38-EOF                          VALUE 'Y'.                 
           05  WS-FIN-YEAR                PIC 9(04)  VALUE ZEROES.              
           05  WS-FIN-YEAR-NEXT           PIC 9(04)  VALUE ZEROES.              
           05  WS-START-YM                PIC 9(06)  VALUE ZEROES.              
           05  WS-END-YM                  PIC 9(06)  VALUE ZEROES.              
           05  WS-SAVE-PRJCT              PIC X(30)  VALUE SPACES.              
           05  WS-AMT                     PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT2                    PIC 9(5)V99 VALUE ZEROES.             
           05  WS-EDT-AMT                 PIC ZZZ9.99 VALUE ZEROES.             
           05  WS-EDT-AMT2                PIC ZZZZ9.99 VALUE ZEROES.            
                                                                                
       01  WS-AMOUNTS.                                                          
           05  WS-AMT-APR                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-MAY                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-JUN                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-JUL                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-AUG                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-SEP                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-OCT                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-NOV                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-DEC                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-JAN                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-FEB                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-MAR                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-AMT-APR-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-MAY-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-JUN-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-JUL-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-AUG-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-SEP-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-OCT-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-NOV-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-DEC-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-JAN-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-FEB-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-AMT-MAR-ML              PIC 9(4)V99 VALUE ZEROES.             
           05  WS-TOT-APR                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-MAY                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-JUN                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-JUL                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-AUG                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-SEP                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-OCT                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-NOV                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-DEC                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-JAN                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-FEB                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-MAR                 PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-APR-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-MAY-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-JUN-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-JUL-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-AUG-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-SEP-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-OCT-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-NOV-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-DEC-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-JAN-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-FEB-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-MAR-ML              PIC 9(9)V99 VALUE ZEROES.             
           05  WS-TOT-PRJCT               PIC 9(4)V99 VALUE ZEROES.             
                                                                                
       01  LC3A-HEADER01.                                                       
           05  FILLER              PIC X(8)      VALUE 'BP13LC3A'.              
           05  FILLER              PIC X(5)      VALUE SPACES .                 
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(39)     VALUE                          
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER              PIC X(17)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  LC3A-CURR-DATE      PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(2)      VALUE SPACES.                  
                                                                                
       01  LC3A-HEADER02.                                                       
           05  FILLER                     PIC X(45) VALUE SPACES.               
           05  FILLER                     PIC X(37) VALUE                       
               'ACTUAL DBSS LOAN DISBURSEMENTS IN FY '.                         
           05  LC3A-FIN-YEAR              PIC X(04) VALUE SPACES.               
                                                                                
       01  LC3A-FIRST-LINE.                                                     
           05  FILLER                     PIC X(50)  VALUE                      
               '.-------------------------------------------------'.            
           05  FILLER                     PIC X(50)  VALUE                      
               '--------------------------------------------------'.            
           05  FILLER                     PIC X(30)  VALUE                      
               '-----------------------------.'.                                
                                                                                
       01  LC3A-TITLE01.                                                        
           05  FILLER                     PIC X(25)  VALUE                      
                                          '|PROJECT                |'.          
           05  LC3A-APR                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-MAY                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-JUN                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-JUL                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AUG                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-SEP                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-OCT                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-NOV                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-DEC                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-JAN                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-FEB                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-MAR                   PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(10)  VALUE '| TOTAL  |'.        
                                                                                
       01  LC3A-TITLE02.                                                        
           05  FILLER                     PIC X(50)  VALUE                      
               '|                       | ($M)  | ($M)  | ($M)  | '.            
           05  FILLER                     PIC X(50)  VALUE                      
               '($M)  | ($M)  | ($M)  | ($M)  | ($M)  | ($M)  | ($'.            
           05  FILLER                     PIC X(30)  VALUE                      
               'M)  | ($M)  | ($M)  |        |'.                                
                                                                                
       01  LC3A-SEPARATE-LINE.                                                  
           05  FILLER                     PIC X(50)  VALUE                      
               '|-----------------------+-------+-------+-------+-'.            
           05  FILLER                     PIC X(50)  VALUE                      
               '------+-------+-------+-------+-------+-------+---'.            
           05  FILLER                     PIC X(30)  VALUE                      
               '----+-------+-------+--------|'.                                
                                                                                
       01  LC3A-DETAIL-LINE.                                                    
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-PRJCT                 PIC X(23)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-APR               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-MAY               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-JUN               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-JUL               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-AUG               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-SEP               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-OCT               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-NOV               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-DEC               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-JAN               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-FEB               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-MAR               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-AMT-TOTAL             PIC X(08)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
                                                                                
       01  LC3A-TOTAL-LINE.                                                     
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  FILLER                     PIC X(23)  VALUE 'TOTAL'.             
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-APR               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-MAY               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-JUN               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-JUL               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-AUG               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-SEP               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-OCT               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-NOV               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-DEC               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-JAN               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-FEB               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-MAR               PIC X(07)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
           05  LC3A-TOT-TOTAL             PIC X(08)  VALUE SPACES.              
           05  FILLER                     PIC X(01)  VALUE '|'.                 
                                                                                
       01  LC3A-FINAL-LINE.                                                     
           05  FILLER                     PIC X(50)  VALUE                      
               '!-------------------------------------------------'.            
           05  FILLER                     PIC X(50)  VALUE                      
               '--------------------------------------------------'.            
           05  FILLER                     PIC X(30)  VALUE                      
               '-----------------------------!'.                                
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
       0000-MAIN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           PERFORM 1000-OPEN-ROUTINE        THRU 1000-EXIT.                     
           PERFORM 3000-MAIN-PROCESS        THRU 3000-EXIT                      
                   UNTIL FD38-EOF.                                              
           PERFORM 4000-WRITE-REPORT        THRU 4000-EXIT.                     
           PERFORM 4200-WRITE-TOTAL         THRU 4200-EXIT.                     
           PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           OPEN INPUT  SY02F001                                                 
                       BP13FD38                                                 
                OUTPUT BP13LC3A.                                                
                                                                                
           PERFORM 8000-READ-SY02F001       THRU 8000-EXIT.                     
                                                                                
           PERFORM 8001-READ-BP13FD38       THRU 8001-EXIT.                     
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3000-MAIN-PROCESS.                                                       
      ******************************************************************        
                                                                                
           IF FD38-NUM-REGN = SPACES OR LOW-VALUES                              
              PERFORM 8001-READ-BP13FD38    THRU 8001-EXIT                      
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF FD38-DTE-DUE(1:6) <= WS-END-YM  AND                               
              FD38-DTE-DUE(1:6) >= WS-START-YM AND                              
              FD38-AMT-INTEREST-NEWLOAN > 0                                     
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 8001-READ-BP13FD38    THRU 8001-EXIT                      
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF BP13FD38-TRANS-REC(329:30) NOT = WS-SAVE-PRJCT                    
              PERFORM 4000-WRITE-REPORT     THRU 4000-EXIT                      
              MOVE BP13FD38-TRANS-REC(329:30) TO WS-SAVE-PRJCT                  
              MOVE ZEROES     TO WS-AMT-APR  WS-AMT-MAY  WS-AMT-JUN             
                                 WS-AMT-JUL  WS-AMT-AUG  WS-AMT-SEP             
                                 WS-AMT-OCT  WS-AMT-NOV  WS-AMT-DEC             
                                 WS-AMT-JAN  WS-AMT-FEB  WS-AMT-MAR             
           END-IF.                                                              
                                                                                
           EVALUATE FD38-DTE-DUE(5:2)                                           
               WHEN '04'                                                        
                    COMPUTE WS-AMT-APR = WS-AMT-APR + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-APR = WS-TOT-APR + FD38-AMT-LOAN-NEW         
               WHEN '05'                                                        
                    COMPUTE WS-AMT-MAY = WS-AMT-MAY + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-MAY = WS-TOT-MAY + FD38-AMT-LOAN-NEW         
               WHEN '06'                                                        
                    COMPUTE WS-AMT-JUN = WS-AMT-JUN + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-JUN = WS-TOT-JUN + FD38-AMT-LOAN-NEW         
               WHEN '07'                                                        
                    COMPUTE WS-AMT-JUL = WS-AMT-JUL + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-JUL = WS-TOT-JUL + FD38-AMT-LOAN-NEW         
               WHEN '08'                                                        
                    COMPUTE WS-AMT-AUG = WS-AMT-AUG + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-AUG = WS-TOT-AUG + FD38-AMT-LOAN-NEW         
               WHEN '09'                                                        
                    COMPUTE WS-AMT-SEP = WS-AMT-SEP + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-SEP = WS-TOT-SEP + FD38-AMT-LOAN-NEW         
               WHEN '10'                                                        
                    COMPUTE WS-AMT-OCT = WS-AMT-OCT + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-OCT = WS-TOT-OCT + FD38-AMT-LOAN-NEW         
               WHEN '11'                                                        
                    COMPUTE WS-AMT-NOV = WS-AMT-NOV + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-NOV = WS-TOT-NOV + FD38-AMT-LOAN-NEW         
               WHEN '12'                                                        
                    COMPUTE WS-AMT-DEC = WS-AMT-DEC + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-DEC = WS-TOT-DEC + FD38-AMT-LOAN-NEW         
               WHEN '01'                                                        
                    COMPUTE WS-AMT-JAN = WS-AMT-JAN + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-JAN = WS-TOT-JAN + FD38-AMT-LOAN-NEW         
               WHEN '02'                                                        
                    COMPUTE WS-AMT-FEB = WS-AMT-FEB + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-FEB = WS-TOT-FEB + FD38-AMT-LOAN-NEW         
               WHEN '03'                                                        
                    COMPUTE WS-AMT-MAR = WS-AMT-MAR + FD38-AMT-LOAN-NEW         
                    COMPUTE WS-TOT-MAR = WS-TOT-MAR + FD38-AMT-LOAN-NEW         
           END-EVALUATE                                                         
                                                                                
           PERFORM 8001-READ-BP13FD38       THRU 8001-EXIT.                     
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4000-WRITE-REPORT.                                                       
      ******************************************************************        
                                                                                
           IF WS-SAVE-PRJCT = SPACES OR LOW-VALUES                              
              PERFORM 4100-WRITE-HEADER      THRU 4100-EXIT                     
              GO TO 4000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE WS-SAVE-PRJCT        TO LC3A-PRJCT                              
                                                                                
           MOVE ZEROES               TO WS-AMT-APR-ML WS-AMT-MAY-ML             
                                        WS-AMT-JUN-ML WS-AMT-JUL-ML             
                                        WS-AMT-AUG-ML WS-AMT-SEP-ML             
                                        WS-AMT-OCT-ML WS-AMT-NOV-ML             
                                        WS-AMT-DEC-ML WS-AMT-JAN-ML             
                                        WS-AMT-FEB-ML WS-AMT-MAR-ML             
           IF WS-AMT-APR > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-APR / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-APR-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-APR                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-APR                            
           END-IF                                                               
           IF WS-AMT-MAY > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-MAY / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-MAY-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-MAY                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-MAY                            
           END-IF                                                               
           IF WS-AMT-JUN > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-JUN / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-JUN-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-JUN                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-JUN                            
           END-IF                                                               
           IF WS-AMT-JUL > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-JUL / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-JUL-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-JUL                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-JUL                            
           END-IF                                                               
           IF WS-AMT-AUG > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-AUG / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-AUG-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-AUG                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-AUG                            
           END-IF                                                               
           IF WS-AMT-SEP > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-SEP / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-SEP-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-SEP                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-SEP                            
           END-IF                                                               
           IF WS-AMT-OCT > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-OCT / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-OCT-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-OCT                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-OCT                            
           END-IF                                                               
           IF WS-AMT-NOV > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-NOV / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-NOV-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-NOV                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-NOV                            
           END-IF                                                               
           IF WS-AMT-DEC > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-DEC / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-DEC-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-DEC                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-DEC                            
           END-IF                                                               
           IF WS-AMT-JAN > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-JAN / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-JAN-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-JAN                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-JAN                            
           END-IF                                                               
           IF WS-AMT-FEB > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-FEB / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-FEB-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-FEB                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-FEB                            
           END-IF                                                               
           IF WS-AMT-MAR > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-AMT-MAR / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-AMT-MAR-ML                           
              MOVE WS-EDT-AMT        TO LC3A-AMT-MAR                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-AMT-MAR                            
           END-IF                                                               
           COMPUTE WS-TOT-PRJCT = WS-AMT-APR-ML + WS-AMT-MAY-ML +               
                                  WS-AMT-JUN-ML + WS-AMT-JUL-ML +               
                                  WS-AMT-AUG-ML + WS-AMT-SEP-ML +               
                                  WS-AMT-OCT-ML + WS-AMT-NOV-ML +               
                                  WS-AMT-DEC-ML + WS-AMT-JAN-ML +               
                                  WS-AMT-FEB-ML + WS-AMT-MAR-ML                 
           MOVE WS-TOT-PRJCT         TO WS-EDT-AMT2                             
           MOVE WS-EDT-AMT2          TO LC3A-AMT-TOTAL.                         
                                                                                
           WRITE BP13LC3A-REC FROM LC3A-DETAIL-LINE.                            
           WRITE BP13LC3A-REC FROM LC3A-SEPARATE-LINE.                          
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4100-WRITE-HEADER.                                                       
      ******************************************************************        
                                                                                
           MOVE WS-FIN-YEAR   TO LC3A-FIN-YEAR                                  
           STRING WS-FIN-YEAR '-04' DELIMITED BY SIZE INTO LC3A-APR             
           STRING WS-FIN-YEAR '-05' DELIMITED BY SIZE INTO LC3A-MAY             
           STRING WS-FIN-YEAR '-06' DELIMITED BY SIZE INTO LC3A-JUN             
           STRING WS-FIN-YEAR '-07' DELIMITED BY SIZE INTO LC3A-JUL             
           STRING WS-FIN-YEAR '-08' DELIMITED BY SIZE INTO LC3A-AUG             
           STRING WS-FIN-YEAR '-09' DELIMITED BY SIZE INTO LC3A-SEP             
           STRING WS-FIN-YEAR '-10' DELIMITED BY SIZE INTO LC3A-OCT             
           STRING WS-FIN-YEAR '-11' DELIMITED BY SIZE INTO LC3A-NOV             
           STRING WS-FIN-YEAR '-12' DELIMITED BY SIZE INTO LC3A-DEC             
           STRING WS-FIN-YEAR-NEXT '-01' DELIMITED BY SIZE INTO LC3A-JAN        
           STRING WS-FIN-YEAR-NEXT '-02' DELIMITED BY SIZE INTO LC3A-FEB        
           STRING WS-FIN-YEAR-NEXT '-03' DELIMITED BY SIZE INTO LC3A-MAR        
                                                                                
           MOVE SPACES        TO BP13LC3A-REC                                   
           WRITE BP13LC3A-REC                      AFTER PAGE.                  
           WRITE BP13LC3A-REC FROM LC3A-HEADER01   AFTER 3.                     
           WRITE BP13LC3A-REC FROM LC3A-HEADER02.                               
           WRITE BP13LC3A-REC FROM LC3A-FIRST-LINE AFTER 2.                     
           WRITE BP13LC3A-REC FROM LC3A-TITLE01.                                
           WRITE BP13LC3A-REC FROM LC3A-TITLE02.                                
           WRITE BP13LC3A-REC FROM LC3A-SEPARATE-LINE.                          
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4200-WRITE-TOTAL.                                                        
      ******************************************************************        
                                                                                
           IF WS-TOT-APR > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-APR / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-APR-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-APR                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-APR                            
           END-IF                                                               
           IF WS-TOT-MAY > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-MAY / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-MAY-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-MAY                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-MAY                            
           END-IF                                                               
           IF WS-TOT-JUN > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-JUN / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-JUN-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-JUN                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-JUN                            
           END-IF                                                               
           IF WS-TOT-JUL > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-JUL / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-JUL-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-JUL                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-JUL                            
           END-IF                                                               
           IF WS-TOT-AUG > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-AUG / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-AUG-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-AUG                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-AUG                            
           END-IF                                                               
           IF WS-TOT-SEP > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-SEP / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-SEP-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-SEP                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-SEP                            
           END-IF                                                               
           IF WS-TOT-OCT > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-OCT / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-OCT-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-OCT                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-OCT                            
           END-IF                                                               
           IF WS-TOT-NOV > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-NOV / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-NOV-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-NOV                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-NOV                            
           END-IF                                                               
           IF WS-TOT-DEC > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-DEC / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-DEC-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-DEC                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-DEC                            
           END-IF                                                               
           IF WS-TOT-JAN > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-JAN / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-JAN-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-JAN                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-JAN                            
           END-IF                                                               
           IF WS-TOT-FEB > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-FEB / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-FEB-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-FEB                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-FEB                            
           END-IF                                                               
           IF WS-TOT-MAR > 0                                                    
              COMPUTE WS-AMT ROUNDED = WS-TOT-MAR / 1000000                     
              MOVE WS-AMT            TO WS-EDT-AMT                              
                                        WS-TOT-MAR-ML                           
              MOVE WS-EDT-AMT        TO LC3A-TOT-MAR                            
           ELSE                                                                 
              MOVE '   -   '         TO LC3A-TOT-MAR                            
           END-IF                                                               
           COMPUTE WS-TOT-PRJCT = WS-TOT-APR-ML + WS-TOT-MAY-ML +               
                                  WS-TOT-JUN-ML + WS-TOT-JUL-ML +               
                                  WS-TOT-AUG-ML + WS-TOT-SEP-ML +               
                                  WS-TOT-OCT-ML + WS-TOT-NOV-ML +               
                                  WS-TOT-DEC-ML + WS-TOT-JAN-ML +               
                                  WS-TOT-FEB-ML + WS-TOT-MAR-ML                 
           MOVE WS-TOT-PRJCT         TO WS-EDT-AMT2                             
           MOVE WS-EDT-AMT2          TO LC3A-TOT-TOTAL.                         
                                                                                
           WRITE BP13LC3A-REC FROM LC3A-TOTAL-LINE.                             
           WRITE BP13LC3A-REC FROM LC3A-FINAL-LINE.                             
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       8000-READ-SY02F001.                                                      
      ******************************************************************        
                                                                                
           READ SY02F001.                                                       
                                                                                
           IF F001-LST-PREV-MM > 03                                             
              MOVE F001-DTE-LAST-DAY-PREV(1:4) TO WS-FIN-YEAR                   
           ELSE                                                                 
              MOVE F001-DTE-LAST-DAY-PREV(1:4) TO WS-FIN-YEAR                   
              SUBTRACT 1                     FROM WS-FIN-YEAR                   
           END-IF.                                                              
                                                                                
           COMPUTE WS-FIN-YEAR-NEXT = WS-FIN-YEAR + 1                           
                                                                                
           STRING WS-FIN-YEAR '04'                                              
                  DELIMITED BY SIZE INTO WS-START-YM                            
           MOVE F001-DTE-LAST-DAY-PREV(1:6)    TO WS-END-YM.                    
                                                                                
           STRING F001-DTE-CURRENT(7:2) '/'                                     
                  F001-DTE-CURRENT(5:2) '/'                                     
                  F001-DTE-CURRENT(1:4)                                         
                  DELIMITED BY SIZE INTO LC3A-CURR-DATE.                        
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       8001-READ-BP13FD38.                                                      
      ******************************************************************        
                                                                                
           READ BP13FD38                                                        
             AT END                                                             
                MOVE 'Y'                TO WS-FD38-EOF                          
                GO                      TO 8001-EXIT                            
           END-READ.                                                            
                                                                                
           ADD 1                        TO CNT-FD38-READ.                       
                                                                                
       8001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       9000-CLOSE-FILES.                                                        
      ******************************************************************        
           DISPLAY '                                           '.               
           DISPLAY '*****     BP13CC3A CONTROL LISTING    *****'.               
           DISPLAY '                                           '.               
           DISPLAY 'NO OF RECORDS READ FROM BP13FD38 : ' CNT-FD38-READ          
           DISPLAY 'NO OF RECORDS READ FROM BP13FD00 : ' CNT-FD00-READ          
           DISPLAY 'NO OF RECORDS WRITE TO  BP13LC3A : ' CNT-FD38A-WRITE        
                                                                                
           CLOSE SY02F001                                                       
                 BP13FD38                                                       
                 BP13LC3A.                                                      
                                                                                
           STOP  RUN.                                                           
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
