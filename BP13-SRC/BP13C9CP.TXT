       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C9CP.                                                 
       AUTHOR.        GURU..                                                    
       DATE-WRITTEN.  20/09/2019.                                               
      * ====================================================== *                
      *                                                        *                
      *    SYSTEM NAME : SOC                                   *                
      *    SYSTEM ID   : BP13                                  *                
      *    OBJECTIVE   : TO IDENTIFY CASES THAT SHOULD BE TAGGED                
      *                  AS MA,MB,MC,MD,ME,MF,MH,MJ.           *                
      *                                                        *                
      *    INPUT FILES : BP13F410                              *                
      *                  BP13K895                              *                
      *                  BP13K060                              *                
      *                  BP13K80A                              *                
      *                  BP13K820                              *                
      *                  BP13K853                              *                
      *                  BM06K110                              *                
      *                  P04K010                               *                
      *    OUTPUT FILES: BP13L9CP                              *                
      *                  P13L9CPA - EXCEPTION REPORT           *                
      *                  BP13F310.                             *                
      *--------------------------------------------------------*                
      * CHG-NO    BY     DATE     DESCRIPTION                  *                
      * --------  ----  --------  ---------------------------- *                
      * BP137951  KR13  20/09/19  NEW PROGRAM                  *                
      * BP137913  KR13  19/11/19  CHK CDE-MCPS = M/C/P         *                
      * BP139030  ZAR7  07/01/22  REPLACE CHUA YEE MIEN TO LIM KOK CHUN         
      * BP139276  KAC1  05/04/24  REPLACE LIM KOK CHUN BY      *                
      *                                KATHIJAH_BEE_ALI_MOHAMED*                
      * ====================================================== *                
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F410 ASSIGN       TO BP13F410.                            
                                                                                
           SELECT BP13K800 ASSIGN       TO BP13K800                             
                           ACCESS MODE  IS RANDOM                               
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K800-NUM-REGN                        
                           FILE STATUS  IS K800-STATUS.                         
                                                                                
           SELECT BP13K820 ASSIGN       TO BP13K820                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS K820-KEY-FLD                         
                           FILE STATUS  IS K820-STATUS.                         
                                                                                
           SELECT BP13K853 ASSIGN       TO BP13K853                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K853-KEY-FLD                         
                           FILE STATUS  IS K853-STATUS.                         
                                                                                
           SELECT BP13K893 ASSIGN       TO BP13K893                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K893-KEY-FLD                         
                           FILE STATUS  IS K893-STATUS.                         
                                                                                
           SELECT BP13K895 ASSIGN       TO BP13K895                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K895-KEY-FLD                         
                           FILE STATUS  IS K895-STATUS.                         
                                                                                
           SELECT BP13K060 ASSIGN       TO BP13K060                             
                           ACCESS MODE  IS RANDOM                               
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K060-KEY-FLD                         
                           FILE STATUS  IS K060-STATUS.                         
                                                                                
           SELECT BP13K80A ASSIGN       TO BP13K80A                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K80A-KEY-FLD                         
                           FILE STATUS  IS K80A-STATUS.                         
                                                                                
           SELECT BM06K110 ASSIGN       TO BM06K110                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K110-KEY-FLD                         
                           FILE STATUS  IS K110-STATUS.                         
                                                                                
           SELECT  P04K010 ASSIGN       TO P04K010                              
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K010-PRIME-KEY                       
                           FILE STATUS  IS K010-STATUS.                         
                                                                                
           SELECT BP13L9CP ASSIGN       TO BP13L9CP.                            
           SELECT P13L9CPA ASSIGN       TO P13L9CPA.                            
           SELECT BP13F310 ASSIGN       TO BP13F310.                            
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K893                                                            
            RECORD CONTAINS 2050 CHARACTERS.                                    
       COPY BP13K893.                                                           
                                                                                
       FD  BP13K895                                                             
           RECORD CONTAINS 450  CHARACTERS.                                     
       COPY BP13K895.                                                           
                                                                                
       FD  BP13K853                                                             
           RECORD CONTAINS 250  CHARACTERS.                                     
       COPY BP13K853.                                                           
                                                                                
       FD  BP13K060                                                             
           RECORD CONTAINS 25   CHARACTERS.                                     
       COPY BP13K060.                                                           
                                                                                
       FD  BM06K110                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BM06K110.                                                           
                                                                                
       FD  BP13K820                                                             
           RECORD CONTAINS 400 CHARACTERS.                                      
       COPY BP13K820.                                                           
                                                                                
       FD  BP13K80A                                                             
           RECORD CONTAINS 100 CHARACTERS.                                      
       COPY BP13K80A.                                                           
                                                                                
       FD  P04K010                                                              
           RECORD CONTAINS  300 CHARACTERS.                                     
       COPY P04K010.                                                            
                                                                                
       FD  BP13F410                                                             
           RECORD CONTAINS 2000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       COPY BP13F410.                                                           
                                                                                
       FD  BP13L9CP                                                             
           RECORD CONTAINS 200  CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  BP13L9CP-REC           PIC X(200).                                   
                                                                                
       FD  P13L9CPA                                                             
           RECORD CONTAINS 132  CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13L9CPA-REC           PIC X(132).                                   
                                                                                
       FD  BP13F310                                                             
           RECORD CONTAINS 150  CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  BP13F310-TRANS-REC.                                                  
           05  F310-KEY-FLD.                                                    
               10  F310-REGN-NO                   PIC X(8).                     
               10  F310-CDE-TRANS                 PIC X(2).                     
           05  F310-SCH-ACC                       PIC X(11).                    
           05  F310-DTE-TRANS                     PIC X(08).                    
           05  F310-CDE-NT                        PIC X(3).                     
           05  F310-CDE-FLAT-TYPE                 PIC X(2).                     
           05  F310-NUM-BLK                       PIC X(05).                    
           05  F310-NME-STREET                    PIC X(20).                    
           05  F310-NUM-HSE                       PIC X(08).                    
           05  F310-NUM-POSTAL                    PIC X(06).                    
           05  F310-NUM-NRIC                      PIC X(09).                    
           05  F310-NME-OCCUP                     PIC X(66).                    
           05  FILLER                             PIC X(02).                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY DESIGTAB.                                                           
                                                                                
       01  WS-CURR-DATE                   PIC 9(08).                            
       01  WS-CURRENT-DATE REDEFINES WS-CURR-DATE.                              
           05  WS-CURR-YY                 PIC 9999.                             
           05  WS-CURR-MM                 PIC 99.                               
           05  WS-CURR-DD                 PIC 99.                               
                                                                                
       01  WS-INT-DATE                    PIC 9(07).                            
                                                                                
       01  WS-DATE-6                      PIC 9(8).                             
       01  K800-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K893-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K820-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K895-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K853-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K010-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K110-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K060-STATUS                    PIC 9(2)  VALUE ZERO.                 
       01  K80A-STATUS                    PIC 9(2)  VALUE ZERO.                 
                                                                                
       01  WS-F410-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K800-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K893-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K895-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K820-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K853-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K853-SAME-HA                PIC 9(5)  VALUE ZERO.                 
       01  WS-K110-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K80A-READ                   PIC 9(5)  VALUE ZERO.                 
       01  WS-K820-NFND                   PIC 9(5)  VALUE ZERO.                 
       01  WS-L9CP-WRITTEN                PIC 9(5)  VALUE ZERO.                 
       01  WS-L9CP1-WRITTEN               PIC 9(5)  VALUE ZERO.                 
       01  WS-F310-WRITTEN                PIC 9(5)  VALUE ZERO.                 
                                                                                
       01  WS-EOF-F410                    PIC X     VALUE SPACE.                
           88 EOF-F410                    VALUE 'Y'.                            
       01  WS-EOF-K820                    PIC X     VALUE SPACE.                
           88 EOF-K820                    VALUE 'Y'.                            
       01  WS-EOF-K895                    PIC X     VALUE SPACE.                
           88 EOF-K895                    VALUE 'Y'.                            
       01  WS-EOF-K853                    PIC X     VALUE SPACE.                
           88 EOF-K853                    VALUE 'Y'.                            
       01  WS-K800-FND                    PIC X     VALUE SPACE.                
           88 K800-FND                    VALUE 'Y'.                            
       01  WS-K893-FND                    PIC X     VALUE SPACE.                
           88 K893-FND                    VALUE 'Y'.                            
       01  WS-K820-FND                    PIC X     VALUE SPACE.                
           88 K820-FND                    VALUE 'Y'.                            
       01  WS-K895-FND                    PIC X     VALUE SPACE.                
           88 K895-FND                    VALUE 'Y'.                            
                                                                                
       01  WS-K010-EOF                    PIC X     VALUE SPACES.               
       01  WS-K010-FND                    PIC X     VALUE SPACES.               
       01  WS-DEBAR-FND                   PIC X     VALUE SPACES.               
       01  WS-PRINT                       PIC X     VALUE SPACES.               
       01  WS-3GEN                        PIC X     VALUE SPACES.               
       01  WS-MODL-DESG                   PIC XX    VALUE SPACES.               
       01  WS-CDE-MCPS                    PIC X     VALUE SPACES.               
       01  WS-FIRST-REPORT                PIC X     VALUE 'Y'.                  
                                                                                
       01  WS-OCCUP-DETAILS.                                                    
           05  WS-OCCUPIER OCCURS 16 TIMES.                                     
               10  WS-UIN                 PIC X(09).                            
               10  WS-KEY-ISS             PIC X(10).                            
               10  WS-NAME                PIC X(30).                            
               10  WS-RSN-TAB OCCURS 2 TIMES.                                   
                   15  WS-DEB-RST         PIC X(02).                            
                   15  WS-DEB-AGR         PIC X(02).                            
               10  WS-RELN                PIC X(02).                            
       01  WS-REASON-TABLE.                                                     
           05  WS-REASON OCCURS 8 TIMES.                                        
               10  WS-RSN                 PIC X(02)  VALUE SPACES.              
               10  FIL09A                 PIC X(01)  VALUE SPACES.              
       01  WS-DCODE                       PIC X(2)   VALUE ZEROES.              
       01  WS-DSGN                        PIC X(4)   VALUE '3GEN'.              
       01  WS-I                           PIC 99 VALUE 0.                       
       01  WS-J                           PIC 99 VALUE 0.                       
       01  WS-K                           PIC 99 VALUE 0.                       
       01  WS-CNT                         PIC 99 VALUE 0.                       
       01  WS-CNT1                        PIC 99 VALUE 0.                       
       01  WS-CNT2                        PIC 99 VALUE 0.                       
       01  WS-CNT3                        PIC 99 VALUE 0.                       
       01  WS-CNT3-IC                     PIC 99 VALUE 0.                       
       01  WS-CNT4                        PIC 99 VALUE 0.                       
       01  WS-CNT4-IC                     PIC 99 VALUE 0.                       
                                                                                
       01  L9CP-HEADER.                                                         
           05  FILLER             PIC X(08)  VALUE 'REGN'.                      
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(11)  VALUE 'SCH ACC'.                   
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(09)  VALUE 'NRIC'.                      
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(30)  VALUE 'NAME'.                      
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(20)  VALUE 'RELATIONSHIP'.              
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(07)  VALUE 'ALC SCH'.                   
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(10)  VALUE 'KI DATE'.                   
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(13)  VALUE 'MCPS'.                      
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(23)  VALUE                              
                                              'REASON CODE            '.        
           05  FILLER             PIC X(01)  VALUE ';'.                         
           05  FILLER             PIC X(10)  VALUE SPACES.                      
                                                                                
       01  L9CP-DETAIL.                                                         
           05  L9CP-REGN          PIC X(08)  VALUE SPACES.                      
           05  FIL01              PIC X(01)  VALUE SPACES.                      
           05  L9CP-SCH-ACC       PIC X(11)  VALUE SPACES.                      
           05  FIL02              PIC X(01)  VALUE SPACES.                      
           05  L9CP-NRIC          PIC X(09)  VALUE SPACES.                      
           05  FIL03              PIC X(01)  VALUE SPACES.                      
           05  L9CP-NAME          PIC X(30)  VALUE SPACES.                      
           05  FIL04              PIC X(01)  VALUE SPACES.                      
           05  L9CP-RELN          PIC X(20)  VALUE SPACES.                      
           05  FIL05              PIC X(01)  VALUE SPACES.                      
           05  L9CP-ALO-SCH       PIC X(03)  VALUE SPACES.                      
           05  FILLER             PIC X(04)  VALUE SPACES.                      
           05  FIL06              PIC X(01)  VALUE SPACES.                      
           05  L9CP-KI-DATE       PIC X(10)  VALUE SPACES.                      
           05  FIL07              PIC X(01)  VALUE SPACES.                      
           05  L9CP-MCPS          PIC X(13)  VALUE SPACES.                      
           05  FIL08              PIC X(01)  VALUE SPACES.                      
           05  L9CP-REASON-TABLE.                                               
              10  L9CP-REASON OCCURS 8 TIMES.                                   
                  15  L9CP-RSN       PIC X(02)  VALUE SPACES.                   
                  15  FIL09          PIC X(01)  VALUE SPACES.                   
           05  FILLER             PIC X(10)  VALUE SPACES.                      
                                                                                
       01  L9CP1-HEADER1.                                                       
           05  FILLER              PIC X(35)  VALUE SPACES.                     
                                                                                
           05  HDR1-TXT            PIC X(35)  VALUE SPACES.                     
           05  L9CP1-DATE1         PIC X(12)  VALUE SPACES.                     
           05  FILLER              PIC X(03)  VALUE ' - '.                      
           05  L9CP1-DATE2         PIC X(12)  VALUE SPACES.                     
                                                                                
       01  L9CP1-HEADER2.                                                       
           05  FILLER              PIC X(06)  VALUE 'S.NO'.                     
           05  FILLER              PIC X(13)  VALUE 'REGN NO'.                  
           05  FILLER              PIC X(08)  VALUE 'NRIC'.                     
           05  FILLER              PIC X(13)  VALUE 'KEY ISS-DTE'.              
           05  FILLER              PIC X(09)  VALUE 'DTE-BAL'.                  
           05  FILLER              PIC X(10)  VALUE 'ALLO-SCH'.                 
           05  FILLER              PIC X(07)  VALUE 'F-TYP'.                    
           05  FILLER              PIC X(06)  VALUE '3GEN'.                     
           05  FILLER              PIC X(32)  VALUE 'AGR CRE WHO'.              
           05  FILLER              PIC X(12)  VALUE 'DEBAR TAG'.                
           05  FILLER              PIC X(09)  VALUE 'DEBAR TAG'.                
           05  FILLER              PIC X(07)  VALUE  SPACES.                    
       01  L9CP1-HEADER3.                                                       
           05  FILLER              PIC X(72)  VALUE SPACES.                     
           05  FILLER              PIC X(32)  VALUE 'ISSUED KEY'.               
           05  FILLER              PIC X(12)  VALUE 'BY RST'.                   
           05  FILLER              PIC X(06)  VALUE 'BY AGR'.                   
           05  FILLER              PIC X(10)  VALUE  SPACES.                    
       01  L9CP1-DETAIL.                                                        
           05  L9CP1-SNO           PIC ZZZZ9.                                   
           05  FILLER              PIC X(01)  VALUE SPACES.                     
           05  L9CP1-REGN          PIC X(08)  VALUE SPACES.                     
           05  FILLER              PIC X(02)  VALUE SPACES.                     
           05  L9CP1-NRIC          PIC X(09)  VALUE SPACES.                     
           05  FILLER              PIC X(02)  VALUE SPACES.                     
           05  L9CP1-KI-DATE       PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(03)  VALUE SPACES.                     
           05  L9CP1-DTE-BALLOT    PIC X(07)  VALUE SPACES.                     
           05  FILLER              PIC X(04)  VALUE SPACES.                     
           05  L9CP1-ALLOC-SCH     PIC X(03)  VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  L9CP1-F-TYP         PIC X(02)  VALUE SPACES.                     
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  L9CP1-3GEN          PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(03)  VALUE SPACES.                     
           05  L9CP1-NAME          PIC X(30)  VALUE SPACES.                     
           05  FILLER              PIC X(02)  VALUE SPACES.                     
           05  L9CP1-DEB-RST       PIC X(02)  VALUE SPACES.                     
           05  FILLER              PIC X(02)  VALUE SPACES.                     
           05  L9CP1-DEB-RST1      PIC X(02)  VALUE SPACES.                     
           05  FILLER              PIC X(06)  VALUE SPACES.                     
           05  L9CP1-DEB-AGR       PIC X(02)  VALUE SPACES.                     
           05  FILLER              PIC X(02)  VALUE SPACES.                     
           05  L9CP1-DEB-AGR1      PIC X(02)  VALUE SPACES.                     
           05  FILLER              PIC X(10)  VALUE SPACES.                     
                                                                                
      ****************************************************************          
      *    MAIL HEADER                                               *          
      ****************************************************************          
       01  MAIL-HDR-HELO.                                                       
           05  FILLER PIC X(132) VALUE 'HELO SGPHDB1'.                          
       01  MAIL-HDR-MAIL-FROM.                                                  
           05  FILLER PIC X(132) VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.              
       01  MAIL-HDR-MAIL-RCPT-TO.                                               
           05  FILLER PIC X(132) VALUE SPACES.                                  
       01  MAIL-HDR-MAIL-RCPT-TO1.                                              
           05  FILLER PIC X(132)                                                
               VALUE 'RCPT TO:<LOW_SOO_CHIEW@HDB.GOV.SG>'.                      
       01  MAIL-HDR-MAIL-RCPT-TO2.                                              
           05  FILLER PIC X(132)                                                
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.           
       01  MAIL-HDR-MAIL-RCPT-TO3.                                              
           05  FILLER PIC X(132)                                                
               VALUE 'RCPT TO:<HEE_WAN_MENG@HDB.GOV.SG>'.                       
       01  MAIL-HDR-MAIL-RCPT-TO4.                                              
           05  FILLER PIC X(132)                                                
               VALUE 'RCPT TO:<JAMILAH_BAHROM@HDB.GOV.SG>'.                     
       01  MAIL-HDR-DATA.                                                       
           05  FILLER PIC X(132) VALUE 'DATA'.                                  
       01  MAIL-HDR-FROM.                                                       
           05  FILLER PIC X(132) VALUE 'FROM:SOC SYSTEM - EMAIL ALERT'.         
       01  MAIL-HDR-MAIL-TO.                                                    
           05  FILLER PIC X(132) VALUE SPACES.                                  
       01  MAIL-HDR-MAIL-TO-LOW.                                                
           05  FILLER PIC X(132)                                                
               VALUE 'TO:<LOW_SOO_CHIEW@HDB.GOV.SG>'.                           
       01  MAIL-HDR-MAIL-TO-CC1.                                                
           05  FILLER PIC X(132)                                                
               VALUE 'CC:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                
       01  MAIL-HDR-MAIL-TO-CC2.                                                
           05  FILLER PIC X(132)                                                
               VALUE 'CC:<HEE_WAN_MENG@HDB.GOV.SG>'.                            
       01  MAIL-HDR-MAIL-TO-CC3.                                                
           05  FILLER PIC X(132)                                                
               VALUE 'CC:<JAMILAH_BAHROM@HDB.GOV.SG>'.                          
       01  MAIL-SUBJECT-LZ3D.                                                   
           05  SUBJ-TXT PIC X(132)   VALUE 'SUBJECT : Exception Report o        
      -        'n     Debarment'.                                               
       01  MAIL-BODY-LZ3D              PIC X(132) VALUE SPACES.                 
       01  MAIL-END-LZ3D               PIC X(132) VALUE SPACES.                 
       01  MAIL-HDR-DATE.                                                       
           05  FILLER                  PIC X(6)   VALUE 'DATE: '.               
           05  MAIL-DATE               PIC X(10)  VALUE SPACES.                 
       01  MAIL-END.                                                            
           05 FILLER                   PIC X      VALUE '.'.                    
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(132) VALUE SPACES.                 
      *                                                                         
                                                                                
       PROCEDURE DIVISION.                                                      
      *---------------------------------------------------------------*         
       0000-CONTROL.                                                            
      *---------------------------------------------------------------*         
                                                                                
           PERFORM 1000-OPEN-FILES        THRU 1000-EXIT.                       
                                                                                
           PERFORM 2000-READ-BP13F410     THRU 2000-EXIT.                       
                                                                                
           PERFORM 3000-PROCESS-BP13F410  THRU 3000-EXIT                        
             UNTIL EOF-F410.                                                    
                                                                                
           PERFORM 9000-CLOSE-FILES       THRU 9000-EXIT.                       
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       1000-OPEN-FILES.                                                         
      *---------------------------------------------------------------*         
                                                                                
           OPEN INPUT  BP13F410                                                 
                       BP13K800                                                 
                       BP13K80A                                                 
                       BP13K820                                                 
                       BP13K853                                                 
                       BP13K893                                                 
                       BP13K895                                                 
                       BP13K060                                                 
                       BM06K110                                                 
                       P04K010                                                  
                OUTPUT BP13L9CP                                                 
                       P13L9CPA                                                 
                       BP13F310.                                                
                                                                                
           IF K800-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K800-STATUS ' K800-STATUS                    
              MOVE K800-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K893-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K893-STATUS ' K893-STATUS                    
              MOVE K893-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K820-STATUS ' K820-STATUS                    
              MOVE K820-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K853-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K853-STATUS ' K853-STATUS                    
              MOVE K853-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K895-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K895-STATUS ' K895-STATUS                    
              MOVE K895-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K80A-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K80A-STATUS ' K80A-STATUS                    
              MOVE K80A-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K010-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K010-STATUS ' K010-STATUS                    
              MOVE K010-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K110-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K110-STATUS ' K110-STATUS                    
              MOVE K110-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K060-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPEN ERROR, K060-STATUS ' K060-STATUS                    
              MOVE K060-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           MOVE SPACES            TO BP13L9CP-REC.                              
           WRITE BP13L9CP-REC     FROM L9CP-HEADER.                             
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURR-DATE.                     
                                                                                
           COMPUTE WS-INT-DATE =                                                
                               FUNCTION INTEGER-OF-DATE(WS-CURR-DATE)           
           COMPUTE WS-INT-DATE = WS-INT-DATE - 6                                
                                                                                
           COMPUTE WS-DATE-6 = FUNCTION DATE-OF-INTEGER(WS-INT-DATE).           
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       2000-READ-BP13F410.                                                      
      *---------------------------------------------------------------*         
                                                                                
           READ BP13F410 AT END                                                 
                MOVE 'Y' TO WS-EOF-F410                                         
                GO TO 2000-EXIT.                                                
                                                                                
           ADD 1 TO WS-F410-READ.                                               
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3000-PROCESS-BP13F410.                                                   
      *---------------------------------------------------------------*         
                                                                                
           IF  F410-DTE-KEY-ISSUE >= WS-DATE-6                                  
           AND F410-DTE-KEY-ISSUE <= WS-CURR-DATE                               
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 2000-READ-BP13F410      THRU 2000-EXIT                    
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE 0                  TO WS-CNT WS-CNT2 WS-CNT3 WS-CNT4.           
           MOVE SPACES             TO WS-OCCUP-DETAILS WS-PRINT.                
           INITIALIZE                 WS-OCCUP-DETAILS.                         
                                                                                
           IF F410-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES                      
              PERFORM 6000-READ-BM06K110 THRU 6000-EXIT                         
           END-IF.                                                              
                                                                                
           IF K110-DTE-KEY-ISSUED > '20140113'                                  
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 2000-READ-BP13F410    THRU 2000-EXIT                      
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM 2100-READ-BP13K800       THRU 2100-EXIT                      
                                                                                
           IF NOT K800-FND                                                      
              PERFORM 2200-READ-BP13K893    THRU 2200-EXIT                      
           END-IF                                                               
                                                                                
           IF WS-CDE-MCPS NOT = 'M' AND 'C' AND 'P'                             
              PERFORM 2000-READ-BP13F410    THRU 2000-EXIT                      
              GO TO 3000-EXIT                                                   
           END-IF                                                               
                                                                                
           PERFORM 3200-BROWSE-BP13K820     THRU 3200-EXIT.                     
                                                                                
           IF NOT K820-FND                                                      
              PERFORM 3300-STARTBR-BP13K895 THRU 3300-EXIT                      
           END-IF.                                                              
                                                                                
           PERFORM 3500-STARTBR-BP13K853    THRU 3500-EXIT.                     
                                                                                
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > WS-CNT                 
                OR WS-UIN(WS-I) = SPACES OR LOW-VALUES                          
              PERFORM 3050-CHECK-DEBARMENT  THRU 3050-EXIT                      
           END-PERFORM.                                                         
                                                                                
           MOVE F410-NUM-SCH-ACC(1:9)       TO K80A-KEY-FLD                     
           PERFORM 6500-READ-BP13K80A       THRU 6500-EXIT                      
                                                                                
           IF WS-MODL-DESG NOT = SPACES                                         
              MOVE SPACES                  TO WS-DCODE                          
              MOVE WS-MODL-DESG            TO WS-DCODE                          
              SET WS-DSGN-IND TO 1                                              
              SEARCH WS-DESIGN-ENTRY                                            
                  AT END                                                        
                     MOVE SPACES           TO WS-3GEN                           
                WHEN (WS-DSGN-CDE(WS-DSGN-IND)(1:2) = WS-DCODE)                 
                 AND (WS-DSGN-TEXT(WS-DSGN-IND)(1:4) = WS-DSGN)                 
                     MOVE 'Y'              TO WS-3GEN                           
           ELSE                                                                 
              MOVE SPACES                  TO WS-3GEN                           
           END-IF                                                               
                                                                                
      **** CNT2 > 0 IF HAS ANY DEBAR // CNT3 > 0 IF (MA,MC,ME,MH)               
           IF WS-CNT2 = ZEROS OR WS-PRINT = 'Y'                                 
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > WS-CNT              
              OR WS-UIN(WS-I) = SPACES OR LOW-VALUES                            
                 PERFORM 8500-WRITE-REPORT   THRU 8500-EXIT                     
              END-PERFORM                                                       
           END-IF                                                               
                                                                                
           PERFORM 2000-READ-BP13F410      THRU 2000-EXIT.                      
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       2100-READ-BP13K800.                                                      
      *---------------------------------------------------------------*         
           MOVE F410-NUM-REGN               TO K800-NUM-REGN                    
                                                                                
           READ BP13K800                                                        
                                                                                
           EVALUATE K800-STATUS                                                 
               WHEN 00                                                          
                    MOVE 'Y'                TO WS-K800-FND                      
                    MOVE K800-CDE-MCPS      TO WS-CDE-MCPS                      
                    ADD 1  TO WS-K800-READ                                      
               WHEN 23                                                          
                    MOVE 'N'                TO WS-K800-FND                      
                    MOVE SPACES             TO WS-CDE-MCPS                      
               WHEN OTHER                                                       
                  DISPLAY 'READ  ERROR BP13K800 : ' K800-STATUS                 
                          ' KEY : ' K800-NUM-REGN                               
                  MOVE K800-STATUS         TO RETURN-CODE                       
                  PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT               
           END-EVALUATE.                                                        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       2200-READ-BP13K893.                                                      
      *---------------------------------------------------------------*         
           MOVE SPACES                      TO BP13K893-MASTER                  
                                               WS-CDE-MCPS                      
           MOVE F410-NUM-REGN               TO K893-NUM-REGN-HIST               
                                                                                
           START BP13K893 KEY >= K893-NUM-REGN-HIST                             
                                                                                
           EVALUATE K893-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    READ BP13K893 NEXT RECORD                                   
                    IF K893-STATUS = 00 OR 02                                   
                       IF F410-NUM-REGN = K893-NUM-REGN-HIST                    
                          MOVE K893-CDE-MCPS      TO WS-CDE-MCPS                
                          ADD 1  TO WS-K893-READ                                
                       END-IF                                                   
                    END-IF                                                      
               WHEN 23                                                          
                    MOVE SPACES             TO WS-CDE-MCPS                      
               WHEN OTHER                                                       
                    DISPLAY 'READ  ERROR BP13K893 : ' K893-STATUS               
                          ' KEY : ' K893-NUM-REGN                               
                    MOVE K893-STATUS         TO RETURN-CODE                     
                    PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT             
           END-EVALUATE.                                                        
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3050-CHECK-DEBARMENT.                                                    
      *---------------------------------------------------------------*         
                                                                                
           MOVE WS-UIN(WS-I)  TO K010-NUM-UINFIN.                               
                                                                                
           IF K010-NUM-UINFIN(1:1) NOT = 'T'                                    
              PERFORM 4500-CHECK-DEBAR  THRU 4500-EXIT                          
              IF WS-CNT1 > ZEROS                                                
                 PERFORM 7000-WRITE-OUTPUT   THRU 7000-EXIT                     
                 PERFORM 8000-WRITE-BP13F310 THRU 8000-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3200-BROWSE-BP13K820.                                                    
      *---------------------------------------------------------------*         
                                                                                
           MOVE SPACES                  TO BP13K820-REC.                        
           INITIALIZE                      BP13K820-REC.                        
                                                                                
           MOVE 'N'                     TO WS-EOF-K820                          
                                           WS-K820-FND                          
           MOVE F410-NUM-REGN           TO K820-NUM-REGN.                       
                                                                                
           START BP13K820 KEY >= K820-NUM-REGN.                                 
                                                                                
           EVALUATE K820-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 3210-READNEXT-BP13K820 THRU 3210-EXIT               
                      UNTIL EOF-K820                                            
               WHEN 20                                                          
               WHEN 23                                                          
                    ADD 1                            TO WS-K820-NFND            
                    MOVE 'Y'                         TO WS-EOF-K820             
                    MOVE 'N'                         TO WS-K820-FND             
               WHEN OTHER                                                       
                    DISPLAY 'START ERROR BP13K820 : ' K820-STATUS               
                            ' REGN : ' F410-NUM-REGN                            
                    PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT             
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3210-READNEXT-BP13K820.                                                  
      *---------------------------------------------------------------*         
                                                                                
           READ BP13K820 NEXT RECORD                                            
                         AT END MOVE 'Y' TO WS-EOF-K820                         
                         GO TO 3210-EXIT                                        
           END-READ.                                                            
                                                                                
           EVALUATE K820-STATUS                                                 
              WHEN 00                                                           
              WHEN 02                                                           
                IF (F410-NUM-REGN = K820-NUM-REGN) AND                          
                   (K820-NUM-NRIC = F410-NRIC1 OR                               
                    K820-NUM-NRIC = F410-NRIC2 OR                               
                    K820-NUM-NRIC = F410-NRIC3 OR                               
                    K820-NUM-NRIC = F410-NRIC4)                                 
                   ADD 1                      TO WS-K820-READ                   
                   MOVE 'Y'                   TO WS-K820-FND                    
                   ADD 1                      TO WS-CNT                         
                   MOVE K820-NUM-NRIC         TO WS-UIN(WS-CNT)                 
                   MOVE K820-NUM-RELATIONSHIP TO WS-RELN(WS-CNT)                
                   MOVE K820-NME-OCCP         TO WS-NAME(WS-CNT)                
                ELSE                                                            
                  MOVE 'Y'                    TO WS-EOF-K820                    
                END-IF                                                          
              WHEN 10                                                           
              WHEN 23                                                           
                MOVE 'Y'                      TO WS-EOF-K820                    
                MOVE 'N'                      TO WS-K820-FND                    
              WHEN OTHER                                                        
                  DISPLAY 'READ  ERROR BP13K820 : ' K820-STATUS                 
                          ' REGN : ' F410-NUM-REGN                              
                  PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3300-STARTBR-BP13K895.                                                   
      *---------------------------------------------------------------*         
           MOVE 'N'                TO WS-EOF-K895                               
                                      WS-K820-FND.                              
           MOVE SPACES             TO K895-KEY-FLD.                             
           MOVE F410-NUM-REGN      TO K895-NUM-REGN-HIST.                       
                                                                                
           START BP13K895  KEY >= K895-KEY-FLD                                  
                                                                                
           EVALUATE K895-STATUS                                                 
               WHEN 00                                                          
                    PERFORM 3400-READNEXT-BP13K895  THRU 3400-EXIT              
                        UNTIL WS-EOF-K895 = 'Y'                                 
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING IN BP13K895, STATUS IS '             
                             K895-STATUS                                        
           END-EVALUATE.                                                        
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3400-READNEXT-BP13K895.                                                  
      *---------------------------------------------------------------*         
           READ BP13K895 NEXT AT END                                            
               MOVE 'Y' TO WS-EOF-K895.                                         
                                                                                
           EVALUATE K895-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    IF K895-NUM-REGN-HIST = F410-NUM-REGN                       
                       PERFORM 3450-CHECK     THRU 3450-EXIT                    
                    ELSE                                                        
                       MOVE 'Y'               TO WS-EOF-K895                    
                    END-IF                                                      
               WHEN 23                                                          
                     MOVE 'Y'                 TO WS-EOF-K895                    
               WHEN OTHER                                                       
                     DISPLAY 'READ ERROR, K895-STATUS ' K895-STATUS             
                          ' REGN = ' F410-NUM-REGN                              
           END-EVALUATE.                                                        
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3450-CHECK.                                                              
      *---------------------------------------------------------------*         
                                                                                
           IF (K895-NUM-NRIC = F410-NRIC1) OR                                   
              (K895-NUM-RELATIONSHIP = '20' OR '09')                            
              ADD 1                      TO WS-K895-READ                        
                                            WS-CNT                              
              MOVE K895-NUM-NRIC         TO WS-UIN(WS-CNT)                      
              MOVE K895-NUM-RELATIONSHIP TO WS-RELN(WS-CNT)                     
              MOVE K895-NME-OCCP         TO WS-NAME(WS-CNT)                     
           END-IF.                                                              
                                                                                
           IF K895-NUM-NRIC = F410-NRIC2 OR                                     
                              F410-NRIC3 OR F410-NRIC4                          
              IF K895-NUM-RELATIONSHIP = '02' OR '12'                           
                  ADD 1                      TO WS-K895-READ                    
                                                WS-CNT                          
                  MOVE K895-NUM-NRIC         TO WS-UIN(WS-CNT)                  
                  MOVE K895-NUM-RELATIONSHIP TO WS-RELN(WS-CNT)                 
                  MOVE K895-NME-OCCP         TO WS-NAME(WS-CNT)                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3500-STARTBR-BP13K853.                                                   
      *---------------------------------------------------------------*         
           MOVE 'N'                TO WS-EOF-K853.                              
           MOVE SPACES             TO K853-KEY-FLD.                             
           MOVE F410-NUM-REGN      TO K853-NUM-REGN.                            
                                                                                
           START BP13K853  KEY >= K853-KEY-FLD                                  
                                                                                
           EVALUATE K853-STATUS                                                 
               WHEN 00                                                          
                    PERFORM 3600-READNEXT-BP13K853  THRU 3600-EXIT              
                      UNTIL WS-EOF-K853 = 'Y'                                   
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING IN BP13K853, STATUS IS '             
                             K853-STATUS                                        
           END-EVALUATE.                                                        
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3600-READNEXT-BP13K853.                                                  
      *---------------------------------------------------------------*         
           READ BP13K853 NEXT AT END                                            
               MOVE 'Y' TO WS-EOF-K853.                                         
                                                                                
           EVALUATE K853-STATUS                                                 
           WHEN 00                                                              
           WHEN 02                                                              
                IF K853-NUM-REGN = F410-NUM-REGN                                
                   IF K853-NUM-NRIC = F410-NRIC1 OR                             
                      K853-NUM-NRIC = F410-NRIC2 OR                             
                      K853-NUM-NRIC = F410-NRIC3 OR                             
                      K853-NUM-NRIC = F410-NRIC4                                
                      ADD 1                      TO WS-K853-SAME-HA             
                   ELSE                                                         
                      ADD 1                      TO WS-K853-READ                
                                                    WS-CNT                      
                      MOVE K853-NUM-NRIC         TO WS-UIN(WS-CNT)              
                      MOVE 'MC'                  TO WS-RELN(WS-CNT)             
                      MOVE K853-NME-OCCP         TO WS-NAME(WS-CNT)             
                   END-IF                                                       
                ELSE                                                            
                   MOVE 'Y'                      TO WS-EOF-K853                 
                END-IF                                                          
           WHEN 23                                                              
                 MOVE 'Y'                        TO WS-EOF-K853                 
           WHEN OTHER                                                           
                 DISPLAY 'READ ERROR, K853-STATUS ' K853-STATUS                 
                      ' REGN = ' F410-NUM-REGN                                  
           END-EVALUATE.                                                        
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       4500-CHECK-DEBAR.                                                        
      *---------------------------------------------------------------*         
                                                                                
           MOVE SPACES          TO K010-PRIME-KEY WS-REASON-TABLE.              
           MOVE ZEROES          TO WS-CNT1 WS-CNT3-IC WS-CNT4-IC.               
           MOVE 'N'             TO WS-K010-EOF                                  
                                   WS-DEBAR-FND.                                
                                                                                
           MOVE WS-UIN(WS-I)  TO K010-NUM-UINFIN.                               
                                                                                
           START P04K010  KEY >= K010-PRIME-KEY                                 
                                                                                
           EVALUATE K010-STATUS                                                 
               WHEN ZERO                                                        
                    PERFORM 4600-READ-P04K010   THRU 4600-EXIT                  
                      UNTIL WS-K010-EOF = 'Y'                                   
               WHEN 23                                                          
                    MOVE 'Y' TO WS-K010-EOF                                     
               WHEN OTHER                                                       
                    DISPLAY 'READ ERROR, K010-STATUS ' K010-STATUS              
                    DISPLAY 'K010-NUM-UINFIN = ' K010-NUM-UINFIN                
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
           IF WS-CNT3-IC > WS-CNT4-IC                                           
           OR (WS-CNT3-IC = ZEROES AND WS-CNT4-IC = ZEROES)                     
              MOVE 'Y'                     TO WS-PRINT                          
           END-IF.                                                              
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------*                                                   
       4600-READ-P04K010.                                                       
      *---------------------*                                                   
                                                                                
           READ P04K010  NEXT RECORD                                            
                                                                                
           EVALUATE K010-STATUS                                                 
           WHEN 00                                                              
              IF K010-NUM-UINFIN(1:9) = WS-UIN(WS-I)                            
                IF K010-EX-SCH-ACCTNO   = F410-NUM-SCH-ACC(1:9)                 
                 IF K010-REASON-CODE = 'MA' OR 'MB' OR 'MC' OR 'MD' OR          
                                       'ME' OR 'MF' OR 'MH' OR 'MJ'             
                    ADD  1  TO WS-CNT1 WS-CNT2                                  
                    MOVE K010-REASON-CODE     TO WS-RSN(WS-CNT1)                
                    IF K010-REASON-CODE = 'MA' OR 'MC' OR 'ME' OR 'MH'          
                       ADD  1        TO WS-CNT3 WS-CNT3-IC                      
                    ELSE                                                        
                       ADD  1        TO WS-CNT4 WS-CNT4-IC                      
                    END-IF                                                      
                 END-IF                                                         
                END-IF                                                          
              ELSE                                                              
                 MOVE 'Y'        TO WS-K010-EOF                                 
              END-IF                                                            
           WHEN 23                                                              
              MOVE 'Y'           TO WS-K010-EOF                                 
              MOVE 'N'           TO WS-DEBAR-FND                                
              DISPLAY 'RECORD NOT FOUND IN P04K010, KEY IS: '                   
                        WS-UIN(WS-I)                                            
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING P04K010 , STATUS IS: '                     
                        K010-STATUS  ' -' WS-UIN(WS-I)                          
              PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
      *-------------------*                                                     
       6000-READ-BM06K110.                                                      
      *-------------------*                                                     
                                                                                
           MOVE SPACES                      TO K110-REC.                        
           INITIALIZE                          K110-REC.                        
                                                                                
           MOVE F410-NUM-SCH-ACC            TO K110-KEY-FLD.                    
                                                                                
           READ BM06K110.                                                       
                                                                                
           EVALUATE K110-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1 TO WS-K110-READ                                       
               WHEN 23                                                          
                    MOVE SPACES       TO K110-DTE-KEY-ISSUED                    
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BM06K110 : ' K110-STATUS             
                    MOVE K110-STATUS         TO RETURN-CODE                     
                    PERFORM 9000-CLOSE-FILES    THRU 9000-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       6500-READ-BP13K80A.                                                      
      *------------------------------------------------------------             
                                                                                
           READ BP13K80A.                                                       
                                                                                
           EVALUATE K80A-STATUS                                                 
               WHEN 00                                                          
                    MOVE K80A-NUM-BLK          TO F310-NUM-BLK                  
                    MOVE K80A-NME-STREET       TO F310-NME-STREET               
                    MOVE K80A-NUM-HSE          TO F310-NUM-HSE                  
                    MOVE K80A-CDE-MODL-DESG    TO WS-MODL-DESG                  
               WHEN 23                                                          
                    MOVE SPACES                TO F310-NUM-BLK                  
                                                  F310-NME-STREET               
                                                  F310-NUM-HSE                  
                                                  F310-NUM-POSTAL               
                                                  WS-MODL-DESG                  
                                                  K80A-NUM-FLAT-TYPE            
               WHEN OTHER                                                       
                    DISPLAY 'READ  ERROR BP13K80A : ' K80A-STATUS               
                          ' KEY : ' K80A-KEY-FLD                                
                    MOVE K80A-STATUS         TO RETURN-CODE                     
                    PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT             
           END-EVALUATE.                                                        
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       7000-WRITE-OUTPUT.                                                       
      *********************                                                     
           MOVE SPACES           TO BP13L9CP-REC                                
           INITIALIZE               BP13L9CP-REC.                               
                                                                                
           MOVE WS-REASON-TABLE  TO L9CP-REASON-TABLE.                          
           MOVE ';'      TO FIL01 FIL02 FIL03 FIL04 FIL05 FIL06 FIL07           
                            FIL08 FIL09(1) FIL09(2) FIL09(3) FIL09(4)           
                         FIL09(5) FIL09(6) FIL09(7) FIL09(8).                   
                                                                                
           MOVE F410-NUM-REGN    TO L9CP-REGN.                                  
           MOVE F410-NUM-SCH-ACC TO L9CP-SCH-ACC.                               
           MOVE WS-UIN(WS-I)     TO L9CP-NRIC.                                  
           MOVE WS-NAME(WS-I)    TO L9CP-NAME.                                  
                                                                                
           EVALUATE WS-CDE-MCPS                                                 
               WHEN 'M'                                                         
                    MOVE 'STAY TOGETHER'    TO L9CP-MCPS                        
               WHEN 'C'                                                         
                    MOVE 'NEAR CHILD'       TO L9CP-MCPS                        
               WHEN 'P'                                                         
                    MOVE 'NEAR PARENT'      TO L9CP-MCPS                        
               WHEN 'B'                                                         
                    MOVE 'P MOVE TO NME'    TO L9CP-MCPS                        
               WHEN OTHER                                                       
                    MOVE SPACES             TO L9CP-MCPS                        
           END-EVALUATE.                                                        
                                                                                
           IF WS-RELN(WS-I) = 'MC'                                              
              MOVE 'MCPS FILE'     TO L9CP-RELN                                 
           ELSE                                                                 
              IF WS-RELN(WS-I) NOT = SPACES AND LOW-VALUES                      
                 PERFORM 7500-DECODE-RELN THRU 7500-EXIT                        
              ELSE                                                              
                 MOVE SPACES        TO L9CP-RELN                                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K110-DTE-KEY-ISSUED NOT = SPACES AND LOW-VALUES AND               
                                        ZEROES                                  
              STRING K110-DTE-KEY-ISSUED(7:2) '/'                               
                  K110-DTE-KEY-ISSUED(5:2) '/'                                  
                  K110-DTE-KEY-ISSUED(1:4) '/'                                  
                  DELIMITED BY SIZE INTO L9CP-KI-DATE                           
           ELSE                                                                 
              MOVE SPACES             TO L9CP-KI-DATE                           
           END-IF.                                                              
                                                                                
           MOVE ZEROES TO WS-K                                                  
           PERFORM VARYING WS-J FROM 1 BY 1 UNTIL WS-J > 8                      
                OR WS-RSN(WS-J) = SPACES OR WS-K > 1                            
              IF WS-RSN(WS-J) = 'MA' OR 'MC' OR 'ME' OR 'MH'                    
                 ADD 1 TO WS-K                                                  
                 MOVE WS-RSN(WS-J)          TO WS-DEB-RST(WS-I, WS-K)           
              END-IF                                                            
           END-PERFORM                                                          
                                                                                
           MOVE ZEROES TO WS-K                                                  
           PERFORM VARYING WS-J FROM 1 BY 1 UNTIL WS-J > 8                      
                OR WS-RSN(WS-J) = SPACES OR WS-K > 1                            
              IF WS-RSN(WS-J) = 'MB' OR 'MD' OR 'MF' OR 'MJ'                    
                 ADD 1 TO WS-K                                                  
                 MOVE WS-RSN(WS-J)          TO WS-DEB-AGR(WS-I, WS-K)           
              END-IF                                                            
           END-PERFORM                                                          
                                                                                
           MOVE F410-CDE-ALLOC-SCH    TO L9CP-ALO-SCH.                          
                                                                                
           WRITE BP13L9CP-REC FROM L9CP-DETAIL.                                 
           ADD 1 TO WS-L9CP-WRITTEN.                                            
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       7500-DECODE-RELN.                                                        
      ******************************************************************        
            MOVE SPACES                 TO BP13K060-REC.                        
                                                                                
            MOVE WS-RELN(WS-I)          TO K060-CODE.                           
            MOVE '35'                   TO K060-SERIAL-NO.                      
                                                                                
            READ BP13K060.                                                      
            EVALUATE K060-STATUS                                                
                WHEN '00'                                                       
                     MOVE K060-DESC        TO L9CP-RELN                         
                WHEN '23'                                                       
                     MOVE SPACES           TO L9CP-RELN                         
                WHEN OTHER                                                      
                     DISPLAY 'ERROR IN READING BP13K060, STATUS - '             
                     K060-STATUS                                                
            END-EVALUATE.                                                       
                                                                                
       7500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       8000-WRITE-BP13F310.                                                     
      *********************                                                     
           MOVE SPACES           TO BP13F310-TRANS-REC.                         
           INITIALIZE               BP13F310-TRANS-REC.                         
                                                                                
           MOVE F410-NUM-REGN    TO F310-REGN-NO.                               
           MOVE 'MB'             TO F310-CDE-TRANS.                             
           MOVE F410-NUM-SCH-ACC TO F310-SCH-ACC.                               
           MOVE WS-UIN(WS-I)     TO F310-NUM-NRIC.                              
           MOVE WS-NAME(WS-I)    TO F310-NME-OCCUP.                             
                                                                                
           IF K110-DTE-KEY-ISSUED NOT = SPACES AND LOW-VALUES AND               
                                        ZEROES                                  
              MOVE K110-DTE-KEY-ISSUED  TO F310-DTE-TRANS                       
           ELSE                                                                 
              MOVE SPACES               TO F310-DTE-TRANS                       
           END-IF.                                                              
                                                                                
           MOVE F410-NUM-FLAT-TYPE    TO F310-CDE-FLAT-TYPE.                    
           MOVE F410-CDE-NT           TO F310-CDE-NT                            
                                                                                
           IF F410-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES                      
              MOVE F410-NUM-SCH-ACC(1:9)  TO K80A-KEY-FLD                       
              PERFORM 6500-READ-BP13K80A THRU 6500-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE BP13F310-TRANS-REC.                                            
           ADD 1 TO WS-F310-WRITTEN.                                            
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------*                                                     
       8500-WRITE-REPORT.                                                       
      *-------------------*                                                     
                                                                                
           IF WS-FIRST-REPORT = 'Y'                                             
              MOVE SPACES                   TO MAIL-HDR-MAIL-RCPT-TO            
                                               MAIL-HDR-MAIL-TO                 
              WRITE P13L9CPA-REC FROM MAIL-HDR-HELO                             
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-FROM                        
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-RCPT-TO1                    
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-RCPT-TO2                    
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-RCPT-TO3                    
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-RCPT-TO4                    
              WRITE P13L9CPA-REC FROM MAIL-HDR-DATA                             
              WRITE P13L9CPA-REC FROM MAIL-HDR-FROM                             
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-TO-LOW                      
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-TO-CC1                      
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-TO-CC2                      
              WRITE P13L9CPA-REC FROM MAIL-HDR-MAIL-TO-CC3                      
              MOVE F410-CDE-ALLOC-SCH       TO SUBJ-TXT(31:3)                   
              STRING '(' WS-DATE-6(7:2) '/' WS-DATE-6(5:2) '/'                  
                   WS-DATE-6(1:4) ')' DELIMITED BY SIZE INTO L9CP1-DATE1        
              STRING '(' WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-YY  ')'          
                      DELIMITED BY SIZE INTO L9CP1-DATE2                        
              STRING L9CP1-DATE1 ' - ' L9CP1-DATE2                              
                     DELIMITED BY SIZE INTO MAIL-SUBJECT-LZ3D(45:27)            
              WRITE P13L9CPA-REC FROM MAIL-SUBJECT-LZ3D                         
              STRING WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-YY                   
                     DELIMITED BY SIZE INTO MAIL-DATE                           
              WRITE P13L9CPA-REC FROM MAIL-HDR-DATE                             
              WRITE P13L9CPA-REC FROM MAIL-SPACES                               
              MOVE    'N'             TO WS-FIRST-REPORT                        
              STRING 'EXCEPTION REPORT FOR ' F410-CDE-ALLOC-SCH                 
                     ' DEBARMENT ' DELIMITED BY SIZE INTO HDR1-TXT              
              WRITE P13L9CPA-REC FROM L9CP1-HEADER1                             
              WRITE P13L9CPA-REC FROM MAIL-SPACES                               
              WRITE P13L9CPA-REC FROM L9CP1-HEADER2                             
              WRITE P13L9CPA-REC FROM L9CP1-HEADER3                             
           END-IF.                                                              
                                                                                
           MOVE SPACES                      TO L9CP1-DETAIL.                    
           INITIALIZE L9CP1-DETAIL.                                             
           ADD 1 TO WS-L9CP1-WRITTEN.                                           
           MOVE WS-L9CP1-WRITTEN            TO L9CP1-SNO.                       
           MOVE F410-NUM-REGN               TO L9CP1-REGN.                      
           MOVE WS-3GEN                     TO L9CP1-3GEN.                      
           MOVE F410-CDE-ALLOC-SCH          TO L9CP1-ALLOC-SCH.                 
           MOVE K80A-NUM-FLAT-TYPE          TO L9CP1-F-TYP.                     
           MOVE WS-UIN(WS-I)                TO L9CP1-NRIC.                      
           MOVE WS-NAME(WS-I)               TO L9CP1-NAME.                      
           MOVE WS-KEY-ISS(WS-I)            TO L9CP1-KI-DATE.                   
           MOVE WS-DEB-RST(WS-I, 1)         TO L9CP1-DEB-RST.                   
           MOVE WS-DEB-RST(WS-I, 2)         TO L9CP1-DEB-RST1.                  
           MOVE WS-DEB-AGR(WS-I, 1)         TO L9CP1-DEB-AGR.                   
           MOVE WS-DEB-AGR(WS-I, 2)         TO L9CP1-DEB-AGR1.                  
           IF K110-DTE-KEY-ISSUED NOT = SPACES AND LOW-VALUES AND               
                                        ZEROES                                  
              STRING K110-DTE-KEY-ISSUED(7:2) '/'                               
                  K110-DTE-KEY-ISSUED(5:2) '/'                                  
                  K110-DTE-KEY-ISSUED(1:4) '/'                                  
                  DELIMITED BY SIZE INTO L9CP1-KI-DATE                          
           ELSE                                                                 
              MOVE SPACES             TO L9CP1-KI-DATE                          
           END-IF.                                                              
           IF F410-DTE-BALLOT NOT = SPACES AND LOW-VALUES AND                   
                                        ZEROES                                  
              STRING F410-DTE-BALLOT(5:2) '/'                                   
                     F410-DTE-BALLOT(1:4) '/'                                   
                  DELIMITED BY SIZE INTO L9CP1-DTE-BALLOT                       
           ELSE                                                                 
              MOVE SPACES             TO L9CP1-DTE-BALLOT                       
           END-IF.                                                              
                                                                                
           WRITE P13L9CPA-REC FROM L9CP1-DETAIL.                                
                                                                                
       8500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       9000-CLOSE-FILES.                                                        
      *---------------------------------------------------------------*         
                                                                                
           CLOSE BP13F410                                                       
                 BP13K800                                                       
                 BP13K80A                                                       
                 BP13K820                                                       
                 BP13K853                                                       
                 BP13K893                                                       
                 BP13K895                                                       
                 BP13K060                                                       
                 BM06K110                                                       
                 P04K010                                                        
                 BP13L9CP                                                       
                 P13L9CPA                                                       
                 BP13F310.                                                      
                                                                                
           IF K800-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K800-STATUS ' K800-STATUS                   
              MOVE K800-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K893-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K893-STATUS ' K893-STATUS                   
              MOVE K893-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K820-STATUS ' K820-STATUS                   
              MOVE K820-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K853-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K853-STATUS ' K853-STATUS                   
              MOVE K853-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K895-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K895-STATUS ' K895-STATUS                   
              MOVE K895-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K80A-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K80A-STATUS ' K80A-STATUS                   
              MOVE K80A-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K010-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K010-STATUS ' K010-STATUS                   
              MOVE K010-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K110-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K110-STATUS ' K110-STATUS                   
              MOVE K110-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           IF K060-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE ERROR, K060-STATUS ' K060-STATUS                   
              MOVE K060-STATUS TO RETURN-CODE                                   
           END-IF.                                                              
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '*================ BP13C9CP ================*'.              
           DISPLAY ' ---FROM DATE: ' WS-DATE-6 ' TO ' WS-CURR-DATE.             
           DISPLAY '   NO. OF F410 RECORDS READ      = ' WS-F410-READ.          
           DISPLAY '   NO. OF K800 RECORDS READ      = ' WS-K800-READ.          
           DISPLAY '   NO. OF K893 RECORDS READ      = ' WS-K893-READ.          
           DISPLAY '   NO. OF K895 RECORDS READ      = ' WS-K895-READ.          
           DISPLAY '   NO. OF K820 RECORDS READ      = ' WS-K820-READ.          
           DISPLAY '   NO. OF K853 RECORDS READ      = ' WS-K853-READ.          
           DISPLAY '   NO. OF K853 SAME NRIC AS HA   = ' WS-K853-SAME-HA        
           DISPLAY '   NO. OF K820 RECORDS NOT FOUND = ' WS-K820-NFND.          
           DISPLAY '   NO. OF K110 RECORDS FOUND     = ' WS-K110-READ.          
           DISPLAY '   NO. OF L9CP RECORDS WRITTEN   = ' WS-L9CP-WRITTEN        
           DISPLAY '   NO. OF REPORT CASES WRITTEN   = '                        
                                                        WS-L9CP1-WRITTEN        
           DISPLAY '   NO. OF F310 RECORDS WRITTEN   = ' WS-F310-WRITTEN        
           DISPLAY '*==========================================*'.              
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
