      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID. BP13C304                                                     
       AUTHOR. CKL.                                                             
                                                                                
      **********************************************************                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *    SYSTEM ID : BP13                                    *                
      **********************************************************                
      *    OBJECTIVE :                                         *                
      *      1.  THIS IS A PROGRAM TO CREATE TRANSACTION       *                
      *          FOR GENREATING GL TRANSACTIONS & HISTORICAL   *                
      *          FINANCIAL TRANSACTION FILE                    *                
      *                                                        *                
      *     INPUT FILES:                                       *                
      *      1. SUCCESSFUL AGREEMENT ORDER FILE (BP13F300)     *                
      *                                                        *                
      *     OUTPUT FILES:                                      *                
      *      1. HISTORICAL FINANCIAL TRANSACTION               *                
      *         FILE (BP13F130)                                *                
      *      2. GL TRANSACTION FILE (BP13F120)                 *                
      *                                                        *                
      **********************************************************                
      * C930993 LJL 191193 TO CATER FOR GST.                   *                
      *BP130302 LJL 200897 TO CATER FOR REGN DEPOSIT.          *                
      *BP130418 SGK 030698 TO CATER FOR Y2K.                   *                
      *BP132309 MCC 240303 TO CATER FOR BANK ORIGINATION.      *                
      *BP132742 BA2 030406 TO WRITE TO B05F005.                *                
      *BP133566 ESA1190509 TO UPDATE F120-NUM-FLAT-TYPE-SA     *                
      *                    FROM F300-NUM-FLAT-TYPE             *                
      *BP134156 JB8 010411 TO REMOVE CHECKING ON CD-CASH/CPF1234*               
      *BP135833 KSJ 090616 CATER FOR EXPANDED SER CONTRA AMT   *                
      *BP136441 KSJ 190916 MOVE LEASE TENURE TO PP SCHEDULE    *                
      **********************************************************                
                                                                                
      *-----------------------*                                                 
       ENVIRONMENT DIVISION.                                                    
      *-----------------------*                                                 
       CONFIGURATION SECTION.                                                   
      *-----------------------*                                                 
                                                                                
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
                                                                                
      *-----------------------*                                                 
       INPUT-OUTPUT SECTION.                                                    
      *-----------------------*                                                 
       FILE-CONTROL.                                                            
           SELECT BP13F300 ASSIGN TO BP13F300.                                  
                                                                                
           SELECT BP13K800  ASSIGN       TO BP13K800                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K800-NUM-REGN                       
                            FILE STATUS  IS WS-K800-STATUS.                     
                                                                                
           SELECT BP13F120 ASSIGN TO BP13F120.                                  
                                                                                
           SELECT BP13F130 ASSIGN TO BP13F130.                                  
                                                                                
           SELECT B05F005  ASSIGN TO B05F005.                                   
                                                                                
      *-----------------------*                                                 
       DATA DIVISION.                                                           
      *-----------------------*                                                 
       FILE SECTION.                                                            
      *-----------------------*                                                 
                                                                                
       FD  BP13F300                                                             
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 2000 CHARACTERS              
                                   LABEL RECORDS ARE STANDARD.                  
       COPY BP13F300.                                                           
                                                                                
       FD  BP13K800                                                             
                                   RECORD CONTAINS 2000 CHARACTERS.             
       COPY BP13K800.                                                           
                                                                                
       FD  BP13F120                                                             
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 150 CHARACTERS               
                                   LABEL RECORDS ARE STANDARD.                  
       COPY BP13F120.                                                           
                                                                                
       FD  BP13F130                                                             
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 150 CHARACTERS               
                                   LABEL RECORDS ARE STANDARD.                  
       COPY BP13F130.                                                           
                                                                                
       FD  B05F005                                                              
                                   RECORDING MODE  IS  F                        
                                   RECORD CONTAINS 160 CHARACTERS.              
       COPY B05F005.                                                            
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                                 
      *-----------------------*                                                 
                                                                                
       01  WS-SEQ                 PIC 9(3)   VALUE ZEROS.                       
       01  WS-DATE-TODAY.                                                       
           03  WS-TODAY-CC        PIC X(2).                                     
           03  WS-TODAY-YY        PIC X(2).                                     
           03  WS-TODAY-MM        PIC X(2).                                     
           03  WS-TODAY-DD        PIC X(2).                                     
                                                                                
       01  WS-TRANS-DATE.                                                       
           03  WS-TRANS-CC        PIC X(2).                                     
           03  WS-TRANS-YY        PIC X(2).                                     
           03  WS-TRANS-MM        PIC X(2).                                     
           03  WS-TRANS-DD        PIC X(2).                                     
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-CD               PIC S9(7)V9(2) VALUE +0.                     
           05  WS-CD-BEF           PIC S9(7)V9(2) VALUE +0.                     
           05  WS-CD-UPD           PIC S9(7)V9(2) VALUE +0.                     
           05  WS-BK-TRANSFER      PIC S9(5)V9(2) VALUE +0.                     
           05  WS-REGN-DEP-TRANSFER PIC S9(5)V9(2) VALUE +0.                    
           05  WS-NO-F300-READ     PIC  9(4)      VALUE ZEROS.                  
           05  WS-NO-F300-AA       PIC  9(4)      VALUE ZEROS.                  
           05  WS-NO-F300-SA       PIC  9(4)      VALUE ZEROS.                  
           05  WS-NO-F120-WR       PIC  9(4)      VALUE ZEROS.                  
           05  WS-NO-F130-WR       PIC  9(4)      VALUE ZEROS.                  
           05  WS-NO-F005-WR       PIC  9(4)      VALUE ZEROS.                  
           05  WS-TOT-AMT          PIC  9(10)V99  VALUE ZEROS.                  
           05  WS-SER-CONTRA-ICP   PIC S9(6)V9(2) VALUE +0.                     
                                                                                
       01  WS-STATUS.                                                           
           05  WS-EOF-F300         PIC X(3).                                    
               88  EOF-F300        VALUE 'YES'.                                 
           05  WS-K800-STATUS      PIC 9(2)    VALUE ZEROES.                    
           05  WS-K800-FND         PIC X(1)    VALUE SPACES.                    
                                                                                
       01  WS-NUM-VOUCHER.                                                      
           05 FILLER               PIC X(2)    VALUE 'SO'.                      
           05 WS-NUM-VOUCHER-MM    PIC X(2).                                    
           05 WS-NUM-VOUCHER-YY    PIC X(2).                                    
                                                                                
       01  WS-NUM-JR.                                                           
           05 FILLER               PIC X(1)    VALUE '0'.                       
           05 WS-NUM-JR-MM         PIC X(2).                                    
           05 WS-NUM-JR-YY         PIC X(2).                                    
                                                                                
      *-----------------------*                                                 
       PROCEDURE DIVISION.                                                      
      *-----------------------*                                                 
                                                                                
      *-----------------------*                                                 
       0000-MAIN-LOGIC.                                                         
      *-----------------------*                                                 
           PERFORM 1000-INIT-RTN  THRU 1000-EXIT.                               
                                                                                
           PERFORM 2000-READ-F300 THRU 2000-EXIT.                               
                                                                                
           PERFORM 3000-MAIN-PROCESS THRU 3000-EXIT                             
           UNTIL   EOF-F300.                                                    
                                                                                
           DISPLAY '***-------- BP13C304 --------***'                           
           DISPLAY 'TOTAL NO. OF RECORD READ FROM BP13F300          = '         
                    WS-NO-F300-READ.                                            
           DISPLAY 'NO. OF RECORD READ WITH F300-CDE-TRANS "SA"     = '         
                    WS-NO-F300-SA.                                              
           DISPLAY 'NO. OF RECORD READ WITH F300-CDE-TRANS NON "SA" = '         
                    WS-NO-F300-AA.                                              
           DISPLAY 'NO. OF RECORDS CREATED IN BP13F120              = '         
                    WS-NO-F120-WR.                                              
           DISPLAY 'NO. OF RECORDS CREATED IN BP13F130              = '         
                    WS-NO-F130-WR.                                              
           DISPLAY 'NO. OF RECORDS CREATED IN B05F005               = '         
                    WS-NO-F005-WR.                                              
                                                                                
           PERFORM 9000-CLOSE-FILES                                             
           THRU    9000-EXIT.                                                   
                                                                                
       0000-FINISH.                                                             
           STOP RUN.                                                            
                                                                                
                                                                                
      *-----------------------*                                                 
       1000-INIT-RTN.                                                           
      *-----------------------*                                                 
           OPEN INPUT  BP13F300                                                 
                       BP13K800                                                 
                OUTPUT BP13F120                                                 
                       BP13F130                                                 
                       B05F005.                                                 
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING BP13K800 ERROR ' WS-K800-STATUS                  
              MOVE     WS-K800-STATUS      TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-DATE-TODAY.                  
           MOVE WS-TODAY-DD                 TO  WS-TRANS-DD.                    
           MOVE WS-TODAY-MM                 TO  WS-TRANS-MM.                    
           MOVE WS-TODAY-CC                 TO  WS-TRANS-CC.                    
           MOVE WS-TODAY-YY                 TO  WS-TRANS-YY.                    
                                                                                
           MOVE 'NO'   TO WS-EOF-F300.                                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       2000-READ-F300.                                                          
      *-----------------------*                                                 
           READ BP13F300                                                        
               AT END MOVE 'YES' TO WS-EOF-F300                                 
                      MOVE HIGH-VALUES TO F300-CUR-REG                          
                      GO TO  2000-EXIT.                                         
                                                                                
           ADD 1     TO WS-NO-F300-READ.                                        
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       3000-MAIN-PROCESS.                                                       
      *-----------------------*                                                 
      *------------------------------------------*                              
      * IF 'AA' CASE (UPDATE AO REC FROM P13M321)                               
      *     PERFORM PARA 5000                                                   
      * ELSE (FROM P13M301)                                                     
      *     PERFORM PARA 4000                                                   
      *------------------------------------------*                              
                                                                                
           IF F300-CDE-TRANS = 'AA'                                             
              ADD 1  TO WS-NO-F300-AA                                           
              PERFORM 5000-PROCESS-AFTER THRU 5000-EXIT                         
           ELSE                                                                 
              PERFORM 4000-PROCESS-REC   THRU 4000-EXIT                         
              ADD 1  TO WS-NO-F300-SA                                           
           END-IF.                                                              
                                                                                
           MOVE +0 TO WS-CD.                                                    
           MOVE +0 TO WS-BK-TRANSFER.                                           
           MOVE +0 TO WS-REGN-DEP-TRANSFER.                                     
                                                                                
           PERFORM 2000-READ-F300 THRU 2000-EXIT.                               
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       4000-PROCESS-REC.                                                        
      *----------------------*                                                  
      * FOR NORMAL SOCA CASE *                                                  
      *----------------------*                                                  
           IF F300-AMT-BK-TRANSFER NOT NUMERIC                                  
              MOVE   ZERO                TO F300-AMT-BK-TRANSFER                
           END-IF.                                                              
                                                                                
           IF F300-AMT-BK-TRANSFER NOT = 0                                      
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  '19'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'BK'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE  F300-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              COMPUTE  WS-BK-TRANSFER    = F300-AMT-BK-TRANSFER * -1            
              MOVE  WS-BK-TRANSFER       TO F120-AMT-RECEIPT                    
              MOVE  'D'                  TO F120-CDE-CRDR                       
              MOVE  F300-CUR-REG         TO F120-NUM-REGN                       
              MOVE  F300-SCH-ACC         TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN                                           
                                                                                
              MOVE  SPACES               TO BP13F130-REC                        
              MOVE  '19'                 TO F130-TRANS-TYPE                     
              MOVE  'BK'                 TO F130-CDE-PAYMENT-TYPE               
              MOVE  WS-TRANS-DATE        TO F130-DTE-POST                       
              MOVE  F300-DTE-AGRM-ORDER  TO F130-DTE-TRANS                      
              MOVE  F300-AMT-BK-TRANSFER TO F130-AMT-RECEIPT                    
              ADD   1                    TO WS-NO-F130-WR                       
              MOVE  F300-CUR-REG         TO F130-NUM-REGN                       
              MOVE  ZEROS                TO F130-COUNT-HISTORY                  
              WRITE BP13F130-REC.                                               
                                                                                
           IF F300-AMT-REGN-DEPOSIT-CASH IS NOT NUMERIC                         
              DISPLAY ' REGN ' F300-CUR-REG                                     
              MOVE ZEROES TO F300-AMT-REGN-DEPOSIT-CASH.                        
                                                                                
           IF F300-AMT-REGN-DEPOSIT-CPF1 IS NOT NUMERIC                         
              MOVE ZEROES TO F300-AMT-REGN-DEPOSIT-CPF1.                        
                                                                                
           IF F300-AMT-REGN-DEPOSIT-CPF2 IS NOT NUMERIC                         
              MOVE ZEROES TO F300-AMT-REGN-DEPOSIT-CPF2.                        
                                                                                
           IF F300-AMT-REGN-DEPOSIT-CPF3 IS NOT NUMERIC                         
              MOVE ZEROES TO F300-AMT-REGN-DEPOSIT-CPF3.                        
                                                                                
           IF F300-AMT-REGN-DEPOSIT-CPF4 IS NOT NUMERIC                         
              MOVE ZEROES TO F300-AMT-REGN-DEPOSIT-CPF4.                        
                                                                                
           IF F300-AMT-REGN-DEPOSIT-CASH NOT = 0  OR                            
              F300-AMT-REGN-DEPOSIT-CPF1 NOT = 0  OR                            
              F300-AMT-REGN-DEPOSIT-CPF2 NOT = 0  OR                            
              F300-AMT-REGN-DEPOSIT-CPF3 NOT = 0  OR                            
              F300-AMT-REGN-DEPOSIT-CPF4 NOT = 0                                
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  '19'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'RDE'                TO F120-CDE-PAYMENT-TYPE               
              MOVE  F300-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              COMPUTE WS-REGN-DEP-TRANSFER =                                    
                      (F300-AMT-REGN-DEPOSIT-CASH +                             
                       F300-AMT-REGN-DEPOSIT-CPF1 +                             
                       F300-AMT-REGN-DEPOSIT-CPF2 +                             
                       F300-AMT-REGN-DEPOSIT-CPF3 +                             
                       F300-AMT-REGN-DEPOSIT-CPF4) * -1                         
              MOVE  WS-REGN-DEP-TRANSFER TO F120-AMT-RECEIPT                    
              MOVE  'D'                  TO F120-CDE-CRDR                       
              MOVE  F300-CUR-REG         TO F120-NUM-REGN                       
              MOVE  F300-SCH-ACC         TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN                                           
                                                                                
              MOVE  SPACES               TO BP13F130-REC                        
              MOVE  '19'                 TO F130-TRANS-TYPE                     
              MOVE  'RDE'                TO F130-CDE-PAYMENT-TYPE               
              MOVE  WS-TRANS-DATE        TO F130-DTE-POST                       
              MOVE  F300-DTE-AGRM-ORDER  TO F130-DTE-TRANS                      
              COMPUTE  F130-AMT-RECEIPT = WS-REGN-DEP-TRANSFER * -1             
              ADD   1                    TO WS-NO-F130-WR                       
              MOVE  F300-CUR-REG         TO F130-NUM-REGN                       
              MOVE  ZEROS                TO F130-COUNT-HISTORY                  
              WRITE BP13F130-REC.                                               
                                                                                
           IF F300-AMT-CAVEAT-REGN NOT NUMERIC                                  
              MOVE  ZERO                 TO F300-AMT-CAVEAT-REGN                
           END-IF.                                                              
                                                                                
           IF F300-AMT-LEASE-STAMP NOT NUMERIC                                  
              MOVE  ZERO                 TO F300-AMT-LEASE-STAMP                
           ELSE                                                                 
              ADD F300-AMT-CAVEAT-REGN   TO F300-AMT-LEASE-STAMP                
           END-IF.                                                              
                                                                                
           IF F300-AMT-LEASE-STAMP NOT = 0                                      
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F300-AMT-LEASE-STAMP TO F120-AMT-RECEIPT                    
              MOVE  'C'                  TO F120-CDE-CRDR                       
              MOVE  F300-CUR-REG         TO F120-NUM-REGN                       
              MOVE  F300-SCH-ACC         TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              MOVE  '23'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'LSE'                TO F120-CDE-PAYMENT-TYPE               
              MOVE  F300-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              ADD   1                    TO WS-NO-F120-WR                       
              ADD   1                    TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN                                           
              PERFORM  6000-PROCESS-B05F005 THRU 6000-EXIT.                     
                                                                                
           IF F300-AMT-CONVEY IS NOT NUMERIC                                    
              MOVE  ZERO    TO  F300-AMT-CONVEY                                 
              DISPLAY 'CONV NOT NUMERIC     '  F300-CUR-REG.                    
                                                                                
           IF F300-AMT-CONVEY NOT = 0                                           
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE F300-CUR-REG          TO F120-NUM-REGN                       
              MOVE  F300-SCH-ACC         TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CON'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE  F300-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              MOVE F300-AMT-CONVEY       TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN.                                          
                                                                                
           IF F300-AMT-CONVEY-GST NOT NUMERIC                                   
              MOVE   ZERO                TO F300-AMT-CONVEY-GST                 
           END-IF.                                                              
                                                                                
           IF F300-AMT-CONVEY-GST NOT = 0                                       
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE F300-CUR-REG          TO F120-NUM-REGN                       
              MOVE  F300-SCH-ACC         TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CST'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE  F300-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              MOVE F300-AMT-CONVEY-GST   TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN.                                          
                                                                                
           IF F300-AMT-MORT-CONVY NOT NUMERIC                                   
              MOVE  ZERO    TO  F300-AMT-MORT-CONVY                             
              DISPLAY 'MORT NOT NUMERIC     '  F300-CUR-REG.                    
                                                                                
           IF F300-AMT-MORT-CONVY NOT = 0                                       
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE F300-CUR-REG          TO F120-NUM-REGN                       
              MOVE  F300-SCH-ACC         TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CON'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE  F300-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              MOVE F300-AMT-MORT-CONVY   TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN.                                          
                                                                                
           IF F300-AMT-MORT-CONVY-GST NOT NUMERIC                               
              MOVE   ZERO                TO F300-AMT-MORT-CONVY-GST             
           END-IF.                                                              
                                                                                
           IF F300-AMT-MORT-CONVY-GST NOT = 0                                   
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE F300-CUR-REG          TO F120-NUM-REGN                       
              MOVE  F300-SCH-ACC         TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CST'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE  F300-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              MOVE F300-AMT-MORT-CONVY-GST TO F120-AMT-RECEIPT                  
              MOVE 'C'                   TO F120-CDE-CRDR                       
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN.                                          
                                                                                
           IF F300-AMT-CD-REQ NOT NUMERIC                                       
              MOVE   ZERO              TO F300-AMT-CD-REQ                       
           END-IF.                                                              
                                                                                
           IF F300-AMT-CD-REQ NOT = 0                                           
              MOVE  SPACES             TO BP13F120-CASHTRAN                     
              MOVE F300-CUR-REG        TO F120-NUM-REGN                         
              MOVE F300-SCH-ACC        TO F120-NUM-SCH-ACCT                     
              MOVE  WS-TRANS-DATE      TO F120-DTE-POST                         
              MOVE  F300-DTE-SALE-AGRM TO F120-DTE-TRANS                        
              MOVE '21'                TO F120-CDE-TRANS-TYPE                   
              MOVE 'CD'                TO F120-CDE-PAYMENT-TYPE                 
              MOVE F300-NUM-FLAT-TYPE  TO F120-NUM-FLAT-TYPE-SA                 
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              IF F300-AMT-TOPUP-CASH NOT NUMERIC                                
                 MOVE  ZERO            TO F300-AMT-TOPUP-CASH                   
              END-IF                                                            
              IF F300-AMT-TOPUP-CPF1 NOT NUMERIC                                
                 MOVE  ZERO            TO F300-AMT-TOPUP-CPF1                   
              END-IF                                                            
              IF F300-AMT-TOPUP-CPF2 NOT NUMERIC                                
                 MOVE  ZERO            TO F300-AMT-TOPUP-CPF2                   
              END-IF                                                            
              IF F300-AMT-TOPUP-CPF3 NOT NUMERIC                                
                 MOVE  ZERO            TO F300-AMT-TOPUP-CPF3                   
              END-IF                                                            
              IF F300-AMT-TOPUP-CPF4 NOT NUMERIC                                
                 MOVE  ZERO            TO F300-AMT-TOPUP-CPF4                   
              END-IF                                                            
              IF F300-AMT-SER-CONTRA-ICP NOT NUMERIC                            
                 MOVE  ZERO            TO F300-AMT-SER-CONTRA-ICP               
              END-IF                                                            
              IF F300-AMT-SER-CONTRA-ICP-NEW NOT NUMERIC                        
                 MOVE  ZEROES          TO F300-AMT-SER-CONTRA-ICP-NEW           
              END-IF                                                            
              IF F300-AMT-SER-CONTRA-ICP-NEW > F300-AMT-SER-CONTRA-ICP          
                 MOVE F300-AMT-SER-CONTRA-ICP-NEW                               
                                       TO WS-SER-CONTRA-ICP                     
              ELSE                                                              
                 MOVE F300-AMT-SER-CONTRA-ICP                                   
                                       TO WS-SER-CONTRA-ICP                     
              END-IF                                                            
              IF F300-AMT-BK-TRANSFER NOT NUMERIC                               
                 MOVE  ZERO            TO F300-AMT-BK-TRANSFER                  
              END-IF                                                            
                                                                                
              COMPUTE WS-CD = F300-AMT-TOPUP-CASH +                             
                              F300-AMT-TOPUP-CPF1 +                             
                              F300-AMT-TOPUP-CPF2 +                             
                              F300-AMT-TOPUP-CPF3 +                             
                              F300-AMT-TOPUP-CPF4 +                             
                              WS-SER-CONTRA-ICP   +                             
                              F300-AMT-BK-TRANSFER +                            
                              F300-AMT-REGN-DEPOSIT-CASH +                      
                              F300-AMT-REGN-DEPOSIT-CPF1 +                      
                              F300-AMT-REGN-DEPOSIT-CPF2 +                      
                              F300-AMT-REGN-DEPOSIT-CPF3 +                      
                              F300-AMT-REGN-DEPOSIT-CPF4                        
                                                                                
              MOVE WS-CD               TO F120-AMT-RECEIPT                      
              MOVE 'C'                 TO F120-CDE-CRDR                         
              ADD   1                  TO WS-NO-F120-WR                         
              ADD  1                   TO WS-SEQ                                
              MOVE WS-SEQ              TO F120-COUNT-HISTORY                    
              WRITE BP13F120-CASHTRAN                                           
                                                                                
              MOVE  SPACES               TO BP13F130-REC                        
              MOVE  '21'                 TO F130-TRANS-TYPE                     
              MOVE  'CD'                 TO F130-CDE-PAYMENT-TYPE               
              MOVE  WS-TRANS-DATE        TO F130-DTE-POST                       
              MOVE  F300-DTE-AGRM-ORDER  TO F130-DTE-TRANS                      
              MOVE  WS-CD                TO F130-AMT-RECEIPT                    
              ADD   1                    TO WS-NO-F130-WR                       
              MOVE  F300-CUR-REG         TO F130-NUM-REGN                       
              MOVE ZEROS                 TO F130-COUNT-HISTORY                  
              WRITE BP13F130-REC.                                               
                                                                                
           IF F300-AMT-SOC-DEBTOR NOT NUMERIC                                   
              MOVE   ZERO                TO F300-AMT-SOC-DEBTOR                 
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-DEBTOR NOT = 0                                       
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE F300-CUR-REG          TO F120-NUM-REGN                       
              MOVE F300-SCH-ACC          TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F300-DTE-SALE-AGRM   TO F120-DTE-TRANS                      
              MOVE '22'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'SOC'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE F300-NUM-FLAT-TYPE  TO F120-NUM-FLAT-TYPE-SA                 
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              MOVE F300-AMT-SOC-DEBTOR   TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN                                           
              MOVE  SPACES               TO BP13F130-REC                        
              MOVE  '22'                 TO F130-TRANS-TYPE                     
              MOVE  'SOC'                TO F130-CDE-PAYMENT-TYPE               
              MOVE  WS-TRANS-DATE        TO F130-DTE-POST                       
              MOVE  F300-DTE-AGRM-ORDER  TO F130-DTE-TRANS                      
              MOVE  F300-AMT-SOC-DEBTOR  TO F130-AMT-RECEIPT                    
              ADD   1                    TO WS-NO-F130-WR                       
              MOVE  F300-CUR-REG         TO F130-NUM-REGN                       
              MOVE ZEROS                 TO F130-COUNT-HISTORY                  
              WRITE BP13F130-REC.                                               
                                                                                
              MOVE 0 TO WS-SEQ.                                                 
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       4100-GET-LEASE-TENURE.                                                   
      *----------------------*                                                  
                                                                                
           MOVE SPACES                     TO   BP13K800-MASTER.                
           MOVE F300-CUR-REG               TO   K800-NUM-REGN.                  
                                                                                
           PERFORM 4110-BP13K800-READ      THRU 4110-EXIT.                      
                                                                                
           IF WS-K800-FND = 'Y'                                                 
              MOVE K800-NUM-LEASE-TENURE                                        
                                           TO   F120-NUM-PP-SCHEDULE            
           ELSE                                                                 
              MOVE SPACES                  TO   F120-NUM-PP-SCHEDULE            
           END-IF.                                                              
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       4110-BP13K800-READ.                                                      
      *----------------------*                                                  
                                                                                
           READ BP13K800.                                                       
                                                                                
           EVALUATE WS-K800-STATUS                                              
           WHEN 00                                                              
              MOVE 'Y'                     TO   WS-K800-FND                     
                                                                                
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE 'N'                     TO   WS-K800-FND                     
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'READ BP13K800 ERROR '    WS-K800-STATUS                  
              MOVE     WS-K800-STATUS      TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       4110-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       5000-PROCESS-AFTER.                                                      
      *----------------------*                                                  
      * FOR AFTER SOCA CASE  *                                                  
      *----------------------*                                                  
      **    IF  F300-AMT-CD-CASH IS NOT NUMERIC                                 
      **        DISPLAY F300-CUR-REG  '  1'                                     
      **        MOVE 0 TO       F300-AMT-CD-CASH                                
      **        ELSE                                                            
      **    IF  F300-AMT-CD-CPF1 IS NOT NUMERIC                                 
      **        DISPLAY F300-CUR-REG  '  2'                                     
      **        MOVE 0 TO       F300-AMT-CD-CPF1                                
      **        ELSE                                                            
      **    IF  F300-AMT-CD-CPF2 IS NOT NUMERIC                                 
      **        DISPLAY F300-CUR-REG  '  3'                                     
      **        MOVE 0 TO       F300-AMT-CD-CPF2                                
      **        ELSE                                                            
      **    IF  F300-AMT-CD-CPF3 IS NOT NUMERIC                                 
      **        DISPLAY F300-CUR-REG  '   4'                                    
      **        MOVE 0 TO       F300-AMT-CD-CPF3                                
      **        ELSE                                                            
      **    IF  F300-AMT-CD-CPF4 IS NOT NUMERIC                                 
      **        DISPLAY F300-CUR-REG  '   5'                                    
      **        MOVE 0 TO       F300-AMT-CD-CPF4.                               
      **                                                                        
      **    COMPUTE WS-CD-BEF = F300-AMT-CD-CASH +                              
      **                        F300-AMT-CD-CPF1 +                              
      **                        F300-AMT-CD-CPF2 +                              
      **                        F300-AMT-CD-CPF3 +                              
      **                        F300-AMT-CD-CPF4.                               
                                                                                
            IF F300-AMT-CD-CASH-UPD IS NOT NUMERIC                              
                DISPLAY F300-CUR-REG      '6'                                   
                MOVE ZEROS  TO  F300-AMT-CD-CASH-UPD                            
                ELSE                                                            
            IF F300-AMT-CD-CPF1-UPD IS NOT NUMERIC                              
                DISPLAY F300-CUR-REG     '7'                                    
                MOVE ZEROS  TO  F300-AMT-CD-CPF1-UPD                            
                ELSE                                                            
            IF F300-AMT-CD-CPF2-UPD IS NOT NUMERIC                              
                DISPLAY F300-CUR-REG     '8'                                    
                MOVE ZEROS  TO  F300-AMT-CD-CPF2-UPD                            
                ELSE                                                            
            IF F300-AMT-CD-CPF3-UPD IS NOT NUMERIC                              
                DISPLAY F300-CUR-REG     '9'                                    
                MOVE ZEROS  TO  F300-AMT-CD-CPF3-UPD                            
                ELSE                                                            
            IF F300-AMT-CD-CPF4-UPD IS NOT NUMERIC                              
                DISPLAY F300-CUR-REG    '10'                                    
                MOVE ZEROS  TO  F300-AMT-CD-CPF4-UPD.                           
                                                                                
            COMPUTE WS-CD-UPD = F300-AMT-CD-CASH-UPD +                          
                                F300-AMT-CD-CPF1-UPD +                          
                                F300-AMT-CD-CPF2-UPD +                          
                                F300-AMT-CD-CPF3-UPD +                          
                                F300-AMT-CD-CPF4-UPD                            
                                                                                
      **   IF WS-CD-UPD >  WS-CD-BEF                                            
      **      COMPUTE WS-CD = WS-CD-UPD - WS-CD-BEF                             
           IF WS-CD-UPD >  0                                                    
              COMPUTE WS-CD = WS-CD-UPD                                         
              MOVE  SPACES             TO BP13F120-CASHTRAN                     
              MOVE F300-CUR-REG        TO F120-NUM-REGN                         
              MOVE F300-SCH-ACC        TO F120-NUM-SCH-ACCT                     
              MOVE  WS-TRANS-DATE      TO F120-DTE-POST                         
              MOVE  F300-DTE-LAST-UPDATE TO F120-DTE-TRANS                      
              MOVE '21'                TO F120-CDE-TRANS-TYPE                   
              MOVE 'CD'                TO F120-CDE-PAYMENT-TYPE                 
              MOVE F300-NUM-FLAT-TYPE  TO F120-NUM-FLAT-TYPE-SA                 
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              MOVE WS-CD               TO F120-AMT-RECEIPT                      
              MOVE 'C'                 TO F120-CDE-CRDR                         
              ADD   1                  TO WS-NO-F120-WR                         
              ADD  1                   TO WS-SEQ                                
              MOVE WS-SEQ              TO F120-COUNT-HISTORY                    
              WRITE BP13F120-CASHTRAN                                           
                                                                                
              MOVE  SPACES             TO BP13F120-CASHTRAN                     
              MOVE F300-CUR-REG        TO F120-NUM-REGN                         
              MOVE F300-SCH-ACC        TO F120-NUM-SCH-ACCT                     
              MOVE  WS-TRANS-DATE      TO F120-DTE-POST                         
              MOVE  F300-DTE-LAST-UPDATE TO F120-DTE-TRANS                      
              MOVE '22'                TO F120-CDE-TRANS-TYPE                   
              MOVE 'SOC'               TO F120-CDE-PAYMENT-TYPE                 
              MOVE F300-NUM-FLAT-TYPE  TO F120-NUM-FLAT-TYPE-SA                 
              PERFORM 4100-GET-LEASE-TENURE THRU 4100-EXIT                      
              MOVE WS-CD               TO F120-AMT-RECEIPT                      
              MOVE 'C'                 TO F120-CDE-CRDR                         
              ADD   1                  TO WS-NO-F120-WR                         
              ADD  1                   TO WS-SEQ                                
              MOVE WS-SEQ              TO F120-COUNT-HISTORY                    
              WRITE BP13F120-CASHTRAN                                           
                                                                                
              MOVE SPACES               TO BP13F130-REC                         
              MOVE '21'                 TO F130-TRANS-TYPE                      
              MOVE 'CD '                TO F130-CDE-PAYMENT-TYPE                
              MOVE F300-DTE-LAST-UPDATE TO F130-DTE-TRANS                       
              MOVE  WS-TRANS-DATE       TO F130-DTE-POST                        
              MOVE WS-CD                TO F130-AMT-RECEIPT                     
              ADD  1                    TO WS-NO-F130-WR                        
              MOVE F300-CUR-REG         TO F130-NUM-REGN                        
              MOVE ZEROS                TO F130-COUNT-HISTORY                   
              WRITE BP13F130-REC                                                
                                                                                
              MOVE SPACES               TO BP13F130-REC                         
              MOVE '22'                 TO F130-TRANS-TYPE                      
              MOVE 'SOC'                TO F130-CDE-PAYMENT-TYPE                
              MOVE F300-DTE-LAST-UPDATE TO F130-DTE-TRANS                       
              MOVE  WS-TRANS-DATE       TO F130-DTE-POST                        
              MOVE WS-CD                TO F130-AMT-RECEIPT                     
              ADD  1                    TO WS-NO-F130-WR                        
              MOVE F300-CUR-REG         TO F130-NUM-REGN                        
              MOVE ZEROS                TO F130-COUNT-HISTORY                   
              WRITE BP13F130-REC.                                               
                                                                                
              MOVE 0 TO WS-SEQ.                                                 
              MOVE 0 TO WS-CD.                                                  
                                                                                
      *       PERFORM  6000-PROCESS-B05F005  THRU 6000-EXIT.                    
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       6000-PROCESS-B05F005.                                                    
      *----------------------*                                                  
      * FOR CPF UPDATION     *                                                  
      *----------------------*                                                  
           MOVE ZEROES TO WS-TOT-AMT.                                           
                                                                                
           IF F300-AMT-LEASE-STAMP-CASH    IS NUMERIC AND                       
              F300-AMT-CAVEAT-REGN-CASH    IS NUMERIC AND                       
              F300-AMT-CAVEAT-REGN-SERCNTR IS NUMERIC AND                       
              F300-AMT-SER-CONTRA-STP-FEES IS NUMERIC                           
              COMPUTE WS-TOT-AMT = F300-AMT-LEASE-STAMP-CASH +                  
                                   F300-AMT-CAVEAT-REGN-CASH +                  
                                   F300-AMT-CAVEAT-REGN-SERCNTR +               
                                   F300-AMT-SER-CONTRA-STP-FEES                 
           END-IF.                                                              
                                                                                
           IF WS-TOT-AMT > 0                                                    
              MOVE SPACES TO F005-RECEIPT-REC                                   
              MOVE WS-TOT-AMT      TO  F005-TOTAL-AMT                           
              MOVE 'CASH'          TO  F005-VR-NO                               
              PERFORM 6100-WRITE-AB05F005 THRU 6100-EXIT                        
           END-IF.                                                              
                                                                                
                                                                                
           MOVE ZEROES TO WS-TOT-AMT.                                           
           IF F300-AMT-LEASE-STAMP-CPF1 IS NUMERIC AND                          
              F300-AMT-CAVEAT-REGN-CPF1 IS NUMERIC                              
              COMPUTE WS-TOT-AMT = F300-AMT-LEASE-STAMP-CPF1 +                  
                                   F300-AMT-CAVEAT-REGN-CPF1                    
           END-IF.                                                              
                                                                                
           IF WS-TOT-AMT > 0                                                    
              MOVE SPACES TO F005-RECEIPT-REC                                   
              MOVE WS-TOT-AMT       TO  F005-TOTAL-AMT                          
              MOVE F300-CPF1        TO  F005-VR-NO                              
              PERFORM 6100-WRITE-AB05F005 THRU 6100-EXIT                        
           END-IF.                                                              
                                                                                
                                                                                
           MOVE ZEROES TO WS-TOT-AMT.                                           
           IF F300-AMT-LEASE-STAMP-CPF2 IS NUMERIC AND                          
              F300-AMT-CAVEAT-REGN-CPF2 IS NUMERIC                              
              COMPUTE WS-TOT-AMT = F300-AMT-LEASE-STAMP-CPF2 +                  
                                   F300-AMT-CAVEAT-REGN-CPF2                    
           END-IF.                                                              
                                                                                
           IF WS-TOT-AMT > 0                                                    
              MOVE SPACES TO F005-RECEIPT-REC                                   
              MOVE WS-TOT-AMT  TO  F005-TOTAL-AMT                               
              MOVE F300-CPF2   TO  F005-VR-NO                                   
              PERFORM 6100-WRITE-AB05F005 THRU 6100-EXIT                        
           END-IF.                                                              
                                                                                
                                                                                
           MOVE ZEROES TO WS-TOT-AMT.                                           
           IF F300-AMT-LEASE-STAMP-CPF3 IS NUMERIC AND                          
              F300-AMT-CAVEAT-REGN-CPF3 IS NUMERIC                              
              COMPUTE WS-TOT-AMT = F300-AMT-LEASE-STAMP-CPF3 +                  
                                   F300-AMT-CAVEAT-REGN-CPF3                    
           END-IF.                                                              
                                                                                
           IF WS-TOT-AMT > 0                                                    
              MOVE SPACES TO F005-RECEIPT-REC                                   
              MOVE WS-TOT-AMT      TO F005-TOTAL-AMT                            
              MOVE F300-CPF3       TO F005-VR-NO                                
              PERFORM 6100-WRITE-AB05F005 THRU 6100-EXIT                        
           END-IF.                                                              
                                                                                
                                                                                
           MOVE ZEROES TO WS-TOT-AMT.                                           
           IF F300-AMT-LEASE-STAMP-CPF4 IS NUMERIC AND                          
              F300-AMT-CAVEAT-REGN-CPF4 IS NUMERIC                              
              COMPUTE WS-TOT-AMT = F300-AMT-LEASE-STAMP-CPF4 +                  
                                   F300-AMT-CAVEAT-REGN-CPF4                    
           END-IF.                                                              
                                                                                
           IF WS-TOT-AMT > 0                                                    
              MOVE SPACES TO F005-RECEIPT-REC                                   
              MOVE WS-TOT-AMT     TO F005-TOTAL-AMT                             
              MOVE F300-CPF4      TO F005-VR-NO                                 
              PERFORM 6100-WRITE-AB05F005 THRU 6100-EXIT                        
           END-IF.                                                              
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       6100-WRITE-AB05F005.                                                     
      *------------------------*                                                
           MOVE F300-SCH-ACC              TO  F005-HDB-REF-SF.                  
           MOVE '8'                       TO  F005-VR-TYPE.                     
           MOVE 'SO'                      TO  F005-SCHEDULE-NO(1:2).            
           MOVE '04'                      TO  F005-SYSTEM-CODE.                 
           MOVE '/'                       TO  F005-SCHEDULE-NO(8:1).            
                                                                                
           MOVE '0000000104250'           TO  F005-VOTE-NO                      
           MOVE 'C'                       TO  F005-CODE.                        
           MOVE SPACES                    TO  F005-NAME.                        
                                                                                
           MOVE WS-TRANS-DATE             TO  F005-RECEIPT-DATE.                
                                                                                
           MOVE WS-TRANS-DATE(1:6)        TO  F005-ACC-MTH-YR.                  
                                                                                
           MOVE WS-TRANS-YY               TO  F005-SCHEDULE-NO(9:2).            
                                                                                
           MOVE WS-TRANS-MM               TO  WS-NUM-VOUCHER-MM.                
           MOVE WS-TRANS-YY               TO  WS-NUM-VOUCHER-YY.                
           MOVE WS-NUM-VOUCHER            TO  F005-RECEIPT-NO.                  
                                                                                
           MOVE WS-TRANS-MM               TO  WS-NUM-JR-MM                      
           MOVE WS-TRANS-YY               TO  WS-NUM-JR-YY.                     
           MOVE WS-NUM-JR                 TO  F005-SCHEDULE-NO(3:5).            
                                                                                
           MOVE 'BP13'                    TO  F005-CDE-SYSTEM.                  
           MOVE 'NS'                      TO  F005-CDE-SFTT.                    
                                                                                
           WRITE F005-RECEIPT-REC.                                              
           ADD 1 TO WS-NO-F005-WR.                                              
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       9000-CLOSE-FILES.                                                        
      *----------------------*                                                  
           CLOSE      BP13F300                                                  
                      BP13K800                                                  
                      BP13F120                                                  
                      BP13F130                                                  
                      B05F005.                                                  
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSING BP13K800 ERROR ' WS-K800-STATUS                  
              MOVE     WS-K800-STATUS      TO   RETURN-CODE                     
           END-IF.                                                              
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
