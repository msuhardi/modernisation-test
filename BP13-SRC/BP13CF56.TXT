       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CF56.                                                 
      *AUTHOR.        ZDD1.                                                     
      *DATE-WRITTEN.  28MAY2012.                                                
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : PRINT SUCC OR UNSUCC LETTER FOR BTO         *            
      *                  MGPS AND PA CASES                         *            
      *  INPUT FILES : 1.  BP13F740  -  SOC REQ FILE               *            
      *                2.  BP13K813                                *            
      *                3.  BP13K825  -  OCCUPIER FILE              *            
      *                4.  BP13K830  -  ADDRESS FILE               *            
      *                                                            *            
      *  LISTINGS    : 5.  P13LF56E                                *            
      *                6.  P13LF56F                                *            
      *                7.  P13LF56G                                *            
      *                7.  P13LF56H                                *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  BY    DATE    DESCRIPTION                         *            
      * -------- ---  ------   -----------                         *            
      * BP133832 ZDD  20100210 NEW PROGRAM.                        *            
      * BP134679 SMR2 20121023 CATER FOR FORM REVISIONS            *            
      * BP134679 SMR2 20121115 CATER FOR FORM REVISIONS            *            
      * BP134718 SMR2 20121214 ADD NME-PROJECT-MGPS-LTR            *            
      * BP134857 SMR2 20130417 CHANGE CONDITION FOR BP13WC & BP13WE*            
      * BP135100 SMR2 20131108 CHECK MGPS FOR BP13WL/WK/WF/WI/WH   *            
      * BP135170 SMR2 20140102 CATER FOR 3GEN                      *            
      * BP135190 SMR2 20131204 EXPAND BP13K813 TO 1000             *            
      * BP135636 SMR2 20150316 NEW IMP NOTES FOR UNSUCC LETTERS-7N *            
      * BP136096 SMR2 20160118 NEW IMP NOTES FOR SINGLES - HQ/HS   *            
      *                        REMOVE IMP NOTES - BP13V8/V0        *            
      *                        REMOVE HARDCODING FOR FLAT TYPE     *            
      * BP136172 SMR2 20160303 REMOVE SA FORMS BP13WB/WD/WG/WJ/WM  *            
      * BP136169 SMR2 20160407 SWITCH THE FIELDS, UNIT & STREET    *            
      *                        REMOVE FORMS - BP13WF/WI            *            
      * BP137685 AM25 20190218 UPDATE TEXT EXERCISE FIELD          *            
      * BP137685 IL5  20190319 CHANGE START POSITION FOR PRINTED   *            
      *                        NT AND FT                           *            
      *                        CHANGE HARD-CODED MGPS FT TO MIXCASE*            
      * BP138311 AM25 20200910 REMOVE FAQS - FORM BP13HN           *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F740  ASSIGN        TO BP13F740.                          
                                                                                
           SELECT BP13K740  ASSIGN        TO BP13K740                           
                            ORGANIZATION  IS INDEXED                            
                            ACCESS MODE   IS DYNAMIC                            
                            RECORD KEY    IS K740-KEY-FLD                       
                            ALTERNATE KEY IS K740-NUM-REGN                      
                            FILE STATUS   IS BP13K740-STATUS.                   
                                                                                
           SELECT BP13K825  ASSIGN        TO BP13K825                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K825-KEY-FLD                       
                            FILE STATUS   IS WS-K825-STATUS.                    
                                                                                
           SELECT BP13K830  ASSIGN        TO BP13K830                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K830-KEY-FLD                       
                            ALTERNATE RECORD KEY IS  K830-NUM-REGN              
                            FILE STATUS   IS WS-K830-STATUS.                    
                                                                                
           SELECT BP13K813  ASSIGN        TO BP13K813                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K813-KEY-FLD                       
                            FILE STATUS   IS WS-K813-STATUS.                    
                                                                                
           SELECT P13LF56E  ASSIGN        TO P13LF56E.                          
           SELECT P13LF56H  ASSIGN        TO P13LF56H.                          
           SELECT P13LF56I  ASSIGN        TO P13LF56I.                          
           SELECT P13LF56K  ASSIGN        TO P13LF56K.                          
           SELECT P13LF56L  ASSIGN        TO P13LF56L.                          
           SELECT P13LF56M  ASSIGN        TO P13LF56M.                          
                                                                                
           SELECT P13LF561  ASSIGN        TO P13LF561.                          
           SELECT P13LF562  ASSIGN        TO P13LF562.                          
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F740                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13F740.                                                           
                                                                                
       FD   BP13K740                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K740.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD  P13LF56E                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF56E-PRT-REC                    PIC X(90).                          
                                                                                
       FD  P13LF56H                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF56H-PRT-REC                    PIC X(90).                          
                                                                                
       FD  P13LF56I                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF56I-PRT-REC                    PIC X(90).                          
                                                                                
       FD  P13LF56K                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF56K-PRT-REC                    PIC X(90).                          
                                                                                
       FD  P13LF56L                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF56L-PRT-REC                    PIC X(90).                          
                                                                                
       FD  P13LF56M                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF56M-PRT-REC                    PIC X(90).                          
                                                                                
       FD  P13LF561                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LF561-PRT-REC                    PIC X(132).                         
                                                                                
       FD  P13LF562                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LF562-PRT-REC                    PIC X(132).                         
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       COPY PRIOSCH.                                                            
                                                                                
       01  WS-STATUS.                                                           
           05  BP13K740-STATUS              PIC 99    VALUE ZEROS.              
           05  WS-K825-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K813-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F740-NOT-FND              PIC 9(06)  VALUE ZEROS.             
           05  WS-NOT-FND-K740              PIC X     VALUE 'N'.                
           05  WS-K740-NOT-FND              PIC 9(06)  VALUE ZEROS.             
           05  WS-F740-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF56E-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF56H-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF56I-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF56K-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF56L-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF56M-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-SUCC          PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-UNSUCC        PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-LF56E            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LF56E            PIC 9(06)  VALUE 60.                
           05  WS-CNT-PAGE-LF56D            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LF56D            PIC 9(06)  VALUE 60.                
           05  WS-RECORD-CNT                PIC ZZZ9.                           
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F740-EOF                  PIC X     VALUE 'N'.                
           05  WS-K740-EOF                  PIC X     VALUE 'N'.                
           05  WS-BALLOT-SW                 PIC X(2)  VALUE SPACES.             
           05  WS-K825-NME-OCCP             PIC X(66) VALUE SPACES.             
           05  WS-ALLOCSCH-TYPE             PIC X(3)  VALUE SPACES.             
           05  WS-FLAT-TYPE                 PIC X(02) VALUE SPACES.             
           05  WS-NEW-TOWN                  PIC X(03) VALUE SPACES.             
           05  WS-MONTH                     PIC X(03) VALUE SPACES.             
           05  WS-IDX-X                     PIC 99    VALUE 01.                 
           05  WS-PAR-FLATYP                PIC X(02) VALUE SPACES.             
           05  WS-PAR-QUEUE                 PIC X(05) VALUE SPACES.             
           05  WS-CHL-FLATYP                PIC X(02) VALUE SPACES.             
           05  WS-CHL-QUEUE                 PIC X(05) VALUE SPACES.             
           05  WS-PA-FLATYP                 PIC X(02) VALUE SPACES.             
           05  WS-PA-QUEUE                  PIC X(05) VALUE SPACES.             
           05  WS-PA-NT                     PIC X(03) VALUE SPACES.             
           05  WS-PA-DTEBAL                 PIC X(06) VALUE SPACES.             
           05  WS-DECODE-ROOM               PIC X(25) VALUE SPACES.             
           05  WS-NUM-UNIT-OFFER            PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-UNIT-OFFER-GEN3       PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-QUEUE-START           PIC X(05) VALUE SPACES.             
           05  WS-NUM-QUEUE-MID             PIC X(05) VALUE SPACES.             
           05  WS-NUM-QUEUE-END             PIC X(05) VALUE SPACES.             
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE-X REDEFINES WS-SENT-DATE PIC X(8).                  
           05  WS-DAYS                      PIC 9(7)  VALUE ZEROES.             
           05  WS-APPMT-TIME.                                                   
               10  WS-APPMT-HR              PIC 9(2)  VALUE 00.                 
               10  WS-APPMT-MIN             PIC 9(2)  VALUE 00.                 
           05  WS-DTE-BALLOT                PIC X(6)  VALUE SPACES.             
           05  WS-MTH-BE                    PIC X(9)  VALUE SPACES.             
                                                                                
       01  WS2-DEFAULT.                                                         
           05  WS2-MAX-LINES-LF56C          PIC 9(2)   VALUE 37.                
           05  WS2-MAX-LINES-LF562          PIC 9(2)   VALUE 45.                
                                                                                
       01  WS-MTH-CONV.                                                         
           05  FILLER                  PIC X(5)    VALUE 'JAN01'.               
           05  FILLER                  PIC X(5)    VALUE 'FEB02'.               
           05  FILLER                  PIC X(5)    VALUE 'MAR03'.               
           05  FILLER                  PIC X(5)    VALUE 'APR04'.               
           05  FILLER                  PIC X(5)    VALUE 'MAY05'.               
           05  FILLER                  PIC X(5)    VALUE 'JUN06'.               
           05  FILLER                  PIC X(5)    VALUE 'JUL07'.               
           05  FILLER                  PIC X(5)    VALUE 'AUG08'.               
           05  FILLER                  PIC X(5)    VALUE 'SEP09'.               
           05  FILLER                  PIC X(5)    VALUE 'OCT10'.               
           05  FILLER                  PIC X(5)    VALUE 'NOV11'.               
           05  FILLER                  PIC X(5)    VALUE 'DEC12'.               
       01  WS-MTH-CONV-TABLE REDEFINES WS-MTH-CONV.                             
           05  WS-TF-MTH       OCCURS 12 TIMES INDEXED BY WS-IDX.               
               10  WS-TRAN-MM          PIC X(3).                                
               10  WS-NUM-MM           PIC X(2).                                
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05 FILLER                   PIC X(12) VALUE                          
             '01  JANUARY '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '02  FEBRUARY'.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '03   MARCH  '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '04   APRIL  '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '05    MAY   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '06   JUNE   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '07   JULY   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '08   AUGUST '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '09 SEPTEMBER'.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '10  OCTOBER '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '11 NOVEMBER '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '12 DECEMBER '.                                                    
       01  FILLER  REDEFINES  WS-MONTHS-IN-DIGITS-AND-WORDS.                    
           05 WS-MONTH-TABLE               OCCURS 12                            
                                           INDEXED BY WS-MTH-IND.               
              10 WS-MONTH-IN-DIGITS    PIC X(02).                               
              10 FILLER                PIC X(01).                               
              10 WS-MONTH-IN-WORDS     PIC X(09).                               
                                                                                
       01  WS-TIME-DATES.                                                       
           05  WS-SYSTEM-DATE.                                                  
               10  WS-SYS-CCYY.                                                 
                   15  WS-SYS-CC              PIC 9(2).                         
                   15  WS-SYS-YY              PIC 9(2).                         
               10  WS-SYS-MM                  PIC 9(2).                         
               10  WS-SYS-DD                  PIC 9(2).                         
           05  WS-EDITED-DATE.                                                  
               10  WS-EDITED-DD               PIC 9(2).                         
               10  FILLER                     PIC X(1)  VALUE '/'.              
               10  WS-EDITED-MM               PIC 9(2).                         
               10  FILLER                     PIC X(1)  VALUE '/'.              
               10  WS-EDITED-YY               PIC 9(4).                         
                                                                                
      *===============================                                          
      *   LINKAGE SECTION FOR AV02C015                                          
      *===============================                                          
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER TO APPLICANT                     *            
      *------------------------------------------------------------*            
       01  LF56-LINE-01.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF56-REF                 PIC X(15) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-02.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF56-DATE                PIC X(13) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-03.                                                        
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF56-NAME01              PIC X(66) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-04.                                                        
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF56-NAME02              PIC X(66) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-05.                                                        
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF56-BLK                 PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  LF56-ADDR-L2             PIC X(47) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-06.                                                        
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF56-UNIT                PIC X(11) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-07.                                                        
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF56-ADDR-L3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-08.                                                        
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LF56-BAR-CODE            PIC X(09) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-FILECOPY.                                                  
           05  FILLER                   PIC X(70) VALUE SPACES.                 
           05  LF56-FILE-COPY           PIC X(09) VALUE 'FILE COPY'.            
                                                                                
       01  LF56-LINE-8C.                                                        
           05  FILLER                   PIC X(22) VALUE SPACES.                 
           05  LF56-MTH-BE              PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF56-YEAR-BE             PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LF56-EXERCISE            PIC X(35) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-8D.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF56-NME-EXERCISE-1      PIC X(70) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-8E.                                                        
           05  FILLER                   PIC X(20) VALUE SPACES.                 
           05  LF56-NME-EXERCISE-2      PIC X(70) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-9A.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF56-ROOM-CHL-A          PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(20) VALUE SPACES.                 
           05  LF56-ESTATE-A            PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-9B.                                                        
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  LF56-ROOM-CHL-B          PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(03) VALUE SPACES.                 
           05  LF56-ESTATE-B            PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-9C.                                                        
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  LF56-ROOM-PAR-B          PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(03) VALUE SPACES.                 
           05  LF56-ESTATE-E            PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-9D.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF56-ROOM-CHL-D          PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(26) VALUE SPACES.                 
           05  LF56-ESTATE-F            PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-9E.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF56-ROOM-CHL-E          PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  LF56-ESTATE-G            PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-09-PAR.                                                    
           05  FILLER                   PIC X(42) VALUE SPACES.                 
           05  LF56-ROOM-PAR            PIC X(25) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-09-PAR-A.                                                  
           05  FILLER                   PIC X(64) VALUE SPACES.                 
           05  LF56-ROOM-PAR-A          PIC X(17) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-09-CHL.                                                    
           05  FILLER                   PIC X(64) VALUE SPACES.                 
           05  LF56-ROOM-CHL-C          PIC X(17) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-09A-EST.                                                   
           05  FILLER                   PIC X(13) VALUE SPACES.                 
           05  LF56-ESTATE-C            PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-09B-EST.                                                   
           05  FILLER                   PIC X(67) VALUE SPACES.                 
           05  LF56-ESTATE-D            PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-10.                                                        
           05  FILLER                   PIC X(28) VALUE SPACES.                 
           05  LF56-NORM-QUEUE          PIC ZZZZ9.                              
                                                                                
       01  LF56-LINE-10A.                                                       
           05  FILLER                   PIC X(42) VALUE SPACES.                 
           05  LF56-NORM-QUEUE-A        PIC ZZZZ9.                              
                                                                                
       01  LF56-LINE-11A.                                                       
           05  FILLER                   PIC X(33) VALUE SPACES.                 
           05  LF56-PA-ROOM-TYP-A       PIC X(17) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-11B.                                                       
           05  FILLER                   PIC X(69) VALUE SPACES.                 
           05  LF56-PA-ROOM-TYP-B       PIC X(17) VALUE SPACES.                 
                                                                                
       01  LF56-LINE-12A.                                                       
           05  FILLER                   PIC X(43) VALUE SPACES.                 
           05  LF56-PA-QUEUE-A          PIC ZZZZ9.                              
           05  FILLER                   PIC X(34) VALUE SPACES.                 
           05  LF56-UNIT-OFFER-A        PIC ZZZ9.                               
                                                                                
       01  LF56-LINE-12B.                                                       
           05  FILLER                   PIC X(59) VALUE SPACES.                 
           05  LF56-PA-QUEUE-B          PIC ZZZZ9.                              
                                                                                
       01  LF56-LINE-12C.                                                       
           05  FILLER                   PIC X(57) VALUE SPACES.                 
           05  LF56-PA-QUEUE-C          PIC ZZZZ9.                              
                                                                                
       01  LF56-LINE-12D.                                                       
           05  FILLER                   PIC X(53) VALUE SPACES.                 
           05  LF56-PA-QUEUE-D          PIC ZZZZ9.                              
                                                                                
       01  LF56-LINE-12E.                                                       
           05  FILLER                   PIC X(65) VALUE SPACES.                 
           05  LF56-PA-QUEUE-E          PIC ZZZZ9.                              
                                                                                
       01  LF56-LINE-12F.                                                       
           05  FILLER                   PIC X(50) VALUE SPACES.                 
           05  LF56-PA-QUEUE-F          PIC ZZZZ9.                              
                                                                                
       01  LF56-LINE-13B.                                                       
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LF56-UNIT-OFFER-B        PIC ZZZ9.                               
                                                                                
       01  LF56-LINE-13C.                                                       
           05  FILLER                   PIC X(26) VALUE SPACES.                 
           05  LF56-UNIT-OFFER-C        PIC ZZZ9.                               
                                                                                
       01  LF56-LINE-13D.                                                       
           05  FILLER                   PIC X(17) VALUE SPACES.                 
           05  LF56-UNIT-OFFER-D        PIC ZZZ9.                               
                                                                                
       01  LF56-LINE-13E.                                                       
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  LF56-UNIT-OFFER-E        PIC ZZZ9.                               
                                                                                
       01  LF56-LINE-14.                                                        
           05  FILLER                   PIC X(53) VALUE SPACES.                 
           05  LF56-OUTCOME             PIC X(17) VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  LF56A-HDG1.                                                          
           05  LF56A-LISTING            PIC X(14) VALUE 'P13LF56C'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  LF56A-DATE               PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  LF56A-PAGE               PIC ZZZZ9.                              
                                                                                
       01  LF56A-HDG2.                                                          
           05  FILLER                   PIC X(20) VALUE SPACES.                 
           05  LF56A-LISTING-TYPE       PIC X(89) VALUE SPACES.                 
                                                                                
       01  LF56A-HDG4.                                                          
           05  FILLER                   PIC X(7)  VALUE ' S/N   '.              
           05  FILLER                   PIC X(9)  VALUE 'REF-NO   '.            
           05  FILLER                   PIC X(15) VALUE                         
               'APPLICANT NAMES'.                                               
           05  FILLER                   PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE '  UIN  '.              
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE 'CAT  '.                
           05  FILLER                   PIC X(5)  VALUE 'ALLOC'.                
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'FLAT'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'HHTY   '.              
           05  FILLER                   PIC X(4)  VALUE 'MCPS'.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'RES-HA1'.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'SUCC'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'NT1   '.               
           05  FILLER                   PIC X(6)  VALUE 'UNSUCC'.               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'BALLOT'.               
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE 'ZE'.                   
                                                                                
       01  LF56A-HDG5.                                                          
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'REGN-NO'.              
           05  FILLER                   PIC X(40) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'SCH'.                  
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'TYPE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE '    '.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE '       '.              
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE '     '.                
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'ZONE   '.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE '   '.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'ZONE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'POS'.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'Q-POS'.                
                                                                                
       01  LF56A-HDG6.                                                          
           05  FILLER                   PIC X(7)  VALUE '       '.              
           05  FILLER                   PIC X(9)  VALUE 'LOAN-TAG '.            
           05  FILLER                   PIC X(15) VALUE                         
               'REQ-STATUS     '.                                               
                                                                                
       01  LF56A-DTL-1.                                                         
           05  LF56A-SERIAL-NO          PIC ZZZ9.                               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF56A-REF-NO             PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF56A-NAME-1             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF56A-NRIC-1             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF56A-CAT                PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF56A-ALLOC              PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF56A-FLAT               PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LF56A-HHTY               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF56A-MCPS               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(9)  VALUE SPACES.                 
           05  LF56A-RES-HA1            PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF56A-SUCC               PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF56A-NT1                PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  LF56A-UNSUCC             PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LF56A-BALLOT-POS         PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF56A-ZONE               PIC X(2)  VALUE SPACES.                 
                                                                                
       01  LF56A-DTL-2.                                                         
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF56A-REGN-NO            PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF56A-NAME-2             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF56A-NRIC-2             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(79) VALUE SPACES.                 
           05  LF56A-QUEUE              PIC X(5)  VALUE SPACES.                 
                                                                                
       01  LF56A-DTL-3.                                                         
           05  FILLER                   PIC X(16) VALUE SPACES.                 
           05  LF56A-BLK                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF56A-UNIT               PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF56A-ADDR2              PIC X(65) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF56A-ADDR3              PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF56A-DTL-4.                                                         
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF56A-LOAN-TAG           PIC X(6)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF56A-REQ-STATUS         PIC X(22) VALUE SPACES.                 
                                                                                
       01  DJDE-LINE-NON-POD1             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13K1,BFORM=BP13K2,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-NON-POD2             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13KQ,BFORM=BLANKF,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-WA                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WA,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WC                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WC,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WE                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WE,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WH                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WH,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WK                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WK,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WL                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WL,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-BLANKF                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BLANKF,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V6                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V6,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V7                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V7,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V9                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V9,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP137N                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP137N,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13HQ                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13HQ,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13HS                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13HS,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
       0000-MAIN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           PERFORM 1000-OPEN-FILES             THRU 1000-EXIT.                  
           PERFORM 3500-READ-BP13F740          THRU 3500-EXIT.                  
           PERFORM 3000-PROCESS-RECORDS        THRU 3000-EXIT                   
                   UNTIL WS-F740-EOF = 'Y'.                                     
           PERFORM 9000-CLOSE-ROUTINE          THRU 9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-FILES.                                                         
      ******************************************************************        
                                                                                
           OPEN INPUT BP13F740                                                  
                      BP13K740                                                  
                      BP13K825                                                  
                      BP13K830                                                  
                      BP13K813                                                  
               OUTPUT P13LF56E                                                  
                      P13LF56H                                                  
                      P13LF56I                                                  
                      P13LF56K                                                  
                      P13LF56L                                                  
                      P13LF56M                                                  
                      P13LF561                                                  
                      P13LF562.                                                 
                                                                                
           IF BP13K740-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K740-STATUS ' BP13K740-STATUS          
              MOVE     BP13K740-STATUS TO RETURN-CODE                           
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K825-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K825 STATUS IS ' WS-K825-STATUS            
              MOVE     WS-K825-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K830 STATUS IS ' WS-K830-STATUS            
              MOVE     WS-K830-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K813 STATUS IS ' WS-K813-STATUS            
              MOVE     WS-K813-STATUS TO RETURN-CODE                            
              PERFORM  9000-CLOSE-ROUTINE.                                      
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-SYSTEM-DATE.                 
                                                                                
           MOVE   WS-SYS-DD           TO WS-EDITED-DD.                          
           MOVE   WS-SYS-MM           TO WS-EDITED-MM.                          
           MOVE   WS-SYS-CCYY         TO WS-EDITED-YY.                          
           MOVE   WS-EDITED-DATE      TO LF56A-DATE.                            
                                                                                
           MOVE SPACES                   TO LF56E-PRT-REC                       
                                            LF56H-PRT-REC                       
                                            LF56I-PRT-REC                       
                                            LF56K-PRT-REC                       
                                            LF56L-PRT-REC                       
                                            LF56M-PRT-REC.                      
                                                                                
           MOVE SPACES           TO LF56E-PRT-REC.                              
           WRITE LF56E-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF56E-PRT-REC.                              
           WRITE LF56E-PRT-REC   AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF56H-PRT-REC.                              
           WRITE LF56H-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF56H-PRT-REC.                              
           WRITE LF56H-PRT-REC   AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF56I-PRT-REC.                              
           WRITE LF56I-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF56I-PRT-REC.                              
           WRITE LF56I-PRT-REC   AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF56K-PRT-REC.                              
           WRITE LF56K-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF56K-PRT-REC.                              
           WRITE LF56K-PRT-REC   AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF56L-PRT-REC.                              
           WRITE LF56L-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF56L-PRT-REC.                              
           WRITE LF56L-PRT-REC   AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF56M-PRT-REC.                              
           WRITE LF56M-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF56M-PRT-REC.                              
           WRITE LF56M-PRT-REC   AFTER PAGE.                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3000-PROCESS-RECORDS.                                                    
      ******************************************************************        
                                                                                
           MOVE SPACES                 TO   WS-PAR-FLATYP                       
                                            WS-PAR-QUEUE                        
                                            WS-CHL-FLATYP                       
                                            WS-CHL-QUEUE                        
                                            WS-PA-FLATYP                        
                                            WS-PA-QUEUE                         
                                            WS-PA-NT                            
                                            WS-PA-DTEBAL                        
                                            WS-NUM-QUEUE-START                  
                                            WS-NUM-QUEUE-MID                    
                                            WS-NUM-QUEUE-END.                   
                                                                                
           MOVE SPACES                 TO   LF56-ROOM-PAR                       
                                            LF56-ROOM-PAR-A                     
                                            LF56-ROOM-PAR-B                     
                                            LF56-ROOM-CHL-A                     
                                            LF56-ROOM-CHL-B                     
                                            LF56-ROOM-CHL-C                     
                                            LF56-ROOM-CHL-D                     
                                            LF56-ROOM-CHL-E                     
                                            LF56-PA-ROOM-TYP-A                  
                                            LF56-PA-ROOM-TYP-B.                 
                                                                                
           MOVE ZEROES                 TO   WS-NUM-UNIT-OFFER                   
                                            WS-NUM-UNIT-OFFER-GEN3.             
                                                                                
           MOVE F740-NUM-REGN                  TO LF56-REF.                     
                                                                                
           IF F740-NUM-MGPS      =  'P'                                         
              MOVE F740-CDE-FLAT-TYPE          TO   WS-PAR-FLATYP               
              MOVE F740-NUM-NT-FT-QUEUE        TO   WS-PAR-QUEUE                
                                                                                
              MOVE SPACES                      TO   K813-KEY-FLD                
              MOVE F740-CDE-NT1                TO   K813-NUM-ZONE               
              MOVE F740-CDE-FLAT-TYPE          TO   K813-NUM-FLAT-TYPE          
              MOVE F740-DTE-BALLOT             TO   K813-DTE-BALLOT             
              PERFORM 3100-READ-K813-ROOM      THRU 3100-EXIT                   
              MOVE WS-DECODE-ROOM              TO   LF56-ROOM-PAR               
                                                    LF56-ROOM-PAR-A             
                                                    LF56-ROOM-PAR-B             
                                                                                
              MOVE SPACES                      TO   BP13K740-REC                
              MOVE F740-NUM-JB-REGN            TO   K740-NUM-REGN               
              PERFORM 4000-READ-BP13K740       THRU 4000-EXIT                   
              MOVE K740-CDE-FLAT-TYPE          TO   WS-CHL-FLATYP               
              MOVE K740-NUM-NT-FT-QUEUE        TO   WS-CHL-QUEUE                
                                                                                
              MOVE SPACES                      TO   K813-KEY-FLD                
              MOVE K740-CDE-NT1                TO   K813-NUM-ZONE               
              MOVE K740-CDE-FLAT-TYPE          TO   K813-NUM-FLAT-TYPE          
              MOVE K740-DTE-BALLOT             TO   K813-DTE-BALLOT             
              PERFORM 3100-READ-K813-ROOM      THRU 3100-EXIT                   
              IF K813-NUM-GEN3-TAG = 'Y'                                        
                 MOVE '5-room flat'            TO   LF56-ROOM-CHL-A             
                                                    LF56-ROOM-CHL-B             
                                                    LF56-ROOM-CHL-C             
                                                    LF56-ROOM-CHL-D             
                                                    LF56-ROOM-CHL-E             
              ELSE                                                              
                 MOVE WS-DECODE-ROOM           TO   LF56-ROOM-CHL-A             
                                                    LF56-ROOM-CHL-B             
                                                    LF56-ROOM-CHL-C             
                                                    LF56-ROOM-CHL-D             
                                                    LF56-ROOM-CHL-E             
              END-IF                                                            
           ELSE                                                                 
              MOVE F740-CDE-FLAT-TYPE          TO  WS-CHL-FLATYP                
              MOVE F740-NUM-NT-FT-QUEUE        TO  WS-CHL-QUEUE                 
                                                                                
              MOVE SPACES                      TO   K813-KEY-FLD                
              MOVE F740-CDE-NT1                TO   K813-NUM-ZONE               
              MOVE F740-CDE-FLAT-TYPE          TO   K813-NUM-FLAT-TYPE          
              MOVE F740-DTE-BALLOT             TO   K813-DTE-BALLOT             
              PERFORM 3100-READ-K813-ROOM      THRU 3100-EXIT                   
              IF K813-NUM-GEN3-TAG = 'Y'                                        
                 MOVE '5-room flat'            TO   LF56-ROOM-CHL-A             
                                                    LF56-ROOM-CHL-B             
                                                    LF56-ROOM-CHL-C             
                                                    LF56-ROOM-CHL-D             
                                                    LF56-ROOM-CHL-E             
              ELSE                                                              
                 MOVE WS-DECODE-ROOM           TO   LF56-ROOM-CHL-A             
                                                    LF56-ROOM-CHL-B             
                                                    LF56-ROOM-CHL-C             
                                                    LF56-ROOM-CHL-D             
                                                    LF56-ROOM-CHL-E             
              END-IF                                                            
                                                                                
              MOVE SPACES                      TO   BP13K740-REC                
              MOVE F740-NUM-JB-REGN            TO   K740-NUM-REGN               
              PERFORM 4000-READ-BP13K740       THRU 4000-EXIT                   
              MOVE K740-CDE-FLAT-TYPE          TO   WS-PAR-FLATYP               
              MOVE K740-NUM-NT-FT-QUEUE        TO   WS-PAR-QUEUE                
                                                                                
              MOVE SPACES                      TO   K813-KEY-FLD                
              MOVE K740-CDE-NT1                TO   K813-NUM-ZONE               
              MOVE K740-CDE-FLAT-TYPE          TO   K813-NUM-FLAT-TYPE          
              MOVE K740-DTE-BALLOT             TO   K813-DTE-BALLOT             
              PERFORM 3100-READ-K813-ROOM      THRU 3100-EXIT                   
              MOVE WS-DECODE-ROOM              TO   LF56-ROOM-PAR               
                                                    LF56-ROOM-PAR-A             
                                                    LF56-ROOM-PAR-B             
           END-IF.                                                              
                                                                                
           PERFORM 4100-STARTBR-K740      THRU 4100-EXIT                        
                                                                                
           MOVE SPACES                    TO   K813-KEY-FLD                     
           MOVE WS-PA-NT                  TO   K813-NUM-ZONE                    
           MOVE WS-PA-FLATYP              TO   K813-NUM-FLAT-TYPE               
           MOVE WS-PA-DTEBAL              TO   K813-DTE-BALLOT                  
           PERFORM 3100-READ-K813-ROOM    THRU 3100-EXIT                        
           IF K813-NUM-GEN3-TAG = 'Y' AND                                       
             (K740-NUM-GEN3 NOT = 'Y')                                          
              MOVE '5-room flat'          TO   LF56-PA-ROOM-TYP-A               
                                               LF56-PA-ROOM-TYP-B               
           ELSE                                                                 
              MOVE WS-DECODE-ROOM         TO   LF56-PA-ROOM-TYP-A               
                                               LF56-PA-ROOM-TYP-B               
           END-IF.                                                              
                                                                                
           PERFORM 5300-READ-K813         THRU 5300-EXIT                        
           PERFORM 4500-MOVE-DETAILS      THRU 4500-EXIT                        
                                                                                
           PERFORM 3500-READ-BP13F740     THRU 3500-EXIT.                       
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3100-READ-K813-ROOM.                                                     
      ******************************************************************        
                                                                                
           MOVE SPACES                      TO WS-DECODE-ROOM.                  
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE WS-K813-STATUS                                              
           WHEN 00                                                              
              MOVE K813-NME-FLAT-TYPE-LTR   TO WS-DECODE-ROOM                   
                                                                                
           WHEN 23                                                              
              DISPLAY 'RECORD NOT FOUND IN BP13K813, KEY IS '                   
                       K813-KEY-FLD                                             
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'ERROR IN READING BP13K813, STATUS - '                    
                       WS-K813-STATUS                                           
              PERFORM 9000-CLOSE-ROUTINE    THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3500-READ-BP13F740.                                                      
      ******************************************************************        
                                                                                
           READ BP13F740                                                        
                AT END MOVE 'Y' TO WS-F740-EOF                                  
                       GO TO 3500-EXIT.                                         
                                                                                
           ADD  1   TO  WS-F740-READ-CTR.                                       
           MOVE 'N' TO  WS-NOT-FND-K740.                                        
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4000-READ-BP13K740.                                                      
      ******************************************************************        
                                                                                
            MOVE 'N' TO WS-NOT-FND-K740.                                        
            READ BP13K740 KEY IS K740-NUM-REGN.                                 
                                                                                
            EVALUATE BP13K740-STATUS                                            
               WHEN '00'                                                        
               WHEN '02'                                                        
                  CONTINUE                                                      
               WHEN '23'                                                        
                  ADD 1     TO WS-K740-NOT-FND                                  
                  DISPLAY 'RECORD NOT FOUND IN BP13K740, KEY IS '               
                  F740-NUM-REGN                                                 
                  MOVE 'Y' TO WS-NOT-FND-K740                                   
               WHEN OTHER                                                       
                  DISPLAY 'ERROR IN READING BP13K740, STATUS - '                
                  BP13K740-STATUS                                               
                  PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                     
            END-EVALUATE.                                                       
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4100-STARTBR-K740.                                                       
      ******************************************************************        
                                                                                
           MOVE LOW-VALUES                 TO K740-NUM-REGN.                    
           MOVE F740-NUM-REGN              TO K740-NUM-REGN.                    
                                                                                
           MOVE 'N'                        TO WS-K740-EOF.                      
                                                                                
           START BP13K740 KEY >= K740-NUM-REGN.                                 
                                                                                
           EVALUATE BP13K740-STATUS                                             
           WHEN ZEROES                                                          
              PERFORM 4200-READNEXT-K740   THRU 4200-EXIT                       
                UNTIL K740-NUM-REGN NOT = F740-NUM-REGN                         
                   OR WS-K740-EOF = 'Y'                                         
                                                                                
           WHEN 10                                                              
           WHEN 23                                                              
              ADD 1                        TO WS-K740-NOT-FND                   
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'ERROR IN STARTBR OF BP13K740. STATUS IS '                
                      BP13K740-STATUS                                           
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4200-READNEXT-K740.                                                      
      ******************************************************************        
                                                                                
           READ BP13K740 NEXT RECORD                                            
                AT END MOVE 'Y'            TO WS-K740-EOF.                      
                                                                                
           EVALUATE BP13K740-STATUS                                             
           WHEN ZEROES                                                          
           WHEN 02                                                              
              IF K740-NUM-REGN = F740-NUM-REGN AND                              
                 K740-NUM-RANDOM(28:1) = 'M'                                    
                 MOVE K740-CDE-FLAT-TYPE   TO WS-PA-FLATYP                      
                 MOVE K740-NUM-NT-FT-QUEUE TO WS-PA-QUEUE                       
                 MOVE K740-CDE-NT1         TO WS-PA-NT                          
                 MOVE K740-DTE-BALLOT      TO WS-PA-DTEBAL                      
                 MOVE 'Y'                  TO WS-K740-EOF                       
              END-IF                                                            
                                                                                
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE 'Y'                     TO WS-K740-EOF                       
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'ERROR IN READ NEXT OF BP13K740. STATUS IS '              
                      BP13K740-STATUS                                           
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4500-MOVE-DETAILS.                                                       
      ******************************************************************        
                                                                                
           MOVE F740-DTE-BALLOT  TO WS-DTE-BALLOT.                              
                                                                                
           EVALUATE WS-DTE-BALLOT(5:2)                                          
           WHEN 01                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'JANUARY '    F740-DTE-BALLOT(1:4)                          
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
           WHEN 02                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'FEBRUARY '    F740-DTE-BALLOT(1:4)                         
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 03                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'MARCH '    F740-DTE-BALLOT(1:4)                            
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 04                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'APRIL '    F740-DTE-BALLOT(1:4)                            
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 05                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'MAY '    F740-DTE-BALLOT(1:4)                              
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 06                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'JUNE '    F740-DTE-BALLOT(1:4)                             
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 07                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'JULY '    F740-DTE-BALLOT(1:4)                             
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 08                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'AUGUST '    F740-DTE-BALLOT(1:4)                           
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 09                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'SEPTEMBER '    F740-DTE-BALLOT(1:4)                        
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 10                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'OCTOBER '    F740-DTE-BALLOT(1:4)                          
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 11                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'NOVEMBER '    F740-DTE-BALLOT(1:4)                         
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
                                                                                
           WHEN 12                                                              
             STRING 'FLAT APPLICATION IN '                                      
                    'DECEMBER '    F740-DTE-BALLOT(1:4)                         
                      ' BUILD-TO-ORDER (BTO) EXERCISE '                         
               DELIMITED BY SIZE INTO       LF56-NME-EXERCISE-1                 
               MOVE   'UNDER THE MULTI-GENERATION PRIORITY SCHEME'              
                       TO   LF56-NME-EXERCISE-2                                 
           END-EVALUATE.                                                        
                                                                                
           MOVE SPACES                    TO K825-KEY-FLD.                      
           MOVE K740-NUM-REGN             TO K825-NUM-REGN.                     
           MOVE K740-NUM-NRIC1            TO K825-NUM-NRIC.                     
                                                                                
           PERFORM  4600-READ-K825      THRU 4600-EXIT.                         
           MOVE     WS-K825-NME-OCCP      TO LF56-NAME01.                       
                                                                                
           IF K740-NUM-NRIC2 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                 TO    LF56-NAME02                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE K740-NUM-REGN             TO K825-NUM-REGN                   
              MOVE K740-NUM-NRIC2            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LF56-NAME02                     
           END-IF.                                                              
                                                                                
           PERFORM  8000-CHECK-SCH   THRU  8000-EXIT.                           
           PERFORM  4800-GET-ADDR    THRU  4800-EXIT.                           
                                                                                
      *** PARENT DETAILS ***                                                    
      *    IF   WS-PAR-FLATYP(1:1) = '1'                                        
      *       MOVE 'Studio Apartment (SA)' TO LF56-ROOM-PAR                     
      *    ELSE                                                                 
      *       STRING WS-PAR-FLATYP(1:1) '-room flat'                            
      *       DELIMITED BY SIZE     INTO LF56-ROOM-PAR                          
      *    END-IF.                                                              
                                                                                
      *    MOVE LF56-ROOM-PAR         TO LF56-ROOM-PAR-A                        
      *                                  LF56-ROOM-PAR-B.                       
                                                                                
      *** CHILD DETAILS ***                                                     
      *    IF   WS-CHL-FLATYP(1:1) = '1'                                        
      *       MOVE 'Studio Apartment' TO LF56-ROOM-CHL-A                        
      *    ELSE                                                                 
      *       STRING WS-CHL-FLATYP(1:1) '-room flat'                            
      *       DELIMITED BY SIZE     INTO LF56-ROOM-CHL-A                        
      *    END-IF.                                                              
                                                                                
      *    MOVE LF56-ROOM-CHL-A       TO LF56-ROOM-CHL-B                        
      *                                  LF56-ROOM-CHL-C.                       
                                                                                
      *** MGP DETAILS - NUM-RANDOM(28:1) = 'M' ***                              
      *    IF   WS-PA-FLATYP(1:1)  = '1'                                        
      *       MOVE 'Studio Apartment' TO LF56-PA-ROOM-TYP-A                     
      *                                  LF56-PA-ROOM-TYP-B                     
      *    ELSE                                                                 
      *       STRING WS-PA-FLATYP(1:1) '-room flat'                             
      *       DELIMITED BY SIZE     INTO LF56-PA-ROOM-TYP-A                     
      *       STRING WS-PA-FLATYP(1:1) '-room flat'                             
      *       DELIMITED BY SIZE     INTO LF56-PA-ROOM-TYP-B                     
      *    END-IF.                                                              
                                                                                
           MOVE F740-NUM-NT-FT-QUEUE TO LF56-NORM-QUEUE                         
                                        LF56-NORM-QUEUE-A                       
           MOVE WS-PA-QUEUE          TO LF56-PA-QUEUE-A                         
                                        LF56-PA-QUEUE-B                         
                                        LF56-PA-QUEUE-C                         
                                        LF56-PA-QUEUE-D                         
                                        LF56-PA-QUEUE-E                         
                                        LF56-PA-QUEUE-F                         
                                                                                
           IF K813-NUM-GEN3-TAG = 'Y'                                           
              IF K740-NUM-GEN3 = 'Y'                                            
                 CONTINUE                                                       
      *          MOVE '5-room/3Gen flat'       TO LF56-PA-ROOM-TYP-A            
      *                                           LF56-PA-ROOM-TYP-B            
              ELSE                                                              
                 MOVE K813-NUM-UNIT-OFFER   TO WS-NUM-UNIT-OFFER                
                 IF K813-NUM-UNIT-OFFER-GEN3 IS NOT NUMERIC                     
                    MOVE ZEROES             TO WS-NUM-UNIT-OFFER-GEN3           
                 ELSE                                                           
                    MOVE K813-NUM-UNIT-OFFER-GEN3                               
                                            TO WS-NUM-UNIT-OFFER-GEN3           
                 END-IF                                                         
                 COMPUTE LF56-UNIT-OFFER-A = WS-NUM-UNIT-OFFER -                
                                             WS-NUM-UNIT-OFFER-GEN3             
                 MOVE LF56-UNIT-OFFER-A     TO LF56-UNIT-OFFER-B                
                                               LF56-UNIT-OFFER-C                
                                               LF56-UNIT-OFFER-D                
                                               LF56-UNIT-OFFER-E                
                                                                                
                 IF K813-NUM-QUEUE-START-MGPSGEN3 IS NOT NUMERIC                
                    MOVE ZEROES        TO K813-NUM-QUEUE-START-MGPSGEN3         
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-START-MGPSGEN3                             
                                       TO WS-NUM-QUEUE-START                    
                 IF K813-NUM-QUEUE-MID-MGPSGEN3 IS NOT NUMERIC                  
                    MOVE ZEROES        TO K813-NUM-QUEUE-MID-MGPSGEN3           
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-MID-MGPSGEN3                               
                                       TO WS-NUM-QUEUE-MID                      
                 IF K813-NUM-QUEUE-END-MGPSGEN3 IS NOT NUMERIC                  
                    MOVE ZEROES        TO K813-NUM-QUEUE-END-MGPSGEN3           
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-END-MGPSGEN3                               
                                       TO WS-NUM-QUEUE-END                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F740-CDE-FLAT-TYPE(1:1) NOT = '1'                                 
              IF K740-NUM-NT-FT-QUEUE = SPACES OR LOW-VALUES OR ZEROES          
                 IF K813-NUM-MATURE-EST-TAG = 'Y'                               
                    PERFORM 6700-PRT-BP13WL         THRU 6700-EXIT              
                    PERFORM 7000-PRINT-CONTROL-LIST THRU 7000-EXIT              
                    GO TO 4500-EXIT                                             
                 ELSE                                                           
                    PERFORM 6800-PRT-BP13WK         THRU 6800-EXIT              
                    PERFORM 7000-PRINT-CONTROL-LIST THRU 7000-EXIT              
                    GO TO 4500-EXIT                                             
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF K740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-START                     
                 PERFORM 6400-PRT-BP13WA         THRU 6400-EXIT                 
                 PERFORM 7000-PRINT-CONTROL-LIST THRU 7000-EXIT                 
                 GO TO 4500-EXIT                                                
              END-IF                                                            
                                                                                
              IF K740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-START AND                  
                 K740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-MID                       
                 PERFORM 6410-PRT-BP13WC         THRU 6410-EXIT                 
                 PERFORM 7000-PRINT-CONTROL-LIST THRU 7000-EXIT                 
                 GO TO 4500-EXIT                                                
              END-IF                                                            
                                                                                
              IF K740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-MID AND                    
                 K740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-END                       
                 PERFORM 6510-PRT-BP13WE         THRU 6510-EXIT                 
                 PERFORM 7000-PRINT-CONTROL-LIST THRU 7000-EXIT                 
                 GO TO 4500-EXIT                                                
              END-IF                                                            
                                                                                
              IF K740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-END                        
                 PERFORM 6610-PRT-BP13WH         THRU 6610-EXIT                 
                 PERFORM 7000-PRINT-CONTROL-LIST THRU 7000-EXIT                 
                 GO TO 4500-EXIT                                                
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4600-READ-K825.                                                          
      ******************************************************************        
                                                                                
           MOVE    SPACES                TO  WS-K825-NME-OCCP                   
           READ BP13K825.                                                       
                                                                                
           IF WS-K825-STATUS = 00 OR 02                                         
              MOVE    K825-NME-OCCP      TO  WS-K825-NME-OCCP                   
           ELSE                                                                 
           IF WS-K825-STATUS = 23                                               
              DISPLAY 'K825 REC NOT FOUND : '   K825-KEY-FLD                    
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K825 = '   WS-K825-STATUS              
                      ', K825-KEY-FLD = '   K825-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4800-GET-ADDR.                                                           
      ******************************************************************        
                                                                                
           MOVE SPACES TO LF56-LINE-06 LF56-LINE-07 LF56-LINE-08.               
           MOVE SPACES TO LF56-LINE-05.                                         
           MOVE SPACES            TO    K830-KEY-FLD.                           
                                                                                
           MOVE F740-NUM-REGN     TO    K830-KEY-FLD.                           
           READ BP13K830.                                                       
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF ((K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR               
                 (K830-NME-MAIL-STR-BLDG(1:47) = SPACES))                       
                 MOVE K830-NUM-BLK         TO LF56-BLK                          
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO LF56-UNIT                         
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO LF56-UNIT                         
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO LF56-ADDR-L2                
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE SPACES            TO LF56-ADDR-L3                      
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO LF56-ADDR-L3                      
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                                                                                
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LF56-BAR-CODE             
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK         TO LF56-BLK                     
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                 TO LF56-UNIT                    
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT     TO LF56-UNIT                    
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO LF56-ADDR-L2              
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO LF56-ADDR-L3                  
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO LF56-ADDR-L3                  
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                                                                                
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LF56-BAR-CODE             
              END-IF                                                            
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              MOVE SPACES TO LF56-LINE-06 LF56-LINE-07 LF56-LINE-08             
              MOVE SPACES TO LF56-LINE-05                                       
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                        
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4950-CALL-AV02C015.                                                      
      ******************************************************************        
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       4950-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5300-READ-K813.                                                          
      ******************************************************************        
                                                                                
           MOVE SPACES TO K813-KEY-FLD.                                         
           MOVE F740-CDE-NT1        TO  K813-NUM-ZONE.                          
           MOVE F740-CDE-FLAT-TYPE  TO  K813-NUM-FLAT-TYPE.                     
           MOVE F740-DTE-BALLOT     TO  K813-DTE-BALLOT.                        
                                                                                
           READ BP13K813                                                        
                                                                                
           EVALUATE WS-K813-STATUS                                              
             WHEN 00                                                            
               MOVE K813-TXT-SEL-PERIOD-LTR    TO LF56-OUTCOME                  
                                                                                
               IF K813-NME-PROJECT-MGPS-LTR = SPACES OR LOW-VALUES              
                  MOVE K813-NME-PROJECT-LTR      TO LF56-ESTATE-A               
               ELSE                                                             
                  MOVE K813-NME-PROJECT-MGPS-LTR TO LF56-ESTATE-A               
               END-IF                                                           
                                                                                
               MOVE K813-NME-PROJECT-LTR TO LF56-ESTATE-B                       
                                            LF56-ESTATE-C                       
                                            LF56-ESTATE-D                       
                                            LF56-ESTATE-E                       
                                            LF56-ESTATE-F                       
                                            LF56-ESTATE-G                       
                                                                                
               MOVE K813-NUM-UNIT-OFFER  TO LF56-UNIT-OFFER-A                   
                                            LF56-UNIT-OFFER-B                   
                                            LF56-UNIT-OFFER-C                   
                                            LF56-UNIT-OFFER-D                   
                                            LF56-UNIT-OFFER-E                   
                                                                                
               STRING K813-DTE-LETTER-PRINT (7:2) '/'                           
                      K813-DTE-LETTER-PRINT (5:2) '/'                           
                      K813-DTE-LETTER-PRINT(1:4) DELIMITED BY SIZE              
                         INTO LF56-DATE                                         
                                                                                
               MOVE K813-NUM-QUEUE-START TO WS-NUM-QUEUE-START                  
               MOVE K813-NUM-QUEUE-MID   TO WS-NUM-QUEUE-MID                    
               MOVE K813-NUM-QUEUE-END   TO WS-NUM-QUEUE-END                    
                                                                                
             WHEN 23                                                            
               MOVE K740-CDE-NT1         TO LF56-ESTATE-A                       
                                            LF56-ESTATE-B                       
                                            LF56-ESTATE-C                       
                                            LF56-ESTATE-D                       
                                            LF56-ESTATE-E                       
                                            LF56-ESTATE-F                       
                                            LF56-ESTATE-G                       
                                                                                
               DISPLAY 'RECORD NOT FOUND IN BP13K813, KEY IS '                  
                '02' K740-CDE-NT1                                               
             WHEN OTHER                                                         
                  DISPLAY 'ERROR IN READING BP13K813, STATUS - '                
                  WS-K813-STATUS                                                
           END-EVALUATE.                                                        
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6400-PRT-BP13WA.                                                         
      ******************************************************************        
      *** Successful MGPS with PA queue positions within top 50% ***            
      *** of flat supply - NMEs only                             ***            
                                                                                
            ADD   1               TO    WS-LF56E-WRT-CTR.                       
            MOVE  SPACES          TO    LF56E-PRT-REC.                          
            MOVE WS-LF56E-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WA(49:4).                     
            WRITE LF56E-PRT-REC   FROM  DJDE-LINE-WA     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF56E-PRT-REC.                          
            WRITE LF56E-PRT-REC   AFTER PAGE.                                   
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-01  AFTER 1.                  
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-02.                           
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-03  AFTER 5.                  
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-04.                           
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-05.                           
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-06.                           
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-07.                           
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-08  AFTER 3.                  
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-8D  AFTER 6.                  
                                                                                
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-09-PAR  AFTER 5.              
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-9D      AFTER 1.              
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-10A     AFTER 1.              
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-11B     AFTER 3.              
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-12E     AFTER 1.              
            WRITE LF56E-PRT-REC   FROM  LF56-LINE-14      AFTER 2.              
                                                                                
            MOVE SPACES           TO    LF56E-PRT-REC                           
                                        DJDE-LINE-WA(49:4).                     
            IF F740-CDE-ALLOC-SCH = 'FTS' OR 'STS'                              
               WRITE LF56E-PRT-REC FROM DJDE-BP13HQ        AFTER PAGE           
            ELSE                                                                
               WRITE LF56E-PRT-REC FROM DJDE-BP13V6        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LF56E-PRT-REC.                          
            WRITE LF56E-PRT-REC   AFTER 5.                                      
            MOVE SPACES           TO LF56E-PRT-REC.                             
            WRITE LF56E-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF56E-PRT-REC.                             
            WRITE LF56E-PRT-REC   AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF56E-PRT-REC.                             
            WRITE LF56E-PRT-REC   FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF56E-PRT-REC.                             
            WRITE LF56E-PRT-REC   AFTER PAGE.                                   
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6410-PRT-BP13WC.                                                         
      ******************************************************************        
      *** Successful MGPS with PA queue positions within 51% ***                
      *** to 100% of flat supply - NMEs only                 ***                
                                                                                
            ADD   1               TO    WS-LF56K-WRT-CTR.                       
            MOVE  SPACES          TO    LF56K-PRT-REC.                          
            MOVE WS-LF56K-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WC(49:4).                     
            WRITE LF56K-PRT-REC   FROM  DJDE-LINE-WC     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF56K-PRT-REC.                          
            WRITE LF56K-PRT-REC   AFTER PAGE.                                   
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-01  AFTER 1.                  
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-02.                           
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-03  AFTER 5.                  
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-04.                           
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-05.                           
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-06.                           
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-07.                           
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-08  AFTER 3.                  
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-8D  AFTER 6.                  
                                                                                
            IF F740-NUM-MGPS = 'P'                                              
               WRITE LF56K-PRT-REC   FROM  LF56-LINE-09-PAR-A AFTER 3           
            ELSE                                                                
               WRITE LF56K-PRT-REC   FROM  LF56-LINE-09-CHL   AFTER 3           
            END-IF.                                                             
                                                                                
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-09A-EST AFTER 1.              
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-09-PAR  AFTER 2.              
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-9D      AFTER 1.              
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-10A     AFTER 1.              
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-11B     AFTER 3.              
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-12E     AFTER 1.              
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-13D     AFTER 1.              
            WRITE LF56K-PRT-REC   FROM  LF56-LINE-14      AFTER 2.              
                                                                                
            MOVE SPACES           TO    LF56K-PRT-REC                           
                                        DJDE-LINE-WC(49:4).                     
            IF F740-CDE-ALLOC-SCH = 'FTS' OR 'STS'                              
               WRITE LF56K-PRT-REC FROM DJDE-BP13HQ        AFTER PAGE           
            ELSE                                                                
               WRITE LF56K-PRT-REC FROM DJDE-BP13V6        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LF56K-PRT-REC.                          
            WRITE LF56K-PRT-REC   AFTER 5.                                      
            MOVE SPACES           TO LF56K-PRT-REC.                             
            WRITE LF56K-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF56K-PRT-REC.                             
            WRITE LF56K-PRT-REC   AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF56K-PRT-REC.                             
            WRITE LF56K-PRT-REC   FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF56K-PRT-REC.                             
            WRITE LF56K-PRT-REC   AFTER PAGE.                                   
                                                                                
       6410-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6510-PRT-BP13WE.                                                         
      ******************************************************************        
      *** Successful MGPS with PA queue positions within 101% ***               
      *** to 200% of flat supply                              ***               
                                                                                
            ADD   1               TO    WS-LF56L-WRT-CTR.                       
            MOVE  SPACES          TO    LF56L-PRT-REC.                          
            MOVE WS-LF56L-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WE(49:4).                     
            WRITE LF56L-PRT-REC   FROM  DJDE-LINE-WE     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF56L-PRT-REC.                          
            WRITE LF56L-PRT-REC   AFTER PAGE.                                   
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-01  AFTER 1.                  
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-02.                           
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-03  AFTER 5.                  
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-04.                           
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-05.                           
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-06.                           
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-07.                           
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-08  AFTER 3.                  
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-8D  AFTER 6.                  
                                                                                
            IF F740-NUM-MGPS = 'P'                                              
               WRITE LF56L-PRT-REC   FROM  LF56-LINE-9C       AFTER 3           
            ELSE                                                                
               WRITE LF56L-PRT-REC   FROM  LF56-LINE-9B       AFTER 3           
            END-IF.                                                             
                                                                                
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-09-PAR  AFTER 2.              
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-9D      AFTER 1.              
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-10A     AFTER 1.              
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-11B     AFTER 3.              
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-12B     AFTER 1.              
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-13E     AFTER 1.              
            WRITE LF56L-PRT-REC   FROM  LF56-LINE-14      AFTER 3.              
                                                                                
            MOVE SPACES           TO    LF56L-PRT-REC                           
                                        DJDE-LINE-WE(49:4).                     
            IF F740-CDE-ALLOC-SCH = 'FTS' OR 'STS'                              
               WRITE LF56L-PRT-REC FROM DJDE-BP13HQ        AFTER PAGE           
            ELSE                                                                
               WRITE LF56L-PRT-REC FROM DJDE-BP13V7        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LF56L-PRT-REC.                          
            WRITE LF56L-PRT-REC   AFTER 5.                                      
            MOVE SPACES           TO LF56L-PRT-REC.                             
            WRITE LF56L-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF56L-PRT-REC.                             
            WRITE LF56L-PRT-REC   AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF56L-PRT-REC.                             
            WRITE LF56L-PRT-REC   FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF56L-PRT-REC.                             
            WRITE LF56L-PRT-REC   AFTER PAGE.                                   
                                                                                
       6510-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6610-PRT-BP13WH.                                                         
      ******************************************************************        
      *** Successful MGPS with PA queue positions within 201% ***               
      *** to 300% of flat supply                              ***               
                                                                                
            ADD   1               TO    WS-LF56M-WRT-CTR.                       
            MOVE  SPACES          TO    LF56M-PRT-REC.                          
            MOVE WS-LF56M-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WH(49:4).                     
            WRITE LF56M-PRT-REC   FROM  DJDE-LINE-WH     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF56M-PRT-REC.                          
            WRITE LF56M-PRT-REC   AFTER PAGE.                                   
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-01  AFTER 1.                  
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-02.                           
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-03  AFTER 5.                  
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-04.                           
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-05.                           
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-06.                           
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-07.                           
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-08  AFTER 3.                  
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-8D  AFTER 6.                  
                                                                                
            IF F740-NUM-MGPS = 'P'                                              
               WRITE LF56M-PRT-REC   FROM  LF56-LINE-9C   AFTER 3               
            ELSE                                                                
               WRITE LF56M-PRT-REC   FROM  LF56-LINE-9B   AFTER 3               
            END-IF.                                                             
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-09-PAR  AFTER 2.              
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-9D      AFTER 1.              
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-10A     AFTER 1.              
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-11B     AFTER 3.              
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-12E     AFTER 1.              
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-13C     AFTER 1.              
            WRITE LF56M-PRT-REC   FROM  LF56-LINE-14      AFTER 4.              
                                                                                
            MOVE SPACES           TO    LF56M-PRT-REC                           
                                        DJDE-LINE-WH(49:4).                     
            IF F740-CDE-ALLOC-SCH = 'FTS' OR 'STS'                              
               WRITE LF56M-PRT-REC FROM DJDE-BP13HS        AFTER PAGE           
            ELSE                                                                
               WRITE LF56M-PRT-REC FROM DJDE-BP13V9        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LF56M-PRT-REC.                          
            WRITE LF56M-PRT-REC   AFTER 5.                                      
            MOVE SPACES           TO LF56M-PRT-REC.                             
            WRITE LF56M-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF56M-PRT-REC.                             
            WRITE LF56M-PRT-REC   AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF56M-PRT-REC.                             
            WRITE LF56M-PRT-REC   FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF56M-PRT-REC.                             
            WRITE LF56M-PRT-REC   AFTER PAGE.                                   
                                                                                
       6610-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6700-PRT-BP13WL.                                                         
      ******************************************************************        
      *** Successful MGPS with PA queue positions within beyond ***             
      *** 300% of flat supply - Mature Estates only             ***             
                                                                                
            ADD   1               TO    WS-LF56H-WRT-CTR.                       
            MOVE  SPACES          TO    LF56H-PRT-REC.                          
            MOVE WS-LF56H-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WL(49:4).                     
            WRITE LF56H-PRT-REC   FROM  DJDE-LINE-WL     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF56H-PRT-REC.                          
            WRITE LF56H-PRT-REC   AFTER PAGE.                                   
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-01  AFTER 1.                  
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-02.                           
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-03  AFTER 5.                  
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-04.                           
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-05.                           
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-06.                           
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-07.                           
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-08  AFTER 3.                  
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-8D  AFTER 6.                  
                                                                                
            IF F740-NUM-MGPS = 'P'                                              
               WRITE LF56H-PRT-REC   FROM  LF56-LINE-9C   AFTER 3               
            ELSE                                                                
               WRITE LF56H-PRT-REC   FROM  LF56-LINE-9B   AFTER 3               
            END-IF.                                                             
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-09-PAR  AFTER 2.              
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-9D      AFTER 1.              
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-10A     AFTER 1.              
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-11A     AFTER 3.              
            WRITE LF56H-PRT-REC   FROM  LF56-LINE-14      AFTER 4.              
                                                                                
            MOVE SPACES           TO    LF56H-PRT-REC                           
                                        DJDE-LINE-WL(49:4).                     
            WRITE LF56H-PRT-REC   FROM  DJDE-BP137N        AFTER PAGE.          
            MOVE SPACES           TO    LF56H-PRT-REC.                          
            WRITE LF56H-PRT-REC   AFTER 5.                                      
            MOVE SPACES           TO LF56H-PRT-REC.                             
            WRITE LF56H-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF56H-PRT-REC.                             
            WRITE LF56H-PRT-REC   AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF56H-PRT-REC.                             
            WRITE LF56H-PRT-REC   FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF56H-PRT-REC.                             
            WRITE LF56H-PRT-REC   AFTER PAGE.                                   
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6800-PRT-BP13WK.                                                         
      ******************************************************************        
      *** Successful MGPS with PA queue positions within beyond ***             
      *** 300% of flat supply - NMEs only                       ***             
                                                                                
            ADD   1               TO    WS-LF56I-WRT-CTR.                       
            MOVE  SPACES          TO    LF56I-PRT-REC.                          
            MOVE WS-LF56I-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WK(49:4).                     
            WRITE LF56I-PRT-REC   FROM  DJDE-LINE-WK     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF56I-PRT-REC.                          
            WRITE LF56I-PRT-REC   AFTER PAGE.                                   
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-01  AFTER 1.                  
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-02.                           
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-03  AFTER 5.                  
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-04.                           
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-05.                           
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-06.                           
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-07.                           
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-08  AFTER 3.                  
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-8D  AFTER 6.                  
                                                                                
            IF F740-NUM-MGPS = 'P'                                              
               WRITE LF56I-PRT-REC   FROM  LF56-LINE-9C   AFTER 3               
            ELSE                                                                
               WRITE LF56I-PRT-REC   FROM  LF56-LINE-9B   AFTER 3               
            END-IF.                                                             
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-09-PAR  AFTER 2.              
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-9E      AFTER 1.              
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-10A     AFTER 1.              
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-11A     AFTER 3.              
            WRITE LF56I-PRT-REC   FROM  LF56-LINE-14      AFTER 8.              
                                                                                
            MOVE SPACES           TO    LF56I-PRT-REC                           
                                        DJDE-LINE-WK(49:4).                     
            WRITE LF56I-PRT-REC   FROM  DJDE-BP137N        AFTER PAGE.          
            MOVE SPACES           TO    LF56I-PRT-REC.                          
            WRITE LF56I-PRT-REC   AFTER 5.                                      
            MOVE SPACES           TO LF56I-PRT-REC.                             
            WRITE LF56I-PRT-REC   FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF56I-PRT-REC.                             
            WRITE LF56I-PRT-REC   AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF56I-PRT-REC.                             
            WRITE LF56I-PRT-REC   FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF56I-PRT-REC.                             
            WRITE LF56I-PRT-REC   AFTER PAGE.                                   
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       7000-PRINT-CONTROL-LIST.                                                 
      ******************************************************************        
      *    PRINT CONTROL LISTING FOR SUCCESSFUL APPLICANTS                      
      *-------------------------------------------------------------            
                                                                                
           MOVE F740-NUM-REF              TO    LF56A-REF-NO.                   
           MOVE F740-NUM-REGN             TO    LF56A-REGN-NO.                  
           MOVE LF56-NAME01               TO    LF56A-NAME-1.                   
           MOVE F740-NUM-NRIC1            TO    LF56A-NRIC-1.                   
           MOVE F740-CDE-NT1              TO    LF56A-NT1.                      
           MOVE F740-CDE-HOUSEHOLD        TO    LF56A-HHTY.                     
           MOVE F740-NUM-MCPS             TO    LF56A-MCPS.                     
           MOVE F740-CDE-RESIDENT-HA1     TO    LF56A-RES-HA1.                  
           MOVE F740-CDE-FLAT-TYPE        TO    LF56A-FLAT.                     
           MOVE F740-CDE-ALLOC-SCH        TO    LF56A-ALLOC.                    
           MOVE F740-CDE-UNSUCC           TO    LF56A-UNSUCC.                   
           MOVE F740-CDE-CATEGORY         TO    LF56A-CAT.                      
           MOVE F740-CDE-SUCC-NT-ZONE     TO    LF56A-SUCC.                     
           MOVE F740-CDE-ZONE             TO    LF56A-ZONE.                     
           MOVE LF56-NAME02               TO    LF56A-NAME-2.                   
           IF F740-NUM-NRIC2 (2:1) NOT = '#'                                    
              MOVE F740-NUM-NRIC2         TO    LF56A-NRIC-2                    
           ELSE                                                                 
              MOVE SPACES                 TO    LF56A-NRIC-2.                   
           MOVE F740-NUM-NT-FT-QUEUE      TO    LF56A-QUEUE.                    
           MOVE F740-NUM-BALLOT-POSITION  TO    LF56A-BALLOT-POS.               
           MOVE F740-NUM-LOAN-TAG         TO    LF56A-LOAN-TAG.                 
           MOVE F740-CDE-REQUEST-STATUS   TO    LF56A-REQ-STATUS.               
                                                                                
      *-----------> PREPARE ADDRESS FOR BP13LF56A CONTROL LIST                  
           MOVE SPACES                    TO    LF56A-DTL-3.                    
           MOVE LF56-BLK                  TO    LF56A-BLK.                      
           MOVE LF56-UNIT                 TO    LF56A-UNIT.                     
           MOVE LF56-ADDR-L2              TO    LF56A-ADDR2.                    
           MOVE LF56-ADDR-L3              TO    LF56A-ADDR3.                    
           MOVE LF56-ADDR-L3              TO    LF56A-ADDR3.                    
                                                                                
           IF K740-NUM-NT-FT-QUEUE NOT = SPACES AND LOW-VALUES                  
              PERFORM 7100-PRINT-CONTROL-SUCC   THRU 7100-EXIT                  
           ELSE                                                                 
              PERFORM 7200-PRINT-CONTROL-UNSUCC THRU 7200-EXIT                  
           END-IF.                                                              
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7100-PRINT-CONTROL-SUCC.                                                 
      **************************************************************            
                                                                                
           MOVE 'P13LF561'             TO LF56A-LISTING.                        
           STRING 'CONTROL LIST FOR SUCCESSFUL LETTERS W/O EMAIL '              
                  'ADDRESSES (APPLICATION WITHIN 300%)'                         
                  DELIMITED BY SIZE  INTO LF56A-LISTING-TYPE.                   
           ADD    1                    TO    WS-CNT-LETTERS-SUCC.               
           MOVE   WS-CNT-LETTERS-SUCC  TO    LF56A-SERIAL-NO.                   
                                                                                
           IF WS-CNT-LINE-LF56E > WS2-MAX-LINES-LF56C                           
              ADD   1                  TO   WS-CNT-PAGE-LF56E                   
              MOVE  1                  TO   WS-CNT-LINE-LF56E                   
              MOVE  WS-CNT-PAGE-LF56E  TO   LF56A-PAGE                          
              WRITE LF561-PRT-REC      FROM LF56A-HDG1 AFTER PAGE               
                                                                                
              WRITE LF561-PRT-REC      FROM LF56A-HDG2 AFTER 1                  
              WRITE LF561-PRT-REC      FROM LF56A-HDG4 AFTER 2                  
              WRITE LF561-PRT-REC      FROM LF56A-HDG5 AFTER 1                  
              WRITE LF561-PRT-REC      FROM LF56A-HDG6 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LF561-PRT-REC                       
              WRITE LF561-PRT-REC                                               
           END-IF.                                                              
                                                                                
           WRITE   LF561-PRT-REC        FROM  LF56A-DTL-1 AFTER 1.              
           WRITE   LF561-PRT-REC        FROM  LF56A-DTL-2 AFTER 1.              
           WRITE   LF561-PRT-REC        FROM  LF56A-DTL-3 AFTER 1.              
           WRITE   LF561-PRT-REC        FROM  LF56A-DTL-4 AFTER 1.              
           MOVE    SPACES               TO    LF561-PRT-REC                     
           WRITE   LF561-PRT-REC                                                
           ADD     4                    TO    WS-CNT-LINE-LF56E.                
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7200-PRINT-CONTROL-UNSUCC.                                               
      **************************************************************            
                                                                                
           MOVE 'P13LF562'             TO LF56A-LISTING.                        
           STRING 'CONTROL LIST FOR UNSUCCESSFUL LETTERS W/O EMAIL '            
                  'ADDRESSES (APPLICATION BEYOND 300%)'                         
                  DELIMITED BY SIZE  INTO LF56A-LISTING-TYPE.                   
           ADD    1                    TO    WS-CNT-LETTERS-UNSUCC.             
           MOVE   WS-CNT-LETTERS-UNSUCC  TO    LF56A-SERIAL-NO.                 
                                                                                
           IF WS-CNT-LINE-LF56D > WS2-MAX-LINES-LF562                           
              ADD   1                  TO   WS-CNT-PAGE-LF56D                   
              MOVE  1                  TO   WS-CNT-LINE-LF56D                   
              MOVE  WS-CNT-PAGE-LF56D  TO   LF56A-PAGE                          
              WRITE LF562-PRT-REC      FROM LF56A-HDG1 AFTER PAGE               
                                                                                
              WRITE LF562-PRT-REC      FROM LF56A-HDG2 AFTER 1                  
              WRITE LF562-PRT-REC      FROM LF56A-HDG4 AFTER 2                  
              WRITE LF562-PRT-REC      FROM LF56A-HDG5 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LF562-PRT-REC                       
              WRITE LF562-PRT-REC                                               
           END-IF.                                                              
                                                                                
           WRITE   LF562-PRT-REC        FROM  LF56A-DTL-1 AFTER 1.              
           WRITE   LF562-PRT-REC        FROM  LF56A-DTL-2 AFTER 1.              
           WRITE   LF562-PRT-REC        FROM  LF56A-DTL-3 AFTER 1.              
           MOVE    SPACES               TO    LF562-PRT-REC                     
           WRITE   LF562-PRT-REC                                                
           ADD     4                    TO    WS-CNT-LINE-LF56D.                
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       8000-CHECK-SCH.                                                          
      **************************************************************            
                                                                                
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
               AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                            
             WHEN F740-CDE-ALLOC-SCH = WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)          
             MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO WS-ALLOCSCH-TYPE.             
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13CF56 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F740 RECORDS READ          : ' WS-F740-READ-CTR.           
           DISPLAY ' 50%  NON-MAT & MAT (BP13WA): ' WS-LF56E-WRT-CTR.           
           DISPLAY ' 100% NON-MAT & MAT (BP13WC): ' WS-LF56K-WRT-CTR.           
           DISPLAY ' 200% NON-MAT & MAT (BP13WE): ' WS-LF56L-WRT-CTR.           
           DISPLAY ' 300% NON-MAT & MAT (BP13WH): ' WS-LF56M-WRT-CTR.           
           DISPLAY ' >300% NON-MAT      (BP13WK): ' WS-LF56I-WRT-CTR.           
           DISPLAY ' >300% MAT          (BP13WL): ' WS-LF56H-WRT-CTR.           
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13F740                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 BP13K813                                                       
                 P13LF56E                                                       
                 P13LF56H                                                       
                 P13LF56I                                                       
                 P13LF56K                                                       
                 P13LF56L                                                       
                 P13LF56M                                                       
                 P13LF561                                                       
                 P13LF562.                                                      
                                                                                
           IF WS-K825-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K825-STAT ' WS-K825-STATUS.            
                                                                                
           IF WS-K830-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS.            
                                                                                
           IF WS-K813-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K813-STAT ' WS-K813-STATUS.            
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
