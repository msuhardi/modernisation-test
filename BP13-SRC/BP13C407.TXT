      *------------------------*                                                
       IDENTIFICATION DIVISION.                                                 
      *------------------------*                                                
       PROGRAM-ID.    BP13C407.                                                 
       AUTHOR.        KH LEE.                                                   
      *DATE-WRITTEN.  30/10/89.                                                 
                                                                                
      * ====================================================== *                
      *    OBJECTIVE  :                                        *                
      *        1.  TO PRINT ACKNOWLEDGEMENT LIST IN BATCH-NO   *                
      *            SCHEME ACCOUNT NO AND CPF NO.               *                
      *            THIS LISTING IS TO ACCOMPANY THE HPI/9      *                
      *            FORMS WHICH ARE BATCHED BY SALES SECTION    *                
      *            ON DAILY BASIS.                             *                
      *            THE LIST IS TO BE ACKNOWLEDGED BY THE CPF   *                
      *            BOARD UPON RECEIPT.                         *                
      *                                                        *                
      *     INPUT/OUTPUT FILES:                                *                
      *           1. BP13CPF  (TEMPORARY CPF FILE)             *                
      *                                                        *                
      *     LISTING:                                           *                
      *           1. P13L407A (ACKNOWLEDGEMENT LIST FOR SOS)   *                
      *           2. P13L407B (DETAIL LIST FOR SOS)            *                
      *           3. P13L407C (ACKNOWLEDGEMENT LIST FOR SOC)   *                
      *           4. P13L407D (DETAIL LIST FOR SOC)            *                
      *           5. P13L407E (ACKNOWLEDGEMENT LIST FOR ST)    *                
      *           6. P13L407F (DETAIL LIST FOR ST)             *                
      *           7. P13L407G (ACKNOWLEDGEMENT LIST FOR RP)    *                
      *           8. P13L407H (DETAIL LIST FOR RP)             *                
      *           8. P13L407J (DETAIL LIST FOR CPF UPD)        *                
      *           8. P13L407K (DETAIL LIST FOR CPF DELETION)   *                
      *                                                        *                
      *CHG-NO  BY   ON       DESCRIPTION                       *                
      *------  --   --       -----------                       *                
      *SOC-PH8 RML  930727   EXPAND REGN TO 8 BYTES            *                
      *C9404E6 LJL  940614   TO CATER FOR SITTING TENANT SALE  *                
      *                      FOR TYPE 2B CASES.                *                
      *C950420 GJ   950512   TO CATER FOR CPF WITHDRAWAL THRU  *                
      *                      IDNET.                            *                
      *BP130037LJL  951017   TO CATER FOR SALES TYPE 3A.       *                
      *BP130315RHB  980619   TO CATER FOR RETIREMENT ACCOUNT.  *                
      *BP130522SGK  980731   TO ADD CPF-PREFIX & TO CHANGE     *                
      *                      FILE SIZE OF BP13CPF FROM 130 TO  *                
      *                      140 BYTES.                        *                
      *BP130418RHB  980626   TO FORMATDATE AS MM/DD/CCYY    .  *                
      *BP132839CLT  150506   TO PRINT SA CASE                  *                
      *BP132973BA2  080207   DATE TO BE FETCHED FROM SY02F001  *                
      *BP136415PCL4 131016   TO CATER FOR SALES TYPE 18        *                
      *BP137176DN8  041218   TO CATER FOR SALES TYPE 19        *                
      * ====================================================== *                
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT BP13CPF  ASSIGN TO BP13CPF.                                   
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
           SELECT P13L407A ASSIGN TO P13L407A.                                  
           SELECT P13L407B ASSIGN TO P13L407B.                                  
           SELECT P13L407C ASSIGN TO P13L407C.                                  
           SELECT P13L407D ASSIGN TO P13L407D.                                  
           SELECT P13L407E ASSIGN TO P13L407E.                                  
           SELECT P13L407F ASSIGN TO P13L407F.                                  
           SELECT P13L407G ASSIGN TO P13L407G.                                  
           SELECT P13L407H ASSIGN TO P13L407H.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD  BP13CPF                                                              
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 140 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       01  BP13CPF-REC.                                                         
           05  CPF-NUM-BATCH           PIC 9(4).                                
           05  CPF-NUM-SCH-ACC.                                                 
               10  CPF-SCHEME          PIC 9(4).                                
               10  CPF-ACCOUNT         PIC 9(4).                                
               10  CPF-CHK-CDE         PIC 9(1).                                
               10  CPF-LESSEE-CDE      PIC 9(2).                                
           05  CPF-NAME                PIC X(60).                               
           05  CPF-NUM-REGN            PIC X(8).                                
           05  CPF-CPF-NO              PIC X(9).                                
           05  CPF-AMT-ICP-CPF         PIC S9(6)V99.                            
           05  CPF-AMT-FIRST-CPF       PIC S9(5)V99.                            
           05  CPF-AMT-MTHLY-CPF       PIC S9(5)V99.                            
           05  CPF-CDE-SALES-TYPE      PIC X(2).                                
           05  CPF-NUM-SERIAL          PIC X(9).                                
           05  FILLER                  PIC X(1).                                
           05  CPF-AMT-RETIRE          PIC 9(6)V99 COMP-3.                      
           05  FILLER                  PIC X(9).                                
                                                                                
       FD  P13L407A                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE1           PIC X(132).                                      
                                                                                
       FD  P13L407B                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE2           PIC X(132).                                      
                                                                                
       FD  P13L407C                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE3           PIC X(132).                                      
                                                                                
       FD  P13L407D                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE4           PIC X(132).                                      
                                                                                
       FD  P13L407E                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE5           PIC X(132).                                      
                                                                                
       FD  P13L407F                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE6           PIC X(132).                                      
                                                                                
       FD  P13L407G                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE7           PIC X(132).                                      
                                                                                
       FD  P13L407H                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRT-LINE8           PIC X(132).                                      
                                                                                
      *------------------------*                                                
       WORKING-STORAGE SECTION.                                                 
      *------------------------*                                                
                                                                                
       01  L407-COMM-HDG1.                                                      
           05  PGM-ID              PIC X(8).                                    
           05  FILLER              PIC X(6)  VALUE SPACES.                      
           05  FILLER              PIC X(25) VALUE 'HDB3'.                      
           05  FILLER              PIC X(64)  VALUE                             
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER              PIC X(6)   VALUE 'DATE: '.                   
           05  WS-SYS-DATE         PIC X(10).                                   
           05  FILLER              PIC X(08)  VALUE '  PAGE: '.                 
           05  WS-PAGE             PIC ZZZ9.                                    
                                                                                
       01  L407-COMM-HDG2.                                                      
           05  FILLER              PIC X(24)  VALUE SPACES.                     
           05  FILLER              PIC X(30)  VALUE 'TO HDB,'.                  
                                                                                
       01  L407-COMM-HDG3.                                                      
           05  FILLER              PIC X(41)  VALUE SPACES.                     
           05  FILLER              PIC X(70)  VALUE                             
               'ACKNOWLEDGEMENT LIST FOR HPI/9 FORMS'.                          
                                                                                
       01  L407-COMM-HDG4.                                                      
           05  FILLER              PIC X(90)   VALUE SPACES.                    
           05  FILLER              PIC X(30)   VALUE                            
               '.........................'.                                     
                                                                                
       01  L407-COMM-HDG5.                                                      
           05  FILLER              PIC X(100)  VALUE SPACES.                    
           05  FILLER              PIC X(30)   VALUE 'CPF BOARD'.               
                                                                                
       01  L407-COMM-HDG6.                                                      
           05  FILLER              PIC X(53)   VALUE                            
               ' S/N   HDB-REF-NO   NAME'.                                      
           05  FILLER              PIC X(31)   VALUE                            
               'REGN-NO  SERIAL-NO  CPF-NO'.                                    
           05  FILLER              PIC X(45)   VALUE                            
               'ICP-CPF    1ST-INSTAL  MONTHLY-CPF RETIREMENT'.                 
                                                                                
       01  L407-COMM-HDG7.                                                      
           05  FILLER              PIC X(05)  VALUE '  NO'.                     
           05  FILLER              PIC X(23)   VALUE                            
               'CPF         INSTALMENT'.                                        
                                                                                
       01  L407-COMM-HDG8.                                                      
           05  FILLER              PIC X(12)   VALUE ' BATCH NO : '.            
           05  L407-BATCH-NO       PIC 9(4).                                    
                                                                                
                                                                                
      *---------------------------------------------------------------*         
      *       HEADINGS FOR ACKNOWLEDGEMENT LIST FOR SOS               *         
      *---------------------------------------------------------------*         
       01  L407A-HDG1.                                                          
           05  FILLER          PIC X(29)   VALUE SPACES.                        
           05  FILLER          PIC X(28)   VALUE                                
               'I ACKNOWLEDGED RECEIPT OF '.                                    
           05  L407A-TOT-CNT   PIC ZZZZ9.                                       
           05  FILLER          PIC X(44)   VALUE                                
               ' HPI/9 (ADVANCED ALLOCATION FLAT) FORMS FOR '.                  
           05  L407A-DATE      PIC X(10).                                       
                                                                                
      *---------------------------------------------------------------*         
      *       HEADINGS FOR ACKNOWLEDGEMENT LIST FOR SOC               *         
      *---------------------------------------------------------------*         
       01  L407C-HDG1.                                                          
           05  FILLER          PIC X(29)   VALUE SPACES.                        
           05  FILLER          PIC X(28)   VALUE                                
               'I ACKNOWLEDGED RECEIPT OF '.                                    
           05  L407C-TOT-CNT   PIC ZZZZ9.                                       
           05  FILLER          PIC X(28)   VALUE                                
               ' HPI/9 (SOC FLAT) FORMS FOR '.                                  
           05  L407C-DATE      PIC X(10).                                       
                                                                                
      *---------------------------------------------------------------*         
      *       HEADINGS FOR ACKNOWLEDGEMENT LIST FOR ST                *         
      *---------------------------------------------------------------*         
       01  L407E-HDG1.                                                          
           05  FILLER          PIC X(29)   VALUE SPACES.                        
           05  FILLER          PIC X(28)   VALUE                                
               'I ACKNOWLEDGED RECEIPT OF '.                                    
           05  L407E-TOT-CNT   PIC ZZZZ9.                                       
           05  FILLER          PIC X(28)   VALUE                                
               ' HPI/9 (ST  FLAT) FORMS FOR '.                                  
           05  L407E-DATE      PIC X(10).                                       
                                                                                
      *---------------------------------------------------------------*         
      *       HEADINGS FOR ACKNOWLEDGEMENT LIST FOR RP                *         
      *---------------------------------------------------------------*         
       01  L407G-HDG1.                                                          
           05  FILLER          PIC X(29)   VALUE SPACES.                        
           05  FILLER          PIC X(28)   VALUE                                
               'I ACKNOWLEDGED RECEIPT OF '.                                    
           05  L407G-TOT-CNT   PIC ZZZZ9.                                       
           05  FILLER          PIC X(28)   VALUE                                
               ' HPI/9 (RP  FLAT) FORMS FOR '.                                  
           05  L407G-DATE      PIC X(10).                                       
                                                                                
      *---------------------------------------------------------------*         
      *       DETAIL FOR ACKNOWLEDGEMENT LIST                         *         
      *---------------------------------------------------------------*         
       01  L407-DL1.                                                            
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-SEQ-NO          PIC ZZZ9.                                   
           05  FILLER               PIC X(2)    VALUE SPACES.                   
           05  L407-SCH-ACC-NO      PIC X(11).                                  
           05  FILLER               PIC X(2)    VALUE SPACES.                   
           05  L407-NAME            PIC X(32).                                  
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-REGN-NO         PIC X(8).                                   
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-SERIAL-NO       PIC X(9).                                   
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-CPF-NO          PIC X(9).                                   
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-AMT-ICP-CPF     PIC $$$$,$$9.99.                            
           05  FILLER               PIC X(2)    VALUE SPACES.                   
           05  L407-AMT-FIRST-CPF   PIC $$$,$$9.99.                             
           05  FILLER               PIC X(2)    VALUE SPACES.                   
           05  L407-AMT-MTHLY-CPF   PIC $$$,$$9.99.                             
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-AMT-RETIRE      PIC $$$,$$9.99.                             
           05  L407-AMT-RETIRE-A  REDEFINES L407-AMT-RETIRE.                    
               10  WS-AMT-RETIRE-A   PIC X(10).                                 
                                                                                
       01  L407-DL2.                                                            
           05  FILLER               PIC X(41)   VALUE SPACES.                   
           05  FILLER               PIC X(20)   VALUE                           
               '***  BATCH TOTAL  ='.                                           
           05  L407-CPF-SUB         PIC ZZZZZZZZ9.                              
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-ICP-CPF-SUB     PIC $$$$,$$$,$$9.99.                        
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-FIRST-CPF-SUB   PIC $$$$,$$$,$$9.99.                        
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-MTHLY-CPF-SUB   PIC $$$$,$$$,$$9.99.                        
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-RETIRE-SUB      PIC $$$,$$9.99.                             
                                                                                
       01  L407-DL3.                                                            
           05  FILLER               PIC X(41)   VALUE SPACES.                   
           05  FILLER               PIC X(20)   VALUE                           
               '***  GRAND TOTAL  ='.                                           
           05  L407-CPF-TOT         PIC ZZZZZZZZZZ9.                            
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-ICP-CPF-TOT     PIC $$$$,$$$,$$9.99.                        
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-FIRST-CPF-TOT   PIC $$$$,$$$,$$9.99.                        
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-MTHLY-CPF-TOT   PIC $$$$,$$$,$$9.99.                        
           05  FILLER               PIC X(1)    VALUE SPACES.                   
           05  L407-RETIRE-TOT      PIC $$$,$$9.99.                             
                                                                                
      *---------------------------------------------------------------*         
      *       HEADINGS FOR DETAIL LIST FOR SOS                        *         
      *---------------------------------------------------------------*         
                                                                                
       01  L407B-HDG1.                                                          
           05  FILLER              PIC X(39)   VALUE SPACES.                    
           05  FILLER              PIC X(60)   VALUE                            
               'ACKNOWLEDGEMENT LIST FOR ADVANCE ALLOCATION FLAT'.              
                                                                                
       01  L407D-HDG1.                                                          
           05  FILLER              PIC X(42)   VALUE SPACES.                    
           05  FILLER              PIC X(60)   VALUE                            
               'ACKNOWLEDGEMENT LIST FOR SOC FLAT'.                             
                                                                                
       01  L407F-HDG1.                                                          
           05  FILLER              PIC X(42)   VALUE SPACES.                    
           05  FILLER              PIC X(60)   VALUE                            
               'ACKNOWLEDGEMENT LIST FOR ST  FLAT'.                             
                                                                                
       01  L407H-HDG1.                                                          
           05  FILLER              PIC X(42)   VALUE SPACES.                    
           05  FILLER              PIC X(60)   VALUE                            
               'ACKNOWLEDGEMENT LIST FOR RP  FLAT'.                             
                                                                                
       01  WS-CODE-TABLE.                                                       
           05  WS-CODE-1              PIC X(2)   VALUE 'A0'.                    
           05  WS-CODE-2              PIC X(2)   VALUE 'B0'.                    
           05  WS-CODE-3              PIC X(2)   VALUE 'D4'.                    
           05  WS-CODE-4              PIC X(2)   VALUE 'F6'.                    
           05  WS-CODE-6              PIC X(2)   VALUE '00'.                    
           05  WS-CODE-7              PIC X(2)   VALUE '11'.                    
           05  WS-CODE-9              PIC X(2)   VALUE '22'.                    
           05  WS-CODE-10             PIC X(2)   VALUE '33'.                    
           05  WS-CODE-11             PIC X(2)   VALUE '44'.                    
           05  WS-CODE-12             PIC X(2)   VALUE '55'.                    
           05  WS-CODE-13             PIC X(2)   VALUE '66'.                    
           05  WS-CODE-14             PIC X(2)   VALUE '77'.                    
           05  WS-CODE-15             PIC X(2)   VALUE '88'.                    
           05  WS-CODE-16             PIC X(2)   VALUE '99'.                    
                                                                                
       01  WS-CODE-TABLE-DES REDEFINES WS-CODE-TABLE.                           
           05  WS-CODE-VALUE OCCURS 16 TIMES INDEXED BY WS-CODE-PTR.            
               10  WS-CODE-IND        PIC X.                                    
               10  WS-CODE-DIGIT      PIC 9(1).                                 
                                                                                
       01  WS-COUNTS.                                                           
           05  WS-SEQ-NO1            PIC 9(4)    VALUE ZEROS.                   
           05  WS-SEQ-NO2            PIC 9(4)    VALUE ZEROS.                   
           05  WS-SEQ-NO3            PIC 9(4)    VALUE ZEROS.                   
           05  WS-SEQ-NO4            PIC 9(4)    VALUE ZEROS.                   
           05  WS-LINE-CNT1          PIC 9(2)    VALUE ZEROS.                   
           05  WS-LINE-CNT2          PIC 9(2)    VALUE ZEROS.                   
           05  WS-LINE-CNT3          PIC 9(2)    VALUE ZEROS.                   
           05  WS-LINE-CNT4          PIC 9(2)    VALUE ZEROS.                   
           05  WS-PAGE-CNT1          PIC 9(4)    VALUE ZEROS.                   
           05  WS-PAGE-CNT2          PIC 9(4)    VALUE ZEROS.                   
           05  WS-PAGE-CNT3          PIC 9(4)    VALUE ZEROS.                   
           05  WS-PAGE-CNT4          PIC 9(4)    VALUE ZEROS.                   
           05  WS-CPF-SUB1           PIC 9(10)   VALUE ZEROS.                   
           05  WS-CPF-TOT1           PIC 9(11)   VALUE ZEROS.                   
           05  WS-ICP-CPF-SUB1       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-ICP-CPF-TOT1       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-SUB1     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-TOT1     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-SUB1     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-TOT1     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-SUB1        PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-TOT1        PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-CPF-SUB2           PIC 9(9)    VALUE ZEROS.                   
           05  WS-CPF-TOT2           PIC 9(11)   VALUE ZEROS.                   
           05  WS-ICP-CPF-SUB2       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-ICP-CPF-TOT2       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-SUB2     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-TOT2     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-SUB2     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-TOT2     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-SUB2        PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-TOT2        PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-CPF-SUB3           PIC 9(9)    VALUE ZEROS.                   
           05  WS-CPF-TOT3           PIC 9(11)   VALUE ZEROS.                   
           05  WS-ICP-CPF-SUB3       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-ICP-CPF-TOT3       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-SUB3     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-TOT3     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-SUB3     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-TOT3     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-SUB3        PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-TOT3        PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-CPF-SUB4           PIC 9(9)    VALUE ZEROS.                   
           05  WS-CPF-TOT4           PIC 9(11)   VALUE ZEROS.                   
           05  WS-ICP-CPF-SUB4       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-ICP-CPF-TOT4       PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-SUB4     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-FIRST-CPF-TOT4     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-SUB4     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-MTHLY-CPF-TOT4     PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-SUB4        PIC 9(10)V99 VALUE ZEROS.                  
           05  WS-RETIRE-TOT4        PIC 9(10)V99 VALUE ZEROS.                  
                                                                                
       01  WS-CPF-NO.                                                           
           05  WS-CPF-NUM.                                                      
               10  WS-CPF-NUM1       PIC X(1).                                  
               10  WS-CPF-NUM2       PIC 9(6).                                  
           05  WS-CPF-CDE            PIC X(1).                                  
                                                                                
       01  WS-CPF.                                                              
           05  WS-CPF1               PIC 9(1).                                  
           05  WS-CPF2               PIC 9(6).                                  
                                                                                
       01  WS-CPF-COMP               PIC 9(7).                                  
                                                                                
       01  WS-PREV-BATCH-NO          PIC 9(4).                                  
                                                                                
       01  WS-PREV-SALES-TYPE        PIC X(2).                                  
                                                                                
       01  WS-DATE.                                                             
           05  WS-MM           PIC 99.                                          
           05  FILLER          PIC X       VALUE '/'.                           
           05  WS-DD           PIC 99.                                          
           05  FILLER          PIC X       VALUE '/'.                           
           05  WS-CC           PIC 99.                                          
           05  WS-YY           PIC 99.                                          
                                                                                
       01  WS-EDITED-DATE.                                                      
           05  WS-EDIT-DD      PIC 99.                                          
           05  FILLER          PIC X       VALUE '/'.                           
           05  WS-EDIT-MM      PIC 99.                                          
           05  FILLER          PIC X       VALUE '/'.                           
           05  WS-EDIT-CC      PIC 99.                                          
           05  WS-EDIT-YY      PIC 99.                                          
                                                                                
       01  WS-CURR-CCYYMMDD.                                                    
           05  WS-CURR-CC      PIC 99.                                          
           05  WS-CURR-YY      PIC 99.                                          
           05  WS-CURR-MM      PIC 99.                                          
           05  WS-CURR-DD      PIC 99.                                          
                                                                                
       01  WS-PROGRAM-SWITCHES.                                                 
           05  WS-EOF-CPF      PIC X(1)    VALUE 'N'.                           
                                                                                
                                                                                
      *------------------------*                                                
       PROCEDURE DIVISION.                                                      
      *------------------------*                                                
                                                                                
       0010-MAIN.                                                               
           PERFORM 100-OPENING-ROUTINE THRU 100-EXIT.                           
           PERFORM 110-READ-FILE-SY02  THRU 110-EXIT.                           
           PERFORM 150-READ-FILE-CPF THRU 150-EXIT.                             
           PERFORM 200-PROCESS-REPORT THRU 200-EXIT                             
                   UNTIL WS-EOF-CPF = 'Y'.                                      
           PERFORM 300-PRINT-TOT THRU 300-EXIT.                                 
           PERFORM 400-CLOSING-ROUTINE THRU 400-EXIT.                           
                                                                                
       100-OPENING-ROUTINE.                                                     
           OPEN INPUT   BP13CPF                                                 
                        SY02F001                                                
                OUTPUT  P13L407A                                                
                        P13L407B                                                
                        P13L407C                                                
                        P13L407D                                                
                        P13L407E                                                
                        P13L407F                                                
                        P13L407G                                                
                        P13L407H.                                               
           MOVE ZEROS TO WS-COUNTS.                                             
           MOVE 'N' TO WS-EOF-CPF.                                              
           MOVE 60 TO WS-LINE-CNT2  WS-LINE-CNT1  WS-LINE-CNT3                  
                      WS-LINE-CNT4.                                             
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
       110-READ-FILE-SY02.                                                      
           READ SY02F001  AT END                                                
                DISPLAY 'NO RECORD FOUND AT SY02F001'.                          
                                                                                
       110-EXIT.                                                                
           EXIT.                                                                
                                                                                
       150-READ-FILE-CPF.                                                       
           MOVE ZEROS TO WS-PREV-BATCH-NO.                                      
           MOVE 'N' TO WS-EOF-CPF.                                              
           READ BP13CPF AT END MOVE 'Y' TO WS-EOF-CPF.                          
           MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO.                              
           MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE.                       
                                                                                
       150-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *    TO PRINT OUT THE REPORT IN BATCHES SEQUENCE                 *        
      ******************************************************************        
       200-PROCESS-REPORT.                                                      
           IF CPF-CDE-SALES-TYPE = '01' OR '1A'                                 
              PERFORM 500-PRINT-DETAIL-SOS THRU 500-EXIT.                       
           IF CPF-CDE-SALES-TYPE = '02' OR '2B'                                 
              PERFORM 510-PRINT-DETAIL-ST THRU 510-EXIT.                        
           IF CPF-CDE-SALES-TYPE = '03' OR '3A'                                 
              PERFORM 520-PRINT-DETAIL-RP THRU 520-EXIT.                        
           IF CPF-CDE-SALES-TYPE = '10' OR '1B' OR '13' OR '18' OR '19'         
              PERFORM 550-PRINT-DETAIL-SOC THRU 550-EXIT.                       
                                                                                
           MOVE 'N' TO WS-EOF-CPF.                                              
           READ BP13CPF AT END MOVE 'Y' TO WS-EOF-CPF.                          
           IF WS-EOF-CPF = 'Y' AND WS-PREV-SALES-TYPE = '01'                    
              PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT.                          
           IF WS-EOF-CPF = 'Y' AND WS-PREV-SALES-TYPE = '02'                    
              PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT.                          
           IF WS-EOF-CPF = 'Y' AND WS-PREV-SALES-TYPE = '03'                    
              PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT.                          
           IF WS-EOF-CPF = 'Y' AND                                              
                 WS-PREV-SALES-TYPE = ('10' OR '13' OR '18')                    
              PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT.                          
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
       300-PRINT-TOT.                                                           
           IF WS-SEQ-NO1 > ZEROS                                                
              PERFORM 2000-PRINT-TOT-SOS THRU 2000-EXIT                         
              PERFORM 2100-ACK-LIST-SOS THRU 2100-EXIT.                         
                                                                                
           IF WS-SEQ-NO3 > ZEROS                                                
              PERFORM 2010-PRINT-TOT-ST THRU 2010-EXIT                          
              PERFORM 2110-ACK-LIST-ST THRU 2110-EXIT.                          
                                                                                
           IF WS-SEQ-NO4 > ZEROS                                                
              PERFORM 2020-PRINT-TOT-RP THRU 2020-EXIT                          
              PERFORM 2120-ACK-LIST-RP THRU 2120-EXIT.                          
                                                                                
           IF WS-SEQ-NO2 > ZEROS                                                
              PERFORM 2050-PRINT-TOT-SOC THRU 2050-EXIT                         
              PERFORM 2150-ACK-LIST-SOC THRU 2150-EXIT.                         
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
       400-CLOSING-ROUTINE.                                                     
           CLOSE BP13CPF                                                        
                 SY02F001                                                       
                 P13L407A                                                       
                 P13L407B                                                       
                 P13L407C                                                       
                 P13L407D                                                       
                 P13L407E                                                       
                 P13L407F                                                       
                 P13L407G                                                       
                 P13L407H.                                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
       500-PRINT-DETAIL-SOS.                                                    
           IF WS-LINE-CNT1 > 23 OR                                              
              CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
                 PERFORM 600-PRINT-HEAD-SOS THRU 600-EXIT.                      
           ADD 1 TO WS-SEQ-NO1.                                                 
           MOVE WS-SEQ-NO1 TO L407-SEQ-NO.                                      
           STRING CPF-SCHEME '-' CPF-ACCOUNT '-' CPF-CHK-CDE                    
               DELIMITED BY SIZE INTO L407-SCH-ACC-NO.                          
                                                                                
           MOVE CPF-NAME          TO L407-NAME.                                 
           MOVE CPF-NUM-REGN      TO L407-REGN-NO.                              
           MOVE CPF-NUM-SERIAL    TO L407-SERIAL-NO.                            
           MOVE CPF-CPF-NO        TO L407-CPF-NO.                               
           MOVE CPF-CPF-NO(2:8)   TO WS-CPF-NO.                                 
           SET WS-CODE-PTR TO 1.                                                
           SEARCH WS-CODE-VALUE AT END                                          
                  DISPLAY 'INVALID CPF-CODE ' CPF-CPF-NO                        
                  MOVE 0 TO WS-CPF1                                             
                  WHEN WS-CPF-NUM1 = WS-CODE-IND(WS-CODE-PTR)                   
                       MOVE WS-CODE-DIGIT(WS-CODE-PTR) TO WS-CPF1.              
           MOVE WS-CPF-NUM2 TO WS-CPF2.                                         
           MOVE WS-CPF      TO WS-CPF-COMP.                                     
           COMPUTE WS-CPF-SUB1 = WS-CPF-SUB1 + WS-CPF-COMP.                     
           COMPUTE WS-CPF-TOT1 = WS-CPF-TOT1 + WS-CPF-COMP.                     
           MOVE CPF-AMT-ICP-CPF TO L407-AMT-ICP-CPF.                            
           MOVE CPF-AMT-FIRST-CPF TO L407-AMT-FIRST-CPF.                        
           MOVE CPF-AMT-MTHLY-CPF TO L407-AMT-MTHLY-CPF.                        
           IF   CPF-AMT-RETIRE > 0                                              
           MOVE CPF-AMT-RETIRE    TO L407-AMT-RETIRE                            
           ELSE                                                                 
           MOVE '    - ' TO L407-AMT-RETIRE-A.                                  
           COMPUTE WS-ICP-CPF-SUB1 = WS-ICP-CPF-SUB1 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-ICP-CPF-TOT1 = WS-ICP-CPF-TOT1 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-FIRST-CPF-SUB1 =                                          
                   WS-FIRST-CPF-SUB1 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-FIRST-CPF-TOT1 =                                          
                   WS-FIRST-CPF-TOT1 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-MTHLY-CPF-SUB1 =                                          
                   WS-MTHLY-CPF-SUB1 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-MTHLY-CPF-TOT1 =                                          
                   WS-MTHLY-CPF-TOT1 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-RETIRE-SUB1 =                                             
                   WS-RETIRE-SUB1 + CPF-AMT-RETIRE.                             
           COMPUTE WS-RETIRE-TOT1 =                                             
                   WS-RETIRE-TOT1 + CPF-AMT-RETIRE.                             
                                                                                
           MOVE  SPACES TO PRT-LINE2.                                           
           WRITE PRT-LINE2 FROM L407-DL1 AFTER 2.                               
           ADD 1 TO WS-LINE-CNT1.                                               
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
       510-PRINT-DETAIL-ST.                                                     
           IF WS-LINE-CNT3 > 23 OR                                              
              CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
                 PERFORM 610-PRINT-HEAD-ST THRU 610-EXIT.                       
           ADD 1 TO WS-SEQ-NO3.                                                 
           MOVE WS-SEQ-NO3 TO L407-SEQ-NO.                                      
           STRING CPF-SCHEME '-' CPF-ACCOUNT '-' CPF-CHK-CDE                    
               DELIMITED BY SIZE INTO L407-SCH-ACC-NO.                          
                                                                                
           MOVE CPF-NAME         TO L407-NAME.                                  
           MOVE CPF-NUM-REGN     TO L407-REGN-NO.                               
           MOVE CPF-NUM-SERIAL   TO L407-SERIAL-NO.                             
           MOVE CPF-CPF-NO       TO L407-CPF-NO.                                
           MOVE CPF-CPF-NO(2:8)  TO WS-CPF-NO.                                  
           SET WS-CODE-PTR TO 1.                                                
           SEARCH WS-CODE-VALUE AT END                                          
                  DISPLAY 'INVALID CPF-CODE ' CPF-CPF-NO                        
                  MOVE 0 TO WS-CPF1                                             
                  WHEN WS-CPF-NUM1 = WS-CODE-IND(WS-CODE-PTR)                   
                       MOVE WS-CODE-DIGIT(WS-CODE-PTR) TO WS-CPF1.              
           MOVE WS-CPF-NUM2 TO WS-CPF2.                                         
           MOVE WS-CPF      TO WS-CPF-COMP.                                     
           COMPUTE WS-CPF-SUB3 = WS-CPF-SUB3 + WS-CPF-COMP.                     
           COMPUTE WS-CPF-TOT3 = WS-CPF-TOT3 + WS-CPF-COMP.                     
           MOVE CPF-AMT-ICP-CPF TO L407-AMT-ICP-CPF.                            
           MOVE CPF-AMT-FIRST-CPF TO L407-AMT-FIRST-CPF.                        
           MOVE CPF-AMT-MTHLY-CPF TO L407-AMT-MTHLY-CPF.                        
           MOVE CPF-AMT-RETIRE    TO L407-AMT-RETIRE.                           
           IF   CPF-AMT-RETIRE > 0                                              
           MOVE CPF-AMT-RETIRE    TO L407-AMT-RETIRE                            
           ELSE                                                                 
           MOVE '    - ' TO L407-AMT-RETIRE-A.                                  
           COMPUTE WS-ICP-CPF-SUB3 = WS-ICP-CPF-SUB3 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-ICP-CPF-TOT3 = WS-ICP-CPF-TOT3 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-FIRST-CPF-SUB3 =                                          
                   WS-FIRST-CPF-SUB3 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-FIRST-CPF-TOT3 =                                          
                   WS-FIRST-CPF-TOT3 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-MTHLY-CPF-SUB3 =                                          
                   WS-MTHLY-CPF-SUB3 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-MTHLY-CPF-TOT3 =                                          
                   WS-MTHLY-CPF-TOT3 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-RETIRE-SUB3 =                                             
                   WS-RETIRE-SUB3 + CPF-AMT-RETIRE.                             
           COMPUTE WS-RETIRE-TOT3 =                                             
                   WS-RETIRE-TOT3 + CPF-AMT-RETIRE.                             
                                                                                
           MOVE  SPACES TO PRT-LINE6.                                           
           WRITE PRT-LINE6 FROM L407-DL1 AFTER 2.                               
           ADD 1 TO WS-LINE-CNT3.                                               
                                                                                
       510-EXIT.                                                                
           EXIT.                                                                
                                                                                
       520-PRINT-DETAIL-RP.                                                     
           IF WS-LINE-CNT4 > 23 OR                                              
              CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
                 PERFORM 620-PRINT-HEAD-RP THRU 620-EXIT.                       
           ADD 1 TO WS-SEQ-NO4.                                                 
           MOVE WS-SEQ-NO4 TO L407-SEQ-NO.                                      
           STRING CPF-SCHEME '-' CPF-ACCOUNT '-' CPF-CHK-CDE                    
               DELIMITED BY SIZE INTO L407-SCH-ACC-NO.                          
                                                                                
           MOVE CPF-NAME         TO L407-NAME.                                  
           MOVE CPF-NUM-REGN     TO L407-REGN-NO.                               
           MOVE CPF-NUM-SERIAL   TO L407-SERIAL-NO.                             
           MOVE CPF-CPF-NO       TO L407-CPF-NO.                                
           MOVE CPF-CPF-NO(2:8)  TO WS-CPF-NO.                                  
           SET WS-CODE-PTR TO 1.                                                
           SEARCH WS-CODE-VALUE AT END                                          
                  DISPLAY 'INVALID CPF-CODE ' CPF-CPF-NO                        
                  MOVE 0 TO WS-CPF1                                             
                  WHEN WS-CPF-NUM1 = WS-CODE-IND(WS-CODE-PTR)                   
                       MOVE WS-CODE-DIGIT(WS-CODE-PTR) TO WS-CPF1.              
           MOVE WS-CPF-NUM2 TO WS-CPF2.                                         
           MOVE WS-CPF      TO WS-CPF-COMP.                                     
           COMPUTE WS-CPF-SUB4 = WS-CPF-SUB4 + WS-CPF-COMP.                     
           COMPUTE WS-CPF-TOT4 = WS-CPF-TOT4 + WS-CPF-COMP.                     
           MOVE CPF-AMT-ICP-CPF TO L407-AMT-ICP-CPF.                            
           MOVE CPF-AMT-FIRST-CPF TO L407-AMT-FIRST-CPF.                        
           MOVE CPF-AMT-MTHLY-CPF TO L407-AMT-MTHLY-CPF.                        
           MOVE CPF-AMT-MTHLY-CPF TO L407-AMT-MTHLY-CPF.                        
           MOVE CPF-AMT-RETIRE    TO L407-AMT-RETIRE.                           
           IF   CPF-AMT-RETIRE > 0                                              
           MOVE CPF-AMT-RETIRE    TO L407-AMT-RETIRE                            
           ELSE                                                                 
           MOVE '    - ' TO L407-AMT-RETIRE-A.                                  
           COMPUTE WS-ICP-CPF-SUB4 = WS-ICP-CPF-SUB4 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-ICP-CPF-TOT4 = WS-ICP-CPF-TOT4 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-FIRST-CPF-SUB4 =                                          
                   WS-FIRST-CPF-SUB4 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-FIRST-CPF-TOT4 =                                          
                   WS-FIRST-CPF-TOT4 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-MTHLY-CPF-SUB4 =                                          
                   WS-MTHLY-CPF-SUB4 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-MTHLY-CPF-TOT4 =                                          
                   WS-MTHLY-CPF-TOT4 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-RETIRE-SUB4 =                                             
                   WS-RETIRE-SUB4 + CPF-AMT-RETIRE.                             
           COMPUTE WS-RETIRE-TOT4 =                                             
                   WS-RETIRE-TOT4 + CPF-AMT-RETIRE.                             
                                                                                
           MOVE  SPACES TO PRT-LINE8.                                           
           WRITE PRT-LINE8 FROM L407-DL1 AFTER 2.                               
           ADD 1 TO WS-LINE-CNT4.                                               
                                                                                
       520-EXIT.                                                                
           EXIT.                                                                
                                                                                
       550-PRINT-DETAIL-SOC.                                                    
           IF WS-LINE-CNT2 > 23 OR                                              
              CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
                 PERFORM 650-PRINT-HEAD-SOC THRU 650-EXIT.                      
           ADD 1 TO WS-SEQ-NO2.                                                 
           MOVE WS-SEQ-NO2 TO L407-SEQ-NO.                                      
           STRING CPF-SCHEME '-' CPF-ACCOUNT '-' CPF-CHK-CDE                    
               DELIMITED BY SIZE INTO L407-SCH-ACC-NO.                          
                                                                                
           MOVE CPF-NAME         TO L407-NAME.                                  
           MOVE CPF-NUM-REGN     TO L407-REGN-NO.                               
           MOVE CPF-NUM-SERIAL   TO L407-SERIAL-NO.                             
           MOVE CPF-CPF-NO       TO L407-CPF-NO.                                
           MOVE CPF-CPF-NO(2:8)  TO WS-CPF-NO.                                  
           SET WS-CODE-PTR TO 1.                                                
           SEARCH WS-CODE-VALUE AT END                                          
                  DISPLAY 'INVALID CPF-CODE = ' CPF-CPF-NO                      
                  MOVE 0 TO WS-CPF1                                             
                  WHEN WS-CPF-NUM1 = WS-CODE-IND(WS-CODE-PTR)                   
                       MOVE WS-CODE-DIGIT(WS-CODE-PTR) TO WS-CPF1.              
           MOVE WS-CPF-NUM2 TO WS-CPF2.                                         
           MOVE WS-CPF      TO WS-CPF-COMP.                                     
           COMPUTE WS-CPF-SUB2 = WS-CPF-SUB2 + WS-CPF-COMP.                     
           COMPUTE WS-CPF-TOT2 = WS-CPF-TOT2 + WS-CPF-COMP.                     
           MOVE CPF-AMT-ICP-CPF TO L407-AMT-ICP-CPF.                            
           MOVE CPF-AMT-FIRST-CPF TO L407-AMT-FIRST-CPF.                        
           MOVE CPF-AMT-MTHLY-CPF TO L407-AMT-MTHLY-CPF.                        
           MOVE CPF-AMT-RETIRE    TO L407-AMT-RETIRE.                           
           IF   CPF-AMT-RETIRE > 0                                              
           MOVE CPF-AMT-RETIRE    TO L407-AMT-RETIRE                            
           ELSE                                                                 
           MOVE '    - ' TO L407-AMT-RETIRE-A.                                  
           COMPUTE WS-ICP-CPF-SUB2 = WS-ICP-CPF-SUB2 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-ICP-CPF-TOT2 = WS-ICP-CPF-TOT2 + CPF-AMT-ICP-CPF.         
           COMPUTE WS-FIRST-CPF-SUB2 =                                          
                   WS-FIRST-CPF-SUB2 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-FIRST-CPF-TOT2 =                                          
                   WS-FIRST-CPF-TOT2 + CPF-AMT-FIRST-CPF.                       
           COMPUTE WS-MTHLY-CPF-SUB2 =                                          
                   WS-MTHLY-CPF-SUB2 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-MTHLY-CPF-TOT2 =                                          
                   WS-MTHLY-CPF-TOT2 + CPF-AMT-MTHLY-CPF.                       
           COMPUTE WS-RETIRE-SUB2 =                                             
                   WS-RETIRE-SUB2 + CPF-AMT-RETIRE.                             
           COMPUTE WS-RETIRE-TOT2 =                                             
                   WS-RETIRE-TOT2 + CPF-AMT-RETIRE.                             
                                                                                
           MOVE  SPACES TO PRT-LINE4.                                           
           WRITE PRT-LINE4 FROM L407-DL1 AFTER 2.                               
           ADD 1 TO WS-LINE-CNT2.                                               
                                                                                
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ***************************************************************           
      *      PRINT HEADER FOR ADVANCED ALLOCATION FLAT              *           
      ***************************************************************           
       600-PRINT-HEAD-SOS.                                                      
           IF CPF-CDE-SALES-TYPE = '1A'                                         
              MOVE '01' TO CPF-CDE-SALES-TYPE                                   
           ELSE                                                                 
              IF CPF-CDE-SALES-TYPE = '1B'                                      
                 MOVE '10' TO CPF-CDE-SALES-TYPE.                               
                                                                                
           IF CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
              IF WS-PREV-SALES-TYPE = '01'                                      
                 PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '02'                                      
                 PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '03' OR '3A'                              
                 PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '10' OR '13' OR '18'                      
                 PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE.                 
                                                                                
           IF CPF-CDE-SALES-TYPE NOT = WS-PREV-SALES-TYPE                       
              IF WS-PREV-SALES-TYPE = '02'                                      
                 PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '03' OR '3A'                              
                 PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '10' OR '13' OR '18'                      
                 PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE.                 
                                                                                
           ADD 1 TO WS-PAGE-CNT1.                                               
           MOVE WS-PAGE-CNT1 TO WS-PAGE.                                        
           MOVE 'P13L407B' TO PGM-ID.                                           
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURR-CCYYMMDD.                      
                                                                                
           MOVE F001-CURR-DD   TO WS-DD  WS-EDIT-DD.                            
           MOVE F001-CURR-MM   TO WS-MM  WS-EDIT-MM.                            
           MOVE F001-CURR-YY   TO WS-YY  WS-EDIT-YY.                            
           MOVE F001-CURR-CC   TO WS-CC  WS-EDIT-CC.                            
           MOVE WS-EDITED-DATE TO WS-SYS-DATE.                                  
           MOVE CPF-NUM-BATCH  TO L407-BATCH-NO.                                
           WRITE PRT-LINE2 FROM L407-COMM-HDG1 AFTER PAGE.                      
           WRITE PRT-LINE2 FROM L407B-HDG1 AFTER 1.                             
           WRITE PRT-LINE2 FROM L407-COMM-HDG3 AFTER 1.                         
           WRITE PRT-LINE2 FROM L407-COMM-HDG8 AFTER 2.                         
           WRITE PRT-LINE2 FROM L407-COMM-HDG6 AFTER 3.                         
           WRITE PRT-LINE2 FROM L407-COMM-HDG7 AFTER 1.                         
                                                                                
           MOVE ZEROS TO WS-LINE-CNT1.                                          
                                                                                
        600-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ***************************************************************           
      *      PRINT HEADER FOR ST FLAT                               *           
      ***************************************************************           
       610-PRINT-HEAD-ST.                                                       
           IF CPF-CDE-SALES-TYPE = '1A'                                         
              MOVE '01' TO CPF-CDE-SALES-TYPE                                   
           ELSE                                                                 
              IF CPF-CDE-SALES-TYPE = '1B'                                      
                 MOVE '10' TO CPF-CDE-SALES-TYPE.                               
                                                                                
           IF CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
              IF WS-PREV-SALES-TYPE = '01'                                      
                 PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '02'                                      
                 PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '03' OR '3A'                              
                 PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '10' OR '13' OR '18'                      
                 PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO.                        
                                                                                
           IF CPF-CDE-SALES-TYPE NOT = WS-PREV-SALES-TYPE                       
              IF WS-PREV-SALES-TYPE = '01'                                      
                 PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '03' OR '3A'                              
                 PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '10' OR '13' OR '18'                      
                 PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE.                 
                                                                                
           ADD 1 TO WS-PAGE-CNT3.                                               
           MOVE WS-PAGE-CNT3 TO WS-PAGE.                                        
           MOVE 'P13L407F' TO PGM-ID.                                           
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURR-CCYYMMDD.                      
           MOVE WS-CURR-DD     TO WS-DD  WS-EDIT-DD.                            
           MOVE WS-CURR-MM     TO WS-MM  WS-EDIT-MM.                            
           MOVE WS-CURR-YY     TO WS-YY  WS-EDIT-YY.                            
           MOVE WS-CURR-CC     TO WS-CC  WS-EDIT-CC.                            
           MOVE WS-EDITED-DATE TO WS-SYS-DATE.                                  
           MOVE CPF-NUM-BATCH  TO L407-BATCH-NO.                                
           WRITE PRT-LINE6 FROM L407-COMM-HDG1 AFTER PAGE.                      
           WRITE PRT-LINE6 FROM L407F-HDG1 AFTER 1.                             
           WRITE PRT-LINE6 FROM L407-COMM-HDG3 AFTER 1.                         
           WRITE PRT-LINE6 FROM L407-COMM-HDG8 AFTER 2.                         
           WRITE PRT-LINE6 FROM L407-COMM-HDG6 AFTER 3.                         
           WRITE PRT-LINE6 FROM L407-COMM-HDG7 AFTER 1.                         
                                                                                
           MOVE ZEROS TO WS-LINE-CNT3.                                          
                                                                                
        610-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ***************************************************************           
      *      PRINT HEADER FOR RP FLAT                               *           
      ***************************************************************           
       620-PRINT-HEAD-RP.                                                       
           IF CPF-CDE-SALES-TYPE = '1A'                                         
              MOVE '01' TO CPF-CDE-SALES-TYPE                                   
           ELSE                                                                 
              IF CPF-CDE-SALES-TYPE = '1B'                                      
                 MOVE '10' TO CPF-CDE-SALES-TYPE.                               
                                                                                
           IF CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
              IF WS-PREV-SALES-TYPE = '01'                                      
                 PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '02'                                      
                 PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '03' OR '3A'                              
                 PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '10' OR '13' OR '18'                      
                 PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO.                        
                                                                                
           IF CPF-CDE-SALES-TYPE NOT = WS-PREV-SALES-TYPE                       
              IF WS-PREV-SALES-TYPE = '01'                                      
                 PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '02'                                      
                 PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '10' OR '13' OR '18'                      
                 PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE.                 
                                                                                
           ADD 1 TO WS-PAGE-CNT4.                                               
           MOVE WS-PAGE-CNT4 TO WS-PAGE.                                        
           MOVE 'P13L407H' TO PGM-ID.                                           
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURR-CCYYMMDD.                      
           MOVE WS-CURR-DD     TO WS-DD  WS-EDIT-DD.                            
           MOVE WS-CURR-MM     TO WS-MM  WS-EDIT-MM.                            
           MOVE WS-CURR-YY     TO WS-YY  WS-EDIT-YY.                            
           MOVE WS-CURR-CC     TO WS-CC  WS-EDIT-CC.                            
           MOVE WS-EDITED-DATE TO WS-SYS-DATE.                                  
           MOVE CPF-NUM-BATCH  TO L407-BATCH-NO.                                
           WRITE PRT-LINE8 FROM L407-COMM-HDG1 AFTER PAGE.                      
           WRITE PRT-LINE8 FROM L407H-HDG1 AFTER 1.                             
           WRITE PRT-LINE8 FROM L407-COMM-HDG3 AFTER 1.                         
           WRITE PRT-LINE8 FROM L407-COMM-HDG8 AFTER 2.                         
           WRITE PRT-LINE8 FROM L407-COMM-HDG6 AFTER 3.                         
           WRITE PRT-LINE8 FROM L407-COMM-HDG7 AFTER 1.                         
                                                                                
           MOVE ZEROS TO WS-LINE-CNT4.                                          
                                                                                
        620-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ***************************************************************           
      *      PRINT HEADER FOR SOC FLAT                              *           
      ***************************************************************           
       650-PRINT-HEAD-SOC.                                                      
           IF CPF-CDE-SALES-TYPE = '1A'                                         
              MOVE '01' TO CPF-CDE-SALES-TYPE                                   
           ELSE                                                                 
              IF CPF-CDE-SALES-TYPE = '1B'                                      
                 MOVE '10' TO CPF-CDE-SALES-TYPE.                               
                                                                                
           IF CPF-NUM-BATCH NOT = WS-PREV-BATCH-NO                              
              IF WS-PREV-SALES-TYPE = '01'                                      
                 PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '02'                                      
                 PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '03' OR '3A'                              
                 PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '10' OR '13' OR '18'                      
                 PERFORM 750-PRINT-SUB-TOT THRU 750-EXIT                        
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO.                        
                                                                                
           IF CPF-CDE-SALES-TYPE NOT = WS-PREV-SALES-TYPE                       
              IF WS-PREV-SALES-TYPE = '01'                                      
                 PERFORM 700-PRINT-SUB-TOT THRU 700-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '02'                                      
                 PERFORM 710-PRINT-SUB-TOT THRU 710-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE                  
              ELSE                                                              
              IF WS-PREV-SALES-TYPE = '03' OR '3A'                              
                 PERFORM 720-PRINT-SUB-TOT THRU 720-EXIT                        
                 MOVE CPF-NUM-BATCH TO WS-PREV-BATCH-NO                         
                 MOVE CPF-CDE-SALES-TYPE TO WS-PREV-SALES-TYPE.                 
           ADD 1 TO WS-PAGE-CNT2.                                               
                                                                                
           MOVE WS-PAGE-CNT2 TO WS-PAGE.                                        
           MOVE 'P13L407D' TO PGM-ID.                                           
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURR-CCYYMMDD.                      
           MOVE WS-CURR-DD     TO WS-DD  WS-EDIT-DD.                            
           MOVE WS-CURR-MM     TO WS-MM  WS-EDIT-MM.                            
           MOVE WS-CURR-YY     TO WS-YY  WS-EDIT-YY.                            
           MOVE WS-CURR-CC     TO WS-CC  WS-EDIT-CC.                            
           MOVE WS-EDITED-DATE TO WS-SYS-DATE.                                  
           MOVE CPF-NUM-BATCH  TO L407-BATCH-NO.                                
           WRITE PRT-LINE4 FROM L407-COMM-HDG1 AFTER PAGE.                      
           WRITE PRT-LINE4 FROM L407D-HDG1 AFTER 1.                             
           WRITE PRT-LINE4 FROM L407-COMM-HDG3 AFTER 1.                         
           WRITE PRT-LINE4 FROM L407-COMM-HDG8 AFTER 2.                         
           WRITE PRT-LINE4 FROM L407-COMM-HDG6 AFTER 3.                         
           WRITE PRT-LINE4 FROM L407-COMM-HDG7 AFTER 1.                         
                                                                                
           MOVE ZEROS TO WS-LINE-CNT2.                                          
                                                                                
        650-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
      *   PRINT OUT THE BATCH TOTAL FOR ADVANCE ALLOCATION FLAT   *             
      *************************************************************             
       700-PRINT-SUB-TOT.                                                       
           MOVE WS-CPF-SUB1 TO L407-CPF-SUB.                                    
           MOVE WS-ICP-CPF-SUB1 TO L407-ICP-CPF-SUB.                            
           MOVE WS-FIRST-CPF-SUB1 TO L407-FIRST-CPF-SUB.                        
           MOVE WS-MTHLY-CPF-SUB1 TO L407-MTHLY-CPF-SUB.                        
           MOVE WS-RETIRE-SUB1    TO L407-MTHLY-CPF-SUB.                        
                                                                                
           WRITE PRT-LINE2 FROM L407-DL2 AFTER 2.                               
                                                                                
           MOVE ZEROS TO WS-CPF-SUB1.                                           
           MOVE ZEROS TO WS-ICP-CPF-SUB1.                                       
           MOVE ZEROS TO WS-FIRST-CPF-SUB1.                                     
           MOVE ZEROS TO WS-MTHLY-CPF-SUB1.                                     
           MOVE ZEROS TO WS-RETIRE-SUB1.                                        
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *************************************************************             
      *   PRINT OUT THE BATCH TOTAL FOR ST FLAT                   *             
      *************************************************************             
       710-PRINT-SUB-TOT.                                                       
           MOVE WS-CPF-SUB3 TO L407-CPF-SUB.                                    
           MOVE WS-ICP-CPF-SUB3 TO L407-ICP-CPF-SUB.                            
           MOVE WS-FIRST-CPF-SUB3 TO L407-FIRST-CPF-SUB.                        
           MOVE WS-MTHLY-CPF-SUB3 TO L407-MTHLY-CPF-SUB.                        
           MOVE WS-RETIRE-SUB3    TO L407-MTHLY-CPF-SUB.                        
                                                                                
           WRITE PRT-LINE6 FROM L407-DL2 AFTER 2.                               
                                                                                
           MOVE ZEROS TO WS-CPF-SUB3.                                           
           MOVE ZEROS TO WS-ICP-CPF-SUB3.                                       
           MOVE ZEROS TO WS-FIRST-CPF-SUB3.                                     
           MOVE ZEROS TO WS-MTHLY-CPF-SUB3.                                     
           MOVE ZEROS TO WS-RETIRE-SUB3.                                        
                                                                                
       710-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *************************************************************             
      *   PRINT OUT THE BATCH TOTAL FOR RP FLAT                   *             
      *************************************************************             
       720-PRINT-SUB-TOT.                                                       
           MOVE WS-CPF-SUB4 TO L407-CPF-SUB.                                    
           MOVE WS-ICP-CPF-SUB4 TO L407-ICP-CPF-SUB.                            
           MOVE WS-FIRST-CPF-SUB4 TO L407-FIRST-CPF-SUB.                        
           MOVE WS-MTHLY-CPF-SUB4 TO L407-MTHLY-CPF-SUB.                        
           MOVE WS-RETIRE-SUB4    TO L407-MTHLY-CPF-SUB.                        
                                                                                
           WRITE PRT-LINE8 FROM L407-DL2 AFTER 2.                               
                                                                                
           MOVE ZEROS TO WS-CPF-SUB4.                                           
           MOVE ZEROS TO WS-ICP-CPF-SUB4.                                       
           MOVE ZEROS TO WS-FIRST-CPF-SUB4.                                     
           MOVE ZEROS TO WS-MTHLY-CPF-SUB4.                                     
           MOVE ZEROS TO WS-RETIRE-SUB4.                                        
                                                                                
       720-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *************************************************************             
      *   PRINT OUT THE BATCH TOTAL FOR SOC FLAT                  *             
      *************************************************************             
       750-PRINT-SUB-TOT.                                                       
           MOVE WS-CPF-SUB2 TO L407-CPF-SUB.                                    
           MOVE WS-ICP-CPF-SUB2 TO L407-ICP-CPF-SUB.                            
           MOVE WS-FIRST-CPF-SUB2 TO L407-FIRST-CPF-SUB.                        
           MOVE WS-MTHLY-CPF-SUB2 TO L407-MTHLY-CPF-SUB.                        
           MOVE WS-RETIRE-SUB2    TO L407-MTHLY-CPF-SUB.                        
                                                                                
           WRITE PRT-LINE4 FROM L407-DL2 AFTER 2.                               
                                                                                
           MOVE ZEROS TO WS-CPF-SUB2.                                           
           MOVE ZEROS TO WS-ICP-CPF-SUB2.                                       
           MOVE ZEROS TO WS-FIRST-CPF-SUB2.                                     
           MOVE ZEROS TO WS-MTHLY-CPF-SUB2.                                     
           MOVE ZEROS TO WS-RETIRE-SUB2.                                        
                                                                                
       750-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *************************************************************             
      *   PRINT OUT THE GRAND TOTAL FOR ADVANCE ALLOCATION FLAT   *             
      *************************************************************             
       2000-PRINT-TOT-SOS.                                                      
           MOVE WS-CPF-TOT1 TO L407-CPF-TOT.                                    
           MOVE WS-ICP-CPF-TOT1 TO L407-ICP-CPF-TOT.                            
           MOVE WS-FIRST-CPF-TOT1 TO L407-FIRST-CPF-TOT.                        
           MOVE WS-MTHLY-CPF-TOT1 TO L407-MTHLY-CPF-TOT.                        
           MOVE WS-RETIRE-TOT1    TO L407-RETIRE-TOT.                           
                                                                                
           WRITE PRT-LINE2 FROM L407-DL3 AFTER 1.                               
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************************************************             
      *   PRINT OUT THE GRAND TOTAL FOR ST FLAT                   *             
      *************************************************************             
       2010-PRINT-TOT-ST.                                                       
           MOVE WS-CPF-TOT3 TO L407-CPF-TOT.                                    
           MOVE WS-ICP-CPF-TOT3 TO L407-ICP-CPF-TOT.                            
           MOVE WS-FIRST-CPF-TOT3 TO L407-FIRST-CPF-TOT.                        
           MOVE WS-MTHLY-CPF-TOT3 TO L407-MTHLY-CPF-TOT.                        
           MOVE WS-RETIRE-TOT3    TO L407-RETIRE-TOT.                           
                                                                                
           WRITE PRT-LINE6 FROM L407-DL3 AFTER 1.                               
                                                                                
       2010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************************************************             
      *   PRINT OUT THE GRAND TOTAL FOR RP FLAT                   *             
      *************************************************************             
       2020-PRINT-TOT-RP.                                                       
           MOVE WS-CPF-TOT4 TO L407-CPF-TOT.                                    
           MOVE WS-ICP-CPF-TOT4 TO L407-ICP-CPF-TOT.                            
           MOVE WS-FIRST-CPF-TOT4 TO L407-FIRST-CPF-TOT.                        
           MOVE WS-MTHLY-CPF-TOT4 TO L407-MTHLY-CPF-TOT.                        
           MOVE WS-RETIRE-TOT4    TO L407-RETIRE-TOT.                           
                                                                                
           WRITE PRT-LINE8 FROM L407-DL3 AFTER 1.                               
                                                                                
       2020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************************************************             
      *   PRINT OUT THE GRAND TOTAL FOR SOC FLAT                  *             
      *************************************************************             
       2050-PRINT-TOT-SOC.                                                      
           MOVE WS-CPF-TOT2 TO L407-CPF-TOT.                                    
           MOVE WS-ICP-CPF-TOT2 TO L407-ICP-CPF-TOT.                            
           MOVE WS-FIRST-CPF-TOT2 TO L407-FIRST-CPF-TOT.                        
           MOVE WS-MTHLY-CPF-TOT2 TO L407-MTHLY-CPF-TOT.                        
           MOVE WS-RETIRE-TOT2    TO L407-RETIRE-TOT.                           
                                                                                
           WRITE PRT-LINE4 FROM L407-DL3 AFTER 1.                               
                                                                                
       2050-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2100-ACK-LIST-SOS.                                                       
           MOVE WS-SEQ-NO1 TO L407A-TOT-CNT.                                    
           MOVE WS-EDITED-DATE TO L407A-DATE.                                   
           MOVE SPACES TO PRT-LINE1.                                            
           WRITE PRT-LINE1 FROM L407-COMM-HDG2 AFTER PAGE.                      
           WRITE PRT-LINE1 FROM L407A-HDG1 AFTER 5.                             
           WRITE PRT-LINE1 FROM L407-COMM-HDG4 AFTER 6.                         
           WRITE PRT-LINE1 FROM L407-COMM-HDG5 AFTER 2.                         
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2110-ACK-LIST-ST.                                                        
           MOVE WS-SEQ-NO3 TO L407E-TOT-CNT.                                    
           MOVE WS-EDITED-DATE TO L407E-DATE.                                   
           MOVE SPACES TO PRT-LINE5.                                            
           WRITE PRT-LINE5 FROM L407-COMM-HDG2 AFTER PAGE.                      
           WRITE PRT-LINE5 FROM L407E-HDG1 AFTER 5.                             
           WRITE PRT-LINE5 FROM L407-COMM-HDG4 AFTER 6.                         
           WRITE PRT-LINE5 FROM L407-COMM-HDG5 AFTER 2.                         
                                                                                
       2110-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2120-ACK-LIST-RP.                                                        
           MOVE WS-SEQ-NO4 TO L407G-TOT-CNT.                                    
           MOVE WS-EDITED-DATE TO L407G-DATE.                                   
           MOVE SPACES TO PRT-LINE7.                                            
           WRITE PRT-LINE7 FROM L407-COMM-HDG2 AFTER PAGE.                      
           WRITE PRT-LINE7 FROM L407G-HDG1 AFTER 5.                             
           WRITE PRT-LINE7 FROM L407-COMM-HDG4 AFTER 6.                         
           WRITE PRT-LINE7 FROM L407-COMM-HDG5 AFTER 2.                         
                                                                                
       2120-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2150-ACK-LIST-SOC.                                                       
           MOVE WS-SEQ-NO2 TO L407C-TOT-CNT.                                    
           MOVE WS-EDITED-DATE TO L407C-DATE.                                   
           MOVE SPACES TO PRT-LINE3.                                            
           WRITE PRT-LINE3 FROM L407-COMM-HDG2 AFTER PAGE.                      
           WRITE PRT-LINE3 FROM L407C-HDG1 AFTER 5.                             
           WRITE PRT-LINE3 FROM L407-COMM-HDG4 AFTER 6.                         
           WRITE PRT-LINE3 FROM L407-COMM-HDG5 AFTER 2.                         
                                                                                
       2150-EXIT.                                                               
           EXIT.                                                                
                                                                                
