       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CZ2H.                                                 
      *AUTHOR.        LIZ PATIAG.                                               
      *DATE-WRITTEN.  10/07/2015.                                               
      *========================================================*                
      * SYSTEM OF COMMITMENT (BP13)                            *                
      *========================================================*                
      *    OBJECTIVE :                                         *                
      *      1.  COUNT THE TOTAL NUMBER OF FLATS AND UPDATE    *                
      *          BP13F558 (RSL, SMS, TRF, MAM, SLS)            *                
      *          BP13K558 - NUM-NTIMER FIELD                   *                
      *          BP13F730 - ELDERLY                            *                
      *--------------------------------------------------------*                
      * CHG-NO    BY  DATE    DESCRIPTION                      *                
      * -------  ---  ------  -----------                      *                
      * BP135921 FNP1 100715  NEW PROGRAM                      *                
      * BP136239 SMR2 260516  ADD ALLO-CAT FIELD IN BP13TMP    *                
      * BP136404 SMR2 061016  SEPARATE BTO AND SBF REPORTS     *                
      * BP136852 SMR2 200717  CATER FOR ROF REPORTS            *                
      * BP137439 AM25 030918  CORRECT PAGINATION ISSUE         *                
      * BP137994 SMP3 200819  ENHANCE CONDITION ON COUNTING    *                
      * BP138285 AM25 180520  CHANGE REPORT ID                 *                
      * BP138240 FP6  291020  EXCLUDE OM RSL FLAT              *                
      * BP139518 EAA2 280223  TO INCLUDE 6 SALES TYPE CODE IN  *                
      *                       HOUSEHOLD DETERMINATION          *                
      *                       (8L/8M/8N/8R/8S/8T)              *                
      *========================================================*                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F558   ASSIGN       TO BP13F558.                          
                                                                                
           SELECT BP13F730   ASSIGN       TO BP13F730.                          
                                                                                
           SELECT BP13K558   ASSIGN       TO BP13K558                           
                             ACCESS MODE  IS RANDOM                             
                             ORGANIZATION IS INDEXED                            
                             RECORD KEY   IS K558-KEY-FLD                       
                             FILE STATUS  IS BP13K558-STATUS.                   
                                                                                
           SELECT P13F558O   ASSIGN       TO P13F558O.                          
           SELECT BP13TMP    ASSIGN       TO BP13TMP.                           
           SELECT P13LZ2HA   ASSIGN       TO P13LZ2HA.                          
           SELECT P13LZ2HB   ASSIGN       TO P13LZ2HB.                          
           SELECT P13LZ2HC   ASSIGN       TO P13LZ2HC.                          
           SELECT P13LZ2HD   ASSIGN       TO P13LZ2HD.                          
           SELECT P13LZ2HE   ASSIGN       TO P13LZ2HE.                          
           SELECT P13LZ2HF   ASSIGN       TO P13LZ2HF.                          
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F558                                                            
            RECORD CONTAINS 600 CHARACTERS                                      
            BLOCK  CONTAINS 0   RECORDS                                         
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       COPY BP13F558.                                                           
                                                                                
       FD   BP13F730                                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            BLOCK  CONTAINS 0   RECORDS                                         
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       COPY BP13F730.                                                           
                                                                                
       FD   BP13K558                                                            
            RECORD CONTAINS 600 CHARACTERS.                                     
       COPY BP13K558.                                                           
                                                                                
       FD   P13F558O                                                            
            RECORD CONTAINS 600 CHARACTERS                                      
            BLOCK  CONTAINS 0   RECORDS                                         
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       01   P13F558O-REC            PIC X(600).                                 
                                                                                
       FD   BP13TMP                                                             
            RECORD CONTAINS 50  CHARACTERS                                      
            BLOCK  CONTAINS 0   RECORDS                                         
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       01   BP13TMP-REC.                                                        
            05  TMP-NUM-REGN        PIC X(8).                                   
            05  TMP-NUM-NRIC        PIC X(9).                                   
            05  TMP-NUM-ALLO-CAT    PIC X(3).                                   
            05  FILLER              PIC X(30).                                  
                                                                                
       FD   P13LZ2HA                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2HA-REC            PIC X(132).                                 
                                                                                
       FD   P13LZ2HB                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2HB-REC            PIC X(132).                                 
                                                                                
       FD   P13LZ2HC                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2HC-REC            PIC X(132).                                 
                                                                                
       FD   P13LZ2HD                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2HD-REC            PIC X(132).                                 
                                                                                
       FD   P13LZ2HE                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2HE-REC            PIC X(132).                                 
                                                                                
       FD   P13LZ2HF                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2HF-REC            PIC X(132).                                 
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-F558-READ             PIC 9(8)    VALUE 0.                        
       01  WS-F730-READ             PIC 9(8)    VALUE 0.                        
       01  WS-OUTPUT-CNT            PIC 9(8)    VALUE 0.                        
       01  WS-TMP-WRITE-CNT         PIC 9(8)    VALUE 0.                        
       01  WS-MATCHED-CNT           PIC 9(8)    VALUE 0.                        
       01  K558-FND-CNT             PIC 9(8)    VALUE 0.                        
       01  WS-K558-UPD              PIC 9(8)    VALUE 0.                        
       01  K558-NFND-CNT            PIC 9(8)    VALUE 0.                        
       01  WS-FILE-STATUS           PIC X(03)   VALUE SPACES.                   
       01  WS-TOTAL                 PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-A               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-B               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-C               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-D               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-E               PIC 9(5)    VALUE 0.                        
       01  BP13K558-STATUS          PIC 99      VALUE ZEROES.                   
       01  WS-F730-MATCH            PIC 9(8)    VALUE 0.                        
       01  WS-F730-NOMATCH          PIC 9(8)    VALUE 0.                        
       01  WS-F558-NOMATCH          PIC 9(8)    VALUE 0.                        
                                                                                
       01  WS-FLAT-VARIABLES.                                                   
           05  WS-FLAT-DETAILS OCCURS 10 TIMES.                                 
               10  WS-NUM-HDB-REF       PIC X(11).                              
               10  WS-RESALE-CODE       PIC X(3).                               
               10  WS-FILE-SRC          PIC X(3).                               
               10  WS-DIVORCE-CODE      PIC X(1).                               
               10  WS-DEBAR-CODE        PIC X(2).                               
           05  WS-CNT                   PIC 9(1) VALUE ZEROES.                  
           05  WS-CTR                   PIC 9(2) VALUE ZEROES.                  
           05  WS-CTR2                  PIC 9(2) VALUE ZEROES.                  
           05  WS-CTR3                  PIC 9(2) VALUE ZEROES.                  
           05  WS-CTR4                  PIC 9(2) VALUE ZEROES.                  
           05  WS-CTR6                  PIC 9(2) VALUE ZEROES.                  
           05  WS-PAGE-CNT              PIC 9(5) VALUE ZEROES.                  
           05  WS-PAGE-CNT-A            PIC 9(5) VALUE ZEROES.                  
           05  WS-PAGE-CNT-B            PIC 9(5) VALUE ZEROES.                  
           05  WS-PAGE-CNT-C            PIC 9(5) VALUE ZEROES.                  
           05  WS-PAGE-CNT-D            PIC 9(5) VALUE ZEROES.                  
           05  WS-PAGE-CNT-E            PIC 9(5) VALUE ZEROES.                  
           05  WS-LINE-CNT              PIC 9(2) VALUE ZEROES.                  
           05  WS-LINE-CNT-A            PIC 9(2) VALUE ZEROES.                  
           05  WS-LINE-CNT-B            PIC 9(2) VALUE ZEROES.                  
           05  WS-LINE-CNT-C            PIC 9(2) VALUE ZEROES.                  
           05  WS-LINE-CNT-D            PIC 9(2) VALUE ZEROES.                  
           05  WS-LINE-CNT-E            PIC 9(2) VALUE ZEROES.                  
           05  WS-NUM-REGN              PIC X(8) VALUE SPACES.                  
           05  WS-NUM-NTIMER            PIC X(1) VALUE SPACES.                  
           05  WS-DEBAR33               PIC X(1) VALUE SPACES.                  
           05  WS-DEBAR                 PIC X(2) VALUE SPACES.                  
           05  WS-APPLICANT-REC.                                                
               10  WS-NUM-NRIC-A        PIC X(9) VALUE SPACES.                  
               10  WS-NUM-NTIMER-A      PIC X(1) VALUE SPACES.                  
               10  WS-CDE-HH-A          PIC X(1) VALUE SPACES.                  
               10  WS-TAG-A             PIC X(1) VALUE SPACES.                  
               10  WS-NUM-MS-A          PIC X(1) VALUE SPACES.                  
               10  WS-DP-CNT-A          PIC X(2) VALUE SPACES.                  
               10  WS-DEBAR-A           PIC X(2) VALUE SPACES.                  
           05  WS-SPOUSE-REC.                                                   
               10  WS-NUM-NRIC-B        PIC X(9) VALUE SPACES.                  
               10  WS-NUM-NTIMER-B      PIC X(1) VALUE SPACES.                  
               10  WS-CDE-HH-B          PIC X(1) VALUE SPACES.                  
               10  WS-TAG-B             PIC X(1) VALUE SPACES.                  
               10  WS-DP-CNT-B          PIC X(2) VALUE SPACES.                  
               10  WS-DEBAR-B           PIC X(2) VALUE SPACES.                  
           05  WS-OTHER-RELN-REC.                                               
               10  WS-NUM-NRIC-C        PIC X(9) VALUE SPACES.                  
               10  WS-NUM-NTIMER-C      PIC X(1) VALUE SPACES.                  
               10  WS-CDE-HH-C          PIC X(1) VALUE SPACES.                  
               10  WS-TAG-C             PIC X(1) VALUE SPACES.                  
               10  WS-DP-CNT-C          PIC X(2) VALUE SPACES.                  
               10  WS-DEBAR-C           PIC X(2) VALUE SPACES.                  
           05  WS-K558-FLAT-DETAILS OCCURS 10 TIMES.                            
               10  WS-K558-HDB-REF       PIC X(11).                             
               10  WS-K558-RESALE-CODE       PIC X(3).                          
               10  WS-K558-FILE-SRC          PIC X(3).                          
               10  WS-K558-DIVORCE-CODE      PIC X(1).                          
               10  WS-K558-DEBAR-CODE        PIC X(2).                          
                                                                                
       01  EOF-BP13F558            PIC X        VALUE 'N'.                      
       01  EOF-BP13F730            PIC X        VALUE 'N'.                      
       01  WS-LZ2HA-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2HB-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2HC-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2HD-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2HE-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2HF-HDR            PIC X        VALUE 'N'.                      
                                                                                
       01  WS-DATE.                                                             
           05  WS-YY               PIC X(2).                                    
           05  WS-MM               PIC X(2).                                    
           05  WS-DD               PIC X(2).                                    
                                                                                
       01  WS-CC                   PIC 99.                                      
                                                                                
       01  LZ2H-HEAD01.                                                         
           05  FILLER              PIC X(8)      VALUE 'BP13LZ2H'.              
           05  FILLER              PIC X(1)      VALUE '_'.                     
           05  LZ2H-SMODE          PIC X(3)      VALUE SPACES.                  
           05  FILLER              PIC X(1)      VALUE SPACES.                  
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                    'S Y S T E M   O F   '.                     
           05  FILLER              PIC X(19)     VALUE                          
                                    'C O M M I T M E N T'.                      
           05  FILLER              PIC X(32)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  LZ2H-DATE           PIC X(10).                                   
                                                                                
       01  LZ2H-HEAD02.                                                         
           05  FILLER              PIC X(44)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NTIMERS) - BTO'.                       
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2H-PAGENO         PIC ZZZZ9.                                   
                                                                                
       01  LZ2H-HEAD02A.                                                        
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(44)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NOT NTIMERS) - BTO'.                   
           05  FILLER              PIC X(29)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2H-PAGENO-A       PIC ZZZZ9.                                   
                                                                                
       01  LZ2H-HEAD02B.                                                        
           05  FILLER              PIC X(44)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NTIMERS) - SBF'.                       
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2H-PAGENO-B       PIC ZZZZ9.                                   
                                                                                
       01  LZ2H-HEAD02C.                                                        
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(44)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NOT NTIMERS) - SBF'.                   
           05  FILLER              PIC X(29)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2H-PAGENO-C       PIC ZZZZ9.                                   
                                                                                
       01  LZ2H-HEAD02D.                                                        
           05  FILLER              PIC X(44)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NTIMERS) - ROF'.                       
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2H-PAGENO-D       PIC ZZZZ9.                                   
                                                                                
       01  LZ2H-HEAD02E.                                                        
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(44)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NOT NTIMERS) - ROF'.                   
           05  FILLER              PIC X(29)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2H-PAGENO-E       PIC ZZZZ9.                                   
                                                                                
       01  LZ2H-HEAD03.                                                         
           05  FILLER              PIC X(07)     VALUE ' S/N'.                  
           05  FILLER              PIC X(09)     VALUE 'REG NO'.                
           05  FILLER              PIC X(06)     VALUE 'SMODE '.                
           05  FILLER              PIC X(04)     VALUE 'NT'.                    
           05  FILLER              PIC X(03)     VALUE 'FT'.                    
           05  FILLER              PIC X(10)     VALUE ' NRIC'.                 
           05  FILLER              PIC X(13)     VALUE '  HDB-REF'.             
           05  FILLER              PIC X(04)     VALUE 'ST'.                    
           05  FILLER              PIC X(05)     VALUE 'FILE'.                  
           05  FILLER              PIC X(08)     VALUE 'DIVORCE'.               
           05  FILLER              PIC X(07)     VALUE 'DEBAR'.                 
           05  FILLER              PIC X(06)     VALUE 'RELN'.                  
                                                                                
       01  LZ2H-BLANK.                                                          
           05  FILLER              PIC X(132)    VALUE SPACES.                  
                                                                                
       01  LZ2H-DETAIL.                                                         
           05  FILLER                PIC X(01)     VALUE SPACES.                
           05  LZ2H-TOTAL            PIC X(05)     VALUE ZEROES.                
           05  FILLER                PIC X(01)     VALUE SPACES.                
           05  LZ2H-NUM-REGN         PIC X(8)      VALUE SPACES.                
           05  FILLER                PIC X(2)      VALUE SPACES.                
           05  LZ2H-NUM-SMODE        PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(2)      VALUE SPACES.                
           05  LZ2H-NUM-NT           PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(1)      VALUE SPACES.                
           05  LZ2H-NUM-FT           PIC X(2)      VALUE SPACES.                
           05  FILLER                PIC X(1)      VALUE SPACES.                
           05  LZ2H-NUM-NRIC1        PIC X(9)      VALUE SPACES.                
           05  FILLER                PIC X(1)      VALUE SPACES.                
           05  LZ2H-HDB-REF          PIC X(11)     VALUE SPACES.                
           05  FILLER                PIC X(02)     VALUE SPACES.                
           05  LZ2H-RESALE-STATUS    PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(02)     VALUE SPACES.                
           05  LZ2H-CODE             PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(04)     VALUE SPACES.                
           05  LZ2H-DIVORCE          PIC X(01)     VALUE SPACES.                
           05  FILLER                PIC X(06)     VALUE SPACES.                
           05  LZ2H-DEBAR            PIC X(02)     VALUE SPACES.                
           05  FILLER                PIC X(06)     VALUE SPACES.                
           05  LZ2H-RELN             PIC X(02)     VALUE SPACES.                
                                                                                
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------*                
       000-MAIN.                                                                
      *--------------------------------------------------------*                
           OPEN INPUT  BP13F558                                                 
                       BP13F730                                                 
                I-O    BP13K558                                                 
                OUTPUT P13F558O                                                 
                       BP13TMP                                                  
                       P13LZ2HA                                                 
                       P13LZ2HB                                                 
                       P13LZ2HC                                                 
                       P13LZ2HD                                                 
                       P13LZ2HE                                                 
                       P13LZ2HF.                                                
                                                                                
           IF BP13K558-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR OPENING BP13K558 (' BP13K558-STATUS ')'            
              MOVE BP13K558-STATUS           TO RETURN-CODE                     
              GO TO 900-CLOSE-ROUTINE                                           
           END-IF.                                                              
                                                                                
           ACCEPT WS-DATE FROM DATE.                                            
           IF WS-YY > '90'                                                      
              MOVE '19' TO WS-CC                                                
           ELSE                                                                 
              MOVE '20' TO WS-CC.                                               
           STRING WS-DD '/' WS-MM '/' WS-CC WS-YY                               
                DELIMITED BY SIZE INTO LZ2H-DATE.                               
                                                                                
           PERFORM 050-READ-F730-REC THRU 050-EXIT.                             
           PERFORM 100-READ-F558-REC THRU 100-EXIT.                             
           PERFORM 200-PROCESS-REC   THRU 200-EXIT                              
                   UNTIL EOF-BP13F730 = 'Y' AND EOF-BP13F558 = 'Y'              
           PERFORM 900-CLOSE-ROUTINE.                                           
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       005-PRINT-HEADING.                                                       
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT.                          
           MOVE WS-PAGE-CNT            TO LZ2H-PAGENO.                          
           MOVE 'BTO'                  TO LZ2H-SMODE.                           
                                                                                
           WRITE P13LZ2HA-REC FROM LZ2H-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2HA-REC FROM LZ2H-HEAD02  AFTER 1.                        
           WRITE P13LZ2HA-REC FROM LZ2H-BLANK.                                  
           WRITE P13LZ2HA-REC FROM LZ2H-HEAD03  AFTER 3.                        
           WRITE P13LZ2HA-REC FROM LZ2H-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT.                          
                                                                                
       005-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       010-PRINT-HEADING-A.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-A.                        
           MOVE WS-PAGE-CNT-A          TO LZ2H-PAGENO-A.                        
           MOVE 'BTO'                  TO LZ2H-SMODE.                           
                                                                                
           WRITE P13LZ2HB-REC FROM LZ2H-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2HB-REC FROM LZ2H-HEAD02A AFTER 1.                        
           WRITE P13LZ2HB-REC FROM LZ2H-BLANK.                                  
           WRITE P13LZ2HB-REC FROM LZ2H-HEAD03  AFTER 3.                        
           WRITE P13LZ2HB-REC FROM LZ2H-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-A.                        
                                                                                
       010-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       015-PRINT-HEADING-B.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-B.                        
           MOVE WS-PAGE-CNT-B          TO LZ2H-PAGENO-B.                        
           MOVE 'SBF'                  TO LZ2H-SMODE.                           
                                                                                
           WRITE P13LZ2HC-REC FROM LZ2H-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2HC-REC FROM LZ2H-HEAD02B AFTER 1.                        
           WRITE P13LZ2HC-REC FROM LZ2H-BLANK.                                  
           WRITE P13LZ2HC-REC FROM LZ2H-HEAD03  AFTER 3.                        
           WRITE P13LZ2HC-REC FROM LZ2H-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-B.                        
                                                                                
       015-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       020-PRINT-HEADING-C.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-C.                        
           MOVE WS-PAGE-CNT-C          TO LZ2H-PAGENO-C.                        
           MOVE 'SBF'                  TO LZ2H-SMODE.                           
                                                                                
           WRITE P13LZ2HD-REC FROM LZ2H-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2HD-REC FROM LZ2H-HEAD02C AFTER 1.                        
           WRITE P13LZ2HD-REC FROM LZ2H-BLANK.                                  
           WRITE P13LZ2HD-REC FROM LZ2H-HEAD03  AFTER 3.                        
           WRITE P13LZ2HD-REC FROM LZ2H-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-C.                        
                                                                                
       020-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       025-PRINT-HEADING-D.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-D.                        
           MOVE WS-PAGE-CNT-D          TO LZ2H-PAGENO-D.                        
           MOVE 'ROF'                  TO LZ2H-SMODE.                           
                                                                                
           WRITE P13LZ2HE-REC FROM LZ2H-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2HE-REC FROM LZ2H-HEAD02D AFTER 1.                        
           WRITE P13LZ2HE-REC FROM LZ2H-BLANK.                                  
           WRITE P13LZ2HE-REC FROM LZ2H-HEAD03  AFTER 3.                        
           WRITE P13LZ2HE-REC FROM LZ2H-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-D.                        
                                                                                
       025-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       030-PRINT-HEADING-E.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-E.                        
           MOVE WS-PAGE-CNT-E          TO LZ2H-PAGENO-E.                        
           MOVE 'ROF'                  TO LZ2H-SMODE.                           
                                                                                
           WRITE P13LZ2HF-REC FROM LZ2H-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2HF-REC FROM LZ2H-HEAD02E AFTER 1.                        
           WRITE P13LZ2HF-REC FROM LZ2H-BLANK.                                  
           WRITE P13LZ2HF-REC FROM LZ2H-HEAD03  AFTER 3.                        
           WRITE P13LZ2HF-REC FROM LZ2H-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-E.                        
                                                                                
       030-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       050-READ-F730-REC.                                                       
      *--------------------------------------------------------*                
                                                                                
           READ BP13F730 AT END MOVE 'Y' TO EOF-BP13F730                        
                MOVE HIGH-VALUE TO F730-NUM-REGN                                
                GO TO 050-EXIT.                                                 
           ADD 1 TO WS-F730-READ.                                               
                                                                                
                                                                                
       050-EXIT.                                                                
           EXIT.                                                                
      *--------------------------------------------------------*                
       100-READ-F558-REC.                                                       
      *--------------------------------------------------------*                
                                                                                
           READ BP13F558 AT END MOVE 'Y' TO EOF-BP13F558                        
                MOVE HIGH-VALUE TO F558-NUM-REGN                                
                GO TO 100-EXIT.                                                 
           ADD 1 TO WS-F558-READ.                                               
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       200-PROCESS-REC.                                                         
      *--------------------------------------------------------*                
                                                                                
           MOVE ZEROES         TO WS-CNT.                                       
           MOVE 'N'            TO WS-NUM-NTIMER.                                
           MOVE 'N'            TO WS-DEBAR33.                                   
                                                                                
                                                                                
           IF F730-NUM-REGN = F558-NUM-REGN                                     
              ADD 1 TO WS-F730-MATCH                                            
              PERFORM 250-PROCESS-MATCHED   THRU 250-EXIT                       
              MOVE WS-NUM-NTIMER  TO F558-NUM-NTIMER                            
              WRITE P13F558O-REC FROM BP13F558-REC                              
              ADD 1 TO WS-OUTPUT-CNT                                            
              PERFORM 700-READ-BP13K558     THRU 700-EXIT                       
              PERFORM 100-READ-F558-REC     THRU 100-EXIT                       
           ELSE                                                                 
           IF F730-NUM-REGN < F558-NUM-REGN                                     
              ADD 1 TO WS-F558-NOMATCH                                          
              PERFORM 050-READ-F730-REC     THRU 050-EXIT                       
           ELSE                                                                 
              ADD 1 TO WS-F730-NOMATCH                                          
              WRITE P13F558O-REC FROM BP13F558-REC                              
              ADD 1 TO WS-OUTPUT-CNT                                            
              PERFORM 100-READ-F558-REC     THRU 100-EXIT                       
           END-IF.                                                              
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       250-PROCESS-MATCHED.                                                     
      *--------------------------------------------------------*                
                                                                                
                                                                                
           IF F558-NUM-APPLN NOT = 'Y'                                          
              IF F558-CDE-RELATIONSHIP = '20' OR '09'                           
                 CONTINUE                                                       
              ELSE                                                              
                 GO TO 250-EXIT                                                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 10                 
              MOVE SPACES         TO WS-NUM-HDB-REF(WS-CTR)                     
                                     WS-RESALE-CODE(WS-CTR)                     
                                     WS-FILE-SRC(WS-CTR)                        
                                     WS-DIVORCE-CODE(WS-CTR)                    
                                     WS-DEBAR-CODE(WS-CTR)                      
           END-PERFORM.                                                         
                                                                                
           PERFORM 300-CHECK-RSL-DEBAR33 THRU 300-EXIT.                         
           PERFORM 320-CHECK-SMS-HDBREF  THRU 320-EXIT.                         
           PERFORM 330-CHECK-TRF-HDBREF  THRU 330-EXIT.                         
           PERFORM 340-CHECK-MAM-HDBREF  THRU 340-EXIT.                         
           PERFORM 350-CHECK-SLS-HDBREF  THRU 350-EXIT.                         
                                                                                
           IF WS-CNT >= 2                                                       
              MOVE 'Y'       TO WS-NUM-NTIMER                                   
              IF F730-NUM-ALLO-CAT = 'BTO'                                      
                 PERFORM VARYING WS-CTR FROM 1 BY 1                             
                   UNTIL WS-CTR > WS-CNT                                        
                      OR WS-NUM-HDB-REF(WS-CTR) = SPACES                        
                    PERFORM 800-WRITE-REPORT  THRU 800-EXIT                     
                 END-PERFORM                                                    
              ELSE                                                              
                 IF F730-NUM-ALLO-CAT = 'SBF'                                   
                    PERFORM VARYING WS-CTR FROM 1 BY 1                          
                      UNTIL WS-CTR > WS-CNT                                     
                         OR WS-NUM-HDB-REF(WS-CTR) = SPACES                     
                       PERFORM 830-WRITE-REPORT  THRU 830-EXIT                  
                    END-PERFORM                                                 
                 ELSE                                                           
                    IF F730-NUM-ALLO-CAT = 'ROF'                                
                       PERFORM VARYING WS-CTR FROM 1 BY 1                       
                         UNTIL WS-CTR > WS-CNT                                  
                            OR WS-NUM-HDB-REF(WS-CTR) = SPACES                  
                          PERFORM 850-WRITE-REPORT  THRU 850-EXIT               
                       END-PERFORM                                              
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              PERFORM 810-WRITE-TMP         THRU 810-EXIT                       
           ELSE                                                                 
              IF WS-DEBAR33 NOT = 'Y'                                           
                 IF F730-NUM-ALLO-CAT = 'BTO'                                   
                    PERFORM 820-WRITE-REPORT-INVALID THRU 820-EXIT              
                 ELSE                                                           
                    IF F730-NUM-ALLO-CAT = 'SBF'                                
                       PERFORM 840-WRITE-REPORT-INVALID THRU 840-EXIT           
                    ELSE                                                        
                       IF F730-NUM-ALLO-CAT = 'ROF'                             
                          PERFORM 860-WRITE-REPORT-INVALID THRU 860-EXIT        
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       250-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       300-CHECK-RSL-DEBAR33.                                                   
      *--------------------------------------------------------*                
                                                                                
           MOVE ZEROES     TO WS-CTR6.                                          
      *************************************************************             
      ***  FOR RSL CASES, IF NUM-DEBAR6 = '33', TAG AS NTIMER  ****             
      ***  NO NEED TO CHECK OTHER HDB REFS.                    ****             
      *************************************************************             
                                                                                
           IF F558-NUM-DEBARMENT-6 = '33'                                       
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 3               
                   OR F558-RESALE-UNIT(WS-CTR) = SPACES                         
                IF F558-RESALE-UNIT(WS-CTR) NOT = SPACES AND LOW-VALUES         
                   ADD 1 TO WS-CTR6                                             
                   MOVE F558-RESALE-CODE(WS-CTR) TO                             
                                            WS-RESALE-CODE(WS-CTR6)             
                   MOVE F558-RESALE-UNIT(WS-CTR) TO                             
                                            WS-NUM-HDB-REF(WS-CTR6)             
                END-IF                                                          
              END-PERFORM                                                       
              IF F558-NUM-HDB-REF-RSL  NOT = SPACES AND LOW-VALUES              
                 ADD 1 TO WS-CTR6                                               
                 MOVE F558-CDE-FILE-STATUS-RSL TO                               
                                            WS-RESALE-CODE(WS-CTR6)             
                 MOVE F558-NUM-HDB-REF-RSL     TO                               
                                            WS-NUM-HDB-REF(WS-CTR6)             
              END-IF                                                            
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > WS-CTR6         
                   OR WS-DEBAR33 = 'Y'                                          
                IF WS-RESALE-CODE(WS-CTR) = 'SD ' OR '2L ' OR '2N ' OR          
                                            '2P ' OR '2D ' OR '3D ' OR          
                                            'HD ' OR 'LD ' OR 'PD ' OR          
                                            'SAA' OR 'SAN' OR 'SAP' OR          
                                            'SAB' OR 'SSD' OR 'SDD' OR          
                                            'GSD' OR 'GDD' OR 'RBD' OR          
                                            'RMD' OR 'RB2' OR 'RM2'             
                   MOVE 'Y'              TO WS-DEBAR33                          
                                            WS-NUM-NTIMER                       
                   MOVE F558-NUM-DEBARMENT-6 TO WS-DEBAR-CODE(WS-CTR)           
                   MOVE 'RSL'                TO WS-FILE-SRC(WS-CTR)             
                END-IF                                                          
                IF WS-DEBAR33  = 'Y'                                            
                   IF F730-NUM-ALLO-CAT = 'BTO'                                 
                      PERFORM 800-WRITE-REPORT  THRU 800-EXIT                   
                   ELSE                                                         
                      IF F730-NUM-ALLO-CAT = 'SBF'                              
                         PERFORM 830-WRITE-REPORT  THRU 830-EXIT                
                      ELSE                                                      
                         IF F730-NUM-ALLO-CAT = 'ROF'                           
                            PERFORM 850-WRITE-REPORT  THRU 850-EXIT             
                         END-IF                                                 
                      END-IF                                                    
                   END-IF                                                       
                   PERFORM 810-WRITE-TMP         THRU 810-EXIT                  
                END-IF                                                          
              END-PERFORM                                                       
           ELSE                                                                 
              PERFORM 310-CHECK-RSL-HDBREF THRU 310-EXIT                        
           END-IF.                                                              
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       310-CHECK-RSL-HDBREF.                                                    
      *--------------------------------------------------------*                
           IF F558-CDE-FILE-STATUS-RSL =  'BN ' OR 'PP ' OR                     
                                 'SA ' OR 'AN ' OR 'AP ' OR 'OM ' OR            
                                 'CM ' OR 'BCM' OR 'BOM' OR 'BNA' OR            
                                 'GNA' OR 'GOM' OR 'GSR' OR 'MNA' OR            
                                 'MOM' OR 'SAM' OR 'VNA' OR 'VOM' OR            
                                 'SNA' OR 'OMS' OR 'FGR' OR 'GPR' OR            
                                 'REM' OR 'GHR' OR 'NG '                        
              GO TO 310-EXIT                                                    
           END-IF.                                                              
                                                                                
           IF F558-NUM-HDB-REF-RSL(1:9) NOT = SPACES AND LOW-VALUES AND         
                                            WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
              ADD 1                         TO WS-CNT                           
              MOVE F558-NUM-HDB-REF-RSL     TO WS-NUM-HDB-REF(WS-CNT)           
              MOVE F558-CDE-FILE-STATUS-RSL TO WS-RESALE-CODE(WS-CNT)           
              MOVE 'RSL'                    TO WS-FILE-SRC(WS-CNT)              
              MOVE F558-NUM-DEBARMENT-6     TO WS-DEBAR-CODE(WS-CNT)            
              MOVE SPACES                   TO WS-DIVORCE-CODE(WS-CNT)          
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 3 OR               
              F558-RESALE-UNIT(WS-CTR) = SPACES                                 
              IF F558-RESALE-UNIT(WS-CTR)(1:9) NOT =                            
                                            SPACES AND LOW-VALUES AND           
                                            WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
                 ADD 1                      TO WS-CNT                           
                 MOVE F558-RESALE-UNIT(WS-CTR) TO WS-NUM-HDB-REF(WS-CNT)        
                 MOVE F558-RESALE-CODE(WS-CTR) TO WS-RESALE-CODE(WS-CNT)        
                 MOVE 'RSL'                    TO WS-FILE-SRC(WS-CNT)           
                 MOVE F558-NUM-DEBARMENT-6     TO WS-DEBAR-CODE(WS-CNT)         
                 MOVE SPACES                TO WS-DIVORCE-CODE(WS-CNT)          
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       310-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       320-CHECK-SMS-HDBREF.                                                    
      *--------------------------------------------------------*                
                                                                                
      *** EXCLUDE OPEN MARKET FLATS ***                                         
                                                                                
           IF F558-CDE-FILE-STATUS-SMS = 'OM'                                   
              GO TO 320-EXIT                                                    
           END-IF.                                                              
                                                                                
           IF F558-NUM-HDB-REF-SMS(1:9) NOT = SPACES AND LOW-VALUES AND         
                                            WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
              ADD 1                         TO WS-CNT                           
              MOVE F558-NUM-HDB-REF-SMS     TO WS-NUM-HDB-REF(WS-CNT)           
              MOVE F558-CDE-SALES-TYPE-SMS  TO WS-RESALE-CODE(WS-CNT)           
              MOVE 'SMS'                    TO WS-FILE-SRC(WS-CNT)              
              MOVE F558-NUM-DEBARMENT-4     TO WS-DEBAR-CODE(WS-CNT)            
              MOVE SPACES                   TO WS-DIVORCE-CODE(WS-CNT)          
           END-IF.                                                              
                                                                                
           IF F558-MULTIPLE-FLAT-SMS(1:9) NOT = SPACES AND LOW-VALUES           
                                        AND WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
              ADD 1                      TO WS-CNT                              
              MOVE F558-MULTIPLE-FLAT-SMS   TO WS-NUM-HDB-REF(WS-CNT)           
              MOVE F558-MULTIPLE-STY-SMS    TO WS-RESALE-CODE(WS-CNT)           
              MOVE 'SMS'                    TO WS-FILE-SRC(WS-CNT)              
              MOVE F558-NUM-DEBARMENT-4     TO WS-DEBAR-CODE(WS-CNT)            
              MOVE SPACES                   TO WS-DIVORCE-CODE(WS-CNT)          
           END-IF.                                                              
                                                                                
       320-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       330-CHECK-TRF-HDBREF.                                                    
      *--------------------------------------------------------*                
                                                                                
      *************************************************************             
      ***  IF SALES TYPE IS NOT = 7, 7J, 8A, 8B, 8E => DP FLATS ***             
      ***  NO NEED TO CHECK FOR DEBARMENT4 CODE                 ***             
      *************************************************************             
                                                                                
           IF (F558-NUM-SALES-TYPE-TR NOT = '7 ' AND '7J' AND '8A' AND          
                                            '7C' AND '8B' AND '8E' AND          
                                            '8L' AND '8M' AND '8N' AND          
                                            '8R' AND '8S' AND '8T') OR          
              (F558-MULTIPLE-STY-TRF  NOT = '7 ' AND '7J' AND '8A' AND          
                                            '7C' AND '8B' AND '8E' AND          
                                            '8L' AND '8M' AND '8N' AND          
                                            '8R' AND '8S' AND '8T')             
              CONTINUE                                                          
           ELSE                                                                 
              IF F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66' OR                 
                                        'GA' OR 'GB'                            
                 IF (F558-NUM-HDB-REF-DEBAR(1:9) =                              
                                           F558-NUM-HDB-REF-TR(1:9)) OR         
                    (F558-NUM-HDB-REF-DEBAR(1:9) =                              
                                           F558-MULTIPLE-FLAT-TRF(1:9))         
                    CONTINUE                                                    
                 ELSE                                                           
                    GO TO 330-EXIT                                              
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F558-NUM-HDB-REF-TR(1:9) NOT = SPACES AND LOW-VALUES AND          
                                            WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
              ADD 1                         TO WS-CNT                           
              MOVE F558-NUM-HDB-REF-TR      TO WS-NUM-HDB-REF(WS-CNT)           
              MOVE F558-NUM-SALES-TYPE-TR   TO WS-RESALE-CODE(WS-CNT)           
              MOVE 'TRF'                    TO WS-FILE-SRC(WS-CNT)              
              MOVE F558-NUM-DEBARMENT-4     TO WS-DEBAR-CODE(WS-CNT)            
              MOVE F558-NUM-DIVORCE-TR      TO WS-DIVORCE-CODE(WS-CNT)          
           END-IF.                                                              
                                                                                
           IF F558-MULTIPLE-FLAT-TRF(1:9) NOT = SPACES AND LOW-VALUES           
                                        AND WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
              ADD 1                         TO WS-CNT                           
              MOVE F558-MULTIPLE-FLAT-TRF   TO WS-NUM-HDB-REF(WS-CNT)           
              MOVE F558-MULTIPLE-STY-TRF    TO WS-RESALE-CODE(WS-CNT)           
              MOVE 'TRF'                    TO WS-FILE-SRC(WS-CNT)              
              MOVE F558-NUM-DEBARMENT-4     TO WS-DEBAR-CODE(WS-CNT)            
              MOVE F558-MULTIPLE-DIVORCE-TRF TO WS-DIVORCE-CODE(WS-CNT)         
           END-IF.                                                              
                                                                                
                                                                                
       330-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       340-CHECK-MAM-HDBREF.                                                    
      *--------------------------------------------------------*                
                                                                                
      *************************************************************             
      ***  IF SALES TYPE IS NOT = 7, 7J, 8A, 8B, 8E => DP FLATS ***             
      ***  NO NEED TO CHECK FOR DEBARMENT4 CODE                 ***             
      *************************************************************             
                                                                                
           IF F558-NUM-SALES-TYPE-MAM NOT = '7 ' AND '7J' AND '8A' AND          
                                            '7C' AND '8B' AND '8E' AND          
                                            '8L' AND '8M' AND '8N' AND          
                                            '8R' AND '8S' AND '8T'              
              CONTINUE                                                          
           ELSE                                                                 
              IF F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66' OR                 
                                        'GA' OR 'GB'                            
                 IF F558-NUM-HDB-REF-DEBAR(1:9) =                               
                                          F558-NUM-HDB-REF-MAM(1:9)             
                    CONTINUE                                                    
                 ELSE                                                           
                    GO TO 340-EXIT                                              
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F558-NUM-HDB-REF-MAM(1:9) NOT = SPACES AND LOW-VALUES AND         
                                            WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
              ADD 1                         TO WS-CNT                           
              MOVE F558-NUM-HDB-REF-MAM     TO WS-NUM-HDB-REF(WS-CNT)           
              MOVE F558-NUM-SALES-TYPE-MAM  TO WS-RESALE-CODE(WS-CNT)           
              MOVE 'MAM'                    TO WS-FILE-SRC(WS-CNT)              
              MOVE F558-NUM-DEBARMENT-4     TO WS-DEBAR-CODE(WS-CNT)            
              MOVE SPACES                   TO WS-DIVORCE-CODE(WS-CNT)          
           END-IF.                                                              
                                                                                
                                                                                
       340-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       350-CHECK-SLS-HDBREF.                                                    
      *--------------------------------------------------------*                
                                                                                
      *************************************************************             
      ***  IF SALES TYPE IS NOT = 7, 7J, 8A, 8B, 8E => DP FLATS ***             
      ***  NO NEED TO CHECK FOR DEBARMENT4 CODE                 ***             
      *************************************************************             
                                                                                
           IF F558-NUM-SALES-TYPE-SLS NOT = '7 ' AND '7J' AND '8A' AND          
                                            '7C' AND '8B' AND '8E' AND          
                                            '8L' AND '8M' AND '8N' AND          
                                            '8R' AND '8S' AND '8T'              
              CONTINUE                                                          
           ELSE                                                                 
              IF F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66' OR                 
                                        'GA' OR 'GB'                            
                 IF F558-NUM-HDB-REF-DEBAR(1:9) =                               
                                          F558-NUM-HDB-REF-SLS(1:9)             
                    CONTINUE                                                    
                 ELSE                                                           
                    GO TO 350-EXIT                                              
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
                                                                                
           IF F558-NUM-HDB-REF-SLS(1:9) NOT = SPACES AND LOW-VALUES AND         
                                            WS-NUM-HDB-REF(1)(1:9) AND          
                                            WS-NUM-HDB-REF(2)(1:9) AND          
                                            WS-NUM-HDB-REF(3)(1:9) AND          
                                            WS-NUM-HDB-REF(4)(1:9) AND          
                                            WS-NUM-HDB-REF(5)(1:9) AND          
                                            WS-NUM-HDB-REF(6)(1:9) AND          
                                            WS-NUM-HDB-REF(7)(1:9) AND          
                                            WS-NUM-HDB-REF(8)(1:9) AND          
                                            WS-NUM-HDB-REF(9)(1:9) AND          
                                            WS-NUM-HDB-REF(10)(1:9)             
              ADD 1                         TO WS-CNT                           
              MOVE F558-NUM-HDB-REF-SLS     TO WS-NUM-HDB-REF(WS-CNT)           
              MOVE F558-NUM-SALES-TYPE-SLS  TO WS-RESALE-CODE(WS-CNT)           
              MOVE 'SLS'                    TO WS-FILE-SRC(WS-CNT)              
              MOVE F558-NUM-DEBARMENT-4     TO WS-DEBAR-CODE(WS-CNT)            
              MOVE SPACES                   TO WS-DIVORCE-CODE(WS-CNT)          
           END-IF.                                                              
                                                                                
                                                                                
       350-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       700-READ-BP13K558.                                                       
      *--------------------------------------------------------*                
                                                                                
           MOVE SPACES                   TO K558-KEY-FLD.                       
           MOVE F558-NUM-REGN            TO K558-NUM-REGN.                      
           MOVE F558-NUM-NRIC            TO K558-NUM-NRIC.                      
                                                                                
           READ BP13K558.                                                       
                                                                                
           EVALUATE BP13K558-STATUS                                             
              WHEN 00                                                           
                 MOVE WS-NUM-NTIMER      TO K558-NUM-NTIMER                     
                 PERFORM 750-REWRITE-BP13K558  THRU 750-EXIT                    
                 ADD 1 TO K558-FND-CNT                                          
             WHEN 23                                                            
                 ADD 1 TO K558-NFND-CNT                                         
                 DISPLAY 'RECORD NOT FOUND IN BP13K558: ' K558-KEY-FLD          
             WHEN OTHER                                                         
                 DISPLAY 'ERROR WITH READ OF BP13K558. STATUS IS '              
                      BP13K558-STATUS                                           
                 MOVE BP13K558-STATUS              TO RETURN-CODE               
                 PERFORM 900-CLOSE-ROUTINE        THRU 900-EXIT                 
             END-EVALUATE.                                                      
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       750-REWRITE-BP13K558.                                                    
      *--------------------------------------------------------*                
                                                                                
           REWRITE BP13K558-REC.                                                
                                                                                
           EVALUATE BP13K558-STATUS                                             
              WHEN 00                                                           
                 ADD 1 TO WS-K558-UPD                                           
              WHEN OTHER                                                        
                 DISPLAY 'ERROR WITH UPDATING OF BP13K558. STATUS IS '          
                     BP13K558-STATUS                                            
                 MOVE BP13K558-STATUS             TO RETURN-CODE                
                 PERFORM 900-CLOSE-ROUTINE        THRU 900-EXIT                 
           END-EVALUATE.                                                        
                                                                                
       750-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       800-WRITE-REPORT.                                                        
      *--------------------------------------------------------*                
      *** NTIMERS - BTO ***                                                     
                                                                                
           INITIALIZE                         P13LZ2HA-REC                      
                                              LZ2H-DETAIL.                      
                                                                                
           IF WS-LZ2HA-HDR = 'N'                                                
              MOVE 'Y'             TO WS-LZ2HA-HDR                              
              PERFORM 005-PRINT-HEADING THRU 005-EXIT                           
           ELSE                                                                 
              IF WS-LINE-CNT > 59                                               
                 MOVE ZEROES       TO WS-LINE-CNT                               
                 PERFORM 005-PRINT-HEADING THRU 005-EXIT                        
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CTR = 1 OR WS-DEBAR33 = 'Y'                                    
              ADD 1                       TO WS-TOTAL                           
              MOVE WS-TOTAL               TO LZ2H-TOTAL                         
              MOVE F558-NUM-REGN          TO LZ2H-NUM-REGN                      
              MOVE F730-NUM-ALLO-CAT      TO LZ2H-NUM-SMODE                     
              MOVE F558-NUM-NRIC          TO LZ2H-NUM-NRIC1                     
              MOVE F558-NUM-ZONE-NT-SOC   TO LZ2H-NUM-NT                        
              MOVE F558-NUM-FLAT-TY-SOC   TO LZ2H-NUM-FT                        
              MOVE F558-CDE-RELATIONSHIP  TO LZ2H-RELN                          
           END-IF.                                                              
                                                                                
           MOVE WS-NUM-HDB-REF(WS-CTR)    TO LZ2H-HDB-REF.                      
           MOVE WS-RESALE-CODE(WS-CTR)    TO LZ2H-RESALE-STATUS.                
           MOVE WS-FILE-SRC(WS-CTR)       TO LZ2H-CODE.                         
           MOVE WS-DIVORCE-CODE(WS-CTR)   TO LZ2H-DIVORCE.                      
           MOVE WS-DEBAR-CODE(WS-CTR)     TO LZ2H-DEBAR.                        
                                                                                
           WRITE P13LZ2HA-REC             FROM LZ2H-DETAIL.                     
           ADD 1                          TO WS-LINE-CNT.                       
           MOVE SPACES                    TO P13LZ2HA-REC.                      
           INITIALIZE                        P13LZ2HA-REC.                      
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       810-WRITE-TMP.                                                           
      *--------------------------------------------------------*                
                                                                                
           MOVE SPACES                 TO BP13TMP-REC.                          
           INITIALIZE                     BP13TMP-REC.                          
                                                                                
           MOVE F558-NUM-REGN          TO TMP-NUM-REGN.                         
           MOVE F558-NUM-NRIC          TO TMP-NUM-NRIC.                         
           MOVE F730-NUM-ALLO-CAT      TO TMP-NUM-ALLO-CAT.                     
                                                                                
           WRITE BP13TMP-REC.                                                   
           ADD 1 TO WS-TMP-WRITE-CNT.                                           
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       820-WRITE-REPORT-INVALID.                                                
      *--------------------------------------------------------*                
      *** NOT NTIMERS - BTO ***                                                 
                                                                                
           INITIALIZE                         P13LZ2HB-REC                      
                                              LZ2H-DETAIL.                      
                                                                                
           IF WS-LZ2HB-HDR = 'N'                                                
              MOVE 'Y'             TO WS-LZ2HB-HDR                              
              PERFORM 010-PRINT-HEADING-A THRU 010-EXIT                         
           ELSE                                                                 
              IF WS-LINE-CNT-A > 59                                             
                 MOVE ZEROES       TO WS-LINE-CNT-A                             
                 PERFORM 010-PRINT-HEADING-A THRU 010-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1                          TO WS-TOTAL-A.                        
           MOVE WS-TOTAL-A                TO LZ2H-TOTAL.                        
           MOVE F558-NUM-REGN             TO LZ2H-NUM-REGN.                     
           MOVE F730-NUM-ALLO-CAT         TO LZ2H-NUM-SMODE.                    
           MOVE F558-NUM-NRIC             TO LZ2H-NUM-NRIC1.                    
           MOVE F558-NUM-ZONE-NT-SOC      TO LZ2H-NUM-NT.                       
           MOVE F558-NUM-FLAT-TY-SOC      TO LZ2H-NUM-FT.                       
           MOVE F558-CDE-RELATIONSHIP     TO LZ2H-RELN.                         
                                                                                
           MOVE WS-NUM-HDB-REF(WS-CNT)    TO LZ2H-HDB-REF.                      
           MOVE WS-RESALE-CODE(WS-CNT)    TO LZ2H-RESALE-STATUS.                
           MOVE WS-FILE-SRC(WS-CNT)       TO LZ2H-CODE.                         
           MOVE WS-DIVORCE-CODE(WS-CNT)   TO LZ2H-DIVORCE.                      
           MOVE WS-DEBAR-CODE(WS-CNT)     TO LZ2H-DEBAR.                        
                                                                                
           IF WS-CNT = 0                                                        
              IF F558-NUM-HDB-REF-RSL NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-RSL      TO LZ2H-HDB-REF                 
                 MOVE F558-CDE-FILE-STATUS-RSL  TO LZ2H-RESALE-STATUS           
                 MOVE 'RSL'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-SMS NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-SMS      TO LZ2H-HDB-REF                 
                 MOVE F558-CDE-SALES-TYPE-SMS   TO LZ2H-RESALE-STATUS           
                 MOVE 'SMS'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-TR NOT = SPACES AND LOW-VALUES                
                 MOVE F558-NUM-HDB-REF-TR       TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-TR    TO LZ2H-RESALE-STATUS           
                 MOVE 'TRF'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-MAM NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-MAM      TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-MAM   TO LZ2H-RESALE-STATUS           
                 MOVE 'MAM'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-SLS NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-SLS      TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-SLS   TO LZ2H-RESALE-STATUS           
                 MOVE 'SLS'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
                 MOVE SPACES                    TO LZ2H-HDB-REF                 
                                                   LZ2H-RESALE-STATUS           
                                                   LZ2H-CODE                    
                                                   LZ2H-DIVORCE                 
                                                   LZ2H-DEBAR                   
           END-IF.                                                              
                                                                                
           WRITE P13LZ2HB-REC             FROM LZ2H-DETAIL.                     
           ADD 1                          TO WS-LINE-CNT-A.                     
           MOVE SPACES                    TO P13LZ2HB-REC.                      
           INITIALIZE                        P13LZ2HB-REC.                      
                                                                                
       820-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       830-WRITE-REPORT.                                                        
      *--------------------------------------------------------*                
      *** NTIMERS - SBF ***                                                     
                                                                                
           INITIALIZE                         P13LZ2HC-REC                      
                                              LZ2H-DETAIL.                      
                                                                                
           IF WS-LZ2HC-HDR = 'N'                                                
              MOVE 'Y'             TO WS-LZ2HC-HDR                              
              PERFORM 015-PRINT-HEADING-B THRU 015-EXIT                         
           ELSE                                                                 
              IF WS-LINE-CNT-B > 59                                             
                 MOVE ZEROES       TO WS-LINE-CNT-B                             
                 PERFORM 015-PRINT-HEADING-B THRU 015-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CTR = 1 OR WS-DEBAR33 = 'Y'                                    
              ADD 1                       TO WS-TOTAL-B                         
              MOVE WS-TOTAL-B             TO LZ2H-TOTAL                         
              MOVE F558-NUM-REGN          TO LZ2H-NUM-REGN                      
              MOVE F730-NUM-ALLO-CAT      TO LZ2H-NUM-SMODE                     
              MOVE F558-NUM-NRIC          TO LZ2H-NUM-NRIC1                     
              MOVE F558-NUM-ZONE-NT-SOC   TO LZ2H-NUM-NT                        
              MOVE F558-NUM-FLAT-TY-SOC   TO LZ2H-NUM-FT                        
              MOVE F558-CDE-RELATIONSHIP  TO LZ2H-RELN                          
           END-IF.                                                              
                                                                                
           MOVE WS-NUM-HDB-REF(WS-CTR)    TO LZ2H-HDB-REF.                      
           MOVE WS-RESALE-CODE(WS-CTR)    TO LZ2H-RESALE-STATUS.                
           MOVE WS-FILE-SRC(WS-CTR)       TO LZ2H-CODE.                         
           MOVE WS-DIVORCE-CODE(WS-CTR)   TO LZ2H-DIVORCE.                      
           MOVE WS-DEBAR-CODE(WS-CTR)     TO LZ2H-DEBAR.                        
                                                                                
           WRITE P13LZ2HC-REC             FROM LZ2H-DETAIL.                     
           ADD 1                          TO WS-LINE-CNT-B.                     
           MOVE SPACES                    TO P13LZ2HC-REC.                      
           INITIALIZE                        P13LZ2HC-REC.                      
                                                                                
       830-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       840-WRITE-REPORT-INVALID.                                                
      *--------------------------------------------------------*                
      *** NOT NTIMERS - SBF ***                                                 
                                                                                
           INITIALIZE                         P13LZ2HD-REC                      
                                              LZ2H-DETAIL.                      
                                                                                
           IF WS-LZ2HD-HDR = 'N'                                                
              MOVE 'Y'             TO WS-LZ2HD-HDR                              
              PERFORM 020-PRINT-HEADING-C THRU 020-EXIT                         
           ELSE                                                                 
              IF WS-LINE-CNT-C > 59                                             
                 MOVE ZEROES       TO WS-LINE-CNT-C                             
                 PERFORM 020-PRINT-HEADING-C THRU 020-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1                          TO WS-TOTAL-C.                        
           MOVE WS-TOTAL-C                TO LZ2H-TOTAL.                        
           MOVE F558-NUM-REGN             TO LZ2H-NUM-REGN.                     
           MOVE F730-NUM-ALLO-CAT         TO LZ2H-NUM-SMODE.                    
           MOVE F558-NUM-NRIC             TO LZ2H-NUM-NRIC1.                    
           MOVE F558-NUM-ZONE-NT-SOC      TO LZ2H-NUM-NT.                       
           MOVE F558-NUM-FLAT-TY-SOC      TO LZ2H-NUM-FT.                       
           MOVE F558-CDE-RELATIONSHIP     TO LZ2H-RELN.                         
                                                                                
           MOVE WS-NUM-HDB-REF(WS-CNT)    TO LZ2H-HDB-REF.                      
           MOVE WS-RESALE-CODE(WS-CNT)    TO LZ2H-RESALE-STATUS.                
           MOVE WS-FILE-SRC(WS-CNT)       TO LZ2H-CODE.                         
           MOVE WS-DIVORCE-CODE(WS-CNT)   TO LZ2H-DIVORCE.                      
           MOVE WS-DEBAR-CODE(WS-CNT)     TO LZ2H-DEBAR.                        
                                                                                
           IF WS-CNT = 0                                                        
              IF F558-NUM-HDB-REF-RSL NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-RSL      TO LZ2H-HDB-REF                 
                 MOVE F558-CDE-FILE-STATUS-RSL  TO LZ2H-RESALE-STATUS           
                 MOVE 'RSL'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-SMS NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-SMS      TO LZ2H-HDB-REF                 
                 MOVE F558-CDE-SALES-TYPE-SMS   TO LZ2H-RESALE-STATUS           
                 MOVE 'SMS'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-TR NOT = SPACES AND LOW-VALUES                
                 MOVE F558-NUM-HDB-REF-TR       TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-TR    TO LZ2H-RESALE-STATUS           
                 MOVE 'TRF'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-MAM NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-MAM      TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-MAM   TO LZ2H-RESALE-STATUS           
                 MOVE 'MAM'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-SLS NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-SLS      TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-SLS   TO LZ2H-RESALE-STATUS           
                 MOVE 'SLS'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
                 MOVE SPACES                    TO LZ2H-HDB-REF                 
                                                   LZ2H-RESALE-STATUS           
                                                   LZ2H-CODE                    
                                                   LZ2H-DIVORCE                 
                                                   LZ2H-DEBAR                   
           END-IF.                                                              
                                                                                
           WRITE P13LZ2HD-REC             FROM LZ2H-DETAIL.                     
           ADD 1                          TO WS-LINE-CNT-C.                     
           MOVE SPACES                    TO P13LZ2HD-REC.                      
           INITIALIZE                        P13LZ2HD-REC.                      
                                                                                
       840-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       850-WRITE-REPORT.                                                        
      *--------------------------------------------------------*                
      *** NTIMERS - ROF ***                                                     
                                                                                
           INITIALIZE                         P13LZ2HE-REC                      
                                              LZ2H-DETAIL.                      
                                                                                
           IF WS-LZ2HE-HDR = 'N'                                                
              MOVE 'Y'             TO WS-LZ2HE-HDR                              
              PERFORM 025-PRINT-HEADING-D THRU 025-EXIT                         
           ELSE                                                                 
              IF WS-LINE-CNT-D > 59                                             
                 MOVE ZEROES       TO WS-LINE-CNT-D                             
                 PERFORM 025-PRINT-HEADING-D THRU 025-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CTR = 1 OR WS-DEBAR33 = 'Y'                                    
              ADD 1                       TO WS-TOTAL-D                         
              MOVE WS-TOTAL-D             TO LZ2H-TOTAL                         
              MOVE F558-NUM-REGN          TO LZ2H-NUM-REGN                      
              MOVE F730-NUM-ALLO-CAT      TO LZ2H-NUM-SMODE                     
              MOVE F558-NUM-NRIC          TO LZ2H-NUM-NRIC1                     
              MOVE F558-NUM-ZONE-NT-SOC   TO LZ2H-NUM-NT                        
              MOVE F558-NUM-FLAT-TY-SOC   TO LZ2H-NUM-FT                        
              MOVE F558-CDE-RELATIONSHIP  TO LZ2H-RELN                          
           END-IF.                                                              
                                                                                
           MOVE WS-NUM-HDB-REF(WS-CTR)    TO LZ2H-HDB-REF.                      
           MOVE WS-RESALE-CODE(WS-CTR)    TO LZ2H-RESALE-STATUS.                
           MOVE WS-FILE-SRC(WS-CTR)       TO LZ2H-CODE.                         
           MOVE WS-DIVORCE-CODE(WS-CTR)   TO LZ2H-DIVORCE.                      
           MOVE WS-DEBAR-CODE(WS-CTR)     TO LZ2H-DEBAR.                        
                                                                                
           WRITE P13LZ2HE-REC             FROM LZ2H-DETAIL.                     
           ADD 1                          TO WS-LINE-CNT-D.                     
           MOVE SPACES                    TO P13LZ2HE-REC.                      
           INITIALIZE                        P13LZ2HE-REC.                      
                                                                                
       850-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       860-WRITE-REPORT-INVALID.                                                
      *--------------------------------------------------------*                
      *** NOT NTIMERS - ROF ***                                                 
                                                                                
           INITIALIZE                         P13LZ2HF-REC                      
                                              LZ2H-DETAIL.                      
                                                                                
           IF WS-LZ2HF-HDR = 'N'                                                
              MOVE 'Y'             TO WS-LZ2HF-HDR                              
              PERFORM 030-PRINT-HEADING-E THRU 030-EXIT                         
           ELSE                                                                 
              IF WS-LINE-CNT-E > 59                                             
                 MOVE ZEROES       TO WS-LINE-CNT-E                             
                 PERFORM 030-PRINT-HEADING-E THRU 030-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1                          TO WS-TOTAL-E.                        
           MOVE WS-TOTAL-E                TO LZ2H-TOTAL.                        
           MOVE F558-NUM-REGN             TO LZ2H-NUM-REGN.                     
           MOVE F730-NUM-ALLO-CAT         TO LZ2H-NUM-SMODE.                    
           MOVE F558-NUM-NRIC             TO LZ2H-NUM-NRIC1.                    
           MOVE F558-NUM-ZONE-NT-SOC      TO LZ2H-NUM-NT.                       
           MOVE F558-NUM-FLAT-TY-SOC      TO LZ2H-NUM-FT.                       
           MOVE F558-CDE-RELATIONSHIP     TO LZ2H-RELN.                         
                                                                                
           MOVE WS-NUM-HDB-REF(WS-CNT)    TO LZ2H-HDB-REF.                      
           MOVE WS-RESALE-CODE(WS-CNT)    TO LZ2H-RESALE-STATUS.                
           MOVE WS-FILE-SRC(WS-CNT)       TO LZ2H-CODE.                         
           MOVE WS-DIVORCE-CODE(WS-CNT)   TO LZ2H-DIVORCE.                      
           MOVE WS-DEBAR-CODE(WS-CNT)     TO LZ2H-DEBAR.                        
                                                                                
           IF WS-CNT = 0                                                        
              IF F558-NUM-HDB-REF-RSL NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-RSL      TO LZ2H-HDB-REF                 
                 MOVE F558-CDE-FILE-STATUS-RSL  TO LZ2H-RESALE-STATUS           
                 MOVE 'RSL'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-SMS NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-SMS      TO LZ2H-HDB-REF                 
                 MOVE F558-CDE-SALES-TYPE-SMS   TO LZ2H-RESALE-STATUS           
                 MOVE 'SMS'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-TR NOT = SPACES AND LOW-VALUES                
                 MOVE F558-NUM-HDB-REF-TR       TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-TR    TO LZ2H-RESALE-STATUS           
                 MOVE 'TRF'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-MAM NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-MAM      TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-MAM   TO LZ2H-RESALE-STATUS           
                 MOVE 'MAM'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
              IF F558-NUM-HDB-REF-SLS NOT = SPACES AND LOW-VALUES               
                 MOVE F558-NUM-HDB-REF-SLS      TO LZ2H-HDB-REF                 
                 MOVE F558-NUM-SALES-TYPE-SLS   TO LZ2H-RESALE-STATUS           
                 MOVE 'SLS'                     TO LZ2H-CODE                    
                 MOVE SPACES                    TO LZ2H-DIVORCE                 
                 MOVE SPACES                    TO LZ2H-DEBAR                   
              ELSE                                                              
                 MOVE SPACES                    TO LZ2H-HDB-REF                 
                                                   LZ2H-RESALE-STATUS           
                                                   LZ2H-CODE                    
                                                   LZ2H-DIVORCE                 
                                                   LZ2H-DEBAR                   
           END-IF.                                                              
                                                                                
           WRITE P13LZ2HF-REC             FROM LZ2H-DETAIL.                     
           ADD 1                          TO WS-LINE-CNT-E.                     
           MOVE SPACES                    TO P13LZ2HF-REC.                      
           INITIALIZE                        P13LZ2HF-REC.                      
                                                                                
       860-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       900-CLOSE-ROUTINE.                                                       
      *--------------------------------------------------------*                
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY 'BP13CZ2H                 CURR-DATE : ' WS-DATE.             
           DISPLAY 'REPORT ON MULTIPLE DP FLATS'.                               
           DISPLAY '*-----------------------------------------------*'.         
           DISPLAY 'NO OF RECORDS READ FROM F558   ' WS-F558-READ.              
           DISPLAY 'NO OF RECORDS READ FROM F730   ' WS-F730-READ.              
           DISPLAY 'NO OF RECORDS OUTPUT BP13F558  ' WS-OUTPUT-CNT.             
           DISPLAY 'NO OF RECORDS FND IN BP13K558  ' K558-FND-CNT.              
           DISPLAY 'NO OF RECORDS NFND IN BP13K558 ' K558-NFND-CNT.             
           DISPLAY 'NO OF RECORDS UPDATED BP13K558 ' WS-K558-UPD.               
           DISPLAY 'NO OF RECORDS MATCHED W/ F730  ' WS-F730-MATCH.             
           DISPLAY 'NO OF RECORDS NOT MTCH W/ F730 ' WS-F730-NOMATCH.           
           DISPLAY 'NO OF RECORDS NOT MTCH W/ F558 ' WS-F558-NOMATCH.           
           DISPLAY 'NO OF LZ2HA RECORDS WRITTEN    ' WS-TOTAL.                  
           DISPLAY 'NO OF LZ2HB RECORDS WRITTEN    ' WS-TOTAL-A.                
           DISPLAY 'NO OF LZ2HC RECORDS WRITTEN    ' WS-TOTAL-B.                
           DISPLAY 'NO OF LZ2HD RECORDS WRITTEN    ' WS-TOTAL-C.                
           DISPLAY 'NO OF LZ2HE RECORDS WRITTEN    ' WS-TOTAL-D.                
           DISPLAY 'NO OF LZ2HF RECORDS WRITTEN    ' WS-TOTAL-E.                
           DISPLAY 'NO OF TMP  RECORDS WRITTEN     ' WS-TMP-WRITE-CNT.          
                                                                                
           CLOSE P13F558O                                                       
                 BP13F558                                                       
                 BP13F730                                                       
                 BP13K558                                                       
                 BP13TMP                                                        
                 P13LZ2HA                                                       
                 P13LZ2HB                                                       
                 P13LZ2HC                                                       
                 P13LZ2HD                                                       
                 P13LZ2HE                                                       
                 P13LZ2HF.                                                      
                                                                                
           IF BP13K558-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING BP13K558 (' BP13K558-STATUS ')'            
              MOVE BP13K558-STATUS           TO RETURN-CODE                     
              GO TO 900-CLOSE-ROUTINE                                           
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
