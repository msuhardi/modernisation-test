      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C348.                                                 
      *AUTHOR.        MALC.                                                     
      *DATE-WRITTEN.  14/02/2003.                                               
                                                                                
      *---------------------------------------------------------------*         
      *                                                               *         
      *    OBJECTIVE  :                                               *         
      *        1.  TO READ RESALE CPFIBG FILE TO UPDATE               *         
      *            CPF WITHDRAWAL FOR BANK ORIGINATION CASES.         *         
      *                                                               *         
      *     INPUT FILES:                                              *         
      *           1. BB24F04A (CPFIBG FILE)                           *         
      *                                                               *         
      *     INPUT/OUTPUT FILE:                                        *         
      *           2. BP13K671 (BANK ORIGINATION CPF WITHDRAWAL)       *         
      *           3. BP13K110 (FIS FILE)                              *         
      *           4. BP13L348 (REPORT)                                *         
      *---------------------------------------------------------------*         
      * CHG-NO  BY   ON        DESCRIPTION                            *         
      *=======  ==== ======= =========================================*         
      *BP132291 MALC 1402203 NEW PROGRAM                              *         
      *BP132347 SK   300503  WRITE TO BP13F121, BP13F120              *         
      *BP132526 SK   180604  INCREASE BP13K671 TO 3000                *         
      *BP132526 SK   020804  BYPASS SUBTRANSFER CASES                 *         
      *---------------------------------------------------------------*         
                                                                                
      *-----------------------*                                                 
       ENVIRONMENT DIVISION.                                                    
      *-----------------------*                                                 
       CONFIGURATION SECTION.                                                   
      *-----------------------*                                                 
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BB24F04A ASSIGN TO BB24F04A.                                  
           SELECT BP13F121 ASSIGN TO BP13F121.                                  
           SELECT BP13F120 ASSIGN TO BP13F120.                                  
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
                                                                                
           SELECT BM06K110 ASSIGN TO BM06K110                                   
                  ACCESS MODE  IS RANDOM                                        
                  ORGANIZATION IS INDEXED                                       
                  RECORD KEY   IS K110-KEY-FLD                                  
                  FILE STATUS  IS BM06K110-STATUS.                              
                                                                                
           SELECT BP13K671 ASSIGN TO BP13K671                                   
                  ACCESS MODE  IS RANDOM                                        
                  ORGANIZATION IS INDEXED                                       
                  RECORD KEY   IS K671-NUM-REGN                                 
                  FILE STATUS  IS BP13K671-STATUS.                              
                                                                                
           SELECT BP13L348 ASSIGN TO BP13L348.                                  
                                                                                
      *-----------------------*                                                 
       DATA DIVISION.                                                           
      *-----------------------*                                                 
       FILE SECTION.                                                            
      *-----------------------*                                                 
                                                                                
       FD  BB24F04A                                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       COPY BB24F04A.                                                           
                                                                                
       FD  BM06K110                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K671                                                            
            RECORD CONTAINS 3000 CHARACTERS.                                    
       COPY BP13K671.                                                           
                                                                                
       FD  BP13F121                                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       COPY BP13F121.                                                           
                                                                                
       FD  BP13F120                                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       COPY BP13F120.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD   BP13L348                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE  IS  F.                                              
       01   BP13L348-REC                PIC X(132).                             
                                                                                
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                                 
      *-----------------------*                                                 
                                                                                
       01  WS-COUNTER.                                                          
           05  WS-LINE-CTR               PIC 9(2)    VALUE 54.                  
           05  WS-PAGE-CTR               PIC 9(7)    VALUE ZEROS.               
           05  WS-READ-CNT               PIC 9(7)    VALUE ZEROS.               
           05  WS-PRINT-CNT              PIC 9(7)    VALUE ZEROS.               
           05  WS-PROCESS-CNT            PIC 9(7)    VALUE ZEROS.               
           05  WS-READ-K110              PIC 9(7)    VALUE ZEROS.               
           05  WS-READ-K671              PIC 9(7)    VALUE ZEROS.               
           05  WS-NOT-FND-K671           PIC 9(7)    VALUE ZEROS.               
           05  WS-NOT-MTCH-K671          PIC 9(7)    VALUE ZEROS.               
           05  WS-NOT-FND-K110           PIC 9(7)    VALUE ZEROS.               
           05  WS-WRITE-F120             PIC 9(8)    VALUE ZEROS.               
           05  WS-WRITE-F121             PIC 9(8)    VALUE ZEROS.               
           05  WS-CTR                    PIC 9(2)    VALUE ZEROS.               
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  BM06K110-STATUS           PIC 9(2)    VALUE 0.                   
           05  BP13K671-STATUS           PIC 9(2)    VALUE 0.                   
                                                                                
       01  WS-PROGRAM-SWITCHES.                                                 
           05  WS-EOF1                   PIC X       VALUE 'N'.                 
           05  WS-SY02-EOF               PIC X       VALUE 'N'.                 
           05  WS-FND-K671               PIC X       VALUE 'N'.                 
           05  WS-FND-K110               PIC X       VALUE 'N'.                 
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-DATE                   PIC X(8).                              
           05  WS-NUM-REGN               PIC X(8).                              
           05  WS-NUM-CPF                PIC X(9).                              
           05  WS-SCH-ACCT               PIC X(11).                             
           05  WS-NUM-VALUE-DATE         PIC X(8).                              
           05  WS-F04A-IDP               PIC 9(9)V99.                           
           05  WS-F04A-STAMP-LEGAL-FEE   PIC 9(7)V99.                           
           05  WS-PRINT-TOTAL-FEE        PIC 9(7)V99.                           
           05  WS-PRINT-IDP-REQ          PIC 9(7)V99.                           
           05  WS-PRINT-IDP-PD           PIC 9(7)V99.                           
           05  WS-REMARKS                PIC X(34).                             
           05  WS-TOTAL-LEGAL-FEES       PIC S9(7)V99.                          
           05  WS-LEGAL-FEES-REQ         PIC S9(7)V99.                          
           05  WS-AMT-REQUIRED           PIC S9(7)V99.                          
           05  WS-AMT-PAID               PIC S9(7)V99.                          
           05  WS-SAVE-FEES              PIC S9(7)V99.                          
           05  WS-LUMPSUM-LEFT           PIC S9(7)V99.                          
           05  WS-SV-LUMPSUM-LEFT        PIC S9(7)V99.                          
           05  WS-PAY-TYPE               PIC X(3).                              
           05  WS-CDE-APPLT-CPF          PIC X(1).                              
           05  WS-NRIC                   PIC X(9).                              
           05  WS-AMOUNT                 PIC S9(7)V99.                          
                                                                                
       01  WS-PAID-TABLE.                                                       
           05  WS-PAID-TAB OCCURS 4 TIMES.                                      
               10 WS-TOTAL-LUMP-IDP-REQ  PIC 9(7)V99.                           
               10 WS-TOTAL-LUMP-IDP-PD   PIC 9(7)V99.                           
               10 WS-LUMPSUM-REQ         PIC 9(7)V99.                           
               10 WS-LUMPSUM-PD          PIC 9(7)V99.                           
               10 WS-IDP-REQ             PIC 9(7)V99.                           
               10 WS-IDP-PD              PIC 9(7)V99.                           
               10 WS-LEASE-SF-REQ        PIC 9(7)V99.                           
               10 WS-LEASE-SF-PD         PIC 9(7)V99.                           
               10 WS-SALE-CF-REQ         PIC 9(7)V99.                           
               10 WS-SALE-CF-PD          PIC 9(7)V99.                           
               10 WS-MORT-CF-REQ         PIC 9(7)V99.                           
               10 WS-MORT-CF-PD          PIC 9(7)V99.                           
               10 WS-CAVEAT-REQ          PIC 9(7)V99.                           
               10 WS-CAVEAT-PD           PIC 9(7)V99.                           
               10 WS-SOLICIT-REQ         PIC 9(7)V99.                           
               10 WS-SOLICIT-PD          PIC 9(7)V99.                           
               10 WS-LSE-ESCR-REQ        PIC 9(7)V99.                           
               10 WS-LSE-ESCR-PD         PIC 9(7)V99.                           
               10 WS-LSE-REGN-REQ        PIC 9(7)V99.                           
               10 WS-LSE-REGN-PD         PIC 9(7)V99.                           
               10 WS-SRVY-FEE-REQ        PIC 9(7)V99.                           
               10 WS-SRVY-FEE-PD         PIC 9(7)V99.                           
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-CCYY             PIC 9(4).                                
           05  WS-SYS-MM               PIC 9(2).                                
           05  WS-SYS-DD               PIC 9(2).                                
                                                                                
       01  WS-DTE-CPF.                                                          
           05  WS-CPF-CCYY             PIC 9(4).                                
           05  WS-CPF-MM               PIC 9(2).                                
           05  WS-CPF-DD               PIC 9(2).                                
                                                                                
      *-------------------------------------------------------------            
      * REPORT LAYOUT                                                           
      *-------------------------------------------------------------            
       01  L348-HEADER1.                                                        
           05 FILLER                     PIC X(8)   VALUE 'BP13L348'.           
           05 FILLER                     PIC X(47)  VALUE SPACES.               
           05 FILLER                     PIC X(20)  VALUE                       
              'SYSTEM OF COMMITMENT'.                                           
           05 FILLER                     PIC X(38)  VALUE SPACES.               
           05 FILLER                     PIC X(7)   VALUE 'DATE : '.            
           05 L348-DATE                  PIC X(10)  VALUE SPACES.               
                                                                                
       01  L348-HEADER2.                                                        
           05 FILLER                     PIC X(41)  VALUE SPACES.               
           05 FILLER                     PIC X(50)  VALUE                       
              'CONTROL LIST OF HBL1 CPF UPDATE FOR BO CPF PAYMENT'.             
           05 FILLER                     PIC X(22)  VALUE SPACES.               
           05 FILLER                     PIC X(8)   VALUE 'PAGE : '.            
           05 L348-PAGE                  PIC Z,ZZZ,ZZ9 VALUE ZEROS.             
                                                                                
       01  L348-HEADER3.                                                        
           05 FILLER                     PIC X(41)  VALUE                       
              'SNO        REGN     CPF NO    SCH ACCT'.                         
           05 FILLER                     PIC X(2)   VALUE SPACES.               
           05 FILLER                     PIC X(47)  VALUE                       
              'VAL DATE LUMP/IDP REQ LUMP/IDP PD   SF REQ'.                     
           05 FILLER                     PIC X(20)  VALUE                       
              ' SF PD  REMARKS'.                                                
                                                                                
       01  L348-DETAIL.                                                         
           05 L348-SNO                   PIC Z(6)9.                             
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-NUM-REGN              PIC X(8)  VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-NUM-CPF               PIC X(9)  VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-NUM-SCH-ACCT          PIC X(14) VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-NUM-VALUE-DATE        PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-AMT-IDP-REQ           PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-AMT-IDP-PD            PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-AMT-STAMP-FEE-REQ     PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-AMT-STAMP-FEE-PD      PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L348-REMARKS               PIC X(34) VALUE SPACES.                
                                                                                
       01  L348-HEADER4.                                                        
           05 FILLER                     PIC X(132) VALUE ALL '-'.              
                                                                                
                                                                                
      *----------------------*                                                  
       PROCEDURE DIVISION.                                                      
      *----------------------*                                                  
                                                                                
      *----------------------*                                                  
       1000-MAIN-PROCEDURE.                                                     
      *----------------------*                                                  
           PERFORM 2000-OPENING-ROUTINE      THRU 2000-EXIT.                    
           PERFORM 2050-READ-SY02F001        THRU 2050-EXIT.                    
                                                                                
           PERFORM 2100-INITIALIZE-VAR       THRU 2100-EXIT.                    
                                                                                
           PERFORM 3000-READ-BB24F04A        THRU 3000-EXIT                     
                   UNTIL WS-EOF1 = 'Y'.                                         
                                                                                
           IF WS-READ-CNT = ZEROES                                              
              PERFORM 6100-PRINT-HDG THRU 6100-EXIT                             
              MOVE SPACES TO L348-DETAIL                                        
              MOVE '************* BB24F04A FILE EMPTY **************'           
                   TO L348-DETAIL                                               
              WRITE   BP13L348-REC   FROM L348-DETAIL AFTER 5                   
           ELSE                                                                 
              MOVE SPACES TO L348-DETAIL                                        
              MOVE '************* END OF FILE **************'                   
                   TO L348-DETAIL                                               
              WRITE   BP13L348-REC   FROM L348-DETAIL AFTER 1                   
           END-IF.                                                              
                                                                                
           PERFORM 7000-CLOSING-ROUTINE      THRU 7000-EXIT.                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       2000-OPENING-ROUTINE.                                                    
      *----------------------*                                                  
           OPEN INPUT  BB24F04A                                                 
                       BM06K110                                                 
                       SY02F001                                                 
                I-O    BP13K671                                                 
                OUTPUT BP13L348                                                 
                       BP13F121                                                 
                       BP13F120.                                                
                                                                                
             IF BM06K110-STATUS NOT = 0 AND 97                                  
                DISPLAY 'OPENING ERROR, K110-STATUS ' BM06K110-STATUS           
                PERFORM 7000-CLOSING-ROUTINE      THRU 7000-EXIT.               
                                                                                
             IF BP13K671-STATUS NOT = 0 AND 97                                  
                DISPLAY 'OPENING ERROR, K671-STATUS ' BP13K671-STATUS           
                PERFORM 7000-CLOSING-ROUTINE      THRU 7000-EXIT.               
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------*                                                     
       2050-READ-SY02F001.                                                      
      *-------------------*                                                     
                                                                                
           READ SY02F001 AT END MOVE 'Y' TO WS-SY02-EOF                         
                GO TO 2050-EXIT                                                 
           END-READ.                                                            
                                                                                
           MOVE F001-DTE-CURRENT  TO WS-SYSTEM-DATE.                            
                                                                                
       2050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------*                                                  
       2100-INITIALIZE-VAR.                                                     
      *----------------------*                                                  
           MOVE    SPACES                TO   WS-NUM-VALUE-DATE.                
           MOVE    'N'                   TO   WS-EOF1.                          
                                                                                
           INITIALIZE                         WS-COUNTER.                       
                                                                                
           MOVE    SPACES                TO   WS-OTHER-VARIABLES.               
           INITIALIZE                         WS-OTHER-VARIABLES.               
                                                                                
           MOVE    SPACES                TO   WS-PAID-TABLE.                    
           INITIALIZE                         WS-PAID-TABLE.                    
                                                                                
           MOVE 55                       TO   WS-LINE-CTR.                      
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------*                                                     
       3000-READ-BB24F04A.                                                      
      *-------------------*                                                     
           READ BB24F04A AT END MOVE 'Y' TO WS-EOF1                             
                GO TO 3000-EXIT.                                                
           ADD 1 TO WS-READ-CNT.                                                
                                                                                
           MOVE SPACES                 TO    WS-NUM-REGN                        
                                             WS-NUM-VALUE-DATE                  
                                             WS-REMARKS                         
                                             WS-NUM-CPF                         
                                             WS-SCH-ACCT.                       
                                                                                
           MOVE ZEROES                  TO   WS-F04A-IDP                        
                                             WS-F04A-STAMP-LEGAL-FEE            
                                             WS-PRINT-IDP-REQ                   
                                             WS-PRINT-IDP-PD                    
                                             WS-PRINT-TOTAL-FEE                 
                                             WS-LEGAL-FEES-REQ.                 
                                                                                
           MOVE    F04A-DTE-VALUE       TO   WS-NUM-VALUE-DATE.                 
           MOVE    F04A-NUM-CPF         TO   WS-NUM-CPF.                        
           MOVE    F04A-NUM-HDB-REF     TO   WS-SCH-ACCT.                       
                                                                                
           PERFORM 4000-INITIALIZE-BB24 THRU 4000-EXIT.                         
           PERFORM 4300-INIT-TABLE      THRU 4300-EXIT.                         
           PERFORM 5000-PROCESS-RECORD  THRU 5000-EXIT.                         
           PERFORM 6000-PRINT-RECORD    THRU 6000-EXIT.                         
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *---------------------*                                                   
       4000-INITIALIZE-BB24.                                                    
      *---------------------*                                                   
           IF F04A-AMT-LUMP-SUM NOT NUMERIC                                     
              MOVE ZEROES                TO  F04A-AMT-LUMP-SUM                  
           END-IF.                                                              
                                                                                
           IF F04A-AMT-STAMP-LEGAL-FEE NOT NUMERIC                              
              MOVE ZEROES                TO  F04A-AMT-STAMP-LEGAL-FEE           
           END-IF.                                                              
                                                                                
           MOVE F04A-AMT-LUMP-SUM        TO WS-F04A-IDP.                        
           MOVE F04A-AMT-STAMP-LEGAL-FEE TO WS-F04A-STAMP-LEGAL-FEE.            
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       4300-INIT-TABLE.                                                         
      *----------------------*                                                  
      *INITIALIZE TABLE                                                         
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 4                  
              MOVE +0 TO   WS-IDP-REQ           (WS-CTR)                        
                           WS-IDP-PD            (WS-CTR)                        
                           WS-LEASE-SF-REQ      (WS-CTR)                        
                           WS-LEASE-SF-PD       (WS-CTR)                        
                           WS-CAVEAT-REQ        (WS-CTR)                        
                           WS-CAVEAT-PD         (WS-CTR)                        
                           WS-SALE-CF-REQ       (WS-CTR)                        
                           WS-SALE-CF-PD        (WS-CTR)                        
                           WS-MORT-CF-REQ       (WS-CTR)                        
                           WS-MORT-CF-PD        (WS-CTR)                        
                           WS-LUMPSUM-REQ       (WS-CTR)                        
                           WS-LUMPSUM-PD        (WS-CTR)                        
                           WS-TOTAL-LUMP-IDP-REQ(WS-CTR)                        
                           WS-TOTAL-LUMP-IDP-PD (WS-CTR)                        
           END-PERFORM.                                                         
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       5000-PROCESS-RECORD.                                                     
      *----------------------*                                                  
           PERFORM 5100-READ-BM06K110      THRU 5100-EXIT.                      
                                                                                
           IF WS-FND-K110 = 'Y'                                                 
              PERFORM 5200-READ-BP13K671   THRU 5200-EXIT                       
              IF (WS-FND-K671 = 'Y') AND (K671-NUM-SUBTRF NOT = 'Y')            
                 PERFORM 5300-PROCESS-K671 THRU 5300-EXIT                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------*                                                     
       5100-READ-BM06K110.                                                      
      *-------------------*                                                     
           MOVE 'N'                            TO WS-FND-K110.                  
           MOVE F04A-NUM-HDB-REF               TO K110-KEY-FLD.                 
                                                                                
           READ BM06K110.                                                       
           EVALUATE BM06K110-STATUS                                             
              WHEN 00                                                           
                 ADD   1                       TO WS-READ-K110                  
                 IF K110-REGN-NO = LOW-VALUES  OR SPACES OR ZEROES              
                    MOVE '* FIS REGN NO = BLANK' TO WS-REMARKS                  
                    MOVE SPACES                  TO K110-REGN-NO                
                 ELSE                                                           
                    MOVE 'Y'                     TO WS-FND-K110                 
                 END-IF                                                         
                 MOVE K110-REGN-NO               TO WS-NUM-REGN                 
              WHEN 23                                                           
                 ADD   1                         TO WS-NOT-FND-K110             
                 DISPLAY 'BM06K110 NOT FOUND KEY : ' K110-KEY-FLD               
                 MOVE    '* SCH ACCT NOT FND IN FIS' TO WS-REMARKS              
              WHEN OTHER                                                        
                 DISPLAY 'ERRROR READING BM06K110, STATUS = '                   
                          BM06K110-STATUS '    KEY = ' K110-KEY-FLD             
                PERFORM 7000-CLOSING-ROUTINE   THRU 7000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------*                                                     
       5200-READ-BP13K671.                                                      
      *-------------------*                                                     
           MOVE 'N'                            TO WS-FND-K671.                  
           MOVE K110-REGN-NO                   TO K671-NUM-REGN.                
                                                                                
           READ BP13K671.                                                       
           EVALUATE BP13K671-STATUS                                             
             WHEN  00                                                           
                 ADD   1                       TO WS-READ-K671                  
                 MOVE 'Y'                      TO WS-FND-K671                   
                 IF K671-NUM-SUBTRF = 'Y'                                       
                    DISPLAY 'SUB TRANSFER CASE BYPASS. REGN: '                  
                                                   K671-NUM-REGN                
                 END-IF                                                         
             WHEN  23                                                           
                 ADD   1                       TO WS-NOT-FND-K671               
                 DISPLAY 'REGN BP13K671 NOT FOUND. REGN: ' K671-NUM-REGN        
                         ' SCH: ' WS-SCH-ACCT                                   
                 MOVE    '* REGN NOT FOUND IN BO FILE' TO WS-REMARKS            
             WHEN OTHER                                                         
                 DISPLAY 'ERRROR READING BP13K671, STATUS = '                   
                          BP13K671-STATUS ' KEY = ' K671-NUM-REGN               
                 PERFORM 7000-CLOSING-ROUTINE   THRU 7000-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       5300-PROCESS-K671.                                                       
      *------------------*                                                      
           PERFORM 5310-INIT-NUMERIC         THRU 5310-EXIT.                    
           PERFORM 5320-MOVE-K671-TABLE      THRU 5320-EXIT.                    
                                                                                
           IF K671-NUM-HBL-TYP NOT = '1'                                        
              MOVE '*HBL FORM WRONG. UPD HBL IN M687.' TO WS-REMARKS            
              GO TO 5300-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE +0  TO WS-TOTAL-LEGAL-FEES.                                     
                                                                                
           EVALUATE F04A-NUM-CPF                                                
              WHEN K671-NUM-CPF1-NO                                             
                   IF K671-AMT-SOC-CPF1-PAID         > 0 OR                     
                      K671-AMT-LUMPSUM-CPF1-PAID     > 0 OR                     
                      K671-AMT-LSE-STMP-CPF1-PAID    > 0 OR                     
                      K671-AMT-SALE-CONVY-CPF1-PAID  > 0 OR                     
                      K671-AMT-MORT-CONVY-CPF1-PAID  > 0 OR                     
                      K671-AMT-SRVY-FEE-CPF1-PAID    > 0 OR                     
                      K671-AMT-LSE-ESCR-CPF1-PAID    > 0 OR                     
                      K671-AMT-LSE-REGN-CPF1-PAID    > 0 OR                     
                      K671-AMT-CAVEAT-REGN-CPF1-PAID > 0 OR                     
                      K671-AMT-SOLICIT-CPF1-PAID     > 0                        
                      MOVE '*DUPLICATE IBG REJECTED.' TO WS-REMARKS             
                      GO TO 5300-EXIT                                           
                   END-IF                                                       
                   MOVE 1 TO WS-CTR                                             
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5500-PROCESS-CPF1 THRU 5500-EXIT                     
              WHEN K671-NUM-CPF2-NO                                             
                   IF K671-AMT-SOC-CPF2-PAID         > 0 OR                     
                      K671-AMT-LUMPSUM-CPF2-PAID     > 0 OR                     
                      K671-AMT-LSE-STMP-CPF2-PAID    > 0 OR                     
                      K671-AMT-SALE-CONVY-CPF2-PAID  > 0 OR                     
                      K671-AMT-MORT-CONVY-CPF2-PAID  > 0 OR                     
                      K671-AMT-SRVY-FEE-CPF2-PAID    > 0 OR                     
                      K671-AMT-LSE-ESCR-CPF2-PAID    > 0 OR                     
                      K671-AMT-LSE-REGN-CPF2-PAID    > 0 OR                     
                      K671-AMT-CAVEAT-REGN-CPF2-PAID > 0 OR                     
                      K671-AMT-SOLICIT-CPF2-PAID     > 0                        
                      MOVE '*DUPLICATE IBG REJECTED.' TO WS-REMARKS             
                      GO TO 5300-EXIT                                           
                   END-IF                                                       
                   MOVE 2 TO WS-CTR                                             
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5510-PROCESS-CPF2 THRU 5510-EXIT                     
              WHEN K671-NUM-CPF3-NO                                             
                   IF K671-AMT-SOC-CPF3-PAID         > 0 OR                     
                      K671-AMT-LUMPSUM-CPF3-PAID     > 0 OR                     
                      K671-AMT-LSE-STMP-CPF3-PAID    > 0 OR                     
                      K671-AMT-SALE-CONVY-CPF3-PAID  > 0 OR                     
                      K671-AMT-MORT-CONVY-CPF3-PAID  > 0 OR                     
                      K671-AMT-SRVY-FEE-CPF3-PAID    > 0 OR                     
                      K671-AMT-LSE-ESCR-CPF3-PAID    > 0 OR                     
                      K671-AMT-LSE-REGN-CPF3-PAID    > 0 OR                     
                      K671-AMT-CAVEAT-REGN-CPF3-PAID > 0 OR                     
                      K671-AMT-SOLICIT-CPF3-PAID     > 0                        
                      MOVE '*DUPLICATE IBG REJECTED.' TO WS-REMARKS             
                      GO TO 5300-EXIT                                           
                   END-IF                                                       
                   MOVE 3 TO WS-CTR                                             
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5520-PROCESS-CPF3 THRU 5520-EXIT                     
              WHEN K671-NUM-CPF4-NO                                             
                   IF K671-AMT-SOC-CPF4-PAID         > 0 OR                     
                      K671-AMT-LUMPSUM-CPF4-PAID     > 0 OR                     
                      K671-AMT-LSE-STMP-CPF4-PAID    > 0 OR                     
                      K671-AMT-SALE-CONVY-CPF4-PAID  > 0 OR                     
                      K671-AMT-MORT-CONVY-CPF4-PAID  > 0 OR                     
                      K671-AMT-SRVY-FEE-CPF4-PAID    > 0 OR                     
                      K671-AMT-LSE-ESCR-CPF4-PAID    > 0 OR                     
                      K671-AMT-LSE-REGN-CPF4-PAID    > 0 OR                     
                      K671-AMT-CAVEAT-REGN-CPF4-PAID > 0 OR                     
                      K671-AMT-SOLICIT-CPF4-PAID     > 0                        
                      MOVE '*DUPLICATE IBG REJECTED.' TO WS-REMARKS             
                      GO TO 5300-EXIT                                           
                   END-IF                                                       
                   MOVE 4 TO WS-CTR                                             
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5530-PROCESS-CPF4 THRU 5530-EXIT                     
              WHEN OTHER                                                        
                   ADD   1                TO WS-NOT-MTCH-K671                   
                   DISPLAY 'CPF NO: ' F04A-NUM-CPF ' NO MATCHING K671.'         
                     ' REGN: ' K671-NUM-REGN ' SCH: ' WS-SCH-ACCT               
                   MOVE 'CPF NO. NO MATCHING K671' TO WS-REMARKS                
           END-EVALUATE.                                                        
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------*                                                     
       5310-INIT-NUMERIC.                                                       
      *-------------------*                                                     
      *IDP VARIABLES                                                            
           IF K671-AMT-SOC-CPF1        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF1-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4-PAID               
           END-IF.                                                              
                                                                                
      *LUMP SUM                                                                 
           IF K671-AMT-LUMPSUM-CPF1    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF1-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4-PAID           
           END-IF.                                                              
                                                                                
      *LUMP SUM RETIRE                                                          
           IF K671-AMT-LUMPSUM-CPF1-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4-RETIRE         
           END-IF.                                                              
                                                                                
      *LEASE STAMP FEE                                                          
           IF K671-AMT-LSE-STMP-CPF1   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF1-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF2-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF3-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF4-PAID        
           END-IF.                                                              
                                                                                
      *CAVEAT REGN FEE                                                          
           IF K671-AMT-CAVEAT-REGN-CPF1 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF1           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF2           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF3           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF4           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF1-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF2-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF3-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF4-PAID          
           END-IF.                                                              
                                                                                
      *SALE CONVEY FEE                                                          
           IF K671-AMT-SALE-CONVY-CPF1 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF1             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF2             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF3             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF4             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF1-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF2-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF3-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF4-PAID         
           END-IF.                                                              
                                                                                
      *MORT CONVEY FEE                                                          
           IF K671-AMT-MORT-CONVY-CPF1 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF1             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF2             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF3             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF4             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF1-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF2-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF3-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF4-PAID         
           END-IF.                                                              
                                                                                
      *SOLICITOR BILL                                                           
           IF K671-AMT-SOLICIT-CPF1 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF4-PAID              
           END-IF.                                                              
                                                                                
      *LEASE IN ESCROW                                                          
           IF K671-AMT-LSE-ESCR-CPF1 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF4-PAID             
           END-IF.                                                              
                                                                                
      *LEASE REGN FEE                                                           
           IF K671-AMT-LSE-REGN-CPF1 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF4-PAID             
           END-IF.                                                              
                                                                                
      *SRVY-FEE FEE                                                             
           IF K671-AMT-SRVY-FEE-CPF1 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF4-PAID             
           END-IF.                                                              
                                                                                
       5310-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *---------------------*                                                   
       5320-MOVE-K671-TABLE.                                                    
      *---------------------*                                                   
      * IDP REQ                                                                 
           COMPUTE WS-IDP-REQ(1) = K671-AMT-SOC-CPF1        +                   
                                   K671-AMT-SOC-CPF1-RETIRE.                    
                                                                                
           COMPUTE WS-IDP-REQ(2) = K671-AMT-SOC-CPF2        +                   
                                   K671-AMT-SOC-CPF2-RETIRE.                    
                                                                                
           COMPUTE WS-IDP-REQ(3) = K671-AMT-SOC-CPF3        +                   
                                   K671-AMT-SOC-CPF3-RETIRE.                    
                                                                                
           COMPUTE WS-IDP-REQ(4) = K671-AMT-SOC-CPF4        +                   
                                   K671-AMT-SOC-CPF4-RETIRE.                    
                                                                                
           IF K110-DTE-KEY-AVAIL > ZEROES                                       
              PERFORM 5330-MOVE-K671-KEYAVAIL THRU 5330-EXIT                    
           END-IF.                                                              
                                                                                
      *SOLICITOR BILL                                                           
           MOVE K671-AMT-SOLICIT-CPF1         TO WS-SOLICIT-REQ(1).             
           MOVE K671-AMT-SOLICIT-CPF2         TO WS-SOLICIT-REQ(2).             
           MOVE K671-AMT-SOLICIT-CPF3         TO WS-SOLICIT-REQ(3).             
           MOVE K671-AMT-SOLICIT-CPF4         TO WS-SOLICIT-REQ(4).             
                                                                                
      *LEASE STAMP FEE                                                          
           MOVE K671-AMT-LSE-STMP-CPF1        TO WS-LEASE-SF-REQ(1).            
           MOVE K671-AMT-LSE-STMP-CPF2        TO WS-LEASE-SF-REQ(2).            
           MOVE K671-AMT-LSE-STMP-CPF3        TO WS-LEASE-SF-REQ(3).            
           MOVE K671-AMT-LSE-STMP-CPF4        TO WS-LEASE-SF-REQ(4).            
                                                                                
      *CAVEAT REGN FEE                                                          
           MOVE K671-AMT-CAVEAT-REGN-CPF1      TO WS-CAVEAT-REQ(1).             
           MOVE K671-AMT-CAVEAT-REGN-CPF2      TO WS-CAVEAT-REQ(2).             
           MOVE K671-AMT-CAVEAT-REGN-CPF3      TO WS-CAVEAT-REQ(3).             
           MOVE K671-AMT-CAVEAT-REGN-CPF4      TO WS-CAVEAT-REQ(4).             
                                                                                
      *SALE CONVEY FEE                                                          
           MOVE K671-AMT-SALE-CONVY-CPF1      TO WS-SALE-CF-REQ(1).             
           MOVE K671-AMT-SALE-CONVY-CPF2      TO WS-SALE-CF-REQ(2).             
           MOVE K671-AMT-SALE-CONVY-CPF3      TO WS-SALE-CF-REQ(3).             
           MOVE K671-AMT-SALE-CONVY-CPF4      TO WS-SALE-CF-REQ(4).             
                                                                                
      *MORT CONVEY FEE                                                          
           MOVE K671-AMT-MORT-CONVY-CPF1      TO WS-MORT-CF-REQ(1).             
           MOVE K671-AMT-MORT-CONVY-CPF2      TO WS-MORT-CF-REQ(2).             
           MOVE K671-AMT-MORT-CONVY-CPF3      TO WS-MORT-CF-REQ(3).             
           MOVE K671-AMT-MORT-CONVY-CPF4      TO WS-MORT-CF-REQ(4).             
                                                                                
       5320-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       5330-MOVE-K671-KEYAVAIL.                                                 
      *------------------------*                                                
      * LUMPSUM REQ                                                             
           COMPUTE WS-LUMPSUM-REQ(1) = K671-AMT-LUMPSUM-CPF1       +            
                                       K671-AMT-LUMPSUM-CPF1-RETIRE.            
           COMPUTE WS-LUMPSUM-REQ(2) = K671-AMT-LUMPSUM-CPF2       +            
                                       K671-AMT-LUMPSUM-CPF2-RETIRE.            
           COMPUTE WS-LUMPSUM-REQ(3) = K671-AMT-LUMPSUM-CPF3       +            
                                       K671-AMT-LUMPSUM-CPF3-RETIRE.            
           COMPUTE WS-LUMPSUM-REQ(4) = K671-AMT-LUMPSUM-CPF4       +            
                                       K671-AMT-LUMPSUM-CPF4-RETIRE.            
                                                                                
      *LEASE IN ESCROW                                                          
           MOVE K671-AMT-LSE-ESCR-CPF1        TO WS-LSE-ESCR-REQ(1).            
           MOVE K671-AMT-LSE-ESCR-CPF2        TO WS-LSE-ESCR-REQ(2).            
           MOVE K671-AMT-LSE-ESCR-CPF3        TO WS-LSE-ESCR-REQ(3).            
           MOVE K671-AMT-LSE-ESCR-CPF4        TO WS-LSE-ESCR-REQ(4).            
                                                                                
      *LEASE REGN FEE                                                           
           MOVE K671-AMT-LSE-REGN-CPF1        TO WS-LSE-REGN-REQ(1).            
           MOVE K671-AMT-LSE-REGN-CPF2        TO WS-LSE-REGN-REQ(2).            
           MOVE K671-AMT-LSE-REGN-CPF3        TO WS-LSE-REGN-REQ(3).            
           MOVE K671-AMT-LSE-REGN-CPF4        TO WS-LSE-REGN-REQ(4).            
                                                                                
      *LEASE REGN FEE                                                           
           MOVE K671-AMT-SRVY-FEE-CPF1        TO WS-SRVY-FEE-REQ(1).            
           MOVE K671-AMT-SRVY-FEE-CPF2        TO WS-SRVY-FEE-REQ(2).            
           MOVE K671-AMT-SRVY-FEE-CPF3        TO WS-SRVY-FEE-REQ(3).            
           MOVE K671-AMT-SRVY-FEE-CPF4        TO WS-SRVY-FEE-REQ(4).            
                                                                                
       5330-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       5400-COMPUTE-PAID.                                                       
      *------------------*                                                      
      *IDP                                                                      
           IF K110-DTE-KEY-AVAIL = SPACES OR LOW-VALUES OR ZEROES               
              COMPUTE WS-TOTAL-LUMP-IDP-REQ(WS-CTR) =                           
                      WS-IDP-REQ(WS-CTR)                                        
              IF WS-F04A-IDP >= WS-TOTAL-LUMP-IDP-REQ(WS-CTR)                   
                 MOVE WS-IDP-REQ(WS-CTR)      TO WS-IDP-PD(WS-CTR)              
              ELSE                                                              
                 MOVE WS-F04A-IDP             TO WS-IDP-PD(WS-CTR)              
              END-IF                                                            
           ELSE                                                                 
              COMPUTE WS-TOTAL-LUMP-IDP-REQ(WS-CTR) =                           
                      WS-IDP-REQ(WS-CTR) + WS-LUMPSUM-REQ(WS-CTR)               
                                                                                
              IF WS-F04A-IDP >= WS-TOTAL-LUMP-IDP-REQ(WS-CTR)                   
                 MOVE WS-LUMPSUM-REQ (WS-CTR) TO WS-LUMPSUM-PD(WS-CTR)          
                 MOVE WS-IDP-REQ(WS-CTR)      TO WS-IDP-PD(WS-CTR)              
              ELSE                                                              
                 MOVE +0 TO WS-LUMPSUM-LEFT                                     
                 COMPUTE WS-LUMPSUM-LEFT = WS-F04A-IDP -                        
                                           WS-IDP-REQ(WS-CTR)                   
                 IF WS-LUMPSUM-LEFT < 0                                         
                    MOVE WS-F04A-IDP          TO WS-IDP-PD(WS-CTR)      AID     
                    MOVE +0                   TO WS-LUMPSUM-LEFT                
                 ELSE                                                           
                    MOVE WS-IDP-REQ(WS-CTR)   TO WS-IDP-PD(WS-CTR)              
                 END-IF                                                         
                                                                                
                 MOVE WS-LUMPSUM-LEFT         TO WS-SV-LUMPSUM-LEFT             
                 IF WS-LUMPSUM-LEFT > 0                                         
                    COMPUTE WS-LUMPSUM-LEFT = WS-LUMPSUM-LEFT -                 
                                              WS-LUMPSUM-REQ(WS-CTR)            
                    IF WS-LUMPSUM-LEFT < 0                                      
                       MOVE WS-SV-LUMPSUM-LEFT TO WS-LUMPSUM-PD(WS-CTR) AID     
                    ELSE                                                        
                       MOVE WS-LUMPSUM-REQ(WS-CTR) TO                           
                            WS-LUMPSUM-PD (WS-CTR)                              
                    END-IF                                                      
                 ELSE                                                           
                    MOVE +0  TO WS-LUMPSUM-PD(WS-CTR)                           
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K110-DTE-KEY-AVAIL > ZEROES                                       
              COMPUTE WS-TOTAL-LUMP-IDP-PD(WS-CTR) =                            
                      WS-LUMPSUM-PD(WS-CTR) + WS-IDP-PD(WS-CTR)                 
           ELSE                                                                 
              COMPUTE WS-TOTAL-LUMP-IDP-PD(WS-CTR) = WS-IDP-PD(WS-CTR)          
           END-IF.                                                              
                                                                                
           MOVE WS-TOTAL-LUMP-IDP-PD(WS-CTR)  TO WS-PRINT-IDP-PD.               
           MOVE WS-TOTAL-LUMP-IDP-REQ(WS-CTR) TO WS-PRINT-IDP-REQ.              
                                                                                
      *LEGAL FEES                                                               
           IF K110-DTE-KEY-AVAIL = SPACES OR LOW-VALUES OR ZEROES               
              PERFORM 5410-FEES-NO-KEYAVAIL THRU 5410-EXIT                      
           ELSE                                                                 
              PERFORM 5420-FEES-KEYAVAIL    THRU 5420-EXIT                      
           END-IF.                                                              
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       5410-FEES-NO-KEYAVAIL.                                                   
      *----------------------*                                                  
           COMPUTE WS-LEGAL-FEES-REQ =                                          
                   WS-LEASE-SF-REQ    (WS-CTR) +                                
                   WS-SALE-CF-REQ     (WS-CTR) +                                
                   WS-MORT-CF-REQ     (WS-CTR) +                                
                   WS-CAVEAT-REQ      (WS-CTR) +                                
                   WS-SOLICIT-REQ     (WS-CTR)                                  
                                                                                
           MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-TOTAL-LEGAL-FEES.                 
                                                                                
           IF WS-F04A-STAMP-LEGAL-FEE = 0                                       
              MOVE +0 TO  WS-LEASE-SF-PD     (WS-CTR)                           
                          WS-SALE-CF-PD      (WS-CTR)                           
                          WS-MORT-CF-PD      (WS-CTR)                           
                          WS-CAVEAT-PD       (WS-CTR)                           
                          WS-SOLICIT-PD      (WS-CTR)                           
           ELSE                                                                 
              IF WS-F04A-STAMP-LEGAL-FEE   >= WS-LEGAL-FEES-REQ                 
                 IF WS-F04A-STAMP-LEGAL-FEE = WS-LEGAL-FEES-REQ                 
                    MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-PRINT-TOTAL-FEE          
                 ELSE                                                           
                    MOVE WS-LEGAL-FEES-REQ       TO WS-PRINT-TOTAL-FEE          
                 END-IF                                                         
                 MOVE WS-LEASE-SF-REQ     (WS-CTR)   TO                         
                      WS-LEASE-SF-PD      (WS-CTR)                              
                 MOVE WS-CAVEAT-REQ       (WS-CTR)   TO                         
                      WS-CAVEAT-PD        (WS-CTR)                              
                 MOVE WS-SALE-CF-REQ      (WS-CTR)   TO                         
                      WS-SALE-CF-PD       (WS-CTR)                              
                 MOVE WS-MORT-CF-REQ      (WS-CTR)   TO                         
                      WS-MORT-CF-PD       (WS-CTR)                              
                 MOVE WS-SOLICIT-REQ      (WS-CTR)   TO                         
                      WS-SOLICIT-PD       (WS-CTR)                              
              ELSE                                                              
                 MOVE WS-F04A-STAMP-LEGAL-FEE TO   WS-PRINT-TOTAL-FEE           
                                                                                
      *///       CAVEAT FEE                                                     
                 MOVE WS-CAVEAT-REQ(WS-CTR)   TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-CAVEAT-PD(WS-CTR)          
                                                                                
      *///       LEASE SF                                                       
                 MOVE WS-LEASE-SF-REQ(WS-CTR) TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-LEASE-SF-PD(WS-CTR)         
                                                                                
      *///       SALE CONVY                                                     
                 MOVE WS-SALE-CF-REQ(WS-CTR)  TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-SALE-CF-PD(WS-CTR)         
                                                                                
      *///       MORT CONVY                                                     
                 MOVE WS-MORT-CF-REQ(WS-CTR)  TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-MORT-CF-PD(WS-CTR)         
                                                                                
      *///       SOLICITOR BILL                                                 
                 MOVE WS-SOLICIT-REQ(WS-CTR)  TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-SOLICIT-PD(WS-CTR)         
                                                                                
           END-IF.                                                              
                                                                                
       5410-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------*                                                     
       5420-FEES-KEYAVAIL.                                                      
      *-------------------*                                                     
           COMPUTE WS-LEGAL-FEES-REQ =                                          
                   WS-LEASE-SF-REQ    (WS-CTR) +                                
                   WS-CAVEAT-REQ      (WS-CTR) +                                
                   WS-SALE-CF-REQ     (WS-CTR) +                                
                   WS-MORT-CF-REQ     (WS-CTR) +                                
                   WS-SOLICIT-REQ     (WS-CTR) +                                
                   WS-LSE-ESCR-REQ    (WS-CTR) +                                
                   WS-LSE-REGN-REQ    (WS-CTR) +                                
                   WS-SRVY-FEE-REQ    (WS-CTR).                                 
                                                                                
           MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-TOTAL-LEGAL-FEES.                 
                                                                                
           IF WS-F04A-STAMP-LEGAL-FEE = 0                                       
              MOVE +0 TO  WS-LEASE-SF-PD     (WS-CTR)                           
                          WS-CAVEAT-PD       (WS-CTR)                           
                          WS-SALE-CF-PD      (WS-CTR)                           
                          WS-MORT-CF-PD      (WS-CTR)                           
                          WS-SOLICIT-PD      (WS-CTR)                           
                          WS-LSE-ESCR-PD     (WS-CTR)                           
                          WS-LSE-REGN-PD     (WS-CTR)                           
                          WS-SRVY-FEE-PD     (WS-CTR)                           
           ELSE                                                                 
              IF WS-F04A-STAMP-LEGAL-FEE   >= WS-LEGAL-FEES-REQ                 
                 IF WS-F04A-STAMP-LEGAL-FEE = WS-LEGAL-FEES-REQ                 
                    MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-PRINT-TOTAL-FEE          
                 ELSE                                                           
                    MOVE WS-LEGAL-FEES-REQ       TO WS-PRINT-TOTAL-FEE          
                 END-IF                                                         
                 MOVE WS-LEASE-SF-REQ     (WS-CTR)   TO                         
                      WS-LEASE-SF-PD      (WS-CTR)                              
                 MOVE WS-CAVEAT-REQ       (WS-CTR)   TO                         
                      WS-CAVEAT-PD        (WS-CTR)                              
                 MOVE WS-SALE-CF-REQ      (WS-CTR)   TO                         
                      WS-SALE-CF-PD       (WS-CTR)                              
                 MOVE WS-MORT-CF-REQ      (WS-CTR)   TO                         
                      WS-MORT-CF-PD       (WS-CTR)                              
                 MOVE WS-SOLICIT-REQ      (WS-CTR)   TO                         
                      WS-SOLICIT-PD       (WS-CTR)                              
                 MOVE WS-LSE-ESCR-REQ     (WS-CTR)   TO                         
                      WS-LSE-ESCR-PD      (WS-CTR)                              
                 MOVE WS-LSE-REGN-REQ     (WS-CTR)   TO                         
                      WS-LSE-REGN-PD      (WS-CTR)                              
                 MOVE WS-SRVY-FEE-REQ     (WS-CTR)   TO                         
                      WS-SRVY-FEE-PD      (WS-CTR)                              
              ELSE                                                              
                 MOVE WS-F04A-STAMP-LEGAL-FEE TO   WS-PRINT-TOTAL-FEE           
                                                                                
      *///       CAVEAT FEE                                                     
                 MOVE WS-CAVEAT-REQ(WS-CTR)   TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-CAVEAT-PD(WS-CTR)          
                                                                                
      *///       LEASE SF                                                       
                 MOVE WS-LEASE-SF-REQ(WS-CTR) TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-LEASE-SF-PD(WS-CTR)         
                                                                                
      *///       SALE CONVY                                                     
                 MOVE WS-SALE-CF-REQ(WS-CTR)  TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-SALE-CF-PD(WS-CTR)         
                                                                                
      *///       MORT CONVY                                                     
                 MOVE WS-MORT-CF-REQ(WS-CTR)  TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-MORT-CF-PD(WS-CTR)         
                                                                                
      *///       LEASE REGN FEE                                                 
                 MOVE WS-LSE-REGN-REQ(WS-CTR) TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-LSE-REGN-PD(WS-CTR)        
                                                                                
      *///       LEASE IN ESCROW                                                
                 MOVE WS-LSE-ESCR-REQ(WS-CTR) TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-LSE-ESCR-PD(WS-CTR)        
                                                                                
      *///       SURVEY FEE                                                     
                 MOVE WS-SRVY-FEE-REQ(WS-CTR) TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-SRVY-FEE-PD(WS-CTR)        
                                                                                
      *///       SOLICITOR BILL                                                 
                 MOVE WS-SOLICIT-REQ(WS-CTR)  TO   WS-AMT-REQUIRED              
                 PERFORM 5440-COMPUTE-FEES    THRU 5440-EXIT                    
                 MOVE WS-AMT-PAID             TO  WS-SOLICIT-PD(WS-CTR)         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5420-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       5440-COMPUTE-FEES.                                                       
      *------------------*                                                      
           MOVE WS-TOTAL-LEGAL-FEES   TO WS-SAVE-FEES.                          
                                                                                
           IF WS-TOTAL-LEGAL-FEES > 0                                           
              COMPUTE WS-TOTAL-LEGAL-FEES = WS-TOTAL-LEGAL-FEES -               
                                            WS-AMT-REQUIRED                     
              IF WS-TOTAL-LEGAL-FEES < 0                                        
                 MOVE WS-SAVE-FEES    TO WS-AMT-PAID                    AID     
                 MOVE +0              TO WS-TOTAL-LEGAL-FEES                    
              ELSE                                                              
                 MOVE WS-AMT-REQUIRED TO WS-AMT-PAID                            
              END-IF                                                            
           ELSE                                                                 
              MOVE +0                 TO WS-AMT-PAID                            
           END-IF.                                                              
                                                                                
           MOVE WS-TOTAL-LEGAL-FEES   TO WS-SAVE-FEES.                          
                                                                                
       5440-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       5500-PROCESS-CPF1.                                                       
      *------------------*                                                      
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF1.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              MOVE WS-LUMPSUM-PD(WS-CTR) TO  K671-AMT-LUMPSUM-CPF1-PAID         
                                                                                
              MOVE WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF1-PAID                                  
              MOVE WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF1-PAID                                  
              MOVE WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF1-PAID                                  
           END-IF.                                                              
                                                                                
           MOVE WS-IDP-PD          (WS-CTR) TO  K671-AMT-SOC-CPF1-PAID          
           MOVE WS-SOLICIT-PD      (WS-CTR)     TO                              
                K671-AMT-SOLICIT-CPF1-PAID.                                     
           MOVE WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF1-PAID.                                    
           MOVE WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF1-PAID.                                  
           MOVE WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF1-PAID.                                  
           MOVE WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF1-PAID.                                 
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6500-CHECK-CPF1       THRU 6500-EXIT.                        
                                                                                
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       5510-PROCESS-CPF2.                                                       
      *------------------*                                                      
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF2.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              MOVE WS-LUMPSUM-PD(WS-CTR) TO  K671-AMT-LUMPSUM-CPF2-PAID         
                                                                                
              MOVE WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF2-PAID                                  
              MOVE WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF2-PAID                                  
              MOVE WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF2-PAID                                  
           END-IF.                                                              
                                                                                
           MOVE WS-IDP-PD         (WS-CTR) TO  K671-AMT-SOC-CPF2-PAID           
           MOVE WS-SOLICIT-PD     (WS-CTR)     TO                               
                K671-AMT-SOLICIT-CPF2-PAID.                                     
           MOVE WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF2-PAID.                                    
           MOVE WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF2-PAID.                                  
           MOVE WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF2-PAID.                                  
           MOVE WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF2-PAID.                                 
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6550-CHECK-CPF2       THRU 6550-EXIT.                        
                                                                                
       5510-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       5520-PROCESS-CPF3.                                                       
      *------------------*                                                      
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF3.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              MOVE WS-LUMPSUM-PD(WS-CTR) TO  K671-AMT-LUMPSUM-CPF3-PAID         
                                                                                
              MOVE WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF3-PAID                                  
              MOVE WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF3-PAID                                  
              MOVE WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF3-PAID                                  
           END-IF.                                                              
                                                                                
           MOVE WS-IDP-PD          (WS-CTR) TO  K671-AMT-SOC-CPF3-PAID          
           MOVE WS-SOLICIT-PD      (WS-CTR)     TO                              
                K671-AMT-SOLICIT-CPF3-PAID                                      
           MOVE WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF3-PAID.                                    
           MOVE WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF3-PAID.                                  
           MOVE WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF3-PAID.                                  
           MOVE WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF3-PAID.                                 
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6600-CHECK-CPF3       THRU 6600-EXIT.                        
                                                                                
       5520-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       5530-PROCESS-CPF4.                                                       
      *------------------*                                                      
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF4.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              MOVE WS-LUMPSUM-PD(WS-CTR) TO  K671-AMT-LUMPSUM-CPF4-PAID         
                                                                                
              MOVE WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF4-PAID                                  
              MOVE WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF4-PAID                                  
              MOVE WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF4-PAID                                  
           END-IF.                                                              
                                                                                
           MOVE WS-IDP-PD          (WS-CTR) TO  K671-AMT-SOC-CPF4-PAID.         
           MOVE WS-SOLICIT-PD      (WS-CTR)     TO                              
                K671-AMT-SOLICIT-CPF4-PAID.                                     
           MOVE WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF4-PAID.                                    
           MOVE WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF4-PAID.                                  
           MOVE WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF4-PAID.                                  
           MOVE WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF4-PAID.                                 
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6650-CHECK-CPF4       THRU 6650-EXIT.                        
                                                                                
       5530-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       5900-REWRITE-BP13K671.                                                   
      *----------------------*                                                  
           MOVE 'BP13C348'   TO K671-NUM-USERID.                                
           REWRITE BP13K671-REC.                                                
                                                                                
           IF BP13K671-STATUS = ZEROES                                          
              ADD 1          TO WS-PROCESS-CNT                                  
              IF WS-F04A-STAMP-LEGAL-FEE >= WS-LEGAL-FEES-REQ AND               
                 WS-F04A-IDP >= WS-TOTAL-LUMP-IDP-REQ(WS-CTR)                   
                 MOVE 'AMT SUFFICIENT.'             TO WS-REMARKS               
              ELSE                                                              
                 IF WS-F04A-IDP < WS-TOTAL-LUMP-IDP-REQ(WS-CTR) AND             
                    WS-F04A-STAMP-LEGAL-FEE < WS-LEGAL-FEES-REQ                 
                    MOVE '*LUMPSUM/IDP/SF PD INSUFFICIENT' TO WS-REMARKS        
                 ELSE                                                           
                    IF WS-F04A-STAMP-LEGAL-FEE < WS-LEGAL-FEES-REQ              
                       MOVE '*SF PAID INSUFFICIENT' TO WS-REMARKS               
                    ELSE                                                        
                       IF WS-F04A-IDP < WS-TOTAL-LUMP-IDP-REQ(WS-CTR)           
                          MOVE '*LUMPSUM/IDP PD INSUFFICIENT'                   
                               TO WS-REMARKS                                    
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              DISPLAY 'ERROR REWRITING BP13K671, STATUS : '                     
                       BP13K671-STATUS                                          
              PERFORM 7000-CLOSING-ROUTINE THRU 7000-EXIT                       
           END-IF.                                                              
                                                                                
       5900-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------*                                                  
       6000-PRINT-RECORD.                                                       
      *----------------------*                                                  
           IF WS-LINE-CTR > 54                                                  
              PERFORM 6100-PRINT-HDG THRU 6100-EXIT                             
           END-IF.                                                              
                                                                                
           PERFORM 6200-PRINT-DETAIL THRU 6200-EXIT.                            
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------*                                                        
       6100-PRINT-HDG.                                                          
      *----------------*                                                        
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                               
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
              DELIMITED BY SIZE INTO L348-DATE.                                 
                                                                                
           ADD   1            TO    WS-PAGE-CTR.                                
           MOVE  WS-PAGE-CTR  TO    L348-PAGE.                                  
           WRITE BP13L348-REC FROM L348-HEADER1 AFTER PAGE.                     
           WRITE BP13L348-REC FROM L348-HEADER2 AFTER 2.                        
           WRITE BP13L348-REC FROM L348-HEADER3 AFTER 2.                        
           WRITE BP13L348-REC FROM L348-HEADER4 AFTER 1.                        
           MOVE  6            TO    WS-LINE-CTR.                                
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       6200-PRINT-DETAIL.                                                       
      *------------------*                                                      
           MOVE SPACES                   TO   L348-NUM-REGN                     
                                              L348-NUM-SCH-ACCT                 
                                              L348-NUM-VALUE-DATE.              
                                                                                
           MOVE ZEROES                   TO   L348-AMT-IDP-PD                   
                                              L348-AMT-IDP-REQ                  
                                              L348-AMT-STAMP-FEE-PD             
                                              L348-AMT-STAMP-FEE-REQ.           
                                                                                
           MOVE WS-NUM-REGN              TO   L348-NUM-REGN.                    
                                                                                
           ADD 1                         TO   WS-PRINT-CNT.                     
           MOVE WS-PRINT-CNT             TO   L348-SNO.                         
                                                                                
           MOVE WS-NUM-CPF               TO   L348-NUM-CPF.                     
                                                                                
           STRING WS-SCH-ACCT(1:4) '-'                                          
                  WS-SCH-ACCT(5:4) '-'                                          
                  WS-SCH-ACCT(9:1) '-'                                          
                  WS-SCH-ACCT(10:2)                                             
                  DELIMITED BY SIZE      INTO L348-NUM-SCH-ACCT.                
                                                                                
           MOVE WS-PRINT-IDP-PD          TO   L348-AMT-IDP-PD.                  
           MOVE WS-PRINT-IDP-REQ         TO   L348-AMT-IDP-REQ.                 
           MOVE WS-PRINT-TOTAL-FEE       TO   L348-AMT-STAMP-FEE-PD.            
           MOVE WS-LEGAL-FEES-REQ        TO   L348-AMT-STAMP-FEE-REQ.           
                                                                                
           STRING WS-NUM-VALUE-DATE(7:2) '/'                                    
                  WS-NUM-VALUE-DATE(5:2) '/'                                    
                  WS-NUM-VALUE-DATE(1:4)                                        
                  DELIMITED BY SIZE INTO   L348-NUM-VALUE-DATE.                 
                                                                                
           MOVE WS-REMARKS               TO   L348-REMARKS.                     
                                                                                
           WRITE BP13L348-REC FROM L348-DETAIL AFTER 1.                         
           MOVE SPACES                   TO L348-DETAIL.                        
           WRITE BP13L348-REC FROM L348-DETAIL AFTER 1.                         
           ADD 2                         TO   WS-LINE-CTR.                      
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
      *1. SOC           - SAP                                                   
      *2. LUMPSUM       - LSM                                                   
      *3. LSE STMP      - LSP                                                   
      *3. SALE CONVY    - SCN                                                   
      *5. MORT CONVY    - MCN                                                   
      *6. SRVY FEE      - SRF                                                   
      *7. LSE ESCR      - LES                                                   
      *8. LSE REGN      - LRG                                                   
      *9. CAVT REGN     - CRG                                                   
      *10.SOLICIT       - SLP                                                   
      ************************************************************              
                                                                                
      *----------------------*                                                  
       6500-CHECK-CPF1.                                                         
      *----------------------*                                                  
                                                                                
           IF (K671-DTE-VALUE-CPF1 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF1 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF1-NO       TO WS-NRIC.                              
           MOVE '1'                    TO WS-CDE-APPLT-CPF.                     
                                                                                
           IF K671-AMT-SOC-CPF1-PAID > 0                                        
              MOVE 'SAP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SOC-CPF1-PAID        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF1-PAID > 0                                    
              MOVE 'LSM'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LUMPSUM-CPF1-PAID    TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-PAID > 0                                   
              MOVE 'LSP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-STMP-CPF1-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-PAID > 0                                 
              MOVE 'SCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SALE-CONVY-CPF1-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-PAID > 0                                 
              MOVE 'MCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-MORT-CONVY-CPF1-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF1-PAID > 0                                   
              MOVE 'SRF'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SRVY-FEE-CPF1-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF1-PAID > 0                                   
              MOVE 'LES'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-ESCR-CPF1-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF1-PAID > 0                                   
              MOVE 'LRG'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-REGN-CPF1-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-PAID > 0                                
              MOVE 'CRG'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-CAVEAT-REGN-CPF1-PAID TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF1-PAID > 0                                    
              MOVE 'SLP'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-SOLICIT-CPF1-PAID     TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------*                                                  
       6550-CHECK-CPF2.                                                         
      *----------------------*                                                  
                                                                                
           IF (K671-DTE-VALUE-CPF2 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF2 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF2-NO       TO WS-NRIC.                              
           MOVE '2'                    TO WS-CDE-APPLT-CPF.                     
                                                                                
           IF K671-AMT-SOC-CPF2-PAID > 0                                        
              MOVE 'SAP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SOC-CPF2-PAID        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-PAID > 0                                    
              MOVE 'LSM'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LUMPSUM-CPF2-PAID    TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2-PAID > 0                                   
              MOVE 'LSP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-STMP-CPF2-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2-PAID > 0                                 
              MOVE 'SCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SALE-CONVY-CPF2-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2-PAID > 0                                 
              MOVE 'MCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-MORT-CONVY-CPF2-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2-PAID > 0                                   
              MOVE 'SRF'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SRVY-FEE-CPF2-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2-PAID > 0                                   
              MOVE 'LES'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-ESCR-CPF2-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2-PAID > 0                                   
              MOVE 'LRG'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-REGN-CPF2-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2-PAID > 0                                
              MOVE 'CRG'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-CAVEAT-REGN-CPF2-PAID TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2-PAID > 0                                    
              MOVE 'SLP'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-SOLICIT-CPF2-PAID     TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
       6550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------*                                                  
       6600-CHECK-CPF3.                                                         
      *----------------------*                                                  
                                                                                
           IF (K671-DTE-VALUE-CPF3 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF3 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF3-NO       TO WS-NRIC.                              
           MOVE '3'                    TO WS-CDE-APPLT-CPF.                     
                                                                                
           IF K671-AMT-SOC-CPF3-PAID > 0                                        
              MOVE 'SAP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SOC-CPF3-PAID        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-PAID > 0                                    
              MOVE 'LSM'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LUMPSUM-CPF3-PAID    TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3-PAID > 0                                   
              MOVE 'LSP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-STMP-CPF3-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3-PAID > 0                                 
              MOVE 'SCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SALE-CONVY-CPF3-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3-PAID > 0                                 
              MOVE 'MCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-MORT-CONVY-CPF3-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3-PAID > 0                                   
              MOVE 'SRF'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SRVY-FEE-CPF3-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3-PAID > 0                                   
              MOVE 'LES'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-ESCR-CPF3-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3-PAID > 0                                   
              MOVE 'LRG'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-REGN-CPF3-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3-PAID > 0                                
              MOVE 'CRG'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-CAVEAT-REGN-CPF3-PAID TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3-PAID > 0                                    
              MOVE 'SLP'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-SOLICIT-CPF3-PAID     TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------*                                                  
       6650-CHECK-CPF4.                                                         
      *----------------------*                                                  
                                                                                
           IF (K671-DTE-VALUE-CPF4 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF4 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF4-NO       TO WS-NRIC.                              
           MOVE '4'                    TO WS-CDE-APPLT-CPF.                     
                                                                                
           IF K671-AMT-SOC-CPF4-PAID > 0                                        
              MOVE 'SAP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SOC-CPF4-PAID        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-PAID > 0                                    
              MOVE 'LSM'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LUMPSUM-CPF4-PAID    TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4-PAID > 0                                   
              MOVE 'LSP'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-STMP-CPF4-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4-PAID > 0                                 
              MOVE 'SCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SALE-CONVY-CPF4-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4-PAID > 0                                 
              MOVE 'MCN'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-MORT-CONVY-CPF4-PAID TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4-PAID > 0                                   
              MOVE 'SRF'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-SRVY-FEE-CPF4-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4-PAID > 0                                   
              MOVE 'LES'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-ESCR-CPF4-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4-PAID > 0                                   
              MOVE 'LRG'                         TO WS-PAY-TYPE                 
              MOVE K671-AMT-LSE-REGN-CPF4-PAID   TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4-PAID > 0                                
              MOVE 'CRG'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-CAVEAT-REGN-CPF4-PAID TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4-PAID > 0                                    
              MOVE 'SLP'                          TO WS-PAY-TYPE                
              MOVE K671-AMT-SOLICIT-CPF4-PAID     TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
       6650-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------*                                                  
       6900-WRITE-F121.                                                         
      *----------------------*                                                  
                                                                                
           MOVE SPACES                TO BP13F121-CPFTRAN                       
                                         BP13F120-CASHTRAN.                     
                                                                                
           INITIALIZE                    BP13F121-CPFTRAN                       
                                         BP13F120-CASHTRAN.                     
                                                                                
           MOVE K671-NUM-REGN         TO F121-NUM-REGN.                         
           MOVE WS-DTE-CPF            TO F121-DTE-POST.                         
           MOVE WS-SYSTEM-DATE        TO F121-DTE-TRANS.                        
           MOVE ZEROS                 TO F121-COUNT-HISTORY.                    
           MOVE WS-AMOUNT             TO F121-AMT-RECIEPT.                      
           MOVE K671-NUM-SCH-ACC      TO F121-NUM-SCH-ACCT.                     
           MOVE 'BANKCPF 404151'      TO F121-NUM-RECPT-JRNO.                   
           MOVE '40'                  TO F121-CDE-TRANS-TYPE.                   
           MOVE WS-PAY-TYPE           TO F121-CDE-PAYMENT-TYPE.                 
           MOVE WS-NRIC               TO F121-NUM-NRIC.                         
           MOVE WS-CDE-APPLT-CPF      TO F121-CDE-APPLT-CPF.                    
                                                                                
           IF WS-SYS-MM = WS-CPF-MM                                             
              WRITE BP13F121-CPFTRAN                                            
              ADD 1 TO WS-WRITE-F121                                            
           ELSE                                                                 
              WRITE BP13F120-CASHTRAN FROM BP13F121-CPFTRAN                     
              ADD 1 TO WS-WRITE-F120                                            
           END-IF.                                                              
                                                                                
       6900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------*                                                  
       7000-CLOSING-ROUTINE.                                                    
      *----------------------*                                                  
           CLOSE BB24F04A                                                       
                 BP13K671                                                       
                 BP13F121                                                       
                 BP13F120                                                       
                 SY02F001                                                       
                 BM06K110                                                       
                 BP13L348.                                                      
                                                                                
           DISPLAY '*************** BP13C348 **************'.                   
           DISPLAY 'BB24F04A RECORDS READ            : ' WS-READ-CNT.           
           DISPLAY 'BM06K110 RECORDS READ            : ' WS-READ-K110.          
           DISPLAY 'BM06K110 RECORDS NOT FOUND       : '                        
                    WS-NOT-FND-K110.                                            
           DISPLAY 'BP13K671 RECORDS READ            : ' WS-READ-K671.          
           DISPLAY 'BP13K671 RECORDS NOT FOUND       : '                        
                    WS-NOT-FND-K671.                                            
           DISPLAY 'BB24F04A CPF NOT MATCHING K671   :'                         
                    WS-NOT-MTCH-K671.                                           
           DISPLAY 'BP13K671 RECORDS UPDATED         : ' WS-PROCESS-CNT.        
           DISPLAY 'BP13F120 RECORDS WRITE           : ' WS-WRITE-F120.         
           DISPLAY 'BP13F121 RECORDS WRITE           : ' WS-WRITE-F121.         
           DISPLAY 'BP13L348 RECORDS PRINTED         : ' WS-PRINT-CNT.          
           DISPLAY '*************** BP13C348 ***************'.                  
                                                                                
             IF BM06K110-STATUS NOT = 0 AND 97                                  
                DISPLAY 'CLOSING ERROR, K110-STATUS ' BM06K110-STATUS           
                MOVE BM06K110-STATUS TO RETURN-CODE.                            
                                                                                
             IF BP13K671-STATUS NOT = 0 AND 97                                  
                DISPLAY 'CLOSING ERROR, K671-STATUS ' BP13K671-STATUS           
                MOVE BP13K671-STATUS TO RETURN-CODE.                            
                                                                                
           STOP RUN.                                                            
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
