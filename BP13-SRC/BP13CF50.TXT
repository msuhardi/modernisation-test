       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13CF50.                                                  
      *AUTHOR.       ZDD1.                                                      
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (SOC)                                 *            
      * ========================================================== *            
      *  OBJECTIVE:                                                *            
      *  PRINT REPORT FOR LIST OF CASES FOR CEREMONY               *            
      *                                                            *            
      *  I    :  BM06F120                                          *            
      *  I/O  :  BP13K800                                          *            
      * ========================================================== *            
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BM06F120 ASSIGN TO BM06F120.                                  
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K800-NUM-REGN                              
                  FILE STATUS     IS WS-K800-STATUS.                            
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS DYNAMIC                                    
                  RECORD KEY      IS K820-KEY-FLD                               
                  FILE STATUS     IS WS-K820-STATUS.                            
                                                                                
           SELECT BP13K830 ASSIGN TO BP13K830                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K830-KEY-FLD                               
                  FILE STATUS     IS WS-K830-STATUS.                            
                                                                                
           SELECT BP13K857 ASSIGN TO BP13K857                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K857-KEY-FLD                               
                  FILE STATUS     IS WS-K857-STATUS.                            
                                                                                
           SELECT BP13K022 ASSIGN TO BP13K022                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K022-KEY-FLD                               
                  ALTERNATE KEY   IS K022-NUM-REGN                              
                  FILE STATUS     IS WS-K022-STATUS.                            
                                                                                
           SELECT BP13K640 ASSIGN TO BP13K640                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K640-REGN-NO                               
                  FILE STATUS     IS WS-K640-STATUS.                            
                                                                                
           SELECT BM06K110 ASSIGN TO BM06K110                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K110-KEY-FLD                               
                  FILE STATUS     IS WS-K110-STATUS.                            
                                                                                
           SELECT AB03K080 ASSIGN TO AB03K080                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS DYNAMIC                                    
                  RECORD KEY      IS K080-KEY                                   
                  FILE STATUS     IS WS-K080-STATUS.                            
                                                                                
           SELECT AB03K030 ASSIGN TO AB03K030                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K030-NUM-HDB-REF                           
                  FILE STATUS     IS WS-K030-STATUS.                            
                                                                                
           SELECT BP17K000 ASSIGN TO BP17K000                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS RANDOM                                     
                  RECORD KEY      IS K000-KEY-FLD                               
                  ALTERNATE KEY   IS K000-NUM-REGNO                             
                  FILE STATUS     IS WS-K000-STATUS.                            
                                                                                
           SELECT BP13RPT1 ASSIGN TO BP13RPT1.                                  
           SELECT BP13RPT2 ASSIGN TO BP13RPT2.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD  BM06F120   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 700  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY BM06F120.                                                           
                                                                                
       FD  BP13K800   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 2000 CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY BP13K800.                                                           
                                                                                
       FD  BP13K820   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 400 CHARACTERS                            
                      LABEL RECORDS ARE STANDARD.                               
       COPY BP13K820.                                                           
                                                                                
       FD  BP13K640   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 500 CHARACTERS                            
                      LABEL RECORDS ARE STANDARD.                               
       COPY BP13K640.                                                           
                                                                                
       FD  BP13K830   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 250  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY BP13K830.                                                           
                                                                                
       FD  BP13K022   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 100  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY BP13K022.                                                           
                                                                                
       FD  BP13K857   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 200  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY BP13K857.                                                           
                                                                                
       FD  BM06K110   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 500  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY BM06K110.                                                           
                                                                                
       FD  AB03K080   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 50   CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY AB03K080.                                                           
                                                                                
       FD  AB03K030   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 800  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY AB03K030.                                                           
                                                                                
       FD  BP17K000   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 200  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       COPY BP17K000.                                                           
                                                                                
       FD  BP13RPT1   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 125  CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       01  BP13RPT1-REC  PIC X(125).                                            
                                                                                
       FD  BP13RPT2   BLOCK CONTAINS 0 RECORDS                                  
                      RECORD CONTAINS 1515 CHARACTERS                           
                      LABEL RECORDS ARE STANDARD.                               
       01  BP13RPT2-REC.                                                        
          05  WS-REG-NO       PIC X(08).                                        
          05  FILLER1         PIC X(01).                                        
          05  WS-NEW-UNIT     PIC X(09).                                        
          05  FILLER2         PIC X(01).                                        
          05  WS-ELIG-SCH     PIC X(03).                                        
          05  FILLER3         PIC X(01).                                        
          05  WS-ALLOC-MODE   PIC X(03).                                        
          05  FILLER4         PIC X(01).                                        
          05  WS-ALLO-SCH     PIC X(03).                                        
          05  FILLER5         PIC X(01).                                        
          05  WS-SERS-ADD     PIC X(66).                                        
          05  FILLER6         PIC X(01).                                        
          05  WS-NRIC-HA1     PIC X(09).                                        
          05  FILLER6A        PIC X(01).                                        
          05  WS-NAME-HA1     PIC X(66).                                        
          05  FILLER7         PIC X(01).                                        
          05  WS-HA1-REL      PIC X(02).                                        
          05  FILLER8         PIC X(01).                                        
          05  WS-NRIC-HA2     PIC X(09).                                        
          05  FILLER8A        PIC X(01).                                        
          05  WS-NAME-HA2     PIC X(66).                                        
          05  FILLER9         PIC X(01).                                        
          05  WS-HA2-REL      PIC X(02).                                        
          05  FILLER10        PIC X(01).                                        
          05  WS-NRIC-HA3     PIC X(09).                                        
          05  FILLER11        PIC X(01).                                        
          05  WS-NAME-HA3     PIC X(66).                                        
          05  FILLER12        PIC X(01).                                        
          05  WS-HA3-REL      PIC X(02).                                        
          05  FILLER13        PIC X(01).                                        
          05  WS-NRIC-HA4     PIC X(09).                                        
          05  FILLER13A       PIC X(01).                                        
          05  WS-NAME-HA4     PIC X(66).                                        
          05  FILLER15        PIC X(01).                                        
          05  WS-HA4-REL      PIC X(02).                                        
          05  FILLER16        PIC X(01).                                        
          05  WS-NO-OCCUP1    PIC 9(02).                                        
          05  FILLER17        PIC X(01).                                        
          05  WS-NRIC-OCCUP1  PIC X(09).                                        
          05  FILLER18        PIC X(01).                                        
          05  WS-NAME-OCCUP1  PIC X(66).                                        
          05  FILLER19        PIC X(01).                                        
          05  WS-NRIC-OCCUP2  PIC X(09).                                        
          05  FILLER20        PIC X(01).                                        
          05  WS-NAME-OCCUP2  PIC X(66).                                        
          05  FILLER21        PIC X(01).                                        
          05  WS-NRIC-OCCUP3  PIC X(09).                                        
          05  FILLER22        PIC X(01).                                        
          05  WS-NAME-OCCUP3  PIC X(66).                                        
          05  FILLER23        PIC X(01).                                        
          05  WS-NRIC-OCCUP4  PIC X(09).                                        
          05  FILLER24        PIC X(01).                                        
          05  WS-NAME-OCCUP4  PIC X(66).                                        
          05  FILLER25        PIC X(01).                                        
          05  WS-NRIC-OCCUP5  PIC X(09).                                        
          05  FILLER26        PIC X(01).                                        
          05  WS-NAME-OCCUP5  PIC X(66).                                        
          05  FILLER27        PIC X(01).                                        
          05  WS-NRIC-OCCUP6  PIC X(09).                                        
          05  FILLER28        PIC X(01).                                        
          05  WS-NAME-OCCUP6  PIC X(66).                                        
          05  FILLER29        PIC X(01).                                        
          05  WS-NRIC-OCCUP7  PIC X(09).                                        
          05  FILLER30        PIC X(01).                                        
          05  WS-NAME-OCCUP7  PIC X(66).                                        
          05  FILLER31        PIC X(01).                                        
          05  WS-NRIC-OCCUP8  PIC X(09).                                        
          05  FILLER32        PIC X(01).                                        
          05  WS-NAME-OCCUP8  PIC X(66).                                        
          05  FILLER33        PIC X(01).                                        
          05  WS-NRIC-OCCUP9  PIC X(09).                                        
          05  FILLER34        PIC X(01).                                        
          05  WS-NAME-OCCUP9  PIC X(66).                                        
          05  FILLER35        PIC X(01).                                        
          05  WS-NRIC-OCCUP10 PIC X(09).                                        
          05  FILLER36        PIC X(01).                                        
          05  WS-NAME-OCCUP10 PIC X(66).                                        
          05  FILLER37        PIC X(01).                                        
          05  WS-NRIC-OCCUP11 PIC X(09).                                        
          05  FILLER38        PIC X(01).                                        
          05  WS-NAME-OCCUP11 PIC X(66).                                        
          05  FILLER39        PIC X(01).                                        
          05  WS-NRIC-OCCUP12 PIC X(09).                                        
          05  FILLER40        PIC X(01).                                        
          05  WS-NAME-OCCUP12 PIC X(66).                                        
          05  FILLER41        PIC X(01).                                        
          05  WS-COR-BLK      PIC X(16).                                        
          05  FILLER42        PIC X(01).                                        
          05  WS-COR-STREET   PIC X(32).                                        
          05  FILLER43        PIC X(01).                                        
          05  WS-COR-FLAT     PIC X(11).                                        
          05  FILLER44        PIC X(01).                                        
          05  WS-COR-POSTAL   PIC X(06).                                        
          05  FILLER45        PIC X(01).                                        
          05  WS-CONTACT-NUM  PIC X(08).                                        
          05  FILLER46        PIC X(01).                                        
          05  WS-FLAT-TYPE    PIC X(02).                                        
          05  FILLER47        PIC X(01).                                        
          05  WS-LOAN-TAG     PIC X(01).                                        
          05  FILLER48        PIC X(01).                                        
          05  WS-HH-INCOME    PIC ZZZZ9.                                        
          05  FILLER49        PIC X(01).                                        
          05  WS-AHG          PIC X(03).                                        
          05  FILLER50        PIC X(01).                                        
          05  WS-AHG-STAT     PIC X(01).                                        
          05  FILLER51        PIC X(01).                                        
          05  WS-OCS-TAG      PIC X(01).                                        
          05  FILLER52        PIC X(01).                                        
          05  WS-SMS-REC      PIC X(01).                                        
          05  FILLER53        PIC X(01).                                        
          05  WS-PROV-TAG     PIC X(01).                                        
          05  FILLER54        PIC X(01).                                        
          05  WS-OIC          PIC X(05).                                        
          05  FILLER55        PIC X(01).                                        
          05  WS-EMAIL        PIC X(50).                                        
          05  FILLER56        PIC X(01).                                        
          05  WS-LOAN-AMT     PIC X(08).                                        
          05  FILLER57        PIC X(01).                                        
          05  WS-HOUSEHOLD    PIC X(02).                                        
          05  FILLER58        PIC X(01).                                        
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01  WS-SWITCHES.                                                         
           05  WS-K800-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K820-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K640-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K830-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K022-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K110-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K080-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K030-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K857-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-K000-STATUS            PIC 99    VALUE ZEROS.                 
           05  WS-F120-EOF               PIC X     VALUE 'N'.                   
           05  WS-PROCESS                PIC X     VALUE 'N'.                   
           05  WS-FOUND                  PIC X     VALUE 'N'.                   
           05  WS-FOUND-SMS              PIC X     VALUE 'N'.                   
           05  WS-FOUND-SERS             PIC X     VALUE 'N'.                   
           05  WS-FLAG                   PIC X     VALUE 'N'.                   
           05  WS-NRIC                   PIC X(9)  VALUE SPACES.                
           05  WS-F120-READ              PIC 9(6)  VALUE ZEROS.                 
           05  WS-K800-READ              PIC 9(6)  VALUE ZEROS.                 
           05  WS-K800-REWRITE           PIC 9(6)  VALUE ZEROS.                 
           05  WS-K800-NOTFND            PIC 9(6)  VALUE ZEROS.                 
           05  WS-K857-NOTFND            PIC 9(6)  VALUE ZEROS.                 
           05  WS-K000-NOTFND            PIC 9(6)  VALUE ZEROS.                 
           05  WS-BYPASS                 PIC 9(6)  VALUE ZEROS.                 
           05  WS-CNT-L000-WRITE         PIC 9(6)  VALUE ZEROS.                 
           05  WS-NO-OCCUP               PIC 9(5)  VALUE ZEROS.                 
           05  WS-HH-TOT-INC             PIC 9(5)  VALUE ZEROS.                 
           05  WS-SEQ-CNT                 PIC 9(5)   VALUE ZEROES.              
           05  WS-PAGE-CNT                PIC 9(5)   VALUE 0.                   
           05  WS-LINE-CNT                PIC 9(2)   VALUE 46.                  
                                                                                
       01  WS-CURRENT-DATE.                                                     
           05  WS-CUR-CCYYMMDD.                                                 
               10  WS-CURR-CCYY           PIC X(4).                             
               10  WS-CURR-MM             PIC X(2).                             
               10  WS-CURR-DD             PIC X(2).                             
      *----------------------------------------------------------------*        
      *    REPORT LAYOUT OF  VOUCHER LIST.                             *        
      *----------------------------------------------------------------*        
       01  L000-PRT-HDR-1.                                                      
           05  FILLER                     PIC X      VALUE SPACE.               
           05  FILLER                     PIC X(8)   VALUE 'BP13L000'.          
           05  FILLER                     PIC X(5)   VALUE SPACES.              
           05  FILLER                     PIC X(4)   VALUE 'HDB3'.              
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  FILLER                     PIC X(39)                             
               VALUE 'S Y S T E M   O F   C O M M I T M E N T'.                 
           05  FILLER                     PIC X(05)  VALUE SPACES.              
           05  FILLER                     PIC X(9)   VALUE 'PAGE   : '.         
           05  L000-PRT-PAGE              PIC ZZZZ9.                            
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  FILLER                     PIC X(7)   VALUE 'DATE : '.           
           05  L000-PRT-DATE              PIC X(10)  VALUE SPACES.              
                                                                                
       01  L000-PRT-HDR-2.                                                      
           05  FILLER                     PIC X(52)  VALUE SPACES.              
           05  FILLER                     PIC X(44)                             
           VALUE 'LIST OF CASES FOR LETTER PRINTING'.                           
                                                                                
       01  L000-PRT-HDR-3.                                                      
           05  FILLER                  PIC X(02)  VALUE SPACES.                 
           05  FILLER                  PIC X(05)  VALUE ' S/N '.                
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(08)  VALUE 'REGN NO.'.             
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(10)  VALUE '# OF OCCUP'.           
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(09)  VALUE 'CONTACT #'.            
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(06)  VALUE 'FT TYP'.               
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(05)  VALUE 'OIC'.                  
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(08)  VALUE 'LOAN TAG'.             
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(10)  VALUE 'CUR LESSEE'.           
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(05)  VALUE 'FT/ST'.                
           05  FILLER                  PIC X(03)  VALUE SPACES.                 
           05  FILLER                  PIC X(07)  VALUE 'OCS TAG'.              
                                                                                
       01  L000-PRT-HDR-4.                                                      
           05  FILLER                     PIC X(100) VALUE ALL '='.             
                                                                                
       01  L000-PRT-DETAIL.                                                     
           05  FILLER                     PIC X(02)  VALUE SPACES.              
           05  L000-SER-NO                PIC ZZZZ9.                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-REGN-NO               PIC X(08).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-NO-OCCUP              PIC X(10).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-CONTACT-NUM           PIC X(09).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-FLAT-TYPE             PIC X(06).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-OIC                   PIC X(05).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-LOAN-TAG              PIC X(08).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-CUR-LESSEE            PIC X(10).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-HH-TYPE               PIC X(05).                            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L000-OCS-TAG               PIC X(07).                            
                                                                                
       01  L000-PRT-DETAIL-A.                                                   
           05  FILLER                  PIC X(20)  VALUE SPACES.                 
           05  FILLER                  PIC X(09)  VALUE 'HA NAME :'.            
           05  L000-HA1-NAME           PIC X(30).                               
           05  FILLER                  PIC X(05)  VALUE SPACES.                 
           05  L000-HA2-NAME           PIC X(30).                               
                                                                                
       01  L000-PRT-DETAIL-A1.                                                  
           05  FILLER                  PIC X(29)  VALUE SPACES.                 
           05  L000-HA3-NAME           PIC X(30).                               
           05  FILLER                  PIC X(05)  VALUE SPACES.                 
           05  L000-HA4-NAME           PIC X(30).                               
                                                                                
       01  L000-PRT-DETAIL-B.                                                   
           05  FILLER                  PIC X(20)  VALUE SPACES.                 
           05  FILLER                  PIC X(10)  VALUE 'CORR ADD :'.           
           05  L000-COR-BLK            PIC X(16).                               
           05  FILLER                  PIC X(01)  VALUE SPACE.                  
           05  L000-COR-STREET         PIC X(32).                               
           05  FILLER                  PIC X(01)  VALUE SPACE.                  
           05  L000-COR-FLAT           PIC X(11).                               
           05  FILLER                  PIC X(01)  VALUE SPACE.                  
           05  L000-COR-POSTAL         PIC X(06).                               
                                                                                
       01  L000-PRT-DETAIL-C.                                                   
           05  FILLER                  PIC X(20)  VALUE SPACES.                 
           05  FILLER                  PIC X(10)  VALUE 'NEW ADD  :'.           
           05  L000-NEW-BLK            PIC X(05).                               
           05  FILLER                  PIC X(01)  VALUE SPACE.                  
           05  L000-NEW-STREET         PIC X(32).                               
           05  FILLER                  PIC X(01)  VALUE SPACE.                  
           05  L000-NEW-FLAT           PIC X(09).                               
           05  FILLER                  PIC X(01)  VALUE SPACE.                  
           05  L000-NEW-POSTAL         PIC X(06).                               
                                                                                
      *-------------------------------------------------------*                 
      *    COPY BOOK FOR SUBROUTINE - BP13C913.               *                 
      *-------------------------------------------------------*                 
       COPY P13COMM8.                                                           
                                                                                
      *-------------------------------------------------------*                 
      *    LINKAGE VARIABLES                                  *                 
      *-------------------------------------------------------*                 
       01   WS-LINK-REC.                                                        
            05 WS-LINK-NUM-SCH            PIC X(4).                             
            05 WS-LINK-NUM-ACC            PIC X(4).                             
            05 WS-LINK-NUM-CHK            PIC X(1).                             
                                                                                
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       000-MAIN-LOGIC.                                                          
            PERFORM 100-OPEN-FILES      THRU 100-EXIT.                          
            PERFORM 200-READ-BM06F120   THRU 200-EXIT.                          
            PERFORM 400-PROCESS-REC     THRU 400-EXIT                           
                UNTIL WS-F120-EOF = 'Y'.                                        
            PERFORM 999-CLOSE-FILES     THRU 999-EXIT.                          
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
       100-OPEN-FILES.                                                          
      *-------------------------------------------------------------            
           OPEN INPUT  BM06F120                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                       BP13K640                                                 
                       BP13K830                                                 
                       BP13K022                                                 
                       BP13K857                                                 
                       BM06K110                                                 
                       AB03K080                                                 
                       AB03K030                                                 
                       BP17K000                                                 
                OUTPUT BP13RPT1                                                 
                       BP13RPT2.                                                
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K800-STATUS ' WS-K800-STATUS              
              MOVE WS-K800-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K820-STATUS ' WS-K820-STATUS              
              MOVE WS-K820-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K640-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K640-STATUS ' WS-K640-STATUS              
              MOVE WS-K640-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K830-STATUS ' WS-K830-STATUS              
              MOVE WS-K830-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K022-STATUS ' WS-K022-STATUS              
              MOVE WS-K022-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K110-STATUS ' WS-K110-STATUS              
              MOVE WS-K110-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K080-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K080-STATUS ' WS-K080-STATUS              
              MOVE WS-K080-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K030-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K030-STATUS ' WS-K030-STATUS              
              MOVE WS-K030-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K857-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K857-STATUS ' WS-K857-STATUS              
              MOVE WS-K857-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
           IF WS-K000-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR, K000-STATUS ' WS-K000-STATUS              
              MOVE WS-K000-STATUS       TO RETURN-CODE                          
              PERFORM 999-CLOSE-FILES THRU 999-EXIT.                            
                                                                                
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO  WS-CUR-CCYYMMDD.                 
           STRING WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY                    
                  DELIMITED BY SIZE INTO L000-PRT-DATE.                         
           STRING 'REGN NO;UNIT NO;ALLOC MODE;ELG SCH;ALC SCH;'                 
                  'SERS ADDR;HA1 NRIC;HA 1;HA1 REL;HA2 NRIC;'                   
                  'HA 2;HA2 REL;HA3 NRIC;HA 3; HA3 REL;HA4 NRIC;HA 4;'          
                  'HA4 REL;NO OF OCCUP;'                                        
                  'OCCUP1 NRIC;OCCUP1;OCCUP2 NRIC;OCCUP2;'                      
                  'OCCUP3 NRIC;OCCUP3;OCCUP4 NRIC;OCCUP4;'                      
                  'OCCUP5 NRIC;OCCUP5;OCCUP6 NRIC;OCCUP6;'                      
                  'OCCUP7 NRIC;OCCUP7;OCCUP8 NRIC;OCCUP8;'                      
                  'OCCUP9 NRIC;OCCUP9;OCCUP10 NRIC;OCCUP10;'                    
                  'OCCUP11 NRIC;OCCUP11;OCCUP12 NRIC;OCCUP12;'                  
                  'BLK;STREET;UNIT;POSTAL;CONTACT #;FT;LOAN TAG;'               
                  'HH INCOME;AHG;AHG STAT;OCS TAG;LESSEE;OIC;PROV TAG;'         
                  'EMAIL;LOAN AMT;HH;'                                          
                  DELIMITED BY SIZE INTO BP13RPT2-REC.                          
           WRITE BP13RPT2-REC.                                                  
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
       200-READ-BM06F120.                                                       
      *-------------------------------------------------------------            
           READ BM06F120 AT END                                                 
           MOVE 'Y'                      TO WS-F120-EOF                         
           GO TO 200-EXIT.                                                      
                                                                                
           ADD 1                         TO WS-F120-READ.                       
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       400-PROCESS-REC.                                                         
      *-------------------------------------------------------------            
                                                                                
            MOVE SPACES          TO L000-PRT-DETAIL                             
                                    L000-PRT-DETAIL-A                           
                                    L000-PRT-DETAIL-A1                          
                                    L000-PRT-DETAIL-B                           
                                    L000-PRT-DETAIL-C                           
                                    BP13RPT2-REC.                               
            MOVE ZEROES          TO WS-NO-OCCUP1                                
                                     WS-HH-TOT-INC.                             
                                                                                
            PERFORM  401-MOVE-FILLER   THRU 401-EXIT.                           
                                                                                
            MOVE SPACES                 TO BP13K800-MASTER                      
            MOVE F120-REGN-NO           TO K800-NUM-REGN                        
                                           L000-REGN-NO                         
                                           WS-REG-NO                            
            PERFORM 500-PROCESS-K800    THRU 500-EXIT.                          
            MOVE K800-NUM-FLAT-TYPE     TO L000-FLAT-TYPE                       
                                           WS-FLAT-TYPE                         
            MOVE K800-NUM-LOAN-TAG      TO L000-LOAN-TAG                        
                                           WS-LOAN-TAG.                         
            MOVE K800-NUM-ALLO-CAT      TO WS-ALLOC-MODE.                       
            MOVE K800-NUM-PROV-TAG      TO WS-PROV-TAG.                         
                                                                                
            IF K800-NUM-NRIC1 NOT = SPACES AND LOW-VALUES                       
                AND K800-NUM-NRIC1(1:1) NOT = '#'                               
               MOVE SPACES          TO AB03K080-REC                             
               MOVE K800-NUM-NRIC1  TO K080-NUM-UIN                             
                                       WS-NRIC                                  
               PERFORM 600-READ-K080       THRU 600-EXIT                        
               MOVE WS-FOUND-SMS           TO L000-CUR-LESSEE                   
                                           WS-SMS-REC                           
      *        ADD 1 TO WS-NO-HA                                                
               MOVE SPACES TO BP13K820-REC                                      
               MOVE F120-REGN-NO  TO K820-NUM-REGN                              
               MOVE K800-NUM-NRIC1         TO K820-NUM-NRIC                     
               PERFORM 510-READ-K820       THRU 510-EXIT                        
               MOVE K820-NME-OCCP          TO L000-HA1-NAME                     
                                              WS-NAME-HA1                       
               MOVE K800-NUM-NRIC1         TO WS-NRIC-HA1                       
               MOVE K820-NUM-HP-PGR        TO L000-CONTACT-NUM                  
                                              WS-CONTACT-NUM                    
               IF K820-AMT-INCOME NOT = SPACES AND LOW-VALUES                   
                COMPUTE WS-HH-TOT-INC = WS-HH-TOT-INC + K820-AMT-INCOME         
               END-IF                                                           
               MOVE K820-NUM-RELATIONSHIP   TO WS-HA1-REL                       
            END-IF.                                                             
            IF K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES                       
                AND K800-NUM-NRIC2(1:1) NOT = '#'                               
               IF WS-FOUND-SMS NOT = 'Y'                                        
                 MOVE SPACES          TO AB03K080-REC                           
                 MOVE K800-NUM-NRIC2  TO K080-NUM-UIN                           
                                       WS-NRIC                                  
                 PERFORM 600-READ-K080       THRU 600-EXIT                      
                 MOVE WS-FOUND-SMS           TO L000-CUR-LESSEE                 
                                             WS-SMS-REC                         
               END-IF                                                           
      *        ADD 1 TO WS-NO-HA                                                
               MOVE SPACES TO BP13K820-REC                                      
               MOVE F120-REGN-NO  TO K820-NUM-REGN                              
               MOVE K800-NUM-NRIC2         TO K820-NUM-NRIC                     
               PERFORM 510-READ-K820       THRU 510-EXIT                        
               MOVE K820-NME-OCCP          TO L000-HA2-NAME                     
                                              WS-NAME-HA2                       
               MOVE K800-NUM-NRIC2        TO WS-NRIC-HA2                        
               IF K820-AMT-INCOME NOT = SPACES AND LOW-VALUES                   
                COMPUTE WS-HH-TOT-INC = WS-HH-TOT-INC + K820-AMT-INCOME         
               END-IF                                                           
               MOVE K820-NUM-RELATIONSHIP   TO WS-HA2-REL                       
            END-IF.                                                             
            IF K800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES                       
                AND K800-NUM-NRIC3(1:1) NOT = '#'                               
               IF WS-FOUND-SMS NOT = 'Y'                                        
                 MOVE SPACES          TO AB03K080-REC                           
                 MOVE K800-NUM-NRIC3  TO K080-NUM-UIN                           
                                       WS-NRIC                                  
               MOVE K800-NUM-NRIC3        TO WS-NRIC-HA3                        
                 PERFORM 600-READ-K080       THRU 600-EXIT                      
                 MOVE WS-FOUND-SMS           TO L000-CUR-LESSEE                 
                                             WS-SMS-REC                         
               END-IF                                                           
      *        ADD 1 TO WS-NO-HA                                                
               MOVE SPACES TO BP13K820-REC                                      
               MOVE F120-REGN-NO  TO K820-NUM-REGN                              
               MOVE K800-NUM-NRIC3         TO K820-NUM-NRIC                     
               PERFORM 510-READ-K820       THRU 510-EXIT                        
               MOVE K820-NME-OCCP          TO L000-HA3-NAME                     
                                              WS-NAME-HA3                       
               IF K820-AMT-INCOME NOT = SPACES AND LOW-VALUES                   
                COMPUTE WS-HH-TOT-INC = WS-HH-TOT-INC + K820-AMT-INCOME         
               END-IF                                                           
               MOVE K820-NUM-RELATIONSHIP   TO WS-HA3-REL                       
            END-IF.                                                             
            IF K800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES                       
                AND K800-NUM-NRIC4(1:1) NOT = '#'                               
               IF WS-FOUND-SMS NOT = 'Y'                                        
                 MOVE SPACES          TO AB03K080-REC                           
                 MOVE K800-NUM-NRIC4  TO K080-NUM-UIN                           
                                       WS-NRIC                                  
               MOVE K800-NUM-NRIC4        TO WS-NRIC-HA4                        
                 PERFORM 600-READ-K080       THRU 600-EXIT                      
                 MOVE WS-FOUND-SMS           TO L000-CUR-LESSEE                 
                                             WS-SMS-REC                         
               END-IF                                                           
      *        ADD 1 TO WS-NO-HA                                                
               MOVE SPACES TO BP13K820-REC                                      
               MOVE F120-REGN-NO  TO K820-NUM-REGN                              
               MOVE K800-NUM-NRIC4         TO K820-NUM-NRIC                     
               PERFORM 510-READ-K820       THRU 510-EXIT                        
               MOVE K820-NME-OCCP          TO L000-HA4-NAME                     
                                              WS-NAME-HA4                       
               IF K820-AMT-INCOME NOT = SPACES AND LOW-VALUES                   
                COMPUTE WS-HH-TOT-INC = WS-HH-TOT-INC + K820-AMT-INCOME         
               END-IF                                                           
               MOVE K820-NUM-RELATIONSHIP   TO WS-HA4-REL                       
                                                                                
            END-IF.                                                             
                                                                                
            MOVE SPACES                 TO BP13K830-REC.                        
            MOVE F120-REGN-NO           TO K830-KEY-FLD.                        
            PERFORM 520-READ-K830       THRU 520-EXIT.                          
            MOVE K830-NUM-BLK           TO WS-COR-BLK  L000-COR-BLK             
            MOVE K830-NME-STREET-BLDG   TO WS-COR-STREET L000-COR-STREET        
            MOVE K830-NUM-FLAT          TO WS-COR-FLAT L000-COR-FLAT            
            MOVE K830-NUM-POSTAL        TO WS-COR-POSTAL L000-COR-POSTAL        
            MOVE SPACES                 TO K022-KEY-FLD.                        
            MOVE F120-REGN-NO           TO K022-NUM-REGN.                       
            PERFORM 530-READ-K022       THRU 530-EXIT.                          
            MOVE K022-NUM-OIC           TO L000-OIC                             
                                           WS-OIC.                              
                                                                                
                                                                                
            MOVE F120-UNIT-NO           TO WS-NEW-UNIT L000-NEW-FLAT            
                                                                                
            MOVE K800-CDE-BALLOT-HOUSEHOLD TO L000-HH-TYPE.                     
                                                                                
            MOVE SPACES  TO K110-REC.                                           
            MOVE F120-SCH-ACC-NO   TO K110-KEY-FLD.                             
            PERFORM 570-READ-K110       THRU 570-EXIT.                          
            IF K110-CDE-POD-TAG = SPACES OR LOW-VALUES                          
               MOVE K110-CDE-POF-TAG       TO L000-OCS-TAG                      
                                              WS-OCS-TAG                        
            ELSE                                                                
               MOVE K110-CDE-POD-TAG       TO L000-OCS-TAG                      
                                              WS-OCS-TAG                        
            END-IF.                                                             
                                                                                
            PERFORM 550-READ-BP13K820   THRU 550-EXIT.                          
            MOVE WS-NO-OCCUP            TO L000-NO-OCCUP                        
                                           WS-NO-OCCUP1.                        
            MOVE K800-NUM-AHG           TO WS-AHG.                              
            MOVE K800-NUM-AHG-STATUS    TO WS-AHG-STAT.                         
            MOVE K800-NUM-ALLO-SCHEME   TO WS-ALLO-SCH.                         
            MOVE K800-NUM-ELIG-SCHEME   TO WS-ELIG-SCH.                         
            MOVE K800-NUM-HOUSEHOLD     TO WS-HOUSEHOLD.                        
            MOVE WS-HH-TOT-INC          TO WS-HH-INCOME.                        
                                                                                
            MOVE SPACES   TO BP13K857-REC.                                      
            MOVE F120-REGN-NO  TO K857-NUM-REGN                                 
            PERFORM 620-PROCESS-K857    THRU 620-EXIT.                          
            MOVE K857-NUM-EMAIL         TO WS-EMAIL.                            
                                                                                
            MOVE F120-REGN-NO  TO K000-NUM-REGNO                                
            PERFORM 630-READ-BP17K000   THRU 630-EXIT.                          
            IF WS-FOUND-SERS = 'Y'                                              
              PERFORM 640-READ-PIDB       THRU 640-EXIT                         
            END-IF.                                                             
                                                                                
            MOVE SPACES                 TO BP13K640-TRANS-REC.                  
            MOVE F120-REGN-NO           TO K640-REGN-NO                         
            PERFORM 580-READ-K640       THRU 580-EXIT.                          
            MOVE K640-AMT-MAX-LOAN      TO WS-LOAN-AMT.                         
                                                                                
            PERFORM 700-UPD-REPORT      THRU 700-EXIT.                          
            WRITE BP13RPT2-REC.                                                 
            PERFORM 200-READ-BM06F120   THRU 200-EXIT.                          
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
       401-MOVE-FILLER.                                                         
      *-------------------------------------------------------------            
                                                                                
            MOVE ';'        TO FILLER1    FILLER2                               
                               FILLER3    FILLER4                               
                               FILLER5    FILLER6                               
                               FILLER6A   FILLER8A                              
                               FILLER13A                                        
                               FILLER7    FILLER8                               
                               FILLER9    FILLER10                              
                               FILLER11   FILLER12                              
                               FILLER13                                         
                               FILLER15   FILLER16                              
                               FILLER17   FILLER18                              
                               FILLER19   FILLER20                              
                               FILLER21   FILLER22                              
                               FILLER23   FILLER24                              
                               FILLER25   FILLER26                              
                               FILLER27   FILLER28                              
                               FILLER29   FILLER30                              
                               FILLER31   FILLER32                              
                               FILLER33   FILLER34                              
                               FILLER35   FILLER36                              
                               FILLER37   FILLER38                              
                               FILLER39   FILLER40                              
                               FILLER41   FILLER42                              
                               FILLER43   FILLER44                              
                               FILLER45   FILLER46                              
                               FILLER47   FILLER48                              
                               FILLER49   FILLER50                              
                               FILLER51   FILLER52                              
                               FILLER53   FILLER54                              
                               FILLER55   FILLER56                              
                               FILLER57   FILLER58.                             
       401-EXIT.                                                                
           EXIT.                                                                
                                                                                
       500-PROCESS-K800.                                                        
      *-------------------------------------------------------------            
                                                                                
             READ BP13K800                                                      
                                                                                
             IF WS-K800-STATUS = 00                                             
                CONTINUE                                                        
             ELSE                                                               
                IF WS-K800-STATUS = 23                                          
                   ADD 1 TO WS-K800-NOTFND                                      
                   MOVE 'N'  TO WS-FOUND                                        
                   DISPLAY 'RECORD NOT FND IN BP13K800 ' WS-K800-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP13K800,STATUS ' WS-K800-STATUS         
                   MOVE WS-K800-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
       510-READ-K820.                                                           
      *-------------------------------------------------------------            
             READ BP13K820                                                      
                                                                                
             IF WS-K820-STATUS = 00                                             
                CONTINUE                                                        
             ELSE                                                               
                IF WS-K820-STATUS = 23                                          
                   MOVE 'N'  TO WS-FOUND                                        
                   DISPLAY 'RECORD NOT FND IN BP13K820 ' WS-K820-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP13K820,STATUS ' WS-K820-STATUS         
                   MOVE WS-K820-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       510-EXIT.                                                                
           EXIT.                                                                
                                                                                
       520-READ-K830.                                                           
      *-------------------------------------------------------------            
             READ BP13K830                                                      
                                                                                
             IF WS-K830-STATUS = 00                                             
                MOVE 'Y' TO WS-FOUND                                            
             ELSE                                                               
                IF WS-K830-STATUS = 23                                          
                   MOVE 'N'  TO WS-FOUND                                        
                   DISPLAY 'RECORD NOT FND IN BP13K830 ' WS-K830-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP13K830,STATUS ' WS-K830-STATUS         
                   MOVE WS-K830-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       520-EXIT.                                                                
           EXIT.                                                                
                                                                                
       530-READ-K022.                                                           
      *-------------------------------------------------------------            
             READ BP13K022 KEY IS K022-NUM-REGN.                                
                                                                                
             IF WS-K022-STATUS = 00 OR 02                                       
                CONTINUE                                                        
             ELSE                                                               
                IF WS-K022-STATUS = 23                                          
                   MOVE 'N'  TO WS-FOUND                                        
                   DISPLAY 'RECORD NOT FND IN BP13K022 ' WS-K022-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP13K022,STATUS ' WS-K022-STATUS         
                   MOVE WS-K022-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       530-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       550-READ-BP13K820.                                                       
      *-------------------------------------------------------------            
           MOVE  SPACES       TO BP13K820-REC.                                  
           MOVE  'N'          TO WS-FLAG.                                       
           MOVE   ZEROES      TO WS-NO-OCCUP.                                   
           MOVE  F120-REGN-NO TO K820-NUM-REGN.                                 
           START BP13K820 KEY >  K820-KEY-FLD.                                  
                                                                                
           IF WS-K820-STATUS = 00                                               
                 PERFORM UNTIL WS-FLAG = 'Y'                                    
                    READ BP13K820 NEXT RECORD                                   
                         AT END MOVE 'Y' TO WS-FLAG                             
                    END-READ                                                    
                    IF WS-K820-STATUS = 00                                      
                       IF K820-NUM-REGN = F120-REGN-NO                          
                         IF K820-NUM-NRIC NOT = K800-NUM-NRIC1 AND              
                                                K800-NUM-NRIC2 AND              
                                                K800-NUM-NRIC3 AND              
                                                K800-NUM-NRIC4                  
                            ADD 1 TO WS-NO-OCCUP                                
                            EVALUATE WS-NO-OCCUP                                
                              WHEN 01                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP1          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP1          
                              WHEN 02                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP2          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP2          
                              WHEN 03                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP3          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP3          
                              WHEN 04                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP4          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP4          
                              WHEN 05                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP5          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP5          
                              WHEN 06                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP6          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP6          
                              WHEN 07                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP7          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP7          
                              WHEN 08                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP8          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP8          
                              WHEN 09                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP9          
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP9          
                              WHEN 10                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP10         
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP10         
                              WHEN 11                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP11         
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP11         
                              WHEN 12                                           
                                 MOVE K820-NUM-NRIC  TO WS-NRIC-OCCUP12         
                                 MOVE K820-NME-OCCP  TO WS-NAME-OCCUP12         
                            END-EVALUATE                                        
                            IF K820-AMT-INCOME NOT =                            
                               SPACES AND LOW-VALUES                            
                              COMPUTE WS-HH-TOT-INC =                           
                                WS-HH-TOT-INC + K820-AMT-INCOME                 
                            END-IF                                              
                         END-IF                                                 
                       ELSE                                                     
                         MOVE 'Y' TO WS-FLAG                                    
                       END-IF                                                   
                    END-IF                                                      
                 END-PERFORM                                                    
           ELSE                                                                 
              DISPLAY 'ERROR WITH START READ OF BP13K820. STATUS IS '           
                       WS-K820-STATUS                                           
              MOVE WS-K820-STATUS              TO RETURN-CODE                   
              GO TO 999-CLOSE-FILES                                             
           END-IF.                                                              
                                                                                
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
       570-READ-K110.                                                           
      *-------------------------------------------------------------            
             READ BM06K110                                                      
                                                                                
             IF WS-K110-STATUS = 00                                             
                CONTINUE                                                        
             ELSE                                                               
                IF WS-K110-STATUS = 23                                          
                   MOVE 'N'  TO WS-FOUND                                        
                   DISPLAY 'RECORD NOT FND IN BP13K110 ' WS-K110-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP13K110,STATUS ' WS-K110-STATUS         
                   MOVE WS-K110-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       570-EXIT.                                                                
           EXIT.                                                                
                                                                                
       580-READ-K640.                                                           
      *-------------------------------------------------------------            
             READ BP13K640                                                      
                                                                                
             IF WS-K640-STATUS = 00                                             
                CONTINUE                                                        
             ELSE                                                               
                IF WS-K640-STATUS = 23                                          
                   MOVE 'N'  TO WS-FOUND                                        
                   DISPLAY 'RECORD NOT FND IN BP13K640 ' WS-K640-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP13K640,STATUS ' WS-K640-STATUS         
                   MOVE WS-K110-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       580-EXIT.                                                                
           EXIT.                                                                
                                                                                
       600-READ-K080.                                                           
      *-------------------------------------------------------------            
           MOVE 'N'  TO WS-FLAG                                                 
           START AB03K080 KEY >  K080-KEY                                       
                                                                                
           IF WS-K080-STATUS = 00                                               
                 PERFORM UNTIL WS-FLAG = 'Y'                                    
                    READ AB03K080 NEXT RECORD                                   
                         AT END MOVE 'Y' TO WS-FLAG                             
                    END-READ                                                    
                    IF WS-K080-STATUS = 00                                      
                       IF WS-NRIC       = K080-NUM-UIN                          
                        MOVE SPACES TO AB03K030-REC                             
                        MOVE K080-NUM-HDB-REF TO K030-NUM-HDB-REF               
                        PERFORM 610-READ-K030   THRU 610-EXIT                   
                       ELSE                                                     
                         MOVE 'Y' TO WS-FLAG                                    
                       END-IF                                                   
                    END-IF                                                      
                 END-PERFORM                                                    
           ELSE                                                                 
              DISPLAY 'ERROR WITH START READ OF BP13K820. STATUS IS '           
                       WS-K820-STATUS                                           
              MOVE WS-K820-STATUS              TO RETURN-CODE                   
              GO TO 999-CLOSE-FILES                                             
           END-IF.                                                              
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
       610-READ-K030.                                                           
      *-------------------------------------------------------------            
             READ AB03K030                                                      
                                                                                
             IF WS-K030-STATUS = 00                                             
                MOVE 'Y'    TO WS-FOUND-SMS                                     
             ELSE                                                               
                IF WS-K030-STATUS = 23                                          
                   MOVE 'N'  TO WS-FOUND-SMS                                    
                   DISPLAY 'RECORD NOT FND IN AB03K030 ' WS-K030-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ AB03K030,STATUS ' WS-K030-STATUS         
                   MOVE WS-K030-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       610-EXIT.                                                                
           EXIT.                                                                
                                                                                
       620-PROCESS-K857.                                                        
      *-------------------------------------------------------------            
                                                                                
             READ BP13K857                                                      
                                                                                
             IF WS-K857-STATUS = 00                                             
                CONTINUE                                                        
             ELSE                                                               
                IF WS-K857-STATUS = 23                                          
                   ADD 1 TO WS-K857-NOTFND                                      
                   MOVE 'N'  TO WS-FOUND                                        
                   DISPLAY 'RECORD NOT FND IN BP13K857 ' WS-K857-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP13K857,STATUS ' WS-K857-STATUS         
                   MOVE WS-K857-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       620-EXIT.                                                                
           EXIT.                                                                
                                                                                
       630-READ-BP17K000.                                                       
      *-------------------------------------------------------------            
                                                                                
             READ BP17K000 KEY IS K000-NUM-REGNO                                
                                                                                
             IF WS-K000-STATUS = 00                                             
                CONTINUE                                                        
                MOVE 'Y'  TO WS-FOUND-SERS                                      
             ELSE                                                               
                IF WS-K000-STATUS = 23                                          
                   ADD 1 TO WS-K000-NOTFND                                      
                   MOVE 'N'  TO WS-FOUND-SERS                                   
                   DISPLAY 'RECORD NOT FND IN BP17K000 ' WS-K000-STATUS         
                ELSE                                                            
                   DISPLAY 'ERROR READ BP17K000,STATUS ' WS-K000-STATUS         
                   MOVE WS-K000-STATUS     TO RETURN-CODE                       
                   GO TO 999-CLOSE-FILES.                                       
                                                                                
       630-EXIT.                                                                
           EXIT.                                                                
                                                                                
       640-READ-PIDB.                                                           
      *-------------------------------------------------------------            
                                                                                
      *  TO CALL SUBROUTINE BP13C913,GETTING ADDRESS                            
           MOVE SPACES                   TO WS-LINK-REC.                        
           MOVE K000-NUM-SCH-ACC(1:4)    TO WS-LINK-NUM-SCH.                    
           MOVE K000-NUM-SCH-ACC(5:4)    TO WS-LINK-NUM-ACC.                    
           MOVE K000-NUM-SCH-ACC(9:1)    TO WS-LINK-NUM-CHK.                    
           PERFORM 650-CALL-BP13C913      THRU 650-EXIT.                        
                                                                                
                                                                                
       640-EXIT.                                                                
           EXIT.                                                                
                                                                                
       650-CALL-BP13C913.                                                       
      *-------------------------------------------------------------            
                                                                                
           CALL 'BP13C913' USING                                                
                 WS-LINK-REC, BP13COMM8-REC                                     
           END-CALL.                                                            
                                                                                
           IF COMM8-CDE-SYSERR  = 0                                             
               STRING  'BLK ' COMM8-NUM-BLK ' ' COMM8-NME-STREET                
                    ' # ' COMM8-NUM-LEVEL '-' COMM8-NUM-UNIT-MAIN               
                    ' ' COMM8-NUM-POSTAL-CODE DELIMITED BY SIZE INTO            
                    WS-SERS-ADD                                                 
           END-IF.                                                              
                                                                                
           IF COMM8-CDE-SYSERR NOT = 0                                          
                                                                                
              IF COMM8-CDE-SYSERR = 100                                         
                 DISPLAY 'SCH-ACC NOT FOUND IN PBF TABLE'                       
                         COMM8-CDE-SYSERR                                       
                 MOVE SPACES TO   WS-SERS-ADD                                   
              ELSE                                                              
                 DISPLAY 'ERROR READING PBF TABLE' COMM8-CDE-SYSERR             
              END-IF                                                            
              MOVE SPACES        TO BP13COMM8-REC                               
           END-IF.                                                              
                                                                                
       650-EXIT.                                                                
           EXIT.                                                                
                                                                                
       700-UPD-REPORT.                                                          
      *-------------------------------------------------------------            
                                                                                
           ADD  1              TO WS-SEQ-CNT.                                   
           MOVE WS-SEQ-CNT     TO L000-SER-NO.                                  
                                                                                
           IF WS-LINE-CNT > 45                                                  
              PERFORM  710-PRT-HEADING  THRU  710-EXIT                          
              MOVE 0   TO WS-LINE-CNT                                           
           END-IF.                                                              
                                                                                
           WRITE BP13RPT1-REC  FROM L000-PRT-DETAIL     AFTER 2.                
           WRITE BP13RPT1-REC  FROM L000-PRT-DETAIL-A   AFTER 1.                
           IF L000-HA3-NAME NOT = SPACES AND LOW-VALUES                         
              WRITE BP13RPT1-REC  FROM L000-PRT-DETAIL-A1  AFTER 1              
           END-IF                                                               
           WRITE BP13RPT1-REC  FROM L000-PRT-DETAIL-B   AFTER 1.                
           WRITE BP13RPT1-REC  FROM L000-PRT-DETAIL-C   AFTER 1.                
           ADD   1             TO   WS-CNT-L000-WRITE.                          
           ADD   6             TO   WS-LINE-CNT.                                
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
       710-PRT-HEADING.                                                         
      *-------------------------------------------------------------            
           ADD   1                   TO WS-PAGE-CNT.                            
           MOVE  WS-PAGE-CNT         TO L000-PRT-PAGE.                          
                                                                                
           WRITE BP13RPT1-REC  FROM L000-PRT-HDR-1   AFTER PAGE.                
           WRITE BP13RPT1-REC  FROM L000-PRT-HDR-2   AFTER 1.                   
           WRITE BP13RPT1-REC  FROM L000-PRT-HDR-3   AFTER 2.                   
           WRITE BP13RPT1-REC  FROM L000-PRT-HDR-4   AFTER 1.                   
                                                                                
           MOVE 5                    TO WS-LINE-CNT.                            
                                                                                
       710-EXIT.                                                                
           EXIT.                                                                
                                                                                
       999-CLOSE-FILES.                                                         
      *-------------------------------------------------------------            
           DISPLAY '* ------------ BP13CF50 ------------- * '.                  
           DISPLAY 'NO OF REC READ    BM06F120 = ' WS-F120-READ.                
           DISPLAY 'NO OF REC WRITTEN BP13RPT1 = ' WS-CNT-L000-WRITE.           
                                                                                
           CLOSE BM06F120 BP13K830 BP13K820 BP13K022 BM06K110                   
                 BP13K800 AB03K080 AB03K030 BP13RPT1 BP13RPT2                   
                 BP13K857 BP17K000 BP13K640.                                    
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BP13K800, STATUS ' WS-K800-STATUS          
              MOVE WS-K800-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K857-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BP13K857, STATUS ' WS-K857-STATUS          
              MOVE WS-K857-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BP13K820, STATUS ' WS-K820-STATUS          
              MOVE WS-K820-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BP13K830, STATUS ' WS-K830-STATUS          
              MOVE WS-K830-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BP13K022, STATUS ' WS-K022-STATUS          
              MOVE WS-K022-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K640-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BP13K640, STATUS ' WS-K640-STATUS          
              MOVE WS-K640-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BM06K110, STATUS ' WS-K110-STATUS          
              MOVE WS-K110-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K080-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING AB03K080, STATUS ' WS-K080-STATUS          
              MOVE WS-K080-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K030-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING AB03K030, STATUS ' WS-K030-STATUS          
              MOVE WS-K030-STATUS        TO RETURN-CODE.                        
                                                                                
           IF WS-K000-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR CLOSING BP17K000, STATUS ' WS-K000-STATUS          
              MOVE WS-K000-STATUS        TO RETURN-CODE.                        
                                                                                
           STOP RUN.                                                            
                                                                                
       999-EXIT.                                                                
           EXIT.                                                                
