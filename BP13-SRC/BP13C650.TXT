      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
       PROGRAM-ID.    BP13C650.                                                 
       AUTHOR.        SGK.                                                      
      *DATE-WRITTEN.  28/08/97.                                                 
                                                                                
      * ============================================================== *        
      *                  SYSTEM OF COMMITMENT  (BP13)                  *        
      * ============================================================== *        
      *                                                                *        
      *   OBJECTIVE   :  1.  THIS IS A PROGRAM TO PRINT OUT            *        
      *                      TP LETTER + WORKSHEET FOR CA CASES.       *        
      *                                                                *        
      *   FOR TP ¦ CA=E/Y ¦ SALES-TYPE=10 ¦ NON-SERS ¦ PREM & NON-PREM *        
      * ============================================================== *        
      *                                                                *        
      *  CHGE-NO   BY      DATE     DESCRIPTION                        *        
      *  -------   ---  ----------  -----------                        *        
      *  BP130302  SGK  12/05/1998  NEW PGM FOR TP.                    *        
      *  BP130418  SGK  27/08/1998  CATER FOR Y2K.                     *        
      *  BP130539  SGK  27/10/1998  TO CHECK FLOOR-AREA <= 90 FOR      *        
      *                             IDP-SCH = 'NRT' & ALLOC-SCH = 'REN'*        
      *  BP130636  JMS  12/02/1999  TO CATER FOR TC RECOVERY AMOUNT    *        
      *  BP130580  JMS  15/04/1999  TO CATER FOR NEW FORM FOR BP134D   *        
      *  BP130669  JMS  28/05/1999  TO CATER FOR LOAN TOP UP AMT       *        
      *                             FOR CA=Y CASES.                    *        
      *  BP130690  JMS  09/07/1999  TO CHECK LOAN WITH K640-AMX-LOAN   *        
      *                             AND RECALCULATE FEES FOR LESS LOAN *        
      *                             USING NEW SUBROUTINE (BP13C90A).   *        
      *  BP130799  JMS  15/03/2000  TO REMOVE K640-CDE-LOAN-OPTION-APPL*        
      *  BP130885  RAS  26/06/2000  TO CHANGE BP13C902 TO BP13C903     *        
      *  BP130883  RAS  08/08/2000  TO TAKE PIDB FIELDS FROM BP13F310. *        
      *  BP130952  ESC  29/12/2000  TO CATER FOR RED ALLOC SCHEME      *        
      *  BP130998  CLT  02/15/2001  ENHANCE AB20C900 FOR SA FLAT       *        
      *  BP131036  RAS  14/06/2001  TO CATER FOR ALLOC CODES: SFC & SRC*        
      *  BP132031  MALC 03/10/2001  TO CATER FOR SALE OF SERS FLAT     *        
      *                             TO SINGLES                         *        
      *  BP132037  CKK  24/10/2001  TO ADD HALF IDP CODE IN WORKSHEET  *        
      *  BP132093  MALC 05/02/2002  TO CATER FOR 5% PURCH PRICE forfeit*        
      *  BP132097  MALC 11/02/2002  CATER FOR MARRIED CHILD PRIO SCHEME*        
      *  BP132125  MCC  07/04/2002  ROUNDING OF ODD CENTS              *        
      *  BP132095  CKK  22/04/2002  TO PRINT BARCODE FOR QMS AND REMOVE*        
      *                             PRINTING OF JUNK-MAIL LETTER       *        
      *  BP132127  CKK  13/05/2002  CHANGE LETTER LAYOUT               *        
      *  BP132160  AS1  26/06/2002  MOVE THE BAR CODE FROM TOP TO BOTTOM        
      *  BP132232  MALC 21/10/2002  CHGE LETTER FROM BP1325 to BP1327  *        
      *                             TO CATER FOR CSM INFO              *        
      *  BP132232  MALC 29/10/2002  IF ALLO-CAT = WIS, APPLN-TYPE = S  *        
      *                             NEW-TOWN = JW & K022-FOUND GET CSM *        
      *  BP132237  MALC 28/10/2002  RESTORE ORIGINAL FEES AND TO SHOW  *        
      *                             30% OFF-BUDGET DISC IN BRACKET     *        
      *  BP132263  MALC 14/11/2002  TO REMOVE 30% OFF-BUDGET DISC      *        
      *                             & TO CATER FOR CHANGE OF GST       *        
      *  BP132266  CKK  04/01/2003  TO ADD NEW KEY FIELD FOR K022      *        
      *  BP132352  CKK  24/05/2003  TO READ K024                       *        
      *  BP132352  SK   07/06/2003  TO REMOVE PRINTING HP NUMBER       *        
      *  BP132399  MALC 12/08/2003  CALL BP13C904 TO GET CD PERCENTAGE *        
      *  BP132429  MALC 14/11/2003  TO HARDCODE 5% GST                 *        
      *  BP132485  MJ16 01/03/2004  TO INCLUDE CHECKING OF SERS TABLE  *        
      *                             TO SERS INCLUDE 3 NEW ALLOC SCHEMES*        
      *                             TABLE.('SFO','SRO','SJO')          *        
      *  BP132568  JF4  22/07/2004  CATER FOR ENHANCEMENT OF APPT LTR  *        
      *  BP132588  JF4  24/08/2004  PASS SYSTEM DATE TO AB20C900 PGM   *        
      *  BP132660  JF4  15/03/2005  TO GET PREMIUM FROM BP13K800       *        
      *  BP132707  JF4  29/06/2005  INITIALIZE VARS FOR AGE COMPUTATION*        
      *  BP135109  RJE1 20/12/2013  LETTERHEADS WITH NEW PUBLIC MAILBOX*        
      *                             EMAIL ADDRESSES                    *        
      *  BP139485  kac1 02/01/2024  to call bp13c90d for 9 % gst       *        
      *                             wef 20240101                       *        
      ******************************************************************        
                                                                                
      ***********************                                                   
       ENVIRONMENT DIVISION.                                                    
      ***********************                                                   
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F310  ASSIGN       TO BP13F310.                           
           SELECT P13L650A  ASSIGN       TO P13L650A.                           
                                                                                
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS BP13K022-STATUS.                    
                                                                                
           SELECT BP13K024  ASSIGN       TO BP13K024                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K024-KEY-FLD                        
                            FILE STATUS  IS BP13K024-STATUS.                    
                                                                                
           SELECT BP13K800  ASSIGN       TO BP13K800                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K800-NUM-REGN                       
                            FILE STATUS  IS BP13K800-STATUS.                    
                                                                                
           SELECT BP13K820  ASSIGN       TO BP13K820                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K820-KEY-FLD                        
                            FILE STATUS  IS BP13K820-STATUS.                    
                                                                                
           SELECT BP13K830  ASSIGN       TO BP13K830                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K830-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K830-NUM-REGN               
                            FILE STATUS  IS BP13K830-STATUS.                    
                                                                                
           SELECT BP13K640  ASSIGN       TO BP13K640                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K640-KEY-FLD                        
                            FILE STATUS  IS BP13K640-STATUS.                    
                                                                                
           SELECT BM06K110  ASSIGN       TO BM06K110                            
                            ACCESS  MODE IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD   KEY IS K110-KEY-FLD                        
                            FILE STATUS  IS BM06K110-STATUS.                    
                                                                                
           SELECT BM06K100  ASSIGN       TO BM06K100                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K100-KEY-FLD                        
                            FILE STATUS  IS BM06K100-STATUS.                    
                                                                                
           SELECT AB03K050  ASSIGN       TO AB03K050                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K050-KEY                            
                            FILE STATUS  IS AB03K050-STATUS.                    
                                                                                
           SELECT P13L650B  ASSIGN       TO P13L650B.                           
           SELECT P13L650D  ASSIGN       TO P13L650D.                           
           SELECT P13L650E  ASSIGN       TO P13L650E.                           
                                                                                
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F310                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13F310.                                                           
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K640                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K640.                                                           
                                                                                
       FD   AB03K050                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY AB03K050.                                                           
                                                                                
       FD  P13L650A                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 80  CHARACTERS.                                      
       01  P13L650A-REC                     PIC X(80).                          
                                                                                
       FD  P13L650B                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  PRINT-REC2                       PIC X(132).                         
                                                                                
       FD  P13L650D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 80  CHARACTERS.                                      
       01  PRINT-REC4                       PIC X(80).                          
                                                                                
       FD  P13L650E                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 80  CHARACTERS.                                      
       01  PRINT-REC5                       PIC X(80).                          
                                                                                
      **************************                                                
       WORKING-STORAGE SECTION.                                                 
      **************************                                                
                                                                                
       COPY SERSCH.                                                             
       COPY AV02COMM.                                                           
       COPY AB20M97C.                                                           
       COPY P13COMCD.                                                           
                                                                                
       01  WS-C908-PARAMETERS.                                                  
           05  WS-INPUT-PARAMETERS.                                             
               10  WS-C908-TXT-IN-SIZE       PIC 9(2).                          
               10  WS-C908-TXT-INPUT         PIC X(30).                         
           05  WS-OUTPUT-PARAMETERS.                                            
               10  WS-C908-TXT-OUT-SIZE      PIC 9(2).                          
               10  WS-C908-TXT-OUTPUT        PIC X(40).                         
           05  WS-C908-RETCODE               PIC S9(04)  COMP.                  
                                                                                
       01  WS-INDICATORS.                                                       
           05  BP13K022-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K024-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K800-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K820-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K830-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K640-STATUS              PIC 99    VALUE ZEROS.              
           05  BM06K100-STATUS              PIC 99    VALUE ZEROS.              
           05  BM06K110-STATUS              PIC 99    VALUE ZEROS.              
           05  AB03K050-STATUS              PIC 99    VALUE ZEROS.              
           05  WS-F310-EOF                  PIC X     VALUE 'N'.                
           05  WS-K820-EOF                  PIC X     VALUE 'N'.                
           05  WS-K050-EOF                  PIC X     VALUE 'N'.                
           05  WS-REGN-CHGE                 PIC X     VALUE 'N'.                
           05  K110-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K022-FOUND                   PIC X     VALUE 'N'.                
           05  K024-FOUND                   PIC X     VALUE 'N'.                
           05  K800-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K820-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K830-NOT-FOUND               PIC X     VALUE 'N'.                
           05  WS-FIRST-CASE                PIC X     VALUE 'Y'.                
                                                                                
       01  WS-AB03K050-REC                  PIC X(200) VALUE SPACES.            
       01  WS-K050-CDE-LOAN-SCH             PIC X(1)   VALUE SPACES.            
       01  WS-COUNTERS.                                                         
           05  WS-CNT-F310                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K110                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K820                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K830                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K640                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K022                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K024                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CTR                       PIC 9     VALUE ZEROS.              
           05  WS-CTR2                      PIC 9     VALUE ZEROS.              
           05  WS-PAGE-NO                   PIC 9(4)  VALUE ZEROS.              
           05  WS-CNT                       PIC 9(2)  VALUE ZEROS.              
           05  WS-SEQ-NO                    PIC 9(4)  VALUE ZEROS.              
           05  WS-CNT-PROC                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-LETTERS               PIC 9(3)  VALUE ZEROS.              
           05  WS-PRINT-LETTERS             PIC X(1)  VALUE SPACE.              
           05  WS-CNT-SKIPPED               PIC 9(3)  VALUE ZERO.               
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-EMAIL                     PIC X(19) VALUE SPACES.             
           05  WS-HDR-PHONE-DID             PIC X(25) VALUE SPACES.             
           05  WS-NAME                      PIC X(66) VALUE SPACES.             
                                                                                
           05  WS-VALID-DATE.                                                   
               10  WS-VALID-YYYY            PIC 9999.                           
                   88 VALID-YEAR1           VALUE 1900 THRU 2100.               
               10  WS-VALID-MM              PIC 99.                             
                   88 VALID-MONTH1          VALUE 1 THRU 12.                    
               10  WS-VALID-DD              PIC 99.                             
                   88 VALID-DATE1           VALUE 1 THRU 31.                    
                                                                                
           05  WS-K820-KEY.                                                     
               10  WS-K820-REGN             PIC X(8)  VALUE SPACES.             
               10  FILLER                   PIC X(9)  VALUE SPACES.             
                                                                                
           05  WS-ACC.                                                          
               10  WS-ACCOUNT               PIC X(4)  VALUE SPACES.             
               10  WS-CDG                   PIC X(1)  VALUE SPACE.              
                                                                                
           05  WS-NUM-FIELD.                                                    
               10  WS-REM                   PIC 9(3)  VALUE ZEROES.             
               10  WS-YEAR                  PIC 9(4)  VALUE ZEROES.             
               10  WS-SC-CC1-AMT            PIC 9(5)V99     VALUE ZEROS.        
               10  WS-SC-CC2-AMT            PIC 9(5)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC1-GST       PIC 9(5)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC2-GST       PIC 9(5)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC3-GST       PIC 9(5)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC1-GST       PIC 9(3)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC2-GST       PIC 9(3)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC3-GST       PIC 9(3)V99     VALUE ZEROS.        
               10  WS-SC-CC-NUM-AMT         PIC 9(5)V99     VALUE ZEROS.        
               10  WS-SC-CC-NUM-AMT-GST     PIC 9(5)V99     VALUE ZEROS.        
               10  WS-ICP-TOP-UP            PIC S9(7)V99    VALUE ZEROS.        
                                                                                
           05  WS-SUB-UNIT.                                                     
               10  FILLER                   PIC X     VALUE '-'.                
               10  SUB-UNIT-NO              PIC X(3)  VALUE ZEROES.             
                                                                                
           05  WS-SC-CC-DESC.                                                   
               10  FILLER                   PIC X(1)   VALUE '('.               
               10  WS-SC-CC-AMT             PIC ZZ9.99 VALUE SPACES.            
               10  FILLER                   PIC X(1)   VALUE '+'.               
               10  WS-SC-CC-AMT-GST         PIC   9.99 VALUE SPACES.            
               10  FILLER                   PIC X(3)   VALUE 'GST'.             
               10  WS-SC-CC-SIGN            PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-REBATE-AMT      PIC   Z.ZZ  VALUE SPACES.           
               10  WS-SC-CC-REBATE-DESC     PIC X(3)   VALUE 'REB'.             
               10  WS-SC-CC-SIGN2           PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-GRANT-AMT       PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-GRANT-DESC      PIC X(3)   VALUE 'GRT'.             
               10  WS-SC-CC-SIGN3           PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-REB-SP-AMT      PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-REB-SP-DESC     PIC X(3)   VALUE 'SP)'.             
                                                                                
           05  WS-HH-INCOME                 PIC 9(6)     VALUE ZEROES.          
           05  WS-CD-CPF1                   PIC 9(7)V99  VALUE ZEROES.          
           05  WS-CA-INCOME                 PIC 9(6)     VALUE ZEROES.          
           05  WS-AMT-PREMIUM               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-AMT-PREMIUM-EDT           PIC $$$$,$$9.99.                    
           05  WS-PURCHASE-PRICE            PIC 9(8)V99  VALUE ZEROES.          
           05  WS-SELLING-PRICE             PIC $$$,$$$,$$9.99.                 
                                                                                
           05  WS-SKIP-PR-LINE              PIC 9(02)    VALUE 60.              
           05  WS-SKIP-PAGE-NO              PIC 9(03)    VALUE ZERO.            
                                                                                
           05  WS-K110-CSPRICE              PIC 9(8)     VALUE ZEROES.          
           05  WS-COMP-SELLPR               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-LS-FEE               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-CV-FEE               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-CONVEY-FEE                PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-TOTAL                PIC S9(8)V99  VALUE ZEROES.         
           05  WS-LS-LEAVE                  PIC S9(8)V99  VALUE ZEROES.         
           05  WS-CONV-LEAVE                PIC S9(8)V99  VALUE ZEROES.         
           05  WS-ROUND-CONVFEE             PIC S9(8)V99  VALUE ZEROES.         
           05  WS-TOTAL-SELLPR              PIC S9(8)V99  VALUE ZEROES.         
           05  WS-BALANCE-AMT               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-BALANCE                   PIC S9(7)V99  VALUE ZEROES.         
           05  WS-MAX-LOAN-AMT              PIC S9(7)V99  VALUE ZEROES.         
           05  WS-RND-UP-LOAN               PIC 9(7)      VALUE ZEROES.         
           05  WS-LOAN-DIFF                 PIC 9(6)      VALUE ZEROES.         
           05  WS-AMT-BAL-CD-CASH           PIC S9(7)V99  VALUE ZEROES.         
           05  WS-TOTAL-CD                  PIC S9(7)V99  VALUE ZEROES.         
           05  WS-TOTAL-FEES                PIC S9(6)V99  VALUE ZEROES.         
           05  WS-COMP-SURVEY-FEE           PIC S9(5)V99  VALUE ZEROES.         
           05  WS-COMP-LEASE                PIC S9(5)V99  VALUE ZEROES.         
           05  WS-COMP-MORTGAGE             PIC S9(5)V99  VALUE ZEROES.         
           05  WS-TOT-STAMP-FEE             PIC S9(5)V99  VALUE ZEROES.         
           05  WS-MORT-STAMP-FEE            PIC S9(5)V99  VALUE ZEROES.         
           05  WS-MORT-STAMP-FEE1           PIC S9(5)V99  VALUE ZEROES.         
           05  WS-TOT-SCCC                  PIC S9(5)V99  VALUE ZEROES.         
           05  WS-INTREST-RATE              PIC 9(2)V99  VALUE ZEROES.          
           05  WS-MTHLY-INSTAL              PIC 9(5)V99  VALUE ZEROES.          
           05  WS-LOAN-ROUND-DOWN.                                              
               10  WS-LOAN-INT-5            PIC 9(5)    VALUE ZEROS.            
               10  WS-LOAN-INT-2            PIC 9(2)V99 VALUE ZEROS.            
           05  WS-LOAN-ROUND-DOWN1          PIC 9(7)V99 VALUE ZEROS.            
                                                                                
           05  WS-COMPARE-DATE.                                                 
               10  WS-COMPARE-YYYY         PIC 9(4)   VALUE ZEROS.              
               10  WS-COMPARE-MM           PIC 99     VALUE ZEROS.              
                   88  FIRST-HALF              VALUE 01 02 03 04 05 06.         
                   88  SECOND-HALF             VALUE 07 08 09 10 11 12.         
               10  WS-COMPARE-DD           PIC 99     VALUE ZEROS.              
                                                                                
           05  WS-COMPUTE-DATE.                                                 
               10  WS-COMPUTE-CC        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-YY        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-MM        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-DD        PIC 99     VALUE ZEROS.                 
                                                                                
           05  WS-NUM-OIC               PIC X(5).                               
           05  WS-OIC-TABLE.                                                    
               10 WS-OIC-TAB OCCURS 5 TIMES PIC X.                              
           05  WS-OIC-EMAIL-TABLE.                                              
               10 WS-OIC-EMAIL-TAB OCCURS 5 TIMES PIC X.                        
                                                                                
       01  WS-SERS-VARIABLES.                                                   
           05 WS-ALLOC-SCH                  PIC X(03).                          
           05 WS-SCH-FND                    PIC X(01).                          
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C901"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S901.                                                        
           05  WS-S901-INT                 PIC 9V9(4)   VALUE ZEROES.           
           05  WS-S901-FAC                 PIC 9(2)     VALUE ZEROES.           
           05  WS-S901-ERL                 PIC X        VALUE SPACE.            
           05  WS-S901-LOAN-AMT            PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-ERL-LOAN-AMT        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S901-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S901-DESIGN              PIC X(3)     VALUE SPACES.           
           05  FILLER                      PIC X(1)     VALUE SPACE.            
           05  WS-S901-MTH-INSTAL          PIC S9(5)V99 VALUE +0.               
           05  WS-S901-SUB-INSTAL          PIC S9(5)V99 VALUE +0.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABELS PASSED  TO SUB-PROGRAM "BP13C905"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S905.                                                        
           05  WS-S905-SC-CC1              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC2              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC3              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-TOTAL-AMT        PIC 9(7)V99  VALUE ZEROES.           
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DTE.                                                          
               10  WS-DTE-YYYY              PIC X(4)  VALUE SPACES.             
               10  WS-DTE-MM                PIC X(2)  VALUE SPACES.             
               10  WS-DTE-DD                PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-EXPIRED-TP.                                               
               10  WS-DTE-EXPIRED-TP-DD     PIC X(2)  VALUE SPACES.             
               10  WS-SLASH1                PIC X     VALUE SPACE.              
               10  WS-DTE-EXPIRED-TP-MM     PIC X(2)  VALUE SPACES.             
               10  WS-SLASH2                PIC X     VALUE SPACE.              
               10  WS-DTE-EXPIRED-TP-YYYY   PIC X(4)  VALUE SPACES.             
                                                                                
           05  WS-ACCEPTANCE-DATE.                                              
               10  WS-ACCEPTANCE-CC         PIC 9(2)  VALUE 00.                 
               10  WS-ACCEPTANCE-YY         PIC 9(2)  VALUE 00.                 
               10  WS-ACCEPTANCE-MM         PIC 9(2)  VALUE 00.                 
               10  WS-ACCEPTANCE-DD         PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-AGE                       PIC 9(2)  VALUE ZERO.               
           05  WS-DOB1                      PIC 9(8)  VALUE 00.                 
           05  WS-DOB2                      PIC 9(8)  VALUE 00.                 
           05  WS-DOB3                      PIC 9(8)  VALUE 00.                 
           05  WS-DOB4                      PIC 9(8)  VALUE 00.                 
           05  WS-YNGST-DOB-NUM             PIC 9(8).                           
           05  WS-YNGST-DOB REDEFINES  WS-YNGST-DOB-NUM.                        
               09 WS-YNGST-CCYY             PIC 9(4).                           
               09 WS-YNGST-MMDD             PIC 9(4).                           
                                                                                
           05  WS-DATE-INT                  PIC S9(9).                          
                                                                                
           05  WS-CURRENT-DATE1             PIC 9(8)  VALUE ZERO.               
                                                                                
           05  WS-CUR-YYYYMMDD.                                                 
               10  WS-CUR-YYYY              PIC 9(4)  VALUE 00.                 
               10  WS-CUR-MM                PIC 99    VALUE 00.                 
               10  WS-CUR-DD                PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-EDITED-DATE.                                                  
               10  WS-EDIT-DD               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-EDIT-MM               PIC XX    VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-EDIT-YYYY             PIC X(4)  VALUE SPACES.             
                                                                                
           05  WS-CURRENT-DATE.                                                 
               10  WS-CURRENT-DD            PIC 99    VALUE 00.                 
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-CURRENT-MM            PIC 99    VALUE 00.                 
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-CURRENT-YYYY          PIC 9(4)  VALUE 00.                 
                                                                                
           05  WS-CURR-DATE.                                                    
                   15  WS-CCYY              PIC 9(4)  VALUE 00.                 
                   15  WS-MM                PIC 9(2)  VALUE 00.                 
                   15  WS-DD                PIC 9(2)  VALUE 00.                 
           05  WS-CURR-DATE-R  REDEFINES  WS-CURR-DATE.                         
               09  WS-YYYY                  PIC 9(4).                           
               09  WS-MMDD                  PIC 9(4).                           
           05  WS-CURR-DATE2                PIC 9(08).                          
           05  WS-CURR-DATE-R    REDEFINES WS-CURR-DATE2.                       
                 07 WS-CCYY2.                                                   
                   15  WS-CC2               PIC 9(2).                           
                   15  WS-YY2               PIC 9(2).                           
                 07 WS-CCYY2-R   REDEFINES   WS-CCYY2  PIC 9(4).                
                 07 WS-MMDD2.                                                   
                   15  WS-MM2               PIC 9(2).                           
                   15  WS-DD2               PIC 9(2).                           
                                                                                
           05  WS-DTE-WEF.                                                      
               10  WS-WEF-CC                PIC X(2)  VALUE SPACES.             
               10  WS-WEF-YY                PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X(1)  VALUE SPACE.              
               10  WS-WEF-MM                PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X(1)  VALUE SPACE.              
               10  WS-WEF-DD                PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-SCCC.                                                     
               10  WS-SCCC-DD               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-SCCC-MM               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-SCCC-CC               PIC X(2)  VALUE SPACES.             
               10  WS-SCCC-YY               PIC X(2)  VALUE SPACES.             
                                                                                
       01  DATE-REC.                                                            
           05  CAL-DATE.                                                        
               10  CAL-YEAR                 PIC 9(4).                           
                   88  VALID-YEAR               VALUE 1900 THRU 2100.           
               10  CAL-MONTH                PIC 9(2).                           
                   88  31-DAY-MONTH             VALUE 01, 03, 05, 07,           
                                                      08, 10, 12.               
                   88  30-DAY-MONTH             VALUE 04, 06, 09, 11.           
                   88  28-29-DAY-MONTH          VALUE 02.                       
                   88  VALID-MONTH              VALUE 01 THRU 12.               
               10  CAL-DAY                  PIC 9(2).                           
                   88  VALID-DAY                VALUE 01 THRU 31.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C903"          *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S903.                                                        
           05  WS-S903-NUM-SCH-ACC          PIC X(9)     VALUE SPACES.          
           05  WS-S903-SO-EFF-DATE.                                             
               10  WS-S903-SO-EFF-CC        PIC 9(2)     VALUE ZEROES.          
               10  WS-S903-SO-EFF-YYMMDD    PIC 9(6)     VALUE ZEROES.          
           05  WS-S903-DESIGN-TY            PIC X(3)     VALUE SPACES.          
           05  WS-S903-ROOM-TY              PIC X(2)     VALUE SPACES.          
           05  WS-S903-SC-CC1               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC2               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC3               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-TOTAL-AMT         PIC 9(7)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT1            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT2            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT3            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-CURR-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-SC-NEXT-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-RET-CODE             PIC X(2)     VALUE SPACES.          
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "AV02C021"          *             
      *-----------------------------------------------------------*             
       COPY P13GST01.                                                           
                                                                                
      *------------------------*                                                
      *  LINKAGE FOR AV02C015  *                                                
      *------------------------*                                                
        01  WS-LINK-AV02C015.                                                   
            05  AV02C015-IN-POSTCODE         PIC X(6).                          
            05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                          
                                                                                
       01  BLANK-LINE                       PIC X(80) VALUE SPACES.             
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1306)                 *             
      *-----------------------------------------------------------*             
                                                                                
       01  L650-LINE-OIC.                                                       
           05  FILLER                      PIC X(10)  VALUE SPACES.             
           05  L635-OIC-NAME               PIC X(30)  VALUE SPACES.             
           05  FILLER                      PIC X(26)  VALUE SPACES.             
                                                                                
       01  L650-LINE-OIC1.                                                      
           05  FILLER                      PIC X(10)  VALUE SPACES.             
           05  L635-OIC-DESG               PIC X(24)  VALUE SPACES.             
           05  FILLER                      PIC X(32)  VALUE SPACES.             
                                                                                
       01  L650-LINE-BARCODE.                                                   
           05  FILLER                      PIC X(66)  VALUE SPACES.             
           05  L650-BARCODE-REGN           PIC X(13)  VALUE SPACES.             
                                                                                
       01  L650-PR-LINE-0.                                                      
           05  FILLER                      PIC X(28)  VALUE SPACES.             
           05  L650-BOTCCC.                                                     
               10  L650-TC                 PIC X(2)   VALUE SPACES.             
               10  L650-SLASH1             PIC X      VALUE SPACE.              
               10  L650-BO                 PIC X(2)   VALUE SPACES.             
               10  L650-SLASH2             PIC X      VALUE SPACE.              
               10  L650-CC                 PIC X(2)   VALUE SPACES.             
           05  FILLER                      PIC X(35)  VALUE SPACES.             
                                                                                
       01  L650-PR-LINE-1.                                                      
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L650-CDE-NT                PIC X(3)   VALUE 'XX'.                
           05  FILLER                     PIC X(1)   VALUE '/'.                 
           05  L650-RECOM-ROOM-TYPE       PIC X(2)   VALUE 'X'.                 
           05  FILLER                     PIC X(1)   VALUE '/'.                 
           05  L650-REGN-NO               PIC X(8)   VALUE 'XXXXXXX '.          
           05  FILLER                     PIC X(3)   VALUE '  ('.               
           05  L650-ALLOCATION-SCHEME     PIC X(3)   VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
                                                                                
       01  L650-PR-LINE-2.                                                      
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L650-SCHEME                PIC X(4)   VALUE 'XXXX'.              
           05  D1                         PIC X      VALUE '-'.                 
           05  L650-ACC                   PIC X(4)   VALUE 'XXXX'.              
           05  D2                         PIC X      VALUE '-'.                 
           05  L650-CDG                   PIC X      VALUE 'X'.                 
           05  D3                         PIC X      VALUE '-'.                 
           05  L650-ACC-TYPE              PIC X(2)   VALUE 'XX'.                
           05  FILLER                     PIC X(33)  VALUE SPACES.              
           05  L635-HDR-PHONE-DID         PIC X(24)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-3.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L650-APPL-NAME             PIC X(66)  VALUE SPACES.              
           05  FILLER                     PIC X(6)   VALUE SPACES.              
           05  L635-EMAIL                 PIC X(19)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-4.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L650-COAPPL-NAME           PIC X(66)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-4A.                                                     
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L650-THIRD-NAME            PIC X(66)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-4B.                                                     
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L650-FOURTH-NAME           PIC X(66)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-5.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L650-BLKNO                 PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L650-NUM-FLAT.                                                   
               10  L650-CHAR              PIC X      VALUE SPACE.               
               10  L650-LEVEL             PIC X(2)   VALUE SPACES.              
               10  L650-DASH              PIC X      VALUE SPACE.               
               10  L650-HSE-MAIN          PIC X(4)   VALUE SPACES.              
               10  L650-HSE-SUB           PIC X(3)   VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-6.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L650-STREET-NAME           PIC X(65)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-7.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L650-POST-CODE             PIC X(16)  VALUE SPACES.              
           05  L650-DOT                   PIC X(1)   VALUE SPACE.               
                                                                                
       01  L650-PR-LINE-7A.                                                     
           05  FILLER                     PIC X(75)  VALUE SPACES.              
           05  PRINT-DATE                 PIC X(10)                             
                                          VALUE 'XX/XX/XXXX'.                   
                                                                                
       01  L650-PR-LINE-7B.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L650-BAR-CODE              PIC X(09)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-8.                                                      
           05  FILLER                     PIC X(18)  VALUE SPACES.              
           05  L650-BLK-NO                PIC X(5)   VALUE ' XXX'.              
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE '#'.                 
           05  L650-LEVEL-NO              PIC X(2)   VALUE SPACES.              
           05  FILLER                     PIC X      VALUE '-'.                 
           05  L650-MAIN-UNIT             PIC X(5)   VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L650-ST-NAME               PIC X(20)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L650-COUNTRY-POSTCDE       PIC X(17)  VALUE 'SINGAPORE '.        
                                                                                
       01  L650-PR-LINE-9.                                                      
           05  FILLER                     PIC X(24)  VALUE SPACES.              
           05  L650-CURR-SELL-PR          PIC $$$,$$$,$$9.99.                   
           05  FILLER                     PIC X(2)  VALUE SPACES.               
           05  L650-CA-TAG                PIC X(8)  VALUE SPACES.               
                                                                                
       01  L650-PR-LINE-9A.                                                     
           05  FILLER                   PIC X(25)  VALUE SPACES.                
           05  L650-PREMIUM-TXT         PIC X(30)  VALUE SPACES.                
                                                                                
       01  L650-PR-LINE-11A.                                                    
           05  FILLER                     PIC X(69)  VALUE SPACES.              
           05  L650-AMT-INSURED           PIC ZZZ,ZZ9.99.                       
           05  L650-AMT-I-R REDEFINES L650-AMT-INSURED                          
                                          PIC X(10).                            
       01  L650-PR-LINE-11B.                                                    
           05  FILLER                     PIC X(24)  VALUE SPACES.              
           05  L650-AMT-PREMIUM           PIC ZZ9.99.                           
           05  L650-AMT-P-R REDEFINES L650-AMT-PREMIUM                          
                                          PIC X(6).                             
       01  L650-PR-LINE-11C.                                                    
           05  FILLER                     PIC X(43)  VALUE SPACES.              
           05  L650-APPOINT-DATE          PIC X(10)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-11D.                                                    
           05  FILLER                     PIC X(44)  VALUE SPACES.              
           05  L650-FORFEIT-CLAUSE1       PIC X(35)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-11E.                                                    
           05  FILLER                     PIC X(20)  VALUE SPACES.              
           05  L650-FORFEIT-CLAUSE2       PIC X(35)  VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-12.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(13)  VALUE                      
                                                     '(ED FOR TP : '.           
           05  L650-DTE-EXPIRED           PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
                                                                                
       01  L650-PR-LINE-13.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(03)  VALUE 'SC:'.               
           05  L650-AMT-CURR-SCCC         PIC ZZ9.99.                           
           05  FILLER                     PIC X(5)   VALUE ' WEF '.             
           05  L650-DTE-CURR-SCCC         PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  L650-CURR-GST-DESC         PIC X(45)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L650-BARCODE1-PREFIX       PIC X(2)   VALUE SPACES.              
           05  L650-BARCODE1-REGN         PIC X(8)   VALUE SPACES.              
                                                                                
       01  L650-PR-LINE-14.                                                     
           05  FILLER                     PIC X(13)  VALUE SPACES.              
           05  L650-AMT-NEXT-SCCC         PIC ZZ9.99.                           
           05  FILLER                     PIC X(5)   VALUE ' WEF '.             
           05  L650-DTE-NEXT-SCCC         PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  L650-NEXT-GST-DESC         PIC X(48)  VALUE SPACES.              
                                                                                
       01  L635-DTL-HAND-PHONE.                                                 
           05  FILLER                     PIC X(53)  VALUE SPACES.              
           05  L635-ASSIST-HP             PIC X(12)  VALUE SPACES.              
                                                                                
       01  L635-DTL-DID.                                                        
           05  FILLER                     PIC X(50)  VALUE SPACES.              
           05  L635-CHG-APPT-DID          PIC X(8)   VALUE SPACES.              
                                                                                
      *==> PART-A PRINT VARIABLES                                               
       01  L310A-PR-HEAD-09.                                                    
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L211-CDE-NT                 PIC X(3)   VALUE 'XXX'.              
           05  FILLER                      PIC X(1)   VALUE '/'.                
           05  L211-RECOM-ROOM-TYPE        PIC X(2)   VALUE 'X'.                
           05  FILLER                      PIC X(1)   VALUE '/'.                
           05  L211-REGN-NO                PIC X(8)  VALUE SPACES.              
           05  FILLER                      PIC X(3)  VALUE '  ('.               
           05  L211-ALLOCATION-SCHEME      PIC X(3)   VALUE SPACES.             
           05  FILLER                      PIC X(1)  VALUE ')'.                 
           05  FILLER                      PIC X(2)  VALUE SPACES.              
           05  L211-HALF-IDP               PIC X(3)   VALUE SPACES.             
                                                                                
      *==> FOR TP WITH CA                                                       
       01  L400C-PR-LINE-1.                                                     
           05  FILLER                   PIC X(33)  VALUE SPACES.                
           05  400C-YNGST-PURCHSR       PIC Z9     VALUE ZEROES.                
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  400C-REPAY-PRD           PIC ZZ9.                                
           05  FILLER                   PIC X(06)  VALUE ' YEARS'.              
                                                                                
      *==> FOR SA/TP EXEMPTED FROM CA                                           
       01  L400C-PR-LINE-1A.                                                    
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  400C-REPAY-PRDA          PIC ZZ9.                                
           05  FILLER                   PIC X(06)  VALUE ' YEARS'.              
                                                                                
       01  L400C-PR-LINE-2.                                                     
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  400C-HH-INCOME           PIC $$$$$9.                             
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  400C-CA-INCOME           PIC $$$$$9.                             
                                                                                
      *==> FOR SA/TP EXEMPTED FROM CA                                           
       01  L400C-PR-LINE-2A.                                                    
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  400C-INT-RATEA           PIC Z9.99.                              
           05  FILLER                   PIC X(2)   VALUE ' %'.                  
                                                                                
       01  L400C-PR-LINE-2C.                                                    
           05  FILLER                   PIC X(30)  VALUE SPACES.                
           05  400C-INT-RATE            PIC Z9.99.                              
           05  FILLER                   PIC X(2)   VALUE ' %'.                  
           05  FILLER                   PIC X(26)  VALUE SPACES.                
           05  400C-MAX-LOAN-ELIG       PIC $$$$$$$9.99.                        
                                                                                
       01  L400C-PR-LINE-2D.                                                    
           05  FILLER                   PIC X(63)  VALUE SPACES.                
           05  400C-INSTAL-ELIG         PIC $$$$$9.99.                          
                                                                                
       01  L400C-PR-LINE-3.                                                     
           05  FILLER                   PIC X(24)  VALUE SPACES.                
           05  L400C-PREMIUM-TXT        PIC X(35)  VALUE SPACES.                
           05  400C-SELLING-PRICE       PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-3A.                                                    
           05  FILLER                   PIC X(47)  VALUE SPACES.                
           05  400C-AMT-LS-FEE          PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-4.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-LEASE-FEE           PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-5.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORT-STAMP-FEE      PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-6.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORTGAGE-FEE        PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-7.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-TOT-STAMP-FEE       PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-7A.                                                    
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  FILLER-1                 PIC X(1)   VALUE '('.                   
           05  400C-ACT-CV-FEE          PIC ZZ9.99.                             
           05  FILLER                   PIC X(2)   VALUE ' +'.                  
           05  400C-GST-CV-FEE          PIC Z9.99.                              
           05  FILLER                   PIC X(4)   VALUE ' GST'.                
           05  FILLER-2                 PIC X(1)   VALUE ')'.                   
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400C-AMT-CV-FEE          PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-8.                                                     
           05  FILLER                   PIC X(24)  VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '('.                   
           05  400C-SURVEY-FEE-ACT      PIC Z,ZZ9.99.                           
           05  FILLER                   PIC X(3)   VALUE ' + '.                 
           05  400C-SURVEY-FEE-GST      PIC ZZ9.99.                             
           05  FILLER                   PIC X(8)   VALUE ' GST)'.               
           05  400C-TOT-SURVEY-FEE      PIC ZZZ,ZZ9.99.                         
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400C-TOT-FEES            PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-9.                                                     
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-TOT-SELLPR          PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-10.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CASH             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-11.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF1             PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400C-CD-CPF1-TXT         PIC X(5)   VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-12.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF2             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-13.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF3             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-14.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF4             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-14A.                                                   
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-LOAN-TOP-UP         PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X      VALUE SPACES.                
           05  400C-TOTAL-CD            PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-15.                                                    
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-BALANCE-AMT         PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-16.                                                    
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-MAX-LOAN-AMT        PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-16A.                                                   
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-MAX-LOAN-ELIG2      PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-16B.                                                   
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-TOP-UP-ICP          PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-17.                                                    
           05  FILLER                   PIC X(33)  VALUE SPACES.                
           05  L400C-REPAY-PRD          PIC ZZ.                                 
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  400C-MTHLY-INSTAL        PIC Z,ZZ9.99.                           
                                                                                
       01  L400C-PR-LINE-18.                                                    
           05  FILLER                   PIC X(64)  VALUE SPACES.                
           05  400C-SC-CC-AMT           PIC Z,ZZ9.99.                           
                                                                                
      *==>        PRINT NOTES                                                   
       01  L310A-PR-LINE-15.                                                    
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L310-SYS-DATE               PIC X(10) VALUE SPACES.              
                                                                                
       01  L310A-PR-LINE-16.                                                    
           05  FILLER                      PIC X(17)  VALUE SPACES.             
           05  L310-AMT-CURR-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-CURR-SCCC          PIC X(10) VALUE SPACES.              
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-CURR-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
       01  L310A-PR-LINE-17.                                                    
           05  FILLER                      PIC X(17) VALUE SPACES.              
           05  L310-AMT-NEXT-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-NEXT-SCCC          PIC X(10) VALUE SPACES.              
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-NEXT-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
      *****LAY OUT FOR  SKIPPED CASES                                           
       01 L650A-HEADER-1.                                                       
          05   FILLER                   PIC X(15)    VALUE SPACES.              
          05   FILLER                   PIC X(50)    VALUE                      
                  'LIST OF TP    LETTER (CA = Y/E) SKIPPED CASES'.              
          05   FILLER                   PIC X(15)    VALUE SPACES.              
                                                                                
       01 L650A-HEADER-2.                                                       
          05   FILLER                   PIC X(01)    VALUE SPACES.              
          05   FILLER                   PIC X(08)    VALUE 'P13L650A'.          
          05   FILLER                   PIC X(10)    VALUE SPACES.              
          05   FILLER                   PIC X(08)    VALUE 'DATE : '.           
          05   L650A-PRT-DATE           PIC X(10)    VALUE SPACES.              
          05   FILLER                   PIC X(33)    VALUE SPACES.              
          05   FILLER                   PIC X(06)    VALUE 'PAGE: '.            
          05   L650A-PAGE-NO            PIC ZZ99.                               
                                                                                
       01 L650A-HEADER-3.                                                       
          05   FILLER                   PIC X(08)  VALUE 'REGN NO.'.            
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'REPAY.PERIOD'.        
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'INTR.FACTOR '.        
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'INTEREST    '.        
          05   FILLER                   PIC X(01)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'REMARKS     '.        
                                                                                
       01 L650A-DETAIL.                                                         
          05   L650A-REGN-NO            PIC X(08)  VALUE SPACES.                
          05   FILLER                   PIC X(07)  VALUE SPACES.                
          05   L650A-REPAY-PD           PIC Z9.                                 
          05   FILLER                   PIC X(12)  VALUE SPACES.                
          05   L650A-FAC                PIC 99     VALUE ZERO.                  
          05   FILLER                   PIC X(10)  VALUE SPACES.                
          05   L650A-INT                PIC Z9.99.                              
          05   FILLER                   PIC X(05)  VALUE SPACES.                
          05   L650A-REMARK             PIC X(29)  VALUE SPACES.                
                                                                                
       01  WS-LINK-S90N.                                                        
         02 WS-S90N-OFFERPR-PREMIUM        PIC 9(8)     VALUE ZEROES.           
         02 WS-S90N-OFFERPR                PIC 9(8)     VALUE ZEROES.           
         02 WS-LINK-S900.                                                       
           05  WS-S900-SELL-PR             PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-DESIGN              PIC X(3)     VALUE SPACES.           
           05  WS-S900-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S900-CD-PREV-PAID        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-TOT-ICP             PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S900-PREM-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-SURVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-ESCROW-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-REGN-FEE         PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ESCROW-FEE     PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-MORT-REGN-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LOAN                PIC S9(7)V99 VALUE ZEROES.           
           05  WS-S900-ORIG-SELL           PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-SALE-TYPE           PIC X(2)     VALUE SPACES.           
           05  WS-S900-PREMIUM-CODE        PIC X(2)     VALUE SPACES.           
           05  WS-S900-SURVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-SALES-TYPE-SURVEY   PIC X(2)     VALUE SPACES.           
                                                                                
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      **********************                                                    
                                                                                
      ******************************************************************        
       100-MAIN-ROUTINE.                                                        
      ******************************************************************        
           PERFORM 200-OPEN-FILES              THRU    200-EXIT.                
           PERFORM 250-MOVE-GST-RATE           THRU    250-EXIT.                
           PERFORM 300-READ-BP13F310           THRU    300-EXIT.                
           PERFORM 400-ALLOCATION-STATUS-CHECK THROUGH 400-EXIT                 
                       UNTIL WS-F310-EOF = 'Y'.                                 
           PERFORM 1000-CLOSE-ROUTINE          THRU    1000-EXIT.               
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       110-CHK-SERS.                                                            
      ******************************************************************        
      *-----------------------------------*                                     
      * SEARCH SCHEME IN ALLOC SCH TABLE  *                                     
      *-----------------------------------*                                     
           IF WS-ALLOC-SCH  NOT =  LOW-VALUES AND SPACES                        
               SET WS-SERS-PTR  TO 1                                            
               SEARCH WS-SERS-SCH                                               
                   AT END                                                       
                   MOVE 'N' TO WS-SCH-FND                                       
                   WHEN WS-SERS-SCHEME(WS-SERS-PTR) = WS-ALLOC-SCH              
                   MOVE 'Y' TO WS-SCH-FND                                       
               END-SEARCH                                                       
           ELSE                                                                 
               MOVE 'N' TO WS-SCH-FND                                           
           END-IF.                                                              
                                                                                
       110-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       200-OPEN-FILES.                                                          
      ******************************************************************        
           OPEN INPUT BP13K800                                                  
                      BP13K022                                                  
                      BP13K024                                                  
                      BP13K820                                                  
                      BP13K830                                                  
                      BP13K640                                                  
                      BM06K100                                                  
                      BM06K110                                                  
                      AB03K050                                                  
                      BP13F310                                                  
               OUTPUT P13L650A                                                  
                      P13L650B                                                  
                      P13L650D                                                  
                      P13L650E.                                                 
                                                                                
           CALL 'OAV02001' USING LINK-REC.                                      
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K022-STATUS ' BP13K022-STATUS          
              MOVE     BP13K022-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K024-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K024-STATUS ' BP13K024-STATUS          
              MOVE     BP13K024-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K800-STATUS ' BP13K800-STATUS          
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K820-STATUS ' BP13K820-STATUS          
              MOVE     BP13K820-STATUS TO RETURN-CODE                           
              PERFORM 1000-CLOSE-ROUTINE.                                       
                                                                                
           IF BP13K830-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K830-STATUS ' BP13K830-STATUS          
              MOVE     BP13K830-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K640-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K640-STATUS ' BP13K640-STATUS          
              MOVE     BP13K640-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BM06K100-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BM06K100-STATUS ' BM06K100-STATUS          
              MOVE     BM06K100-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BM06K110-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BM06K110-STATUS ' BM06K110-STATUS          
              MOVE     BM06K110-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           MOVE 30 TO WS-CNT.                                                   
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       250-MOVE-GST-RATE.                                                       
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    CALL BP13C90D TO GET GST-RATE                          *             
      *-----------------------------------------------------------*             
           CALL 'BP13C90D' USING WS-COMM-AREA-GST.                              
                                                                                
       250-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       300-READ-BP13F310.                                                       
      ******************************************************************        
      *--------------------------------------------------------*                
      *    1.   READ FILE BP13F310.                            *                
      *    2.   CHECK F310-ALLOC-STATUS.                       *                
      *--------------------------------------------------------*                
                                                                                
           READ BP13F310                                                        
                AT END MOVE 'Y' TO WS-F310-EOF                                  
                       GO TO 300-EXIT.                                          
                                                                                
           ADD  1  TO  WS-CNT-F310.                                             
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       400-ALLOCATION-STATUS-CHECK.                                             
      ******************************************************************        
           PERFORM 500-ELIGIBILITY-CHECK  THROUGH  500-EXIT.                    
           PERFORM 300-READ-BP13F310      THROUGH  300-EXIT.                    
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       500-ELIGIBILITY-CHECK.                                                   
      ******************************************************************        
           PERFORM 550-INITIALIZE-WORKSHEET  THRU 550-EXIT.                     
           PERFORM 600-ACCESS-BM06K110  THROUGH  600-EXIT.                      
           MOVE    ZEROS   TO WS-ACCEPTANCE-DATE.                               
                                                                                
           IF K110-NOT-FOUND = 'Y'                                              
              MOVE ZEROS  TO WS-ACCEPTANCE-DATE                                 
              DISPLAY 'RECORD NOT FOUND IN BM06K110, KEY: '                     
                       K110-KEY-FLD                                             
              GO TO 500-EXIT                                                    
           ELSE                                                                 
              MOVE K110-DTE-ACCEPTANCE TO WS-ACCEPTANCE-DATE                    
              IF  (K110-DTE-KEY-AVAIL = SPACES OR LOW-VALUES OR ZEROES)         
              OR  (K110-DTE-KEY-AVAIL  NOT NUMERIC)                             
                 DISPLAY 'K110-DTE-KEY-AVAIL  SPACES FOR '                      
                          K110-KEY-FLD  ' RECORD SKIPPED'                       
                   GO TO 500-EXIT.                                              
                                                                                
           PERFORM 700-READ-SOC-MASTER THRU 700-EXIT.                           
           ADD     1   TO    WS-CNT-PROC.                                       
                                                                                
           PERFORM 750-GET-REGN-CHKDIGIT  THRU 750-EXIT.                        
           PERFORM 800-SETUP-LETTERS THROUGH 800-EXIT.                          
           PERFORM 900-SETUP-WORKSHEET THROUGH 900-EXIT.                        
           PERFORM 825-PRINT-LETTERS THROUGH 825-EXIT.                          
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              PERFORM 885-GET-INCOME     THROUGH 885-EXIT                       
           END-IF.                                                              
                                                                                
           PERFORM 950-PROCESS-PRINT-WSHEET  THRU 950-EXIT.                     
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       550-INITIALIZE-WORKSHEET.                                                
      ******************************************************************        
           MOVE SPACES   TO L211-REGN-NO        L310-SYS-DATE                   
                            L310-DTE-CURR-SCCC  L310-CURR-GST-DESC              
                            L310-DTE-NEXT-SCCC  L310-NEXT-GST-DESC              
                            400C-CD-CPF1-TXT.                                   
                                                                                
           MOVE ZEROES   TO L310-AMT-CURR-SCCC   L310-AMT-NEXT-SCCC             
                            400C-REPAY-PRD       400C-INT-RATE                  
                            400C-SELLING-PRICE   400C-LEASE-FEE                 
                            400C-MORT-STAMP-FEE  400C-MORTGAGE-FEE              
                            400C-TOT-STAMP-FEE   400C-SURVEY-FEE-ACT            
                            400C-SURVEY-FEE-GST  400C-TOT-SURVEY-FEE            
                            400C-TOT-FEES        400C-TOT-SELLPR                
                            400C-CD-CASH         400C-CD-CPF1                   
                            400C-CD-CPF2         400C-CD-CPF3                   
                            400C-CD-CPF4         400C-TOTAL-CD                  
                            400C-BALANCE-AMT     400C-MAX-LOAN-AMT              
                            400C-MTHLY-INSTAL    400C-SC-CC-AMT                 
                            400C-YNGST-PURCHSR   400C-GST-CV-FEE                
                            400C-REPAY-PRDA      400C-MAX-LOAN-ELIG             
                            400C-INT-RATEA       400C-ACT-CV-FEE                
                                                 400C-GST-CV-FEE                
                            400C-INSTAL-ELIG     400C-MAX-LOAN-ELIG2            
                            400C-TOP-UP-ICP      400C-LOAN-TOP-UP.              
                                                                                
           MOVE SPACES TO L650-BARCODE-REGN.                                    
           MOVE SPACES TO L650-BARCODE1-REGN.                                   
           MOVE SPACES TO L650-BARCODE1-PREFIX.                                 
                                                                                
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       600-ACCESS-BM06K110.                                                     
      ******************************************************************        
      *--------------------------------------------------------*                
      *    USE F310-SCH-ACCT-NO TO ACCESS BM06K110 FOR NEW     *                
      *        FLAT INFORMATION.                               *                
      *--------------------------------------------------------*                
           MOVE 'N' TO K110-NOT-FOUND.                                          
           MOVE F310-SCH-ACC TO K110-KEY-FLD.                                   
                                                                                
           READ BM06K110.                                                       
                                                                                
           IF BM06K110-STATUS = 00 OR 02                                        
              DISPLAY 'FOUND :'                                                 
           ELSE                                                                 
           IF BM06K110-STATUS = 23                                              
              MOVE    'Y'  TO K110-NOT-FOUND                                    
              DISPLAY 'REC NOT FND, K110-KEY-FLD   ' K110-KEY-FLD               
           ELSE                                                                 
              DISPLAY 'READ ERROR, K110-STATUS  = ' BM06K110-STATUS             
              DISPLAY '            K110-KEY-FLD = ' K110-KEY-FLD                
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           ADD  1  TO  WS-CNT-K110.                                             
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       700-READ-SOC-MASTER.                                                     
      ******************************************************************        
           MOVE F310-REGN-NO TO K800-NUM-REGN.                                  
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF BP13K800-STATUS = 00                                              
              MOVE    'N'  TO K800-NOT-FOUND                                    
           ELSE                                                                 
           IF BP13K800-STATUS = 23                                              
              MOVE    'Y'  TO K800-NOT-FOUND                                    
              DISPLAY 'REC NOT FOUND IN BP13K800 ' K800-NUM-REGN                
              GO TO    500-EXIT                                                 
           ELSE                                                                 
              DISPLAY 'READ ERROR, BP13K800-STATUS ' BP13K800-STATUS            
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF K800-NUM-SCH-ACC = SPACES OR LOW-VALUES                           
              DISPLAY 'K800 SCH ACC SPACES FOR ' K800-NUM-REGN                  
                      ' RECORD SKIPPED'                                         
              GO TO 500-EXIT.                                                   
                                                                                
           IF K800-DTE-SALE-AGMT = SPACES OR LOW-VALUES OR ZEROS                
              DISPLAY 'K800 DTE SALE AGMT NOT NUM. NON T' K800-NUM-REGN         
                      'P REC SKIPPED'                                           
              GO TO 500-EXIT.                                                   
                                                                                
           IF K800-NUM-SCCC-ELGBTY = SPACES OR LOW-VALUES                       
              DISPLAY 'NUM SCCC ELGBTY IS SPACES FOR ' K800-NUM-REGN            
                      ' RECORD SKIPPED'                                         
              GO TO 500-EXIT.                                                   
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       750-GET-REGN-CHKDIGIT.                                                   
      *-------------------------------------------------------------            
           STRING 'SL' K800-NUM-REGN DELIMITED BY SIZE                          
             INTO  WS-C908-TXT-INPUT.                                           
                                                                                
           MOVE SPACES               TO WS-C908-TXT-OUTPUT.                     
           MOVE 10                   TO WS-C908-TXT-IN-SIZE.                    
           MOVE ZEROS                TO WS-C908-RETCODE                         
                                        WS-C908-TXT-OUT-SIZE.                   
                                                                                
           CALL 'BP13C908'    USING WS-C908-PARAMETERS.                         
                                                                                
           IF WS-C908-RETCODE = ZEROS                                           
              MOVE WS-C908-TXT-OUTPUT(1:WS-C908-TXT-OUT-SIZE) TO                
                   L650-BARCODE-REGN                                            
           ELSE                                                                 
              DISPLAY 'ERROR IN BP13C908-REGN: ' WS-C908-TXT-INPUT              
              MOVE SPACES                 TO  L650-BARCODE-REGN.                
                                                                                
       750-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       800-SETUP-LETTERS.                                                       
      ******************************************************************        
      *--------------------------------------------------------*                
      *    PRINT LETTERS FOR LEASE AGREEMENT.                  *                
      *--------------------------------------------------------*                
           ADD  1                    TO  WS-CNT-LETTERS.                        
           MOVE K800-NUM-NEW-TOWN    TO  L650-CDE-NT                            
                                         L211-CDE-NT.                           
                                                                                
           IF F310-CDE-TYP-ACTUSE = '06'                                        
              MOVE 'E ' TO L650-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '08'                                        
              MOVE 'MG' TO L650-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '04' AND                                    
              F310-CDE-MODL-DESG  = '06'                                        
              MOVE '4S' TO L650-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
              MOVE F310-CDE-TYP-ACTUSE TO L650-RECOM-ROOM-TYPE                  
                                          L211-RECOM-ROOM-TYPE.                 
                                                                                
           MOVE K800-NUM-REGN        TO L650-REGN-NO                            
                                        L650-BARCODE1-REGN.                     
                                                                                
           MOVE 'SL'   TO L650-BARCODE1-PREFIX.                                 
                                                                                
           MOVE K800-NUM-ALLO-SCHEME TO L650-ALLOCATION-SCHEME                  
                                        L211-ALLOCATION-SCHEME.                 
                                                                                
           MOVE SPACES               TO L211-HALF-IDP.                          
           IF K800-NUM-HALF-IDP = 'S' OR = 'A' OR = 'Y'                         
              STRING '-' K800-NUM-HALF-IDP                                      
                     DELIMITED BY SIZE INTO L211-HALF-IDP.                      
                                                                                
           MOVE SPACES               TO PRINT-REC2                              
                                        PRINT-REC4                              
                                        PRINT-REC5.                             
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO   WS-CUR-YYYYMMDD.               
           MOVE WS-CUR-DD            TO WS-EDIT-DD.                             
           MOVE WS-CUR-MM            TO WS-EDIT-MM.                             
           MOVE WS-CUR-YYYY          TO WS-EDIT-YYYY.                           
           MOVE WS-EDITED-DATE       TO PRINT-DATE.                             
                                                                                
           MOVE    '-'               TO D1 D2 D3.                               
           MOVE    F310-SCH          TO L650-SCHEME.                            
           MOVE    F310-ACC          TO WS-ACC.                                 
           MOVE    WS-ACCOUNT        TO L650-ACC.                               
           MOVE    WS-CDG            TO L650-CDG.                               
           MOVE    F310-LESSEE-CODE  TO L650-ACC-TYPE.                          
                                                                                
           MOVE    F310-CDE-BO       TO L650-BO.                                
           MOVE    F310-CDE-CC       TO L650-CC.                                
           MOVE    F310-CDE-TC       TO L650-TC.                                
           MOVE    '/'               TO L650-SLASH1                             
                                        L650-SLASH2.                            
                                                                                
           MOVE ZEROES               TO WS-DOB1 WS-DOB2                         
                                        WS-DOB3 WS-DOB4.                        
                                                                                
           MOVE    K800-NUM-REGN     TO K820-NUM-REGN.                          
           MOVE    K800-NUM-NRIC1    TO K820-NUM-NRIC.                          
           PERFORM 850-GET-NAME    THRU 850-EXIT.                               
           MOVE    WS-NAME           TO L650-APPL-NAME.                         
           MOVE    K820-DTE-BIRTH    TO WS-DOB1.                                
                                                                                
           IF K800-NUM-NRIC2(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC2      NOT = SPACES                                  
              MOVE    K800-NUM-REGN     TO K820-NUM-REGN                        
              MOVE    K800-NUM-NRIC2    TO K820-NUM-NRIC                        
              PERFORM 850-GET-NAME      THRU  850-EXIT                          
              MOVE    WS-NAME           TO L650-COAPPL-NAME                     
              MOVE    K820-DTE-BIRTH    TO WS-DOB2                              
           ELSE                                                                 
              MOVE SPACES               TO L650-COAPPL-NAME.                    
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3      NOT = SPACES                                  
              MOVE K800-NUM-REGN     TO K820-NUM-REGN                           
              MOVE K800-NUM-NRIC3    TO K820-NUM-NRIC                           
              PERFORM 850-GET-NAME   THRU 850-EXIT                              
              MOVE WS-NAME           TO L650-THIRD-NAME                         
              MOVE    K820-DTE-BIRTH    TO WS-DOB3                              
           ELSE                                                                 
              MOVE SPACES            TO L650-THIRD-NAME.                        
                                                                                
           IF K800-NUM-NRIC4(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC4      NOT = SPACES                                  
              MOVE K800-NUM-REGN     TO K820-NUM-REGN                           
              MOVE K800-NUM-NRIC4    TO K820-NUM-NRIC                           
              PERFORM 850-GET-NAME   THRU 850-EXIT                              
              MOVE WS-NAME           TO L650-FOURTH-NAME                        
              MOVE    K820-DTE-BIRTH TO WS-DOB4                                 
           ELSE                                                                 
              MOVE SPACES            TO L650-FOURTH-NAME.                       
                                                                                
           PERFORM 860-READ-K830     THRU  860-EXIT.                            
                                                                                
           IF K800-NUM-PREMIUM-RATE IS NOT NUMERIC                              
              MOVE  ZERO        TO K800-NUM-PREMIUM-RATE                        
           END-IF.                                                              
                                                                                
           IF K800-AMT-PREMIUM      IS NOT NUMERIC                              
              MOVE  ZERO        TO K800-AMT-PREMIUM                             
           END-IF.                                                              
                                                                                
           IF K110-NOT-FOUND = 'Y'                                              
              MOVE ZEROS        TO K110-CURR-SELLING-PRICE                      
           END-IF.                                                              
                                                                                
           IF  K800-NUM-PREMIUM-RATE > 0                                        
               MOVE K800-AMT-PREMIUM       TO WS-AMT-PREMIUM                    
               COMPUTE WS-PURCHASE-PRICE =  K110-CURR-SELLING-PRICE +           
                                            WS-AMT-PREMIUM                      
               MOVE  WS-PURCHASE-PRICE     TO L650-CURR-SELL-PR                 
               MOVE  K110-CURR-SELLING-PRICE                                    
                                           TO WS-SELLING-PRICE                  
               MOVE  WS-AMT-PREMIUM        TO WS-AMT-PREMIUM-EDT                
               STRING '(WITH PREMIUM ' WS-AMT-PREMIUM-EDT ')'                   
                       DELIMITED BY SIZE INTO  L650-PREMIUM-TXT                 
               STRING '( ' WS-SELLING-PRICE ' + '                               
                       WS-AMT-PREMIUM-EDT ')'                                   
                       DELIMITED BY SIZE INTO  L400C-PREMIUM-TXT                
           ELSE                                                                 
              MOVE K110-CURR-SELLING-PRICE TO L650-CURR-SELL-PR                 
                                              WS-PURCHASE-PRICE                 
              MOVE SPACES                  TO L650-PREMIUM-TXT                  
                                              L400C-PREMIUM-TXT                 
           END-IF.                                                              
                                                                                
           IF K800-NUM-CA-TAG = 'E'                                             
              MOVE ' CA = E ' TO L650-CA-TAG                                    
           ELSE                                                                 
           IF K800-NUM-CA-TAG = 'Y'                                             
              MOVE ' CA = Y ' TO L650-CA-TAG                                    
           ELSE                                                                 
              MOVE SPACES     TO L650-CA-TAG.                                   
                                                                                
           MOVE F310-NUM-BLK         TO L650-BLK-NO.                            
           MOVE F310-NUM-LEVEL       TO L650-LEVEL-NO.                          
           MOVE F310-NUM-MAIN        TO L650-MAIN-UNIT.                         
           MOVE F310-NME-STREET      TO L650-ST-NAME.                           
                                                                                
           IF   F310-NUM-POSTAL = SPACES OR LOW-VALUES  OR ZEROES               
                MOVE SPACES          TO L650-COUNTRY-POSTCDE                    
           ELSE                                                                 
                STRING 'SINGAPORE ' F310-NUM-POSTAL '.'                         
                DELIMITED BY SIZE  INTO L650-COUNTRY-POSTCDE.                   
                                                                                
           MOVE K800-DTE-EXPIRED-TP TO WS-DTE.                                  
           MOVE '/'                 TO WS-SLASH1  WS-SLASH2.                    
           MOVE WS-DTE-YYYY         TO WS-DTE-EXPIRED-TP-YYYY.                  
           MOVE WS-DTE-MM           TO WS-DTE-EXPIRED-TP-MM.                    
           MOVE WS-DTE-DD           TO WS-DTE-EXPIRED-TP-DD.                    
                                                                                
           MOVE  WS-DTE-EXPIRED-TP  TO L650-DTE-EXPIRED.                        
                                                                                
           MOVE K110-AIX1 TO K100-KEY-FLD.                                      
                                                                                
           READ BM06K100.                                                       
                                                                                
           IF BM06K100-STATUS = 00                                              
              NEXT SENTENCE                                                     
           ELSE                                                                 
           IF BM06K100-STATUS = 23                                              
              DISPLAY 'REC NOT FOUND IN BM06K100 = ' K100-KEY-FLD               
              GO TO    800-EXIT                                                 
           ELSE                                                                 
              DISPLAY 'READ ERROR, BM06K100-STATUS ' BM06K100-STATUS            
              MOVE     BM06K100-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE1.                 
           MOVE WS-CURRENT-DATE1           TO DATE-REC.                         
           PERFORM 810-COMPUTE-DTE-EXPIRED-TP  THRU  810-EXIT                   
           STRING CAL-DAY    '/'  CAL-MONTH '/' CAL-YEAR                        
                  DELIMITED BY SIZE INTO   L650-APPOINT-DATE.                   
                                                                                
           MOVE F310-CDE-TYP-ACTUSE     TO  BM97-NUM-FLAT-TYPE.                 
           MOVE F310-CDE-MODL-DESG      TO  BM97-CDE-MODL-DESG.                 
           MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-CURR-DATE.                   
           MOVE WS-CURR-DATE            TO  BM97-DTE-COMPARE.                   
                                                                                
           INITIALIZE                       BM97-NUM-ERROR                      
                                            BM97-NUM-SYSERR.                    
                                                                                
           DISPLAY 'CALLING AB20C900'                                           
                                                                                
           CALL 'AB20C900' USING WS-BM97-AREA.                                  
                                                                                
           IF (BM97-NUM-ERROR = ZEROS OR SPACES) AND                            
              BM97-NUM-SYSERR = ZEROS                                           
              MOVE BM97-AMT-INSURED     TO  L650-AMT-INSURED                    
              MOVE BM97-AMT-PREMIUM     TO  L650-AMT-PREMIUM                    
           ELSE                                                                 
              MOVE BM97-NUM-SYSERR      TO  RETURN-CODE                         
              DISPLAY 'ERROR IN CALLING AB20C900, ' BM97-NUM-ERROR              
              MOVE SPACES               TO  L650-AMT-I-R                        
                                            L650-AMT-P-R                        
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           PERFORM 890-CALL-BP13C903  THRU  890-EXIT.                           
                                                                                
           IF K110-DTE-ACCEPTANCE >= '20020110'                                 
              MOVE 'equal to Five Percent (5%) of the'                          
                   TO L650-FORFEIT-CLAUSE1                                      
              MOVE 'Purchase Price; and' TO L650-FORFEIT-CLAUSE2                
           ELSE                                                                 
              MOVE 'equivalent to three (3) times the'                          
                   TO L650-FORFEIT-CLAUSE1                                      
              MOVE 'option fee; and'     TO L650-FORFEIT-CLAUSE2                
           END-IF.                                                              
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       810-COMPUTE-DTE-EXPIRED-TP.                                              
      ******************************************************************        
               MOVE  ZEROS      TO     WS-NUM-FIELD.                            
               ADD   30         TO     CAL-DAY.                                 
                                                                                
               PERFORM  812-PROCESS-DATE  THRU  812-EXIT.                       
               MOVE  SPACES    TO    LINK-REC.                                  
                                                                                
               PERFORM 815-CHECK-HOLIDAY   THRU  815-EXIT                       
                       UNTIL WS-RET-DAY = 'EVE' OR 'DAY' OR 'EIF' OR            
                                          'EID' OR 'EIR'.                       
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       812-PROCESS-DATE.                                                        
      *------------------*                                                      
               IF 31-DAY-MONTH                                                  
                  IF CAL-DAY > 31                                               
                     COMPUTE  CAL-DAY    =  CAL-DAY  -  31                      
                     COMPUTE  CAL-MONTH  =  CAL-MONTH + 1                       
                  END-IF                                                        
               END-IF.                                                          
                                                                                
               IF 30-DAY-MONTH                                                  
                  IF CAL-DAY > 30                                               
                     COMPUTE CAL-DAY  =  CAL-DAY  - 30                          
                     COMPUTE CAL-MONTH = CAL-MONTH + 1                          
                  END-IF                                                        
               END-IF.                                                          
                                                                                
               IF 28-29-DAY-MONTH                                               
                  IF CAL-DAY >= 29                                              
                     DIVIDE 4 INTO CAL-YEAR GIVING WS-YEAR                      
                              REMAINDER WS-REM                                  
                     IF (WS-REM = 0 ) AND (CAL-DAY > 29)                        
                         COMPUTE CAL-DAY = CAL-DAY - 29                         
                         MOVE 03   TO  CAL-MONTH                                
                     ELSE                                                       
                     IF (WS-REM NOT = 0 ) AND (CAL-DAY > 28)                    
                         COMPUTE CAL-DAY = CAL-DAY - 28                         
                         MOVE 03   TO  CAL-MONTH                                
                     END-IF                                                     
                     END-IF                                                     
                   END-IF                                                       
                  END-IF.                                                       
                                                                                
               IF CAL-MONTH > 12                                                
                  MOVE  01    TO    CAL-MONTH                                   
                  ADD   01    TO    CAL-YEAR                                    
               END-IF.                                                          
                                                                                
       812-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------*                                                      
       815-CHECK-HOLIDAY.                                                       
      *------------------*                                                      
           MOVE  CAL-DATE              TO WS-IN-DATE.                           
           MOVE 'HD'                   TO WS-IN-OPTION.                         
           MOVE '000'                  TO WS-RETURN.                            
                                                                                
           CALL 'AV02C002' USING LINK-REC.                                      
                                                                                
           IF WS-RETURN = 'EID'                                                 
              DISPLAY 'ERROR IN DATE ' WS-IN-DATE                               
              MOVE SPACES TO CAL-DATE.                                          
           DISPLAY 'WS-RET-DAY : '  WS-RET-DAY.                                 
                                                                                
           IF WS-RET-DAY = 'HOL'                                                
              ADD 1 TO CAL-DAY                                                  
              PERFORM 812-PROCESS-DATE                                          
                 THRU 812-EXIT                                                  
           END-IF.                                                              
                                                                                
       815-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       820-CALL-AV02C015.                                                       
      *****************************************************************         
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       820-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       825-PRINT-LETTERS.                                                       
      ******************************************************************        
           PERFORM 830-READ-BP13K022  THRU 830-EXIT.                            
           PERFORM 840-GET-CSM-INFO  THRU 840-EXIT.                             
                                                                                
           MOVE  SPACES    TO   PRINT-REC2.                                     
           WRITE PRINT-REC2                        AFTER PAGE.                  
                                                                                
           WRITE PRINT-REC2 FROM L650-PR-LINE-0    AFTER 4.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-1    AFTER 1.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-7A   AFTER 0.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-2    AFTER 1.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-3    AFTER 2.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-4    AFTER 1.                     
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3     NOT = SPACES                                   
              WRITE PRINT-REC2 FROM L650-PR-LINE-4A AFTER 1                     
              WRITE PRINT-REC2 FROM L650-PR-LINE-4B AFTER 1                     
              WRITE PRINT-REC2 FROM L650-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L650-PR-LINE-6                              
              WRITE PRINT-REC2 FROM L650-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L650-PR-LINE-7B                             
              WRITE PRINT-REC2 FROM L650-PR-LINE-8  AFTER 6                     
           ELSE                                                                 
              WRITE PRINT-REC2 FROM L650-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L650-PR-LINE-6                              
              WRITE PRINT-REC2 FROM L650-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L650-PR-LINE-7B AFTER 3                     
              WRITE PRINT-REC2 FROM L650-PR-LINE-8  AFTER 6.                    
                                                                                
           WRITE PRINT-REC2 FROM L650-PR-LINE-9  AFTER 2                        
           WRITE PRINT-REC2 FROM L650-PR-LINE-9A AFTER 1                        
                                                                                
      *--------------------------------------------------------*                
      *    TO INSERT LINES TO BEAT THE FCB                     *                
      *--------------------------------------------------------*                
           WRITE PRINT-REC2 FROM L650-PR-LINE-11A AFTER 12.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-11B AFTER 01.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-11C AFTER 05.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-11D AFTER 03.                     
           WRITE PRINT-REC2 FROM L650-PR-LINE-11E AFTER 01.                     
                                                                                
           WRITE PRINT-REC2 FROM L650-LINE-OIC    AFTER 11.                     
           WRITE PRINT-REC2 FROM L650-LINE-OIC1   AFTER 1.                      
                                                                                
           WRITE PRINT-REC2 FROM L650-PR-LINE-12  AFTER 1.                      
           WRITE PRINT-REC2 FROM L650-LINE-BARCODE  AFTER 0.                    
           WRITE PRINT-REC2 FROM L650-PR-LINE-13  AFTER 1.                      
           WRITE PRINT-REC2 FROM L650-PR-LINE-14  AFTER 1.                      
                                                                                
       825-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       830-READ-BP13K022.                                                       
      ******************************************************************        
           MOVE 'N'          TO K022-FOUND.                                     
                                                                                
           MOVE F310-REGN-NO TO K022-NUM-REGN.                                  
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF BP13K022-STATUS = 00                                              
              MOVE 'Y' TO K022-FOUND                                            
           ELSE                                                                 
           IF BP13K022-STATUS = 23                                              
              MOVE 'N' TO K022-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K022 = '  BP13K022-STATUS              
              MOVE 'N' TO K022-FOUND.                                           
                                                                                
           MOVE 'N'          TO K024-FOUND.                                     
           IF K022-FOUND = 'Y'                                                  
              ADD 1                       TO   WS-CNT-K022                      
              MOVE K022-NUM-OIC           TO   K024-NUM-OIC                     
              PERFORM 835-READ-BP13K024   THRU 835-EXIT                         
           END-IF.                                                              
                                                                                
       830-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       835-READ-BP13K024.                                                       
      ******************************************************************        
           READ BP13K024 KEY IS K024-KEY-FLD.                                   
                                                                                
           IF BP13K024-STATUS = 00                                              
              MOVE 'Y' TO K024-FOUND                                            
           ELSE                                                                 
           IF BP13K024-STATUS = 23                                              
              MOVE 'N' TO K024-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K024 = '  BP13K024-STATUS              
              MOVE 'N' TO K024-FOUND.                                           
                                                                                
           IF K024-FOUND = 'Y'                                                  
              ADD   1  TO WS-CNT-K024                                           
           END-IF.                                                              
                                                                                
       835-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       840-GET-CSM-INFO.                                                        
      ******************************************************************        
           MOVE SPACES TO L635-HDR-PHONE-DID                                    
                          L635-DTL-HAND-PHONE                                   
      *                   L635-EMAIL                                            
                          L635-DTL-DID                                          
                          L635-OIC-NAME                                         
                          L635-OIC-DESG                                         
                          WS-HDR-PHONE-DID                                      
                          WS-EMAIL.                                             
                                                                                
           IF K024-FOUND = 'Y'                                                  
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 5               
                 MOVE SPACES TO WS-OIC-EMAIL-TAB(WS-CTR)                        
                 MOVE SPACES TO WS-OIC-TAB(WS-CTR)                              
              END-PERFORM                                                       
                                                                                
              MOVE K024-NME-OIC                 TO L635-OIC-NAME                
              MOVE 'CUSTOMER SERVICE MANAGER'   TO L635-OIC-DESG                
              MOVE K024-NUM-DID                 TO L635-HDR-PHONE-DID           
                                                   L635-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L635-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           ELSE                                                                 
              MOVE '1800-8663066(toll-free)'    TO WS-HDR-PHONE-DID             
              MOVE FUNCTION LOWER-CASE(WS-HDR-PHONE-DID)                        
                                                TO L635-HDR-PHONE-DID           
              MOVE '64903783'                   TO L635-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L635-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           END-IF.                                                              
                                                                                
      *    MOVE FUNCTION LOWER-CASE(WS-EMAIL)   TO L635-EMAIL.                  
                                                                                
       840-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       850-GET-NAME.                                                            
      ******************************************************************        
           READ BP13K820.                                                       
                                                                                
           IF BP13K820-STATUS = 00                                              
              MOVE K820-NME-OCCP    TO WS-NAME                                  
           ELSE                                                                 
           IF BP13K820-STATUS = 23                                              
              MOVE     SPACES       TO WS-NAME                                  
              DISPLAY 'BP13K820 RECORD NOT FOUND = ' BP13K820-STATUS            
              DISPLAY 'K820-KEY-FLD  = '    K820-KEY-FLD                        
           ELSE                                                                 
              MOVE     SPACES       TO WS-NAME                                  
              DISPLAY 'ERROR READING BP13K820 = '  BP13K820-STATUS.             
                                                                                
           ADD 1 TO WS-CNT-K820.                                                
                                                                                
       850-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       860-READ-K830.                                                           
      ******************************************************************        
           MOVE     F310-REGN-NO     TO    K830-NUM-REGN.                       
                                                                                
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           IF BP13K830-STATUS = 00 OR 02                                        
              IF K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES                      
                 IF K830-NUM-ADDR-TYPE = 'H'                                    
                    MOVE SPACES              TO L650-STREET-NAME                
                    MOVE K830-NUM-BLK        TO L650-BLKNO                      
                    MOVE K830-NUM-LVL-CHAR   TO L650-CHAR                       
                    MOVE K830-NUM-LVL-NUM    TO L650-LEVEL                      
                    MOVE K830-NUM-LVL-DASH   TO L650-DASH                       
                    MOVE K830-NUM-HSEMAIN    TO L650-HSE-MAIN                   
                    MOVE K830-NUM-HSESUB     TO L650-HSE-SUB                    
                    MOVE K830-NME-STREET     TO L650-STREET-NAME                
                                                                                
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES           TO L650-POST-CODE L650-DOT         
                    ELSE                                                        
                       STRING 'SINGAPORE ' K830-NUM-POSTAL                      
                       DELIMITED BY SIZE   INTO L650-POST-CODE                  
                       MOVE  '.'             TO L650-DOT                        
                    END-IF                                                      
                                                                                
                 ELSE                                                           
                    MOVE SPACES               TO L650-STREET-NAME               
                    MOVE K830-NUM-BLK         TO L650-BLKNO                     
                    MOVE K830-NUM-FLAT        TO L650-NUM-FLAT                  
                    MOVE K830-NME-STREET-BLDG TO L650-STREET-NAME               
                                                                                
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES            TO L650-POST-CODE                 
                    ELSE                                                        
                       STRING 'SINGAPORE '  K830-NUM-POSTAL                     
                       DELIMITED BY SIZE    INTO L650-POST-CODE                 
                       MOVE  '.'              TO L650-DOT                       
                    END-IF                                                      
                 END-IF                                                         
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                 MOVE SPACES                  TO WS-LINK-AV02C015               
                 MOVE K830-NUM-POSTAL         TO AV02C015-IN-POSTCODE           
                 PERFORM 820-CALL-AV02C015    THRU 820-EXIT                     
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L650-BAR-CODE             
                                                                                
            ELSE                                                                
               IF K830-NUM-MAIL-ADDR-TYPE = 'H'                                 
                  MOVE SPACES                 TO L650-STREET-NAME               
                  MOVE K830-NUM-MAIL-BLK      TO L650-BLKNO                     
                  MOVE K830-NUM-MAIL-LVL-CHAR TO L650-CHAR                      
                  MOVE K830-NUM-MAIL-LVL-NUM  TO L650-LEVEL                     
                  MOVE K830-NUM-MAIL-LVL-DASH TO L650-DASH                      
                  MOVE K830-NUM-MAIL-HSEMAIN  TO L650-HSE-MAIN                  
                  MOVE K830-NUM-MAIL-HSESUB   TO L650-HSE-SUB                   
                  MOVE K830-NME-MAIL-STREET   TO L650-STREET-NAME               
                                                                                
                  IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR             
                                            ZEROES                              
                     MOVE SPACES              TO L650-POST-CODE L650-DOT        
                  ELSE                                                          
                     STRING 'SINGAPORE '    K830-NUM-MAIL-POSTAL                
                     DELIMITED BY SIZE      INTO L650-POST-CODE                 
                     MOVE  '.'                TO L650-DOT                       
                  END-IF                                                        
                                                                                
               ELSE                                                             
                  MOVE SPACES                 TO L650-STREET-NAME               
                  MOVE K830-NUM-MAIL-BLK      TO L650-BLKNO                     
                  MOVE K830-NUM-MAIL-FLAT     TO L650-NUM-FLAT                  
                  MOVE K830-NME-MAIL-STR-BLDG TO L650-STREET-NAME               
                                                                                
                  IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR             
                                            ZEROES                              
                     MOVE SPACES              TO L650-POST-CODE                 
                  ELSE                                                          
                     STRING 'SINGAPORE '    K830-NUM-MAIL-POSTAL                
                     DELIMITED BY SIZE      INTO L650-POST-CODE                 
                     MOVE  '.'                TO L650-DOT                       
                  END-IF                                                        
               END-IF                                                           
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                 MOVE SPACES                  TO WS-LINK-AV02C015               
                 MOVE K830-NUM-MAIL-POSTAL    TO AV02C015-IN-POSTCODE           
                 PERFORM 820-CALL-AV02C015    THRU 820-EXIT                     
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L650-BAR-CODE             
                                                                                
           ELSE                                                                 
           IF BP13K830-STATUS = 23                                              
              MOVE SPACES  TO L650-BLKNO                                        
                              L650-NUM-FLAT                                     
                              L650-STREET-NAME                                  
                              L650-POST-CODE                                    
                              L650-DOT                                          
              DISPLAY 'BP13K830 RECORD NOT FOUND  = ' BP13K830-STATUS           
              DISPLAY '         K830-NUM-REGN     = ' K830-NUM-REGN             
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' BP13K830-STATUS               
              DISPLAY '      K830-NUM-REGN    = ' K830-NUM-REGN                 
              GO TO    1000-CLOSE-ROUTINE.                                      
                                                                                
           ADD 1 TO WS-CNT-K830.                                                
                                                                                
       860-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       885-GET-INCOME.                                                          
      ******************************************************************        
           MOVE 'Y'             TO WS-FIRST-CASE.                               
           MOVE K820-NUM-REGN   TO WS-K820-REGN.                                
           MOVE WS-K820-KEY     TO K820-KEY-FLD.                                
           MOVE 'N'             TO WS-REGN-CHGE.                                
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
           MOVE  ZERO           TO WS-HH-INCOME.                                
           MOVE  ZERO           TO WS-CA-INCOME.                                
                                                                                
           IF BP13K820-STATUS NOT = 00                                          
              DISPLAY 'START ERROR, BP13K820-STATUS ' BP13K820-STATUS           
           ELSE                                                                 
              PERFORM 886-READNEXT  THRU  886-EXIT                              
                       UNTIL    WS-K820-EOF  = 'Y'                              
                       OR       WS-REGN-CHGE = 'Y'.                             
                                                                                
           MOVE  WS-HH-INCOME        TO 400C-HH-INCOME.                         
           MOVE  WS-CA-INCOME        TO 400C-CA-INCOME.                         
                                                                                
       885-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       886-READNEXT.                                                            
      ******************************************************************        
           READ BP13K820 NEXT                                                   
                AT END   MOVE 'Y' TO WS-K820-EOF.                               
                                                                                
           IF K820-NUM-REGN NOT = WS-K820-REGN                                  
              MOVE 'Y' TO WS-REGN-CHGE                                          
           ELSE                                                                 
              IF (K820-AMT-INCOME   NOT = SPACES AND LOW-VALUES AND             
                                          ZEROS) AND                            
                 (K820-NUM-CA-TAG = 'CA' OR 'CD')                               
                  COMPUTE  WS-HH-INCOME = K820-AMT-INCOME +                     
                                          WS-HH-INCOME                          
              END-IF                                                            
              IF (K820-AMT-INCOME-CA NOT = SPACES AND LOW-VALUES AND            
                                           ZEROS) AND                           
                 (K820-NUM-CA-TAG = 'CA' OR 'CD')                               
                  COMPUTE  WS-CA-INCOME = K820-AMT-INCOME-CA +                  
                                          WS-CA-INCOME                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
       886-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       890-CALL-BP13C903.                                                       
      ******************************************************************        
           MOVE     FUNCTION CURRENT-DATE(1:8)                                  
                                         TO  WS-CURR-DATE.                      
           MOVE     WS-CURR-DATE         TO    WS-S903-SO-EFF-DATE.             
           MOVE     ZEROES               TO    WS-S903-SC-CC1                   
                                               WS-S903-SC-CC2                   
                                               WS-S903-SC-CC3.                  
           MOVE     ZEROES               TO    WS-S903-SC-REBATE1               
                                               WS-S903-SC-REBATE2               
                                               WS-S903-SC-REBATE3               
                                               WS-S903-SC-GRANT1                
                                               WS-S903-SC-GRANT2                
                                               WS-S903-SC-GRANT3                
                                               WS-S903-SC-REC-TC1               
                                               WS-S903-SC-REC-TC2               
                                               WS-S903-SC-REC-TC3               
                                               WS-S903-SC-TOTAL-AMT.            
           MOVE     ZEROES               TO    WS-S903-SC-TOTAL-AMT.            
           MOVE     F310-SCH-ACC(1:9)    TO    WS-S903-NUM-SCH-ACC.             
           MOVE     F310-CDE-TYP-ACTUSE  TO    WS-S903-ROOM-TY.                 
           MOVE     F310-CDE-MODL-DESG   TO    WS-S903-DESIGN-TY.               
                                                                                
      *-----------------------------------------------------------*             
      *    CALL BP13C903 TO GET THE SC-CC1,SC-CC2 AND SC-CC3      *             
      *-----------------------------------------------------------*             
           CALL 'BP13C903' USING WS-LINK-S903.                                  
                                                                                
      *-----------------------------------------------------------*             
      *    CALL AV02C021 TO COMPUTE THE GST FOR SC-CC1 & SC-CC2   *             
      *-----------------------------------------------------------*             
           MOVE  WS-S903-SC-CC1     TO WS-AMT-NETT.                             
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST         TO WS-S903-SC-CC1-GST.                      
                                                                                
           MOVE  WS-S903-SC-REC-TC1 TO WS-AMT-NETT.                             
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST         TO WS-S903-SC-TC1-GST.                      
                                                                                
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z') OR                           
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SSP' OR 'SPP'                  
                                    OR 'SPS' OR 'SRP')                          
              COMPUTE WS-SC-CC1-AMT  =  WS-S903-SC-CC1     +                    
                                        WS-S903-SC-CC1-GST +                    
                                        WS-S903-SC-REC-TC1 +                    
                                        WS-S903-SC-TC1-GST                      
           ELSE                                                                 
              COMPUTE WS-SC-CC1-AMT  =  WS-S903-SC-CC1     +                    
                                        WS-S903-SC-CC1-GST -                    
                                        WS-S903-SC-REBATE1 -                    
                                        WS-S903-SC-GRANT1  -                    
                                        WS-S903-SC-REB-SP1                      
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT       TO  L310-AMT-CURR-SCCC.                     
                                                                                
           MOVE WS-S903-SC-CURR-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-CC                TO WS-SCCC-CC.                         
           MOVE WS-WEF-YY                TO WS-SCCC-YY.                         
           MOVE WS-DTE-SCCC              TO L310-DTE-CURR-SCCC.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY        = 'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME        = 'SPO' OR 'SSP' OR 'SPP'            
                                          OR 'SPS' OR 'SRP')                    
              COMPUTE WS-SC-CC-NUM-AMT     = WS-S903-SC-CC1 +                   
                                             WS-S903-SC-REC-TC1                 
              COMPUTE WS-SC-CC-NUM-AMT-GST = WS-S903-SC-CC1-GST +               
                                             WS-S903-SC-TC1-GST                 
              MOVE WS-SC-CC-NUM-AMT       TO WS-SC-CC-AMT                       
              MOVE WS-SC-CC-NUM-AMT-GST   TO WS-SC-CC-AMT-GST                   
           ELSE                                                                 
              MOVE WS-S903-SC-CC1         TO WS-SC-CC-AMT                       
              MOVE WS-S903-SC-CC1-GST     TO WS-SC-CC-AMT-GST                   
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      = 'N' OR 'Z') OR                       
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SSP' OR 'SPP'              
                                        OR 'SPS' OR 'SRP')                      
               MOVE ')'                  TO WS-SC-CC-SIGN                       
               MOVE ZEROES               TO WS-SC-CC-REBATE-AMT                 
               MOVE SPACES               TO WS-SC-CC-REBATE-DESC                
               MOVE SPACES               TO WS-SC-CC-SIGN2                      
               MOVE ZEROES               TO WS-SC-CC-GRANT-AMT                  
               MOVE SPACES               TO WS-SC-CC-GRANT-DESC                 
               MOVE SPACES               TO WS-SC-CC-SIGN3                      
               MOVE ZEROES               TO WS-SC-CC-REB-SP-AMT                 
               MOVE SPACES               TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE1         =  ZEROES                              
              IF WS-S903-SC-GRANT1       =  ZEROES                              
                 IF WS-S903-SC-REB-SP1   =  ZEROES OR                           
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE1    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY       =  '06'                               
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT            TO L650-AMT-CURR-SCCC.                 
           MOVE WS-DTE-SCCC              TO L650-DTE-CURR-SCCC.                 
           MOVE WS-SC-CC-DESC            TO L650-CURR-GST-DESC                  
                                            L310-CURR-GST-DESC.                 
                                                                                
           IF   WS-S903-SC-CC1 = WS-S903-SC-CC2                                 
                MOVE WS-S903-SC-CC1-GST  TO WS-S903-SC-CC2-GST                  
           ELSE                                                                 
                MOVE WS-S903-SC-CC2     TO  WS-AMT-NETT                         
                CALL 'AV02C021'     USING   WS-COMM-AREA-GST                    
                MOVE WS-AMT-GST         TO  WS-S903-SC-CC2-GST.                 
                                                                                
           IF   WS-S903-SC-REC-TC1 = WS-S903-SC-REC-TC2                         
                MOVE WS-S903-SC-TC1-GST  TO WS-S903-SC-TC2-GST                  
           ELSE                                                                 
                MOVE WS-S903-SC-REC-TC2     TO  WS-AMT-NETT                     
                CALL 'AV02C021'     USING   WS-COMM-AREA-GST                    
                MOVE WS-AMT-GST         TO  WS-S903-SC-TC2-GST.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z') OR                           
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SSP' OR 'SPP'                  
                                    OR 'SPS' OR 'SRP')                          
              COMPUTE WS-SC-CC2-AMT =  WS-S903-SC-CC2     +                     
                                       WS-S903-SC-CC2-GST +                     
                                       WS-S903-SC-REC-TC2 +                     
                                       WS-S903-SC-TC2-GST                       
           ELSE                                                                 
              COMPUTE WS-SC-CC2-AMT =  WS-S903-SC-CC2     +                     
                                       WS-S903-SC-CC2-GST -                     
                                       WS-S903-SC-REBATE2 -                     
                                       WS-S903-SC-GRANT2  -                     
                                       WS-S903-SC-REB-SP2                       
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT       TO  L310-AMT-NEXT-SCCC.                     
                                                                                
           MOVE WS-S903-SC-NEXT-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-CC                TO WS-SCCC-CC.                         
           MOVE WS-WEF-YY                TO WS-SCCC-YY.                         
           MOVE WS-DTE-SCCC              TO L310-DTE-NEXT-SCCC.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY        = 'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME        = 'SPO' OR 'SSP' OR 'SPP'            
                                          OR 'SPS' OR 'SRP')                    
              COMPUTE WS-SC-CC-NUM-AMT     =  WS-S903-SC-CC2 +                  
                                              WS-S903-SC-REC-TC2                
              COMPUTE WS-SC-CC-NUM-AMT-GST =  WS-S903-SC-CC2-GST +              
                                              WS-S903-SC-TC2-GST                
              MOVE WS-SC-CC-NUM-AMT        TO WS-SC-CC-AMT                      
              MOVE WS-SC-CC-NUM-AMT-GST    TO WS-SC-CC-AMT-GST                  
           ELSE                                                                 
              MOVE WS-S903-SC-CC2          TO WS-SC-CC-AMT                      
              MOVE WS-S903-SC-CC2-GST      TO WS-SC-CC-AMT-GST                  
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      = 'N' OR 'Z') OR                       
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SSP' OR 'SPP'              
                                        OR 'SPS' OR 'SRP')                      
               MOVE ')'                  TO WS-SC-CC-SIGN                       
               MOVE ZEROES               TO WS-SC-CC-REBATE-AMT                 
               MOVE SPACES               TO WS-SC-CC-REBATE-DESC                
               MOVE SPACES               TO WS-SC-CC-SIGN2                      
               MOVE ZEROES               TO WS-SC-CC-GRANT-AMT                  
               MOVE SPACES               TO WS-SC-CC-GRANT-DESC                 
               MOVE SPACES               TO WS-SC-CC-SIGN3                      
               MOVE ZEROES               TO WS-SC-CC-REB-SP-AMT                 
               MOVE SPACES               TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE2         =  ZEROES                              
              IF WS-S903-SC-GRANT2       =  ZEROES                              
                 IF WS-S903-SC-REB-SP2   =  ZEROES OR                           
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE2    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT            TO L650-AMT-NEXT-SCCC.                 
           MOVE WS-DTE-SCCC              TO L650-DTE-NEXT-SCCC.                 
           MOVE WS-SC-CC-DESC            TO L650-NEXT-GST-DESC                  
                                            L310-NEXT-GST-DESC.                 
                                                                                
           COMPUTE WS-TOT-SCCC ROUNDED = WS-SC-CC1-AMT +                        
                                         (WS-SC-CC2-AMT * 2)                    
           MOVE WS-TOT-SCCC              TO 400C-SC-CC-AMT.                     
                                                                                
       890-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       900-SETUP-WORKSHEET.                                                     
      ******************************************************************        
           PERFORM 910-COMPUTE-COMM-DEPOSIT  THRU 910-EXIT.                     
           DISPLAY 'CALCULATING CREDIT'.                                        
           PERFORM 935-COMPUTE-CREDIT-ASSESMNT THRU 935-EXIT.                   
           DISPLAY 'CALCULATING PARTB '.                                        
           PERFORM 940-COMPUTE-PARTB-WSHEET  THRU 940-EXIT.                     
           DISPLAY 'PRINTWSHEET '.                                              
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       910-COMPUTE-COMM-DEPOSIT.                                                
      ******************************************************************        
           IF K110-CURR-SELLING-PRICE IS NUMERIC                                
              MOVE K110-CURR-SELLING-PRICE  TO WS-K110-CSPRICE                  
           ELSE                                                                 
              MOVE ZEROES                   TO WS-K110-CSPRICE.                 
                                                                                
           PERFORM 915-GET-CD-PERCENT THRU 915-EXIT.                            
                                                                                
           COMPUTE WS-COMP-SELLPR = (WS-SR08-CD-PCT / 100) *                    
                                     WS-K110-CSPRICE.                           
                                                                                
       910-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       915-GET-CD-PERCENT.                                                      
      ******************************************************************        
           MOVE SPACES                  TO WS-SR08-COMMAREA.                    
           INITIALIZE                      WS-SR08-COMMAREA.                    
                                                                                
           MOVE F310-SCH-ACC            TO WS-SR08-SCH-ACC.                     
           MOVE K800-NUM-IDP-SCHEME     TO WS-SR08-IDP-SCH.                     
           MOVE K800-NUM-ALLO-SCHEME    TO WS-SR08-ALLOC-SCH.                   
           MOVE K800-NUM-ELIG-SCHEME    TO WS-SR08-ELIG-SCH.                    
           MOVE SPACES                  TO WS-SR08-HALF-IDP.                    
           MOVE ZEROES                  TO WS-SR08-CD-PCT                       
                                           WS-SR08-JT-BALLOT-MTF.               
           MOVE SPACES                  TO WS-SR08-CDE-ERROR.                   
                                                                                
           CALL 'BP13C904' USING WS-SR08-COMMAREA.                              
                                                                                
       915-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       935-COMPUTE-CREDIT-ASSESMNT.                                             
      ******************************************************************        
           PERFORM  2000-READ-BP13K640   THRU   2000-EXIT.                      
                                                                                
           IF  K640-AMT-REPAY-PERIOD IS NOT NUMERIC                             
               MOVE  ZERO            TO  K640-AMT-REPAY-PERIOD                  
           END-IF.                                                              
           IF  K640-AMT-INTEREST-RATE IS NOT NUMERIC                            
               MOVE  ZERO            TO  K640-AMT-INTEREST-RATE                 
           END-IF.                                                              
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
               MOVE  K640-AMT-REPAY-PERIOD  TO   WS-S901-REPAY-PD               
                                                 400C-REPAY-PRD                 
                                                 400C-REPAY-PRDA                
                                                                                
               MOVE  K640-AMT-INTEREST-RATE TO   400C-INT-RATE                  
                                                 400C-INT-RATEA                 
               IF  K640-AMT-MAX-LOAN IS NOT NUMERIC                             
                   MOVE  ZERO               TO   K640-AMT-MAX-LOAN              
               END-IF                                                           
               MOVE     K640-AMT-MAX-LOAN   TO   400C-MAX-LOAN-ELIG             
               MOVE     K640-AMT-MAX-LOAN   TO   400C-MAX-LOAN-ELIG2            
               IF  K640-AMT-ELIG-INSTAL IS NOT NUMERIC                          
                   MOVE  ZERO               TO   K640-AMT-ELIG-INSTAL           
               END-IF                                                           
               MOVE     K640-AMT-ELIG-INSTAL TO  400C-INSTAL-ELIG               
               IF  K800-AMT-HSE-INCOME  IS NOT NUMERIC                          
                   MOVE  ZERO                TO  K800-AMT-HSE-INCOME            
               END-IF                                                           
               PERFORM 937-YOUNGEST-APPL    THRU   937-EXIT                     
           ELSE                                                                 
           IF K800-NUM-CA-TAG = 'E'                                             
              MOVE '30'                      TO  400C-REPAY-PRD                 
                                                 400C-REPAY-PRDA                
              MOVE K640-AMT-INTEREST-RATE    TO  400C-INT-RATE                  
                                                 400C-INT-RATEA                 
           END-IF.                                                              
                                                                                
       935-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       937-YOUNGEST-APPL.                                                       
      ******************************************************************        
            MOVE    FUNCTION CURRENT-DATE(1:8)  TO      WS-CURR-DATE2.          
                                                                                
            IF WS-DOB1 = ZERO  OR LOW-VALUES OR SPACES                          
            IF WS-DOB2 = ZERO  OR LOW-VALUES OR SPACES                          
            IF WS-DOB3 = ZERO  OR LOW-VALUES OR SPACES                          
            IF WS-DOB4 = ZERO  OR LOW-VALUES OR SPACES                          
                  GO TO 937-EXIT                                                
            END-IF.                                                             
                                                                                
            IF WS-DOB1 = SPACES OR LOW-VALUES OR ZERO                           
               MOVE '00000000'    TO   WS-DOB1.                                 
            IF WS-DOB2 = SPACES OR LOW-VALUES OR ZERO                           
               MOVE '00000000'    TO   WS-DOB2.                                 
            IF WS-DOB3 = SPACES OR LOW-VALUES OR ZERO                           
               MOVE '00000000'    TO   WS-DOB3.                                 
            IF WS-DOB4 = SPACES OR LOW-VALUES OR ZERO                           
               MOVE '00000000'    TO   WS-DOB4.                                 
                                                                                
            MOVE  ZERO            TO   WS-YNGST-DOB-NUM.                        
                                                                                
            IF (WS-DOB1 NOT = '00000000' )  AND                                 
               WS-DOB1 > WS-DOB2 AND WS-DOB1 > WS-DOB3 AND                      
               WS-DOB1 > WS-DOB4                                                
                   DISPLAY 'DOB1 : '   WS-DOB1                                  
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB1                        
            ELSE                                                                
            IF (WS-DOB2 NOT = '00000000') AND                                   
               WS-DOB2 > WS-DOB1 AND WS-DOB2 > WS-DOB3 AND                      
               WS-DOB2 > WS-DOB4                                                
                   DISPLAY 'DOB2 : '   WS-DOB2                                  
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB2                        
            ELSE                                                                
            IF (WS-DOB3 NOT = '00000000') AND                                   
               WS-DOB3 > WS-DOB1 AND WS-DOB3 > WS-DOB2 AND                      
               WS-DOB3 > WS-DOB4                                                
                   DISPLAY 'DOB3 : '   WS-DOB3                                  
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB3                        
            ELSE                                                                
            IF (WS-DOB4 NOT = '00000000') AND                                   
               WS-DOB4 > WS-DOB1 AND WS-DOB4 > WS-DOB2 AND                      
               WS-DOB4 > WS-DOB3                                                
                   DISPLAY 'DOB4 : '   WS-DOB4                                  
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB4.                       
                                                                                
            MOVE  ZERO    TO  WS-AGE.                                           
                                                                                
            COMPUTE   WS-AGE  = WS-YYYY - WS-YNGST-CCYY.                        
            IF WS-YNGST-MMDD > WS-MMDD                                          
               COMPUTE  WS-AGE = WS-AGE - 1.                                    
                                                                                
            MOVE  WS-AGE  TO  400C-YNGST-PURCHSR.                               
                                                                                
       937-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       940-COMPUTE-PARTB-WSHEET.                                                
      ******************************************************************        
      ***********************************************************               
      *   TO GET THE FEES AND INSTALMENT                                        
      *************************************************************             
           MOVE ZEROES                   TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF1 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF1      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF2 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF2      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF3 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF3      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF4 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF4      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CASH IS NUMERIC                                       
              ADD  K800-AMT-CD-CASH      TO WS-TOTAL-CD.                        
                                                                                
           IF K800-AMT-CD-REFUND IS NOT NUMERIC                                 
              MOVE ZEROES TO K800-AMT-CD-REFUND                                 
           END-IF.                                                              
           SUBTRACT K800-AMT-CD-REFUND   FROM WS-TOTAL-CD.                      
                                                                                
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
           MOVE ZEROS                    TO WS-MAX-LOAN-AMT.                    
                                                                                
           MOVE K800-NUM-ALLO-SCHEME     TO   WS-ALLOC-SCH.                     
           PERFORM 110-CHK-SERS          THRU 110-EXIT.                         
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              IF K800-NUM-PREMIUM-RATE > 0                                      
                 PERFORM 945-CALL-BP13C90N   THRU 945-EXIT                      
              ELSE                                                              
                 PERFORM 943-CALL-BP13C900   THRU 943-EXIT                      
              END-IF                                                            
           ELSE                                                                 
              IF K800-NUM-CA-TAG = 'E'                                          
                 PERFORM 943-CALL-BP13C900   THRU 943-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-LOAN-INT-2           TO WS-S900-TOT-ICP.                     
           MOVE ZEROES                  TO WS-LOAN-INT-2.                       
           MOVE WS-LOAN-ROUND-DOWN      TO WS-MAX-LOAN-AMT.                     
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              IF K800-NUM-PREMIUM-RATE > 0                                      
                 PERFORM 945-CALL-BP13C90N   THRU 945-EXIT                      
              ELSE                                                              
                 PERFORM 943-CALL-BP13C900   THRU 943-EXIT                      
              END-IF                                                            
           ELSE                                                                 
             IF K800-NUM-CA-TAG = 'E'                                           
                PERFORM 943-CALL-BP13C900    THRU 943-EXIT                      
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              IF K640-AMT-MAX-LOAN < WS-MAX-LOAN-AMT                            
                 PERFORM 944-CALL-BP13C90A  THRU 944-EXIT                       
                 MOVE K640-AMT-MAX-LOAN     TO 400C-MAX-LOAN-AMT                
              ELSE                                                              
                 MOVE WS-MAX-LOAN-AMT       TO 400C-MAX-LOAN-AMT                
              END-IF                                                            
           ELSE                                                                 
              IF K800-NUM-CA-TAG = 'E'                                          
                 MOVE WS-MAX-LOAN-AMT       TO 400C-MAX-LOAN-AMT                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           COMPUTE WS-TOTAL-CD      = WS-TOTAL-CD + WS-LOAN-INT-2.              
                                                                                
           COMPUTE WS-TOT-STAMP-FEE = WS-COMP-LEASE + WS-MORT-STAMP-FEE         
                                    + WS-COMP-MORTGAGE +                        
                                      WS-S900-PREM-ST-FEE.                      
           COMPUTE WS-TOTAL-FEES    = WS-TOT-STAMP-FEE +                        
                                      WS-S900-CONVEY-FEE +                      
                                      WS-S900-CONVEY-FEE-GST +                  
                                      WS-COMP-SURVEY-FEE.                       
                                                                                
           MOVE K800-AMT-PREMIUM         TO WS-AMT-PREMIUM.                     
           COMPUTE WS-PURCHASE-PRICE =      K110-CURR-SELLING-PRICE +           
                                            WS-AMT-PREMIUM.                     
           COMPUTE WS-TOTAL-SELLPR  = WS-TOTAL-FEES +                           
                                      WS-PURCHASE-PRICE.                        
           COMPUTE WS-BALANCE-AMT   = WS-TOTAL-SELLPR - WS-TOTAL-CD.            
                                                                                
           MOVE WS-S900-PREM-ST-FEE      TO 400C-AMT-LS-FEE.                    
           MOVE WS-S900-CONVEY-FEE       TO 400C-ACT-CV-FEE.                    
           MOVE WS-S900-CONVEY-FEE-GST   TO 400C-GST-CV-FEE.                    
                                                                                
           COMPUTE WS-CONVEY-FEE =  WS-S900-CONVEY-FEE +                        
                                    WS-S900-CONVEY-FEE-GST.                     
           MOVE WS-CONVEY-FEE            TO  400C-AMT-CV-FEE.                   
                                                                                
           MOVE ZEROES                   TO  WS-AMT-BAL-CD-CASH.                
           COMPUTE WS-AMT-BAL-CD-CASH =  K800-AMT-CD-CASH -                     
                                         K800-AMT-CD-REFUND.                    
                                                                                
           MOVE WS-AMT-BAL-CD-CASH       TO 400C-CD-CASH.                       
           MOVE WS-LOAN-INT-2            TO 400C-LOAN-TOP-UP.                   
           MOVE WS-COMP-LEASE            TO 400C-LEASE-FEE.                     
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
           MOVE WS-MORT-STAMP-FEE        TO 400C-MORT-STAMP-FEE.                
           MOVE WS-COMP-MORTGAGE         TO 400C-MORTGAGE-FEE.                  
           MOVE WS-TOT-STAMP-FEE         TO 400C-TOT-STAMP-FEE.                 
           MOVE WS-TOTAL-FEES            TO 400C-TOT-FEES.                      
           MOVE WS-TOTAL-SELLPR          TO 400C-TOT-SELLPR.                    
           MOVE WS-TOTAL-CD              TO 400C-TOTAL-CD.                      
           MOVE K800-AMT-CD-CPF1         TO 400C-CD-CPF1.                       
                                                                                
           MOVE '     '                  TO 400C-CD-CPF1-TXT.                   
           MOVE K800-AMT-CD-CPF2         TO 400C-CD-CPF2.                       
           MOVE K800-AMT-CD-CPF3         TO 400C-CD-CPF3.                       
           MOVE K800-AMT-CD-CPF4         TO 400C-CD-CPF4.                       
           MOVE WS-BALANCE-AMT           TO 400C-BALANCE-AMT.                   
                                                                                
      *==> GET INTEREST RATE                                                    
           MOVE   FUNCTION CURRENT-DATE(1:8) TO WS-COMPUTE-DATE.                
                                                                                
           PERFORM 941-READ-AB03K050   THRU 941-EXIT.                           
                                                                                
      *==> TO GET INSTALMENT                                                    
           MOVE   'N'                    TO WS-S901-ERL.                        
           MOVE    F310-CDE-TYP-ACTUSE   TO WS-S901-RM.                         
           MOVE    F310-CDE-MODL-DESG    TO WS-S901-DESIGN.                     
           MOVE    ZERO                  TO WS-S901-REPAY-PD.                   
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              MOVE  K640-AMT-REPAY-PERIOD   TO WS-S901-REPAY-PD                 
           END-IF.                                                              
           IF K800-NUM-CA-TAG = 'E'                                             
              MOVE    30                    TO WS-S901-REPAY-PD                 
           END-IF.                                                              
                                                                                
           IF WS-K050-CDE-LOAN-SCH = 'P'                                        
              COMPUTE WS-S901-INT = K050-PCT-PA-INT * 0.01                      
              MOVE    K050-CDE-PA-FACTOR  TO  WS-S901-FAC                       
           ELSE                                                                 
              MOVE    K050-CDE-MKT-FACTOR  TO  WS-S901-FAC                      
               IF K640-AMT-REPAY-PERIOD >= 1 AND                                
                  K640-AMT-REPAY-PERIOD <= 5                                    
                  COMPUTE WS-S901-INT = K050-PCT-MKT-INT(1) * 0.01              
               ELSE                                                             
               IF K640-AMT-REPAY-PERIOD >= 6 AND                                
                  K640-AMT-REPAY-PERIOD <= 10                                   
                  COMPUTE WS-S901-INT = K050-PCT-MKT-INT(2) * 0.01              
               ELSE                                                             
                  COMPUTE WS-S901-INT = K050-PCT-MKT-INT(3) * 0.01              
               END-IF                                                           
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              COMPUTE WS-ICP-TOP-UP = WS-BALANCE-AMT -                          
                                      K640-AMT-MAX-LOAN                         
              IF WS-ICP-TOP-UP > 0                                              
                  MOVE WS-ICP-TOP-UP      TO 400C-TOP-UP-ICP                    
                  MOVE K640-AMT-MAX-LOAN  TO WS-S901-LOAN-AMT                   
              ELSE                                                              
                  MOVE  ZERO              TO 400C-TOP-UP-ICP                    
                  MOVE WS-BALANCE-AMT     TO WS-S901-LOAN-AMT                   
              END-IF                                                            
           ELSE                                                                 
              MOVE    WS-MAX-LOAN-AMT     TO WS-S901-LOAN-AMT                   
              MOVE    ZEROES              TO WS-S901-ERL-LOAN-AMT               
           END-IF.                                                              
                                                                                
           IF  WS-S901-INT IS NOT NUMERIC OR WS-S901-INT = ZERO                 
               MOVE 'INT.RATE = 0 IN BP13C901' TO  L650A-REMARK                 
               PERFORM  2500-SKIP-REC      THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF  WS-S901-REPAY-PD IS NOT NUMERIC OR                               
               WS-S901-REPAY-PD = ZERO                                          
               MOVE 'REPAY-PD = 0 IN BP13C901' TO  L650A-REMARK                 
               PERFORM  2500-SKIP-REC      THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF  WS-S901-FAC      IS NOT NUMERIC OR                               
               WS-S901-FAC  = ZERO                                              
               MOVE 'S901-FAC = 0 IN BP13C901' TO  L650A-REMARK                 
               PERFORM  2500-SKIP-REC      THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           CALL   'BP13C901' USING WS-LINK-S901.                                
           MOVE    WS-S901-MTH-INSTAL   TO WS-MTHLY-INSTAL.                     
           MOVE WS-MTHLY-INSTAL         TO 400C-MTHLY-INSTAL.                   
                                                                                
       940-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       941-READ-AB03K050.                                                       
      ******************************************************************        
            MOVE K640-CDE-LOAN-OPTION  TO K050-CDE-LOAN-SCH                     
                                          WS-K050-CDE-LOAN-SCH.                 
                                                                                
            MOVE 'N'                   TO WS-K050-EOF.                          
            MOVE LOW-VALUES            TO K050-DTE-INT-EFF.                     
                                                                                
            START  AB03K050  KEY > K050-KEY.                                    
                                                                                
            IF AB03K050-STATUS NOT = 00                                         
               DISPLAY 'ERROR READING AB03K050, STATUS '                        
                                      AB03K050-STATUS                           
               MOVE AB03K050-STATUS TO RETURN-CODE                              
               PERFORM  1000-CLOSE-ROUTINE                                      
            END-IF.                                                             
                                                                                
            PERFORM  UNTIL WS-K050-EOF = 'Y'                                    
              READ  AB03K050  NEXT                                              
              IF AB03K050-STATUS NOT = '00' AND '10'                            
                 DISPLAY 'ERROR READING AB03K050, STATUS '                      
                                        AB03K050-STATUS                         
                 MOVE AB03K050-STATUS TO RETURN-CODE                            
                 PERFORM  1000-CLOSE-ROUTINE                                    
              END-IF                                                            
              IF AB03K050-STATUS = '10'                                         
                 MOVE 'Y'           TO   WS-K050-EOF                            
              END-IF                                                            
              IF K050-CDE-LOAN-SCH NOT = WS-K050-CDE-LOAN-SCH                   
                 MOVE 'Y'           TO   WS-K050-EOF                            
              ELSE                                                              
                 PERFORM 965-CHECK-DATE    THRU  965-EXIT                       
              END-IF                                                            
            END-PERFORM.                                                        
                                                                                
            MOVE  WS-AB03K050-REC        TO      AB03K050-REC.                  
                                                                                
            IF  K050-CDE-LOAN-SCH  NOT = WS-K050-CDE-LOAN-SCH                   
                GO TO 990-ERROR.                                                
                                                                                
            MOVE  K050-DTE-PA-ANCENT     TO      WS-VALID-DATE.                 
                                                                                
            IF K050-CDE-LOAN-SCH = 'P' AND                                      
               VALID-YEAR1 AND VALID-MONTH1 AND VALID-DATE1 AND                 
               WS-COMPUTE-DATE > K050-DTE-PA-ANCENT                             
                  GO TO 941-EXIT.                                               
                                                                                
            MOVE  K050-DTE-MKT-ANCENT     TO      WS-VALID-DATE.                
                                                                                
            IF K050-CDE-LOAN-SCH = 'M' AND                                      
               VALID-YEAR1 AND VALID-MONTH1 AND VALID-DATE1 AND                 
               WS-COMPUTE-DATE > K050-DTE-MKT-ANCENT                            
                  GO TO 941-EXIT.                                               
                                                                                
            GO TO 990-ERROR.                                                    
                                                                                
       941-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       965-CHECK-DATE.                                                          
      ******************************************************************        
            IF K050-DTE-PA-ANCENT IS NOT NUMERIC  AND                           
               K050-CDE-LOAN-SCH = 'P'                                          
               MOVE 'Y'      TO    WS-K050-EOF                                  
               GO TO  965-EXIT                                                  
            END-IF.                                                             
                                                                                
            IF K050-DTE-MKT-ANCENT IS NOT NUMERIC AND                           
               K050-CDE-LOAN-SCH = 'M'                                          
               MOVE 'Y'      TO    WS-K050-EOF                                  
               GO TO  965-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  K050-DTE-PA-ANCENT   TO  WS-VALID-DATE.                       
                                                                                
            IF K050-CDE-LOAN-SCH = 'P'                                          
               IF  VALID-YEAR1 AND VALID-MONTH1 AND VALID-DATE1 AND             
                   WS-COMPUTE-DATE <= K050-DTE-PA-ANCENT                        
                   MOVE 'Y'      TO    WS-K050-EOF                              
               ELSE                                                             
                   MOVE  AB03K050-REC       TO  WS-AB03K050-REC                 
               END-IF                                                           
            END-IF.                                                             
                                                                                
            MOVE  K050-DTE-MKT-ANCENT   TO  WS-VALID-DATE.                      
            IF  K050-CDE-LOAN-SCH = 'M'                                         
                IF  VALID-YEAR1 AND VALID-MONTH1 AND VALID-DATE1 AND            
                    WS-COMPUTE-DATE <= K050-DTE-MKT-ANCENT                      
                    MOVE 'Y'      TO    WS-K050-EOF                             
                ELSE                                                            
                    MOVE  AB03K050-REC       TO  WS-AB03K050-REC                
                END-IF                                                          
            END-IF.                                                             
                                                                                
       965-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       990-ERROR.                                                               
      ******************************************************************        
               MOVE  '99'             TO  RETURN-CODE                           
               GO  TO  1000-CLOSE-ROUTINE.                                      
                                                                                
                                                                                
      ******************************************************************        
       943-CALL-BP13C900.                                                       
      ******************************************************************        
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE WS-PURCHASE-PRICE        TO WS-S900-SELL-PR.                    
           MOVE WS-PURCHASE-PRICE        TO 400C-SELLING-PRICE.                 
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE ZERO                     TO WS-S900-REPAY-PD.                   
           IF K800-NUM-CA-TAG = 'Y'                                             
           MOVE K640-AMT-REPAY-PERIOD    TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           IF K800-NUM-CA-TAG = 'E'                                             
           MOVE 30                       TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY           
                                            WS-S900-SALE-TYPE.                  
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE K800-NUM-PREMIUM-RATE    TO WS-S900-PREMIUM-CODE.               
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
           MOVE ZEROS                    TO WS-S900-CONVEY-FEE                  
                                            WS-S900-CONVEY-FEE-GST.             
                                                                                
           CALL 'BP13C900' USING WS-LINK-S900.                                  
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE  =  WS-S900-LS-ESCROW-FEE +                    
                                     WS-S900-LS-REGN-FEE.                       
                                                                                
           MOVE WS-S900-MORT-ST-FEE     TO WS-MORT-STAMP-FEE.                   
                                                                                
           COMPUTE WS-COMP-MORTGAGE =  WS-S900-MORT-ESCROW-FEE +                
                                       WS-S900-MORT-REGN-FEE.                   
                                                                                
           MOVE WS-S900-LOAN          TO WS-LOAN-ROUND-DOWN.                    
                                                                                
           DISPLAY 'LOAN ROUND ' WS-LOAN-ROUND-DOWN.                            
                                                                                
       943-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       944-CALL-BP13C90A.                                                       
      ******************************************************************        
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE K800-AMT-PREMIUM         TO WS-AMT-PREMIUM.                     
           COMPUTE WS-PURCHASE-PRICE =      K110-CURR-SELLING-PRICE +           
                                            WS-AMT-PREMIUM                      
           MOVE  WS-PURCHASE-PRICE       TO 400C-SELLING-PRICE.                 
           MOVE  WS-PURCHASE-PRICE       TO WS-S900-SELL-PR.                    
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE ZERO                     TO WS-S900-REPAY-PD.                   
           IF K800-NUM-CA-TAG = 'Y'                                             
           MOVE K640-AMT-REPAY-PERIOD    TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           IF K800-NUM-CA-TAG = 'E'                                             
           MOVE 30                       TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY           
                                            WS-S900-SALE-TYPE.                  
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE K800-NUM-PREMIUM-RATE    TO WS-S900-PREMIUM-CODE.               
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
           MOVE K640-AMT-MAX-LOAN        TO WS-S900-LOAN.                       
                                                                                
           CALL 'BP13C90A' USING WS-LINK-S900.                                  
                                                                                
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE     =      WS-S900-LS-ESCROW-FEE +             
                                            WS-S900-LS-REGN-FEE.                
                                                                                
           MOVE WS-S900-MORT-ST-FEE      TO WS-MORT-STAMP-FEE.                  
                                                                                
           COMPUTE WS-COMP-MORTGAGE  =      WS-S900-MORT-ESCROW-FEE +           
                                            WS-S900-MORT-REGN-FEE.              
                                                                                
           COMPUTE WS-TOT-STAMP-FEE = WS-COMP-LEASE + WS-MORT-STAMP-FEE         
                                + WS-COMP-MORTGAGE +                            
                                  WS-S900-PREM-ST-FEE.                          
           COMPUTE WS-TOTAL-FEES    = WS-TOT-STAMP-FEE +                        
                                      WS-S900-CONVEY-FEE +                      
                                      WS-S900-CONVEY-FEE-GST +                  
                                      WS-COMP-SURVEY-FEE.                       
           COMPUTE WS-TOTAL-SELLPR  = WS-TOTAL-FEES +                           
                                      WS-PURCHASE-PRICE.                        
           COMPUTE WS-BALANCE       = WS-TOTAL-SELLPR -                         
                                      WS-TOTAL-CD.                              
                                                                                
           MOVE WS-BALANCE               TO WS-LOAN-ROUND-DOWN.                 
           COMPUTE WS-MAX-LOAN-AMT  = WS-LOAN-INT-5 * 100.                      
                                                                                
       944-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       945-CALL-BP13C90N.                                                       
      ******************************************************************        
      *TO CALCULATE LOAN FOR OFFER SELLING PRICE + PREMIUM                      
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE K800-AMT-PREMIUM         TO WS-AMT-PREMIUM.                     
           COMPUTE WS-PURCHASE-PRICE =      K110-CURR-SELLING-PRICE +           
                                            WS-AMT-PREMIUM.                     
           MOVE  WS-PURCHASE-PRICE       TO 400C-SELLING-PRICE.                 
           MOVE  WS-PURCHASE-PRICE       TO WS-S900-SELL-PR.                    
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE ZERO                     TO WS-S900-REPAY-PD.                   
           IF K800-NUM-CA-TAG = 'Y'                                             
           MOVE K640-AMT-REPAY-PERIOD    TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           IF K800-NUM-CA-TAG = 'E'                                             
           MOVE 30                       TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY           
                                            WS-S900-SALE-TYPE.                  
           MOVE ZEROS                    TO WS-S900-CONVEY-FEE                  
                                            WS-S900-CONVEY-FEE-GST.             
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE K800-NUM-PREMIUM-RATE    TO WS-S900-PREMIUM-CODE.               
           IF K110-1ST-OFFER-SELLING-PRICE IS NOT NUMERIC                       
              MOVE  ZERO          TO   K110-1ST-OFFER-SELLING-PRICE             
           END-IF.                                                              
                                                                                
           IF K110-AMT-POD IS NOT NUMERIC                                       
              MOVE  ZERO          TO   K110-AMT-POD                             
           END-IF.                                                              
                                                                                
           IF K110-AMT-POF IS NOT NUMERIC                                       
              MOVE  ZERO          TO   K110-AMT-POF                             
           END-IF.                                                              
                                                                                
           COMPUTE  WS-S90N-OFFERPR = K110-1ST-OFFER-SELLING-PRICE +            
                                      K110-AMT-POD +                            
                                      K110-AMT-POF.                             
                                                                                
           COMPUTE  WS-S90N-OFFERPR-PREMIUM = WS-S90N-OFFERPR +                 
                                              WS-AMT-PREMIUM.                   
                                                                                
           CALL 'BP13C90N' USING WS-LINK-S90N.                                  
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE  =  WS-S900-LS-ESCROW-FEE +                    
                                     WS-S900-LS-REGN-FEE.                       
                                                                                
           MOVE WS-S900-MORT-ST-FEE     TO WS-MORT-STAMP-FEE.                   
                                                                                
           COMPUTE WS-COMP-MORTGAGE =  WS-S900-MORT-ESCROW-FEE +                
                                       WS-S900-MORT-REGN-FEE.                   
                                                                                
           MOVE WS-S900-LOAN          TO WS-LOAN-ROUND-DOWN.                    
                                                                                
           DISPLAY 'LOAN ROUND ' WS-LOAN-ROUND-DOWN.                            
                                                                                
       945-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       950-PROCESS-PRINT-WSHEET.                                                
      ******************************************************************        
      *==> PRINT PARTA                                                          
           MOVE F310-REGN-NO    TO   L211-REGN-NO.                              
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              WRITE PRINT-REC4     FROM L310A-PR-HEAD-09     AFTER PAGE         
              PERFORM  951-PRINT-CA-Y        THRU   951-EXIT                    
           ELSE                                                                 
           IF K800-NUM-CA-TAG = 'E'                                             
              WRITE PRINT-REC5     FROM L310A-PR-HEAD-09     AFTER PAGE         
              PERFORM  952-PRINT-CA-E        THRU   952-EXIT.                   
                                                                                
       950-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       951-PRINT-CA-Y.                                                          
      ******************************************************************        
      *==> PRINT PARTA                                                          
           WRITE PRINT-REC4     FROM L400C-PR-LINE-1   AFTER 4.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-2   AFTER 1.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-2C  AFTER 1.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-2D  AFTER 1.                 
           MOVE  SPACES         TO   PRINT-REC4.                                
           WRITE PRINT-REC4                            AFTER 2.                 
                                                                                
      *==> PRINT PARTB                                                          
           WRITE PRINT-REC4     FROM L400C-PR-LINE-3   AFTER 3.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-3A  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-4   AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-5   AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-6   AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-7   AFTER 2.                 
           MOVE  '('            TO FILLER-1.                                    
           MOVE  ')'            TO FILLER-2.                                    
           WRITE PRINT-REC4     FROM L400C-PR-LINE-7A  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-8   AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-9   AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-10  AFTER 3.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-11  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-12  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-13  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-14  AFTER 2                  
           WRITE PRINT-REC4     FROM L400C-PR-LINE-14A AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-15  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-16  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-16B AFTER 2.                 
                                                                                
           MOVE   K640-AMT-REPAY-PERIOD   TO  L400C-REPAY-PRD.                  
                                                                                
           WRITE PRINT-REC4     FROM L400C-PR-LINE-17  AFTER 2.                 
           WRITE PRINT-REC4     FROM L400C-PR-LINE-18  AFTER 2.                 
                                                                                
      *==> PRINT NOTE                                                           
           MOVE   WS-EDITED-DATE  TO L310-SYS-DATE.                             
           WRITE  PRINT-REC4    FROM L310A-PR-LINE-15  AFTER 8.                 
           WRITE  PRINT-REC4    FROM L310A-PR-LINE-16  AFTER 1.                 
           WRITE  PRINT-REC4    FROM L310A-PR-LINE-17  AFTER 1.                 
                                                                                
       951-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       952-PRINT-CA-E.                                                          
      ******************************************************************        
      *==> PRINT PARTA                                                          
           WRITE PRINT-REC5     FROM L400C-PR-LINE-1A  AFTER 4.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-2A  AFTER 1.                 
           MOVE  SPACES         TO   PRINT-REC5.                                
           WRITE PRINT-REC5                            AFTER 1.                 
                                                                                
      *==> PRINT PARTB                                                          
           WRITE PRINT-REC5     FROM L400C-PR-LINE-3   AFTER 3.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-3A  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-4   AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-5   AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-6   AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-7   AFTER 2.                 
           MOVE  SPACES         TO FILLER-1 FILLER-2.                           
           WRITE PRINT-REC5     FROM L400C-PR-LINE-7A  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-8   AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-9   AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-10  AFTER 3.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-11  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-12  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-13  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-14  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-14A AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-15  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-16  AFTER 2.                 
                                                                                
           MOVE   ZERO                     TO  L400C-REPAY-PRD.                 
                                                                                
           WRITE PRINT-REC5     FROM L400C-PR-LINE-17  AFTER 2.                 
           WRITE PRINT-REC5     FROM L400C-PR-LINE-18  AFTER 2.                 
                                                                                
      *==> PRINT NOTE                                                           
           MOVE   WS-EDITED-DATE  TO L310-SYS-DATE.                             
           WRITE  PRINT-REC5    FROM L310A-PR-LINE-15  AFTER 13.                
           WRITE  PRINT-REC5    FROM L310A-PR-LINE-16  AFTER 1.                 
           WRITE  PRINT-REC5    FROM L310A-PR-LINE-17  AFTER 1.                 
                                                                                
       952-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1000-CLOSE-ROUTINE.                                                      
      ******************************************************************        
            DISPLAY '                                        '.                 
            DISPLAY ' *****   BP13C650 CONTROL TOTALS   *****'.                 
            DISPLAY '                                        '.                 
            DISPLAY ' NO READ FROM F310     : ' WS-CNT-F310.                    
            DISPLAY ' NO READ FROM K110     : ' WS-CNT-K110.                    
            DISPLAY ' NO READ FROM K820     : ' WS-CNT-K820.                    
            DISPLAY ' NO READ FROM K830     : ' WS-CNT-K830.                    
            DISPLAY ' NO READ FROM K640     : ' WS-CNT-K640.                    
            DISPLAY ' NO READ FROM K022     : ' WS-CNT-K022.                    
            DISPLAY ' NO READ FROM K024     : ' WS-CNT-K024.                    
            DISPLAY ' NO PROCESSED          : ' WS-CNT-PROC.                    
            DISPLAY ' NO PRINTED            : ' WS-CNT-LETTERS.                 
            DISPLAY ' NO SKIPPED            : ' WS-CNT-SKIPPED.                 
                                                                                
            CLOSE BP13F310                                                      
                  BP13K022                                                      
                  BP13K024                                                      
                  BP13K800                                                      
                  BP13K820                                                      
                  BP13K830                                                      
                  BM06K100                                                      
                  BM06K110                                                      
                  AB03K050                                                      
                  P13L650A                                                      
                  P13L650B                                                      
                  P13L650D                                                      
                  P13L650E.                                                     
                                                                                
            CALL 'CAV02001' USING LINK-REC.                                     
                                                                                
            IF BP13K022-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K022-STAT ' BP13K022-STATUS.          
            IF BP13K024-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K024-STAT ' BP13K024-STATUS.          
            IF BP13K800-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K800-STAT ' BP13K800-STATUS.          
            IF BP13K820-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K820-STAT ' BP13K820-STATUS.          
            IF BP13K830-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K830-STAT ' BP13K830-STATUS.          
            IF BM06K100-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BM06K100-STAT ' BM06K100-STATUS.          
            IF BM06K110-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BM06K110-STAT ' BM06K110-STATUS.          
                                                                                
            STOP RUN.                                                           
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2000-READ-BP13K640.                                                      
      ******************************************************************        
              MOVE  SPACES               TO      BP13K640-TRANS-REC.            
              MOVE  F310-REGN-NO         TO      K640-REGN-NO.                  
              READ BP13K640.                                                    
                                                                                
              EVALUATE BP13K640-STATUS                                          
                 WHEN '00'                                                      
                         ADD     1       TO      WS-CNT-K640                    
                 WHEN '23'                                                      
                         DISPLAY 'BP13K640 - RECORD NOT FOUND '                 
                         DISPLAY 'KEY : ' K640-REGN-NO                          
                 WHEN OTHER                                                     
                         DISPLAY 'ERROR READING BP13K640      '                 
                         DISPLAY 'KEY : ' K640-REGN-NO                          
                         DISPLAY 'STATUS : '  BP13K640-STATUS                   
              END-EVALUATE.                                                     
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2500-SKIP-REC.                                                           
      ******************************************************************        
            IF   WS-SKIP-PR-LINE   >  55                                        
                  ADD       1       TO     WS-SKIP-PAGE-NO                      
                  PERFORM   2550-WRITE-HEADER    THRU  2550-EXIT                
            END-IF.                                                             
                                                                                
            MOVE   F310-REGN-NO          TO    L650A-REGN-NO.                   
            MOVE   WS-S901-REPAY-PD      TO    L650A-REPAY-PD.                  
            MOVE   WS-S901-FAC           TO    L650A-FAC.                       
            MOVE   WS-S901-INT           TO    L650A-INT.                       
            WRITE  P13L650A-REC          FROM  L650A-DETAIL.                    
            ADD    1                     TO    WS-SKIP-PR-LINE.                 
                                                                                
            ADD    1                     TO    WS-CNT-SKIPPED.                  
                                                                                
       2500-EXIT.                                                               
              EXIT.                                                             
                                                                                
                                                                                
      ******************************************************************        
       2550-WRITE-HEADER.                                                       
      ******************************************************************        
             WRITE  P13L650A-REC     FROM   L650A-HEADER-1 AFTER PAGE.          
                                                                                
             MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-CUR-YYYYMMDD.              
             MOVE WS-CUR-DD            TO WS-EDIT-DD.                           
             MOVE WS-CUR-MM            TO WS-EDIT-MM.                           
             MOVE WS-CUR-YYYY          TO WS-EDIT-YYYY.                         
             MOVE WS-EDITED-DATE       TO L650A-PRT-DATE.                       
                                                                                
             MOVE   WS-SKIP-PAGE-NO    TO     L650A-PAGE-NO.                    
             WRITE  P13L650A-REC       FROM   L650A-HEADER-2  AFTER 2.          
                                                                                
             MOVE   ALL '-'            TO     P13L650A-REC.                     
             WRITE  P13L650A-REC       AFTER 1.                                 
                                                                                
             WRITE  P13L650A-REC       FROM   L650A-HEADER-3  AFTER 1.          
                                                                                
             MOVE   ALL '-'            TO     P13L650A-REC.                     
             WRITE  P13L650A-REC       AFTER 1.                                 
             MOVE   4                  TO     WS-SKIP-PR-LINE.                  
                                                                                
       2550-EXIT.                                                               
              EXIT.                                                             
