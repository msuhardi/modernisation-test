      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C436.                                                 
      *AUTHOR.        TOH SHIOK KUAN.                                           
      *DATE-WRITTEN.  11/10/89.                                                 
                                                                                
      * ========================================================= *             
      * SYSTEM OF COMMITMENT  (BP13)                              *             
      * ========================================================= *             
      *    OBJECTIVE :                                            *             
      *      1. TO PRINT PAYMENT SCHEDULE FOR STAMPING OF         *             
      *         DEED OF ASSIGNMENT (BP13L436J) FOR DBSS           *             
      *                                                           *             
      *    I/O FILES :                                            *             
      *       INPUT  :  BP13F315 - TRANSACTION FILE (SEQ)         *             
      *                 BP13K800 - SOC APPLICATION MASTER (VSAM)  *             
      *                 BP13KD40 - PROGRESS PAYMENT (VSAM)        *             
      *                 BP13KD45 - PROGRESS PAYMENT - ACCUM (VSAM)*             
      *      OUTPUT  :  BP13K625 - STAMP FEE MASTER (SEQ)         *             
      *                 AG07F225 - STAMPING FILE    (SEQ)         *             
      *                 BP13436J - STAMPING DOA FOR SOC FLAT      *             
      *                                                           *             
      * --------------------------------------------------------- *             
      * CHG REF  DATE   BY   DESCRIPTIONS                         *             
      * -------- ------ ---  ------------                         *             
      * BP132937 120107 CLT1 STAMPING FOR DBSS                    *             
      *                      PROGRAM IS SIMILAR TO BP13C416       *             
      * BP132969 130207 MTSR MOVE SFTT CODE TO F220-TXT-INFO      *             
      * BP133781 070710 ESD1 CATER FOR PRINTING TRANS CODE 'DS'.  *             
      * BP134218 110511 JB8  TO CATER FOR REMOVAL OF NOMINAL DUTIES             
      * BP134745 191212 IMC1 INITIALIZE SOLICITOR NAME EVERY PROJ *             
      * BP135032 291013 JGO1 TO READ KA10 WHEN PROJ CODE CHANGE   *             
      *                      FROM PREVIOUS PROJ CODE              *             
      * BP135096 051213 JGO1 UPDATE VOUCHER FROM 'SU' TO 'SS'     *             
      * BP135146 040614 JGO1 ADD EXCEPTION FOR CASE 5042672F      *             
      * BP135120 110714 JGO1 CHANGE OUTPUT FROM F220 TO F225      *             
      * BP135437 120814 JGO1 CHANGE VOUCHER INFO                  *             
      * BP135832 190515 JGO1 UPDATE VALUE PASSED TO F225 BANK     *             
      * BP137140 191217 PCL4 TO REDEFINE AG07 FILE ERROR CODE     *             
      * BP138339 070820 KR13 REMOVED P13436J1 - IOM8 CONVERSION.  *             
      * ========================================================= *             
                                                                                
      *----------------------*                                                  
       ENVIRONMENT DIVISION.                                                    
      *----------------------*                                                  
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT B05K006   ASSIGN       TO B05K006                             
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K006-HDB-REF-SF                     
                            FILE STATUS  IS WS-K006-STATUS.                     
                                                                                
           SELECT BP13K800  ASSIGN       TO BP13K800                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K800-NUM-REGN                       
                            FILE STATUS  IS WS-K800-STATUS.                     
                                                                                
           SELECT BP13KD00  ASSIGN       TO BP13KD00                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS KD00-NUM-REGN                       
                            FILE STATUS  IS WS-KD00-STATUS.                     
                                                                                
           SELECT BP13KA10  ASSIGN       TO BP13KA10                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS KA10-NUM-PRJCT                      
                            FILE STATUS  IS WS-KA10-STATUS.                     
                                                                                
           SELECT BP13KD40  ASSIGN       TO BP13KD40                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS KD40-KEY-FLD                        
                            FILE STATUS  IS WS-KD40-STATUS.                     
                                                                                
           SELECT BP13KD45  ASSIGN       TO BP13KD45                            
                            ORGANIZATION IS INDEXED                             
                            ACCESS MODE  IS DYNAMIC                             
                            RECORD KEY   IS KD45-KEY-FLD                        
                            FILE STATUS  IS WS-KD45-STATUS.                     
                                                                                
           SELECT BP13K625  ASSIGN       TO BP13K625                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K625-KEY-FLD                        
                            FILE STATUS  IS WS-K625-STATUS.                     
                                                                                
           SELECT BP13F315  ASSIGN       TO BP13F315.                           
           SELECT AG07F225  ASSIGN       TO AG07F225.                           
                                                                                
           SELECT BP13436J  ASSIGN       TO BP13436J.                           
           SELECT BP13436K  ASSIGN       TO BP13436K.                           
           SELECT BP13436L  ASSIGN       TO BP13436L.                           
                                                                                
      *---------------*                                                         
       DATA DIVISION.                                                           
      *---------------*                                                         
       FILE SECTION.                                                            
      *---------------*                                                         
                                                                                
       FD   B05K006.                                                            
       COPY B05K006.                                                            
                                                                                
       FD   BP13KD40                                                            
            RECORD CONTAINS 1500 CHARACTERS.                                    
       COPY BP13KD40.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13KD00                                                            
            RECORD CONTAINS 1600 CHARACTERS.                                    
       COPY BP13KD00.                                                           
                                                                                
       FD   BP13KA10                                                            
            RECORD CONTAINS  800 CHARACTERS.                                    
       COPY BP13KA10.                                                           
                                                                                
       FD   BP13KD45                                                            
            RECORD CONTAINS 1550 CHARACTERS.                                    
       COPY BP13KD45.                                                           
                                                                                
       FD   BP13K625                                                            
            RECORD CONTAINS 500  CHARACTERS.                                    
       COPY BP13K625.                                                           
                                                                                
       FD   BP13F315                                                            
            BLOCK  CONTAINS 0    RECORDS                                        
            RECORD CONTAINS 500  CHARACTERS                                     
            LABEL  RECORDS  ARE  STANDARD                                       
            RECORDING MODE  IS   F.                                             
       COPY BP13F315.                                                           
                                                                                
       FD   AG07F225                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 600 CHARACTERS.                                     
       COPY AG07F225.                                                           
                                                                                
      *---------------------------------------                                  
      * LISTING FOR STAMPING DOA FOR SOC FLAT                                   
      *---------------------------------------                                  
       FD   BP13436J                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L436J-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13436K                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L436K-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13436L                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L436L-PRINT-REC          PIC X(132).                                
                                                                                
      *------------------------*                                                
       WORKING-STORAGE SECTION.                                                 
      *------------------------*                                                
      *-----------------------------------------------------------*             
      *    DEFINE HEADING LINES                                   *             
      *-----------------------------------------------------------*             
       01  PRT-L436-HDG-1.                                                      
           05  L436-REPORT-ID       PIC X(8)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE '      HDB3'.               
           05  FILLER               PIC X(27) VALUE SPACES.                     
           05  FILLER               PIC X(39) VALUE                             
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER               PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'DATE : '.                  
           05  L436-CURRENT-DATE    PIC X(10) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'PAGE : '.                  
           05  L436-PAGE            PIC ZZZZ9.                                  
                                                                                
       01  PRT-L436-HDG-2.                                                      
           05  FILLER               PIC X(30) VALUE                             
               'HOUSING AND DEVELOPMENT BOARD'.                                 
           05  FILLER               PIC X(20) VALUE SPACES.                     
           05  FILLER               PIC X(30) VALUE                             
               'P A Y M E N T    V O U C H E R'.                                
           05  FILLER               PIC X(25) VALUE SPACES.                     
           05  L436-COPY-NAME       PIC X(20) VALUE SPACES.                     
                                                                                
       01  PRT-L436-HDG-3.                                                      
           05  L436-REPORT-ID-DESC  PIC X(132).                                 
                                                                                
       01  PRT-L436L-HDG-3.                                                     
           05  L436L-REPORT-ID-DESC  PIC X(132).                                
                                                                                
       01  PRT-L436-HDG-4.                                                      
           05  FILLER               PIC X(46) VALUE SPACES.                     
           05  FILLER               PIC X(85) VALUE ALL '-'.                    
                                                                                
       01  PRT-L436-HDG-5.                                                      
           05  FILLER               PIC X(46) VALUE                             
               'SALES UNIT (AGREEMENT TEAM)'.                                   
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(27) VALUE                             
               ' FOR FINANCE DEPARTMENT USE'.                                   
           05  FILLER               PIC X(21) VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE                             
               '¦  BATCH NO    : '.                                             
           05  L436-BATCH-NO        PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L436-HDG-6.                                                      
           05  FILLER               PIC X(46) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(48) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(34) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L436-HDG-7.                                                      
           05  FILLER               PIC X(46) VALUE 'SYSTEM CODE : 04'.         
           05  FILLER               PIC X(14) VALUE '¦ CHECKED BY :'.           
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE '¦  VOUCHER NO  :'.         
           05  L436-VOUCHER-NO      PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L436-HDG-8.                                                      
           05  FILLER               PIC X(46) VALUE                             
              'GL CODE     : 0000000104250'.                                    
           05  FILLER               PIC X(85) VALUE ALL '-'.                    
                                                                                
       01  PRT-L436-HDG-9.                                                      
           05  FILLER               PIC X(46) VALUE                             
              'DESCRIPTION : STAMP FEES'.                                       
                                                                                
       01  PRT-L436L-HDG-9.                                                     
           05  FILLER               PIC X(46) VALUE                             
              'DESCRIPTION : LEASE PREPARATION FEES'.                           
                                                                                
       01  PRT-L436-HDG-10.                                                     
           05  FILLER               PIC X(53)   VALUE                           
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.            
           05  FILLER               PIC X(13)   VALUE  SPACES.                  
           05  FILLER               PIC X(20)   VALUE                           
              'BANK   : DBS        '.                                           
           05  FILLER               PIC X(11)   VALUE  SPACES.                  
           05  FILLER               PIC X(25)   VALUE                           
              'BANK CODE   : DBSSSGSGXXX'.                                      
                                                                                
       01  PRT-L436L-HDG-10.                                                    
           05  FILLER               PIC X(14)   VALUE  'PAYABLE TO  : '.        
           05  PRT-SOL-NAME         PIC X(66)   VALUE  SPACES.                  
           05  FILLER               PIC X(52)   VALUE  SPACES.                  
                                                                                
       01  PRT-L436-HDG-10A.                                                    
           05  FILLER               PIC X(24)   VALUE                           
              'A/C NO      : 0010468600'.                                       
           05  FILLER               PIC X(42)   VALUE  SPACES.                  
                                                                                
       01  PRT-L436-HDG-11.                                                     
           05  FILLER               PIC X(11)   VALUE                           
               'REMITTANCE '.                                                   
           05  FILLER               PIC X(55)   VALUE                           
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.          
                                                                                
       01  PRT-L436L-HDG-11.                                                    
           05  FILLER               PIC X(7)   VALUE                            
               'CHEQUE '.                                                       
           05  FILLER               PIC X(55)   VALUE                           
              'DESPATCH TO :  C/O MR BALA(STAMPING) OF SALES OPERATION'.        
           05  FILLER               PIC X(55)   VALUE SPACES.                   
           05  FILLER               PIC X(15)   VALUE 'TEL : 64903781'.         
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L436A & BP13L436D SUB-HEADING LINES         *             
      *-----------------------------------------------------------*             
       01  PRT-L436-SUBHDG-1.                                                   
           05  FILLER               PIC X(69) VALUE SPACES.                     
           05  FILLER               PIC X(19) VALUE                             
               'DATE OF    MORTGAGE'.                                           
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'DUP'.                      
           05  L436-SUP-LEASE-DESC  PIC X(10) VALUE SPACES.                     
           05  FILLER               PIC X(2)  VALUE SPACES.                     
                                                                                
       01  PRT-L436L-SUBHDG-1.                                                  
           05  FILLER               PIC X(89) VALUE SPACES.                     
           05  FILLER               PIC X(23) VALUE                             
               'DATE OF        LEASE   '.                                       
                                                                                
       01  PRT-L436L-SUBHDG-1A.                                                 
           05  FILLER               PIC X(22) VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE 'ATRIUM 4TH STOREY'.        
           05  FILLER               PIC X(17) VALUE ' SINGAPORE 310480'.        
                                                                                
       01  PRT-L436-SUBHDG-2.                                                   
           05  FILLER               PIC X(4)  VALUE 'S/NO'.                     
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.               
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.                  
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.                    
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(25) VALUE                             
               'FLAT ADDRESS/STREET NAME'.                                      
           05  FILLER               PIC X(1)  VALUE SPACE.                      
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.                  
           05  FILLER               PIC X(9)  VALUE '  S&P    '.                
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.                
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(3)  VALUE 'DOA'.                      
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.                
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  L436-TAG-DESC        PIC X(3)  VALUE '   '.                      
           05  FILLER               PIC X(6)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.                    
                                                                                
       01  PRT-L436L-SUBHDG-2.                                                  
           05  FILLER               PIC X(4)  VALUE 'S/NO'.                     
           05  FILLER               PIC X(5)  VALUE SPACE.                      
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.               
           05  FILLER               PIC X(9)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.                  
           05  FILLER               PIC X(4)  VALUE SPACE.                      
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.                    
           05  FILLER               PIC X(3)  VALUE SPACE.                      
           05  FILLER               PIC X(25) VALUE                             
               'FLAT ADDRESS/STREET NAME'.                                      
           05  FILLER               PIC X(5)  VALUE SPACE.                      
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.                  
           05  FILLER               PIC X(12) VALUE '     S&P    '.             
           05  FILLER               PIC X(6)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.                
           05  FILLER               PIC X(13) VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.                    
                                                                                
       01  PRT-L436-SUBHDG-3.                                                   
           05  FILLER               PIC X(4)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(25) VALUE ALL '-'.                    
           05  FILLER               PIC X(1)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE ALL '-'.                    
           05  FILLER               PIC X(1)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
                                                                                
       01  PRT-L436L-SUBHDG-3.                                                  
           05  FILLER               PIC X(4)  VALUE ALL '-'.                    
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
           05  FILLER               PIC X(6)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE ALL '-'.                    
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(25) VALUE ALL '-'.                    
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE ALL '-'.                    
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE ALL '-'.                    
           05  FILLER               PIC X(7)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ALL '-'.                    
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L436A & BP13L436D DETAIL LINES              *             
      *-----------------------------------------------------------*             
       01  L436-REC-DETAIL.                                                     
           05  L436-SERIAL-NO               PIC ZZZ9.                           
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L436-SCH-ACC                 PIC X(14) VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L436-REGN-NO                 PIC X(8)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L436-BLKNO                   PIC X(5)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L436-STREET                  PIC X(25) VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L436-FLATNO                  PIC X(7)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L436-SALE-DD                 PIC X(2)  VALUE SPACES.             
           05  L436-DASH1                   PIC X     VALUE SPACE.              
           05  L436-SALE-MM                 PIC X(2)  VALUE SPACES.             
           05  L436-DASH2                   PIC X     VALUE SPACE.              
           05  L436-SALE-CC                 PIC X(2)  VALUE SPACES.             
           05  L436-SALE-YY                 PIC X(2)  VALUE SPACES.             
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L436-MORT-SF                 PIC $$$,$$9.99.                     
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L436-DUP-DOA                 PIC $9.99.                          
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L436-SUP-LEASE-STAMP         PIC $$$,$$9.99.                     
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L436-TAG                     PIC X.                              
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L436-DETL-AMT-TOTAL          PIC $$$$,$$9.99.                    
                                                                                
       01  L436L-REC-DETAIL.                                                    
           05  L436L-SERIAL-NO               PIC ZZZ9.                          
           05  FILLER                        PIC X(4)  VALUE SPACE.             
           05  L436L-SCH-ACC                 PIC X(14) VALUE SPACES.            
           05  FILLER                        PIC X(6)  VALUE SPACE.             
           05  L436L-REGN-NO                 PIC X(8)  VALUE SPACES.            
           05  FILLER                        PIC X(4)  VALUE SPACE.             
           05  L436L-BLKNO                   PIC X(5)  VALUE SPACES.            
           05  FILLER                        PIC X(3)  VALUE SPACE.             
           05  L436L-STREET                  PIC X(25) VALUE SPACES.            
           05  FILLER                        PIC X(5)  VALUE SPACE.             
           05  L436L-FLATNO                  PIC X(7)  VALUE SPACES.            
           05  FILLER                        PIC X(3)  VALUE SPACE.             
           05  L436L-SALE-DD                 PIC X(2)  VALUE SPACES.            
           05  L436L-DASH1                   PIC X     VALUE SPACE.             
           05  L436L-SALE-MM                 PIC X(2)  VALUE SPACES.            
           05  L436L-DASH2                   PIC X     VALUE SPACE.             
           05  L436L-SALE-CC                 PIC X(2)  VALUE SPACES.            
           05  L436L-SALE-YY                 PIC X(2)  VALUE SPACES.            
           05  FILLER                        PIC X(3)  VALUE SPACES.            
           05  L436L-LEASE-STAMP             PIC $$$,$$9.99.                    
           05  FILLER                        PIC X(6)  VALUE SPACES.            
           05  FILLER                        PIC X(3)  VALUE SPACES.            
           05  L436L-DETL-AMT-TOTAL          PIC $$$$,$$9.99.                   
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L436A & BP13L436D TOTAL LINES               *             
      *-----------------------------------------------------------*             
       01  PRT-L436-DASH-LINE.                                                  
           05  FILLER                       PIC X(78)   VALUE SPACES.           
           05  FILLER                       PIC X(54)   VALUE ALL '='.          
                                                                                
       01  PRT-L436-TOTAL-LINE.                                                 
           05  FILLER                       PIC X(35) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
               'SERIAL NO : ('.                                                 
           05  L436-VR-NO-LOW               PIC X(4)  VALUE '0001'.             
           05  FILLER                       PIC X(4)  VALUE ' TO '.             
           05  L436-VR-NO-HIGH              PIC X(4)  VALUE '0025'.             
           05  FILLER                       PIC X(4)  VALUE ')'.                
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.          
           05  L436-TOTAL-MORT-SF           PIC $,$$$,$$9.99.                   
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L436-TOTAL-DUP-DOA           PIC $$9.99.                         
           05  L436-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.                   
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  FILLER                       PIC X(4)  VALUE SPACES.             
           05  L436-TOTAL-AMT               PIC $,$$$,$$9.99.                   
                                                                                
       01  PRT-L436L-TOTAL-LINE.                                                
           05  FILLER                       PIC X(35) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
               'SERIAL NO : ('.                                                 
           05  L436L-VR-NO-LOW               PIC X(4)  VALUE '0001'.            
           05  FILLER                       PIC X(4)  VALUE ' TO '.             
           05  L436L-VR-NO-HIGH              PIC X(4)  VALUE '0025'.            
           05  FILLER                       PIC X(4)  VALUE ')'.                
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.          
           05  FILLER                       PIC X(21) VALUE SPACES.             
           05  L436L-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.                  
           05  FILLER                       PIC X(4)  VALUE SPACES.             
           05  FILLER                       PIC X(4)  VALUE SPACES.             
           05  L436L-TOTAL-AMT              PIC $,$$$,$$9.99.                   
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE FOOTING LINES                                   *             
      *-----------------------------------------------------------*             
       01  PRT-L436-FTG-1.                                                      
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '.         
           05  L436-AMT-WORDS.                                                  
               10  L436-AMT-DESC1  PIC X(60)   VALUE SPACES.                    
               10  L436-AMT-DESC2  PIC X(60)   VALUE SPACES.                    
                                                                                
       01  PRT-L436-FTG-2.                                                      
           05  FILLER              PIC X(35)   VALUE SPACES.                    
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY :'.            
           05  FILLER              PIC X(15)   VALUE ALL '_'.                   
           05  FILLER              PIC X(10)   VALUE SPACES.                    
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY :'.          
           05  FILLER              PIC X(15)   VALUE ALL '_'.                   
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L436  HEADING LINES                         *             
      *-----------------------------------------------------------*             
       01  MAIN-HEADER.                                                         
           05  HEADER-LISTID             PIC X(8)  VALUE SPACES.                
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'HDB3'.                
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(39) VALUE                        
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.             
           05  HEADER-DATE               PIC X(10).                             
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.             
           05  HEADER-PAGE               PIC ZZZZ9.                             
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13436K REPORT LINES                           *             
      *-----------------------------------------------------------*             
       01  L436K-HEADER2.                                                       
           05  FILLER                    PIC X(47) VALUE SPACES.                
           05  FILLER                    PIC X(35)  VALUE                       
               'REPORT ON CASES WITH EARMARK ERROR'.                            
                                                                                
       01  L436K-HEADER3.                                                       
           05  FILLER               PIC X(4)  VALUE 'S/NO'.                     
           05  FILLER               PIC X(3)  VALUE SPACE.                      
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.               
           05  FILLER               PIC X(9)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.                  
           05  FILLER               PIC X(5)  VALUE SPACE.                      
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.            
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.             
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.        
                                                                                
       01  L436K-REC-DETAIL.                                                    
           05  L436K-SERIAL-NO              PIC ZZZ9.                           
           05  FILLER                       PIC X(3)  VALUE SPACE.              
           05  L436K-SCH-ACC                PIC X(14) VALUE SPACES.             
           05  FILLER                       PIC X(5)  VALUE SPACE.              
           05  L436K-REGN-NO                PIC X(8)  VALUE SPACES.             
           05  FILLER                       PIC X(5)  VALUE SPACE.              
           05  L436K-JR-VCHR-NO             PIC X(13) VALUE SPACES.             
           05  FILLER                       PIC X(5)  VALUE SPACES.             
           05  L436K-AMT-TOTAL              PIC $$$$,$$9.99.                    
           05  FILLER                       PIC X(5)  VALUE SPACES.             
           05  L436K-ERROR-DESC             PIC X(30).                          
                                                                                
       01  L436K-UNDERLINE                  PIC X(132) VALUE ALL '-'.           
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE ERROR MESSAGE FORMAT                            *             
      *-----------------------------------------------------------*             
       01  WS-ERRMSG-HEADER.                                                    
           05  FILLER                       PIC X(46) VALUE                     
               ' *************   ERROR MESSAGE   *************'.                
                                                                                
       01  WS-ERROR.                                                            
           05  FILLER                       PIC X(24) VALUE                     
               ' ERROR ENCOUNTERED WHEN '.                                      
           05  WS-CUR-PROC                  PIC X(21).                          
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  FILLER                       PIC X(15) VALUE                     
               ' STATUS CODE = '.                                               
           05  WS-CUR-STATUS                PIC X(2).                           
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE SUMMARY FORMAT                                  *             
      *-----------------------------------------------------------*             
       01  WS-SUMMARY-HEADER.                                                   
           05  FILLER                       PIC X     VALUE SPACES.             
           05  FILLER                       PIC X(16) VALUE ALL '*'.            
           05  FILLER                       PIC X(20) VALUE                     
               'BP13C436 SUMMARY RPT'.                                          
           05  FILLER                       PIC X(19) VALUE ALL '*'.            
                                                                                
       01  WS-READ-CASES.                                                       
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF RECORDS READ FROM TRANS FILE  (BP13F315) = '.            
           05  WS-EDIT-BP13F315-READ        PIC ZZZ9.                           
                                                                                
       01  WS-DOA-PAYMENT-PRINTED.                                              
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF DOA PAYMENTS   (BP13L436A)               = '.            
           05  WS-EDIT-L436A-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L436J-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (BP13L436J)               = '.            
           05  WS-EDIT-L436J-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-STAMP-FEES-REC-WRITTEN.                                           
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF RECORDS WRITTEN TO STAMP FILE (AG07F225) = '.            
           05  WS-EDIT-AG07F225-WRITE       PIC ZZZ9.                           
                                                                                
       01  WS-SUMMARY-TRAILER.                                                  
           05  FILLER                       PIC X     VALUE SPACES.             
           05  FILLER                       PIC X(55) VALUE ALL '*'.            
                                                                                
      *-----------------------------------------------------------*             
      *    CONSTANTS LIST                                         *             
      *-----------------------------------------------------------*             
       01  WS-ERROR-PROCEDURE-NAMES.                                            
           05  CLOSE-K006                   PIC X(21) VALUE                     
                   'CLOSING FILE  B05K006'.                                     
           05  CLOSE-KD40                   PIC X(21) VALUE                     
                   'CLOSING FILE BP13KD40'.                                     
           05  CLOSE-KD45                   PIC X(21) VALUE                     
                   'CLOSING FILE BP13KD45'.                                     
           05  CLOSE-K625                   PIC X(21) VALUE                     
                   'CLOSING FILE BP13K625'.                                     
           05  NOTFND-IN-FIS                PIC X(23) VALUE                     
                   'REC NOT FOUND IN K315'.                                     
           05  NOTFND-IN-MST                PIC X(23) VALUE                     
                   'REC NOT FOUND IN K006'.                                     
           05  OPEN-K006                    PIC X(21) VALUE                     
                   'OPENING FILE  B05K006'.                                     
           05  OPEN-K800                    PIC X(21) VALUE                     
                   'OPENING FILE BP13K800'.                                     
           05  OPEN-KD00                    PIC X(21) VALUE                     
                   'OPENING FILE BP13KD00'.                                     
           05  OPEN-KA10                    PIC X(21) VALUE                     
                   'OPENING FILE BP13KA10'.                                     
           05  OPEN-KD40                    PIC X(21) VALUE                     
                   'OPENING FILE BP13KD40'.                                     
           05  OPEN-KD45                    PIC X(21) VALUE                     
                   'OPENING FILE BP13KD45'.                                     
           05  OPEN-K625                    PIC X(21) VALUE                     
                   'OPENING FILE BP13K625'.                                     
           05  READ-F315                    PIC X(21) VALUE                     
                   'READING FILE BP13F315'.                                     
           05  WRITE-K625                   PIC X(21) VALUE                     
                   'WRITING FILE BP13K625'.                                     
           05  READ-K006                    PIC X(21) VALUE                     
                   'READING FILE  B05K006'.                                     
           05  READ-KD40                    PIC X(21) VALUE                     
                   'READING FILE BP13KD40'.                                     
           05  READ-KD45                    PIC X(21) VALUE                     
                   'READING FILE BP13KD45'.                                     
           05  READ-K625                    PIC X(21) VALUE                     
                   'READING FILE BP13K625'.                                     
           05  START-KD45                   PIC X(21) VALUE                     
                   'STARTBR FILE BP13KD45'.                                     
                                                                                
       01  DUP-DOA-AMT                      PIC 9V99  VALUE 0.                  
       01  DUP-SA-AMT                       PIC 9V99  VALUE 0.                  
       01  HYPHEN                           PIC X     VALUE '-'.                
       01  MAX-REC-PER-PAGE                 PIC 9(2)  VALUE 39.                 
       01  MAX-DETLS-PER-PAGE               PIC 9(3)  VALUE 25.                 
                                                                                
      *-----------------------------------------------------------*             
      *    LEVEL-88 VARIABLES                                     *             
      *-----------------------------------------------------------*             
       01  WS-EOF                           PIC X     VALUE 'N'.                
           88  END-OF-BP13F315                        VALUE 'Y'.                
       01  WS-REPORT-ID-SW                  PIC X(1)  VALUE SPACE.              
       01  WS-PREV-REPORT-ID                PIC X(1)  VALUE SPACE.              
           88  REPORT-L436J                           VALUE 'J'.                
                                                                                
      *-----------------------------------------------------------*             
      *    OTHER VARIABLES                                        *             
      *-----------------------------------------------------------*             
       01  WS-COUNTERS.                                                         
           05  WS-AG07-STATUS               PIC 9(2)    VALUE ZEROS.            
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).                
           05  WS-BP13F315-READ-CNT         PIC 9(4)    VALUE ZEROS.            
           05  WS-BP13K625-WRITE-CNT        PIC 9(4)    VALUE ZEROES.           
           05  WS-AG07F225-WRITE-CNT        PIC 9(4)    VALUE ZEROES.           
      *    -----------------------                                              
      *    FOR L436J -     LISTING                                              
      *    -----------------------                                              
           05  WS-L436J-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L436J-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L436J-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L436J-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L436J-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L436J-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L436J-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    -----------------------                                              
      *    FOR L436L -     LISTING                                              
      *    -----------------------                                              
           05  WS-L436L-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L436L-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L436L-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L436L-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L436L-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    --------------------------                                           
      *    FOR L436K - ERROR LISTING                                            
      *    --------------------------                                           
           05  WS-L436K-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L436K-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L436K-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
                                                                                
       01  WS-FLATNO.                                                           
           05  WS-NUM-LEVEL                 PIC X(2).                           
           05  FILLER                       PIC X       VALUE '-'.              
           05  WS-NUM-MAIN                  PIC X(5).                           
                                                                                
       01  WS-SCH-ACC.                                                          
           05  WS-SCH                       PIC X(4).                           
           05  WS-SCH-SEP1                  PIC X.                              
           05  WS-ACC                       PIC X(4).                           
           05  WS-SCH-SEP2                  PIC X.                              
           05  WS-CHK                       PIC X.                              
           05  WS-SCH-SEP3                  PIC X.                              
           05  WS-LESCDE                    PIC X(2).                           
                                                                                
       01  WS-F315-ACC-CHK.                                                     
           05  WS-F315-ACC                  PIC X(4).                           
           05  WS-F315-CHK                  PIC X(1).                           
                                                                                
       01  WS-AO-DATE.                                                          
           05  WS-AO-CC                     PIC X(2).                           
           05  WS-AO-YY                     PIC X(2).                           
           05  WS-AO-MM                     PIC X(2).                           
           05  WS-AO-DD                     PIC X(2).                           
                                                                                
       01  WS-SALE-DATE.                                                        
           05  WS-SALE-CC                   PIC X(2).                           
           05  WS-SALE-YY                   PIC X(2).                           
           05  WS-SALE-MM                   PIC X(2).                           
           05  WS-SALE-DD                   PIC X(2).                           
                                                                                
       01  WS-TEMPORARY-BUFFER.                                                 
           05  WS-TEMP-TOTAL                PIC 9(7)V99.                        
           05  WS-TEMP-DIFF                 PIC 9(7)V99.                        
                                                                                
       01  WS-BLANK-LINE                    PIC X     VALUE SPACES.             
       01  WS-F315-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K006-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K800-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-KD00-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-KA10-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-KD40-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-KD45-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K625-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K625-EOF                      PIC X(1)  VALUE 'N'.                
       01  WS-KD45-EOF                      PIC X(1)  VALUE 'N'.                
       01  WS-LEASE-SF                      PIC S9(5)V99.                       
       01  WS-LEASE-STAMP                   PIC S9(5)V99 VALUE ZEROS.           
       01  WS-MORT-SF                       PIC S9(5)V99.                       
       01  WS-MORT-SF2                      PIC S9(5)V99.                       
       01  WS-SUP-SF                        PIC S9(5)V99.                       
       01  WS-DUP-DOA                       PIC 9(2)V99.                        
       01  WS-ANNUAL-RENT                   PIC 9(7)V99.                        
       01  WS-LOAN-GRANTED                  PIC 9(7)V99.                        
       01  WS-SELL-PRICE                    PIC 9(8)  VALUE ZEROES.             
       01  WS-LEASE-AMT                     PIC 9(10)V99 VALUE ZEROES.          
       01  WS-NUM-HDB-REF                   PIC X(11) VALUE SPACES.             
       01  WS-NUM-DOC                       PIC X(3)  VALUE SPACES.             
       01  WS-NUM-DOC-TYP                   PIC X(1)  VALUE SPACES.             
       01  WS-NUM-DOC-CNT                   PIC 9(1)  VALUE ZEROES.             
       01  WS-AMT-STAMP-DUTY                PIC 9(13)V99 VALUE ZEROES.          
       01  WS-AMT-STAMP-DUTY-DUP            PIC 9(13)V99 VALUE ZEROES.          
       01  WS-AMT-EARMARK                   PIC 9(10)V99 VALUE ZEROES.          
       01  WS-EM-LEASE-STAMP                PIC S9(5)V99 VALUE ZEROS.           
       01  WS-EM-MORT-SF                    PIC S9(5)V99 VALUE ZEROS.           
       01  WS-EM-SUP-SF                     PIC S9(5)V99 VALUE ZEROS.           
       01  WS-EM-DUP-DOA                    PIC 9(2)V99  VALUE ZEROS.           
       01  WS-STAFF-START                   PIC X(9) VALUE '29586H   '.         
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES USED BY F220                             *              
      *----------------------------------------------------------*              
       01  WS-NEW-VOUCHER                   PIC X      VALUE 'Y'.               
       01  WS-NEW-BATCH                     PIC X      VALUE 'Y'.               
       01  WS-NEW-HEADER                    PIC X      VALUE 'Y'.               
       01  WS-DTE-SALE-AGRM                 PIC X(08)  VALUE SPACES.            
       01  WS-NUM-VOUCHER                   PIC X(11)  VALUE SPACES.            
       01  WS-NUM-BATCH-TYPE                PIC X(4)   VALUE SPACES.            
       01  WS-NUM-FIN-YEAR                  PIC 9(4)   VALUE ZEROES.            
       01  WS-NUM-BATCH-SERIAL              PIC 9(5)   VALUE ZEROES.            
       01  WS-SCH-ACCT-NO                   PIC X(11)  VALUE SPACES.            
       01  WS-SCH-ACCT-NO2                  PIC X(11)  VALUE SPACES.            
       01  WS-TXT-INFO                      PIC X(50)  VALUE SPACES.            
       01  WS-NME-FIN-SOLICITOR             PIC X(50)  VALUE SPACES.            
       01  WS-CNT-DETAILS                   PIC 9(4)   VALUE ZEROES.            
       01  WS-AMT-TRANS                     PIC 9(7)V99 VALUE ZEROES.           
       01  WS-AMT-TOTAL                     PIC 9(7)V99 VALUE ZEROES.           
       01  WS-PREV-SA-TP-TAG                PIC X(1)   VALUE SPACE.             
       01  WS-PREV-PROJ-CODE                PIC X(3)   VALUE SPACE.             
       01  WS-EDITED-VOUCHER-NO.                                                
           05  WS-EDITED-NUM-DDD            PIC X(3)   VALUE SPACES.            
           05  FILLER                       PIC X(1)   VALUE '-'.               
           05  WS-EDITED-NUM-FIN-YEAR       PIC X(2)   VALUE SPACES.            
           05  FILLER                       PIC X(1)   VALUE '-'.               
           05  WS-EDITED-NUM-VR-SERIAL      PIC X(6)   VALUE SPACES.            
       01  WS-L436J-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(42)  VALUE                    
              'S&P AGREEMENT AND DEED OF ASSIGNMENT (DBSS'.                     
           05  FILLER                       PIC X(17)  VALUE                    
              ')                '.                                              
       01  WS-L436JL-DESC.                                                      
           05  FILLER                       PIC X(47)  VALUE SPACES.            
           05  FILLER                       PIC X(42)  VALUE                    
              'LEASE PREPARATION FEES TO SOLICITOR       '.                     
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AG07C907"       *              
      *----------------------------------------------------------*              
       COPY AG7C907C.                                                           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "BP13C906"       *              
      *----------------------------------------------------------*              
       COPY P13C906C.                                                           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AB05C902"       *              
      *----------------------------------------------------------*              
       COPY AB05902C.                                                           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *              
      *----------------------------------------------------------*              
       01  WS-SUBSCRIPTS.                                                       
           05  WA-SUB              PIC 999   VALUE 0.                           
           05  WF-SUB              PIC 999   VALUE 0.                           
           05  WL-SUB              PIC 999   VALUE 0.                           
           05  WS-SUB              PIC 999   VALUE 0.                           
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                           
                                                                                
       01  WA-NAMES.                                                            
           05  FILLER              PIC X(10) VALUE '3ONE      '.                
           05  FILLER              PIC X(10) VALUE '3TWO      '.                
           05  FILLER              PIC X(10) VALUE '5THREE    '.                
           05  FILLER              PIC X(10) VALUE '4FOUR     '.                
           05  FILLER              PIC X(10) VALUE '4FIVE     '.                
           05  FILLER              PIC X(10) VALUE '3SIX      '.                
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.                
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.                
           05  FILLER              PIC X(10) VALUE '4NINE     '.                
           05  FILLER              PIC X(10) VALUE '3TEN      '.                
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.                
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.                
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.                
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.                
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.                
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.                
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.                
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.                
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.                
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.                
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.                
           05  FILLER              PIC X(10) VALUE '5FORTY    '.                
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.                
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.                
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.                
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.                
           05  FILLER              PIC X(10) VALUE '6NINETY   '.                
       01  WA-NAMER REDEFINES WA-NAMES.                                         
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.                   
                                                                                
       01  WS-LITERALS.                                                         
           05  L-CENT              PIC X(5)  VALUE '4CENT'.                     
           05  L-AND               PIC X(4)  VALUE '3AND'.                      
           05  L-X                 PIC X     VALUE '%'.                         
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.                  
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.                 
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.                  
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.                    
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.                    
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.                  
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.                   
                                                                                
       01  SWITCHES.                                                            
           05  WS-SWITCH           PIC 9     VALUE 0.                           
           05  WS-THO-SW           PIC 9     VALUE 0.                           
           05  WS-CNT-SW           PIC 9     VALUE 0.                           
           05  WS-LIT-SW           PIC 9     VALUE 0.                           
           05  WS-TEN-SW           PIC 9     VALUE 0.                           
           05  WS-AND-SW           PIC 9     VALUE 0.                           
                                                                                
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                           
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.                      
       01  WS-RESULT               PIC 999   VALUE 0.                           
       01  WL-AREA.                                                             
           05  WL-ITEM1            PIC 9     VALUE 0.                           
           05  FILLER              PIC X(11) VALUE SPACE.                       
       01  WL-ITM REDEFINES WL-AREA.                                            
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.                   
                                                                                
       01  WS-CHEQUE-DETAILS.                                                   
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                         
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.                 
           05  WF-DETAILS.                                                      
               10  WF-LINE-1       PIC X(60).                                   
               10  WF-LINE-2       PIC X(60).                                   
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.                   
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).                 
                                                                                
                                                                                
      *------------------*                                                      
       PROCEDURE DIVISION.                                                      
      *------------------*                                                      
                                                                                
      ******************************************************************        
       0000-CONTROL.                                                            
      ******************************************************************        
            PERFORM  0100-SET-DATE               THRU  0100-EXIT.               
            PERFORM  0200-OPEN-FILES             THRU  0200-EXIT.               
            PERFORM  1100-READ-BP13F315          THRU  1100-EXIT.               
            PERFORM  0900-CHECK-SALES-TYPE       THRU  0900-EXIT.               
                                                                                
            MOVE     WS-REPORT-ID-SW             TO    WS-PREV-REPORT-ID        
            MOVE     F315-CDE-SA-TP-TAG          TO    WS-PREV-SA-TP-TAG        
            MOVE     F315-CDE-PROJECT            TO    WS-PREV-PROJ-CODE        
            PERFORM  1000-READ-AND-PRINT-LOOP    THRU  1000-EXIT                
                          UNTIL END-OF-BP13F315.                                
                                                                                
            PERFORM  8000-DISPLAY-STATISTICS     THRU  8000-EXIT.               
            PERFORM  9000-CLOSE-FILES            THRU  9000-EXIT.               
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0100-SET-DATE.                                                           
      ******************************************************************        
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                              
                    FUNCTION CURRENT-DATE(5:2) '/'                              
                    FUNCTION CURRENT-DATE(1:4)                                  
            DELIMITED BY SIZE INTO HEADER-DATE.                                 
                                                                                
            MOVE HEADER-DATE           TO   L436-CURRENT-DATE.                  
                                                                                
       0100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0200-OPEN-FILES.                                                         
      ******************************************************************        
            OPEN INPUT  BP13F315                                                
                        B05K006                                                 
                        BP13K800                                                
                        BP13KD00                                                
                        BP13KA10                                                
                        BP13KD40                                                
                        BP13KD45                                                
                 I-O    BP13K625                                                
                 OUTPUT AG07F225                                                
                        BP13436J                                                
                        BP13436L                                                
                        BP13436K.                                               
                                                                                
            IF WS-K006-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K006                  TO   WS-CUR-PROC              
               MOVE    WS-K006-STATUS             TO   WS-CUR-STATUS            
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.               
                                                                                
            IF WS-K800-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K800                  TO    WS-CUR-PROC             
               MOVE    WS-K800-STATUS             TO    WS-CUR-STATUS           
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
            IF WS-KD00-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-KD00                  TO    WS-CUR-PROC             
               MOVE    WS-KD00-STATUS             TO    WS-CUR-STATUS           
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
            IF WS-KA10-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-KA10                  TO    WS-CUR-PROC             
               MOVE    WS-KA10-STATUS             TO    WS-CUR-STATUS           
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
            IF WS-KD40-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-KD40                  TO    WS-CUR-PROC             
               MOVE    WS-KD40-STATUS             TO    WS-CUR-STATUS           
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
            IF WS-KD45-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-KD45                  TO    WS-CUR-PROC             
               MOVE    WS-KD45-STATUS             TO    WS-CUR-STATUS           
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
            IF WS-K625-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K625                TO    WS-CUR-PROC               
               MOVE    WS-K625-STATUS           TO    WS-CUR-STATUS             
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
      * VOUCHER NUMBER                                                          
            MOVE 'AG07K960' TO    C907-NUM-FILENME.                             
            CALL 'K960OPEN' USING AG07C907-AREA.                                
                                                                                
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR OPENING AG07K960, STATUS = '                      
                        C907-NUM-FILE-STATUS                                    
               MOVE     C907-NUM-FILE-STATUS    TO  WS-AG07-STAT-X              
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE              
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT                
            END-IF.                                                             
                                                                                
      * BATCH NUMBER (17/07/1999 - ROMAR)                                       
            MOVE 'BP13K620' TO    C906-NUM-FILENME.                             
            CALL 'K620OPEN' USING BP13C906-AREA.                                
                                                                                
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR OPENING BP13K620, STATUS = '                      
                        C906-NUM-FILE-STATUS                                    
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE              
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT                
            END-IF.                                                             
                                                                                
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')              
            MOVE SPACES              TO   WS-B902-AREA.                         
            INITIALIZE                    WS-B902-AREA.                         
            MOVE 'O'                 TO   B902-CDE-TYPE.                        
            CALL 'AB05C902'  USING WS-B902-AREA.                                
                                                                                
            IF B902-CDE-ERROR NOT = ZEROES                                      
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                           
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'                    
               PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                        
            END-IF.                                                             
                                                                                
       0200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0900-CHECK-SALES-TYPE.                                                   
      ******************************************************************        
            MOVE  'J'           TO     WS-REPORT-ID-SW.                         
            MOVE  'DBSS'        TO     WS-NUM-BATCH-TYPE.                       
            IF  F315-CDE-TRANS   =   'DS'                                       
                MOVE  'DBDS'        TO     WS-NUM-BATCH-TYPE                    
            END-IF.                                                             
                                                                                
       0900-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1000-READ-AND-PRINT-LOOP.                                                
      ******************************************************************        
            IF F315-CDE-TRANS = 'DB'  OR  'DS'                                  
               IF (WS-REPORT-ID-SW    NOT = WS-PREV-REPORT-ID) OR               
                  (F315-CDE-SA-TP-TAG NOT = WS-PREV-SA-TP-TAG) OR               
                  (F315-CDE-PROJECT   NOT = WS-PREV-PROJ-CODE)                  
                                                                                
                   PERFORM  5000-WRITE-TRAILER-F225                             
                      THRU  5000-TRAILER-EXIT                                   
                   MOVE     ZEROES               TO  WS-CNT-DETAILS             
                   MOVE     ZEROES               TO  WS-TEMP-TOTAL              
                   MOVE     'Y'                  TO  WS-NEW-BATCH               
                                                     WS-NEW-VOUCHER             
                                                     WS-NEW-HEADER              
                   MOVE     WS-REPORT-ID-SW      TO  WS-PREV-REPORT-ID          
                   MOVE     F315-CDE-SA-TP-TAG   TO  WS-PREV-SA-TP-TAG          
                   MOVE     F315-CDE-PROJECT     TO  WS-PREV-PROJ-CODE          
                   INITIALIZE BP13KA10-REC                                      
                   MOVE  F315-CDE-PROJECT        TO   KA10-NUM-PRJCT            
                   MOVE     SPACES              TO WS-NME-FIN-SOLICITOR         
                   PERFORM 1315-READ-BP13KA10    THRU 1315-EXIT                 
               END-IF                                                           
                                                                                
               PERFORM  1050-PROCESS-RECORD      THRU 1050-EXIT                 
               PERFORM  1055-EARMARK-ACCOUNT     THRU 1055-EXIT                 
                                                                                
               IF B902-CDE-SYSERR NOT = ZEROES                                  
                  DISPLAY 'ERROR CALLING AB05C902, STATUS = '                   
                           B902-CDE-SYSERR                                      
                  MOVE     '99'                 TO RETURN-CODE                  
                  PERFORM  9000-CLOSE-FILES                                     
               END-IF                                                           
                                                                                
               IF B902-CDE-ERROR-ACCT(1) = SPACES                               
                  IF WS-NEW-HEADER = 'Y'                                        
                     PERFORM  5000-WRITE-HEADER-F225                            
                              THRU 5000-HEADER-EXIT                             
                     MOVE  'N'             TO   WS-NEW-HEADER                   
                  END-IF                                                        
                  PERFORM  1060-PRINT-RECORD        THRU 1060-EXIT              
                  MOVE F315-CDE-SA-TP-TAG  TO   WS-PREV-SA-TP-TAG               
                  MOVE F315-CDE-PROJECT    TO   WS-PREV-PROJ-CODE               
                  PERFORM  6000-WRITE-STAMPING-FILE THRU 6000-EXIT              
               END-IF                                                           
                                                                                
            END-IF.                                                             
                                                                                
            PERFORM 1100-READ-BP13F315       THRU 1100-EXIT.                    
                                                                                
            IF NOT END-OF-BP13F315                                              
               PERFORM 0900-CHECK-SALES-TYPE THRU 0900-EXIT                     
            END-IF.                                                             
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1050-PROCESS-RECORD.                                                     
      ******************************************************************        
            PERFORM 1300-READ-BP13K800 THRU 1300-EXIT.                          
                                                                                
            IF WS-NME-FIN-SOLICITOR = SPACES OR LOW-VALUES                      
               PERFORM 1310-READ-BP13KD00 THRU 1310-EXIT                        
            END-IF.                                                             
                                                                                
            PERFORM 1400-READ-BP13KD40 THRU 1400-EXIT.                          
                                                                                
            IF WS-LEASE-SF                NOT NUMERIC                           
               MOVE ZEROES TO WS-LEASE-SF.                                      
                                                                                
            IF WS-LOAN-GRANTED            NOT NUMERIC                           
               MOVE ZEROS  TO WS-LOAN-GRANTED.                                  
                                                                                
      * GENERATE BATCH NUMBER.                                                  
            IF WS-NEW-BATCH = 'Y'                                               
               MOVE WS-NUM-BATCH-TYPE TO C906-NUM-BATCH-TYPE                    
               MOVE  'BP13K620'       TO C906-NUM-FILENME                       
                                                                                
               CALL 'BP13C906'  USING BP13C906-AREA                             
                                                                                
               IF C906-NUM-FILE-STATUS =  '00'                                  
                  MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE           
                  MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR             
                  MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL         
                  MOVE    'N'                   TO  WS-NEW-BATCH                
               ELSE                                                             
                  DISPLAY 'ERROR CALLING BP13C906, FILE STATUS = '              
                           C906-NUM-FILE-STATUS                                 
                  MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE                  
                  PERFORM  9000-CLOSE-FILES                                     
            END-IF.                                                             
                                                                                
      * GENERATE VOUCHER NUMBER.                                                
            IF WS-NEW-VOUCHER = 'Y'                                             
      *        MOVE  'SU '      TO C907-NUM-DDD                                 
               MOVE  'SS '      TO C907-NUM-DDD                                 
               MOVE  'AG07K960' TO C907-NUM-FILENME                             
                                                                                
               CALL 'AG07C907'  USING AG07C907-AREA                             
                                                                                
               IF C907-NUM-FILE-STATUS =  '00'                                  
                  MOVE    'N'   TO    WS-NEW-VOUCHER                            
               ELSE                                                             
                  DISPLAY 'ERROR CALLING AG07C907, FILE STATUS = '              
                           C907-NUM-FILE-STATUS                                 
                  MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X               
                  MOVE     WS-AG07-STATUS       TO RETURN-CODE                  
                  PERFORM  9000-CLOSE-FILES                                     
            END-IF.                                                             
                                                                                
       1050-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1055-EARMARK-ACCOUNT.                                                    
      ******************************************************************        
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                              
            MOVE SPACES              TO   WS-B902-AREA.                         
            INITIALIZE                    WS-B902-AREA.                         
                                                                                
            STRING C907-NUM-DDD  C907-NUM-FIN-YR                                
                   C907-NUM-VR-SERIAL                                           
                   DELIMITED BY SIZE INTO B902-VR-NO                            
            END-STRING.                                                         
                                                                                
            MOVE 'E'                     TO   B902-CDE-TYPE.                    
            MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.                
            MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.                   
            MOVE 'P13C436'               TO   B902-NUM-USERID-UPDATE.           
            MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.          
            MOVE 01                      TO   B902-NUM-HDB-REF-CNT.             
            MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).              
            MOVE ZEROES                  TO   WS-AMT-EARMARK.                   
                                                                                
            PERFORM 1057-COMP-TRANS-AMT  THRU 1057-EXIT.                        
            MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).              
                                                                                
            DISPLAY '----------------'.                                         
            DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                           
            DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                        
            DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.                    
            DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.                       
            DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.               
            DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.                 
            DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).                  
            DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).                  
                                                                                
            CALL 'AB05C902'  USING WS-B902-AREA.                                
                                                                                
            DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).               
            DISPLAY '----------------'.                                         
                                                                                
            EVALUATE B902-CDE-ERROR-ACCT(1)                                     
               WHEN SPACES                                                      
                  CONTINUE                                                      
               WHEN OTHER                                                       
                  PERFORM 6500-PRINT-L436K-REPORT     THRU 6500-EXIT            
            END-EVALUATE.                                                       
                                                                                
       1055-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1057-COMP-TRANS-AMT.                                                     
      ******************************************************************        
            IF WS-MORT-SF2 = ZEROS                                              
               MOVE     ZEROES            TO   WS-EM-MORT-SF                    
               MOVE     ZEROES            TO   WS-EM-DUP-DOA                    
            ELSE                                                                
               MOVE     WS-MORT-SF2       TO   WS-EM-MORT-SF                    
               SUBTRACT DUP-DOA-AMT       FROM WS-EM-MORT-SF                    
               MOVE     DUP-DOA-AMT       TO   WS-EM-DUP-DOA                    
            END-IF.                                                             
                                                                                
            IF WS-LEASE-SF = ZEROES                                             
               INITIALIZE   WS-EM-LEASE-STAMP                                   
            ELSE                                                                
               COMPUTE WS-EM-LEASE-STAMP = WS-LEASE-SF                          
            END-IF.                                                             
                                                                                
            DISPLAY 'NUM-REGN            = ' F315-REGN-NO.                      
            DISPLAY 'WS-EM-MORT-SF       = ' WS-EM-MORT-SF.                     
            DISPLAY 'WS-EM-LEASE-STAMP   = ' WS-EM-LEASE-STAMP.                 
            DISPLAY 'WS-LEASE-SF= ' WS-LEASE-SF.                                
                                                                                
            COMPUTE WS-AMT-EARMARK = (WS-EM-MORT-SF + WS-EM-DUP-DOA +           
                                     WS-EM-LEASE-STAMP).                        
            DISPLAY 'WS-AMT-EARMARK     = ' WS-AMT-EARMARK.                     
            IF F315-CDE-TRANS  =  'DS'                                          
               COMPUTE WS-AMT-EARMARK = WS-EM-LEASE-STAMP                       
            END-IF.                                                             
                                                                                
       1057-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1060-PRINT-RECORD.                                                       
      ******************************************************************        
            PERFORM 2150-HANDLE-SER  THRU  2150-EXIT.                           
                                                                                
       1060-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1100-READ-BP13F315.                                                      
      ******************************************************************        
            READ BP13F315                                                       
              AT END                                                            
                 MOVE    'Y'  TO WS-EOF                                         
                 PERFORM 4200-PRINT-LAST-LINES THRU 4200-EXIT                   
                 GO TO   1100-EXIT.                                             
                                                                                
            IF F315-CDE-TRANS = 'DB'  OR  'DS'                                  
               ADD  1                 TO  WS-BP13F315-READ-CNT                  
               MOVE F315-REGN-NO      TO  KD40-NUM-REGN.                        
                                                                                
            MOVE    F315-SCH          TO  WS-SCH.                               
            MOVE    F315-ACC          TO  WS-F315-ACC-CHK.                      
            MOVE    WS-F315-ACC       TO  WS-ACC.                               
            MOVE    WS-F315-CHK       TO  WS-CHK.                               
            MOVE    F315-LESSEE-CODE  TO  WS-LESCDE.                            
            MOVE    HYPHEN            TO  WS-SCH-SEP1.                          
            MOVE    HYPHEN            TO  WS-SCH-SEP2.                          
            MOVE    HYPHEN            TO  WS-SCH-SEP3.                          
            MOVE    F315-NUM-LEVEL    TO  WS-NUM-LEVEL.                         
            MOVE    F315-NUM-MAIN     TO  WS-NUM-MAIN.                          
                                                                                
            IF F315-CDE-SA-TP-TAG  =  LOW-VALUE                                 
               MOVE SPACE             TO  F315-CDE-SA-TP-TAG                    
            END-IF.                                                             
                                                                                
       1100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1300-READ-BP13K800.                                                      
      ******************************************************************        
            DISPLAY '1300'.                                                     
      *---------------------------------------------------------------*         
      *     USE F315-REGN-NO TO ACCESS BP13K800                       *         
      *---------------------------------------------------------------*         
            MOVE SPACES                      TO   BP13K800-MASTER.              
            INITIALIZE                            BP13K800-MASTER.              
                                                                                
            MOVE F315-REGN-NO                TO   K800-NUM-REGN.                
                                                                                
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                           
                                                                                
            READ BP13K800.                                                      
                                                                                
            DISPLAY 'WS-K800-STATUS = ' WS-K800-STATUS.                         
                                                                                
            IF WS-K800-STATUS = 00                                              
               MOVE  K800-DTE-SALE-AGMT      TO   WS-DTE-SALE-AGRM              
            ELSE                                                                
               MOVE  SPACES                  TO   WS-DTE-SALE-AGRM              
            END-IF.                                                             
                                                                                
       1300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1310-READ-BP13KD00.                                                      
      ******************************************************************        
            DISPLAY '1310'.                                                     
      *---------------------------------------------------------------*         
      *     USE F315-REGN-NO TO ACCESS BP13KD00                       *         
      *---------------------------------------------------------------*         
            MOVE SPACES                      TO   BP13KD00-REC.                 
            INITIALIZE                            BP13KD00-REC.                 
                                                                                
            MOVE F315-REGN-NO                TO   KD00-NUM-REGN.                
                                                                                
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                           
                                                                                
            READ BP13KD00.                                                      
                                                                                
            IF WS-KD00-STATUS = 00                                              
               INITIALIZE BP13KA10-REC                                          
               MOVE  KD00-NUM-PROJECT        TO   KA10-NUM-PRJCT                
               PERFORM 1315-READ-BP13KA10    THRU 1315-EXIT                     
            ELSE                                                                
               MOVE  SPACES                  TO   WS-NME-FIN-SOLICITOR          
            END-IF.                                                             
                                                                                
       1310-EXIT.                                                               
            EXIT.                                                               
      ******************************************************************        
       1315-READ-BP13KA10.                                                      
      ******************************************************************        
            READ BP13KA10.                                                      
                                                                                
            IF WS-KA10-STATUS = 00                                              
               STRING 'M/S ' KA10-NME-SOLICITOR DELIMITED BY SIZE               
                                              INTO WS-NME-FIN-SOLICITOR         
               MOVE  WS-NME-FIN-SOLICITOR    TO   PRT-SOL-NAME                  
            ELSE                                                                
               MOVE  SPACES                  TO   WS-NME-FIN-SOLICITOR          
            END-IF.                                                             
                                                                                
       1315-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1400-READ-BP13KD40.                                                      
      ******************************************************************        
            DISPLAY '1400'.                                                     
      *---------------------------------------------------------------*         
      *     USE F315-REGN-NO TO ACCESS BP13KD40 (GET DATE, FEES ETC)  *         
      *---------------------------------------------------------------*         
            INITIALIZE                            WS-MORT-SF2                   
                                                  WS-LOAN-GRANTED               
                                                  WS-SELL-PRICE                 
                                                  WS-SCH-ACCT-NO2.              
                                                                                
            MOVE SPACES                      TO   BP13KD40-REC.                 
            INITIALIZE                            BP13KD40-REC.                 
                                                                                
            MOVE F315-REGN-NO                TO   KD40-NUM-REGN.                
            MOVE '01'                        TO   KD40-NUM-PP-SCHDL.            
                                                                                
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                           
            READ BP13KD40.                                                      
            DISPLAY 'WS-KD40-STATUS = ' WS-KD40-STATUS.                         
            IF WS-KD40-STATUS = 00                                              
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  IF K800-DTE-RAISE-AO <= '20110218'                            
                     MOVE 2.00                    TO   DUP-DOA-AMT              
                                                       DUP-SA-AMT               
                  ELSE                                                          
                     MOVE 0.00                    TO   DUP-DOA-AMT              
                                                       DUP-SA-AMT               
                  END-IF                                                        
                  MOVE  KD40-AMT-SNP-STAMP        TO   WS-LEASE-SF              
                  MOVE  KD40-AMT-MORT-STAMP       TO   WS-MORT-SF               
                                                       WS-MORT-SF2              
                  MOVE  KD40-AMT-LOAN-GRANTED     TO   WS-LOAN-GRANTED          
                  MOVE  KD40-NUM-SCH-ACC          TO   WS-SCH-ACCT-NO2          
                  MOVE  KD40-AMT-CURR-SELLPR      TO   WS-SELL-PRICE            
               END-IF                                                           
               MOVE    WS-DTE-SALE-AGRM           TO   WS-AO-DATE               
               COMPUTE WS-ANNUAL-RENT = 0                                       
               IF KD40-AMT-SOLICITOR-BILL IS NOT NUMERIC                        
                  MOVE ZEROES TO KD40-AMT-SOLICITOR-BILL                        
               END-IF                                                           
               IF  F315-CDE-TRANS  = 'DS'                                       
                   MOVE KD40-AMT-SOLICITOR-BILL  TO  WS-LEASE-SF                
               END-IF                                                           
            ELSE                                                                
               IF WS-KD40-STATUS = 23                                           
                  PERFORM 1500-READ-BP13KD45         THRU 1500-EXIT             
               ELSE                                                             
                  MOVE    READ-KD40                  TO WS-CUR-PROC             
                  MOVE    WS-KD40-STATUS             TO WS-CUR-STATUS           
                  PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT             
                  PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT             
               END-IF                                                           
            END-IF.                                                             
                                                                                
       1400-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1500-READ-BP13KD45.                                                      
      ******************************************************************        
           DISPLAY '1500'.                                                      
           MOVE SPACES                     TO BP13KD45-REC.                     
           INITIALIZE                         BP13KD45-REC.                     
                                                                                
           MOVE 'N'                        TO WS-KD45-EOF.                      
                                                                                
           MOVE F315-REGN-NO               TO KD45-NUM-REGN-HIST.               
           MOVE SPACES                     TO KD45-DTE-UPDATE-HIST              
                                              KD45-TME-UPDATE-HIST.             
                                                                                
           START BP13KD45 KEY >= KD45-KEY-FLD.                                  
                                                                                
           EVALUATE WS-KD45-STATUS                                              
           WHEN 00                                                              
              PERFORM 1510-READNXT-BP13KD45 THRU 1510-EXIT                      
                 UNTIL WS-KD45-EOF = 'Y'                                        
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE    ZEROES                     TO   WS-LEASE-SF               
              MOVE    ZEROES                     TO   WS-MORT-SF                
              MOVE    ZEROES                     TO   WS-MORT-SF2               
              MOVE    ZEROES                     TO   WS-SUP-SF                 
              MOVE    ZEROES                     TO   WS-DUP-DOA                
              MOVE    SPACES                     TO   WS-AO-DATE                
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS             
              MOVE    START-KD45                 TO   WS-CUR-PROC               
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                 
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT                 
           WHEN OTHER                                                           
              MOVE    START-KD45                 TO WS-CUR-PROC                 
              MOVE    WS-KD45-STATUS             TO WS-CUR-STATUS               
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                 
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT                 
           END-EVALUATE.                                                        
                                                                                
       1500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1510-READNXT-BP13KD45.                                                   
      ******************************************************************        
            DISPLAY '1510'.                                                     
           READ BP13KD45 NEXT RECORD.                                           
                                                                                
           EVALUATE WS-KD45-STATUS                                              
           WHEN 00                                                              
              IF KD45-NUM-REGN-HIST = F315-REGN-NO                              
                 IF KD45-NUM-PP-SCHDL = '01'                                    
                    IF F315-NUM-ADHOC-SF = SPACES                               
                       IF K800-DTE-RAISE-AO <= '20110218'                       
                          MOVE 2.00                TO  DUP-DOA-AMT              
                                                       DUP-SA-AMT               
                       ELSE                                                     
                          MOVE 0.00                TO  DUP-DOA-AMT              
                                                       DUP-SA-AMT               
                       END-IF                                                   
                       MOVE KD45-AMT-SNP-STAMP     TO  WS-LEASE-SF              
                       MOVE KD45-AMT-MORT-STAMP    TO  WS-MORT-SF               
                                                       WS-MORT-SF2              
                       MOVE KD45-AMT-LOAN-GRANTED  TO  WS-LOAN-GRANTED          
                       MOVE WS-DTE-SALE-AGRM       TO  WS-AO-DATE               
                       MOVE KD45-NUM-SCH-ACC       TO  WS-SCH-ACCT-NO2          
                       MOVE KD45-AMT-CURR-SELLPR   TO  WS-SELL-PRICE            
                       MOVE    'Y'                 TO  WS-KD45-EOF              
                       COMPUTE WS-ANNUAL-RENT = 0                               
                       IF KD45-AMT-SOLICITOR-BILL NOT NUMERIC                   
                          MOVE ZEROES TO KD45-AMT-SOLICITOR-BILL                
                       END-IF                                                   
                       IF  F315-CDE-TRANS  = 'DS'                               
                           MOVE KD45-AMT-SOLICITOR-BILL TO  WS-LEASE-SF         
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 MOVE    'Y'                        TO   WS-KD45-EOF            
                 MOVE    ZEROES                     TO   WS-LEASE-SF            
                 MOVE    ZEROES                     TO   WS-MORT-SF             
                                                         WS-MORT-SF2            
                 MOVE    ZEROES                     TO   WS-SUP-SF              
                 MOVE    ZEROES                     TO   WS-DUP-DOA             
                 MOVE    SPACES                     TO   WS-AO-DATE             
                 MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS          
                 MOVE    READ-KD45                  TO   WS-CUR-PROC            
                 PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT              
                 PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT              
              END-IF                                                            
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE    'Y'                        TO   WS-KD45-EOF               
              MOVE    ZEROES                     TO   WS-LEASE-SF               
              MOVE    ZEROES                     TO   WS-MORT-SF                
              MOVE    ZEROES                     TO   WS-SUP-SF                 
              MOVE    ZEROES                     TO   WS-DUP-DOA                
              MOVE    SPACES                     TO   WS-AO-DATE                
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS             
              MOVE    READ-KD45                  TO   WS-CUR-PROC               
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                 
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT                 
           WHEN OTHER                                                           
              MOVE    READ-KD45                  TO   WS-CUR-PROC               
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS             
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                 
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT                 
           END-EVALUATE.                                                        
                                                                                
       1510-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1800-READ-B05K006.                                                       
      ******************************************************************        
            MOVE  ' '                TO L436-TAG.                               
            MOVE  SPACES             TO K006-HDB-REF-SF.                        
            MOVE  WS-SCH-ACCT-NO2    TO K006-HDB-REF-SF.                        
                                                                                
            READ  B05K006.                                                      
                                                                                
            IF WS-K006-STATUS = 00                                              
               PERFORM 1810-CHECK-ADHOC-BLANK-CASES THRU 1810-EXIT              
            END-IF.                                                             
                                                                                
       1800-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1810-CHECK-ADHOC-BLANK-CASES.                                            
      ******************************************************************        
           INITIALIZE             WS-LEASE-AMT.                                 
           COMPUTE WS-LEASE-AMT = WS-LEASE-SF + WS-MORT-SF                      
           IF F315-CDE-TRANS   = 'DS'                                           
              MOVE WS-LEASE-SF  TO  WS-LEASE-AMT                                
           END-IF.                                                              
           IF (K006-BALANCES > WS-LEASE-AMT) OR                                 
              (K006-BALANCES = WS-LEASE-AMT)                                    
               NEXT SENTENCE                                                    
           ELSE                                                                 
               MOVE '*'          TO L436-TAG                                    
           END-IF.                                                              
                                                                                
       1810-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2000-DISPLAY-ERROR-MESSAGE.                                              
      ******************************************************************        
            DISPLAY ' *************   ERROR MESSAGE   *************'.           
            DISPLAY 'ERROR ENCOUNTERED WHEN ' WS-CUR-PROC.                      
            DISPLAY 'STATUS CODE = ' WS-CUR-STATUS.                             
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2150-HANDLE-SER.                                                         
      ******************************************************************        
      *--------------------------------*                                        
      *     PRINT  L436J-RECORD (DOA)  *                                        
      *--------------------------------*                                        
            ADD    1                      TO  WS-CNT-DETAILS.                   
                                                                                
      *     -----------------------                                             
      *     SET UP L436J-REC-DETAIL                                             
      *     -----------------------                                             
            MOVE   WS-CNT-DETAILS         TO  L436-SERIAL-NO                    
                                              L436L-SERIAL-NO                   
            MOVE   WS-SCH-ACC             TO  L436-SCH-ACC                      
                                              L436L-SCH-ACC                     
            MOVE   F315-REGN-NO           TO  L436-REGN-NO                      
                                              L436L-REGN-NO                     
            MOVE   F315-NUM-BLK           TO  L436-BLKNO                        
                                              L436L-BLKNO                       
            MOVE   F315-NME-STREET        TO  L436-STREET                       
                                              L436L-STREET                      
            MOVE   WS-DTE-SALE-AGRM       TO  WS-SALE-DATE                      
            MOVE   WS-SALE-CC             TO  L436-SALE-CC                      
                                              L436L-SALE-CC                     
            MOVE   WS-SALE-YY             TO  L436-SALE-YY                      
                                              L436L-SALE-YY                     
            MOVE   WS-SALE-MM             TO  L436-SALE-MM                      
                                              L436L-SALE-MM                     
            MOVE   WS-SALE-DD             TO  L436-SALE-DD                      
                                              L436L-SALE-DD                     
            MOVE   '/'                    TO  L436-DASH1  L436-DASH2            
                                              L436L-DASH1  L436L-DASH2          
            MOVE   WS-FLATNO              TO  L436-FLATNO                       
                                              L436L-FLATNO                      
                                                                                
            IF WS-LOAN-GRANTED = ZEROS                                          
               MOVE     ZEROES            TO  L436-MORT-SF                      
               MOVE     ZEROES            TO  L436-TOTAL-MORT-SF                
               MOVE     ZEROES            TO  L436-DUP-DOA                      
               MOVE     ZEROES            TO  WS-MORT-SF                        
               MOVE     ZEROES            TO  WS-DUP-DOA                        
            ELSE                                                                
               SUBTRACT DUP-DOA-AMT       FROM  WS-MORT-SF                      
               MOVE     WS-MORT-SF        TO    L436-MORT-SF                    
               MOVE     DUP-DOA-AMT       TO    WS-DUP-DOA                      
               MOVE     DUP-DOA-AMT       TO    L436-DUP-DOA                    
            END-IF.                                                             
                                                                                
            IF F315-REGN-NO = '5042672F'                                        
               MOVE     500               TO    WS-MORT-SF                      
               MOVE     500               TO    L436-TOTAL-MORT-SF              
               MOVE     500               TO    L436-MORT-SF                    
            END-IF.                                                             
                                                                                
            IF WS-LEASE-SF NOT = ZEROES                                         
               PERFORM  1800-READ-B05K006 THRU 1800-EXIT                        
                                                                                
               COMPUTE WS-LEASE-STAMP = WS-LEASE-SF                             
                                                                                
               MOVE    WS-LEASE-STAMP   TO  L436-SUP-LEASE-STAMP                
                                            L436L-LEASE-STAMP                   
            ELSE                                                                
               MOVE    0                TO  L436-SUP-LEASE-STAMP                
                                            L436L-LEASE-STAMP                   
            END-IF.                                                             
                                                                                
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +              
                                     WS-LEASE-STAMP).                           
            IF F315-CDE-TRANS  = 'DS'                                           
               COMPUTE WS-TEMP-TOTAL = WS-LEASE-STAMP                           
            END-IF.                                                             
                                                                                
            MOVE    WS-TEMP-TOTAL         TO  L436-DETL-AMT-TOTAL               
                                              L436L-DETL-AMT-TOTAL.             
                                                                                
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.                   
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.                     
            ADD     1                     TO  WS-L436J-PRINT-CNT.               
            ADD     WS-MORT-SF            TO  WS-L436J-MORT-CNT.                
            ADD     WS-DUP-DOA            TO  WS-L436J-DUP-DOA-CNT.             
            ADD     WS-LEASE-STAMP        TO  WS-L436J-LEASE-CNT.               
            ADD     WS-TEMP-TOTAL         TO  WS-L436J-IND-TOT-CNT.             
            MOVE    WS-L436J-IND-TOT-CNT  TO  WS-AMT-TOTAL.                     
            IF F315-CDE-TRANS = 'DB'                                            
               WRITE   L436J-PRINT-REC  FROM  L436-REC-DETAIL AFTER 1           
            ELSE                                                                
               IF F315-CDE-TRANS = 'DS'                                         
                  WRITE L436L-PRINT-REC FROM L436L-REC-DETAIL AFTER 1           
               END-IF                                                           
            END-IF.                                                             
                                                                                
            MOVE    'J'                   TO  WS-PREV-REPORT-ID.                
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                   
                                          TO  WS-TXT-INFO.                      
            IF  F315-CDE-TRANS  = 'DS'                                          
                MOVE   'NS PAYMENT FOR LEASE PREPARATION FEES'                  
                                          TO  WS-TXT-INFO                       
            END-IF.                                                             
                                                                                
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.        
                                                                                
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                            
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT         
                MOVE    ZEROES                   TO   WS-CNT-DETAILS            
                MOVE    'Y'                      TO   WS-NEW-BATCH              
                                                      WS-NEW-VOUCHER            
                                                      WS-NEW-HEADER             
            END-IF.                                                             
                                                                                
       2150-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4200-PRINT-LAST-LINES.                                                   
      ******************************************************************        
            PERFORM 5000-WRITE-TRAILER-F225                                     
               THRU 5000-TRAILER-EXIT.                                          
                                                                                
       4200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4295-PRINT-L436J-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4295-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L436-VR-NO-HIGH                      
                                           L436L-VR-NO-HIGH                     
            MOVE  WS-L436J-MORT-CNT     TO L436-TOTAL-MORT-SF.                  
            MOVE  WS-L436J-DUP-DOA-CNT  TO L436-TOTAL-DUP-DOA.                  
            MOVE  WS-L436J-LEASE-CNT    TO L436-TOTAL-SUP-LEASE-SF              
                                           L436L-TOTAL-SUP-LEASE-SF.            
            MOVE  WS-L436J-IND-TOT-CNT  TO L436-TOTAL-AMT                       
                                           L436L-TOTAL-AMT.                     
            IF  F315-CDE-TRANS  = 'DB'                                          
                WRITE L436J-PRINT-REC  FROM PRT-L436-DASH-LINE  AFTER 2         
                WRITE L436J-PRINT-REC  FROM PRT-L436-TOTAL-LINE AFTER 1         
                WRITE L436J-PRINT-REC  FROM PRT-L436-DASH-LINE  AFTER 1         
            ELSE                                                                
              IF F315-CDE-TRANS  = 'DS'                                         
                WRITE L436L-PRINT-REC  FROM PRT-L436-DASH-LINE  AFTER 2         
                WRITE L436L-PRINT-REC FROM PRT-L436L-TOTAL-LINE AFTER 1         
                WRITE L436L-PRINT-REC FROM PRT-L436-DASH-LINE  AFTER 1          
              END-IF                                                            
            END-IF.                                                             
            MOVE     WS-L436J-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L436-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L436-AMT-DESC2.                 
                                                                                
            WRITE    L436J-PRINT-REC       FROM PRT-L436-FTG-1 AFTER 3.         
            WRITE    L436L-PRINT-REC       FROM PRT-L436-FTG-1 AFTER 3.         
            WRITE    L436J-PRINT-REC       FROM PRT-L436-FTG-2 AFTER 6.         
            MOVE     SPACES                TO L436L-PRINT-REC.                  
            WRITE    L436L-PRINT-REC                                            
            WRITE    L436L-PRINT-REC       FROM PRT-L436-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L436J-MORT-CNT               
                                                WS-L436J-DUP-DOA-CNT            
                                                WS-L436J-LEASE-CNT              
                                                WS-L436J-IND-TOT-CNT.           
       4295-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4770-PRINT-L436J-HEADER.                                                 
      ******************************************************************        
            IF F315-CDE-TRANS = 'DB'                                            
               MOVE 'P13L436J'          TO L436-REPORT-ID                       
            ELSE                                                                
               IF F315-CDE-TRANS = 'DS'                                         
                  MOVE 'P13L436L'          TO L436-REPORT-ID                    
               END-IF                                                           
            END-IF                                                              
                                                                                
            MOVE  WS-L436J-DESC      TO L436-REPORT-ID-DESC.                    
            MOVE  WS-L436JL-DESC     TO L436L-REPORT-ID-DESC.                   
            MOVE 'LEASE     '        TO L436-SUP-LEASE-DESC.                    
            MOVE '   '               TO L436-TAG-DESC.                          
            ADD   1                  TO WS-L436J-PAGE-CNT.                      
            MOVE  WS-L436J-PAGE-CNT  TO L436-PAGE.                              
                                                                                
            MOVE "FINANCE'S COPY"          TO L436-COPY-NAME.                   
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-1    AFTER PAGE.           
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-2    AFTER 2.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-3    AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-4    AFTER 2.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-5    AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-6    AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-7    AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-8    AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-9    AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-10   AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-10A  AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-11   AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-SUBHDG-1 AFTER 3.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-SUBHDG-2 AFTER 1.              
            WRITE L436J-PRINT-REC  FROM PRT-L436-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L436J-PRINT-REC.                        
            WRITE L436J-PRINT-REC AFTER 1.                                      
                                                                                
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-1    AFTER PAGE.           
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-2    AFTER 2.              
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-3    AFTER 1.             
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-4    AFTER 2.              
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-5    AFTER 1.              
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-6    AFTER 1.              
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-7    AFTER 1.              
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-8    AFTER 1.              
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-9    AFTER 1.             
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-10   AFTER 1.             
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-11   AFTER 1.             
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-1A AFTER 1.            
            MOVE SPACES TO L436L-PRINT-REC.                                     
            WRITE L436L-PRINT-REC.                                              
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-1 AFTER 3.             
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-2 AFTER 1.             
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-3 AFTER 1.             
            MOVE  SPACES             TO L436L-PRINT-REC.                        
            WRITE L436L-PRINT-REC AFTER 1.                                      
                                                                                
       4770-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-HEADER-F225.                                                  
      ******************************************************************        
            INITIALIZE                         AG07F225-HEADER.                 
            MOVE    SPACES                TO   AG07F225-HEADER.                 
                                                                                
            MOVE    C907-NUM-DDD          TO   F225-NUM-DDD.                    
            MOVE    C907-NUM-FIN-YR       TO   F225-NUM-FIN-YEAR.               
            MOVE    C907-NUM-VR-SERIAL    TO   F225-NUM-VR-SERIAL.              
            MOVE    F225-NUM-VR           TO   WS-NUM-VOUCHER.                  
            MOVE    00                    TO   F225-NUM-REC-TYP.                
            MOVE   'PV'                   TO   F225-NUM-VR-TYP.                 
            MOVE   'TL'                   TO   F225-NUM-VR-SUB-TYP.             
            MOVE   'SOC'                  TO   F225-NUM-TRANS-TYP.              
            MOVE  FUNCTION CURRENT-DATE   TO   F225-DTE-VR-CREATE               
                                               F225-DTE-VR-PRT-FINAL.           
            MOVE   'BP13C436'      TO   F225-NUM-VR-CREATE-USERID               
                                        F225-NUM-VR-PRT-FINAL-USERID.           
            MOVE   'STPFEE  '      TO   F225-NUM-DDD-FILE-REF.                  
            MOVE   'COMMISSIONER OF STAMP DUTIES'   TO  F225-NME-PAYEE1.        
            MOVE   'C/O SC(STAMPING) OF SALES UNIT' TO  F225-NME-STREET.        
            MOVE   'SALES AGREEMENT TEAM' TO   F225-NME-COLL-OFFCR.             
            MOVE   '64903781'           TO   F225-NUM-COLL-OFFCR-PHONE.         
            MOVE   'SALES AGREEMENT TEAM' TO F225-NME-CONTACT-OFFCR.            
            MOVE   '64903781'           TO  F225-NUM-CONTACT-PHONE.             
            MOVE   'DBSSSGSGXXX'        TO  F225-NUM-PAYEE-BANK.                
            MOVE   SPACES               TO  F225-NUM-PAYEE-BANK-BRNCH.          
            MOVE   '0010468600'         TO  F225-NUM-PAYEE-IBG-ACCT.            
            MOVE   SPACES               TO  F225-NUM-ROOT-ACCT.                 
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN1.                
            MOVE   SPACES               TO  F225-NME-PAYEE2.                    
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN2.                
            MOVE   SPACES               TO  F225-NUM-PAYEE-TAX-REGN.            
            MOVE   SPACES               TO  F225-TXT-REJECT-HDR.                
            MOVE   'STPFEE  '           TO  F225-NUM-INTRFC-FR-HDR.             
            MOVE   'CV'                 TO  F225-NUM-ACTION-TYP.                
            MOVE   SPACES               TO  F225-NUM-PRCS-TERM.                 
            MOVE   SPACES               TO  F225-NUM-ROUTE-FLAG.                
            IF F315-USERID   = 'BP13P001'                                       
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP             
                                             F225-NUM-USERID-START              
            ELSE                                                                
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP             
                                             F225-NUM-USERID-START              
            END-IF.                                                             
            MOVE   'PREP'               TO   F225-NUM-VCHR-STATE-START.         
            MOVE   SPACES               TO   F225-DTE-PYMNT-DUE.                
                                                                                
            IF F315-CDE-TRANS = 'DS'                                            
               MOVE WS-NME-FIN-SOLICITOR    TO   F225-NME-PAYEE1                
               MOVE  'C/O MR BALA OF SALES OPERATION'  TO                       
                                                 F225-NME-STREET                
               MOVE   'MR BALA       '     TO   F225-NME-COLL-OFFCR             
               MOVE   SPACES            TO F225-NUM-PAYEE-BANK                  
                                           F225-NUM-PAYEE-BANK-BRNCH            
                                           F225-NUM-PAYEE-IBG-ACCT              
            END-IF.                                                             
                                                                                
            WRITE AG07F225-HEADER.                                              
                                                                                
            ADD     1                     TO   WS-AG07F225-WRITE-CNT.           
            MOVE    C907-NUM-DDD          TO   WS-EDITED-NUM-DDD.               
            MOVE    C907-NUM-FIN-YR       TO   WS-EDITED-NUM-FIN-YEAR.          
            MOVE    C907-NUM-VR-SERIAL    TO   WS-EDITED-NUM-VR-SERIAL.         
            MOVE    WS-EDITED-VOUCHER-NO  TO   L436-VOUCHER-NO.                 
                                                                                
            MOVE    SPACES                TO   L436-BATCH-NO.                   
                                                                                
            STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE                       
                   WS-NUM-FIN-YEAR     DELIMITED BY SPACE                       
                   '-'                 DELIMITED BY SIZE                        
                   WS-NUM-BATCH-SERIAL DELIMITED BY SPACE                       
                   INTO L436-BATCH-NO                                           
            END-STRING.                                                         
                                                                                
            EVALUATE TRUE                                                       
            WHEN     REPORT-L436J                                               
               PERFORM 4770-PRINT-L436J-HEADER   THRU 4770-EXIT                 
            END-EVALUATE.                                                       
                                                                                
       5000-HEADER-EXIT.                                                        
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-TRANS-DETAIL-F225.                                            
      ******************************************************************        
            INITIALIZE AG07F225-TRANS.                                          
            MOVE    SPACES             TO    AG07F225-TRANS.                    
            MOVE    WS-NUM-VOUCHER     TO    F225-NUM-VR-T.                     
            MOVE    WS-CNT-DETAILS     TO    F225-NUM-TRANS-SERIAL.             
            MOVE   '04'                TO    F225-NUM-SYS.                      
            MOVE    WS-SCH-ACCT-NO     TO    F225-NUM-HDB-REF.                  
            MOVE   '0000000104250'     TO    F225-NUM-GL-ACCT.                  
            MOVE    WS-AMT-TRANS       TO    F225-AMT-TRANS.                    
            MOVE   'D'                 TO    F225-NUM-TRANS-DR-CR               
            MOVE    ZEROES             TO    F225-AMT-TRANS-GST.                
            MOVE    WS-TXT-INFO        TO    F225-TXT-INFO.                     
            MOVE    SPACES             TO    F225-NUM-TAX-CDE.                  
            MOVE    SPACES             TO    F225-NUM-CPF.                      
            MOVE    SPACES             TO    F225-TXT-REJECT-DTL.               
            MOVE    'STPFEE  '          TO  F225-NUM-INTRFC-FR-T.               
                                                                                
            WRITE   AG07F225-TRANS.                                             
                                                                                
            ADD     1                  TO    WS-AG07F225-WRITE-CNT.             
                                                                                
       5000-DETAIL-EXIT.                                                        
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-TRAILER-F225.                                                 
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 5000-TRAILER-EXIT                                          
            END-IF.                                                             
                                                                                
            EVALUATE TRUE                                                       
            WHEN REPORT-L436J                                                   
               PERFORM 4295-PRINT-L436J-GRAND-TOTAL THRU 4295-EXIT              
               MOVE    WS-AMT             TO  WS-AMT-TOTAL                      
            END-EVALUATE.                                                       
                                                                                
            INITIALIZE AG07F225-TRAILER.                                        
            MOVE       SPACES             TO  AG07F225-TRAILER.                 
            MOVE       WS-NUM-VOUCHER     TO  F225-NUM-VR-R.                    
            MOVE       99                 TO  F225-NUM-TRAILER-SERIAL.          
            MOVE       'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                  
                                          TO  F225-TXT-VOUCHER-NARRATION        
            IF  F315-CDE-TRANS  = 'DS'                                          
                MOVE       'PAYMENT FOR LEASE PREPARATION FEES'                 
                                         TO  F225-TXT-VOUCHER-NARRATION         
            END-IF.                                                             
                                                                                
            MOVE       WS-CNT-DETAILS     TO  F225-QTY-VR-TRANS.                
            MOVE       WS-AMT-TOTAL       TO  F225-AMT-VR-DR-TOTAL.             
            MOVE       ZEROES             TO  F225-AMT-VR-CR-TOTAL.             
            MOVE       SPACES             TO  F225-TXT-REJECT-TLR.              
            MOVE       'STPFEE  '         TO  F225-NUM-INTRFC-FR.               
                                                                                
            WRITE      AG07F225-TRAILER.                                        
                                                                                
            ADD        1                  TO    WS-AG07F225-WRITE-CNT.          
                                                                                
       5000-TRAILER-EXIT.                                                       
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       6000-WRITE-STAMPING-FILE.                                                
      ******************************************************************        
            DISPLAY '6000-WRITE-STAMPING-FILE'.                                 
            INITIALIZE BP13K625-REC.                                            
            MOVE  SPACES                TO BP13K625-REC.                        
                                                                                
            PERFORM 1400-READ-BP13KD40  THRU 1400-EXIT.                         
                                                                                
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.                      
            MOVE 'DAS'                  TO WS-NUM-DOC.                          
                                                                                
      ****  WRITE DETAIL PART FOR ORIGINAL MORTGAGE STAMP FEE*******            
            MOVE  'O'                   TO WS-NUM-DOC-TYP.                      
                                                                                
            IF WS-MORT-SF > 0                                                   
               COMPUTE WS-MORT-SF = WS-MORT-SF - DUP-DOA-AMT                    
            END-IF.                                                             
                                                                                
            MOVE  WS-MORT-SF             TO WS-AMT-STAMP-DUTY.                  
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY-DUP.              
                                                                                
            IF WS-AMT-STAMP-DUTY > 0                                            
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT                
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT                
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY                
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP            
               WRITE BP13K625-REC                                               
               ADD   1   TO  WS-BP13K625-WRITE-CNT                              
            ELSE                                                                
               NEXT SENTENCE                                                    
            END-IF.                                                             
                                                                                
      ****  WRITE DETAIL PART FOR DUPLICATE MORTGAGE STAMP FEE*******           
            MOVE  'D'                    TO WS-NUM-DOC-TYP.                     
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY.                  
            MOVE  WS-DUP-DOA             TO WS-AMT-STAMP-DUTY-DUP.              
                                                                                
            IF WS-AMT-STAMP-DUTY-DUP > 0                                        
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT                
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT                
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY                
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP            
               WRITE BP13K625-REC                                               
               ADD   1   TO  WS-BP13K625-WRITE-CNT                              
            ELSE                                                                
               NEXT SENTENCE                                                    
            END-IF.                                                             
                                                                                
      ****  WRITE DETAIL PART FOR ORIGINAL S&P FEE   *******                    
            MOVE  'ALE'               TO WS-NUM-DOC.                            
            MOVE  'O'                 TO WS-NUM-DOC-TYP.                        
            PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT.                  
            PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT.                  
            MOVE  WS-LEASE-STAMP      TO K625-AMT-STAMP-DUTY.                   
            MOVE  ZEROES              TO K625-AMT-STAMP-DUTY-DUP.               
            WRITE BP13K625-REC.                                                 
            ADD   1                   TO WS-BP13K625-WRITE-CNT.                 
                                                                                
      ****  WRITE DETAIL PART FOR DUPLICATE S&P FEE   *******                   
            MOVE  'D'                 TO WS-NUM-DOC-TYP.                        
            PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT.                  
            PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT.                  
            MOVE  ZEROES              TO K625-AMT-STAMP-DUTY.                   
            MOVE  DUP-SA-AMT          TO K625-AMT-STAMP-DUTY-DUP.               
            WRITE BP13K625-REC.                                                 
            ADD   1                   TO WS-BP13K625-WRITE-CNT.                 
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6100-CHK-EXISTING-BP13K625.                                              
      ******************************************************************        
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.                    
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                        
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.                    
           MOVE 1                       TO K625-NUM-DOC-CNT.                    
           MOVE 'N'                     TO WS-K625-EOF.                         
                                                                                
           START BP13K625 KEY = K625-KEY-FLD.                                   
                                                                                
           EVALUATE  WS-K625-STATUS                                             
              WHEN '00'                                                         
                    PERFORM 6200-READNEXT-BP13K625 THRU 6200-EXIT               
                            UNTIL WS-K625-EOF = 'Y'                             
                    ADD  1              TO WS-NUM-DOC-CNT                       
              WHEN '10'                                                         
              WHEN '23'                                                         
                    MOVE 1              TO WS-NUM-DOC-CNT                       
              WHEN OTHER                                                        
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '             
                    MOVE WS-K625-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6200-READNEXT-BP13K625.                                                  
      ******************************************************************        
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF                    
              GO TO 6200-EXIT.                                                  
                                                                                
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                        
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                        
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                           
              MOVE 'Y'                  TO WS-K625-EOF                          
              GO TO 6200-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.                      
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6300-MAIN-DETAILS-TO-K625.                                               
      ******************************************************************        
            MOVE  SPACES                 TO BP13K625-REC.                       
            INITIALIZE                      BP13K625-REC.                       
                                                                                
            MOVE  F315-SCH-ACC           TO K625-NUM-HDB-REF.                   
            MOVE  WS-NUM-DOC             TO K625-NUM-DOC.                       
            MOVE  WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.                   
            MOVE  WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.                   
            MOVE  C907-NUM-DDD           TO K625-NUM-DDD.                       
            MOVE  C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.                  
            MOVE  C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.                 
            MOVE  C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.                
            MOVE  C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.                  
            MOVE  C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.              
            MOVE  F315-REGN-NO           TO K625-NUM-REGN.                      
            MOVE  WS-DTE-SALE-AGRM       TO K625-DTE-DOC-PREPARE.               
            MOVE  WS-SELL-PRICE          TO K625-AMT-PURCHASE-PRICE.            
            MOVE  WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.               
            MOVE  SPACES                 TO K625-NUM-INCREASE-SCCC.             
            MOVE  WS-LOAN-GRANTED        TO K625-AMT-LOAN.                      
            MOVE  'BP13C436'             TO K625-NUM-SYSTEM.                    
            MOVE  FUNCTION CURRENT-DATE  TO K625-DTE-UPDATE.                    
            COMPUTE K625-NUM-LEASE-TERM = 99 * 12.                              
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6500-PRINT-L436K-REPORT.                                                 
      ******************************************************************        
           IF WS-L436K-REC-ON-PAGE-CNT > 65                                     
              PERFORM 6510-PRINT-L436-HEADER     THRU 6510-EXIT                 
           END-IF.                                                              
                                                                                
           MOVE SPACES                TO L436K-REC-DETAIL.                      
           INITIALIZE                    L436K-REC-DETAIL.                      
                                                                                
           ADD  1                     TO WS-L436K-PRINT-CNT.                    
           MOVE WS-L436K-PRINT-CNT    TO L436K-SERIAL-NO.                       
           MOVE F315-REGN-NO          TO L436K-REGN-NO.                         
                                                                                
           STRING F315-SCH-ACC(1:4) '-'                                         
                  F315-SCH-ACC(5:4) '-'                                         
                  F315-SCH-ACC(9:1) '-'                                         
                  F315-SCH-ACC(10:2)                                            
                  DELIMITED BY SIZE INTO L436K-SCH-ACC                          
           END-STRING.                                                          
                                                                                
           STRING C907-NUM-DDD    '-'                                           
                  C907-NUM-FIN-YR '-'                                           
                  C907-NUM-VR-SERIAL                                            
                  DELIMITED BY SIZE INTO L436K-JR-VCHR-NO                       
           END-STRING.                                                          
                                                                                
           MOVE WS-AMT-EARMARK    TO L436K-AMT-TOTAL.                           
                                                                                
           EVALUATE B902-CDE-ERROR-ACCT(1)                                      
              WHEN 'S0045'                                                      
                 MOVE 'B05K006 FILE ERROR'         TO L436K-ERROR-DESC          
              WHEN 'S0052'                                                      
                 MOVE 'INVALID INPUT      '        TO L436K-ERROR-DESC          
              WHEN 'S0053'                                                      
                 MOVE 'AB05K009 FILE ERROR'        TO L436K-ERROR-DESC          
              WHEN 'S0054'                                                      
                 MOVE 'B05K006 REC NOT FND'        TO L436K-ERROR-DESC          
              WHEN 'S0055'                                                      
                 MOVE 'NOT ENOUGH BALANCE'         TO L436K-ERROR-DESC          
              WHEN OTHER                                                        
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L436K-ERROR-DESC          
           END-EVALUATE.                                                        
                                                                                
           WRITE L436K-PRINT-REC  FROM L436K-REC-DETAIL  AFTER 1.               
                                                                                
           ADD   1     TO  WS-L436K-REC-ON-PAGE-CNT.                            
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6510-PRINT-L436-HEADER.                                                  
      ******************************************************************        
           ADD  1                 TO   WS-L436K-PAGE-CNT.                       
           MOVE WS-L436K-PAGE-CNT TO   L436-PAGE.                               
           MOVE 'P13L436K'        TO   L436-REPORT-ID.                          
           WRITE L436K-PRINT-REC  FROM PRT-L436-HDG-1    AFTER PAGE.            
           WRITE L436K-PRINT-REC  FROM L436K-HEADER2     AFTER 2.               
           WRITE L436K-PRINT-REC  FROM L436K-HEADER3     AFTER 2.               
           WRITE L436K-PRINT-REC  FROM L436K-UNDERLINE   AFTER 1.               
           MOVE  6                TO   WS-L436K-REC-ON-PAGE-CNT.                
                                                                                
       6510-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       8000-DISPLAY-STATISTICS.                                                 
      ******************************************************************        
            MOVE    WS-BP13F315-READ-CNT  TO  WS-EDIT-BP13F315-READ.            
            MOVE    WS-L436J-PRINT-CNT    TO  WS-EDIT-L436J-PRINT.              
            MOVE    WS-AG07F225-WRITE-CNT TO  WS-EDIT-AG07F225-WRITE.           
                                                                                
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-SUMMARY-HEADER.                                          
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-READ-CASES.                                              
            DISPLAY WS-DOA-PAYMENT-PRINTED.                                     
            DISPLAY WS-L436J-PRINTED.                                           
            DISPLAY WS-STAMP-FEES-REC-WRITTEN.                                  
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-SUMMARY-TRAILER.                                         
            DISPLAY 'NO OF RECORDS WRITTEN TO             (BP13K625) = '        
                    WS-BP13K625-WRITE-CNT.                                      
            DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = '        
                    WS-L436K-PRINT-CNT.                                         
                                                                                
       8000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       9000-CLOSE-FILES.                                                        
      ******************************************************************        
      *     CLOSE  B05K006                                                      
            CLOSE  BP13F315                                                     
                   AG07F225                                                     
                   BP13K800                                                     
                   BP13KD00                                                     
                   BP13KA10                                                     
                   BP13KD40                                                     
                   BP13KD45                                                     
                                                                                
                   BP13436J                                                     
                   BP13436L                                                     
                                                                                
                   BP13436K                                                     
                                                                                
                   BP13K625.                                                    
                                                                                
            IF WS-K006-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING B05K006, STAT = ' WS-K006-STATUS          
               MOVE     WS-K006-STATUS     TO  RETURN-CODE                      
            END-IF.                                                             
                                                                                
            IF WS-K800-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING BP13K800, STAT = ' WS-K800-STATUS         
               MOVE     WS-K800-STATUS      TO  RETURN-CODE                     
            END-IF.                                                             
                                                                                
            IF WS-KD00-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING BP13KD00, STAT = ' WS-KD00-STATUS         
               MOVE     WS-KD00-STATUS      TO  RETURN-CODE                     
            END-IF.                                                             
                                                                                
            IF WS-KA10-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING BP13KA10, STAT = ' WS-KA10-STATUS         
               MOVE     WS-KA10-STATUS      TO  RETURN-CODE                     
            END-IF.                                                             
                                                                                
            IF WS-KD40-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING BP13KD40, STAT = ' WS-KD40-STATUS         
               MOVE     WS-KD40-STATUS      TO  RETURN-CODE                     
            END-IF.                                                             
                                                                                
            IF WS-KD45-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING BP13KD45, STAT = ' WS-KD45-STATUS         
               MOVE     WS-KD45-STATUS      TO  RETURN-CODE                     
            END-IF.                                                             
                                                                                
            IF WS-K625-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING BP13K625, STAT = ' WS-K625-STATUS          
              MOVE     WS-K625-STATUS      TO  RETURN-CODE                      
            END-IF.                                                             
                                                                                
            MOVE 'AG07K960'  TO     C907-NUM-FILENME.                           
            CALL 'K960CLSE'  USING  AG07C907-AREA.                              
                                                                                
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR CLOSING AG07K960, STATUS = '                      
                        C907-NUM-FILE-STATUS                                    
               MOVE     C907-NUM-FILE-STATUS    TO  WS-AG07-STAT-X              
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE              
            END-IF.                                                             
                                                                                
            MOVE 'BP13K620'  TO     C906-NUM-FILENME.                           
            CALL 'K620MCLS'  USING  BP13C906-AREA.                              
                                                                                
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR CLOSING BP13K620, STATUS = '                      
                        C906-NUM-FILE-STATUS                                    
               MOVE     C906-NUM-FILE-STATUS    TO  WS-AG07-STAT-X              
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE              
            END-IF.                                                             
                                                                                
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')             
            MOVE SPACES              TO   WS-B902-AREA.                         
            INITIALIZE                    WS-B902-AREA.                         
            MOVE 'C'                 TO   B902-CDE-TYPE.                        
            CALL 'AB05C902'  USING WS-B902-AREA.                                
                                                                                
            IF B902-CDE-ERROR NOT = ZEROES                                      
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                           
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'                    
            END-IF.                                                             
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       9500-CONVT-AMT-WORD.                                                     
      ******************************************************************        
      *------------------------------------------------------------*            
      *                                                            *            
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *            
      *                              INTO AMOUNT IN WORDS          *            
      *                                                            *            
      *------------------------------------------------------------*            
            MOVE SPACES TO WF-DETAILS.                                          
            MOVE ZERO   TO WS-SWITCH                                            
                           WS-THO-SW                                            
                           WS-CNT-SW                                            
                           WS-LIT-SW                                            
                           WS-TEN-SW                                            
                           WS-AND-SW.                                           
            MOVE 60     TO WS-PLACE-COUNTER.                                    
            MOVE 1      TO WF-SUB.                                              
                                                                                
            PERFORM B000-ROUTINE THRU B990-EXIT                                 
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.          
                                                                                
       9500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       B000-ROUTINE SECTION.                                                    
      ******************************************************************        
       B000-GO.                                                                 
            IF WS-DIGIT (WS-SUB) = ZERO                                         
                 IF WS-TEN-SW = ZERO                                            
                    GO TO B800-MOVE-TYPE                                        
                 ELSE                                                           
                    GO TO B010-PROCESS.                                         
                                                                                
            IF WS-FIRST-SUB = ZERO                                              
               MOVE WS-SUB TO WS-FIRST-SUB.                                     
                                                                                
            IF WS-SWITCH = ZERO                                                 
               MOVE 1 TO WS-SWITCH.                                             
                                                                                
       B010-PROCESS.                                                            
            IF WS-SUB = 8                                                       
               MOVE 9 TO WS-CNT-SW.                                             
                                                                                
            IF WS-SUB = 9                                                       
               IF WS-CNT-SW = ZERO                                              
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                          
                                                                                
            IF WS-SUB = 2 OR 3 OR 4                                             
               MOVE 1 TO WS-THO-SW.                                             
                                                                                
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                                   
            IF WS-SUB = 3 OR 6 OR 8                                             
               IF WS-DIGIT (WS-SUB) = 1                                         
                  MOVE 1 TO WS-TEN-SW                                           
                  GO TO B990-EXIT                                               
               ELSE                                                             
                  ADD 18 TO WA-SUB                                              
            ELSE                                                                
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                        
               IF WS-TEN-SW = 1                                                 
                  MOVE 0 TO WS-TEN-SW                                           
                  ADD 10 TO WA-SUB.                                             
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                                   
            PERFORM R000-LOAD-IN.                                               
                                                                                
       B300-TENS.                                                               
            IF WS-SUB = 3 OR 6 OR 8                                             
               GO TO B990-EXIT.                                                 
                                                                                
       B400-MOVE-HUNDRED.                                                       
            IF WS-SUB = 2 OR 5                                                  
               MOVE L-HUNDRED TO WL-AREA                                        
               MOVE 1 TO WS-LIT-SW                                              
               PERFORM R000-LOAD-IN                                             
               MOVE 1 TO WS-AND-SW                                              
               GO TO B990-EXIT.                                                 
                                                                                
       B800-MOVE-TYPE.                                                          
            IF WS-SWITCH = ZERO                                                 
               GO TO B990-EXIT.                                                 
                                                                                
            IF WS-SUB = 1                                                       
               MOVE  L-MILLION TO WL-AREA                                       
               MOVE  1         TO WS-LIT-SW                                     
               MOVE  1         TO WS-AND-SW                                     
               GO TO B880-LOAD-IN.                                              
                                                                                
            IF WS-SUB = 7                                                       
               MOVE 1 TO WS-LIT-SW WS-AND-SW                                    
               IF WS-FIRST-SUB = 7  AND                                         
                  WS-DIGIT (WS-SUB) = 1                                         
                  MOVE L-DOLLAR TO WL-AREA                                      
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
                  MOVE L-DOLLARS TO WL-AREA                                     
                  GO TO B880-LOAD-IN.                                           
                                                                                
            IF WS-SUB = 4 AND WS-THO-SW = 1                                     
               MOVE 1 TO WS-AND-SW WS-LIT-SW                                    
               MOVE L-THOUSAND TO WL-AREA                                       
               GO TO B880-LOAD-IN.                                              
                                                                                
            IF WS-SUB = 9                                                       
               MOVE 1 TO WS-LIT-SW                                              
               IF WS-CNT-SW = ZERO                                              
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
               IF WS-CNT-SW = 1                                                 
                  MOVE L-CENT TO WL-AREA                                        
                  PERFORM R000-LOAD-IN                                          
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
                  MOVE L-CENTS TO WL-AREA                                       
                  PERFORM R000-LOAD-IN                                          
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN.                                           
            GO TO B990-EXIT.                                                    
                                                                                
       B880-LOAD-IN.                                                            
            PERFORM R000-LOAD-IN.                                               
                                                                                
       B990-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       R000-LOAD-IN SECTION.                                                    
      ******************************************************************        
      *------------------------------------------------------------*            
      *                                                            *            
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *            
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *            
      *                                                            *            
      *------------------------------------------------------------*            
                                                                                
       R001-GO.                                                                 
            IF WS-LIT-SW = 1                                                    
               MOVE ZERO TO WS-LIT-SW                                           
               GO TO R050-CONT.                                                 
                                                                                
            IF WS-SUB = 2 OR 5                                                  
               GO TO R050-CONT.                                                 
                                                                                
       R025-ADD-TEST.                                                           
            IF WS-AND-SW NOT = 1                                                
               GO TO R050-CONT.                                                 
                                                                                
            MOVE ZERO TO WS-AND-SW.                                             
            MOVE WL-AREA TO WL-AREA-SAVE.                                       
            MOVE L-AND TO WL-AREA.                                              
            PERFORM R200-LOADUP.                                                
            MOVE WL-AREA-SAVE TO WL-AREA.                                       
                                                                                
       R050-CONT.                                                               
            PERFORM R200-LOADUP.                                                
                                                                                
       R099-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       R200-LOADUP SECTION.                                                     
      ******************************************************************        
       R201-GO.                                                                 
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                               
            IF  WS-RESULT > WS-PLACE-COUNTER                                    
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                            
                ADD 60 TO WS-PLACE-COUNTER.                                     
                                                                                
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL                  
                    WL-ITEM (WL-SUB) = L-X.                                     
                                                                                
       R490-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       R500-LOAD SECTION.                                                       
      ******************************************************************        
       R501-GO.                                                                 
                                                                                
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                          
            ADD  1                TO WF-SUB.                                    
            IF WL-ITEM (WL-SUB) = SPACE                                         
               ADD   1     TO     WL-SUB                                        
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                              
               SUBTRACT 1  FROM   WL-SUB.                                       
                                                                                
       R990-EXIT.                                                               
            EXIT.                                                               
