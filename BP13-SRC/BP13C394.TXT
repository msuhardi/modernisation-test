       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C394.                                                 
      *AUTHOR.        N.SURESH.                                                 
      *DATE-WRITTEN.  16/04/2001.                                               
      * ====================================================== *                
      *             SYSTEM OF COMMITMENT (BP13)                *                
      * ====================================================== *                
      *    OBJECTIVE   : TO AMORTISE FOR STUDIO APARTMENTS     *                
      *                  BASED ON DEFER INCOME.                *                
      *                  TO GENERATE MONTHLY AND ACCUMULATED   *                
      *                  AMORTISATION REPORT.                  *                
      *                                                                         
      * P13F690A - ACCUM AMORTISATION FILE                                      
      * P13F690B - NEW   AMORTISATION FILE                                      
      * P13F690C - ERROR AMORTISATION FILE                                      
      * BP13F120 - GL ENTRY FOR SA                                              
      *--------------------------------------------------------*                
      * CHG-NO  BY    DATE    DETAILS                          *                
      * ------  --- --------  -------                          *                
      * BP131000 SN   16042001  NEW PGM                        *                
      * BP132044 LITO 23112001  BACKDATE                       *                
      * BP132044 CKK7 20122001  REMOVE HARD-CODING             *                
      * BP132292 SK   06102003  VALIDATE DTE-COMPENSATION-PD   *                
      * BP135903 FNP1 30102015  CATER FOR LBS/FLEXI CASES      *                
      * BP136398 FNP1 26052016  EXPAND F690 TO 600 BYTES AND   *                
      *                         ADD AMORT FOR GRANT/PREMIUM    *                
      * BP137219 FNP1 19022018  CATER FOR FSG GRANT            *                
      * BP138083 KR13 18012020  ADDED EHG                      *                
      * BP138560 FP6  29122020  ADDED LHG                      *                
      * BP138944 FP6  14102021  EXPAND F690 TO 800 BYTES AND   *                
      *                         ADDED SUG                      *                
      * ====================================================== *                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F120 ASSIGN  TO BP13F120.                                 
                                                                                
           SELECT BP13F690 ASSIGN  TO BP13F690.                                 
                                                                                
           SELECT P13F690A ASSIGN       TO P13F690A.                            
           SELECT P13F690B ASSIGN       TO P13F690B.                            
           SELECT P13F690C ASSIGN       TO P13F690C.                            
           SELECT SY02F001 ASSIGN       TO SY02F001.                            
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F120                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F120.                                                           
                                                                                
       FD  BP13F690                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 800 CHARACTERS                                       
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F690.                                                           
                                                                                
       FD  P13F690A                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       01  P13F690A-REC      PIC X(800).                                        
                                                                                
       FD  P13F690B                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       01  P13F690B-REC      PIC X(800).                                        
                                                                                
       FD  P13F690C                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       01  P13F690C-REC      PIC X(800).                                        
                                                                                
       COPY SY02F001.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
                                                                                
       01  WS-CURR-TIME.                                                        
           05  WS-HH                      PIC X(2)   VALUE SPACES.              
           05  WS-MM                      PIC X(2)   VALUE SPACES.              
           05  WS-SS                      PIC X(2)   VALUE SPACES.              
           05  WS-MS                      PIC X(2)   VALUE SPACES.              
                                                                                
       01  WS-TIME.                                                             
           05  WS-HH                      PIC X(2)   VALUE SPACES.              
           05  WS-MM                      PIC X(2)   VALUE SPACES.              
           05  WS-SS                      PIC X(2)   VALUE SPACES.              
                                                                                
       01  WS-EDITED-TIME.                                                      
           05  WS-SYS-TIME                PIC X(6)   VALUE SPACES.              
           05  WS-MICRO-SEC               PIC 9      VALUE 0.                   
                                                                                
       01  WS-ADJUST-TIME.                                                      
           05  WS-ADJ-TIME                PIC X(4)   VALUE SPACES.              
           05  WS-ADJ-MICRO-SEC           PIC 999    VALUE 0.                   
                                                                                
       01  WS-SEC-COUNT                   PIC 9      VALUE 0.                   
                                                                                
       01  WS-FILE-STATUS.                                                      
           05 F690-STATUS                 PIC 99     VALUE ZEROS.               
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-F690-READ                PIC 9(5)   VALUE ZEROS.               
           05 WS-F690A-WRITE              PIC 9(5)   VALUE ZEROS.               
           05 WS-F690B-WRITE              PIC 9(5)   VALUE ZEROS.               
           05 WS-F690C-WRITE              PIC 9(5)   VALUE ZEROS.               
           05 WS-F120-WRITE               PIC 9(5)    VALUE ZEROS.              
           05 WS-AMT-INCOME-MTH           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-INCOME-ACCUM       PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-LAST               PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SGP-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SGP-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SGP-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SPR-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SPR-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SPR-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-ELD-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-ELD-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-ELD-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-AHG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-AHG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-AHG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-EHG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-EHG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-EHG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-LHG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-LHG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-LHG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SHG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SHG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SHG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SRG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SRG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SRG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-REG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-REG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-REG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-FSG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-FSG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-FSG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SUG-MTH              PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SUG-ACCUM          PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMORT-SUG-LAST           PIC 9(6)V99 VALUE ZEROS.              
           05 WS-BALANCE                  PIC 9(6)V99 VALUE ZEROS.              
           05 WS-NUM-AMORT                PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-LAST           PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-SGP-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-SPR-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-ELD-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-AHG-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-EHG-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-LHG-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-SHG-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-SRG-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-REG-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-NUM-AMORT-SUG-LAST       PIC 9(3)    VALUE ZEROS.              
           05 WS-BK-TRANSFER              PIC S9(5)V9(2) VALUE +0.              
           05 WS-SEQ                      PIC 9(3)   VALUE ZEROS.               
           05 WS-F690-SURR                PIC 9(8)   VALUE ZEROS.               
           05 WS-F690-ISSUE               PIC 9(8)   VALUE ZEROS.               
           05 WS-DIFF-MON                 PIC 9(2)   VALUE ZEROES.              
           05 WS-AMT-INC-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SGP-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SPR-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-ELD-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-AHG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-EHG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-LHG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SHG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SRG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-REG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-FSG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-AMT-SUG-BACKDATE         PIC 9(6)V99 VALUE ZEROS.              
           05 WS-BACKDATE                 PIC X(1)    VALUE SPACES.             
                                                                                
       01  WS-SYS-DATE.                                                         
           05 WS-SYS-CC                PIC 99.                                  
           05 WS-SYS-YY                PIC 99.                                  
           05 WS-SYS-MM                PIC 99.                                  
           05 WS-SYS-DD                PIC 99.                                  
                                                                                
       01  WS-ISSUE-DATE.                                                       
           05 WS-ISSUE-YEAR              PIC 9(4)  VALUE ZEROES.                
           05 WS-ISSUE-MM                PIC 99    VALUE ZEROES.                
           05 WS-ISSUE-DD                PIC 99    VALUE ZEROES.                
                                                                                
       01  WS-SURR-DATE.                                                        
           05 WS-SURR-YEAR              PIC 9(4)  VALUE ZEROES.                 
           05 WS-SURR-MM                PIC 99    VALUE ZEROES.                 
           05 WS-SURR-DD                PIC 99    VALUE ZEROES.                 
                                                                                
       01  WS-DIFF1                      PIC 9(8) VALUE ZEROES.                 
       01  WS-DIFF2                      PIC 9(8) VALUE ZEROES.                 
       01  WS-DIFF3                      PIC 9(8) VALUE ZEROES.                 
                                                                                
       01  WS-DATE.                                                             
           05 WS-YEAR                    PIC 9(4) VALUE ZEROES.                 
           05 WS-MONTH                   PIC 99   VALUE ZEROES.                 
           05 WS-DAY                     PIC 99   VALUE ZEROES.                 
                                                                                
       01  WS-DATE1.                                                            
           05 WS-YEAR1                   PIC 9(4) VALUE ZEROES.                 
           05 WS-MONTH1                  PIC 99   VALUE ZEROES.                 
           05 WS-DAY1                    PIC 99   VALUE ZEROES.                 
                                                                                
       01  WS-TEMP-DATE                  PIC 9(8) VALUE ZEROES.                 
       01  WS-TEMP-DATE1                 PIC 9(8) VALUE ZEROES.                 
       01  WS-SURRENDER                  PIC X    VALUE SPACES.                 
       01  WS-LEASE-TENURE               PIC 9(2) VALUE ZEROES.                 
                                                                                
       01  WS-TEMP-DATE2.                                                       
           05 WS-TEMP-YEAR               PIC 9(4) VALUE ZEROES.                 
           05 WS-TEMP-MONTH              PIC 99   VALUE ZEROES.                 
           05 WS-TEMP-DAY                PIC 99   VALUE ZEROES.                 
                                                                                
       01  WS-DIFF-TEMP.                                                        
           05 WS-DIFF-YEAR               PIC 9(4) VALUE ZEROES.                 
           05 WS-DIFF-MONTH              PIC 99   VALUE ZEROES.                 
           05 WS-DIFF-DAY                PIC 99   VALUE ZEROES.                 
                                                                                
       01  WS-DIFF3-TEMP.                                                       
           05 WS-DIFF3-YEAR               PIC 9(4) VALUE ZEROES.                
           05 WS-DIFF3-MONTH              PIC 99   VALUE ZEROES.                
           05 WS-DIFF3-DAY                PIC 99   VALUE ZEROES.                
                                                                                
       01  WS-DATE-CCYYMM.                                                      
           05 WS-CCYYMM1.                                                       
              10 WS-CCYY1-NUM             PIC 9(04).                            
              10 WS-MM1-NUM               PIC 9(02).                            
           05 WS-CCYYMM2.                                                       
              10 WS-CCYY2-NUM             PIC 9(04).                            
              10 WS-MM2-NUM               PIC 9(02).                            
                                                                                
       01  WS-F690-EOF                   PIC X VALUE 'N'.                       
                                                                                
                                                                                
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
       000-MAIN-ROUTINE.                                                        
           PERFORM 100-INITIALIZATION THRU 100-EXIT.                            
           PERFORM 200-READ-F690      THRU 200-EXIT.                            
           PERFORM 300-PROCESS        THRU 300-EXIT                             
                   UNTIL WS-F690-EOF = 'Y'.                                     
           PERFORM 999-CLOSE-FILES    THRU 999-EXIT.                            
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
       100-INITIALIZATION.                                                      
                                                                                
           OPEN INPUT   BP13F690                                                
                        SY02F001                                                
                OUTPUT  BP13F120                                                
                        P13F690A                                                
                        P13F690B                                                
                        P13F690C.                                               
                                                                                
               IF F690-STATUS NOT = 0 AND 97                                    
                  DISPLAY 'OPENING ERROR, F690-STATUS ' F690-STATUS             
                  MOVE F690-STATUS TO RETURN-CODE                               
                  PERFORM 999-CLOSE-FILES THRU 999-EXIT                         
               END-IF.                                                          
                                                                                
              MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYS-DATE.                   
              PERFORM 110-READ-SY02      THRU 110-EXIT.                         
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
       110-READ-SY02.                                                           
           READ SY02F001 AT END                                                 
                 DISPLAY 'SY02F001 - SYSTEM DATE FILE IS EMPTY'                 
                 MOVE 99          TO RETURN-CODE                                
                 PERFORM 999-CLOSE-FILES THRU 999-EXIT                          
           END-READ.                                                            
                                                                                
       110-EXIT.                                                                
           EXIT.                                                                
                                                                                
       200-READ-F690.                                                           
           READ BP13F690 NEXT AT END                                            
                         MOVE 'Y' TO WS-F690-EOF                                
                         GO TO 200-EXIT.                                        
           ADD  1  TO WS-F690-READ.                                             
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       300-PROCESS.                                                             
                                                                                
           MOVE SPACES TO WS-BACKDATE.                                          
           PERFORM 340-INITIALIZE-FIELDS THRU 340-EXIT.                         
                                                                                
           IF F690-DTE-SURRENDER-COMPLETED = SPACES OR LOW-VALUES OR            
                                             ALL ' 0'                           
              IF F690-NUM-LEASE-TENURE IS NOT NUMERIC                           
                 MOVE ZEROS TO F690-NUM-LEASE-TENURE                            
              END-IF                                                            
              MOVE F690-NUM-LEASE-TENURE TO WS-LEASE-TENURE                     
              COMPUTE WS-NUM-AMORT = WS-LEASE-TENURE * 12                       
      *       IF F690-NUM-AMORT < 360                                           
              IF F690-NUM-AMORT < WS-NUM-AMORT                                  
                  PERFORM 350-COMPUTE-MTH-AMORT THRU 350-EXIT                   
                  PERFORM 400-WRITE-F690A    THRU 400-EXIT                      
                  PERFORM 500-F120-WRITE     THRU 500-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 200-READ-F690      THRU 200-EXIT.                            
                                                                                
       300-EXIT.                                                                
            EXIT.                                                               
                                                                                
       340-INITIALIZE-FIELDS.                                                   
                                                                                
           IF F690-AMT-SINGLES-PREMIUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-SINGLES-PREMIUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SGP-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-SGP-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SGP-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SGP-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SC-SPR-PREMIUM  NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-SC-SPR-PREMIUM                            
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SPR-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SPR-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SPR-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SPR-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-ELDERLY-PREMIUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-ELD-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-ELD-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-ELD-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-ELD-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-AHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-AHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-AHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-AHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-EHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-EHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-EHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-EHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-EHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-EHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-LHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-LHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-LHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-LHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-LHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-LHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-SHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SRG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-SRG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SRG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SRG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SRG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SRG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-REG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-REG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-REG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-REG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-REG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-REG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-FSG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-FSG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-FSG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-FSG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-FSG-LAST  NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-FSG-LAST                            
           END-IF.                                                              
                                                                                
           IF F690-AMT-SUG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-SUG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SUG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SUG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SUG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SUG-ACCUM                           
           END-IF.                                                              
                                                                                
       340-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       350-COMPUTE-MTH-AMORT.                                                   
                                                                                
           IF F690-AMT-AMORT-INCOME-MTH IS NOT NUMERIC                          
              MOVE ZEROS               TO F690-AMT-AMORT-INCOME-MTH             
                                          F690-NUM-AMORT                        
           END-IF.                                                              
                                                                                
           COMPUTE WS-NUM-AMORT-LAST = WS-NUM-AMORT - 1.                        
                                                                                
      *    IF F690-NUM-AMORT = 359                                              
           IF F690-NUM-AMORT = WS-NUM-AMORT-LAST                                
              COMPUTE WS-AMORT-LAST =                                           
                   F690-AMT-DEFER-INCOME - F690-AMT-AMORT-INCOME-ACCUM          
                                                                                
              MOVE WS-AMORT-LAST TO  F690-AMT-AMORT-INCOME-LAST                 
              MOVE WS-AMORT-LAST TO  F690-AMT-AMORT-INCOME-MTH                  
                                                                                
              ADD F690-AMT-AMORT-INCOME-LAST TO                                 
                                          F690-AMT-AMORT-INCOME-ACCUM           
              ADD 1 TO F690-NUM-AMORT                                           
              PERFORM 600-GET-AMORT-LAST-OTHER   THRU 600-EXIT                  
           ELSE                                                                 
           IF F690-AMT-AMORT-INCOME-MTH = ZEROES                                
              PERFORM 355-COMPUTE-BACKDATE THRU 355-EXIT                        
           ELSE                                                                 
              MOVE F690-AMT-AMORT-INCOME-MTH TO WS-AMORT-INCOME-ACCUM           
              COMPUTE F690-AMT-AMORT-INCOME-ACCUM =                             
                   WS-AMORT-INCOME-ACCUM + F690-AMT-AMORT-INCOME-ACCUM          
              ADD 1   TO F690-NUM-AMORT                                         
              PERFORM 700-COMPUTE-ACCUM-OTHER   THRU 700-EXIT                   
           END-IF                                                               
           END-IF.                                                              
                                                                                
       350-EXIT.                                                                
            EXIT.                                                               
                                                                                
       355-COMPUTE-BACKDATE.                                                    
      *    DIVIDE F690-AMT-DEFER-INCOME BY 360 GIVING                           
           DIVIDE F690-AMT-DEFER-INCOME BY WS-NUM-AMORT GIVING                  
                                        WS-AMT-INCOME-MTH                       
           MOVE WS-AMT-INCOME-MTH       TO F690-AMT-AMORT-INCOME-MTH            
                                                                                
           PERFORM 650-GET-AMORT-MTH-OTHER    THRU 650-EXIT                     
                                                                                
           MOVE F690-DTE-KEY-ISSUE(1:6) TO WS-CCYYMM1                           
           MOVE F001-DTE-CURRENT(1:6)   TO WS-CCYYMM2                           
           IF WS-CCYYMM1 < WS-CCYYMM2                                           
              IF WS-CCYY1-NUM = WS-CCYY2-NUM                                    
                 COMPUTE WS-DIFF-MON =                                          
                         (WS-MM2-NUM - WS-MM1-NUM) + 1                          
              ELSE                                                              
                 COMPUTE WS-DIFF-MON =                                          
                        ((WS-CCYY2-NUM * 12) + WS-MM2-NUM) -                    
                        ((WS-CCYY1-NUM * 12) + WS-MM1-NUM) + 1                  
              END-IF                                                            
              MOVE 'Y' TO F690-NUM-BACKDATE                                     
                          WS-BACKDATE                                           
              COMPUTE WS-AMT-INC-BACKDATE =                                     
                      WS-AMT-INCOME-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-INC-BACKDATE TO                                    
                      F690-AMT-AMORT-INCOME-ACCUM                               
                                                                                
              PERFORM 680-GET-BACKDATE-OTHER    THRU 680-EXIT                   
              ADD     WS-DIFF-MON  TO F690-NUM-AMORT                            
              MOVE    F001-DTE-CURRENT TO F690-DTE-CREATE                       
              WRITE P13F690B-REC FROM F690-REC                                  
              ADD 1 TO WS-F690B-WRITE                                           
           ELSE                                                                 
              MOVE WS-AMT-INCOME-MTH TO F690-AMT-AMORT-INCOME-ACCUM             
              PERFORM 690-GET-ACCUM-OTHER    THRU 690-EXIT                      
              ADD 1                TO F690-NUM-AMORT                            
              WRITE P13F690B-REC FROM F690-REC                                  
              ADD 1 TO WS-F690B-WRITE                                           
           END-IF.                                                              
                                                                                
       355-EXIT.                                                                
            EXIT.                                                               
                                                                                
       400-WRITE-F690A.                                                         
                                                                                
           WRITE P13F690A-REC FROM F690-REC.                                    
                                                                                
           ADD 1 TO WS-F690A-WRITE.                                             
       400-EXIT.                                                                
            EXIT.                                                               
                                                                                
       500-F120-WRITE.                                                          
           MOVE  SPACES             TO BP13F120-CASHTRAN.                       
                                                                                
           EVALUATE F690-NUM-AMORTISE-TRANS                                     
              WHEN 'S'                                                          
                IF F690-CDE-TYP-ACTUSE =  01                                    
                   MOVE  '27'               TO F120-CDE-TRANS-TYPE              
                   MOVE  'SA1'              TO F120-CDE-PAYMENT-TYPE            
                ELSE                                                            
                   IF F690-CDE-TYP-ACTUSE = 02                                  
                      MOVE  '28'            TO F120-CDE-TRANS-TYPE              
                      MOVE  'SA2'           TO F120-CDE-PAYMENT-TYPE            
                   END-IF                                                       
                END-IF                                                          
              WHEN 'F'                                                          
              WHEN 'L'                                                          
              WHEN 'H'                                                          
                MOVE '37'                   TO F120-CDE-TRANS-TYPE              
                MOVE 'VRL'                  TO F120-CDE-PAYMENT-TYPE            
           END-EVALUATE.                                                        
                                                                                
           IF WS-BACKDATE = 'Y'                                                 
              MOVE F690-AMT-AMORT-INCOME-ACCUM TO F120-AMT-RECEIPT              
           ELSE                                                                 
              MOVE  F690-AMT-AMORT-INCOME-MTH   TO F120-AMT-RECEIPT             
           END-IF.                                                              
                                                                                
           MOVE F690-CDE-TYP-ACTUSE TO F120-NUM-FLAT-TYPE-SA.                   
           MOVE F690-NUM-AMORTISE-TRANS TO F120-CDE-VALID.                      
           MOVE  'D'                TO F120-CDE-CRDR.                           
           MOVE  F690-NUM-REGN      TO F120-NUM-REGN.                           
           MOVE  F690-NUM-SCH-ACC   TO F120-NUM-SCH-ACCT.                       
           MOVE  F690-DTE-KEY-ISSUE TO F120-DTE-POST.                           
           MOVE  F690-DTE-KEY-ISSUE TO F120-DTE-TRANS.                          
           ADD   1                  TO WS-F120-WRITE.                           
           ADD  1                   TO WS-SEQ.                                  
           MOVE WS-SEQ              TO F120-COUNT-HISTORY.                      
           WRITE BP13F120-CASHTRAN.                                             
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
       600-GET-AMORT-LAST-OTHER.                                                
                                                                                
           IF F690-AMT-SINGLES-PREMIUM NOT = ZEROES                             
              COMPUTE WS-AMORT-SGP-LAST =                                       
                   F690-AMT-SINGLES-PREMIUM - F690-AMT-AMORT-SGP-ACCUM          
                                                                                
              MOVE WS-AMORT-SGP-LAST TO  F690-AMT-AMORT-SGP-LAST                
              MOVE WS-AMORT-SGP-LAST TO  F690-AMT-AMORT-SGP-MTH                 
                                                                                
              ADD F690-AMT-AMORT-SGP-LAST    TO                                 
                                          F690-AMT-AMORT-SGP-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-SC-SPR-PREMIUM  NOT = ZEROES                             
              COMPUTE WS-AMORT-SPR-LAST =                                       
                   F690-AMT-SC-SPR-PREMIUM  - F690-AMT-AMORT-SPR-ACCUM          
                                                                                
              MOVE WS-AMORT-SPR-LAST TO  F690-AMT-AMORT-SPR-LAST                
              MOVE WS-AMORT-SPR-LAST TO  F690-AMT-AMORT-SPR-MTH                 
                                                                                
              ADD F690-AMT-AMORT-SPR-LAST    TO                                 
                                          F690-AMT-AMORT-SPR-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM NOT = ZEROES                             
              COMPUTE WS-AMORT-ELD-LAST =                                       
                   F690-AMT-ELDERLY-PREMIUM - F690-AMT-AMORT-ELD-ACCUM          
                                                                                
              MOVE WS-AMORT-ELD-LAST TO  F690-AMT-AMORT-ELD-LAST                
              MOVE WS-AMORT-ELD-LAST TO  F690-AMT-AMORT-ELD-MTH                 
                                                                                
              ADD F690-AMT-AMORT-ELD-LAST    TO                                 
                                          F690-AMT-AMORT-ELD-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM NOT = ZEROES                             
              COMPUTE WS-AMORT-ELD-LAST =                                       
                   F690-AMT-ELDERLY-PREMIUM - F690-AMT-AMORT-ELD-ACCUM          
                                                                                
              MOVE WS-AMORT-ELD-LAST TO  F690-AMT-AMORT-ELD-LAST                
              MOVE WS-AMORT-ELD-LAST TO  F690-AMT-AMORT-ELD-MTH                 
                                                                                
              ADD F690-AMT-AMORT-ELD-LAST    TO                                 
                                          F690-AMT-AMORT-ELD-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-AHG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-AHG-LAST =                                       
                   F690-AMT-AHG-GRANT - F690-AMT-AMORT-AHG-ACCUM                
                                                                                
              MOVE WS-AMORT-AHG-LAST TO  F690-AMT-AMORT-AHG-LAST                
              MOVE WS-AMORT-AHG-LAST TO  F690-AMT-AMORT-AHG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-AHG-LAST    TO                                 
                                          F690-AMT-AMORT-AHG-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-EHG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-EHG-LAST =                                       
                   F690-AMT-EHG-GRANT - F690-AMT-AMORT-EHG-ACCUM                
                                                                                
              MOVE WS-AMORT-EHG-LAST TO  F690-AMT-AMORT-EHG-LAST                
              MOVE WS-AMORT-EHG-LAST TO  F690-AMT-AMORT-EHG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-EHG-LAST    TO                                 
                                          F690-AMT-AMORT-EHG-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-LHG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-LHG-LAST =                                       
                   F690-AMT-LHG-GRANT - F690-AMT-AMORT-LHG-ACCUM                
                                                                                
              MOVE WS-AMORT-LHG-LAST TO  F690-AMT-AMORT-LHG-LAST                
              MOVE WS-AMORT-LHG-LAST TO  F690-AMT-AMORT-LHG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-LHG-LAST    TO                                 
                                          F690-AMT-AMORT-LHG-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-SHG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-SHG-LAST =                                       
                   F690-AMT-SHG-GRANT - F690-AMT-AMORT-SHG-ACCUM                
                                                                                
              MOVE WS-AMORT-SHG-LAST TO  F690-AMT-AMORT-SHG-LAST                
              MOVE WS-AMORT-SHG-LAST TO  F690-AMT-AMORT-SHG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-SHG-LAST    TO                                 
                                          F690-AMT-AMORT-SHG-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-SRG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-SRG-LAST =                                       
                   F690-AMT-SRG-GRANT - F690-AMT-AMORT-SRG-ACCUM                
                                                                                
              MOVE WS-AMORT-SRG-LAST TO  F690-AMT-AMORT-SRG-LAST                
              MOVE WS-AMORT-SRG-LAST TO  F690-AMT-AMORT-SRG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-SRG-LAST    TO                                 
                                          F690-AMT-AMORT-SRG-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-REG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-REG-LAST =                                       
                   F690-AMT-REG-GRANT - F690-AMT-AMORT-REG-ACCUM                
                                                                                
              MOVE WS-AMORT-REG-LAST TO  F690-AMT-AMORT-REG-LAST                
              MOVE WS-AMORT-REG-LAST TO  F690-AMT-AMORT-REG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-REG-LAST    TO                                 
                                          F690-AMT-AMORT-REG-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-FSG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-FSG-LAST =                                       
                   F690-AMT-FSG-GRANT - F690-AMT-AMORT-FSG-ACCUM                
                                                                                
              MOVE WS-AMORT-FSG-LAST TO  F690-AMT-AMORT-FSG-LAST                
              MOVE WS-AMORT-FSG-LAST TO  F690-AMT-AMORT-FSG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-FSG-LAST    TO                                 
                                          F690-AMT-AMORT-FSG-ACCUM              
           END-IF.                                                              
                                                                                
           IF F690-AMT-SUG-GRANT       NOT = ZEROES                             
              COMPUTE WS-AMORT-SUG-LAST =                                       
                   F690-AMT-SUG-GRANT - F690-AMT-AMORT-SUG-ACCUM                
                                                                                
              MOVE WS-AMORT-SUG-LAST TO  F690-AMT-AMORT-SUG-LAST                
              MOVE WS-AMORT-SUG-LAST TO  F690-AMT-AMORT-SUG-MTH                 
                                                                                
              ADD F690-AMT-AMORT-SUG-LAST    TO                                 
                                          F690-AMT-AMORT-SUG-ACCUM              
           END-IF.                                                              
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
       650-GET-AMORT-MTH-OTHER.                                                 
                                                                                
           IF F690-AMT-SINGLES-PREMIUM NOT = ZEROES                             
              DIVIDE F690-AMT-SINGLES-PREMIUM BY WS-NUM-AMORT GIVING            
                                        WS-AMT-SGP-MTH                          
              MOVE WS-AMT-SGP-MTH       TO F690-AMT-AMORT-SGP-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-SC-SPR-PREMIUM NOT = ZEROES                              
              DIVIDE F690-AMT-SC-SPR-PREMIUM  BY WS-NUM-AMORT GIVING            
                                        WS-AMT-SPR-MTH                          
              MOVE WS-AMT-SPR-MTH       TO F690-AMT-AMORT-SPR-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM NOT = ZEROES                             
              DIVIDE F690-AMT-ELDERLY-PREMIUM  BY WS-NUM-AMORT GIVING           
                                        WS-AMT-ELD-MTH                          
              MOVE WS-AMT-ELD-MTH       TO F690-AMT-AMORT-ELD-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-AHG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-AHG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-AHG-MTH                          
              MOVE WS-AMT-AHG-MTH       TO F690-AMT-AMORT-AHG-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-EHG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-EHG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-EHG-MTH                          
              MOVE WS-AMT-EHG-MTH       TO F690-AMT-AMORT-EHG-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-LHG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-LHG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-LHG-MTH                          
              MOVE WS-AMT-LHG-MTH       TO F690-AMT-AMORT-LHG-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-SHG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-SHG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-SHG-MTH                          
              MOVE WS-AMT-SHG-MTH       TO F690-AMT-AMORT-SHG-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-SRG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-SRG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-SRG-MTH                          
              MOVE WS-AMT-SRG-MTH       TO F690-AMT-AMORT-SRG-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-REG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-REG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-REG-MTH                          
              MOVE WS-AMT-REG-MTH       TO F690-AMT-AMORT-REG-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-FSG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-FSG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-FSG-MTH                          
              MOVE WS-AMT-FSG-MTH       TO F690-AMT-AMORT-FSG-MTH               
           END-IF.                                                              
                                                                                
           IF F690-AMT-SUG-GRANT       NOT = ZEROES                             
              DIVIDE F690-AMT-SUG-GRANT        BY WS-NUM-AMORT GIVING           
                                        WS-AMT-SUG-MTH                          
              MOVE WS-AMT-SUG-MTH       TO F690-AMT-AMORT-SUG-MTH               
           END-IF.                                                              
                                                                                
       650-EXIT.                                                                
           EXIT.                                                                
                                                                                
       680-GET-BACKDATE-OTHER.                                                  
                                                                                
           IF F690-AMT-SINGLES-PREMIUM NOT = ZEROES                             
              COMPUTE WS-AMT-SGP-BACKDATE =                                     
                         WS-AMT-SGP-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-SGP-BACKDATE TO F690-AMT-AMORT-SGP-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SC-SPR-PREMIUM  NOT = ZEROES                             
              COMPUTE WS-AMT-SPR-BACKDATE =                                     
                         WS-AMT-SPR-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-SPR-BACKDATE TO F690-AMT-AMORT-SPR-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM  NOT = ZEROES                            
              COMPUTE WS-AMT-ELD-BACKDATE =                                     
                         WS-AMT-ELD-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-ELD-BACKDATE TO F690-AMT-AMORT-ELD-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AHG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-AHG-BACKDATE =                                     
                         WS-AMT-AHG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-AHG-BACKDATE TO F690-AMT-AMORT-AHG-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-EHG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-EHG-BACKDATE =                                     
                         WS-AMT-EHG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-EHG-BACKDATE TO F690-AMT-AMORT-EHG-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-LHG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-LHG-BACKDATE =                                     
                         WS-AMT-LHG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-LHG-BACKDATE TO F690-AMT-AMORT-LHG-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SHG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-SHG-BACKDATE =                                     
                         WS-AMT-SHG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-SHG-BACKDATE TO F690-AMT-AMORT-SHG-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SRG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-SRG-BACKDATE =                                     
                         WS-AMT-SRG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-SRG-BACKDATE TO F690-AMT-AMORT-SRG-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-REG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-REG-BACKDATE =                                     
                         WS-AMT-REG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-REG-BACKDATE TO F690-AMT-AMORT-REG-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-FSG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-FSG-BACKDATE =                                     
                         WS-AMT-FSG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-FSG-BACKDATE TO F690-AMT-AMORT-FSG-ACCUM           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SUG-GRANT        NOT = ZEROES                            
              COMPUTE WS-AMT-SUG-BACKDATE =                                     
                         WS-AMT-SUG-MTH * WS-DIFF-MON                           
              ADD     WS-AMT-SUG-BACKDATE TO F690-AMT-AMORT-SUG-ACCUM           
           END-IF.                                                              
                                                                                
       680-EXIT.                                                                
           EXIT.                                                                
                                                                                
       690-GET-ACCUM-OTHER.                                                     
                                                                                
           IF F690-AMT-SINGLES-PREMIUM NOT = ZEROES                             
              MOVE WS-AMT-SGP-MTH    TO F690-AMT-AMORT-SGP-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM NOT = ZEROES                             
              MOVE WS-AMT-ELD-MTH    TO F690-AMT-AMORT-ELD-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SC-SPR-PREMIUM NOT = ZEROES                              
              MOVE WS-AMT-SPR-MTH    TO F690-AMT-AMORT-SPR-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-AHG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-AHG-MTH    TO F690-AMT-AMORT-AHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-EHG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-EHG-MTH    TO F690-AMT-AMORT-EHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-LHG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-LHG-MTH    TO F690-AMT-AMORT-LHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SHG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-SHG-MTH    TO F690-AMT-AMORT-SHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SRG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-SRG-MTH    TO F690-AMT-AMORT-SRG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-REG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-REG-MTH    TO F690-AMT-AMORT-REG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-FSG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-FSG-MTH    TO F690-AMT-AMORT-FSG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SUG-GRANT      NOT = ZEROES                              
              MOVE WS-AMT-SUG-MTH    TO F690-AMT-AMORT-SUG-ACCUM                
           END-IF.                                                              
                                                                                
       690-EXIT.                                                                
           EXIT.                                                                
                                                                                
       700-COMPUTE-ACCUM-OTHER.                                                 
                                                                                
           IF F690-AMT-SINGLES-PREMIUM NOT = ZEROES                             
              MOVE F690-AMT-AMORT-SGP-MTH    TO WS-AMORT-SGP-ACCUM              
              COMPUTE F690-AMT-AMORT-SGP-ACCUM    =                             
                   WS-AMORT-SGP-ACCUM + F690-AMT-AMORT-SGP-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM NOT = ZEROES                             
              MOVE F690-AMT-AMORT-ELD-MTH    TO WS-AMORT-ELD-ACCUM              
              COMPUTE F690-AMT-AMORT-ELD-ACCUM    =                             
                   WS-AMORT-ELD-ACCUM + F690-AMT-AMORT-ELD-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SC-SPR-PREMIUM NOT = ZEROES                              
              MOVE F690-AMT-AMORT-SPR-MTH    TO WS-AMORT-SPR-ACCUM              
              COMPUTE F690-AMT-AMORT-SPR-ACCUM    =                             
                   WS-AMORT-SPR-ACCUM + F690-AMT-AMORT-SPR-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-AHG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-AHG-MTH    TO WS-AMORT-AHG-ACCUM              
              COMPUTE F690-AMT-AMORT-AHG-ACCUM    =                             
                   WS-AMORT-AHG-ACCUM + F690-AMT-AMORT-AHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-EHG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-EHG-MTH    TO WS-AMORT-EHG-ACCUM              
              COMPUTE F690-AMT-AMORT-EHG-ACCUM    =                             
                   WS-AMORT-EHG-ACCUM + F690-AMT-AMORT-EHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-LHG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-LHG-MTH    TO WS-AMORT-LHG-ACCUM              
              COMPUTE F690-AMT-AMORT-LHG-ACCUM    =                             
                   WS-AMORT-LHG-ACCUM + F690-AMT-AMORT-LHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SHG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-SHG-MTH    TO WS-AMORT-SHG-ACCUM              
              COMPUTE F690-AMT-AMORT-SHG-ACCUM    =                             
                   WS-AMORT-SHG-ACCUM + F690-AMT-AMORT-SHG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SRG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-SRG-MTH    TO WS-AMORT-SRG-ACCUM              
              COMPUTE F690-AMT-AMORT-SRG-ACCUM    =                             
                   WS-AMORT-SRG-ACCUM + F690-AMT-AMORT-SRG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-REG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-REG-MTH    TO WS-AMORT-REG-ACCUM              
              COMPUTE F690-AMT-AMORT-REG-ACCUM    =                             
                   WS-AMORT-REG-ACCUM + F690-AMT-AMORT-REG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-FSG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-FSG-MTH    TO WS-AMORT-FSG-ACCUM              
              COMPUTE F690-AMT-AMORT-FSG-ACCUM    =                             
                   WS-AMORT-FSG-ACCUM + F690-AMT-AMORT-FSG-ACCUM                
           END-IF.                                                              
                                                                                
           IF F690-AMT-SUG-GRANT      NOT = ZEROES                              
              MOVE F690-AMT-AMORT-SUG-MTH    TO WS-AMORT-SUG-ACCUM              
              COMPUTE F690-AMT-AMORT-SUG-ACCUM    =                             
                   WS-AMORT-SUG-ACCUM + F690-AMT-AMORT-SUG-ACCUM                
           END-IF.                                                              
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
       999-CLOSE-FILES.                                                         
           CLOSE BP13F690                                                       
                 BP13F120                                                       
                 P13F690A                                                       
                 P13F690B                                                       
                 P13F690C.                                                      
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '*================ BP13C394 ================*'.              
           DISPLAY '    NO. OF F690  READ           = ' WS-F690-READ.           
           DISPLAY '    NO. OF F690A WRITE          = ' WS-F690A-WRITE.         
           DISPLAY '    NO. OF F690B WRITE          = ' WS-F690B-WRITE.         
           DISPLAY '    NO. OF F690C WRITE          = ' WS-F690C-WRITE.         
           DISPLAY '    NO. OF F120  WRITE          = ' WS-F120-WRITE.          
           DISPLAY '*==========================================*'.              
                                                                                
           STOP RUN.                                                            
                                                                                
        999-EXIT.                                                               
            EXIT.                                                               
                                                                                
