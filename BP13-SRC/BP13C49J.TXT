       IDENTIFICATION DIVISION.                                         00010006
       PROGRAM-ID.    BP13C49J.                                         00020006
      *AUTHOR.        KAVYA VAKA.                                       00030006
      *DATE-WRITTEN.  JUNE 03 2020.                                     00040006
      * ============================================================    00050006
      * SYSTEM OF COMMITMENT (SOC)                                      00060006
      * ============================================================    00070006
      * OBJECTIVE  - PRINT LETTERS ON NOTIFICATION OF                   00080006
      *              REVISED COMPLETION DATE - 6 MONTHS DELAY           00090006
      *                                                                 00100006
      * FORM USED  BP1310                                               00110006
      *                                                                 00120006
      * INPUT FILES:  BM06F110                                          00130006
      *               BP13K022                                          00140006
      *               BP13K024                                          00150006
      *               BP13K800                                          00160006
      *               BP13K820                                          00170006
      *               BP13K830                                          00180006
      *               BM06K100                                          00190006
      *               BM06K510                                          00200006
      *               BP13K857                                          00210006
      *        I-O    BP13K491                                          00220006
      *               BP13F491                                          00230006
      * REPORT:       BP13L49J                                          00240006
      *               BP13P491                                          00250006
      * ------------------------------------------------------------    00260006
      * REF NO    DATE  BY  DESCRIPTIONS                                00270006
      * -------- ------ --- ------------                                00280006
      * BP138337 030620 KV5  NEW PGM                                    00290006
      * BP138337 240620 KV5  WRITE F491                                 00300006
      * BP138337 260620 KAC1 TO INIT P491-LINE05C                       00310006
      * BP138337 290620 KV5  COMMENTED THE MAIL REPORTS                 00320006
      * BP138392 230720 KTM3 HARDCODE DATE 24/07/2020                   00330006
      * BP138392 240720 KTM3 REMOVE HARDCODED DATE                      00340006
      * BP138408 120820 KV5  COMMENTED 12/08/2020 ADDED FILLER TO       00350006
      *                      POSTAL                                     00360006
      * BP138379 140820 KV5  HARDCODE PCD DATE FOR 3402543F             00370006
      * BP138432 310820 KTM3 HARDCODE PCD DATE FOR 1555311A             00371006
      * BP138432 220920 KTM3 HARDCODE PCD DATE FOR 3467568F             00371106
      * ============================================================    00372006
                                                                        00373006
       ENVIRONMENT DIVISION.                                            00374006
       CONFIGURATION SECTION.                                           00375006
       SOURCE-COMPUTER. IBM-3090.                                       00376006
       OBJECT-COMPUTER. IBM-3090.                                       00377006
       INPUT-OUTPUT SECTION.                                            00378006
       FILE-CONTROL.                                                    00379006
                                                                        00380006
           SELECT BP13K022  ASSIGN       TO BP13K022                    00390006
                            ACCESS MODE  IS RANDOM                      00400006
                            ORGANIZATION IS INDEXED                     00410006
                            RECORD KEY   IS K022-KEY-FLD                00420006
                            ALTERNATE RECORD KEY IS K022-NUM-REGN       00430006
                            WITH DUPLICATES                             00440006
                            FILE STATUS  IS K022-STATUS.                00450006
                                                                        00460006
           SELECT BP13K024  ASSIGN       TO BP13K024                    00470006
                            ACCESS MODE  IS RANDOM                      00480006
                            ORGANIZATION IS INDEXED                     00490006
                            RECORD KEY   IS K024-KEY-FLD                00500006
                            FILE STATUS  IS K024-STATUS.                00510006
                                                                        00520006
           SELECT BP13K800 ASSIGN        TO BP13K800                    00530006
                           ORGANIZATION  IS INDEXED                     00540006
                           ACCESS MODE   IS RANDOM                      00550006
                           RECORD KEY    IS K800-NUM-REGN               00560006
                           FILE STATUS   IS K800-STATUS.                00570006
                                                                        00580006
           SELECT BP13K820 ASSIGN        TO BP13K820                    00590006
                           ORGANIZATION  IS INDEXED                     00600006
                           ACCESS MODE   IS RANDOM                      00610006
                           RECORD KEY    IS K820-KEY-FLD                00620006
                           FILE STATUS   IS K820-STATUS.                00630006
                                                                        00640006
           SELECT BP13K830 ASSIGN        TO BP13K830                    00650006
                           ORGANIZATION  IS INDEXED                     00660006
                           ACCESS MODE   IS RANDOM                      00670006
                           RECORD KEY    IS K830-KEY-FLD                00680006
                           ALTERNATE KEY IS K830-NUM-REGN               00690006
                           FILE STATUS   IS K830-STATUS.                00700006
                                                                        00710006
           SELECT BP13K857 ASSIGN        TO BP13K857                    00720006
                           ORGANIZATION  IS INDEXED                     00730006
                           ACCESS MODE   IS RANDOM                      00740006
                           RECORD KEY    IS K857-KEY-FLD                00750006
                           FILE STATUS   IS K857-STATUS.                00760006
           SELECT BM06K510 ASSIGN        TO BM06K510                    00770006
                           ORGANIZATION  IS INDEXED                     00780006
                           ACCESS MODE   IS RANDOM                      00790006
                           RECORD KEY    IS K510-ESTCDE                 00800006
                           FILE STATUS   IS K510-STATUS.                00810006
                                                                        00820006
           SELECT BP13K491 ASSIGN       TO BP13K491                     00830006
                           ORGANIZATION  IS INDEXED                     00840006
                           ACCESS MODE   IS RANDOM                      00850006
                           RECORD KEY    IS K491-KEY-FLD                00860006
                           FILE STATUS   IS K491-STATUS.                00870006
                                                                        00880006
           SELECT BM06K100 ASSIGN        TO BM06K100                    00890006
                           ORGANIZATION  IS INDEXED                     00900006
                           ACCESS MODE   IS RANDOM                      00910006
                           RECORD KEY    IS K100-KEY-FLD                00920006
                           FILE STATUS   IS K100-STATUS.                00930006
                                                                        00940006
           SELECT BP13F491 ASSIGN       TO BP13F491.                    00950006
           SELECT BP13L49J ASSIGN       TO BP13L49J.                    00960006
           SELECT BP13P491 ASSIGN       TO BP13P491.                    00970006
           SELECT BM06F110 ASSIGN       TO BM06F110.                    00980006
                                                                        00990006
                                                                        01000006
       DATA DIVISION.                                                   01010006
       FILE SECTION.                                                    01020006
      *-------------------------------------------------------------    01030006
       FD   BP13K022                                                    01040006
            RECORD CONTAINS 100 CHARACTERS.                             01050006
       COPY BP13K022.                                                   01060006
                                                                        01070006
       FD   BP13K024                                                    01080006
            RECORD CONTAINS 100 CHARACTERS.                             01090006
       COPY BP13K024.                                                   01100006
                                                                        01110006
       FD   BP13K800                                                    01120006
            RECORD CONTAINS 2000 CHARACTERS.                            01130006
       COPY BP13K800.                                                   01140006
                                                                        01150006
       FD   BP13K820                                                    01160006
            RECORD CONTAINS 400 CHARACTERS.                             01170006
       COPY BP13K820.                                                   01180006
                                                                        01190006
       FD   BP13K830                                                    01200006
            RECORD CONTAINS 250 CHARACTERS.                             01210006
       COPY BP13K830.                                                   01220006
                                                                        01230006
       FD   BP13K857                                                    01240006
            RECORD CONTAINS 200 CHARACTERS.                             01250006
       COPY BP13K857.                                                   01260006
                                                                        01270006
       FD   BP13K491                                                    01280006
            RECORD CONTAINS 200 CHARACTERS.                             01290006
       COPY BP13K491.                                                   01300006
                                                                        01310006
       FD   BM06K510                                                    01320006
            RECORD CONTAINS 60 CHARACTERS.                              01330006
       COPY BM06K510.                                                   01340006
                                                                        01350006
       FD   BM06K100                                                    01360006
            RECORD CONTAINS 500 CHARACTERS.                             01370006
       COPY BM06K100.                                                   01380006
                                                                        01390006
       FD   BM06F110                                                    01400006
            RECORDING MODE IS F                                         01410006
            RECORD CONTAINS 500 CHARACTERS                              01420006
            BLOCK  CONTAINS 0   RECORDS.                                01430006
       COPY BM06F110.                                                   01440006
                                                                        01450006
       FD   BP13F491                                                    01460006
            RECORDING MODE IS F                                         01470006
            RECORD CONTAINS 200 CHARACTERS                              01480006
            BLOCK  CONTAINS 0   RECORDS.                                01490006
       COPY BP13F491.                                                   01500006
                                                                        01510006
       FD   BP13L49J           RECORDING MODE IS F                      01520006
                               RECORD CONTAINS 132 CHARACTERS           01530006
                               BLOCK  CONTAINS 0   RECORDS.             01540006
       01   L49J-PRTREC        PIC X(132).                              01550006
                                                                        01560006
       FD   BP13P491           RECORDING MODE IS F                      01570006
                               RECORD CONTAINS 100 CHARACTERS           01580006
                               BLOCK  CONTAINS 0   RECORDS.             01590006
       01   P491-PRTREC        PIC X(100).                              01600006
                                                                        01610006
       WORKING-STORAGE SECTION.                                         01620006
       01  K022-STATUS                   PIC 99    VALUE 0.             01630006
       01  K024-STATUS                   PIC 99    VALUE 0.             01640006
       01  K800-STATUS                   PIC 99    VALUE 0.             01650006
       01  K820-STATUS                   PIC 99    VALUE 0.             01660006
       01  K830-STATUS                   PIC 99    VALUE 0.             01670006
       01  K510-STATUS                   PIC 99    VALUE 0.             01680006
       01  K100-STATUS                   PIC 99    VALUE 0.             01690006
       01  K857-STATUS                   PIC 99    VALUE 0.             01700006
       01  K491-STATUS                   PIC 99    VALUE 0.             01710006
       01  WS-F110-EOF                   PIC X     VALUE 'N'.           01720006
       01  WS-F491-EOF                   PIC X     VALUE 'N'.           01730006
       01  WS-FOUND-K857                 PIC X     VALUE 'N'.           01740006
       01  WS-F491-FND                   PIC X     VALUE 'N'.           01750006
       01  WS-FOUND-K491                 PIC X     VALUE 'N'.           01760006
                                                                        01770006
       01  WS-OCCUPANTS.                                                01780006
           05  WS-NAME      OCCURS 4 TIMES   PIC X(66).                 01790006
                                                                        01800006
       01  WS-DATE                       PIC X(8)  VALUE SPACES.        01810006
       01  WS-MONTH                      PIC X(3)  VALUE SPACES.        01820006
       01  WS-QUARTER                    PIC X(11) VALUE SPACES.        01830006
       01  WS-YEAR                       PIC 9(4).                      01840006
       01  WS-NAME-EMAIL                 PIC X(66).                     01850006
                                                                        01860006
       01  WS-PREV-BLK-NO                PIC X(5).                      01870006
       01  WS-OCCP-PTR                   PIC 9(2).                      01880006
       01  WS-SQL-CODE                   PIC 9(4).                      01890006
                                                                        01900006
       01  WS-STOP                       PIC X(1)  VALUE SPACES.        01910006
       01  WS-PROCESS                    PIC X(1)  VALUE SPACES.        01920006
       01  WS-TEMP-PCD                   PIC X(15) VALUE SPACES.        01930006
       01  WS-TEMP-PCD-A                 PIC X(15) VALUE SPACES.        01940006
       01  WS-HP                         PIC X(08) VALUE SPACES.        01950006
       01  WS-A                          PIC 9(02) VALUE ZEROS.         01960006
       01  WS-B                          PIC 9(02) VALUE ZEROS.         01970006
       01  WS-C                          PIC 9(02) VALUE ZEROS.         01980006
       01  WS-D                          PIC 9(02) VALUE ZEROS.         01990006
                                                                        02000006
       01  WS-CL49J-HEADER               PIC X(132) VALUE SPACES.       02010006
       01  WS-DTE-TME.                                                  02020006
           05 WS-DTE                     PIC X(08) VALUE SPACES.        02030006
       01  WS-COUNTERS.                                                 02040006
           05 WS-CNT-F110-READ           PIC 9(7)  VALUE 0.             02050006
           05 WS-CNT-LETTER              PIC 9(7)  VALUE 0.             02060006
           05 WS-CNT-K800-MISS           PIC 9(7)  VALUE 0.             02070006
           05 WS-CNT-K820-MISS           PIC 9(7)  VALUE 0.             02080006
           05 WS-CNT-K830-MISS           PIC 9(7)  VALUE 0.             02090006
           05 WS-CNT-K510-MISS           PIC 9(7)  VALUE 0.             02100006
           05 WS-CNT-K100-MISS           PIC 9(7)  VALUE 0.             02110006
           05 WS-CNT-K857-W-EMAIL        PIC 9(7)  VALUE 0.             02120006
           05 WS-CNTR                    PIC X(1)  VALUE 'N'.           02130006
           05 WS-IDX                     PIC 9(2)  VALUE 0.             02140006
           05 WS-CNT                     PIC 9(2)  VALUE 0.             02150006
           05 CTR                        PIC 9(2)  VALUE 0.             02160006
           05 WS-BLK-CNT                 PIC 9(7)  VALUE 0.             02170006
           05 WS-TOTAL-CNT               PIC 9(7)  VALUE 0.             02180006
           05 WS-TOTAL-CNT-A             PIC 9(7)  VALUE 0.             02190006
           05 WS-LINE-CNT                PIC 9(7)  VALUE 0.             02200006
           05 WS-PAGE-CNT                PIC 9(7)  VALUE 0.             02210006
           05 WS-LINE-CNT-A              PIC 9(7)  VALUE 0.             02220006
           05 WS-PAGE-CNT-A              PIC 9(7)  VALUE 0.             02230006
           05 WS-F491-WRT                PIC 9(7)  VALUE 0.             02240006
           05 WS-F491-REWRITE            PIC 9(7)  VALUE 0.             02250006
           05 WS-L49J-WRT                PIC 9(7)  VALUE 0.             02260006
           05 WS-P491-WRT                PIC 9(7)  VALUE 0.             02270006
           05 WS-F859-WRT                PIC 9(7)  VALUE 0.             02280006
           05 WS-BP13FY-CTR              PIC 9(6)  VALUE ZEROS.         02290006
           05 WS-RECORD-CNT              PIC ZZZ9.                      02300006
                                                                        02310006
           05 WS-ERROR-FL                PIC X(1) VALUE 'N'.            02320006
              88 WS-NO-ERROR             VALUE 'N'.                     02330006
              88 WS-ERROR                VALUE 'Y'.                     02340006
                                                                        02350006
       01  WS-TEMP-MONTH                 PIC X(45) VALUE SPACES.        02360006
       01  WS-TEMP-SPACE                 PIC X(22) VALUE                02370006
                                         'Update on Progress of '.      02380006
       01  WS-TEMP-SPACE1                PIC X(10) VALUE SPACES.        02390006
       01  WS-TEMP-SPACE3                PIC X(29) VALUE SPACES.        02400006
       01  WS-TEMP-ADDRESS1              PIC X(85) VALUE SPACES.        02410006
       01  WS-TEMP-ADDRESS2              PIC X(85) VALUE SPACES.        02420006
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                               02430006
           05 FILLER                   PIC X(06) VALUE                  02440006
             '01 JAN'.                                                  02450006
           05 FILLER                   PIC X(06) VALUE                  02460006
             '02 FEB'.                                                  02470006
           05 FILLER                   PIC X(06) VALUE                  02480006
             '03 MAR'.                                                  02490006
           05 FILLER                   PIC X(06) VALUE                  02500006
             '04 APR'.                                                  02510006
           05 FILLER                   PIC X(06) VALUE                  02520006
             '05 MAY'.                                                  02530006
           05 FILLER                   PIC X(06) VALUE                  02540006
             '06 JUN'.                                                  02550006
           05 FILLER                   PIC X(06) VALUE                  02560006
             '07 JUL'.                                                  02570006
           05 FILLER                   PIC X(06) VALUE                  02580006
             '08 AUG'.                                                  02590006
           05 FILLER                   PIC X(06) VALUE                  02600006
             '09 SEP'.                                                  02610006
           05 FILLER                   PIC X(06) VALUE                  02620006
             '10 OCT'.                                                  02630006
           05 FILLER                   PIC X(06) VALUE                  02640006
             '11 NOV'.                                                  02650006
           05 FILLER                   PIC X(06) VALUE                  02660006
             '12 DEC'.                                                  02670006
       01  FILLER  REDEFINES  WS-MONTHS-IN-DIGITS-AND-WORDS.            02680006
           05 WS-MONTH-TABLE               OCCURS 12                    02690006
                                           INDEXED BY WS-MTH-IND.       02700006
              10 WS-MONTH-IN-DIGITS    PIC X(02).                       02710006
              10 FILLER                PIC X(01).                       02720006
              10 WS-MONTH-IN-WORDS     PIC X(03).                       02730006
                                                                        02740006
                                                                        02750006
       01 WS-REPORT-FIELDS.                                             02760006
           05  WS-DATE-RPT-DTL.                                         02770006
               10 FILLER                PIC X(6)  VALUE 'DATE: '.       02780006
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.         02790006
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'. 02800006
           05  WS-MAIL-RPT2             PIC X(27)                       02810006
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                        02820006
      *    05  WS-MAIL-RPT3             PIC X(40)                       02830006
      *        VALUE 'RCPT TO:<PATRICIA_SS_CHIN@HDB.GOV.SG>'.           02840006
      *    05  WS-MAIL-RPT4             PIC X(40)                       02850006
      *        VALUE 'RCPT TO:<VIVIAN_LP_CHIA@HDB.GOV.SG>'.             02860006
      *    05  WS-MAIL-RPT4A            PIC X(40)                       02870006
      *        VALUE 'RCPT TO:<TAN_TSIN_GIAP@HDB.GOV.SG>'.              02880006
      *    05  WS-MAIL-RPT4B            PIC X(40)                       02890006
      *        VALUE 'RCPT TO:<TEH_SHIJIN@HDB.GOV.SG>'.                 02900006
      *    05  WS-MAIL-RPT9             PIC X(4)                        02910006
      *        VALUE 'DATA'.                                            02920006
      *    05  WS-MAIL-RPT10            PIC X(29)                       02930006
      *        VALUE 'FROM:SOC_SYSTEM@HDB.GOV.SG'.                      02940006
      *    05  WS-MAIL-RPT11            PIC X(40)                       02950006
      *        VALUE 'TO:<PATRICIA_SS_CHIN@HDB.GOV.SG>'.                02960006
      *    05  WS-MAIL-RPT12            PIC X(40)                       02970006
      *        VALUE 'TO:<VIVIAN_LP_CHIA@HDB.GOV.SG>'.                  02980006
      *    05  WS-MAIL-RPT12A           PIC X(40)                       02990006
      *        VALUE 'TO:<TAN_TSIN_GIAP@HDB.GOV.SG>'.                   03000006
      *    05  WS-MAIL-RPT12B           PIC X(40)                       03010006
      *        VALUE 'TO:<TEH_SHIJIN@HDB.GOV.SG>'.                      03020006
      *    05  WS-MAIL-RPT17            PIC X(34)                       03030006
      *        VALUE  'SUBJECT : DUPLICATE DEBARMENT RPT '.             03040006
           05  WS-MAIL-RPT18.                                           03050006
               10 WS-ADDR-RPT           PIC X(98).                      03060006
                                                                        03070006
      *=======================================================*         03080006
      *    LINKAGE VARIABLES                                  *         03090006
      *=======================================================*         03100006
       01   WS-LINK-REC.                                                03110006
            05 WS-LINK-NUM-SCH            PIC X(4).                     03120006
            05 WS-LINK-NUM-ACC            PIC X(4).                     03130006
            05 WS-LINK-NUM-CHK            PIC X(1).                     03140006
                                                                        03150006
       COPY P13COMM8.                                                   03160006
                                                                        03170006
      *-------------------------------------------------------------    03180006
      *    LETTER LAYOUT                                                03190006
      *-------------------------------------------------------------    03200006
       01  P491-LINE01.                                                 03210006
           05 FILLER                     PIC X(74) VALUE SPACES.        03220006
           05 P491-REGN-NO               PIC X(8)  VALUE SPACES.        03230006
                                                                        03240006
       01  P491-LINE02.                                                 03250006
           05 FILLER                     PIC X(74) VALUE SPACES.        03260006
           05 P491-DATE                  PIC X(10) VALUE SPACES.        03270006
                                                                        03280006
       01  P491-LINE03.                                                 03290006
           05 FILLER                     PIC X(74) VALUE SPACES.        03300006
           05 P491-OIC-TEL               PIC X(8)  VALUE SPACES.        03310006
                                                                        03320006
       01  P491-LINE04.                                                 03330006
           05 FILLER                     PIC X(11)  VALUE SPACES.       03340006
           05 P491-NAME1                 PIC X(66)  VALUE SPACES.       03350006
                                                                        03360006
       01  P491-LINE04B.                                                03370006
           05 FILLER                     PIC X(11)  VALUE SPACES.       03380006
           05 P491-NAME2                 PIC X(66)  VALUE SPACES.       03390006
                                                                        03400006
       01  P491-LINE04C.                                                03410006
           05 FILLER                     PIC X(11)  VALUE SPACES.       03420006
           05 P491-NAME3                 PIC X(66)  VALUE SPACES.       03430006
                                                                        03440006
       01  P491-LINE04D.                                                03450006
           05 FILLER                     PIC X(11)  VALUE SPACES.       03460006
           05 P491-NAME4                 PIC X(66)  VALUE SPACES.       03470006
                                                                        03480006
       01  P491-LINE05.                                                 03490006
           05 FILLER                     PIC X(11)  VALUE SPACES.       03500006
           05 P491-BLK                   PIC X(10)  VALUE SPACES.       03510006
           05 FILLER                     PIC X(2)   VALUE SPACES.       03520006
           05 P491-FLAT-NO.                                             03530006
              15  P491-CHAR              PIC X      VALUE SPACE.        03540006
              15  P491-LEVEL             PIC X(2)   VALUE SPACES.       03550006
              15  P491-DASH              PIC X      VALUE SPACE.        03560006
              15  P491-HSE-MAIN          PIC X(4)   VALUE SPACES.       03570006
              15  P491-HSE-SUB           PIC X(3)   VALUE SPACES.       03580006
                                                                        03590006
       01  P491-LINE05B.                                                03600006
           05 FILLER                     PIC X(11) VALUE SPACES.        03610006
           05 P491-STREET                PIC X(32) VALUE SPACES.        03620006
                                                                        03630006
       01  P491-LINE05C.                                                03640006
           05 FILLER                     PIC X(11) VALUE SPACES.        03650006
           05 FILLER                     PIC X(9)  VALUE 'SINGAPORE'.   03660006
           05 FILLER                     PIC X(1)  VALUE SPACES.        03670006
           05 P491-POSTAL                PIC X(6)  VALUE SPACES.        03680006
                                                                        03690006
       01  PECD-LINE06.                                                 03700006
           05  FILLER                    PIC X(10) VALUE SPACES.        03710006
           05  PECD-BAR-CODE             PIC X(09) VALUE SPACES.        03720006
                                                                        03730006
       01  PECD-LINE07.                                                 03740006
           05 FILLER                     PIC X(20) VALUE SPACES.        03750006
           05 FILLER                     PIC X(4)  VALUE 'BLK'.         03760006
           05 P491-UNIT-BLK              PIC X(5)  VALUE SPACES.        03770006
           05 FILLER                     PIC X(3)  VALUE SPACES.        03780006
           05 P491-UNIT-FLAT-NO.                                        03790006
              10 FILLER                  PIC X     VALUE '#'.           03800006
              10 P491-UNIT-LVL-NO        PIC X(2)  VALUE SPACES.        03810006
              10 FILLER                  PIC X     VALUE '-'.           03820006
              10 P491-UNIT-UNIT-NO       PIC X(5)  VALUE SPACES.        03830006
           05 FILLER                     PIC X(3)  VALUE SPACES.        03840006
           05 P491-UNIT-STREET-POSTAL    PIC X(50) VALUE SPACES.        03850006
                                                                        03860006
      *01  PECD-LINE07A.                                                03870006
      *    05 FILLER                     PIC X(11) VALUE SPACES.        03880006
      *    05 P491-SUBJECT               PIC X(50)                      03890006
      *            VALUE 'PROBABLE COMPLETION DATE FOR'.                03900006
                                                                        03910006
       01  P491-LINE07A.                                                03920006
           05 FILLER                     PIC X(3)  VALUE SPACES.        03930006
           05 P491-POSTAL1               PIC X(6)  VALUE SPACES.        03940006
                                                                        03950006
       01  PECD-LINE08A.                                                03960006
           05 FILLER                     PIC X(29) VALUE SPACES.        03970006
           05 P491-DTE-COMPLT-MM         PIC X(03) VALUE SPACES.        03980006
           05 FILLER                     PIC X(01) VALUE SPACES.        03990006
           05 P491-DTE-COMPLT-YR         PIC X(05) VALUE SPACES.        04000006
                                                                        04010006
      *01  PECD-LINE09A.                                                04020006
      *    05 FILLER                     PIC X(10) VALUE SPACES.        04030006
      *    05 P491-DTE-COMPLT-YR         PIC X(05) VALUE SPACES.        04040006
      *    05 FILLER                     PIC X(85) VALUE SPACES.        04050006
                                                                        04060006
      *01  PECD-LINE08.                                                 04070006
      *    05 FILLER                     PIC X(51) VALUE SPACES.        04080006
      *    05 P491-NEWTOWN               PIC X(20)  VALUE SPACES.       04090006
                                                                        04100006
      *01  PECD-LINE09.                                                 04110006
      *    05 FILLER                     PIC X(56) VALUE SPACES.        04120006
      *    05 FILLER                     PIC X(4)  VALUE 'BLK'.         04130006
      *    05 P491-UNIT-BLK2             PIC X(5)  VALUE SPACES.        04140006
      *    05 FILLER                     PIC X(1)  VALUE SPACES.        04150006
      *    05 P491-NEWTOWN2              PIC X(20) VALUE SPACES.        04160006
                                                                        04170006
       01  PECD-LINE9.                                                  04180006
           05 FILLER                     PIC X(22) VALUE SPACES.        04190006
           05 P491-MAIL                  PIC X(67) VALUE                04200006
           '<https://services2.hdb.gov.sg/webapp/SX05AWSPCP/SX05PSPCPLog04210006
      -        'in.jsp>'.                                               04220006
       01  PECD-LINE10.                                                 04230006
           05 FILLER                     PIC X(52) VALUE SPACES.        04240006
           05 P491-NEW-PCD               PIC X(18) VALUE SPACES.        04250006
                                                                        04260006
       01  PECD-LINE10A.                                                04270006
           05 FILLER                     PIC X(47) VALUE SPACES.        04280006
           05 FILLER                     PIC X(12) VALUE SPACES.        04290006
           05 P491-NEW-PCDA              PIC X(18) VALUE SPACES.        04300006
                                                                        04310006
       01  PECD-LINE10Q.                                                04320006
           05 FILLER                     PIC X(29) VALUE SPACES.        04330006
           05 P491-NEW-PCDQ              PIC X(16) VALUE SPACES.        04340006
                                                                        04350006
       01  PECD-NOTE-LINE10A.                                           04360006
           05 FILLER                     PIC X(23) VALUE SPACES.        04370006
           05 FILLER                     PIC X(73) VALUE SPACES.        04380006
           05 P491-NOTEA-PCD             PIC X(18) VALUE SPACES.        04390006
                                                                        04400006
       01  PECD-NOTE-LINE10B.                                           04410006
           05 FILLER                     PIC X(49) VALUE SPACES.        04420006
           05 FILLER                     PIC X(10) VALUE SPACES.        04430006
           05 P491-NOTEB-PCD             PIC X(18) VALUE SPACES.        04440006
                                                                        04450006
       01  PECD-NOTE-LINE10C.                                           04460006
           05 FILLER                     PIC X(23) VALUE SPACES.        04470006
           05 FILLER                     PIC X(57) VALUE SPACES.        04480006
           05 P491-NOTEC-PCD             PIC X(18) VALUE SPACES.        04490006
                                                                        04500006
       01  PECD-NOTE-LINE10D.                                           04510006
           05 FILLER                     PIC X(29) VALUE SPACES.        04520006
           05 P491-NOTED-PCD             PIC X(16) VALUE SPACES.        04530006
                                                                        04540006
                                                                        04550006
       01  PECD-FT-OIC.                                                 04560006
           05 FILLER                     PIC X(10) VALUE SPACES.        04570006
           05 P491-NME-OIC               PIC X(30) VALUE SPACES.        04580006
                                                                        04590006
      *01  CL49J-LINE01.                                                04600006
      *    05 CL49J-MM                   PIC 9(02).                     04610006
      *    05 CL49J-YYYY                 PIC 9(04).                     04620006
      *                                                                 04630006
      *01  L49J-LINE01.                                                 04640006
      *    05 FILLER                     PIC X(11) VALUE SPACES.        04650006
      *    05 L49J-STREET1               PIC X(32) VALUE SPACES.        04660006
      *                                                                 04670006
      *01  L49J-LINE02.                                                 04680006
      *    05 FILLER                     PIC X(11)  VALUE SPACES.       04690006
      *    05 L49J-BLK                   PIC X(10)  VALUE SPACES.       04700006
      *    05 FILLER                     PIC X(2)   VALUE SPACES.       04710006
      *    05 L49J-FLAT-NO1.                                            04720006
      *       15  L49J-CHAR              PIC X      VALUE SPACE.        04730006
      *       15  L49J-LEVEL             PIC X(2)   VALUE SPACES.       04740006
      *       15  L49J-DASH              PIC X      VALUE SPACE.        04750006
      *       15  L49J-HSE-MAIN          PIC X(4)   VALUE SPACES.       04760006
      *       15  L49J-HSE-SUB           PIC X(3)   VALUE SPACES.       04770006
      *                                                                 04780006
      *01  L49J-LINE03.                                                 04790006
      *    05 FILLER                     PIC X(11) VALUE SPACES.        04800006
      *    05 FILLER                     PIC X(10) VALUE 'SINGAPORE'.   04810006
      *    05 L49J-POSTAL                PIC X(6)  VALUE SPACES.        04820006
      *-------------------------------------------------------------    04830006
      *    REPORT LAYOUT                                                04840006
      *-------------------------------------------------------------    04850006
       01  L49J-HDR01.                                                  04860006
           05 FILLER                     PIC X(14) VALUE 'BP13L49J'.    04870006
           05 FILLER                     PIC X(30) VALUE 'HDB3'.        04880006
           05 FILLER                     PIC X(42) VALUE                04890006
             'S Y S T E M   O F   C O M M I T M E N T'.                 04900006
           05 FILLER                     PIC X(13) VALUE SPACES.        04910006
           05 FILLER                     PIC X(7)  VALUE 'DATE: '.      04920006
           05 L49J-DATE                  PIC X(10) VALUE SPACES.        04930006
           05 FILLER                     PIC X(10) VALUE '   PAGE: '.   04940006
           05 L49J-PAGE                  PIC ZZZZ9.                     04950006
                                                                        04960006
       01  L49J-HDR02.                                                  04970006
           05 FILLER                     PIC X(40) VALUE SPACES.        04980006
           05 FILLER                     PIC X(80) VALUE                04990006
             'LETTERS PRINTED FOR NOTIFICATION OF NEW PCD DATE'.        05000006
                                                                        05010006
       01  L49J-HDR03.                                                  05020006
           05 FILLER                     PIC X(10) VALUE '  BLOCK: '.   05030006
           05 L49J-BLOCK                 PIC X(5)  VALUE SPACES.        05040006
           05 FILLER                     PIC X(4)  VALUE SPACES.        05050006
           05 L49J-STREET-NAME           PIC X(32) VALUE SPACES.        05060006
                                                                        05070006
       01  L49J-HDR04.                                                  05080006
           05 FILLER                     PIC X(9)  VALUE '   NO.   '.   05090006
           05 FILLER                     PIC X(14) VALUE 'SCH-ACC NO'.  05100006
           05 FILLER                     PIC X(10) VALUE '  REGN NO.'.  05110006
           05 FILLER                     PIC X(34)                      05120006
                    VALUE '  NAME(TRUNCATED) '.                         05130006
           05 FILLER                     PIC X(10) VALUE '  NRIC NO.'.  05140006
           05 FILLER                     PIC X(7)  VALUE '  BLK '.      05150006
           05 FILLER                     PIC X(26)                      05160006
                    VALUE '      MAIL STREET NAME'.                     05170006
           05 FILLER                     PIC X(10) VALUE '  FLAT NO.'.  05180006
           05 FILLER                     PIC X(8)  VALUE '  PC'.        05190006
                                                                        05200006
       01  L49J-DETAIL.                                                 05210006
           05 FILLER                     PIC X(2)  VALUE SPACES.        05220006
           05 L49J-NO                    PIC ZZZZ9.                     05230006
           05 FILLER                     PIC X(2)  VALUE SPACES.        05240006
           05 L49J-SCH-ACC               PIC X(14) VALUE SPACES.        05250006
           05 FILLER                     PIC X(2)  VALUE SPACES.        05260006
           05 L49J-REGN-NO               PIC X(8)  VALUE SPACES.        05270006
           05 FILLER                     PIC X(2)  VALUE SPACES.        05280006
           05 L49J-NAME                  PIC X(32) VALUE SPACES.        05290006
           05 FILLER                     PIC X(2)  VALUE SPACES.        05300006
           05 L49J-NRIC-NO               PIC X(9)  VALUE SPACES.        05310006
           05 FILLER                     PIC X     VALUE SPACES.        05320006
           05 L49J-BLK-NO                PIC X(10) VALUE SPACES.        05330006
           05 FILLER                     PIC X     VALUE SPACES.        05340006
           05 L49J-STREET                PIC X(20) VALUE SPACES.        05350006
           05 FILLER                     PIC X(2)  VALUE SPACES.        05360006
           05 L49J-FLAT-NO.                                             05370006
              10 FILLER                  PIC X     VALUE '#'.           05380006
              10 L49J-LVL-NO             PIC X(2)  VALUE SPACES.        05390006
              10 FILLER                  PIC X     VALUE '-'.           05400006
              10 L49J-UNIT-NO            PIC X(4)  VALUE SPACES.        05410006
           05 FILLER                     PIC X(2)  VALUE SPACES.        05420006
           05 L49J-pOSTAL-CODE           PIC X(6)  VALUE SPACES.        05430006
                                                                        05440006
       01  L49J-PRT-TOTAL.                                              05450006
           05 FILLER                     PIC X(10) VALUE SPACES.        05460006
           05 FILLER                     PIC X(30)                      05470006
              VALUE 'TOTAL NUMBER OF LETTERS: '.                        05480006
           05 L49J-TOTAL                 PIC Z,ZZZ,ZZ9.                 05490006
                                                                        05500006
      *------------------------------------------------------------*    05510006
      *  DJDE LINE                                                 *    05520006
      *------------------------------------------------------------*    05530006
                                                                        05540006
       01  DJDE-LINE-FY-PAGE1             PIC X(80)  VALUE              05550006
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP1310,NUMBER=(0000,29,65,305560006
      -    '),DUPLEX=NO,END;'.                                          05570006
       01  DJDE-LINE-FX-PAGE2             PIC X(80)  VALUE              05580006
           '$DJDE$ FORMS=BP1310,END;'.                                  05590006
                                                                        05600006
      *-------------------------------------------------------------    05610006
      *    REPORT LAYOUT FOR LETTERS TO BE EMAILED                      05620006
      *-------------------------------------------------------------    05630006
      *-------------------------------------------------------------    05640006
      *-------------------------------------------------------------    05650006
      *  LINKAGE FOR BP13CB4A                                           05660006
      *-------------------------------------------------------------    05670006
                                                                        05680006
       PROCEDURE DIVISION.                                              05690006
      *-------------------------------------------------------------    05700006
       0000-CONTROL.                                                    05710006
      *-------------------------------------------------------------    05720006
           PERFORM 1000-START-UP         THRU 1000-EXIT.                05730006
           PERFORM 2000-MAIN-ROUTINE     THRU 2000-EXIT                 05740006
                   UNTIL WS-F110-EOF = 'Y'.                             05750006
           PERFORM 9999-WRAP-UP.                                        05760006
                                                                        05770006
       0000-EXIT.                                                       05780006
            EXIT.                                                       05790006
                                                                        05800006
      *-------------------------------------------------------------    05810006
       1000-START-UP.                                                   05820006
      *-------------------------------------------------------------    05830006
            OPEN INPUT  BP13K022                                        05840006
                        BP13K024                                        05850006
                        BP13K800                                        05860006
                        BP13K820                                        05870006
                        BP13K830                                        05880006
                        BM06K510                                        05890006
                        BM06K100                                        05900006
                        BM06F110                                        05910006
                        BP13K857                                        05920006
                OUTPUT  BP13L49J                                        05930006
                        BP13P491                                        05940006
                   I-O  BP13K491                                        05950006
                        BP13F491.                                       05960006
                                                                        05970006
            IF K491-STATUS NOT = 00 AND 97                              05980006
               DISPLAY 'OPEN FAILED FOR BP13K491,STATUS ' K491-STATUS   05990006
               MOVE K491-STATUS TO RETURN-CODE                          06000006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06010006
            END-IF.                                                     06020006
                                                                        06030006
            IF K022-STATUS NOT = 00 AND 97                              06040006
               DISPLAY 'OPEN FAILED FOR BP13K022,STATUS ' K022-STATUS   06050006
               MOVE K022-STATUS TO RETURN-CODE                          06060006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06070006
            END-IF.                                                     06080006
                                                                        06090006
            IF K024-STATUS NOT = 00 AND 97                              06100006
               DISPLAY 'OPEN FAILED FOR BP13K024,STATUS ' K024-STATUS   06110006
               MOVE K024-STATUS TO RETURN-CODE                          06120006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06130006
            END-IF.                                                     06140006
                                                                        06150006
            IF K800-STATUS NOT = 00 AND 97                              06160006
               DISPLAY 'OPEN FAILED FOR BP13K800,STATUS ' K800-STATUS   06170006
               MOVE K800-STATUS TO RETURN-CODE                          06180006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06190006
            END-IF.                                                     06200006
                                                                        06210006
            IF K820-STATUS NOT = 00 AND 97                              06220006
               DISPLAY 'OPEN FAILED FOR BP13K820,STATUS ' K820-STATUS   06230006
               MOVE K820-STATUS TO RETURN-CODE                          06240006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06250006
            END-IF.                                                     06260006
                                                                        06270006
            IF K830-STATUS NOT = 00 AND 97                              06280006
               DISPLAY 'OPEN FAILED FOR BP13K830,STATUS ' K830-STATUS   06290006
               MOVE K830-STATUS TO RETURN-CODE                          06300006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06310006
            END-IF.                                                     06320006
                                                                        06330006
            IF K510-STATUS NOT = 00 AND 97                              06340006
               DISPLAY 'OPEN FAILED FOR BM06K510,STATUS ' K510-STATUS   06350006
               MOVE K510-STATUS TO RETURN-CODE                          06360006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06370006
            END-IF.                                                     06380006
                                                                        06390006
            IF K100-STATUS NOT = 00 AND 97                              06400006
               DISPLAY 'OPEN FAILED FOR BM06K100,STATUS ' K100-STATUS   06410006
               MOVE K100-STATUS TO RETURN-CODE                          06420006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06430006
            END-IF.                                                     06440006
                                                                        06450006
            IF K857-STATUS NOT = 00 AND 97                              06460006
               DISPLAY 'OPEN FAILED FOR BP13K857,STATUS ' K857-STATUS   06470006
               MOVE K857-STATUS TO RETURN-CODE                          06480006
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 06490006
            END-IF.                                                     06500006
                                                                        06510006
            READ BM06F110                                               06520006
                 AT END                                                 06530006
                         MOVE 'Y'          TO WS-F110-EOF               06540006
                         GO TO 1000-EXIT                                06550006
                 NOT AT END                                             06560006
                  IF F110-REGN-NO(1:2) = '##'                           06570006
                     READ BM06F110                                      06580006
                          AT END                                        06590006
                                  MOVE 'Y'          TO WS-F110-EOF      06600006
                                  GO TO 1000-EXIT                       06610006
                  END-IF                                                06620006
            END-READ.                                                   06630006
                                                                        06640006
            MOVE 60                  TO WS-LINE-CNT.                    06650006
            MOVE 60                  TO WS-LINE-CNT-A.                  06660006
            ADD  1                   TO WS-CNT-F110-READ.               06670006
            MOVE F110-BLK-NO         TO WS-PREV-BLK-NO.                 06680006
                                                                        06690006
            MOVE FUNCTION CURRENT-DATE TO WS-DATE.                      06700006
                                                                        06710006
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)       06720006
                   DELIMITED BY SIZE INTO P491-DATE.                    06730006
                                                                        06740006
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)       06750006
                   DELIMITED BY SIZE INTO L49J-DATE.                    06760006
                                                                        06770006
       1000-EXIT.                                                       06780006
            EXIT.                                                       06790006
                                                                        06800006
      *-------------------------------------------------------------    06810006
       2000-MAIN-ROUTINE.                                               06820006
      *-------------------------------------------------------------    06830006
                                                                        06840006
           IF F110-REGN-NO(1:2) = '##'                                  06850006
              READ BM06F110 AT END                                      06860006
                   MOVE 'Y' TO WS-F110-EOF                              06870006
                   GO TO 2000-EXIT                                      06880006
                   NOT AT END                                           06890006
                   IF F110-REGN-NO(1:2) = '##'                          06900006
                      GO TO 2000-EXIT                                   06910006
                   END-IF                                               06920006
           END-IF                                                       06930006
                                                                        06940006
           SET WS-NO-ERROR           TO TRUE.                           06950006
           INITIALIZE  WS-OCCUPANTS.                                    06960006
           INITIALIZE  WS-NAME-EMAIL.                                   06970006
           MOVE SPACES                   TO  BP13K491-REC BP13F491-REC  06980006
                                             WS-F491-EOF WS-F491-FND.   06990006
           INITIALIZE                        BP13K491-REC BP13F491-REC. 07000006
                                                                        07010006
      *-------------------------------------------------------------*   07020006
      * READS BM06F110 AND PROCESS EACH RECORD UNTIL END OF FILE    *   07030006
      *-------------------------------------------------------------*   07040006
                                                                        07050006
           MOVE 'N'     TO WS-PROCESS WS-FOUND-K857.                    07060006
           MOVE SPACES  TO WS-HP.                                       07070006
                                                                        07080006
           MOVE SPACES                     TO BP13K491-REC.             07090006
           PERFORM 3003-READ-K491   THRU 3003-EXIT.                     07100006
      *    IF WS-F491-FND = 'Y' OR WS-PROCESS = 'N'                     07110006
              CLOSE BP13F491                                            07120006
              OPEN I-O BP13F491                                         07130006
      *    END-IF                                                       07140006
           PERFORM 3004-READ-F491   THRU 3004-EXIT                      07150006
             UNTIL WS-F491-EOF = 'Y' OR WS-F491-FND = 'Y'               07160006
           IF WS-F491-EOF = 'Y' AND WS-F491-FND = 'N'                   07170006
              CLOSE BP13F491                                            07180006
              OPEN EXTEND BP13F491                                      07190006
           END-IF                                                       07200006
           PERFORM 2100-RETRIEVE-DATA   THRU 2100-EXIT.                 07210006
           PERFORM 3000-FORMAT-LETTER   THRU 3000-EXIT                  07220006
           PERFORM 4000-READ-K857       THRU 4000-EXIT                  07230006
             IF WS-FOUND-K857 = 'Y'                                     07240006
                IF K857-NUM-EMAIL NOT = SPACES AND LOW-VALUES           07250006
                 ADD 1 TO WS-CNT-K857-W-EMAIL                           07260006
                 IF WS-FOUND-K491 = 'N'                                 07270006
                    PERFORM 3001-FORMAT-EMAIL    THRU 3001-EXIT         07280006
                 ELSE                                                   07290006
                    PERFORM 3002-FORMAT-EMAIL    THRU 3002-EXIT         07300006
                 END-IF                                                 07310006
                 IF WS-F491-FND = 'N'                                   07320006
                    PERFORM 3005-FORMAT-EMAIL    THRU 3005-EXIT         07330006
                 ELSE                                                   07340006
                    PERFORM 3006-FORMAT-EMAIL    THRU 3006-EXIT         07350006
                 END-IF                                                 07360006
                 MOVE 'Y' TO WS-PROCESS                                 07370006
                END-IF                                                  07380006
             END-IF                                                     07390006
             IF WS-PROCESS NOT = 'Y'                                    07400006
                 IF K100-NUM-PACD = 'M' OR K100-NUM-PACD = 'Q'          07410006
                    PERFORM 3100-PRINT-LETTER THRU 3100-EXIT            07420006
                 END-IF                                                 07430006
               PERFORM 3200-PRINT-AUDIT     THRU 3200-EXIT              07440006
             END-IF.                                                    07450006
                                                                        07460006
           READ BM06F110 AT END                                         07470006
                MOVE 'Y' TO WS-F110-EOF                                 07480006
                GO TO 2000-EXIT                                         07490006
                 NOT AT END                                             07500006
                  IF F110-REGN-NO(1:2) = '##'                           07510006
                     READ BM06F110 AT END                               07520006
                          MOVE 'Y' TO WS-F110-EOF                       07530006
                          GO TO 2000-EXIT                               07540006
                  END-IF                                                07550006
                END-READ.                                               07560006
                                                                        07570006
           ADD  1                          TO WS-CNT-F110-READ.         07580006
                                                                        07590006
       2000-EXIT.                                                       07600006
            EXIT.                                                       07610006
                                                                        07620006
      *-------------------------------------------------------------    07630006
       2100-RETRIEVE-DATA.                                              07640006
      *-------------------------------------------------------------    07650006
           MOVE F110-REGN-NO               TO K800-NUM-REGN.            07660006
           MOVE SPACES                     TO WS-TEMP-PCD               07670006
                                              WS-TEMP-PCD-A.            07680006
           PERFORM 8100-READ-K800          THRU 8100-EXIT.              07690006
           IF WS-NO-ERROR                                               07700006
              PERFORM 2200-GET-NRIC-NAMES  THRU 2200-EXIT               07710006
              PERFORM 2300-GET-NRIC-ADDR   THRU 2300-EXIT               07720006
              PERFORM 2400-GET-BLK-ADDRESS THRU 2400-EXIT               07730006
              PERFORM 2500-GET-NEWTOWN     THRU 2500-EXIT               07740006
              PERFORM 2600-GET-PCD         THRU 2600-EXIT               07750006
           END-IF                                                       07760006
                                                                        07770006
           .                                                            07780006
       2100-EXIT.                                                       07790006
            EXIT.                                                       07800006
                                                                        07810006
      *-------------------------------------------------------------    07820006
       2200-GET-NRIC-NAMES.                                             07830006
      *-------------------------------------------------------------    07840006
           MOVE  4                         TO   WS-OCCP-PTR.            07850006
           MOVE SPACES                     TO   WS-NAME-EMAIL.          07860006
           IF K800-NUM-NRIC4 NOT = SPACES                               07870006
              MOVE SPACES                  TO   BP13K820-REC            07880006
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           07890006
              MOVE K800-NUM-NRIC4          TO   K820-NUM-NRIC           07900006
              PERFORM 8200-READ-K820       THRU 8200-EXIT               07910006
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    07920006
              SUBTRACT   1                 FROM WS-OCCP-PTR             07930006
              MOVE K820-NUM-HP-PGR         TO   WS-HP                   07940006
           END-IF.                                                      07950006
                                                                        07960006
           IF K800-NUM-NRIC3 NOT = SPACES AND WS-NO-ERROR               07970006
              MOVE SPACES                  TO   BP13K820-REC            07980006
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           07990006
              MOVE K800-NUM-NRIC3          TO   K820-NUM-NRIC           08000006
              PERFORM 8200-READ-K820       THRU 8200-EXIT               08010006
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    08020006
              SUBTRACT   1                 FROM WS-OCCP-PTR             08030006
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES            08040006
                 MOVE K820-NUM-HP-PGR         TO   WS-HP                08050006
              END-IF                                                    08060006
           END-IF.                                                      08070006
                                                                        08080006
           IF K800-NUM-NRIC2 NOT = SPACES AND WS-NO-ERROR               08090006
              MOVE SPACES                  TO   BP13K820-REC            08100006
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           08110006
              MOVE K800-NUM-NRIC2          TO   K820-NUM-NRIC           08120006
              PERFORM 8200-READ-K820       THRU 8200-EXIT               08130006
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    08140006
              SUBTRACT   1                 FROM WS-OCCP-PTR             08150006
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES            08160006
                 MOVE K820-NUM-HP-PGR         TO   WS-HP                08170006
              END-IF                                                    08180006
           END-IF.                                                      08190006
                                                                        08200006
           IF K800-NUM-NRIC1 NOT = SPACES AND WS-NO-ERROR               08210006
              MOVE SPACES                  TO   BP13K820-REC            08220006
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           08230006
              MOVE K800-NUM-NRIC1          TO   K820-NUM-NRIC           08240006
              PERFORM 8200-READ-K820       THRU 8200-EXIT               08250006
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    08260006
                                                WS-NAME-EMAIL           08270006
              MOVE K820-NUM-HP-PGR         TO   WS-HP                   08280006
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES            08290006
                 MOVE K820-NUM-HP-PGR         TO   WS-HP                08300006
              END-IF                                                    08310006
           END-IF.                                                      08320006
                                                                        08330006
       2200-EXIT.                                                       08340006
            EXIT.                                                       08350006
                                                                        08360006
      *-------------------------------------------------------------    08370006
       2300-GET-NRIC-ADDR.                                              08380006
      *------------------------------------------------------           08390006
                                                                        08400006
           MOVE F110-REGN-NO               TO  K830-NUM-REGN.           08410006
           PERFORM 8300-READ-K830          THRU 8300-EXIT.              08420006
                                                                        08430006
       2300-EXIT.                                                       08440006
            EXIT.                                                       08450006
                                                                        08460006
      *-------------------------------------------------------------    08470006
       2400-GET-BLK-ADDRESS.                                            08480006
      *------------------------------------------------------           08490006
           MOVE SPACES           TO BP13COMM8-REC.                      08500006
           MOVE K800-NUM-SCH     TO WS-LINK-NUM-SCH.                    08510006
           MOVE K800-NUM-ACC     TO WS-LINK-NUM-ACC.                    08520006
           MOVE K800-NUM-ACC-CK  TO WS-LINK-NUM-CHK.                    08530006
                                                                        08540006
           CALL 'BP13C913' USING                                        08550006
                 WS-LINK-REC, BP13COMM8-REC                             08560006
           END-CALL.                                                    08570006
                                                                        08580006
           IF COMM8-CDE-SYSERR NOT = 0                                  08590006
              MOVE COMM8-CDE-SYSERR  TO WS-SQL-CODE                     08600006
              IF COMM8-CDE-SYSERR = 100                                 08610006
                 DISPLAY 'SCH-ACC NOT FOUND IN PBF TABLE' WS-SQL-CODE   08620006
              ELSE                                                      08630006
                 DISPLAY 'ERROR READING PBF TABLE' WS-SQL-CODE          08640006
              END-IF                                                    08650006
              MOVE SPACES        TO BP13COMM8-REC                       08660006
              SET WS-ERROR       TO TRUE                                08670006
           END-IF.                                                      08680006
                                                                        08690006
       2400-EXIT.                                                       08700006
            EXIT.                                                       08710006
                                                                        08720006
       2500-GET-NEWTOWN.                                                08730006
      *------------------------------------------------------           08740006
                                                                        08750006
            MOVE F110-ESTATE        TO   K510-ESTCDE.                   08760006
            PERFORM 8400-READ-K510  THRU 8400-EXIT.                     08770006
                                                                        08780006
       2500-EXIT.                                                       08790006
            EXIT.                                                       08800006
                                                                        08810006
      *-------------------------------------------------------------    08820006
       2600-GET-PCD.                                                    08830006
      *------------------------------------------------------           08840006
                                                                        08850006
           MOVE F110-AIX1          TO   K100-KEY-FLD.                   08860006
           PERFORM 8500-READ-K100  THRU 8500-EXIT.                      08870006
                                                                        08880006
           IF K100-NUM-PACD = 'M'                                       08890006
              PERFORM 2700-MONTHLY-PACD   THRU 2700-EXIT                08900006
           ELSE                                                         08910006
             IF K100-NUM-PACD = 'Q'                                     08920006
                PERFORM 2800-QUARTERLY-PACD   THRU 2800-EXIT            08930006
             END-IF                                                     08940006
           END-IF.                                                      08950006
                                                                        08960006
       2600-EXIT.                                                       08970006
            EXIT.                                                       08980006
                                                                        08990006
      *-------------------------------------------------------------    09000006
       2700-MONTHLY-PACD.                                               09010006
      *------------------------------------------------------           09020006
           SET WS-MTH-IND TO 1.                                         09030006
                                                                        09040006
           SEARCH WS-MONTH-TABLE                                        09050006
               AT END                                                   09060006
               MOVE '   ' TO WS-MONTH                                   09070006
            WHEN WS-MONTH-IN-DIGITS(WS-MTH-IND) = K100-DTE-PACD-QTR(5:2)09080006
               MOVE WS-MONTH-IN-WORDS(WS-MTH-IND) TO WS-MONTH           09090006
           END-SEARCH.                                                  09100006
                                                                        09110006
           MOVE K100-DTE-PACD-QTR(1:4)       TO WS-YEAR.                09120006
                                                                        09130006
           MOVE SPACES                 TO K491-DTE-PCD F491-DTE-PCD     09140006
           STRING WS-MONTH ' ' WS-YEAR                                  09150006
                  DELIMITED BY SIZE                                     09160006
                  INTO K491-DTE-PCD                                     09170006
           END-STRING.                                                  09180006
           STRING WS-MONTH ' ' WS-YEAR                                  09190006
                  DELIMITED BY SIZE                                     09200006
                  INTO F491-DTE-PCD                                     09210006
           END-STRING.                                                  09220006
           MOVE WS-MONTH                     TO P491-DTE-COMPLT-MM      09230006
           STRING WS-YEAR DELIMITED BY SIZE  INTO P491-DTE-COMPLT-YR    09240006
                                                                        09250006
           MOVE K491-DTE-PCD  TO WS-TEMP-PCD.                           09260006
                                                                        09270006
       2700-EXIT.                                                       09280006
            EXIT.                                                       09290006
                                                                        09300006
      *-------------------------------------------------------------    09310006
       2800-QUARTERLY-PACD.                                             09320006
      *------------------------------------------------------           09330006
           IF K100-DTE-PACD-QTR(5:2) = '01' OR '02' OR '03'             09340006
              MOVE '1ST QUARTER' TO WS-QUARTER                          09350006
           ELSE                                                         09360006
              IF K100-DTE-PACD-QTR(5:2) = '04' OR '05' OR '06'          09370006
                 MOVE '2ND QUARTER' TO WS-QUARTER                       09380006
              ELSE                                                      09390006
                 IF K100-DTE-PACD-QTR(5:2) = '07' OR '08' OR '09'       09400006
                    MOVE '3RD QUARTER' TO WS-QUARTER                    09410006
                 ELSE                                                   09420006
                    MOVE '4TH QUARTER' TO WS-QUARTER                    09430006
                 END-IF                                                 09440006
              END-IF                                                    09450006
           END-IF.                                                      09460006
                                                                        09470006
           MOVE K100-DTE-PACD-QTR(1:4)       TO WS-YEAR.                09480006
                                                                        09490006
           STRING WS-QUARTER ' ' WS-YEAR                                09500006
                  DELIMITED BY SIZE                                     09510006
                  INTO P491-NEW-PCDQ                                    09520006
                                                                        09530006
           MOVE SPACES                 TO K491-DTE-PCD F491-DTE-PCD     09540006
           STRING WS-QUARTER ' ' WS-YEAR                                09550006
                  DELIMITED BY SIZE                                     09560006
                  INTO K491-DTE-PCD                                     09570006
           END-STRING.                                                  09580006
           STRING WS-QUARTER ' ' WS-YEAR                                09590006
                  DELIMITED BY SIZE                                     09600006
                  INTO F491-DTE-PCD                                     09610006
           END-STRING.                                                  09620006
           MOVE K491-DTE-PCD  TO WS-TEMP-PCD.                           09630006
                                                                        09640006
       2800-EXIT.                                                       09650006
            EXIT.                                                       09660006
                                                                        09670006
      *------------------------------------------------------           09680006
       3000-FORMAT-LETTER.                                              09690006
      *------------------------------------------------------           09700006
           MOVE SPACES                   TO  P491-REGN-NO               09710006
                                             P491-NAME1                 09720006
                                             P491-NAME2                 09730006
                                             P491-NAME3                 09740006
                                             P491-NAME4                 09750006
                                             P491-OIC-TEL               09760006
                                             P491-NME-OIC.              09770006
                                                                        09780006
           MOVE K800-NUM-REGN            TO  P491-REGN-NO.              09790006
           MOVE WS-NAME(1)               TO  P491-NAME1.                09800006
           MOVE WS-NAME(2)               TO  P491-NAME2.                09810006
           MOVE WS-NAME(3)               TO  P491-NAME3.                09820006
           MOVE WS-NAME(4)               TO  P491-NAME4.                09830006
           IF K830-NUM-MAIL-ADDR NOT = SPACES AND LOW-VALUES            09840006
              PERFORM 3050-FORMAT-MAIL-ADDR THRU 3050-EXIT              09850006
           ELSE                                                         09860006
              PERFORM 3055-FORMAT-HOME-ADDR THRU 3055-EXIT              09870006
           END-IF.                                                      09880006
                                                                        09890006
           MOVE COMM8-NUM-BLK            TO  P491-UNIT-BLK.             09900006
           MOVE COMM8-NME-STREET         TO  P491-UNIT-STREET-POSTAL.   09910006
           MOVE COMM8-NUM-LEVEL          TO  P491-UNIT-LVL-NO.          09920006
           MOVE COMM8-NUM-UNIT-MAIN      TO  P491-UNIT-UNIT-NO.         09930006
           MOVE COMM8-NUM-POSTAL-CODE    TO  P491-POSTAL1.              09940006
                                                                        09950006
            STRING WS-TEMP-SPACE1 WS-TEMP-SPACE  'BLK' P491-UNIT-BLK ' '09960006
                   P491-UNIT-FLAT-NO ' '                                09970006
                   P491-UNIT-STREET-POSTAL                              09980006
                   DELIMITED BY SIZE INTO WS-TEMP-ADDRESS1.             09990006
                                                                        10000006
            STRING WS-TEMP-SPACE1 'S(' P491-POSTAL1 ')'                 10010006
                   DELIMITED BY SIZE INTO WS-TEMP-ADDRESS2.             10020006
                                                                        10030006
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    10040006
                                                                        10050006
       3000-EXIT.                                                       10060006
            EXIT.                                                       10070006
                                                                        10080006
      *-------------------------------------------------------------    10090006
       3001-FORMAT-EMAIL.                                               10100006
      *------------------------------------------------------           10110006
                                                                        10120006
           MOVE K800-NUM-REGN            TO  K491-NUM-REGN.             10130006
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y'                        10140006
           MOVE 'Y'                      TO  K491-CDE-DA                10150006
           END-IF.                                                      10160006
           MOVE K857-NUM-EMAIL           TO  K491-NUM-EMAIL             10170006
           MOVE COMM8-NUM-BLK            TO  K491-NUM-BLK               10180006
           MOVE COMM8-NUM-LEVEL          TO  K491-NUM-LEVEL             10190006
           MOVE COMM8-NUM-UNIT-MAIN      TO  K491-NUM-MAIN-UNIT         10200006
           MOVE COMM8-NME-STREET         TO  K491-NUM-STREET            10210006
           MOVE COMM8-NUM-POSTAL-CODE    TO  K491-NUM-POSTAL            10220006
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    10230006
           MOVE K024-NME-OIC             TO  K491-NME-OIC.              10240006
           MOVE WS-DATE                TO K491-DTE-UPDATE.              10250006
                                                                        10260006
           WRITE BP13K491-REC.                                          10270006
                                                                        10280006
           EVALUATE K491-STATUS                                         10290006
             WHEN 00                                                    10300006
                 ADD 1 TO WS-F491-WRT                                   10310006
             WHEN 02                                                    10320006
             WHEN 22                                                    10330006
                 DISPLAY 'DUP RECORD K491..STAT'    K491-STATUS         10340006
                          '/' K491-NUM-REGN                             10350006
             WHEN OTHER                                                 10360006
                 DISPLAY 'ERROR WRITING THE RECORD K491..STAT'          10370006
                    K491-STATUS                                         10380006
                 DISPLAY 'KEY FIELD K028 ' K491-KEY-FLD                 10390006
                 MOVE K491-STATUS           TO RETURN-CODE              10400006
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT             10410006
           END-EVALUATE.                                                10420006
                                                                        10430006
       3001-EXIT.                                                       10440006
            EXIT.                                                       10450006
                                                                        10460006
      *-------------------------------------------------------------    10470006
       3002-FORMAT-EMAIL.                                               10480006
      *------------------------------------------------------           10490006
                                                                        10500006
           MOVE K800-NUM-REGN            TO  K491-NUM-REGN.             10510006
           MOVE K857-NUM-EMAIL           TO  K491-NUM-EMAIL             10520006
           MOVE COMM8-NUM-BLK            TO  K491-NUM-BLK               10530006
           MOVE COMM8-NUM-LEVEL          TO  K491-NUM-LEVEL             10540006
           MOVE COMM8-NUM-UNIT-MAIN      TO  K491-NUM-MAIN-UNIT         10550006
           MOVE COMM8-NME-STREET         TO  K491-NUM-STREET            10560006
           MOVE COMM8-NUM-POSTAL-CODE    TO  K491-NUM-POSTAL            10570006
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    10580006
           MOVE K024-NME-OIC             TO  K491-NME-OIC.              10590006
           MOVE WS-DATE                TO K491-DTE-UPDATE.              10600006
                                                                        10610006
           REWRITE BP13K491-REC.                                        10620006
                                                                        10630006
           EVALUATE K491-STATUS                                         10640006
             WHEN 00                                                    10650006
                 ADD 1 TO WS-F491-REWRITE                               10660006
             WHEN OTHER                                                 10670006
                 DISPLAY 'ERROR REWRITING THE RECORD K491..STAT'        10680006
                    K491-STATUS                                         10690006
                 DISPLAY 'KEY FIELD K491 ' K491-KEY-FLD                 10700006
                 MOVE K491-STATUS           TO RETURN-CODE              10710006
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT             10720006
           END-EVALUATE.                                                10730006
                                                                        10740006
       3002-EXIT.                                                       10750006
            EXIT.                                                       10760006
                                                                        10770006
      *-------------------------------------------------------------    10780006
       3003-READ-K491.                                                  10790006
      *-------------------------------------------------------------    10800006
           MOVE SPACES         TO BP13K491-REC.                         10810006
           MOVE 'N'            TO WS-FOUND-K491.                        10820006
           MOVE F110-REGN-NO   TO K491-NUM-REGN.                        10830006
           READ BP13K491.                                               10840006
                                                                        10850006
           IF K491-STATUS = 00                                          10860006
              MOVE 'Y'  TO WS-FOUND-K491                                10870006
           ELSE                                                         10880006
           IF K491-STATUS = 23                                          10890006
              MOVE 'N'  TO WS-FOUND-K491                                10900006
           ELSE                                                         10910006
              DISPLAY 'ERROR READING BP13K491, STATUS ' K491-STATUS     10920006
              MOVE K491-STATUS TO RETURN-CODE                           10930006
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 10940006
                                                                        10950006
       3003-EXIT.                                                       10960006
            EXIT.                                                       10970006
                                                                        10980006
      *-------------------------------------------------------------    10990006
       3004-READ-F491.                                                  11000006
      *-------------------------------------------------------------    11010006
                                                                        11020006
           READ BP13F491                                                11030006
             AT END                                                     11040006
                 MOVE 'Y'          TO WS-F491-EOF                       11050006
                 MOVE 'N'          TO WS-F491-FND                       11060006
             NOT AT END                                                 11070006
              IF F491-NUM-REGN = F110-REGN-NO                           11080006
                 MOVE 'Y'          TO WS-F491-FND                       11090006
              END-IF                                                    11100006
           END-READ.                                                    11110006
                                                                        11120006
       3004-EXIT.                                                       11130006
            EXIT.                                                       11140006
                                                                        11150006
      *-------------------------------------------------------------    11160006
       3005-FORMAT-EMAIL.                                               11170006
      *------------------------------------------------------           11180006
                                                                        11190006
           MOVE K800-NUM-REGN            TO  F491-NUM-REGN.             11200006
           MOVE K857-NUM-EMAIL           TO  F491-NUM-EMAIL             11210006
           MOVE COMM8-NUM-BLK            TO  F491-NUM-BLK               11220006
           MOVE COMM8-NUM-LEVEL          TO  F491-NUM-LEVEL             11230006
           MOVE COMM8-NUM-UNIT-MAIN      TO  F491-NUM-MAIN-UNIT         11240006
           MOVE COMM8-NME-STREET         TO  F491-NUM-STREET            11250006
           MOVE COMM8-NUM-POSTAL-CODE    TO  F491-NUM-POSTAL            11260006
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    11270006
           MOVE K024-NME-OIC             TO  F491-NME-OIC.              11280006
           MOVE WS-DATE                  TO  F491-DTE-UPDATE.           11290006
                                                                        11300006
           WRITE BP13F491-REC.                                          11310006
                                                                        11320006
       3005-EXIT.                                                       11330006
            EXIT.                                                       11340006
                                                                        11350006
      *-------------------------------------------------------------    11360006
       3006-FORMAT-EMAIL.                                               11370006
      *------------------------------------------------------           11380006
                                                                        11390006
           MOVE K800-NUM-REGN            TO  F491-NUM-REGN.             11400006
           MOVE K857-NUM-EMAIL           TO  F491-NUM-EMAIL             11410006
           MOVE COMM8-NUM-BLK            TO  F491-NUM-BLK               11420006
           MOVE COMM8-NUM-LEVEL          TO  F491-NUM-LEVEL             11430006
           MOVE COMM8-NUM-UNIT-MAIN      TO  F491-NUM-MAIN-UNIT         11440006
           MOVE COMM8-NME-STREET         TO  F491-NUM-STREET            11450006
           MOVE COMM8-NUM-POSTAL-CODE    TO  F491-NUM-POSTAL            11460006
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    11470006
           MOVE K024-NME-OIC             TO  F491-NME-OIC.              11480006
           MOVE WS-DATE                  TO  F491-DTE-UPDATE.           11490006
                                                                        11500006
           REWRITE BP13F491-REC.                                        11510006
                                                                        11520006
       3006-EXIT.                                                       11530006
            EXIT.                                                       11540006
                                                                        11550006
      *-------------------------------------------------------------    11560006
       3050-FORMAT-MAIL-ADDR.                                           11570006
      *------------------------------------------------------           11580006
                                                                        11590006
           IF K830-NUM-MAIL-ADDR-TYPE  = 'H'                            11600006
              MOVE K830-NME-MAIL-STR-BLDG TO P491-STREET                11610006
              MOVE K830-NUM-MAIL-LVL-CHAR TO P491-CHAR                  11620006
              MOVE K830-NUM-MAIL-LVL-NUM  TO P491-LEVEL                 11630006
              MOVE K830-NUM-MAIL-LVL-DASH TO P491-DASH                  11640006
              MOVE K830-NUM-MAIL-HSEMAIN  TO P491-HSE-MAIN              11650006
              MOVE K830-NUM-MAIL-HSESUB   TO P491-HSE-SUB               11660006
           ELSE                                                         11670006
              MOVE K830-NUM-MAIL-FLAT     TO P491-FLAT-NO               11680006
              MOVE K830-NME-MAIL-STR-BLDG TO P491-STREET                11690006
           END-IF.                                                      11700006
                                                                        11710006
           MOVE K830-NUM-MAIL-BLK         TO P491-BLK.                  11720006
                                                                        11730006
           IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS      11740006
              MOVE SPACES                   TO P491-LINE05C             11750006
           ELSE                                                         11760006
              MOVE 'SINGAPORE'              TO P491-LINE05C(12:9)       11770006
           END-IF.                                                      11780006
           MOVE K830-NUM-MAIL-POSTAL      TO P491-POSTAL.               11790006
                                                                        11800006
           IF K830-NUM-MAIL-POSTAL = SPACES OR ZEROS                    11810006
              DISPLAY '- MAIL POSTAL EMPTY ' K830-NUM-MAIL-POSTAL       11820006
                      ', REGN IS ' K800-NUM-REGN.                       11830006
                                                                        11840006
       3050-EXIT.                                                       11850006
            EXIT.                                                       11860006
                                                                        11870006
                                                                        11880006
      *-------------------------------------------------------------    11890006
       3055-FORMAT-HOME-ADDR.                                           11900006
      *------------------------------------------------------           11910006
                                                                        11920006
           IF K830-NUM-ADDR-TYPE  = 'H'                                 11930006
              MOVE K830-NME-STREET      TO P491-STREET                  11940006
              MOVE K830-NUM-LVL-CHAR    TO P491-CHAR                    11950006
              MOVE K830-NUM-LVL-NUM     TO P491-LEVEL                   11960006
              MOVE K830-NUM-LVL-DASH    TO P491-DASH                    11970006
              MOVE K830-NUM-HSEMAIN     TO P491-HSE-MAIN                11980006
              MOVE K830-NUM-HSESUB      TO P491-HSE-SUB                 11990006
           ELSE                                                         12000006
              MOVE K830-NUM-FLAT        TO P491-FLAT-NO                 12010006
              MOVE K830-NME-STREET-BLDG TO P491-STREET                  12020006
           END-IF.                                                      12030006
                                                                        12040006
           MOVE K830-NUM-BLK            TO P491-BLK.                    12050006
           IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROS           12060006
              MOVE SPACES                  TO P491-LINE05C              12070006
           ELSE                                                         12080006
              MOVE 'SINGAPORE'             TO P491-LINE05C(12:9)        12090006
           END-IF.                                                      12100006
           MOVE K830-NUM-POSTAL         TO P491-POSTAL.                 12110006
                                                                        12120006
           IF K830-NUM-POSTAL = SPACES OR ZEROS                         12130006
              DISPLAY '- RES POSTAL EMPTY ' K830-NUM-MAIL-POSTAL        12140006
                      ', REGN IS ' K800-NUM-REGN.                       12150006
                                                                        12160006
                                                                        12170006
       3055-EXIT.                                                       12180006
            EXIT.                                                       12190006
                                                                        12200006
                                                                        12210006
      *-------------------------------------------------------------    12220006
       3100-PRINT-LETTER.                                               12230006
      *-------------------------------------------------------------    12240006
                                                                        12250006
      * LETTER TO BE SENT OUT FOR MONTHLY                               12260006
      *-------------------------------------------------------------    12270006
                                                                        12280006
           MOVE SPACES TO WS-TEMP-MONTH                                 12290006
           IF K100-NUM-PACD = 'M'                                       12300006
            STRING WS-TEMP-SPACE3 P491-DTE-COMPLT-MM ' '                12310006
                   P491-DTE-COMPLT-YR                                   12320006
                   DELIMITED BY SIZE INTO WS-TEMP-MONTH                 12330006
           ELSE                                                         12340006
             IF K100-NUM-PACD = 'Q'                                     12350006
                STRING WS-TEMP-SPACE3 P491-NEW-PCDQ                     12360006
                       DELIMITED BY SIZE INTO WS-TEMP-MONTH             12370006
                IF P491-REGN-NO = '3402543F' OR '1555311A'              12380006
                 MOVE SPACES TO WS-TEMP-MONTH                           12390006
                 STRING WS-TEMP-SPACE3 '4TH QUARTER ' '2020'            12400006
                   DELIMITED BY SIZE INTO WS-TEMP-MONTH                 12410006
                END-IF                                                  12420006
                IF P491-REGN-NO = '3467568F'                            12421006
                 MOVE SPACES TO WS-TEMP-MONTH                           12422006
                 STRING WS-TEMP-SPACE3 '1ST QUARTER ' '2021'            12423006
                   DELIMITED BY SIZE INTO WS-TEMP-MONTH                 12424006
                END-IF                                                  12425006
             END-IF                                                     12430006
           END-IF                                                       12440006
           ADD   1                   TO WS-BP13FY-CTR.                  12450006
           MOVE  SPACES              TO P491-PRTREC.                    12460006
           MOVE  WS-BP13FY-CTR       TO WS-RECORD-CNT.                  12470006
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-FY-PAGE1(49:4).       12480006
           MOVE  DJDE-LINE-FY-PAGE1  TO P491-PRTREC.                    12490006
           WRITE P491-PRTREC      AFTER PAGE.                           12500006
                                                                        12510006
           ADD   1                   TO WS-CNT-LETTER                   12520006
                                        WS-P491-WRT                     12530006
           WRITE P491-PRTREC FROM P491-LINE01.                          12540006
      *    MOVE '24/07/2020' TO P491-DATE.                              12550006
      *    MOVE '12/08/2020' TO P491-DATE.                              12560006
           WRITE P491-PRTREC FROM P491-LINE02.                          12570006
                                                                        12580006
           WRITE P491-PRTREC FROM P491-LINE04 AFTER 4.                  12590006
           WRITE P491-PRTREC FROM P491-LINE04B.                         12600006
           WRITE P491-PRTREC FROM P491-LINE04C.                         12610006
           WRITE P491-PRTREC FROM P491-LINE04D.                         12620006
                                                                        12630006
           WRITE P491-PRTREC FROM P491-LINE05.                          12640006
           WRITE P491-PRTREC FROM P491-LINE05B.                         12650006
           IF P491-POSTAL = SPACES                                      12660006
              MOVE SPACES   TO P491-LINE05C                             12670006
           END-IF                                                       12680006
           WRITE P491-PRTREC FROM P491-LINE05C.                         12690006
                                                                        12700006
           WRITE P491-PRTREC FROM WS-TEMP-ADDRESS1 AFTER 8.             12710006
           WRITE P491-PRTREC FROM WS-TEMP-ADDRESS2 AFTER 1.             12720006
           WRITE P491-PRTREC FROM WS-TEMP-MONTH     AFTER 14.           12730006
                                                                        12740006
           MOVE  SPACES              TO P491-PRTREC.                    12750006
           MOVE  DJDE-LINE-FX-PAGE2  TO P491-PRTREC.                    12760006
           WRITE P491-PRTREC      AFTER PAGE.                           12770006
                                                                        12780006
       3100-EXIT.                                                       12790006
           EXIT.                                                        12800006
                                                                        12810006
      *-------------------------------------------------------------    12820006
       3200-PRINT-AUDIT.                                                12830006
      *-------------------------------------------------------------    12840006
           IF WS-LINE-CNT > 55                                          12850006
           OR WS-PREV-BLK-NO NOT = F110-BLK-NO                          12860006
              PERFORM 5200-CREATE-EMAIL  THRU 5200-EXIT                 12870006
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                 12880006
           END-IF.                                                      12890006
                                                                        12900006
           MOVE SPACES                       TO L49J-DETAIL             12910006
           INITIALIZE                           L49J-DETAIL.            12920006
           ADD 2                TO WS-LINE-CNT.                         12930006
           ADD 1                TO WS-BLK-CNT.                          12940006
                                                                        12950006
           MOVE SPACES          TO L49J-PRTREC                          12960006
           INITIALIZE              L49J-PRTREC                          12970006
           MOVE WS-BLK-CNT      TO L49J-NO                              12980006
                                   WS-L49J-WRT.                         12990006
           STRING F110-SCHEME '-' F110-ACC '-' F110-CHK '-'             13000006
                  F110-ACC-TYPE                                         13010006
                  DELIMITED BY SIZE INTO L49J-SCH-ACC.                  13020006
                                                                        13030006
           MOVE F110-REGN-NO    TO L49J-REGN-NO.                        13040006
                                                                        13050006
           PERFORM VARYING WS-IDX FROM 1 BY 1                           13060006
             UNTIL WS-NAME(WS-IDX) NOT = SPACES                         13070006
                OR WS-IDX > 4                                           13080006
              CONTINUE                                                  13090006
           END-PERFORM.                                                 13100006
                                                                        13110006
           IF WS-IDX > 4                                                13120006
              MOVE 1            TO WS-IDX                               13130006
           END-IF.                                                      13140006
           MOVE WS-NAME(WS-IDX) TO L49J-NAME.                           13150006
           MOVE K800-NUM-NRIC1  TO L49J-NRIC-NO.                        13160006
           MOVE P491-BLK        TO L49J-BLK-NO.                         13170006
           MOVE P491-STREET     TO L49J-STREET.                         13180006
           MOVE P491-FLAT-NO    TO L49J-FLAT-NO.                        13190006
           MOVE P491-POSTAL     TO L49J-POSTAL-CODE.                    13200006
                                                                        13210006
           WRITE L49J-PRTREC FROM L49J-DETAIL AFTER 2.                  13220006
                                                                        13230006
       3200-EXIT.                                                       13240006
           EXIT.                                                        13250006
                                                                        13260006
      *-------------------------------------------------------------    13270006
       4000-READ-K857.                                                  13280006
      *-------------------------------------------------------------    13290006
           MOVE SPACES         TO BP13K857-REC.                         13300006
           MOVE 'N'            TO WS-FOUND-K857.                        13310006
           MOVE F110-REGN-NO   TO K857-NUM-REGN.                        13320006
           READ BP13K857.                                               13330006
                                                                        13340006
           IF K857-STATUS = 00                                          13350006
              MOVE 'Y'  TO WS-FOUND-K857                                13360006
           ELSE                                                         13370006
           IF K857-STATUS = 23                                          13380006
              MOVE 'N'  TO WS-FOUND-K857                                13390006
              DISPLAY '> NOT FOUND K857 FOR '                           13400006
                      K022-NUM-REGN                                     13410006
           ELSE                                                         13420006
              DISPLAY 'ERROR READING BP13K857, STATUS ' K857-STATUS     13430006
              MOVE K857-STATUS TO RETURN-CODE                           13440006
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 13450006
                                                                        13460006
       4000-EXIT.                                                       13470006
            EXIT.                                                       13480006
                                                                        13490006
                                                                        13500006
                                                                        13510006
      *-------------------------------------------------------------    13520006
       5000-RETRIEVE-CSM.                                               13530006
      *-------------------------------------------------------------    13540006
           MOVE K800-NUM-REGN TO K022-NUM-REGN.                         13550006
           READ BP13K022 KEY IS K022-NUM-REGN.                          13560006
                                                                        13570006
           IF K022-STATUS = 00                                          13580006
              MOVE K022-NUM-OIC TO K024-NUM-OIC                         13590006
              PERFORM 5100-READ-BP13K024 THRU 5100-EXIT                 13600006
           ELSE                                                         13610006
           IF K022-STATUS = 23                                          13620006
              DISPLAY '> CSM FOR ' K022-NUM-REGN ' NOT FOUND.'          13630006
           ELSE                                                         13640006
              DISPLAY 'ERROR READING BP13K022, STATUS ' K022-STATUS     13650006
              MOVE K022-STATUS TO RETURN-CODE                           13660006
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 13670006
                                                                        13680006
       5000-EXIT.                                                       13690006
            EXIT.                                                       13700006
                                                                        13710006
                                                                        13720006
       5100-READ-BP13K024.                                              13730006
      *-------------------------------------------------------------    13740006
           READ BP13K024 KEY IS K024-KEY-FLD.                           13750006
                                                                        13760006
           IF K024-STATUS = 00                                          13770006
              MOVE K024-NME-OIC TO P491-NME-OIC                         13780006
              MOVE K024-NUM-DID TO P491-OIC-TEL                         13790006
              CONTINUE                                                  13800006
           ELSE                                                         13810006
           IF K024-STATUS = 23                                          13820006
              DISPLAY '> CSM DETAIL OF ' K024-NUM-OIC ' FOR '           13830006
                      K022-NUM-REGN ' NOT FOUND.'                       13840006
           ELSE                                                         13850006
              DISPLAY 'ERROR READING BP13K024, STATUS ' K024-STATUS     13860006
              MOVE K024-STATUS TO RETURN-CODE                           13870006
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 13880006
                                                                        13890006
       5100-EXIT.                                                       13900006
            EXIT.                                                       13910006
                                                                        13920006
      *================================================================*13930006
       5200-CREATE-EMAIL.                                               13940006
      *================================================================*13950006
                                                                        13960006
            WRITE L49J-PRTREC  FROM WS-MAIL-RPT1                        13970006
            WRITE L49J-PRTREC  FROM WS-MAIL-RPT2                        13980006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT3                        13990006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT4                        14000006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT4A                       14010006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT4B                       14020006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT9                        14030006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT10                       14040006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT11                       14050006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT12                       14060006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT12A                      14070006
      *     WRITE L49J-PRTREC  FROM WS-MAIL-RPT12B                      14080006
                                                                        14090006
      *     MOVE   WS-MAIL-RPT17  TO L49J-PRTREC                        14100006
      *     WRITE L49J-PRTREC                                           14110006
                                                                        14120006
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)       14130006
                   DELIMITED BY SIZE INTO WS-DATE-RPT                   14140006
            WRITE L49J-PRTREC  FROM WS-DATE-RPT-DTL                     14150006
            MOVE SPACES TO  L49J-PRTREC                                 14160006
            WRITE   L49J-PRTREC.                                        14170006
                                                                        14180006
       5200-EXIT.                                                       14190006
            EXIT.                                                       14200006
                                                                        14210006
      *-------------------------------------------------------------    14220006
       6000-PRINT-HEADING.                                              14230006
      *-------------------------------------------------------------    14240006
           ADD  1                    TO WS-PAGE-CNT.                    14250006
           MOVE WS-PAGE-CNT          TO L49J-PAGE.                      14260006
           MOVE F110-BLK-NO          TO L49J-BLOCK.                     14270006
           MOVE COMM8-NME-STREET     TO L49J-STREET-NAME.               14280006
                                                                        14290006
           MOVE  8                   TO WS-LINE-CNT.                    14300006
                                                                        14310006
           IF WS-PREV-BLK-NO  NOT = F110-BLK-NO                         14320006
              ADD WS-BLK-CNT         TO WS-TOTAL-CNT                    14330006
              INITIALIZE                WS-BLK-CNT                      14340006
           END-IF.                                                      14350006
           MOVE F110-BLK-NO          TO WS-PREV-BLK-NO.                 14360006
                                                                        14370006
           MOVE SPACES               TO L49J-PRTREC.                    14380006
           INITIALIZE                   L49J-PRTREC                     14390006
           WRITE L49J-PRTREC         FROM L49J-HDR01 AFTER PAGE.        14400006
           WRITE L49J-PRTREC         FROM L49J-HDR02.                   14410006
           WRITE L49J-PRTREC         FROM L49J-HDR03 AFTER 2.           14420006
           WRITE L49J-PRTREC         FROM L49J-HDR04 AFTER 2.           14430006
           MOVE ALL '='              TO L49J-PRTREC.                    14440006
           WRITE L49J-PRTREC            AFTER 1.                        14450006
                                                                        14460006
       6000-EXIT.                                                       14470006
            EXIT.                                                       14480006
                                                                        14490006
      *-------------------------------------------------------------    14500006
       8100-READ-K800.                                                  14510006
      *-------------------------------------------------------------    14520006
           READ BP13K800 KEY IS K800-NUM-REGN.                          14530006
                                                                        14540006
           EVALUATE K800-STATUS                                         14550006
               WHEN 00                                                  14560006
               WHEN 02                                                  14570006
                    CONTINUE                                            14580006
               WHEN 10                                                  14590006
               WHEN 23                                                  14600006
                    ADD  1                  TO WS-CNT-K800-MISS         14610006
                    DISPLAY 'K800 REC NOT FOUND : ' F110-REGN-NO        14620006
                            ' ; ' F110-SCH-ACC-NO                       14630006
                    SET WS-ERROR            TO TRUE                     14640006
                    GO TO 8100-EXIT                                     14650006
               WHEN OTHER                                               14660006
                    MOVE K800-STATUS              TO RETURN-CODE        14670006
                    DISPLAY 'ERROR READING BP13K800, STATUS '           14680006
                             K800-STATUS                                14690006
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            14700006
           END-EVALUATE.                                                14710006
                                                                        14720006
       8100-EXIT.                                                       14730006
            EXIT.                                                       14740006
                                                                        14750006
      *-------------------------------------------------------------    14760006
       8200-READ-K820.                                                  14770006
      *-------------------------------------------------------------    14780006
           READ BP13K820 KEY IS K820-KEY-FLD.                           14790006
                                                                        14800006
           EVALUATE K820-STATUS                                         14810006
               WHEN 00                                                  14820006
               WHEN 02                                                  14830006
                    CONTINUE                                            14840006
               WHEN 10                                                  14850006
               WHEN 23                                                  14860006
                    MOVE SPACES             TO K820-NME-OCCP            14870006
                    ADD  1                  TO WS-CNT-K820-MISS         14880006
                    DISPLAY 'K820 REC NOT FOUND : ' K800-NUM-REGN       14890006
                    GO TO 8200-EXIT                                     14900006
               WHEN OTHER                                               14910006
                    MOVE K820-STATUS              TO RETURN-CODE        14920006
                    DISPLAY 'ERROR READING BP13K820, STATUS '           14930006
                             K820-STATUS                                14940006
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            14950006
           END-EVALUATE.                                                14960006
                                                                        14970006
       8200-EXIT.                                                       14980006
            EXIT.                                                       14990006
                                                                        15000006
      *-------------------------------------------------------------    15010006
       8300-READ-K830.                                                  15020006
      *-------------------------------------------------------------    15030006
           READ BP13K830 KEY IS K830-NUM-REGN.                          15040006
                                                                        15050006
           EVALUATE K830-STATUS                                         15060006
               WHEN 00                                                  15070006
               WHEN 02                                                  15080006
                    CONTINUE                                            15090006
               WHEN 10                                                  15100006
               WHEN 23                                                  15110006
                    MOVE SPACES             TO BP13K830-REC             15120006
                    ADD  1                  TO WS-CNT-K830-MISS         15130006
                    DISPLAY 'REGN-NUM' K830-NUM-REGN                    15140006
                    DISPLAY 'K830 REC NOT FOUND : ' K800-NUM-NRIC1      15150006
                                                    K800-NUM-NRIC2      15160006
                    SET WS-ERROR            TO TRUE                     15170006
                    GO TO 8300-EXIT                                     15180006
               WHEN OTHER                                               15190006
                    MOVE K830-STATUS              TO RETURN-CODE        15200006
                    DISPLAY 'ERROR READING BP13K830, STATUS '           15210006
                             K830-STATUS                                15220006
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            15230006
           END-EVALUATE.                                                15240006
                                                                        15250006
       8300-EXIT.                                                       15260006
            EXIT.                                                       15270006
                                                                        15280006
      *-------------------------------------------------------------    15290006
       8400-READ-K510.                                                  15300006
      *-------------------------------------------------------------    15310006
                                                                        15320006
           READ BM06K510 KEY IS K510-ESTCDE.                            15330006
                                                                        15340006
           EVALUATE K510-STATUS                                         15350006
               WHEN 00                                                  15360006
               WHEN 02                                                  15370006
                    CONTINUE                                            15380006
               WHEN 10                                                  15390006
               WHEN 23                                                  15400006
                    ADD  1                  TO WS-CNT-K510-MISS         15410006
                    DISPLAY 'K510 REC NOT FOUND : ' K510-ESTCDE         15420006
                    GO TO 8400-EXIT                                     15430006
               WHEN OTHER                                               15440006
                    MOVE K510-STATUS              TO RETURN-CODE        15450006
                    DISPLAY 'ERROR READING BM06K510, STATUS '           15460006
                             K510-STATUS                                15470006
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            15480006
           END-EVALUATE.                                                15490006
                                                                        15500006
       8400-EXIT.                                                       15510006
            EXIT.                                                       15520006
                                                                        15530006
      *-------------------------------------------------------------    15540006
       8500-READ-K100.                                                  15550006
      *-------------------------------------------------------------    15560006
                                                                        15570006
           READ BM06K100 KEY IS K100-KEY-FLD.                           15580006
                                                                        15590006
           EVALUATE K100-STATUS                                         15600006
               WHEN 00                                                  15610006
               WHEN 02                                                  15620006
                    CONTINUE                                            15630006
               WHEN 10                                                  15640006
               WHEN 23                                                  15650006
                    ADD  1                  TO WS-CNT-K100-MISS         15660006
                    DISPLAY 'K100 REC NOT FOUND : ' K100-KEY-FLD        15670006
                    GO TO 8500-EXIT                                     15680006
               WHEN OTHER                                               15690006
                    MOVE K100-STATUS              TO RETURN-CODE        15700006
                    DISPLAY 'ERROR READING BM06K100, STATUS '           15710006
                             K100-STATUS                                15720006
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            15730006
           END-EVALUATE.                                                15740006
                                                                        15750006
       8500-EXIT.                                                       15760006
            EXIT.                                                       15770006
                                                                        15780006
      *-------------------------------------------------------------    15790006
       9900-HANDLE-ABEND.                                               15800006
      *-------------------------------------------------------------    15810006
                                                                        15820006
           DISPLAY ' '.                                                 15830006
           DISPLAY '- BP13C491 CONTROL TOTAL -------------'.            15840006
           DISPLAY 'TOTAL BM06F110 RECS READ  = ' WS-CNT-F110-READ.     15850006
           DISPLAY 'TOTAL LETTERS PRINTED     = ' WS-CNT-LETTER.        15860006
           DISPLAY 'TOTAL MISSING K800 REC    = ' WS-CNT-K800-MISS.     15870006
           DISPLAY 'TOTAL MISSING K820 REC    = ' WS-CNT-K820-MISS.     15880006
           DISPLAY 'TOTAL MISSING K830 REC    = ' WS-CNT-K830-MISS.     15890006
           DISPLAY 'TOTAL MISSING K510 REC    = ' WS-CNT-K510-MISS.     15900006
           DISPLAY 'TOTAL MISSING K100 REC    = ' WS-CNT-K100-MISS.     15910006
           DISPLAY 'TOTAL CASES WITH EMAIL    = ' WS-CNT-K857-W-EMAIL.  15920006
           DISPLAY 'TOTAL CASES WRITEN K491   = ' WS-F491-WRT.          15930006
           DISPLAY 'TOTAL CASES REWRITE K491  = ' WS-F491-REWRITE.      15940006
           DISPLAY 'TOTAL CASES WRITEN L49J   = ' WS-L49J-WRT.          15950006
           DISPLAY 'TOTAL CASES WRITEN P491   = ' WS-P491-WRT.          15960006
                                                                        15970006
           CLOSE BP13K022                                               15980006
                 BP13K024                                               15990006
                 BP13K800                                               16000006
                 BP13K820                                               16010006
                 BP13K830                                               16020006
                 BM06F110                                               16030006
                 BP13K491                                               16040006
                 BP13F491                                               16050006
                 BP13L49J                                               16060006
                 BP13P491.                                              16070006
                                                                        16080006
           IF K022-STATUS NOT = 00 AND 97                               16090006
              MOVE K022-STATUS TO RETURN-CODE                           16100006
              DISPLAY 'CLOSE FAILED FOR BP13K022 ' K022-STATUS          16110006
           END-IF.                                                      16120006
                                                                        16130006
           IF K024-STATUS NOT = 00 AND 97                               16140006
              MOVE K024-STATUS TO RETURN-CODE                           16150006
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K024-STATUS          16160006
           END-IF.                                                      16170006
                                                                        16180006
           IF K800-STATUS NOT = 00 AND 97                               16190006
              MOVE K800-STATUS TO RETURN-CODE                           16200006
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K800-STATUS          16210006
           END-IF.                                                      16220006
                                                                        16230006
           IF K820-STATUS NOT = 00 AND 97                               16240006
              MOVE K820-STATUS TO RETURN-CODE                           16250006
              DISPLAY 'CLOSE FAILED FOR BP13K820 ' K820-STATUS          16260006
           END-IF.                                                      16270006
                                                                        16280006
           IF K830-STATUS NOT = 00 AND 97                               16290006
              MOVE K830-STATUS TO RETURN-CODE                           16300006
              DISPLAY 'CLOSE FAILED FOR BP13K830 ' K830-STATUS          16310006
           END-IF.                                                      16320006
                                                                        16330006
           IF K510-STATUS NOT = 00 AND 97                               16340006
              DISPLAY 'CLOSE FAILED FOR BM06K510 ' K510-STATUS          16350006
              MOVE K510-STATUS TO RETURN-CODE.                          16360006
                                                                        16370006
           IF K100-STATUS NOT = 00 AND 97                               16380006
              DISPLAY 'CLOSE FAILED FOR BM06K100 ' K100-STATUS          16390006
              MOVE K100-STATUS TO RETURN-CODE.                          16400006
                                                                        16410006
           IF K857-STATUS NOT = 00 AND 97                               16420006
              DISPLAY 'CLOSE FAILED FOR BP13K857 ' K857-STATUS          16430006
              MOVE K857-STATUS TO RETURN-CODE.                          16440006
           STOP RUN.                                                    16450006
                                                                        16460006
       9900-EXIT.                                                       16470006
            EXIT.                                                       16480006
                                                                        16490006
      *-------------------------------------------------------------    16500006
       9999-WRAP-UP.                                                    16510006
      *-------------------------------------------------------------    16520006
           ADD WS-BLK-CNT                        TO WS-TOTAL-CNT.       16530006
           MOVE WS-TOTAL-CNT                     TO L49J-TOTAL.         16540006
           WRITE L49J-PRTREC FROM L49J-PRT-TOTAL AFTER 2.               16550006
                                                                        16560006
           DISPLAY ' '.                                                 16570006
           DISPLAY '- BP13C49J CONTROL TOTAL -------------'.            16580006
           DISPLAY ' TOTAL BM06F110 REC READ : ' WS-CNT-F110-READ.      16590006
           DISPLAY ' TOTAL LETTERS PRINTED   : ' WS-CNT-LETTER.         16600006
           DISPLAY ' TOTAL MISSING K800 REC  : ' WS-CNT-K800-MISS.      16610006
           DISPLAY ' TOTAL MISSING K820 REC  : ' WS-CNT-K820-MISS.      16620006
           DISPLAY ' TOTAL MISSING K830 REC  : ' WS-CNT-K830-MISS.      16630006
           DISPLAY ' TOTAL MISSING K510 REC  : ' WS-CNT-K510-MISS.      16640006
           DISPLAY ' TOTAL MISSING K100 REC  : ' WS-CNT-K100-MISS.      16650006
           DISPLAY ' TOTAL CASES WITH EMAIL  : ' WS-CNT-K857-W-EMAIL.   16660006
           DISPLAY ' TOTAL CASES WRITEN K491 :  ' WS-F491-WRT.          16670006
           DISPLAY ' TOTAL CASES REWRITE K491 : ' WS-F491-REWRITE.      16680006
           DISPLAY ' TOTAL CASES WRITEN L49J  : ' WS-L49J-WRT.          16690006
           DISPLAY ' TOTAL CASES WRITEN P491  : ' WS-P491-WRT.          16700006
                                                                        16710006
           CLOSE BP13K022                                               16720006
                 BP13K024                                               16730006
                 BP13K800                                               16740006
                 BP13K820                                               16750006
                 BP13K830                                               16760006
                 BM06K510                                               16770006
                 BM06K100                                               16780006
                 BM06F110                                               16790006
                 BP13K857                                               16800006
                 BP13K491                                               16810006
                 BP13L49J                                               16820006
                 BP13P491.                                              16830006
                                                                        16840006
           IF K491-STATUS NOT = 00 AND 97                               16850006
              DISPLAY 'CLOSE FAILED FOR BP13K491 ' K491-STATUS          16860006
              MOVE K491-STATUS TO RETURN-CODE.                          16870006
                                                                        16880006
                                                                        16890006
           IF K022-STATUS NOT = 00 AND 97                               16900006
              DISPLAY 'CLOSE FAILED FOR BP13K022 ' K022-STATUS          16910006
              MOVE K022-STATUS TO RETURN-CODE.                          16920006
                                                                        16930006
           IF K024-STATUS NOT = 00 AND 97                               16940006
              DISPLAY 'CLOSE FAILED FOR BP13K024 ' K024-STATUS          16950006
              MOVE K024-STATUS TO RETURN-CODE.                          16960006
                                                                        16970006
           IF K800-STATUS NOT = 00 AND 97                               16980006
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K800-STATUS          16990006
              MOVE K800-STATUS TO RETURN-CODE.                          17000006
                                                                        17010006
           IF K820-STATUS NOT = 00 AND 97                               17020006
              DISPLAY 'CLOSE FAILED FOR BP13K820 ' K820-STATUS          17030006
              MOVE K820-STATUS TO RETURN-CODE.                          17040006
                                                                        17050006
           IF K830-STATUS NOT = 00 AND 97                               17060006
              DISPLAY 'CLOSE FAILED FOR BP13K830 ' K830-STATUS          17070006
              MOVE K830-STATUS TO RETURN-CODE.                          17080006
                                                                        17090006
           IF K510-STATUS NOT = 00 AND 97                               17100006
              DISPLAY 'CLOSE FAILED FOR BM06K510 ' K510-STATUS          17110006
              MOVE K510-STATUS TO RETURN-CODE.                          17120006
                                                                        17130006
           IF K100-STATUS NOT = 00 AND 97                               17140006
              DISPLAY 'CLOSE FAILED FOR BM06K100 ' K100-STATUS          17150006
              MOVE K100-STATUS TO RETURN-CODE.                          17160006
                                                                        17170006
           IF K857-STATUS NOT = 00 AND 97                               17180006
              DISPLAY 'CLOSE FAILED FOR BP13K857 ' K857-STATUS          17190006
              MOVE K857-STATUS TO RETURN-CODE.                          17200006
           STOP RUN.                                                    17210006
                                                                        17220006
       9999-EXIT.                                                       17230006
            EXIT.                                                       17240006
