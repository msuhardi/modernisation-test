       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CY56.                                                 
       AUTHOR.        JIANG BO.                                                 
       DATE-WRITTEN.  03/07/09.                                                 
                                                                                
      **********************************************************                
      *                                                        *                
      *  SYSTEM NAME : SYSTEM OF COMMITMENT                    *                
      *                                                        *                
      *  SYSTEM ID   : BP13                                    *                
      *                                                        *                
      *  OBJECTIVE   : OUTPUT REPORT  WITH TITLE               *                
      *                                                        *                
      *  CHG-NO  BY   DATE   DESCRIPTION                       *                
      * -------- ---- ------ -------------------               *                
      * BP133653 JB8  030709 NEW PROGRAM                       *                
      * BP133891 PCL3 150710 TO OUTPUT CITIZENSHIP-HOUSEHOLD   *                
      * BP134395 ZDD1 191011 TO ADD HH INCOME                  *                
      * BP134495 IMC1 020712 TO ADD REJ DATE AND REASON        *                
      * BP134803 IMC1 210213 TO ADD CHILD INFO,APPS,MCPS,MGPS, *                
      *                      PPS                               *                
      * BP13     IMC1 211114 TO PPS, YOUNG CHILD SC, FT2T      *                
      * BP13     IMC1 271114 TO INCLUDE PROJECT NAME           *                
      * BP136005 FNP1 301015 TO INCLUDE PCD QTR AND TENURE     *                
      * BP136320 ZDD1 270416 TO INCLUDE PCD FT STAT/PROTECTED  *                
      *                         BLK NO                         *                
      * BP136252 FNP1 050716 REMOVE DASH IN SCH ACCT           *                
      **********************************************************                
                                                                                
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F557 ASSIGN TO BP13F557.                                  
                                                                                
           SELECT BP13L557 ASSIGN TO BP13L557.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F557                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 400 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F557.                                                           
                                                                                
       FD   BP13L557                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            LABEL RECORDS ARE OMITTED                                           
            RECORDING MODE IS F.                                                
       01   BP13L557-REC                  PIC X(500).                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-EOF-F557                PIC X(01)   VALUE SPACE.              
               88  F557-EOF               VALUE 'Y'.                            
                                                                                
       01  WS-COUNTERS.                                                         
           05  CNT-F557-READ              PIC 9(07)   VALUE ZEROES.             
           05  CNT-F557A-WRITE            PIC 9(07)   VALUE ZEROES.             
           05  CNT-F557B-WRITE            PIC 9(07)   VALUE ZEROES.             
           05  CNT-F557C-WRITE            PIC 9(07)   VALUE ZEROES.             
           05  WS-SNO-A                   PIC 9(07)   VALUE ZEROES.             
           05  WS-SNO-B                   PIC 9(07)   VALUE ZEROES.             
           05  WS-SNO-C                   PIC 9(07)   VALUE ZEROES.             
                                                                                
       01  WS-REPORT-TITLE.                                                     
           05  P13F557A-TITLE.                                                  
               10  F557A-TITLE01.                                               
                   20  FILLER             PIC X(53)   VALUE ';;;;;;'.           
                   20  FILLER             PIC X(33)   VALUE                     
                       'DATE;   DATE;            ;    SOC'.                     
                   20  FILLER             PIC X(32)   VALUE ';;;;;'.            
                   20  FILLER             PIC X(03)   VALUE 'TYP'.              
                   20  FILLER             PIC X(32)   VALUE ';;'.               
                   20  FILLER             PIC X(42)   VALUE                     
                       'DATE;        HA1;  HA2;  HA3;  HA4;    HA1'.            
                   20  FILLER             PIC X(38)   VALUE                     
                       ';    HA2;    HA3;    HA4; HH; ALC; ELG'.                
                   20  FILLER             PIC X(42)   VALUE                     
                       ';;            SMS;         SMS;  SMS; SALE'.            
                   20  FILLER             PIC X(44)   VALUE                     
                       '; SMS; SMS;  SMS;        RSL;        RSL; HH'.          
                   20  FILLER             PIC X(33)   VALUE                     
                       ';  HH ;   HA1;;        CHLD;  YC;'.                     
               10  F557A-TITLE02.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       ';     SNO; REGN NO;  SCH ACCT NO;    NRIC1;   '.        
                   20  FILLER             PIC X(43)   VALUE                     
                       '  MOD; QUARTR; ACCEPTANCE; NEIGH; CONTRACT;'.           
                   20  FILLER             PIC X(41)   VALUE                     
                       ' NT;  FT; HH; ESTATE;               DSC; '.             
                   20  FILLER             PIC X(46)   VALUE                     
                       'MODLE DESIGN DESCRIPTION;     HANDOVER;HA1 AGE'.        
                   20  FILLER             PIC X(42)   VALUE                     
                       ';  AGE;  AGE;  AGE; INCOME; INCOME; INCOME'.            
                   20  FILLER             PIC X(43)   VALUE                     
                       '; INCOME; SZ; SCH; SCH; ETHNIC;     HDB REF'.           
                   20  FILLER             PIC X(43)   VALUE                     
                       ';     TOWN; EST; TYPE; FT;  ROLE; EFFECTIVE'.           
                   20  FILLER             PIC X(43)   VALUE                     
                       ';  EFFECTIVE;  FT;  CTZ; INC;   MT;  CHILD'.            
                   20  FILLER             PIC X(44)   VALUE                     
                       ';  CTZ;  SC;   APPS; MCPS; MGPS; PPS;  PPSQ'.           
                   20  FILLER             PIC X(41)   VALUE                     
                       ';FT2T; PROJECT NAME                      '.             
                   20  FILLER             PIC X(35)   VALUE                     
                       '                ; PCD QTR  ; TENURE'.                   
                   20  FILLER             PIC X(33)   VALUE                     
                       ';BLK NO;FT STAT;PROT STAT;ELDERLY'.                     
               10  F557A-TITLE03.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       '  =======  ========  ==============  ========='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '  ===  ======  ==========  ========  ===  ==  '.        
                   20  FILLER             PIC X(45)   VALUE                     
                       '==  ====================  ===  =============='.         
                   20  FILLER             PIC X(46)   VALUE                     
                       '==============  ==========  ====  ====  ====  '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '====  ======  ======  ======  ======  ==  === '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       ' ===  =========   ===========  ====  ===  ===='.        
                   20  FILLER             PIC X(45)   VALUE                     
                       '  ===  ====  ==========  ==========  ===  ==='.         
      *            20  FILLER             PIC X(45)   VALUE                     
      *                '  ===  ====  ==========  ==========  ===  ==='.         
                   20  FILLER             PIC X(45)   VALUE                     
                       '  =====  ===  =====  =====  =====  ====  ===='.         
                   20  FILLER             PIC X(45)   VALUE                     
                       '  ====  ====  ====   ====  =================='.         
                   20  FILLER             PIC X(45)   VALUE                     
                       '=================================           '.          
           05  P13F557B-TITLE.                                                  
               10  F557B-TITLE01.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       ';;;;;;                                        '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '       DATE;   DATE;       DATE;            ; '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '   SOC;;;;                            TYP;;;  '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '                           DATE;        HA1;  '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       'HA2;  HA3;  HA4;    HA1;    HA2;    HA3;    HA'.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '4; HH; ALC; ELG;              HH;  HH;   HA1'.          
               10  F557B-TITLE02.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       ';     SNO; REGN NO;  SCH ACCT NO;    NRIC1;   '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '  MOD; QUARTR; ACCEPTANCE; TP;         NEIGH; '.        
                   20  FILLER             PIC X(09)   VALUE                     
                       'CONTRACT;'.                                             
                   20  FILLER             PIC X(43)   VALUE                     
                       'NT;  FT; HH; ESTATE;               DSC; MOD'.           
                   20  FILLER             PIC X(46)   VALUE                     
                       'LE DESIGN DESCRIPTION;     HANDOVER;    AGE;  '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       'AGE;  AGE;  AGE; INCOME; INCOME; INCOME; INCOM'.        
                   20  FILLER             PIC X(43)   VALUE                     
                       'E; SZ; SCH; SCH; ETHNIC;     CTZ;INC;   MT'.            
                   20  FILLER             PIC X(29)   VALUE                     
                       ';  CHILD; PCD QTR  ; TENURE; '.                         
                   20  FILLER             PIC X(33)   VALUE                     
                       'BLK NO;FT STAT; PROT STAT;ELDERLY'.                     
               10  F557B-TITLE03.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       '  =======  ========  ==============  ========='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '  ===  ======  ==========  ==========  ======='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '=  ===  ==  ==  ====================  ===  ==='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '=========================  ==========  ====  ='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '===  ====  ====  ======  ======  ======  ====='.        
                   20  FILLER             PIC X(44)   VALUE                     
                       '=  ==  ===  ===  =========   ===  =====  ==='.          
                   20  FILLER             PIC X(07)   VALUE                     
                       '  ====='.                                               
           05  P13F557C-TITLE.                                                  
               10  F557C-TITLE01.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       ';;;;;;                                        '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '       DATE;   DATE;       DATE;       REJ;   '.        
                   20  FILLER             PIC X(18)   VALUE                     
                       '     REJ;         '.                                    
                   20  FILLER             PIC X(46)   VALUE                     
                       ';     SOC;;;;;                           TYP;;'.        
                   20  FILLER             PIC X(3)   VALUE                      
                       '   '.                                                   
                   20  FILLER             PIC X(46)   VALUE                     
                       '                           ALC; DATE;        H'.        
                   20  FILLER             PIC X(46)   VALUE                     
                       'A1;  HA2;  HA3;  HA4;    HA1;    HA2;    HA3; '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '   HA4; HH; ALC; ELG;           ;NEW FLAT;;;;;'.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '                               HH;  HH;    HA1'.        
               10  F557C-TITLE02.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       ';     SNO; REGN NO;  SCH ACCT NO;    NRIC1;   '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '  MOD; QUARTR; CANCEL;     ACCEPTANCE; REJECTI'.        
                   20  FILLER             PIC X(29)   VALUE                     
                       'ON;  REASON; NEIGH; CONTRACT;'.                         
                   20  FILLER             PIC X(45)   VALUE                     
                       '  NT;  FT; HH; ESTATE;               DSC; MOD'.         
                   20  FILLER             PIC X(46)   VALUE                     
                       'LE DESIGN DESCRIPTION;     TAG; HANDOVER;    A'.        
                   20  FILLER             PIC X(46)   VALUE                     
                       'GE;  AGE;  AGE;  AGE; INCOME; INCOME; INCOME; '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       'INCOME; SZ; SCH; SCH; ETHNIC;    REGN;     QUA'.        
                   20  FILLER             PIC X(46)   VALUE                     
                       'RTR; NT;  FT;  SCH ACC;        CTZ; INC;   MT;'.        
                   20  FILLER             PIC X(15)   VALUE                     
                       '  CHILD; TENURE'.                                       
                   20  FILLER             PIC X(33)   VALUE                     
                       ';BLK NO;FT STAT;PROT STAT;ELDERLY'.                     
               10  F557C-TITLE03.                                               
                   20  FILLER             PIC X(46)   VALUE                     
                       '  =======  ========  ==============  ========='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '  ===  ======  ==========  ==========  ======='.        
                   20  FILLER             PIC X(21)   VALUE                     
                       '===  ======  ========'.                                 
                   20  FILLER             PIC X(46)   VALUE                     
                       '   ===  ==  ==  ====================  ===  ==='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '=========================  ===  ==========  =='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '==  ====  ====  ====  ======  ======  ======  '.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '======  ==  ===  ===  =========  ========  ==='.        
                   20  FILLER             PIC X(46)   VALUE                     
                       '===  ===  ===  ==============  ===  =====  ==='.        
                   20  FILLER             PIC X(07)   VALUE                     
                       '  ====='.                                               
                                                                                
       01  WS-REPORT-FORMAT.                                                    
           05  P13F557A-FORMAT.                                                 
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-SNO                      PIC ZZZZZZ9.                  
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-REGN                 PIC X(08).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-SCH-ACCNT            PIC X(11).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557A-NUM-NRIC1                PIC X(09).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-CDE-SALES-MODE           PIC X(03).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-DTE-QUARTER              PIC X(06).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-DTE-ACCEPTANCE           PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NEIGHBOURHOOD            PIC X(04).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-CONTRACT                 PIC X(04).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-TOWN                 PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-FLAT-TYPE            PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-HH                   PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-DESC-ESTATE              PIC X(20).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-CDE-TYP-DESG             PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-DESC-MODL-DESG           PIC X(28).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-DTE-HANDOVER             PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-AGE-HA1              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-AGE-HA2              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-AGE-HA3              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-AGE-HA4              PIC ZZZ9.                     
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-AMT-INCOME-HA1           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-AMT-INCOME-HA2           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-AMT-INCOME-HA3           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-AMT-INCOME-HA4           PIC ZZZZ9.                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-HH-SIZE              PIC Z9.                       
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-ALLO-SCHEME          PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-ELIG-SCHEME          PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-ETHNIC               PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-HDBREF-SMS-HA1       PIC X(11).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-TOWN-SMS-HA1         PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-NUM-ESTATE-SMS-HA1       PIC X(03).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-SALE-TYPE-SMS-HA1    PIC X(03).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-FT-SMS-HA1           PIC X(02).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-ROLE-SMS-HA1         PIC X(02).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-DTE-SALE-EFF-SMS-HA1     PIC X(10).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-DTE-SALE-EFF-RSL-HA1     PIC X(10).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-FT-RSL-HA1           PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-CDE-CTZ-HH               PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-AMT-INC-HH               PIC ZZZZ9.                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557A-CDE-MARITAL-STAT         PIC X(01).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557A-NUM-CHILD                PIC X(02).                    
               10  FILLER                         PIC X(06) VALUE '; '.         
               10  F557A-NUM-CHILD-CTZ            PIC X(03).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-AGE-YOUNGEST         PIC X(03).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557A-NUM-APPS                 PIC X(01).                    
               10  FILLER                         PIC X(06) VALUE '; '.         
               10  F557A-NUM-MCPS                 PIC X(01).                    
               10  FILLER                         PIC X(06) VALUE '; '.         
               10  F557A-NUM-MGPS                 PIC X(01).                    
               10  FILLER                         PIC X(06) VALUE '; '.         
               10  F557A-NUM-PPS                  PIC X(01).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557A-NUM-PPS-QUOTA            PIC X(01).                    
               10  FILLER                         PIC X(06) VALUE '; '.         
               10  F557A-NUM-FT2T                 PIC X(01).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557A-NUM-PROJECT              PIC X(50).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-DTE-PCD                  PIC X(10).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557A-NUM-LEASE-TENURE         PIC X(02).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557A-NUM-BLK-NO               PIC X(05).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557A-NUM-FLAT-STATUS          PIC X(11).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-NUM-PROTECTED            PIC X(12).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557A-NUM-ELDERLY              PIC X(01).                    
           05  P13F557B-FORMAT.                                                 
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-SNO                      PIC ZZZZZZ9.                  
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-REGN                 PIC X(08).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557B-NUM-SCH-ACCNT            PIC X(11).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557B-NUM-NRIC1                PIC X(09).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-CDE-SALES-MODE           PIC X(03).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557B-DTE-QUARTER              PIC X(06).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557B-DTE-ACCEPTANCE           PIC X(10).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557B-DTE-TP                   PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NEIGHBOURHOOD            PIC X(04).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-CONTRACT                 PIC X(04).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-TOWN                 PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-FLAT-TYPE            PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-HH                   PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-DESC-ESTATE              PIC X(20).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-CDE-TYP-DESG             PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-DESC-MODL-DESG           PIC X(28).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557B-DTE-HANDOVER             PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-AGE-HA1              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-AGE-HA2              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-AGE-HA3              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-AGE-HA4              PIC ZZZ9.                     
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557B-AMT-INCOME-HA1           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557B-AMT-INCOME-HA2           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557B-AMT-INCOME-HA3           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557B-AMT-INCOME-HA4           PIC ZZZZ9.                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-HH-SIZE              PIC Z9.                       
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-ALLO-SCHEME          PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-ELIG-SCHEME          PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-NUM-ETHNIC               PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-CDE-CTZ-HH               PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-AMT-INC-HH               PIC ZZZZ9.                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557B-CDE-MARITAL-STAT         PIC X(01).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557B-NUM-CHILD                PIC X(02).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557B-DTE-PCD                  PIC X(10).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557B-NUM-LEASE-TENURE         PIC X(02).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557B-NUM-BLK-NO               PIC X(05).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557B-NUM-FLAT-STATUS          PIC X(11).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557B-NUM-PROTECTED            PIC X(12).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557B-NUM-ELDERLY              PIC X(01).                    
           05  P13F557C-FORMAT.                                                 
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-SNO                      PIC ZZZZZZ9.                  
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-REGN                 PIC X(08).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-SCH-ACCNT            PIC X(11).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557C-NUM-NRIC1                PIC X(09).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-CDE-SALES-MODE           PIC X(03).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557C-DTE-QUARTER              PIC X(06).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557C-DTE-CANCEL               PIC X(10).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557C-DTE-ACCEPTANCE           PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-REJ-DTE                  PIC X(10).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557C-REJ-REASON               PIC X(02).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557C-NEIGHBOURHOOD            PIC X(08).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557C-CONTRACT                 PIC X(04).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557C-NUM-TOWN                 PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-FLAT-TYPE            PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-HH                   PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-DESC-ESTATE              PIC X(20).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-CDE-TYP-DESG             PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-DESC-MODL-DESG           PIC X(28).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-ALLOC-TAG            PIC X(02).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557C-DTE-HANDOVER             PIC X(10).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-AGE-HA1              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-AGE-HA2              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-AGE-HA3              PIC ZZZ9.                     
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-AGE-HA4              PIC ZZZ9.                     
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557C-AMT-INCOME-HA1           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557C-AMT-INCOME-HA2           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557C-AMT-INCOME-HA3           PIC ZZZZ9.                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557C-AMT-INCOME-HA4           PIC ZZZZ9.                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-HH-SIZE              PIC Z9.                       
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-ALLO-SCHEME          PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-ELIG-SCHEME          PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-ETHNIC               PIC X(10).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557C-NUM-REGN-NEW-FLAT        PIC X(08).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557C-DTE-QTR-NEW-FLAT         PIC X(06).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-NT-NEW-FLAT          PIC X(03).                    
               10  FILLER                         PIC X(03) VALUE '; '.         
               10  F557C-NUM-FT-NEW-FLAT          PIC X(02).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-NUM-SCH-ACC-NEW-FLAT     PIC X(14).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-CDE-CTZ-HH               PIC X(03).                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-AMT-INC-HH               PIC ZZZZ9.                    
               10  FILLER                         PIC X(02) VALUE '; '.         
               10  F557C-CDE-MARITAL-STAT         PIC X(01).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557C-NUM-CHILD                PIC X(02).                    
               10  FILLER                         PIC X(04) VALUE '; '.         
               10  F557C-NUM-LEASE-TENURE         PIC X(02).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557C-NUM-BLK-NO               PIC X(05).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557C-NUM-FLAT-STATUS          PIC X(11).                    
               10  FILLER                         PIC X(05) VALUE ';'.          
               10  F557C-NUM-PROTECTED            PIC X(12).                    
               10  FILLER                         PIC X(01) VALUE ';'.          
               10  F557C-NUM-ELDERLY              PIC X(01).                    
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
                                                                                
      ******************************************************************        
      *        MAIN LINE PROCESS                                       *        
      ******************************************************************        
       MAIN-PROCESS.                                                            
           PERFORM 1000-OPEN-FILES              THRU 1000-EXIT.                 
           PERFORM 2000-READ-BP13F557           THRU 2000-EXIT.                 
           PERFORM 3000-PROCESS-RECORDS         THRU 3000-EXIT.                 
           PERFORM 9000-CLOSE-FILES             THRU 9000-EXIT.                 
                                                                                
      *****************                                                         
       1000-OPEN-FILES.                                                         
      *****************                                                         
                                                                                
           OPEN INPUT  BP13F557                                                 
                OUTPUT BP13L557.                                                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       2000-READ-BP13F557.                                                      
      *********************                                                     
                                                                                
           READ BP13F557                                                        
             AT END                                                             
                MOVE 'Y'         TO WS-EOF-F557                                 
                GO               TO 2000-EXIT                                   
            NOT AT END                                                          
                ADD 1            TO CNT-F557-READ                               
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       3000-PROCESS-RECORDS.                                                    
      **********************                                                    
      **                                                                        
      ** TP CASES                                                               
      **                                                                        
           IF F557-NUM-STATUS = 'T'                                             
              PERFORM 4200-OUTPUT-TITLE-TP      THRU 4200-EXIT                  
              PERFORM 5200-OUTPUT-DTL-TP        THRU 5200-EXIT                  
                UNTIL F557-EOF                                                  
           ELSE                                                                 
      **                                                                        
      ** BOOKING CASES                                                          
      **                                                                        
           IF F557-NUM-STATUS = 'B'                                             
              PERFORM 4100-OUTPUT-TITLE-BK      THRU 4100-EXIT                  
              PERFORM 5100-OUTPUT-DTL-BK        THRU 5100-EXIT                  
                UNTIL F557-EOF                                                  
           ELSE                                                                 
      **                                                                        
      ** CANCEL CASES                                                           
      **                                                                        
           IF F557-NUM-STATUS = 'C'                                             
              PERFORM 4300-OUTPUT-TITLE-CANCEL  THRU 4300-EXIT                  
              PERFORM 5300-OUTPUT-DTL-CANCEL    THRU 5300-EXIT                  
                UNTIL F557-EOF                                                  
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4100-OUTPUT-TITLE-BK.                                                    
      **********************                                                    
                                                                                
           MOVE F557A-TITLE01                   TO BP13L557-REC.                
           WRITE BP13L557-REC.                                                  
           ADD 1                                TO CNT-F557A-WRITE.             
                                                                                
           MOVE F557A-TITLE02                   TO BP13L557-REC.                
           WRITE BP13L557-REC.                                                  
           ADD 1                                TO CNT-F557A-WRITE.             
                                                                                
      *    MOVE F557A-TITLE03                   TO BP13L557-REC.                
      *    WRITE BP13L557-REC.                                                  
      *    ADD 1                                TO CNT-F557A-WRITE.             
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4200-OUTPUT-TITLE-TP.                                                    
      **********************                                                    
                                                                                
           MOVE F557B-TITLE01                   TO BP13L557-REC.                
           WRITE BP13L557-REC.                                                  
           ADD 1                                TO CNT-F557B-WRITE.             
                                                                                
           MOVE F557B-TITLE02                   TO BP13L557-REC.                
           WRITE BP13L557-REC.                                                  
           ADD 1                                TO CNT-F557B-WRITE.             
                                                                                
      *    MOVE F557B-TITLE03                   TO BP13L557-REC.                
      *    WRITE BP13L557-REC.                                                  
      *    ADD 1                                TO CNT-F557B-WRITE.             
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************                                                
       4300-OUTPUT-TITLE-CANCEL.                                                
      **************************                                                
                                                                                
           MOVE F557C-TITLE01                   TO BP13L557-REC.                
           WRITE BP13L557-REC.                                                  
           ADD 1                                TO CNT-F557C-WRITE.             
                                                                                
           MOVE F557C-TITLE02                   TO BP13L557-REC.                
           WRITE BP13L557-REC.                                                  
           ADD 1                                TO CNT-F557C-WRITE.             
                                                                                
      *    MOVE F557C-TITLE03                   TO BP13L557-REC.                
      *    WRITE BP13L557-REC.                                                  
      *    ADD 1                                TO CNT-F557C-WRITE.             
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       5100-OUTPUT-DTL-BK.                                                      
      ********************                                                      
                                                                                
           ADD 1                           TO WS-SNO-A.                         
      *    MOVE SPACES                     TO P13F557A-FORMAT.                  
           INITIALIZE                         P13F557A-FORMAT.                  
                                                                                
           MOVE WS-SNO-A                   TO F557A-SNO.                        
           MOVE F557-NUM-REGN              TO F557A-NUM-REGN                    
           MOVE F557-NUM-SCH-ACCNT         TO F557A-NUM-SCH-ACCNT               
           MOVE F557-NUM-NRIC1             TO F557A-NUM-NRIC1                   
           MOVE F557-CDE-SALES-MODE        TO F557A-CDE-SALES-MODE              
           MOVE F557-DTE-QUARTER           TO F557A-DTE-QUARTER                 
           IF F557-DTE-ACCEPTANCE = SPACES OR LOW-VALUES OR ZEROES              
              MOVE SPACES                  TO F557A-DTE-ACCEPTANCE              
           ELSE                                                                 
              STRING F557-DTE-ACCEPTANCE(7:2) '/'                               
                     F557-DTE-ACCEPTANCE(5:2) '/'                               
                     F557-DTE-ACCEPTANCE(1:4)                                   
                     DELIMITED BY SIZE INTO F557A-DTE-ACCEPTANCE                
              END-STRING                                                        
           END-IF                                                               
           MOVE F557-NEIGHBOURHOOD-CONTRACT                                     
             TO F557A-NEIGHBOURHOOD                                             
                                                                                
           MOVE F557-CONTRACT                                                   
             TO F557A-CONTRACT                                                  
                                                                                
           MOVE F557-NUM-TOWN              TO F557A-NUM-TOWN                    
           MOVE F557-NUM-HH                TO F557A-NUM-HH                      
           MOVE F557-NUM-FLAT-TYPE         TO F557A-NUM-FLAT-TYPE               
           MOVE F557-DESC-ESTATE           TO F557A-DESC-ESTATE                 
           MOVE F557-CDE-TYP-DESG          TO F557A-CDE-TYP-DESG                
           MOVE F557-DESC-MODL-DESG        TO F557A-DESC-MODL-DESG              
           IF F557-DTE-HANDOVER = SPACES OR LOW-VALUES OR ZEROES                
              MOVE SPACES                  TO F557A-DTE-HANDOVER                
           ELSE                                                                 
              STRING F557-DTE-HANDOVER(7:2) '/'                                 
                     F557-DTE-HANDOVER(5:2) '/'                                 
                     F557-DTE-HANDOVER(1:4)                                     
                     DELIMITED BY SIZE INTO F557A-DTE-HANDOVER                  
              END-STRING                                                        
           END-IF                                                               
           MOVE F557-NUM-AGE-HA1           TO F557A-NUM-AGE-HA1                 
           MOVE F557-NUM-AGE-HA2           TO F557A-NUM-AGE-HA2                 
           MOVE F557-NUM-AGE-HA3           TO F557A-NUM-AGE-HA3                 
           MOVE F557-NUM-AGE-HA4           TO F557A-NUM-AGE-HA4                 
           MOVE F557-AMT-INCOME-HA1        TO F557A-AMT-INCOME-HA1              
           MOVE F557-AMT-INCOME-HA2        TO F557A-AMT-INCOME-HA2              
           MOVE F557-AMT-INCOME-HA3        TO F557A-AMT-INCOME-HA3              
           MOVE F557-AMT-INCOME-HA4        TO F557A-AMT-INCOME-HA4              
           MOVE F557-NUM-HH-SIZE           TO F557A-NUM-HH-SIZE                 
           MOVE F557-NUM-ALLO-SCHEME       TO F557A-NUM-ALLO-SCHEME             
           MOVE F557-NUM-ELIG-SCHEME       TO F557A-NUM-ELIG-SCHEME             
           MOVE F557-NUM-ETHNIC            TO F557A-NUM-ETHNIC                  
           MOVE F557-NUM-HDBREF-SMS-HA1    TO F557A-NUM-HDBREF-SMS-HA1          
           MOVE F557-NUM-TOWN-SMS-HA1      TO F557A-NUM-TOWN-SMS-HA1            
           MOVE F557-NUM-ESTATE-SMS-HA1    TO F557A-NUM-ESTATE-SMS-HA1          
           MOVE F557-NUM-SALE-TYPE-SMS-HA1                                      
             TO F557A-NUM-SALE-TYPE-SMS-HA1                                     
           MOVE F557-NUM-FT-SMS-HA1        TO F557A-NUM-FT-SMS-HA1              
           MOVE F557-NUM-ROLE-SMS-HA1      TO F557A-NUM-ROLE-SMS-HA1            
           IF F557-DTE-SALE-EFF-SMS-HA1 = SPACES OR LOW-VALUES                  
                                                 OR ZEROES                      
              MOVE SPACES                  TO F557-DTE-SALE-EFF-SMS-HA1         
           ELSE                                                                 
              STRING F557-DTE-SALE-EFF-SMS-HA1(7:2) '/'                         
                     F557-DTE-SALE-EFF-SMS-HA1(5:2) '/'                         
                     F557-DTE-SALE-EFF-SMS-HA1(1:4)                             
                     DELIMITED BY SIZE INTO F557A-DTE-SALE-EFF-SMS-HA1          
              END-STRING                                                        
           END-IF                                                               
           IF F557-DTE-SALE-EFF-RSL-HA1 = SPACES OR LOW-VALUES                  
                                                 OR ZEROES                      
              MOVE SPACES                  TO F557-DTE-SALE-EFF-RSL-HA1         
           ELSE                                                                 
              STRING F557-DTE-SALE-EFF-RSL-HA1(7:2) '/'                         
                     F557-DTE-SALE-EFF-RSL-HA1(5:2) '/'                         
                     F557-DTE-SALE-EFF-RSL-HA1(1:4) '/'                         
                     DELIMITED BY SIZE INTO F557A-DTE-SALE-EFF-RSL-HA1          
              END-STRING                                                        
           END-IF                                                               
           MOVE F557-NUM-FT-RSL-HA1          TO F557A-NUM-FT-RSL-HA1            
           MOVE F557-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                             TO F557A-CDE-CTZ-HH.               
           MOVE F557-AMT-INCOME-HH           TO F557A-AMT-INC-HH.               
           MOVE F557-NUM-MARITAL-STATUS      TO F557A-CDE-MARITAL-STAT          
           MOVE F557-NUM-CHILD               TO F557A-NUM-CHILD                 
           MOVE F557-NUM-YOUNG-CHILD-CITIZEN TO F557A-NUM-CHILD-CTZ             
           MOVE F557-NUM-YOUNG-CHILD-AGE     TO F557A-NUM-AGE-YOUNGEST          
           MOVE F557-NUM-APPS                TO F557A-NUM-APPS                  
           MOVE F557-NUM-MCPS-ELIG           TO F557A-NUM-MCPS                  
           MOVE F557-NUM-MGPS                TO F557A-NUM-MGPS                  
           MOVE F557-NUM-PPS                 TO F557A-NUM-PPS                   
           MOVE F557-NUM-PPS-QUOTA           TO F557A-NUM-PPS-QUOTA             
           MOVE F557-NUM-FT2T                TO F557A-NUM-FT2T                  
           MOVE F557-NUM-PROJECT             TO F557A-NUM-PROJECT               
           MOVE F557-NUM-LEASE-TENURE TO F557A-NUM-LEASE-TENURE                 
           MOVE F557-NUM-BLOCK        TO F557A-NUM-BLK-NO                       
           MOVE F557-NUM-FLAT-STATUS  TO F557A-NUM-FLAT-STATUS                  
           MOVE F557-NUM-PROTECTED    TO F557A-NUM-PROTECTED                    
           MOVE F557-NUM-ELDERLY      TO F557A-NUM-ELDERLY                      
                                                                                
           IF F557-DTE-PACD             = SPACES OR LOW-VALUES                  
                                                 OR ZEROES                      
              MOVE SPACES                  TO F557A-DTE-PCD                     
           ELSE                                                                 
              STRING F557-DTE-PACD(7:2) '/'                                     
                     F557-DTE-PACD(5:2) '/'                                     
                     F557-DTE-PACD(1:4) '/'                                     
                     DELIMITED BY SIZE INTO F557A-DTE-PCD                       
              END-STRING                                                        
           END-IF                                                               
                                                                                
           WRITE BP13L557-REC FROM P13F557A-FORMAT.                             
           ADD 1                           TO CNT-F557A-WRITE.                  
                                                                                
           PERFORM 2000-READ-BP13F557           THRU 2000-EXIT.                 
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       5200-OUTPUT-DTL-TP.                                                      
      ********************                                                      
                                                                                
           ADD 1                           TO WS-SNO-B.                         
      *    MOVE SPACES                     TO P13F557B-FORMAT.                  
           INITIALIZE                         P13F557B-FORMAT.                  
                                                                                
           MOVE WS-SNO-B                   TO F557B-SNO.                        
           MOVE F557-NUM-REGN              TO F557B-NUM-REGN                    
           MOVE F557-NUM-SCH-ACCNT         TO F557B-NUM-SCH-ACCNT               
           MOVE F557-NUM-NRIC1             TO F557B-NUM-NRIC1                   
           MOVE F557-CDE-SALES-MODE        TO F557B-CDE-SALES-MODE              
           MOVE F557-DTE-QUARTER           TO F557B-DTE-QUARTER                 
           IF F557-DTE-ACCEPTANCE = SPACES OR LOW-VALUES OR ZEROES              
              MOVE SPACES                  TO F557B-DTE-ACCEPTANCE              
           ELSE                                                                 
              STRING F557-DTE-ACCEPTANCE(7:2) '/'                               
                     F557-DTE-ACCEPTANCE(5:2) '/'                               
                     F557-DTE-ACCEPTANCE(1:4)                                   
                     DELIMITED BY SIZE INTO F557B-DTE-ACCEPTANCE                
              END-STRING                                                        
           END-IF                                                               
           IF F557-DTE-TP = SPACES OR LOW-VALUES OR ZEROES                      
              MOVE SPACES                  TO F557B-DTE-TP                      
           ELSE                                                                 
              STRING F557-DTE-TP(7:2) '/'                                       
                     F557-DTE-TP(5:2) '/'                                       
                     F557-DTE-TP(1:4)                                           
                     DELIMITED BY SIZE INTO F557B-DTE-TP                        
              END-STRING                                                        
           END-IF                                                               
           MOVE F557-NEIGHBOURHOOD-CONTRACT                                     
             TO F557B-NEIGHBOURHOOD                                             
           MOVE F557-CONTRACT                                                   
             TO F557B-CONTRACT                                                  
           MOVE F557-NUM-TOWN              TO F557B-NUM-TOWN                    
           MOVE F557-NUM-HH                TO F557B-NUM-HH                      
           MOVE F557-NUM-FLAT-TYPE         TO F557B-NUM-FLAT-TYPE               
           MOVE F557-DESC-ESTATE           TO F557B-DESC-ESTATE                 
           MOVE F557-CDE-TYP-DESG          TO F557B-CDE-TYP-DESG                
           MOVE F557-DESC-MODL-DESG        TO F557B-DESC-MODL-DESG              
           IF F557-DTE-HANDOVER = SPACES OR LOW-VALUES OR ZEROES                
              MOVE SPACES                  TO F557B-DTE-HANDOVER                
           ELSE                                                                 
              STRING F557-DTE-HANDOVER(7:2) '/'                                 
                     F557-DTE-HANDOVER(5:2) '/'                                 
                     F557-DTE-HANDOVER(1:4)                                     
                     DELIMITED BY SIZE INTO F557B-DTE-HANDOVER                  
              END-STRING                                                        
           END-IF                                                               
           MOVE F557-NUM-AGE-HA1           TO F557B-NUM-AGE-HA1                 
           MOVE F557-NUM-AGE-HA2           TO F557B-NUM-AGE-HA2                 
           MOVE F557-NUM-AGE-HA3           TO F557B-NUM-AGE-HA3                 
           MOVE F557-NUM-AGE-HA4           TO F557B-NUM-AGE-HA4                 
           MOVE F557-AMT-INCOME-HA1        TO F557B-AMT-INCOME-HA1              
           MOVE F557-AMT-INCOME-HA2        TO F557B-AMT-INCOME-HA2              
           MOVE F557-AMT-INCOME-HA3        TO F557B-AMT-INCOME-HA3              
           MOVE F557-AMT-INCOME-HA4        TO F557B-AMT-INCOME-HA4              
           MOVE F557-NUM-HH-SIZE           TO F557B-NUM-HH-SIZE                 
           MOVE F557-NUM-ALLO-SCHEME       TO F557B-NUM-ALLO-SCHEME             
           MOVE F557-NUM-ELIG-SCHEME       TO F557B-NUM-ELIG-SCHEME             
           MOVE F557-NUM-ETHNIC            TO F557B-NUM-ETHNIC                  
           MOVE F557-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                           TO F557B-CDE-CTZ-HH.                 
           MOVE F557-AMT-INCOME-HH        TO F557B-AMT-INC-HH.                  
           MOVE F557-NUM-MARITAL-STATUS   TO F557B-CDE-MARITAL-STAT             
           MOVE F557-NUM-CHILD            TO F557B-NUM-CHILD                    
           MOVE F557-NUM-LEASE-TENURE     TO F557B-NUM-LEASE-TENURE             
           MOVE F557-NUM-BLOCK            TO F557B-NUM-BLK-NO                   
           MOVE F557-NUM-FLAT-STATUS      TO F557B-NUM-FLAT-STATUS              
           MOVE F557-NUM-PROTECTED        TO F557B-NUM-PROTECTED                
           MOVE F557-NUM-ELDERLY          TO F557B-NUM-ELDERLY                  
                                                                                
           IF F557-DTE-PACD             = SPACES OR LOW-VALUES                  
                                                 OR ZEROES                      
              MOVE SPACES                  TO F557B-DTE-PCD                     
           ELSE                                                                 
              STRING F557-DTE-PACD(7:2) '/'                                     
                     F557-DTE-PACD(5:2) '/'                                     
                     F557-DTE-PACD(1:4) '/'                                     
                     DELIMITED BY SIZE INTO F557B-DTE-PCD                       
              END-STRING                                                        
           END-IF                                                               
                                                                                
           WRITE BP13L557-REC FROM P13F557B-FORMAT.                             
           ADD 1                           TO CNT-F557B-WRITE.                  
                                                                                
           PERFORM 2000-READ-BP13F557           THRU 2000-EXIT.                 
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       5300-OUTPUT-DTL-CANCEL.                                                  
      ************************                                                  
                                                                                
           ADD 1                           TO WS-SNO-C.                         
      *    MOVE SPACES                     TO P13F557C-FORMAT.                  
           INITIALIZE                         P13F557C-FORMAT.                  
                                                                                
           MOVE WS-SNO-C                   TO F557C-SNO.                        
           MOVE F557-NUM-REGN              TO F557C-NUM-REGN                    
           MOVE F557-NUM-NRIC1             TO F557C-NUM-NRIC1                   
           MOVE F557-CDE-SALES-MODE        TO F557C-CDE-SALES-MODE              
           MOVE F557-DTE-QUARTER           TO F557C-DTE-QUARTER                 
           MOVE F557-NUM-SCH-ACCNT         TO F557C-NUM-SCH-ACCNT               
           IF F557-DTE-CANCEL = SPACES OR LOW-VALUES OR ZEROES                  
              MOVE SPACES                  TO F557C-DTE-CANCEL                  
           ELSE                                                                 
              STRING F557-DTE-CANCEL(7:2) '/'                                   
                     F557-DTE-CANCEL(5:2) '/'                                   
                     F557-DTE-CANCEL(1:4)                                       
                     DELIMITED BY SIZE INTO F557C-DTE-CANCEL                    
              END-STRING                                                        
           END-IF                                                               
           IF F557-DTE-ACCEPTANCE = SPACES OR LOW-VALUES OR ZEROES              
              MOVE SPACES                  TO F557C-DTE-ACCEPTANCE              
           ELSE                                                                 
              STRING F557-DTE-ACCEPTANCE(7:2) '/'                               
                     F557-DTE-ACCEPTANCE(5:2) '/'                               
                     F557-DTE-ACCEPTANCE(1:4)                                   
                     DELIMITED BY SIZE INTO F557C-DTE-ACCEPTANCE                
              END-STRING                                                        
           END-IF                                                               
           MOVE F557-NEIGHBOURHOOD-CONTRACT                                     
             TO F557C-NEIGHBOURHOOD                                             
           MOVE F557-CONTRACT                                                   
             TO F557C-CONTRACT                                                  
           MOVE F557-NUM-TOWN              TO F557C-NUM-TOWN                    
           MOVE F557-NUM-HH                TO F557C-NUM-HH                      
           MOVE F557-NUM-FLAT-TYPE         TO F557C-NUM-FLAT-TYPE               
           MOVE F557-DESC-ESTATE           TO F557C-DESC-ESTATE                 
           MOVE F557-CDE-TYP-DESG          TO F557C-CDE-TYP-DESG                
           MOVE F557-DESC-MODL-DESG        TO F557C-DESC-MODL-DESG              
           IF F557-DTE-HANDOVER = SPACES OR LOW-VALUES OR ZEROES                
              MOVE SPACES                  TO F557C-DTE-HANDOVER                
           ELSE                                                                 
              STRING F557-DTE-HANDOVER(7:2) '/'                                 
                     F557-DTE-HANDOVER(5:2) '/'                                 
                     F557-DTE-HANDOVER(1:4)                                     
                     DELIMITED BY SIZE INTO F557C-DTE-HANDOVER                  
              END-STRING                                                        
           END-IF                                                               
           MOVE F557-NUM-ALLOC-TAG         TO F557C-NUM-ALLOC-TAG               
           MOVE F557-NUM-AGE-HA1           TO F557C-NUM-AGE-HA1                 
           MOVE F557-NUM-AGE-HA2           TO F557C-NUM-AGE-HA2                 
           MOVE F557-NUM-AGE-HA3           TO F557C-NUM-AGE-HA3                 
           MOVE F557-NUM-AGE-HA4           TO F557C-NUM-AGE-HA4                 
           MOVE F557-AMT-INCOME-HA1        TO F557C-AMT-INCOME-HA1              
           MOVE F557-AMT-INCOME-HA2        TO F557C-AMT-INCOME-HA2              
           MOVE F557-AMT-INCOME-HA3        TO F557C-AMT-INCOME-HA3              
           MOVE F557-AMT-INCOME-HA4        TO F557C-AMT-INCOME-HA4              
           MOVE F557-NUM-HH-SIZE           TO F557C-NUM-HH-SIZE                 
           MOVE F557-NUM-ALLO-SCHEME       TO F557C-NUM-ALLO-SCHEME             
           MOVE F557-NUM-ELIG-SCHEME       TO F557C-NUM-ELIG-SCHEME             
           MOVE F557-NUM-ETHNIC            TO F557C-NUM-ETHNIC                  
           MOVE F557-NUM-REGN-NEW-FLAT     TO F557C-NUM-REGN-NEW-FLAT           
           MOVE F557-DTE-QTR-NEW-FLAT      TO F557C-DTE-QTR-NEW-FLAT            
           MOVE F557-NUM-NT-NEW-FLAT       TO F557C-NUM-NT-NEW-FLAT             
           MOVE F557-NUM-FT-NEW-FLAT       TO F557C-NUM-FT-NEW-FLAT             
           MOVE F557-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                           TO F557C-CDE-CTZ-HH.                 
           MOVE F557-AMT-INCOME-HH         TO F557C-AMT-INC-HH.                 
           MOVE F557-NUM-MARITAL-STATUS   TO F557C-CDE-MARITAL-STAT             
           MOVE F557-NUM-CHILD            TO F557C-NUM-CHILD                    
           IF F557-NUM-SCHACC-NEW-FLAT NOT = SPACES AND LOW-VALUES              
              STRING F557-NUM-SCHACC-NEW-FLAT(1:4) '-'                          
                     F557-NUM-SCHACC-NEW-FLAT(5:4) '-'                          
                     F557-NUM-SCHACC-NEW-FLAT(9:1) '-'                          
                     F557-NUM-SCHACC-NEW-FLAT(10:2)                             
                     DELIMITED BY SIZE INTO F557C-NUM-SCH-ACC-NEW-FLAT          
              END-STRING                                                        
           END-IF.                                                              
                                                                                
           IF F557-DTE-SALE-EFF-RSL-HA1 = SPACES OR LOW-VALUES OR ZEROES        
              MOVE SPACES                  TO F557C-REJ-DTE                     
           ELSE                                                                 
                STRING F557-DTE-SALE-EFF-RSL-HA1(7:2)                           
                       '/'                                                      
                       F557-DTE-SALE-EFF-RSL-HA1(5:2)                           
                       '/'                                                      
                       F557-DTE-SALE-EFF-RSL-HA1(1:4)                           
                DELIMITED BY SIZE INTO F557C-REJ-DTE                            
              END-STRING                                                        
           END-IF.                                                              
                                                                                
           MOVE F557-NUM-FT-RSL-HA1       TO F557C-REJ-REASON                   
           MOVE F557-NUM-LEASE-TENURE     TO F557C-NUM-LEASE-TENURE             
           MOVE F557-NUM-BLOCK            TO F557C-NUM-BLK-NO                   
           MOVE F557-NUM-FLAT-STATUS      TO F557C-NUM-FLAT-STATUS              
           MOVE F557-NUM-PROTECTED        TO F557C-NUM-PROTECTED                
           MOVE F557-NUM-ELDERLY          TO F557C-NUM-ELDERLY                  
                                                                                
           WRITE BP13L557-REC FROM P13F557C-FORMAT.                             
           ADD 1                           TO CNT-F557C-WRITE.                  
                                                                                
           PERFORM 2000-READ-BP13F557           THRU 2000-EXIT.                 
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************                                                        
       9000-CLOSE-FILES.                                                        
      ******************                                                        
                                                                                
           DISPLAY '******  BP13CY56 *************'.                            
           DISPLAY 'NO OF F557 REC READ          : ' CNT-F557-READ.             
           DISPLAY 'NO OF BOOKED CASES WRITTEN   : ' CNT-F557A-WRITE.           
           DISPLAY 'NO OF TP     CASES WRITTEN   : ' CNT-F557B-WRITE.           
           DISPLAY 'NO OF CANCEL CASES WRITTEN   : ' CNT-F557C-WRITE.           
                                                                                
           CLOSE BP13F557                                                       
                 BP13L557.                                                      
                                                                                
       9000-EXIT.                                                               
           STOP RUN.                                                            
