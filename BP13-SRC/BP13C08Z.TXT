       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13C08Z.                                                  
       AUTHOR.       AM25.                                                      
       DATE-WRITTEN. 26/12/2019.                                                
      *****************************************************************         
      *                SOC - SYSTEM OF COMMITMENT (BP13)              *         
      *===============================================================*         
      *  OBJECTIVES :                                                 *         
      *     - TO CREATE RAW-DATA OF CONFIRMATION LETTERS (BTO/SBF)    *         
      *       USING IOMS; FH10, FB10 AND FTP FILES                    *         
      *     - 2-ROOM FLEXI FLAT ONLY                                  *         
      *===============================================================*         
      * FILES DESCRIPTION :-                                          *         
      *                                                               *         
      *                ACCESS     REC                                 *         
      * DD NAME  I/O/E MODE       LEN  KEY FIELDS    REMARKS          *         
      * -------- ----- ---------- ---- ------------- ---------------- *         
      * BP13F730 I     SEQUENTIAL 500                                 *         
      * BP13K022 I     RANDOM     100  K022-KEY-FLD                   *         
      * BP13K024 I     RANDOM     100  K024-KEY-FLD                   *         
      * BP13K730 I     RANDOM     500  K730-KEY-NEW                   *         
      * BP13K813 I     RANDOM     1000 K813-KEY-FLD                   *         
      * BP13K825 I     RANDOM     200  K825-KEY-FLD                   *         
      * BP13K830 I     RANDOM     250  K830-KEY-FLD                   *         
      * P13B8Z5P O     SEQUENTIAL 1500               IOMS             *         
      * P13H8Z5P O     SEQUENTIAL 72                 IOMS             *         
      * P13B8ZES O     SEQUENTIAL 1500               IOMS             *         
      * P13H8ZES O     SEQUENTIAL 72                 IOMS             *         
      * P13B8Z5J O     SEQUENTIAL 1500               IOMS             *         
      * P13H8Z5J O     SEQUENTIAL 72                 IOMS             *         
      * P13B8ZEU O     SEQUENTIAL 1500               IOMS             *         
      * P13H8ZEU O     SEQUENTIAL 72                 IOMS             *         
      * P13B8ZEW O     SEQUENTIAL 1500               IOMS             *         
      * P13H8ZEW O     SEQUENTIAL 72                 IOMS             *         
      * P13B8ZBQ O     SEQUENTIAL 1500               IOMS             *         
      * P13H8ZBQ O     SEQUENTIAL 72                 IOMS             *         
      * BP13FTP  O     SEQUENTIAL 72                 IOMS             *         
      * P13L08ZA O     SEQUENTIAL 132                CTRL-LIST        *         
      * P13L08ZB O     SEQUENTIAL 132                CTRL-LIST        *         
      * P13L08ZC O     SEQUENTIAL 132                CTRL-LIST        *         
      * P13L08ZD O     SEQUENTIAL 132                CTRL-LIST        *         
      * P13L08ZE O     SEQUENTIAL 132                CTRL-LIST        *         
      * P13L08ZF O     SEQUENTIAL 132                CTRL-LIST        *         
      * P13L08ZZ O     SEQUENTIAL 132                CTRL-LIST        *         
      *===============================================================*         
      * REVISION HISTORY :                                            *         
      *                                                               *         
      * CHG-REQ#  DD/MM/YY   BY   DESCRIPTION                         *         
      * --------  --------  ----  ----------------------------------- *         
      * BP138104  26/12/19  AM25  NEW PROGRAM                         *         
      * BP139409  08/11/22  AM25  ADD HARDCODING TO SPS QUOTA FOR PLH *         
      *                           UNDER NOV 2022 BTO                  *         
      *****************************************************************         
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F730 ASSIGN      TO BP13F730.                             
                                                                                
           SELECT BP13K022 ASSIGN      TO BP13K022                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K022-KEY-FLD                                     
              ALTERNATE KEY IS K022-NUM-REGN                                    
              FILE STATUS   IS WS-K022-STATUS.                                  
                                                                                
           SELECT BP13K024 ASSIGN      TO BP13K024                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K024-KEY-FLD                                     
              FILE STATUS   IS WS-K024-STATUS.                                  
                                                                                
           SELECT BP13K730 ASSIGN      TO BP13K730                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K730-KEY-NEW                                     
              FILE STATUS   IS WS-K730-STATUS.                                  
                                                                                
           SELECT BP13K813 ASSIGN      TO BP13K813                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K813-KEY-FLD                                     
              FILE STATUS   IS WS-K813-STATUS.                                  
                                                                                
           SELECT BP13K825 ASSIGN      TO BP13K825                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K825-KEY-FLD                                     
              FILE STATUS   IS WS-K825-STATUS.                                  
                                                                                
           SELECT BP13K830 ASSIGN      TO BP13K830                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K830-KEY-FLD                                     
              ALTERNATE KEY IS K830-NUM-REGN                                    
              FILE STATUS   IS WS-K830-STATUS.                                  
                                                                                
           SELECT P13B8Z5P ASSIGN      TO P13B8Z5P.                             
           SELECT P13H8Z5P ASSIGN      TO P13H8Z5P.                             
           SELECT P13B8ZES ASSIGN      TO P13B8ZES.                             
           SELECT P13H8ZES ASSIGN      TO P13H8ZES.                             
           SELECT P13B8Z5J ASSIGN      TO P13B8Z5J.                             
           SELECT P13H8Z5J ASSIGN      TO P13H8Z5J.                             
           SELECT P13B8ZEU ASSIGN      TO P13B8ZEU.                             
           SELECT P13H8ZEU ASSIGN      TO P13H8ZEU.                             
           SELECT P13B8ZEW ASSIGN      TO P13B8ZEW.                             
           SELECT P13H8ZEW ASSIGN      TO P13H8ZEW.                             
           SELECT P13B8ZBQ ASSIGN      TO P13B8ZBQ.                             
           SELECT P13H8ZBQ ASSIGN      TO P13H8ZBQ.                             
           SELECT BP13FTP  ASSIGN      TO BP13FTP.                              
                                                                                
           SELECT P13L08ZA ASSIGN      TO P13L08ZA.                             
           SELECT P13L08ZB ASSIGN      TO P13L08ZB.                             
           SELECT P13L08ZC ASSIGN      TO P13L08ZC.                             
           SELECT P13L08ZD ASSIGN      TO P13L08ZD.                             
           SELECT P13L08ZE ASSIGN      TO P13L08ZE.                             
           SELECT P13L08ZF ASSIGN      TO P13L08ZF.                             
           SELECT P13L08ZZ ASSIGN      TO P13L08ZZ.                             
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F730                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 500 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F730.                                                           
                                                                                
       FD  BP13K022                                                             
           RECORD CONTAINS 100 CHARACTERS.                                      
       COPY BP13K022.                                                           
                                                                                
       FD  BP13K024                                                             
           RECORD CONTAINS 100 CHARACTERS.                                      
       COPY BP13K024.                                                           
                                                                                
       FD  BP13K730                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BP13K730.                                                           
                                                                                
       FD  BP13K813                                                             
           RECORD CONTAINS 1000 CHARACTERS.                                     
       COPY BP13K813.                                                           
                                                                                
       FD  BP13K825                                                             
           RECORD CONTAINS 200 CHARACTERS.                                      
       COPY BP13K825.                                                           
                                                                                
       FD  BP13K830                                                             
           RECORD CONTAINS 250 CHARACTERS.                                      
       COPY BP13K830.                                                           
                                                                                
       FD  P13B8Z5P                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1500 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B8Z5P-REC                PIC X(1500).                             
                                                                                
       FD  P13H8Z5P                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H8Z5P-REC                PIC X(72).                               
                                                                                
       FD  P13B8ZES                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1500 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B8ZES-REC                PIC X(1500).                             
                                                                                
       FD  P13H8ZES                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H8ZES-REC                PIC X(72).                               
                                                                                
       FD  P13B8Z5J                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1500 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B8Z5J-REC                PIC X(1500).                             
                                                                                
       FD  P13H8Z5J                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H8Z5J-REC                PIC X(72).                               
                                                                                
       FD  P13B8ZEU                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1500 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B8ZEU-REC                PIC X(1500).                             
                                                                                
       FD  P13H8ZEU                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H8ZEU-REC                PIC X(72).                               
                                                                                
       FD  P13B8ZEW                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1500 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B8ZEW-REC                PIC X(1500).                             
                                                                                
       FD  P13H8ZEW                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H8ZEW-REC                PIC X(72).                               
                                                                                
       FD  P13B8ZBQ                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1500 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B8ZBQ-REC                PIC X(1500).                             
                                                                                
       FD  P13H8ZBQ                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H8ZBQ-REC                PIC X(72).                               
                                                                                
       FD  BP13FTP                                                              
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  BP13FTP-REC                 PIC X(72).                               
                                                                                
       FD  P13L08ZA                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L08ZA-REC                PIC X(132).                              
                                                                                
       FD  P13L08ZB                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L08ZB-REC                PIC X(132).                              
                                                                                
       FD  P13L08ZC                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L08ZC-REC                PIC X(132).                              
                                                                                
       FD  P13L08ZD                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L08ZD-REC                PIC X(132).                              
                                                                                
       FD  P13L08ZE                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L08ZE-REC                PIC X(132).                              
                                                                                
       FD  P13L08ZF                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L08ZF-REC                PIC X(132).                              
                                                                                
       FD  P13L08ZZ                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L08ZZ-REC                PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY P13FH10A.                                                           
       COPY P13P08ZA.                                                           
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-K022-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K024-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K730-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K813-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K825-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K830-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-SYS-DTE-TME.                                                  
               10 WS-SYS-DATE          PIC 9(8)        VALUE ZEROES.            
               10 WS-SYS-TIME          PIC 9(8)        VALUE ZEROES.            
           05  WS-DTE-NEXT-INT         PIC S9(9)       VALUE ZEROES.            
           05  WS-DTE-NEXT             PIC 9(8)        VALUE ZEROES.            
           05  WS-DTE-PRINT            PIC X(10)       VALUE SPACES.            
           05  WS-DTE-BAL-MTH-9        PIC X(9)        VALUE SPACES.            
           05  WS-GROUP-ID             PIC X(8)        VALUE SPACES.            
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F730-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K022-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K024-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K730-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K813-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K825-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K830-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-FH10-WRITE           PIC 9(6)        VALUE ZEROES.            
           05  WS-FB10-WRITE           PIC 9(6)        VALUE ZEROES.            
           05  WS-FTP-WRITE            PIC 9(6)        VALUE ZEROES.            
           05  WS-B8Z5P-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B8ZES-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B8Z5J-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B8ZEU-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B8ZEW-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B8ZBQ-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-H8Z5P-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H8ZES-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H8Z5J-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H8ZEU-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H8ZEW-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H8ZBQ-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-BP135P-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13ES-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP135J-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13EU-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13EW-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13BQ-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-L08ZA-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L08ZB-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L08ZC-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L08ZD-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L08ZE-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L08ZF-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L08ZZ-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L08ZA-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L08ZA-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L08ZB-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L08ZB-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L08ZC-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L08ZC-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L08ZD-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L08ZD-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L08ZE-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L08ZE-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L08ZF-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L08ZF-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L08ZZ-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L08ZZ-LINE-CNT       PIC 9(2)        VALUE 60.                
                                                                                
       01  WS-SWITCHES-FLAGS.                                                   
           05  WS-F730-EOF             PIC X           VALUE 'N'.               
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05  FILLER                  PIC X(12)       VALUE                    
               '01 JANUARY  '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '02 FEBRUARY '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '03 MARCH    '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '04 APRIL    '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '05 MAY      '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '06 JUNE     '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '07 JULY     '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '08 AUGUST   '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '09 SEPTEMBER'.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '10 OCTOBER  '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '11 NOVEMBER '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '12 DECEMBER '.                                                  
       01  FILLER REDEFINES WS-MONTHS-IN-DIGITS-AND-WORDS.                      
           05  WS-MONTH-TABLE OCCURS 12 INDEXED BY WS-MTH-IND.                  
               10  WS-MONTH-IN-DIGITS  PIC X(2).                                
               10  FILLER              PIC X(1).                                
               10  WS-MONTH-IN-WORDS   PIC X(9).                                
                                                                                
       01  WS-IOMS-VARIABLES.                                                   
           05  WS-UPD-TMESTAMP.                                                 
               10  WS-UPD-DATE         PIC X(8)        VALUE SPACES.            
               10  WS-UPD-TME          PIC X(8)        VALUE SPACES.            
           05  WS-FTP-DEST-REC.                                                 
               10  WS-FTP-JOBNAME      PIC X(8)        VALUE SPACES.            
               10  FILLER              PIC X           VALUE '_'.               
               10  WS-FTP-DESC         PIC X(6)        VALUE SPACES.            
               10  FILLER              PIC X           VALUE '_'.               
               10  WS-FTP-TMESTAMP     PIC X(12)       VALUE SPACES.            
           05  WS-P13FT10A-WRITE       PIC 9(7)        VALUE ZEROES.            
           05  WS-PARM.                                                         
               10  WS-PARM-JOBNAME     PIC X(8)        VALUE SPACES.            
               10  WS-PARM-B10-SOURCE  PIC X(70)       VALUE SPACES.            
               10  WS-PARM-H10-SOURCE  PIC X(70)       VALUE SPACES.            
                                                                                
       01  WS-BP13FTP-REC.                                                      
           05  WS-FTP-LINE1.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'CD /DATAFILE'.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE2.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'DIR         '.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE3.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'ASCII       '.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE4.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  WS-FTP-SOURCE       PIC X(70)       VALUE SPACES.            
           05  WS-FTP-LINE5.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'DIR         '.                                              
               10  FILLER              PIC X(66)       VALUE SPACES.            
           05  WS-FTP-LINE6.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'QUIT        '.                                              
               10  FILLER              PIC X(66)       VALUE SPACES.            
                                                                                
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE    PIC X(6)        VALUE SPACES.            
           05  AV02C015-OUT-POSTCODE-CHKSUM                                     
                                       PIC X(9)        VALUE SPACES.            
                                                                                
      *------------------------------------------------------------*            
      *    REPORT LAYOUT FOR CONTROL LISTINGS                      *            
      *------------------------------------------------------------*            
       01  L08Z-HDR1.                                                           
           05  L08Z-LISTING            PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'HDB3'.            
           05  FILLER                  PIC X(22)       VALUE SPACES.            
           05  FILLER                  PIC X(39)       VALUE                    
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                  PIC X(18)       VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'DATE: '.          
           05  L08Z-DATE               PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE ' PAGE: '.         
           05  L08Z-PAGE               PIC Z,ZZ9.                               
           05  FILLER                  PIC X(7)        VALUE SPACES.            
                                                                                
       01  L08Z-HDR2.                                                           
           05  FILLER                  PIC X(97)       VALUE SPACES.            
           05  FILLER                  PIC X(16)       VALUE                    
               'SALES UNIT (RST)'.                                              
           05  FILLER                  PIC X(19)       VALUE SPACES.            
                                                                                
       01  L08Z-HDR3.                                                           
           05  FILLER                  PIC X(38)       VALUE SPACES.            
           05  L08Z-LISTING-TYPE       PIC X(50)       VALUE SPACES.            
           05  FILLER                  PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(13)       VALUE                    
               'PRINTED ON : '.                                                 
           05  L08Z-PRT-DATE           PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(12)       VALUE SPACES.            
                                                                                
       01  L08Z-HDR4.                                                           
           05  FILLER                  PIC X(7)        VALUE ' S/N   '.         
           05  FILLER                  PIC X(9)        VALUE                    
               'REF-NO   '.                                                     
           05  FILLER                  PIC X(15)       VALUE                    
               'APPLICANT NAMES'.                                               
           05  FILLER                  PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE '  UIN  '.         
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE 'CAT  '.           
           05  FILLER                  PIC X(5)        VALUE 'ALLOC'.           
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'FT  '.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'SERVE  '.         
           05  FILLER                  PIC X(2)        VALUE 'JB'.              
           05  FILLER                  PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'PORT   '.         
           05  FILLER                  PIC X(6)        VALUE 'SUCC'.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'NT1   '.          
           05  FILLER                  PIC X(5)        VALUE 'MCPS '.           
           05  FILLER                  PIC X(10)       VALUE                    
               'RES-NRIC1 '.                                                    
           05  FILLER                  PIC X(4)        VALUE 'RES '.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
                                                                                
       01  L08Z-HDR5.                                                           
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  FILLER                  PIC X(8)        VALUE 'REGN-NO'.         
           05  FILLER                  PIC X(39)       VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'ELIG'.            
           05  FILLER                  PIC X(4)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'BHH '.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(8)        VALUE 'ELIG-TAG'.        
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(8)        VALUE 'REGN-NO'.         
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE 'TAG  '.           
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'NT/ZONE'.         
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'HHTY'.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE 'GRO'.             
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(9)        VALUE                    
               'RES-NRIC2'.                                                     
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE 'Q-POS'.           
           05  FILLER                  PIC X(2)        VALUE SPACES.            
                                                                                
       01  L08Z-HDR6.                                                           
           05  FILLER                  PIC X(7)        VALUE ' S/N   '.         
           05  FILLER                  PIC X(9)        VALUE                    
               'REF-NO   '.                                                     
           05  FILLER                  PIC X(15)       VALUE                    
               'APPLICANT NAMES'.                                               
           05  FILLER                  PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE '  UIN  '.         
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE 'CAT  '.           
           05  FILLER                  PIC X(5)        VALUE 'ALLOC'.           
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'FT  '.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'SERVE  '.         
           05  FILLER                  PIC X(3)        VALUE 'DTE'.             
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE '5 YR   '.         
           05  FILLER                  PIC X(6)        VALUE 'PORT'.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'NT1   '.          
           05  FILLER                  PIC X(5)        VALUE 'MCPS '.           
           05  FILLER                  PIC X(10)       VALUE                    
               'RES-NRIC1 '.                                                    
           05  FILLER                  PIC X(7)        VALUE 'CHANCES'.         
                                                                                
       01  L08Z-HDR7.                                                           
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  FILLER                  PIC X(8)        VALUE 'REGN-NO'.         
           05  FILLER                  PIC X(39)       VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'ELIG'.            
           05  FILLER                  PIC X(4)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'BHH '.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(8)        VALUE 'ELIG-TAG'.        
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(8)        VALUE 'REQUEST'.         
           05  FILLER                  PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'TAG    '.         
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'HHTY'.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE 'GRO'.             
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(9)        VALUE                    
               'RES-NRIC2'.                                                     
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE 'Q-POS'.           
           05  FILLER                  PIC X(2)        VALUE SPACES.            
                                                                                
       01  L08Z-DTL1.                                                           
           05  L08Z-SERIAL-NO          PIC ZZZZ9.                               
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-REF-NO             PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-NAME-1             PIC X(22)       VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-NRIC-1             PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-CAT                PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-ALLOC              PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  L08Z-FLAT               PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  L08Z-SERVE              PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  L08Z-JB-REGN            PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE SPACES.            
           05  L08Z-PORT-TAG           PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  L08Z-SUCC               PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  L08Z-NT1                PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-MCPS               PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  L08Z-RES-NRIC1          PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  L08Z-RES-HA1            PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
                                                                                
       01  L08Z-DTL2.                                                           
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  L08Z-REGN-NO            PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-NAME-2             PIC X(22)       VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-NRIC-2             PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  L08Z-ELIG-SCH           PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  L08Z-BHH                PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(9)        VALUE SPACES.            
           05  L08Z-ELIG-TAG           PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(28)       VALUE SPACES.            
           05  L08Z-HHTY               PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  L08Z-GRO-RANK           PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-RES-NRIC2          PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  L08Z-QUEUE              PIC X(5)        VALUE SPACES.            
                                                                                
       01  L08Z-DTL3.                                                           
           05  FILLER                  PIC X(16)       VALUE SPACES.            
           05  L08Z-BLK                PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-UNIT               PIC X(11)       VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-ADDR2              PIC X(47)       VALUE SPACES.            
           05  FILLER                  PIC X(21)       VALUE SPACES.            
           05  L08Z-ADDR3              PIC X(20)       VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
                                                                                
       01  L08Z-DTL4.                                                           
           05  L08Z-SERIAL-NO-SUM      PIC ZZZZ9.                               
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-REF-NO-SUM         PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-NAME-1-SUM         PIC X(22)       VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  L08Z-NRIC-1-SUM         PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-CAT-SUM            PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-ALLOC-SUM          PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  L08Z-FLAT-SUM           PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-SERVE-SUM          PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  L08Z-DTE-REQ-SUM        PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-5YR-SUM            PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE SPACES.            
           05  L08Z-PORT-TAG-SUM       PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  L08Z-NT1-SUM            PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L08Z-MCPS-SUM           PIC X(4)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  L08Z-RES-NRIC1-SUM      PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  L08Z-CHANCE-SUM         PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
                                                                                
       01  L08Z-BLANK.                                                          
           05  FILLER                  PIC X(132)      VALUE SPACES.            
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
      *****************************************************************         
       0000-CONTROL.                                                            
      *****************************************************************         
                                                                                
           ACCEPT WS-PARM-JOBNAME.                                              
           ACCEPT WS-PARM-B10-SOURCE.                                           
           ACCEPT WS-PARM-H10-SOURCE.                                           
                                                                                
           PERFORM 1000-OPEN-FILES       THRU 1000-EXIT.                        
           PERFORM 2000-READ-BP13F730    THRU 2000-EXIT.                        
           PERFORM 3000-MAIN-PROCESSING  THRU 3000-EXIT                         
              UNTIL WS-F730-EOF = 'Y'.                                          
           PERFORM 8900-CREATE-FIOMS-REC THRU 8900-EXIT.                        
           PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT.                        
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1000-OPEN-FILES.                                                         
      *****************************************************************         
                                                                                
           OPEN INPUT  BP13F730                                                 
                       BP13K022                                                 
                       BP13K024                                                 
                       BP13K730                                                 
                       BP13K813                                                 
                       BP13K825                                                 
                       BP13K830                                                 
                OUTPUT P13B8Z5P                                                 
                       P13H8Z5P                                                 
                       P13B8ZES                                                 
                       P13H8ZES                                                 
                       P13B8Z5J                                                 
                       P13H8Z5J                                                 
                       P13B8ZEU                                                 
                       P13H8ZEU                                                 
                       P13B8ZEW                                                 
                       P13H8ZEW                                                 
                       P13B8ZBQ                                                 
                       P13H8ZBQ                                                 
                       BP13FTP                                                  
                       P13L08ZA                                                 
                       P13L08ZB                                                 
                       P13L08ZC                                                 
                       P13L08ZD                                                 
                       P13L08ZE                                                 
                       P13L08ZF                                                 
                       P13L08ZZ.                                                
                                                                                
           IF (WS-K022-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K022 FAIL STATUS=' WS-K022-STATUS               
              MOVE WS-K022-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K024-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K024 FAIL STATUS=' WS-K024-STATUS               
              MOVE WS-K024-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K730-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K730 FAIL STATUS=' WS-K730-STATUS               
              MOVE WS-K730-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K813-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K813 FAIL STATUS=' WS-K813-STATUS               
              MOVE WS-K813-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K825-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K825 FAIL STATUS=' WS-K825-STATUS               
              MOVE WS-K825-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K830-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K830 FAIL STATUS=' WS-K830-STATUS               
              MOVE WS-K830-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM 1500-FORMAT-DATE-TIME THRU 1500-EXIT.                        
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1500-FORMAT-DATE-TIME.                                                   
      *****************************************************************         
                                                                                
           MOVE FUNCTION CURRENT-DATE  TO WS-SYS-DTE-TME                        
                                          WS-UPD-TMESTAMP.                      
                                                                                
           COMPUTE WS-DTE-NEXT-INT =                                            
                         FUNCTION INTEGER-OF-DATE(WS-SYS-DATE) + 1.             
                                                                                
           COMPUTE WS-DTE-NEXT =                                                
                         FUNCTION DATE-OF-INTEGER(WS-DTE-NEXT-INT).             
                                                                                
           STRING WS-DTE-NEXT(7:2) '/'                                          
                  WS-DTE-NEXT(5:2) '/'                                          
                  WS-DTE-NEXT(1:4)                                              
              DELIMITED BY SIZE INTO WS-DTE-PRINT.                              
                                                                                
           MOVE WS-DTE-PRINT           TO L08Z-DATE                             
                                          L08Z-PRT-DATE.                        
                                                                                
       1500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       2000-READ-BP13F730.                                                      
      *****************************************************************         
                                                                                
           READ BP13F730                                                        
              AT END                                                            
                 MOVE 'Y'              TO WS-F730-EOF                           
              NOT AT END                                                        
                 ADD 1                 TO WS-F730-READ                          
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3000-MAIN-PROCESSING.                                                    
      *****************************************************************         
                                                                                
           IF F730-DTE-BALLOT = SPACES OR LOW-VALUES                            
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 3100-READ-BP13K730 THRU 3100-EXIT                         
                                                                                
              IF WS-K730-STATUS = 00                                            
                 IF K730-NUM-ELDERLY = 'F' OR 'S'                               
                    PERFORM 3200-PROCESS-LETTERS THRU 3200-EXIT                 
                    PERFORM 8000-PRT-CTRL-LIST   THRU 8000-EXIT                 
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F730 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3100-READ-BP13K730.                                                      
      *****************************************************************         
                                                                                
           MOVE F730-NUM-REGN          TO K730-NUM-REGN.                        
                                                                                
           READ BP13K730.                                                       
                                                                                
           EVALUATE WS-K730-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K730-READ                          
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K730: ' F730-NUM-REGN            
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K730 FAIL STATUS=' WS-K730-STATUS            
                 MOVE WS-K730-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3200-PROCESS-LETTERS.                                                    
      *****************************************************************         
                                                                                
           PERFORM 4000-PROCESS-B10-REC THRU 4000-EXIT.                         
                                                                                
           EVALUATE TRUE                                                        
              WHEN K730-CDE-ALLOC-SCH = 'TPS'                                   
                 PERFORM 7005-BP135P THRU 7005-EXIT                             
                                                                                
              WHEN K730-CDE-ALLOC-SCH = 'TCP'                                   
                 PERFORM 7010-BP13ES THRU 7010-EXIT                             
                                                                                
              WHEN K730-NUM-PORT-ELIG-TAG = 'P'                                 
                 PERFORM 7015-BP135J THRU 7015-EXIT                             
                                                                                
              WHEN (K730-NUM-MGPS NOT = SPACES AND LOW-VALUES) AND              
                    K730-NUM-ALLO-CAT = 'BTO'                                   
                 PERFORM 7020-BP13EU THRU 7020-EXIT                             
                                                                                
              WHEN ((K730-NUM-APPS NOT = SPACES AND LOW-VALUES) AND             
                    (F730-NUM-APPS-ELIG-TAG = '1' OR 'T')) OR                   
                   ((K730-NUM-MCPS = 'P' OR 'C' OR 'M' OR 'B') AND              
                    (K730-CDE-RESIDENT-HA1 = '1' OR 'A' OR 'T'))                
                 PERFORM 7025-BP13EW THRU 7025-EXIT                             
                                                                                
              WHEN OTHER                                                        
                 PERFORM 7030-BP13BQ THRU 7030-EXIT                             
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4000-PROCESS-B10-REC.                                                    
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO WS-P13P08ZA-B10-REC.                  
           INITIALIZE WS-P13P08ZA-B10-REC.                                      
                                                                                
           MOVE '_'                    TO WS-P08ZA-UNDERSCORE1                  
                                          WS-P08ZA-UNDERSCORE2                  
                                          WS-P08ZA-UNDERSCORE3.                 
           MOVE 'B10'                  TO WS-P08ZA-RECORD-TYPE.                 
           MOVE WS-PARM-JOBNAME        TO WS-P08ZA-JOBNAME.                     
           MOVE WS-UPD-TMESTAMP(1:12)  TO WS-P08ZA-TMESTAMP.                    
           MOVE K730-NUM-REGN          TO WS-P08ZA-NUM-REGN                     
                                          WS-P08ZA-OUR-REF.                     
           MOVE WS-DTE-PRINT           TO WS-P08ZA-DTE-PRINT.                   
                                                                                
           PERFORM 4100-READ-BP13K022 THRU 4100-EXIT.                           
           PERFORM 4200-READ-BP13K813 THRU 4200-EXIT.                           
           PERFORM 4300-READ-BP13K830 THRU 4300-EXIT.                           
           PERFORM 4400-GET-NME-APPLT THRU 4400-EXIT.                           
           PERFORM 4500-GET-TXT-EXER  THRU 4500-EXIT.                           
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4100-READ-BP13K022.                                                      
      *****************************************************************         
                                                                                
           MOVE K730-NUM-REGN          TO K022-NUM-REGN.                        
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K022-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                 ADD 1                 TO WS-K022-READ                          
                 PERFORM 4150-READ-BP13K024 THRU 4150-EXIT                      
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K022: ' K730-NUM-REGN            
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K022 FAIL STATUS=' WS-K022-STATUS            
                 MOVE WS-K022-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4150-READ-BP13K024.                                                      
      *****************************************************************         
                                                                                
           MOVE K022-NUM-OIC           TO K024-NUM-OIC.                         
                                                                                
           READ BP13K024.                                                       
                                                                                
           EVALUATE WS-K024-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K024-READ                          
                 MOVE K024-NME-OIC     TO WS-P08ZA-NME-OIC                      
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K024: '                          
                    'REGN=' K730-NUM-REGN ',KEY=' K022-NUM-OIC                  
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K024 FAIL STATUS=' WS-K024-STATUS            
                 MOVE WS-K024-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4200-READ-BP13K813.                                                      
      *****************************************************************         
                                                                                
           MOVE K730-CDE-NT1           TO K813-NUM-ZONE.                        
           MOVE K730-CDE-FLAT-TYPE     TO K813-NUM-FLAT-TYPE.                   
           MOVE K730-DTE-BALLOT        TO K813-DTE-BALLOT.                      
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE WS-K813-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K813-READ                          
                 MOVE K813-NME-FLAT-TYPE-LTR                                    
                                       TO WS-P08ZA-TXT-APPLIED-FT               
                 MOVE K813-NME-PROJECT-LTR                                      
                                       TO WS-P08ZA-TXT-APPLIED-ESTATE           
                 MOVE K813-TXT-RESULT-PERIOD-LTR                                
                                       TO WS-P08ZA-TXT-RESULT-PERIOD            
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K813: '                          
                    'REGN=' K730-NUM-REGN ',KEY=' K813-KEY-FLD                  
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K813 FAIL STATUS=' WS-K813-STATUS            
                 MOVE WS-K813-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4300-READ-BP13K830.                                                      
      *****************************************************************         
                                                                                
           MOVE K730-NUM-REGN          TO K830-NUM-REGN.                        
                                                                                
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K830-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                 ADD 1                 TO WS-K830-READ                          
                 PERFORM 4350-GET-ADDRESS THRU 4350-EXIT                        
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K830: ' K730-NUM-REGN            
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K830 FAIL STATUS=' WS-K830-STATUS            
                 MOVE WS-K830-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4350-GET-ADDRESS.                                                        
      *****************************************************************         
                                                                                
           IF ((K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES)                      
            OR (K830-NME-MAIL-STR-BLDG(1:47) = SPACES OR LOW-VALUES))           
              MOVE K830-NUM-BLK        TO WS-P08ZA-BLK                          
                                                                                
              IF ((K830-NUM-LVL-NUM = SPACES OR LOW-VALUES)                     
              AND (K830-NUM-HSEMAIN = SPACES OR LOW-VALUES))                    
                 CONTINUE                                                       
              ELSE                                                              
                 MOVE K830-NUM-FLAT    TO WS-P08ZA-HSE-NO                       
              END-IF                                                            
                                                                                
              MOVE K830-NME-STREET-BLDG(1:47)                                   
                                       TO WS-P08ZA-STR-BLDG                     
                                                                                
              IF (K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES)             
                 CONTINUE                                                       
              ELSE                                                              
                 STRING 'SINGAPORE ' K830-NUM-POSTAL                            
                    DELIMITED BY SIZE INTO WS-P08ZA-POSTAL                      
              END-IF                                                            
                                                                                
              MOVE SPACES              TO WS-LINK-AV02C015                      
              MOVE K830-NUM-POSTAL     TO AV02C015-IN-POSTCODE                  
              CALL 'AV02C015' USING AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM                
              MOVE AV02C015-OUT-POSTCODE-CHKSUM                                 
                                       TO WS-P08ZA-BAR-CODE                     
           ELSE                                                                 
              MOVE K830-NUM-MAIL-BLK   TO WS-P08ZA-BLK                          
                                                                                
              IF ((K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES)                
              AND (K830-NUM-MAIL-HSEMAIN = SPACES OR LOW-VALUES))               
                 CONTINUE                                                       
              ELSE                                                              
                 MOVE K830-NUM-MAIL-FLAT                                        
                                       TO WS-P08ZA-HSE-NO                       
              END-IF                                                            
                                                                                
              MOVE K830-NME-MAIL-STR-BLDG(1:47)                                 
                                       TO WS-P08ZA-STR-BLDG                     
                                                                                
              IF (K830-NUM-MAIL-POSTAL = SPACES                                 
               OR LOW-VALUES OR ZEROES)                                         
                 CONTINUE                                                       
              ELSE                                                              
                 STRING 'SINGAPORE ' K830-NUM-MAIL-POSTAL                       
                    DELIMITED BY SIZE INTO WS-P08ZA-POSTAL                      
              END-IF                                                            
                                                                                
              MOVE SPACES              TO WS-LINK-AV02C015                      
              MOVE K830-NUM-MAIL-POSTAL                                         
                                       TO AV02C015-IN-POSTCODE                  
              CALL 'AV02C015' USING AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM                
              MOVE AV02C015-OUT-POSTCODE-CHKSUM                                 
                                       TO WS-P08ZA-BAR-CODE                     
           END-IF.                                                              
                                                                                
       4350-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4400-GET-NME-APPLT.                                                      
      *****************************************************************         
                                                                                
           MOVE K730-NUM-REGN          TO K825-NUM-REGN.                        
           MOVE K730-NUM-NRIC1         TO K825-NUM-NRIC.                        
           PERFORM 4450-READ-BP13K825 THRU 4450-EXIT.                           
           MOVE K825-NME-OCCP          TO WS-P08ZA-NME-APPLT1.                  
                                                                                
           IF (K730-NUM-NRIC2(2:1) = '#' OR SPACES OR LOW-VALUES)               
              CONTINUE                                                          
           ELSE                                                                 
              MOVE K730-NUM-NRIC2      TO K825-NUM-NRIC                         
              PERFORM 4450-READ-BP13K825 THRU 4450-EXIT                         
              MOVE K825-NME-OCCP       TO WS-P08ZA-NME-APPLT2                   
           END-IF.                                                              
                                                                                
           IF (K730-NUM-NRIC3(2:1) = '#' OR SPACES OR LOW-VALUES)               
              CONTINUE                                                          
           ELSE                                                                 
              MOVE K730-NUM-NRIC3      TO K825-NUM-NRIC                         
              PERFORM 4450-READ-BP13K825 THRU 4450-EXIT                         
              MOVE K825-NME-OCCP       TO WS-P08ZA-NME-APPLT3                   
           END-IF.                                                              
                                                                                
           IF (K730-NUM-NRIC4(2:1) = '#' OR SPACES OR LOW-VALUES)               
              CONTINUE                                                          
           ELSE                                                                 
              MOVE K730-NUM-NRIC4      TO K825-NUM-NRIC                         
              PERFORM 4450-READ-BP13K825 THRU 4450-EXIT                         
              MOVE K825-NME-OCCP       TO WS-P08ZA-NME-APPLT4                   
           END-IF.                                                              
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4450-READ-BP13K825.                                                      
      *****************************************************************         
                                                                                
           READ BP13K825.                                                       
                                                                                
           EVALUATE WS-K825-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K825-READ                          
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K825: ' K825-KEY-FLD             
                 MOVE SPACES           TO K825-NME-OCCP                         
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K825 FAIL STATUS=' WS-K825-STATUS            
                 MOVE WS-K825-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4500-GET-TXT-EXER.                                                       
      *****************************************************************         
                                                                                
           PERFORM 4550-SEARCH-MONTH THRU 4550-EXIT.                            
                                                                                
           EVALUATE F730-NUM-ALLO-CAT                                           
              WHEN 'BTO'                                                        
                 STRING 'FLAT APPLICATION IN ' DELIMITED BY SIZE                
                        WS-DTE-BAL-MTH-9 DELIMITED BY SPACES                    
                        ' ' F730-DTE-BALLOT(1:4) ' '                            
                        'BUILD-TO-ORDER EXERCISE'                               
                    DELIMITED BY SIZE INTO WS-P08ZA-TXT-EXERCISE                
              WHEN 'BE'                                                         
                 STRING 'FLAT APPLICATION IN ' DELIMITED BY SIZE                
                        WS-DTE-BAL-MTH-9 DELIMITED BY SPACES                    
                        ' ' F730-DTE-BALLOT(1:4) ' '                            
                        'BALLOTING EXERCISE'                                    
                    DELIMITED BY SIZE INTO WS-P08ZA-TXT-EXERCISE                
              WHEN 'SBF'                                                        
                 STRING 'FLAT APPLICATION IN ' DELIMITED BY SIZE                
                        WS-DTE-BAL-MTH-9 DELIMITED BY SPACES                    
                        ' ' F730-DTE-BALLOT(1:4) ' '                            
                        'SALE OF BALANCE FLATS EXERCISE'                        
                    DELIMITED BY SIZE INTO WS-P08ZA-TXT-EXERCISE                
              WHEN OTHER                                                        
                 CONTINUE                                                       
           END-EVALUATE.                                                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4550-SEARCH-MONTH.                                                       
      *****************************************************************         
                                                                                
           SET WS-MTH-IND              TO 1.                                    
           SEARCH WS-MONTH-TABLE                                                
              AT END                                                            
                 MOVE SPACES           TO WS-DTE-BAL-MTH-9                      
              WHEN WS-MONTH-IN-DIGITS(WS-MTH-IND) =                             
                                               F730-DTE-BALLOT(5:2)             
                 MOVE WS-MONTH-IN-WORDS(WS-MTH-IND)                             
                                       TO WS-DTE-BAL-MTH-9                      
           END-SEARCH.                                                          
                                                                                
       4550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7005-BP135P.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B8Z5P-SNO.                         
           MOVE WS-B8Z5P-SNO           TO WS-P08ZA-NUM-SNO.                     
                                                                                
           MOVE 'BP135P'               TO WS-P08ZA-DESC                         
                                          WS-P08ZA-NUM-FORMID1.                 
           MOVE 'BP135N'               TO WS-P08ZA-NUM-FORMID2.                 
                                                                                
           WRITE P13B8Z5P-REC FROM WS-P13P08ZA-B10-REC.                         
           ADD 1                       TO WS-H8Z5P-WRITE                        
                                          WS-BP135P-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7010-BP13ES.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B8ZES-SNO.                         
           MOVE WS-B8ZES-SNO           TO WS-P08ZA-NUM-SNO.                     
                                                                                
           MOVE 'BP13ES'               TO WS-P08ZA-DESC                         
                                          WS-P08ZA-NUM-FORMID1.                 
           MOVE 'BP13ET'               TO WS-P08ZA-NUM-FORMID2.                 
                                                                                
           WRITE P13B8ZES-REC FROM WS-P13P08ZA-B10-REC.                         
           ADD 1                       TO WS-H8ZES-WRITE                        
                                          WS-BP13ES-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7015-BP135J.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B8Z5J-SNO.                         
           MOVE WS-B8Z5J-SNO           TO WS-P08ZA-NUM-SNO.                     
                                                                                
           MOVE 'BP135J'               TO WS-P08ZA-DESC                         
                                          WS-P08ZA-NUM-FORMID1.                 
           MOVE 'BP13EV'               TO WS-P08ZA-NUM-FORMID2.                 
                                                                                
           WRITE P13B8Z5J-REC FROM WS-P13P08ZA-B10-REC.                         
           ADD 1                       TO WS-H8Z5J-WRITE                        
                                          WS-BP135J-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7015-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7020-BP13EU.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B8ZEU-SNO.                         
           MOVE WS-B8ZEU-SNO           TO WS-P08ZA-NUM-SNO.                     
                                                                                
           MOVE 'BP13EU'               TO WS-P08ZA-DESC                         
                                          WS-P08ZA-NUM-FORMID1.                 
           MOVE 'BP13EV'               TO WS-P08ZA-NUM-FORMID2.                 
                                                                                
           WRITE P13B8ZEU-REC FROM WS-P13P08ZA-B10-REC.                         
           ADD 1                       TO WS-H8ZEU-WRITE                        
                                          WS-BP13EU-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7025-BP13EW.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B8ZEW-SNO.                         
           MOVE WS-B8ZEW-SNO           TO WS-P08ZA-NUM-SNO.                     
                                                                                
           MOVE 'BP13EW'               TO WS-P08ZA-DESC                         
                                          WS-P08ZA-NUM-FORMID1.                 
           MOVE 'BP135T'               TO WS-P08ZA-NUM-FORMID2.                 
           MOVE '20%'                  TO WS-P08ZA-TXT-SPS-QUOTA.               
                                                                                
           IF K813-NUM-ZONE = '668'                                             
              MOVE '10%'               TO WS-P08ZA-TXT-SPS-QUOTA                
           END-IF.                                                              
                                                                                
           WRITE P13B8ZEW-REC FROM WS-P13P08ZA-B10-REC.                         
           ADD 1                       TO WS-H8ZEW-WRITE                        
                                          WS-BP13EW-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7025-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7030-BP13BQ.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B8ZBQ-SNO.                         
           MOVE WS-B8ZBQ-SNO           TO WS-P08ZA-NUM-SNO.                     
                                                                                
           MOVE 'BP13BQ'               TO WS-P08ZA-DESC                         
                                          WS-P08ZA-NUM-FORMID1.                 
           MOVE 'BP13EV'               TO WS-P08ZA-NUM-FORMID2.                 
                                                                                
           WRITE P13B8ZBQ-REC FROM WS-P13P08ZA-B10-REC.                         
           ADD 1                       TO WS-H8ZBQ-WRITE                        
                                          WS-BP13BQ-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7030-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8000-PRT-CTRL-LIST.                                                      
      *****************************************************************         
                                                                                
           EVALUATE TRUE                                                        
              WHEN K730-CDE-ALLOC-SCH = 'TPS'                                   
                 PERFORM 8005-PRT-CTRL-L08ZA THRU 8005-EXIT                     
                                                                                
              WHEN K730-CDE-ALLOC-SCH = 'TCP'                                   
                 PERFORM 8010-PRT-CTRL-L08ZB THRU 8010-EXIT                     
                                                                                
              WHEN K730-NUM-PORT-ELIG-TAG = 'P'                                 
                 PERFORM 8015-PRT-CTRL-L08ZC THRU 8015-EXIT                     
                                                                                
              WHEN (K730-NUM-MGPS NOT = SPACES AND LOW-VALUES) AND              
                    K730-NUM-ALLO-CAT = 'BTO'                                   
                 PERFORM 8020-PRT-CTRL-L08ZD THRU 8020-EXIT                     
                                                                                
              WHEN ((K730-NUM-APPS NOT = SPACES AND LOW-VALUES) AND             
                    (F730-NUM-APPS-ELIG-TAG = '1' OR 'T')) OR                   
                   ((K730-NUM-MCPS = 'P' OR 'C' OR 'M' OR 'B') AND              
                    (K730-CDE-RESIDENT-HA1 = '1' OR 'A' OR 'T'))                
                 PERFORM 8025-PRT-CTRL-L08ZE THRU 8025-EXIT                     
                                                                                
              WHEN OTHER                                                        
                 PERFORM 8030-PRT-CTRL-L08ZF THRU 8030-EXIT                     
                                                                                
           END-EVALUATE.                                                        
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8005-PRT-CTRL-L08ZA.                                                     
      *****************************************************************         
                                                                                
           IF WS-L08ZA-LINE-CNT > 59                                            
              ADD 1                    TO WS-L08ZA-PAGE-CNT                     
              MOVE WS-L08ZA-PAGE-CNT   TO L08Z-PAGE                             
                                                                                
              MOVE 'P13L08ZA'          TO L08Z-LISTING                          
              MOVE 'CTRL LIST FOR TPS LETTER - ELDERLY'                         
                                       TO L08Z-LISTING-TYPE                     
                                                                                
              WRITE P13L08ZA-REC FROM L08Z-HDR1 AFTER PAGE                      
              WRITE P13L08ZA-REC FROM L08Z-HDR2                                 
              WRITE P13L08ZA-REC FROM L08Z-BLANK                                
              WRITE P13L08ZA-REC FROM L08Z-HDR3                                 
              WRITE P13L08ZA-REC FROM L08Z-BLANK                                
              WRITE P13L08ZA-REC FROM L08Z-HDR4                                 
              WRITE P13L08ZA-REC FROM L08Z-HDR5                                 
              WRITE P13L08ZA-REC FROM L08Z-BLANK                                
                                                                                
              MOVE 8                   TO WS-L08ZA-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L08ZA-CNT.                         
           MOVE WS-L08ZA-CNT           TO L08Z-SERIAL-NO.                       
                                                                                
           PERFORM 8300-POPULATE-L08Z THRU 8300-EXIT.                           
                                                                                
           WRITE P13L08ZA-REC FROM L08Z-DTL1.                                   
           WRITE P13L08ZA-REC FROM L08Z-DTL2.                                   
           WRITE P13L08ZA-REC FROM L08Z-DTL3.                                   
           WRITE P13L08ZA-REC FROM L08Z-BLANK.                                  
           ADD 4                       TO WS-L08ZA-LINE-CNT.                    
                                                                                
           PERFORM 8400-PRT-CTRL-L08ZZ THRU 8400-EXIT.                          
                                                                                
       8005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8010-PRT-CTRL-L08ZB.                                                     
      *****************************************************************         
                                                                                
           IF WS-L08ZB-LINE-CNT > 59                                            
              ADD 1                    TO WS-L08ZB-PAGE-CNT                     
              MOVE WS-L08ZB-PAGE-CNT   TO L08Z-PAGE                             
                                                                                
              MOVE 'P13L08ZB'          TO L08Z-LISTING                          
              MOVE 'CTRL LIST FOR TCP LETTER - ELDERLY'                         
                                       TO L08Z-LISTING-TYPE                     
                                                                                
              WRITE P13L08ZB-REC FROM L08Z-HDR1 AFTER PAGE                      
              WRITE P13L08ZB-REC FROM L08Z-HDR2                                 
              WRITE P13L08ZB-REC FROM L08Z-BLANK                                
              WRITE P13L08ZB-REC FROM L08Z-HDR3                                 
              WRITE P13L08ZB-REC FROM L08Z-BLANK                                
              WRITE P13L08ZB-REC FROM L08Z-HDR4                                 
              WRITE P13L08ZB-REC FROM L08Z-HDR5                                 
              WRITE P13L08ZB-REC FROM L08Z-BLANK                                
                                                                                
              MOVE 8                   TO WS-L08ZB-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L08ZB-CNT.                         
           MOVE WS-L08ZB-CNT           TO L08Z-SERIAL-NO.                       
                                                                                
           PERFORM 8300-POPULATE-L08Z THRU 8300-EXIT.                           
                                                                                
           WRITE P13L08ZB-REC FROM L08Z-DTL1.                                   
           WRITE P13L08ZB-REC FROM L08Z-DTL2.                                   
           WRITE P13L08ZB-REC FROM L08Z-DTL3.                                   
           WRITE P13L08ZB-REC FROM L08Z-BLANK.                                  
           ADD 4                       TO WS-L08ZB-LINE-CNT.                    
                                                                                
           PERFORM 8400-PRT-CTRL-L08ZZ THRU 8400-EXIT.                          
                                                                                
       8010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8015-PRT-CTRL-L08ZC.                                                     
      *****************************************************************         
                                                                                
           IF WS-L08ZC-LINE-CNT > 59                                            
              ADD 1                    TO WS-L08ZC-PAGE-CNT                     
              MOVE WS-L08ZC-PAGE-CNT   TO L08Z-PAGE                             
                                                                                
              MOVE 'P13L08ZC'          TO L08Z-LISTING                          
              MOVE 'CTRL LIST FOR SERS LETTER - ELDERLY'                        
                                       TO L08Z-LISTING-TYPE                     
                                                                                
              WRITE P13L08ZC-REC FROM L08Z-HDR1 AFTER PAGE                      
              WRITE P13L08ZC-REC FROM L08Z-HDR2                                 
              WRITE P13L08ZC-REC FROM L08Z-BLANK                                
              WRITE P13L08ZC-REC FROM L08Z-HDR3                                 
              WRITE P13L08ZC-REC FROM L08Z-BLANK                                
              WRITE P13L08ZC-REC FROM L08Z-HDR4                                 
              WRITE P13L08ZC-REC FROM L08Z-HDR5                                 
              WRITE P13L08ZC-REC FROM L08Z-BLANK                                
                                                                                
              MOVE 8                   TO WS-L08ZC-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L08ZC-CNT.                         
           MOVE WS-L08ZC-CNT           TO L08Z-SERIAL-NO.                       
                                                                                
           PERFORM 8300-POPULATE-L08Z THRU 8300-EXIT.                           
                                                                                
           WRITE P13L08ZC-REC FROM L08Z-DTL1.                                   
           WRITE P13L08ZC-REC FROM L08Z-DTL2.                                   
           WRITE P13L08ZC-REC FROM L08Z-DTL3.                                   
           WRITE P13L08ZC-REC FROM L08Z-BLANK.                                  
           ADD 4                       TO WS-L08ZC-LINE-CNT.                    
                                                                                
           PERFORM 8400-PRT-CTRL-L08ZZ THRU 8400-EXIT.                          
                                                                                
       8015-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8020-PRT-CTRL-L08ZD.                                                     
      *****************************************************************         
                                                                                
           IF WS-L08ZD-LINE-CNT > 59                                            
              ADD 1                    TO WS-L08ZD-PAGE-CNT                     
              MOVE WS-L08ZD-PAGE-CNT   TO L08Z-PAGE                             
                                                                                
              MOVE 'P13L08ZD'          TO L08Z-LISTING                          
              MOVE 'CTRL LIST FOR MGPS LETTER - ELDERLY'                        
                                       TO L08Z-LISTING-TYPE                     
                                                                                
              WRITE P13L08ZD-REC FROM L08Z-HDR1 AFTER PAGE                      
              WRITE P13L08ZD-REC FROM L08Z-HDR2                                 
              WRITE P13L08ZD-REC FROM L08Z-BLANK                                
              WRITE P13L08ZD-REC FROM L08Z-HDR3                                 
              WRITE P13L08ZD-REC FROM L08Z-BLANK                                
              WRITE P13L08ZD-REC FROM L08Z-HDR4                                 
              WRITE P13L08ZD-REC FROM L08Z-HDR5                                 
              WRITE P13L08ZD-REC FROM L08Z-BLANK                                
                                                                                
              MOVE 8                   TO WS-L08ZD-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L08ZD-CNT.                         
           MOVE WS-L08ZD-CNT           TO L08Z-SERIAL-NO.                       
                                                                                
           PERFORM 8300-POPULATE-L08Z THRU 8300-EXIT.                           
                                                                                
           WRITE P13L08ZD-REC FROM L08Z-DTL1.                                   
           WRITE P13L08ZD-REC FROM L08Z-DTL2.                                   
           WRITE P13L08ZD-REC FROM L08Z-DTL3.                                   
           WRITE P13L08ZD-REC FROM L08Z-BLANK.                                  
           ADD 4                       TO WS-L08ZD-LINE-CNT.                    
                                                                                
           PERFORM 8400-PRT-CTRL-L08ZZ THRU 8400-EXIT.                          
                                                                                
       8020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8025-PRT-CTRL-L08ZE.                                                     
      *****************************************************************         
                                                                                
           IF WS-L08ZE-LINE-CNT > 59                                            
              ADD 1                    TO WS-L08ZE-PAGE-CNT                     
              MOVE WS-L08ZE-PAGE-CNT   TO L08Z-PAGE                             
                                                                                
              MOVE 'P13L08ZE'          TO L08Z-LISTING                          
              MOVE 'CTRL LIST FOR SPS LETTER - ELDERLY'                         
                                       TO L08Z-LISTING-TYPE                     
                                                                                
              WRITE P13L08ZE-REC FROM L08Z-HDR1 AFTER PAGE                      
              WRITE P13L08ZE-REC FROM L08Z-HDR2                                 
              WRITE P13L08ZE-REC FROM L08Z-BLANK                                
              WRITE P13L08ZE-REC FROM L08Z-HDR3                                 
              WRITE P13L08ZE-REC FROM L08Z-BLANK                                
              WRITE P13L08ZE-REC FROM L08Z-HDR4                                 
              WRITE P13L08ZE-REC FROM L08Z-HDR5                                 
              WRITE P13L08ZE-REC FROM L08Z-BLANK                                
                                                                                
              MOVE 8                   TO WS-L08ZE-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L08ZE-CNT.                         
           MOVE WS-L08ZE-CNT           TO L08Z-SERIAL-NO.                       
                                                                                
           PERFORM 8300-POPULATE-L08Z THRU 8300-EXIT.                           
                                                                                
           WRITE P13L08ZE-REC FROM L08Z-DTL1.                                   
           WRITE P13L08ZE-REC FROM L08Z-DTL2.                                   
           WRITE P13L08ZE-REC FROM L08Z-DTL3.                                   
           WRITE P13L08ZE-REC FROM L08Z-BLANK.                                  
           ADD 4                       TO WS-L08ZE-LINE-CNT.                    
                                                                                
           PERFORM 8400-PRT-CTRL-L08ZZ THRU 8400-EXIT.                          
                                                                                
       8025-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8030-PRT-CTRL-L08ZF.                                                     
      *****************************************************************         
                                                                                
           IF WS-L08ZF-LINE-CNT > 59                                            
              ADD 1                    TO WS-L08ZF-PAGE-CNT                     
              MOVE WS-L08ZF-PAGE-CNT   TO L08Z-PAGE                             
                                                                                
              MOVE 'P13L08ZF'          TO L08Z-LISTING                          
              MOVE 'CTRL LIST FOR ELDERLY QUOTA LETTER'                         
                                       TO L08Z-LISTING-TYPE                     
                                                                                
              WRITE P13L08ZF-REC FROM L08Z-HDR1 AFTER PAGE                      
              WRITE P13L08ZF-REC FROM L08Z-HDR2                                 
              WRITE P13L08ZF-REC FROM L08Z-BLANK                                
              WRITE P13L08ZF-REC FROM L08Z-HDR3                                 
              WRITE P13L08ZF-REC FROM L08Z-BLANK                                
              WRITE P13L08ZF-REC FROM L08Z-HDR4                                 
              WRITE P13L08ZF-REC FROM L08Z-HDR5                                 
              WRITE P13L08ZF-REC FROM L08Z-BLANK                                
                                                                                
              MOVE 8                   TO WS-L08ZF-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L08ZF-CNT.                         
           MOVE WS-L08ZF-CNT           TO L08Z-SERIAL-NO.                       
                                                                                
           PERFORM 8300-POPULATE-L08Z THRU 8300-EXIT.                           
                                                                                
           WRITE P13L08ZF-REC FROM L08Z-DTL1.                                   
           WRITE P13L08ZF-REC FROM L08Z-DTL2.                                   
           WRITE P13L08ZF-REC FROM L08Z-DTL3.                                   
           WRITE P13L08ZF-REC FROM L08Z-BLANK.                                  
           ADD 4                       TO WS-L08ZF-LINE-CNT.                    
                                                                                
           PERFORM 8400-PRT-CTRL-L08ZZ THRU 8400-EXIT.                          
                                                                                
       8030-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8300-POPULATE-L08Z.                                                      
      *****************************************************************         
                                                                                
           MOVE K730-NUM-REF           TO L08Z-REF-NO                           
                                          L08Z-REF-NO-SUM.                      
           MOVE K730-NUM-REGN          TO L08Z-REGN-NO.                         
           MOVE WS-P08ZA-NME-APPLT1    TO L08Z-NAME-1                           
                                          L08Z-NAME-1-SUM.                      
           MOVE K730-NUM-NRIC1         TO L08Z-NRIC-1                           
                                          L08Z-NRIC-1-SUM.                      
           MOVE K730-CDE-NT1           TO L08Z-NT1                              
                                          L08Z-NT1-SUM.                         
           MOVE K730-NUM-MCPS          TO L08Z-MCPS.                            
           MOVE K730-NUM-RES-NRIC1     TO L08Z-RES-NRIC1                        
                                          L08Z-RES-NRIC1-SUM.                   
           MOVE K730-NUM-RES-NRIC2     TO L08Z-RES-NRIC2.                       
           MOVE K730-CDE-FLAT-TYPE     TO L08Z-FLAT                             
                                          L08Z-FLAT-SUM.                        
           MOVE K730-CDE-ALLOC-SCH     TO L08Z-ALLOC                            
                                          L08Z-ALLOC-SUM.                       
           MOVE K730-CDE-ELIG-SCH      TO L08Z-ELIG-SCH.                        
           MOVE K730-NUM-JB-REGN       TO L08Z-JB-REGN.                         
           MOVE K730-NUM-RANDOM-PRIORITY                                        
                                       TO L08Z-CHANCE-SUM.                      
           MOVE K730-NUM-PORT-ELIG-TAG TO L08Z-PORT-TAG                         
                                          L08Z-PORT-TAG-SUM.                    
           MOVE K730-CDE-CATEGORY      TO L08Z-CAT                              
                                          L08Z-CAT-SUM.                         
           MOVE K730-CDE-SUCC-NT-ZONE  TO L08Z-SUCC.                            
           MOVE K730-CDE-RESIDENT-HA1  TO L08Z-RES-HA1.                         
                                                                                
           STRING K730-NUM-MCPS '(' K730-CDE-RESIDENT-HA1 ')'                   
              DELIMITED BY SIZE INTO L08Z-MCPS-SUM.                             
                                                                                
           MOVE WS-P08ZA-NME-APPLT2    TO L08Z-NAME-2.                          
           IF K730-NUM-NRIC2(2:1) = '#'                                         
              MOVE SPACES              TO L08Z-NRIC-2                           
           ELSE                                                                 
              MOVE K730-NUM-NRIC2      TO L08Z-NRIC-2                           
           END-IF.                                                              
                                                                                
           MOVE K730-CDE-BALLOT-HOUSEHOLD                                       
                                       TO L08Z-BHH.                             
           MOVE K730-CDE-HOUSEHOLD     TO L08Z-HHTY.                            
           MOVE K730-NUM-GRO-RANK      TO L08Z-GRO-RANK.                        
           MOVE K730-CDE-SERVE         TO L08Z-SERVE                            
                                          L08Z-SERVE-SUM.                       
           MOVE K730-CDE-ELIG-TAG      TO L08Z-ELIG-TAG.                        
           MOVE K730-NUM-NT-FT-QUEUE   TO L08Z-QUEUE.                           
           MOVE K730-NUM-5YR-OCCUPN    TO L08Z-5YR-SUM.                         
                                                                                
           IF K730-DTE-REQUEST = SPACES OR LOW-VALUES                           
              MOVE SPACES              TO L08Z-DTE-REQ-SUM                      
           ELSE                                                                 
              STRING  K730-DTE-REQUEST(7:2) '/'                                 
                      K730-DTE-REQUEST(5:2) '/'                                 
                      K730-DTE-REQUEST(1:4)                                     
                 DELIMITED BY SIZE INTO L08Z-DTE-REQ-SUM                        
           END-IF.                                                              
                                                                                
           MOVE WS-P08ZA-BLK           TO L08Z-BLK.                             
           MOVE WS-P08ZA-HSE-NO        TO L08Z-UNIT.                            
           MOVE WS-P08ZA-STR-BLDG      TO L08Z-ADDR2.                           
           MOVE WS-P08ZA-POSTAL        TO L08Z-ADDR3.                           
                                                                                
       8300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8400-PRT-CTRL-L08ZZ.                                                     
      *****************************************************************         
                                                                                
           IF WS-L08ZZ-LINE-CNT > 59                                            
              MOVE ZEROES              TO WS-L08ZZ-LINE-CNT                     
                                                                                
              ADD 1                    TO WS-L08ZZ-PAGE-CNT                     
              MOVE WS-L08ZZ-PAGE-CNT   TO L08Z-PAGE                             
                                                                                
              MOVE 'P13L08ZZ'          TO L08Z-LISTING                          
              MOVE '          SUMMARY OF CONTROL LIST'                          
                                       TO L08Z-LISTING-TYPE                     
                                                                                
              WRITE P13L08ZZ-REC FROM L08Z-HDR1 AFTER PAGE                      
              WRITE P13L08ZZ-REC FROM L08Z-HDR2                                 
              WRITE P13L08ZZ-REC FROM L08Z-BLANK                                
              WRITE P13L08ZZ-REC FROM L08Z-HDR3                                 
              WRITE P13L08ZZ-REC FROM L08Z-BLANK                                
              WRITE P13L08ZZ-REC FROM L08Z-HDR6                                 
              WRITE P13L08ZZ-REC FROM L08Z-HDR7                                 
              WRITE P13L08ZZ-REC FROM L08Z-BLANK                                
                                                                                
              MOVE 8                      TO WS-L08ZZ-LINE-CNT                  
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L08ZZ-CNT.                         
           MOVE WS-L08ZZ-CNT           TO L08Z-SERIAL-NO-SUM.                   
                                                                                
           WRITE P13L08ZZ-REC FROM L08Z-DTL4.                                   
           WRITE P13L08ZZ-REC FROM L08Z-DTL2.                                   
           WRITE P13L08ZZ-REC FROM L08Z-DTL3.                                   
           WRITE P13L08ZZ-REC FROM L08Z-BLANK.                                  
           ADD 4                       TO WS-L08ZZ-LINE-CNT.                    
                                                                                
       8400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8900-CREATE-FIOMS-REC.                                                   
      *****************************************************************         
                                                                                
           PERFORM 8910-WRITE-BP13FH10 THRU 8910-EXIT.                          
                                                                                
      * FTP                                                                     
           WRITE BP13FTP-REC FROM WS-FTP-LINE1.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE2.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE3.                                 
           ADD 3                       TO WS-FTP-WRITE.                         
                                                                                
           MOVE 'BP135P'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP13ES'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP135J'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP13EU'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP13EW'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP13BQ'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
                                                                                
           WRITE BP13FTP-REC FROM WS-FTP-LINE5.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE6.                                 
           ADD 2                       TO WS-FTP-WRITE.                         
                                                                                
       8900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8910-WRITE-BP13FH10.                                                     
      *****************************************************************         
                                                                                
           MOVE 'EAALST1V'             TO WS-GROUP-ID.                          
           MOVE WS-H8Z5P-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H8Z5P-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H8Z5P-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST1W'             TO WS-GROUP-ID.                          
           MOVE WS-H8ZES-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H8ZES-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H8ZES-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST2C'             TO WS-GROUP-ID.                          
           MOVE WS-H8Z5J-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H8Z5J-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H8Z5J-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST1X'             TO WS-GROUP-ID.                          
           MOVE WS-H8ZEU-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H8ZEU-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H8ZEU-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST1Y'             TO WS-GROUP-ID.                          
           MOVE WS-H8ZEW-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H8ZEW-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H8ZEW-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST1B'             TO WS-GROUP-ID.                          
           MOVE WS-H8ZBQ-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H8ZBQ-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H8ZBQ-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
       8910-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8915-POPULATE-FH10A.                                                     
      *****************************************************************         
                                                                                
      * H10                                                                     
           MOVE SPACES                 TO WS-P13FH10A-REC.                      
           INITIALIZE WS-P13FH10A-REC.                                          
                                                                                
           MOVE 'H10'                  TO WS-FH10-RECORD-TYPE.                  
           MOVE WS-PARM-JOBNAME        TO WS-FH10-JOBNAME.                      
           MOVE WS-UPD-TMESTAMP(1:14)  TO WS-FH10-JOBDATE.                      
           MOVE 'BP13W003'             TO WS-FH10-WFD-ID.                       
           MOVE 'Y'                    TO WS-FH10-OUTPUT-PRINT.                 
           MOVE WS-GROUP-ID            TO WS-FH10-GROUP-ID.                     
                                                                                
      * FEEDBACK FROM MOOI ON 18/5/2017                                         
      * IOMS NOT CATER FOR THE PRINTING OF 2 COPIES                             
      * USING PROGRAM TO TRIGGER TWICE INSTEAD                                  
      *    MOVE 2                      TO WS-FH10-COPIES.                       
      *                                                                         
           MOVE 1                      TO WS-FH10-COPIES.                       
           MOVE 'B'                    TO WS-FH10-COLOUR.                       
           MOVE 'A4W'                  TO WS-FH10-PAPER-TYPE.                   
           MOVE 'D'                    TO WS-FH10-PRINT-SETTING.                
           MOVE 'N'                    TO WS-FH10-AMIS                          
                                          WS-FH10-OMR                           
                                          WS-FH10-OUTPUT-FILING                 
                                          WS-FH10-OUTPUT-ONEINBOX               
                                          WS-FH10-OUTPUT-SMS                    
                                          WS-FH10-OUTPUT-EMAIL                  
                                          WS-FH10-OUTPUT-FAX.                   
                                                                                
      * T10                                                                     
           MOVE SPACES                 TO WS-P13FT10A-REC.                      
           INITIALIZE WS-P13FT10A-REC.                                          
                                                                                
           MOVE 'T10'                  TO WS-FT10-RECORD-TYPE.                  
           MOVE WS-P13FT10A-WRITE      TO WS-FT10-TOTAL-ACCOUNTS.               
                                                                                
       8915-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8920-WRITE-BP13FTP-SRC.                                                  
      *****************************************************************         
                                                                                
           MOVE WS-PARM-JOBNAME        TO WS-FTP-JOBNAME.                       
           MOVE WS-UPD-TMESTAMP(1:12)  TO WS-FTP-TMESTAMP.                      
                                                                                
      * B10                                                                     
           MOVE SPACES                 TO  WS-FTP-SOURCE.                       
           STRING "PUT '"                                                       
                  WS-PARM-B10-SOURCE "." WS-FTP-DESC                            
                  "' "                                                          
                  WS-FTP-DEST-REC ".TXT"                                        
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                              
           END-STRING.                                                          
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                                 
           ADD 1                       TO WS-FTP-WRITE.                         
                                                                                
      * H10                                                                     
           MOVE SPACES                 TO WS-FTP-SOURCE.                        
           STRING "PUT '"                                                       
                  WS-PARM-H10-SOURCE "." WS-FTP-DESC                            
                  "' "                                                          
                  WS-FTP-DEST-REC ".H10"                                        
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                              
           END-STRING.                                                          
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                                 
           ADD 1                       TO WS-FTP-WRITE.                         
                                                                                
       8920-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       9000-CLOSE-FILES.                                                        
      *****************************************************************         
                                                                                
           CLOSE BP13F730                                                       
                 BP13K022                                                       
                 BP13K024                                                       
                 BP13K730                                                       
                 BP13K813                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 P13B8Z5P                                                       
                 P13H8Z5P                                                       
                 P13B8ZES                                                       
                 P13H8ZES                                                       
                 P13B8Z5J                                                       
                 P13H8Z5J                                                       
                 P13B8ZEU                                                       
                 P13H8ZEU                                                       
                 P13B8ZEW                                                       
                 P13H8ZEW                                                       
                 P13B8ZBQ                                                       
                 P13H8ZBQ                                                       
                 BP13FTP                                                        
                 P13L08ZA                                                       
                 P13L08ZB                                                       
                 P13L08ZC                                                       
                 P13L08ZD                                                       
                 P13L08ZE                                                       
                 P13L08ZF                                                       
                 P13L08ZZ.                                                      
                                                                                
           IF WS-K022-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K022 FAIL STATUS=' WS-K022-STATUS              
              MOVE WS-K022-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K024-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K024 FAIL STATUS=' WS-K024-STATUS              
              MOVE WS-K024-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K730-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K730 FAIL STATUS=' WS-K730-STATUS              
              MOVE WS-K730-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K813 FAIL STATUS=' WS-K813-STATUS              
              MOVE WS-K813-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K825-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K825 FAIL STATUS=' WS-K825-STATUS              
              MOVE WS-K825-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K830 FAIL STATUS=' WS-K830-STATUS              
              MOVE WS-K830-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           DISPLAY '******************************'.                            
           DISPLAY '* PROGRAM BP13C08Z           *'.                            
           DISPLAY '* CONTROL COUNTS             *'.                            
           DISPLAY '*----------------------------*'.                            
           DISPLAY '* REC READ F730     : ' WS-F730-READ ' *'.                  
           DISPLAY '* REC READ K022     : ' WS-K022-READ ' *'.                  
           DISPLAY '* REC READ K024     : ' WS-K024-READ ' *'.                  
           DISPLAY '* REC READ K730     : ' WS-K730-READ ' *'.                  
           DISPLAY '* REC READ K813     : ' WS-K813-READ ' *'.                  
           DISPLAY '* REC READ K825     : ' WS-K825-READ ' *'.                  
           DISPLAY '* REC READ K830     : ' WS-K830-READ ' *'.                  
           DISPLAY '* REC WRITTEN FH10  : ' WS-FH10-WRITE ' *'.                 
           DISPLAY '* REC WRITTEN FB10  : ' WS-FB10-WRITE ' *'.                 
           DISPLAY '* REC WRITTEN FTP   : ' WS-FTP-WRITE ' *'.                  
           DISPLAY '* CASES FOR BP13BQ  : ' WS-BP13BQ-CNT ' *'.                 
           DISPLAY '* CASES FOR BP135P  : ' WS-BP135P-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13ES  : ' WS-BP13ES-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13EU  : ' WS-BP13EU-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13EW  : ' WS-BP13EW-CNT ' *'.                 
           DISPLAY '* CASES FOR BP135J  : ' WS-BP135J-CNT ' *'.                 
           DISPLAY '******************************'.                            
                                                                                
       9000-EXIT.                                                               
           STOP RUN.                                                            
           EXIT.                                                                
                                                                                
      *======================  END OF PROGRAM  ======================*          
