       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CH07.                                                 
      *AUTHOR.        BO JIANG.                                                 
      *DATE-WRITTEN.  04AUG2008.                                                
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : PRINT LETTER ON CASES DID NIT BOOK FLAT     *            
      *                BASED ON ALLOCA-TAG TO INDICATE DEBARMENT   *            
      *                ON NON-SELECTION COUNT.                     *            
      *                                                            *            
      *  INPUT FILES : 1.  BP13F800  -                             *            
      *                2.  SY02F001  -                             *            
      *                3.  BP13KH15  -                             *            
      *                4.  BP13K820  -                             *            
      *                5.  BP13K830  -                             *            
      *                6.  BP13K022  -                             *            
      *                7.  BP13K024  -                             *            
      *                8.  BP13K813  -                             *            
      *                9.  BP13KH10  -                             *            
      *                                                            *            
      *  LETTERS     : 1.  P13PH07A  - (BP13I0)  REPLACE W/ BP138A *            
      *                2.  P13PH07B  - (BP13I1)  REPLACE W/ BP138B *            
      *                3.  P13PH07C  - (BP13I2)                    *            
      *                4.  P13PH07D  - (BP13I3)                    *            
      *                5.  P13PH07E  - (BP13I4)  REPLACE W/ BP138C *            
      *                6.  P13PH07F  - (BP13I5)  REPLACE W/ BP138D *            
      *                7.  P13PH07G  - (BP13I6)                    *            
      *                8.  P13PH07H  - (BP13I7)                    *            
      *                9.  P13PH07I  - (BP13IT)  REPLACE W/ BP139E *            
      *               10.  P13PH07J  - (BP13IU)                    *            
      *               11.  P13PH07K  - (BP13IV)                    *            
      *               12.  P13PH07L  - (BP13IW)                    *            
      *               13.  P13PH07M  - (BP13IX)                    *            
      *               14.  P13PH07N  - (BP131B)                    *            
      *               15.  P13PH07O  - (BP131C)                    *            
      *               16.  P13PH07P  - (BP131D)                    *            
      *               17.  P13PH07Q  - (BP131E)                    *            
      *               18.  P13PH07R  - (BP131F)                    *            
      *               19.  P13PH07S  - (BP131G)                    *            
      *               20.  P13PH07T  - (BP131J)                    *            
      *               21.  P13PH07U  - (BP131K)                    *            
      *               22.  P13PH07V  - (BP13I9)  REPLACE W/ BP138F *            
      *               23.  P13PH07W  - (BP138A)                    *            
      *               24.  P13PH07X  - (BP138B)                    *            
      *               25.  P13PH07Y  - (BP138C)                    *            
      *               26.  P13PH07Z  - (BP138D)                    *            
      *               27.  P13PH071  - (BP138E)                    *            
      *               28.  P13PH072  - (BP138F)                    *            
      *               29.  P13PH073  - (BP138G)                    *            
      *               30.  P13PH074  - (BP138H)                    *            
      *               30.  P13PH075  - (BP138I)                    *            
      *               31.  P13PH076  - (BP138J)                    *            
      *               32.  P13PH077  - (BP138K)                    *            
      *               33.  P13PH078  - (BP138L)                    *            
      *               34.  P13PH079  - (BP138M)                    *            
      *               35.  P13PH070  - (BP138N)                    *            
      *               36.  P13PH7A1  - (BP138O)                    *            
      *               37.  P13PH7A2  - (BP138P)                    *            
      *               38.  P13PH7A3  - (BP138Q)                    *            
      *               39.  P13PH7A4  - (BP138R)                    *            
      *               40.  P13PH7A5  - (BP138S)                    *            
      *               41.  P13PH7A6  - (BP138T)                    *            
      *               42.  P13PH7A7  - (BP138U)                    *            
      *               43.  P13PH7A8  - (BP138V)                    *            
      *               44.  P13PH7A9  - (BP138W)                    *            
      *               45.  P13PH7A0  - (BP138X)                    *            
      *               46.  P13PH7B1  - (BP131S)                    *            
      *               47.  P13PH7B2  - (BP131R)                    *            
      *               48.  P13PH7B3  - (BP13MD)                    *            
      *               49.  P13PH7B4  - (BP13ME)                    *            
      *                                                            *            
      *               46.  BP13LH07  -                             *            
      *     ------------------------------------------------       *            
      *     |    | ALLO-CAT | MATURE | BK    |BK(PRV)|STRIKE|      *            
      *     |----|----------|--------|-------|-------|------|      *            
      *     | I0 |  BE/BTO  | ALL    | LF    |       | 1    |      *            
      *     | I1 |  BE/BTO  | ALL    | WF    |       | ALL  |      *            
      *     | I4 |  BE/BTO  | ALL    | LF    | RQ    | 1    |      *            
      *     | I5 |  BE/BTO  | ALL    | WF    | RQ    | ALL  |      *            
      *     | IT |  BE/BTO  | ALL    | LF    |       | 2    |      *            
      *     | I9 |  BE/BTO  | ALL    | LF    | RQ    | 2    |      *            
      *     | I2 |  BTO     | N      | NF/SF |       | ALL  |      *            
      *     | I3 |  BTO     | N      | NC/SC |       | ALL  |      *            
      *     | I6 |  BTO     | N      | NF    | RQ    | ALL  |      *            
      *     | IU |  BTO     | N      | NC    | RQ    | ALL  |      *            
      *     | I7 |  BE/BTO  | Y(BTO) | NC    | RQ    | ALL  |      *            
      *     | IV |  BE/BTO  | Y(BTO) | NF    | RQ    | ALL  |      *            
      *     | IW |  BE/BTO  | Y(BTO) | NC/SC |       | ALL  | (NI) *            
      *     | IX |  BE/BTO  | Y(BTO) | NF/SF |       | ALL  | (NI) *            
      *     -------------------------------------------------      *            
      *     | 1E |  BTO     | N      | NF    |       | ALL  | NI   *            
      *     | 1C |  BE/BTO  | Y(BTO) | NF    | RQ    | ALL  | NI   *            
      *     | 1B |  BE/BTO  | Y(BTO) | NC    | RQ    | ALL  | NI   *            
      *     | 1G |  BTO     | N      | NF    | RQ    | ALL  | NI   *            
      *     | 1F |  BTO     | N      | NC    | RQ    | ALL  | NI   *            
      *     | 1J |  BTO     | N      | NV    |       | ALL  | NI   *            
      *     | 1K |  BTO     | N      | NV    | RQ    | ALL  | NI   *            
      *     | 1D |  BTO     | N      | NC    |       | ALL  | NI   *            
      *     | 8A |  BTO     | ALL    | LF    |       | 1    |      *            
      *     | 8B |  BTO     | ALL    | WF    |       | WAIVE|      *            
      *     | 8C |  BTO     | ALL    | LF    | RQ    | 1    |      *            
      *     | 8D |  BTO     | ALL    | WF    | RQ    | WAIVE|      *            
      *     | 8E |  BTO     | ALL    | LF    |       | 2    |      *            
      *     | 8F |  BTO     | ALL    | LF    | RQ    | 2    |      *            
      *     | 8G |  BTO     | ALL    | LG    |       | +1   |      *            
      *     | 8H |  BTO     | ALL    | WG    |       | WAIVE|      *            
      *     | 8I |  BTO     | ALL    | LG    | RQ    | +1   |      *            
      *     | 8J |  BTO     | ALL    | WG    | RQ    | WAIVE|      *            
      *     | 8K |  BTO     | ALL    | LG    |       | +1   |      *            
      *     | 8L |  BTO     | ALL    | LG    | RQ    | +1   |      *            
      *     | 8M |  BTO     | ALL    | LA    |       | 1    |      *            
      *     | 8N |  BTO     | ALL    | WA    |       | WAIVE|      *            
      *     | 8O |  BTO     | ALL    | LA    | RQ    | 1    |      *            
      *     | 8P |  BTO     | ALL    | WA    | RQ    | WAIVE|      *            
      *     | 8Q |  BTO     | ALL    | LA    |       | 2    |      *            
      *     | 8R |  BTO     | ALL    | LA    | RQ    | 2    |      *            
      *     | 8S |  BTO     | ALL    | LB    |       | 1    |      *            
      *     | 8T |  BTO     | ALL    | WB    |       | WAIVE|      *            
      *     | 8U |  BTO     | ALL    | LB    | RQ    | 1    |      *            
      *     | 8V |  BTO     | ALL    | WB    | RQ    | WAIVE|      *            
      *     | 8W |  BTO     | ALL    | LB    |       | 2    |      *            
      *     | 8X |  BTO     | ALL    | LB    | RQ    | 2    |      *            
      *     | MD |  BTO     | ALL    | WA/WB |       | WAIVE| <=12K*            
      *                                           AND W/WO PPO=A,B,C*           
      *     | ME |  BTO     | ALL    | WA/WB | RQ    | WAIVE| <=12K*            
      *                                           AND W/WO PPO=A,B,C*           
      *     | 8M |  BTO     | ALL    | LB    |       | 1    |      *            
      *     | 8O |  BTO     | ALL    | LB    | RQ    | 1    |      *            
      *     | 8Q |  BTO     | ALL    | LB    |       | 2    |      *            
      *     | 8R |  BTO     | ALL    | LB    | RQ    | 2    |      *            
      *     | MD |  BTO     | ALL    | WB    |       | WAIVE|      *            
      *     | ME |  BTO     | ALL    | WB    | RQ    | WAIVE|      *            
      *     -------------------------------------------------      *            
      * ---------------------------------------------------------- *            
      * CHG REF  BY    DATE    DESCRIPTION                         *            
      * -------- ---  ------   -----------                         *            
      * BP133367 JB8  20080804 NEW PROGRAM.                        *            
      * BP133367 LMS1 20090107 TO CATER FOR BE.                    *            
      * BP133367 JB8  20090311 TO PRINT NEW LETTERS.               *            
      * BP133601 JB8  20090604 TO CATER FOR ALLOC-TAG = 'RQ'       *            
      * BP133654 JB8  20090707 TO CATER FOR RQ & NOT-INVITED CASES *            
      * BP133771 IL5  20091209 CHANGES TO LETTER HEADER            *            
      * BP133810 JB8  20100114 TO CATER FOR COMBINE FLAT UNDER SBF *            
      * BP133803 JB8  20100115 TO CATER FOR 200910 CT UNDER SBF    *            
      * BP133803 JB8  20100115 NEW FORM FOR SBF/BE W 2 STICS(RQ)   *            
      * BP133771 PCL3 20100401 TO CATER CHANGES ON BP13I9 AND BP13IT            
      * BP134043 JB8  20101213 TO CATER FOR 201008 JE/JW           *            
      * BP134353 PCL3 20118029 TO HANDLE FOR FLAT TYPE IF          *            
      *                        K813-NUM-FT-PREMIUM = 'Y'           *            
      * BP134516 ESA1 20120528 TO CATER FOR CENTRAL 201203         *            
      * BP134514 ESA1 20120612 TO CATER FOR COMBINED NT            *            
      * BP134657 ESA1 20121102 TO CATER FOR 3-BYTES ZONE           *            
      * BP134714 ESA1 20121204 TO CATER FOR CT 201209 DTE-BALLOT   *            
      * BP134716 ESA1 20130123 TO ADD 1 DAY TO LETTER DATE         *            
      * BP134769 ESA1 20130201 TO POPULATE PH07-FLAT-TYPE-B FOR SBF*            
      * BP135039 IMC1 20130913 ADD 24 NEW LETTERS                  *            
      * BP135089 IMC1 20131004 FIX ISSUE WITH NON SELN COUNT       *            
      * BP135084 ESA1 20131022 CATER FOR NEW NC/NF LETTER FORMAT   *            
      * BP135089 IMC1 20131025 REMOVE CHECKING OF NON SELN CNT = WB*            
      * BP135114 ESA1 20131128 CATER FOR FTS CANCELLATION LETTER   *            
      * BP135239 IMC1 20140221 FIX 8A LETTER                       *            
      * BP135203 ESA1 20140228 TO ADD 201311 FOR S1 & S2 APARTMENT *            
      * BP135239 IMC1 20140307 ALLOW FT2T CASES TO PRINT AS 1ST TMR*            
      * BP135239 IMC1 20140320 PRT THE NRIC WITH THE HIGHEST COUNT *            
      * BP135239 IMC1 20140414 ALLOW REL TO 2ND TIMER CASES WITH   *            
      *                        1 CNT TO PRINT 8G LETTER            *            
      * BP135239 ESA1 20140417 TO CATER FOR 3GEN FLAT              *            
      * BP135281 ESA1 20140530 TO USE BTO-ZONE TO READ BP13K813    *            
      * BP135383 IMC1 20140711 CHANGE BP138I LETTER DATE           *            
      * BP135389 IMC1 20140711 CATER FOR NEW LETTER FORMAT         *            
      * BP135451 IMC1 20140815 ADD 201405 TO SBF CT CASES          *            
      * BP135474 IMC1 20140828 BYPASS GEN3 CASES OVER 300%         *            
      * BP135474 IMC1 20140911 CATER FOR 'E' FLATS AND PREM FLATS  *            
      * BP135411 ESA1 20140916 CATER FOR EXECUTIVE IN PRINTING     *            
      * BP135517 IMC1 20141124 BP138I CHANGE TO TAKE FT DATE       *            
      * BP135704 KG12 20150429 CATER FOR 'E' FLATS                 *            
      * BP135704 ESA1 20150608 REMOVE BYPASS GEN3 CASES OVER 300%  *            
      * BP136160 FNP1 20160310 CATER FOR 2F FLATS                  *            
      * BP136160 FNP1 20160314 ADD 2 LETTERS MD AND ME             *            
      * BP136122 ESA1 20160408 CATER FOR '2F' IN READING BP13K246  *            
      * BP136467 FNP1 20161004 FOR RQ CASES, GET LIMIT FROM F800 IF*            
      *                        NO RECORD IN BP13KH15               *            
      * BP136614 FNP1 20170125 FOR RQ CASES, MOVE START OF DEBAR DTE            
      *                        IF NO BOOK APPT DATE                *            
      * BP136656 FNP1 20170222 CATER FOR SAP CASES                              
      * BP138148 KR13 06102020 LETTERS FOR ELIG-SCH 'PAC'.         *            
      * BP138611 FP6  20210412 IF FLAT = '1F' --> PRINT AS 'COMMUNITY           
      *                        CARE APT'                           *            
      * BP138611 FP6  20210416 PRINT LETTER FOR 1F, SAME AS 2ROOM  *            
      * BP138781 FP6  20210521 ADD DEB-EXPIRY-FTS TO LETTER 8Q     *            
      * BP138781 FP6  20211001 MOVE DATE DEB ST/FTS BASED ON ALLOC-TAG          
      * BP138781 FP6  20211021 FIXED MOVING OF THE EXPIRY DATE FOR 8Q           
      * BP138903 FP6  20211109 HARCODE PROJECT NAME FOR NON-SELECTION           
      *                        COUNT OF 3-ROOM HG FLATS            *            
      * BP139545 FKH2 20231025 POLICY CHANGE STARTING FROM 202310  *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F800  ASSIGN        TO BP13F800.                          
           SELECT SY02F001  ASSIGN        TO SY02F001.                          
                                                                                
           SELECT BP13K060  ASSIGN        TO BP13K060                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K060-KEY-FLD                       
                            FILE STATUS   IS WS-K060-STATUS.                    
                                                                                
           SELECT BP13K246  ASSIGN        TO BP13K246                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K246-KEY-FLD                       
                            FILE STATUS   IS WS-K246-STATUS.                    
                                                                                
           SELECT BP13KH15  ASSIGN        TO BP13KH15                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KH15-KEY-FLD                       
                            ALTERNATE KEY IS KH15-ALT-KEY                       
                            FILE STATUS   IS WS-KH15-STATUS.                    
                                                                                
           SELECT BP13KH10  ASSIGN        TO BP13KH10                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KH10-KEY-FLD                       
                            FILE STATUS   IS WS-KH10-STATUS.                    
                                                                                
           SELECT BP13K813  ASSIGN        TO BP13K813                           
                            ORGANIZATION  IS INDEXED                            
                            ACCESS MODE   IS DYNAMIC                            
                            RECORD KEY    IS K813-KEY-FLD                       
                            FILE STATUS   IS WS-K813-STATUS.                    
                                                                                
           SELECT BP13K820  ASSIGN        TO BP13K820                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K820-KEY-FLD                       
                            FILE STATUS   IS WS-K820-STATUS.                    
                                                                                
           SELECT BP13K830  ASSIGN        TO BP13K830                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K830-KEY-FLD                       
                            ALTERNATE KEY IS K830-NUM-REGN                      
                            FILE STATUS   IS WS-K830-STATUS.                    
                                                                                
           SELECT BP13K022  ASSIGN        TO BP13K022                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K022-KEY-FLD                       
                            ALTERNATE KEY IS K022-NUM-REGN                      
                            FILE STATUS   IS WS-K022-STATUS.                    
                                                                                
           SELECT BP13K024  ASSIGN        TO BP13K024                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K024-KEY-FLD                       
                            FILE STATUS   IS WS-K024-STATUS.                    
                                                                                
           SELECT P13PH07A  ASSIGN        TO P13PH07A.                          
           SELECT P13PH07B  ASSIGN        TO P13PH07B.                          
           SELECT P13PH07C  ASSIGN        TO P13PH07C.                          
           SELECT P13PH07D  ASSIGN        TO P13PH07D.                          
           SELECT P13PH07E  ASSIGN        TO P13PH07E.                          
           SELECT P13PH07F  ASSIGN        TO P13PH07F.                          
           SELECT P13PH07G  ASSIGN        TO P13PH07G.                          
           SELECT P13PH07H  ASSIGN        TO P13PH07H.                          
           SELECT P13PH07I  ASSIGN        TO P13PH07I.                          
           SELECT P13PH07J  ASSIGN        TO P13PH07J.                          
           SELECT P13PH07K  ASSIGN        TO P13PH07K.                          
           SELECT P13PH07L  ASSIGN        TO P13PH07L.                          
           SELECT P13PH07M  ASSIGN        TO P13PH07M.                          
           SELECT P13PH07N  ASSIGN        TO P13PH07N.                          
           SELECT P13PH07O  ASSIGN        TO P13PH07O.                          
           SELECT P13PH07P  ASSIGN        TO P13PH07P.                          
           SELECT P13PH07Q  ASSIGN        TO P13PH07Q.                          
           SELECT P13PH07R  ASSIGN        TO P13PH07R.                          
           SELECT P13PH07S  ASSIGN        TO P13PH07S.                          
           SELECT P13PH07T  ASSIGN        TO P13PH07T.                          
           SELECT P13PH07U  ASSIGN        TO P13PH07U.                          
           SELECT P13PH07V  ASSIGN        TO P13PH07V.                          
                                                                                
           SELECT P13PH07W  ASSIGN        TO P13PH07W.                          
           SELECT P13PH07X  ASSIGN        TO P13PH07X.                          
           SELECT P13PH07Y  ASSIGN        TO P13PH07Y.                          
           SELECT P13PH07Z  ASSIGN        TO P13PH07Z.                          
           SELECT P13PH071  ASSIGN        TO P13PH071.                          
           SELECT P13PH072  ASSIGN        TO P13PH072.                          
                                                                                
           SELECT P13PH073  ASSIGN        TO P13PH073.                          
           SELECT P13PH074  ASSIGN        TO P13PH074.                          
           SELECT P13PH075  ASSIGN        TO P13PH075.                          
           SELECT P13PH076  ASSIGN        TO P13PH076.                          
           SELECT P13PH077  ASSIGN        TO P13PH077.                          
           SELECT P13PH078  ASSIGN        TO P13PH078.                          
           SELECT P13PH079  ASSIGN        TO P13PH079.                          
           SELECT P13PH070  ASSIGN        TO P13PH070.                          
           SELECT P13PH7A1  ASSIGN        TO P13PH7A1.                          
           SELECT P13PH7A2  ASSIGN        TO P13PH7A2.                          
           SELECT P13PH7A3  ASSIGN        TO P13PH7A3.                          
           SELECT P13PH7A4  ASSIGN        TO P13PH7A4.                          
                                                                                
           SELECT P13PH7A5  ASSIGN        TO P13PH7A5.                          
           SELECT P13PH7A6  ASSIGN        TO P13PH7A6.                          
           SELECT P13PH7A7  ASSIGN        TO P13PH7A7.                          
           SELECT P13PH7A8  ASSIGN        TO P13PH7A8.                          
           SELECT P13PH7A9  ASSIGN        TO P13PH7A9.                          
           SELECT P13PH7A0  ASSIGN        TO P13PH7A0.                          
           SELECT P13PH7B1  ASSIGN        TO P13PH7B1.                          
           SELECT P13PH7B2  ASSIGN        TO P13PH7B2.                          
           SELECT P13PH7B3  ASSIGN        TO P13PH7B3.                          
           SELECT P13PH7B4  ASSIGN        TO P13PH7B4.                          
                                                                                
           SELECT BP13LH07  ASSIGN        TO BP13LH07.                          
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       COPY SY02F001.                                                           
                                                                                
       FD   BP13F800                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13F800.                                                           
                                                                                
       FD  BP13K060                                                             
           RECORD CONTAINS 25  CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD  BP13K246                                                             
           RECORD CONTAINS 80  CHARACTERS.                                      
       COPY BP13K246.                                                           
                                                                                
       FD   BP13KH10                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13KH10.                                                           
                                                                                
       FD   BP13KH15                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13KH15.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD  BP13LH07                                                             
           RECORDING MODE  IS  F.                                               
       01  LH07-PRTREC                      PIC X(132).                         
                                                                                
       FD  P13PH07A                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07A-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07B                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07B-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07C                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07C-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07D                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07D-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07E                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07E-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07F                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07F-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07G                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07G-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07H                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07H-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07I                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07I-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07J                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07J-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07K                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07K-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07L                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07L-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07M                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07M-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07N                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07N-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07O                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07O-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07P                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07P-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07Q                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07Q-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07R                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07R-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07S                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07S-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07T                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07T-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07U                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07U-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07V                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07V-PRTREC                     PIC X(90).                          
                                                                                
      * FTS LETTERS                                                             
                                                                                
       FD  P13PH07W                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07W-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07X                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07X-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07Y                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07Y-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH07Z                                                             
           RECORDING MODE  IS  F.                                               
       01  PH07Z-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH071                                                             
           RECORDING MODE  IS  F.                                               
       01  PH071-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH072                                                             
           RECORDING MODE  IS  F.                                               
       01  PH072-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH073                                                             
           RECORDING MODE  IS  F.                                               
       01  PH073-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH074                                                             
           RECORDING MODE  IS  F.                                               
       01  PH074-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH075                                                             
           RECORDING MODE  IS  F.                                               
       01  PH075-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH076                                                             
           RECORDING MODE  IS  F.                                               
       01  PH076-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH077                                                             
           RECORDING MODE  IS  F.                                               
       01  PH077-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH078                                                             
           RECORDING MODE  IS  F.                                               
       01  PH078-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH079                                                             
           RECORDING MODE  IS  F.                                               
       01  PH079-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH070                                                             
           RECORDING MODE  IS  F.                                               
       01  PH070-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A1                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A1-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A2                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A2-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A3                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A3-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A4                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A4-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A5                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A5-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A6                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A6-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A7                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A7-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A8                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A8-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A9                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A9-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7A0                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7A0-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7B1                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7B1-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7B2                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7B2-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7B3                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7B3-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13PH7B4                                                             
           RECORDING MODE  IS  F.                                               
       01  PH7B4-PRTREC                     PIC X(90).                          
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       COPY AV02COMM.                                                           
                                                                                
       01  WS-STATUS.                                                           
           05  WS-KH10-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-KH15-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K060-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K813-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K820-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K022-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K024-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K246-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F800-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07A-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07B-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07C-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07D-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07E-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07F-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07G-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07H-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07I-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07J-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07K-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07L-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07M-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07N-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07O-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07P-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07Q-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07R-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07S-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07T-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07U-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07V-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07W-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07X-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07Y-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH07Z-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH071-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH072-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH073-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH074-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH075-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH076-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH077-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH078-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH079-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH070-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A1-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A2-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A3-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A4-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A5-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A6-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A7-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A8-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A9-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7A0-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7B1-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7B2-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7B3-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PH7B4-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-LH07             PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LH07             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-CUR-LINE              PIC 9(02)  VALUE 58.                
           05  WS-CTR                       PIC 9(03)  VALUE ZEROS.             
           05  WS-CNT                       PIC 9(03)  VALUE ZEROS.             
           05  WS-SKIP1                     PIC 9(06)  VALUE ZEROS.             
           05  WS-SKIP2                     PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-NOLTR                 PIC 9(06)  VALUE ZEROS.             
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-KH15-EOF                  PIC X     VALUE 'N'.                
           05  WS-KH15-FND                  PIC X     VALUE 'N'.                
           05  WS-KH10-FND                  PIC X     VALUE 'N'.                
           05  WS-F800-EOF                  PIC X     VALUE 'N'.                
           05  WS-F001-EOF                  PIC X(1)  VALUE 'N'.                
               88 EOF-F001                            VALUE 'Y'.                
           05  WS-NUM-UNIT-AVAIL            PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-QUOTA-AVAIL           PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-WITHIN-LIMIT          PIC X(01) VALUE 'N'.                
           05  WS-NUM-NRIC                  PIC X(09) VALUE ZEROES.             
           05  WS-NUM-NON-SELN              PIC 9(02) VALUE ZEROES.             
           05  WS-IDX                       PIC 9(02) VALUE ZEROES.             
           05  WS-BALLOT1                   PIC X(45) VALUE SPACES.             
           05  WS-NUM-MATURE                PIC X(1)  VALUE SPACE.              
           05  WS-ALLOC-TAG                 PIC X(2)  VALUE SPACE.              
           05  WS-ALLOC-TAG-PREV            PIC X(2)  VALUE SPACE.              
           05  WS-NUM-STRIKE-FT             PIC 9(2)  VALUE ZEROES.             
           05  WS-NUM-STRIKE-ST             PIC 9(2)  VALUE ZEROES.             
           05  WS-NUM-STRIKE-FTS            PIC 9(2)  VALUE ZEROES.             
           05  WS-K820-NME-OCCP             PIC X(66) VALUE SPACE.              
           05  WS-NI-TAG                    PIC X(01) VALUE 'N'.                
           05  WS-CDE-HH                    PIC X(01) VALUE SPACE.              
           05  WS-CDE-BHH                   PIC X(01) VALUE SPACE.              
           05  WS-NUM-ALLO-SCH              PIC X(03) VALUE SPACE.              
           05  WS-NUM-ELIG-SCHEME           PIC X(03) VALUE SPACE.              
           05  WS-DTE-DEBAR-FT-HH           PIC X(10) VALUE SPACE.              
           05  WS-DTE-DEBAR-EXP-FT-HH       PIC X(10) VALUE SPACE.              
           05  WS-DTE-DEBAR-FT-HG           PIC X(10) VALUE SPACE.              
           05  WS-DTE-DEBAR-EXP-FT-HG       PIC X(10) VALUE SPACE.              
           05  WS-DTE-DEBAR-ST              PIC X(10) VALUE SPACE.              
           05  WS-DTE-DEBAR-EXP-ST          PIC X(10) VALUE SPACE.              
           05  WS-DTE-DEBAR-FTS             PIC X(10) VALUE SPACE.              
           05  WS-DTE-DEBAR-EXP-FTS         PIC X(10) VALUE SPACE.              
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-NUM-DATE                  PIC 9(7)  VALUE ZEROES.             
                                                                                
       01  WS-DATE-VALID                    PIC X(01) VALUE SPACE.              
           88  DATE-VALID                   VALUE 'Y'.                          
                                                                                
       01  WS-PARSING.                                                          
           05 WS-STRING-TO-PARSE            PIC X(70).                          
           05 WS-PARSED-STRING              PIC X(70).                          
           05 WS-STRING-LENGTH              PIC 9(03).                          
           05 WS-CUR-POS-SP                 PIC 9(03).                          
           05 WS-CUR-POS-PS                 PIC 9(03).                          
           05 WS-SPACE-FLAG                 PIC X    VALUE 'N'.                 
           05 WS-INSERT-SPACE-FLAG          PIC X    VALUE 'N'.                 
                                                                                
       01  WS-ALLOCSCH-TYPE               PIC X(3)    VALUE SPACES.             
       COPY PRIOSCH.                                                            
                                                                                
      *===============================                                          
      *   LINKAGE SECTION FOR AV02C015                                          
      *===============================                                          
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER TO APPLICANT                     *            
      *------------------------------------------------------------*            
       01  PH07-LINE01.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  PH07-NUM-REGN            PIC X(08) VALUE SPACES.                 
           05  FILLER                   PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE02.                                                         
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  FILLER                   PIC X(71) VALUE SPACES.                 
           05  PH07-DATE                PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE03.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PH07-NAME                PIC X(66) VALUE SPACES.                 
                                                                                
       01  PH07-LINE04.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PH07-NAME2               PIC X(66) VALUE SPACES.                 
                                                                                
       01  PH07-LINE05.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PH07-BLK                 PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  PH07-UNIT                PIC X(11) VALUE SPACES.                 
                                                                                
       01  PH07-LINE06.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PH07-ADDR-L2             PIC X(47) VALUE SPACES.                 
                                                                                
       01  PH07-LINE07.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PH07-ADDR-L3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  PH07-LINE08.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PH07-BAR-CODE            PIC X(09) VALUE SPACES.                 
                                                                                
       01  PH07-LINE09A.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(70) VALUE                         
                                        'APPLICATION TO BUY A FLAT'.            
       01  PH07-LINE09.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(10) VALUE 'UNDER THE '.           
           05  PH07-BALLOT1             PIC X(50) VALUE SPACES.                 
                                                                                
       01  PH07-LINE09B.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(16) VALUE                         
                                        'APPLICATION FOR '.                     
           05  PH07-BALLOT2             PIC X(50) VALUE SPACES.                 
                                                                                
       01  PH07-LINE10.                                                         
           05  FILLER                   PIC X(44) VALUE SPACES.                 
           05  PH07-FLAT-TYPE           PIC X(20) VALUE SPACES.                 
                                                                                
       01  PH07-LINE10A.                                                        
           05  FILLER                   PIC X(61) VALUE SPACES.                 
           05  PH07-FLAT-TYPE-A         PIC X(20) VALUE SPACES.                 
                                                                                
       01  PH07-LINE10B.                                                        
           05  FILLER                   PIC X(66) VALUE SPACES.                 
           05  PH07-FLAT-TYPE-B         PIC X(20) VALUE SPACES.                 
                                                                                
       01  PH07-LINE10C.                                                        
           05  FILLER                   PIC X(62) VALUE SPACES.                 
           05  PH07-FLAT-TYPE-C         PIC X(20) VALUE SPACES.                 
                                                                                
       01  PH07-LINE10F.                                                        
           05  FILLER                   PIC X(68) VALUE SPACES.                 
           05  PH07-FLAT-TYPE-F         PIC X(20) VALUE SPACES.                 
                                                                                
      * CANCEL LETTERS                                                          
       01  PH07-LINE10D.                                                        
           05  FILLER                   PIC X(62) VALUE SPACES.                 
           05  PH07-FLAT-TYPE-D         PIC X(20) VALUE SPACES.                 
                                                                                
       01  PH07-LINE10E.                                                        
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  PH07-FLAT-TYPE-E         PIC X(20) VALUE SPACES.                 
                                                                                
       01  PH07-LINE11.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  PH07-NME-PRJCT           PIC X(30) VALUE SPACES.                 
                                                                                
       01  PH07-LINE11C.                                                        
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  PH07-NME-PRJCT-11C       PIC X(30) VALUE SPACES.                 
                                                                                
       01  PH07-LINE12.                                                         
           05  FILLER                   PIC X(43) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT         PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE12C.                                                        
           05  FILLER                   PIC X(49) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-12C     PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE12D.                                                        
           05  FILLER                   PIC X(82) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-12D     PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE12E.                                                        
           05  FILLER                   PIC X(53) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-12E     PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE13.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PH07-NME-CSM             PIC X(30) VALUE SPACES.                 
                                                                                
       01  PH07-LINE14.                                                         
           05  FILLER                   PIC X(58) VALUE SPACES.                 
           05  PH07-DTE-DEBAR           PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE SPACES.                 
           05  PH07-DTE-DEBAR-EXP       PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE15.                                                         
           05  FILLER                   PIC X(29) VALUE SPACES.                 
           05  PH07-NUM-QUEUE           PIC X(05) VALUE SPACES.                 
                                                                                
       01  PH07-LINE15C.                                                        
           05  FILLER                   PIC X(25) VALUE SPACES.                 
           05  PH07-NUM-QUEUE-C         PIC X(05) VALUE SPACES.                 
                                                                                
       01  PH07-LINE16.                                                         
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  PH07-DTE-DEBAR-16        PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE17.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-17      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE18.                                                         
           05  FILLER                   PIC X(68) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-18      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE19.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-19      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE20.                                                         
           05  FILLER                   PIC X(71) VALUE SPACES.                 
           05  PH07-DTE-DEBAR-EXP-ST    PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE21.                                                         
           05  FILLER                   PIC X(71) VALUE SPACES.                 
           05  PH07-DTE-DEBAR-EXP-FTS   PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE22.                                                         
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  PH07-DTE-DEBAR-EXP-FT-HH PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE23.                                                         
           05  FILLER                   PIC X(31) VALUE SPACES.                 
           05  PH07-DTE-DEBAR-EXP-FT-HG PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE24.                                                         
           05  FILLER                   PIC X(71) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-24      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE25.                                                         
           05  FILLER                   PIC X(49) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-25      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE26.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-26      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE27.                                                         
           05  FILLER                   PIC X(40) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-27      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE28.                                                         
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  PH07-DTE-BK-APPT-28      PIC X(10) VALUE SPACES.                 
                                                                                
       01  PH07-LINE29.                                                         
           05  FILLER                   PIC X(38) VALUE SPACES.                 
           05  PH07-DTE-DEBAR-29        PIC X(10) VALUE SPACES.                 
                                                                                
                                                                                
       01  PH07-BLK-LINE.                                                       
           05  FILLER                   PIC X(90) VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  LH07-HDG1.                                                           
           05  LH07-LISTING             PIC X(14) VALUE 'BP13LH07'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  LH07-DATE                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  LH07-PAGE                PIC ZZZZ9.                              
                                                                                
       01  LH07-HDG2.                                                           
           05  FILLER                   PIC X(41) VALUE SPACES.                 
           05  FILLER                   PIC X(37) VALUE                         
               'CONTROL LIST FOR NON-SELECTION LETTER'.                         
                                                                                
       01  LH07-HDG3.                                                           
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(48) VALUE                         
               'S/N REGN      HDB_REF     ALLO ZONE  NT  FT  CAT'.              
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(46) VALUE                         
               'HH/B-HH DTE_BK    QUEUE  MOD MATURE TAG  TAG-P'.                
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(24) VALUE                         
               'NRCI1      NRIC2      NO'.                                      
                                                                                
       01  LH07-DTL.                                                            
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-SN                  PIC ZZZZ9 VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LH07-REGN                PIC X(8)  VALUE SPACES.                 
           05  LH07-OVERSEA             PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LH07-HDB-REF             PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-ALLO-SCH            PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-ZONE                PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-NT                  PIC X(03) VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-FT                  PIC X(02) VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-CAT                 PIC X(03) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LH07-HH                  PIC X(01) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE '/'.                    
           05  LH07-BALLOT-HH           PIC X(01) VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LH07-DTE-BK              PIC X(08) VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-QUEUE               PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-ALLO-CAT            PIC X(03) VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LH07-NUM-MATURE          PIC X(01) VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LH07-ALLOC-TAG           PIC X(02) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LH07-ALLOC-TAG-PREV      PIC X(02) VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LH07-NRIC1               PIC X(09) VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-NRIC2               PIC X(09) VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  LH07-LTR-TYPE            PIC X(02) VALUE SPACES.                 
                                                                                
       01  LH07-FOOTER.                                                         
           05  FILLER                   PIC X(90) VALUE                         
               '  "*" CASES WITH OVERSEA ADDRESS.'.                             
                                                                                
      *=============================================================            
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-FILES             THRU 1000-EXIT.                  
           PERFORM 3000-PROCESS-RECORDS        THRU 3000-EXIT                   
                   UNTIL WS-F800-EOF = 'Y'.                                     
           PERFORM 8200-WRITE-FOOTER           THRU 8200-EXIT.                  
           PERFORM 9000-CLOSE-ROUTINE          THRU 9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1000-OPEN-FILES.                                                         
      *=============================================================            
           OPEN INPUT BP13F800                                                  
                      SY02F001                                                  
                      BP13KH10                                                  
                      BP13KH15                                                  
                      BP13K060                                                  
                      BP13K813                                                  
                      BP13K820                                                  
                      BP13K830                                                  
                      BP13K022                                                  
                      BP13K024                                                  
                      BP13K246                                                  
               OUTPUT P13PH07A                                                  
                      P13PH07B                                                  
                      P13PH07C                                                  
                      P13PH07D                                                  
                      P13PH07E                                                  
                      P13PH07F                                                  
                      P13PH07G                                                  
                      P13PH07H                                                  
                      P13PH07I                                                  
                      P13PH07J                                                  
                      P13PH07K                                                  
                      P13PH07L                                                  
                      P13PH07M                                                  
                      P13PH07N                                                  
                      P13PH07O                                                  
                      P13PH07P                                                  
                      P13PH07Q                                                  
                      P13PH07R                                                  
                      P13PH07S                                                  
                      P13PH07T                                                  
                      P13PH07U                                                  
                      P13PH07V                                                  
                      P13PH07W                                                  
                      P13PH07X                                                  
                      P13PH07Y                                                  
                      P13PH07Z                                                  
                      P13PH071                                                  
                      P13PH072                                                  
                      P13PH073                                                  
                      P13PH074                                                  
                      P13PH075                                                  
                      P13PH076                                                  
                      P13PH077                                                  
                      P13PH078                                                  
                      P13PH079                                                  
                      P13PH070                                                  
                      P13PH7A1                                                  
                      P13PH7A2                                                  
                      P13PH7A3                                                  
                      P13PH7A4                                                  
                      P13PH7A5                                                  
                      P13PH7A6                                                  
                      P13PH7A7                                                  
                      P13PH7A8                                                  
                      P13PH7A9                                                  
                      P13PH7A0                                                  
                      P13PH7B1                                                  
                      P13PH7B2                                                  
                      P13PH7B3                                                  
                      P13PH7B4                                                  
                      BP13LH07.                                                 
                                                                                
           CALL 'OAV02001' USING LINK-REC.                                      
                                                                                
           IF WS-K060-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K060 STATUS ' WS-K060-STATUS               
              MOVE     WS-K060-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K246-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K246 STATUS ' WS-K246-STATUS               
              MOVE     WS-K246-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-KH10-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR KH10 STATUS ' WS-KH10-STATUS               
              MOVE     WS-KH10-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-KH15-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR KH15 STATUS ' WS-KH15-STATUS               
              MOVE     WS-KH15-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K820 STATUS ' WS-K820-STATUS               
              MOVE     WS-K820-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K813 STATUS ' WS-K813-STATUS               
              MOVE     WS-K813-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K830 STATUS ' WS-K830-STATUS               
              MOVE     WS-K830-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K022 STATUS ' WS-K022-STATUS               
              MOVE     WS-K022-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           READ SY02F001 AT END MOVE 'Y'  TO WS-F001-EOF.                       
           IF EOF-F001                                                          
              DISPLAY 'RECORD NOT FOUND IN SY01F001 '                           
              DISPLAY 'PROCESSING TERMINATED '                                  
              GO TO 9000-CLOSE-ROUTINE                                          
           ELSE                                                                 
              MOVE F001-DTE-CURRENT      TO   WS-CURR-DATE                      
           END-IF.                                                              
           COMPUTE WS-NUM-DATE =                                                
                   FUNCTION INTEGER-OF-DATE(WS-CURR-DATE)                       
           ADD 1                         TO   WS-NUM-DATE.                      
           COMPUTE WS-CURR-DATE =                                               
                   FUNCTION DATE-OF-INTEGER(WS-NUM-DATE).                       
                                                                                
           MOVE 'N'                      TO WS-DATE-VALID.                      
                                                                                
           PERFORM UNTIL DATE-VALID                                             
              COMPUTE WS-CURR-DATE =                                            
                      FUNCTION DATE-OF-INTEGER(WS-NUM-DATE)                     
              PERFORM 8300-CHECK-WEEKDAY      THRU 8300-EXIT                    
              IF WS-RETURN = 'SAT' OR 'SUN'                                     
                 COMPUTE WS-NUM-DATE = WS-NUM-DATE + 1                          
              ELSE                                                              
                 PERFORM 8400-CHECK-HOLIDAY   THRU 8400-EXIT                    
                 IF WS-RETURN = 'HOL'                                           
                    COMPUTE WS-NUM-DATE = WS-NUM-DATE + 1                       
                 ELSE                                                           
                    MOVE 'Y'                    TO WS-DATE-VALID                
                 END-IF                                                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           STRING WS-CURR-DATE(7:2) '/'                                         
                  WS-CURR-DATE(5:2) '/'                                         
                  WS-CURR-DATE(1:4) DELIMITED BY SIZE                           
                  INTO PH07-DATE.                                               
                                                                                
           STRING F001-DTE-CURRENT(7:2) '/'                                     
                  F001-DTE-CURRENT(5:2) '/'                                     
                  F001-DTE-CURRENT(1:4) DELIMITED BY SIZE                       
                  INTO LH07-DATE.                                               
                                                                                
           PERFORM 2000-READ-BP13F800  THRU 2000-EXIT.                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       2000-READ-BP13F800.                                                      
      *=============================================================            
                                                                                
            READ BP13F800 AT END                                                
                 MOVE 'Y'  TO  WS-F800-EOF                                      
                 GO TO 2000-EXIT.                                               
                                                                                
      **********************************                                        
      * COMMENT OUT TO CATER FOR SBF 3P*                                        
      **********************************                                        
      *     IF F800-NUM-ROOM-TYPE = 'P'                                         
      *        MOVE SPACES                        TO F800-NUM-ROOM-TYPE         
      *     END-IF.                                                             
                                                                                
            ADD  1  TO WS-F800-READ-CTR.                                        
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       3000-PROCESS-RECORDS.                                                    
      *=============================================================            
                                                                                
           IF (F800-NUM-ALLO-CAT NOT = 'BTO' AND 'BE' AND 'SBF') OR             
              (F800-NUM-ALLOC-TAG NOT = 'FN' AND 'SI' AND 'NI' AND              
                                        'NF' AND 'NC' AND 'NV' AND              
                                        'SF' AND 'SC' AND 'LF' AND              
                                        'RQ' AND 'WF' AND 'LG' AND              
                                        'WG' AND 'LA' AND 'WA' AND              
                                        'LB' AND 'WB')                          
              ADD 1                           TO WS-SKIP1                       
              PERFORM 2000-READ-BP13F800    THRU 2000-EXIT                      
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
                                                                                
           MOVE F800-NUM-HOUSEHOLD            TO WS-CDE-HH                      
           MOVE F800-CDE-BALLOT-HOUSEHOLD     TO WS-CDE-BHH.                    
                                                                                
      * TREAT RELEGATED TO 2ND TIMER AS 1ST TIMERS                              
           IF WS-CDE-HH = 'G' AND WS-CDE-BHH = 'F' AND                          
              F800-NUM-FT2T = 'Y'                                               
              MOVE 'H'           TO WS-CDE-HH                                   
                                    WS-CDE-BHH                                  
           END-IF                                                               
                                                                                
           IF WS-CDE-HH = 'G' AND WS-CDE-BHH = 'G' AND                          
              F800-NUM-FT2T = 'Y'                                               
              MOVE 'H'           TO WS-CDE-HH                                   
              MOVE 'G'           TO WS-CDE-BHH                                  
           END-IF.                                                              
                                                                                
           IF WS-CDE-BHH = 'N' OR F800-NUM-NTIMER = 'Y'                         
              MOVE 'G'           TO WS-CDE-BHH                                  
           END-IF.                                                              
                                                                                
           MOVE F800-NUM-ALLO-SCHEME          TO WS-NUM-ALLO-SCH                
           MOVE F800-NUM-ELIG-SCHEME          TO WS-NUM-ELIG-SCHEME             
           MOVE F800-NUM-HOUSEHOLD            TO LH07-HH                        
           MOVE F800-CDE-BALLOT-HOUSEHOLD     TO LH07-BALLOT-HH.                
                                                                                
           INITIALIZE      PH07-LINE01 PH07-LINE03                              
                           PH07-LINE04 PH07-LINE05 PH07-LINE06                  
                           PH07-LINE07 PH07-LINE08 PH07-LINE09                  
                           PH07-LINE10 PH07-LINE11 PH07-LINE12                  
                           PH07-LINE13 PH07-LINE14 PH07-LINE15                  
                           PH07-LINE10A PH07-LINE10B PH07-LINE10F               
                           PH07-LINE10C PH07-LINE12C                            
                           PH07-LINE16  PH07-LINE17  PH07-LINE18                
                           PH07-LINE19  PH07-LINE10E PH07-LINE11C               
                           PH07-LINE12E PH07-LINE20  PH07-LINE21                
                           PH07-LINE22  PH07-LINE23  PH07-LINE24                
                           PH07-LINE25  PH07-LINE26  PH07-LINE27                
                           PH07-LINE28  PH07-LINE29.                            
                                                                                
           PERFORM 4000-GET-ALLO-SCH   THRU 4000-EXIT.                          
           IF WS-ALLOCSCH-TYPE = 'CCC'                                          
              PERFORM 2000-READ-BP13F800  THRU 2000-EXIT                        
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE F800-NUM-REGN              TO PH07-NUM-REGN                     
           MOVE 'N'                        TO WS-NI-TAG                         
           IF F800-DTE-BK-APPT NOT NUMERIC                                      
              IF F800-DTE-BK-APPT = 'NOINVITE'                                  
                 MOVE 'Y'                  TO WS-NI-TAG                         
              END-IF                                                            
           ELSE                                                                 
              IF F800-DTE-BK-APPT NOT = SPACES AND LOW-VALUE                    
                 STRING F800-DTE-BK-APPT(7:2) '/'                               
                        F800-DTE-BK-APPT(5:2) '/'                               
                        F800-DTE-BK-APPT(1:4)                                   
                    DELIMITED BY SIZE INTO PH07-DTE-BK-APPT                     
                 END-STRING                                                     
              ELSE                                                              
                 MOVE SPACES               TO PH07-DTE-BK-APPT                  
              END-IF                                                            
           END-IF.                                                              
           MOVE PH07-DTE-BK-APPT           TO PH07-DTE-BK-APPT-12C              
                                              PH07-DTE-BK-APPT-12D              
                                              PH07-DTE-BK-APPT-12E              
                                              PH07-DTE-BK-APPT-17               
                                              PH07-DTE-BK-APPT-18               
                                              PH07-DTE-BK-APPT-19               
                                              PH07-DTE-BK-APPT-24               
                                              PH07-DTE-BK-APPT-25               
                                              PH07-DTE-BK-APPT-26               
                                              PH07-DTE-BK-APPT-27               
                                              PH07-DTE-BK-APPT-28               
           MOVE F800-NUM-NT-FT-QUEUE       TO PH07-NUM-QUEUE                    
                                              PH07-NUM-QUEUE-C.                 
                                                                                
           MOVE F800-NUM-REGN               TO K820-NUM-REGN                    
           MOVE F800-NUM-NRIC1              TO K820-NUM-NRIC                    
           PERFORM 4600-READ-K820         THRU 4600-EXIT                        
           MOVE WS-K820-NME-OCCP            TO PH07-NAME.                       
                                                                                
           IF F800-NUM-NRIC2  = SPACES OR LOW-VALUES                            
              MOVE SPACES                   TO PH07-NAME2                       
           ELSE                                                                 
              MOVE F800-NUM-NRIC2           TO K820-NUM-NRIC                    
              PERFORM 4600-READ-K820      THRU 4600-EXIT                        
              MOVE WS-K820-NME-OCCP         TO PH07-NAME2.                      
                                                                                
           PERFORM 4800-GET-ADDR          THRU 4800-EXIT.                       
           PERFORM 5000-GET-NME-CSM       THRU 5000-EXIT.                       
                                                                                
           IF F800-NUM-NEW-TOWN = 'HG' AND                                      
              F800-DTE-BALLOT = '202108' AND                                    
              F800-AMT-HSE-INCOME > 7000 AND                                    
              F800-NUM-FLAT-TYPE = '3 '                                         
              MOVE 'KOVAN WELLSPRING'  TO PH07-NME-PRJCT                        
                                          PH07-NME-PRJCT-11C                    
           ELSE                                                                 
              IF F800-NUM-ALLO-CAT = 'BTO'                                      
                 PERFORM 6000-GET-NME-PRJCT  THRU 6000-EXIT                     
                 DISPLAY 'PH07-FLAT-TYPE: ' PH07-FLAT-TYPE                      
                         ' PH07-NME-PRJCT: ' PH07-NME-PRJCT                     
              ELSE                                                              
                 IF F800-NUM-ALLO-CAT = 'BE ' OR 'SBF'                          
                    MOVE 'Y'                      TO WS-NUM-MATURE              
                    PERFORM 6100-GET-NME-TOWN   THRU 6100-EXIT                  
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 6300-DECODE-BALLOT     THRU 6300-EXIT.                       
           PERFORM 6650-INITIALIZE-DEBAR  THRU 6650-EXIT.                       
                                                                                
           MOVE F800-NUM-NRIC1            TO WS-NUM-NRIC                        
           PERFORM 6700-READ-BP13KH10     THRU 6700-EXIT.                       
                                                                                
           IF F800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC2            TO WS-NUM-NRIC                     
              PERFORM 6700-READ-BP13KH10     THRU 6700-EXIT                     
           END-IF                                                               
                                                                                
           IF F800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC3            TO WS-NUM-NRIC                     
              PERFORM 6700-READ-BP13KH10     THRU 6700-EXIT                     
           END-IF                                                               
                                                                                
           IF F800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC4            TO WS-NUM-NRIC                     
              PERFORM 6700-READ-BP13KH10     THRU 6700-EXIT                     
           END-IF                                                               
                                                                                
           PERFORM 6800-GET-BOOK-STATUS   THRU 6800-EXIT.                       
                                                                                
           PERFORM 7000-PRT-LETTER        THRU 7000-EXIT.                       
           PERFORM 8000-PRN-CNTRL-LIST    THRU 8000-EXIT.                       
                                                                                
           PERFORM 2000-READ-BP13F800     THRU 2000-EXIT.                       
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4000-GET-ALLO-SCH.                                                       
      *=============================================================            
                                                                                
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
              AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                             
              WHEN F800-NUM-ALLO-SCHEME =                                       
                                WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)                 
              MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO                              
                                      WS-ALLOCSCH-TYPE.                         
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4600-READ-K820.                                                          
      *=============================================================            
           MOVE    SPACES                TO  WS-K820-NME-OCCP                   
           READ BP13K820.                                                       
                                                                                
           IF WS-K820-STATUS = 00 OR 02                                         
              MOVE    K820-NME-OCCP      TO  WS-K820-NME-OCCP                   
           ELSE                                                                 
           IF WS-K820-STATUS = 23                                               
              DISPLAY 'K820 REC NOT FOUND : '   K820-KEY-FLD                    
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K820 = '   WS-K820-STATUS              
                      ', K820-KEY-FLD = '   K820-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4800-GET-ADDR.                                                           
      *=============================================================            
                                                                                
           INITIALIZE     PH07-LINE05                                           
                          PH07-LINE06                                           
                          PH07-LINE07                                           
                          PH07-LINE08.                                          
           MOVE SPACES                     TO LH07-OVERSEA.                     
                                                                                
           MOVE F800-NUM-REGN TO K830-NUM-REGN                                  
           READ BP13K830  KEY IS K830-NUM-REGN.                                 
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                
                 ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                           
                 (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))               
                 MOVE K830-NUM-BLK         TO PH07-BLK                          
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO PH07-UNIT                         
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO PH07-UNIT                         
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO PH07-ADDR-L2                
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE '*'               TO LH07-OVERSEA                      
                    MOVE SPACES            TO PH07-ADDR-L3                      
                    DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL               
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO PH07-ADDR-L3                      
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4850-CALL-AV02C015     THRU 4850-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO PH07-BAR-CODE             
                                                                                
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK        TO PH07-BLK                      
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                TO PH07-UNIT                     
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT    TO PH07-UNIT                     
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO PH07-ADDR-L2              
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO PH07-ADDR-L3                  
                    MOVE '*'                   TO LH07-OVERSEA                  
                    DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL              
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO PH07-ADDR-L3                  
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4850-CALL-AV02C015     THRU 4850-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO PH07-BAR-CODE             
              END-IF                                                            
                                                                                
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              INITIALIZE     PH07-LINE05                                        
                             PH07-LINE06                                        
                             PH07-LINE07                                        
                             PH07-LINE08                                        
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-NUM-REGN                       
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-NUM-REGN                       
      *       PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4850-CALL-AV02C015.                                                      
      *=============================================================            
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       4850-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================*           
       5000-GET-NME-CSM.                                                        
      *=============================================================*           
                                                                                
           MOVE SPACES                        TO PH07-NME-CSM.                  
           MOVE F800-NUM-REGN                 TO K022-NUM-REGN.                 
                                                                                
           PERFORM 5200-READ-BP13K022       THRU 5200-EXIT.                     
                                                                                
           IF WS-K022-STATUS  =  00                                             
              MOVE K022-NUM-OIC               TO K024-NUM-OIC                   
              PERFORM 5400-READ-BP13K024    THRU 5400-EXIT                      
                                                                                
              IF WS-K024-STATUS  =  00                                          
                 MOVE K024-NME-OIC            TO PH07-NME-CSM                   
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------*           
       5200-READ-BP13K022.                                                      
      *-------------------------------------------------------------*           
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K022-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                CONTINUE                                                        
             WHEN 23                                                            
                DISPLAY 'REC NOT FOUND IN BP13K022'                             
                      ', K022-NUM-REGN: ' K022-NUM-REGN                         
             WHEN OTHER                                                         
                DISPLAY 'BP13K022 READ ERROR,STATUS : ' WS-K022-STATUS          
                      ', K022-NUM-REGN: ' K022-NUM-REGN                         
                MOVE WS-K022-STATUS   TO RETURN-CODE                            
                PERFORM 9000-CLOSE-ROUTINE                                      
           END-EVALUATE.                                                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------*           
       5400-READ-BP13K024.                                                      
      *-------------------------------------------------------------*           
           READ BP13K024.                                                       
                                                                                
           EVALUATE WS-K024-STATUS                                              
             WHEN 00                                                            
                CONTINUE                                                        
             WHEN 23                                                            
                DISPLAY 'REC NOT FOUND IN BP13K024'                             
                      ', K024-NUM-OIC: ' K024-NUM-OIC                           
             WHEN OTHER                                                         
                DISPLAY 'BP13K024 READ ERROR,STATUS : ' WS-K024-STATUS          
                      ', K024-NUM-OIC: ' K024-NUM-OIC                           
                MOVE WS-K024-STATUS   TO RETURN-CODE                            
                PERFORM 9000-CLOSE-ROUTINE                                      
           END-EVALUATE.                                                        
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------*           
       6000-GET-NME-PRJCT.                                                      
      *-------------------------------------------------------------*           
           MOVE SPACES                    TO BP13K813-REC.                      
           MOVE F800-NUM-BTO-ZONE         TO K813-NUM-ZONE.                     
           MOVE F800-NUM-FLAT-TYPE        TO K813-NUM-FLAT-TYPE.                
           MOVE 'N'                       TO WS-NUM-MATURE.                     
                                                                                
           PERFORM 6050-START-BP13K813 THRU 6050-EXIT.                          
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6050-START-BP13K813.                                                     
      *===============================================================*         
                                                                                
           START BP13K813 KEY >= K813-KEY-FLD                                   
                                                                                
           EVALUATE WS-K813-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                PERFORM 6060-READNEXT-BP13K813 THRU 6060-EXIT                   
             WHEN 23                                                            
                DISPLAY 'REC NOT FOUND IN BP13K813'                             
                      ', K813-KEY-FLD ' K813-KEY-FLD                            
             WHEN OTHER                                                         
                DISPLAY 'BP13K813 READ ERROR,STATUS : ' WS-K813-STATUS          
                      ', K813-KEY-FLD: ' K813-KEY-FLD                           
                MOVE WS-K813-STATUS   TO RETURN-CODE                            
                PERFORM 9000-CLOSE-ROUTINE                                      
           END-EVALUATE.                                                        
                                                                                
       6050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6060-READNEXT-BP13K813.                                                  
      *===============================================================*         
                                                                                
           READ BP13K813 NEXT RECORD.                                           
                                                                                
           EVALUATE WS-K813-STATUS                                              
             WHEN 00                                                            
                IF K813-NUM-ZONE      = F800-NUM-BTO-ZONE AND                   
                   K813-NUM-FLAT-TYPE = F800-NUM-FLAT-TYPE                      
                                                                                
                  MOVE K813-NME-SITE           TO PH07-NME-PRJCT                
                                                  PH07-NME-PRJCT-11C            
                  IF K813-NUM-MATURE-EST-TAG = 'Y'                              
                     MOVE 'Y'                  TO WS-NUM-MATURE                 
                  END-IF                                                        
                                                                                
                  IF K813-NUM-FLAT-TYPE = '1A'                                  
                     MOVE 'STUDIO APARTMENT'   TO PH07-FLAT-TYPE                
                  ELSE                                                          
                     IF K813-NUM-FLAT-TYPE = '3P'                               
                        STRING '3-ROOM PREMIUM FLAT'                            
                             DELIMITED BY SIZE INTO PH07-FLAT-TYPE              
                     ELSE                                                       
                        IF K813-NUM-FLAT-TYPE = '2F'                            
                           MOVE '2-ROOM FLEXI FLAT' TO PH07-FLAT-TYPE           
                        ELSE                                                    
                           IF K813-NUM-FLAT-TYPE = '1F'                         
                              MOVE 'COMMUNITY CARE APT' TO                      
                                                       PH07-FLAT-TYPE           
                           ELSE                                                 
                              STRING K813-NUM-FLAT-TYPE(1:1)                    
                                     '-ROOM FLAT'                               
                              DELIMITED BY SIZE INTO PH07-FLAT-TYPE             
                           END-IF                                               
                        END-IF                                                  
                     END-IF                                                     
                  END-IF                                                        
                  IF K813-NUM-GEN3-TAG  = 'Y'                                   
                     MOVE '5-ROOM/3GEN FLAT'  TO PH07-FLAT-TYPE                 
                  END-IF                                                        
                  MOVE PH07-FLAT-TYPE          TO PH07-FLAT-TYPE-A              
                                                  PH07-FLAT-TYPE-B              
                                                  PH07-FLAT-TYPE-C              
                                                  PH07-FLAT-TYPE-E              
                                                  PH07-FLAT-TYPE-F              
                END-IF                                                          
             WHEN 23                                                            
                DISPLAY 'REC NOT FOUND IN BP13K813'                             
                      ', K813-KEY-FLD ' K813-KEY-FLD                            
             WHEN OTHER                                                         
                DISPLAY 'BP13K813 READ ERROR,STATUS : ' WS-K813-STATUS          
                      ', K813-KEY-FLD: ' K813-KEY-FLD                           
                MOVE WS-K813-STATUS   TO RETURN-CODE                            
                PERFORM 9000-CLOSE-ROUTINE                                      
           END-EVALUATE.                                                        
                                                                                
       6060-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------*           
       6100-GET-NME-TOWN.                                                       
      *-------------------------------------------------------------*           
                                                                                
           MOVE SPACES                TO K060-KEY-FLD.                          
           MOVE 02                    TO K060-SERIAL-NO.                        
           MOVE F800-NUM-NEW-TOWN     TO K060-CODE.                             
           PERFORM 6600-READ-BP13K060 THRU 6600-EXIT                            
           IF WS-K060-STATUS = 00                                               
              IF F800-NUM-NEW-TOWN = 'CT' AND                                   
                 (F800-DTE-BALLOT  = '200809' OR '200910')                      
                 MOVE 'THE PINNACLE@DUXTON' TO PH07-NME-PRJCT                   
                                               PH07-NME-PRJCT-11C               
              ELSE                                                              
                 IF (F800-NUM-NEW-TOWN = 'JE' OR 'JW') AND                      
                    (F800-DTE-BALLOT = '201008') AND                            
                    (F800-NUM-ALLO-CAT = 'SBF')                                 
                    MOVE 'JURONG EAST/WEST' TO PH07-NME-PRJCT                   
                                               PH07-NME-PRJCT-11C               
                 ELSE                                                           
                    MOVE K060-DESC(1:20)    TO PH07-NME-PRJCT                   
                                               PH07-NME-PRJCT-11C               
                 END-IF                                                         
              END-IF                                                            
                                                                                
                                                                                
              IF F800-NUM-NEW-TOWN = 'CT'                                       
                 IF F800-DTE-BALLOT  = '200809' OR '200910' OR                  
                                       '201311' OR '201405'                     
                    IF F800-NUM-FLAT-TYPE = '4 '                                
                       MOVE 'S1 APARTMENT' TO PH07-FLAT-TYPE                    
                    ELSE                                                        
                       IF F800-NUM-FLAT-TYPE = '5 '                             
                          MOVE 'S2 APARTMENT' TO PH07-FLAT-TYPE                 
                       END-IF                                                   
                    END-IF                                                      
                 ELSE                                                           
                    IF F800-DTE-BALLOT = '201209'                               
                       IF F800-NUM-FLAT-TYPE = '4 '                             
                          MOVE '3-ROOM/S1 APT' TO PH07-FLAT-TYPE                
                       ELSE                                                     
                          IF F800-NUM-FLAT-TYPE = '5 '                          
                             MOVE 'S2 APARTMENT' TO PH07-FLAT-TYPE              
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF F800-NUM-ALLO-CAT = 'SBF'                                   
                    PERFORM 6200-GET-SBF-FLAT-TYPE THRU 6200-EXIT               
                 ELSE                                                           
                     IF F800-NUM-FLAT-TYPE = '3P'                               
                        STRING '3-ROOM PREMIUM FLAT'                            
                             DELIMITED BY SIZE INTO PH07-FLAT-TYPE              
                     ELSE                                                       
                        STRING F800-NUM-FLAT-TYPE(1:1) '-ROOM FLAT'             
                             DELIMITED BY SIZE INTO PH07-FLAT-TYPE              
                     END-IF                                                     
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F800-NUM-FLAT-TYPE = '1A'                                         
              MOVE 'STUDIO APARTMENT' TO PH07-FLAT-TYPE                         
           END-IF.                                                              
                                                                                
           IF F800-NUM-FLAT-TYPE = '2F'                                         
              MOVE '2-ROOM FLEXI FLAT' TO PH07-FLAT-TYPE                        
           END-IF.                                                              
                                                                                
           IF F800-NUM-FLAT-TYPE = '1F'                                         
              MOVE 'COMMUNITY CARE APT' TO PH07-FLAT-TYPE                       
           END-IF.                                                              
                                                                                
                                                                                
           IF F800-NUM-GEN3      = 'Y'                                          
              MOVE '5-ROOM/3GEN FLAT'  TO PH07-FLAT-TYPE                        
           END-IF.                                                              
                                                                                
           MOVE PH07-FLAT-TYPE             TO PH07-FLAT-TYPE-A                  
                                              PH07-FLAT-TYPE-B                  
                                              PH07-FLAT-TYPE-C                  
                                              PH07-FLAT-TYPE-E                  
                                              PH07-FLAT-TYPE-F.                 
                                                                                
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6200-GET-SBF-FLAT-TYPE.                                                  
      *=============================================================            
                                                                                
           IF F800-NUM-FLAT-TYPE = '3P'                                         
              STRING '3-ROOM PREMIUM FLAT'                                      
                     DELIMITED BY SIZE INTO PH07-FLAT-TYPE                      
           ELSE                                                                 
              IF F800-NUM-FLAT-TYPE = '2F'                                      
                 STRING '2-ROOM FLEXI FLAT'                                     
                     DELIMITED BY SIZE INTO PH07-FLAT-TYPE                      
              ELSE                                                              
                 IF F800-NUM-FLAT-TYPE = '1F'                                   
                    STRING 'COMMUNITY CARE APT'                                 
                      DELIMITED BY SIZE INTO PH07-FLAT-TYPE                     
                 ELSE                                                           
                    STRING F800-NUM-FLAT-TYPE(1:1) '-ROOM FLAT'                 
                      DELIMITED BY SIZE INTO PH07-FLAT-TYPE                     
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE SPACES              TO BP13K246-REC.                            
           INITIALIZE                  BP13K246-REC.                            
                                                                                
           MOVE K060-DESC(1:20)     TO K246-NUM-NEW-TOWN                        
                                                                                
           EVALUATE F800-NUM-FLAT-TYPE                                          
             WHEN '1A'                                                          
             WHEN '2A'                                                          
              MOVE 'SA    '         TO K246-NUM-FLAT-TYPE                       
             WHEN '1F'                                                          
              MOVE '1-ROOM'         TO K246-NUM-FLAT-TYPE                       
             WHEN '2 '                                                          
             WHEN '2F'                                                          
              MOVE '2-ROOM'         TO K246-NUM-FLAT-TYPE                       
             WHEN '3 '                                                          
              MOVE '3-ROOM'         TO K246-NUM-FLAT-TYPE                       
             WHEN '4 '                                                          
              MOVE '4-ROOM'         TO K246-NUM-FLAT-TYPE                       
             WHEN '5 '                                                          
              MOVE '5-ROOM'         TO K246-NUM-FLAT-TYPE                       
           END-EVALUATE.                                                        
                                                                                
           MOVE F800-DTE-BALLOT     TO K246-DTE-BALLOT.                         
                                                                                
           READ BP13K246.                                                       
                                                                                
           IF WS-K246-STATUS = 00                                               
              IF K246-COMBINED-FT NOT = SPACES AND LOW-VALUES                   
                 IF K246-NUM-FT-TAG = 'N'                                       
                    MOVE SPACES       TO WS-STRING-TO-PARSE                     
                    STRING  K246-COMBINED-FT(1:1) '/'                           
                            K246-NUM-FLAT-TYPE(1:6) ' FLAT'                     
                            DELIMITED BY SIZE INTO WS-STRING-TO-PARSE           
                    MOVE LENGTH OF WS-STRING-TO-PARSE                           
                                      TO WS-STRING-LENGTH                       
                    MOVE 'Y'          TO WS-INSERT-SPACE-FLAG                   
                    PERFORM 6210-PARSE-STRING THRU 6210-EXIT                    
                    MOVE   WS-PARSED-STRING   TO  PH07-FLAT-TYPE                
                 ELSE                                                           
                    MOVE SPACES       TO WS-STRING-TO-PARSE                     
                    STRING K246-NUM-FLAT-TYPE(1:6) '/ '                         
                           K246-COMBINED-FT(1:4) ' FLAT'                        
                           DELIMITED BY SIZE INTO WS-STRING-TO-PARSE            
                    MOVE LENGTH OF WS-STRING-TO-PARSE                           
                                      TO WS-STRING-LENGTH                       
                    MOVE 'Y'          TO WS-INSERT-SPACE-FLAG                   
                    PERFORM 6210-PARSE-STRING THRU 6210-EXIT                    
                    MOVE   WS-PARSED-STRING   TO  PH07-FLAT-TYPE                
                 END-IF                                                         
              END-IF                                                            
              IF K246-COMBINED-NT NOT = SPACES AND LOW-VALUES                   
                 IF K246-NUM-NT-TAG = 'Y'                                       
                    MOVE SPACES       TO WS-STRING-TO-PARSE                     
                    STRING K246-NUM-NEW-TOWN '/ '                               
                           K246-COMBINED-NT                                     
                           DELIMITED BY SIZE INTO WS-STRING-TO-PARSE            
                    END-STRING                                                  
                    MOVE LENGTH OF WS-STRING-TO-PARSE                           
                                         TO WS-STRING-LENGTH                    
                    MOVE 'Y'          TO WS-INSERT-SPACE-FLAG                   
                    PERFORM 6210-PARSE-STRING    THRU 6210-EXIT                 
                    MOVE   WS-PARSED-STRING TO  PH07-NME-PRJCT                  
                                                PH07-NME-PRJCT-11C              
                 ELSE                                                           
                    MOVE SPACES       TO WS-STRING-TO-PARSE                     
                    STRING K246-COMBINED-NT '/ '                                
                           K246-NUM-NEW-TOWN                                    
                           DELIMITED BY SIZE INTO WS-STRING-TO-PARSE            
                    END-STRING                                                  
                    MOVE LENGTH OF WS-STRING-TO-PARSE                           
                                      TO WS-STRING-LENGTH                       
                    MOVE 'Y'          TO WS-INSERT-SPACE-FLAG                   
                    PERFORM 6210-PARSE-STRING THRU 6210-EXIT                    
                    MOVE   WS-PARSED-STRING   TO  PH07-NME-PRJCT                
                                                  PH07-NME-PRJCT-11C            
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF F800-NUM-FLAT-TYPE = '3P'                                      
                 STRING '3-ROOM PREMIUM FLAT'                                   
                        DELIMITED BY SIZE INTO PH07-FLAT-TYPE                   
              ELSE                                                              
                 IF F800-NUM-FLAT-TYPE = 'E '                                   
                    MOVE 'EXECUTIVE FLAT'  TO PH07-FLAT-TYPE                    
                 ELSE                                                           
                    IF F800-NUM-FLAT-TYPE = '2F'                                
                       MOVE '2-ROOM FLEXI FLAT'  TO PH07-FLAT-TYPE              
                    ELSE                                                        
                       IF F800-NUM-FLAT-TYPE = '1F'                             
                          MOVE 'COMMUNITY CARE APT' TO PH07-FLAT-TYPE           
                       ELSE                                                     
                          STRING F800-NUM-FLAT-TYPE(1:1) '-ROOM FLAT'           
                           DELIMITED BY SIZE INTO PH07-FLAT-TYPE                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              DISPLAY 'BP13K246 - READING ERROR, STATUS IS '                    
                      WS-K246-STATUS ', KEY IS ' K246-KEY-FLD                   
           END-IF.                                                              
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6210-PARSE-STRING.                                                       
      *=============================================================            
           MOVE SPACES                    TO   WS-PARSED-STRING.                
           MOVE 1                         TO   WS-CUR-POS-PS.                   
           ADD  1                         TO   WS-STRING-LENGTH.                
           PERFORM 6220-GET-CHAR          THRU 6220-EXIT                        
              VARYING WS-CUR-POS-SP FROM 1 BY 1                                 
              UNTIL WS-CUR-POS-SP = WS-STRING-LENGTH.                           
                                                                                
       6210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6220-GET-CHAR.                                                           
      *=============================================================            
           IF WS-STRING-TO-PARSE(WS-CUR-POS-SP:1) NOT = SPACES                  
              IF WS-SPACE-FLAG = 'Y' AND                                        
                 WS-INSERT-SPACE-FLAG = 'Y' AND                                 
                 WS-PARSED-STRING NOT = SPACES                                  
                 MOVE ' ' TO WS-PARSED-STRING(WS-CUR-POS-PS:1)                  
                 ADD 1           TO  WS-CUR-POS-PS                              
              END-IF                                                            
              MOVE WS-STRING-TO-PARSE(WS-CUR-POS-SP:1)                          
                              TO  WS-PARSED-STRING(WS-CUR-POS-PS:1)             
              ADD 1           TO  WS-CUR-POS-PS                                 
              MOVE    'N'      TO WS-SPACE-FLAG                                 
           ELSE                                                                 
              MOVE 'Y'     TO WS-SPACE-FLAG                                     
           END-IF.                                                              
                                                                                
       6220-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6300-DECODE-BALLOT.                                                      
      *=============================================================            
                                                                                
           MOVE SPACES            TO PH07-BALLOT1 WS-BALLOT1                    
                                     PH07-BALLOT2                               
           IF F800-DTE-BALLOT NOT NUMERIC                                       
              MOVE ZEROES                      TO F800-DTE-BALLOT               
           END-IF.                                                              
                                                                                
           IF F800-DTE-BALLOT(5:2) < '01' OR                                    
              F800-DTE-BALLOT(5:2) > '12'                                       
              MOVE '01'                        TO F800-DTE-BALLOT(5:2)          
           END-IF.                                                              
                                                                                
           IF F800-NUM-ALLO-CAT NOT = 'BTO' AND 'BE ' AND 'SBF'                 
              GO TO 6300-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF F800-NUM-ALLO-CAT = 'BTO'                                         
              STRING ' ' F800-DTE-BALLOT(1:4)                                   
                     ' BUILD-TO-ORDER (BTO) EXERCISE'                           
                 DELIMITED BY SIZE INTO WS-BALLOT1                              
           END-IF.                                                              
                                                                                
           IF F800-NUM-ALLO-CAT = 'BE '                                         
              STRING ' ' F800-DTE-BALLOT(1:4)                                   
                     ' BALLOTING EXERCISE'                                      
                 DELIMITED BY SIZE INTO WS-BALLOT1                              
           END-IF.                                                              
                                                                                
           IF F800-NUM-ALLO-CAT = 'SBF'                                         
              STRING ' ' F800-DTE-BALLOT(1:4)                                   
                     ' SALE OF BALANCE FLATS EXERCISE'                          
                 DELIMITED BY SIZE INTO WS-BALLOT1                              
           END-IF.                                                              
                                                                                
           EVALUATE F800-DTE-BALLOT(5:2)                                        
              WHEN '01'                                                         
                   STRING 'JANUARY' WS-BALLOT1                                  
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '02'                                                         
                   STRING 'FEBRUARY' WS-BALLOT1                                 
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '03'                                                         
                   STRING 'MARCH' WS-BALLOT1                                    
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '04'                                                         
                   STRING 'APRIL' WS-BALLOT1                                    
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '05'                                                         
                   STRING 'MAY' WS-BALLOT1                                      
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '06'                                                         
                   STRING 'JUNE' WS-BALLOT1                                     
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '07'                                                         
                   STRING 'JULY' WS-BALLOT1                                     
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '08'                                                         
                   STRING 'AUGUST' WS-BALLOT1                                   
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '09'                                                         
                   STRING 'SEPTEMBER' WS-BALLOT1                                
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '10'                                                         
                   STRING 'OCTOBER' WS-BALLOT1                                  
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '11'                                                         
                   STRING 'NOVEMBER' WS-BALLOT1                                 
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
              WHEN '12'                                                         
                   STRING 'DECEMBER' WS-BALLOT1                                 
                      DELIMITED BY SIZE INTO PH07-BALLOT1                       
           END-EVALUATE.                                                        
                                                                                
           MOVE PH07-BALLOT1            TO PH07-BALLOT2.                        
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6500-GET-WITHIN-LIMIT.                                                   
      *=============================================================            
                                                                                
           MOVE SPACES                 TO BP13KH15-REC.                         
           INITIALIZE                     BP13KH15-REC.                         
                                                                                
           MOVE 'N'                    TO WS-KH15-EOF WS-KH15-FND.              
           MOVE F800-NUM-REGN          TO KH15-NUM-REGN                         
                                                                                
           PERFORM 6510-START-BP13KH15          THRU 6510-EXIT.                 
           IF WS-KH15-STATUS = 00 OR 02                                         
              PERFORM 6520-READNEXT-BP13KH15    THRU 6520-EXIT                  
                UNTIL WS-KH15-EOF = 'Y' OR WS-KH15-FND = 'Y'                    
           ELSE                                                                 
              MOVE 'N'                 TO WS-NUM-WITHIN-LIMIT                   
           END-IF.                                                              
                                                                                
           IF WS-KH15-FND = 'N'                                                 
              IF BP13F800-MASTER(37:4) = 'CH16'                                 
                 MOVE BP13F800-MASTER(41:1) TO WS-NUM-WITHIN-LIMIT              
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6510-START-BP13KH15.                                                     
      ******************************************************************        
                                                                                
           START BP13KH15 KEY >= KH15-ALT-KEY.                                  
                                                                                
           EVALUATE WS-KH15-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
              WHEN 23                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'BP13KH15 - ERROR STARTING :'                          
                         WS-KH15-STATUS                                         
                 MOVE WS-KH15-STATUS     TO RETURN-CODE                         
                 GO TO 9000-CLOSE-ROUTINE                                       
           END-EVALUATE.                                                        
                                                                                
       6510-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *============================================================             
       6520-READNEXT-BP13KH15.                                                  
      *============================================================             
                                                                                
           READ BP13KH15 NEXT                                                   
             AT END MOVE 'Y' TO WS-KH15-EOF.                                    
                                                                                
           EVALUATE WS-KH15-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                IF KH15-NUM-REGN = F800-NUM-REGN                                
                   IF KH15-DTE-BK-APPMT = F800-DTE-BK-APPT                      
                      MOVE KH15-NUM-WITHIN-LIMIT TO WS-NUM-WITHIN-LIMIT         
                      MOVE KH15-NUM-ALLOC-TAG    TO WS-ALLOC-TAG                
                      MOVE 'Y'                   TO WS-KH15-FND                 
                   END-IF                                                       
                ELSE                                                            
                   MOVE 'Y'                      TO WS-KH15-EOF                 
                END-IF                                                          
             WHEN 23                                                            
                MOVE 'Y'                         TO WS-KH15-EOF                 
             WHEN OTHER                                                         
                DISPLAY 'BP13KH15 - READ ERROR: ' WS-KH15-STATUS                
                MOVE WS-KH15-STATUS              TO RETURN-CODE                 
                PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       6520-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6600-READ-BP13K060.                                                      
      *=============================================================            
           READ BP13K060.                                                       
           IF WS-K060-STATUS = 00                                               
              CONTINUE                                                          
           ELSE                                                                 
              IF WS-K060-STATUS = 23                                            
                 DISPLAY 'RECORD NOT FOUND IN BP13K060, KEY: '                  
                         K060-KEY-FLD                                           
              ELSE                                                              
                 DISPLAY 'ERROR WITH READING BP13K060, STATUS '                 
                          WS-K060-STATUS                                        
                         ', KEY: ' K060-KEY-FLD                                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6650-INITIALIZE-DEBAR.                                                   
      *=============================================================            
                                                                                
           MOVE 0                            TO WS-NUM-STRIKE-FT                
                                                WS-NUM-STRIKE-ST                
                                                WS-NUM-STRIKE-FTS.              
           MOVE SPACES                       TO WS-DTE-DEBAR-FT-HH              
                                                WS-DTE-DEBAR-EXP-FT-HH          
                                                WS-DTE-DEBAR-FT-HG              
                                                WS-DTE-DEBAR-EXP-FT-HG          
                                                WS-DTE-DEBAR-ST                 
                                                WS-DTE-DEBAR-EXP-ST             
                                                WS-DTE-DEBAR-FTS                
                                                WS-DTE-DEBAR-EXP-FTS.           
                                                                                
       6650-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6700-READ-BP13KH10.                                                      
      *=============================================================            
                                                                                
           MOVE SPACES                       TO BP13KH10-REC.                   
           INITIALIZE                           BP13KH10-REC.                   
           MOVE WS-NUM-NRIC                  TO KH10-NUM-UIN.                   
                                                                                
           READ BP13KH10.                                                       
           IF WS-KH10-STATUS = 00                                               
              IF KH10-NUM-NON-SELN-FT  > WS-NUM-STRIKE-FT OR                    
                 KH10-NUM-NON-SELN-ST  > WS-NUM-STRIKE-ST OR                    
                 KH10-NUM-NON-SELN-FTS > WS-NUM-STRIKE-FTS                      
      *FT 02                                                                    
                  IF KH10-DTE-DEBAR-FT-HH NOT = SPACES AND LOW-VALUES           
                    STRING KH10-DTE-DEBAR-FT-HH(7:2) '/'                        
                           KH10-DTE-DEBAR-FT-HH(5:2) '/'                        
                           KH10-DTE-DEBAR-FT-HH(1:4)                            
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-FT-HH            
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-FT-HH                 
                  END-IF                                                        
                                                                                
                  IF KH10-DTE-DEBAR-EXPIRY-FT-HH NOT = SPACES AND               
                                                      LOW-VALUES                
                    STRING KH10-DTE-DEBAR-EXPIRY-FT-HH(7:2) '/'                 
                           KH10-DTE-DEBAR-EXPIRY-FT-HH(5:2) '/'                 
                           KH10-DTE-DEBAR-EXPIRY-FT-HH(1:4)                     
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-FT-HH        
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-EXP-FT-HH             
                  END-IF                                                        
                                                                                
                  MOVE KH10-NUM-NON-SELN-FT     TO WS-NUM-STRIKE-FT             
                                                                                
      *FT 04                                                                    
                  IF KH10-DTE-DEBAR-FT-HG NOT = SPACES AND LOW-VALUES           
                    STRING KH10-DTE-DEBAR-FT-HG(7:2) '/'                        
                           KH10-DTE-DEBAR-FT-HG(5:2) '/'                        
                           KH10-DTE-DEBAR-FT-HG(1:4)                            
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-FT-HG            
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-FT-HG                 
                  END-IF                                                        
                                                                                
                  IF KH10-DTE-DEBAR-EXPIRY-FT-HG NOT = SPACES AND               
                                                       LOW-VALUES               
                    STRING KH10-DTE-DEBAR-EXPIRY-FT-HG(7:2) '/'                 
                           KH10-DTE-DEBAR-EXPIRY-FT-HG(5:2) '/'                 
                           KH10-DTE-DEBAR-EXPIRY-FT-HG(1:4)                     
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-FT-HG        
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-EXP-FT-HG             
                  END-IF                                                        
                                                                                
      *ST                                                                       
                  IF KH10-DTE-DEBAR-ST NOT = SPACES AND LOW-VALUES              
                    STRING KH10-DTE-DEBAR-ST(7:2) '/'                           
                           KH10-DTE-DEBAR-ST(5:2) '/'                           
                           KH10-DTE-DEBAR-ST(1:4)                               
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-ST               
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-ST                    
                  END-IF                                                        
                                                                                
                  IF KH10-DTE-DEBAR-EXPIRY-ST NOT = SPACES AND                  
                                                    LOW-VALUES                  
                    STRING KH10-DTE-DEBAR-EXPIRY-ST(7:2) '/'                    
                           KH10-DTE-DEBAR-EXPIRY-ST(5:2) '/'                    
                           KH10-DTE-DEBAR-EXPIRY-ST(1:4)                        
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-ST           
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-EXP-ST                
                  END-IF                                                        
                                                                                
                  MOVE KH10-NUM-NON-SELN-ST     TO WS-NUM-STRIKE-ST             
      *FTS                                                                      
                  IF KH10-DTE-DEBAR-FTS NOT = SPACES AND LOW-VALUES             
                    STRING KH10-DTE-DEBAR-FTS(7:2) '/'                          
                           KH10-DTE-DEBAR-FTS(5:2) '/'                          
                           KH10-DTE-DEBAR-FTS(1:4)                              
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-FTS              
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-FTS                   
                  END-IF                                                        
                                                                                
                  IF KH10-DTE-DEBAR-EXPIRY-FTS NOT = SPACES AND                 
                                                     LOW-VALUES                 
                    STRING KH10-DTE-DEBAR-EXPIRY-FTS(7:2) '/'                   
                           KH10-DTE-DEBAR-EXPIRY-FTS(5:2) '/'                   
                           KH10-DTE-DEBAR-EXPIRY-FTS(1:4)                       
                           DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-FTS          
                    END-STRING                                                  
                  ELSE                                                          
                    MOVE SPACES           TO WS-DTE-DEBAR-EXP-FTS               
                  END-IF                                                        
                                                                                
                  MOVE KH10-NUM-NON-SELN-FTS    TO WS-NUM-STRIKE-FTS            
                                                                                
                  MOVE WS-DTE-DEBAR-FT-HH       TO PH07-DTE-DEBAR               
                                                   PH07-DTE-DEBAR-16            
                                                   PH07-DTE-DEBAR-29            
      *           MOVE WS-DTE-DEBAR-ST          TO PH07-DTE-DEBAR-29            
                                                                                
                 MOVE WS-DTE-DEBAR-EXP-FT-HH TO PH07-DTE-DEBAR-EXP-FT-HH        
                                                PH07-DTE-DEBAR-EXP              
                 MOVE WS-DTE-DEBAR-EXP-FT-HG TO PH07-DTE-DEBAR-EXP-FT-HG        
                 MOVE WS-DTE-DEBAR-EXP-ST    TO PH07-DTE-DEBAR-EXP-ST           
                 MOVE WS-DTE-DEBAR-EXP-FTS   TO PH07-DTE-DEBAR-EXP-FTS          
              END-IF                                                            
                                                                                
           ELSE                                                                 
              IF WS-KH10-STATUS = 23                                            
                 DISPLAY 'RECORD NOT FOUND IN BP13KH10, KEY: '                  
                         KH10-KEY-FLD                                           
              ELSE                                                              
                 DISPLAY 'ERROR WITH READING BP13KH10, STATUS '                 
                          WS-KH10-STATUS                                        
                         ', KEY: ' KH10-KEY-FLD                                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------*                                                   
       6800-GET-BOOK-STATUS.                                                    
      *---------------------*                                                   
                                                                                
           IF F800-NUM-ALLOC-TAG = 'FN' OR 'SI' OR 'NI' OR 'RQ'                 
              PERFORM 6500-GET-WITHIN-LIMIT     THRU 6500-EXIT                  
      *       IF WS-NUM-WITHIN-LIMIT = 'Y'                                      
      *          MOVE 'LF'                    TO WS-ALLOC-TAG                   
      *       ELSE                                                              
      *          MOVE 'WF'                    TO WS-ALLOC-TAG                   
      *       END-IF                                                            
           ELSE                                                                 
              MOVE F800-NUM-ALLOC-TAG         TO WS-ALLOC-TAG                   
              IF WS-KH15-FND = 'N'                                              
                 IF BP13F800-MASTER(37:4) = 'CH16'                              
                    MOVE BP13F800-MASTER(41:1) TO WS-NUM-WITHIN-LIMIT           
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F800-NUM-ALLOC-TAG-PREV NOT = SPACES AND LOW-VALUES               
              MOVE F800-NUM-ALLOC-TAG-PREV    TO WS-ALLOC-TAG-PREV              
           ELSE                                                                 
              IF F800-NUM-ALLOC-TAG = 'RQ'                                      
                 MOVE 'RQ'                    TO WS-ALLOC-TAG-PREV              
              ELSE                                                              
                 MOVE SPACES                  TO WS-ALLOC-TAG-PREV              
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7000-PRT-LETTER.                                                         
      *=============================================================            
                                                                                
           MOVE SPACES                        TO LH07-LTR-TYPE.                 
           IF WS-NUM-MATURE = 'N'                                               
              IF WS-ALLOC-TAG = 'NF' AND WS-ALLOC-TAG-PREV = 'RQ'               
                 IF WS-NI-TAG = 'Y'                                             
                    IF (F800-NUM-ROOM >= '2' OR                                 
                       F800-NUM-FLAT-TYPE = '1F' OR                             
                       F800-NUM-ROOM = 'E') AND                                 
                       WS-NUM-ALLO-SCH NOT = 'FTS'                              
                       PERFORM 7019-PRT-LTR1G      THRU 7019-EXIT               
                    END-IF                                                      
                    IF F800-NUM-FLAT-TYPE = '1A' AND                            
                       WS-NUM-ALLO-SCH NOT = 'FTS'                              
                       PERFORM 7015-PRT-LTR1C      THRU 7015-EXIT               
                    END-IF                                                      
                    IF WS-NUM-ALLO-SCH = 'FTS'                                  
                       PERFORM 7047-PRT-LTR1S      THRU 7047-EXIT               
                    END-IF                                                      
                 ELSE                                                           
                    IF (WS-CDE-HH = 'H' OR 'T') AND                             
                      (F800-NUM-ROOM >= '2' OR                                  
                       F800-NUM-FLAT-TYPE = '1F' OR                             
                       F800-NUM-ROOM = 'E')                                     
                       PERFORM 7007-PRT-LTRI6      THRU 7007-EXIT               
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
              IF WS-ALLOC-TAG = 'NC' AND WS-ALLOC-TAG-PREV = 'RQ'               
                 IF WS-NI-TAG = 'Y'                                             
                    IF (F800-NUM-ROOM >= '2' OR                                 
                        F800-NUM-FLAT-TYPE = '1F' OR                            
                        F800-NUM-ROOM = 'E') AND                                
                       WS-NUM-ALLO-SCH  NOT = 'FTS'                             
                       PERFORM 7018-PRT-LTR1F      THRU 7018-EXIT               
                    END-IF                                                      
                    IF F800-NUM-FLAT-TYPE = '1A'  AND                           
                       WS-NUM-ALLO-SCH NOT = 'FTS'                              
                       PERFORM 7014-PRT-LTR1B      THRU 7014-EXIT               
                    END-IF                                                      
                    IF WS-NUM-ALLO-SCH = 'FTS'                                  
                       PERFORM 7048-PRT-LTR1R      THRU 7048-EXIT               
                    END-IF                                                      
                 ELSE                                                           
                    IF (WS-CDE-HH = 'H' OR 'T') AND                             
                        (F800-NUM-ROOM >= '2' OR                                
                         F800-NUM-FLAT-TYPE = '1F' OR                           
                         F800-NUM-ROOM = 'E')                                   
                       PERFORM 7010-PRT-LTRIU      THRU 7010-EXIT               
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
              IF WS-ALLOC-TAG = 'NC' AND WS-NI-TAG = 'Y'                        
                 IF (F800-NUM-ROOM >= '2' OR                                    
                     F800-NUM-FLAT-TYPE = '1F' OR                               
                     F800-NUM-ROOM = 'E') AND                                   
                    WS-NUM-ALLO-SCH NOT = 'FTS'                                 
                    PERFORM 7016-PRT-LTR1D         THRU 7016-EXIT               
                 END-IF                                                         
                 IF F800-NUM-FLAT-TYPE = '1A' AND                               
                    WS-NUM-ALLO-SCH NOT = 'FTS'                                 
                    PERFORM 7012-PRT-LTRIW         THRU 7012-EXIT               
                 END-IF                                                         
                 IF WS-NUM-ALLO-SCH  = 'FTS'                                    
                    PERFORM 7048-PRT-LTR1R         THRU 7048-EXIT               
                 END-IF                                                         
              ELSE                                                              
              IF (WS-ALLOC-TAG = 'NF' OR 'SF') AND WS-NI-TAG NOT = 'Y'          
                 IF (WS-CDE-HH = 'H' OR 'T') AND (F800-NUM-ROOM >= '2'          
                     OR F800-NUM-FLAT-TYPE = '1F'                               
                     OR F800-NUM-ROOM = 'E')                                    
                    PERFORM 7003-PRT-LTRI2         THRU 7003-EXIT               
                 END-IF                                                         
              ELSE                                                              
              IF WS-ALLOC-TAG = 'NF' AND WS-NI-TAG = 'Y'                        
                 IF (F800-NUM-ROOM >= '2' OR                                    
                     F800-NUM-FLAT-TYPE = '1F' OR                               
                     F800-NUM-ROOM = 'E') AND                                   
                    WS-NUM-ALLO-SCH NOT = 'FTS'                                 
                    PERFORM 7017-PRT-LTR1E         THRU 7017-EXIT               
                 END-IF                                                         
                 IF F800-NUM-FLAT-TYPE = '1A' AND                               
                    WS-NUM-ALLO-SCH NOT = 'FTS'                                 
                    PERFORM 7013-PRT-LTRIX         THRU 7013-EXIT               
                 END-IF                                                         
                 IF WS-NUM-ALLO-SCH = 'FTS'                                     
                    PERFORM 7047-PRT-LTR1S         THRU 7047-EXIT               
                 END-IF                                                         
              ELSE                                                              
              IF (WS-ALLOC-TAG = 'NC' OR 'SC') AND WS-NI-TAG NOT = 'Y'          
                 IF (WS-CDE-HH = 'H' OR 'T') AND (F800-NUM-ROOM >= '2'          
                     OR F800-NUM-FLAT-TYPE = '1F'                               
                     OR F800-NUM-ROOM = 'E')                                    
                    PERFORM 7004-PRT-LTRI3         THRU 7004-EXIT               
                 END-IF                                                         
              ELSE                                                              
              IF WS-ALLOC-TAG = 'NV' AND WS-NI-TAG = 'Y'                        
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7021-PRT-LTR1K         THRU 7021-EXIT               
                 ELSE                                                           
                    PERFORM 7020-PRT-LTR1J         THRU 7020-EXIT               
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-NUM-MATURE = 'Y'                                               
              IF WS-ALLOC-TAG = 'NF' AND WS-ALLOC-TAG-PREV = 'RQ'               
                 IF WS-NI-TAG = 'Y'                                             
                    PERFORM 7015-PRT-LTR1C         THRU 7015-EXIT               
                 ELSE                                                           
                    IF (WS-CDE-HH = 'H' OR 'T') AND                             
                        (F800-NUM-ROOM >= '2' OR                                
                         F800-NUM-FLAT-TYPE = '1F' OR                           
                         F800-NUM-ROOM = 'E')                                   
                       PERFORM 7011-PRT-LTRIV      THRU 7011-EXIT               
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
              IF WS-ALLOC-TAG = 'NC' AND WS-ALLOC-TAG-PREV = 'RQ'               
                 IF WS-NI-TAG = 'Y'                                             
                    PERFORM 7014-PRT-LTR1B         THRU 7014-EXIT               
                 ELSE                                                           
                    IF (WS-CDE-HH = 'H' OR 'T') AND                             
                        (F800-NUM-ROOM >= '2' OR                                
                         F800-NUM-FLAT-TYPE = '1F' OR                           
                         F800-NUM-ROOM = 'E')                                   
                       PERFORM 7008-PRT-LTRI7      THRU 7008-EXIT               
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
              IF WS-ALLOC-TAG = 'NF' AND WS-NI-TAG = 'Y'                        
                 IF F800-NUM-ROOM >= '2' OR F800-NUM-FLAT-TYPE = '1A'           
                    OR F800-NUM-FLAT-TYPE = '1F'                                
                    OR F800-NUM-ROOM = 'E'                                      
                    PERFORM 7013-PRT-LTRIX         THRU 7013-EXIT               
                 END-IF                                                         
              ELSE                                                              
              IF (WS-ALLOC-TAG = 'NF' OR 'SF') AND WS-NI-TAG NOT = 'Y'          
                 IF (WS-CDE-HH = 'H' OR 'T') AND (F800-NUM-ROOM >= '2'          
                      OR F800-NUM-FLAT-TYPE = '1F'                              
                      OR F800-NUM-ROOM = 'E')                                   
                    PERFORM 7013-PRT-LTRIX         THRU 7013-EXIT               
                 END-IF                                                         
              ELSE                                                              
              IF WS-ALLOC-TAG = 'NC' AND WS-NI-TAG = 'Y'                        
                 IF F800-NUM-ROOM >= '2' OR F800-NUM-FLAT-TYPE = '1A'           
                     OR F800-NUM-FLAT-TYPE = '1F'                               
                     OR F800-NUM-ROOM = 'E'                                     
                    PERFORM 7012-PRT-LTRIW         THRU 7012-EXIT               
                 END-IF                                                         
              ELSE                                                              
              IF (WS-ALLOC-TAG = 'NC' OR 'SC') AND WS-NI-TAG NOT = 'Y'          
                 IF (WS-CDE-HH = 'H' OR 'T') AND (F800-NUM-ROOM >= '2'          
                      OR F800-NUM-FLAT-TYPE ='1F'                               
                      OR F800-NUM-ROOM = 'E')                                   
                    PERFORM 7012-PRT-LTRIW         THRU 7012-EXIT               
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
             IF WS-ALLOC-TAG   = 'LF'  AND                                      
                WS-NI-TAG NOT  = 'Y'   AND                                      
                (F800-NUM-ROOM >= '2'  OR                                       
                F800-NUM-FLAT-TYPE = '1F' OR                                    
                F800-NUM-ROOM = 'E')   AND                                      
                (WS-CDE-HH = 'H' OR 'T')                                        
                IF WS-NUM-STRIKE-FT = '01'                                      
                   IF WS-ALLOC-TAG-PREV = 'RQ'                                  
                      IF F800-DTE-BALLOT >= '201307'                            
                         PERFORM 7037-PRT-LTR8C         THRU 7037-EXIT          
                      ELSE                                                      
                         PERFORM 7005-PRT-LTRI4         THRU 7005-EXIT          
                      END-IF                                                    
                   ELSE                                                         
                      IF F800-DTE-BALLOT >= '201307'                            
                         PERFORM 7035-PRT-LTR8A      THRU 7035-EXIT             
                      ELSE                                                      
                         PERFORM 7001-PRT-LTRI0      THRU 7001-EXIT             
                      END-IF                                                    
                   END-IF                                                       
                ELSE                                                            
                   IF WS-NUM-STRIKE-FT = '02'                                   
                      IF WS-ALLOC-TAG-PREV = 'RQ'                               
                         IF F800-DTE-BALLOT >= '201307'                         
                            PERFORM 7040-PRT-LTR8F       THRU 7040-EXIT         
                         ELSE                                                   
                            PERFORM 7022-PRT-LTRI9       THRU 7022-EXIT         
                         END-IF                                                 
                      ELSE                                                      
                         IF F800-DTE-BALLOT >= '201307'                         
                            PERFORM 7039-PRT-LTR8E       THRU 7039-EXIT         
                         ELSE                                                   
                            PERFORM 7009-PRT-LTRIT       THRU 7009-EXIT         
                         END-IF                                                 
                      END-IF                                                    
                   END-IF                                                       
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
             IF WS-ALLOC-TAG = 'WF' AND                                         
                WS-NI-TAG NOT = 'Y' AND                                         
                (F800-NUM-ROOM >= '2' OR                                        
                 F800-NUM-FLAT-TYPE = '1F' OR                                   
                 F800-NUM-ROOM = 'E') AND                                       
                (WS-CDE-HH = 'H' OR 'T')                                        
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   IF F800-DTE-BALLOT >= '201307'                               
                      PERFORM 7038-PRT-LTR8D            THRU 7038-EXIT          
                   ELSE                                                         
                      PERFORM 7006-PRT-LTRI5            THRU 7006-EXIT          
                   END-IF                                                       
                ELSE                                                            
                   IF F800-DTE-BALLOT >= '201307'                               
                      PERFORM 7036-PRT-LTR8B            THRU 7036-EXIT          
                   ELSE                                                         
                      PERFORM 7002-PRT-LTRI1            THRU 7002-EXIT          
                   END-IF                                                       
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * NEW LETTERS ABCDE                                                       
      * 7 AND 9                                                                 
                                                                                
             IF (WS-ALLOC-TAG        = 'LG' OR 'LF') AND                        
                 WS-NUM-STRIKE-FT    = '03' AND                                 
                 WS-NUM-WITHIN-LIMIT = 'Y'  AND                                 
                (WS-CDE-HH = 'H' OR 'T')                                        
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7025-PRT-LTR8I            THRU 7025-EXIT             
                ELSE                                                            
                   PERFORM 7023-PRT-LTR8G            THRU 7023-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 8 AND 10                                                                
             IF WS-ALLOC-TAG        = 'WG' AND                                  
                WS-NI-TAG       NOT = 'Y'  AND                                  
                WS-NUM-WITHIN-LIMIT = 'N'  AND                                  
               (WS-CDE-HH = 'H' OR 'T' AND WS-CDE-BHH = 'G')                    
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7026-PRT-LTR8J            THRU 7026-EXIT             
                ELSE                                                            
                   PERFORM 7024-PRT-LTR8H            THRU 7024-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 11 AND 12                                                               
             IF (WS-ALLOC-TAG        = 'LF' OR                                  
                 WS-ALLOC-TAG        = 'LG') AND                                
                 WS-NUM-STRIKE-FT    = '04' AND                                 
                 WS-NUM-WITHIN-LIMIT = 'Y'  AND                                 
                (WS-CDE-HH = 'H' OR 'T' AND WS-CDE-BHH = 'H' OR 'G')            
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7028-PRT-LTR8L            THRU 7028-EXIT             
                ELSE                                                            
                   PERFORM 7027-PRT-LTR8K            THRU 7027-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 13 AND 15                                                               
             IF WS-ALLOC-TAG        = 'LA' AND                                  
                WS-NUM-STRIKE-ST    = '01' AND                                  
                WS-NUM-WITHIN-LIMIT = 'Y'  AND                                  
               (WS-CDE-HH = 'G' AND WS-CDE-BHH = 'G')                           
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7031-PRT-LTR8O            THRU 7031-EXIT             
                ELSE                                                            
                   PERFORM 7029-PRT-LTR8M            THRU 7029-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 14 AND 16                                                               
             IF WS-ALLOC-TAG        = 'WA' AND                                  
                WS-NUM-WITHIN-LIMIT = 'N'  AND                                  
               (WS-CDE-HH = 'G' AND WS-CDE-BHH = 'G')                           
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7050-PRT-LTRME            THRU 7050-EXIT             
                ELSE                                                            
                   PERFORM 7049-PRT-LTRMD            THRU 7049-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 17 AND 18                                                               
             IF WS-ALLOC-TAG        = 'LA' AND                                  
                WS-NUM-STRIKE-ST    = '02' AND                                  
                WS-NUM-WITHIN-LIMIT = 'Y'  AND                                  
               (WS-CDE-HH = 'G' AND WS-CDE-BHH = 'G')                           
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7034-PRT-LTR8R            THRU 7034-EXIT             
                ELSE                                                            
                   PERFORM 7033-PRT-LTR8Q            THRU 7033-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 19 AND 21                                                               
             IF WS-ALLOC-TAG        = 'LB' AND                                  
                ((WS-NUM-ALLO-SCH     = 'FTS' OR 'STS') OR                      
                ((WS-NUM-ALLO-SCH   = 'SAP') AND                                
                (WS-NUM-ELIG-SCHEME = 'SSC' OR 'JSS' OR 'NCS' OR                
                                         'SSE' OR 'JSE' OR 'NSE'))) AND         
                WS-NUM-STRIKE-FTS   = '01' AND                                  
                WS-NUM-WITHIN-LIMIT = 'Y'                                       
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7043-PRT-LTR8U            THRU 7043-EXIT             
                ELSE                                                            
                   PERFORM 7041-PRT-LTR8S            THRU 7041-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
           IF  WS-ALLOC-TAG        = 'LB'  AND WS-NUM-ALLO-SCH   = 'PA '        
           AND WS-NUM-ELIG-SCHEME  = 'PAC' AND WS-NUM-STRIKE-FTS = '01'         
           AND WS-NUM-WITHIN-LIMIT = 'Y'                                        
              IF WS-ALLOC-TAG-PREV = 'RQ'                                       
                 PERFORM 7031-PRT-LTR8O            THRU 7031-EXIT               
              ELSE                                                              
                 PERFORM 7029-PRT-LTR8M            THRU 7029-EXIT               
              END-IF                                                            
           END-IF                                                               
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 20 AND 22                                                               
             IF WS-ALLOC-TAG        = 'WB' AND                                  
                ((WS-NUM-ALLO-SCH     = 'FTS' OR 'STS')  OR                     
                ((WS-NUM-ALLO-SCH   = 'SAP') AND                                
                (WS-NUM-ELIG-SCHEME = 'SSC' OR 'JSS' OR 'NCS' OR                
                                         'SSE' OR 'JSE' OR 'NSE'))) AND         
                WS-NUM-WITHIN-LIMIT = 'N'                                       
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7050-PRT-LTRME            THRU 7050-EXIT             
                ELSE                                                            
                   PERFORM 7049-PRT-LTRMD            THRU 7049-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
           IF  WS-ALLOC-TAG       = 'WB'  AND WS-NUM-ALLO-SCH    = 'PA '        
           AND WS-NUM-ELIG-SCHEME = 'PAC' AND WS-NUM-WITHIN-LIMIT = 'N'         
              IF WS-ALLOC-TAG-PREV = 'RQ'                                       
                 PERFORM 7050-PRT-LTRME            THRU 7050-EXIT               
              ELSE                                                              
                 PERFORM 7049-PRT-LTRMD            THRU 7049-EXIT               
              END-IF                                                            
           END-IF                                                               
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
      * 23 AND 24                                                               
             IF WS-ALLOC-TAG        = 'LB'  AND                                 
                ((WS-NUM-ALLO-SCH     = 'FTS' OR 'STS') OR                      
                ((WS-NUM-ALLO-SCH   = 'SAP') AND                                
                (WS-NUM-ELIG-SCHEME = 'SSC' OR 'JSS' OR 'NCS' OR                
                                         'SSE' OR 'JSE' OR 'NSE'))) AND         
                WS-NUM-STRIKE-FTS   = '02'  AND                                 
                WS-NUM-WITHIN-LIMIT = 'Y'                                       
                IF WS-ALLOC-TAG-PREV = 'RQ'                                     
                   PERFORM 7046-PRT-LTR8X            THRU 7046-EXIT             
                ELSE                                                            
                   PERFORM 7045-PRT-LTR8W            THRU 7045-EXIT             
                END-IF                                                          
             END-IF                                                             
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
      *BP139545 START                                                           
           IF F800-DTE-BALLOT < '202310'                                        
                                                                                
           IF  WS-ALLOC-TAG        = 'LB'  AND WS-NUM-ALLO-SCH   = 'PA '        
           AND WS-NUM-ELIG-SCHEME  = 'PAC' AND WS-NUM-STRIKE-FTS = '02'         
           AND WS-NUM-WITHIN-LIMIT = 'Y'                                        
              IF WS-ALLOC-TAG-PREV = 'RQ'                                       
                 PERFORM 7034-PRT-LTR8R            THRU 7034-EXIT               
              ELSE                                                              
                 PERFORM 7033-PRT-LTR8Q            THRU 7033-EXIT               
              END-IF                                                            
           END-IF                                                               
                                                                                
           END-IF.                                                              
      *BP139545 END                                                             
                                                                                
           IF LH07-LTR-TYPE = SPACES                                            
              ADD 1 TO WS-CNT-NOLTR                                             
              DISPLAY ' ================================'                       
              DISPLAY ' NO LETTER PRINTED FOR THIS REGN : '                     
                       F800-NUM-REGN                                            
              DISPLAY ' MATURE : ' WS-NUM-MATURE                                
                      ' ALLOC-TAG : ' WS-ALLOC-TAG                              
                      ' A-TAG-PRE : ' WS-ALLOC-TAG-PREV                         
                      ' NI-TAG : ' WS-NI-TAG                                    
                      ' HH : ' WS-CDE-HH                                        
                      ' BHH : ' WS-CDE-BHH                                      
                      ' ALLO SCH: ' WS-NUM-ALLO-SCH                             
                      ' FT : ' F800-NUM-FLAT-TYPE                               
              DISPLAY ' FT STRIKE : ' WS-NUM-STRIKE-FT                          
                      ' ST STRIKE : ' WS-NUM-STRIKE-ST                          
                      ' FTS STRIKE : ' WS-NUM-STRIKE-FTS                        
                      ' W/LIMIT : ' WS-NUM-WITHIN-LIMIT                         
              DISPLAY ' INCOME: ' F800-AMT-HSE-INCOME                           
                      ' PPO TAG : ' F800-NUM-PPO                                
              DISPLAY ' ================================'                       
           END-IF.                                                              
                                                                                
       7000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------------------------------------------------*          
       7001-PRT-LTRI0.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I0'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07A-PRTREC.                           
            WRITE PH07A-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07A-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07A-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07A-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07A-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07A-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07A-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07A-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07A-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07A-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07A-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07A-PRTREC    FROM  PH07-LINE10 AFTER 3.                    
            WRITE PH07A-PRTREC    FROM  PH07-LINE11                             
            WRITE PH07A-PRTREC    FROM  PH07-LINE12 AFTER 2.                    
            WRITE PH07A-PRTREC    FROM  PH07-LINE13 AFTER 23.                   
            ADD   1               TO    WS-PH07A-WRT-CTR.                       
                                                                                
       7001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7002-PRT-LTRI1.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I1'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07B-PRTREC.                           
            WRITE PH07B-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07B-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07B-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07B-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07B-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE10 AFTER 3.                    
            WRITE PH07B-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07B-PRTREC    FROM  PH07-LINE12 AFTER 2.                    
            WRITE PH07B-PRTREC    FROM  PH07-LINE13 AFTER 23.                   
            ADD   1               TO    WS-PH07B-WRT-CTR.                       
                                                                                
       7002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7003-PRT-LTRI2.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I2'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07C-PRTREC.                           
            WRITE PH07C-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07C-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07C-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07C-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07C-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE10 AFTER 3.                    
            WRITE PH07C-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07C-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07C-WRT-CTR.                       
                                                                                
       7003-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7004-PRT-LTRI3.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I3'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07D-PRTREC.                           
            WRITE PH07D-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07D-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07D-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07D-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07D-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE10 AFTER 3.                    
            WRITE PH07D-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07D-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07D-WRT-CTR.                       
                                                                                
       7004-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7005-PRT-LTRI4.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I4'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07E-PRTREC.                           
            WRITE PH07E-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07E-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07E-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07E-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07E-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE10A AFTER 3.                   
            WRITE PH07E-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07E-PRTREC    FROM  PH07-LINE15 AFTER 3.                    
            WRITE PH07E-PRTREC    FROM  PH07-LINE13 AFTER 16.                   
            ADD   1               TO    WS-PH07E-WRT-CTR.                       
                                                                                
       7005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7006-PRT-LTRI5.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I5'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07F-PRTREC.                           
            WRITE PH07F-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07F-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07F-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07F-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07F-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE10A AFTER 3.                   
            WRITE PH07F-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07F-PRTREC    FROM  PH07-LINE15 AFTER 3.                    
            WRITE PH07F-PRTREC    FROM  PH07-LINE13 AFTER 16.                   
            ADD   1               TO    WS-PH07F-WRT-CTR.                       
                                                                                
       7006-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7007-PRT-LTRI6.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I6'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07G-PRTREC.                           
            WRITE PH07G-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07G-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07G-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07G-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07G-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE10A AFTER 3.                   
            WRITE PH07G-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07G-PRTREC    FROM  PH07-LINE15 AFTER 3.                    
            WRITE PH07G-PRTREC    FROM  PH07-LINE13 AFTER 25.                   
            ADD   1               TO    WS-PH07G-WRT-CTR.                       
                                                                                
       7007-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7008-PRT-LTRI7.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'I7'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07H-PRTREC.                           
            WRITE PH07H-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07H-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07H-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07H-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07H-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE10A AFTER 3.                   
            WRITE PH07H-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07H-PRTREC    FROM  PH07-LINE15 AFTER 3.                    
            WRITE PH07H-PRTREC    FROM  PH07-LINE13 AFTER 15.                   
            ADD   1               TO    WS-PH07H-WRT-CTR.                       
                                                                                
       7008-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7009-PRT-LTRIT.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'IT'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07I-PRTREC.                           
            WRITE PH07I-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07I-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07I-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07I-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07I-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE10 AFTER 3.                    
            WRITE PH07I-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07I-PRTREC    FROM  PH07-LINE12 AFTER 2.                    
            WRITE PH07I-PRTREC    FROM  PH07-LINE14 AFTER 9.                    
            WRITE PH07I-PRTREC    FROM  PH07-LINE13 AFTER 16.                   
            ADD   1               TO    WS-PH07I-WRT-CTR.                       
                                                                                
       7009-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7010-PRT-LTRIU.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'IU'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07J-PRTREC.                           
            WRITE PH07J-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07J-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07J-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07J-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07J-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE10A AFTER 3.                   
            WRITE PH07J-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07J-PRTREC    FROM  PH07-LINE15 AFTER 3.                    
            WRITE PH07J-PRTREC    FROM  PH07-LINE13 AFTER 18.                   
            ADD   1               TO    WS-PH07J-WRT-CTR.                       
                                                                                
       7010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7011-PRT-LTRIV.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'IV'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07K-PRTREC.                           
            WRITE PH07K-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07K-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07K-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07K-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07K-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE10A AFTER 3.                   
            WRITE PH07K-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07K-PRTREC    FROM  PH07-LINE15 AFTER 3.                    
            WRITE PH07K-PRTREC    FROM  PH07-LINE13 AFTER 18.                   
            ADD   1               TO    WS-PH07K-WRT-CTR.                       
                                                                                
       7011-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7012-PRT-LTRIW.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'IW'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07L-PRTREC.                           
            WRITE PH07L-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07L-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07L-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07L-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07L-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07L-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07L-PRTREC    FROM  PH07-LINE13 AFTER 20.                   
            ADD   1               TO    WS-PH07L-WRT-CTR.                       
                                                                                
       7012-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7013-PRT-LTRIX.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'IX'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07M-PRTREC.                           
            WRITE PH07M-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07M-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07M-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07M-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07M-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07M-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07M-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07M-WRT-CTR.                       
                                                                                
       7013-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7014-PRT-LTR1B.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1B'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07N-PRTREC.                           
            WRITE PH07N-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07N-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07N-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07N-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07N-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07N-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07N-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07N-WRT-CTR.                       
                                                                                
       7014-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7015-PRT-LTR1C.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1C'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07O-PRTREC.                           
            WRITE PH07O-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07O-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07O-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07O-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07O-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07O-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07O-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07O-WRT-CTR.                       
                                                                                
       7015-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7016-PRT-LTR1D.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1D'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07P-PRTREC.                           
            WRITE PH07P-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07P-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07P-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07P-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07P-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07P-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07P-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07P-WRT-CTR.                       
                                                                                
       7016-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7017-PRT-LTR1E.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1E'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07Q-PRTREC.                           
            WRITE PH07Q-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07Q-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07Q-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07Q-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07Q-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07Q-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07Q-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07Q-WRT-CTR.                       
                                                                                
       7017-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7018-PRT-LTR1F.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1F'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07R-PRTREC.                           
            WRITE PH07R-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07R-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07R-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07R-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07R-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07R-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07R-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07R-WRT-CTR.                       
                                                                                
       7018-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7019-PRT-LTR1G.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1G'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07S-PRTREC.                           
            WRITE PH07S-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07S-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07S-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07S-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07S-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH07S-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07S-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07S-WRT-CTR.                       
                                                                                
       7019-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7020-PRT-LTR1J.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1J'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07T-PRTREC.                           
            WRITE PH07T-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07T-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07T-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07T-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07T-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE10 AFTER 3.                    
            WRITE PH07T-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07T-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07T-WRT-CTR.                       
                                                                                
       7020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7021-PRT-LTR1K.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1K'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07U-PRTREC.                           
            WRITE PH07U-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07U-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07U-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07U-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07U-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE10A AFTER 3.                   
            WRITE PH07U-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07U-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH07U-WRT-CTR.                       
                                                                                
       7021-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7022-PRT-LTRI9.                                                          
      *=============================================================            
                                                                                
            MOVE 'I9'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07V-PRTREC.                           
            WRITE PH07V-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07V-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07V-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07V-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH07V-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE10B AFTER 3.                   
            WRITE PH07V-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH07V-PRTREC    FROM  PH07-LINE15 AFTER 3.                    
            WRITE PH07V-PRTREC    FROM  PH07-LINE14 AFTER 6.                    
            WRITE PH07V-PRTREC    FROM  PH07-LINE13 AFTER 18.                   
            ADD   1               TO    WS-PH07V-WRT-CTR.                       
                                                                                
       7022-EXIT.                                                               
           EXIT.                                                                
                                                                                
      * FTS LETTERS                                                             
                                                                                
      *=============================================================            
       7023-PRT-LTR8G.                                                          
      *=============================================================            
                                                                                
            MOVE '8G'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH073-PRTREC.                           
            WRITE PH073-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH073-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH073-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH073-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH073-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH073-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH073-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH073-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH073-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH073-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH073-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH073-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH073-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH073-PRTREC    FROM  PH07-LINE16 AFTER 4.                    
            WRITE PH073-PRTREC    FROM  PH07-LINE13 AFTER 20.                   
            ADD   1               TO    WS-PH073-WRT-CTR.                       
                                                                                
       7023-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7024-PRT-LTR8H.                                                          
      *=============================================================            
                                                                                
            MOVE '8H'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH074-PRTREC.                           
            WRITE PH074-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH074-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH074-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH074-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH074-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH074-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH074-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH074-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH074-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH074-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH074-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH074-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH074-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH074-PRTREC    FROM  PH07-LINE18 AFTER 3.                    
            WRITE PH074-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH074-WRT-CTR.                       
                                                                                
       7024-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7025-PRT-LTR8I.                                                          
      *=============================================================            
                                                                                
            MOVE '8I'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH075-PRTREC.                           
            WRITE PH075-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH075-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH075-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH075-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH075-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH075-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH075-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH075-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH075-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH075-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH075-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH075-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH075-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH075-PRTREC    FROM  PH07-LINE29  AFTER 4.                   
            WRITE PH075-PRTREC    FROM  PH07-LINE13 AFTER 18.                   
            ADD   1               TO    WS-PH075-WRT-CTR.                       
                                                                                
       7025-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7026-PRT-LTR8J.                                                          
      *=============================================================            
                                                                                
            MOVE '8J'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH076-PRTREC.                           
            WRITE PH076-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH076-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH076-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH076-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH076-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH076-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH076-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH076-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH076-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH076-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH076-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH076-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH076-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH076-PRTREC    FROM  PH07-LINE23 AFTER 4.                    
            WRITE PH076-PRTREC    FROM  PH07-LINE13 AFTER 18.                   
            ADD   1               TO    WS-PH076-WRT-CTR.                       
                                                                                
       7026-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7027-PRT-LTR8K.                                                          
      *=============================================================            
                                                                                
            MOVE '8K'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH077-PRTREC.                           
            WRITE PH077-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH077-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH077-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH077-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH077-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH077-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH077-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH077-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH077-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH077-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH077-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH077-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH077-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH077-PRTREC    FROM  PH07-LINE28 AFTER 6.                    
            WRITE PH077-PRTREC    FROM  PH07-LINE13 AFTER 18.                   
            ADD   1               TO    WS-PH077-WRT-CTR.                       
                                                                                
       7027-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7028-PRT-LTR8L.                                                          
      *=============================================================            
                                                                                
            MOVE '8L'               TO  LH07-LTR-TYPE.                          
            MOVE WS-DTE-DEBAR-FT-HG TO  PH07-DTE-BK-APPT-17.                    
                                                                                
            MOVE  SPACES            TO  PH078-PRTREC.                           
            WRITE PH078-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH078-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH078-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH078-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH078-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH078-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH078-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH078-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH078-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH078-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH078-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH078-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH078-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH078-PRTREC    FROM  PH07-LINE17 AFTER 6.                    
            WRITE PH078-PRTREC    FROM  PH07-LINE13 AFTER 16.                   
            ADD   1               TO    WS-PH078-WRT-CTR.                       
                                                                                
       7028-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7029-PRT-LTR8M.                                                          
      *=============================================================            
                                                                                
            MOVE '8M'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH079-PRTREC.                           
            WRITE PH079-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH079-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH079-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH079-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH079-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH079-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH079-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH079-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH079-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH079-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH079-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH079-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH079-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH079-PRTREC    FROM  PH07-LINE13 AFTER 24.                   
            ADD   1               TO    WS-PH079-WRT-CTR.                       
                                                                                
       7029-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7030-PRT-LTR8N.                                                          
      *=============================================================            
                                                                                
            MOVE '8N'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH070-PRTREC.                           
            WRITE PH070-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH070-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH070-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH070-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH070-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH070-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH070-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH070-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH070-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH070-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH070-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH070-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH070-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH070-PRTREC    FROM  PH07-LINE13 AFTER 24.                   
            ADD   1               TO    WS-PH070-WRT-CTR.                       
                                                                                
       7030-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7031-PRT-LTR8O.                                                          
      *=============================================================            
                                                                                
            MOVE '8O'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A1-PRTREC.                           
            WRITE PH7A1-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A1-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A1-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A1-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A1-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A1-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A1-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A1-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A1-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A1-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A1-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A1-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A1-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH7A1-PRTREC    FROM  PH07-LINE13 AFTER 22.                   
            ADD   1               TO    WS-PH7A1-WRT-CTR.                       
                                                                                
       7031-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7032-PRT-LTR8P.                                                          
      *=============================================================            
                                                                                
            MOVE '8P'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A2-PRTREC.                           
            WRITE PH7A2-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A2-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A2-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A2-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A2-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A2-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A2-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A2-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A2-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A2-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A2-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A2-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A2-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH7A2-PRTREC    FROM  PH07-LINE13 AFTER 22.                   
            ADD   1               TO    WS-PH7A2-WRT-CTR.                       
                                                                                
       7032-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7033-PRT-LTR8Q.                                                          
      *=============================================================            
                                                                                
            MOVE '8Q'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A3-PRTREC.                           
            WRITE PH7A3-PRTREC    AFTER PAGE.                                   
                                                                                
            IF WS-ALLOC-TAG = 'LA'                                              
               MOVE WS-DTE-DEBAR-ST      TO PH07-DTE-BK-APPT-25                 
               MOVE WS-DTE-DEBAR-EXP-ST  TO PH07-DTE-DEBAR-EXP-FTS              
            ELSE                                                                
               IF WS-ALLOC-TAG = 'LB'                                           
                  MOVE WS-DTE-DEBAR-FTS     TO PH07-DTE-BK-APPT-25              
                  MOVE WS-DTE-DEBAR-EXP-FTS TO PH07-DTE-DEBAR-EXP-FTS           
               END-IF                                                           
            END-IF.                                                             
                                                                                
            WRITE PH7A3-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A3-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A3-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A3-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A3-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A3-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A3-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A3-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A3-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A3-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A3-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A3-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH7A3-PRTREC    FROM  PH07-LINE25 AFTER 4.                    
            WRITE PH7A3-PRTREC    FROM  PH07-LINE21 AFTER 4.                    
            WRITE PH7A3-PRTREC    FROM  PH07-LINE13 AFTER 16.                   
            ADD   1               TO    WS-PH7A3-WRT-CTR.                       
                                                                                
       7033-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7034-PRT-LTR8R.                                                          
      *=============================================================            
                                                                                
            MOVE '8R'               TO  LH07-LTR-TYPE.                          
            MOVE WS-DTE-DEBAR-ST    TO PH07-DTE-BK-APPT-19.                     
                                                                                
            MOVE  SPACES            TO  PH7A4-PRTREC.                           
            WRITE PH7A4-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A4-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A4-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A4-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A4-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A4-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A4-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A4-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A4-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A4-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A4-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A4-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A4-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH7A4-PRTREC    FROM  PH07-LINE19 AFTER 4.                    
            WRITE PH7A4-PRTREC    FROM  PH07-LINE20 AFTER 4.                    
            WRITE PH7A4-PRTREC    FROM  PH07-LINE13 AFTER 14.                   
            ADD   1               TO    WS-PH7A4-WRT-CTR.                       
                                                                                
       7034-EXIT.                                                               
           EXIT.                                                                
                                                                                
      * FT2T NEW REPORT                                                         
      *=============================================================            
       7035-PRT-LTR8A.                                                          
      *=============================================================            
                                                                                
            MOVE '8A'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07W-PRTREC.                           
            WRITE PH07W-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07W-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07W-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07W-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07W-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07W-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07W-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07W-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07W-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07W-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH07W-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH07W-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH07W-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH07W-PRTREC    FROM  PH07-LINE13 AFTER 24.                   
            ADD   1               TO    WS-PH07W-WRT-CTR.                       
                                                                                
       7035-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7036-PRT-LTR8B.                                                          
      *=============================================================            
                                                                                
            MOVE '8B'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07X-PRTREC.                           
            WRITE PH07X-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07X-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07X-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07X-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07X-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07X-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07X-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07X-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07X-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07X-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH07X-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH07X-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH07X-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH07X-PRTREC    FROM  PH07-LINE13 AFTER 24.                   
            ADD   1               TO    WS-PH07X-WRT-CTR.                       
                                                                                
       7036-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7037-PRT-LTR8C.                                                          
      *=============================================================            
                                                                                
            MOVE '8C'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07Y-PRTREC.                           
            WRITE PH07Y-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07Y-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07Y-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07Y-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07Y-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07Y-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07Y-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07Y-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07Y-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07Y-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH07Y-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH07Y-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH07Y-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH07Y-PRTREC    FROM  PH07-LINE13 AFTER 22.                   
            ADD   1               TO    WS-PH07Y-WRT-CTR.                       
                                                                                
       7037-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7038-PRT-LTR8D.                                                          
      *=============================================================            
                                                                                
            MOVE '8D'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH07Z-PRTREC.                           
            WRITE PH07Z-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH07Z-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH07Z-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH07Z-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH07Z-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH07Z-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH07Z-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH07Z-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH07Z-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH07Z-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH07Z-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH07Z-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH07Z-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH07Z-PRTREC    FROM  PH07-LINE13 AFTER 22.                   
            ADD   1               TO    WS-PH07Z-WRT-CTR.                       
                                                                                
       7038-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7039-PRT-LTR8E.                                                          
      *=============================================================            
                                                                                
            MOVE '8E'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH071-PRTREC.                           
            WRITE PH071-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH071-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH071-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH071-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH071-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH071-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH071-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH071-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH071-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH071-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH071-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH071-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH071-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH071-PRTREC    FROM  PH07-LINE26 AFTER 6.                    
            WRITE PH071-PRTREC    FROM  PH07-LINE13 AFTER 18.                   
            ADD   1               TO    WS-PH071-WRT-CTR.                       
                                                                                
       7039-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7040-PRT-LTR8F.                                                          
      *=============================================================            
                                                                                
            MOVE '8F'               TO  LH07-LTR-TYPE.                          
            MOVE WS-DTE-DEBAR-FT-HH TO PH07-DTE-BK-APPT-27.                     
                                                                                
            MOVE  SPACES            TO  PH072-PRTREC.                           
            WRITE PH072-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH072-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH072-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH072-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH072-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH072-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH072-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH072-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH072-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH072-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH072-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH072-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH072-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH072-PRTREC    FROM  PH07-LINE27 AFTER 3.                    
            WRITE PH072-PRTREC    FROM  PH07-LINE13 AFTER 19.                   
            ADD   1               TO    WS-PH072-WRT-CTR.                       
                                                                                
       7040-EXIT.                                                               
           EXIT.                                                                
                                                                                
      * FTS LETTERS                                                             
      *=============================================================            
       7041-PRT-LTR8S.                                                          
      *=============================================================            
                                                                                
            MOVE '8S'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A5-PRTREC.                           
            WRITE PH7A5-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A5-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A5-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A5-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A5-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A5-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A5-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A5-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A5-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A5-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A5-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A5-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A5-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH7A5-PRTREC    FROM  PH07-LINE13 AFTER 24.                   
            ADD   1               TO    WS-PH7A5-WRT-CTR.                       
                                                                                
       7041-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7042-PRT-LTR8T.                                                          
      *=============================================================            
                                                                                
            MOVE '8T'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A6-PRTREC.                           
            WRITE PH7A6-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A6-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A6-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A6-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A6-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A6-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A6-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A6-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A6-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A6-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A6-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A6-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A6-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH7A6-PRTREC    FROM  PH07-LINE13 AFTER 24.                   
            ADD   1               TO    WS-PH7A6-WRT-CTR.                       
                                                                                
       7042-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7043-PRT-LTR8U.                                                          
      *=============================================================            
                                                                                
            MOVE '8U'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A7-PRTREC.                           
            WRITE PH7A7-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A7-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A7-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A7-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A7-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A7-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A7-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A7-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A7-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A7-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A7-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A7-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A7-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH7A7-PRTREC    FROM  PH07-LINE13 AFTER 22.                   
            ADD   1               TO    WS-PH7A7-WRT-CTR.                       
                                                                                
       7043-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7044-PRT-LTR8V.                                                          
      *=============================================================            
                                                                                
            MOVE '8V'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A8-PRTREC.                           
            WRITE PH7A8-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A8-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A8-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A8-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A8-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A8-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A8-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A8-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A8-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A8-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A8-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A8-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A8-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH7A8-PRTREC    FROM  PH07-LINE13 AFTER 22.                   
            ADD   1               TO    WS-PH7A8-WRT-CTR.                       
                                                                                
       7044-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7045-PRT-LTR8W.                                                          
      *=============================================================            
                                                                                
            MOVE '8W'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7A9-PRTREC.                           
            WRITE PH7A9-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A9-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A9-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A9-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A9-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A9-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A9-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A9-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A9-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A9-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A9-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A9-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A9-PRTREC    FROM  PH07-LINE12C.                           
            WRITE PH7A9-PRTREC    FROM  PH07-LINE25 AFTER 5.                    
            WRITE PH7A9-PRTREC    FROM  PH07-LINE21 AFTER 4.                    
            WRITE PH7A9-PRTREC    FROM  PH07-LINE13 AFTER 15.                   
            ADD   1               TO    WS-PH7A9-WRT-CTR.                       
                                                                                
       7045-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7046-PRT-LTR8X.                                                          
      *=============================================================            
                                                                                
            MOVE '8X'               TO  LH07-LTR-TYPE.                          
            MOVE WS-DTE-DEBAR-FTS   TO PH07-DTE-BK-APPT-24.                     
                                                                                
            MOVE  SPACES            TO  PH070-PRTREC.                           
            WRITE PH7A0-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7A0-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7A0-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7A0-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7A0-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7A0-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7A0-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7A0-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7A0-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7A0-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7A0-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7A0-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7A0-PRTREC    FROM  PH07-LINE15C AFTER 3.                   
            WRITE PH7A0-PRTREC    FROM  PH07-LINE24 AFTER 5.                    
            WRITE PH7A0-PRTREC    FROM  PH07-LINE21 AFTER 4.                    
            WRITE PH7A0-PRTREC    FROM  PH07-LINE13 AFTER 13.                   
            ADD   1               TO    WS-PH7A0-WRT-CTR.                       
                                                                                
       7046-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7047-PRT-LTR1S.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1S'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7B1-PRTREC.                           
            WRITE PH7B1-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7B1-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7B1-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7B1-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH7B1-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH7B1-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH7B1-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH7B1-WRT-CTR.                       
                                                                                
       7047-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7048-PRT-LTR1R.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE '1R'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7B2-PRTREC.                           
            WRITE PH7B2-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7B2-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7B2-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7B2-PRTREC    FROM  PH07-LINE09A AFTER 6.                   
            WRITE PH7B2-PRTREC    FROM  PH07-LINE09.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE10E AFTER 3.                   
            WRITE PH7B2-PRTREC    FROM  PH07-LINE11.                            
            WRITE PH7B2-PRTREC    FROM  PH07-LINE13 AFTER 21.                   
            ADD   1               TO    WS-PH7B2-WRT-CTR.                       
                                                                                
       7048-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7049-PRT-LTRMD.                                                          
      *=============================================================            
                                                                                
            MOVE 'MD'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7B3-PRTREC.                           
            WRITE PH7B3-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7B3-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7B3-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7B3-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7B3-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7B3-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7B3-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7B3-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7B3-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7B3-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
      *     WRITE PH7B3-PRTREC    FROM  PH07-LINE10C AFTER 4.                   
            WRITE PH7B3-PRTREC    FROM  PH07-LINE10  AFTER 2.                   
            WRITE PH7B3-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7B3-PRTREC    FROM  PH07-LINE12E AFTER 3.                   
            WRITE PH7B3-PRTREC    FROM  PH07-LINE13 AFTER 25.                   
            ADD   1               TO    WS-PH7B3-WRT-CTR.                       
                                                                                
       7049-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7050-PRT-LTRME.                                                          
      *=============================================================            
                                                                                
            MOVE 'ME'               TO  LH07-LTR-TYPE.                          
                                                                                
            MOVE  SPACES            TO  PH7B4-PRTREC.                           
            WRITE PH7B4-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE PH7B4-PRTREC    FROM  PH07-LINE01.                            
            WRITE PH7B4-PRTREC    FROM  PH07-LINE02.                            
            WRITE PH7B4-PRTREC    FROM  PH07-LINE03 AFTER 5.                    
            WRITE PH7B4-PRTREC    FROM  PH07-LINE04.                            
            WRITE PH7B4-PRTREC    FROM  PH07-LINE05.                            
            WRITE PH7B4-PRTREC    FROM  PH07-LINE06.                            
            WRITE PH7B4-PRTREC    FROM  PH07-LINE07.                            
            WRITE PH7B4-PRTREC    FROM  PH07-LINE08 AFTER 3.                    
            WRITE PH7B4-PRTREC    FROM  PH07-LINE09B AFTER 6.                   
            WRITE PH7B4-PRTREC    FROM  PH07-LINE10F AFTER 2.                   
            WRITE PH7B4-PRTREC    FROM  PH07-LINE11C.                           
            WRITE PH7B4-PRTREC    FROM  PH07-LINE15C AFTER 4.                   
            WRITE PH7B4-PRTREC    FROM  PH07-LINE13 AFTER 24.                   
            ADD   1               TO    WS-PH7B4-WRT-CTR.                       
                                                                                
       7050-EXIT.                                                               
           EXIT.                                                                
      *=============================================================            
       8000-PRN-CNTRL-LIST.                                                     
      *=============================================================            
                                                                                
           ADD 1                          TO WS-CNT-CUR-LINE                    
           ADD 1                          TO WS-CNT-LINE-LH07.                  
                                                                                
           IF WS-CNT-CUR-LINE > 58                                              
              PERFORM 8100-WRITE-HEADER THRU 8100-EXIT                          
              ADD 1                       TO WS-CNT-CUR-LINE                    
           END-IF                                                               
                                                                                
           MOVE WS-CNT-LINE-LH07          TO LH07-SN                            
           MOVE F800-NUM-REGN             TO LH07-REGN                          
           MOVE F800-NUM-SCH-ACC          TO LH07-HDB-REF                       
           MOVE F800-NUM-ALLO-SCHEME      TO LH07-ALLO-SCH                      
           MOVE F800-NUM-ZONE             TO LH07-ZONE                          
           MOVE F800-NUM-NEW-TOWN         TO LH07-NT                            
           MOVE F800-NUM-FLAT-TYPE        TO LH07-FT                            
           MOVE F800-NUM-CAT              TO LH07-CAT                           
           IF F800-DTE-BK-APPT = 'NOINVITE'                                     
              MOVE SPACES                 TO LH07-DTE-BK                        
           ELSE                                                                 
              MOVE F800-DTE-BK-APPT       TO LH07-DTE-BK                        
           END-IF                                                               
           MOVE F800-NUM-NT-FT-QUEUE      TO LH07-QUEUE                         
           MOVE F800-NUM-ALLO-CAT         TO LH07-ALLO-CAT                      
           MOVE F800-NUM-ALLOC-TAG        TO LH07-ALLOC-TAG                     
           IF F800-NUM-ALLO-CAT = 'BTO'                                         
              MOVE WS-NUM-MATURE          TO LH07-NUM-MATURE                    
           ELSE                                                                 
              MOVE SPACES                 TO LH07-NUM-MATURE                    
           END-IF                                                               
           MOVE F800-NUM-ALLOC-TAG-PREV   TO LH07-ALLOC-TAG-PREV                
           MOVE F800-NUM-NRIC1            TO LH07-NRIC1                         
           MOVE F800-NUM-NRIC2            TO LH07-NRIC2                         
                                                                                
           WRITE LH07-PRTREC FROM LH07-DTL.                                     
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       8100-WRITE-HEADER.                                                       
      **************************************************************            
                                                                                
           IF WS-CNT-PAGE-LH07 NOT = 0                                          
              WRITE LH07-PRTREC FROM LH07-FOOTER AFTER 2                        
           END-IF.                                                              
                                                                                
           ADD 1                          TO WS-CNT-PAGE-LH07                   
           MOVE WS-CNT-PAGE-LH07          TO LH07-PAGE                          
           WRITE LH07-PRTREC FROM LH07-HDG1 AFTER PAGE                          
           WRITE LH07-PRTREC FROM LH07-HDG2 AFTER 2                             
           WRITE LH07-PRTREC FROM LH07-HDG3 AFTER 3                             
           MOVE 6                         TO WS-CNT-CUR-LINE.                   
                                                                                
       8100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       8200-WRITE-FOOTER.                                                       
      **************************************************************            
                                                                                
           COMPUTE WS-CNT = 60 - WS-CNT-CUR-LINE.                               
           WRITE LH07-PRTREC FROM LH07-FOOTER AFTER WS-CNT.                     
                                                                                
       8200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       8300-CHECK-WEEKDAY.                                                      
      **************************************************************            
                                                                                
           MOVE 'DW'                          TO WS-IN-OPTION                   
           MOVE WS-CURR-DATE                  TO WS-IN-DATE                     
                                                                                
           CALL 'AV02C001' USING LINK-REC.                                      
                                                                                
       8300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       8400-CHECK-HOLIDAY.                                                      
      **************************************************************            
                                                                                
           MOVE WS-CURR-DATE            TO WS-IN-DATE.                          
           MOVE 'HD'                    TO WS-IN-OPTION.                        
                                                                                
           CALL 'AV02C002'  USING LINK-REC.                                     
                                                                                
           IF WS-RETURN = 'EOP' OR 'EID' OR 'EIF' OR 'EIR'                      
              DISPLAY 'ERROR IN READING HOLIDAY FILE, RETURN CODE IS '          
                      WS-RETURN                                                 
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
       8400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13CH07 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F800 RECORDS READ          : ' WS-F800-READ-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I0     : ' WS-PH07A-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I1     : ' WS-PH07B-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I2     : ' WS-PH07C-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I3     : ' WS-PH07D-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I4     : ' WS-PH07E-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I5     : ' WS-PH07F-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I6     : ' WS-PH07G-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I7     : ' WS-PH07H-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13IT     : ' WS-PH07I-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13IU     : ' WS-PH07J-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13IV     : ' WS-PH07K-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13IW     : ' WS-PH07L-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13IX     : ' WS-PH07M-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131B     : ' WS-PH07N-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131C     : ' WS-PH07O-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131D     : ' WS-PH07P-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131E     : ' WS-PH07Q-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131F     : ' WS-PH07R-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131G     : ' WS-PH07S-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131J     : ' WS-PH07T-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131K     : ' WS-PH07U-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I9     : ' WS-PH07V-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138A     : ' WS-PH07W-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138B     : ' WS-PH07X-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138C     : ' WS-PH07Y-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138D     : ' WS-PH07Z-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138E     : ' WS-PH071-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138F     : ' WS-PH072-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138G     : ' WS-PH073-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138H     : ' WS-PH074-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138I     : ' WS-PH075-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138J     : ' WS-PH076-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138K     : ' WS-PH077-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138L     : ' WS-PH078-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138M     : ' WS-PH079-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138N     : ' WS-PH070-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138O     : ' WS-PH7A1-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138P     : ' WS-PH7A2-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138Q     : ' WS-PH7A3-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138R     : ' WS-PH7A4-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138S     : ' WS-PH7A5-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138T     : ' WS-PH7A6-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138U     : ' WS-PH7A7-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138V     : ' WS-PH7A8-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138W     : ' WS-PH7A9-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP138X     : ' WS-PH7A0-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131R     : ' WS-PH7B1-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP131S     : ' WS-PH7B2-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13MD     : ' WS-PH7B3-WRT-CTR.           
           DISPLAY ' NO OF CASES FOR BP13ME     : ' WS-PH7B4-WRT-CTR.           
           DISPLAY ' NO OF CASES WITH NO LETTER : ' WS-CNT-NOLTR.               
           DISPLAY ' NO OF NOT SUCCESSFUL CASES : ' WS-SKIP1.                   
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13F800                                                       
                 BP13K060                                                       
                 SY02F001                                                       
                 BP13KH15                                                       
                 BP13KH10                                                       
                 BP13K813                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13K022                                                       
                 BP13K024                                                       
                 BP13K246                                                       
                 P13PH07A                                                       
                 P13PH07B                                                       
                 P13PH07C                                                       
                 P13PH07D                                                       
                 P13PH07E                                                       
                 P13PH07F                                                       
                 P13PH07G                                                       
                 P13PH07H                                                       
                 P13PH07I                                                       
                 P13PH07J                                                       
                 P13PH07K                                                       
                 P13PH07L                                                       
                 P13PH07M                                                       
                 P13PH07N                                                       
                 P13PH07O                                                       
                 P13PH07P                                                       
                 P13PH07Q                                                       
                 P13PH07R                                                       
                 P13PH07S                                                       
                 P13PH07T                                                       
                 P13PH07U                                                       
                 P13PH07V                                                       
                 P13PH07W                                                       
                 P13PH07X                                                       
                 P13PH07Y                                                       
                 P13PH07Z                                                       
                 P13PH071                                                       
                 P13PH072                                                       
                 P13PH073                                                       
                 P13PH074                                                       
                 P13PH075                                                       
                 P13PH076                                                       
                 P13PH077                                                       
                 P13PH078                                                       
                 P13PH079                                                       
                 P13PH070                                                       
                 P13PH7A1                                                       
                 P13PH7A2                                                       
                 P13PH7A3                                                       
                 P13PH7A4                                                       
                 P13PH7A5                                                       
                 P13PH7A6                                                       
                 P13PH7A7                                                       
                 P13PH7A8                                                       
                 P13PH7A9                                                       
                 P13PH7A0                                                       
                 P13PH7B1                                                       
                 P13PH7B2                                                       
                 P13PH7B3                                                       
                 P13PH7B4                                                       
                 BP13LH07.                                                      
                                                                                
           IF WS-KH15-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13KH15-STAT ' WS-KH15-STATUS.            
                                                                                
           IF WS-KH10-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13KH10-STAT ' WS-KH10-STATUS.            
                                                                                
           IF WS-K060-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K060-STAT ' WS-K060-STATUS.            
                                                                                
           IF WS-K246-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K246-STAT ' WS-K246-STATUS.            
                                                                                
           IF WS-K813-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K813-STAT ' WS-K813-STATUS.            
                                                                                
           IF WS-K820-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K820-STAT ' WS-K820-STATUS.            
                                                                                
           IF WS-K830-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS.            
                                                                                
           IF WS-K022-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K022-STAT ' WS-K022-STATUS.            
                                                                                
           IF WS-K024-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K024-STAT ' WS-K024-STATUS.            
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
