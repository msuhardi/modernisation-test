      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
                                                                                
       PROGRAM-ID.    BP13C262.                                                 
       AUTHOR.        MARIA THERESA R. SANTOS.                                  
       DATE-WRITTEN.  22/05/95.                                                 
      *================================================================*        
      *                                                                *        
      *   SYSTEM NAME :  SYSTEM OF COMMITMENT   (SOC)                  *        
      *                                                                *        
      *   SYSTEM ID   :  BP13                                          *        
      *                                                                *        
      *   OBJECTIVE   :  1.  THIS IS THE PROGRAM TO PRINT LIST OF      *        
      *                      UPDATED ECD/OCS DUE DATE/INTERNAL DOORS   *        
      *                                                                *        
      *   INPUT FILES :  1.  BM06K100                                  *        
      *                  2.  BM06F190                                  *        
      *                  3.  BM06K510                                  *        
      *                  4.  BB14K500                                  *        
      *                  5.  BP13K277                                  *        
      *                                                                *        
      *   LISTINGS    :  1.  P13L262A                                  *        
      *                                                                *        
      *   CHGE-NO   DATE   BY   DESCRIPTION                            *        
      *   -------  ------  ---  -------------------------------------  *        
      *   C9504B6  220595  MTS  OCS (CREATED)                          *        
      *   BP130055 250396  EVM  GET DOOR AND COST OF DOOR FROM K275    *        
      *   BP130418 030398  SIA  CHANGED BM06F900 TO BM06F190  &        *        
      *                         CHANGED BM06K210 TO BM06K100  &        *        
      *   BP130781 29121999 GBR TO GET 2,3 ROOM DOOR AND COST FROM K275*        
      *   BP13XXXX 17102012 PCL TO UPDATE REC LENGTH OF BP13K275       *        
      *   BP135127 08112013 ESA1TO REPLACE BP13K277 WITH BP13K277      *        
      *   BP135177 20122013 ESA1TO CATER FOR OCS LAYOUT                *        
      *================================================================*        
                                                                                
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BM06K100  ASSIGN        TO BM06K100                           
                  ORGANIZATION   INDEXED                                        
                  ACCESS         RANDOM                                         
                  RECORD KEY     K100-KEY-FLD                                   
                  FILE STATUS    K100-FSTAT.                                    
           SELECT BM06K510  ASSIGN        TO BM06K510                           
                  ORGANIZATION   INDEXED                                        
                  ACCESS         RANDOM                                         
                  RECORD KEY     K510-ESTCDE                                    
                  FILE STATUS    K510-FSTAT.                                    
           SELECT BB14K500  ASSIGN        TO BB14K500                           
                  ORGANIZATION   INDEXED                                        
                  ACCESS         RANDOM                                         
                  RECORD KEY     K500-CDE-BLK                                   
                  FILE STATUS    K500-FSTAT.                                    
           SELECT BP13K277  ASSIGN        TO BP13K277                           
                  ORGANIZATION   INDEXED                                        
                  ACCESS         RANDOM                                         
                  RECORD KEY     K277-KEY-FLD                                   
                  FILE STATUS    K277-FSTAT.                                    
           SELECT BM06F190  ASSIGN        TO BM06F190.                          
           SELECT P13L262A  ASSIGN        TO P13L262A.                          
                                                                                
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K510                                                            
            RECORD CONTAINS 60 CHARACTERS.                                      
       COPY BM06K510.                                                           
                                                                                
       FD   BB14K500                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BB14K500.                                                           
                                                                                
       FD   BP13K277                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K277.                                                           
                                                                                
       FD   BM06F190                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS  STANDARD                                             
            RECORD CONTAINS 650 CHARACTERS.                                     
       COPY BM06F190.                                                           
                                                                                
       FD   P13L262A                                                            
            RECORD CONTAINS 132 CHARACTERS.                                     
                                                                                
       01   PRINT-REC                  PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-EOF-F190                      PIC X(1)  VALUE 'N'.            
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-PAGE-CNT                      PIC 9(4)  VALUE ZEROES.         
           05  WS-REC-CNT                       PIC 9(8)  VALUE ZEROES.         
           05  WS-READ-F190-CNT                 PIC 9(5)  VALUE ZEROES.         
                                                                                
       01  WS-CURR-DATE                         PIC X(8).                       
                                                                                
       01  WS-PRT-DATE.                                                         
           05  WS-PRT-CC                        PIC XX.                         
           05  WS-PRT-YY                        PIC XX.                         
           05  WS-PRT-MM                        PIC XX.                         
           05  WS-PRT-DD                        PIC XX.                         
                                                                                
       01  WS-DATE-VARS.                                                        
                                                                                
           05  WS-COMP-DATE.                                                    
               10  WS-CC                        PIC XX.                         
               10  WS-YY                        PIC XX.                         
               10  WS-MM                        PIC XX.                         
               10  WS-DD                        PIC XX.                         
                                                                                
       01  WS-MISC.                                                             
           05  F190-FSTAT                       PIC X(2).                       
           05  K100-FSTAT                       PIC X(2).                       
           05  K510-FSTAT                       PIC X(2).                       
           05  K500-FSTAT                       PIC X(2).                       
           05  K277-FSTAT                       PIC X(2).                       
           05  WS-SERNO                         PIC 9(4)  VALUE 0.              
                                                                                
      *----------------------------------------------------------------*        
      *   COMMON HEADER USE FOR BOTH REPORTS                           *        
      *----------------------------------------------------------------*        
       01  L262-HDG1.                                                           
           05  PRT-REPORT-TITLE         PIC X(9)  VALUE 'BP13L262'.             
           05  FILLER                   PIC X(37) VALUE SPACES.                 
           05  FILLER                   PIC X(40) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE :'.               
           05  PRT-DATE                 PIC X(10).                              
                                                                                
       01  L262-HDG2.                                                           
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  FILLER                   PIC X(41) VALUE                         
               'UPDATED ECD/OCS DUE DATE/INTERNAL DOORS'.                       
           05  FILLER                   PIC X(26) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'PAGE : '.              
           05  PRT-PAGE                 PIC ZZZ9.                               
                                                                                
       01  L262-HDG4.                                                           
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(43) VALUE                         
               '                        '.                                      
           05  FILLER                   PIC X(37) VALUE                         
               '                                     '.                         
           05  FILLER                   PIC X(40) VALUE                         
               'FLAT   INTERNAL       COST OF           '.                      
                                                                                
       01  L262-HDG5.                                                           
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(43) VALUE                         
               'ESTATE                     /NHOOD/CONT    '.                    
           05  FILLER                   PIC X(37) VALUE                         
               'BLK NO     ECD        OCS DUE DATE   '.                         
           05  FILLER                   PIC X(40) VALUE                         
               'TYPE    DOORS      INTERNAL DOORS       '.                      
                                                                                
       01  L262-HDG6.                                                           
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(43) VALUE                         
               '______________________________________     '.                   
                                                                                
           05  FILLER                   PIC X(37) VALUE                         
               '______   ________     ____________   '.                         
                                                                                
           05  FILLER                   PIC X(40) VALUE                         
               '____   ________    ______________       '.                      
                                                                                
      *----------------------------------------------------------------*        
      *    05  FILLER                   PIC X(24) VALUE                         
      *        '                        '.                                      
      *        'EST                        /NHOOD/CONT                          
      *        '______________________________________     '.                   
      *        'XXXXXXXXXXXXXXXXXXXXXXXXXXX/XXXXX/XXXX     '.                   
      *        'XXXXXXXX                '.                                      
      *                                                                         
      *    05  FILLER                   PIC X(37) VALUE                         
      *        '                                     '.                         
      *        'BLK NO     ECD        OCS DUE DATE   '.                         
      *        '______     ___        ____________   '.                         
      *        ' XXXX    DD/MM/YY       DD/MM/YY     '.                         
      *                                                                         
      *    05  FILLER                   PIC X(40) VALUE                         
      *        '                       COST OF          '.                      
      *        'INTERNAL DOORS      INTERNAL DOORS      '.                      
      *        '______________      ______________      '.                      
      *        '     XX             $   XXXXXXXXXX      '.                      
      *----------------------------------------------------------------*        
      *   DETAIL RECORD                                                *        
      *----------------------------------------------------------------*        
       01  L262-DTL1.                                                           
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  PRT-ESTATE               PIC X(27).                              
           05  PRT-NHOOD-S              PIC X(1).                               
           05  PRT-NHOOD                PIC X(5).                               
           05  PRT-CONT-S               PIC X(1).                               
           05  PRT-CONT                 PIC X(4).                               
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  PRT-BLK                  PIC X(5).                               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  PRT-ECD                  PIC X(10).                              
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  PRT-ODD                  PIC X(10).                              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  PRT-FT                   PIC X(4).                               
           05  FILLER                   PIC X(6) VALUE SPACES.                  
           05  PRT-ID                   PIC X(2).                               
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  PRT-DOLLAR               PIC X(1).                               
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  PRT-CID                  PIC ZZ,ZZZ,ZZ9.                         
           05  PRT-CID-R REDEFINES PRT-CID.                                     
              10  PRT-CID-X             PIC X(10).                              
                                                                                
       01  L262-DTL2.                                                           
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  PRT-ESTATE2              PIC X(9).                               
                                                                                
      *----------------------------------------------------------------*        
      *    05  FILLER                   PIC X(37) VALUE                         
      *        'ECD & OCS DUE DATE                   '.                         
      *        '------------------                   '.                         
      *        '                                     '.                         
      *        'UPDATED BY HCO : __________          '.                         
      *        'CHECKED BY SCO : __________          '.                         
      *        '                                     '.                         
      *    05  FILLER                   PIC X(37) VALUE                         
      *        'INTERNAL DOORS/COST                  '.                         
      *        'OF INTERNAL DOORS                    '.                         
      *        '_________________                    '.                         
      *        'UPDATED BY HCO : __________          '.                         
      *        'CHECKED BY                           '.                         
      *        'TEAM HEAD      : __________          '.                         
      *----------------------------------------------------------------*        
                                                                                
       01  L262-FTR1.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               'ECD & OCS DUE DATE                   '.                         
           05  FILLER                   PIC X(37) VALUE                         
               'INTERNAL DOORS/COST                  '.                         
                                                                                
       01  L262-FTR2.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               '__________________                   '.                         
           05  FILLER                   PIC X(37) VALUE                         
               'OF INTERNAL DOORS                    '.                         
                                                                                
       01  L262-FTR3.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               '                                     '.                         
           05  FILLER                   PIC X(37) VALUE                         
               '_________________                    '.                         
                                                                                
       01  L262-FTR4.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               'UPDATED BY HCO : __________          '.                         
           05  FILLER                   PIC X(37) VALUE                         
               'UPDATED BY EO  : __________          '.                         
                                                                                
       01  L262-FTR5.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               'CHECKED BY SCO : __________          '.                         
           05  FILLER                   PIC X(37) VALUE                         
               'CHECKED BY                           '.                         
                                                                                
       01  L262-FTR6.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               '                                     '.                         
           05  FILLER                   PIC X(37) VALUE                         
               'TEAM HEAD      : __________          '.                         
                                                                                
       01  L262-FTR7.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               '                              NOTE : '.                         
           05  FILLER                   PIC X(37) VALUE                         
               'COPY OF THE SALES BROCHURES          '.                         
                                                                                
       01  L262-FTR8.                                                           
           05  FILLER                   PIC X(60) VALUE  SPACES.                
           05  FILLER                   PIC X(37) VALUE                         
               '                                     '.                         
           05  FILLER                   PIC X(37) VALUE                         
               'SPECIFICATION ATTACHED               '.                         
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      **********************                                                    
                                                                                
      ******************************************************************        
       000-MAIN.                                                                
      ******************************************************************        
                                                                                
           PERFORM   100-OPEN-ROUTINE      THRU    100-EXIT.                    
                                                                                
           PERFORM   200-READ-F190         THRU    200-EXIT.                    
                                                                                
           PERFORM   300-PROCESS-F190      THRU    300-EXIT                     
                         UNTIL WS-EOF-F190 = 'Y'.                               
                                                                                
           PERFORM   999-CLOSE-ROUTINE     THRU    999-EXIT.                    
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       100-OPEN-ROUTINE.                                                        
      ******************************************************************        
                                                                                
           OPEN INPUT BM06F190                                                  
                      BM06K100                                                  
                      BM06K510                                                  
                      BB14K500                                                  
                      BP13K277                                                  
               OUTPUT P13L262A.                                                 
                                                                                
           IF K100-FSTAT NOT = '00' AND '97'                                    
              MOVE K100-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BM06K100 OPEN ERROR : ' K100-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE   THRU  999-EXIT.                       
                                                                                
           IF K510-FSTAT NOT = '00' AND '97'                                    
              MOVE K510-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BM06K510 OPEN ERROR : ' K510-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE   THRU  999-EXIT.                       
                                                                                
           IF K500-FSTAT NOT = '00' AND '97'                                    
              MOVE K500-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BB14K500 OPEN ERROR : ' K500-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE   THRU  999-EXIT.                       
                                                                                
           IF K277-FSTAT NOT = '00' AND '97'                                    
              MOVE K277-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BP13K277 OPEN ERROR : ' K277-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE   THRU  999-EXIT.                       
                                                                                
           MOVE ZEROES TO  WS-COUNTERS.                                         
           MOVE 50     TO  WS-REC-CNT                                           
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURR-DATE.                          
                                                                                
           STRING WS-CURR-DATE (7:2) '/'                                        
                  WS-CURR-DATE (5:2) '/'                                        
                  WS-CURR-DATE (1:4)                                            
                  DELIMITED BY SIZE   INTO     PRT-DATE.                        
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       200-READ-F190.                                                           
      ******************************************************************        
                                                                                
           READ BM06F190                                                        
                AT END MOVE 'Y'  TO  WS-EOF-F190                                
                       GO TO 200-EXIT.                                          
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       300-PROCESS-F190.                                                        
      ******************************************************************        
                                                                                
           ADD 1 TO WS-READ-F190-CNT.                                           
                                                                                
           PERFORM 400-PRINT-P13L262A THRU 400-EXIT.                            
                                                                                
           PERFORM 200-READ-F190 THRU 200-EXIT.                                 
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       400-PRINT-P13L262A.                                                      
      ******************************************************************        
                                                                                
           IF WS-REC-CNT > 40                                                   
              PERFORM 500-PRINT-HEADER  THRU  500-EXIT.                         
                                                                                
           PERFORM 600-READ-BM06K100   THRU  600-EXIT                           
                                                                                
           IF K100-FSTAT = '00'                                                 
              CONTINUE                                                          
           ELSE                                                                 
           IF K100-FSTAT = '23'                                                 
              DISPLAY 'BP13K100 RECORD NOT FOUND FOR : ' K100-KEY-FLD           
              GO TO 400-EXIT                                                    
           ELSE                                                                 
              MOVE K100-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BM06K100 READ ERROR : ' K100-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT.                          
                                                                                
           MOVE   SPACES                TO     PRINT-REC.                       
                                                                                
           PERFORM 700-READ-BM06K510   THRU  700-EXIT                           
                                                                                
           IF K510-FSTAT = '00'                                                 
              MOVE K510-ESTATE-NAME TO PRT-ESTATE                               
           ELSE                                                                 
           IF K510-FSTAT = '23'                                                 
              DISPLAY 'BM06K510 RECORD NOT FOUND FOR : ' K510-ESTCDE            
              MOVE SPACES TO PRT-ESTATE                                         
           ELSE                                                                 
              MOVE K510-FSTAT TO RETURN-CODE                                    
              MOVE SPACES TO PRT-ESTATE                                         
              DISPLAY 'BM06K510 READ ERROR : ' K510-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT.                          
                                                                                
           MOVE   '/'                   TO     PRT-NHOOD-S                      
                                               PRT-CONT-S.                      
           MOVE   K100-NEIGHBOURHOOD    TO     PRT-NHOOD.                       
           MOVE   K100-CONTRACT-NO      TO     PRT-CONT.                        
           MOVE   K100-BLK-NO           TO     PRT-BLK.                         
                                                                                
           MOVE   K100-CDE-BLK          TO     K500-CDE-BLK.                    
           READ  BB14K500.                                                      
                                                                                
           IF K500-FSTAT = '00'                                                 
              MOVE K500-DTE-BLDG-COMPLETE TO  WS-COMP-DATE                      
              STRING WS-DD     '/'                                              
                     WS-MM     '/'                                              
                     WS-CC                                                      
                     WS-YY                                                      
              DELIMITED BY SIZE                                                 
              INTO   PRT-ECD                                                    
           ELSE                                                                 
           IF K500-FSTAT = '23'                                                 
              DISPLAY 'BB14K500 RECORD NOT FOUND FOR : ' K500-CDE-BLK           
              MOVE SPACES               TO     PRT-ECD                          
           ELSE                                                                 
              MOVE K500-FSTAT TO RETURN-CODE                                    
              MOVE SPACES TO PRT-ECD                                            
              DISPLAY 'BB14K500 READ ERROR : ' K500-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT.                          
                                                                                
           MOVE   K100-DTE-OCS-DUE      TO WS-PRT-DATE.                         
                                                                                
           IF K100-DTE-OCS-DUE = ZEROES OR SPACES OR LOW-VALUES                 
              MOVE '00/00/0000'           TO PRT-ODD                            
           ELSE                                                                 
              STRING WS-PRT-DD '/'                                              
                     WS-PRT-MM '/'                                              
                     WS-PRT-CC                                                  
                     WS-PRT-YY                                                  
              DELIMITED BY SIZE                                                 
              INTO   PRT-ODD.                                                   
                                                                                
           MOVE SPACES                      TO K277-KEY-FLD.                    
           MOVE K100-KEY-FLD                TO K277-KEY-FLD.                    
           MOVE F190-NUM-FEATURE            TO K277-NUM-FEATURE.                
           MOVE F190-NUM-LAYOUT             TO K277-NUM-LAYOUT.                 
           PERFORM 450-READ-K277            THRU 450-EXIT.                      
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       450-READ-K277.                                                           
      ******************************************************************        
           READ BP13K277.                                                       
           EVALUATE K277-FSTAT                                                  
           WHEN '00'                                                            
                 PERFORM 460-MOVE-K277       THRU 460-EXIT                      
           WHEN '23'                                                            
                 MOVE SPACES   TO PRT-ID PRT-CID-X PRT-FT PRT-DOLLAR            
                 WRITE  PRINT-REC            FROM L262-DTL1 AFTER 1             
                 ADD    1                    TO WS-REC-CNT                      
           WHEN OTHER                                                           
              MOVE K277-FSTAT TO RETURN-CODE                                    
              MOVE SPACES TO PRT-ECD                                            
              DISPLAY 'BP13K277 READ ERROR : ' K277-FSTAT                       
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-EVALUATE.                                                        
                                                                                
       450-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       460-MOVE-K277.                                                           
      ******************************************************************        
           IF WS-REC-CNT > 40                                                   
              PERFORM 500-PRINT-HEADER    THRU 500-EXIT.                        
                                                                                
           IF K277-NUM-DOOR-2RM NOT = SPACES AND LOW-VALUES                     
              MOVE '2 RM'                 TO PRT-FT                             
              MOVE K277-NUM-DOOR-2RM      TO PRT-ID                             
              MOVE '$'                    TO PRT-DOLLAR                         
              MOVE K277-AMT-COST-2RM      TO PRT-CID                            
              WRITE  PRINT-REC            FROM L262-DTL1 AFTER 1                
              ADD    1                    TO WS-REC-CNT.                        
                                                                                
           IF K277-NUM-DOOR-3RM NOT = SPACES AND LOW-VALUES                     
              IF K277-NUM-DOOR-2RM NOT = SPACES AND LOW-VALUES                  
                 MOVE SPACES                 TO L262-DTL1                       
              END-IF                                                            
              MOVE '3 RM'                 TO PRT-FT                             
              MOVE K277-NUM-DOOR-3RM      TO PRT-ID                             
              MOVE '$'                    TO PRT-DOLLAR                         
              MOVE K277-AMT-COST-3RM      TO PRT-CID                            
              WRITE  PRINT-REC            FROM L262-DTL1 AFTER 1                
              ADD    1                    TO WS-REC-CNT.                        
                                                                                
           IF K277-NUM-DOOR-4RM NOT = SPACES AND LOW-VALUES                     
              IF (K277-NUM-DOOR-2RM NOT = SPACES AND LOW-VALUES) OR             
                 (K277-NUM-DOOR-3RM NOT = SPACES AND LOW-VALUES)                
                 MOVE SPACES                 TO L262-DTL1                       
              END-IF                                                            
              MOVE '4 RM'                 TO PRT-FT                             
              MOVE K277-NUM-DOOR-4RM      TO PRT-ID                             
              MOVE '$'                    TO PRT-DOLLAR                         
              MOVE K277-AMT-COST-4RM      TO PRT-CID                            
              WRITE  PRINT-REC            FROM L262-DTL1 AFTER 1                
              ADD    1                    TO WS-REC-CNT.                        
                                                                                
           IF K277-NUM-DOOR-5RM NOT = SPACES AND LOW-VALUES                     
              IF (K277-NUM-DOOR-2RM NOT = SPACES AND LOW-VALUES) OR             
                 (K277-NUM-DOOR-3RM NOT = SPACES AND LOW-VALUES) OR             
                 (K277-NUM-DOOR-4RM NOT = SPACES AND LOW-VALUES)                
                 MOVE SPACES                 TO L262-DTL1                       
              END-IF                                                            
              MOVE '5 RM'                 TO PRT-FT                             
              MOVE K277-NUM-DOOR-5RM      TO PRT-ID                             
              MOVE '$'                    TO PRT-DOLLAR                         
              MOVE K277-AMT-COST-5RM      TO PRT-CID                            
              WRITE  PRINT-REC            FROM L262-DTL1 AFTER 1                
              ADD    1                    TO WS-REC-CNT.                        
                                                                                
           IF K277-NUM-DOOR-EXEC NOT = SPACES AND LOW-VALUES                    
              IF (K277-NUM-DOOR-2RM NOT = SPACES AND LOW-VALUES) OR             
                 (K277-NUM-DOOR-3RM NOT = SPACES AND LOW-VALUES) OR             
                 (K277-NUM-DOOR-4RM NOT = SPACES AND LOW-VALUES) OR             
                 (K277-NUM-DOOR-5RM NOT = SPACES AND LOW-VALUES)                
                  MOVE SPACES                 TO L262-DTL1                      
              END-IF                                                            
              MOVE 'EXEC'                 TO PRT-FT                             
              MOVE K277-NUM-DOOR-EXEC     TO PRT-ID                             
              MOVE '$'                    TO PRT-DOLLAR                         
              MOVE K277-AMT-COST-EXEC     TO PRT-CID                            
              WRITE  PRINT-REC            FROM L262-DTL1 AFTER 1                
              ADD    1                    TO WS-REC-CNT.                        
                                                                                
       460-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       500-PRINT-HEADER.                                                        
      ******************************************************************        
                                                                                
           ADD    1           TO   WS-PAGE-CNT.                                 
           MOVE   WS-PAGE-CNT TO   PRT-PAGE.                                    
           WRITE  PRINT-REC   FROM L262-HDG1   AFTER PAGE.                      
           WRITE  PRINT-REC   FROM L262-HDG2   AFTER 1.                         
           WRITE  PRINT-REC   FROM L262-HDG4   AFTER 2.                         
           WRITE  PRINT-REC   FROM L262-HDG5   AFTER 1.                         
           WRITE  PRINT-REC   FROM L262-HDG6   AFTER 1.                         
           MOVE   SPACES      TO   PRINT-REC.                                   
           WRITE  PRINT-REC.                                                    
           MOVE   ZEROES      TO   WS-REC-CNT.                                  
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       600-READ-BM06K100.                                                       
      ******************************************************************        
                                                                                
           MOVE F190-2-ESTATE           TO     K100-ESTATE.                     
           MOVE F190-2-NEIGHBOURHOOD    TO     K100-NEIGHBOURHOOD.              
           MOVE F190-2-CONTRACT-NO      TO     K100-CONTRACT-NO.                
           MOVE F190-2-BLK-NO           TO     K100-BLK-NO.                     
                                                                                
           READ   BM06K100.                                                     
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       700-READ-BM06K510.                                                       
      ******************************************************************        
                                                                                
           MOVE   K100-ESTATE         TO     K510-ESTCDE.                       
                                                                                
           READ   BM06K510.                                                     
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       999-CLOSE-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           IF WS-REC-CNT > 30                                                   
              PERFORM 500-PRINT-HEADER    THRU 500-EXIT.                        
                                                                                
           WRITE PRINT-REC FROM  L262-FTR1 AFTER 5                              
           WRITE PRINT-REC FROM  L262-FTR2 AFTER 1                              
           WRITE PRINT-REC FROM  L262-FTR3 AFTER 1                              
           WRITE PRINT-REC FROM  L262-FTR4 AFTER 2                              
           WRITE PRINT-REC FROM  L262-FTR5 AFTER 2                              
           WRITE PRINT-REC FROM  L262-FTR6 AFTER 1                              
           WRITE PRINT-REC FROM  L262-FTR7 AFTER 3                              
           WRITE PRINT-REC FROM  L262-FTR8 AFTER 1                              
                                                                                
           CLOSE BM06K100                                                       
                 BM06K510                                                       
                 BM06F190                                                       
                 BP13K277                                                       
                 P13L262A.                                                      
                                                                                
           IF K100-FSTAT NOT = '00' AND '97'                                    
              MOVE K100-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BM06K100 CLOSE ERROR : ' K100-FSTAT.                     
                                                                                
           IF K510-FSTAT NOT = '00' AND '97'                                    
              MOVE K510-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BM06K510 CLOSE ERROR : ' K510-FSTAT.                     
                                                                                
           IF K277-FSTAT NOT = '00' AND '97'                                    
              MOVE K277-FSTAT TO RETURN-CODE                                    
              DISPLAY 'BP13K277 CLOSE ERROR : ' K277-FSTAT.                     
                                                                                
           STOP RUN.                                                            
                                                                                
       999-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
