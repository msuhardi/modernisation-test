       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C153.                                                 
      *AUTHOR.        SIA.                                                      
      *DATE-WRITTEN.  25/02/1998.                                               
      * =========================================================== *           
      * SYSTEM OF COMMITMENT (BP13)                                 *           
      * =========================================================== *           
      *                                                             *           
      *    OBJECTIVE :                                              *           
      *      PRINT QTRLY REPORT ON HSEHOLD TYPE & 5YR ELIGIBILITY   *           
      *      REPORT CONTAINS SMS, RESALE HISTORY,                   *           
      *          TRANSFER HISTORY INFORMATION                       *           
      *                                                             *           
      *     INPUT :                                                 *           
      *      1. BP13F558 (SEQUENTIAL)                               *           
      *      2. BP13F520 (SEQUENTIAL)                               *           
      *      3. BP13K800                                            *           
      *      4. BP13K810 (GET DTE-CHG HH, CHG-5YR)                  *           
      *      5. BP13K060                                            *           
      *                                                             *           
      *     OUTPUT :                                                *           
      *      1. BP13L153                                            *           
      *                                                             *           
      *  CHG-NO  BY  ON      DESCRIPTION                            *           
      *-----------------------------------                          *           
      * BP130458 SIA 19982702  NEW PGM                              *           
      * BP130459 LSB 19980603  ADJUST PRINT LINE                    *           
      * BP130418 RHB 19980825  TO CATER FOR Y2000.                  *           
      * BP130645 SRA 19990419  TO DISPLAY F558-NUM-DEBARMENT-1,     *           
      *                        DEBARMENT-2,DEBARMENT-3 IN THE       *           
      *                        REPORT BP13L153                      *           
      * BP130630 NOR 19990624  FIXED LINE COUNTER                   *           
      * BP130652 NOR 19990519  EXPAND F520 RECL FR 300 TO 500       *           
      * BP130897 AKT 20000731  EXPAND F558 RECL FR 400 TO 600       *           
      * BP132059 ANC 20020206  TO DISPLAY F558-NUM-DEBARMENT-4,     *           
      *                        DEBARMENT-5 IN BP13L153 REPORT       *           
      * BP132603 JF4 20041028  CHANGE 10-YR TIMEBAR TO 5-YR         *           
      * =========================================================== *           
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
      *                                                                         
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F558 ASSIGN TO BP13F558.                                  
           SELECT BP13F520 ASSIGN TO BP13F520.                                  
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                     ORGANIZATION IS INDEXED                                    
                     ACCESS MODE  IS RANDOM                                     
                     RECORD KEY   IS K800-NUM-REGN                              
                     FILE STATUS  IS WS-K800-STATUS.                            
                                                                                
           SELECT BP13K810 ASSIGN TO BP13K810                                   
                     ORGANIZATION IS INDEXED                                    
                     ACCESS MODE  IS SEQUENTIAL                                 
                     RECORD KEY   IS K810-KEY-FLD                               
                     FILE STATUS  IS WS-K810-STATUS.                            
                                                                                
                                                                                
           SELECT BP13K060 ASSIGN TO BP13K060                                   
                     ORGANIZATION IS INDEXED                                    
                     ACCESS MODE  IS RANDOM                                     
                     RECORD KEY   IS K060-KEY-FLD                               
                     FILE STATUS  IS WS-K060-STATUS.                            
                                                                                
           SELECT BP13L153 ASSIGN TO BP13L153.                                  
                                                                                
                                                                                
      *                                                                         
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *                                                                         
       FD   BP13F558                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 600 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BP13F558.                                                           
      *                                                                         
       FD   BP13F520                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BP13F520.                                                           
      *                                                                         
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K810                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K810.                                                           
                                                                                
       FD   BP13K060                                                            
            RECORD CONTAINS 25 CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD   BP13L153                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       01   BP13L153-REC     PIC X(132).                                        
                                                                                
      *                                                                         
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-DTE-CURRENT.                                                      
           05  WS-CC1                     PIC X(2).                             
           05  WS-YY1                     PIC X(2).                             
           05  WS-MM1                     PIC X(2).                             
           05  WS-DD1                     PIC X(2).                             
                                                                                
       01  WS-DTE-TODATE.                                                       
           05  WS-DD                      PIC X(2).                             
           05  FILLER                     PIC X(1)    VALUE '/'.                
           05  WS-MM                      PIC X(2).                             
           05  FILLER                     PIC X(1)    VALUE '/'.                
           05  WS-CC                      PIC X(2).                             
           05  WS-YY                      PIC X(2).                             
                                                                                
       01  WS-VARIABLE.                                                         
           05  WS-F558-EOF                PIC X(1)    VALUE 'N'.                
           05  WS-F520-EOF                PIC X(1)    VALUE 'N'.                
           05  WS-F558-READ               PIC 9(5)    VALUE 0.                  
           05  WS-F520-READ               PIC 9(5)    VALUE 0.                  
           05  WS-K800-READ               PIC 9(5)    VALUE 0.                  
           05  WS-K810-READ               PIC 9(5)    VALUE 0.                  
           05  WS-K060-READ               PIC 9(5)    VALUE 0.                  
           05  WS-K800-NOTFND             PIC 9(5)    VALUE 0.                  
           05  WS-K810-NOTFND             PIC 9(5)    VALUE 0.                  
           05  WS-K060-NOTFND             PIC 9(5)    VALUE 0.                  
           05  WS-K800-FND                PIC X(1)    VALUE SPACES.             
           05  WS-K800-STATUS             PIC 9(2)    VALUE 0.                  
           05  WS-K810-STATUS             PIC 9(2)    VALUE 0.                  
           05  WS-K060-STATUS             PIC 9(2)    VALUE 0.                  
           05  WS-REC-MATCH               PIC 9(5)    VALUE 0.                  
           05  WS-PREV-REGN               PIC X(8)    VALUE SPACES.             
           05  WS-SNO                     PIC 9(4)    VALUE 0.                  
           05  WS-LINE                    PIC 9(2)    VALUE 60.                 
           05  WS-PAGE                    PIC 9(4)    VALUE 0.                  
           05  WS-DTE-CHGE-HH             PIC X(8)     VALUE SPACES.            
           05  WS-DTE-CHGE-5YR            PIC X(8)     VALUE SPACES.            
                                                                                
      *----------------------------------------------------------------*        
      * REPORT LAYOUT                                                  *        
      *----------------------------------------------------------------*        
       01  L153-HDR-01.                                                         
           05  FILLER                   PIC X(8)    VALUE 'BP13L153'.           
           05  FILLER                   PIC X(7)    VALUE SPACES .              
           05  FILLER                   PIC X(8)    VALUE 'HDBCAT 3'.           
           05  FILLER                   PIC X(21)   VALUE SPACES.               
           05  FILLER                   PIC X(39)   VALUE                       
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(17)   VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE 'DATE :'.             
           05  L153-DATE                PIC X(10)   VALUE SPACES.               
           05  FILLER                   PIC X(3)    VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE 'PAGE : '.            
           05  L153-PAGE                PIC ZZZ9 .                              
                                                                                
       01  L153-HDR-02.                                                         
           05  FILLER                   PIC X(38)   VALUE SPACES .              
           05  FILLER                   PIC X(55)   VALUE                       
             'QUARTERLY REPORT ON HOUSEHOLD TYPE AND 5YR ELIGIBILITY '.         
           05  FILLER                   PIC X(39)   VALUE SPACES.               
                                                                                
       01  L153-HDR-03.                                                         
           05  FILLER                   PIC X(29)   VALUE SPACES.               
           05  FILLER                   PIC X(27)   VALUE                       
              '(BEFORE) (AFTER)  CHNGE-DTE'.                                    
           05  FILLER                   PIC X(76)   VALUE SPACES.               
                                                                                
       01  L153-HDR-04.                                                         
           05  FILLER                   PIC X(29)   VALUE SPACES.               
           05  FILLER                   PIC X(49)   VALUE                       
              ' HH/5YR  HH/5YR   HH-TYPE                  DEBAR1'.              
           05  FILLER                   PIC X(01)   VALUE SPACES.               
           05  FILLER                   PIC X(52)   VALUE                       
              'SMS-SCH     FT ST SALES DATE RDB MOVEIN  M-RES SUBLT'.           
                                                                                
       01  L153-HDR-05.                                                         
           05  FILLER                   PIC X(55)   VALUE                       
              '      REGN/    ZN P/C FZ Q-TM MTHRES  MTHRES   5YR     '.        
           05  FILLER                   PIC X(24)   VALUE                       
              '   NRIC          DEBAR2 '.                                       
           05  FILLER                   PIC X(52)   VALUE                       
              'RSL-SCH     FT ST RSL DATE   SOLD-SELLR  M-RES SUBLT'.           
                                                                                
       01  L153-HDR-06.                                                         
           05  FILLER                   PIC X(55)   VALUE                       
              'S/N   CURREG   FT  DTE-APPL   SUBLET  SUBLET           '.        
           05  FILLER                   PIC X(24)   VALUE                       
              '   REL-SHIP   HA DEBAR3 '.                                       
           05  FILLER                   PIC X(52)   VALUE                       
              'TRF-SCH        ST TRF DATE   RDB MOVEIN  M-RES SUBLT'.           
                                                                                
       01  L153-HDR-07.                                                         
           05  FILLER                   PIC X(55)   VALUE SPACES.               
           05  FILLER                   PIC X(24)   VALUE                       
              '                 DEBAR4 '.                                       
           05  FILLER                   PIC X(52)   VALUE SPACES.               
                                                                                
       01  L153-HDR-08.                                                         
           05  FILLER                   PIC X(55)   VALUE SPACES.               
           05  FILLER                   PIC X(24)   VALUE                       
              '                 DEBAR5 '.                                       
           05  FILLER                   PIC X(52)   VALUE SPACES.               
                                                                                
       01  L153-HDR-LINE                     PIC X(132) VALUE ALL '-'.          
                                                                                
       01  L153-DTL-01.                                                         
           05 L153-SNO                       PIC ZZZ9.                          
           05 L153-SNO-X REDEFINES L153-SNO  PIC X(4).                          
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-REGN                      PIC X(8)  VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-ZONE                      PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-PARENT-CHILD              PIC X(1)  VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-FREEZE-HH                 PIC X(1)  VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-TME-QUEUE                 PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-HOUSEHOLD-BFR             PIC X(1)  VALUE SPACES.            
           05 L153-SLASH-BFR                 PIC X(3)  VALUE SPACES.            
           05 L153-5YR-OCCUPN-BFR            PIC X(1)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-HOUSEHOLD-AFT             PIC X(1)  VALUE SPACES.            
           05 L153-SLASH-AFT                 PIC X(3)  VALUE SPACES.            
           05 L153-5YR-OCCUPN-AFT            PIC X(1)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-DTE-CHGE-HSEHOLD          PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-NRIC                      PIC X(9)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-APPLN                     PIC X(1)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-DEBARMENT1                PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-HDB-REF-SMS               PIC X(11) VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-FLAT-TYPE-SMS             PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-SALES-TYPE-SMS            PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-DTE-FLAT-SOLD-SMS         PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-DTE-MOVE-IN-RDB           PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-MTH-RESIDE-SMS            PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-SUBLET-SMS                PIC X(3)  VALUE SPACES.            
                                                                                
       01  L153-DTL-02.                                                         
           05 FILLER                         PIC X(6)  VALUE SPACES.            
           05 L153-CUR-REGN                  PIC X(8)  VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-FLAT-TYPE                 PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-DTE-REGN                  PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-MTH-RESIDE-BFR            PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(5)  VALUE SPACES.            
           05 L153-MTH-RESIDE-AFT            PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(4)  VALUE SPACES.            
           05 L153-DTE-CHGE-5YR              PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(2)  VALUE SPACES.            
           05 L153-RELATIONSHIP              PIC X(15) VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-DEBARMENT2                PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-HDB-REF-RSL               PIC X(11) VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-FLAT-TYPE-RESALE          PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-FILE-STATUS-RSL           PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-DTE-RESALE-EFF            PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-DTE-SOLD-SELLER-RSL       PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-MTH-RESIDE-RSL            PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-SUBLET-RSL                PIC X(3)  VALUE SPACES.            
                                                                                
       01  L153-DTL-03.                                                         
           05 FILLER                         PIC X(31) VALUE SPACES.            
           05 L153-MTH-SUBLET-BFR            PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(5)  VALUE SPACES.            
           05 L153-MTH-SUBLET-AFT            PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(32) VALUE SPACES.            
           05 L153-DEBARMENT3                PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(03) VALUE SPACES.            
           05 L153-HDB-REF-TR                PIC X(11) VALUE SPACES.            
           05 FILLER                         PIC X(4)  VALUE SPACES.            
           05 L153-SALES-TYPE-TR             PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-DTE-TRANSFER-TR           PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(1)  VALUE SPACES.            
           05 L153-DTE-MOVE-IN-TR            PIC X(10) VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-MTH-RESIDE-TR             PIC X(3)  VALUE SPACES.            
           05 FILLER                         PIC X(3)  VALUE SPACES.            
           05 L153-SUBLET-TR                 PIC X(3)  VALUE SPACES.            
                                                                                
       01  L153-DTL-04.                                                         
           05 FILLER                         PIC X(74) VALUE SPACES.            
           05 L153-DEBARMENT4                PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(54) VALUE SPACES.            
                                                                                
       01  L153-DTL-05.                                                         
           05 FILLER                         PIC X(74) VALUE SPACES.            
           05 L153-DEBARMENT5                PIC X(2)  VALUE SPACES.            
           05 FILLER                         PIC X(54) VALUE SPACES.            
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      ***************************************************************           
       0000-MAIN-ROUTINE.                                                       
      ***************************************************************           
                                                                                
           PERFORM 1000-OPEN-FILES         THRU 1000-EXIT.                      
           PERFORM 2000-READ-BP13F558      THRU 2000-EXIT.                      
           PERFORM 2500-READ-BP13F520      THRU 2500-EXIT.                      
           PERFORM 3000-PROCESS-MATCH      THRU 3000-EXIT                       
             UNTIL F558-NUM-REGN = HIGH-VALUES                                  
              AND  F520-NUM-REGN = HIGH-VALUES.                                 
           PERFORM 9000-CLOSE-ROUTINE      THRU 9000-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************************************************           
       1000-OPEN-FILES.                                                         
      ***************************************************************           
                                                                                
           OPEN INPUT  BP13F558                                                 
                       BP13F520                                                 
                       BP13K800                                                 
                       BP13K810                                                 
                       BP13K060                                                 
                OUTPUT BP13L153.                                                
                                                                                
           IF WS-K800-STATUS NOT = 0 AND 97                                     
              DISPLAY 'OPEN FAILED FOR BP13K800 :' WS-K800-STATUS               
              MOVE WS-K800-STATUS TO RETURN-CODE                                
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K810-STATUS NOT = 0 AND 97                                     
              DISPLAY 'OPEN FAILED FOR BP13K810 :' WS-K810-STATUS               
              MOVE WS-K810-STATUS TO RETURN-CODE                                
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K060-STATUS NOT = 0 AND 97                                     
              DISPLAY 'OPEN FAILED FOR BP13K060 :' WS-K060-STATUS               
              MOVE WS-K060-STATUS TO RETURN-CODE                                
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-DTE-CURRENT.                        
           MOVE WS-DD1 TO WS-DD.                                                
           MOVE WS-MM1 TO WS-MM.                                                
           MOVE WS-CC1 TO WS-CC.                                                
           MOVE WS-YY1 TO WS-YY.                                                
                                                                                
           MOVE WS-DTE-TODATE TO L153-DATE.                                     
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ***************************************************************           
       2000-READ-BP13F558.                                                      
      ***************************************************************           
           READ BP13F558                                                        
                AT END MOVE HIGH-VALUES TO F558-NUM-REGN                        
                GO TO 2000-EXIT.                                                
           ADD 1                         TO WS-F558-READ.                       
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************************************************           
       2500-READ-BP13F520.                                                      
      ***************************************************************           
           READ BP13F520                                                        
                AT END MOVE HIGH-VALUE TO BP13F520-REC                          
                GO TO 2500-EXIT.                                                
           ADD 1                         TO WS-F520-READ.                       
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ***************************************************************           
       3000-PROCESS-MATCH.                                                      
      ***************************************************************           
                                                                                
           IF F558-NUM-REGN = F520-NUM-REGN                                     
              PERFORM 3050-CHECK-MATCH-CASE THRU 3050-EXIT                      
              PERFORM 2500-READ-BP13F520     THRU 2500-EXIT                     
           ELSE                                                                 
              IF F558-NUM-REGN > F520-NUM-REGN                                  
                 PERFORM 2500-READ-BP13F520     THRU 2500-EXIT                  
              ELSE                                                              
                 PERFORM 2000-READ-BP13F558     THRU 2000-EXIT.                 
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3050-CHECK-MATCH-CASE.                                                   
                                                                                
           PERFORM 3100-READ-BP13K800     THRU 3100-EXIT                        
           IF WS-K800-FND = 'Y'                                                 
              PERFORM 3080-CHECK-HOUSEHOLD THRU 3080-EXIT                       
           END-IF.                                                              
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3080-CHECK-HOUSEHOLD.                                                    
                                                                                
           IF F520-CDE-HOUSEHOLD NOT = K800-NUM-HOUSEHOLD                       
              IF F520-CDE-HOUSEHOLD = 'H' AND K800-NUM-HOUSEHOLD = 'T'          
                         AND K800-NUM-HOUSEHOLD-FREEZE = 'Y'                    
                 PERFORM UNTIL F558-NUM-REGN NOT = F520-NUM-REGN                
                    PERFORM 2000-READ-BP13F558  THRU 2000-EXIT                  
                 END-PERFORM                                                    
              ELSE                                                              
                  PERFORM 3150-MOVE-BP13K800     THRU 3150-EXIT                 
                  PERFORM 3200-READ-BP13K810     THRU 3200-EXIT                 
                  PERFORM UNTIL F558-NUM-REGN NOT = F520-NUM-REGN               
                    PERFORM 3500-MOVE-BP13L153  THRU 3500-EXIT                  
                    PERFORM 4000-PRNT-BP13L153  THRU 4000-EXIT                  
                    PERFORM 2000-READ-BP13F558  THRU 2000-EXIT                  
                  END-PERFORM                                                   
           ELSE                                                                 
              PERFORM UNTIL F558-NUM-REGN NOT = F520-NUM-REGN                   
              PERFORM 2000-READ-BP13F558  THRU 2000-EXIT                        
              END-PERFORM                                                       
           END-IF.                                                              
                                                                                
       3080-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ***************************************************************           
       3100-READ-BP13K800.                                                      
      ***************************************************************           
                                                                                
           ADD  1      TO  WS-REC-MATCH.                                        
                                                                                
           MOVE F558-NUM-REGN    TO   K800-NUM-REGN.                            
           READ BP13K800.                                                       
           EVALUATE WS-K800-STATUS                                              
           WHEN  00                                                             
                 ADD 1 TO WS-K800-READ                                          
                 MOVE 'Y'    TO WS-K800-FND                                     
           WHEN  23                                                             
                 MOVE SPACES TO WS-K800-FND                                     
                 ADD 1 TO WS-K800-NOTFND                                        
                 DISPLAY 'RECORD NOT FND : '  K800-NUM-REGN                     
                         ' '  F558-NUM-REGN                                     
           WHEN  OTHER                                                          
                 DISPLAY 'K800 RECORD NOT FOUND  = ' WS-K800-STATUS             
                 DISPLAY '      K800-NUM-REGN    = ' K800-NUM-REGN              
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************************************************           
       3150-MOVE-BP13K800.                                                      
      ***************************************************************           
           MOVE SPACES                 TO L153-DTL-01.                          
           MOVE SPACES                 TO L153-DTL-02.                          
           MOVE SPACES                 TO L153-DTL-03.                          
                                                                                
           MOVE K800-NUM-REGN          TO L153-REGN.                            
           MOVE K800-DTE-REGN          TO L153-DTE-REGN.                        
           MOVE K800-NUM-CUR-REGN      TO L153-CUR-REGN.                        
           MOVE K800-NUM-ZONE          TO L153-ZONE.                            
           MOVE K800-NUM-FLAT-TYPE     TO L153-FLAT-TYPE.                       
           MOVE K800-TME-QUEUE         TO L153-TME-QUEUE.                       
           MOVE K800-NUM-5YR-OCCUPN    TO L153-5YR-OCCUPN-BFR.                  
           MOVE K800-NUM-HOUSEHOLD-FREEZE  TO L153-FREEZE-HH.                   
           MOVE K800-NUM-MTH-RESIDE    TO L153-MTH-RESIDE-BFR.                  
           MOVE K800-NUM-MTH-SUBLET    TO L153-MTH-SUBLET-BFR.                  
           MOVE K800-NUM-HOUSEHOLD     TO L153-HOUSEHOLD-BFR.                   
           MOVE ' / '                  TO L153-SLASH-BFR                        
                                          L153-SLASH-AFT.                       
                                                                                
           IF  K800-DTE-REGN = SPACES OR LOW-VALUES                             
               MOVE SPACES TO  L153-DTE-REGN                                    
           ELSE                                                                 
               STRING K800-DTE-REGN(7:2) '/'                                    
                      K800-DTE-REGN(5:2) '/'                                    
                      K800-DTE-REGN(1:4)                                        
               DELIMITED BY SIZE INTO L153-DTE-REGN                             
           END-IF.                                                              
                                                                                
       3150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************************************************           
       3200-READ-BP13K810.                                                      
      ***************************************************************           
                                                                                
           MOVE SPACES          TO WS-DTE-CHGE-HH.                              
           MOVE SPACES          TO WS-DTE-CHGE-5YR.                             
                                                                                
           MOVE SPACES          TO K810-KEY-FLD.                                
           MOVE K800-NUM-REGN   TO K810-NUM-REGN.                               
                                                                                
           START BP13K810 KEY IS >= K810-KEY-FLD                                
                 INVALID KEY                                                    
                 MOVE SPACES TO K810-NUM-REGN                                   
                 DISPLAY 'RECORD NOTFND, K810-STATUS ' WS-K810-STATUS           
                         '               K810-REGN:  ' K800-NUM-REGN.           
                                                                                
           PERFORM 3300-READNEXT-K810 THRU 3300-EXIT                            
                   UNTIL K810-NUM-REGN NOT = K800-NUM-REGN                      
                   OR    K810-KEY-FLD      = HIGH-VALUES.                       
                                                                                
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************************************************           
       3300-READNEXT-K810.                                                      
      ***************************************************************           
           READ BP13K810 NEXT                                                   
                AT END MOVE HIGH-VALUES TO K810-KEY-FLD                         
                GO TO 3300-EXIT.                                                
                                                                                
           IF K810-NUM-REGN NOT = K800-NUM-REGN                                 
                GO TO 3300-EXIT.                                                
                                                                                
           ADD 1 TO WS-K810-READ.                                               
                                                                                
           IF K810-NUM-HOUSEHOLD  NOT = K800-NUM-HOUSEHOLD                      
              MOVE K810-DTE-UPDATE TO WS-DTE-CHGE-HH.                           
                                                                                
           IF K810-NUM-5YR-OCCUPN NOT = K800-NUM-5YR-OCCUPN                     
              MOVE K810-DTE-UPDATE TO WS-DTE-CHGE-5YR.                          
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ***************************************************************           
       3500-MOVE-BP13L153.                                                      
      ***************************************************************           
           MOVE F520-CDE-PARENT-CHILD  TO L153-PARENT-CHILD.                    
           MOVE F520-NUM-5YR-OCCUPN    TO L153-5YR-OCCUPN-AFT.                  
           MOVE F520-NUM-MTH-RESIDE    TO L153-MTH-RESIDE-AFT.                  
           MOVE F520-NUM-MTH-SUBLET    TO L153-MTH-SUBLET-AFT.                  
           MOVE F520-CDE-HOUSEHOLD     TO L153-HOUSEHOLD-AFT.                   
                                                                                
           IF  WS-DTE-CHGE-HH = SPACES OR LOW-VALUES                            
               MOVE SPACES TO  L153-DTE-CHGE-HSEHOLD                            
           ELSE                                                                 
               STRING WS-DTE-CHGE-HH(7:2) '/'                                   
                      WS-DTE-CHGE-HH(5:2) '/'                                   
                      WS-DTE-CHGE-HH(1:4)                                       
               DELIMITED BY SIZE INTO L153-DTE-CHGE-HSEHOLD                     
           END-IF.                                                              
                                                                                
           IF  WS-DTE-CHGE-5YR = SPACES OR LOW-VALUES                           
               MOVE SPACES TO  L153-DTE-CHGE-5YR                                
           ELSE                                                                 
               STRING WS-DTE-CHGE-5YR(7:2) '/'                                  
                      WS-DTE-CHGE-5YR(5:2) '/'                                  
                      WS-DTE-CHGE-5YR(1:4)                                      
               DELIMITED BY SIZE INTO L153-DTE-CHGE-5YR                         
           END-IF.                                                              
                                                                                
      *--> SMS                                                                  
           MOVE F558-NUM-NRIC            TO L153-NRIC.                          
           MOVE F558-NUM-APPLN           TO L153-APPLN.                         
           MOVE F558-NUM-DEBARMENT-1     TO L153-DEBARMENT1.                    
           MOVE F558-NUM-DEBARMENT-2     TO L153-DEBARMENT2.                    
           MOVE F558-NUM-DEBARMENT-3     TO L153-DEBARMENT3.                    
           MOVE F558-NUM-DEBARMENT-4     TO L153-DEBARMENT4.                    
           MOVE F558-NUM-DEBARMENT-5     TO L153-DEBARMENT5.                    
           MOVE F558-NUM-HDB-REF-SMS     TO L153-HDB-REF-SMS                    
           MOVE F558-CDE-FLAT-TYPE-SMS   TO L153-FLAT-TYPE-SMS                  
           MOVE F558-CDE-SALES-TYPE-SMS  TO L153-SALES-TYPE-SMS                 
                                                                                
      *--> DECODE RELATIONSHIP                                                  
           MOVE  35                      TO K060-SERIAL-NO.                     
           MOVE  F558-CDE-RELATIONSHIP   TO K060-CODE.                          
           PERFORM 3600-READ-BP13K060  THRU 3600-EXIT.                          
                                                                                
           IF  F558-DTE-FLAT-SOLD-SMS = SPACES OR LOW-VALUES                    
               MOVE SPACES TO  L153-DTE-FLAT-SOLD-SMS                           
           ELSE                                                                 
               STRING F558-DTE-FLAT-SOLD-SMS(7:2) '/'                           
                      F558-DTE-FLAT-SOLD-SMS(5:2) '/'                           
                      F558-DTE-FLAT-SOLD-SMS(1:4)                               
               DELIMITED BY SIZE INTO L153-DTE-FLAT-SOLD-SMS                    
           END-IF.                                                              
                                                                                
           IF  F558-DTE-MOVE-IN-RDB = SPACES OR LOW-VALUES                      
               MOVE SPACES TO  L153-DTE-MOVE-IN-RDB                             
           ELSE                                                                 
               STRING F558-DTE-MOVE-IN-RDB(7:2) '/'                             
                      F558-DTE-MOVE-IN-RDB(5:2) '/'                             
                      F558-DTE-MOVE-IN-RDB(1:4)                                 
               DELIMITED BY SIZE INTO L153-DTE-MOVE-IN-RDB                      
           END-IF.                                                              
                                                                                
           MOVE F558-NUM-MTH-RESIDE-SMS TO L153-MTH-RESIDE-SMS                  
           MOVE F558-NUM-SUBLET-SMS     TO L153-SUBLET-SMS                      
                                                                                
      *--> RSL                                                                  
           MOVE F558-NUM-HDB-REF-RSL       TO L153-HDB-REF-RSL                  
           MOVE F558-CDE-FLAT-TYPE-RESALE  TO L153-FLAT-TYPE-RESALE             
           MOVE F558-CDE-FILE-STATUS-RSL   TO L153-FILE-STATUS-RSL              
                                                                                
           IF  F558-DTE-RESALE-EFF = SPACES OR LOW-VALUES                       
               MOVE SPACES TO  L153-DTE-RESALE-EFF                              
           ELSE                                                                 
               STRING F558-DTE-RESALE-EFF(7:2) '/'                              
                      F558-DTE-RESALE-EFF(5:2) '/'                              
                      F558-DTE-RESALE-EFF(1:4)                                  
               DELIMITED BY SIZE INTO L153-DTE-RESALE-EFF                       
           END-IF.                                                              
                                                                                
           IF  F558-DTE-SOLD-SELLER-RSL = SPACES OR LOW-VALUES                  
               MOVE SPACES TO  L153-DTE-SOLD-SELLER-RSL                         
           ELSE                                                                 
               STRING F558-DTE-SOLD-SELLER-RSL(7:2) '/'                         
                      F558-DTE-SOLD-SELLER-RSL(5:2) '/'                         
                      F558-DTE-SOLD-SELLER-RSL(1:4)                             
               DELIMITED BY SIZE INTO L153-DTE-SOLD-SELLER-RSL                  
           END-IF.                                                              
                                                                                
           MOVE F558-NUM-MTH-RESIDE-RSL TO L153-MTH-RESIDE-RSL                  
           MOVE F558-NUM-SUBLET-RSL     TO L153-SUBLET-RSL                      
                                                                                
      *--> TRF                                                                  
           MOVE F558-NUM-HDB-REF-TR     TO L153-HDB-REF-TR                      
           MOVE F558-NUM-SALES-TYPE-TR  TO L153-SALES-TYPE-TR                   
           IF  F558-DTE-TRANSFER-TR = SPACES OR LOW-VALUES                      
               MOVE SPACES TO  L153-DTE-TRANSFER-TR                             
           ELSE                                                                 
               STRING F558-DTE-TRANSFER-TR(7:2) '/'                             
                      F558-DTE-TRANSFER-TR(5:2) '/'                             
                      F558-DTE-TRANSFER-TR(1:4)                                 
               DELIMITED BY SIZE INTO L153-DTE-TRANSFER-TR                      
           END-IF                                                               
                                                                                
           IF  F558-DTE-MOVE-IN-TR = SPACES OR LOW-VALUES                       
               MOVE SPACES TO  L153-DTE-MOVE-IN-TR                              
           ELSE                                                                 
               STRING F558-DTE-MOVE-IN-TR(7:2) '/'                              
                      F558-DTE-MOVE-IN-TR(5:2) '/'                              
                      F558-DTE-MOVE-IN-TR(1:4)                                  
               DELIMITED BY SIZE INTO L153-DTE-MOVE-IN-TR                       
           END-IF                                                               
                                                                                
           MOVE F558-NUM-MTH-RESIDE-TR  TO L153-MTH-RESIDE-TR.                  
           MOVE F558-NUM-SUBLET-TR      TO L153-SUBLET-TR.                      
                                                                                
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************************************************           
       3600-READ-BP13K060.                                                      
      ***************************************************************           
           READ BP13K060.                                                       
           EVALUATE WS-K060-STATUS                                              
           WHEN  00                                                             
                 MOVE  K060-DESC               TO L153-RELATIONSHIP             
           WHEN  23                                                             
                 MOVE  F558-CDE-RELATIONSHIP   TO L153-RELATIONSHIP             
                 ADD 1 TO WS-K060-NOTFND                                        
                 DISPLAY 'RECORD NOT FND : '  K060-KEY-FLD                      
           WHEN  OTHER                                                          
                 DISPLAY 'K060 RECORD NOT FOUND  = ' WS-K060-STATUS             
                 DISPLAY '      K060-KEY-FLD    = ' K060-KEY-FLD                
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************************************************           
       4000-PRNT-BP13L153.                                                      
      ***************************************************************           
                                                                                
           IF WS-LINE > 54                                                      
              MOVE  8 TO WS-LINE                                                
              ADD   1 TO WS-PAGE                                                
              MOVE  WS-PAGE TO L153-PAGE                                        
              WRITE BP13L153-REC FROM L153-HDR-01 AFTER PAGE                    
              WRITE BP13L153-REC FROM L153-HDR-02                               
              WRITE BP13L153-REC FROM L153-HDR-03 AFTER 2                       
              WRITE BP13L153-REC FROM L153-HDR-04                               
              WRITE BP13L153-REC FROM L153-HDR-05                               
              WRITE BP13L153-REC FROM L153-HDR-06                               
              WRITE BP13L153-REC FROM L153-HDR-07                               
              WRITE BP13L153-REC FROM L153-HDR-08                               
              WRITE BP13L153-REC FROM L153-HDR-LINE.                            
                                                                                
           IF F558-NUM-REGN NOT = WS-PREV-REGN                                  
              MOVE  F558-NUM-REGN TO WS-PREV-REGN                               
              ADD   1 TO WS-SNO                                                 
              MOVE  WS-SNO TO L153-SNO                                          
              WRITE BP13L153-REC FROM L153-DTL-01 AFTER 4                       
              ADD   4 TO WS-LINE                                                
           ELSE                                                                 
              MOVE  SPACES TO L153-DTL-01(1:58)                                 
              MOVE  SPACES TO L153-DTL-02(1:58)                                 
              MOVE  SPACES TO L153-DTL-03(1:58)                                 
              MOVE  SPACES TO L153-DTL-04(1:58)                                 
              MOVE  SPACES TO L153-DTL-05(1:58)                                 
              WRITE BP13L153-REC FROM L153-DTL-01 AFTER 2                       
              ADD   2 TO WS-LINE.                                               
                                                                                
           WRITE BP13L153-REC FROM L153-DTL-02                                  
           WRITE BP13L153-REC FROM L153-DTL-03                                  
           WRITE BP13L153-REC FROM L153-DTL-04                                  
           WRITE BP13L153-REC FROM L153-DTL-05                                  
           ADD   2 TO WS-LINE.                                                  
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      ****************************************************************          
       9000-CLOSE-ROUTINE.                                                      
      ****************************************************************          
                                                                                
           CLOSE BP13F558                                                       
                 BP13F520                                                       
                 BP13K800                                                       
                 BP13K810                                                       
                 BP13K060                                                       
                 BP13L153.                                                      
                                                                                
           IF WS-K800-STATUS NOT = 0 AND 97                                     
              DISPLAY 'CLOSE ERROR FOR BP13K800 :' WS-K800-STATUS               
              MOVE WS-K800-STATUS TO RETURN-CODE                                
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K810-STATUS NOT = 0 AND 97                                     
              DISPLAY 'CLOSE ERROR FOR BP13K810 :' WS-K810-STATUS               
              MOVE WS-K810-STATUS TO RETURN-CODE                                
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K060-STATUS NOT = 0 AND 97                                     
              DISPLAY 'CLOSE ERROR FOR BP13K060 :' WS-K060-STATUS               
              MOVE WS-K060-STATUS TO RETURN-CODE                                
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY 'BP13C153 CTRL TOTALS'.                                      
           DISPLAY '--------------------------------------'.                    
           DISPLAY '  NO. OF F558 RECORDS READ = ' WS-F558-READ.                
           DISPLAY '  NO. OF F520 RECORDS READ = ' WS-F520-READ.                
           DISPLAY '  NO. OF RECORDS MATCHED   = ' WS-REC-MATCH.                
           DISPLAY '  NO. OF K800 RECORDS READ = ' WS-K800-READ.                
           DISPLAY '  NO. OF K810 RECORDS READ = ' WS-K810-READ.                
           DISPLAY SPACES.                                                      
           DISPLAY '============================='.                             
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
