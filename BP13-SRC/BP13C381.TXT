      *--------------------------------------------------------------*          
       IDENTIFICATION DIVISION.                                                 
      *--------------------------------------------------------------*          
       PROGRAM-ID.    BP13C381.                                                 
      *AUTHOR.        SK                                                        
      *DATE-WRITTEN.  08-07-2003                                                
      *--------------------------------------------------------------*          
      *                                                              *          
      *    SYSTEM NAME : SYSTEM OF COMMITMENT  (SOC)                 *          
      *                                                              *          
      *    SYSTEM ID   : BP13                                        *          
      *                                                              *          
      *    OBJECTIVES :  MONTHLY CANCELLATION OF WIS APPLICATION     *          
      *                                                              *          
      *    INPUT FILES  : BP13F800                                   *          
      *                 : BP13F205                                   *          
      *                 : BP13K820                                   *          
      *                 : BP13K830                                   *          
      *    I-O          : BP13K800                                   *          
      *                   BP13K840                                   *          
      *                 : BP13K848                                   *          
      *                 : BP13K810                                   *          
      *    OUTPUT       : P13L381A  - REPORT                         *          
      *                 : P13L381B  - REPORT                         *          
      *                 : P13L381C  - LETTER                         *          
      *                 : P13L381D  - LETTER                         *          
      *                 : P13L381E  - LETTER                         *          
      *                 : P13L381F  - LETTER                         *          
      *                 : P13L381G  - LETTER                         *          
      *                 : P13L381H  - LETTER                         *          
      *                 : P13L381I  - LETTER                         *          
      *                 : P13L381J  - LETTER                         *          
      *                 : P13L381K  - LETTER                         *          
      *--------------------------------------------------------------*          
      * CHG-NO  BY   DATE     DETAILS                                *          
      *-------- ---- -------- ---------------------------------------*          
      *BP132370 SK   08072003 NEW PGM                                *          
      *BP132577 SK   20082004 INCLUDE BP13F915 (CDB FILE)            *          
      *BP132626 SK   09122004 CHANGE  BP13F915 LENGTH                *          
      *BP133017 CKK  30042007 INCLUDE WIA/B/C. COMMENTS OUT PRINTING *          
      *BP133056 CKK  18052007 ADD EXERCISE NAME IN LETTERS           *          
      *BP133168 RB12 04102007 ADD OPTION S3                          *          
      *BP133364 RB12 26062008 CHANGE 'MONTHLY' TEXT TO 'QUARTERLY'   *          
      *BP133430 LMS1 10092008 NEW SELECTION TYPE WIH                 *          
      *BP133508 ESA1 12012009 UPDATE OPTION S3 AND CATER FOR DNS,NF  *          
      *                       AND NC LETTERS ACCORDING TO ALLOC MODE *          
      *BP133544 ESA1 01062009 UPDATED THE PRODUCTION FORM            *          
      *BP133551 ESA1 19062009 UPDATED DJDE PORTION                   *          
      *BP134681 ESA1 20092012 CATER FOR 3-BYTES ZONE                 *          
      *BP135494 ESA1 07102014 TO CATER FOR EXTENSION OF SDS APPLN    *          
      *BP137200 FNP1 08032018 CHANGE 'DE' TXN-TYPE TO 'TE' IN F915   *          
      *BP137326 FNP1 06122018 BLANK OFF OTHER DETAILS WHEN CREATING  *          
      *                       'TE' FOR F915                                     
      *BP137918 KV6  09072019 TO CATER FOR REMOVAL OF DTE-DEFER-EXPI-*          
      *                       RY AND NUM-DEFER-ZONE-FT               *          
      *-------- ---- -------- ---------------------------------------*          
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F800 ASSIGN TO BP13F800.                                  
           SELECT BP13F205 ASSIGN TO BP13F205.                                  
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K800-NUM-REGN                              
                  FILE STATUS     IS WS-K800-STATUS.                            
                                                                                
           SELECT BP13K840 ASSIGN TO BP13K840                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K840-KEY-FLD                               
                  FILE STATUS     IS WS-K840-STATUS.                            
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD                               
                  FILE STATUS     IS WS-K820-STATUS.                            
                                                                                
           SELECT BP13K830 ASSIGN TO BP13K830                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K830-KEY-FLD                               
                  ALTERNATE KEY   IS K830-NUM-REGN                              
                  FILE STATUS     IS WS-K830-STATUS.                            
                                                                                
           SELECT BP13K848 ASSIGN TO BP13K848                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K848-KEY-FLD                               
                  FILE STATUS     IS WS-K848-STATUS.                            
                                                                                
           SELECT BP13K810 ASSIGN TO BP13K810                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K810-KEY-FLD                               
                  FILE STATUS     IS WS-K810-STATUS.                            
                                                                                
           SELECT BP13F915 ASSIGN TO BP13F915.                                  
           SELECT P13L381A ASSIGN TO P13L381A.                                  
           SELECT P13L381B ASSIGN TO P13L381B.                                  
           SELECT P13L381C ASSIGN TO P13L381C.                                  
           SELECT P13L381D ASSIGN TO P13L381D.                                  
           SELECT P13L381E ASSIGN TO P13L381E.                                  
           SELECT P13L381F ASSIGN TO P13L381F.                                  
           SELECT P13L381G ASSIGN TO P13L381G.                                  
           SELECT P13L381H ASSIGN TO P13L381H.                                  
           SELECT P13L381I ASSIGN TO P13L381I.                                  
           SELECT P13L381J ASSIGN TO P13L381J.                                  
           SELECT P13L381K ASSIGN TO P13L381K.                                  
                                                                                
      *--------------------------------------------------------------*          
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *--------------------------------------------------------------*          
                                                                                
       FD   BP13F205                                                            
            RECORD CONTAINS 80 CHARACTERS                                       
            RECORDING MODE  IS F.                                               
       COPY BP13F205.                                                           
                                                                                
       FD   BP13F800                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            RECORDING MODE  IS F.                                               
       COPY BP13F800.                                                           
                                                                                
       FD   BP13F915                                                            
            RECORD CONTAINS 800  CHARACTERS                                     
            RECORDING MODE  IS F.                                               
       COPY BP13F915.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K840                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K840.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K848                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K848.                                                           
                                                                                
       FD   BP13K810                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K810.                                                           
                                                                                
       FD   P13L381A                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE  IS F.                                               
       01   P13L381A-REC    PIC X(132).                                         
                                                                                
       FD   P13L381B                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE  IS F.                                               
       01   P13L381B-REC    PIC X(132).                                         
                                                                                
       FD   P13L381C                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381C-REC    PIC X(132).                                         
                                                                                
       FD   P13L381D                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381D-REC    PIC X(132).                                         
                                                                                
       FD   P13L381E                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381E-REC    PIC X(132).                                         
                                                                                
       FD   P13L381F                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381F-REC    PIC X(132).                                         
                                                                                
       FD   P13L381G                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381G-REC    PIC X(132).                                         
                                                                                
       FD   P13L381H                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381H-REC    PIC X(132).                                         
                                                                                
       FD   P13L381I                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381I-REC    PIC X(132).                                         
                                                                                
       FD   P13L381J                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381J-REC    PIC X(132).                                         
                                                                                
       FD   P13L381K                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   P13L381K-REC    PIC X(132).                                         
                                                                                
      *--------------------------------------------------------------*          
       WORKING-STORAGE SECTION.                                                 
      *--------------------------------------------------------------*          
                                                                                
       01  WS-FILE-CONTROLS.                                                    
           05  WS-F800-EOF                PIC X(1)  VALUE 'N'.                  
           05  WS-F205-EOF                PIC X(1)  VALUE 'N'.                  
           05  WS-K820-EOF                PIC X(1)  VALUE 'N'.                  
           05  WS-K820-FOUND              PIC X(1)  VALUE 'N'.                  
           05  WS-K840-FOUND              PIC X(1)  VALUE 'N'.                  
                                                                                
           05  WS-K800-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K840-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K820-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K830-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K848-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K810-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-F800-COUNTER            PIC 9(2)  VALUE 0.                    
                                                                                
       01  WS-MISCELLANEOUS-VARS.                                               
           05  WS-EDITED-DATE             PIC X(10) VALUE SPACES.               
           05  WS-NRIC                    PIC X(9)  VALUE SPACES.               
                                                                                
           05  WS-CNT-K800-UPD            PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K840-UPD            PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K840-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K848-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K810-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-CNT-F915-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-CNT-F800-READ           PIC 9(8)  VALUE 0.                    
           05  WS-CNT-F205-READ           PIC 9(8)  VALUE 0.                    
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-CCYY                PIC 9(4).                             
           05  WS-SYS-MM                  PIC 9(2).                             
           05  WS-SYS-DD                  PIC 9(2).                             
                                                                                
       01  WS-SYSTEM-TIME.                                                      
           05 WS-HH                       PIC 9(2).                             
           05 WS-MM                       PIC 9(2).                             
           05 WS-SS                       PIC 9(2).                             
           05 WS-MI                       PIC 9(2).                             
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05 FILLER                   PIC X(06) VALUE                          
             '01 JAN'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '02 FEB'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '03 MAR'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '04 APR'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '05 MAY'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '06 JUN'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '07 JUL'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '08 AUG'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '09 SEP'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '10 OCT'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '11 NOV'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '12 DEC'.                                                          
       01  FILLER  REDEFINES  WS-MONTHS-IN-DIGITS-AND-WORDS.                    
           05 WS-MONTH-TABLE               OCCURS 12                            
                                           INDEXED BY WS-MTH-IND.               
              10 WS-MONTH-IN-DIGITS    PIC X(02).                               
              10 FILLER                PIC X(01).                               
              10 WS-MONTH-IN-WORDS     PIC X(03).                               
                                                                                
       01  WS-L381-CONTROLS.                                                    
           05 WS-CNT-LINE-ON-PAGE-A       PIC 9(8)  VALUE 66.                   
           05 WS-CNT-PRINT-L381-A         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-WRITE-L381-A         PIC 9(8)  VALUE 0.                    
           05 WS-NO-OF-PAGE-A             PIC 9(8)  VALUE 0.                    
                                                                                
           05 WS-CNT-LINE-ON-PAGE-B       PIC 9(8)  VALUE 66.                   
           05 WS-CNT-PRINT-L381-B         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-WRITE-L381-B         PIC 9(8)  VALUE 0.                    
           05 WS-NO-OF-PAGE-B             PIC 9(8)  VALUE 0.                    
                                                                                
           05 WS-CNT-PRINT-L381-C         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-D         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-E         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-F         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-G         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-H         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-I         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-J         PIC 9(8)  VALUE 0.                    
           05 WS-CNT-PRINT-L381-K         PIC 9(8)  VALUE 0.                    
                                                                                
       01 WS-NUM-REGN                     PIC X(8)  VALUE SPACES.               
                                                                                
       01  DJDE-LINE-WIH-NF               PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E1,END;'.                                          
                                                                                
       01  DJDE-LINE-WIH-DNS              PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E2,END;'.                                          
                                                                                
       01  DJDE-LINE-WIH-NC               PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E0,END;'.                                          
                                                                                
       01  DJDE-LINE-3R-NF                PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E4,END;'.                                          
                                                                                
       01  DJDE-LINE-3R-DNS               PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E5,END;'.                                          
                                                                                
       01  DJDE-LINE-3R-NC                PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E3,END;'.                                          
                                                                                
       01  DJDE-LINE-SA-NF                PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E7,END;'.                                          
                                                                                
       01  DJDE-LINE-SA-DNS               PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E8,END;'.                                          
                                                                                
       01  DJDE-LINE-SA-NC                PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13E6,END;'.                                          
                                                                                
      *--------------------------------------------------------------*          
      *  LINKAGE FOR AV02C015                                                   
      *--------------------------------------------------------------*          
        01  WS-LINK-AV02C015.                                                   
            05  AV02C015-IN-POSTCODE         PIC X(6).                          
            05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                          
                                                                                
      *LETTER VARIABLES                                                         
                                                                                
       01  L381-LINE-1.                                                         
           05 FILLER                    PIC X(72)   VALUE SPACES.               
           05 L381-REFN-NO              PIC X(10)   VALUE SPACES.               
                                                                                
       01  L381-LINE-2.                                                         
           05 FILLER                    PIC X(72)  VALUE SPACES.                
           05 L381-CURR-DTE             PIC X(10)  VALUE SPACES.                
                                                                                
       01  L381-LINE-3.                                                         
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  L381-APPL-NAME           PIC X(66)  VALUE SPACES.                
                                                                                
       01  L381-LINE-4.                                                         
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  L381-SECOND-NAME         PIC X(66)  VALUE SPACES.                
                                                                                
       01  L381-LINE-5.                                                         
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  L381-BLK-NO              PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  L381-NUM-FLAT.                                                   
               10  L381-CHAR            PIC X      VALUE SPACES.                
               10  L381-LEVEL           PIC X(2)   VALUE SPACES.                
               10  L381-DASH            PIC X      VALUE SPACES.                
               10  L381-HSE-MAIN        PIC X(4)   VALUE SPACES.                
               10  L381-HSE-SUB         PIC X(3)   VALUE SPACES.                
           05  FILLER                   PIC X(38)  VALUE SPACES.                
                                                                                
       01  L381-LINE-6.                                                         
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  L381-STREET-NAME         PIC X(65)  VALUE SPACES.                
                                                                                
       01  L381-LINE-7.                                                         
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  L381-COUNTRY-NME         PIC X(10)  VALUE 'SINGAPORE '.          
           05  L381-POSTAL-CDE          PIC X(6)   VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '.'.                   
           05  FILLER                   PIC X(32)  VALUE SPACES.                
                                                                                
       01  L381-LINE-8.                                                         
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  L381-BAR-CODE            PIC X(9)   VALUE SPACES.                
                                                                                
       01  L381-LINE-9.                                                         
           05  FILLER                   PIC X(16)  VALUE SPACES.                
           05  L381-MTH-BALLOT          PIC X(03)  VALUE SPACES.                
           05  FILLER                   PIC X(01)  VALUE SPACES.                
           05  L381-YR-BALLOT           PIC X(04)  VALUE SPACES.                
           05  FILLER                   PIC X(107)  VALUE SPACES.               
                                                                                
      *--------------------------------------------------------------*          
      *         BP13L381  -  R E P O R T    L A Y O U T              *          
      *--------------------------------------------------------------*          
                                                                                
       01  L381-HEADER-01-A.                                                    
           05  FILLER              PIC X(08)     VALUE 'P13L381A'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  L381-RUN-DATE-A     PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  L381-PAGE-NO-A      PIC ZZZZ9 .                                  
                                                                                
       01  L381-HEADER-01-B.                                                    
           05  FILLER              PIC X(08)     VALUE 'P13L381B'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  L381-RUN-DATE-B     PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  L381-PAGE-NO-B      PIC ZZZZ9 .                                  
                                                                                
       01  L381-HEADER-02-A.                                                    
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(24)     VALUE                          
           'MONTHLY CANCELLATION OF '.                                          
           05  L381-ALLOC-MODE1    PIC X(03).                                   
           05  FILLER              PIC X(01)     VALUE SPACE.                   
           05  FILLER              PIC X(44)     VALUE                          
           'APPLICATION WITHOUT FLAT SELECTED UNDER CODE'.                      
           05  FILLER              PIC X(01)     VALUE SPACE.                   
           05  L381-CANCEL-CODE    PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACE.                   
           05  FILLER              PIC X(24) VALUE 'BY SITE OFFICE'.            
                                                                                
       01  L381-HEADER-02-B.                                                    
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(24)     VALUE                          
           'MONTHLY CANCELLATION OF '.                                          
           05  L381-ALLOC-MODE2    PIC X(03).                                   
           05  FILLER              PIC X(01)     VALUE SPACE.                   
           05  FILLER              PIC X(44)     VALUE                          
           'APPLICATION WITHOUT FLAT SELECTED UNDER CODE'.                      
           05  FILLER              PIC X(01)     VALUE SPACE.                   
           05  L381-CANCEL-CODE2   PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACE.                   
           05  FILLER              PIC X(24) VALUE 'AT HDB HUB'.                
                                                                                
       01  L381-HEADER-03.                                                      
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(05)    VALUE 'S/N  '.                  
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(08)    VALUE 'REGN NO'.                
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(10)    VALUE 'APPL DATE'.              
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(06)    VALUE 'ESTATE'.                 
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(10)    VALUE 'FLAT TYPE'.              
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(10)    VALUE 'NRIC-1'.                 
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(10)    VALUE 'NRIC-2'.                 
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(10)    VALUE 'ALLC MODE'.              
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(10)    VALUE 'BALT DATE'.              
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(08)    VALUE 'USER ID'.                
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(15)    VALUE 'APPMT DATE/TIME'.        
                                                                                
       01  L381-HEADER-04.                                                      
           05  FILLER              PIC X(130)    VALUE ALL '-'.                 
                                                                                
       01  L381-PR-DETAIL.                                                      
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-SLNO           PIC ZZZZ9.                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-REGN-NO        PIC X(08).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-APPL-DATE      PIC X(10).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-ESTATE         PIC X(06).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-FLAT-TYPE      PIC X(10).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  L381-NRIC1          PIC X(10).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-NRIC2          PIC X(10).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-ALLOC-MODE     PIC X(10).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-BALLOT-DTE     PIC X(07).                                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  L381-USER-ID        PIC X(08).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L381-APPMT-DATE     PIC X(10).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  L381-APPMT-TIME     PIC X(05).                                   
                                                                                
      *--------------------------------------------------------------*          
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------------*          
                                                                                
      *--------------------------------------------------------------*          
       0000-MAIN-ROUTINE.                                                       
      *--------------------------------------------------------------*          
                                                                                
           PERFORM 1000-OPEN-ROUTINE      THRU 1000-EXIT.                       
           PERFORM 1100-READ-F205         THRU 1100-EXIT.                       
                                                                                
           PERFORM 2000-PROCESS           THRU 2000-EXIT                        
                UNTIL WS-F205-EOF = 'Y'.                                        
                                                                                
           PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT.                       
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       1000-OPEN-ROUTINE.                                                       
      *--------------------------------------------------------------*          
                                                                                
           OPEN INPUT  BP13F800                                                 
                       BP13F205                                                 
                       BP13K820                                                 
                       BP13K830                                                 
                I-O    BP13K800                                                 
                       BP13K840                                                 
                       BP13K848                                                 
                       BP13K810                                                 
                OUTPUT P13L381A                                                 
                       P13L381B                                                 
                       P13L381C                                                 
                       P13L381D                                                 
                       P13L381E                                                 
                       P13L381F                                                 
                       P13L381G                                                 
                       P13L381H                                                 
                       P13L381I                                                 
                       P13L381J                                                 
                       P13L381K                                                 
                       BP13F915.                                                
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 OPEN ERROR, STATUS IS ' WS-K800-STATUS          
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K840-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K840 OPEN ERROR, STATUS IS ' WS-K840-STATUS          
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 OPEN ERROR, STATUS IS ' WS-K820-STATUS          
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K830 OPEN ERROR, STATUS IS ' WS-K830-STATUS          
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K848-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K848 OPEN ERROR, STATUS IS ' WS-K848-STATUS          
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K810-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K810 OPEN ERROR, STATUS IS ' WS-K810-STATUS          
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYSTEM-DATE.                   
                                                                                
           STRING WS-SYS-DD '/' WS-SYS-MM '/' WS-SYS-CCYY                       
                  DELIMITED BY SIZE                                             
                  INTO WS-EDITED-DATE                                           
           END-STRING.                                                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       1100-READ-F205.                                                          
      *--------------------------------------------------------------*          
                                                                                
           READ BP13F205                                                        
                AT END  MOVE 'Y' TO WS-F205-EOF                                 
                MOVE 'Y' TO WS-F800-EOF                                         
                GO TO 1100-EXIT                                                 
           END-READ.                                                            
                                                                                
           ADD 1 TO WS-CNT-F205-READ.                                           
                                                                                
       1100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       1200-READ-F800.                                                          
      *--------------------------------------------------------------*          
                                                                                
           READ BP13F800                                                        
                AT END  MOVE 'Y' TO WS-F800-EOF                                 
                GO TO 1200-EXIT                                                 
           END-READ.                                                            
                                                                                
           IF WS-F800-COUNTER = 0                                               
              ADD 1 TO WS-CNT-F800-READ                                         
           END-IF.                                                              
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       1300-CLOSE-OPEN-F800.                                                    
      *--------------------------------------------------------------*          
                                                                                
           CLOSE      BP13F800.                                                 
           OPEN INPUT BP13F800.                                                 
                                                                                
           ADD 1      TO WS-F800-COUNTER.                                       
           MOVE 'N'   TO WS-F800-EOF.                                           
                                                                                
       1300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       2000-PROCESS.                                                            
      *--------------------------------------------------------------*          
           PERFORM 3000-PROCESS1     THRU 3000-EXIT                             
                   UNTIL WS-F800-EOF = 'Y'.                                     
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       3000-PROCESS1.                                                           
      *--------------------------------------------------------------*          
           PERFORM 1200-READ-F800    THRU 1200-EXIT.                            
                                                                                
           IF WS-F800-EOF = 'Y'                                                 
              PERFORM 1100-READ-F205        THRU 1100-EXIT                      
                                                                                
              IF WS-F205-EOF = 'Y'                                              
                 GO TO 3000-EXIT                                                
              END-IF                                                            
                                                                                
              PERFORM 1300-CLOSE-OPEN-F800  THRU 1300-EXIT                      
                                                                                
              IF F205-NUM-OPTION = 'S1' OR 'S2' OR 'S3'                         
                 PERFORM 1200-READ-F800        THRU 1200-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 3500-VALIDATE     THRU 3500-EXIT.                            
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       3500-VALIDATE.                                                           
      *--------------------------------------------------------------*          
           EVALUATE F205-NUM-OPTION                                             
             WHEN 'S1'                                                          
              IF F205-DTE-ALLOCN-NEW NOT = SPACES AND LOW-VALUES AND            
                 ALL '0'                                                        
                 IF ( ( F205-NUM-NT-ZONE-SW = F800-NUM-APPLN-TYPE ) AND         
                      ( F205-NUM-SELECTION = F800-NUM-ALLO-CAT )    AND         
                      ( F205-DTE-BALLOT    = F800-DTE-BALLOT )      AND         
                      ( F205-DTE-ALLOCN   <= F800-DTE-REGN )        AND         
                      ( F205-DTE-ALLOCN-NEW >= F800-DTE-REGN ) )                
                                                                                
                       PERFORM 3600-PRINT   THRU 3600-EXIT                      
                 END-IF                                                         
              ELSE                                                              
                 IF ( ( F205-NUM-NT-ZONE-SW = F800-NUM-APPLN-TYPE ) AND         
                      ( F205-NUM-SELECTION = F800-NUM-ALLO-CAT )    AND         
                      ( F205-DTE-BALLOT    = F800-DTE-BALLOT )      AND         
                      ( F205-DTE-ALLOCN    = F800-DTE-REGN ) )                  
                                                                                
                       PERFORM 3600-PRINT   THRU 3600-EXIT                      
                 END-IF                                                         
              END-IF                                                            
                                                                                
             WHEN 'S2'                                                          
              IF F205-DTE-ALLOCN-NEW NOT = SPACES AND LOW-VALUES AND            
                 ALL '0'                                                        
                 IF ( ( F205-NUM-NT-ZONE-SW = F800-NUM-APPLN-TYPE ) AND         
                      ( F205-NUM-SELECTION = F800-NUM-ALLO-CAT )    AND         
                      ( F205-DTE-BALLOT    = F800-DTE-BALLOT )      AND         
                      ( F205-DTE-ALLOCN   <= F800-DTE-BK-APPT )     AND         
                      ( F205-DTE-ALLOCN-NEW >= F800-DTE-BK-APPT ) )             
                                                                                
                       PERFORM 3600-PRINT   THRU 3600-EXIT                      
                 END-IF                                                         
              ELSE                                                              
                 IF ( ( F205-NUM-NT-ZONE-SW = F800-NUM-APPLN-TYPE ) AND         
                      ( F205-NUM-SELECTION = F800-NUM-ALLO-CAT )    AND         
                      ( F205-DTE-BALLOT    = F800-DTE-BALLOT )      AND         
                      ( F205-DTE-ALLOCN    = F800-DTE-BK-APPT ) )               
                                                                                
                       PERFORM 3600-PRINT   THRU 3600-EXIT                      
                 END-IF                                                         
              END-IF                                                            
                                                                                
             WHEN 'S3'                                                          
                 IF ((F205-NUM-NT-ZONE-SW = F800-NUM-APPLN-TYPE ) AND           
                      ( F205-DTE-BALLOT    = F800-DTE-BALLOT )      AND         
                      ( F205-START-QUEUE <= F800-NUM-ZONE-FT-QUEUE) AND         
                      ( F205-END-QUEUE >= F800-NUM-ZONE-FT-QUEUE))              
                    IF F205-CDE-LETTER = 2                                      
                     IF ((F205-CDE-CATEGORY = 0 AND F800-NUM-CAT = 0) OR        
                        (F205-CDE-CATEGORY = 1 AND F800-NUM-CAT = 1) OR         
                        (F205-CDE-CATEGORY = 2 AND F800-NUM-CAT = 2) OR         
                        ((F205-CDE-CATEGORY = 3) AND                            
                         (F800-NUM-CAT = 3 OR 4)))                              
                         CONTINUE                                               
                     ELSE                                                       
                        GO TO 3500-EXIT                                         
                     END-IF                                                     
                    END-IF                                                      
                    IF (((F205-NUM-SELECTION = 'SA') AND                        
                        (F800-NUM-ALLO-CAT = '3R')    AND                       
                        (F800-NUM-FLAT-TYPE = '1A'))  OR                        
                        (F205-NUM-SELECTION = F800-NUM-ALLO-CAT ))              
                                                                                
                        PERFORM 3600-PRINT   THRU 3600-EXIT                     
                    END-IF                                                      
                 END-IF                                                         
           END-EVALUATE.                                                        
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       3600-PRINT.                                                              
      *--------------------------------------------------------------*          
                                                                                
           MOVE SPACES                 TO L381-APPL-NAME                        
                                          L381-SECOND-NAME                      
                                          L381-LINE-5                           
                                          L381-LINE-6                           
                                          L381-POSTAL-CDE                       
                                          L381-LINE-8                           
                                          L381-LINE-9.                          
                                                                                
           MOVE F800-NUM-REGN         TO WS-NUM-REGN.                           
                                                                                
           PERFORM 5000-READ-K800     THRU 5000-EXIT.                           
           PERFORM 6000-READ-K840     THRU 6000-EXIT.                           
                                                                                
           IF F205-NUM-NT-ZONE-SW = 'S'                                         
              PERFORM 7000-WRITE-P13L381A THRU 7000-EXIT                        
           ELSE                                                                 
              IF F205-NUM-NT-ZONE-SW = 'C' OR 'I'                               
                 PERFORM 8000-WRITE-P13L381B THRU 8000-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 6500-READ-BP13K830 THRU 6500-EXIT.                           
           PERFORM 9000-PRINT-LETTER  THRU 9000-EXIT.                           
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5000-READ-K800.                                                          
      *--------------------------------------------------------------*          
            MOVE LOW-VALUES            TO K800-NUM-REGN.                        
            MOVE WS-NUM-REGN           TO K800-NUM-REGN.                        
                                                                                
            READ BP13K800.                                                      
                                                                                
            EVALUATE WS-K800-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6700-WRITE-K800-IMAGE THRU 6700-EXIT                
                    PERFORM 6800-WRITE-K810       THRU 6800-EXIT                
                    PERFORM 5100-MOVE-PARA        THRU 5100-EXIT                
                    PERFORM 5200-REWRITE-K800     THRU 5200-EXIT                
                    PERFORM 7200-WRITE-CDB        THRU 7200-EXIT                
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K800. STATUS IS '                
                            WS-K800-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5100-MOVE-PARA.                                                          
      *--------------------------------------------------------------*          
                                                                                
           MOVE 'C'               TO K800-NUM-STATUS.                           
                                                                                
           IF F205-CDE-LETTER = 1                                               
              MOVE 'C4'              TO K800-NUM-CANCEL-REASON                  
           ELSE                                                                 
              IF F205-CDE-LETTER = 2                                            
                 MOVE '83'           TO K800-NUM-CANCEL-REASON                  
              ELSE                                                              
                 MOVE 'F1'           TO K800-NUM-CANCEL-REASON                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SYSTEM-DATE    TO K800-DTE-CANCEL                            
                                     K800-DTE-UPDATE.                           
           MOVE SPACES            TO K800-DTE-LETTER-RECV-CAN.                  
                                                                                
           IF F800-NUM-HALF-IDP = 'A' OR 'Q'                                    
              MOVE SPACES    TO K800-NUM-HALF-IDP                               
           END-IF.                                                              
                                                                                
           MOVE 'N'               TO K800-NUM-REGN-REFUND.                      
           MOVE WS-SYSTEM-DATE    TO K800-DTE-REQ-CANCEL.                       
           MOVE SPACES            TO K800-TME-QUEUE                             
                                     K800-TME-QUEUE-PRIO-IFPA                   
                                     K800-NUM-SHORTLIST-PA-HHTY                 
                                     K800-NUM-SHORTLIST-PA-CAT                  
                                     K800-NUM-SHORTLIST-PRIO-HHTY               
                                     K800-NUM-SHORTLIST-PRIO-CAT                
                                     K800-NUM-SLIST-PA-ZNFT                     
                                     K800-NUM-SLIST-PA-ZNFT-CAT                 
                                     K800-NUM-SLIST-PRIO-ZNFT                   
                                     K800-NUM-SLIST-PRIO-ZNFT-CAT.              
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5200-REWRITE-K800.                                                       
      *--------------------------------------------------------------*          
                                                                                
            REWRITE BP13K800-MASTER.                                            
                                                                                
            EVALUATE WS-K800-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1    TO WS-CNT-K800-UPD                                 
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR UPDATING BP13K800. STATUS IS '               
                            WS-K800-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6000-READ-K840.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'N'              TO WS-K840-FOUND                              
            MOVE LOW-VALUES       TO K840-NUM-REGN.                             
            MOVE WS-NUM-REGN      TO K840-NUM-REGN.                             
                                                                                
            READ BP13K840.                                                      
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6100-MOVE-PARA      THRU 6100-EXIT                  
                    PERFORM 6200-REWRITE-K840   THRU 6200-EXIT                  
               WHEN 23                                                          
                    PERFORM 6300-WRITE-K840     THRU 6300-EXIT                  
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K840. STATUS IS '                
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6100-MOVE-PARA.                                                          
      *--------------------------------------------------------------*          
                                                                                
           MOVE WS-NUM-REGN           TO K840-NUM-REGN.                         
                                                                                
           IF F205-CDE-LETTER = 1                                               
              MOVE 'C4'              TO K840-NUM-CANCEL                         
           ELSE                                                                 
              IF F205-CDE-LETTER = 2                                            
                 MOVE '83'           TO K840-NUM-CANCEL                         
              ELSE                                                              
                 MOVE 'F1'           TO K840-NUM-CANCEL                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SYSTEM-DATE        TO K840-DTE-CANCEL                        
                                         K840-DTE-UPDATE.                       
           MOVE 'P13C381'             TO K840-NUM-USERID.                       
                                                                                
           MOVE K800-DTE-REGN         TO K840-DTE-REGN.                         
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6110-MOVE-PARA1.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE K800-NUM-ZONE            TO K840-NUM-ZONE.                      
           MOVE K800-NUM-BTO-ZONE        TO K840-NUM-BTO-ZONE.                  
           MOVE K800-NUM-FLAT-TYPE       TO K840-NUM-FLAT-TYPE.                 
           MOVE K800-NUM-NEW-TOWN        TO K840-NUM-NEW-TOWN.                  
           MOVE K800-NUM-IDP-SCHEME      TO K840-NUM-IDP-SCH.                   
           MOVE K800-NUM-ALLO-SCHEME     TO K840-NUM-ALLOC-SCH.                 
                                                                                
       6110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6120-MOVE-PARA2.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE K800-NUM-NRIC1      TO K840-NUM-NRIC1                           
                                       WS-NRIC.                                 
           MOVE WS-NUM-REGN         TO L381-REFN-NO.                            
           MOVE WS-EDITED-DATE      TO L381-CURR-DTE.                           
                                                                                
           MOVE 'N' TO WS-K820-FOUND.                                           
                                                                                
           PERFORM 6400-READ-BP13K820    THRU 6400-EXIT.                        
                                                                                
           IF WS-K820-FOUND = 'Y'                                               
              IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                      
                 MOVE K820-NME-OCCP  TO K840-NME-APPL1                          
                                        L381-APPL-NAME                          
              ELSE                                                              
                 MOVE SPACES         TO K840-NME-APPL1                          
                                        L381-APPL-NAME                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF (K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                  
              (K800-NUM-NRIC2(1:1) NOT = '#')                                   
              MOVE K800-NUM-NRIC2        TO K840-NUM-NRIC2                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
              PERFORM 6400-READ-BP13K820 THRU 6400-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL2                       
                                           L381-SECOND-NAME                     
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL2                       
                                           L381-SECOND-NAME                     
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC2                      
              MOVE K840-NUM-NRIC2 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL2                             
                                     L381-SECOND-NAME                           
           END-IF.                                                              
                                                                                
           IF (K800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES) AND                  
              (K800-NUM-NRIC3(1:1) NOT = '#')                                   
              MOVE K800-NUM-NRIC3        TO K840-NUM-NRIC3                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
              PERFORM 6400-READ-BP13K820 THRU 6400-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL3                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL3                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC3                      
              MOVE K840-NUM-NRIC3 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL3                             
           END-IF.                                                              
                                                                                
           IF (K800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES) AND                  
              (K800-NUM-NRIC4(1:1) NOT = '#')                                   
              MOVE K800-NUM-NRIC4        TO K840-NUM-NRIC4                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
                                                                                
              PERFORM 6400-READ-BP13K820 THRU 6400-EXIT                         
                                                                                
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL4                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL4                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC4                      
              MOVE K840-NUM-NRIC4 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL4                             
           END-IF.                                                              
                                                                                
                                                                                
       6120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6200-REWRITE-K840.                                                       
      *--------------------------------------------------------------*          
                                                                                
            REWRITE BP13K840-REC.                                               
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1 TO WS-CNT-K840-UPD                                    
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR UPDATING BP13K840. STATUS IS '               
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6300-WRITE-K840.                                                         
      *--------------------------------------------------------------*          
                                                                                
            MOVE SPACES              TO BP13K840-REC.                           
            INITIALIZE                  BP13K840-REC.                           
                                                                                
            MOVE 'Y'                 TO WS-K840-FOUND.                          
                                                                                
            PERFORM 6100-MOVE-PARA   THRU 6100-EXIT.                            
            PERFORM 6110-MOVE-PARA1  THRU 6110-EXIT.                            
            PERFORM 6120-MOVE-PARA2  THRU 6120-EXIT.                            
                                                                                
            WRITE BP13K840-REC.                                                 
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1 TO WS-CNT-K840-WRITE                                  
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K840. STATUS IS '                
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6400-READ-BP13K820.                                                      
      *--------------------------------------------------------------*          
                                                                                
            MOVE LOW-VALUES            TO K820-KEY-FLD.                         
            MOVE WS-NUM-REGN           TO K820-NUM-REGN.                        
            MOVE WS-NRIC               TO K820-NUM-NRIC.                        
                                                                                
            READ BP13K820.                                                      
                                                                                
            EVALUATE WS-K820-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    MOVE 'Y' TO WS-K820-FOUND                                   
                    CONTINUE                                                    
               WHEN 23                                                          
                    DISPLAY 'NOT FOUND IN BP13K820, KEY '                       
                            K820-KEY-FLD                                        
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K820. STATUS IS '                
                            WS-K820-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6500-READ-BP13K830.                                                      
      *--------------------------------------------------------------*          
                                                                                
            MOVE WS-NUM-REGN    TO K830-NUM-REGN.                               
                                                                                
            READ BP13K830 KEY IS   K830-NUM-REGN.                               
                                                                                
            EVALUATE WS-K830-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    CONTINUE                                                    
               WHEN 23                                                          
                    DISPLAY 'NOT FOUND IN BP13K830, REGN'                       
                            K830-NUM-REGN                                       
                    GO TO 6500-EXIT                                             
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K830. STATUS IS '                
                            WS-K830-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
            IF K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES                        
             IF K830-NUM-ADDR-TYPE = 'H'                                        
                MOVE SPACES                TO L381-STREET-NAME                  
                MOVE K830-NUM-BLK          TO L381-BLK-NO                       
                MOVE K830-NME-STREET       TO L381-STREET-NAME                  
                MOVE K830-NUM-LVL-CHAR     TO L381-CHAR                         
                MOVE K830-NUM-LVL-NUM      TO L381-LEVEL                        
                MOVE K830-NUM-LVL-DASH     TO L381-DASH                         
                MOVE K830-NUM-HSEMAIN      TO L381-HSE-MAIN                     
                MOVE K830-NUM-HSESUB       TO L381-HSE-SUB                      
                                                                                
                IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES             
                   MOVE SPACES             TO L381-COUNTRY-NME                  
                   MOVE SPACES             TO L381-POSTAL-CDE                   
                ELSE                                                            
                   MOVE 'SINGAPORE'        TO L381-COUNTRY-NME                  
                   MOVE K830-NUM-POSTAL    TO L381-POSTAL-CDE                   
                END-IF                                                          
             ELSE                                                               
                MOVE SPACES                TO L381-STREET-NAME                  
                MOVE K830-NUM-BLK          TO L381-BLK-NO                       
                MOVE K830-NME-STREET-BLDG  TO L381-STREET-NAME                  
                MOVE K830-NUM-FLAT         TO L381-NUM-FLAT                     
                                                                                
                IF K830-NUM-POSTAL =  SPACES OR LOW-VALUES OR ZEROES            
                   MOVE SPACES             TO L381-COUNTRY-NME                  
                   MOVE SPACES             TO L381-POSTAL-CDE                   
                ELSE                                                            
                   MOVE 'SINGAPORE'        TO L381-COUNTRY-NME                  
                   MOVE K830-NUM-POSTAL    TO L381-POSTAL-CDE                   
                END-IF                                                          
             END-IF                                                             
                                                                                
             MOVE SPACES                       TO WS-LINK-AV02C015              
             MOVE K830-NUM-POSTAL              TO AV02C015-IN-POSTCODE          
             PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT                   
             MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L381-BAR-CODE                 
                                                                                
            ELSE                                                                
             IF K830-NUM-MAIL-ADDR-TYPE = 'H'                                   
                MOVE SPACES                   TO L381-STREET-NAME               
                MOVE K830-NUM-MAIL-BLK        TO L381-BLK-NO                    
                MOVE K830-NME-MAIL-STREET     TO L381-STREET-NAME               
                MOVE K830-NUM-MAIL-LVL-CHAR   TO L381-CHAR                      
                MOVE K830-NUM-MAIL-LVL-NUM    TO L381-LEVEL                     
                MOVE K830-NUM-MAIL-LVL-DASH   TO L381-DASH                      
                MOVE K830-NUM-MAIL-HSEMAIN    TO L381-HSE-MAIN                  
                MOVE K830-NUM-MAIL-HSESUB     TO L381-HSE-SUB                   
                                                                                
                IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROES        
                   MOVE SPACES                TO L381-POSTAL-CDE                
                   MOVE SPACES                TO L381-COUNTRY-NME               
                ELSE                                                            
                   MOVE 'SINGAPORE'           TO L381-COUNTRY-NME               
                   MOVE K830-NUM-MAIL-POSTAL  TO L381-POSTAL-CDE                
                END-IF                                                          
             ELSE                                                               
                MOVE SPACES                   TO L381-STREET-NAME               
                MOVE K830-NUM-MAIL-BLK        TO L381-BLK-NO                    
                MOVE K830-NME-MAIL-STR-BLDG   TO L381-STREET-NAME               
                MOVE K830-NUM-MAIL-FLAT       TO L381-NUM-FLAT                  
                                                                                
                IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROES        
                   MOVE SPACES                TO L381-POSTAL-CDE                
                   MOVE SPACES                TO L381-COUNTRY-NME               
                ELSE                                                            
                   MOVE 'SINGAPORE'           TO L381-COUNTRY-NME               
                   MOVE K830-NUM-MAIL-POSTAL  TO L381-POSTAL-CDE                
                END-IF                                                          
             END-IF                                                             
                                                                                
             MOVE SPACES                       TO WS-LINK-AV02C015              
             MOVE K830-NUM-POSTAL              TO AV02C015-IN-POSTCODE          
             PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT                   
             MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L381-BAR-CODE                 
                                                                                
            END-IF.                                                             
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6600-CALL-AV02C015.                                                      
      *--------------------------------------------------------------*          
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6700-WRITE-K800-IMAGE.                                                   
      *--------------------------------------------------------------*          
                                                                                
           MOVE BP13K800-MASTER TO BP13K848-MASTER.                             
           MOVE 'C381'          TO K848-NUM-TRANS-BKIMAGE.                      
                                                                                
           MOVE F205-NUM-USERID TO K848-NUM-USERID.                             
           MOVE WS-SYSTEM-DATE  TO K848-DTE-BKIMAGE.                            
                                                                                
           MOVE FUNCTION CURRENT-DATE(9:8) TO WS-SYSTEM-TIME.                   
                                                                                
           MOVE WS-SYSTEM-TIME  TO K848-TME-BKIMAGE.                            
           MOVE K848-NUM-REGN   TO K848-NUM-REGN-BKIMAGE.                       
                                                                                
           WRITE BP13K848-MASTER.                                               
                                                                                
           EVALUATE WS-K848-STATUS                                              
               WHEN 00                                                          
                    ADD 1 TO WS-CNT-K848-WRITE                                  
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K848. STATUS IS '                
                            WS-K848-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6800-WRITE-K810.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE SPACES                 TO BP13K810-MASTER.                      
           INITIALIZE                     BP13K810-MASTER.                      
                                                                                
           MOVE K800-NUM-REGN          TO K810-NUM-REGN                         
                                          WS-NUM-REGN.                          
           MOVE WS-SYSTEM-DATE         TO K810-DTE-UPDATE.                      
           MOVE FUNCTION CURRENT-DATE(9:8) TO WS-SYSTEM-TIME.                   
                                                                                
           MOVE WS-SYSTEM-TIME(1:7)    TO K810-TME-UPDATE.                      
           MOVE SPACES                 TO K810-NUM-REF.                         
           MOVE 'C'                    TO K810-NUM-STATUS                       
           MOVE K800-NUM-NRIC1         TO K810-NUM-NRIC1.                       
           MOVE K800-NUM-NRIC2         TO K810-NUM-NRIC2.                       
           MOVE K800-NUM-NRIC3         TO K810-NUM-NRIC3.                       
           MOVE K800-NUM-NRIC4         TO K810-NUM-NRIC4.                       
           MOVE K800-NUM-ZONE          TO K810-NUM-ZONE.                        
           MOVE K800-NUM-FLAT-TYPE     TO K810-NUM-FLAT-TYPE.                   
           MOVE K800-NUM-NEW-TOWN      TO K810-NUM-NEW-TOWN.                    
           MOVE K800-NUM-IDP-SCHEME    TO K810-NUM-IDP-SCHEME.                  
           MOVE K800-NUM-ALLO-SCHEME   TO K810-NUM-ALLO-SCHEME.                 
           MOVE K800-NUM-ELIG-SCHEME   TO K810-NUM-ELIG-SCHEME.                 
           MOVE K800-NUM-CAT           TO K810-NUM-CAT.                         
           MOVE K800-NUM-HOUSEHOLD     TO K810-NUM-HOUSEHOLD.                   
           MOVE SPACES                 TO K810-DTE-CHANGE-ZONE-FT.              
           MOVE K800-QTY-JT-BALLOT     TO K810-QTY-JT-BALLOT.                   
           MOVE K800-NUM-JT-BALLOT-MTF TO K810-NUM-JT-BALLOT.                   
           MOVE K800-NUM-SCH-ACC       TO K810-NUM-SCH-ACC.                     
           MOVE K800-NUM-CUR-REGN      TO K810-NUM-CUR-REGN.                    
           MOVE SPACES                 TO K810-NUM-DEFER-TAG.                   
           MOVE K800-NUM-WAIT-TIME     TO K810-NUM-WAIT-TIME.                   
           MOVE K800-NUM-ZONE-FT-QUEUE TO K810-NUM-ZONE-FT-QUEUE.               
           MOVE K800-NUM-5YR-OCCUPN    TO K810-NUM-5YR-OCCUPN.                  
           MOVE K800-NUM-PARENT-CHILD  TO K810-NUM-PARENT-CHILD.                
           MOVE K800-NUM-HOLDING-TYPE  TO K810-NUM-HOLDING-TYPE.                
           MOVE K800-NUM-SHORTLIST-PA-HHTY                                      
                                       TO K810-NUM-SHORTLIST-PA-HHTY.           
           MOVE K800-NUM-SHORTLIST-PA-CAT                                       
                                       TO K810-NUM-SHORTLIST-PA-CAT.            
           MOVE K800-NUM-SHORTLIST-PRIO-HHTY                                    
                                       TO K810-NUM-SHORTLIST-PRIO-HHTY.         
           MOVE K800-NUM-SHORTLIST-PRIO-CAT                                     
                                       TO K810-NUM-SHORTLIST-PRIO-CAT.          
           MOVE K800-DTE-BALLOT        TO K810-DTE-BALLOT.                      
                                                                                
           MOVE  K800-NUM-BTO-ZONE      TO  K810-NUM-BTO-ZONE.                  
                                                                                
           MOVE K800-TME-QUEUE         TO K810-TME-QUEUE.                       
           MOVE K800-TME-QUEUE         TO K810-TME-QUEUE.                       
           MOVE K800-NUM-JT-BALLOT-REGN TO K810-NUM-JT-BALLOT-REGN-1.           
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-2.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-3.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-4.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-5.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-6.            
           MOVE K800-NUM-LOAN-TAG      TO K810-NUM-LOAN-TAG.                    
           MOVE F205-NUM-USERID        TO K810-NUM-USERID.                      
                                                                                
           IF  K800-NUM-NRIC1      NOT = SPACES AND LOW-VALUES                  
               MOVE K800-NUM-NRIC1     TO WS-NRIC                               
               PERFORM 6400-READ-BP13K820 THRU 6400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA1                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA1.                         
                                                                                
           IF  (K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                 
               (K800-NUM-NRIC2(1:1) NOT = '#')                                  
               MOVE K800-NUM-NRIC2     TO WS-NRIC                               
               PERFORM 6400-READ-BP13K820 THRU 6400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA2                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA2.                         
                                                                                
           IF  (K800-NUM-NRIC3      NOT = SPACES AND LOW-VALUES) AND            
               (K800-NUM-NRIC3(1:1) NOT = '#')                                  
               MOVE K800-NUM-NRIC3     TO WS-NRIC                               
               PERFORM 6400-READ-BP13K820 THRU 6400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA3                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA3.                         
                                                                                
           IF  (K800-NUM-NRIC4      NOT = SPACES AND LOW-VALUES) AND            
               (K800-NUM-NRIC4(1:1) NOT = '#')                                  
               MOVE K800-NUM-NRIC4     TO WS-NRIC                               
               PERFORM 6400-READ-BP13K820 THRU 6400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA4                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA4.                         
                                                                                
           MOVE 'C381'                 TO K810-NUM-SCREENID.                    
                                                                                
           WRITE BP13K810-MASTER.                                               
                                                                                
           EVALUATE WS-K810-STATUS                                              
               WHEN 00                                                          
                    ADD 1 TO WS-CNT-K810-WRITE                                  
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K810. STATUS IS '                
                            WS-K810-STATUS                                      
                    DISPLAY K810-KEY-FLD ' KEY 810'                             
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------*          
       7000-WRITE-P13L381A.                                                     
      *--------------------------------------------------------------*          
                                                                                
           IF WS-CNT-LINE-ON-PAGE-A > 54                                        
              PERFORM 7100-PRINT-HEADING THRU 7100-EXIT                         
              MOVE 1  TO WS-CNT-LINE-ON-PAGE-A                                  
           END-IF.                                                              
                                                                                
           MOVE SPACES              TO P13L381A-REC.                            
           INITIALIZE                  P13L381A-REC.                            
                                                                                
           ADD   1                TO WS-CNT-PRINT-L381-A.                       
           MOVE WS-CNT-PRINT-L381-A TO L381-SLNO.                               
           MOVE WS-NUM-REGN         TO L381-REGN-NO.                            
                                                                                
           STRING K800-DTE-REGN(7:2) '/'                                        
                  K800-DTE-REGN(5:2) '/'                                        
                  K800-DTE-REGN(1:4)                                            
                  DELIMITED BY SIZE                                             
                  INTO L381-APPL-DATE                                           
           END-STRING.                                                          
                                                                                
           MOVE K800-NUM-NEW-TOWN   TO L381-ESTATE.                             
           MOVE K800-NUM-FLAT-TYPE  TO L381-FLAT-TYPE.                          
           MOVE K800-NUM-NRIC1      TO L381-NRIC1.                              
           MOVE K800-NUM-NRIC2      TO L381-NRIC2.                              
           MOVE K800-NUM-ALLO-CAT   TO L381-ALLOC-MODE.                         
                                                                                
           STRING K800-DTE-BALLOT(5:2) '/'                                      
                  K800-DTE-BALLOT(1:4)                                          
                  DELIMITED BY SIZE                                             
                  INTO L381-BALLOT-DTE                                          
           END-STRING.                                                          
                                                                                
           MOVE F205-NUM-USERID   TO L381-USER-ID.                              
                                                                                
           STRING K800-DTE-BK-APPT(7:2) '/'                                     
                  K800-DTE-BK-APPT(5:2) '/'                                     
                  K800-DTE-BK-APPT(1:4)                                         
                  DELIMITED BY SIZE                                             
                  INTO L381-APPMT-DATE                                          
           END-STRING.                                                          
                                                                                
           STRING K800-TME-BK-APPT(1:2) ':'                                     
                  K800-TME-BK-APPT(3:2)                                         
                  DELIMITED BY SIZE                                             
                  INTO L381-APPMT-TIME                                          
           END-STRING.                                                          
                                                                                
           WRITE P13L381A-REC     FROM L381-PR-DETAIL AFTER 1.                  
           ADD   1                TO WS-CNT-LINE-ON-PAGE-A.                     
           MOVE  SPACES           TO L381-PR-DETAIL.                            
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7100-PRINT-HEADING.                                                      
      *--------------------------------------------------------------*          
                                                                                
           ADD  1                TO   WS-NO-OF-PAGE-A.                          
           MOVE WS-NO-OF-PAGE-A  TO   L381-PAGE-NO-A.                           
           MOVE WS-EDITED-DATE   TO   L381-RUN-DATE-A.                          
                                                                                
           MOVE SPACES           TO   P13L381A-REC.                             
           INITIALIZE                 P13L381A-REC.                             
                                                                                
           WRITE P13L381A-REC  AFTER  PAGE.                                     
                                                                                
           WRITE P13L381A-REC  FROM   L381-HEADER-01-A AFTER 1.                 
           MOVE  F205-NUM-SELECTION   TO L381-ALLOC-MODE1.                      
                                                                                
           IF F205-CDE-LETTER = 1                                               
              MOVE 'C4'              TO L381-CANCEL-CODE                        
           ELSE                                                                 
              IF F205-CDE-LETTER = 2                                            
                 MOVE '83'           TO L381-CANCEL-CODE                        
              ELSE                                                              
                 MOVE 'F1'           TO L381-CANCEL-CODE                        
              END-IF                                                            
           END-IF.                                                              
           WRITE P13L381A-REC  FROM   L381-HEADER-02-A AFTER 1.                 
                                                                                
           WRITE P13L381A-REC  FROM   L381-HEADER-03 AFTER 2.                   
           WRITE P13L381A-REC  FROM   L381-HEADER-04 AFTER 1.                   
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7200-WRITE-CDB.                                                          
      *--------------------------------------------------------------*          
                                                                                
           PERFORM 7300-START-BP13K820    THRU 7300-EXIT.                       
           PERFORM 7400-READNEXT-BP13K820 THRU 7400-EXIT                        
                 UNTIL WS-K820-EOF = 'Y'.                                       
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7300-START-BP13K820.                                                     
      *--------------------------------------------------------------*          
                                                                                
           MOVE 'N'           TO  WS-K820-EOF.                                  
           MOVE K800-NUM-REGN TO  K820-NUM-REGN.                                
           MOVE SPACES        TO  K820-NUM-NRIC.                                
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD                                   
           IF WS-K820-STATUS = ZEROS OR 02                                      
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'START BROWSE ERROR, BP13K820 STATUS IS '                 
                      WS-K820-STATUS                                            
              MOVE WS-K820-STATUS           TO RETURN-CODE                      
              PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                         
           END-IF.                                                              
                                                                                
       7300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7400-READNEXT-BP13K820.                                                  
      *--------------------------------------------------------------*          
                                                                                
           READ BP13K820 NEXT                                                   
                AT END                                                          
                   MOVE 'Y'      TO WS-K820-EOF                                 
           END-READ.                                                            
                                                                                
           IF K820-NUM-REGN  = K800-NUM-REGN                                    
              PERFORM 7500-WRITE-F915   THRU 7500-EXIT                          
           ELSE                                                                 
              MOVE 'Y'      TO WS-K820-EOF                                      
           END-IF.                                                              
                                                                                
       7400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7500-WRITE-F915.                                                         
      *--------------------------------------------------------------*          
                                                                                
           IF K820-NUM-CSTMR-SOURCE = SPACES OR LOW-VALUES                      
              GO TO 7500-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES                   TO   BP13F915-REC.                     
           INITIALIZE                         BP13F915-REC.                     
                                                                                
           MOVE  'TE'                    TO   F915-TXN-TYPE.                    
           MOVE  'BP13'                  TO   F915-NUM-UPDATE-SOURCE.           
           MOVE  'BP13C381'              TO   F915-NUM-UPDATE-USERID.           
                                                                                
           MOVE  K820-NUM-CSTMR-SOURCE   TO   F915-NUM-CSTMR-SOURCE.            
                                                                                
                                                                                
           PERFORM 7600-CONVERT-CUSTOMER-ROLE  THRU 7600-EXIT.                  
           MOVE  K820-NUM-REGN           TO   F915-NUM-BSNS-REF.                
                                                                                
           STRING K800-DTE-CANCEL(1:4) '-'                                      
                  K800-DTE-CANCEL(5:2) '-'                                      
                  K800-DTE-CANCEL(7:2)                                          
                  DELIMITED BY SIZE INTO                                        
                  F915-DTE-ROLE-END                                             
           END-STRING.                                                          
                                                                                
           STRING WS-SYSTEM-DATE(1:4) '-'                                       
                  WS-SYSTEM-DATE(5:2) '-'                                       
                  WS-SYSTEM-DATE(7:2)                                           
                  DELIMITED BY SIZE INTO                                        
                  F915-DTE-UPDATE-SOURCE                                        
           END-STRING.                                                          
                                                                                
           WRITE BP13F915-REC.                                                  
           ADD 1 TO WS-CNT-F915-WRITE.                                          
                                                                                
       7500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7600-CONVERT-CUSTOMER-ROLE.                                              
      *--------------------------------------------------------------*          
                                                                                
           IF K820-NUM-NRIC = K800-NUM-NRIC1                                    
               MOVE '011'                 TO F915-NUM-ROLE                      
           ELSE                                                                 
           IF (K820-NUM-NRIC = K800-NUM-NRIC2) OR                               
              (K820-NUM-NRIC = K800-NUM-NRIC3) OR                               
              (K820-NUM-NRIC = K800-NUM-NRIC4)                                  
               MOVE '012'                 TO F915-NUM-ROLE                      
           ELSE                                                                 
               MOVE '013'                 TO F915-NUM-ROLE                      
           END-IF.                                                              
                                                                                
       7600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       8000-WRITE-P13L381B.                                                     
      *--------------------------------------------------------------*          
                                                                                
           IF WS-CNT-LINE-ON-PAGE-B > 54                                        
              PERFORM 8100-PRINT-HEADING THRU 8100-EXIT                         
              MOVE 1  TO WS-CNT-LINE-ON-PAGE-B                                  
           END-IF.                                                              
                                                                                
           MOVE SPACES              TO P13L381B-REC.                            
           INITIALIZE                  P13L381B-REC.                            
                                                                                
           ADD   1                TO WS-CNT-PRINT-L381-B.                       
           MOVE WS-CNT-PRINT-L381-B TO L381-SLNO.                               
           MOVE WS-NUM-REGN         TO L381-REGN-NO.                            
                                                                                
           STRING K800-DTE-REGN(7:2) '/'                                        
                  K800-DTE-REGN(5:2) '/'                                        
                  K800-DTE-REGN(1:4)                                            
                  DELIMITED BY SIZE                                             
                  INTO L381-APPL-DATE                                           
           END-STRING.                                                          
                                                                                
           MOVE K800-NUM-NEW-TOWN   TO L381-ESTATE.                             
           MOVE K800-NUM-FLAT-TYPE  TO L381-FLAT-TYPE.                          
           MOVE K800-NUM-NRIC1      TO L381-NRIC1.                              
           MOVE K800-NUM-NRIC2      TO L381-NRIC2.                              
           MOVE K800-NUM-ALLO-CAT   TO L381-ALLOC-MODE.                         
                                                                                
           STRING K800-DTE-BALLOT(5:2) '/'                                      
                  K800-DTE-BALLOT(1:4)                                          
                  DELIMITED BY SIZE                                             
                  INTO L381-BALLOT-DTE                                          
           END-STRING.                                                          
                                                                                
           MOVE F205-NUM-USERID   TO L381-USER-ID.                              
                                                                                
           STRING K800-DTE-BK-APPT(7:2) '/'                                     
                  K800-DTE-BK-APPT(5:2) '/'                                     
                  K800-DTE-BK-APPT(1:4)                                         
                  DELIMITED BY SIZE                                             
                  INTO L381-APPMT-DATE                                          
           END-STRING.                                                          
                                                                                
           STRING K800-TME-BK-APPT(1:2) ':'                                     
                  K800-TME-BK-APPT(3:2)                                         
                  DELIMITED BY SIZE                                             
                  INTO L381-APPMT-TIME                                          
           END-STRING.                                                          
                                                                                
           WRITE P13L381B-REC     FROM L381-PR-DETAIL AFTER 1.                  
           ADD   1                TO WS-CNT-LINE-ON-PAGE-B.                     
           MOVE  SPACES           TO L381-PR-DETAIL.                            
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       8100-PRINT-HEADING.                                                      
      *--------------------------------------------------------------*          
                                                                                
           ADD  1                TO     WS-NO-OF-PAGE-B.                        
           MOVE WS-NO-OF-PAGE-B  TO     L381-PAGE-NO-B.                         
           MOVE WS-EDITED-DATE   TO     L381-RUN-DATE-B.                        
                                                                                
           MOVE SPACES           TO     P13L381B-REC.                           
           INITIALIZE                   P13L381B-REC.                           
                                                                                
           WRITE P13L381B-REC  AFTER  PAGE.                                     
                                                                                
                                                                                
           WRITE P13L381B-REC  FROM   L381-HEADER-01-B AFTER 1.                 
           MOVE  F205-NUM-SELECTION   TO L381-ALLOC-MODE2.                      
                                                                                
           IF F205-CDE-LETTER = 1                                               
              MOVE 'C4'              TO L381-CANCEL-CODE2                       
           ELSE                                                                 
              IF F205-CDE-LETTER = 2                                            
                 MOVE '83'           TO L381-CANCEL-CODE2                       
              ELSE                                                              
                 MOVE 'F1'           TO L381-CANCEL-CODE2                       
              END-IF                                                            
           END-IF.                                                              
           WRITE P13L381B-REC  FROM   L381-HEADER-02-B AFTER 1.                 
                                                                                
           WRITE P13L381B-REC  FROM   L381-HEADER-03 AFTER 2.                   
           WRITE P13L381B-REC  FROM   L381-HEADER-04 AFTER 1.                   
                                                                                
       8100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       9000-PRINT-LETTER.                                                       
      *--------------------------------------------------------------*          
                                                                                
           MOVE SPACES       TO P13L381C-REC.                                   
           INITIALIZE           P13L381C-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381D-REC.                                   
           INITIALIZE           P13L381D-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381E-REC.                                   
           INITIALIZE           P13L381E-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381F-REC.                                   
           INITIALIZE           P13L381F-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381G-REC.                                   
           INITIALIZE           P13L381G-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381H-REC.                                   
           INITIALIZE           P13L381H-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381I-REC.                                   
           INITIALIZE           P13L381I-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381J-REC.                                   
           INITIALIZE           P13L381J-REC.                                   
                                                                                
           MOVE SPACES       TO P13L381K-REC.                                   
           INITIALIZE           P13L381K-REC.                                   
                                                                                
           IF WS-K840-FOUND = 'N'                                               
              PERFORM 6120-MOVE-PARA2  THRU 6120-EXIT                           
           END-IF.                                                              
                                                                                
           SET WS-MTH-IND TO 1.                                                 
                                                                                
           SEARCH WS-MONTH-TABLE                                                
             AT END                                                             
                MOVE '   ' TO L381-MTH-BALLOT                                   
             WHEN WS-MONTH-IN-DIGITS(WS-MTH-IND) = F205-DTE-BALLOT(5:2)         
                MOVE WS-MONTH-IN-WORDS(WS-MTH-IND) TO L381-MTH-BALLOT           
           END-SEARCH.                                                          
                                                                                
           MOVE F205-DTE-BALLOT(1:4)         TO L381-YR-BALLOT.                 
                                                                                
           IF F205-NUM-SELECTION = '3R'                                         
              IF F205-CDE-LETTER = '1'                                          
                 WRITE P13L381C-REC FROM                                        
                            DJDE-LINE-3R-DNS AFTER PAGE                         
                 WRITE P13L381C-REC FROM L381-LINE-1   AFTER 4                  
                 WRITE P13L381C-REC FROM L381-LINE-2   AFTER 1                  
                 WRITE P13L381C-REC FROM L381-LINE-3   AFTER 5                  
                 WRITE P13L381C-REC FROM L381-LINE-4   AFTER 1                  
                 WRITE P13L381C-REC FROM L381-LINE-5   AFTER 2                  
                 WRITE P13L381C-REC FROM L381-LINE-6   AFTER 1                  
                 WRITE P13L381C-REC FROM L381-LINE-7   AFTER 1                  
                 WRITE P13L381C-REC FROM L381-LINE-8   AFTER 1                  
                 WRITE P13L381C-REC FROM L381-LINE-9   AFTER 8                  
                 ADD  1  TO WS-CNT-PRINT-L381-C                                 
              ELSE                                                              
                IF F205-CDE-LETTER = '2'                                        
                   WRITE P13L381D-REC FROM                                      
                            DJDE-LINE-3R-NC AFTER PAGE                          
                   WRITE P13L381D-REC FROM L381-LINE-1   AFTER 4                
                   WRITE P13L381D-REC FROM L381-LINE-2   AFTER 1                
                   WRITE P13L381D-REC FROM L381-LINE-3   AFTER 5                
                   WRITE P13L381D-REC FROM L381-LINE-4   AFTER 1                
                   WRITE P13L381D-REC FROM L381-LINE-5   AFTER 2                
                   WRITE P13L381D-REC FROM L381-LINE-6   AFTER 1                
                   WRITE P13L381D-REC FROM L381-LINE-7   AFTER 1                
                   WRITE P13L381D-REC FROM L381-LINE-8   AFTER 1                
                   WRITE P13L381D-REC FROM L381-LINE-9   AFTER 8                
                   ADD  1  TO WS-CNT-PRINT-L381-D                               
                ELSE                                                            
                   WRITE P13L381E-REC FROM                                      
                            DJDE-LINE-3R-NF AFTER PAGE                          
                   WRITE P13L381E-REC FROM L381-LINE-1   AFTER 4                
                   WRITE P13L381E-REC FROM L381-LINE-2   AFTER 1                
                   WRITE P13L381E-REC FROM L381-LINE-3   AFTER 5                
                   WRITE P13L381E-REC FROM L381-LINE-4   AFTER 1                
                   WRITE P13L381E-REC FROM L381-LINE-5   AFTER 2                
                   WRITE P13L381E-REC FROM L381-LINE-6   AFTER 1                
                   WRITE P13L381E-REC FROM L381-LINE-7   AFTER 1                
                   WRITE P13L381E-REC FROM L381-LINE-8   AFTER 1                
                   WRITE P13L381E-REC FROM L381-LINE-9   AFTER 8                
                   ADD  1  TO WS-CNT-PRINT-L381-E                               
                END-IF                                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F205-NUM-SELECTION = 'SA'                                         
              IF F205-CDE-LETTER = '1'                                          
                 WRITE P13L381F-REC FROM                                        
                            DJDE-LINE-SA-DNS AFTER PAGE                         
                 WRITE P13L381F-REC FROM L381-LINE-1   AFTER 4                  
                 WRITE P13L381F-REC FROM L381-LINE-2   AFTER 1                  
                 WRITE P13L381F-REC FROM L381-LINE-3   AFTER 5                  
                 WRITE P13L381F-REC FROM L381-LINE-4   AFTER 1                  
                 WRITE P13L381F-REC FROM L381-LINE-5   AFTER 2                  
                 WRITE P13L381F-REC FROM L381-LINE-6   AFTER 1                  
                 WRITE P13L381F-REC FROM L381-LINE-7   AFTER 1                  
                 WRITE P13L381F-REC FROM L381-LINE-8   AFTER 1                  
                 WRITE P13L381F-REC FROM L381-LINE-9   AFTER 8                  
                 ADD  1  TO WS-CNT-PRINT-L381-F                                 
              ELSE                                                              
                IF F205-CDE-LETTER = '2'                                        
                   WRITE P13L381G-REC FROM                                      
                            DJDE-LINE-SA-NC AFTER PAGE                          
                   WRITE P13L381G-REC FROM L381-LINE-1   AFTER 4                
                   WRITE P13L381G-REC FROM L381-LINE-2   AFTER 1                
                   WRITE P13L381G-REC FROM L381-LINE-3   AFTER 5                
                   WRITE P13L381G-REC FROM L381-LINE-4   AFTER 1                
                   WRITE P13L381G-REC FROM L381-LINE-5   AFTER 2                
                   WRITE P13L381G-REC FROM L381-LINE-6   AFTER 1                
                   WRITE P13L381G-REC FROM L381-LINE-7   AFTER 1                
                   WRITE P13L381G-REC FROM L381-LINE-8   AFTER 1                
                   WRITE P13L381G-REC FROM L381-LINE-9   AFTER 8                
                   ADD  1  TO WS-CNT-PRINT-L381-G                               
                ELSE                                                            
                   WRITE P13L381H-REC FROM                                      
                            DJDE-LINE-SA-NF AFTER PAGE                          
                   WRITE P13L381H-REC FROM L381-LINE-1   AFTER 4                
                   WRITE P13L381H-REC FROM L381-LINE-2   AFTER 1                
                   WRITE P13L381H-REC FROM L381-LINE-3   AFTER 5                
                   WRITE P13L381H-REC FROM L381-LINE-4   AFTER 1                
                   WRITE P13L381H-REC FROM L381-LINE-5   AFTER 2                
                   WRITE P13L381H-REC FROM L381-LINE-6   AFTER 1                
                   WRITE P13L381H-REC FROM L381-LINE-7   AFTER 1                
                   WRITE P13L381H-REC FROM L381-LINE-8   AFTER 1                
                   WRITE P13L381H-REC FROM L381-LINE-9   AFTER 8                
                   ADD  1  TO WS-CNT-PRINT-L381-H                               
                END-IF                                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F205-NUM-SELECTION = 'WIH'                                        
              IF F205-CDE-LETTER = '1'                                          
                 WRITE P13L381I-REC FROM                                        
                            DJDE-LINE-WIH-DNS AFTER PAGE                        
                 WRITE P13L381I-REC FROM L381-LINE-1   AFTER 4                  
                 WRITE P13L381I-REC FROM L381-LINE-2   AFTER 1                  
                 WRITE P13L381I-REC FROM L381-LINE-3   AFTER 5                  
                 WRITE P13L381I-REC FROM L381-LINE-4   AFTER 1                  
                 WRITE P13L381I-REC FROM L381-LINE-5   AFTER 2                  
                 WRITE P13L381I-REC FROM L381-LINE-6   AFTER 1                  
                 WRITE P13L381I-REC FROM L381-LINE-7   AFTER 1                  
                 WRITE P13L381I-REC FROM L381-LINE-8   AFTER 1                  
                 WRITE P13L381I-REC FROM L381-LINE-9   AFTER 8                  
                 ADD  1  TO WS-CNT-PRINT-L381-I                                 
              ELSE                                                              
                IF F205-CDE-LETTER = '2'                                        
                   WRITE P13L381J-REC FROM                                      
                            DJDE-LINE-WIH-NC AFTER PAGE                         
                   WRITE P13L381J-REC FROM L381-LINE-1   AFTER 4                
                   WRITE P13L381J-REC FROM L381-LINE-2   AFTER 1                
                   WRITE P13L381J-REC FROM L381-LINE-3   AFTER 5                
                   WRITE P13L381J-REC FROM L381-LINE-4   AFTER 1                
                   WRITE P13L381J-REC FROM L381-LINE-5   AFTER 2                
                   WRITE P13L381J-REC FROM L381-LINE-6   AFTER 1                
                   WRITE P13L381J-REC FROM L381-LINE-7   AFTER 1                
                   WRITE P13L381J-REC FROM L381-LINE-8   AFTER 1                
                   WRITE P13L381J-REC FROM L381-LINE-9   AFTER 8                
                   ADD  1  TO WS-CNT-PRINT-L381-J                               
                ELSE                                                            
                   WRITE P13L381K-REC FROM                                      
                            DJDE-LINE-WIH-NF AFTER PAGE                         
                   WRITE P13L381K-REC FROM L381-LINE-1   AFTER 4                
                   WRITE P13L381K-REC FROM L381-LINE-2   AFTER 1                
                   WRITE P13L381K-REC FROM L381-LINE-3   AFTER 5                
                   WRITE P13L381K-REC FROM L381-LINE-4   AFTER 1                
                   WRITE P13L381K-REC FROM L381-LINE-5   AFTER 2                
                   WRITE P13L381K-REC FROM L381-LINE-6   AFTER 1                
                   WRITE P13L381K-REC FROM L381-LINE-7   AFTER 1                
                   WRITE P13L381K-REC FROM L381-LINE-8   AFTER 1                
                   WRITE P13L381K-REC FROM L381-LINE-9   AFTER 8                
                   ADD  1  TO WS-CNT-PRINT-L381-K                               
                END-IF                                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       9999-CLOSE-ROUTINE.                                                      
      *--------------------------------------------------------------*          
                                                                                
           CLOSE BP13K800                                                       
                 BP13K840                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13K848                                                       
                 BP13K810                                                       
                 BP13F205                                                       
                 BP13F800                                                       
                 P13L381A                                                       
                 P13L381B                                                       
                 P13L381C                                                       
                 P13L381D                                                       
                 P13L381E                                                       
                 P13L381F                                                       
                 P13L381G                                                       
                 P13L381H                                                       
                 P13L381I                                                       
                 P13L381J                                                       
                 P13L381K                                                       
                 BP13F915.                                                      
                                                                                
           EVALUATE WS-K800-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K800-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K800 FAIL. STATUS=' WS-K800-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K840-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K840-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K840 FAIL. STATUS=' WS-K840-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K820-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K820-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K820 FAIL. STATUS=' WS-K820-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K830-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K830-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K830 FAIL. STATUS=' WS-K830-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K848-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K848-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K848 FAIL. STATUS=' WS-K848-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K810-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K810-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K810 FAIL. STATUS=' WS-K810-STATUS          
           END-EVALUATE.                                                        
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '********* BP13C381 CONTROL *********'.                      
           DISPLAY 'DATE : ' WS-EDITED-DATE.                                    
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF READ (BP13F800) = ' WS-CNT-F800-READ.                
           DISPLAY 'NO. OF READ (BP13F205) = ' WS-CNT-F205-READ.                
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS UPDATED    = '.                                 
           DISPLAY '    (BP13K800)         = ' WS-CNT-K800-UPD.                 
           DISPLAY 'NO. OF RECS UPDATED    = '.                                 
           DISPLAY '    (BP13K840)         = ' WS-CNT-K840-UPD.                 
           DISPLAY 'NO. OF RECS WRITE      = '.                                 
           DISPLAY '    (BP13K840)         = ' WS-CNT-K840-WRITE.               
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS WRITE      = '.                                 
           DISPLAY '    (BP13K848)         = ' WS-CNT-K848-WRITE.               
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS WRITE      = '.                                 
           DISPLAY '    (BP13K810)         = ' WS-CNT-K810-WRITE.               
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS WRITE      = '.                                 
           DISPLAY '    (BP13F915)         = ' WS-CNT-F915-WRITE.               
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381A)         = ' WS-CNT-PRINT-L381-A.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381B)         = ' WS-CNT-PRINT-L381-B.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381C)         = ' WS-CNT-PRINT-L381-C.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381D)         = ' WS-CNT-PRINT-L381-D.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381E)         = ' WS-CNT-PRINT-L381-E.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381F)         = ' WS-CNT-PRINT-L381-F.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381G)         = ' WS-CNT-PRINT-L381-G.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381H)         = ' WS-CNT-PRINT-L381-H.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381I)         = ' WS-CNT-PRINT-L381-I.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381J)         = ' WS-CNT-PRINT-L381-J.             
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13L381K)         = ' WS-CNT-PRINT-L381-K.             
           DISPLAY SPACES.                                                      
           DISPLAY '************************************'.                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************** E N D  O F  P R O G R A M *****************             
