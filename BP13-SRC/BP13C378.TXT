      *--------------------------------------------------------*                
       IDENTIFICATION DIVISION.                                                 
      *--------------------------------------------------------*                
       PROGRAM-ID.    BP13C378.                                                 
      *AUTHOR. SK.                                                              
      *DATE-WRITTEN.  29/07/2003.                                               
                                                                                
      **********************************************************                
      *                                                        *                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *                                                        *                
      *    SYSTEM ID : BP13                                    *                
      *                                                        *                
      *    OBJECTIVE  : PRINT THE AGEING REPORT FOR 40-4151,   *                
      *                 40-4153, 54-4151                       *                
      *     INPUT FILES:                                       *                
      *           1. BP13F673                                  *                
      *                                                        *                
      *     OUTPUT FILE:                                       *                
      *           1. P13L378A                                  *                
      *           2. P13L378B                                  *                
      *                                                        *                
      * CHG-NO   BY    DATE     DETAILS                        *                
      * -------- ----  -------- -------------------------------*                
      * BP132347 SK    29072003 NEW PGM                        *                
      **********************************************************                
                                                                                
      *--------------------------------------------------------*                
       ENVIRONMENT DIVISION.                                                    
      *--------------------------------------------------------*                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F673 ASSIGN TO BP13F673.                                  
                                                                                
           SELECT P13L378A ASSIGN TO P13L378A.                                  
           SELECT P13L378B ASSIGN TO P13L378B.                                  
                                                                                
      *--------------------------------------------------------*                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *--------------------------------------------------------*                
                                                                                
       FD  BP13F673                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 100 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F673.                                                           
                                                                                
       FD  P13L378A                                                             
           RECORDING MODE IS F                                                  
           RECORD CONTAINS  132 CHARACTERS.                                     
       01  P13L378A-REC         PIC X(132).                                     
                                                                                
       FD  P13L378B                                                             
           RECORDING MODE IS F                                                  
           RECORD CONTAINS  132 CHARACTERS.                                     
       01  P13L378B-REC         PIC X(132).                                     
                                                                                
      *--------------------------------------------------------*                
       WORKING-STORAGE SECTION.                                                 
      *--------------------------------------------------------*                
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-F673-EOF             PIC X       VALUE 'N'.                   
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-CNT-F673-READ         PIC 9(8)    VALUE ZEROES.                
                                                                                
       01  WS-VARIABLES.                                                        
                                                                                
           05 WS-TOT-LESS-EQ1-A        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-LESS-EQ2-A        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-LESS-EQ3-A        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-GRT-3-A           PIC S9(9)V99 VALUE 0.                    
                                                                                
           05 WS-TOT-CASE-LEQ1-A       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-LEQ2-A       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-LEQ3-A       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-GRT3-A       PIC 9(8)    VALUE 0.                     
                                                                                
           05 WS-TOT-LESS-EQ1-B        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-LESS-EQ2-B        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-LESS-EQ3-B        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-GRT-3-B           PIC S9(9)V99 VALUE 0.                    
                                                                                
           05 WS-TOT-CASE-LEQ1-B       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-LEQ2-B       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-LEQ3-B       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-GRT3-B       PIC 9(8)    VALUE 0.                     
                                                                                
           05 WS-TOT-LESS-EQ1-C        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-LESS-EQ2-C        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-LESS-EQ3-C        PIC S9(9)V99 VALUE 0.                    
           05 WS-TOT-GRT-3-C           PIC S9(9)V99 VALUE 0.                    
                                                                                
           05 WS-TOT-CASE-LEQ1-C       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-LEQ2-C       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-LEQ3-C       PIC 9(8)    VALUE 0.                     
           05 WS-TOT-CASE-GRT3-C       PIC 9(8)    VALUE 0.                     
                                                                                
           05 WS-GRT-TOT-A             PIC S9(9)V99 VALUE 0.                    
           05 WS-GRT-TOT-B             PIC S9(9)V99 VALUE 0.                    
           05 WS-GRT-TOT-C             PIC S9(9)V99 VALUE 0.                    
           05 WS-GRT-TOT-D             PIC S9(9)V99 VALUE 0.                    
                                                                                
           05 WS-CNT-LINE-ON-PAGE1     PIC 9(8)    VALUE 66.                    
           05 WS-CNT-PRINT-L378-A      PIC 9(8)    VALUE 1.                     
           05 WS-CNT-WRITE-L378-A      PIC 9(8)    VALUE 0.                     
           05 WS-NO-OF-PAGE1           PIC 9(8)    VALUE 0.                     
                                                                                
           05 WS-CNT-LINE-ON-PAGE2     PIC 9(8)    VALUE 66.                    
           05 WS-CNT-PRINT-L378-B      PIC 9(8)    VALUE 1.                     
           05 WS-CNT-WRITE-L378-B      PIC 9(8)    VALUE 0.                     
           05 WS-NO-OF-PAGE2           PIC 9(8)    VALUE 0.                     
                                                                                
           05 WS-CNT-LINE-ON-PAGE3     PIC 9(8)    VALUE 66.                    
           05 WS-CNT-PRINT-L378-C      PIC 9(8)    VALUE 1.                     
           05 WS-CNT-WRITE-L378-C      PIC 9(8)    VALUE 0.                     
           05 WS-NO-OF-PAGE3           PIC 9(8)    VALUE 0.                     
                                                                                
           05 WS-CNT-LINE-ON-PAGE4     PIC 9(8)    VALUE 66.                    
           05 WS-CNT-PRINT-L378-D      PIC 9(8)    VALUE 1.                     
           05 WS-CNT-WRITE-L378-D      PIC 9(8)    VALUE 0.                     
           05 WS-NO-OF-PAGE4           PIC 9(8)    VALUE 0.                     
                                                                                
           05 WS-DIFF-MNTH             PIC 9(3)    VALUE 0.                     
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-CCYY             PIC 9(4).                                
           05  WS-SYS-MM               PIC 9(2).                                
           05  WS-SYS-DD               PIC 9(2).                                
                                                                                
       01  WS-F673-DATE.                                                        
           05  WS-F673-CCYY            PIC 9(4).                                
           05  WS-F673-MM              PIC 9(2).                                
           05  WS-F673-DD              PIC 9(2).                                
                                                                                
       01  WS-EDITED-DATE              PIC X(10).                               
                                                                                
      *-----------------------------------------------------------*             
      *    WS FOR CONTROL LISTING                                 *             
      *-----------------------------------------------------------*             
                                                                                
       01  L378-PR-HEAD-01.                                                     
           05  L378-PRINT-HEAD          PIC X(14) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'HDBCAT 3'.             
           05  FILLER                   PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(13) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  L378-PRINT-DATE          PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'PAGE: '.               
           05  L378-PRINT-PAGE          PIC ZZZ9.                               
                                                                                
       01  L378-PR-HEAD-02-A.                                                   
           05  FILLER                   PIC X(39) VALUE SPACES.                 
           05  FILLER                   PIC X(80) VALUE                         
           'AGEING REPORT FOR AMOUNTS OUTSTANDING IN ACCOUNT 40-4151'.          
                                                                                
       01  L378-PR-HEAD-02-B.                                                   
           05  FILLER                   PIC X(39) VALUE SPACES.                 
           05  FILLER                   PIC X(80) VALUE                         
           'AGEING REPORT FOR AMOUNTS OUTSTANDING IN ACCOUNT 54-4151'.          
                                                                                
       01  L378-PR-HEAD-02-C.                                                   
           05  FILLER                   PIC X(39) VALUE SPACES.                 
           05  FILLER                   PIC X(80) VALUE                         
           'AGEING REPORT FOR AMOUNTS OUTSTANDING IN ACCOUNT 40-4153'.          
                                                                                
       01  L378-PR-HEAD-02-D.                                                   
           05  FILLER                   PIC X(43) VALUE SPACES.                 
           05  FILLER                   PIC X(80) VALUE                         
           'AGEING REPORT FOR AMOUNTS OUTSTANDING (>3 MONTHS)'.                 
                                                                                
       01  L378-PR-HEAD-03-A.                                                   
           05  FILLER          PIC X(04) VALUE SPACES.                          
           05  FILLER          PIC X(22) VALUE '<= 1 MONTH'.                    
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(22) VALUE '<= 2 MONTHS'.                   
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(22) VALUE '<= 3 MONTHS'.                   
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(22) VALUE '> 3 MONTHS'.                    
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'TOT AMOUNT'.                    
                                                                                
       01  L378-PR-HEAD-03-A1.                                                  
           05  FILLER          PIC X(10) VALUE 'NO. CASES'.                     
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'AMOUNT'.                        
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'NO. CASES'.                     
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'AMOUNT'.                        
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'NO. CASES'.                     
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'AMOUNT'.                        
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'NO. CASES'.                     
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'AMOUNT'.                        
                                                                                
       01  L378-PR-HEAD-03-B.                                                   
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(05) VALUE 'SL NO'.                         
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'REGN NO'.                       
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(08) VALUE 'ACCOUNT '.                      
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(12) VALUE 'CLOSING BAL'.                   
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'DTE CREATE'.                    
           05  FILLER          PIC X(02) VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'DTE UPDATE'.                    
                                                                                
       01  L378-PR-DETAILS.                                                     
           05  L378-LESS-EQ1         PIC ZZZZ9.                                 
           05  FILLER                PIC X(03)  VALUE SPACES.                   
           05  L378-LESS-EQ1-AMT     PIC $$,$$$,$$9.99-.                        
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-LESS-EQ2         PIC ZZZZ9.                                 
           05  FILLER                PIC X(03)  VALUE SPACES.                   
           05  L378-LESS-EQ2-AMT     PIC $$,$$$,$$9.99-.                        
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-LESS-EQ3         PIC ZZZZ9.                                 
           05  FILLER                PIC X(03)  VALUE SPACES.                   
           05  L378-LESS-EQ3-AMT     PIC $$,$$$,$$9.99-.                        
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-GRT-3            PIC ZZZZ9.                                 
           05  FILLER                PIC X(03)  VALUE SPACES.                   
           05  L378-GRT-3-AMT        PIC $$,$$$,$$9.99-.                        
           05  FILLER                PIC X(03) VALUE SPACES.                    
           05  L378-GRT-TOT          PIC $$$,$$$,$$9.99-.                       
                                                                                
       01  L378-PR-DETAILS1.                                                    
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-SLNO             PIC ZZZZ9.                                 
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-REGN             PIC X(10).                                 
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-ACCOUNT          PIC X(07).                                 
           05  FILLER                PIC X(01)  VALUE SPACES.                   
           05  L378-CLOSE-AMT        PIC $$,$$$,$$9.99-.                        
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-DTE-CREATE       PIC X(10).                                 
           05  FILLER                PIC X(02)  VALUE SPACES.                   
           05  L378-DTE-UPDATE       PIC X(10).                                 
                                                                                
       01  L378-PR-FOOTER-D.                                                    
           05  FILLER                PIC X(28) VALUE 'TOTAL:'.                  
           05  L378-GR-TOT-D         PIC $$$,$$$,$$9.99-.                       
                                                                                
       01  L378-PR-LINE.                                                        
           05  FILLER                PIC X(132) VALUE ALL '-'.                  
                                                                                
       01  L378-PR-BLANK             PIC X(132) VALUE SPACES.                   
                                                                                
      *--------------------------------------------------------*                
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------*                
                                                                                
       0000-MAIN.                                                               
                                                                                
           PERFORM 1000-OPEN-FILE       THRU 1000-EXIT.                         
           PERFORM 1100-READ-F673       THRU 1100-EXIT.                         
           PERFORM 2000-PROCESS         THRU 2000-EXIT                          
                   UNTIL WS-F673-EOF = 'Y'.                                     
                                                                                
           PERFORM 4000-WRITE-P13L378A  THRU 4000-EXIT.                         
           PERFORM 4200-WRITE-P13L378B  THRU 4200-EXIT.                         
           PERFORM 4400-WRITE-P13L378C  THRU 4400-EXIT.                         
           PERFORM 6000-PRINT-FOOTER    THRU 6000-EXIT.                         
                                                                                
           PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                         
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       1000-OPEN-FILE.                                                          
      *--------------------------------------------------------*                
                                                                                
           OPEN INPUT  BP13F673                                                 
                OUTPUT P13L378A                                                 
                       P13L378B.                                                
                                                                                
           MOVE FUNCTION CURRENT-DATE   TO WS-SYSTEM-DATE.                      
                                                                                
           STRING  WS-SYSTEM-DATE(7:2) '/' WS-SYSTEM-DATE(5:2) '/'              
                   WS-SYSTEM-DATE(1:4) DELIMITED BY SIZE                        
                   INTO WS-EDITED-DATE                                          
           END-STRING.                                                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       1100-READ-F673.                                                          
      *--------------------------------------------------------*                
                                                                                
           READ BP13F673                                                        
                AT END  MOVE 'Y' TO WS-F673-EOF                                 
                GO TO 1100-EXIT                                                 
           END-READ.                                                            
                                                                                
           ADD 1 TO WS-CNT-F673-READ.                                           
                                                                                
       1100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       2000-PROCESS.                                                            
      *--------------------------------------------------------*                
                                                                                
           PERFORM 2100-GET-MONTH      THRU 2100-EXIT.                          
           PERFORM 1100-READ-F673      THRU 1100-EXIT.                          
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       2100-GET-MONTH.                                                          
      *--------------------------------------------------------*                
                                                                                
           IF F673-DTE-CREATE NOT = SPACES AND LOW-VALUES AND ALL '0'           
              MOVE F673-DTE-CREATE    TO WS-F673-DATE                           
           ELSE                                                                 
              MOVE ZEROS              TO WS-F673-DATE                           
           END-IF.                                                              
                                                                                
           COMPUTE WS-DIFF-MNTH = ((WS-SYS-CCYY  * 12) + WS-SYS-MM) -           
                                  ((WS-F673-CCYY * 12) + WS-F673-MM).           
                                                                                
           IF WS-DIFF-MNTH <= 1                                                 
              PERFORM 3000-COMPUTE        THRU 3000-EXIT                        
           ELSE                                                                 
           IF WS-DIFF-MNTH <= 2                                                 
              PERFORM 3100-COMPUTE        THRU 3100-EXIT                        
           ELSE                                                                 
           IF WS-DIFF-MNTH <= 3                                                 
              PERFORM 3200-COMPUTE        THRU 3200-EXIT                        
           ELSE                                                                 
           IF WS-DIFF-MNTH > 3                                                  
              PERFORM 3300-COMPUTE        THRU 3300-EXIT                        
              PERFORM 4600-WRITE-P13L378D THRU 4600-EXIT                        
              PERFORM 5400-WRITE-BLANK    THRU 5400-EXIT                        
           END-IF.                                                              
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      * PAT TYPE   ACCOUNT    REPORT                                   *        
      *----------------------------------------------------------------*        
      *   RSL      40-4151      A                                      *        
      *   SMS      54-4151      B                                      *        
      *   SOL      40-4153      C                                      *        
      ******************************************************************        
                                                                                
      *----------------------------------------------------------------*        
       3000-COMPUTE.                                                            
      *----------------------------------------------------------------*        
                                                                                
           IF F673-CDE-PAYMENT-TYPE = 'RSL'                                     
              COMPUTE WS-TOT-LESS-EQ1-A = WS-TOT-LESS-EQ1-A +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ1-A                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SMS'                                     
              COMPUTE WS-TOT-LESS-EQ1-B = WS-TOT-LESS-EQ1-B +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ1-B                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SOL'                                     
              COMPUTE WS-TOT-LESS-EQ1-C = WS-TOT-LESS-EQ1-C +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ1-C                                       
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3100-COMPUTE.                                                            
      *----------------------------------------------------------------*        
                                                                                
           IF F673-CDE-PAYMENT-TYPE = 'RSL'                                     
              COMPUTE WS-TOT-LESS-EQ2-A = WS-TOT-LESS-EQ2-A +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ2-A                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SMS'                                     
              COMPUTE WS-TOT-LESS-EQ2-B = WS-TOT-LESS-EQ2-B +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ2-B                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SOL'                                     
              COMPUTE WS-TOT-LESS-EQ2-C = WS-TOT-LESS-EQ2-C +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ2-C                                       
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3200-COMPUTE.                                                            
      *----------------------------------------------------------------*        
                                                                                
           IF F673-CDE-PAYMENT-TYPE = 'RSL'                                     
              COMPUTE WS-TOT-LESS-EQ3-A = WS-TOT-LESS-EQ3-A +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ3-A                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SMS'                                     
              COMPUTE WS-TOT-LESS-EQ3-B = WS-TOT-LESS-EQ3-B +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ3-B                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SOL'                                     
              COMPUTE WS-TOT-LESS-EQ3-C = WS-TOT-LESS-EQ3-C +                   
                                          F673-AMT-CLOSE                        
              ADD 1 TO WS-TOT-CASE-LEQ3-C                                       
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3300-COMPUTE.                                                            
      *----------------------------------------------------------------*        
                                                                                
           IF F673-CDE-PAYMENT-TYPE = 'RSL'                                     
              COMPUTE WS-TOT-GRT-3-A = WS-TOT-GRT-3-A +                         
                                       F673-AMT-CLOSE                           
              ADD 1 TO WS-TOT-CASE-GRT3-A                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SMS'                                     
              COMPUTE WS-TOT-GRT-3-B = WS-TOT-GRT-3-B +                         
                                       F673-AMT-CLOSE                           
              ADD 1 TO WS-TOT-CASE-GRT3-B                                       
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SOL'                                     
              COMPUTE WS-TOT-GRT-3-C = WS-TOT-GRT-3-C +                         
                                       F673-AMT-CLOSE                           
              ADD 1 TO WS-TOT-CASE-GRT3-C                                       
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4000-WRITE-P13L378A.                                                     
      *----------------------------------------------------------------*        
                                                                                
           IF WS-CNT-LINE-ON-PAGE1 > 54                                         
              PERFORM 4100-PRINT-HEADING-A THRU 4100-EXIT                       
              MOVE 1  TO WS-CNT-LINE-ON-PAGE1                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES         TO P13L378A-REC.                                 
           INITIALIZE             P13L378A-REC.                                 
                                                                                
           PERFORM 5000-MOVE-A    THRU 5000-EXIT.                               
           WRITE P13L378A-REC     FROM L378-PR-DETAILS AFTER 1.                 
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4100-PRINT-HEADING-A.                                                    
      *----------------------------------------------------------------*        
                                                                                
           ADD  1                TO     WS-NO-OF-PAGE1.                         
           MOVE WS-NO-OF-PAGE1   TO     L378-PRINT-PAGE.                        
           MOVE WS-EDITED-DATE   TO     L378-PRINT-DATE.                        
           MOVE 'P13L378A'       TO     L378-PRINT-HEAD.                        
                                                                                
           MOVE SPACES           TO     P13L378A-REC.                           
           INITIALIZE                   P13L378A-REC.                           
                                                                                
           WRITE P13L378A-REC    AFTER  PAGE.                                   
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-01    AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-02-A  AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-03-A  AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-03-A1 AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-LINE       AFTER 1.             
                                                                                
           MOVE 5  TO WS-CNT-LINE-ON-PAGE1.                                     
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4200-WRITE-P13L378B.                                                     
      *----------------------------------------------------------------*        
                                                                                
           IF WS-CNT-LINE-ON-PAGE2 > 54                                         
              PERFORM 4300-PRINT-HEADING-B THRU 4300-EXIT                       
              MOVE 1  TO WS-CNT-LINE-ON-PAGE2                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES         TO P13L378A-REC.                                 
           INITIALIZE             P13L378A-REC.                                 
                                                                                
           PERFORM 5100-MOVE-B    THRU 5100-EXIT.                               
           WRITE P13L378A-REC     FROM L378-PR-DETAILS AFTER 1.                 
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4300-PRINT-HEADING-B.                                                    
      *----------------------------------------------------------------*        
                                                                                
           MOVE SPACES           TO     P13L378A-REC.                           
           INITIALIZE                   P13L378A-REC.                           
                                                                                
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-02-B  AFTER 7.             
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-03-A  AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-03-A1 AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-LINE       AFTER 1.             
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4400-WRITE-P13L378C.                                                     
      *----------------------------------------------------------------*        
                                                                                
           IF WS-CNT-LINE-ON-PAGE3 > 54                                         
              PERFORM 4500-PRINT-HEADING-C THRU 4500-EXIT                       
              MOVE 1  TO WS-CNT-LINE-ON-PAGE3                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES         TO P13L378A-REC.                                 
           INITIALIZE             P13L378A-REC.                                 
                                                                                
           PERFORM  5200-MOVE-C   THRU 5200-EXIT.                               
           WRITE P13L378A-REC     FROM L378-PR-DETAILS AFTER 1.                 
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4500-PRINT-HEADING-C.                                                    
      *----------------------------------------------------------------*        
                                                                                
           MOVE SPACES           TO     P13L378A-REC.                           
           INITIALIZE                   P13L378A-REC.                           
                                                                                
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-02-C  AFTER 7.             
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-03-A  AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-HEAD-03-A1 AFTER 1.             
           WRITE P13L378A-REC    FROM   L378-PR-LINE       AFTER 1.             
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4600-WRITE-P13L378D.                                                     
      *----------------------------------------------------------------*        
                                                                                
           IF WS-CNT-LINE-ON-PAGE4 > 54                                         
              PERFORM 4700-PRINT-HEADING-D THRU 4700-EXIT                       
              MOVE 1  TO WS-CNT-LINE-ON-PAGE4                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES         TO P13L378B-REC.                                 
           INITIALIZE             P13L378B-REC.                                 
                                                                                
           PERFORM  5300-MOVE-D   THRU 5300-EXIT.                               
           WRITE P13L378B-REC   FROM L378-PR-DETAILS1 AFTER 1.                  
           ADD   1              TO WS-CNT-LINE-ON-PAGE4.                        
           ADD   1              TO WS-CNT-PRINT-L378-D.                         
           ADD   1              TO WS-CNT-WRITE-L378-D.                         
           MOVE  SPACES         TO L378-PR-DETAILS1.                            
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4700-PRINT-HEADING-D.                                                    
      *----------------------------------------------------------------*        
                                                                                
           ADD  1                TO     WS-NO-OF-PAGE4.                         
           MOVE WS-NO-OF-PAGE4   TO     L378-PRINT-PAGE.                        
           MOVE WS-EDITED-DATE   TO     L378-PRINT-DATE.                        
           MOVE 'P13L378B'       TO     L378-PRINT-HEAD.                        
                                                                                
           MOVE SPACES           TO     P13L378B-REC.                           
           INITIALIZE                   P13L378B-REC.                           
                                                                                
           WRITE P13L378B-REC    AFTER  PAGE.                                   
           WRITE P13L378B-REC    FROM   L378-PR-HEAD-01    AFTER 1.             
           WRITE P13L378B-REC    FROM   L378-PR-HEAD-02-D  AFTER 1.             
           WRITE P13L378B-REC    FROM   L378-PR-HEAD-03-B  AFTER 1.             
           WRITE P13L378B-REC    FROM   L378-PR-LINE       AFTER 1.             
                                                                                
           MOVE 4  TO WS-CNT-LINE-ON-PAGE4.                                     
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       5000-MOVE-A.                                                             
      *--------------------------------------------------------*                
                                                                                
           MOVE WS-TOT-CASE-LEQ1-A      TO L378-LESS-EQ1.                       
           MOVE WS-TOT-LESS-EQ1-A       TO L378-LESS-EQ1-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-LEQ2-A      TO L378-LESS-EQ2.                       
           MOVE WS-TOT-LESS-EQ2-A       TO L378-LESS-EQ2-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-LEQ3-A      TO L378-LESS-EQ3.                       
           MOVE WS-TOT-LESS-EQ3-A       TO L378-LESS-EQ3-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-GRT3-A      TO L378-GRT-3.                          
           MOVE WS-TOT-GRT-3-A          TO L378-GRT-3-AMT.                      
                                                                                
           COMPUTE WS-GRT-TOT-A    =  WS-TOT-LESS-EQ1-A +                       
                                      WS-TOT-LESS-EQ2-A +                       
                                      WS-TOT-LESS-EQ3-A +                       
                                      WS-TOT-GRT-3-A.                           
                                                                                
           MOVE WS-GRT-TOT-A            TO L378-GRT-TOT.                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       5100-MOVE-B.                                                             
      *--------------------------------------------------------*                
                                                                                
           MOVE WS-TOT-CASE-LEQ1-B      TO L378-LESS-EQ1.                       
           MOVE WS-TOT-LESS-EQ1-B       TO L378-LESS-EQ1-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-LEQ2-B      TO L378-LESS-EQ2.                       
           MOVE WS-TOT-LESS-EQ2-B       TO L378-LESS-EQ2-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-LEQ3-B      TO L378-LESS-EQ3.                       
           MOVE WS-TOT-LESS-EQ3-B       TO L378-LESS-EQ3-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-GRT3-B      TO L378-GRT-3.                          
           MOVE WS-TOT-GRT-3-B          TO L378-GRT-3-AMT.                      
                                                                                
           COMPUTE WS-GRT-TOT-B    =  WS-TOT-LESS-EQ1-B +                       
                                      WS-TOT-LESS-EQ2-B +                       
                                      WS-TOT-LESS-EQ3-B +                       
                                      WS-TOT-GRT-3-B.                           
                                                                                
           MOVE WS-GRT-TOT-B            TO L378-GRT-TOT.                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       5200-MOVE-C.                                                             
      *--------------------------------------------------------*                
                                                                                
           MOVE WS-TOT-CASE-LEQ1-C      TO L378-LESS-EQ1.                       
           MOVE WS-TOT-LESS-EQ1-C       TO L378-LESS-EQ1-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-LEQ2-C      TO L378-LESS-EQ2.                       
           MOVE WS-TOT-LESS-EQ2-C       TO L378-LESS-EQ2-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-LEQ3-C      TO L378-LESS-EQ3.                       
           MOVE WS-TOT-LESS-EQ3-C       TO L378-LESS-EQ3-AMT.                   
                                                                                
           MOVE WS-TOT-CASE-GRT3-C      TO L378-GRT-3.                          
           MOVE WS-TOT-GRT-3-C          TO L378-GRT-3-AMT.                      
                                                                                
           COMPUTE WS-GRT-TOT-C    =  WS-TOT-LESS-EQ1-C +                       
                                      WS-TOT-LESS-EQ2-C +                       
                                      WS-TOT-LESS-EQ3-C +                       
                                      WS-TOT-GRT-3-C.                           
                                                                                
           MOVE WS-GRT-TOT-C            TO L378-GRT-TOT.                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       5300-MOVE-D.                                                             
      *--------------------------------------------------------*                
                                                                                
           MOVE WS-CNT-PRINT-L378-D     TO L378-SLNO.                           
           MOVE F673-NUM-REGN           TO L378-REGN.                           
                                                                                
           IF F673-CDE-PAYMENT-TYPE = 'RSL'                                     
              MOVE '40-4151'  TO L378-ACCOUNT                                   
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SMS'                                     
              MOVE '54-4151'  TO L378-ACCOUNT                                   
           ELSE                                                                 
           IF F673-CDE-PAYMENT-TYPE = 'SOL'                                     
              MOVE '40-4153'  TO L378-ACCOUNT                                   
           END-IF.                                                              
                                                                                
           MOVE F673-AMT-CLOSE          TO L378-CLOSE-AMT.                      
                                                                                
           STRING F673-DTE-CREATE(7:2) '/'                                      
                  F673-DTE-CREATE(5:2) '/'                                      
                  F673-DTE-CREATE(1:4)                                          
                  DELIMITED BY SIZE                                             
                  INTO L378-DTE-CREATE                                          
           END-STRING.                                                          
                                                                                
           STRING F673-DTE-UPDATE(7:2) '/'                                      
                  F673-DTE-UPDATE(5:2) '/'                                      
                  F673-DTE-UPDATE(1:4)                                          
                  DELIMITED BY SIZE                                             
                  INTO L378-DTE-UPDATE                                          
           END-STRING.                                                          
                                                                                
           COMPUTE WS-GRT-TOT-D = WS-GRT-TOT-D +                                
                                  F673-AMT-CLOSE.                               
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       5400-WRITE-BLANK.                                                        
      *----------------------------------------------------------------*        
                                                                                
           IF WS-CNT-LINE-ON-PAGE4 > 54                                         
              PERFORM 4700-PRINT-HEADING-D THRU 4700-EXIT                       
              MOVE 1  TO WS-CNT-LINE-ON-PAGE4                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES         TO P13L378B-REC.                                 
           INITIALIZE             P13L378B-REC.                                 
                                                                                
           WRITE P13L378B-REC   FROM L378-PR-BLANK AFTER 1.                     
           ADD   1              TO WS-CNT-LINE-ON-PAGE4.                        
           MOVE  SPACES         TO L378-PR-DETAILS1.                            
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       6000-PRINT-FOOTER.                                                       
      *----------------------------------------------------------------*        
                                                                                
           IF WS-CNT-WRITE-L378-D < 1                                           
              GO TO 6000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE WS-GRT-TOT-D              TO L378-GR-TOT-D.                     
                                                                                
           MOVE SPACES                TO P13L378B-REC.                          
           INITIALIZE                    P13L378B-REC.                          
                                                                                
           WRITE P13L378B-REC         FROM L378-PR-FOOTER-D AFTER 2.            
           WRITE P13L378B-REC         FROM L378-PR-LINE    AFTER 1.             
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       9000-CLOSE-ROUTINE.                                                      
      *--------------------------------------------------------*                
                                                                                
           CLOSE BP13F673                                                       
                 P13L378A                                                       
                 P13L378B.                                                      
                                                                                
           DISPLAY '******  BP13C378 *************'.                            
           DISPLAY 'DATE : ' WS-EDITED-DATE.                                    
           DISPLAY SPACE.                                                       
           DISPLAY 'NO. OF READ  (BP13F673) : ' WS-CNT-F673-READ.               
           DISPLAY SPACE.                                                       
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
      *                         END OF PROGRAM                                  
      *--------------------------------------------------------------*          
