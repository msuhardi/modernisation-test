      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C353.                                                 
      *AUTHOR.        MTRS.                                                     
      *DATE-WRITTEN.  19/07/94.                                                 
                                                                                
      * ====================================================== *                
      * SYSTEM OF COMMITMENT (BP13)                            *                
      * ====================================================== *                
      *                                                        *                
      *  OBJECTIVE :                                           *                
      *    1.  THIS IS A PROGRAM TO PRINT THE SUB-TRANSFER     *                
      *        CASES COMPLETED FOR THE DAY                     *                
      *                                                        *                
      *  INPUT     :  BP13F880  (SUCCESSFUL CASES)             *                
      *               BP13K890                                 *                
      *                                                        *                
      *  LISTINGS  :  P13L353A  (CONTROL LISTING)              *                
      *               P13L353B  (UNMATCHED LISTING)            *                
      *               P13L353C  (CONSOLIDATED LIST TO VT)      *                
      *               P13L353D  (INDIVIDUAL EMAIL TO CRM)      *                
      *               P13L353E  (UNMATCHED LISTING TO VT)      *                
      *                                                        *                
      * ------------------------------------------------------ *                
      * CHG-NO  BY    ON        DESCRIPTION                    *                
      * --------------------------------------                 *                
      * C891145  LSB  900314 - OUTPUT F310-REC FOR PRINTING OF *                
      *                        TP APPOINTMENT LETTER IF KEY    *                
      *                        AVAILABLE                       *                
      * C910481  ACK  910801 - DO NOT OUTPUT F310-REC          *                
      * SOCPH8B  LITO 930728 - CHG REGN FROM 7 TO 8 BYTES      *                
      * BP130094 EG1  960226 - TO CATER FOR NEW FORMAT.        *                
      * BP130418 MPA  980403 - TO CATER FOR NEW FORMAT.        *                
      * BP130418 RHB  980604 - Y2K                             *                
      * BP130883 RAS  000807 - TO CHANGE BP13C904 TO BP13C913  *                
      * BP135901 KSJ  150827 - INCLUDE OIC COLUMN IN REPORT    *                
      *                      - BYPASS RECORDS WHEN SUB-XFER    *                
      *                        VOUCHER DATE IS PRESENT         *                
      *                      - TO SEND REPORT VIA EMAIL:       *                
      *                        (1) CONSOLIDATED RPT TO VT      *                
      *                        (2) INDIVIDUAL EMAIL TO CRM     *                
      *                        (3) UNMATCHED LISTING TO VT     *                
      * BP136082 PCL4 150111 - TO UPDATE EMAIL RECIPIENTS      *                
      * BP136253 KVL1 160530 - TO REMOVE P13L353A LISTING      *                
      * BP136339 PCL4 160816 - TO UPDATE EMAIL RECIPIENTS      *                
      * BP136560 PCL4 161216 - TO UPDATE EMAIL RECIPIENTS      *                
      * BP136851 PCL4 200617 - TO UPDATE EMAIL RECIPIENTS      *                
      * BP137087 PCL4 071117 - TO UPDATE EMAIL RECIPIENTS      *                
      * BP138202 KV5  100320 - REPLACE MAIL FROM MOHAMED ALI   *                
      *                        BEE KATHIJAH TO HENG SC         *                
      *                        SUZANNE(HDB)                    *                
      * BP138297 KV5  170620 - INITIALIZED THE VARIABLES       *                
      * BP139175 KAC1 020922 - REMOVED HONG HUAT LAU           *                
      *                        ADDED Jialing HE                *                
      *                              Siti Zainah MISONEP       *                
      *                              Kathijah Bee ALI MOHAMED  *                
      *                              Nor'ain MOHAMAD JOHAR     *                
      **********************************************************                
                                                                                
      *-----------------------*                                                 
       ENVIRONMENT DIVISION.                                                    
      *-----------------------*                                                 
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
      *-----------------------*                                                 
       INPUT-OUTPUT SECTION.                                                    
      *-----------------------*                                                 
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT BP13F880   ASSIGN TO BP13F880.                                
           SELECT BP13K890   ASSIGN TO BP13K890                                 
                  ORGANIZATION         INDEXED                                  
                  ACCESS               RANDOM                                   
                  RECORD KEY           K890-KEY-FLD                             
                  FILE STATUS          K890-FSTAT.                              
           SELECT P13L353B   ASSIGN TO P13L353B.                                
           SELECT P13L353C   ASSIGN TO P13L353C.                                
           SELECT P13L353D   ASSIGN TO P13L353D.                                
           SELECT P13L353E   ASSIGN TO P13L353E.                                
                                                                                
                                                                                
      *-----------------------*                                                 
       DATA DIVISION.                                                           
      *-----------------------*                                                 
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F880                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            LABEL RECORD IS STANDARD.                                           
       COPY BP13F880.                                                           
                                                                                
       FD   BP13K890                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K890.                                                           
                                                                                
       FD  P13L353B                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  L353B-PRINT-REC             PIC X(132).                              
                                                                                
       FD  P13L353C                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  L353C-PRINT-REC             PIC X(132).                              
                                                                                
       FD  P13L353D                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  L353D-PRINT-REC             PIC X(132).                              
                                                                                
       FD  P13L353E                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  L353E-PRINT-REC             PIC X(132).                              
                                                                                
                                                                                
      *-------------------------------------------------------------            
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  WS2-COUNTERS.                                                        
           05  WS2-CNT-F880-READ       PIC 9(4)    VALUE ZEROS.                 
           05  WS2-CNT-PRINT-L353A     PIC 9(4)    VALUE ZEROS.                 
           05  WS2-CNT-PRINT-L353B     PIC 9(4)    VALUE ZEROS.                 
           05  WS2-CNT-PRINT-L353C     PIC 9(4)    VALUE ZEROS.                 
           05  WS2-CNT-PRINT-L353D     PIC 9(4)    VALUE ZEROS.                 
           05  WS2-CNT-PRINT-L353E     PIC 9(4)    VALUE ZEROS.                 
           05  WS2-CNT-LINE-ON-L353A   PIC 9(2)    VALUE 66.                    
           05  WS2-CNT-LINE-ON-L353B   PIC 9(2)    VALUE 66.                    
           05  WS2-CNT-LINE-ON-L353C   PIC 9(2)    VALUE 66.                    
           05  WS2-CNT-LINE-ON-L353D   PIC 9(2)    VALUE 00.                    
           05  WS2-CNT-LINE-ON-L353E   PIC 9(2)    VALUE 66.                    
           05  WS2-CNT-NO-PAGE-L353A   PIC 9(5)    VALUE ZEROS.                 
           05  WS2-CNT-NO-PAGE-L353B   PIC 9(5)    VALUE ZEROS.                 
           05  WS2-CNT-NO-PAGE-L353C   PIC 9(5)    VALUE ZEROS.                 
           05  WS2-CNT-NO-PAGE-L353D   PIC 9(5)    VALUE ZEROS.                 
           05  WS2-CNT-NO-PAGE-L353E   PIC 9(5)    VALUE ZEROS.                 
                                                                                
       01  WS3-ACCUM-FIELDS.                                                    
           05  WS3-TOT-AMT-CD-REQ      PIC S9(7)V99 COMP-3 VALUE +0.            
           05  WS3-REFUND              PIC S9(8)V99 COMP-3 VALUE +0.            
           05  WS3-TOT-REFUND          PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS3-TOT-AMT-CD-REQ-CRM  PIC S9(7)V99 COMP-3 VALUE +0.            
           05  WS3-TOT-REFUND-CRM      PIC S9(9)V99 COMP-3 VALUE +0.            
                                                                                
       01  WS4-SWITCHES.                                                        
           05  WS4-EOF-IND         PIC X(1)    VALUE 'N'.                       
               88 WS4-EOF          VALUE 'Y'.                                   
                                                                                
       01  WS5-PRT-DATE.                                                        
           05 WS5-CUR-DD           PIC X(2).                                    
           05 FILLER               PIC X      VALUE '/'.                        
           05 WS5-CUR-MM           PIC X(2).                                    
           05 FILLER               PIC X      VALUE '/'.                        
           05 WS5-CUR-CCYY         PIC X(4).                                    
                                                                                
       01  WS6-DEFAULT-VALUES.                                                  
           05  WS6-DEF-DUP-LEASE   PIC 9(2)    VALUE  2.                        
           05  WS6-MAX-LINES       PIC 9(2)    VALUE  20.                       
      *    05  WS6-L353A-RPT-ID    PIC X(14)   VALUE  'P13L353A'.               
           05  WS6-L353B-RPT-ID    PIC X(14)   VALUE  'P13L353B'.               
                                                                                
       01  WS7-FILE-STATUS.                                                     
           05  K890-FSTAT          PIC X(2).                                    
                                                                                
       01  BP13F880-REC2.                                                       
           05  FILLER              PIC X(1995).                                 
           05  F880-NUM-OIC        PIC X(5).                                    
       01  WS-NUM-OIC-PREV         PIC X(5)    VALUE SPACES.                    
       01  WS-CHK-CRM-PRINT        PIC X(1)    VALUE SPACES.                    
                                                                                
      **********************************************************                
      *    WS FOR SUMMARY LIST OF AGREEMENT ORDER RAISED       *                
      **********************************************************                
       01  L353-PRT-HEAD-1.                                                     
           05  L353-HD1-RPT-ID     PIC X(14)   VALUE SPACES.                    
           05  FILLER              PIC X(8)    VALUE 'HDB3    '.                
           05  FILLER              PIC X(18)   VALUE SPACES.                    
           05  FILLER              PIC X(39)   VALUE                            
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER              PIC X(18)   VALUE SPACES.                    
           05  FILLER              PIC X(7)    VALUE 'DATE: '.                  
           05  L353-DATE           PIC X(10)    VALUE SPACES.                   
           05  FILLER              PIC X(8)    VALUE ' PAGE: '.                 
           05  L353-PAGE           PIC ZZZZ9.                                   
                                                                                
       01  L353-PRT-HEAD-3.                                                     
           05  FILLER              PIC X(31)   VALUE SPACES.                    
           05  FILLER              PIC X(56)   VALUE                            
             'SUMMARY LIST OF SUB-TRANSFER CASES COMPLETED FOR THE DAY'.        
           05  FILLER              PIC X(10)   VALUE SPACES.                    
           05  FILLER              PIC X(40)   VALUE                            
              'USER: SALES UNIT (AGREEMENT TEAM)'.                              
                                                                                
       01  L353-PRT-HEAD-4.                                                     
           05  FILLER              PIC X(07)   VALUE 'S/NO'.                    
           05  FILLER              PIC X(17)   VALUE 'SCH/ACC'.                 
           05  FILLER              PIC X(08)   VALUE 'OIC'.                     
           05  FILLER              PIC X(12)   VALUE 'NRIC1'.                   
           05  FILLER              PIC X(34)   VALUE 'NAME'.                    
           05  FILLER              PIC X(24)   VALUE 'FLAT ADDRESS'.            
           05  FILLER              PIC X(15)   VALUE 'SUB-TRANSFER'.            
           05  FILLER              PIC X(15)   VALUE 'NEW AMT CD REQ/'.         
                                                                                
       01  L353-PRT-HEAD-5.                                                     
           05  FILLER              PIC X(07)   VALUE  SPACES.                   
           05  FILLER              PIC X(17)   VALUE 'REGN NO'.                 
           05  FILLER              PIC X(08)   VALUE  SPACES.                   
           05  FILLER              PIC X(12)   VALUE 'NRIC2'.                   
           05  FILLER              PIC X(34)   VALUE 'NAME'.                    
           05  FILLER              PIC X(24)   VALUE  SPACES.                   
           05  FILLER              PIC X(15)   VALUE 'DATE'.                    
           05  FILLER              PIC X(15)   VALUE 'REFUND'.                  
                                                                                
       01  L353-PRT-DETAIL-1.                                                   
           05  L353-NO             PIC ZZZ9.                                    
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  L353-SCH-ACC        PIC X(14)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  L353-NUM-OIC        PIC X(05)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  L353-NRIC1          PIC X(09).                                   
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  L353-NAME1          PIC X(31).                                   
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  L353-BLK            PIC X(05).                                   
           05  L353-BLK-NO         PIC X(05).                                   
           05  L353-FLAT-NO.                                                    
               10  L353-HEX        PIC X(02).                                   
               10  L353-LEVEL-NO   PIC X(02).                                   
               10  L353-DASH       PIC X(01).                                   
               10  L353-UNIT-NO    PIC X(04).                                   
               10  L353-SUB-UNIT   PIC X(02).                                   
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  L353-DTE-SUBTRF     PIC X(10)   VALUE SPACES.                    
           05  FILLER              PIC X(05)   VALUE SPACES.                    
           05  L353-AMT-CD-REQ     PIC -Z,ZZZ,ZZ9.99.                           
                                                                                
       01  L353-PRT-DETAIL-2.                                                   
           05  FILLER              PIC X(07)   VALUE SPACES.                    
           05  L353-REG            PIC X(08)B(17).                              
           05  L353-NRIC2          PIC X(09)B(3).                               
           05  L353-NAME2          PIC X(31)B(3).                               
           05  L353-STREET         PIC X(20)B(18).                              
           05  L353-REFUND         PIC -ZZ,ZZZ,ZZ9.99.                          
                                                                                
       01  L353-PRT-DETAIL-3.                                                   
           05  FILLER              PIC X(83)   VALUE SPACES.                    
           05  FILLER              PIC X(55)   VALUE ALL '-'.                   
                                                                                
       01  L353-PRT-DETAIL-4.                                                   
           05  FILLER                  PIC X(84)   VALUE SPACES.                
           05  FILLER                  PIC X(32)   VALUE                        
               'TOTAL NEW AMT CD REQ : '.                                       
           05  L353-TOT-AMT-CD-REQ     PIC -ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L353-PRT-DETAIL-5.                                                   
           05  FILLER                  PIC X(84)   VALUE SPACES.                
           05  FILLER                  PIC X(31)   VALUE                        
               'TOTAL REFUND         : '.                                       
           05  L353-TOT-REFUND         PIC -ZZZ,ZZZ,ZZ9.99.                     
                                                                                
      **********************************************************                
      *    WS FOR UNMATCHED LISTING                            *                
      **********************************************************                
       01  L353B-PRT-HEAD-4.                                                    
           05  FILLER              PIC X(42)   VALUE SPACES.                    
           05  FILLER              PIC X(90)   VALUE                            
              ' UNMATCHED LISTING FOR FLAT INVENTORY '.                         
                                                                                
       01  L353B-PRT-HEAD-5.                                                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'NO.'.                     
           05  FILLER              PIC X(05)   VALUE SPACES.                    
           05  FILLER              PIC X(07)   VALUE 'SCH/ACC'.                 
           05  FILLER              PIC X(12)   VALUE SPACES.                    
           05  FILLER              PIC X(07)   VALUE 'REGN NO'.                 
           05  FILLER              PIC X(10)   VALUE SPACES.                    
           05  FILLER              PIC X(10)   VALUE 'REMARKS'.                 
                                                                                
       01  L353B-PRT-HEAD-6.                                                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(130)  VALUE ALL '-'.                   
                                                                                
       01  L353B-PRT-DETAIL-1.                                                  
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  L353B-NO            PIC ZZZ9.                                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  L353B-SCH-ACC       PIC X(14)   VALUE SPACE.                     
           05  FILLER              PIC X(07)   VALUE SPACES.                    
           05  L353B-CUR-REG       PIC X(08).                                   
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  L353B-REMARKS       PIC X(30)   VALUE                            
               'RECORD NOT FOUND IN FIS'.                                       
                                                                                
      *---------------------------------------------------------------*         
      *        MAIL HEADER                                            *         
      *---------------------------------------------------------------*         
       01  MAIL-HDR-HELO.                                                       
           05  FILLER PIC X(80)  VALUE 'HELO SGPHDB1'.                          
                                                                                
       01  MAIL-HDR-MAIL-FROM.                                                  
           05  FILLER PIC X(80)  VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.              
                                                                                
       01  MAIL-HDR-MAIL-RCPT-TO.                                               
           05  FILLER PIC X(80)  VALUE SPACES.                                  
                                                                                
       01  MAIL-HDR-MAIL-RCPT-NOOR.                                             
           05  FILLER PIC X(80)  VALUE 'RCPT TO:<NOORJAHAN_SHAIK_MOHAMED        
      -        '_GULEMKADER@hdb.gov.sg>'.                                       
                                                                                
       01  MAIL-HDR-MAIL-RCPT-BALA.                                             
           05  FILLER PIC X(80)  VALUE 'RCPT TO:<BALASUBRAMANIAM_ARUNASA        
      -        'LAM@hdb.gov.sg>'.                                               
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC1.                                              
           05  FILLER PIC X(80)  VALUE 'RCPT TO:<CHONG_YENG_MUI@hdb.gov.        
      -        'sg>'.                                                           
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC2.                                              
           05  FILLER PIC X(80)  VALUE                                          
              'RCPT TO:<HE_Jialing@hdb.gov.sg>'.                                
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC3.                                              
           05  FILLER PIC X(80)  VALUE                                          
              'RCPT TO:<Kathijah_Bee_ALI_MOHAMED@hdb.gov.sg>'.                  
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC4.                                              
           05  FILLER PIC X(80)  VALUE                                          
      *        'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                 
               'RCPT TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                          
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC5.                                              
           05  FILLER PIC X(80)  VALUE                                          
              "RCPT TO:<Nor'ain_MOHAMAD_JOHAR@hdb.gov.sg>".                     
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC6.                                              
           05  FILLER PIC X(80)  VALUE                                          
              'RCPT TO:<Siti_Zainah_MISONEP@hdb.gov.sg>'.                       
                                                                                
       01  MAIL-HDR-DATA.                                                       
           05  FILLER PIC X(80)  VALUE 'DATA'.                                  
                                                                                
       01  MAIL-HDR-FROM.                                                       
           05  FILLER PIC X(80)  VALUE 'FROM:Soc System - Email Alert'.         
                                                                                
       01  MAIL-HDR-MAIL-TO.                                                    
           05  FILLER PIC X(80)  VALUE SPACES.                                  
                                                                                
       01  MAIL-HDR-MAIL-TO-NOOR.                                               
           05  FILLER PIC X(80)  VALUE 'TO:<NOORJAHAN_SHAIK_MOHAMED_GULE        
      -        'MKADER@hdb.gov.sg>'.                                            
                                                                                
       01  MAIL-HDR-MAIL-NOOR2.                                                 
           05  FILLER PIC X(80)  VALUE 'CC:<NOORJAHAN_SHAIK_MOHAMED_GULE        
      -        'MKADER@hdb.gov.sg>'.                                            
                                                                                
       01  MAIL-HDR-MAIL-BALA.                                                  
           05  FILLER PIC X(80)  VALUE 'CC:<BALASUBRAMANIAM_ARUNASALAM@h        
      -        'db.gov.sg>'.                                                    
                                                                                
       01  MAIL-HDR-MAIL-CC1.                                                   
           05  FILLER PIC X(80)  VALUE 'CC:<CHONG_YENG_MUI@hdb.gov.sg>'.        
                                                                                
       01  MAIL-HDR-MAIL-CC2.                                                   
           05  FILLER PIC X(80)  VALUE                                          
               'CC:<HE_Jialing@hdb.gov.sg>'.                                    
                                                                                
       01  MAIL-HDR-MAIL-CC3.                                                   
           05  FILLER PIC X(80)  VALUE                                          
               'CC:<Kathijah_Bee_ALI_MOHAMED@hdb.gov.sg>'.                      
                                                                                
       01  MAIL-HDR-MAIL-CC4.                                                   
           05  FILLER PIC X(80)  VALUE                                          
      *        'CC:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                      
               'CC:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                               
                                                                                
       01  MAIL-HDR-MAIL-CC5.                                                   
           05  FILLER PIC X(80)  VALUE                                          
               "CC:<Nor'ain_MOHAMAD_JOHAR@hdb.gov.sg>".                         
                                                                                
       01  MAIL-HDR-MAIL-CC6.                                                   
           05  FILLER PIC X(80)  VALUE                                          
               'CC:<Siti_Zainah_MISONEP@hdb.gov.sg>'.                           
                                                                                
       01  MAIL-SUBJECT.                                                        
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Daily List of Sub-Tran        
      -        'sfer Cases'.                                                    
                                                                                
       01  MAIL-SUBJECT-RPTB.                                                   
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Unmatched Listing for         
      -        'Flat Inventory'.                                                
                                                                                
       01  MAIL-HDR-DATE.                                                       
           05  FILLER                  PIC X(6)   VALUE 'DATE: '.               
           05  MAIL-DATE               PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-CRM-BODY.                                                       
           05  FILLER PIC X(80)  VALUE 'The Sub-Transfer is completed.'.        
                                                                                
       01  MAIL-VT-BODY.                                                        
           05  FILLER PIC X(80)  VALUE 'FYNA to refund to outgoing party        
      -        '.'.                                                             
                                                                                
       01  MAIL-END.                                                            
           05 FILLER                   PIC X      VALUE '.'.                    
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(80)  VALUE SPACES.                 
                                                                                
                                                                                
      *---------------------------------------------------------------*         
      *        LINKAGE FOR BP13CCNT                                   *         
      *---------------------------------------------------------------*         
       01  WS-LINK-REC-CCNT.                                                    
           05  WS-LINK-CNTCT-TYPE           PIC X(3).                           
           05  WS-LINK-STAFF-NICK           PIC X(6).                           
           05  WS-LINK-STAFF-NUM            PIC X(6).                           
           05  WS-LINK-STAFF-CNTCT          PIC X(50).                          
           05  WS-LINK-SYSERR               PIC 9(4).                           
                                                                                
      *---------------------------------------------------------------*         
      *        LINKAGE FOR BP13C913                                   *         
      *---------------------------------------------------------------*         
       01  WS-LINK-REC.                                                         
           05  WS-LINK-NUM-SCH-ACC.                                             
               10  WS-LINK-NUM-SCH   PIC X(4).                                  
               10  WS-LINK-NUM-ACC   PIC X(5).                                  
                                                                                
       COPY P13COMM8.                                                           
                                                                                
                                                                                
      *-------------------------------------------------------------            
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       MAIN-ROUTINE.                                                            
      *-------------------------------------------------------------            
           PERFORM 10-OPEN-FILES THRU 10-EXIT.                                  
           PERFORM 100-READ-BP13F880 THRU 100-EXIT UNTIL WS4-EOF.               
           PERFORM 20-PRINT-TOTAL THRU 20-EXIT.                                 
           PERFORM 30-CLOSE-ROUTINE THRU 30-EXIT.                               
                                                                                
       MAIN-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       10-OPEN-FILES.                                                           
      *-------------------------------------------------------------            
           OPEN INPUT  BP13F880                                                 
                       BP13K890                                                 
                OUTPUT P13L353B                                                 
                       P13L353C                                                 
                       P13L353D                                                 
                       P13L353E.                                                
                                                                                
           IF K890-FSTAT NOT = '00' AND '97'                                    
              DISPLAY 'BP13K890 OPEN ERROR STATUS : ' K890-FSTAT                
              PERFORM 30-CLOSE-ROUTINE    THRU  30-EXIT.                        
                                                                                
       10-EXIT.                                                                 
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       20-PRINT-TOTAL.                                                          
      *-------------------------------------------------------------            
      *       PRINT TOTAL FOR AMOUNTS (L353)                           *        
      ******************************************************************        
      *    MOVE WS6-L353A-RPT-ID TO L353-HD1-RPT-ID.                            
                                                                                
           PERFORM 600-CHECK-LINECT THRU 600-EXIT.                              
                                                                                
           ADD 1                TO  WS2-CNT-LINE-ON-L353A.                      
      *    WRITE L353A-PRINT-REC FROM L353-PRT-DETAIL-3 AFTER 2.                
      *    MOVE SPACES          TO L353A-PRINT-REC.                             
                                                                                
           MOVE WS3-TOT-AMT-CD-REQ  TO L353-TOT-AMT-CD-REQ.                     
           MOVE WS3-TOT-REFUND      TO L353-TOT-REFUND.                         
      *    WRITE L353A-PRINT-REC FROM L353-PRT-DETAIL-4 AFTER 1.                
      *    WRITE L353A-PRINT-REC FROM L353-PRT-DETAIL-5 AFTER 1.                
      *    MOVE SPACES TO L353A-PRINT-REC.                                      
      *    WRITE L353A-PRINT-REC FROM L353-PRT-DETAIL-3 AFTER 2.                
                                                                                
           WRITE L353C-PRINT-REC FROM MAIL-SPACES.                              
           WRITE L353C-PRINT-REC FROM L353-PRT-DETAIL-3.                        
           WRITE L353C-PRINT-REC FROM L353-PRT-DETAIL-4.                        
           WRITE L353C-PRINT-REC FROM L353-PRT-DETAIL-5.                        
           WRITE L353C-PRINT-REC FROM L353-PRT-DETAIL-3.                        
           WRITE L353C-PRINT-REC FROM MAIL-SPACES.                              
                                                                                
           PERFORM 611-PRINT-CRM-FOOTER THRU 611-EXIT.                          
                                                                                
       20-EXIT.                                                                 
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       30-CLOSE-ROUTINE.                                                        
      *-------------------------------------------------------------            
           CLOSE BP13F880                                                       
                 BP13K890                                                       
                 P13L353B                                                       
                 P13L353C                                                       
                 P13L353D                                                       
                 P13L353E.                                                      
                                                                                
           IF K890-FSTAT NOT = '00' AND '97'                                    
              DISPLAY 'BP13K890 CLOSE ERROR : ' K890-FSTAT.                     
                                                                                
           DISPLAY ' ** BP13C353 ** '.                                          
           DISPLAY 'NO OF RECORDS READ FROM FILE (BP13F880)  = '                
                   WS2-CNT-F880-READ.                                           
      *    DISPLAY 'NO OF RECORDS PRINTED (P13L353A)         = '                
      *            WS2-CNT-PRINT-L353A.                                         
           DISPLAY 'NO OF UNMATCHED REC PRINTED (P13L353B)   = '                
                   WS2-CNT-PRINT-L353B.                                         
           STOP RUN.                                                            
                                                                                
       30-EXIT.                                                                 
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       100-READ-BP13F880.                                                       
      *-------------------------------------------------------------            
      *   1. READ FILE BP13F880.                                   *            
      *   2. STORE NECESSARY DETAILS FOR PRINTING.                 *            
      *   3. CALL BP13C913 USING F880-NUM-SCH-ACC.                 *            
      *   4. READ BM06K211 TO RETRIEVE NECESSARY DETAILS.          *            
      *   5. PRINT SUMMARY LIST OF AGREEMENT ORDER RAISED          *            
      **************************************************************            
           READ BP13F880                                                        
                AT END MOVE 'Y' TO WS4-EOF-IND                                  
                GO TO 100-EXIT.                                                 
                                                                                
           MOVE BP13F880-REC TO BP13F880-REC2.                                  
           ADD 1 TO WS2-CNT-F880-READ.                                          
                                                                                
           PERFORM 200-CALL-BP13C913   THRU 200-EXIT.                           
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       200-CALL-BP13C913.                                                       
      *-------------------------------------------------------------            
      *          CALL BP13C913 TO GET FLAT'S DETAILS           *                
      **********************************************************                
              MOVE SPACES                  TO BP13COMM8-REC.                    
              INITIALIZE                      BP13COMM8-REC.                    
                                                                                
              MOVE F880-NUM-SCH-ACC        TO WS-LINK-NUM-SCH-ACC               
                                                                                
              CALL 'BP13C913'  USING WS-LINK-REC,                               
                                     BP13COMM8-REC.                             
                                                                                
              IF COMM8-CDE-SYSERR = 0 AND COMM8-NME-STREET = SPACES             
                 DISPLAY 'SCH NOTFND IN PIDB TABLE ' F880-NUM-SCH-ACC           
                 PERFORM 400-MV-L353B-PRT THRU 400-EXIT                         
              ELSE                                                              
              IF COMM8-CDE-SYSERR NOT = 0                                       
                 DISPLAY 'ERROR READING PIDB TABLE ' COMM8-CDE-SYSERR           
              END-IF.                                                           
                                                                                
              IF COMM8-NUM-BLK = SPACES                                         
                 MOVE SPACES                  TO L353-BLK                       
              ELSE                                                              
                 MOVE 'BLK  '                 TO L353-BLK                       
              END-IF.                                                           
              IF COMM8-NUM-LEVEL  = SPACES                                      
                 MOVE SPACES                  TO L353-HEX                       
              ELSE                                                              
                 MOVE '# '                    TO L353-HEX                       
              END-IF.                                                           
              IF COMM8-NUM-UNIT-MAIN = SPACES                                   
                 MOVE SPACES                  TO L353-DASH                      
              ELSE                                                              
                 MOVE '-'                     TO L353-DASH                      
              END-IF.                                                           
                                                                                
              MOVE COMM8-NUM-BLK           TO L353-BLK-NO.                      
              MOVE COMM8-NME-STREET        TO L353-STREET.                      
              MOVE COMM8-NUM-LEVEL         TO L353-LEVEL-NO.                    
              MOVE COMM8-NUM-UNIT-MAIN     TO L353-UNIT-NO.                     
              MOVE COMM8-NUM-UNIT-SUB      TO L353-SUB-UNIT.                    
              PERFORM 300-MV-L353-PRT THRU 300-EXIT.                            
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       300-MV-L353-PRT.                                                         
      *-------------------------------------------------------------            
      *   MOVE NECESSARY DETAILS TO REPORT L353 AND PRINT      *                
      **********************************************************                
           MOVE F880-NUM-REGN          TO L353-REG                              
                                          K890-NUM-REGN.                        
                                                                                
           STRING F880-NUM-SCH-ACC(1:4) '-'                                     
                  F880-NUM-SCH-ACC(5:4) '-'                                     
                  F880-NUM-SCH-ACC(9:1) '-'                                     
                  F880-NUM-SCH-ACC(10:2)                                        
                  DELIMITED BY SIZE INTO L353-SCH-ACC.                          
                                                                                
           MOVE F880-NUM-NRIC1-TREE    TO L353-NRIC1                            
                                          K890-NUM-NRIC                         
           PERFORM 310-READ-BP13K890   THRU  310-EXIT                           
           MOVE K890-NME-OCCP          TO L353-NAME1.                           
                                                                                
           IF F880-DTE-SUB-TRANSFER = SPACES OR LOW-VALUES                      
              MOVE SPACES TO L353-DTE-SUBTRF                                    
           ELSE                                                                 
              MOVE F880-DTE-SUB-TRANSFER (7:2)  TO                              
                                          WS5-CUR-DD OF WS5-PRT-DATE            
              MOVE F880-DTE-SUB-TRANSFER (5:2)  TO                              
                                          WS5-CUR-MM OF WS5-PRT-DATE            
              MOVE F880-DTE-SUB-TRANSFER (1:4)  TO                              
                                          WS5-CUR-CCYY OF WS5-PRT-DATE          
              MOVE WS5-PRT-DATE TO L353-DTE-SUBTRF.                             
                                                                                
           MOVE F880-AMT-NEW-CD-REQ    TO L353-AMT-CD-REQ.                      
                                                                                
           MOVE F880-NUM-NRIC2-TREE    TO L353-NRIC2                            
                                          K890-NUM-NRIC                         
           PERFORM 310-READ-BP13K890   THRU  310-EXIT                           
           MOVE K890-NME-OCCP          TO L353-NAME2.                           
                                                                                
           COMPUTE WS3-REFUND     = F880-AMT-REFUND-CASH +                      
                                    F880-AMT-REFUND-CPF1 +                      
                                    F880-AMT-REFUND-CPF2 +                      
                                    F880-AMT-REFUND-CPF3 +                      
                                    F880-AMT-REFUND-CPF4.                       
                                                                                
           MOVE WS3-REFUND       TO L353-REFUND.                                
                                                                                
           MOVE F880-NUM-OIC            TO L353-NUM-OIC.                        
                                                                                
           PERFORM 500-PRINT THRU 500-EXIT.                                     
                                                                                
           ADD F880-AMT-NEW-CD-REQ      TO WS3-TOT-AMT-CD-REQ.                  
           ADD WS3-REFUND               TO WS3-TOT-REFUND.                      
                                                                                
           IF WS-CHK-CRM-PRINT = 'Y'                                            
              ADD F880-AMT-NEW-CD-REQ   TO WS3-TOT-AMT-CD-REQ-CRM               
              ADD WS3-REFUND            TO WS3-TOT-REFUND-CRM                   
           END-IF.                                                              
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       310-READ-BP13K890.                                                       
      *-------------------------------------------------------------            
      *      READ BP13K890 TO GET APPLICANT NAMES.                 *            
      **************************************************************            
           READ BP13K890.                                                       
           IF K890-FSTAT NOT = '00'                                             
              MOVE 'NOT FND IN SUBTRF-OCCUP'   TO K890-NME-OCCP                 
              DISPLAY 'ERROR READ BP13K890 STATUS = ' K890-FSTAT                
              DISPLAY 'BP13K890-KEY-FLD = ' K890-FSTAT.                         
                                                                                
       310-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       400-MV-L353B-PRT.                                                        
      *-------------------------------------------------------------            
      *      PRINT MISTMATCHED LISTING.                            *            
      **************************************************************            
           MOVE WS6-L353B-RPT-ID TO L353-HD1-RPT-ID.                            
                                                                                
           PERFORM 600-CHECK-LINECT THRU 600-EXIT.                              
                                                                                
           ADD 1  TO WS2-CNT-PRINT-L353B                                        
                     WS2-CNT-LINE-ON-L353B.                                     
           MOVE F880-NUM-REGN      TO L353B-CUR-REG.                            
           STRING F880-NUM-SCH-ACC(1:4) '-'                                     
                  F880-NUM-SCH-ACC(5:4) '-'                                     
                  F880-NUM-SCH-ACC(9:1) '-'                                     
                  F880-NUM-SCH-ACC(10:2)                                        
                  DELIMITED BY SIZE INTO L353B-SCH-ACC.                         
           MOVE WS2-CNT-PRINT-L353B TO L353B-NO.                                
           WRITE L353B-PRINT-REC   FROM L353B-PRT-DETAIL-1 AFTER 1.             
           WRITE L353E-PRINT-REC   FROM L353B-PRT-DETAIL-1.                     
           MOVE SPACES             TO L353B-PRINT-REC.                          
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       500-PRINT.                                                               
      *-------------------------------------------------------------            
      *       PRINT DETAIL LINE FOR REPORT L353                        *        
      ******************************************************************        
      *    MOVE WS6-L353A-RPT-ID       TO L353-HD1-RPT-ID.                      
                                                                                
           PERFORM 600-CHECK-LINECT THRU 600-EXIT.                              
           PERFORM 610-CHECK-OIC    THRU 610-EXIT.                              
                                                                                
           ADD 1                   TO WS2-CNT-PRINT-L353A                       
                                      WS2-CNT-LINE-ON-L353A.                    
           MOVE WS2-CNT-PRINT-L353A TO L353-NO.                                 
      *    WRITE L353A-PRINT-REC   FROM L353-PRT-DETAIL-1 AFTER 1.              
           WRITE L353C-PRINT-REC   FROM L353-PRT-DETAIL-1.                      
           IF WS-CHK-CRM-PRINT = 'Y'                                            
              WRITE L353D-PRINT-REC   FROM L353-PRT-DETAIL-1                    
           END-IF.                                                              
      *    MOVE SPACES             TO L353A-PRINT-REC.                          
                                                                                
           ADD 1                   TO WS2-CNT-LINE-ON-L353A.                    
      *    WRITE L353A-PRINT-REC   FROM L353-PRT-DETAIL-2 AFTER 1.              
           WRITE L353C-PRINT-REC   FROM L353-PRT-DETAIL-2.                      
           IF WS-CHK-CRM-PRINT = 'Y'                                            
              WRITE L353D-PRINT-REC   FROM L353-PRT-DETAIL-2                    
           END-IF.                                                              
      *    MOVE SPACES             TO L353A-PRINT-REC.                          
                                                                                
      *    WRITE L353A-PRINT-REC.                                               
           WRITE L353C-PRINT-REC   FROM MAIL-SPACES.                            
           IF WS-CHK-CRM-PRINT = 'Y'                                            
              WRITE L353D-PRINT-REC   FROM MAIL-SPACES                          
              ADD   1                 TO   WS2-CNT-LINE-ON-L353D                
           END-IF.                                                              
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       600-CHECK-LINECT.                                                        
      *-------------------------------------------------------------            
      *          CHECK LINE COUNT TO DETERMINE PAGE THROW              *        
      *                EITHER FOR L353 OR L353B                        *        
      ******************************************************************        
           IF (L353-HD1-RPT-ID = WS6-L353B-RPT-ID) AND                          
              (WS2-CNT-LINE-ON-L353B > WS6-MAX-LINES)                           
               PERFORM 700-PRINT-RPT-HEADING THRU 700-EXIT                      
               MOVE 1 TO WS2-CNT-LINE-ON-L353B.                                 
                                                                                
      *    IF (L353-HD1-RPT-ID = WS6-L353A-RPT-ID) AND                          
      *       (WS2-CNT-LINE-ON-L353A > WS6-MAX-LINES)                           
           IF (L353-HD1-RPT-ID NOT = WS6-L353B-RPT-ID)                          
               PERFORM 700-PRINT-RPT-HEADING THRU 700-EXIT.                     
      *        MOVE 1 TO WS2-CNT-LINE-ON-L353A.                                 
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       610-CHECK-OIC.                                                           
      *-------------------------------------------------------------            
      *    NOTE: OIC MUST BE SORTED ASCENDINGLY                                 
      ****************************************************************          
                                                                                
           IF F880-NUM-OIC = SPACES                                             
              MOVE 'N' TO WS-CHK-CRM-PRINT                                      
              GO TO 610-EXIT                                                    
           END-IF.                                                              
                                                                                
           MOVE 'Y'                   TO   WS-CHK-CRM-PRINT.                    
                                                                                
           IF F880-NUM-OIC NOT = WS-NUM-OIC-PREV                                
              IF WS2-CNT-LINE-ON-L353D NOT = 0                                  
                 PERFORM 611-PRINT-CRM-FOOTER THRU 611-EXIT                     
              END-IF                                                            
                                                                                
              PERFORM 612-CALL-BP13CCNT THRU 612-EXIT                           
                                                                                
              MOVE SPACES TO MAIL-HDR-MAIL-RCPT-TO,MAIL-HDR-MAIL-TO             
              STRING 'RCPT TO:<'          DELIMITED BY SIZE                     
                      WS-LINK-STAFF-CNTCT DELIMITED BY SPACE                    
                     '>'                  DELIMITED BY SIZE                     
                INTO MAIL-HDR-MAIL-RCPT-TO                                      
                                                                                
              STRING 'TO:<'               DELIMITED BY SIZE                     
                      WS-LINK-STAFF-CNTCT DELIMITED BY SPACE                    
                     '>'                  DELIMITED BY SIZE                     
                INTO MAIL-HDR-MAIL-TO                                           
                                                                                
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-HELO                        
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-FROM                   
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-TO                
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC1               
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC2               
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC3               
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC4               
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC5               
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC6               
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-NOOR              
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-BALA              
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-DATA                        
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-FROM                        
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-TO                     
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-CC1                    
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-CC2                    
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-CC3                    
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-CC4                    
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-CC5                    
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-CC6                    
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-NOOR2                  
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-MAIL-BALA                   
              WRITE L353D-PRINT-REC   FROM MAIL-SUBJECT                         
              WRITE L353D-PRINT-REC   FROM MAIL-HDR-DATE                        
              WRITE L353D-PRINT-REC   FROM MAIL-CRM-BODY                        
              WRITE L353D-PRINT-REC   FROM MAIL-SPACES                          
              MOVE  1                 TO   WS2-CNT-LINE-ON-L353D                
                                                                                
              WRITE L353D-PRINT-REC   FROM L353-PRT-HEAD-4                      
              WRITE L353D-PRINT-REC   FROM L353-PRT-HEAD-5                      
              WRITE L353D-PRINT-REC   FROM MAIL-SPACES                          
                                                                                
              MOVE F880-NUM-OIC       TO   WS-NUM-OIC-PREV                      
           END-IF.                                                              
                                                                                
       610-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       611-PRINT-CRM-FOOTER.                                                    
      *-------------------------------------------------------------            
                                                                                
           MOVE WS3-TOT-AMT-CD-REQ-CRM TO L353-TOT-AMT-CD-REQ.                  
           MOVE WS3-TOT-REFUND-CRM     TO L353-TOT-REFUND.                      
                                                                                
           WRITE L353D-PRINT-REC FROM MAIL-SPACES.                              
           WRITE L353D-PRINT-REC FROM L353-PRT-DETAIL-3.                        
           WRITE L353D-PRINT-REC FROM L353-PRT-DETAIL-4.                        
           WRITE L353D-PRINT-REC FROM L353-PRT-DETAIL-5.                        
           WRITE L353D-PRINT-REC FROM L353-PRT-DETAIL-3.                        
           WRITE L353D-PRINT-REC FROM MAIL-SPACES.                              
                                                                                
           WRITE L353D-PRINT-REC FROM MAIL-END.                                 
                                                                                
           MOVE  0                     TO WS3-TOT-AMT-CD-REQ-CRM                
                                          WS3-TOT-REFUND-CRM.                   
                                                                                
       611-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       612-CALL-BP13CCNT.                                                       
      *-------------------------------------------------------------            
                                                                                
           INITIALIZE                      WS-LINK-REC-CCNT.                    
                                                                                
           MOVE F880-NUM-OIC          TO   WS-LINK-STAFF-NICK.                  
           MOVE 'EML'                 TO   WS-LINK-CNTCT-TYPE.                  
                                                                                
           CALL 'BP13CCNT'         USING   WS-LINK-REC-CCNT.                    
                                                                                
           EVALUATE WS-LINK-SYSERR                                              
           WHEN 000                                                             
              CONTINUE                                                          
           WHEN 100                                                             
              DISPLAY 'EMAIL ADDRESS NOT FOUND FOR ' F880-NUM-REGN              
              STRING  F880-NUM-OIC DELIMITED BY SPACE                           
                     '@hdb.gov.sg' DELIMITED BY SIZE                            
                INTO  WS-LINK-STAFF-CNTCT                                       
           WHEN OTHER                                                           
              DISPLAY 'BP13CCNT ERROR STATUS : ' WS-LINK-SYSERR                 
              PERFORM 30-CLOSE-ROUTINE    THRU  30-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       612-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       700-PRINT-RPT-HEADING.                                                   
      *-------------------------------------------------------------            
      * PRINT HEADING EITHER FOR L353 OR L353B DEPENDING ON INDICATOR *         
      ****************************************************************          
                                                                                
           STRING FUNCTION CURRENT-DATE(7:2) '/'                                
                  FUNCTION CURRENT-DATE(5:2) '/'                                
                  FUNCTION CURRENT-DATE(1:4)                                    
           DELIMITED BY SIZE INTO L353-DATE.                                    
                                                                                
           IF L353-HD1-RPT-ID NOT = WS6-L353B-RPT-ID                            
      *       ADD  1                     TO WS2-CNT-NO-PAGE-L353A               
      *       MOVE WS2-CNT-NO-PAGE-L353A TO L353-PAGE                           
      *       MOVE SPACES                TO L353A-PRINT-REC                     
      *       WRITE L353A-PRINT-REC AFTER PAGE                                  
      *       WRITE L353A-PRINT-REC FROM L353-PRT-HEAD-1 AFTER 1                
      *       WRITE L353A-PRINT-REC FROM L353-PRT-HEAD-3 AFTER 1                
      *       WRITE L353A-PRINT-REC FROM L353-PRT-HEAD-4 AFTER 2                
      *       WRITE L353A-PRINT-REC FROM L353-PRT-HEAD-5 AFTER 1                
      *       MOVE SPACES                TO L353A-PRINT-REC                     
      *                                     L353-HD1-RPT-ID                     
      *       WRITE L353A-PRINT-REC AFTER 2                                     
      *                                                                         
              IF WS2-CNT-LINE-ON-L353C > WS6-MAX-LINES                          
                 MOVE  L353-DATE         TO   MAIL-DATE                         
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-HELO                     
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-FROM                
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-NOOR           
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC1            
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC2            
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC3            
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC4            
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC5            
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC6            
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-BALA           
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-DATA                     
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-FROM                     
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-TO-NOOR             
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-CC1                 
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-CC2                 
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-CC3                 
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-CC4                 
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-CC5                 
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-CC6                 
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-MAIL-BALA                
                 WRITE L353C-PRINT-REC   FROM MAIL-SUBJECT                      
                 WRITE L353C-PRINT-REC   FROM MAIL-HDR-DATE                     
                 WRITE L353C-PRINT-REC   FROM MAIL-VT-BODY                      
                 WRITE L353C-PRINT-REC   FROM MAIL-SPACES                       
                 MOVE  1                 TO   WS2-CNT-LINE-ON-L353C             
                                                                                
                 WRITE L353C-PRINT-REC   FROM L353-PRT-HEAD-4                   
                 WRITE L353C-PRINT-REC   FROM L353-PRT-HEAD-5                   
                 WRITE L353C-PRINT-REC   FROM MAIL-SPACES                       
              END-IF                                                            
           ELSE                                                                 
              ADD  1                     TO WS2-CNT-NO-PAGE-L353B               
              MOVE WS2-CNT-NO-PAGE-L353B TO L353-PAGE                           
              MOVE SPACES                TO L353B-PRINT-REC                     
              WRITE L353B-PRINT-REC AFTER PAGE                                  
              WRITE L353B-PRINT-REC FROM L353-PRT-HEAD-1 AFTER 1                
              WRITE L353B-PRINT-REC FROM L353-PRT-HEAD-3 AFTER 1                
              WRITE L353B-PRINT-REC FROM L353B-PRT-HEAD-4 AFTER 2               
              WRITE L353B-PRINT-REC FROM L353B-PRT-HEAD-5 AFTER 2               
              WRITE L353B-PRINT-REC FROM L353B-PRT-HEAD-6 AFTER 1               
              MOVE SPACES          TO   L353B-PRINT-REC                         
                                        L353-HD1-RPT-ID                         
              WRITE L353B-PRINT-REC AFTER 2                                     
                                                                                
              IF WS2-CNT-LINE-ON-L353E > WS6-MAX-LINES                          
                 MOVE  L353-DATE         TO   MAIL-DATE                         
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-HELO                     
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-FROM                
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-NOOR           
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC1            
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC2            
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC3            
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC4            
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC5            
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-RCPT-CC6            
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-DATA                     
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-FROM                     
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-TO-NOOR             
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-CC1                 
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-CC2                 
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-CC3                 
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-CC4                 
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-CC5                 
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-MAIL-CC6                 
                 WRITE L353E-PRINT-REC   FROM MAIL-SUBJECT-RPTB                 
                 WRITE L353E-PRINT-REC   FROM MAIL-HDR-DATE                     
                 MOVE  1                 TO   WS2-CNT-LINE-ON-L353E             
                                                                                
                 WRITE L353E-PRINT-REC   FROM L353B-PRT-HEAD-4                  
                 WRITE L353E-PRINT-REC   FROM L353B-PRT-HEAD-5                  
                 WRITE L353E-PRINT-REC   FROM MAIL-SPACES                       
              END-IF.                                                           
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
