       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C271.                                                 
      *AUTHOR.        SONNY A.                                                  
      *DATE-WRITTEN.  11/03/97.                                                 
      *DATE-COMPILED.                                                           
      * =========================================================== *           
      *             SYSTEM OF COMMITMENT (SOC)                      *           
      * =========================================================== *           
      *                                                             *           
      *  OBJECTIVE : TO PRINT LETTERS FOR SALES                     *           
      *              WHERE F838-NUM-AMIS    = '1' OR '2' OR         *           
      *                    F838-CDE-PRINTED = 'Y'                   *           
      *                                                             *           
      *  INPUT FILES                                                *           
      *      BP13F838  --                                           *           
      *      BP13K820  --                                           *           
      *      BP13K830  --                                           *           
      *                                                             *           
      *  OUTPUT                                                     *           
      *      P13P271A  -- LETTER FOR AMIS      (COPY)               *           
      *      P13P271B  -- LETTER FOR CORR ADDR                      *           
      *      P13P271C  -- LETTER FOR CORR ADDR (COPY)                           
      *      P13P271D  -- LETTER W/O CORR ADDR                      *           
      *      P13P271E  -- LETTER W/O CORR ADDR (COPY)                           
      *                                                             *           
      *      P13L271A  -- SUMMARY REPORT FOR LETTER FOR AMIS        *           
      *      P13L271B  -- SUMMARY REPORT FOR LETTER FOR CORR ADDR   *           
      *      P13L271C  -- SUMMARY REPORT FOR LETTER W/O CORR ADDR   *           
      *                                                             *           
      *      AV02C015 - POSTAL CODE SUBROUNTINE                     *           
      *                                                             *           
      * ----------------------------------------------------------- *           
      * CHG REF  DATE     OIC  REMARKS                              *           
      * -------- -------- ---  -------                              *           
      * BP130251 11/03/97 SIA  NEW PGM                              *           
      * BP130251 26/08/97 LMS  CHG HEADING FOR P13L271C             *           
      * BP130383 09/01/98 LMS  CHG OF BP13K838 LAYOUT               *           
      * BP130418 21/09/98 LMS  CATER FOR Y2000                      *           
      * BP132038 08/12/01 JAM  REMOVE RESPONSE SLIP FROM FORM       *           
      *                        BP13H2 & CREATE A SEPERATE FORM      *           
      *                        BP13H5. - USE CYCLEFORM              *           
      * BP132127 03/06/02 CKK  TO CHANGE LETTER LAYOUT              *           
      * BP132545 20041109 SSS  +1 LINE FOR HA1 NAME                 *           
      * BP132626 20041209 CKK  CHANGE ALIGNMENT                     *           
      * BP134779 20130221 IL5  CHANGE SALES OPERATIONS UNIT TO      *           
      *                        SALES OPERATIONS SECTION             *           
      * BP137023 20171003 FNP1 REMOVE DUPLICATE COPY                *           
      * BP137986 20190905 CC37 CHANGE IN LAYOUT OF FORMS            *           
      * BP137986 20200106 CC37 TO REMOVE PRINTING OF BE0201 FORM    *           
      * =========================================================== *           
                                                                                
       ENVIRONMENT DIVISION.                                                    
      *-------------------------------------------------------------            
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
      *-------------------------------------------------------------            
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F838 ASSIGN TO BP13F838.                                  
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                        ACCESS MODE          IS RANDOM                          
                        ORGANIZATION         IS INDEXED                         
                        RECORD KEY           IS K820-KEY-FLD                    
                        ALTERNATE RECORD KEY IS K820-NUM-NRIC                   
                                                WITH DUPLICATES                 
                        FILE STATUS          IS WS-K820-STATUS.                 
                                                                                
           SELECT BP13K830 ASSIGN TO BP13K830                                   
                        ACCESS MODE          IS RANDOM                          
                        ORGANIZATION         IS INDEXED                         
                        RECORD KEY           IS K830-KEY-FLD                    
                        ALTERNATE RECORD KEY IS K830-NUM-REGN                   
                                                WITH DUPLICATES                 
                        FILE STATUS          IS WS-K830-STATUS.                 
                                                                                
           SELECT P13P271A ASSIGN TO P13P271A.                                  
           SELECT P13P271B ASSIGN TO P13P271B.                                  
           SELECT P13P271C ASSIGN TO P13P271C.                                  
           SELECT P13P271D ASSIGN TO P13P271D.                                  
           SELECT P13P271E ASSIGN TO P13P271E.                                  
                                                                                
           SELECT P13L271A ASSIGN TO P13L271A.                                  
           SELECT P13L271B ASSIGN TO P13L271B.                                  
           SELECT P13L271C ASSIGN TO P13L271C.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
      *-------------------------------------------------------------            
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
                                                                                
       FD  BP13K820                                                             
               RECORD CONTAINS 400 CHARACTERS.                                  
       COPY BP13K820.                                                           
                                                                                
       FD  BP13F838                                                             
               BLOCK CONTAINS 0 RECORDS                                         
               RECORD CONTAINS 400 CHARACTERS                                   
               LABEL RECORDS ARE STANDARD                                       
               RECORDING MODE IS F.                                             
       COPY BP13F838.                                                           
                                                                                
       FD  BP13K830                                                             
               RECORD CONTAINS 250 CHARACTERS.                                  
       COPY BP13K830.                                                           
                                                                                
       FD  P13P271A                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P271A-REC                 PIC X(80).                              
                                                                                
       FD  P13P271B                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P271B-REC                 PIC X(80).                              
                                                                                
       FD  P13P271C                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P271C-REC                 PIC X(80).                              
                                                                                
       FD  P13P271D                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P271D-REC                 PIC X(80).                              
                                                                                
       FD  P13P271E                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P271E-REC                 PIC X(80).                              
                                                                                
       FD  P13L271A                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13L271A-REC                PIC X(132).                              
                                                                                
       FD  P13L271B                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13L271B-REC                PIC X(132).                              
                                                                                
       FD  P13L271C                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13L271C-REC                PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       COPY AV02COMM.                                                           
                                                                                
       01  WS-DATE                     PIC X(8)   VALUE SPACES.                 
                                                                                
       01  WS-PRT-DTE.                                                          
           05   WS-PRT-YY              PIC X(4).                                
           05   FILLER                 PIC X  VALUE '/'.                        
           05   WS-PRT-MM              PIC X(2).                                
           05   FILLER                 PIC X  VALUE '/'.                        
           05   WS-PRT-DD              PIC X(2).                                
                                                                                
       01  WS-K830-FOUND               PIC X(1)   VALUE  'N'.                   
       01  WS-K820-FOUND               PIC X(1)   VALUE  'N'.                   
       01  WS-NUM-COUNT                PIC 9      VALUE  ZEROS.                 
                                                                                
      *-------------*                                                           
      * EOF FLAGS   *                                                           
      *-------------*                                                           
                                                                                
       01  EOF-BP13F838                PIC X      VALUE  'N'.                   
                                                                                
      *-------------*                                                           
      * FILE STATUS *                                                           
      *-------------*                                                           
                                                                                
       01  WS-K820-STATUS                 PIC 9(2) VALUE ZEROS.                 
       01  WS-K830-STATUS                 PIC 9(2) VALUE ZEROS.                 
                                                                                
      *--------*                                                                
      * COUNTS *                                                                
      *--------*                                                                
       01  WS-F838-READ                    PIC 9(6)  VALUE  ZEROS.              
       01  WS-K820-READ                    PIC 9(6)  VALUE  ZEROS.              
       01  WS-K830-READ                    PIC 9(6)  VALUE  ZEROS.              
       01  WS-K830-NOTFND                  PIC 9(6)  VALUE  ZEROS.              
       01  WS-P271A-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
       01  WS-P271B-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
       01  WS-P271C-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
       01  WS-P271D-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
       01  WS-P271E-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
                                                                                
       01  WS-L271A-WRITTEN                PIC 9(5)  VALUE  ZEROS.              
       01  WS-PG-CNT-L271A                 PIC 999   VALUE  ZEROS.              
       01  WS-COUNT-L271A                  PIC 9(2)  VALUE  55.                 
       01  WS-SNO-L271A                    PIC 9(6)  VALUE  ZEROS.              
                                                                                
       01  WS-L271B-WRITTEN                PIC 9(5)  VALUE  ZEROS.              
       01  WS-PG-CNT-L271B                 PIC 999   VALUE  ZEROS.              
       01  WS-COUNT-L271B                  PIC 9(2)  VALUE  55.                 
       01  WS-SNO-L271B                    PIC 9(6)  VALUE  ZEROS.              
                                                                                
       01  WS-L271C-WRITTEN                PIC 9(5)  VALUE  ZEROS.              
       01  WS-PG-CNT-L271C                 PIC 999   VALUE  ZEROS.              
       01  WS-COUNT-L271C                  PIC 9(2)  VALUE  55.                 
       01  WS-SNO-L271C                    PIC 9(6)  VALUE  ZEROS.              
                                                                                
      *-----------------                                                        
      * PRINT LETTER.                                                           
      *-----------------                                                        
                                                                                
       01  WS-DJDE-HDBREF.                                                      
           05  FILLER                      PIC X(11) VALUE  SPACES.             
      *    05  WS-DJDE-COPY                PIC X(07) VALUE SPACES.              
      *    05  FILLER                      PIC X(21) VALUE  SPACES.             
           05  WS-DJDE-NT-ZONE             PIC X(3).                            
           05  WS-DJDE-FLAT-TYPE           PIC X(2).                            
           05  WS-DJDE-HDBREF-SLASH        PIC X     VALUE  '/'.                
           05  WS-DJDE-REGN                PIC X(8).                            
                                                                                
       01  WS-BP13H-DTE.                                                        
           05  FILLER                      PIC X(02) VALUE SPACES.              
           05  WS-DJDE-DD                  PIC X(2).                            
           05  FILLER                      PIC X     VALUE  '/'.                
           05  WS-DJDE-MM                  PIC X(2).                            
           05  FILLER                      PIC X     VALUE  '/'.                
           05  WS-DJDE-YY                  PIC X(4).                            
                                                                                
       01  WS-BP13H5-DTE.                                                       
           05  FILLER                      PIC X(31) VALUE SPACES.              
           05  WS-DJDE-DD-H5               PIC X(2).                            
           05  FILLER                      PIC X     VALUE  '/'.                
           05  WS-DJDE-MM-H5               PIC X(2).                            
           05  FILLER                      PIC X     VALUE  '/'.                
           05  WS-DJDE-YY-H5               PIC X(4).                            
                                                                                
       01  WS-BP13H-NAME1.                                                      
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-NAME1                PIC X(52) VALUE SPACES.              
           05 WS-DJDE-NAME1-LABEL          PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-BP13H-NAME2.                                                      
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-NAME2                PIC X(52) VALUE SPACES.              
           05 WS-DJDE-NAME2-LABEL          PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-A.                                                   
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-BLK-NO               PIC X(10) VALUE SPACES.              
           05 FILLER                       PIC X(1)  VALUE SPACES.              
           05 WS-DJDE-NUM-FLAT.                                                 
              10 WS-DJDE-CHAR              PIC X     VALUE SPACE.               
              10 WS-DJDE-LEVEL             PIC X(2)  VALUE SPACES.              
              10 WS-DJDE-DASH              PIC X     VALUE SPACE.               
              10 WS-DJDE-HSE-MAIN          PIC X(4)  VALUE SPACES.              
              10 WS-DJDE-HSE-SUB           PIC X(3)  VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-B.                                                   
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-STREET-NAME          PIC X(65) VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-C.                                                   
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05  WS-DJDE-CODE                PIC X(16) VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-D.                                                   
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05  WS-DJDE-BARCODE             PIC X(09) VALUE SPACES.              
                                                                                
       01  WS-HDB-UNIT.                                                         
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(52) VALUE                      
              'SALES OPERATIONS SECTION'.                                       
           05 FILLER                       PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-HDB-NAME.                                                         
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(52) VALUE                      
              'HOUSING AND DEVELOPMENT BOARD'.                                  
           05 FILLER                       PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-HDB-CENTER.                                                       
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(30) VALUE                      
              'ATRIUM 1ST STOREY, HDB HUB'.                                     
           05 FILLER                       PIC X(12) VALUE SPACES.              
                                                                                
       01  WS-HDB-ADDR1.                                                        
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(65) VALUE                      
              '480 LORONG 6 TOA PAYOH'.                                         
                                                                                
       01  WS-HDB-POSTAL.                                                       
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(16) VALUE                      
              'SINGAPORE 310480'.                                               
                                                                                
       01  WS-HDB-BARCODE.                                                      
           05 FILLER                       PIC X(10) VALUE SPACES.              
           05 WS-HDB-BAR                   PIC X(09) VALUE SPACES.              
                                                                                
       01  WS-NEW-ADDRESS.                                                      
           05  WS-BP13H-NEW-ADDR-INFO1.                                         
               10  FILLER                  PIC X(02) VALUE SPACES.              
               10  WS-DJDE-NEW-NUM-BLK     PIC X(10) VALUE SPACES.              
               10  FILLER                  PIC X(01) VALUE SPACE.               
               10  WS-DJDE-NEW-FLAT.                                            
                   15 WS-DJDE-NEW-CHAR     PIC X(01) VALUE SPACE.               
                   15 WS-DJDE-NEW-NUM-LVL  PIC X(03) VALUE SPACES.              
                   15 WS-DJDE-NEW-DASH     PIC X(01) VALUE SPACE.               
                   15 WS-DJDE-NEW-NUM-UNIT PIC X(05) VALUE SPACES.              
           05  WS-BP13H-NEW-ADDR-INFO2.                                         
               10  FILLER                  PIC X(02) VALUE SPACES.              
               10  WS-DJDE-NEW-STREET-NME  PIC X(20) VALUE SPACES.              
           05  WS-BP13H-NEW-ADDR-INFO3.                                         
               10  FILLER                  PIC X(02) VALUE SPACES.              
               10  WS-DJDE-NEW-POSTAL-CDE  PIC X(16) VALUE SPACES.              
           05  WS-BP13H-NEW-ADDR-INFO4.                                         
               10  FILLER                  PIC X(01) VALUE SPACES.              
               10  WS-DJDE-NEW-BARCODE     PIC X(09) VALUE SPACES.              
                                                                                
       01  WS-DJDE-NRIC.                                                        
           05  FILLER                      PIC X(08) VALUE SPACES.              
           05  WS-DJDE-NRIC1               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05  WS-DJDE-NRIC2               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05  WS-DJDE-NRIC3               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05  WS-DJDE-NRIC4               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(03) VALUE SPACES.              
                                                                                
       01  WS-DETAIL-LINE.                                                      
           05  WS-REGN               PIC X(8)    VALUE SPACES.                  
           05  WS-NAME1              PIC X(40)   VALUE SPACES.                  
           05  WS-OLD-RES-ADDR.                                                 
               10  WS-BLK-RES-O      PIC X(10)   VALUE SPACES.                  
               10  FILLER            PIC X(1)    VALUE SPACES.                  
               10  WS-NUM-FLAT-O.                                               
                   15  WS-CHAR-O     PIC X       VALUE SPACE.                   
                   15  WS-LEVEL-O    PIC X(2)    VALUE SPACES.                  
                   15  WS-DASH-O     PIC X       VALUE SPACE.                   
                   15  WS-HSE-MAIN-O PIC X(4)    VALUE SPACES.                  
                   15  WS-HSE-SUB-O  PIC X(3)    VALUE SPACES.                  
           05  WS-NEW-RES-ADDR.                                                 
               10  WS-BLK-RES-N      PIC X(10)   VALUE SPACES.                  
               10  FILLER            PIC X(1)    VALUE SPACES.                  
               10  WS-NUM-FLAT-N.                                               
                   15  WS-CHAR-N     PIC X       VALUE SPACE.                   
                   15  WS-LEVEL-N    PIC X(3)    VALUE SPACES.                  
                   15  WS-DASH-N     PIC X       VALUE SPACE.                   
                   15  WS-HSE-MAIN-N PIC X(5)    VALUE SPACES.                  
           05  WS-CORR-ADDR.                                                    
               10  WS-BLK-CORR          PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X(1)    VALUE SPACES.               
               10  WS-NUM-FLAT-CORR.                                            
                   15  WS-CHAR-CORR     PIC X       VALUE SPACE.                
                   15  WS-LEVEL-CORR    PIC X(2)    VALUE SPACES.               
                   15  WS-DASH-CORR     PIC X       VALUE SPACE.                
                   15  WS-HSE-MAIN-CORR PIC X(4)    VALUE SPACES.               
                   15  WS-HSE-SUB-CORR  PIC X(3)    VALUE SPACES.               
                                                                                
       01  WS-RES-ADDR2.                                                        
           05  WS-NAME2              PIC X(40)   VALUE SPACES.                  
           05  WS-NME-STREET-O       PIC X(20)   VALUE SPACES.                  
           05  WS-NME-STREET-N       PIC X(20)   VALUE SPACES.                  
           05  WS-NME-STREET-CORR    PIC X(32)   VALUE SPACES.                  
                                                                                
       01  WS-RES-ADDR3.                                                        
           05  WS-NUM-POSTAL-O       PIC X(9)    VALUE SPACES.                  
           05  WS-NUM-POSTAL-N       PIC X(9)    VALUE SPACES.                  
           05  WS-NUM-POSTAL-CORR    PIC X(9)    VALUE SPACES.                  
                                                                                
       01  WS-REMAIN                 PIC 9(1)    VALUE ZEROES.                  
                                                                                
      *-------------------                                                      
      * FOR DJDE PRINTING.                                                      
      *-------------------                                                      
       01  WS-DJDE-INFO                   PIC X(100) VALUE                      
           '$DJDE$ FORMS=BE0201,END;'.                                          
                                                                                
      *01  WS-DJDE-BP13H1                 PIC X(100) VALUE                      
      *    '$DJDE$ FORMS=BP13H1,END;'.                                          
                                                                                
       01  WS-DJDE-BP13H1                 PIC X(80) VALUE                       
           '$DJDE$ JDE=13C24U,FORMS=BP13H1,COPIES=1,COLLATE=YES,JDL=BP13        
      -    ',DUPLEX=NO,END;'.                                                   
                                                                                
       01  WS-DJDE-BP13H2                 PIC X(80) VALUE                       
           '$DJDE$ JDE=13C24U,FORMS=BP13H2,COPIES=1,COLLATE=YES,JDL=BP13        
      -    ',DUPLEX=NO,END;'.                                                   
                                                                                
       01  WS-DJDE-BLANKF                 PIC X(80)   VALUE                     
           '$DJDE$ FORMS=BLANKF,SHIFT=(0,0),END;'.                              
                                                                                
      *----------------------------------------------------------------*        
      * HEADER LINES FOR REPORT P13L271                                *        
      *----------------------------------------------------------------*        
       01  L271-PR-HEAD-01.                                                     
           05  L271-HEADER              PIC X(8)    VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE SPACES .              
           05  FILLER                   PIC X(8)    VALUE 'HDBCAT 3'.           
           05  FILLER                   PIC X(21)   VALUE SPACES.               
           05  FILLER                   PIC X(39)   VALUE                       
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(17)   VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE 'DATE :'.             
           05  L271-PRT-DTE.                                                    
               07  L271-PRT-DD          PIC XX      VALUE SPACES.               
               07  FILLER               PIC X       VALUE '/'.                  
               07  L271-PRT-MM          PIC XX      VALUE SPACES.               
               07  FILLER               PIC X       VALUE '/'.                  
               07  L271-PRT-YY          PIC X(4)    VALUE SPACES.               
           05  FILLER                   PIC X(3)    VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE 'PAGE : '.            
           05  L271-PAGE-NO             PIC ZZ9.                                
                                                                                
       01  L271A-PR-HEAD-02.                                                    
           05  FILLER                   PIC X(37)   VALUE SPACES .              
           05  FILLER                   PIC X(49)   VALUE                       
               'SUMMARY REPORT OF LETTERS PRINTED FOR AMIS (COPY)'.             
                                                                                
       01  L271B-PR-HEAD-02.                                                    
           05  FILLER                   PIC X(37)   VALUE SPACES .              
           05  FILLER                   PIC X(49)   VALUE                       
               'SUMMARY REPORT OF LETTERS PRINTED WITH CORR ADDR'.              
                                                                                
       01  L271C-PR-HEAD-02.                                                    
           05  FILLER                   PIC X(37)   VALUE SPACES .              
           05  FILLER                   PIC X(47)   VALUE                       
               'SUMMARY REPORT OF LETTERS PRINTED W/O CORR ADDR'.               
                                                                                
       01  L271-PR-HEAD-03.                                                     
           05  FILLER                   PIC X(24)   VALUE                       
               'S/NO REGN NO   APPLICANT'.                                      
           05  FILLER                   PIC X(45)   VALUE SPACES.               
           05  FILLER                   PIC X(33)   VALUE                       
               'OLD RESIDENTIAL ADDRESS         '.                              
           05  FILLER                   PIC X(23)   VALUE                       
               'NEW RESIDENTIAL ADDRESS'.                                       
           05  FILLER                   PIC X(8)    VALUE SPACES.               
                                                                                
       01  L271B-PR-HEAD-03.                                                    
           05  FILLER                   PIC X(24)   VALUE                       
               'S/NO REGN NO   APPLICANT'.                                      
           05  FILLER                   PIC X(33)   VALUE SPACES.               
           05  FILLER                   PIC X(24)   VALUE                       
               'OLD RESIDENTIAL'.                                               
           05  FILLER                   PIC X(24)   VALUE                       
               'NEW RESIDENTIAL'.                                               
           05  FILLER                   PIC X(24)   VALUE                       
               'CORRESPONDENCE '.                                               
                                                                                
       01  L271B-PR-HEAD-04.                                                    
           05  FILLER                   PIC X(57)   VALUE SPACES.               
           05  FILLER                   PIC X(24)   VALUE                       
               'ADDRESS'.                                                       
           05  FILLER                   PIC X(24)   VALUE                       
               'ADDRESS'.                                                       
           05  FILLER                   PIC X(24)   VALUE                       
               'ADDRESS'.                                                       
                                                                                
      *----------------------------------------------------------------*        
      * DETAIL LINE FOR REPORT P13L271B                                *        
      *----------------------------------------------------------------*        
       01  L271B-PR-DETAILS.                                                    
           05  L271B-SNO                PIC ZZZ9.                               
           05  FILLER                   PIC X(1)    VALUE SPACES.               
           05  L271B-REGN               PIC X(8)    VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L271B-NAME1              PIC X(40)   VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L271B-OLD-RES-ADDR.                                              
               10  L271B-BLK-RES-O      PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X(1)    VALUE SPACES.               
               10  L271B-NUM-FLAT-O.                                            
                   15  L271B-CHAR-O     PIC X       VALUE SPACE.                
                   15  L271B-LEVEL-O    PIC X(2)    VALUE SPACES.               
                   15  L271B-DASH-O     PIC X       VALUE SPACE.                
                   15  L271B-HSE-MAIN-O PIC X(4)    VALUE SPACES.               
                   15  L271B-HSE-SUB-O  PIC X(3)    VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L271B-NEW-RES-ADDR.                                              
               10  L271B-BLK-RES-N      PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X(1)    VALUE SPACE.                
               10  L271B-NUM-FLAT-N.                                            
                   15  L271B-CHAR-N     PIC X       VALUE SPACE.                
                   15  L271B-LEVEL-N    PIC X(3)    VALUE SPACES.               
                   15  L271B-DASH-N     PIC X       VALUE SPACE.                
                   15  L271B-HSE-MAIN-N PIC X(5)    VALUE SPACES.               
           05  FILLER                   PIC X(3)    VALUE SPACES.               
           05  L271B-CORR-ADDR.                                                 
               10  L271B-BLK-CORR       PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X(1)    VALUE SPACE.                
               10  L271B-NUM-FLAT-CORR.                                         
                   15  L271B-CHAR-CORR     PIC X       VALUE SPACE.             
                   15  L271B-LEVEL-CORR    PIC X(3)    VALUE SPACES.            
                   15  L271B-DASH-CORR     PIC X       VALUE SPACE.             
                   15  L271B-HSE-MAIN-CORR PIC X(5)    VALUE SPACES.            
                                                                                
       01  L271B-RES-ADDR2.                                                     
           05  FILLER                   PIC X(15)   VALUE SPACES.               
           05  L271B-NAME2              PIC X(40)   VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L271B-NME-STREET-O       PIC X(20)   VALUE SPACES.               
           05  FILLER                   PIC X(4)    VALUE SPACES.               
           05  L271B-NME-STREET-N       PIC X(20)   VALUE SPACES.               
           05  FILLER                   PIC X(4)    VALUE SPACES.               
           05  L271B-NME-STREET-CORR    PIC X(32)   VALUE SPACES.               
                                                                                
       01  L271B-RES-ADDR3.                                                     
           05  FILLER                   PIC X(57)   VALUE SPACES.               
           05  L271B-NUM-POSTAL-O       PIC X(9)    VALUE SPACES.               
           05  FILLER                   PIC X(15)   VALUE SPACES.               
           05  L271B-NUM-POSTAL-N       PIC X(9)    VALUE SPACES.               
           05  FILLER                   PIC X(15)   VALUE SPACES.               
           05  L271B-NUM-POSTAL-CORR    PIC X(9)    VALUE SPACES.               
                                                                                
      *----------------------------------------------------------------*        
      * DETAIL LINE FOR REPORT P13L271A AND P13L271C.                  *        
      *----------------------------------------------------------------*        
       01  L271-PR-DETAILS.                                                     
           05  L271-SNO                PIC ZZZ9.                                
           05  FILLER                  PIC X(1)    VALUE SPACES.                
           05  L271-REGN               PIC X(8)    VALUE SPACES.                
           05  FILLER                  PIC X(2)    VALUE SPACES.                
           05  L271-NAME1              PIC X(52)   VALUE SPACES.                
           05  FILLER                  PIC X(2)    VALUE SPACES.                
           05  L271-OLD-RES-ADDR.                                               
               10  L271-BLK-RES-O      PIC X(10)   VALUE SPACES.                
               10  FILLER              PIC X(1)    VALUE SPACES.                
               10  L271-NUM-FLAT-O.                                             
                   15  L271-CHAR-O     PIC X       VALUE SPACE.                 
                   15  L271-LEVEL-O    PIC X(2)    VALUE SPACES.                
                   15  L271-DASH-O     PIC X       VALUE SPACE.                 
                   15  L271-HSE-MAIN-O PIC X(4)    VALUE SPACES.                
                   15  L271-HSE-SUB-O  PIC X(3)    VALUE SPACES.                
           05  FILLER                  PIC X(11)   VALUE SPACES.                
           05  L271-NEW-RES-ADDR.                                               
               10  L271-BLK-RES-N      PIC X(10)   VALUE SPACES.                
               10  FILLER              PIC X(1)    VALUE SPACE.                 
               10  L271-NUM-FLAT-N.                                             
                   15  L271-CHAR-N     PIC X       VALUE SPACE.                 
                   15  L271-LEVEL-N    PIC X(3)    VALUE SPACES.                
                   15  L271-DASH-N     PIC X       VALUE SPACE.                 
                   15  L271-HSE-MAIN-N PIC X(5)    VALUE SPACES.                
                                                                                
       01  L271-RES-ADDR2.                                                      
           05  FILLER                  PIC X(15)   VALUE SPACES.                
           05  L271-NAME2              PIC X(52)   VALUE SPACES.                
           05  FILLER                  PIC X(2)    VALUE SPACES.                
           05  L271-NME-STREET-O       PIC X(20)   VALUE SPACES.                
           05  FILLER                  PIC X(1)    VALUE SPACES.                
           05  L271-NUM-POSTAL-O       PIC X(9)    VALUE SPACES.                
           05  FILLER                  PIC X(3)    VALUE SPACES.                
           05  L271-NME-STREET-N       PIC X(20)   VALUE SPACES.                
           05  FILLER                  PIC X(1)    VALUE SPACES.                
           05  L271-NUM-POSTAL-N       PIC X(9)    VALUE SPACES.                
                                                                                
       01  L271-DRAW-LINE.                                                      
           05  LINE1                    PIC X(132)  VALUE ALL '-'.              
                                                                                
      *------------------------*                                                
      *  LINKAGE FOR AV02C015  *                                                
      *------------------------*                                                
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE         PIC X(6).                           
           05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                           
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN.                                                               
      *-------------------------------------------------------------            
                                                                                
           PERFORM 1000-OPEN-FILES        THRU  1000-EXIT.                      
                                                                                
           MOVE  FUNCTION CURRENT-DATE TO WS-DATE.                              
           MOVE  WS-DATE(7:2)             TO    WS-PRT-DD                       
                                                WS-DJDE-DD                      
                                                WS-DJDE-DD-H5.                  
           MOVE  WS-DATE(5:2)             TO    WS-PRT-MM                       
                                                WS-DJDE-MM                      
                                                WS-DJDE-MM-H5.                  
           MOVE  WS-DATE(1:4)             TO    WS-PRT-YY                       
                                                WS-DJDE-YY                      
                                                WS-DJDE-YY-H5.                  
                                                                                
           MOVE     1    TO WS-SNO-L271A                                        
                            WS-PG-CNT-L271A                                     
                            WS-SNO-L271B                                        
                            WS-PG-CNT-L271B                                     
                            WS-SNO-L271C                                        
                            WS-PG-CNT-L271C.                                    
                                                                                
           PERFORM 3000-READ-BP13F838        THRU 3000-EXIT.                    
           PERFORM 4000-PROCESS-BP13F838     THRU 4000-EXIT                     
             UNTIL EOF-BP13F838 = 'Y'.                                          
           PERFORM 9999-CLOSE-FILES THRU 9999-EXIT.                             
                                                                                
      *****************************************************************         
       1000-OPEN-FILES.                                                         
      *****************************************************************         
                                                                                
           OPEN INPUT  BP13F838                                                 
                       BP13K820                                                 
                       BP13K830                                                 
                OUTPUT P13P271A                                                 
                       P13P271B                                                 
                       P13P271C                                                 
                       P13P271D                                                 
                       P13P271E                                                 
                       P13L271A                                                 
                       P13L271B                                                 
                       P13L271C.                                                
                                                                                
           IF WS-K820-STATUS NOT = 0 AND 97                                     
              DISPLAY ' ERROR ENCOUNTERED IN OPENING FILE BP13K820 : '          
                                              WS-K820-STATUS                    
              MOVE WS-K820-STATUS TO RETURN-CODE.                               
                                                                                
           IF WS-K830-STATUS NOT = 0 AND 97                                     
              DISPLAY ' ERROR ENCOUNTERED IN OPENING FILE BP13K830 : '          
                                              WS-K830-STATUS                    
              MOVE WS-K830-STATUS TO RETURN-CODE.                               
                                                                                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       3000-READ-BP13F838.                                                      
      *****************************************************************         
                                                                                
           READ BP13F838                                                        
                AT END  MOVE  'Y' TO    EOF-BP13F838.                           
                                                                                
           IF EOF-BP13F838 NOT = 'Y'                                            
              ADD   1             TO    WS-F838-READ.                           
                                                                                
           MOVE SPACES            TO    WS-DETAIL-LINE                          
                                        WS-RES-ADDR2                            
                                        WS-RES-ADDR3.                           
           MOVE SPACES            TO    L271B-PR-DETAILS                        
                                        L271B-RES-ADDR2                         
                                        L271B-RES-ADDR3.                        
           MOVE SPACES            TO    L271-PR-DETAILS                         
                                        L271-RES-ADDR2.                         
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       4000-PROCESS-BP13F838.                                                   
      *****************************************************************         
                                                                                
           MOVE    SPACES         TO   WS-K820-FOUND.                           
           MOVE    SPACES         TO   WS-K830-FOUND.                           
                                                                                
           MOVE    SPACES         TO   K830-NUM-REGN.                           
           MOVE    F838-NUM-REGN  TO   K830-NUM-REGN.                           
           PERFORM 5000-READ-BP13K830-BY-REGN THRU 5000-EXIT.                   
                                                                                
           IF  WS-K830-FOUND = 'Y'                                              
               PERFORM 7000-MOVE-VALUES-TO-LETTER THRU 7000-EXIT                
               PERFORM 7100-PRINT-DJDE            THRU 7100-EXIT                
           END-IF.                                                              
                                                                                
           PERFORM  3000-READ-BP13F838         THRU 3000-EXIT.                  
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5000-READ-BP13K830-BY-REGN.                                              
      *****************************************************************         
                                                                                
           READ  BP13K830 KEY IS K830-NUM-REGN.                                 
                                                                                
           EVALUATE WS-K830-STATUS                                              
           WHEN  00                                                             
           WHEN  02                                                             
                 ADD     1   TO  WS-K830-READ                                   
                 MOVE   'Y'  TO  WS-K830-FOUND                                  
           WHEN  23                                                             
                 DISPLAY 'RECORD NOT FOUND BP13K830 : ' K830-NUM-REGN           
                 DISPLAY 'NRIC READ                 : ' F838-NUM-NRIC           
                 ADD     1   TO  WS-K830-NOTFND                                 
           WHEN  OTHER                                                          
                 DISPLAY 'READ ERROR BP13K830 : ' WS-K830-STATUS                
                 DISPLAY 'NRIC READ           : ' F838-NUM-NRIC                 
                 DISPLAY 'REGN READ           : ' K830-NUM-REGN                 
                 PERFORM  9999-CLOSE-FILES THRU 9999-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6000-READ-BP13K820.                                                      
      *****************************************************************         
                                                                                
           READ BP13K820.                                                       
                                                                                
           EVALUATE WS-K820-STATUS                                              
           WHEN 00                                                              
                ADD 1                TO   WS-K820-READ                          
                MOVE 'Y'             TO   WS-K820-FOUND                         
           WHEN 23                                                              
                DISPLAY 'RECORD NOT FOUND BP13K820 : '                          
                                K820-NUM-NRIC                                   
                MOVE 'N'             TO   WS-K820-FOUND                         
           WHEN OTHER                                                           
                DISPLAY 'READ ERROR BP13K820   : '                              
                                WS-K820-STATUS                                  
                DISPLAY 'NRIC                  : ' K820-NUM-NRIC                
                PERFORM  9999-CLOSE-FILES THRU 9999-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       6600-CALL-AV02C015.                                                      
      *****************************************************************         
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       6600-EXIT.                                                               
           EXIT.                                                                
      *****************************************************************         
       7000-MOVE-VALUES-TO-LETTER.                                              
      *****************************************************************         
                                                                                
           MOVE F838-NUM-REGN      TO  WS-DJDE-REGN                             
                                       WS-REGN.                                 
           MOVE F838-NUM-NT-ZONE   TO  WS-DJDE-NT-ZONE.                         
           MOVE F838-NUM-FLAT-TYPE TO  WS-DJDE-FLAT-TYPE.                       
           MOVE '/'                TO  WS-DJDE-HDBREF-SLASH.                    
                                                                                
           IF F838-NUM-NRIC  NOT = SPACES AND LOW-VALUES                        
              MOVE F838-NUM-NRIC       TO WS-DJDE-NRIC1                         
              MOVE SPACES              TO WS-K820-FOUND                         
              MOVE SPACES              TO K820-KEY-FLD                          
              MOVE F838-NUM-REGN       TO K820-NUM-REGN                         
              MOVE WS-DJDE-NRIC1       TO K820-NUM-NRIC                         
              PERFORM 6000-READ-BP13K820 THRU 6000-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 MOVE  K820-NME-OCCP  TO   WS-DJDE-NAME1                        
                                           WS-NAME1                             
              ELSE                                                              
                 MOVE  SPACES         TO   WS-DJDE-NAME1                        
                                           WS-NAME1                             
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC1                         
              MOVE SPACES              TO WS-DJDE-NAME1                         
                                          WS-NAME1                              
           END-IF.                                                              
                                                                                
           IF (F838-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                  
              (F838-NUM-NRIC2 (1:1) NOT = '#')                                  
              MOVE F838-NUM-NRIC2      TO WS-DJDE-NRIC2                         
              MOVE SPACES              TO WS-K820-FOUND                         
              MOVE SPACES              TO K820-KEY-FLD                          
              MOVE F838-NUM-REGN       TO K820-NUM-REGN                         
              MOVE WS-DJDE-NRIC2       TO K820-NUM-NRIC                         
              PERFORM 6000-READ-BP13K820 THRU 6000-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 MOVE  K820-NME-OCCP  TO   WS-DJDE-NAME2                        
                                           WS-NAME2                             
              ELSE                                                              
                 MOVE  SPACES         TO   WS-DJDE-NAME2                        
                                           WS-NAME2                             
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC2                         
              MOVE SPACES              TO WS-DJDE-NAME2                         
                                          WS-NAME2                              
           END-IF.                                                              
                                                                                
           IF (F838-NUM-NRIC3 NOT = SPACES AND LOW-VALUES) AND                  
              (F838-NUM-NRIC3 (1:1) NOT = '#')                                  
              MOVE F838-NUM-NRIC3      TO WS-DJDE-NRIC3                         
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC3                         
           END-IF.                                                              
                                                                                
           IF (F838-NUM-NRIC4 NOT = SPACES AND LOW-VALUES) AND                  
              (F838-NUM-NRIC4 (1:1) NOT = '#')                                  
              MOVE F838-NUM-NRIC4      TO WS-DJDE-NRIC4                         
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC4                         
           END-IF.                                                              
                                                                                
      *-----------------------------------------------                          
      * ADDRESS FOR LETTER                                                      
      *-----------------------------------------------                          
                                                                                
           IF (K830-NUM-MAIL-ADDR  = SPACES OR LOW-VALUES) OR                   
              ((K830-NUM-MAIL-LVL-CHAR = '#') AND                               
               (K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES))                  
               IF F838-NUM-OLD-ADDR-TYPE  = 'H'                                 
                  MOVE F838-NUM-OLD-BLK         TO WS-DJDE-BLK-NO               
                  MOVE F838-NME-OLD-STREET      TO WS-DJDE-STREET-NAME          
                  MOVE F838-NUM-OLD-LVL-CHAR    TO WS-DJDE-CHAR                 
                  MOVE F838-NUM-OLD-LVL-NUM     TO WS-DJDE-LEVEL                
                  MOVE F838-NUM-OLD-LVL-DASH    TO WS-DJDE-DASH                 
                  MOVE F838-NUM-OLD-HSEMAIN     TO WS-DJDE-HSE-MAIN             
                  MOVE F838-NUM-OLD-HSESUB      TO WS-DJDE-HSE-SUB              
               ELSE                                                             
                  MOVE F838-NUM-OLD-BLK         TO WS-DJDE-BLK-NO               
                  MOVE F838-NUM-OLD-FLAT        TO WS-DJDE-NUM-FLAT             
                  MOVE F838-NME-OLD-STREET-BLDG TO WS-DJDE-STREET-NAME          
               END-IF                                                           
                                                                                
                                                                                
               IF F838-NUM-OLD-POSTAL = SPACES                                  
                  MOVE  SPACES TO WS-DJDE-CODE                                  
               ELSE                                                             
                  STRING 'SINGAPORE '   F838-NUM-OLD-POSTAL                     
                          DELIMITED BY SIZE  INTO WS-DJDE-CODE                  
                  END-STRING                                                    
               END-IF                                                           
                                                                                
      * TO GET THE BAR CODE                                                     
                                                                                
                  MOVE SPACES                      TO WS-LINK-AV02C015          
                  MOVE F838-NUM-OLD-POSTAL TO AV02C015-IN-POSTCODE              
                  PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT              
                  MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-DJDE-BARCODE          
                                                                                
           ELSE                                                                 
               IF K830-NUM-MAIL-ADDR-TYPE =  'H'                                
                  MOVE K830-NUM-MAIL-BLK      TO WS-DJDE-BLK-NO                 
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-DJDE-STREET-NAME            
                  MOVE K830-NUM-MAIL-LVL-CHAR TO WS-DJDE-CHAR                   
                  MOVE K830-NUM-MAIL-LVL-NUM  TO WS-DJDE-LEVEL                  
                  MOVE K830-NUM-MAIL-LVL-DASH TO WS-DJDE-DASH                   
                  MOVE K830-NUM-MAIL-HSEMAIN  TO WS-DJDE-HSE-MAIN               
                  MOVE K830-NUM-MAIL-HSESUB   TO WS-DJDE-HSE-SUB                
               ELSE                                                             
                  MOVE K830-NUM-MAIL-BLK      TO WS-DJDE-BLK-NO                 
                  MOVE K830-NUM-MAIL-FLAT     TO WS-DJDE-NUM-FLAT               
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-DJDE-STREET-NAME            
               END-IF                                                           
               IF K830-NUM-MAIL-POSTAL = SPACES                                 
                  MOVE  SPACES TO WS-DJDE-CODE                                  
               ELSE                                                             
                  STRING 'SINGAPORE '   K830-NUM-MAIL-POSTAL                    
                          DELIMITED BY SIZE  INTO WS-DJDE-CODE                  
                  END-STRING                                                    
               END-IF                                                           
                                                                                
      * TO GET THE BAR CODE                                                     
                                                                                
                  MOVE SPACES                      TO WS-LINK-AV02C015          
                  MOVE K830-NUM-MAIL-POSTAL TO AV02C015-IN-POSTCODE             
                  PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT              
                  MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-DJDE-BARCODE          
           END-IF.                                                              
                                                                                
      *-----------------------------------------------                          
      * NEW ADDRESS FOR LETTER                                                  
      *-----------------------------------------------                          
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING 'BLK ' F838-NUM-NEW-BLK                                   
                       DELIMITED BY SIZE  INTO  WS-DJDE-NEW-NUM-BLK             
           ELSE                                                                 
               MOVE  F838-NUM-NEW-BLK       TO  WS-DJDE-NEW-NUM-BLK             
           END-IF.                                                              
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING '#'  F838-NUM-NEW-HSELVL                                  
                      '-'  F838-NUM-NEW-HSEUNIT                                 
                      '  ' DELIMITED BY SIZE  INTO WS-DJDE-NEW-FLAT             
           ELSE                                                                 
              IF F838-NUM-NEW-HSELVL = SPACES OR LOW-VALUES                     
                 STRING F838-NUM-NEW-HSELVL                                     
                        F838-NUM-NEW-HSEUNIT                                    
                        '   ' DELIMITED BY SIZE  INTO WS-DJDE-NEW-FLAT          
              ELSE                                                              
                 STRING F838-NUM-NEW-HSELVL                                     
                        '-' F838-NUM-NEW-HSEUNIT                                
                        '  ' DELIMITED BY SIZE  INTO WS-DJDE-NEW-FLAT           
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  F838-NME-NEW-STREET-TXT1 TO  WS-DJDE-NEW-STREET-NME.           
                                                                                
           IF F838-NUM-NEW-POSTAL = SPACES                                      
              MOVE  SPACES TO WS-DJDE-NEW-POSTAL-CDE                            
           ELSE                                                                 
              STRING 'SINGAPORE '   F838-NUM-NEW-POSTAL                         
                      DELIMITED BY SIZE  INTO WS-DJDE-NEW-POSTAL-CDE            
              END-STRING                                                        
                                                                                
      * TO GET THE BAR CODE                                                     
                                                                                
             MOVE SPACES                      TO WS-LINK-AV02C015               
             MOVE F838-NUM-NEW-POSTAL TO AV02C015-IN-POSTCODE                   
             PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT                   
             MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-DJDE-NEW-BARCODE           
                                                                                
           END-IF.                                                              
      *-----------------------------------------------                          
      * OLD ADDRESS FOR REPORT                                                  
      *-----------------------------------------------                          
                                                                                
           IF F838-NUM-OLD-ADDR-TYPE  = 'H'                                     
              MOVE F838-NUM-OLD-BLK         TO WS-BLK-RES-O                     
              MOVE F838-NME-OLD-STREET      TO WS-NME-STREET-O                  
              MOVE F838-NUM-OLD-LVL-CHAR    TO WS-CHAR-O                        
              MOVE F838-NUM-OLD-LVL-NUM     TO WS-LEVEL-O                       
              MOVE F838-NUM-OLD-LVL-DASH    TO WS-DASH-O                        
              MOVE F838-NUM-OLD-HSEMAIN     TO WS-HSE-MAIN-O                    
              MOVE F838-NUM-OLD-HSESUB      TO WS-HSE-SUB-O                     
           ELSE                                                                 
              MOVE F838-NUM-OLD-BLK         TO WS-BLK-RES-O                     
              MOVE F838-NUM-OLD-FLAT        TO WS-NUM-FLAT-O                    
              MOVE F838-NME-OLD-STREET-BLDG TO WS-NME-STREET-O                  
           END-IF.                                                              
                                                                                
           IF F838-NUM-OLD-POSTAL = SPACES                                      
              MOVE  SPACES TO WS-NUM-POSTAL-O                                   
           ELSE                                                                 
              STRING 'S('   F838-NUM-OLD-POSTAL                                 
                      ')'                                                       
                      DELIMITED BY SIZE  INTO WS-NUM-POSTAL-O                   
              END-STRING                                                        
           END-IF.                                                              
                                                                                
      *-----------------------------------------------                          
      * NEW ADDRESS FOR REPORT                                                  
      *-----------------------------------------------                          
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING 'BLK ' F838-NUM-NEW-BLK                                   
                       DELIMITED BY SIZE  INTO  WS-BLK-RES-N                    
           ELSE                                                                 
               MOVE  F838-NUM-NEW-BLK       TO  WS-BLK-RES-N                    
           END-IF.                                                              
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING '#'  F838-NUM-NEW-HSELVL                                  
                      '-'  F838-NUM-NEW-HSEUNIT                                 
                      '  ' DELIMITED BY SIZE  INTO WS-NUM-FLAT-N                
           ELSE                                                                 
              IF F838-NUM-NEW-HSELVL = SPACES OR LOW-VALUES                     
                 STRING F838-NUM-NEW-HSELVL                                     
                        F838-NUM-NEW-HSEUNIT                                    
                        '   ' DELIMITED BY SIZE  INTO WS-NUM-FLAT-N             
              ELSE                                                              
                 STRING F838-NUM-NEW-HSELVL                                     
                        '-' F838-NUM-NEW-HSEUNIT                                
                        '  ' DELIMITED BY SIZE  INTO WS-NUM-FLAT-N              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  F838-NME-NEW-STREET-TXT1 TO  WS-NME-STREET-N.                  
                                                                                
           IF F838-NUM-NEW-POSTAL = SPACES                                      
              MOVE  SPACES TO WS-NUM-POSTAL-N                                   
           ELSE                                                                 
              STRING 'S('   F838-NUM-NEW-POSTAL                                 
                      ')'                                                       
                      DELIMITED BY SIZE  INTO WS-NUM-POSTAL-N                   
              END-STRING                                                        
           END-IF.                                                              
                                                                                
      *-----------------------------------------------                          
      * CORRESPONDENCE ADDRESS FOR REPORT                                       
      *-----------------------------------------------                          
                                                                                
           IF (K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES) OR                    
              ((K830-NUM-MAIL-LVL-CHAR = '#') AND                               
               (K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES))                  
                NEXT SENTENCE                                                   
           ELSE                                                                 
               IF K830-NUM-MAIL-ADDR-TYPE =  'H'                                
                  MOVE K830-NUM-MAIL-BLK      TO WS-BLK-CORR                    
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-NME-STREET-CORR             
                  MOVE K830-NUM-MAIL-LVL-CHAR TO WS-CHAR-CORR                   
                  MOVE K830-NUM-MAIL-LVL-NUM  TO WS-LEVEL-CORR                  
                  MOVE K830-NUM-MAIL-LVL-DASH TO WS-DASH-CORR                   
                  MOVE K830-NUM-MAIL-HSEMAIN  TO WS-HSE-MAIN-CORR               
                  MOVE K830-NUM-MAIL-HSESUB   TO WS-HSE-SUB-CORR                
               ELSE                                                             
                  MOVE K830-NUM-MAIL-BLK      TO WS-BLK-CORR                    
                  MOVE K830-NUM-MAIL-FLAT     TO WS-NUM-FLAT-CORR               
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-NME-STREET-CORR             
               END-IF                                                           
               IF K830-NUM-MAIL-POSTAL = SPACES                                 
                  MOVE  SPACES TO WS-NUM-POSTAL-CORR                            
               ELSE                                                             
                  STRING 'S('   K830-NUM-MAIL-POSTAL                            
                          ')'                                                   
                          DELIMITED BY SIZE  INTO WS-NUM-POSTAL-CORR            
                  END-STRING                                                    
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    IF  WS-DJDE-NAME1 = SPACES                                           
               MOVE SPACES           TO WS-DJDE-NAME1-LABEL.                    
      *    ELSE                                                                 
      *        MOVE ' (APPLICANT 1)' TO WS-DJDE-NAME1-LABEL.                    
                                                                                
      *    IF  WS-DJDE-NAME2 = SPACES                                           
               MOVE SPACES           TO WS-DJDE-NAME2-LABEL.                    
      *    ELSE                                                                 
      *        MOVE ' (APPLICANT 2)' TO WS-DJDE-NAME2-LABEL.                    
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7100-PRINT-DJDE.                                                         
      *****************************************************************         
                                                                                
           IF  F838-NUM-PRINTED = 'Y'                                           
      *        PERFORM 7110-PRINT-DJDE-AMIS-COPY  THRU 7110-EXIT                
               PERFORM 7510-WRITE-P13L271A        THRU 7510-EXIT.               
                                                                                
           IF  F838-NUM-AMIS = '2'                                              
               PERFORM 7120-PRINT-DJDE-BP13H2      THRU 7120-EXIT               
      *        PERFORM 7130-PRINT-DJDE-BP13H2-COPY THRU 7130-EXIT               
               PERFORM 7520-WRITE-P13L271B         THRU 7520-EXIT.              
                                                                                
           IF  F838-NUM-AMIS = '1'                                              
               PERFORM 7140-PRINT-DJDE-BP13H1      THRU 7140-EXIT               
      *        PERFORM 7150-PRINT-DJDE-BP13H1-COPY THRU 7150-EXIT               
               PERFORM 7530-WRITE-P13L271C         THRU 7530-EXIT.              
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7110-PRINT-DJDE-AMIS-COPY.                                               
      *****************************************************************         
                                                                                
      *    MOVE  'C O P Y'     TO    WS-DJDE-COPY                               
           IF WS-P271A-WRITTEN NOT = ZEROES                                     
              WRITE P13P271A-REC  FROM  WS-DJDE-BP13H1                          
           END-IF.                                                              
           MOVE  SPACES        TO    P13P271A-REC.                              
           WRITE P13P271A-REC  AFTER PAGE.                                      
           WRITE P13P271A-REC  FROM  WS-DJDE-HDBREF          AFTER 1            
           WRITE P13P271A-REC  FROM  WS-BP13H-DTE            AFTER 1            
           WRITE P13P271A-REC  FROM  WS-BP13H-NAME1          AFTER 5            
           WRITE P13P271A-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P271A-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 1            
           WRITE P13P271A-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271A-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
           WRITE P13P271A-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 18           
           WRITE P13P271A-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271A-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
      *    WRITE P13P271A-REC  FROM  WS-DJDE-INFO            AFTER PAGE.        
           MOVE  SPACES        TO    P13P271A-REC.                              
      *    WRITE P13P271A-REC        AFTER PAGE.                                
      *    WRITE P13P271A-REC        AFTER 5.                                   
                                                                                
           ADD   1 TO WS-P271A-WRITTEN.                                         
                                                                                
       7110-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7120-PRINT-DJDE-BP13H2.                                                  
      *****************************************************************         
                                                                                
      *  SEND TO MAILING ADDRESS                                                
                                                                                
      *    MOVE  SPACES        TO    WS-DJDE-COPY                               
           MOVE  SPACES        TO    P13P271B-REC                               
           WRITE P13P271B-REC  FROM  WS-DJDE-BP13H2          AFTER PAGE         
      *    WRITE P13P271B-REC                                AFTER PAGE         
      *    WRITE P13P271B-REC  FROM  WS-DJDE-HDBREF          AFTER 1            
      *    WRITE P13P271B-REC  FROM  WS-BP13H-DTE            AFTER 1            
           WRITE P13P271B-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P271B-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 2            
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
      *    WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-D       AFTER 2            
           WRITE P13P271B-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P271B-REC  FROM  WS-DJDE-HDBREF          AFTER 2            
                                                                                
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 16           
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           MOVE  SPACES        TO    P13P271B-REC                               
      *    WRITE P13P271B-REC  AFTER PAGE                                       
      *    WRITE P13P271B-REC  AFTER 5.                                         
                                                                                
      *  SEND TO NEW ADDRESS                                                    
                                                                                
           WRITE P13P271B-REC  FROM  WS-DJDE-BP13H2          AFTER PAGE         
           WRITE P13P271B-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P271B-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P271B-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 2            
           WRITE P13P271B-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271B-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
           WRITE P13P271B-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P271B-REC  FROM  WS-DJDE-HDBREF          AFTER 2            
                                                                                
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 16           
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P271B-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           MOVE  SPACES        TO    P13P271B-REC.                              
                                                                                
           ADD   1 TO WS-P271B-WRITTEN.                                         
                                                                                
       7120-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7130-PRINT-DJDE-BP13H2-COPY.                                             
      *****************************************************************         
                                                                                
      *  SEND COPY TO MAILING ADDR.                                             
                                                                                
      *    MOVE  'C O P Y'     TO    WS-DJDE-COPY                               
           MOVE  SPACES        TO    P13P271C-REC.                              
           WRITE P13P271C-REC                                AFTER PAGE         
           WRITE P13P271C-REC  FROM  WS-DJDE-HDBREF          AFTER 1            
           WRITE P13P271C-REC  FROM  WS-BP13H-DTE            AFTER 1            
           WRITE P13P271C-REC  FROM  WS-BP13H-NAME1          AFTER 5            
           WRITE P13P271C-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 2            
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
                                                                                
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 17           
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           MOVE  SPACES        TO    P13P271C-REC                               
           WRITE P13P271C-REC  AFTER PAGE                                       
           WRITE P13P271C-REC  AFTER 5.                                         
                                                                                
      *  PRINT RESPONSE SLIP HERE (NEXT PAGE)                                   
                                                                                
           MOVE  SPACES        TO    P13P271C-REC.                              
           WRITE P13P271C-REC  FROM  WS-DJDE-HDBREF          AFTER PAGE         
      *    WRITE P13P271C-REC  FROM  WS-BP13H-NAME1          AFTER 7            
      *    WRITE P13P271C-REC  FROM  WS-BP13H-NAME2          AFTER 1            
      *    WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 2            
      *    WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
      *    WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-UNIT             AFTER 7            
           WRITE P13P271C-REC  FROM  WS-HDB-NAME             AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-CENTER           AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-ADDR1            AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-POSTAL           AFTER 1            
                                                                                
           WRITE P13P271C-REC  FROM  WS-BP13H5-DTE           AFTER 10           
           WRITE P13P271C-REC  FROM  WS-NEW-ADDRESS          AFTER 8            
           WRITE P13P271C-REC  FROM  WS-DJDE-NRIC            AFTER 11           
           MOVE  SPACES        TO    P13P271C-REC                               
           WRITE P13P271C-REC  AFTER PAGE                                       
           WRITE P13P271C-REC  AFTER 5.                                         
                                                                                
      *  SEND COPY TO NEW ADDRESS                                               
                                                                                
           MOVE  SPACES        TO    P13P271C-REC.                              
           WRITE P13P271C-REC                                AFTER PAGE         
           WRITE P13P271C-REC  FROM  WS-DJDE-HDBREF          AFTER 1            
           WRITE P13P271C-REC  FROM  WS-BP13H-DTE            AFTER 1            
           WRITE P13P271C-REC  FROM  WS-BP13H-NAME1          AFTER 5            
           WRITE P13P271C-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P271C-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 2            
           WRITE P13P271C-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271C-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
                                                                                
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 17           
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P271C-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           MOVE  SPACES        TO    P13P271C-REC                               
           WRITE P13P271C-REC  AFTER PAGE                                       
           WRITE P13P271C-REC  AFTER 5.                                         
                                                                                
      *  PRINT RESPONSE SLIP HERE (NEXT PAGE)                                   
                                                                                
           MOVE  SPACES        TO    P13P271C-REC.                              
           WRITE P13P271C-REC  FROM  WS-DJDE-HDBREF          AFTER PAGE         
      *    WRITE P13P271C-REC  FROM  WS-BP13H-NAME1          AFTER 7            
      *    WRITE P13P271C-REC  FROM  WS-BP13H-NAME2          AFTER 1            
      *    WRITE P13P271C-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 2            
      *    WRITE P13P271C-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
      *    WRITE P13P271C-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-UNIT             AFTER 7            
           WRITE P13P271C-REC  FROM  WS-HDB-NAME             AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-CENTER           AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-ADDR1            AFTER 1            
           WRITE P13P271C-REC  FROM  WS-HDB-POSTAL           AFTER 1            
           WRITE P13P271C-REC  FROM  WS-BP13H5-DTE           AFTER 10           
           WRITE P13P271C-REC  FROM  WS-NEW-ADDRESS          AFTER 8            
           WRITE P13P271C-REC  FROM  WS-DJDE-NRIC            AFTER 11           
           MOVE  SPACES        TO    P13P271C-REC                               
           WRITE P13P271C-REC  AFTER PAGE.                                      
           WRITE P13P271C-REC  AFTER 5.                                         
                                                                                
           ADD   1 TO WS-P271C-WRITTEN.                                         
                                                                                
       7130-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7140-PRINT-DJDE-BP13H1.                                                  
      *****************************************************************         
                                                                                
      *    MOVE  SPACES        TO    WS-DJDE-COPY                               
      *    IF WS-P271D-WRITTEN NOT = ZEROES                                     
           WRITE P13P271D-REC  FROM  WS-DJDE-BP13H1          AFTER PAGE         
      *    END-IF.                                                              
      *    MOVE  SPACES        TO    P13P271D-REC.                              
      *    WRITE P13P271D-REC  AFTER PAGE.                                      
      *    WRITE P13P271D-REC  FROM  WS-DJDE-HDBREF          AFTER 1            
      *    WRITE P13P271D-REC  FROM  WS-BP13H-DTE            AFTER 1            
           WRITE P13P271D-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P271D-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P271D-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 2            
           WRITE P13P271D-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271D-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
      *    WRITE P13P271D-REC  FROM  WS-BP13H-NEW-ADDR-INFO4 AFTER 2            
           WRITE P13P271D-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P271D-REC  FROM  WS-DJDE-HDBREF          AFTER 2            
           WRITE P13P271D-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 15           
           WRITE P13P271D-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271D-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
      *    WRITE P13P271D-REC  FROM  WS-DJDE-INFO            AFTER PAGE         
           MOVE  SPACES        TO    P13P271D-REC.                              
      *    WRITE P13P271D-REC        AFTER PAGE.                                
      *    WRITE P13P271D-REC        AFTER 5.                                   
           WRITE P13P271D-REC  FROM  WS-DJDE-BLANKF AFTER PAGE.                 
           WRITE P13P271D-REC AFTER 5.                                          
                                                                                
           ADD   1 TO WS-P271D-WRITTEN.                                         
                                                                                
       7140-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7150-PRINT-DJDE-BP13H1-COPY.                                             
      *****************************************************************         
                                                                                
      *    MOVE  'C O P Y'     TO    WS-DJDE-COPY                               
           IF WS-P271E-WRITTEN NOT = ZEROES                                     
              WRITE P13P271E-REC  FROM  WS-DJDE-BP13H1                          
           END-IF.                                                              
           MOVE  SPACES        TO    P13P271E-REC.                              
           WRITE P13P271E-REC  AFTER PAGE.                                      
           WRITE P13P271E-REC  FROM  WS-DJDE-HDBREF          AFTER 1            
           WRITE P13P271E-REC  FROM  WS-BP13H-DTE            AFTER 1            
           WRITE P13P271E-REC  FROM  WS-BP13H-NAME1          AFTER 5            
           WRITE P13P271E-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P271E-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 1            
           WRITE P13P271E-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271E-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
           WRITE P13P271E-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 18           
           WRITE P13P271E-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P271E-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
      *    WRITE P13P271E-REC  FROM  WS-DJDE-INFO.                              
           MOVE  SPACES        TO    P13P271E-REC.                              
      *    WRITE P13P271E-REC        AFTER PAGE.                                
      *    WRITE P13P271E-REC        AFTER 5.                                   
                                                                                
           ADD   1 TO WS-P271E-WRITTEN.                                         
                                                                                
       7150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7510-WRITE-P13L271A.                                                     
      *****************************************************************         
                                                                                
            IF  WS-COUNT-L271A = 0 OR WS-COUNT-L271A > 50                       
                MOVE  ZERO              TO   WS-COUNT-L271A                     
                MOVE  WS-PG-CNT-L271A   TO   L271-PAGE-NO                       
                MOVE  'P13L271A'        TO   L271-HEADER                        
                MOVE  WS-PRT-DD         TO   L271-PRT-DD                        
                MOVE  WS-PRT-MM         TO   L271-PRT-MM                        
                MOVE  WS-PRT-YY         TO   L271-PRT-YY                        
                WRITE P13L271A-REC      FROM L271-PR-HEAD-01 AFTER PAGE         
                WRITE P13L271A-REC      FROM L271A-PR-HEAD-02 AFTER 1           
                WRITE P13L271A-REC      FROM L271-PR-HEAD-03 AFTER 2            
                WRITE P13L271A-REC      FROM L271-DRAW-LINE  AFTER 1            
                ADD   5                 TO   WS-COUNT-L271A                     
                ADD   1                 TO   WS-PG-CNT-L271A.                   
                                                                                
            MOVE  WS-SNO-L271A       TO    L271-SNO.                            
            MOVE  WS-REGN            TO    L271-REGN.                           
            MOVE  WS-NAME1           TO    L271-NAME1.                          
            MOVE  WS-OLD-RES-ADDR    TO    L271-OLD-RES-ADDR.                   
            MOVE  WS-NEW-RES-ADDR    TO    L271-NEW-RES-ADDR.                   
            WRITE P13L271A-REC       FROM  L271-PR-DETAILS   AFTER 2.           
            MOVE  WS-NAME2           TO    L271-NAME2.                          
            MOVE  WS-NME-STREET-O    TO    L271-NME-STREET-O.                   
            MOVE  WS-NUM-POSTAL-O    TO    L271-NUM-POSTAL-O.                   
            MOVE  WS-NME-STREET-N    TO    L271-NME-STREET-N.                   
            MOVE  WS-NUM-POSTAL-N    TO    L271-NUM-POSTAL-N.                   
            WRITE P13L271A-REC       FROM  L271-RES-ADDR2    AFTER 1.           
                                                                                
            ADD   3             TO    WS-COUNT-L271A.                           
            ADD   1             TO    WS-L271A-WRITTEN.                         
            ADD   1             TO    WS-SNO-L271A.                             
                                                                                
       7510-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7520-WRITE-P13L271B.                                                     
      *****************************************************************         
                                                                                
            IF  WS-COUNT-L271B = 0 OR WS-COUNT-L271B > 50                       
                MOVE  ZERO            TO    WS-COUNT-L271B                      
                MOVE  WS-PG-CNT-L271B TO    L271-PAGE-NO                        
                MOVE  'P13L271B'      TO    L271-HEADER                         
                MOVE  WS-PRT-DD       TO    L271-PRT-DD                         
                MOVE  WS-PRT-MM       TO    L271-PRT-MM                         
                MOVE  WS-PRT-YY       TO    L271-PRT-YY                         
                WRITE P13L271B-REC    FROM  L271-PR-HEAD-01 AFTER PAGE          
                WRITE P13L271B-REC    FROM  L271B-PR-HEAD-02 AFTER 1            
                WRITE P13L271B-REC    FROM  L271B-PR-HEAD-03 AFTER 2            
                WRITE P13L271B-REC    FROM  L271B-PR-HEAD-04 AFTER 1            
                WRITE P13L271B-REC    FROM  L271-DRAW-LINE  AFTER 1             
                ADD   6               TO    WS-COUNT-L271B                      
                ADD   1               TO    WS-PG-CNT-L271B.                    
                                                                                
            MOVE  WS-SNO-L271B       TO    L271B-SNO.                           
            MOVE  WS-REGN            TO    L271B-REGN.                          
            MOVE  WS-NAME1           TO    L271B-NAME1.                         
            MOVE  WS-OLD-RES-ADDR    TO    L271B-OLD-RES-ADDR.                  
            MOVE  WS-NEW-RES-ADDR    TO    L271B-NEW-RES-ADDR.                  
            MOVE  WS-CORR-ADDR       TO    L271B-CORR-ADDR.                     
            WRITE P13L271B-REC       FROM  L271B-PR-DETAILS   AFTER 2.          
            MOVE  WS-NAME2           TO    L271B-NAME2.                         
            MOVE  WS-NME-STREET-O    TO    L271B-NME-STREET-O.                  
            MOVE  WS-NME-STREET-N    TO    L271B-NME-STREET-N.                  
            MOVE  WS-NME-STREET-CORR TO    L271B-NME-STREET-CORR.               
            WRITE P13L271B-REC       FROM  L271B-RES-ADDR2    AFTER 1.          
            MOVE  WS-NUM-POSTAL-O    TO    L271B-NUM-POSTAL-O.                  
            MOVE  WS-NUM-POSTAL-N    TO    L271B-NUM-POSTAL-N.                  
            MOVE  WS-NUM-POSTAL-CORR TO    L271B-NUM-POSTAL-CORR.               
            WRITE P13L271B-REC       FROM  L271B-RES-ADDR3    AFTER 1.          
                                                                                
            ADD   4             TO           WS-COUNT-L271B.                    
            ADD   1             TO           WS-L271B-WRITTEN.                  
            ADD   1             TO           WS-SNO-L271B.                      
                                                                                
       7520-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7530-WRITE-P13L271C.                                                     
      *****************************************************************         
                                                                                
            IF  WS-COUNT-L271C = 0 OR WS-COUNT-L271C > 50                       
                MOVE  ZERO            TO    WS-COUNT-L271C                      
                MOVE  WS-PG-CNT-L271C TO    L271-PAGE-NO                        
                MOVE  'P13L271C'      TO    L271-HEADER                         
                MOVE  WS-PRT-DD       TO    L271-PRT-DD                         
                MOVE  WS-PRT-MM       TO    L271-PRT-MM                         
                MOVE  WS-PRT-YY       TO    L271-PRT-YY                         
                WRITE P13L271C-REC    FROM  L271-PR-HEAD-01 AFTER PAGE          
                WRITE P13L271C-REC    FROM  L271C-PR-HEAD-02 AFTER 1            
                WRITE P13L271C-REC    FROM  L271-PR-HEAD-03 AFTER 2             
                WRITE P13L271C-REC    FROM  L271-DRAW-LINE  AFTER 1             
                ADD   5               TO    WS-COUNT-L271C                      
                ADD   1               TO    WS-PG-CNT-L271C.                    
                                                                                
            MOVE  WS-SNO-L271C       TO    L271-SNO.                            
            MOVE  WS-REGN            TO    L271-REGN.                           
            MOVE  WS-NAME1           TO    L271-NAME1.                          
            MOVE  WS-OLD-RES-ADDR    TO    L271-OLD-RES-ADDR.                   
            MOVE  WS-NEW-RES-ADDR    TO    L271-NEW-RES-ADDR.                   
            WRITE P13L271C-REC       FROM  L271-PR-DETAILS   AFTER 2.           
            MOVE  WS-NAME2           TO    L271-NAME2.                          
            MOVE  WS-NME-STREET-O    TO    L271-NME-STREET-O.                   
            MOVE  WS-NUM-POSTAL-O    TO    L271-NUM-POSTAL-O.                   
            MOVE  WS-NME-STREET-N    TO    L271-NME-STREET-N.                   
            MOVE  WS-NUM-POSTAL-N    TO    L271-NUM-POSTAL-N.                   
            WRITE P13L271C-REC       FROM  L271-RES-ADDR2    AFTER 1.           
                                                                                
            ADD   3             TO           WS-COUNT-L271C.                    
            ADD   1             TO           WS-L271C-WRITTEN.                  
            ADD   1             TO           WS-SNO-L271C.                      
                                                                                
       7530-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       9999-CLOSE-FILES.                                                        
      *****************************************************************         
                                                                                
           CLOSE BP13F838                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 P13P271A                                                       
                 P13P271B                                                       
                 P13P271C                                                       
                 P13P271D                                                       
                 P13P271E                                                       
                 P13L271A                                                       
                 P13L271B.                                                      
                                                                                
           IF WS-K820-STATUS NOT = 0                                            
              DISPLAY ' ERROR ENCOUNTERED IN CLOSING FILE  BP13K820 : '         
                                              WS-K820-STATUS                    
              MOVE WS-K820-STATUS TO RETURN-CODE.                               
                                                                                
           IF WS-K830-STATUS NOT = 0                                            
              DISPLAY ' ERROR ENCOUNTERED IN CLOSING FILE  BP13K830 : '         
                                              WS-K830-STATUS                    
              MOVE WS-K830-STATUS TO RETURN-CODE.                               
                                                                                
                                                                                
           DISPLAY '----------------------------------------'.                  
           DISPLAY '               BP13C271                 '.                  
           DISPLAY '----------------------------------------'.                  
                                                                                
           DISPLAY ' NO OF BP13F838 RECS READ     : ' WS-F838-READ.             
           DISPLAY ' NO OF BP13K820 RECS READ     : ' WS-K820-READ.             
           DISPLAY ' NO OF BP13K830 RECS READ     : ' WS-K830-READ.             
           DISPLAY ' NO OF BP13K830 RECS NOTFND   : ' WS-K830-NOTFND.           
           DISPLAY ' NO OF P13P271A RECS WRITTEN  : ' WS-P271A-WRITTEN.         
           DISPLAY ' NO OF P13P271B RECS WRITTEN  : ' WS-P271B-WRITTEN.         
           DISPLAY ' NO OF P13P271C RECS WRITTEN  : ' WS-P271C-WRITTEN.         
           DISPLAY ' NO OF P13P271D RECS WRITTEN  : ' WS-P271D-WRITTEN.         
           DISPLAY ' NO OF P13P271E RECS WRITTEN  : ' WS-P271E-WRITTEN.         
           DISPLAY ' NO OF P13L271A RECS WRITTEN  : ' WS-L271A-WRITTEN.         
           DISPLAY ' NO OF P13L271B RECS WRITTEN  : ' WS-L271B-WRITTEN.         
           DISPLAY ' NO OF P13L271C RECS WRITTEN  : ' WS-L271C-WRITTEN.         
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
                                                                                
