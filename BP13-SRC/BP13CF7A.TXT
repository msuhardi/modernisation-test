       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CF7A.                                                 
      *AUTHOR.        IMC1.                                                     
      *DATE-WRITTEN.  19/04/2013.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      * OBJECTIVE    : CHECK IF OCCUPANTS HAVE ANY EXISTING FLATS  *            
      *                AND YOUNGEST CHILD IS BELOW 16 FOR AST      *            
      *                ELIGIBILITY                                 *            
      *                                                            *            
      * INPUT  FILE  : BP13F730 - CASES PER REGN                   *            
      *                BP13K825 - CHECK IF NRIC1 IS FOUND          *            
      *                BP13K730 - UPDATE NUM-AST STATUS            *            
      *                BP13K757 - RETRIEVE DTE-AST                 *            
      *          (SMS) AB03K030 - K030-DTE-SALE-EFF                *            
      *          (PPO) BR10K010 - K010-DTE-PURCHASE                *            
      *      (PPO HIS) BR10K080 - K080-DTE-DISPOSAL                *            
      *          (RSL) BB24K500 - K500-DTE-COMPLETION              *            
      *          (SLS) BR05K100 - K100-DTE-COMPLETION (SI)         *            
      *                           K100-DTE-FLAT-REVEST(CU)         *            
      *          (MAM) BC03K010 - K010-DTE-REVEST                  *            
      *          (TRF) BB13K500 - K500-DTE-APPROVE                 *            
      *          (DBR) BP04K010 - K010-REASON-CODE                 *            
      * OUTPUT FILE  : BP13F73A - ELIGIBLE                         *            
      *                BP13F73B - NON ELIGIBLE                     *            
      *                                                            *            
      * ========================================================== *            
      * CHG-REF#  BY    DDMMCCYY  DESCRIPTION                      *            
      * --------  ----  --------  -------------------------------- *            
      * BP134922  IMC1  19042013  NEW PROGRAM                      *            
      * BP134922  IMC1  27062013  16 YEARS OLD NON-ELIGIBLE        *            
      * BP13      IMC1  16072013  ADD CHECKING FOR ELIG-SCH = 'FS' *            
      * BP135190  SMR2  04122013  EXPAND BP13K813 TO 1000          *            
      * BP136007  SMR2  04112015  CATER FOR 2-ROOM FLEXI           *            
      * BP136609  SMR2  01032017  ENHANCE CONDITION TO DETERMINE   *            
      *                           AST ELIGIBILITY, TO ALLOW FT 3P  *            
      * BP137048  SMR2  08112017  ENHANCE AST ELIG DETERMINATION   *            
      *                           AST TO BE TAGGED AS 'Y' WHEN     *            
      *                             SMS- DTE-SALE-EFF<DTE-AST      *            
      *                             PPO- DTE-PURCHASE<DTE-AST      *            
      *                             RSL- DTE-SOLD-TO-SELLER<DTE-AST*            
      *                           MAM - AST TO BE TAGGED AS 'P'    *            
      * BP137749  AM25  11032019  CATER FOR CHILD AGE INCR TO 18   *            
      * BP137749  IL5   25052019  ADD CONDITION AGE SC & NSC BLANK *            
      * BP139280  EAA2  30102023  EXPAND BP13K757 FROM 3000 TO 4000*            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F730 ASSIGN       TO BP13F730.                            
                                                                                
           SELECT BP13K825 ASSIGN       TO BP13K825                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K825-KEY-FLD                         
                           FILE STATUS  IS WS-K825-STATUS.                      
                                                                                
           SELECT BP13K730 ASSIGN       TO BP13K730                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K730-KEY-NEW                         
                           FILE STATUS  IS WS-K730-STATUS.                      
                                                                                
           SELECT BP13K757 ASSIGN       TO BP13K757                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K757-KEY-FLD                         
                           FILE STATUS  IS WS-K757-STATUS.                      
                                                                                
           SELECT AB03K030 ASSIGN       TO AB03K030                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K030-NUM-HDB-REF                     
                           FILE STATUS  IS WS-K030-STATUS.                      
                                                                                
           SELECT AB03K080 ASSIGN       TO AB03K080                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K080-KEY                             
                           FILE STATUS  IS WS-AB03K080-STATUS.                  
                                                                                
           SELECT BR10K010 ASSIGN       TO BR10K010                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K010-KEY-FLD OF BR10K010-REC         
                           FILE STATUS  IS WS-BR10K010-STATUS.                  
                                                                                
           SELECT BR10K080 ASSIGN       TO BR10K080                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K080-KEY-FLD                         
                           FILE STATUS  IS WS-BR10K080-STATUS.                  
                                                                                
           SELECT BP13K813 ASSIGN       TO BP13K813                             
                           ACCESS MODE  IS RANDOM                               
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K813-KEY-FLD                         
                           FILE STATUS  IS WS-K813-STATUS.                      
                                                                                
           SELECT BB24K500 ASSIGN       TO BB24K500                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K500-KEY-FLD OF BB24K500-REC         
                           FILE STATUS  IS WS-BB24K500-STATUS.                  
                                                                                
           SELECT BB24K510 ASSIGN       TO BB24K510                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS K510-KEY-FLD OF BB24K510-REC         
                           FILE STATUS  IS WS-BB24K510-STATUS.                  
                                                                                
           SELECT BR05K100 ASSIGN TO BR05K100                                   
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K100-KEY-FLD                         
                           FILE STATUS  IS WS-BR05K100-STATUS.                  
                                                                                
           SELECT BC03K020 ASSIGN       TO BC03K020                             
                           ACCESS  MODE IS SEQUENTIAL                           
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K020-KEY-FLD                         
                           FILE STATUS  IS WS-BC03K020-STATUS.                  
                                                                                
           SELECT BC03K010 ASSIGN       TO  BC03K010                            
                           ACCESS  MODE IS RANDOM                               
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K010-KEY-FLD OF BC03K010-REC         
                           FILE STATUS  IS WS-BC03K010-STATUS.                  
                                                                                
           SELECT BB13K500 ASSIGN       TO BB13K500                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K500-KEY-FLD OF                      
                                           K500-REC-TRANSFEROR                  
                           FILE STATUS  IS WS-BB13K500-STATUS.                  
                                                                                
           SELECT BB13K510 ASSIGN       TO BB13K510                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS K510-KEY-FLD OF                      
                                           BB13K510-REC                         
                           FILE STATUS  IS WS-BB13K510-STATUS.                  
                                                                                
           SELECT BP04K010 ASSIGN  TO BP04K010                                  
                  ORGANIZATION     IS INDEXED                                   
                  ACCESS MODE      IS DYNAMIC                                   
                  RECORD KEY       IS K010-PRIME-KEY                            
                  FILE STATUS      IS WS-BP04K010-STATUS.                       
                                                                                
           SELECT BP13F73A ASSIGN       TO BP13F73A.                            
                                                                                
           SELECT BP13F73B ASSIGN       TO BP13F73B.                            
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F730                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  500 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       COPY BP13F730.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS  200 CHARACTERS.                                    
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K757                                                            
            RECORD CONTAINS 4000 CHARACTERS.                                    
       COPY BP13K757.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BR10K010.                                                           
       COPY BR10K010.                                                           
                                                                                
       FD   BR10K080.                                                           
       COPY BR10K080.                                                           
                                                                                
       FD   AB03K080.                                                           
       COPY AB03K080.                                                           
                                                                                
       FD   AB03K030.                                                           
       COPY AB03K030.                                                           
                                                                                
       FD   BB24K500    RECORD CONTAINS 1700 CHARACTERS.                        
       COPY BB24K500.                                                           
                                                                                
       FD   BB24K510.                                                           
       COPY BB24K510.                                                           
                                                                                
       FD   BP13K730                                                            
            RECORD CONTAINS  500 CHARACTERS.                                    
       COPY BP13K730.                                                           
                                                                                
       FD   BR05K100.                                                           
       COPY BR05K100.                                                           
                                                                                
       FD   BC03K010                                                            
            RECORD CONTAINS 1200 CHARACTERS.                                    
       COPY BC03K010.                                                           
                                                                                
       FD   BC03K020                                                            
            RECORD CONTAINS 50  CHARACTERS.                                     
       COPY BC03K020.                                                           
                                                                                
       FD   BB13K500                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BB13K500.                                                           
                                                                                
       FD   BB13K510                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BB13K510.                                                           
                                                                                
       FD   BP04K010                                                            
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY P04K010.                                                            
                                                                                
       FD   BP13F73A                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  500 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13F73A-REC                   PIC X(500).                          
                                                                                
       FD   BP13F73B                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  500 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13F73B-REC                   PIC X(500).                          
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  WS-K730-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-K757-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-K813-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-K825-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-K030-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-AB03K080-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BR10K010-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BR10K080-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BB24K500-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BB24K510-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BR05K100-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BC03K010-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BC03K020-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BB13K500-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BB13K510-STATUS          PIC 9(02)   VALUE ZEROES.            
           05  WS-BP04K010-STATUS          PIC 9(02)   VALUE ZEROES.            
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F730-READ                PIC 9(08)   VALUE ZEROES.            
           05  WS-F73A-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-F73B-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-PPS-YES                  PIC 9(08)   VALUE ZEROES.            
           05  WS-PPS-NO                   PIC 9(08)   VALUE ZEROES.            
           05  WS-PPS-PENDING              PIC 9(08)   VALUE ZEROES.            
           05  WS-PPS-SINGLE               PIC 9(08)   VALUE ZEROES.            
           05  WS-PPS-ADOPTED              PIC 9(08)   VALUE ZEROES.            
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-AST-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-F730-EOF                 PIC X(01)   VALUE 'N'.               
           05  WS-K825-EOF                 PIC X(01)   VALUE 'N'.               
           05  WS-K730-FND                 PIC X(01)   VALUE 'N'.               
           05  EOF-AB03K080                PIC X(01)   VALUE 'N'.               
           05  EOF-BR10K010                PIC X(01)   VALUE 'N'.               
           05  EOF-BR10K080                PIC X(01)   VALUE 'N'.               
           05  EOF-BB24K500                PIC X(01)   VALUE 'N'.               
           05  EOF-BB24K510                PIC X(01)   VALUE 'N'.               
           05  EOF-BR05K100                PIC X(01)   VALUE 'N'.               
           05  EOF-BC03K010                PIC X(01)   VALUE 'N'.               
           05  EOF-BC03K020                PIC X(01)   VALUE 'N'.               
           05  EOF-BB13K500                PIC X(01)   VALUE 'N'.               
           05  EOF-BB13K510                PIC X(01)   VALUE 'N'.               
           05  EOF-BP04K010                PIC X(01)   VALUE 'N'.               
           05  WS-SMS-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-PPO-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-RSL-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-SLS-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-MAM-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-TRF-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-DBR-FND                  PIC X(01)   VALUE 'N'.               
           05  WS-AST-ELIG                 PIC X(01)   VALUE 'N'.               
           05  WS-K020-FND                 PIC X(01)   VALUE 'N'.               
           05  WS-K010-FND                 PIC X(01)   VALUE 'N'.               
           05  WS-CHILD-SC                 PIC X(01)   VALUE 'N'.               
           05  WS-CHILD-ADOPTED            PIC X(01)   VALUE 'N'.               
           05  WS-CHILD-ONLY               PIC X(01)   VALUE 'N'.               
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DTE-OPEN-BTO             PIC 9(08)   VALUE ZEROES.            
           05  WS-DTE-CHILD-BIRTH          PIC 9(08)   VALUE ZEROES.            
           05  WS-DTE-OPEN-BTO-OTHER       PIC 9(08)   VALUE ZEROES.            
           05  WS-DTE-OTHER-BIRTH          PIC 9(08)   VALUE ZEROES.            
           05  WS-DTE-ELIG-BIRTH           PIC 9(08)   VALUE ZEROES.            
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-SN                       PIC 9(04)   VALUE ZEROES.            
           05  WS-SMS-SCH-ACC              PIC X(11)   VALUE SPACES.            
           05  WS-PPO-SCH-ACC              PIC X(11)   VALUE SPACES.            
           05  WS-RSL-SCH-ACC              PIC X(11)   VALUE SPACES.            
           05  WS-SLS-SCH-ACC              PIC X(11)   VALUE SPACES.            
           05  WS-MAM-SCH-ACC              PIC X(11)   VALUE SPACES.            
           05  WS-TRF-SCH-ACC              PIC X(11)   VALUE SPACES.            
           05  WS-DBR-SCH-ACC              PIC X(11)   VALUE SPACES.            
           05  WS-DTE-COMPLETION-RSL       PIC X(08)   VALUE SPACES.            
           05  WS-DTE-REVEST-SLS           PIC X(08)   VALUE SPACES.            
           05  WS-DTE-REVEST-MAM           PIC X(08)   VALUE SPACES.            
           05  WS-DTE-APPROVE-TRF          PIC X(08)   VALUE SPACES.            
           05  WS-SMS-DATE                 PIC X(08)   VALUE SPACES.            
           05  WS-PPO-DATE                 PIC X(08)   VALUE SPACES.            
           05  WS-DTE-AST                  PIC X(08)   VALUE SPACES.            
           05  WS-NUM-REGN                 PIC X(08)   VALUE SPACES.            
           05  WS-NUM-NRIC                 PIC X(09)   VALUE SPACES.            
           05  WS-NUM-AGE-CHILD            PIC 9(02)   VALUE ZEROES.            
           05  WS-NUM-AGE                  PIC 9(08)   VALUE ZEROES.            
           05  WS-CHILD-AGE REDEFINES WS-NUM-AGE.                               
               10  WS-AGE-CY               PIC 9(04).                           
               10  WS-AGE-MM               PIC 9(02).                           
               10  WS-AGE-DD               PIC 9(02).                           
           05  WS-NUM-AGE-CHILD-O          PIC 9(02)   VALUE ZEROES.            
           05  WS-NUM-AGE-O                PIC 9(08)   VALUE ZEROES.            
           05  WS-CHILD-AGE-O REDEFINES WS-NUM-AGE-O.                           
               10  WS-AGE-CY-O             PIC 9(04).                           
               10  WS-AGE-MM-O             PIC 9(02).                           
               10  WS-AGE-DD-O             PIC 9(02).                           
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
                                                                                
      ********************                                                      
       0000-MAIN-ROUTINE.                                                       
      ********************                                                      
                                                                                
           PERFORM 1000-OPEN-FILES         THRU 1000-EXIT.                      
           PERFORM 2000-READ-BP13F730      THRU 2000-EXIT.                      
           PERFORM 3000-PROCESS-RECS       THRU 3000-EXIT                       
             UNTIL WS-F730-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************                                                        
       1000-OPEN-FILES.                                                         
      ******************                                                        
                                                                                
           OPEN INPUT  BP13F730                                                 
                       BP13K825                                                 
                       BP13K813                                                 
                       BP13K757                                                 
                       AB03K080                                                 
                       AB03K030                                                 
                       BR05K100                                                 
                       BR10K010                                                 
                       BR10K080                                                 
                       BB13K500                                                 
                       BB13K510                                                 
                       BB24K500                                                 
                       BB24K510                                                 
                       BC03K010                                                 
                       BC03K020                                                 
                       BP04K010                                                 
                   I-O BP13K730                                                 
                OUTPUT BP13F73A                                                 
                       BP13F73B.                                                
                                                                                
           IF WS-K730-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING BP13K730 FILE ERROR ' WS-K730-STATUS             
              MOVE WS-K730-STATUS          TO RETURN-CODE                       
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BB24K500-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BB24K500 FILE ERROR ' WS-BB24K500-STATUS         
              MOVE WS-BB24K500-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BB24K510-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BB24K510 FILE ERROR ' WS-BB24K510-STATUS         
              MOVE WS-BB24K510-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K757-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING BP13K757 FILE ERROR ' WS-K757-STATUS             
              MOVE WS-K757-STATUS          TO RETURN-CODE                       
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING BP13K813 FILE ERROR ' WS-K813-STATUS             
              MOVE WS-K813-STATUS          TO RETURN-CODE                       
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING BP13K825 FILE ERROR ' WS-K825-STATUS             
              MOVE WS-K825-STATUS          TO RETURN-CODE                       
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K030-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING AB03K030 FILE ERROR ' WS-K030-STATUS             
              MOVE WS-K030-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-AB03K080-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING AB03K080 FILE ERROR ' WS-AB03K080-STATUS         
              MOVE WS-AB03K080-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BR10K010-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BR10K010 FILE ERROR ' WS-BR10K010-STATUS         
              MOVE WS-BR10K010-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BR10K080-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BR10K080 FILE ERROR ' WS-BR10K080-STATUS         
              MOVE WS-BR10K080-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BR05K100-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BR05K100 FILE ERROR ' WS-BR05K100-STATUS         
              MOVE WS-BR05K100-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BB13K500-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BB13K500 FILE ERROR ' WS-BB13K500-STATUS         
              MOVE WS-BB13K500-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BB13K510-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BB13K510 FILE ERROR ' WS-BB13K510-STATUS         
              MOVE WS-BB13K510-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BP04K010-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'OPENING BP04K010 FILE ERROR ' WS-BP04K010-STATUS         
              MOVE WS-BP04K010-STATUS        TO RETURN-CODE                     
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       2000-READ-BP13F730.                                                      
      *********************                                                     
                                                                                
           READ BP13F730 AT END                                                 
                MOVE 'Y'                   TO WS-F730-EOF                       
                GO TO 2000-EXIT.                                                
                                                                                
           ADD 1                           TO WS-F730-READ.                     
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       3000-PROCESS-RECS.                                                       
      ********************                                                      
                                                                                
           MOVE SPACES                     TO WS-NUM-REGN                       
                                              WS-NUM-NRIC                       
           INITIALIZE                         WS-NUM-AGE-CHILD                  
                                              WS-NUM-AGE-CHILD-O.               
           MOVE 'N'                        TO WS-CHILD-SC                       
                                              WS-SMS-FND                        
                                              WS-PPO-FND.                       
           MOVE 'Y'                        TO WS-AST-ELIG.                      
                                                                                
           IF (F730-CDE-HOUSEHOLD = 'G' AND                                     
               F730-CDE-BALLOT-HOUSEHOLD = 'G') AND                             
              (F730-CDE-FLAT-TYPE(1:1) = '2' OR '3')                            
               CONTINUE                                                         
           ELSE                                                                 
               MOVE 'N'       TO WS-AST-ELIG                                    
           END-IF                                                               
                                                                                
           IF F730-CDE-ELIG-SCH = 'FS'                                          
               MOVE 'N'       TO WS-AST-ELIG                                    
           END-IF                                                               
                                                                                
           PERFORM 4000-CHECK-AST          THRU 4000-EXIT                       
                                                                                
           IF WS-AST-FND = 'Y'                                                  
              IF (F730-NUM-YOUNG-CHILD-AGE-SC  > 18  AND                        
                  F730-NUM-YOUNG-CHILD-AGE-NSC = 'NC') OR                       
                 (F730-NUM-YOUNG-CHILD-AGE-SC  = 'NC' AND                       
                  F730-NUM-YOUNG-CHILD-AGE-NSC > 18 ) OR                        
                 (F730-NUM-YOUNG-CHILD-AGE-SC  > 18   AND                       
                  F730-NUM-YOUNG-CHILD-AGE-NSC > 18 ) OR                        
                 (F730-NUM-YOUNG-CHILD-AGE-SC  = 'NC' AND                       
                  F730-NUM-YOUNG-CHILD-AGE-NSC = 'NC') OR                       
                 (F730-NUM-YOUNG-CHILD-AGE-SC  = SPACES  AND                    
                  F730-NUM-YOUNG-CHILD-AGE-NSC = SPACES)                        
                  MOVE 'N'       TO WS-AST-ELIG                                 
              END-IF                                                            
           ELSE                                                                 
              MOVE 'N'           TO WS-AST-ELIG                                 
           END-IF                                                               
                                                                                
           IF WS-AST-ELIG = 'N'                                                 
      * NOT ELIGIBLE                                                            
               PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                     
               MOVE 'N'                      TO K730-NUM-AST                    
               PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                     
               PERFORM 4600-READ-BP13K757    THRU 4600-EXIT                     
               MOVE SPACES                   TO BP13F730-REC(1:28)              
               MOVE WS-DTE-AST               TO BP13F730-REC(20:8)              
               PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                       
               PERFORM 2000-READ-BP13F730  THRU 2000-EXIT                       
               GO TO 3000-EXIT                                                  
           ELSE                                                                 
               PERFORM 3100-CHECK-EXIST-FLATS   THRU 3100-EXIT                  
           END-IF                                                               
                                                                                
           PERFORM 2000-READ-BP13F730      THRU 2000-EXIT.                      
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************                                                 
       3100-CHECK-EXIST-FLATS.                                                  
      *************************                                                 
                                                                                
           INITIALIZE WS-SMS-SCH-ACC WS-RSL-SCH-ACC WS-PPO-SCH-ACC              
                      WS-MAM-SCH-ACC WS-SLS-SCH-ACC WS-TRF-SCH-ACC              
                      WS-DBR-SCH-ACC        WS-DTE-REVEST-SLS                   
                      WS-DTE-COMPLETION-RSL WS-DTE-REVEST-MAM                   
                      WS-DTE-APPROVE-TRF    WS-SMS-DATE                         
                      WS-PPO-DATE           WS-DTE-AST                          
                                                                                
           PERFORM 4600-READ-BP13K757      THRU 4600-EXIT                       
           PERFORM 4100-CHECK-AB03K080     THRU 4100-EXIT                       
           PERFORM 4300-CHECK-BR10K010     THRU 4300-EXIT                       
           PERFORM 5300-CHECK-BB24K510     THRU 5300-EXIT                       
           PERFORM 5600-CHECK-BR05K100     THRU 5600-EXIT                       
           PERFORM 6000-CHECK-BC03K020     THRU 6000-EXIT                       
           PERFORM 6500-CHECK-BB13K510     THRU 6500-EXIT                       
           PERFORM 7200-CHECK-BP04K010     THRU 7200-EXIT                       
                                                                                
           MOVE SPACES                     TO BP13F730-REC(1:28)                
                                                                                
           IF WS-SMS-FND = 'Y'                                                  
              PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                      
              MOVE 'N'             TO K730-NUM-AST                              
                                      F730-NUM-AST                              
              PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                      
              MOVE WS-SMS-SCH-ACC  TO BP13F730-REC(1:11)                        
              MOVE WS-SMS-DATE     TO BP13F730-REC(12:8)                        
              MOVE WS-DTE-AST      TO BP13F730-REC(20:8)                        
              MOVE 'S'             TO BP13F730-REC(28:1)                        
              PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                        
              GO TO 3100-EXIT                                                   
           END-IF                                                               
                                                                                
           IF WS-PPO-FND = 'Y'                                                  
              IF WS-PPO-DATE >= WS-DTE-AST                                      
                 PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                   
                 MOVE 'N'             TO K730-NUM-AST                           
                                         F730-NUM-AST                           
                 PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                   
                 MOVE WS-DTE-AST      TO BP13F730-REC(20:8)                     
                 MOVE WS-PPO-SCH-ACC  TO BP13F730-REC(1:11)                     
                 MOVE WS-PPO-DATE     TO BP13F730-REC(12:8)                     
                 MOVE 'P'             TO BP13F730-REC(28:1)                     
                 PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                     
                 GO TO 3100-EXIT                                                
              ELSE                                                              
                 PERFORM 4900-CHECK-BR10K080   THRU 4900-EXIT                   
                 IF WS-PPO-DATE >= WS-DTE-AST                                   
                    PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                
                    MOVE 'N'             TO K730-NUM-AST                        
                                            F730-NUM-AST                        
                    PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                
                    MOVE WS-DTE-AST      TO BP13F730-REC(20:8)                  
                    MOVE WS-PPO-SCH-ACC  TO BP13F730-REC(1:11)                  
                    MOVE WS-PPO-DATE     TO BP13F730-REC(12:8)                  
                    MOVE 'P'             TO BP13F730-REC(28:1)                  
                    PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                  
                    GO TO 3100-EXIT                                             
                 ELSE                                                           
                    IF WS-PPO-SCH-ACC NOT = SPACES                              
                       MOVE WS-PPO-SCH-ACC  TO BP13F730-REC(1:11)               
                       MOVE WS-PPO-DATE     TO BP13F730-REC(12:8)               
                       MOVE 'P'             TO BP13F730-REC(28:1)               
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              PERFORM 4900-CHECK-BR10K080   THRU 4900-EXIT                      
              IF WS-PPO-DATE >= WS-DTE-AST                                      
                 PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                   
                 MOVE 'N'             TO K730-NUM-AST                           
                                         F730-NUM-AST                           
                 PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                   
                 MOVE WS-DTE-AST      TO BP13F730-REC(20:8)                     
                 MOVE WS-PPO-SCH-ACC  TO BP13F730-REC(1:11)                     
                 MOVE WS-PPO-DATE     TO BP13F730-REC(12:8)                     
                 MOVE 'P'             TO BP13F730-REC(28:1)                     
                 PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                     
                 GO TO 3100-EXIT                                                
              ELSE                                                              
                 IF WS-PPO-SCH-ACC NOT = SPACES                                 
                    MOVE WS-PPO-SCH-ACC  TO BP13F730-REC(1:11)                  
                    MOVE WS-PPO-DATE     TO BP13F730-REC(12:8)                  
                    MOVE 'P'             TO BP13F730-REC(28:1)                  
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF  WS-RSL-FND = 'Y'                                                 
               PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                     
               MOVE 'N'             TO K730-NUM-AST                             
                                       F730-NUM-AST                             
               PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                     
               MOVE WS-RSL-SCH-ACC         TO BP13F730-REC(1:11)                
               MOVE WS-DTE-COMPLETION-RSL  TO BP13F730-REC(12:8)                
               MOVE WS-DTE-AST             TO BP13F730-REC(20:8)                
               MOVE 'R'                    TO BP13F730-REC(28:1)                
               PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                       
               GO TO 3100-EXIT                                                  
           ELSE                                                                 
               IF WS-RSL-SCH-ACC NOT = SPACES                                   
                  MOVE WS-RSL-SCH-ACC         TO BP13F730-REC(1:11)             
                  MOVE WS-DTE-COMPLETION-RSL  TO BP13F730-REC(12:8)             
                  MOVE 'R'                    TO BP13F730-REC(28:1)             
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  WS-SLS-FND = 'Y'                                                 
               PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                     
               MOVE 'P'             TO K730-NUM-AST                             
                                       F730-NUM-AST                             
               PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                     
               MOVE WS-SLS-SCH-ACC         TO BP13F730-REC(1:11)                
               MOVE WS-DTE-REVEST-SLS      TO BP13F730-REC(12:8)                
               MOVE WS-DTE-AST             TO BP13F730-REC(20:8)                
               MOVE 'L'                    TO BP13F730-REC(28:1)                
               PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                       
               GO TO 3100-EXIT                                                  
           ELSE                                                                 
               IF WS-SLS-SCH-ACC NOT = SPACES                                   
                  MOVE WS-SLS-SCH-ACC             TO BP13F730-REC(1:11)         
                  MOVE WS-DTE-REVEST-SLS          TO BP13F730-REC(12:8)         
                  MOVE 'L'                        TO BP13F730-REC(28:1)         
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  WS-MAM-FND = 'Y'                                                 
               PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                     
               MOVE 'P'             TO K730-NUM-AST                             
                                       F730-NUM-AST                             
               PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                     
               MOVE WS-MAM-SCH-ACC         TO BP13F730-REC(1:11)                
               MOVE WS-DTE-REVEST-MAM      TO BP13F730-REC(12:8)                
               MOVE WS-DTE-AST             TO BP13F730-REC(20:8)                
               MOVE 'M'                    TO BP13F730-REC(28:1)                
               PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                       
               GO TO 3100-EXIT                                                  
           ELSE                                                                 
               IF WS-MAM-SCH-ACC NOT = SPACES                                   
                  MOVE WS-MAM-SCH-ACC         TO BP13F730-REC(1:11)             
                  MOVE WS-DTE-REVEST-MAM      TO BP13F730-REC(12:8)             
                  MOVE 'M'                    TO BP13F730-REC(28:1)             
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  WS-TRF-FND = 'Y'                                                 
               PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                     
               MOVE 'P'             TO K730-NUM-AST                             
                                       F730-NUM-AST                             
               PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                     
               MOVE WS-TRF-SCH-ACC         TO BP13F730-REC(1:11)                
               MOVE WS-DTE-APPROVE-TRF     TO BP13F730-REC(12:8)                
               MOVE WS-DTE-AST             TO BP13F730-REC(20:8)                
               MOVE 'T'                    TO BP13F730-REC(28:1)                
               PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                       
               GO TO 3100-EXIT                                                  
            ELSE                                                                
               IF WS-TRF-SCH-ACC NOT = SPACES                                   
                  MOVE WS-TRF-SCH-ACC         TO BP13F730-REC(1:11)             
                  MOVE WS-DTE-APPROVE-TRF     TO BP13F730-REC(12:8)             
                  MOVE 'T'                    TO BP13F730-REC(28:1)             
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF WS-DBR-FND = 'Y'                                                  
               PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                     
               MOVE 'P'             TO K730-NUM-AST                             
                                       F730-NUM-AST                             
               PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                     
               MOVE WS-DBR-SCH-ACC         TO BP13F730-REC(1:11)                
               MOVE SPACES                 TO BP13F730-REC(12:8)                
               MOVE WS-DTE-AST             TO BP13F730-REC(20:8)                
               MOVE 'D'                    TO BP13F730-REC(28:1)                
               PERFORM 7000-WRITE-BP13F73B THRU 7000-EXIT                       
               GO TO 3100-EXIT                                                  
            ELSE                                                                
               IF WS-DBR-SCH-ACC NOT = SPACES                                   
                  MOVE WS-DBR-SCH-ACC         TO BP13F730-REC(1:11)             
                  MOVE SPACES                 TO BP13F730-REC(12:8)             
                  MOVE 'D'                    TO BP13F730-REC(28:1)             
               END-IF                                                           
           END-IF.                                                              
                                                                                
           PERFORM 4500-READ-BP13K730    THRU 4500-EXIT                         
           MOVE 'Y'                      TO K730-NUM-AST                        
                                            F730-NUM-AST                        
                                                                                
           PERFORM 4550-UPDATE-BP13K730  THRU 4550-EXIT                         
           MOVE WS-DTE-AST               TO BP13F730-REC(20:8)                  
           PERFORM 7100-WRITE-BP13F73A   THRU 7100-EXIT.                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       4000-CHECK-AST.                                                          
      ********************                                                      
                                                                                
           MOVE 'N'                     TO WS-AST-FND.                          
           MOVE F730-NUM-REGN           TO WS-NUM-REGN.                         
           MOVE F730-NUM-NRIC1          TO WS-NUM-NRIC.                         
                                                                                
           PERFORM 4050-READ-BP13K825   THRU 4050-EXIT                          
                                                                                
           IF WS-AST-FND  = 'N' AND                                             
             (F730-NUM-NRIC2(1:1) NOT = '#' AND SPACES)                         
              MOVE F730-NUM-NRIC2            TO WS-NUM-NRIC                     
              PERFORM 4050-READ-BP13K825   THRU 4050-EXIT                       
           END-IF                                                               
                                                                                
           IF WS-AST-FND  = 'N' AND                                             
             (F730-NUM-NRIC3(1:1) NOT = '#' AND SPACES)                         
              MOVE F730-NUM-NRIC3            TO WS-NUM-NRIC                     
              PERFORM 4050-READ-BP13K825   THRU 4050-EXIT                       
           END-IF                                                               
                                                                                
           IF WS-AST-FND  = 'N' AND                                             
             (F730-NUM-NRIC4(1:1) NOT = '#' AND SPACES)                         
              MOVE F730-NUM-NRIC4            TO WS-NUM-NRIC                     
              PERFORM 4050-READ-BP13K825   THRU 4050-EXIT                       
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       4050-READ-BP13K825.                                                      
      ********************                                                      
                                                                                
           MOVE SPACES                               TO BP13K825-REC.           
           INITIALIZE                                   BP13K825-REC.           
                                                                                
           MOVE WS-NUM-REGN                          TO K825-NUM-REGN.          
           MOVE WS-NUM-NRIC                          TO K825-NUM-NRIC.          
                                                                                
           READ BP13K825.                                                       
                                                                                
           EVALUATE WS-K825-STATUS                                              
              WHEN  00                                                          
                    IF K825-NUM-AST = 'Y' AND                                   
                      (K825-NUM-MARITAL-STATUS = '3' OR '4' OR '5')             
                       MOVE 'Y'           TO WS-AST-FND                         
                    END-IF                                                      
              WHEN  23                                                          
                    MOVE 'N'              TO WS-AST-FND                         
                    DISPLAY 'BP13K825 REC NOT FND: ' K825-KEY-FLD               
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BP13K825 ERROR ' WS-K825-STATUS               
                    MOVE WS-K825-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4100-CHECK-AB03K080.                                                     
      *------------------------------------------------------------             
           MOVE SPACES               TO K080-KEY                                
                                        WS-SMS-SCH-ACC                          
                                        WS-SMS-DATE.                            
           MOVE 'N'                  TO EOF-AB03K080                            
                                        WS-SMS-FND.                             
           MOVE F730-NUM-NRIC1       TO K080-NUM-UIN OF AB03K080.               
                                                                                
           START AB03K080 KEY >= K080-KEY.                                      
                                                                                
            EVALUATE WS-AB03K080-STATUS                                         
              WHEN 00                                                           
                   PERFORM 4200-READNEXT-AB03K080   THRU 4200-EXIT              
                     UNTIL K080-NUM-UIN OF AB03K080-REC NOT =                   
                                           F730-NUM-NRIC1                       
                      OR   WS-SMS-FND = 'Y'                                     
                      OR   EOF-AB03K080 = 'Y'                                   
              WHEN 23                                                           
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   DISPLAY 'START AB03K080 ERROR ' WS-AB03K080-STATUS           
                   MOVE WS-AB03K080-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4200-READNEXT-AB03K080.                                                  
      *------------------------------------------------------------             
            READ AB03K080 NEXT.                                                 
                                                                                
            EVALUATE WS-AB03K080-STATUS                                         
              WHEN 00                                                           
                   IF K080-NUM-UIN OF AB03K080 = F730-NUM-NRIC1                 
                      PERFORM 4700-READ-AB03K030   THRU 4700-EXIT               
                   END-IF                                                       
              WHEN 10                                                           
                   MOVE 'Y' TO EOF-AB03K080                                     
              WHEN 23                                                           
                   MOVE 'Y' TO EOF-AB03K080                                     
              WHEN OTHER                                                        
                   DISPLAY 'START AB03K080 ERROR ' WS-AB03K080-STATUS           
                   MOVE WS-AB03K080-STATUS      TO RETURN-CODE                  
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4300-CHECK-BR10K010.                                                     
      *------------------------------------------------------------             
           MOVE SPACES          TO K010-KEY-FLD OF BR10K010-REC                 
                                   WS-PPO-SCH-ACC                               
                                   WS-PPO-DATE.                                 
           MOVE 'N'             TO EOF-BR10K010                                 
                                   WS-PPO-FND.                                  
           MOVE F730-NUM-NRIC1  TO K010-NUM-UIN OF BR10K010-REC.                
                                                                                
           START BR10K010 KEY >= K010-KEY-FLD OF  BR10K010-REC.                 
                                                                                
           EVALUATE WS-BR10K010-STATUS                                          
             WHEN   00                                                          
                    PERFORM 4400-READNEXT-BR10K010 THRU 4400-EXIT               
                      UNTIL K010-NUM-UIN OF BR10K010-REC NOT =                  
                                            F730-NUM-NRIC1                      
                         OR EOF-BR10K010 = 'Y'                                  
                         OR WS-PPO-FND = 'Y'                                    
                                                                                
             WHEN   23                                                          
                    CONTINUE                                                    
             WHEN   OTHER                                                       
                    DISPLAY 'BR10K010 START ERROR ' WS-BR10K010-STATUS          
                    DISPLAY 'BR10K010 RECORD KEY IS ' K010-KEY-FLD              
                            OF BR10K010-REC                                     
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4400-READNEXT-BR10K010.                                                  
      *------------------------------------------------------------             
           READ BR10K010 NEXT.                                                  
                                                                                
           EVALUATE WS-BR10K010-STATUS                                          
              WHEN  00                                                          
                    IF K010-NUM-UIN OF BR10K010-REC = F730-NUM-NRIC1            
                       MOVE K010-NUM-HDB-REF1    TO WS-PPO-SCH-ACC              
                       MOVE K010-DTE-PURCHASE    TO WS-PPO-DATE                 
                       MOVE 'Y'       TO WS-PPO-FND                             
                    ELSE                                                        
                       MOVE 'Y'       TO EOF-BR10K010                           
                    END-IF                                                      
              WHEN  23                                                          
                    MOVE 'Y'       TO EOF-BR10K010                              
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BR10K010 ERROR ' WS-BR10K010-STATUS           
                    MOVE WS-BR10K010-STATUS TO RETURN-CODE                      
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4500-READ-BP13K730.                                                      
      *------------------------------------------------------------             
           INITIALIZE BP13K730-REC.                                             
           MOVE 'N'           TO WS-K730-FND                                    
                                                                                
           MOVE F730-NUM-REGN   TO K730-NUM-REGN                                
                                                                                
           READ BP13K730.                                                       
                                                                                
           EVALUATE WS-K730-STATUS                                              
              WHEN  00                                                          
                    MOVE 'Y'  TO WS-K730-FND                                    
              WHEN  23                                                          
                    DISPLAY 'BP13K730 REC NOT FND: ' K730-NUM-REGN              
              WHEN  OTHER                                                       
                    DISPLAY 'READ BP13K730 ERROR ' WS-K730-STATUS               
                    MOVE WS-K730-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4550-UPDATE-BP13K730.                                                    
      *------------------------------------------------------------             
                                                                                
           REWRITE BP13K730-REC.                                                
                                                                                
           EVALUATE WS-K730-STATUS                                              
              WHEN  00                                                          
                    CONTINUE                                                    
              WHEN  23                                                          
                    DISPLAY 'BP13K730 REC NOT FND: ' K730-NUM-REGN              
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BP13K730 ERROR ' WS-K730-STATUS               
                    MOVE WS-K730-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4600-READ-BP13K757.                                                      
      *------------------------------------------------------------             
           INITIALIZE BP13K757-REC                                              
                      WS-DTE-AST.                                               
                                                                                
           MOVE F730-NUM-REGN   TO K757-NUM-REGN                                
                                                                                
           READ BP13K757.                                                       
                                                                                
           EVALUATE WS-K757-STATUS                                              
              WHEN  00                                                          
                    IF K757-DTE-AST = SPACES OR LOW-VALUES                      
                       MOVE ZEROES       TO WS-DTE-AST                          
                    ELSE                                                        
                       MOVE K757-DTE-AST TO WS-DTE-AST                          
                    END-IF                                                      
              WHEN  23                                                          
                    DISPLAY 'BP13K757 REC NOT FND: ' K757-NUM-REGN              
                    MOVE ZEROES       TO WS-DTE-AST                             
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BP13K757 ERROR ' WS-K757-STATUS               
                    MOVE WS-K757-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4700-READ-AB03K030.                                                      
      *------------------------------------------------------------             
           INITIALIZE AB03K030-REC.                                             
                                                                                
           MOVE K080-NUM-HDB-REF TO K030-NUM-HDB-REF.                           
                                                                                
           READ AB03K030.                                                       
                                                                                
           EVALUATE WS-K030-STATUS                                              
              WHEN  00                                                          
                    IF K030-DTE-SALE-EFF >= WS-DTE-AST                          
                       MOVE K080-NUM-HDB-REF     TO WS-SMS-SCH-ACC              
                       MOVE K030-DTE-SALE-EFF    TO WS-SMS-DATE                 
                       MOVE 'Y'                  TO WS-SMS-FND                  
                    END-IF                                                      
              WHEN  23                                                          
                    DISPLAY 'AB03K030 REC NOT FND: ' K030-NUM-HDB-REF           
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT AB03K030 ERROR ' WS-K030-STATUS               
                    MOVE WS-K030-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4900-CHECK-BR10K080.                                                     
      *------------------------------------------------------------             
           MOVE SPACES          TO K080-KEY-FLD.                                
           MOVE 'N'             TO EOF-BR10K080                                 
                                   WS-PPO-FND.                                  
           MOVE F730-NUM-NRIC1  TO K080-NUM-UIN OF BR10K080-REC.                
                                                                                
           START BR10K080 KEY >= K080-KEY-FLD.                                  
                                                                                
           EVALUATE WS-BR10K080-STATUS                                          
             WHEN   00                                                          
                    PERFORM 4950-READNEXT-BR10K080 THRU 4950-EXIT               
                      UNTIL K080-NUM-UIN OF BR10K080-REC NOT =                  
                                            F730-NUM-NRIC1                      
                         OR EOF-BR10K080 = 'Y'                                  
                         OR WS-PPO-FND = 'Y'                                    
                                                                                
             WHEN   23                                                          
                    CONTINUE                                                    
             WHEN   OTHER                                                       
                    DISPLAY 'BR10K080 START ERROR ' WS-BR10K080-STATUS          
                    DISPLAY 'BR10K080 RECORD KEY IS ' K080-KEY-FLD              
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4950-READNEXT-BR10K080.                                                  
      *------------------------------------------------------------             
           READ BR10K080 NEXT.                                                  
                                                                                
           EVALUATE WS-BR10K080-STATUS                                          
              WHEN  00                                                          
                    IF K080-NUM-UIN OF BR10K080-REC = F730-NUM-NRIC1            
                       MOVE K080-NUM-HDB-REF1    TO WS-PPO-SCH-ACC              
                       MOVE K080-DTE-PURCHASE    TO WS-PPO-DATE                 
                       MOVE 'Y'       TO WS-PPO-FND                             
                    ELSE                                                        
                       MOVE 'Y'       TO EOF-BR10K080                           
                    END-IF                                                      
              WHEN  23                                                          
                    MOVE 'Y'       TO EOF-BR10K080                              
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BR10K080 ERROR ' WS-BR10K080-STATUS           
                    MOVE WS-BR10K080-STATUS TO RETURN-CODE                      
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       4950-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       5300-CHECK-BB24K510.                                                     
      *------------------------------------------------------------             
           INITIALIZE  WS-BB24K510-STATUS                                       
                                                                                
           MOVE SPACES                  TO K510-KEY-FLD OF BB24K510-REC         
           MOVE 'N'                     TO EOF-BB24K510                         
                                           WS-RSL-FND.                          
           MOVE F730-NUM-NRIC1          TO K510-NUM-UIN OF BB24K510-REC         
                                                                                
           START BB24K510 KEY >=  K510-KEY-FLD OF BB24K510-REC                  
                                                                                
           EVALUATE WS-BB24K510-STATUS                                          
              WHEN 00                                                           
                   PERFORM 5400-READNEXT-BB24K510   THRU 5400-EXIT              
                     UNTIL K510-NUM-UIN OF BB24K510-REC                         
                                    NOT = F730-NUM-NRIC1                        
                      OR   WS-RSL-FND   = 'Y'                                   
                      OR   EOF-BB24K510 = 'Y'                                   
              WHEN 23                                                           
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   DISPLAY 'START BB24K510 ERROR ' WS-BB24K510-STATUS           
                   MOVE WS-BB24K510-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       5400-READNEXT-BB24K510.                                                  
      *------------------------------------------------------------             
            READ BB24K510 NEXT.                                                 
                                                                                
            EVALUATE WS-BB24K510-STATUS                                         
              WHEN 00                                                           
                  IF (K510-NUM-UIN OF BB24K510-REC = F730-NUM-NRIC1)    D       
                     IF K510-CDE-STATUS = 'S'                                   
                        PERFORM 5500-READ-BB24K500 THRU 5500-EXIT               
                     END-IF                                                     
                  ELSE                                                          
                      MOVE 'Y' TO EOF-BB24K510                                  
                  END-IF                                                        
              WHEN 10                                                           
              WHEN 23                                                           
                   MOVE 'Y' TO EOF-BB24K510                                     
              WHEN OTHER                                                        
                   DISPLAY 'START BB24K510 ERROR ' WS-BB24K510-STATUS           
                   MOVE WS-BB24K510-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       5500-READ-BB24K500.                                                      
      *------------------------------------------------------------             
                                                                                
           MOVE K510-NUM-HDB-REF OF BB24K510-REC TO                             
                K500-NUM-HDB-REF OF BB24K500-REC                                
           MOVE K510-DTE-APPROVAL  TO K500-DTE-APPROVAL.                        
                                                                                
           READ BB24K500.                                                       
                                                                                
           EVALUATE WS-BB24K500-STATUS                                          
             WHEN 00                                                            
                  IF K500-DTE-SOLD-TO-SELLER OF BB24K500-REC >=                 
                     WS-DTE-AST                                                 
                     MOVE 'Y' TO WS-RSL-FND                                     
                     MOVE K500-NUM-HDB-REF OF BB24K500-REC                      
                       TO WS-RSL-SCH-ACC                                        
                     MOVE K500-DTE-SOLD-TO-SELLER OF BB24K500-REC               
                       TO WS-DTE-COMPLETION-RSL                                 
                  END-IF                                                        
                                                                                
              WHEN 10                                                           
              WHEN 23                                                           
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   DISPLAY 'READ BB24K500 ERROR ' WS-BB24K500-STATUS            
                   MOVE WS-BB24K500-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       5600-CHECK-BR05K100.                                                     
      *==============================================================*          
                                                                                
           MOVE F730-NUM-NRIC1 TO K100-NUM-UIN.                                 
           MOVE 'N'            TO WS-SLS-FND                                    
                                  EOF-BR05K100.                                 
                                                                                
           START BR05K100 KEY >= K100-NUM-UIN.                                  
                                                                                
           EVALUATE WS-BR05K100-STATUS                                          
           WHEN 00                                                              
           WHEN 02                                                              
                PERFORM 5700-READNEXT-BR05K100 THRU 5700-EXIT                   
                PERFORM 5800-PROCESS-SLSREC    THRU 5800-EXIT                   
                  UNTIL (F730-NUM-NRIC1 NOT = K100-NUM-UIN)                     
                     OR WS-SLS-FND   = 'Y'                                      
                     OR EOF-BR05K100 = 'Y'                                      
           WHEN 20                                                              
           WHEN 23                                                              
                MOVE 'N' TO WS-SLS-FND                                          
           WHEN OTHER                                                           
                DISPLAY "START BR05K100 FAIL STATUS " WS-BR05K100-STATUS        
                        " KEY " K100-NUM-UIN                                    
                PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       5600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       5700-READNEXT-BR05K100.                                                  
      *==============================================================*          
                                                                                
           READ BR05K100 NEXT RECORD                                            
                         AT END MOVE 'Y' TO EOF-BR05K100.                       
                                                                                
       5700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       5800-PROCESS-SLSREC.                                                     
      *==============================================================*          
                                                                                
           IF K100-NUM-UIN = F730-NUM-NRIC1 AND                                 
             (K100-NUM-SRNDR = 'SU' OR 'CI')                                    
              IF K100-NUM-SRNDR       = 'SU' AND                                
                 K100-DTE-COMPLETION >= WS-DTE-AST                              
                 MOVE 'Y'       TO WS-SLS-FND                                   
                 MOVE K100-NUM-HDB-REF TO WS-SLS-SCH-ACC                        
                 MOVE K100-DTE-APPLY   TO WS-DTE-REVEST-SLS                     
              ELSE                                                              
                 IF K100-NUM-SRNDR = 'CI' AND                                   
                    K100-DTE-FLAT-REVEST >= WS-DTE-AST                          
                    MOVE 'Y'    TO WS-SLS-FND                                   
                    MOVE K100-NUM-HDB-REF     TO WS-SLS-SCH-ACC                 
                    MOVE K100-DTE-FLAT-REVEST TO WS-DTE-REVEST-SLS              
                 END-IF                                                         
              END-IF                                                            
            END-IF.                                                             
                                                                                
           PERFORM 5700-READNEXT-BR05K100 THRU 5700-EXIT.                       
                                                                                
       5800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6000-CHECK-BC03K020.                                                     
      *-------------------------------------------------------------            
                                                                                
           MOVE  SPACES                       TO   K020-KEY-FLD.                
           MOVE  'N'                          TO   WS-MAM-FND                   
                                                   EOF-BC03K020.                
           MOVE  F730-NUM-NRIC1               TO   K020-KEY-FLD.                
                                                                                
           START BC03K020 KEY >= K020-KEY-FLD.                                  
                                                                                
           EVALUATE WS-BC03K020-STATUS                                          
           WHEN 00                                                              
           WHEN 02                                                              
                PERFORM 6100-READNEXT-BC03K020   THRU 6100-EXIT                 
                PERFORM 6200-PROCESS-MAMS-RECORD THRU 6200-EXIT                 
                  UNTIL K020-NUM-UIN NOT = F730-NUM-NRIC1                       
                     OR EOF-BC03K020 = 'Y'                                      
                     OR WS-MAM-FND = 'Y'                                        
           WHEN 10                                                              
           WHEN 23                                                              
                MOVE 'N'     TO WS-MAM-FND                                      
           WHEN OTHER                                                           
                DISPLAY 'ERROR READING FILE K020 ,STATUS '                      
                                              WS-BC03K020-STATUS                
                PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6100-READNEXT-BC03K020.                                                  
      *-------------------------------------------------------------            
                                                                                
           READ BC03K020 NEXT AT END                                            
                                    MOVE 'Y'  TO EOF-BC03K020.                  
                                                                                
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6200-PROCESS-MAMS-RECORD.                                                
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES                        TO WS-K010-FND.                   
                                                                                
           IF F730-NUM-NRIC1 = K020-NUM-UIN                                     
              PERFORM 6300-READ-BC03K010         THRU 6300-EXIT                 
                                                                                
              IF WS-K010-FND = 'Y'                                              
                 PERFORM 6400-PROCESS-MAM        THRU 6400-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 6100-READNEXT-BC03K020        THRU 6100-EXIT.                
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6300-READ-BC03K010.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE  SPACES              TO   K010-KEY-FLD OF BC03K010-REC.         
           MOVE  K020-NUM-HDB-REF    TO   K010-KEY-FLD OF BC03K010-REC.         
                                                                                
           READ  BC03K010.                                                      
                                                                                
           EVALUATE WS-BC03K010-STATUS                                          
           WHEN 00                                                              
                MOVE 'Y'                      TO   WS-K010-FND                  
           WHEN 23                                                              
                CONTINUE                                                        
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING FILE K010,STATUS '                         
                       WS-BC03K020-STATUS                                       
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6400-PROCESS-MAM.                                                        
      *-------------------------------------------------------------            
                                                                                
           IF K010-DTE-REVEST >= WS-DTE-AST                                     
              MOVE 'Y'              TO WS-MAM-FND                               
              MOVE K010-KEY-FLD OF BC03K010-REC  TO WS-MAM-SCH-ACC              
              MOVE K010-DTE-REVEST               TO WS-DTE-REVEST-MAM           
           END-IF.                                                              
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6500-CHECK-BB13K510.                                                     
      *****************************************************************         
           MOVE SPACES                  TO K510-KEY-FLD OF BB13K510-REC         
           MOVE 'N'                     TO WS-TRF-FND                           
           MOVE F730-NUM-NRIC1          TO K510-NUM-UIN OF BB13K510-REC.        
                                                                                
           START BB13K510 KEY >= K510-KEY-FLD OF BB13K510-REC.                  
           IF WS-BB13K510-STATUS = ZEROES                                       
              PERFORM 6600-READNEXT-BB13K510  THRU 6600-EXIT                    
              PERFORM 6700-CHECK-STATUS-REC   THRU 6700-EXIT                    
                UNTIL F730-NUM-NRIC1 NOT = K510-NUM-UIN OF BB13K510-REC         
                   OR K510-NUM-UIN OF BB13K510 = HIGH-VALUE                     
                   OR WS-TRF-FND = 'Y'                                          
           ELSE                                                                 
           IF WS-BB13K510-STATUS = 23                                           
              DISPLAY 'K510-NUM-UIN : ' K510-NUM-UIN OF BB13K510-REC            
                      ' NOT FOUND IN BB13K510'                                  
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6600-READNEXT-BB13K510.                                                  
      *****************************************************************         
           READ BB13K510 NEXT                                                   
              AT END MOVE HIGH-VALUE TO K510-NUM-UIN OF BB13K510-REC.           
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6700-CHECK-STATUS-REC.                                                   
      *****************************************************************         
                                                                                
           IF K510-CDE-REC = 'S'                                                
              IF F730-NUM-NRIC1 = K510-NUM-UIN OF BB13K510-REC                  
                 PERFORM 6800-READ-BB13K500   THRU 6800-EXIT                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 6600-READNEXT-BB13K510     THRU 6600-EXIT.                   
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6800-READ-BB13K500.                                                      
      *****************************************************************         
           MOVE SPACES        TO K500-KEY-FLD OF K500-REC-TRANSFEROR            
           MOVE K510-NUM-HDB-REF OF BB13K510-REC                                
             TO K500-NUM-HDB-REF OF K500-REC-TRANSFEROR                         
           MOVE K510-CDE-REC  TO K500-CDE-REC.                                  
                                                                                
           READ BB13K500                                                        
                                                                                
           IF WS-BB13K500-STATUS = ZEROES                                       
              IF K500-CDE-REC = 'S' AND                                         
                (K500-DTE-LEGAL-DOC-SIGN >= WS-DTE-AST)                         
                 MOVE 'Y'                TO WS-TRF-FND                          
                 MOVE K500-KEY-FLD       OF K500-REC-TRANSFEROR                 
                   TO WS-TRF-SCH-ACC                                            
                 MOVE K500-DTE-LEGAL-DOC-SIGN  TO WS-DTE-APPROVE-TRF            
              END-IF                                                            
           ELSE                                                                 
              IF WS-BB13K500-STATUS = 23                                        
                 DISPLAY 'K510-NUM-HDB-REF ' K510-NUM-HDB-REF OF                
                         BB13K510-REC ' NOT FOUND IN BB13K500'                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7000-WRITE-BP13F73B.                                                     
      **********************                                                    
      *    NOT ELIGIBLE FOR AST                                                 
                                                                                
           WRITE BP13F73B-REC              FROM BP13F730-REC.                   
           ADD 1                           TO WS-F73B-WRITE.                    
                                                                                
           MOVE SPACES                     TO BP13F73B-REC.                     
           INITIALIZE                         BP13F73B-REC.                     
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7100-WRITE-BP13F73A.                                                     
      **********************                                                    
      *    OK                                                                   
                                                                                
           WRITE BP13F73A-REC              FROM BP13F730-REC.                   
           ADD 1                           TO WS-F73A-WRITE.                    
                                                                                
           MOVE SPACES                     TO BP13F73A-REC.                     
           INITIALIZE                         BP13F73A-REC.                     
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7200-CHECK-BP04K010.                                                     
      *****************************************************************         
           INITIALIZE P04K010-REC                                               
                      WS-BP04K010-STATUS                                        
                                                                                
           MOVE SPACES                  TO P04K010-REC.                         
                                                                                
           MOVE 'N'                     TO WS-DBR-FND                           
                                           EOF-BP04K010                         
           MOVE F730-NUM-NRIC1          TO K010-NUM-UINFIN                      
                                                                                
           START BP04K010 KEY >= K010-PRIME-KEY.                                
           IF WS-BP04K010-STATUS = ZEROES                                       
              PERFORM 7300-READNEXT-BP04K010  THRU 7300-EXIT                    
                UNTIL F730-NUM-NRIC1 NOT = K010-NUM-UINFIN                      
                   OR EOF-BP04K010 = 'Y'                                        
           ELSE                                                                 
              IF WS-BP04K010-STATUS = 23                                        
                 DISPLAY 'K010-NUM-UIN : ' K010-NUM-UINFIN                      
                         ' NOT FOUND IN BP04K010'                               
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7300-READNEXT-BP04K010.                                                  
      *****************************************************************         
           READ BP04K010 NEXT                                                   
              AT END MOVE HIGH-VALUE TO K010-NUM-UINFIN                         
                                                                                
            IF K010-NUM-UINFIN = F730-NUM-NRIC1                                 
               IF K010-REASON-CODE = 'EG' OR 'EH' OR 'EJ' OR 'EM' OR            
                                     'EQ' OR 'EU' OR 'EV' OR 'EX'               
                  MOVE 'Y'                TO WS-DBR-FND                         
                  MOVE K010-EX-SCH-ACCTNO TO WS-DBR-SCH-ACC                     
               END-IF                                                           
            ELSE                                                                
               MOVE 'Y'           TO EOF-BP04K010                               
            END-IF.                                                             
                                                                                
       7300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************                                                       
       9000-CLOSE-FILES.                                                        
      *******************                                                       
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '*================ BP13CF7A ================*'.              
           DISPLAY '  NO OF F730 RECORDS READ     = ' WS-F730-READ.             
           DISPLAY '  NO OF F73A RECORDS WRITTEN  = ' WS-F73A-WRITE.            
           DISPLAY '  NO OF F73B RECORDS WRITTEN  = ' WS-F73B-WRITE.            
           DISPLAY '*==========================================*'.              
                                                                                
           CLOSE BP13F730                                                       
                 BP13K825                                                       
                 BP13K813                                                       
                 BP13K730                                                       
                 BP13K757                                                       
                 AB03K080                                                       
                 AB03K030                                                       
                 BR10K010                                                       
                 BR10K080                                                       
                 BR05K100                                                       
                 BC03K010                                                       
                 BC03K020                                                       
                 BB24K500                                                       
                 BB24K510                                                       
                 BB13K500                                                       
                 BB13K510                                                       
                 BP04K010                                                       
                 BP13F73A                                                       
                 BP13F73B.                                                      
                                                                                
           IF WS-K730-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING BP13K730 FILE ERROR ' WS-K730-STATUS             
              MOVE WS-K730-STATUS          TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-K757-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING BP13K730 FILE ERROR ' WS-K730-STATUS             
              MOVE WS-K757-STATUS          TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING BP13K813 FILE ERROR ' WS-K813-STATUS             
              MOVE WS-K813-STATUS          TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING BP13K825 FILE ERROR ' WS-K825-STATUS             
              MOVE WS-K825-STATUS          TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-K030-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING AB03K030 FILE ERROR ' WS-K030-STATUS             
              MOVE WS-K030-STATUS          TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-AB03K080-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING AB03K080 FILE ERROR ' WS-AB03K080-STATUS         
              MOVE WS-AB03K080-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BR10K010-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BR10K010 FILE ERROR ' WS-BR10K010-STATUS         
              MOVE WS-BR10K010-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BR10K080-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BR10K080 FILE ERROR ' WS-BR10K080-STATUS         
              MOVE WS-BR10K080-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BB24K500-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BB24K500 FILE ERROR ' WS-BB24K500-STATUS         
              MOVE WS-BB24K500-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BB24K510-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BB24K500 FILE ERROR ' WS-BB24K510-STATUS         
              MOVE WS-BB24K510-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BR05K100-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BR05K100 FILE ERROR ' WS-BR05K100-STATUS         
              MOVE WS-BR05K100-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BC03K010-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BC03K010 FILE ERROR ' WS-BC03K010-STATUS         
              MOVE WS-BC03K010-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BC03K020-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BC03K020 FILE ERROR ' WS-BC03K020-STATUS         
              MOVE WS-BC03K020-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BB13K500-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BB13K500 FILE ERROR ' WS-BB13K500-STATUS         
              MOVE WS-BB13K500-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BB13K510-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BB13K510 FILE ERROR ' WS-BB13K510-STATUS         
              MOVE WS-BB13K510-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-BP04K010-STATUS NOT = ZEROES AND 97                            
              DISPLAY 'CLOSING BP04K010 FILE ERROR ' WS-BP04K010-STATUS         
              MOVE WS-BP04K010-STATUS      TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
        9000-EXIT.                                                              
            EXIT.                                                               
                                                                                
