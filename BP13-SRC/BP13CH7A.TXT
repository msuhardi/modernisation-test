       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13CH7A.                                                  
       AUTHOR.       AM25.                                                      
       DATE-WRITTEN. 06/11/2023.                                                
      *****************************************************************         
      *                SOC - SYSTEM OF COMMITMENT (BP13)              *         
      *===============================================================*         
      *  OBJECTIVES   : GENERATE RAWDATA OF NEW NON-SELECTION LETTERS *         
      *                 AND NEW WAIVE LETTERS USING IOMS; B10, H10 &  *         
      *                 FTP FILES (BTO/SBF)                           *         
      *                                                               *         
      *  SUBROUTINE/S : AV02C001 - DATE CHECK - WEEKDAY               *         
      *                 AV02C002 - DATE CHECK - HOLIDAY               *         
      *                 AV02C015 - EXTRACT BARCODE                    *         
      *                                                               *         
      *  FORM ID : BP1331 - FT W/ 1 NS CNT & REL TO ST                *         
      *            BP1332 - FT W/ 1 NS CNT & REL TO ST                *         
      *                     (SELF-CANCELLATION)                       *         
      *            BP1333 - FT W/ 1 NS CNT AFT REL TO ST              *         
      *            BP1334 - FT W/ 1 NS CNT AFT REL TO ST              *         
      *                     (SELF-CANCELLATION)                       *         
      *            BP1335 - ST W/ 1 NS CNT & DEBAR 1YR                *         
      *            BP1336 - ST W/ 1 NS CNT & DEBAR 1YR                *         
      *                     (SELF-CANCELLATION)                       *         
      *            BP1337 - SINGLES W/ 1 NS CNT & DEBAR 1YR           *         
      *            BP1338 - SINGLES W/ 1 NS CNT & DEBAR 1YR           *         
      *                     (SELF-CANCELLATION)                       *         
      *            BP1339 - FT W/ WAIVER OF NS CNT                    *         
      *            BP133A - FT W/ WAIVER OF NS CNT                    *         
      *                     (SELF-CANCELLATION)                       *         
      *            BP133B - FT W/ WAIVER OF NS CNT AFT REL TO ST      *         
      *            BP133C - FT W/ WAIVER OF NS CNT AFT REL TO ST      *         
      *                     (SELF-CANCELLATION)                       *         
      *            BP133D - ST & SINGLES W/ WAIVER OF NS CNT          *         
      *            BP133E - ST & SINGLES W/ WAIVER OF NS CNT          *         
      *                     (SELF-CANCELLATION)                       *         
      *===============================================================*         
      * FILES DESCRIPTION :-                                          *         
      *                                                               *         
      *                ACCESS     REC                                 *         
      * DD NAME  I/O/E MODE       LEN  KEY FIELDS    REMARKS          *         
      * -------- ----- ---------- ---- ------------- ---------------- *         
      * SY02F001 I     SEQUENTIAL 80                                  *         
      * BP13F800 I     SEQUENTIAL 2000                                *         
      * BP13KH10 I     RANDOM     2000 KH10-KEY-FLD                   *         
      * BP13KH15 I     DYNAMIC    200  KH15-KEY-FLD                   *         
      * BP13K060 I     RANDOM     25   K060-KEY-FLD                   *         
      * BP13K246 I     RANDOM     80   K246-KEY-FLD                   *         
      * BP13K813 I     DYNAMIC    1000 K813-KEY-FLD                   *         
      * BP13K820 I     RANDOM     400  K820-KEY-FLD                   *         
      * BP13K830 I     RANDOM     250  K830-KEY-FLD                   *         
      * P13B1031 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1031 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1032 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1032 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1033 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1033 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1034 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1034 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1035 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1035 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1036 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1036 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1037 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1037 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1038 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1038 O     SEQUENTIAL 72                 IOMS             *         
      * P13B1039 O     SEQUENTIAL 1000               IOMS             *         
      * P13H1039 O     SEQUENTIAL 72                 IOMS             *         
      * P13B103A O     SEQUENTIAL 1000               IOMS             *         
      * P13H103A O     SEQUENTIAL 72                 IOMS             *         
      * P13B103B O     SEQUENTIAL 1000               IOMS             *         
      * P13H103B O     SEQUENTIAL 72                 IOMS             *         
      * P13B103C O     SEQUENTIAL 1000               IOMS             *         
      * P13H103C O     SEQUENTIAL 72                 IOMS             *         
      * P13B103D O     SEQUENTIAL 1000               IOMS             *         
      * P13H103D O     SEQUENTIAL 72                 IOMS             *         
      * P13B103E O     SEQUENTIAL 1000               IOMS             *         
      * P13H103E O     SEQUENTIAL 72                 IOMS             *         
      * BP13FTP  O     SEQUENTIAL 72                 IOMS             *         
      * BP13LH7A O     SEQUENTIAL 132                CTRL-LIST        *         
      *===============================================================*         
      * REVISION HISTORY :                                            *         
      *                                                               *         
      * CHG-REQ#  DDMMCCYY   BY   DESCRIPTION                         *         
      * --------  --------  ----  ----------------------------------- *         
      * BP139545  06112023  AM25  NEW PROGRAM (SIMILAR TO BP13CH07)   *         
      *****************************************************************         
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT SY02F001 ASSIGN      TO SY02F001.                             
           SELECT BP13F800 ASSIGN      TO BP13F800.                             
                                                                                
           SELECT BP13KH10 ASSIGN      TO BP13KH10                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS KH10-KEY-FLD                                     
              FILE STATUS   IS WS-KH10-STATUS.                                  
                                                                                
           SELECT BP13KH15 ASSIGN      TO BP13KH15                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS DYNAMIC                                          
              RECORD KEY    IS KH15-KEY-FLD                                     
              ALTERNATE KEY IS KH15-ALT-KEY                                     
              FILE STATUS   IS WS-KH15-STATUS.                                  
                                                                                
           SELECT BP13K060 ASSIGN      TO BP13K060                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K060-KEY-FLD                                     
              FILE STATUS   IS WS-K060-STATUS.                                  
                                                                                
           SELECT BP13K246 ASSIGN      TO BP13K246                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K246-KEY-FLD                                     
              FILE STATUS   IS WS-K246-STATUS.                                  
                                                                                
           SELECT BP13K813 ASSIGN      TO BP13K813                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS DYNAMIC                                          
              RECORD KEY    IS K813-KEY-FLD                                     
              FILE STATUS   IS WS-K813-STATUS.                                  
                                                                                
           SELECT BP13K820 ASSIGN      TO BP13K820                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K820-KEY-FLD                                     
              FILE STATUS   IS WS-K820-STATUS.                                  
                                                                                
           SELECT BP13K830 ASSIGN      TO BP13K830                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K830-KEY-FLD                                     
              ALTERNATE KEY IS K830-NUM-REGN                                    
              FILE STATUS   IS WS-K830-STATUS.                                  
                                                                                
           SELECT P13B1031 ASSIGN      TO P13B1031.                             
           SELECT P13H1031 ASSIGN      TO P13H1031.                             
           SELECT P13B1032 ASSIGN      TO P13B1032.                             
           SELECT P13H1032 ASSIGN      TO P13H1032.                             
           SELECT P13B1033 ASSIGN      TO P13B1033.                             
           SELECT P13H1033 ASSIGN      TO P13H1033.                             
           SELECT P13B1034 ASSIGN      TO P13B1034.                             
           SELECT P13H1034 ASSIGN      TO P13H1034.                             
           SELECT P13B1035 ASSIGN      TO P13B1035.                             
           SELECT P13H1035 ASSIGN      TO P13H1035.                             
           SELECT P13B1036 ASSIGN      TO P13B1036.                             
           SELECT P13H1036 ASSIGN      TO P13H1036.                             
           SELECT P13B1037 ASSIGN      TO P13B1037.                             
           SELECT P13H1037 ASSIGN      TO P13H1037.                             
           SELECT P13B1038 ASSIGN      TO P13B1038.                             
           SELECT P13H1038 ASSIGN      TO P13H1038.                             
           SELECT P13B1039 ASSIGN      TO P13B1039.                             
           SELECT P13H1039 ASSIGN      TO P13H1039.                             
           SELECT P13B103A ASSIGN      TO P13B103A.                             
           SELECT P13H103A ASSIGN      TO P13H103A.                             
           SELECT P13B103B ASSIGN      TO P13B103B.                             
           SELECT P13H103B ASSIGN      TO P13H103B.                             
           SELECT P13B103C ASSIGN      TO P13B103C.                             
           SELECT P13H103C ASSIGN      TO P13H103C.                             
           SELECT P13B103D ASSIGN      TO P13B103D.                             
           SELECT P13H103D ASSIGN      TO P13H103D.                             
           SELECT P13B103E ASSIGN      TO P13B103E.                             
           SELECT P13H103E ASSIGN      TO P13H103E.                             
           SELECT BP13FTP  ASSIGN      TO BP13FTP.                              
                                                                                
           SELECT BP13LH7A ASSIGN      TO BP13LH7A.                             
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD  BP13F800                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 2000 CHARACTERS                                      
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F800.                                                           
                                                                                
       FD  BP13KH10                                                             
           RECORD CONTAINS 2000 CHARACTERS.                                     
       COPY BP13KH10.                                                           
                                                                                
       FD  BP13KH15                                                             
           RECORD CONTAINS 200  CHARACTERS.                                     
       COPY BP13KH15.                                                           
                                                                                
       FD  BP13K060                                                             
           RECORD CONTAINS 25   CHARACTERS.                                     
       COPY BP13K060.                                                           
                                                                                
       FD  BP13K246                                                             
           RECORD CONTAINS 80   CHARACTERS.                                     
       COPY BP13K246.                                                           
                                                                                
       FD  BP13K813                                                             
           RECORD CONTAINS 1000 CHARACTERS.                                     
       COPY BP13K813.                                                           
                                                                                
       FD  BP13K820                                                             
           RECORD CONTAINS 400  CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD  BP13K830                                                             
           RECORD CONTAINS 250  CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD  P13B1031                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1031-REC                PIC X(1000).                             
                                                                                
       FD  P13H1031                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1031-REC                PIC X(72).                               
                                                                                
       FD  P13B1032                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1032-REC                PIC X(1000).                             
                                                                                
       FD  P13H1032                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1032-REC                PIC X(72).                               
                                                                                
       FD  P13B1033                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1033-REC                PIC X(1000).                             
                                                                                
       FD  P13H1033                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1033-REC                PIC X(72).                               
                                                                                
       FD  P13B1034                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1034-REC                PIC X(1000).                             
                                                                                
       FD  P13H1034                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1034-REC                PIC X(72).                               
                                                                                
       FD  P13B1035                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1035-REC                PIC X(1000).                             
                                                                                
       FD  P13H1035                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1035-REC                PIC X(72).                               
                                                                                
       FD  P13B1036                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1036-REC                PIC X(1000).                             
                                                                                
       FD  P13H1036                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1036-REC                PIC X(72).                               
                                                                                
       FD  P13B1037                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1037-REC                PIC X(1000).                             
                                                                                
       FD  P13H1037                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1037-REC                PIC X(72).                               
                                                                                
       FD  P13B1038                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1038-REC                PIC X(1000).                             
                                                                                
       FD  P13H1038                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1038-REC                PIC X(72).                               
                                                                                
       FD  P13B1039                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B1039-REC                PIC X(1000).                             
                                                                                
       FD  P13H1039                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H1039-REC                PIC X(72).                               
                                                                                
       FD  P13B103A                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B103A-REC                PIC X(1000).                             
                                                                                
       FD  P13H103A                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H103A-REC                PIC X(72).                               
                                                                                
       FD  P13B103B                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B103B-REC                PIC X(1000).                             
                                                                                
       FD  P13H103B                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H103B-REC                PIC X(72).                               
                                                                                
       FD  P13B103C                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B103C-REC                PIC X(1000).                             
                                                                                
       FD  P13H103C                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H103C-REC                PIC X(72).                               
                                                                                
       FD  P13B103D                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B103D-REC                PIC X(1000).                             
                                                                                
       FD  P13H103D                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H103D-REC                PIC X(72).                               
                                                                                
       FD  P13B103E                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13B103E-REC                PIC X(1000).                             
                                                                                
       FD  P13H103E                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13H103E-REC                PIC X(72).                               
                                                                                
       FD  BP13FTP                                                              
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  BP13FTP-REC                 PIC X(72).                               
                                                                                
       FD  BP13LH7A                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  BP13LH7A-REC                PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY P13FH10A.                                                           
       COPY P13PCH7A.                                                           
       COPY AV02COMM.                                                           
       COPY PRIOSCH.                                                            
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-KH10-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-KH15-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K060-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K246-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K813-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K820-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K830-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-MTH-IN               PIC X(2)        VALUE SPACES.            
           05  WS-MTH-OUT              PIC X(3)        VALUE SPACES.            
           05  WS-CURR-DATE            PIC 9(8)        VALUE ZEROES.            
           05  WS-NUM-DATE             PIC S9(9)       VALUE ZEROES.            
           05  WS-DTE-PRINT            PIC X(11)       VALUE SPACES.            
           05  WS-DTE-BAL-MTH-9        PIC X(9)        VALUE SPACES.            
           05  WS-GROUP-ID             PIC X(8)        VALUE SPACES.            
           05  WS-PRINT-SETTING        PIC X(1)        VALUE SPACES.            
           05  WS-CDE-HH               PIC X(1)        VALUE SPACES.            
           05  WS-CDE-BHH              PIC X(1)        VALUE SPACES.            
           05  WS-ALLOCSCH-TYPE        PIC X(3)        VALUE SPACES.            
           05  WS-ALLOC-TAG            PIC X(2)        VALUE SPACES.            
           05  WS-ALLOC-TAG-PREV       PIC X(2)        VALUE SPACES.            
           05  WS-NUM-NRIC             PIC X(9)        VALUE SPACES.            
           05  WS-NUM-MATURE           PIC X(1)        VALUE SPACES.            
           05  WS-NUM-STRIKE-FT        PIC 9(2)        VALUE ZEROES.            
           05  WS-NUM-STRIKE-ST        PIC 9(2)        VALUE ZEROES.            
           05  WS-NUM-STRIKE-FTS       PIC 9(2)        VALUE ZEROES.            
           05  WS-NUM-STRIKE-FTPMC     PIC 9(2)        VALUE ZEROES.            
           05  WS-DTE-DEBAR-FT-HH      PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-FT-HG      PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-ST         PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-FTS        PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-FTPMC      PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-EXP-FT-HH  PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-EXP-FT-HG  PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-EXP-ST     PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-EXP-FTS    PIC X(10)       VALUE SPACES.            
           05  WS-DTE-DEBAR-EXP-FTPMC  PIC X(10)       VALUE SPACES.            
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F001-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-F800-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-KH10-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-KH15-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K060-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K246-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K813-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K820-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K830-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-FH10-WRITE           PIC 9(6)        VALUE ZEROES.            
           05  WS-FB10-WRITE           PIC 9(6)        VALUE ZEROES.            
           05  WS-FTP-WRITE            PIC 9(6)        VALUE ZEROES.            
           05  WS-NOLTR-CNT            PIC 9(6)        VALUE ZEROES.            
           05  WS-BYPASS-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-B1031-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1032-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1033-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1034-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1035-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1036-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1037-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1038-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B1039-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B103A-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B103B-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B103C-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B103D-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-B103E-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-H1031-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1032-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1033-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1034-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1035-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1036-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1037-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1038-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H1039-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H103A-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H103B-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H103C-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H103D-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-H103E-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-BP1331-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1332-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1333-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1334-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1335-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1336-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1337-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1338-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1339-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP133A-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP133B-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP133C-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP133D-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP133E-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-LH7A-CNT             PIC 9(5)        VALUE ZEROES.            
           05  WS-LH7A-PAGE-CNT        PIC 9(5)        VALUE ZEROES.            
           05  WS-LH7A-LINE-CNT        PIC 9(2)        VALUE 60.                
           05  WS-CNT                  PIC 9(2)        VALUE ZEROES.            
                                                                                
       01  WS-SWITCHES-FLAGS.                                                   
           05  WS-F001-EOF             PIC X           VALUE 'N'.               
           05  WS-F800-EOF             PIC X           VALUE 'N'.               
           05  WS-KH15-EOF             PIC X           VALUE 'N'.               
           05  WS-KH15-FOUND           PIC X           VALUE 'N'.               
           05  WS-DATE-VALID           PIC X           VALUE 'N'.               
           05  WS-NUM-WITHIN-LIMIT     PIC X           VALUE 'N'.               
                                                                                
       01  WS-PARSING.                                                          
           05  WS-STRING-TO-PARSE      PIC X(70)       VALUE SPACES.            
           05  WS-PARSED-STRING        PIC X(70)       VALUE SPACES.            
           05  WS-STRING-LENGTH        PIC 9(3)        VALUE ZEROES.            
           05  WS-CUR-POS-SP           PIC 9(3)        VALUE ZEROES.            
           05  WS-CUR-POS-PS           PIC 9(3)        VALUE ZEROES.            
           05  WS-SPACE-FLAG           PIC X           VALUE 'N'.               
           05  WS-INSERT-SPACE-FLAG    PIC X           VALUE 'N'.               
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05  FILLER                  PIC X(12)       VALUE                    
               '01 JANUARY  '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '02 FEBRUARY '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '03 MARCH    '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '04 APRIL    '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '05 MAY      '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '06 JUNE     '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '07 JULY     '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '08 AUGUST   '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '09 SEPTEMBER'.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '10 OCTOBER  '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '11 NOVEMBER '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '12 DECEMBER '.                                                  
       01  FILLER REDEFINES WS-MONTHS-IN-DIGITS-AND-WORDS.                      
           05  WS-MONTH-TABLE OCCURS 12 INDEXED BY WS-MTH-IND.                  
               10  WS-MONTH-IN-DIGITS  PIC X(2).                                
               10  FILLER              PIC X(1).                                
               10  WS-MONTH-IN-WORDS   PIC X(9).                                
                                                                                
       01  WS-IOMS-VARIABLES.                                                   
           05  WS-UPD-TMESTAMP.                                                 
               10  WS-UPD-DATE         PIC X(8)        VALUE SPACES.            
               10  WS-UPD-TME          PIC X(8)        VALUE SPACES.            
           05  WS-FTP-DEST-REC.                                                 
               10  WS-FTP-JOBNAME      PIC X(8)        VALUE SPACES.            
               10  FILLER              PIC X           VALUE '_'.               
               10  WS-FTP-DESC         PIC X(6)        VALUE SPACES.            
               10  FILLER              PIC X           VALUE '_'.               
               10  WS-FTP-TMESTAMP     PIC X(12)       VALUE SPACES.            
           05  WS-P13FT10A-WRITE       PIC 9(7)        VALUE ZEROES.            
           05  WS-PARM.                                                         
               10  WS-PARM-JOBNAME     PIC X(8)        VALUE SPACES.            
               10  WS-PARM-B10-SOURCE  PIC X(70)       VALUE SPACES.            
               10  WS-PARM-H10-SOURCE  PIC X(70)       VALUE SPACES.            
                                                                                
       01  WS-BP13FTP-REC.                                                      
           05  WS-FTP-LINE1.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'CD /DATAFILE'.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE2.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'DIR         '.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE3.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'ASCII       '.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE4.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  WS-FTP-SOURCE       PIC X(70)       VALUE SPACES.            
           05  WS-FTP-LINE5.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'DIR         '.                                              
               10  FILLER              PIC X(66)       VALUE SPACES.            
           05  WS-FTP-LINE6.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'QUIT        '.                                              
               10  FILLER              PIC X(66)       VALUE SPACES.            
                                                                                
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE    PIC X(6)        VALUE SPACES.            
           05  AV02C015-OUT-POSTCODE-CHKSUM                                     
                                       PIC X(9)        VALUE SPACES.            
                                                                                
      *------------------------------------------------------------*            
      *    REPORT LAYOUT FOR CONTROL LISTINGS                      *            
      *------------------------------------------------------------*            
       01  LH7A-HDG1.                                                           
           05  LH7A-LISTING            PIC X(14)       VALUE 'BP13LH7A'.        
           05  FILLER                  PIC X(8)        VALUE 'HDB3'.            
           05  FILLER                  PIC X(18)       VALUE SPACES.            
           05  FILLER                  PIC X(39)       VALUE                    
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                  PIC X(18)       VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'DATE: '.          
           05  LH7A-DATE               PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(8)        VALUE ' PAGE: '.         
           05  LH7A-PAGE               PIC ZZZZ9.                               
           05  FILLER                  PIC X(5)        VALUE SPACES.            
                                                                                
       01  LH7A-HDG2.                                                           
           05  FILLER                  PIC X(41)       VALUE SPACES.            
           05  FILLER                  PIC X(37)       VALUE                    
               'CONTROL LIST FOR NON-SELECTION LETTER'.                         
           05  FILLER                  PIC X(54)       VALUE SPACES.            
                                                                                
       01  LH7A-HDG3.                                                           
           05  FILLER                  PIC X(48)       VALUE                    
               '   S/N REGN      HDB_REF     BALLOT ALO ZONE NT '.              
           05  FILLER                  PIC X(48)       VALUE                    
               ' FT CAT HH/BHH DTE_BK   QUEUE MOD EST APPLN APPL'.              
           05  FILLER                  PIC X(35)       VALUE                    
               'N  TAG TAG-P NRIC1     NRIC2     LT'.                           
           05  FILLER                  PIC X(3)        VALUE SPACES.            
                                                                                
       01  LH7A-HDG4.                                                           
           05  FILLER                  PIC X(29)       VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE 'DTE'.             
           05  FILLER                  PIC X(50)       VALUE SPACES.            
           05  FILLER                  PIC X(15)       VALUE                    
               'TAG  TAG  TAG-P'.                                               
           05  FILLER                  PIC X(35)       VALUE SPACES.            
                                                                                
       01  LH7A-DTL1.                                                           
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-SN                 PIC ZZZZ9.                               
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-REGN               PIC X(8)        VALUE SPACES.            
           05  LH7A-OVERSEA            PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-HDB-REF            PIC X(11)       VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-DTE-BAL            PIC X(6)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-ALLO-SCH           PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-ZONE               PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  LH7A-NT                 PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-FT                 PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  LH7A-CAT                PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  LH7A-HH                 PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE '/'.               
           05  LH7A-BALLOT-HH          PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  LH7A-DTE-BK             PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-QUEUE              PIC X(5)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-ALLO-CAT           PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  LH7A-NUM-MATURE         PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  LH7A-ALLOC-TAG          PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE SPACES.            
           05  LH7A-ALLOC-TAG-PREV     PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE SPACES.            
           05  LH7A-ALLOC-TAG-WS       PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  LH7A-ALLOC-TAG-PREV-WS  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  LH7A-NRIC1              PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-NRIC2              PIC X(9)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LH7A-LTR-TYPE           PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
                                                                                
       01  LH7A-FOOTER.                                                         
           05  FILLER                  PIC X(32)       VALUE                    
               ' "*" CASES WITH OVERSEA ADDRESS.'.                              
           05  FILLER                  PIC X(100)      VALUE SPACES.            
                                                                                
       01  LH7A-BLANK.                                                          
           05  FILLER                  PIC X(132)      VALUE SPACES.            
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
      *****************************************************************         
       0000-CONTROL.                                                            
      *****************************************************************         
                                                                                
           ACCEPT WS-PARM-JOBNAME.                                              
           ACCEPT WS-PARM-B10-SOURCE.                                           
           ACCEPT WS-PARM-H10-SOURCE.                                           
                                                                                
           PERFORM 1000-OPEN-FILES       THRU 1000-EXIT.                        
           PERFORM 2000-READ-BP13F800    THRU 2000-EXIT.                        
           PERFORM 3000-MAIN-PROCESSING  THRU 3000-EXIT                         
              UNTIL WS-F800-EOF = 'Y'.                                          
           PERFORM 8900-CREATE-FIOMS-REC THRU 8900-EXIT.                        
           PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT.                        
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1000-OPEN-FILES.                                                         
      *****************************************************************         
                                                                                
           OPEN INPUT  SY02F001                                                 
                       BP13F800                                                 
                       BP13KH10                                                 
                       BP13KH15                                                 
                       BP13K060                                                 
                       BP13K246                                                 
                       BP13K813                                                 
                       BP13K820                                                 
                       BP13K830                                                 
                OUTPUT P13B1031                                                 
                       P13H1031                                                 
                       P13B1032                                                 
                       P13H1032                                                 
                       P13B1033                                                 
                       P13H1033                                                 
                       P13B1034                                                 
                       P13H1034                                                 
                       P13B1035                                                 
                       P13H1035                                                 
                       P13B1036                                                 
                       P13H1036                                                 
                       P13B1037                                                 
                       P13H1037                                                 
                       P13B1038                                                 
                       P13H1038                                                 
                       P13B1039                                                 
                       P13H1039                                                 
                       P13B103A                                                 
                       P13H103A                                                 
                       P13B103B                                                 
                       P13H103B                                                 
                       P13B103C                                                 
                       P13H103C                                                 
                       P13B103D                                                 
                       P13H103D                                                 
                       P13B103E                                                 
                       P13H103E                                                 
                       BP13FTP                                                  
                       BP13LH7A.                                                
                                                                                
           CALL 'OAV02001' USING LINK-REC.                                      
                                                                                
           IF (WS-KH10-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13KH10 FAIL STATUS=' WS-KH10-STATUS               
              MOVE WS-KH10-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-KH15-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13KH15 FAIL STATUS=' WS-KH15-STATUS               
              MOVE WS-KH15-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K060-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K060 FAIL STATUS=' WS-K060-STATUS               
              MOVE WS-K060-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K246-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K246 FAIL STATUS=' WS-K246-STATUS               
              MOVE WS-K246-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K813-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K813 FAIL STATUS=' WS-K813-STATUS               
              MOVE WS-K813-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K820-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K820 FAIL STATUS=' WS-K820-STATUS               
              MOVE WS-K820-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K830-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K830 FAIL STATUS=' WS-K830-STATUS               
              MOVE WS-K830-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE  TO WS-UPD-TMESTAMP.                      
                                                                                
           PERFORM 1100-READ-SY02F001 THRU 1100-EXIT.                           
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1100-READ-SY02F001.                                                      
      *****************************************************************         
                                                                                
           READ SY02F001                                                        
              AT END                                                            
                 DISPLAY 'RECORD NOT FOUND IN SY02F001'                         
                 DISPLAY 'PROCESSING TERMINATED '                               
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
              NOT AT END                                                        
                 ADD 1                 TO WS-F001-READ                          
                                                                                
                 PERFORM 1200-FORMAT-DATE      THRU 1200-EXIT                   
                 PERFORM 1300-VALIDATE-DATE    THRU 1300-EXIT                   
                 PERFORM 1400-FORMAT-DTE-PRINT THRU 1400-EXIT                   
                                                                                
                 STRING F001-DTE-CURRENT(7:2) '/'                               
                        F001-DTE-CURRENT(5:2) '/'                               
                        F001-DTE-CURRENT(1:4)                                   
                    DELIMITED BY SIZE INTO LH7A-DATE                            
           END-READ.                                                            
                                                                                
       1100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1200-FORMAT-DATE.                                                        
      *****************************************************************         
                                                                                
           MOVE F001-DTE-CURRENT       TO WS-CURR-DATE.                         
                                                                                
           COMPUTE WS-NUM-DATE =                                                
                   FUNCTION INTEGER-OF-DATE(WS-CURR-DATE) + 1.                  
                                                                                
           COMPUTE WS-CURR-DATE =                                               
                   FUNCTION DATE-OF-INTEGER(WS-NUM-DATE).                       
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1300-VALIDATE-DATE.                                                      
      *****************************************************************         
                                                                                
           MOVE 'N'                    TO WS-DATE-VALID.                        
                                                                                
           PERFORM UNTIL WS-DATE-VALID = 'Y'                                    
                                                                                
              COMPUTE WS-CURR-DATE =                                            
                      FUNCTION DATE-OF-INTEGER(WS-NUM-DATE)                     
                                                                                
              PERFORM 1310-CHECK-WEEKDAY THRU 1310-EXIT                         
                                                                                
              IF WS-RETURN = 'SAT' OR 'SUN'                                     
                 COMPUTE WS-NUM-DATE = WS-NUM-DATE + 1                          
              ELSE                                                              
                 PERFORM 1320-CHECK-HOLIDAY THRU 1320-EXIT                      
                                                                                
                 IF WS-RETURN = 'HOL'                                           
                    COMPUTE WS-NUM-DATE = WS-NUM-DATE + 1                       
                 ELSE                                                           
                    MOVE 'Y'           TO WS-DATE-VALID                         
                 END-IF                                                         
              END-IF                                                            
                                                                                
           END-PERFORM.                                                         
                                                                                
       1300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1310-CHECK-WEEKDAY.                                                      
      *****************************************************************         
                                                                                
           MOVE 'DW'                   TO WS-IN-OPTION.                         
           MOVE WS-CURR-DATE           TO WS-IN-DATE.                           
                                                                                
           CALL 'AV02C001' USING LINK-REC.                                      
                                                                                
       1310-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1320-CHECK-HOLIDAY.                                                      
      *****************************************************************         
                                                                                
           MOVE 'HD'                    TO WS-IN-OPTION.                        
           MOVE WS-CURR-DATE            TO WS-IN-DATE.                          
                                                                                
           CALL 'AV02C002'  USING LINK-REC.                                     
                                                                                
           IF WS-RETURN = 'EOP' OR 'EID' OR 'EIF' OR 'EIR'                      
              DISPLAY 'ERROR IN READING HOLIDAY FILE, RETURN CODE IS '          
                      WS-RETURN                                                 
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
       1320-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1400-FORMAT-DTE-PRINT.                                                   
      *****************************************************************         
                                                                                
           MOVE WS-CURR-DATE(5:2)      TO WS-MTH-IN.                            
           PERFORM 1450-EVALUATE-MONTH THRU 1450-EXIT.                          
                                                                                
           STRING WS-CURR-DATE(7:2)                                             
                  ' '                                                           
                  WS-MTH-OUT                                                    
                  ' '                                                           
                  WS-CURR-DATE(1:4)                                             
              DELIMITED BY SIZE INTO WS-DTE-PRINT.                              
                                                                                
       1400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1450-EVALUATE-MONTH.                                                     
      *****************************************************************         
                                                                                
           EVALUATE WS-MTH-IN                                                   
              WHEN '01'                                                         
                 MOVE 'Jan'            TO WS-MTH-OUT                            
              WHEN '02'                                                         
                 MOVE 'Feb'            TO WS-MTH-OUT                            
              WHEN '03'                                                         
                 MOVE 'Mar'            TO WS-MTH-OUT                            
              WHEN '04'                                                         
                 MOVE 'Apr'            TO WS-MTH-OUT                            
              WHEN '05'                                                         
                 MOVE 'May'            TO WS-MTH-OUT                            
              WHEN '06'                                                         
                 MOVE 'Jun'            TO WS-MTH-OUT                            
              WHEN '07'                                                         
                 MOVE 'Jul'            TO WS-MTH-OUT                            
              WHEN '08'                                                         
                 MOVE 'Aug'            TO WS-MTH-OUT                            
              WHEN '09'                                                         
                 MOVE 'Sep'            TO WS-MTH-OUT                            
              WHEN '10'                                                         
                 MOVE 'Oct'            TO WS-MTH-OUT                            
              WHEN '11'                                                         
                 MOVE 'Nov'            TO WS-MTH-OUT                            
              WHEN '12'                                                         
                 MOVE 'Dec'            TO WS-MTH-OUT                            
           END-EVALUATE.                                                        
                                                                                
       1450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       2000-READ-BP13F800.                                                      
      *****************************************************************         
                                                                                
           READ BP13F800                                                        
              AT END                                                            
                 MOVE 'Y'              TO WS-F800-EOF                           
              NOT AT END                                                        
                 ADD 1                 TO WS-F800-READ                          
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3000-MAIN-PROCESSING.                                                    
      *****************************************************************         
                                                                                
           IF (F800-NUM-ALLO-CAT NOT = 'BTO' AND 'BE' AND 'SBF') OR             
              (F800-NUM-ALLOC-TAG NOT = 'SI' AND 'NI' AND 'RQ' AND              
                                        'LH' AND 'LI' AND 'LJ' AND              
                                        'LK' AND 'LL' AND 'WH' AND              
                                        'WI' AND 'WJ' AND 'WK' AND              
                                        'WL') OR                                
              (F800-DTE-BALLOT < '202310')                                      
              ADD 1                    TO WS-BYPASS-CNT                         
           ELSE                                                                 
              PERFORM 3100-GET-ALLO-SCH THRU 3100-EXIT                          
                                                                                
              IF WS-ALLOCSCH-TYPE = 'CCC'                                       
                 ADD 1                 TO WS-BYPASS-CNT                         
              ELSE                                                              
                 PERFORM 3200-PROCESS-LETTERS THRU 3200-EXIT                    
                 PERFORM 8000-PRT-CTRL-LH7A   THRU 8000-EXIT                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F800 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3100-GET-ALLO-SCH.                                                       
      *****************************************************************         
                                                                                
           SET WS-ALLOC-PTR            TO 1.                                    
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
              AT END                                                            
                 MOVE 'XXX'            TO WS-ALLOCSCH-TYPE                      
              WHEN F800-NUM-ALLO-SCHEME =                                       
                                WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)                 
                 MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR)                              
                                       TO WS-ALLOCSCH-TYPE                      
           END-SEARCH.                                                          
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3200-PROCESS-LETTERS.                                                    
      *****************************************************************         
                                                                                
           PERFORM 4000-PROCESS-B10-REC    THRU 4000-EXIT.                      
           PERFORM 6000-PREP-FOR-LTR-CHECK THRU 6000-EXIT.                      
                                                                                
           EVALUATE TRUE                                                        
      *-----> NON-SELECTION LETTERS                                             
              WHEN WS-ALLOC-TAG = 'LH' OR 'LI'                                  
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7010-BP1332 THRU 7010-EXIT                          
                 ELSE                                                           
                    PERFORM 7005-BP1331 THRU 7005-EXIT                          
                 END-IF                                                         
                                                                                
              WHEN WS-ALLOC-TAG = 'LJ'                                          
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7020-BP1334 THRU 7020-EXIT                          
                 ELSE                                                           
                    PERFORM 7015-BP1333 THRU 7015-EXIT                          
                 END-IF                                                         
                                                                                
              WHEN WS-ALLOC-TAG = 'LK'                                          
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7030-BP1336 THRU 7030-EXIT                          
                 ELSE                                                           
                    PERFORM 7025-BP1335 THRU 7025-EXIT                          
                 END-IF                                                         
                                                                                
              WHEN WS-ALLOC-TAG = 'LL'                                          
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7040-BP1338 THRU 7040-EXIT                          
                 ELSE                                                           
                    PERFORM 7035-BP1337 THRU 7035-EXIT                          
                 END-IF                                                         
                                                                                
      *-----> WAIVE LETTERS                                                     
              WHEN WS-ALLOC-TAG = 'WH' OR 'WI'                                  
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7050-BP133A THRU 7050-EXIT                          
                 ELSE                                                           
                    PERFORM 7045-BP1339 THRU 7045-EXIT                          
                 END-IF                                                         
                                                                                
              WHEN WS-ALLOC-TAG = 'WJ'                                          
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7060-BP133C THRU 7060-EXIT                          
                 ELSE                                                           
                    PERFORM 7055-BP133B THRU 7055-EXIT                          
                 END-IF                                                         
                                                                                
              WHEN WS-ALLOC-TAG = 'WK' OR 'WL'                                  
                 IF WS-ALLOC-TAG-PREV = 'RQ'                                    
                    PERFORM 7070-BP133E THRU 7070-EXIT                          
                 ELSE                                                           
                    PERFORM 7065-BP133D THRU 7065-EXIT                          
                 END-IF                                                         
                                                                                
              WHEN OTHER                                                        
                 ADD 1                 TO WS-NOLTR-CNT                          
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4000-PROCESS-B10-REC.                                                    
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO WS-P13PCH7A-B10-REC.                  
           INITIALIZE WS-P13PCH7A-B10-REC.                                      
                                                                                
           MOVE '_'                    TO WS-PCH7A-UNDERSCORE1                  
                                          WS-PCH7A-UNDERSCORE2                  
                                          WS-PCH7A-UNDERSCORE3.                 
           MOVE 'B10'                  TO WS-PCH7A-RECORD-TYPE.                 
           MOVE WS-PARM-JOBNAME        TO WS-PCH7A-JOBNAME.                     
           MOVE WS-UPD-TMESTAMP(1:12)  TO WS-PCH7A-TMESTAMP.                    
           MOVE F800-NUM-REGN          TO WS-PCH7A-NUM-REGNO.                   
           MOVE WS-DTE-PRINT           TO WS-PCH7A-DTE-PRINT.                   
                                                                                
           PERFORM 4100-GET-NME-HA    THRU 4100-EXIT.                           
           PERFORM 4200-READ-BP13K830 THRU 4200-EXIT.                           
           PERFORM 4300-GET-SUBJECT   THRU 4300-EXIT.                           
                                                                                
           PERFORM 5000-GET-FT-NT     THRU 5000-EXIT.                           
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4100-GET-NME-HA.                                                         
      *****************************************************************         
                                                                                
           MOVE F800-NUM-REGN          TO K820-NUM-REGN.                        
           MOVE F800-NUM-NRIC1         TO K820-NUM-NRIC.                        
           PERFORM 4150-READ-BP13K820 THRU 4150-EXIT.                           
           MOVE K820-NME-OCCP          TO WS-PCH7A-NME-HA1.                     
                                                                                
           IF (F800-NUM-NRIC2 = SPACES OR LOW-VALUES)                           
              CONTINUE                                                          
           ELSE                                                                 
              MOVE F800-NUM-NRIC2      TO K820-NUM-NRIC                         
              PERFORM 4150-READ-BP13K820 THRU 4150-EXIT                         
              MOVE K820-NME-OCCP       TO WS-PCH7A-NME-HA2                      
           END-IF.                                                              
                                                                                
           IF (F800-NUM-NRIC3 = SPACES OR LOW-VALUES)                           
              CONTINUE                                                          
           ELSE                                                                 
              MOVE F800-NUM-NRIC3      TO K820-NUM-NRIC                         
              PERFORM 4150-READ-BP13K820 THRU 4150-EXIT                         
              MOVE K820-NME-OCCP       TO WS-PCH7A-NME-HA3                      
           END-IF.                                                              
                                                                                
           IF (F800-NUM-NRIC4 = SPACES OR LOW-VALUES)                           
              CONTINUE                                                          
           ELSE                                                                 
              MOVE F800-NUM-NRIC4      TO K820-NUM-NRIC                         
              PERFORM 4150-READ-BP13K820 THRU 4150-EXIT                         
              MOVE K820-NME-OCCP       TO WS-PCH7A-NME-HA4                      
           END-IF.                                                              
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4150-READ-BP13K820.                                                      
      *****************************************************************         
                                                                                
           READ BP13K820.                                                       
                                                                                
           EVALUATE WS-K820-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K820-READ                          
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K820: ' K820-KEY-FLD             
                 MOVE SPACES           TO K820-NME-OCCP                         
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K820 FAIL STATUS=' WS-K820-STATUS            
                 MOVE WS-K820-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4200-READ-BP13K830.                                                      
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO LH7A-OVERSEA.                         
                                                                                
           MOVE F800-NUM-REGN          TO K830-NUM-REGN.                        
                                                                                
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K830-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                 ADD 1                 TO WS-K830-READ                          
                 PERFORM 4250-GET-ADDRESS THRU 4250-EXIT                        
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K830: ' K830-NUM-REGN            
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K830 FAIL STATUS=' WS-K830-STATUS            
                         ', KEY IS ' K830-NUM-REGN                              
           END-EVALUATE.                                                        
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4250-GET-ADDRESS.                                                        
      *****************************************************************         
                                                                                
           IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                   
              ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                              
               (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))                 
              MOVE K830-NUM-BLK        TO WS-PCH7A-BLK                          
                                                                                
              IF ((K830-NUM-LVL-NUM = SPACES OR LOW-VALUES)                     
              AND (K830-NUM-HSEMAIN = SPACES OR LOW-VALUES))                    
                 CONTINUE                                                       
              ELSE                                                              
                 MOVE K830-NUM-FLAT    TO WS-PCH7A-HSE-NO                       
              END-IF                                                            
                                                                                
              MOVE K830-NME-STREET-BLDG(1:47)                                   
                                       TO WS-PCH7A-STR-BLDG                     
                                                                                
              IF (K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES)             
                 MOVE '*'              TO LH7A-OVERSEA                          
                 DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL                  
                         ' FOR REC KEY-FLD ' K830-KEY-FLD                       
              ELSE                                                              
                 STRING 'SINGAPORE ' K830-NUM-POSTAL                            
                    DELIMITED BY SIZE INTO WS-PCH7A-POSTAL                      
              END-IF                                                            
                                                                                
              MOVE SPACES              TO WS-LINK-AV02C015                      
              MOVE K830-NUM-POSTAL     TO AV02C015-IN-POSTCODE                  
              CALL 'AV02C015' USING AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM                
              MOVE AV02C015-OUT-POSTCODE-CHKSUM                                 
                                       TO WS-PCH7A-BAR-CODE                     
           ELSE                                                                 
              MOVE K830-NUM-MAIL-BLK   TO WS-PCH7A-BLK                          
                                                                                
              IF ((K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES)                
              AND (K830-NUM-MAIL-HSEMAIN = SPACES OR LOW-VALUES))               
                 CONTINUE                                                       
              ELSE                                                              
                 MOVE K830-NUM-MAIL-FLAT                                        
                                       TO WS-PCH7A-HSE-NO                       
              END-IF                                                            
                                                                                
              MOVE K830-NME-MAIL-STR-BLDG(1:47)                                 
                                       TO WS-PCH7A-STR-BLDG                     
                                                                                
              IF (K830-NUM-MAIL-POSTAL = SPACES                                 
               OR LOW-VALUES OR ZEROES)                                         
                 MOVE '*'              TO LH7A-OVERSEA                          
                 DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL                 
                         ' FOR REC KEY-FLD ' K830-KEY-FLD                       
              ELSE                                                              
                 STRING 'SINGAPORE ' K830-NUM-MAIL-POSTAL                       
                    DELIMITED BY SIZE INTO WS-PCH7A-POSTAL                      
              END-IF                                                            
                                                                                
              MOVE SPACES              TO WS-LINK-AV02C015                      
              MOVE K830-NUM-MAIL-POSTAL                                         
                                       TO AV02C015-IN-POSTCODE                  
              CALL 'AV02C015' USING AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM                
              MOVE AV02C015-OUT-POSTCODE-CHKSUM                                 
                                       TO WS-PCH7A-BAR-CODE                     
           END-IF.                                                              
                                                                                
       4250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4300-GET-SUBJECT.                                                        
      *****************************************************************         
                                                                                
           IF F800-DTE-BALLOT NOT NUMERIC                                       
              MOVE ZEROES              TO F800-DTE-BALLOT                       
           END-IF.                                                              
                                                                                
           IF F800-DTE-BALLOT(5:2) < '01' OR                                    
              F800-DTE-BALLOT(5:2) > '12'                                       
              MOVE '01'                TO F800-DTE-BALLOT(5:2)                  
           END-IF.                                                              
                                                                                
           PERFORM 4350-SEARCH-MONTH THRU 4350-EXIT.                            
                                                                                
           EVALUATE F800-NUM-ALLO-CAT                                           
              WHEN 'BTO'                                                        
                 STRING 'APPLICATION FOR ' DELIMITED BY SIZE                    
                        WS-DTE-BAL-MTH-9 DELIMITED BY SPACES                    
                        ' ' F800-DTE-BALLOT(1:4) ' '                            
                        'BUILD-TO-ORDER (BTO) EXERCISE'                         
                    DELIMITED BY SIZE INTO WS-PCH7A-NUM-SUBJECT                 
              WHEN 'BE'                                                         
                 STRING 'APPLICATION FOR ' DELIMITED BY SIZE                    
                        WS-DTE-BAL-MTH-9 DELIMITED BY SPACES                    
                        ' ' F800-DTE-BALLOT(1:4) ' '                            
                        'BALLOTING EXERCISE'                                    
                    DELIMITED BY SIZE INTO WS-PCH7A-NUM-SUBJECT                 
              WHEN 'SBF'                                                        
                 STRING 'APPLICATION FOR ' DELIMITED BY SIZE                    
                        WS-DTE-BAL-MTH-9 DELIMITED BY SPACES                    
                        ' ' F800-DTE-BALLOT(1:4) ' '                            
                        'SALE OF BALANCE FLATS EXERCISE'                        
                    DELIMITED BY SIZE INTO WS-PCH7A-NUM-SUBJECT                 
              WHEN OTHER                                                        
                 CONTINUE                                                       
           END-EVALUATE.                                                        
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4350-SEARCH-MONTH.                                                       
      *****************************************************************         
                                                                                
           SET WS-MTH-IND              TO 1.                                    
           SEARCH WS-MONTH-TABLE                                                
              AT END                                                            
                 MOVE SPACES           TO WS-DTE-BAL-MTH-9                      
              WHEN WS-MONTH-IN-DIGITS(WS-MTH-IND) =                             
                                               F800-DTE-BALLOT(5:2)             
                 MOVE WS-MONTH-IN-WORDS(WS-MTH-IND)                             
                                       TO WS-DTE-BAL-MTH-9                      
           END-SEARCH.                                                          
                                                                                
       4350-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5000-GET-FT-NT.                                                          
      *****************************************************************         
                                                                                
           MOVE 'N'                    TO WS-NUM-MATURE.                        
                                                                                
           IF F800-NUM-NEW-TOWN = 'HG' AND                                      
              F800-DTE-BALLOT = '202108' AND                                    
              F800-AMT-HSE-INCOME > 7000 AND                                    
              F800-NUM-FLAT-TYPE = '3 '                                         
              MOVE 'KOVAN WELLSPRING'  TO WS-PCH7A-NUM-NEW-TOWN                 
           ELSE                                                                 
              IF F800-NUM-ALLO-CAT = 'BTO'                                      
                 PERFORM 5100-STARTBR-BP13K813 THRU 5100-EXIT                   
              ELSE                                                              
                 IF F800-NUM-ALLO-CAT = 'BE ' OR 'SBF'                          
                    MOVE 'Y'           TO WS-NUM-MATURE                         
                    PERFORM 5500-READ-BP13K060 THRU 5500-EXIT                   
                    PERFORM 5600-CHECK-F800-FT THRU 5600-EXIT                   
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5100-STARTBR-BP13K813.                                                   
      *****************************************************************         
                                                                                
           MOVE F800-NUM-BTO-ZONE      TO K813-NUM-ZONE.                        
           MOVE F800-NUM-FLAT-TYPE     TO K813-NUM-FLAT-TYPE.                   
                                                                                
           START BP13K813 KEY IS >= K813-KEY-FLD.                               
                                                                                
           EVALUATE WS-K813-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                 PERFORM 5150-READNEXT-BP13K813 THRU 5150-EXIT                  
              WHEN 10                                                           
              WHEN 23                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'STARTBR BP13K813 FAIL STATUS='                        
                                                 WS-K813-STATUS                 
                 MOVE WS-K813-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5150-READNEXT-BP13K813.                                                  
      *****************************************************************         
                                                                                
           READ BP13K813 NEXT RECORD.                                           
                                                                                
           EVALUATE WS-K813-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                 IF F800-NUM-BTO-ZONE  = K813-NUM-ZONE AND                      
                    F800-NUM-FLAT-TYPE = K813-NUM-FLAT-TYPE                     
                    ADD 1              TO WS-K813-READ                          
                    PERFORM 5155-PROCESS-K813 THRU 5155-EXIT                    
                 END-IF                                                         
              WHEN 10                                                           
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K813: ' K813-KEY-FLD             
              WHEN OTHER                                                        
                 DISPLAY 'READNEXT BP13K813 FAIL STATUS='                       
                                                    WS-K813-STATUS              
                 MOVE WS-K813-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       5150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5155-PROCESS-K813.                                                       
      *****************************************************************         
                                                                                
           MOVE K813-NME-SITE          TO WS-PCH7A-NUM-NEW-TOWN.                
                                                                                
           IF K813-NUM-MATURE-EST-TAG = 'Y'                                     
              MOVE 'Y'                 TO WS-NUM-MATURE                         
           END-IF.                                                              
                                                                                
           EVALUATE K813-NUM-FLAT-TYPE                                          
              WHEN '1A'                                                         
                 MOVE 'STUDIO APARTMENT'                                        
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN '3P'                                                         
                 MOVE '3-ROOM PREMIUM FLAT'                                     
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN '2F'                                                         
                 MOVE '2-ROOM FLEXI FLAT'                                       
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN '1F'                                                         
                 MOVE 'COMMUNITY CARE APT'                                      
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN OTHER                                                        
                 STRING K813-NUM-FLAT-TYPE(1:1)                                 
                        '-ROOM FLAT'                                            
                    DELIMITED BY SIZE INTO WS-PCH7A-NUM-FLAT-TYPE               
           END-EVALUATE.                                                        
                                                                                
           IF K813-NUM-GEN3-TAG  = 'Y'                                          
              MOVE '5-ROOM/3GEN FLAT'  TO WS-PCH7A-NUM-FLAT-TYPE                
           END-IF.                                                              
                                                                                
       5155-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5500-READ-BP13K060.                                                      
      *****************************************************************         
                                                                                
           MOVE 02                     TO K060-SERIAL-NO.                       
           MOVE F800-NUM-NEW-TOWN      TO K060-CODE.                            
                                                                                
           READ BP13K060.                                                       
                                                                                
           EVALUATE WS-K060-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K060-READ                          
                                                                                
                 PERFORM 5510-PROCESS-K060 THRU 5510-EXIT                       
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K060: ' K060-KEY-FLD             
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K060 FAIL STATUS=' WS-K060-STATUS            
                         ', KEY IS ' K060-KEY-FLD                               
           END-EVALUATE.                                                        
                                                                                
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5510-PROCESS-K060.                                                       
      *****************************************************************         
                                                                                
           IF F800-NUM-NEW-TOWN = 'CT' AND                                      
              (F800-DTE-BALLOT  = '200809' OR '200910')                         
              MOVE 'THE PINNACLE@DUXTON'                                        
                                       TO WS-PCH7A-NUM-NEW-TOWN                 
           ELSE                                                                 
              IF (F800-NUM-NEW-TOWN = 'JE' OR 'JW') AND                         
                 (F800-DTE-BALLOT = '201008') AND                               
                 (F800-NUM-ALLO-CAT = 'SBF')                                    
                 MOVE 'JURONG EAST/WEST'                                        
                                       TO WS-PCH7A-NUM-NEW-TOWN                 
              ELSE                                                              
                 MOVE K060-DESC(1:20)  TO WS-PCH7A-NUM-NEW-TOWN                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F800-NUM-NEW-TOWN = 'CT'                                          
              IF F800-DTE-BALLOT  = '200809' OR '200910' OR                     
                                    '201311' OR '201405'                        
                 IF F800-NUM-FLAT-TYPE = '4 '                                   
                    MOVE 'S1 APARTMENT'                                         
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                 ELSE                                                           
                    IF F800-NUM-FLAT-TYPE = '5 '                                
                       MOVE 'S2 APARTMENT'                                      
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF F800-DTE-BALLOT = '201209'                                  
                    IF F800-NUM-FLAT-TYPE = '4 '                                
                       MOVE '3-ROOM/S1 APT'                                     
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                    ELSE                                                        
                       IF F800-NUM-FLAT-TYPE = '5 '                             
                          MOVE 'S2 APARTMENT'                                   
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF F800-NUM-ALLO-CAT = 'SBF'                                      
                 PERFORM 5520-GET-SBF-FLAT-TYPE THRU 5520-EXIT                  
              ELSE                                                              
                  IF F800-NUM-FLAT-TYPE = '3P'                                  
                     MOVE '3-ROOM PREMIUM FLAT'                                 
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                  ELSE                                                          
                     STRING F800-NUM-FLAT-TYPE(1:1)                             
                            '-ROOM FLAT'                                        
                        DELIMITED BY SIZE INTO WS-PCH7A-NUM-FLAT-TYPE           
                  END-IF                                                        
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5510-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5520-GET-SBF-FLAT-TYPE.                                                  
      *****************************************************************         
                                                                                
           EVALUATE F800-NUM-FLAT-TYPE                                          
              WHEN '3P'                                                         
                 MOVE '3-ROOM PREMIUM FLAT'                                     
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN '2F'                                                         
                 MOVE '2-ROOM FLEXI FLAT'                                       
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN '1F'                                                         
                 MOVE 'COMMUNITY CARE APT'                                      
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN OTHER                                                        
                 STRING F800-NUM-FLAT-TYPE(1:1)                                 
                        '-ROOM FLAT'                                            
                    DELIMITED BY SIZE INTO WS-PCH7A-NUM-FLAT-TYPE               
           END-EVALUATE.                                                        
                                                                                
           PERFORM 5530-READ-BP13K246 THRU 5530-EXIT.                           
                                                                                
       5520-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5530-READ-BP13K246.                                                      
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO BP13K246-REC.                         
           INITIALIZE BP13K246-REC.                                             
                                                                                
           MOVE K060-DESC(1:20)        TO K246-NUM-NEW-TOWN.                    
                                                                                
           EVALUATE F800-NUM-FLAT-TYPE                                          
              WHEN '1A'                                                         
              WHEN '2A'                                                         
                 MOVE 'SA    '         TO K246-NUM-FLAT-TYPE                    
              WHEN '1F'                                                         
                 MOVE '1-ROOM'         TO K246-NUM-FLAT-TYPE                    
              WHEN '2 '                                                         
              WHEN '2F'                                                         
                 MOVE '2-ROOM'         TO K246-NUM-FLAT-TYPE                    
              WHEN '3 '                                                         
                 MOVE '3-ROOM'         TO K246-NUM-FLAT-TYPE                    
              WHEN '4 '                                                         
                 MOVE '4-ROOM'         TO K246-NUM-FLAT-TYPE                    
              WHEN '5 '                                                         
                 MOVE '5-ROOM'         TO K246-NUM-FLAT-TYPE                    
           END-EVALUATE.                                                        
                                                                                
           MOVE F800-DTE-BALLOT        TO K246-DTE-BALLOT.                      
                                                                                
           READ BP13K246.                                                       
                                                                                
           EVALUATE WS-K246-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K246-READ                          
                                                                                
                 PERFORM 5540-PROCESS-K246 THRU 5540-EXIT                       
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K246 FAIL STATUS=' WS-K246-STATUS            
                         ', KEY IS ' K246-KEY-FLD                               
                                                                                
                 EVALUATE F800-NUM-FLAT-TYPE                                    
                    WHEN '3P'                                                   
                       MOVE '3-ROOM PREMIUM FLAT'                               
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                    WHEN 'E '                                                   
                       MOVE 'EXECUTIVE FLAT'                                    
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                    WHEN '2F'                                                   
                       MOVE '2-ROOM FLEXI FLAT'                                 
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                    WHEN '1F'                                                   
                       MOVE 'COMMUNITY CARE APT'                                
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
                    WHEN OTHER                                                  
                       STRING F800-NUM-FLAT-TYPE(1:1)                           
                              '-ROOM FLAT'                                      
                          DELIMITED BY SIZE INTO WS-PCH7A-NUM-FLAT-TYPE         
                 END-EVALUATE                                                   
           END-EVALUATE.                                                        
                                                                                
       5530-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5540-PROCESS-K246.                                                       
      *****************************************************************         
                                                                                
           IF K246-COMBINED-FT NOT = SPACES AND LOW-VALUES                      
              IF K246-NUM-FT-TAG = 'N'                                          
                 MOVE SPACES           TO WS-STRING-TO-PARSE                    
                                                                                
                 STRING K246-COMBINED-FT(1:1) '/'                               
                        K246-NUM-FLAT-TYPE(1:6) ' FLAT'                         
                    DELIMITED BY SIZE INTO WS-STRING-TO-PARSE                   
                                                                                
                 MOVE LENGTH OF WS-STRING-TO-PARSE                              
                                       TO WS-STRING-LENGTH                      
                 MOVE 'Y'              TO WS-INSERT-SPACE-FLAG                  
                 PERFORM 5541-PARSE-STRING THRU 5541-EXIT                       
                 MOVE WS-PARSED-STRING TO WS-PCH7A-NUM-FLAT-TYPE                
              ELSE                                                              
                 MOVE SPACES           TO WS-STRING-TO-PARSE                    
                                                                                
                 STRING K246-NUM-FLAT-TYPE(1:6) '/ '                            
                        K246-COMBINED-FT(1:4) ' FLAT'                           
                    DELIMITED BY SIZE INTO WS-STRING-TO-PARSE                   
                                                                                
                 MOVE LENGTH OF WS-STRING-TO-PARSE                              
                                       TO WS-STRING-LENGTH                      
                 MOVE 'Y'              TO WS-INSERT-SPACE-FLAG                  
                 PERFORM 5541-PARSE-STRING THRU 5541-EXIT                       
                 MOVE WS-PARSED-STRING TO WS-PCH7A-NUM-FLAT-TYPE                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K246-COMBINED-NT NOT = SPACES AND LOW-VALUES                      
              IF K246-NUM-NT-TAG = 'Y'                                          
                 MOVE SPACES           TO WS-STRING-TO-PARSE                    
                                                                                
                 STRING K246-NUM-NEW-TOWN '/ '                                  
                        K246-COMBINED-NT                                        
                    DELIMITED BY SIZE INTO WS-STRING-TO-PARSE                   
                                                                                
                 MOVE LENGTH OF WS-STRING-TO-PARSE                              
                                       TO WS-STRING-LENGTH                      
                 MOVE 'Y'              TO WS-INSERT-SPACE-FLAG                  
                 PERFORM 5541-PARSE-STRING THRU 5541-EXIT                       
                 MOVE WS-PARSED-STRING TO WS-PCH7A-NUM-NEW-TOWN                 
              ELSE                                                              
                 MOVE SPACES           TO WS-STRING-TO-PARSE                    
                                                                                
                 STRING K246-COMBINED-NT '/ '                                   
                        K246-NUM-NEW-TOWN                                       
                    DELIMITED BY SIZE INTO WS-STRING-TO-PARSE                   
                                                                                
                 MOVE LENGTH OF WS-STRING-TO-PARSE                              
                                       TO WS-STRING-LENGTH                      
                 MOVE 'Y'              TO WS-INSERT-SPACE-FLAG                  
                 PERFORM 5541-PARSE-STRING THRU 5541-EXIT                       
                 MOVE WS-PARSED-STRING TO  WS-PCH7A-NUM-NEW-TOWN                
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5540-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5541-PARSE-STRING.                                                       
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO WS-PARSED-STRING.                     
                                                                                
           MOVE 1                      TO WS-CUR-POS-PS.                        
           ADD  1                      TO WS-STRING-LENGTH.                     
           PERFORM 5542-GET-CHAR THRU 5542-EXIT                                 
              VARYING WS-CUR-POS-SP FROM 1 BY 1                                 
                UNTIL WS-CUR-POS-SP = WS-STRING-LENGTH.                         
                                                                                
       5541-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5542-GET-CHAR.                                                           
      *****************************************************************         
                                                                                
           IF WS-STRING-TO-PARSE(WS-CUR-POS-SP:1) NOT = SPACES                  
              IF WS-SPACE-FLAG = 'Y' AND                                        
                 WS-INSERT-SPACE-FLAG = 'Y' AND                                 
                 WS-PARSED-STRING NOT = SPACES                                  
                 MOVE ' '              TO WS-PARSED-STRING                      
                                                      (WS-CUR-POS-PS:1)         
                 ADD 1                 TO  WS-CUR-POS-PS                        
              END-IF                                                            
                                                                                
              MOVE WS-STRING-TO-PARSE(WS-CUR-POS-SP:1)                          
                                       TO WS-PARSED-STRING                      
                                                      (WS-CUR-POS-PS:1)         
                                                                                
              ADD 1                    TO WS-CUR-POS-PS                         
              MOVE 'N'                 TO WS-SPACE-FLAG                         
           ELSE                                                                 
              MOVE 'Y'                 TO WS-SPACE-FLAG                         
           END-IF.                                                              
                                                                                
       5542-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5600-CHECK-F800-FT.                                                      
      *****************************************************************         
                                                                                
           EVALUATE F800-NUM-FLAT-TYPE                                          
              WHEN '1A'                                                         
                 MOVE 'STUDIO APARTMENT'                                        
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN '2F'                                                         
                 MOVE '2-ROOM FLEXI FLAT'                                       
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
              WHEN '1F'                                                         
                 MOVE 'COMMUNITY CARE APT'                                      
                                       TO WS-PCH7A-NUM-FLAT-TYPE                
           END-EVALUATE.                                                        
                                                                                
           IF F800-NUM-GEN3  = 'Y'                                              
              MOVE '5-ROOM/3GEN FLAT'  TO WS-PCH7A-NUM-FLAT-TYPE                
           END-IF.                                                              
                                                                                
       5600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6000-PREP-FOR-LTR-CHECK.                                                 
      *****************************************************************         
                                                                                
           MOVE F800-NUM-HOUSEHOLD     TO WS-CDE-HH.                            
           MOVE F800-CDE-BALLOT-HOUSEHOLD                                       
                                       TO WS-CDE-BHH.                           
                                                                                
      * TREAT RELEGATED TO 2ND TIMER AS 1ST TIMERS                              
           IF WS-CDE-HH = 'G' AND WS-CDE-BHH = 'F' AND                          
              F800-NUM-FT2T = 'Y'                                               
              MOVE 'H'                 TO WS-CDE-HH                             
                                          WS-CDE-BHH                            
           END-IF.                                                              
                                                                                
           IF WS-CDE-HH = 'G' AND WS-CDE-BHH = 'G' AND                          
              F800-NUM-FT2T = 'Y'                                               
              MOVE 'H'                 TO WS-CDE-HH                             
              MOVE 'G'                 TO WS-CDE-BHH                            
           END-IF.                                                              
                                                                                
           IF WS-CDE-BHH = 'N' OR F800-NUM-NTIMER = 'Y'                         
              MOVE 'G'                 TO WS-CDE-BHH                            
           END-IF.                                                              
                                                                                
           PERFORM 6100-PROCESS-DEBAR   THRU 6100-EXIT.                         
           PERFORM 6200-GET-BOOK-STATUS THRU 6200-EXIT.                         
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6100-PROCESS-DEBAR.                                                      
      *****************************************************************         
                                                                                
           MOVE ZEROES                 TO WS-NUM-STRIKE-FT                      
                                          WS-NUM-STRIKE-ST                      
                                          WS-NUM-STRIKE-FTS                     
                                          WS-NUM-STRIKE-FTPMC.                  
           MOVE SPACES                 TO WS-DTE-DEBAR-FT-HH                    
                                          WS-DTE-DEBAR-FT-HG                    
                                          WS-DTE-DEBAR-ST                       
                                          WS-DTE-DEBAR-FTS                      
                                          WS-DTE-DEBAR-FTPMC                    
                                          WS-DTE-DEBAR-EXP-FT-HH                
                                          WS-DTE-DEBAR-EXP-FT-HG                
                                          WS-DTE-DEBAR-EXP-ST                   
                                          WS-DTE-DEBAR-EXP-FTS                  
                                          WS-DTE-DEBAR-EXP-FTPMC.               
                                                                                
           MOVE F800-NUM-NRIC1         TO WS-NUM-NRIC.                          
           PERFORM 6110-READ-BP13KH10 THRU 6110-EXIT.                           
                                                                                
           IF F800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC2      TO WS-NUM-NRIC                           
              PERFORM 6110-READ-BP13KH10 THRU 6110-EXIT                         
           END-IF.                                                              
                                                                                
           IF F800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC3      TO WS-NUM-NRIC                           
              PERFORM 6110-READ-BP13KH10 THRU 6110-EXIT                         
           END-IF.                                                              
                                                                                
           IF F800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC4      TO WS-NUM-NRIC                           
              PERFORM 6110-READ-BP13KH10 THRU 6110-EXIT                         
           END-IF.                                                              
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6110-READ-BP13KH10.                                                      
      *****************************************************************         
                                                                                
           MOVE WS-NUM-NRIC            TO KH10-KEY-FLD.                         
                                                                                
           READ BP13KH10.                                                       
                                                                                
           EVALUATE WS-KH10-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-KH10-READ                          
                                                                                
                 IF KH10-NUM-NON-SELN-FT    > WS-NUM-STRIKE-FT  OR              
                    KH10-NUM-NON-SELN-ST    > WS-NUM-STRIKE-ST  OR              
                    KH10-NUM-NON-SELN-FTS   > WS-NUM-STRIKE-FTS OR              
                    KH10-NUM-NON-SELN-FTPMC > WS-NUM-STRIKE-FTPMC               
                    PERFORM 6120-FORMAT-1ST-TIMER THRU 6120-EXIT                
                    PERFORM 6130-FORMAT-2ND-TIMER THRU 6130-EXIT                
                    PERFORM 6140-FORMAT-SINGLES   THRU 6140-EXIT                
                    PERFORM 6150-FORMAT-FTPMC     THRU 6150-EXIT                
                 END-IF                                                         
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13KH10: ' KH10-KEY-FLD             
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13KH10 FAIL STATUS=' WS-KH10-STATUS            
                         ', KEY IS ' KH10-KEY-FLD                               
           END-EVALUATE.                                                        
                                                                                
       6110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6120-FORMAT-1ST-TIMER.                                                   
      *****************************************************************         
                                                                                
      *--->FT 02                                                                
           IF KH10-DTE-DEBAR-FT-HH NOT = SPACES AND LOW-VALUES                  
              STRING KH10-DTE-DEBAR-FT-HH(7:2) '/'                              
                     KH10-DTE-DEBAR-FT-HH(5:2) '/'                              
                     KH10-DTE-DEBAR-FT-HH(1:4)                                  
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-FT-HH                      
           END-IF.                                                              
                                                                                
           IF KH10-DTE-DEBAR-EXPIRY-FT-HH NOT = SPACES AND LOW-VALUES           
              STRING KH10-DTE-DEBAR-EXPIRY-FT-HH(7:2) '/'                       
                     KH10-DTE-DEBAR-EXPIRY-FT-HH(5:2) '/'                       
                     KH10-DTE-DEBAR-EXPIRY-FT-HH(1:4)                           
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-FT-HH                  
           END-IF.                                                              
                                                                                
      *--->FT 04                                                                
           IF KH10-DTE-DEBAR-FT-HG NOT = SPACES AND LOW-VALUES                  
              STRING KH10-DTE-DEBAR-FT-HG(7:2) '/'                              
                     KH10-DTE-DEBAR-FT-HG(5:2) '/'                              
                     KH10-DTE-DEBAR-FT-HG(1:4)                                  
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-FT-HG                      
           END-IF.                                                              
                                                                                
           IF KH10-DTE-DEBAR-EXPIRY-FT-HG NOT = SPACES AND LOW-VALUES           
              STRING KH10-DTE-DEBAR-EXPIRY-FT-HG(7:2) '/'                       
                     KH10-DTE-DEBAR-EXPIRY-FT-HG(5:2) '/'                       
                     KH10-DTE-DEBAR-EXPIRY-FT-HG(1:4)                           
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-FT-HG                  
           END-IF.                                                              
                                                                                
           MOVE KH10-NUM-NON-SELN-FT   TO WS-NUM-STRIKE-FT.                     
                                                                                
       6120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6130-FORMAT-2ND-TIMER.                                                   
      *****************************************************************         
                                                                                
           IF KH10-DTE-DEBAR-ST NOT = SPACES AND LOW-VALUES                     
              STRING KH10-DTE-DEBAR-ST(7:2) '/'                                 
                     KH10-DTE-DEBAR-ST(5:2) '/'                                 
                     KH10-DTE-DEBAR-ST(1:4)                                     
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-ST                         
           END-IF.                                                              
                                                                                
           IF KH10-DTE-DEBAR-EXPIRY-ST NOT = SPACES AND LOW-VALUES              
              STRING KH10-DTE-DEBAR-EXPIRY-ST(7:2) '/'                          
                     KH10-DTE-DEBAR-EXPIRY-ST(5:2) '/'                          
                     KH10-DTE-DEBAR-EXPIRY-ST(1:4)                              
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-ST                     
           END-IF.                                                              
                                                                                
           MOVE KH10-NUM-NON-SELN-ST   TO WS-NUM-STRIKE-ST.                     
                                                                                
       6130-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6140-FORMAT-SINGLES.                                                     
      *****************************************************************         
                                                                                
           IF KH10-DTE-DEBAR-FTS NOT = SPACES AND LOW-VALUES                    
              STRING KH10-DTE-DEBAR-FTS(7:2) '/'                                
                     KH10-DTE-DEBAR-FTS(5:2) '/'                                
                     KH10-DTE-DEBAR-FTS(1:4)                                    
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-FTS                        
           END-IF.                                                              
                                                                                
           IF KH10-DTE-DEBAR-EXPIRY-FTS NOT = SPACES AND LOW-VALUES             
              STRING KH10-DTE-DEBAR-EXPIRY-FTS(7:2) '/'                         
                     KH10-DTE-DEBAR-EXPIRY-FTS(5:2) '/'                         
                     KH10-DTE-DEBAR-EXPIRY-FTS(1:4)                             
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-FTS                    
           END-IF.                                                              
                                                                                
           MOVE KH10-NUM-NON-SELN-FTS  TO WS-NUM-STRIKE-FTS.                    
                                                                                
       6140-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6150-FORMAT-FTPMC.                                                       
      *****************************************************************         
                                                                                
           IF KH10-DTE-DEBAR-FTPMC NOT = SPACES AND LOW-VALUES                  
              STRING KH10-DTE-DEBAR-FTPMC(7:2) '/'                              
                     KH10-DTE-DEBAR-FTPMC(5:2) '/'                              
                     KH10-DTE-DEBAR-FTPMC(1:4)                                  
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-FTPMC                      
           END-IF.                                                              
                                                                                
           IF KH10-DTE-DEBAR-EXPIRY-FTPMC NOT = SPACES AND LOW-VALUES           
              STRING KH10-DTE-DEBAR-EXPIRY-FTPMC(7:2) '/'                       
                     KH10-DTE-DEBAR-EXPIRY-FTPMC(5:2) '/'                       
                     KH10-DTE-DEBAR-EXPIRY-FTPMC(1:4)                           
                 DELIMITED BY SIZE INTO WS-DTE-DEBAR-EXP-FTPMC                  
           END-IF.                                                              
                                                                                
           MOVE KH10-NUM-NON-SELN-FTPMC                                         
                                       TO WS-NUM-STRIKE-FTPMC.                  
                                                                                
       6150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6200-GET-BOOK-STATUS.                                                    
      *****************************************************************         
                                                                                
           MOVE 'N'                    TO WS-KH15-FOUND                         
                                          WS-KH15-EOF                           
                                          WS-NUM-WITHIN-LIMIT.                  
           MOVE SPACES                 TO WS-ALLOC-TAG.                         
                                                                                
           IF F800-NUM-ALLOC-TAG = 'SI' OR 'NI' OR 'RQ'                         
              PERFORM 6250-STARTBR-BP13KH15 THRU 6250-EXIT                      
           ELSE                                                                 
              MOVE F800-NUM-ALLOC-TAG  TO WS-ALLOC-TAG                          
           END-IF.                                                              
                                                                                
           IF F800-NUM-ALLOC-TAG-PREV = SPACES OR LOW-VALUES                    
              IF F800-NUM-ALLOC-TAG = 'RQ'                                      
                 MOVE 'RQ'             TO WS-ALLOC-TAG-PREV                     
              ELSE                                                              
                 MOVE SPACES           TO WS-ALLOC-TAG-PREV                     
              END-IF                                                            
           ELSE                                                                 
              MOVE F800-NUM-ALLOC-TAG-PREV                                      
                                       TO WS-ALLOC-TAG-PREV                     
           END-IF.                                                              
                                                                                
           IF WS-KH15-FOUND = 'N'                                               
              IF BP13F800-MASTER(37:4) = 'CH16'                                 
                 MOVE BP13F800-MASTER(41:1)                                     
                                       TO WS-NUM-WITHIN-LIMIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6250-STARTBR-BP13KH15.                                                   
      *****************************************************************         
                                                                                
           MOVE F800-NUM-REGN          TO KH15-NUM-REGN.                        
                                                                                
           START BP13KH15 KEY IS >= KH15-ALT-KEY.                               
                                                                                
           EVALUATE WS-KH15-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                 PERFORM 6255-READNEXT-BP13KH15 THRU 6255-EXIT                  
                    UNTIL WS-KH15-FOUND = 'Y' OR                                
                          WS-KH15-EOF = 'Y'                                     
              WHEN 10                                                           
              WHEN 23                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'STARTBR BP13KH15 FAIL STATUS='                        
                                                 WS-KH15-STATUS                 
                 MOVE WS-KH15-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       6250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6255-READNEXT-BP13KH15.                                                  
      *****************************************************************         
                                                                                
           READ BP13KH15 NEXT RECORD.                                           
                                                                                
           EVALUATE WS-KH15-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                 IF KH15-NUM-REGN = F800-NUM-REGN                               
                    ADD 1              TO WS-KH15-READ                          
                                                                                
                    IF KH15-DTE-BK-APPMT = F800-DTE-BK-APPT AND                 
                       KH15-DTE-BALLOT  >= '202310'                             
                       MOVE KH15-NUM-WITHIN-LIMIT                               
                                       TO WS-NUM-WITHIN-LIMIT                   
                       MOVE KH15-NUM-ALLOC-TAG                                  
                                       TO WS-ALLOC-TAG                          
                       MOVE 'Y'        TO WS-KH15-FOUND                         
                    END-IF                                                      
                 ELSE                                                           
                    MOVE 'Y'           TO WS-KH15-EOF                           
                 END-IF                                                         
              WHEN 10                                                           
              WHEN 23                                                           
                 MOVE 'Y'              TO WS-KH15-EOF                           
              WHEN OTHER                                                        
                 DISPLAY 'READNEXT BP13KH15 FAIL STATUS='                       
                                                    WS-KH15-STATUS              
                 MOVE WS-KH15-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       6255-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7005-BP1331.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1031-SNO.                         
           MOVE WS-B1031-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1331'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           IF F800-NUM-FTPMC NOT = 'N' AND SPACES                               
              MOVE WS-DTE-DEBAR-FTPMC     TO WS-PCH7A-DTE-DEBAR-START           
           ELSE                                                                 
              MOVE WS-DTE-DEBAR-FT-HH     TO WS-PCH7A-DTE-DEBAR-START           
           END-IF.                                                              
                                                                                
           PERFORM 7500-GET-DTE-BK-APPM THRU 7500-EXIT.                         
                                                                                
           WRITE P13B1031-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1031-WRITE                        
                                          WS-BP1331-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7010-BP1332.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1032-SNO.                         
           MOVE WS-B1032-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1332'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE F800-NUM-NT-FT-QUEUE   TO WS-PCH7A-NUM-QUEUE.                   
                                                                                
           IF F800-NUM-FTPMC NOT = 'N' AND SPACES                               
              MOVE WS-DTE-DEBAR-FTPMC     TO WS-PCH7A-DTE-DEBAR-START           
           ELSE                                                                 
              MOVE WS-DTE-DEBAR-FT-HH     TO WS-PCH7A-DTE-DEBAR-START           
           END-IF.                                                              
                                                                                
           WRITE P13B1032-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1032-WRITE                        
                                          WS-BP1332-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7015-BP1333.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1033-SNO.                         
           MOVE WS-B1033-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1333'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE WS-DTE-DEBAR-FT-HG     TO WS-PCH7A-DTE-DEBAR-START.             
                                                                                
           PERFORM 7500-GET-DTE-BK-APPM THRU 7500-EXIT.                         
                                                                                
           WRITE P13B1033-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1033-WRITE                        
                                          WS-BP1333-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7015-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7020-BP1334.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1034-SNO.                         
           MOVE WS-B1034-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1334'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE F800-NUM-NT-FT-QUEUE   TO WS-PCH7A-NUM-QUEUE.                   
           MOVE WS-DTE-DEBAR-FT-HG     TO WS-PCH7A-DTE-DEBAR-START.             
                                                                                
           WRITE P13B1034-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1034-WRITE                        
                                          WS-BP1334-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7025-BP1335.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1035-SNO.                         
           MOVE WS-B1035-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1335'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE WS-DTE-DEBAR-ST        TO WS-PCH7A-DTE-DEBAR-START.             
           MOVE WS-DTE-DEBAR-EXP-ST    TO WS-PCH7A-DTE-DEBAR-EXPIRY.            
                                                                                
           PERFORM 7500-GET-DTE-BK-APPM THRU 7500-EXIT.                         
                                                                                
           WRITE P13B1035-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1035-WRITE                        
                                          WS-BP1335-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7025-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7030-BP1336.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1036-SNO.                         
           MOVE WS-B1036-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1336'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE F800-NUM-NT-FT-QUEUE   TO WS-PCH7A-NUM-QUEUE.                   
           MOVE WS-DTE-DEBAR-ST        TO WS-PCH7A-DTE-DEBAR-START.             
           MOVE WS-DTE-DEBAR-EXP-ST    TO WS-PCH7A-DTE-DEBAR-EXPIRY.            
                                                                                
           WRITE P13B1036-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1036-WRITE                        
                                          WS-BP1336-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7030-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7035-BP1337.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1037-SNO.                         
           MOVE WS-B1037-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1337'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE WS-DTE-DEBAR-FTS       TO WS-PCH7A-DTE-DEBAR-START.             
           MOVE WS-DTE-DEBAR-EXP-FTS   TO WS-PCH7A-DTE-DEBAR-EXPIRY.            
                                                                                
           PERFORM 7500-GET-DTE-BK-APPM THRU 7500-EXIT.                         
                                                                                
           WRITE P13B1037-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1037-WRITE                        
                                          WS-BP1337-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7035-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7040-BP1338.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1038-SNO.                         
           MOVE WS-B1038-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1338'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE F800-NUM-NT-FT-QUEUE   TO WS-PCH7A-NUM-QUEUE.                   
           MOVE WS-DTE-DEBAR-FTS       TO WS-PCH7A-DTE-DEBAR-START.             
           MOVE WS-DTE-DEBAR-EXP-FTS   TO WS-PCH7A-DTE-DEBAR-EXPIRY.            
                                                                                
           WRITE P13B1038-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1038-WRITE                        
                                          WS-BP1338-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7040-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7045-BP1339.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B1039-SNO.                         
           MOVE WS-B1039-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP1339'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
                                                                                
           PERFORM 7500-GET-DTE-BK-APPM THRU 7500-EXIT.                         
                                                                                
           WRITE P13B1039-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H1039-WRITE                        
                                          WS-BP1339-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7045-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7050-BP133A.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B103A-SNO.                         
           MOVE WS-B103A-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP133A'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE F800-NUM-NT-FT-QUEUE   TO WS-PCH7A-NUM-QUEUE.                   
                                                                                
           WRITE P13B103A-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H103A-WRITE                        
                                          WS-BP133A-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7055-BP133B.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B103B-SNO.                         
           MOVE WS-B103B-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP133B'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
                                                                                
           IF WS-DTE-DEBAR-FTPMC NOT = SPACES                                   
              MOVE WS-DTE-DEBAR-FTPMC  TO WS-PCH7A-DTE-DEBAR-START              
           ELSE                                                                 
              IF WS-DTE-DEBAR-FT-HH NOT = SPACES                                
                 MOVE WS-DTE-DEBAR-FT-HH                                        
                                       TO WS-PCH7A-DTE-DEBAR-START              
              ELSE                                                              
                 MOVE WS-DTE-DEBAR-FT-HG                                        
                                       TO WS-PCH7A-DTE-DEBAR-START              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 7500-GET-DTE-BK-APPM THRU 7500-EXIT.                         
                                                                                
           WRITE P13B103B-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H103B-WRITE                        
                                          WS-BP133B-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7055-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7060-BP133C.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B103C-SNO.                         
           MOVE WS-B103C-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP133C'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE F800-NUM-NT-FT-QUEUE   TO WS-PCH7A-NUM-QUEUE.                   
                                                                                
           IF WS-DTE-DEBAR-FTPMC NOT = SPACES                                   
              MOVE WS-DTE-DEBAR-FTPMC  TO WS-PCH7A-DTE-DEBAR-START              
           ELSE                                                                 
              IF WS-DTE-DEBAR-FT-HH NOT = SPACES                                
                 MOVE WS-DTE-DEBAR-FT-HH                                        
                                       TO WS-PCH7A-DTE-DEBAR-START              
              ELSE                                                              
                 MOVE WS-DTE-DEBAR-FT-HG                                        
                                       TO WS-PCH7A-DTE-DEBAR-START              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           WRITE P13B103C-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H103C-WRITE                        
                                          WS-BP133C-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7060-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7065-BP133D.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B103D-SNO.                         
           MOVE WS-B103D-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP133D'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
                                                                                
           WRITE P13B103D-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H103D-WRITE                        
                                          WS-BP133D-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7065-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7070-BP133E.                                                             
      *****************************************************************         
                                                                                
           ADD 1                       TO WS-B103E-SNO.                         
           MOVE WS-B103E-SNO           TO WS-PCH7A-NUM-SNO.                     
                                                                                
           MOVE 'BP133E'               TO WS-PCH7A-DESC                         
                                          WS-PCH7A-NUM-FORMID1.                 
           MOVE F800-NUM-NT-FT-QUEUE   TO WS-PCH7A-NUM-QUEUE.                   
                                                                                
           WRITE P13B103E-REC FROM WS-P13PCH7A-B10-REC.                         
           ADD 1                       TO WS-H103E-WRITE                        
                                          WS-BP133E-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       7070-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7500-GET-DTE-BK-APPM.                                                    
      *****************************************************************         
                                                                                
           IF F800-DTE-BK-APPT NOT NUMERIC                                      
              CONTINUE                                                          
           ELSE                                                                 
              IF F800-DTE-BK-APPT NOT = SPACES AND LOW-VALUES                   
                 STRING F800-DTE-BK-APPT(7:2) '/'                               
                        F800-DTE-BK-APPT(5:2) '/'                               
                        F800-DTE-BK-APPT(1:4)                                   
                    DELIMITED BY SIZE INTO WS-PCH7A-DTE-BK-APPM                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8000-PRT-CTRL-LH7A.                                                      
      *****************************************************************         
                                                                                
           IF WS-LH7A-LINE-CNT > 59                                             
              ADD 1                    TO WS-LH7A-PAGE-CNT                      
              MOVE WS-LH7A-PAGE-CNT    TO LH7A-PAGE                             
                                                                                
              WRITE BP13LH7A-REC FROM LH7A-HDG1 AFTER PAGE                      
              WRITE BP13LH7A-REC FROM LH7A-BLANK                                
              WRITE BP13LH7A-REC FROM LH7A-HDG2                                 
              WRITE BP13LH7A-REC FROM LH7A-BLANK                                
              WRITE BP13LH7A-REC FROM LH7A-BLANK                                
              WRITE BP13LH7A-REC FROM LH7A-HDG3                                 
              WRITE BP13LH7A-REC FROM LH7A-HDG4                                 
              WRITE BP13LH7A-REC FROM LH7A-BLANK                                
                                                                                
              MOVE 8                   TO WS-LH7A-LINE-CNT                      
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-LH7A-CNT.                          
           MOVE WS-LH7A-CNT            TO LH7A-SN.                              
                                                                                
           MOVE F800-NUM-REGN          TO LH7A-REGN.                            
           MOVE F800-NUM-SCH-ACC       TO LH7A-HDB-REF.                         
           MOVE F800-DTE-BALLOT        TO LH7A-DTE-BAL.                         
           MOVE F800-NUM-ALLO-SCHEME   TO LH7A-ALLO-SCH.                        
           MOVE F800-NUM-ZONE          TO LH7A-ZONE.                            
           MOVE F800-NUM-NEW-TOWN      TO LH7A-NT.                              
           MOVE F800-NUM-FLAT-TYPE     TO LH7A-FT.                              
           MOVE F800-NUM-CAT           TO LH7A-CAT.                             
           MOVE F800-NUM-HOUSEHOLD     TO LH7A-HH.                              
           MOVE F800-CDE-BALLOT-HOUSEHOLD                                       
                                       TO LH7A-BALLOT-HH.                       
                                                                                
           IF F800-DTE-BK-APPT = 'NOINVITE'                                     
              MOVE SPACES              TO LH7A-DTE-BK                           
           ELSE                                                                 
              MOVE F800-DTE-BK-APPT    TO LH7A-DTE-BK                           
           END-IF.                                                              
                                                                                
           MOVE F800-NUM-NT-FT-QUEUE   TO LH7A-QUEUE.                           
           MOVE F800-NUM-ALLO-CAT      TO LH7A-ALLO-CAT.                        
           MOVE F800-NUM-ALLOC-TAG     TO LH7A-ALLOC-TAG.                       
                                                                                
           IF F800-NUM-ALLO-CAT = 'BTO'                                         
              MOVE WS-NUM-MATURE       TO LH7A-NUM-MATURE                       
           ELSE                                                                 
              MOVE SPACES              TO LH7A-NUM-MATURE                       
           END-IF.                                                              
                                                                                
           MOVE F800-NUM-ALLOC-TAG-PREV                                         
                                       TO LH7A-ALLOC-TAG-PREV.                  
           MOVE WS-ALLOC-TAG           TO LH7A-ALLOC-TAG-WS.                    
           MOVE WS-ALLOC-TAG-PREV      TO LH7A-ALLOC-TAG-PREV-WS.               
           MOVE F800-NUM-NRIC1         TO LH7A-NRIC1.                           
           MOVE F800-NUM-NRIC2         TO LH7A-NRIC2.                           
                                                                                
           IF WS-PCH7A-NUM-FORMID1 = SPACES OR LOW-VALUES                       
              MOVE SPACES              TO LH7A-LTR-TYPE                         
           ELSE                                                                 
              MOVE WS-PCH7A-NUM-FORMID1(5:2)                                    
                                       TO LH7A-LTR-TYPE                         
           END-IF.                                                              
                                                                                
           WRITE BP13LH7A-REC FROM LH7A-DTL1.                                   
           ADD 1                       TO WS-LH7A-LINE-CNT.                     
                                                                                
           IF WS-LH7A-LINE-CNT = 59                                             
              WRITE BP13LH7A-REC FROM LH7A-FOOTER                               
              ADD 1                    TO WS-LH7A-LINE-CNT                      
           END-IF.                                                              
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8900-CREATE-FIOMS-REC.                                                   
      *****************************************************************         
                                                                                
           PERFORM 8910-WRITE-BP13FH10 THRU 8910-EXIT.                          
                                                                                
      * FTP                                                                     
           WRITE BP13FTP-REC FROM WS-FTP-LINE1.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE2.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE3.                                 
           ADD 3                       TO WS-FTP-WRITE.                         
                                                                                
           MOVE 'BP1331'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1332'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1333'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1334'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1335'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1336'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1337'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1338'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP1339'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP133A'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP133B'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP133C'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP133D'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           MOVE 'BP133E'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
                                                                                
           WRITE BP13FTP-REC FROM WS-FTP-LINE5.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE6.                                 
           ADD 2                       TO WS-FTP-WRITE.                         
                                                                                
       8900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8910-WRITE-BP13FH10.                                                     
      *****************************************************************         
                                                                                
           MOVE 'EAALST31'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1031-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1031-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1031-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST32'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1032-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1032-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1032-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST33'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1033-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1033-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1033-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST34'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1034-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1034-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1034-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST35'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1035-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1035-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1035-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST36'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1036-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1036-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1036-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST37'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1037-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1037-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1037-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST38'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1038-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1038-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1038-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST39'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H1039-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H1039-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H1039-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST3A'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H103A-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H103A-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H103A-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST3B'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H103B-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H103B-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H103B-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST3C'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H103C-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H103C-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H103C-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST3D'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H103D-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H103D-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H103D-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
           MOVE 'EAALST3E'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-H103E-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13H103E-REC FROM WS-P13FH10A-REC.                             
           WRITE P13H103E-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
       8910-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8915-POPULATE-FH10A.                                                     
      *****************************************************************         
                                                                                
      * H10                                                                     
           MOVE SPACES                 TO WS-P13FH10A-REC.                      
           INITIALIZE WS-P13FH10A-REC.                                          
                                                                                
           MOVE 'H10'                  TO WS-FH10-RECORD-TYPE.                  
           MOVE WS-PARM-JOBNAME        TO WS-FH10-JOBNAME.                      
           MOVE WS-UPD-TMESTAMP(1:14)  TO WS-FH10-JOBDATE.                      
           MOVE 'BP13W016'             TO WS-FH10-WFD-ID.                       
           MOVE 'Y'                    TO WS-FH10-OUTPUT-PRINT.                 
           MOVE WS-GROUP-ID            TO WS-FH10-GROUP-ID.                     
                                                                                
      * FEEDBACK FROM MOOI ON 18/5/2017                                         
      * IOMS NOT CATER FOR THE PRINTING OF 2 COPIES                             
      * USING PROGRAM TO TRIGGER TWICE INSTEAD                                  
      *    MOVE 2                      TO WS-FH10-COPIES.                       
      *                                                                         
           MOVE 1                      TO WS-FH10-COPIES.                       
           MOVE 'B'                    TO WS-FH10-COLOUR.                       
           MOVE 'A4W'                  TO WS-FH10-PAPER-TYPE.                   
           MOVE WS-PRINT-SETTING       TO WS-FH10-PRINT-SETTING.                
           MOVE 'N'                    TO WS-FH10-AMIS                          
                                          WS-FH10-OMR                           
                                          WS-FH10-OUTPUT-FILING                 
                                          WS-FH10-OUTPUT-ONEINBOX               
                                          WS-FH10-OUTPUT-SMS                    
                                          WS-FH10-OUTPUT-EMAIL                  
                                          WS-FH10-OUTPUT-FAX.                   
                                                                                
      * T10                                                                     
           MOVE SPACES                 TO WS-P13FT10A-REC.                      
           INITIALIZE WS-P13FT10A-REC.                                          
                                                                                
           MOVE 'T10'                  TO WS-FT10-RECORD-TYPE.                  
           MOVE WS-P13FT10A-WRITE      TO WS-FT10-TOTAL-ACCOUNTS.               
                                                                                
       8915-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8920-WRITE-BP13FTP-SRC.                                                  
      *****************************************************************         
                                                                                
           MOVE WS-PARM-JOBNAME        TO WS-FTP-JOBNAME.                       
           MOVE WS-UPD-TMESTAMP(1:12)  TO WS-FTP-TMESTAMP.                      
                                                                                
      * B10                                                                     
           MOVE SPACES                 TO  WS-FTP-SOURCE.                       
           STRING "PUT '"                                                       
                  WS-PARM-B10-SOURCE "." WS-FTP-DESC                            
                  "' "                                                          
                  WS-FTP-DEST-REC ".TXT"                                        
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                              
           END-STRING.                                                          
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                                 
           ADD 1                       TO WS-FTP-WRITE.                         
                                                                                
      * H10                                                                     
           MOVE SPACES                 TO WS-FTP-SOURCE.                        
           STRING "PUT '"                                                       
                  WS-PARM-H10-SOURCE "." WS-FTP-DESC                            
                  "' "                                                          
                  WS-FTP-DEST-REC ".H10"                                        
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                              
           END-STRING.                                                          
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                                 
           ADD 1                       TO WS-FTP-WRITE.                         
                                                                                
       8920-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       9000-CLOSE-FILES.                                                        
      *****************************************************************         
                                                                                
           IF WS-F800-READ > 0 AND                                              
              WS-LH7A-LINE-CNT NOT = 60                                         
              COMPUTE WS-CNT = 60 - WS-LH7A-LINE-CNT                            
                                                                                
              WRITE BP13LH7A-REC FROM LH7A-FOOTER AFTER WS-CNT                  
           END-IF.                                                              
                                                                                
           CLOSE SY02F001                                                       
                 BP13F800                                                       
                 BP13KH10                                                       
                 BP13KH15                                                       
                 BP13K060                                                       
                 BP13K246                                                       
                 BP13K813                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 P13B1031                                                       
                 P13H1031                                                       
                 P13B1032                                                       
                 P13H1032                                                       
                 P13B1033                                                       
                 P13H1033                                                       
                 P13B1034                                                       
                 P13H1034                                                       
                 P13B1035                                                       
                 P13H1035                                                       
                 P13B1036                                                       
                 P13H1036                                                       
                 P13B1037                                                       
                 P13H1037                                                       
                 P13B1038                                                       
                 P13H1038                                                       
                 P13B1039                                                       
                 P13H1039                                                       
                 P13B103A                                                       
                 P13H103A                                                       
                 P13B103B                                                       
                 P13H103B                                                       
                 P13B103C                                                       
                 P13H103C                                                       
                 P13B103D                                                       
                 P13H103D                                                       
                 P13B103E                                                       
                 P13H103E                                                       
                 BP13FTP                                                        
                 BP13LH7A.                                                      
                                                                                
           CALL 'CAV02001' USING LINK-REC.                                      
                                                                                
           IF WS-KH10-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13KH10 FAIL STATUS=' WS-KH10-STATUS              
              MOVE WS-KH10-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-KH15-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13KH15 FAIL STATUS=' WS-KH15-STATUS              
              MOVE WS-KH15-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K060-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K060 FAIL STATUS=' WS-K060-STATUS              
              MOVE WS-K060-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K246-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K246 FAIL STATUS=' WS-K246-STATUS              
              MOVE WS-K246-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K813 FAIL STATUS=' WS-K813-STATUS              
              MOVE WS-K813-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K820 FAIL STATUS=' WS-K820-STATUS              
              MOVE WS-K820-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K830 FAIL STATUS=' WS-K830-STATUS              
              MOVE WS-K830-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           DISPLAY '******************************'.                            
           DISPLAY '* PROGRAM BP13CH7A           *'.                            
           DISPLAY '* CONTROL COUNTS             *'.                            
           DISPLAY '*----------------------------*'.                            
           DISPLAY '* REC READ F001     : ' WS-F001-READ ' *'.                  
           DISPLAY '* REC READ F800     : ' WS-F800-READ ' *'.                  
           DISPLAY '* REC READ KH10     : ' WS-KH10-READ ' *'.                  
           DISPLAY '* REC READ KH15     : ' WS-KH15-READ ' *'.                  
           DISPLAY '* REC READ K060     : ' WS-K060-READ ' *'.                  
           DISPLAY '* REC READ K246     : ' WS-K246-READ ' *'.                  
           DISPLAY '* REC READ K813     : ' WS-K813-READ ' *'.                  
           DISPLAY '* REC READ K820     : ' WS-K820-READ ' *'.                  
           DISPLAY '* REC READ K830     : ' WS-K830-READ ' *'.                  
           DISPLAY '* REC WRITTEN FH10  : ' WS-FH10-WRITE ' *'.                 
           DISPLAY '* REC WRITTEN FB10  : ' WS-FB10-WRITE ' *'.                 
           DISPLAY '* REC WRITTEN FTP   : ' WS-FTP-WRITE ' *'.                  
           DISPLAY '* NO LETTER CASES   : ' WS-NOLTR-CNT ' *'.                  
           DISPLAY '* BYPASS CASES      : ' WS-BYPASS-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1331  : ' WS-BP1331-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1332  : ' WS-BP1332-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1333  : ' WS-BP1333-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1334  : ' WS-BP1334-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1335  : ' WS-BP1335-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1336  : ' WS-BP1336-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1337  : ' WS-BP1337-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1338  : ' WS-BP1338-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1339  : ' WS-BP1339-CNT ' *'.                 
           DISPLAY '* CASES FOR BP133A  : ' WS-BP133A-CNT ' *'.                 
           DISPLAY '* CASES FOR BP133B  : ' WS-BP133B-CNT ' *'.                 
           DISPLAY '* CASES FOR BP133C  : ' WS-BP133C-CNT ' *'.                 
           DISPLAY '* CASES FOR BP133D  : ' WS-BP133D-CNT ' *'.                 
           DISPLAY '* CASES FOR BP133E  : ' WS-BP133E-CNT ' *'.                 
           DISPLAY '******************************'.                            
                                                                                
       9000-EXIT.                                                               
           STOP RUN.                                                            
           EXIT.                                                                
                                                                                
      *======================  END OF PROGRAM  ======================*          
