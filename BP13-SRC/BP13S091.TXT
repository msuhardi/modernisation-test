  /*******************************************************************/         
  /* SYSTEM OF COMMITMENT (BP13)                                     */         
  /*=================================================================*/         
  /* OBJECTIVES :                                                    */         
  /* PRINT REPORT ON DEATH-CASES AND RENUNCIATION OF PR CASES BY     */         
  /* MATCHING NRIC IN SOC OCCUPIER FILE WITH CDB BROADCAST FILE      */         
  /* DO NOT PRINT IF NOT FOUND IN BP13K800 OR CANCELLED CASES        */         
  /*                                                                 */         
  /* TO PRINT REPORTS                                                */         
  /*  1. P13L091A - MONTHLY REPORT ON RENUNCIATION (BEFORE SHORTLIST)*/         
  /*  2. P13L091B - MONTHLY REPORT ON RENUNCIATION (BEFORE BOOKING)  */         
  /*  3. P13L091C - MONTHLY REPORT ON RENUNCIATION (BEFORE SA)       */         
  /*  4. P13L091D - MONTHLY REPORT ON RENUNCIATION (AFTER SA)        */         
  /*                                                                 */         
  /*  5. P13L091E - MONTHLY REPORT ON DESEASED APPL(BEFORE SHORTLIST)*/         
  /*  6. P13L091F - MONTHLY REPORT ON DESEASED APPL(BEFORE BOOKING)  */         
  /*  7. P13L091G - MONTHLY REPORT ON DESEASED APPL(BEFORE SA)       */         
  /*  8. P13L091H - MONTHLY REPORT ON DESEASED APPL(AFTER SA)        */         
  /*                                                                 */         
  /*-----------------------------------------------------------------*/         
  /* CHGE     DATE     BY   DESCRIPTION                              */         
  /* -------  -------- ---- -----------                              */         
  /* BP130851 20000803 SRN  NEW PROGRAM                              */         
  /* BP132449 20040210 JF4  CHANGE TITLE FOR P13L091C                */         
  /*******************************************************************/         
   OPTIONS NODATE NONUMBER;                                                     
                                                                                
   DATA BP13F820;                                                               
      INFILE BP13F820;                                                          
      INPUT @1   REGN      $CHAR8.                                              
            @9   NRIC      $CHAR9.                                              
            @28  NAME      $CHAR30.                                             
            @235 DTE_REN   $CHAR8.                                              
            @243 DTE_DTH   $CHAR8.                                              
            ;                                                                   
            IF DTE_DTH = '        ' THEN                                        
               DTEPRT = DTE_REN;                                                
            ELSE                                                                
               DTEPRT = DTE_DTH;                                                
   PROC SORT;                                                                   
      BY REGN;                                                                  
                                                                                
   DATA BP13F800;                                                               
   SET BP13F820;BY REGN;                                                        
     IF FIRST.REGN THEN                                                         
        DO;                                                                     
         LENGTH K800KEY $8.;                                                    
         K800KEY = REGN;                                                        
         INFILE BP13K800 VSAM KEY=K800KEY;                                      
         INPUT @;                                                               
         RC=_IORC_; FBC=_FDBK_;                                                 
         IF RC=0 THEN                                                           
         DO;                                                                    
            INPUT @1   APP_ST   $CHAR1.                                         
                  @4   REGN     $CHAR8.                                         
                  @88  HANRIC1  $CHAR9.                                         
                  @97  HANRIC2  $CHAR9.                                         
                  @106 HANRIC3  $CHAR9.                                         
                  @115 HANRIC4  $CHAR9.                                         
                  @49  ZONE     $CHAR2.                                         
                  @51  NT       $CHAR3.                                         
                  @30  FT       $CHAR2.                                         
                  @155 HDBREF   $CHAR11.                                        
                  @459 DTE_SA   $CHAR8.                                         
                  @284 DTE_REC  $CHAR8.                                         
                  @785 DTE_BALT $CHAR6.;                                        
                                                                                
                  IF APP_ST ^= 'C' THEN                                         
                     OUTPUT BP13F800;                                           
           END;                                                                 
                                                                                
         ELSE                                                                   
            DO;                                                                 
               _ERROR_=0;                                                       
               FILE LOG;                                                        
               PUT @1 'REGNNO NOT FOUND IN BP13K800 ' K800KEY;                  
            END;                                                                
                                                                                
     END;                                                                       
                                                                                
   PROC PRINT DATA=BP13F800;                                                    
                                                                                
   DATA P13F820A P13F820B P13F820C P13F820D                                     
        P13F820E P13F820F P13F820G P13F820H;                                    
   MERGE BP13F800(IN=A) BP13F820(IN=B); BY REGN;                                
         IF A AND B THEN                                                        
            DO;                                                                 
               IF NRIC = HANRIC1 OR                                             
                  NRIC = HANRIC2 OR                                             
                  NRIC = HANRIC3 OR                                             
                  NRIC = HANRIC4  THEN                                          
                  STAT='APPLICANT';                                             
               ELSE                                                             
                  STAT='OCCUPIER';                                              
                                                                                
               IF DTE_BALT = '      ' THEN                                      
               /* BEFORE SHORTLISTING */                                        
                  DO;                                                           
                    IF DTE_DTH = '        ' THEN                                
                        OUTPUT P13F820A;                                        
                    ELSE                                                        
                        OUTPUT P13F820E;                                        
                  END;                                                          
               ELSE                                                             
                  IF DTE_BALT ^= '      ' AND                                   
                     HDBREF = '           ' THEN                                
               /* AFTER SHORTLISTING BEFORE BOOKING */                          
                    DO;                                                         
                      IF DTE_DTH = '        ' THEN                              
                          OUTPUT P13F820B;                                      
                      ELSE                                                      
                          OUTPUT P13F820F;                                      
                    END;                                                        
                  ELSE                                                          
                     IF HDBREF ^= '           ' AND                             
                        DTE_SA = '       ' THEN                                 
               /* AFTER BOOKING BEFORE SA */                                    
                        DO;                                                     
                          IF DTE_DTH = '        ' THEN                          
                              OUTPUT P13F820C;                                  
                          ELSE                                                  
                              OUTPUT P13F820G;                                  
                        END;                                                    
                     ELSE                                                       
                        IF DTE_SA ^= '       ' THEN                             
               /* AFTER SA BEFORE TP */                                         
                           DO;                                                  
                             IF DTE_DTH = '        ' THEN                       
                                 OUTPUT P13F820D;                               
                             ELSE                                               
                                 OUTPUT P13F820H;                               
                           END;                                                 
            END;                                                                
   RUN;                                                                         
                                                                                
                                                                                
   /* PRINT P13L091A */                                                         
                                                                                
   DATA _NULLS_;                                                                
   SET P13F820A END=EOF;                                                        
      BY REGN;                                                                  
   FILE P13L091A HEADER=AHDR LINESLEFT=LL NOTITLES;                             
    SNOA+1;                                                                     
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    PUT @005  SNOA                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @099  DTE_PRT                                                           
       ;                                                                        
   RETURN;                                                                      
                                                                                
AHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
   PUT @001 'P13L091A'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON RENOUNCIATION APPLICANTS/OCCUPIERS'              
       @083 '(SOC/CDB)';                                                        
   PUT @040 '(APPLICATION BEFORE SHORTLISTING)';                                
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF RENOUNCIATION'                                            
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
RETURN;                                                                         
                                                                                
   /*        PRINT P13L091B           */                                        
                                                                                
   DATA _NULLS_;                                                                
   SET P13F820B END=EOF;                                                        
      BY REGN;                                                                  
   FILE P13L091B HEADER=BHDR LINESLEFT=LL NOTITLES;                             
    SNOB +1;                                                                    
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    PUT @005  SNOB                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @099  DTE_PRT                                                           
       ;                                                                        
   RETURN;                                                                      
                                                                                
BHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
                                                                                
   PUT @001 'P13L091B'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON RENOUNCIATION APPLICANTS/OCCUPIERS'              
       @083 '(SOC/CDB)';                                                        
   PUT @030 '(APPLICATION AFTER SHORTLISTING BEFORE BOOKING)';                  
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF RENOUNCIATION'                                            
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
   RETURN;                                                                      
                                                                                
                                                                                
   /*        PRINT P13L091C           */                                        
                                                                                
   DATA _NULLS_;                                                                
   SET P13F820C END=EOF;                                                        
      BY REGN;                                                                  
   FILE P13L091C HEADER=CHDR LINESLEFT=LL NOTITLES;                             
    SNOC+1;                                                                     
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    IF DTE_REC = '        ' OR '.' THEN                                         
       DTE_FLE = '          ';                                                  
    ELSE                                                                        
       DTE_FLE = SUBSTR(DTE_REC,7,2)||'-'||                                     
                 SUBSTR(DTE_REC,5,2)||'-'||                                     
                 SUBSTR(DTE_REC,1,4);                                           
                                                                                
    PUT @005  SNOC                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @101  DTE_PRT                                                           
        @120  DTE_FLE                                                           
       ;                                                                        
                                                                                
   RETURN;                                                                      
CHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
                                                                                
   PUT @001 'P13L091C'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON RENOUNCIATION APPLICANTS/OCCUPIERS'              
       @083 '(SOC/CDB)';                                                        
   PUT @030 '(APPLICATION AFTER BOOKING BEFORE SIGNING'                         
       @072 'AGREEMENT OF LEASE)';                                              
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       @120  'DATE FILE'                                                        
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF RENOUNCIATION'                                            
       @120  'RECEIVED'                                                         
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
   RETURN;                                                                      
                                                                                
   /*        PRINT P13L091D           */                                        
   DATA _NULLS_;                                                                
   SET P13F820D END=EOF;                                                        
   BY REGN;                                                                     
   FILE P13L091D HEADER=DHDR LINESLEFT=LL NOTITLES;                             
    SNOD+1;                                                                     
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    PUT @005  SNOD                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @099  DTE_PRT                                                           
       ;                                                                        
   RETURN;                                                                      
DHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
                                                                                
   PUT @001 'P13L091D'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON RENOUNCIATION APPLICANTS/OCCUPIERS'              
       @083 '(SOC/CDB)';                                                        
   PUT @030 '(APPLICATION AFTER SIGNING AGREEMENT OF LEASE BEFORE TP)';         
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF RENOUNCIATION'                                            
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
   RETURN;                                                                      
                                                                                
   /*        PRINT P13L091E           */                                        
   DATA _NULLS_;                                                                
   SET P13F820E END=EOF;                                                        
      BY REGN;                                                                  
   FILE P13L091E HEADER=EHDR LINESLEFT=LL NOTITLES;                             
    SNOE+1;                                                                     
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    PUT @005  SNOE                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @099  DTE_PRT                                                           
       ;                                                                        
      RETURN;                                                                   
                                                                                
EHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
                                                                                
   PUT @001 'P13L091E'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON DECEASED APPLICANTS/OCCUPIERS'                   
       @080 '(SOC/CDB)';                                                        
   PUT @040 '(APPLICATION BEFORE SHORTLISTING)';                                
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF DEATH'                                                    
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
   RETURN;                                                                      
                                                                                
   /*        PRINT P13L091F           */                                        
   DATA _NULLS_;                                                                
   SET P13F820F END=EOF;                                                        
      BY REGN;                                                                  
   FILE P13L091F HEADER=FHDR LINESLEFT=LL NOTITLES;                             
    SNOF+1;                                                                     
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    PUT @005  SNOF                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @099  DTE_PRT                                                           
       ;                                                                        
   RETURN;                                                                      
                                                                                
FHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
                                                                                
   PUT @001 'P13L091F'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON DECEASED APPLICANTS/OCCUPIERS'                   
       @080 '(SOC/CDB)';                                                        
   PUT @030 '(APPLICATION AFTER SHORTLISTING BEFORE BOOKING)';                  
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF DEATH'                                                    
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
   RETURN;                                                                      
                                                                                
   /*        PRINT P13L091G           */                                        
   DATA _NULLS_;                                                                
   SET P13F820G END=EOF;                                                        
      BY REGN;                                                                  
   FILE P13L091G HEADER=GHDR LINESLEFT=LL NOTITLES;                             
    SNOG+1;                                                                     
    IF DTE_REC = '        ' OR '.' THEN                                         
       DTE_FLE = '          ';                                                  
    ELSE                                                                        
       DTE_FLE = SUBSTR(DTE_REC,7,2)||'-'||                                     
                 SUBSTR(DTE_REC,5,2)||'-'||                                     
                 SUBSTR(DTE_REC,1,4);                                           
                                                                                
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    PUT @005  SNOG                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @099  DTE_PRT                                                           
        @112  DTE_FLE                                                           
       ;                                                                        
      RETURN;                                                                   
                                                                                
GHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
                                                                                
   PUT @001 'P13L091G'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON DECEASED APPLICANTS/OCCUPIERS'                   
       @080 '(SOC/CDB)';                                                        
   PUT @030 '(APPLICATION AFTER BOOKING BEFORE SIGNING'                         
       @072 'AGREEMENT OF LEASE)';                                              
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       @112  'DATE FILE'                                                        
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF DEATH'                                                    
       @112  'RECEIVED'                                                         
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
   RETURN;                                                                      
                                                                                
   /*        PRINT P13L091H           */                                        
   DATA _NULLS_;                                                                
   SET P13F820H END=EOF;                                                        
      BY REGN;                                                                  
   FILE P13L091H HEADER=HHDR LINESLEFT=LL NOTITLES;                             
    SNOH + 1;                                                                   
    DTE_PRT = SUBSTR(DTEPRT,7,2)||'-'||                                         
              SUBSTR(DTEPRT,5,2)||'-'||                                         
              SUBSTR(DTEPRT,1,4);                                               
                                                                                
    PUT @005  SNOH                                                              
        @010  REGN                                                              
        @025  ZONE                                                              
        @031  NT                                                                
        @037  FT                                                                
        @042  NRIC                                                              
        @053  NAME                                                              
        @086  STAT                                                              
        @099  DTE_PRT                                                           
       ;                                                                        
    RETURN;                                                                     
HHDR:                                                                           
   PAGE+1;                                                                      
   CUR_DATE=TODAY();                                                            
                                                                                
   PUT @001 'P13L091H'                                                          
       @045 'SYSTEM OF COMMITMENT'                                              
       @104 'DATE : ' CUR_DATE DDMMYY10.                                        
       @123 'PAGE : ' PAGE;                                                     
   PUT @030 'MONTHLY REPORT ON DECEASED APPLICANTS/OCCUPIERS'                   
       @080 '(SOC/CDB)';                                                        
   PUT @030 '(APPLICATION AFTER SIGNING AGREEMENT OF LEASE BEFORE TP)';         
   PUT /;                                                                       
   PUT @010  'REGISTRATION'                                                     
       @030  'NEW'                                                              
       @036  'FLAT'                                                             
       ;                                                                        
   PUT @005  'S/NO'                                                             
       @010  'NUMBER'                                                           
       @024  'ZONE'                                                             
       @030  'TOWN'                                                             
       @036  'TYPE'                                                             
       @042  'NRIC'                                                             
       @053  'NAME'                                                             
       @086  'STATUS'                                                           
       @097  'DATE OF DEATH'                                                    
       ;                                                                        
   PUT @1 131*'_';                                                              
   PUT /;                                                                       
 RETURN;                                                                        
