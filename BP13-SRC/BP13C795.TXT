       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C795.                                                 
      *AUTHOR.        GEORGE VARGHESE.                                          
      *DATE-WRITTEN.  20/08/1999.                                               
      * ====================================================== *                
      * SYSTEM OF COMMITMENT (BP13)                            *                
      * ====================================================== *                
      *                                                        *                
      * (SIMILAR PROGRAM : BP13C913, TO UPDATE ALL CHANGES TO  *                
      *                    BP13C913).                          *                
      *                                                        *                
      *    OBJECTIVE    :                                      *                
      *       1.  TO LIST OUT THOSE APPLICANTS OF RESALE HIST  *                
      *            APPLICATIONS HAVING HOUSING GRANT           *                
      *                                                        *                
      *     INPUT FILES :                                      *                
      *       1. BP13F558  :  RESALE HIST FILE                 *                
      *       2. P13F558A  :  RESALE HIST FILE (SORTED FILE)   *                
      *                                                        *                
      *     LISTINGS:                                          *                
      *       1. BP13L795  :  LIST OF APPLICANTS / APPLICATION *                
      *                                                        *                
      * CHG NO    BY   ON        DESCRIPTION                   *                
      * --------  --- ---------- -----------                   *                
      * BP130715  GV  14/08/1999 NEW PROGRAM                   *                
      * BP130789  AKT 20/01/2000 INCLUDE FIELDS-HANAME,RELNSHIP*                
      *                          NEW MTH MET & NEW HHTYPE.     *                
      * BP130789  AKT 19/02/2000 INCLUDE FIELD -HA.            *                
      * BP130897  AKT 04/08/2000 EXPAND F558 RECL TO 600       *                
      * ====================================================== *                
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13K060  ASSIGN       TO BP13K060                            
                            ACCESS       IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K060-KEY-FLD                        
                            FILE STATUS  IS WS-BP13K060-STATUS.                 
                                                                                
           SELECT BP13K510  ASSIGN       TO BP13K510                            
                            ACCESS       IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K510-KEY-NEW                        
                            FILE STATUS  IS WS-BP13K510-STATUS.                 
                                                                                
           SELECT BP13K820  ASSIGN       TO BP13K820                            
                            ACCESS       IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K820-KEY-FLD                        
                            FILE STATUS  IS WS-BP13K820-STATUS.                 
                                                                                
           SELECT BP13F558  ASSIGN  TO  BP13F558.                               
                                                                                
           SELECT P13F558A  ASSIGN  TO  P13F558A.                               
                                                                                
           SELECT BP13L795  ASSIGN  TO  BP13L795.                               
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
                                                                                
       FD  BP13K060                                                             
           RECORD CONTAINS 25 CHARACTERS.                                       
       COPY BP13K060.                                                           
                                                                                
       FD  BP13K510                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BP13K510.                                                           
                                                                                
       FD  BP13K820                                                             
           RECORD CONTAINS 400 CHARACTERS.                                      
       COPY BP13K820.                                                           
                                                                                
       FD  BP13F558                                                             
           RECORD CONTAINS 600 CHARACTERS                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F558.                                                           
                                                                                
       FD  P13F558A                                                             
           RECORD CONTAINS 600 CHARACTERS                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD.                                          
       01  BP13F558A-REC.                                                       
           05 F558A-KEY-FLD.                                                    
              10 F558A-NUM-REGN           PIC X(8).                             
              10 F558A-NUM-MATURE-KEY REDEFINES F558A-NUM-REGN.                 
                 15 F558A-NUM-REF         PIC X(6).                             
                 15 FILLER                PIC X(2).                             
              10 F558A-NUM-NRIC.                                                
                 15 F558A-NUM-NRIC-PREFIX PIC X(1).                             
                 15 F558A-NUM-NRIC-OLD    PIC X(8).                             
           05 FILLER                      PIC X(03).                            
           05 F558A-NUM-MTH-RESIDE-RSL    PIC 9(3).                             
           05 F558A-NUM-MTH-RESIDE-SMS    PIC 9(3).                             
           05 F558A-NUM-APPLN             PIC X(1).                             
           05 F558A-NUM-SUBLET-SMS        PIC 9(3).                             
           05 F558A-NUM-SUBLET-RSL        PIC 9(3).                             
           05 F558A-NUM-MTH-RESIDE        PIC 9(3).                             
           05 F558A-DTE-RESALE-EFF        PIC X(8).                             
           05 F558A-DTE-TRSF-SMS          PIC X(8).                             
           05 F558A-DTE-FLAT-SOLD-SMS     PIC X(8).                             
           05 F558A-CDE-SALES-TYPE-SMS    PIC X(2).                             
           05 F558A-DTE-ISSUE-REGN        PIC X(8).                             
           05 F558A-NUM-HDB-REF-RSL       PIC X(11).                            
           05 F558A-CDE-RELATIONSHIP      PIC X(2).                             
           05 F558A-CDE-LESSEE-CHECK      PIC X(1).                             
           05 F558A-DTE-MOVE-IN-RDB       PIC X(8).                             
           05 F558A-CDE-HOUSEHOLD         PIC X(1).                             
           05 F558A-NUM-5YR-OCCUPN        PIC X(1).                             
           05 FILLER                      PIC X(2).                             
           05 F558A-NUM-SELLER-RSL        PIC X(1).                             
           05 FILLER                      PIC X(1).                             
           05 F558A-CDE-OWNER-STATUS      PIC X(1).                             
           05 F558A-CDE-FILE               PIC X(1).                            
           05 F558A-NUM-HDB-REF-SMS        PIC X(11).                           
           05 F558A-CDE-FILE-STATUS-RSL    PIC X(3).                            
           05 F558A-CDE-FLAT-TYPE-SMS      PIC X(02).                           
           05 F558A-CDE-FLAT-TYPE-RESALE   PIC X(01).                           
           05 F558A-NUM-MTHLY-INCOME       PIC 9(5).                            
           05 F558A-CDE-SOLE-LESSEE        PIC X(1).                            
           05 F558A-CDE-FILE-STATUS-SMS    PIC X(2).                            
           05 F558A-NUM-ETHNIC             PIC X(1).                            
           05 F558A-NUM-SEX                PIC X(1).                            
           05 F558A-NUM-MARITAL-STATUS     PIC X(1).                            
           05 F558A-DTE-BIRTH.                                                  
              10 F558A-DTE-BIRTH-CC        PIC X(2).                            
              10 F558A-DTE-BIRTH-YY        PIC X(2).                            
              10 F558A-DTE-BIRTH-MM        PIC X(2).                            
              10 F558A-DTE-BIRTH-DD        PIC X(2).                            
           05 F558A-NUM-CITIZENSHIP        PIC X(2).                            
           05 F558A-DTE-SOLD-SELLER-RSL    PIC X(8).                            
           05 F558A-NUM-ALLOC-SCH-SMS      PIC X(3).                            
           05 F558A-NUM-LESSEE-SMS         PIC X(1).                            
           05 F558A-NUM-HDB-REF-TR         PIC X(11).                           
           05 F558A-NUM-SALES-TYPE-TR      PIC X(2).                            
           05 F558A-NUM-ALLO-SCH-TR        PIC X(3).                            
           05 F558A-NUM-ELIG-SCH-TR        PIC X(3).                            
           05 F558A-DTE-EFF-SALE-TR        PIC X(8).                            
           05 F558A-NUM-TRANSFEROR         PIC X(2).                            
           05 F558A-NUM-RSHIP-TR           PIC X(2).                            
           05 F558A-NUM-MSTAT-TR           PIC X(2).                            
           05 F558A-DTE-MOVE-IN-TR         PIC X(8).                            
           05 F558A-DTE-MOVE-OUT-TR        PIC X(8).                            
           05 F558A-NUM-MTH-RESIDE-TR      PIC 9(3).                            
           05 F558A-DTE-TRANSFER-TR        PIC X(8).                            
           05 F558A-NUM-SUBLET-TR          PIC 9(3).                            
           05 F558A-NUM-ZONE-NT-SOC        PIC X(3).                            
           05 F558A-NUM-FLAT-TY-SOC        PIC X(2).                            
           05 F558A-DTE-APPROVAL-RSL      PIC X(8).                             
           05 F558A-AMT-RESALE-RDB        PIC 9(6).                             
           05 F558A-AMT-ORIG-PUR-RDB      PIC 9(6).                             
           05 F558A-NUM-SA-AGE            PIC X(1).                             
           05 F558A-NUM-SA-MTH-STAY       PIC X(1).                             
           05 F558A-NUM-SA-CCC            PIC X(2).                             
           05 F558A-NUM-SA-ED-GEOG        PIC X(2).                             
           05 F558A-NUM-SA-RANK           PIC X(2).                             
           05 F558A-DTE-APPLN-TR          PIC X(8).                             
           05 F558A-NUM-DIVORCE-TR        PIC X(1).                             
           05 F558A-DTE-DEBAR-EFF         PIC X(8).                             
           05 F558A-NUM-HDB-REF-DEBAR     PIC X(11).                            
           05 F558A-NUM-DEBARMENT-1       PIC X(2).                             
           05 F558A-NUM-DEBARMENT-2       PIC X(2).                             
           05 F558A-NUM-DEBARMENT-3       PIC X(2).                             
           05 F558A-NUM-SUBLET-EXM-SMS    PIC X(2).                             
           05 F558A-NUM-SUBLET-EXM-RSL    PIC X(2).                             
           05 F558A-NUM-SUBLET-EXM-TRF    PIC X(2).                             
           05 FILLER                     PIC X(63).                             
           05 F558A-NUM-EST               PIC X(3).                             
           05 F558A-NUM-MO                PIC X(2).                             
           05 F558A-NUM-ED                PIC X(2).                             
           05 F558A-NUM-MODL-DESG         PIC X(2).                             
           05 F558A-NUM-CONFIG-DESG       PIC X(1).                             
           05 F558A-SMS-ADDRESS.                                                
               10 F558A-NUM-BLK           PIC X(5).                             
               10 F558A-NME-STREET        PIC X(20).                            
               10 F558A-NUM-HSE.                                                
                  15  F558A-NUM-LVL       PIC X(3).                             
                  15  F558A-NUM-UNIT      PIC X(5).                             
               10 F558A-NUM-POSTAL-DSTRCT PIC X(6).                             
               10 F558A-CDE-BO            PIC X(2).                             
           05 FILLER                     PIC X(200).                            
                                                                                
       FD  BP13L795                                                             
           RECORDING MODE IS F                                                  
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  L795-PRT-REC                PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01  FILE-STATUS.                                                         
           03  WS-F558-STATUS             PIC 9(2)    VALUE 0.                  
           03  WS-F558A-STATUS            PIC 9(2)    VALUE 0.                  
           03  WS-BP13K060-STATUS         PIC 9(2)    VALUE 0.                  
           03  WS-BP13K510-STATUS         PIC 9(2)    VALUE 0.                  
           03  WS-BP13K820-STATUS         PIC 9(2)    VALUE 0.                  
                                                                                
       01  K                              PIC 9(2)    VALUE 1.                  
                                                                                
       01  WS-ACCUMULATORS.                                                     
           03  WS-TOTAL-PRTED             PIC 9(3)    VALUE 0.                  
           03  WS-LINE-CTR                PIC 9(2)    VALUE 60.                 
           03  WS-PAGE-CTR                PIC 9(4)    VALUE ZERO.               
           03  WS-CNT-F558-READ           PIC 9(4)    VALUE ZERO.               
           03  WS-CNT-F558A-READ          PIC 9(4)    VALUE ZERO.               
           03  WS-CNT-K060-READ           PIC 9(4)    VALUE ZERO.               
           03  WS-CNT-K510-READ           PIC 9(4)    VALUE ZERO.               
           03  WS-CNT-K820-READ           PIC 9(4)    VALUE ZERO.               
                                                                                
       01  WS-SWITCHES.                                                         
           03  F558-FOUND                 PIC X VALUE 'N'.                      
           03  F558A-FOUND                PIC X VALUE 'N'.                      
           03  WS-F558-EOF                PIC X VALUE 'N'.                      
           03  WS-F558A-EOF               PIC X VALUE 'N'.                      
                                                                                
       01  WS-NAME                        PIC X(66).                            
                                                                                
       01  WS-SCHACC.                                                           
           05  WS-SCHEME                  PIC X(04).                            
           05  FILLER                     PIC X(01) VALUE '-'.                  
           05  WS-ACCOUNT                 PIC X(04).                            
           05  FILLER                     PIC X(01) VALUE '-'.                  
           05  WS-CHCKDIGIT               PIC X(01).                            
           05  FILLER                     PIC X(01) VALUE '-'.                  
           05  WS-LSECDE                  PIC X(02).                            
                                                                                
       01  WS-PREV-REGN                   PIC X(08).                            
                                                                                
       01  WS-DATE.                                                             
           03 WS-CCYY                     PIC X(4).                             
           03 WS-MM                       PIC X(2).                             
           03 WS-DD                       PIC X(2).                             
                                                                                
                                                                                
      **************************************************************            
      *           LAY-OUT FOR CONTROL LISTING                      *            
      **************************************************************            
       01  L795-HDG1.                                                           
           03  FILLER              PIC X(14)   VALUE 'BP13L795'.                
           03  FILLER              PIC X(8)    VALUE 'HDB3'.                    
           03  FILLER              PIC X(18)   VALUE SPACES.                    
           03  FILLER              PIC X(39)   VALUE                            
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           03  FILLER              PIC X(18)   VALUE SPACES.                    
           03  FILLER              PIC X(7)    VALUE 'DATE: '.                  
           03  L795-DATE           PIC X(10)   VALUE SPACES.                    
           03  FILLER              PIC X(1)    VALUE SPACES.                    
           03  FILLER              PIC X(7)    VALUE 'PAGE: '.                  
           03  L795-PAGE           PIC ZZZZ9.                                   
                                                                                
       01  L795-HDG2.                                                           
           03  FILLER              PIC X(37) VALUE SPACES.                      
           03  FILLER              PIC X(66) VALUE                              
              'RESALE APPLICATIONS FOUND WITH HOUSING GRANT'.                   
           03  FILLER              PIC X(12) VALUE SPACES.                      
                                                                                
       01  L795-HDG3A.                                                          
           05  FILLER              PIC X(04)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(33)   VALUE SPACES.                    
           05  FILLER              PIC X(05)   VALUE '  SMS'.                   
           05  FILLER              PIC X(09)   VALUE '  SMS    '.               
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'SMS '.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'SMS '.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'RSL'.                     
           05  FILLER              PIC X(12)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'RSL '.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'RSL '.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'RSL'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'NEW'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'NEW'.                     
                                                                                
       01  L795-HDG3B.                                                          
           05  FILLER              PIC X(04)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(34)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE ' SAL'.                    
           05  FILLER              PIC X(09)   VALUE '  SCHEME'.                
           05  FILLER              PIC X(08)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE ' MTH'.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE ' SUB'.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(06)   VALUE 'SCHEME'.                  
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'MTH '.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'SUB '.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'FIL'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'MTH'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'HH '.                     
                                                                                
       01  L795-HDG4.                                                           
           05  FILLER              PIC X(04)   VALUE ' S/N'.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE 'REGN NO  '.               
           05  FILLER              PIC X(09)   VALUE 'NAME     '.               
           05  FILLER              PIC X(13)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE 'RELNSHIP'.                
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE 'NRIC NO  '.               
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE 'HA'.                      
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'TYP'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(13)   VALUE 'ACCOUNT NO'.              
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'RES'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'LET'.                     
      *    05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(14)   VALUE '  ACCOUNT NO'.            
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'RES'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'LET'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'STA'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'MET'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'TYP'.                     
                                                                                
       01  L795-HDG5.                                                           
           05  FILLER              PIC X(04)   VALUE '----'.                    
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE '-------  '.               
           05  FILLER              PIC X(18)   VALUE ALL '-'.                   
           05  FILLER              PIC X(04)   VALUE SPACES.                    
           05  FILLER              PIC X(10)   VALUE '----------'.              
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(09)   VALUE '-------  '.               
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(02)   VALUE '--'.                      
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(10)   VALUE '----------'.              
           05  FILLER              PIC X(06)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(10)   VALUE '----------'.              
           05  FILLER              PIC X(05)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
           05  FILLER              PIC X(02)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE '---'.                     
                                                                                
       01  L795-DTL.                                                            
           03  L795-SNO            PIC XXXX.                                    
           03  FILLER              PIC X(2)  VALUE SPACES.                      
           03  L795-REGN           PIC X(9)  VALUE SPACES.                      
           03  FILLER              PIC X(1)  VALUE SPACES.                      
           03  L795-HANAME         PIC X(20) VALUE SPACES.                      
           03  FILLER              PIC X(1)  VALUE SPACES.                      
           03  L795-RELNSHIP       PIC X(10) VALUE SPACES.                      
           03  FILLER              PIC X(01) VALUE SPACES.                      
           03  L795-NRIC           PIC X(09) VALUE SPACES.                      
           03  FILLER              PIC X(2)  VALUE SPACES.                      
           03  L795-HA             PIC X(01) VALUE SPACES.                      
           03  FILLER              PIC X(3)  VALUE SPACES.                      
           03  L795-SMS-SALE-TYP   PIC X(03) VALUE SPACES.                      
           03  FILLER              PIC X(02) VALUE SPACES.                      
           03  L795-SMS-SCHACC     PIC X(14) VALUE SPACES.                      
           03  FILLER              PIC X(2)  VALUE SPACES.                      
           03  L795-SMS-MTHRES     PIC X(03) VALUE SPACES.                      
           03  FILLER              PIC X(02) VALUE SPACES.                      
           03  L795-SMS-SUBLET     PIC X(3)  VALUE SPACES.                      
           03  FILLER              PIC X(02) VALUE SPACES.                      
           03  L795-RSL-SCHACC     PIC X(14) VALUE SPACES.                      
           03  FILLER              PIC X(01) VALUE SPACES.                      
           03  L795-RSL-MTHRES     PIC X(03) VALUE SPACES.                      
           03  FILLER              PIC X(02) VALUE SPACES.                      
           03  L795-RSL-SUBLET     PIC X(3)  VALUE SPACES.                      
           03  FILLER              PIC X(02) VALUE SPACES.                      
           03  L795-RSL-STATUS     PIC X(2)  VALUE SPACES.                      
           03  FILLER              PIC X(03) VALUE SPACES.                      
           03  L795-NEW-MTHMET     PIC X(3)  VALUE SPACES.                      
           03  FILLER              PIC X(03) VALUE SPACES.                      
           03  L795-NEW-HHTYPE     PIC X(2)  VALUE SPACES.                      
      *-------------------------------------------------------------            
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       000-MAIN-LOGIC.                                                          
      *-------------------------------------------------------------            
           PERFORM 100-OPEN-ROUTINE    THRU 100-EXIT.                           
           PERFORM 200-READ-F558       THRU 200-EXIT.                           
           PERFORM 300-READ-F558A      THRU 300-EXIT.                           
           PERFORM 400-PROCESS-ROUTINE THRU 400-EXIT                            
                   UNTIL WS-F558-EOF = 'Y' OR WS-F558A-EOF = 'Y'.               
           PERFORM 900-CLOSE-ROUTINE.                                           
                                                                                
                                                                                
      *-------------------------------------------------------------            
       100-OPEN-ROUTINE.                                                        
      *-------------------------------------------------------------            
           OPEN INPUT BP13F558                                                  
                      BP13K060                                                  
                      BP13K510                                                  
                      BP13K820                                                  
                      P13F558A                                                  
               OUTPUT BP13L795.                                                 
                                                                                
           IF WS-BP13K060-STATUS NOT = 00 AND 97                                
             DISPLAY 'OPENING BP13K060 ERROR ' WS-BP13K060-STATUS               
             MOVE WS-BP13K060-STATUS    TO RETURN-CODE                          
             PERFORM 900-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-BP13K510-STATUS NOT = 00 AND 97                                
             DISPLAY 'OPENING BP13K510 ERROR ' WS-BP13K510-STATUS               
             MOVE WS-BP13K510-STATUS    TO RETURN-CODE                          
             PERFORM 900-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-BP13K820-STATUS NOT = 00 AND 97                                
             DISPLAY 'OPENING BP13K820 ERROR ' WS-BP13K820-STATUS               
             MOVE WS-BP13K820-STATUS    TO RETURN-CODE                          
             PERFORM 900-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                               
           MOVE WS-MM                 TO K.                                     
           STRING WS-DD '/' WS-MM '/' WS-CCYY                                   
                  DELIMITED BY SIZE INTO L795-DATE.                             
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       200-READ-F558.                                                           
      *-------------------------------------------------------------            
                                                                                
           READ BP13F558     AT END                                             
                             MOVE 'Y' TO WS-F558-EOF                            
                             GO       TO 200-EXIT.                              
                                                                                
           ADD  1                     TO WS-CNT-F558-READ.                      
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       300-READ-F558A.                                                          
      *-------------------------------------------------------------            
                                                                                
           READ P13F558A     AT END                                             
                             MOVE 'Y' TO WS-F558A-EOF                           
                             GO       TO 300-EXIT.                              
                                                                                
           ADD  1                     TO WS-CNT-F558A-READ.                     
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       400-PROCESS-ROUTINE.                                                     
      *-------------------------------------------------------------            
                                                                                
           MOVE    SPACES              TO WS-PREV-REGN.                         
           IF F558-NUM-REGN = F558A-NUM-REGN                                    
              PERFORM 500-PROCESS-PARA    THRU 500-EXIT                         
                   UNTIL F558-NUM-REGN NOT = F558A-NUM-REGN                     
                   OR WS-F558-EOF = 'Y'                                         
                 PERFORM 300-READ-F558A   THRU 300-EXIT                         
           ELSE                                                                 
              IF F558-NUM-REGN > F558A-NUM-REGN                                 
                 PERFORM 300-READ-F558A   THRU 300-EXIT                         
              ELSE                                                              
                 IF F558-NUM-REGN < F558A-NUM-REGN                              
                    PERFORM 200-READ-F558 THRU 200-EXIT                         
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       500-PROCESS-PARA.                                                        
      *-------------------------------------------------------------            
                                                                                
           PERFORM 800-PRINT-CONTROL-LIST       THRU 800-EXIT.                  
           MOVE    F558-NUM-REGN       TO WS-PREV-REGN.                         
           PERFORM 200-READ-F558       THRU 200-EXIT.                           
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       800-PRINT-CONTROL-LIST.                                                  
      *-------------------------------------------------------------            
           IF WS-LINE-CTR > 55                                                  
              PERFORM 810-PRINT-CONTROL-HEADING THRU 810-EXIT                   
           END-IF.                                                              
                                                                                
           MOVE  SPACES                  TO L795-PRT-REC.                       
                                                                                
           ADD   1                       TO WS-LINE-CTR.                        
                                                                                
           IF WS-PREV-REGN NOT = F558-NUM-REGN                                  
              ADD   1                    TO WS-TOTAL-PRTED                      
              MOVE WS-TOTAL-PRTED        TO L795-SNO                            
              MOVE F558-NUM-REGN         TO L795-REGN                           
           ELSE                                                                 
              MOVE SPACES                TO L795-SNO                            
                                            L795-REGN                           
           END-IF.                                                              
                                                                                
           MOVE F558-NUM-NRIC              TO L795-NRIC.                        
           IF F558-NUM-HDB-REF-SMS = SPACES OR LOW-VALUES                       
              MOVE SPACES                     TO L795-SMS-SCHACC                
           ELSE                                                                 
              MOVE F558-NUM-HDB-REF-SMS(1:4)  TO WS-SCHEME                      
              MOVE F558-NUM-HDB-REF-SMS(5:4)  TO WS-ACCOUNT                     
              MOVE F558-NUM-HDB-REF-SMS(9:1)  TO WS-CHCKDIGIT                   
              MOVE F558-NUM-HDB-REF-SMS(10:2) TO WS-LSECDE                      
              MOVE WS-SCHACC                  TO L795-SMS-SCHACC                
           END-IF.                                                              
                                                                                
           MOVE F558-CDE-SALES-TYPE-SMS    TO L795-SMS-SALE-TYP.                
           MOVE F558-NUM-MTH-RESIDE-SMS    TO L795-SMS-MTHRES.                  
           MOVE F558-NUM-SUBLET-SMS        TO L795-SMS-SUBLET.                  
                                                                                
           IF F558-NUM-HDB-REF-RSL = SPACES OR LOW-VALUES                       
              MOVE SPACES                     TO L795-RSL-SCHACC                
           ELSE                                                                 
              MOVE F558-NUM-HDB-REF-RSL(1:4)  TO WS-SCHEME                      
              MOVE F558-NUM-HDB-REF-RSL(5:4)  TO WS-ACCOUNT                     
              MOVE F558-NUM-HDB-REF-RSL(9:1)  TO WS-CHCKDIGIT                   
              MOVE F558-NUM-HDB-REF-RSL(10:2) TO WS-LSECDE                      
              MOVE WS-SCHACC                  TO L795-RSL-SCHACC                
           END-IF.                                                              
           MOVE F558-NUM-MTH-RESIDE-RSL       TO L795-RSL-MTHRES.               
           MOVE F558-NUM-SUBLET-RSL           TO L795-RSL-SUBLET.               
           MOVE F558-CDE-FILE-STATUS-RSL      TO L795-RSL-STATUS.               
           MOVE F558-NUM-APPLN                TO L795-HA.                       
                                                                                
           IF F558-CDE-RELATIONSHIP NOT = SPACES OR LOW-VALUES                  
              MOVE SPACES                     TO K060-KEY-FLD                   
              INITIALIZE                         K060-KEY-FLD                   
              MOVE '35'                       TO K060-SERIAL-NO                 
              MOVE F558-CDE-RELATIONSHIP      TO K060-CODE                      
              PERFORM 820-READ-K060           THRU 820-EXIT                     
           END-IF.                                                              
                                                                                
           MOVE SPACES                        TO K510-KEY-NEW.                  
           MOVE F558-NUM-REGN                 TO K510-NUM-REGN.                 
           PERFORM 830-READ-K510              THRU 830-EXIT.                    
                                                                                
           MOVE SPACES                        TO K820-KEY-FLD.                  
           MOVE F558-NUM-REGN                 TO K820-NUM-REGN.                 
           MOVE F558-NUM-NRIC                 TO K820-NUM-NRIC.                 
           PERFORM 840-READ-K820              THRU 840-EXIT.                    
                                                                                
           IF WS-PREV-REGN NOT = F558-NUM-REGN                                  
              WRITE L795-PRT-REC          FROM L795-DTL AFTER 2                 
           ELSE                                                                 
              WRITE L795-PRT-REC          FROM L795-DTL                         
           END-IF.                                                              
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       810-PRINT-CONTROL-HEADING.                                               
      *-------------------------------------------------------------            
                                                                                
           ADD   1                TO WS-PAGE-CTR                                
           MOVE  3                TO WS-LINE-CTR                                
           MOVE  WS-PAGE-CTR      TO L795-PAGE.                                 
                                                                                
           WRITE L795-PRT-REC     FROM L795-HDG1 AFTER PAGE.                    
           WRITE L795-PRT-REC     FROM L795-HDG2 AFTER 1.                       
           WRITE L795-PRT-REC     FROM L795-HDG3A AFTER 2.                      
           WRITE L795-PRT-REC     FROM L795-HDG3B AFTER 1.                      
                                                                                
           WRITE L795-PRT-REC     FROM L795-HDG4.                               
           WRITE L795-PRT-REC     FROM L795-HDG5.                               
                                                                                
           MOVE  SPACES           TO   L795-PRT-REC.                            
           WRITE L795-PRT-REC.                                                  
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
      *-------------------------------------------------------------            
       820-READ-K060.                                                           
      *-------------------------------------------------------------            
      *---GET CODE TRANSCRIPTION-----------------------------------*            
                                                                                
           READ BP13K060.                                                       
                                                                                
           EVALUATE WS-BP13K060-STATUS                                          
           WHEN 00                                                              
                MOVE K060-DESC            TO L795-RELNSHIP                      
                ADD 1                     TO WS-CNT-K060-READ                   
           WHEN 23                                                              
                DISPLAY 'BP13K060 RECORD NOT FOUND :' K060-KEY-FLD              
                MOVE SPACES               TO L795-RELNSHIP                      
           WHEN OTHER                                                           
                DISPLAY 'BP13K060 READ FILE ERROR:' WS-BP13K060-STATUS          
                PERFORM 900-CLOSE-ROUTINE                                       
           END-EVALUATE.                                                        
                                                                                
        820-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       830-READ-K510.                                                           
      *-------------------------------------------------------------            
                                                                                
           READ BP13K510.                                                       
                                                                                
           EVALUATE WS-BP13K510-STATUS                                          
           WHEN 00                                                              
                MOVE K510-NUM-MTH-RESIDE  TO L795-NEW-MTHMET                    
                MOVE K510-CDE-HOUSEHOLD   TO L795-NEW-HHTYPE                    
                ADD 1                     TO WS-CNT-K510-READ                   
           WHEN 23                                                              
                DISPLAY 'BP13K510 RECORD NOT FOUND :' K510-KEY-NEW              
                MOVE SPACES               TO L795-NEW-MTHMET                    
                MOVE SPACES               TO L795-NEW-HHTYPE                    
           WHEN OTHER                                                           
                DISPLAY 'BP13K510 READ FILE ERROR:' WS-BP13K510-STATUS          
                PERFORM 900-CLOSE-ROUTINE                                       
           END-EVALUATE.                                                        
                                                                                
        830-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       840-READ-K820.                                                           
      *-------------------------------------------------------------            
                                                                                
           READ BP13K820.                                                       
                                                                                
           EVALUATE WS-BP13K820-STATUS                                          
           WHEN 00                                                              
                MOVE K820-NME-OCCP(1:20)      TO L795-HANAME                    
                ADD  1                        TO WS-CNT-K820-READ               
           WHEN 23                                                              
                DISPLAY 'BP13K820 RECORD NOT FOUND :' K820-KEY-FLD              
                MOVE SPACES               TO L795-HANAME                        
           WHEN OTHER                                                           
                DISPLAY 'BP13K820 READ FILE ERROR:' WS-BP13K820-STATUS          
                PERFORM 900-CLOSE-ROUTINE                                       
           END-EVALUATE.                                                        
                                                                                
        840-EXIT.                                                               
           EXIT.                                                                
      *-------------------------------------------------------------            
       900-CLOSE-ROUTINE.                                                       
      *-------------------------------------------------------------            
           CLOSE BP13F558                                                       
                 BP13K060                                                       
                 BP13K510                                                       
                 BP13K820                                                       
                 P13F558A                                                       
                 BP13L795.                                                      
                                                                                
           DISPLAY '                                  '                         
           DISPLAY ' *----- BP13C795 CONTROL LIST ---------*'.                  
           DISPLAY '                                  '                         
           DISPLAY ' NO. OF REC READ FROM F558   = ' WS-CNT-F558-READ.          
           DISPLAY ' NO. OF REC READ FROM K060   = ' WS-CNT-K060-READ.          
           DISPLAY ' NO. OF REC READ FROM K510   = ' WS-CNT-K510-READ.          
           DISPLAY ' NO. OF REC READ FROM K820   = ' WS-CNT-K820-READ.          
           STOP RUN.                                                            
