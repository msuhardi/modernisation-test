       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C502.                                                 
       AUTHOR.        SENTHILVEL.                                               
       DATE-WRITTEN.  08/09/2004.                                               
      *****************************************************************         
      * SYSTEM NAME : SYSTEM OF COMMITMENT                            *         
      *****************************************************************         
      *                                                               *         
      * OBJECTIVE   : THIS PROGRAM PRINTS SUMMARY LIST OF THE         *         
      *               TENDER PROGRAM PRIOR TO PIGEONHILING AND        *         
      *               AFTER  PIGEON-HOLED APPLICATION.                *         
      *               USING BP13F012 FILE.                            *         
      * INPUT FILES :                                                 *         
      *       1.  BP13F012 -- TENDER FILE SORTED                      *         
      *       2.  BP13F713 --                                         *         
      *                                                               *         
      * OUTPUT FILES:                                                 *         
      *   1.  BP13L502 -- REPORT FILE                                 *         
      *                                                               *         
      * CHG-REQ  BY    DATE        DESCRIPTIONS                       *         
      * -------  ----- ----------  -------------                      *         
      * BP132596 PGS1  08/09/2004  NEW PROGRAM                        *         
      * BP132907 CKK7  09/09/2006  CATER FOR 1 AND 2-ROOM REPORT      *         
      * BP132927 CKK7  10/11/2006  CATER FOR DBSS                     *         
      *****************************************************************         
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F012 ASSIGN TO BP13F012.                                  
           SELECT BP13F713 ASSIGN TO BP13F713.                                  
           SELECT BP13L502 ASSIGN TO BP13L502.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD BP13F012                                                              
            RECORDING MODE IS F                                                 
            LABEL RECORD IS STANDARD                                            
            BLOCK CONTAINS    0 RECORDS                                         
            RECORD CONTAINS  400 CHARACTERS.                                    
                                                                                
       COPY BP13F012.                                                           
                                                                                
       FD BP13F713                                                              
            RECORDING MODE IS F                                                 
            LABEL RECORD IS STANDARD                                            
            BLOCK CONTAINS    0 RECORDS                                         
            RECORD CONTAINS  020 CHARACTERS.                                    
       COPY BP13F713.                                                           
                                                                                
       FD  BP13L502                                                             
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE OMITTED                                            
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  PRINT-REC               PIC X(132).                                  
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-FLATNO               PIC 9.                                       
       01  WS-CNT-PAGE             PIC 9(5)    VALUE ZERO.                      
       01  WS-BP13F012-READ        PIC 9(5)    VALUE ZERO.                      
       01  WS-CNT                  PIC 9(2)    VALUE ZERO.                      
       01  WS-XCNT                 PIC 9       VALUE ZERO.                      
       01  WS-PREV-NT              PIC X(3)    VALUE SPACES.                    
       01  WS-NME-TYPE             PIC X(10)   VALUE SPACES.                    
                                                                                
       01  WS-F012-EOF             PIC X       VALUE 'N'.                       
       01  WS-BP13F012-STATUS      PIC XX      VALUE SPACES.                    
                                                                                
       01 WS-DATE              PIC X(8).                                        
       01 WS-TIME              PIC X(8).                                        
                                                                                
       01  WS-FLAT-SUPPLY-TABLE.                                                
           05  WS-SUP-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-SUP-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-SUP-CAT     OCCURS 4 TIMES.                           
                       20  WS-SUP-QTY     PIC 9(5).                             
                                                                                
       01  WS-FLAT-REGISTERED-TABLE.                                            
           05  WS-REG-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-REG-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-REG-CAT     OCCURS 4 TIMES.                           
                       20  WS-REG-QTY     PIC 9(5).                             
                                                                                
       01  WS-FLAT-BALANCE-TABLE.                                               
           05  WS-BAL-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-BAL-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-BAL-CAT     OCCURS 4 TIMES.                           
                       20  WS-BAL-QTY     PIC 9(5).                             
                                                                                
       01  WS-FLAT-COM-TABLE.                                                   
           05  WS-COM-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-COM-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-COM-CAT     OCCURS 4 TIMES.                           
                       20  WS-COM-QTY     PIC 9(5).                             
      ******************************************************************        
      *  REPORT LAYOUT :                                                        
      ******************************************************************        
       01  L502-PRT-HEADING-1.                                                  
           05  FILLER              PIC X(8)      VALUE 'BP13L502'.              
           05  FILLER              PIC X(4)      VALUE SPACES .                 
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(39)     VALUE                          
                             'S Y S T E M   O F  C O M M I T M E N T'.          
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  L502-DATE           PIC X(10).                                   
           05  FILLER              PIC X(2)      VALUE ' ('.                    
           05  L502-TME-HH         PIC X(2).                                    
           05  FILLER              PIC X         VALUE ':'.                     
           05  L502-TME-MM         PIC X(2).                                    
           05  FILLER              PIC X(2)      VALUE ') '.                    
           05  FILLER              PIC X(2)      VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'PAGE : '.               
           05  L502-PAGENO         PIC ZZZZ9 .                                  
                                                                                
       01  L502-PRT-HEADING-2.                                                  
           05  FILLER                     PIC X(100) VALUE SPACES.              
           05  FILLER                     PIC X(32)  VALUE                      
               'SALES UNIT (REGISTRATION TEAM)'.                                
                                                                                
       01  L502-PRT-HEADING-3.                                                  
           05  FILLER              PIC X(19)     VALUE                          
                                   ' NEW TOWN / ZONE : '.                       
           05  L502-CDE-NT         PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(60)     VALUE                          
           'REPORT ON NUMBER OF FLATS AVAILABLE IN EACH NEW TOWN(MCPS)'.        
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE                          
                                   'PROCESS : '.                                
           05  L502-PROCESS        PIC X(15)     VALUE SPACES.                  
                                                                                
       01  L502-PRT-HEADING-5.                                                  
           05  FILLER              PIC X(11) VALUE '  FLAT TYPE'.               
           05  FILLER              PIC X(11) VALUE '          |'.               
           05  HEAD5-DESC1         PIC X(27).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  HEAD5-DESC2         PIC X(27).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  HEAD5-DESC3         PIC X(27).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  FILLER              PIC X(26) VALUE                              
                                          '           TOTAL          '.         
                                                                                
       01  L502-PRT-HEADING-6.                                                  
           05  FILLER              PIC X(11) VALUE                              
               '-----------'.                                                   
           05  FILLER              PIC X(11) VALUE                              
               '----------|'.                                                   
           05  FILLER              PIC X(28) VALUE                              
               '---------------------------|'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '---------------------------|'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '---------------------------|'.                                  
           05  FILLER              PIC X(26) VALUE                              
               ALL '-'.                                                         
                                                                                
       01  L502-PRT-HEADING-7.                                                  
           05  FILLER              PIC X(11) VALUE                              
               '  CATEGORY'.                                                    
           05  FILLER              PIC X(11) VALUE                              
               '          |'.                                                   
           05  FILLER              PIC X(28) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL |'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL |'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL |'.                                  
           05  FILLER              PIC X(26) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL'.                                    
                                                                                
       01  L502-PRT-DETAILS.                                                    
           05  L502-NME-TYPE           PIC X(10)     VALUE SPACES.              
           05  FILLER                  PIC X(02)     VALUE SPACES.              
           05  L502-NME-SCHEME         PIC X(09)     VALUE SPACES.              
           05  FILLER                  PIC X(01)     VALUE SPACES.              
           05  L502-FLAT-RECORD    OCCURS 4 TIMES.                              
               15  L502-PRT-CAT1       PIC ZZZZ9.                               
               15  FILLER              PIC X(1).                                
               15  L502-PRT-CAT2       PIC ZZZZ9.                               
               15  FILLER              PIC X(1).                                
               15  L502-PRT-CAT3       PIC ZZZZ9.                               
               15  FILLER              PIC X(3).                                
               15  L502-PRT-TOT        PIC ZZZZ9.                               
               15  FILLER              PIC X(3).                                
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
      ******************************************************************        
       0000-MAIN-PROCESS.                                                       
      ******************************************************************        
            PERFORM  1000-OPEN-FILES          THRU  1000-EXIT.                  
            PERFORM  2000-READ-BP13F713       THRU  2000-EXIT.                  
            PERFORM  2100-READ-BP13F012       THRU  2100-EXIT.                  
            PERFORM  2200-INILIZE             THRU  2200-EXIT.                  
            PERFORM  3000-PROCESS             THRU  3000-EXIT                   
                     UNTIL  WS-F012-EOF = 'Y'.                                  
            PERFORM  4000-COMPUTE-BALANCE     THRU  4000-EXIT.                  
            PERFORM  5000-PRINT-FLAT-SUMMARY  THRU  5000-EXIT.                  
            PERFORM  9999-CLOSE-FILES         THRU  9999-EXIT.                  
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       1000-OPEN-FILES.                                                         
      ******************************************************************        
            OPEN   INPUT  BP13F012                                              
                          BP13F713                                              
                   OUTPUT BP13L502.                                             
                                                                                
            MOVE FUNCTION CURRENT-DATE  TO  WS-DATE.                            
            ACCEPT WS-TIME  FROM  TIME.                                         
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)               
                    DELIMITED BY SIZE INTO L502-DATE                            
            END-STRING.                                                         
                                                                                
            MOVE WS-TIME(1:2)      TO L502-TME-HH.                              
            MOVE WS-TIME(3:2)      TO L502-TME-MM.                              
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       2000-READ-BP13F713.                                                      
      ******************************************************************        
            READ BP13F713  AT END GO TO 2000-EXIT                               
            END-READ.                                                           
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       2100-READ-BP13F012.                                                      
      ******************************************************************        
            READ BP13F012 AT END  MOVE 'Y' TO WS-F012-EOF                       
                 ADD  1  TO  WS-BP13F012-READ                                   
                 GO TO 2100-EXIT                                                
            END-READ.                                                           
       2100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       2200-INILIZE.                                                            
      ******************************************************************        
            MOVE ZEROS TO WS-FLAT-SUPPLY-TABLE                                  
                          WS-FLAT-REGISTERED-TABLE                              
                          WS-FLAT-BALANCE-TABLE                                 
                          WS-FLAT-COM-TABLE.                                    
                                                                                
            EVALUATE  F713-CDE-COHORT                                           
                WHEN  'MT'                                                      
                      MOVE 'MTTCP/JB/RH/REN'     TO L502-PROCESS                
                WHEN  'CC'                                                      
                      MOVE 'GRO            '     TO L502-PROCESS                
                WHEN  'PA'                                                      
                      MOVE 'MAT/NON-MAT-PA '     TO L502-PROCESS                
                WHEN  'NH'                                                      
                      MOVE 'NHH/UPG        '     TO L502-PROCESS                
                WHEN  'TR'                                                      
                      MOVE 'TRANSITIONAL   '     TO L502-PROCESS                
                WHEN  'RN'                                                      
                      MOVE 'ADD REN REQUEST'     TO L502-PROCESS                
                WHEN  'BA'                                                      
                      MOVE 'NEW + BALANCE  '     TO L502-PROCESS                
                WHEN  'C1'                                                      
                      MOVE 'GRO RESIDENT   '     TO L502-PROCESS                
                WHEN  'C2'                                                      
                      MOVE 'GRO HPS-NONRES '     TO L502-PROCESS                
                WHEN  'C3'                                                      
                      MOVE 'GRO RES/NON-RES'     TO L502-PROCESS                
                WHEN  OTHER                                                     
                      MOVE  F713-CDE-COHORT      TO L502-PROCESS                
            END-EVALUATE.                                                       
                                                                                
            IF F012-CDE-FLAT-TY = '3 ' OR '4 ' OR '5 '                          
               MOVE '            3-ROOM         ' TO HEAD5-DESC1                
               MOVE '            4-ROOM         ' TO HEAD5-DESC2                
               MOVE '            5-ROOM         ' TO HEAD5-DESC3                
            ELSE                                                                
             IF F012-CDE-FLAT-TY = '1A' OR '2A' OR 'E ' OR '1 ' OR '2 '         
                MOVE '           1-ROOM          ' TO HEAD5-DESC1               
                MOVE '           2-ROOM          ' TO HEAD5-DESC2               
                MOVE '                           ' TO HEAD5-DESC3               
             ELSE                                                               
               IF F012-CDE-FLAT-TY = '00'                                       
                  MOVE '              BTO          ' TO HEAD5-DESC1             
                  MOVE '                           ' TO HEAD5-DESC2             
                  MOVE '                           ' TO HEAD5-DESC3             
               END-IF                                                           
             END-IF                                                             
            END-IF.                                                             
                                                                                
       2200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       3000-PROCESS.                                                            
      ******************************************************************        
            IF  WS-PREV-NT = SPACES OR LOW-VALUES                               
                MOVE  F012-CDE-NT-ZONE  TO  WS-PREV-NT                          
            END-IF.                                                             
                                                                                
            IF  F012-CDE-NT-ZONE = WS-PREV-NT                                   
                PERFORM 3100-SETUP-FLAT-TABLES  THRU 3100-EXIT                  
            ELSE                                                                
                PERFORM 4000-COMPUTE-BALANCE    THRU 4000-EXIT                  
                PERFORM 5000-PRINT-FLAT-SUMMARY THRU 5000-EXIT                  
                MOVE  F012-CDE-NT-ZONE  TO  WS-PREV-NT                          
                MOVE  ZEROS             TO  WS-FLAT-SUPPLY-TABLE                
                                            WS-FLAT-REGISTERED-TABLE            
                                            WS-FLAT-BALANCE-TABLE               
                                            WS-FLAT-COM-TABLE                   
                PERFORM 3100-SETUP-FLAT-TABLES  THRU 3100-EXIT                  
            END-IF.                                                             
            PERFORM  2100-READ-BP13F012      THRU 2100-EXIT.                    
       3000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       3100-SETUP-FLAT-TABLES.                                                  
      ******************************************************************        
            IF F012-CDE-FLAT-TY = '3 '  OR '1A' OR '00' OR '1 '                 
               MOVE  1  TO  WS-FLATNO                                           
            ELSE                                                                
               IF F012-CDE-FLAT-TY = '4 ' OR '4D' OR '2A' OR '2 '               
                  MOVE  2  TO  WS-FLATNO                                        
               ELSE                                                             
                  IF F012-CDE-FLAT-TY = '5 ' OR '5D'                            
                     MOVE  3  TO  WS-FLATNO                                     
                  ELSE                                                          
                     GO TO 3100-EXIT                                            
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
            PERFORM 3200-SETUP-SUPPLY-TABLE  THRU 3200-EXIT.                    
            PERFORM 3300-SETUP-REGISTERED-TABLE  THRU 3300-EXIT.                
       3100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       3200-SETUP-SUPPLY-TABLE.                                                 
      ******************************************************************        
            MOVE F012-NUM-MAX-PA1  TO  WS-SUP-QTY ( 1 , WS-FLATNO , 1).         
            MOVE F012-NUM-MAX-PA2  TO  WS-SUP-QTY ( 1 , WS-FLATNO , 2).         
            MOVE F012-NUM-MAX-PA3  TO  WS-SUP-QTY ( 1 , WS-FLATNO , 3).         
            MOVE F012-NUM-TOT-PA   TO  WS-SUP-QTY ( 1 , WS-FLATNO , 4).         
                                                                                
            ADD  F012-NUM-MAX-PA1  TO  WS-SUP-QTY ( 1 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 1).         
            ADD  F012-NUM-MAX-PA2  TO  WS-SUP-QTY ( 1 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 2).         
            ADD  F012-NUM-MAX-PA3  TO  WS-SUP-QTY ( 1 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
            ADD  F012-NUM-TOT-PA   TO  WS-SUP-QTY ( 1 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
            MOVE F012-NUM-MAX-MCPH1 TO WS-SUP-QTY ( 2 , WS-FLATNO , 1).         
            MOVE F012-NUM-MAX-MCPH2 TO WS-SUP-QTY ( 2 , WS-FLATNO , 2).         
            MOVE F012-NUM-MAX-MCPH3 TO WS-SUP-QTY ( 2 , WS-FLATNO , 3).         
            MOVE F012-NUM-TOT-MCPH  TO  WS-SUP-QTY ( 2 , WS-FLATNO , 4).        
                                                                                
            ADD  F012-NUM-MAX-MCPH1 TO WS-SUP-QTY ( 2 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 1).         
            ADD  F012-NUM-MAX-MCPH2 TO WS-SUP-QTY ( 2 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 2).         
            ADD  F012-NUM-MAX-MCPH3 TO WS-SUP-QTY ( 2 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
            ADD  F012-NUM-TOT-MCPH  TO WS-SUP-QTY ( 2 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
            MOVE F012-NUM-MAX-MCPG1 TO WS-SUP-QTY ( 3 , WS-FLATNO , 1).         
            MOVE F012-NUM-MAX-MCPG2 TO WS-SUP-QTY ( 3 , WS-FLATNO , 2).         
            MOVE F012-NUM-MAX-MCPG3 TO WS-SUP-QTY ( 3 , WS-FLATNO , 3).         
            MOVE F012-NUM-TOT-MCPG  TO WS-SUP-QTY ( 3 , WS-FLATNO , 4).         
                                                                                
            ADD  F012-NUM-MAX-MCPG1 TO WS-SUP-QTY ( 3 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 1).         
            ADD  F012-NUM-MAX-MCPG2 TO WS-SUP-QTY ( 3 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 2).         
            ADD  F012-NUM-MAX-MCPG3 TO WS-SUP-QTY ( 3 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
            ADD  F012-NUM-TOT-MCPG TO  WS-SUP-QTY ( 3 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
            MOVE F012-NUM-MAX-NOMCH1 TO WS-SUP-QTY ( 4 , WS-FLATNO , 1).        
            MOVE F012-NUM-MAX-NOMCH2 TO WS-SUP-QTY ( 4 , WS-FLATNO , 2).        
            MOVE F012-NUM-MAX-NOMCH3 TO WS-SUP-QTY ( 4 , WS-FLATNO , 3).        
            MOVE F012-NUM-TOT-NOMCH  TO WS-SUP-QTY ( 4 , WS-FLATNO , 4).        
                                                                                
            ADD  F012-NUM-MAX-NOMCH1 TO WS-SUP-QTY ( 4 , 4 , 1)                 
                                        WS-SUP-QTY ( 9 , 4 , 1)                 
                                        WS-SUP-QTY ( 9 , WS-FLATNO , 1).        
            ADD  F012-NUM-MAX-NOMCH2 TO WS-SUP-QTY ( 4 , 4 , 2)                 
                                        WS-SUP-QTY ( 9 , 4 , 2)                 
                                        WS-SUP-QTY ( 9 , WS-FLATNO , 2).        
            ADD  F012-NUM-MAX-NOMCH3 TO WS-SUP-QTY ( 4 , 4 , 3)                 
                                        WS-SUP-QTY ( 9 , 4 , 3)                 
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
            ADD  F012-NUM-TOT-NOMCH TO WS-SUP-QTY ( 4 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
            MOVE F012-NUM-MAX-NOMCG1 TO WS-SUP-QTY ( 5 , WS-FLATNO , 1).        
            MOVE F012-NUM-MAX-NOMCG2 TO WS-SUP-QTY ( 5 , WS-FLATNO , 2).        
            MOVE F012-NUM-MAX-NOMCG3 TO WS-SUP-QTY ( 5 , WS-FLATNO , 3).        
            MOVE F012-NUM-TOT-NOMCG TO WS-SUP-QTY ( 5 , WS-FLATNO , 4).         
                                                                                
            ADD  F012-NUM-MAX-NOMCG1 TO WS-SUP-QTY ( 5 , 4 , 1)                 
                                       WS-SUP-QTY ( 9 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 1).         
            ADD  F012-NUM-MAX-NOMCG2 TO WS-SUP-QTY ( 5 , 4 , 2)                 
                                       WS-SUP-QTY ( 9 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 2).         
            ADD  F012-NUM-MAX-NOMCG3 TO WS-SUP-QTY ( 5 , 4 , 3)                 
                                       WS-SUP-QTY ( 9 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
            ADD  F012-NUM-TOT-NOMCG TO WS-SUP-QTY ( 5 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
            MOVE F012-NUM-MAX-MCP1 TO  WS-SUP-QTY ( 6 , WS-FLATNO , 1).         
            MOVE F012-NUM-MAX-MCP2 TO  WS-SUP-QTY ( 6 , WS-FLATNO , 2).         
            MOVE F012-NUM-MAX-MCP3 TO  WS-SUP-QTY ( 6 , WS-FLATNO , 3).         
            MOVE F012-NUM-TOT-MCP  TO  WS-SUP-QTY ( 6 , WS-FLATNO , 4).         
                                                                                
            ADD  F012-NUM-MAX-MCP1 TO  WS-SUP-QTY ( 6 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 1).         
            ADD  F012-NUM-MAX-MCP2 TO  WS-SUP-QTY ( 6 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 2).         
            ADD  F012-NUM-MAX-MCP3 TO  WS-SUP-QTY ( 6 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
            ADD  F012-NUM-TOT-MCP  TO  WS-SUP-QTY ( 6 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
            MOVE F012-NUM-MAX-NOMCP1 TO WS-SUP-QTY ( 7 , WS-FLATNO , 1).        
            MOVE F012-NUM-MAX-NOMCP2 TO WS-SUP-QTY ( 7 , WS-FLATNO , 2).        
            MOVE F012-NUM-MAX-NOMCP3 TO WS-SUP-QTY ( 7 , WS-FLATNO , 3).        
            MOVE F012-NUM-TOT-NOMCP  TO WS-SUP-QTY ( 7 , WS-FLATNO , 4).        
                                                                                
            ADD  F012-NUM-MAX-NOMCP1 TO WS-SUP-QTY ( 7 , 4 , 1)                 
                                       WS-SUP-QTY ( 9 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 1).         
            ADD  F012-NUM-MAX-NOMCP2 TO WS-SUP-QTY ( 7 , 4 , 2)                 
                                       WS-SUP-QTY ( 9 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 2).         
            ADD  F012-NUM-MAX-NOMCP3 TO WS-SUP-QTY ( 7 , 4 , 3)                 
                                       WS-SUP-QTY ( 9 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
            ADD  F012-NUM-TOT-NOMCP TO WS-SUP-QTY ( 7 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
      ** MOVE ZEROES TO SUB-TOTAL ROW                                           
                                                                                
            MOVE ZEROES TO WS-SUP-QTY ( 9 , WS-FLATNO , 1 )                     
                           WS-SUP-QTY ( 9 , WS-FLATNO , 2 )                     
                           WS-SUP-QTY ( 9 , WS-FLATNO , 3 )                     
                           WS-SUP-QTY ( 9 , WS-FLATNO , 4 ).                    
                                                                                
      ** MOVE ZEROES TO SUB-TOTAL ROW, TOTALS COLUMN                            
                                                                                
            MOVE ZEROES TO WS-SUP-QTY ( 9 , 4 , 1 )                             
                           WS-SUP-QTY ( 9 , 4 , 2 )                             
                           WS-SUP-QTY ( 9 , 4 , 3 )                             
                           WS-SUP-QTY ( 9 , 4 , 4 ).                            
                                                                                
       3200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       3300-SETUP-REGISTERED-TABLE.                                             
      ******************************************************************        
            MOVE F012-REG-PA1  TO  WS-REG-QTY ( 1 , WS-FLATNO , 1).             
            MOVE F012-REG-PA2  TO  WS-REG-QTY ( 1 , WS-FLATNO , 2).             
            MOVE F012-REG-PA3  TO  WS-REG-QTY ( 1 , WS-FLATNO , 3).             
            ADD  F012-REG-PA1                                                   
                 F012-REG-PA2                                                   
                 F012-REG-PA3  TO  WS-REG-QTY ( 1 , WS-FLATNO , 4).             
                                                                                
            ADD  F012-REG-PA1  TO  WS-REG-QTY ( 1 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 1).             
            ADD  F012-REG-PA2  TO  WS-REG-QTY ( 1 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 2).             
            ADD  F012-REG-PA3  TO  WS-REG-QTY ( 1 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 3).             
            ADD  WS-REG-QTY ( 1 , WS-FLATNO , 4)                                
                               TO  WS-REG-QTY ( 1 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 4).             
                                                                                
            MOVE F012-REG-MCPH1 TO WS-REG-QTY ( 2 , WS-FLATNO , 1).             
            MOVE F012-REG-MCPH2 TO WS-REG-QTY ( 2 , WS-FLATNO , 2).             
            MOVE F012-REG-MCPH3 TO WS-REG-QTY ( 2 , WS-FLATNO , 3).             
            ADD  F012-REG-MCPH1                                                 
                 F012-REG-MCPH2                                                 
                 F012-REG-MCPH3 TO WS-REG-QTY ( 2 , WS-FLATNO , 4).             
                                                                                
            ADD  F012-REG-MCPH1 TO WS-REG-QTY ( 2 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 1).             
            ADD  F012-REG-MCPH2 TO WS-REG-QTY ( 2 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 2).             
            ADD  F012-REG-MCPH3 TO WS-REG-QTY ( 2 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 3).             
            ADD  WS-REG-QTY ( 2 , WS-FLATNO , 4)                                
                               TO  WS-REG-QTY ( 2 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 4).             
                                                                                
            MOVE F012-REG-MCPG1 TO WS-REG-QTY ( 3 , WS-FLATNO , 1).             
            MOVE F012-REG-MCPG2 TO WS-REG-QTY ( 3 , WS-FLATNO , 2).             
            MOVE F012-REG-MCPG3 TO WS-REG-QTY ( 3 , WS-FLATNO , 3).             
            ADD  F012-REG-MCPG1                                                 
                 F012-REG-MCPG2                                                 
                 F012-REG-MCPG3 TO WS-REG-QTY ( 3 , WS-FLATNO , 4).             
                                                                                
            ADD  F012-REG-MCPG1 TO WS-REG-QTY ( 3 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 1).             
            ADD  F012-REG-MCPG2 TO WS-REG-QTY ( 3 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 2).             
            ADD  F012-REG-MCPG3 TO WS-REG-QTY ( 3 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 3).             
            ADD  WS-REG-QTY ( 3 , WS-FLATNO , 4)                                
                               TO  WS-REG-QTY ( 3 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 4).             
                                                                                
            MOVE F012-REG-NOMCH1 TO WS-REG-QTY ( 4 , WS-FLATNO , 1).            
            MOVE F012-REG-NOMCH2 TO WS-REG-QTY ( 4 , WS-FLATNO , 2).            
            MOVE F012-REG-NOMCH3 TO WS-REG-QTY ( 4 , WS-FLATNO , 3).            
            ADD  F012-REG-NOMCH1                                                
                 F012-REG-NOMCH2                                                
                 F012-REG-NOMCH3 TO WS-REG-QTY ( 4 , WS-FLATNO , 4).            
                                                                                
            ADD  F012-REG-NOMCH1 TO WS-REG-QTY ( 4 , 4 , 1)                     
                                   WS-REG-QTY ( 9 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 1).             
            ADD  F012-REG-NOMCH2 TO WS-REG-QTY ( 4 , 4 , 2)                     
                                   WS-REG-QTY ( 9 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 2).             
            ADD  F012-REG-NOMCH3 TO WS-REG-QTY ( 4 , 4 , 3)                     
                                   WS-REG-QTY ( 9 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 3).             
            ADD  WS-REG-QTY ( 4 , WS-FLATNO , 4)                                
                               TO  WS-REG-QTY ( 4 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 4).             
                                                                                
            MOVE F012-REG-NOMCG1 TO WS-REG-QTY ( 5 , WS-FLATNO , 1).            
            MOVE F012-REG-NOMCG2 TO WS-REG-QTY ( 5 , WS-FLATNO , 2).            
            MOVE F012-REG-NOMCG3 TO WS-REG-QTY ( 5 , WS-FLATNO , 3).            
            ADD  F012-REG-NOMCG1                                                
                 F012-REG-NOMCG2                                                
                 F012-REG-NOMCG3 TO WS-REG-QTY ( 5 , WS-FLATNO , 4).            
                                                                                
            ADD  F012-REG-NOMCG1 TO WS-REG-QTY ( 5 , 4 , 1)                     
                                   WS-REG-QTY ( 9 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 1).             
            ADD  F012-REG-NOMCG2 TO WS-REG-QTY ( 5 , 4 , 2)                     
                                   WS-REG-QTY ( 5 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 2).             
            ADD  F012-REG-NOMCG3 TO WS-REG-QTY ( 5 , 4 , 3)                     
                                   WS-REG-QTY ( 9 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 3).             
            ADD  WS-REG-QTY ( 5 , WS-FLATNO , 4)                                
                               TO  WS-REG-QTY ( 5 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , 4 , 4)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 4).             
                                                                                
           MOVE F012-REG-MCP1 TO  WS-REG-QTY ( 6 , WS-FLATNO , 1).              
           MOVE F012-REG-MCP2 TO  WS-REG-QTY ( 6 , WS-FLATNO , 2).              
           MOVE F012-REG-MCP3 TO  WS-REG-QTY ( 6 , WS-FLATNO , 3).              
           ADD  F012-REG-MCP1                                                   
                F012-REG-MCP2                                                   
                F012-REG-MCP3 TO  WS-REG-QTY ( 6 , WS-FLATNO , 4).              
                                                                                
           ADD  F012-REG-MCP1 TO  WS-REG-QTY ( 6 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F012-REG-MCP2 TO  WS-REG-QTY ( 6 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F012-REG-MCP3 TO  WS-REG-QTY ( 6 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 6 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 6 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
           MOVE F012-REG-NOMCP1 TO WS-REG-QTY ( 7 , WS-FLATNO , 1).             
           MOVE F012-REG-NOMCP2 TO WS-REG-QTY ( 7 , WS-FLATNO , 2).             
           MOVE F012-REG-NOMCP3 TO WS-REG-QTY ( 7 , WS-FLATNO , 3).             
           ADD  F012-REG-NOMCP1                                                 
                F012-REG-NOMCP2                                                 
                F012-REG-NOMCP3 TO WS-REG-QTY ( 7 , WS-FLATNO , 4).             
                                                                                
           ADD  F012-REG-NOMCP1 TO WS-REG-QTY ( 7 , 4 , 1)                      
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F012-REG-NOMCP2 TO WS-REG-QTY ( 7 , 4 , 2)                      
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F012-REG-NOMCP3 TO WS-REG-QTY ( 7 , 4 , 3)                      
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 7 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 7 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
      ** MOVE ZEROES TO SUB-TOTAL ROW                                           
                                                                                
            MOVE ZEROES TO WS-REG-QTY ( 9 , WS-FLATNO , 1 )                     
                           WS-REG-QTY ( 9 , WS-FLATNO , 2 )                     
                           WS-REG-QTY ( 9 , WS-FLATNO , 3 )                     
                           WS-REG-QTY ( 9 , WS-FLATNO , 4 ).                    
                                                                                
      ** MOVE ZEROES TO SUB-TOTAL ROW, TOTALS COLUMN                            
                                                                                
            MOVE ZEROES TO WS-REG-QTY ( 9 , 4 , 1 )                             
                           WS-REG-QTY ( 9 , 4 , 2 )                             
                           WS-REG-QTY ( 9 , 4 , 3 )                             
                           WS-REG-QTY ( 9 , 4 , 4 ).                            
                                                                                
       3300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4000-COMPUTE-BALANCE.                                                    
      ******************************************************************        
            PERFORM 4100-COMP-BY-SCHEME-TYPE THRU 4100-EXIT                     
                    VARYING WS-CNT FROM 1 BY 1 UNTIL WS-CNT > 8.                
       4000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4100-COMP-BY-SCHEME-TYPE.                                                
      ******************************************************************        
            PERFORM 4200-COMP-BY-FLAT-TYPE  THRU 4200-EXIT                      
                    VARYING WS-XCNT FROM 1 BY 1 UNTIL WS-XCNT > 3.              
       4100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4200-COMP-BY-FLAT-TYPE.                                                  
      ******************************************************************        
      ** COMPUTE  BALANCE UNDER EACH CATEGORY , FLAT TYPE                       
      ** AND SCHEME TYPE                                                        
                                                                                
            COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 1) =                        
               WS-SUP-QTY ( WS-CNT , WS-XCNT , 1)  -                            
               WS-REG-QTY ( WS-CNT , WS-XCNT , 1).                              
                                                                                
            COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 2) =                        
               WS-SUP-QTY ( WS-CNT , WS-XCNT , 2)  -                            
               WS-REG-QTY ( WS-CNT , WS-XCNT , 2).                              
                                                                                
            COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 3) =                        
               WS-SUP-QTY ( WS-CNT , WS-XCNT , 3)  -                            
               WS-REG-QTY ( WS-CNT , WS-XCNT , 3).                              
                                                                                
            COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 4) =                        
               WS-SUP-QTY ( WS-CNT , WS-XCNT , 4)  -                            
               WS-REG-QTY ( WS-CNT , WS-XCNT , 4).                              
                                                                                
      ** COMPUTE SUB-TOTAL BALANCE UNDER EACH CATEGORY AND FLAT TYPE.           
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 1)  TO                          
                   WS-BAL-QTY ( 9 , WS-XCNT , 1).                               
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 2)  TO                          
                   WS-BAL-QTY ( 9 , WS-XCNT , 2).                               
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 3)  TO                          
                   WS-BAL-QTY ( 9 , WS-XCNT , 3).                               
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 4)  TO                          
                   WS-BAL-QTY ( 9 , WS-XCNT , 4).                               
                                                                                
      ** MOVE ZEROES TO SUB-TOTAL ROW                                           
                                                                                
            MOVE ZEROES TO WS-BAL-QTY ( 9 , WS-XCNT , 1 )                       
                           WS-BAL-QTY ( 9 , WS-XCNT , 2 )                       
                           WS-BAL-QTY ( 9 , WS-XCNT , 3 )                       
                           WS-BAL-QTY ( 9 , WS-XCNT , 4 ).                      
                                                                                
      ** COMPUTE TOTAL BALANCE UNDER EACH CATEGORY AND SCHEME TYPE              
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 1)  TO                          
                   WS-BAL-QTY ( 9 , 4 , 1)                                      
                   WS-BAL-QTY ( WS-CNT , 4 , 1).                                
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 2)  TO                          
                   WS-BAL-QTY ( 9 , 4 , 2)                                      
                   WS-BAL-QTY ( WS-CNT , 4 , 2).                                
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 3)  TO                          
                   WS-BAL-QTY ( 9 , 4 , 3)                                      
                   WS-BAL-QTY ( WS-CNT , 4 , 3).                                
                                                                                
            ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 4)  TO                          
                   WS-BAL-QTY ( 9 , 4 , 4)                                      
                   WS-BAL-QTY ( WS-CNT , 4 , 4).                                
                                                                                
      ** MOVE ZEROES TO SUB-TOTAL ROW, TOTALS COLUMN                            
                                                                                
            MOVE ZEROES TO WS-BAL-QTY ( 9 , 4 , 1 )                             
                           WS-BAL-QTY ( 9 , 4 , 2 )                             
                           WS-BAL-QTY ( 9 , 4 , 3 )                             
                           WS-BAL-QTY ( 9 , 4 , 4 ).                            
                                                                                
       4200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       5000-PRINT-FLAT-SUMMARY.                                                 
      ******************************************************************        
            PERFORM 6000-PRINT-REPORT-HEADING  THRU 6000-EXIT.                  
                                                                                
            MOVE  SPACES                TO  L502-PRT-DETAILS.                   
            MOVE 'SUPPLY'               TO  WS-NME-TYPE.                        
            MOVE  WS-FLAT-SUPPLY-TABLE  TO  WS-FLAT-COM-TABLE.                  
                                                                                
            PERFORM 6100-PRINT-SUB-HEADING  THRU 6100-EXIT.                     
                                                                                
            PERFORM 5100-PRINT-FLAT-DETAILS  THRU 5100-EXIT                     
                    VARYING WS-CNT FROM 1 BY 1  UNTIL WS-CNT > 9.               
                                                                                
            MOVE 'REGISTERED'               TO  WS-NME-TYPE.                    
            MOVE  WS-FLAT-REGISTERED-TABLE  TO  WS-FLAT-COM-TABLE.              
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
                                                                                
            PERFORM 5100-PRINT-FLAT-DETAILS  THRU 5100-EXIT                     
                    VARYING WS-CNT FROM 1 BY 1  UNTIL WS-CNT > 9.               
                                                                                
            MOVE 'BALANCE'                  TO  WS-NME-TYPE.                    
            MOVE  WS-FLAT-BALANCE-TABLE     TO  WS-FLAT-COM-TABLE.              
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
                                                                                
            PERFORM 5100-PRINT-FLAT-DETAILS  THRU 5100-EXIT                     
                    VARYING WS-CNT FROM 1 BY 1  UNTIL WS-CNT > 9.               
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       5100-PRINT-FLAT-DETAILS.                                                 
      ******************************************************************        
            EVALUATE WS-CNT                                                     
                WHEN 1                                                          
                     MOVE  'PUBLIC'    TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
                WHEN 2                                                          
                     MOVE  'MCPS-H'    TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
                WHEN 3                                                          
                     MOVE  'MCPS-G'    TO  L502-NME-SCHEME                      
                     MOVE  WS-NME-TYPE TO  L502-NME-TYPE                        
                WHEN 4                                                          
                     MOVE  'NO-MCPS-H' TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
                WHEN 5                                                          
                     MOVE  'NO-MCPS-G' TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
                WHEN 6                                                          
                     MOVE  'MCPS/FT'   TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
                WHEN 7                                                          
                     MOVE  'NO-MCP/UG' TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
                WHEN 8                                                          
      **             MOVE  'TCP'       TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
                WHEN 9                                                          
                     MOVE  'SUB-TOTAL' TO  L502-NME-SCHEME                      
                     MOVE  SPACES      TO  L502-NME-TYPE                        
            END-EVALUATE.                                                       
                                                                                
            PERFORM 5200-SETUP-FLAT-TYPE-QTY THRU 5200-EXIT                     
                    VARYING WS-XCNT FROM 1 BY 1 UNTIL WS-XCNT > 4.              
                                                                                
            WRITE PRINT-REC  FROM L502-PRT-DETAILS.                             
                                                                                
            IF WS-CNT < 9                                                       
               MOVE ALL '-' TO PRINT-REC                                        
               WRITE PRINT-REC                                                  
            END-IF.                                                             
       5100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       5200-SETUP-FLAT-TYPE-QTY.                                                
      ******************************************************************        
            MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 1 )                           
                 TO  L502-PRT-CAT1 (WS-XCNT).                                   
                                                                                
            MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 2 )                           
                 TO  L502-PRT-CAT2 (WS-XCNT).                                   
                                                                                
            MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 3 )                           
                 TO  L502-PRT-CAT3 (WS-XCNT).                                   
                                                                                
            MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 4 )                           
                 TO  L502-PRT-TOT (WS-XCNT).                                    
       5200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       6000-PRINT-REPORT-HEADING.                                               
      ******************************************************************        
            ADD        1       TO WS-CNT-PAGE.                                  
            MOVE  WS-CNT-PAGE  TO L502-PAGENO.                                  
            MOVE  WS-PREV-NT   TO L502-CDE-NT.                                  
            WRITE PRINT-REC FROM L502-PRT-HEADING-1 AFTER PAGE.                 
            WRITE PRINT-REC FROM L502-PRT-HEADING-3.                            
       6000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       6100-PRINT-SUB-HEADING.                                                  
      ******************************************************************        
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC AFTER 1.                                            
                                                                                
            WRITE PRINT-REC FROM L502-PRT-HEADING-5.                            
            WRITE PRINT-REC FROM L502-PRT-HEADING-6.                            
            WRITE PRINT-REC FROM L502-PRT-HEADING-7.                            
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
       6100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       9999-CLOSE-FILES.                                                        
      ******************************************************************        
            CLOSE  BP13F012                                                     
                   BP13F713                                                     
                   BP13L502.                                                    
            STOP RUN.                                                           
       9999-EXIT.                                                               
            EXIT.                                                               
      *-------------------------------------------------------------*           
      *                             END                             *           
      *-------------------------------------------------------------*           
