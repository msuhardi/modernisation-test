       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C395.                                                 
      *AUTHOR.        SN.                                                       
      *DATE-WRITTEN.  15/05/01.                                                 
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      *    OBJECTIVE  :                                            *            
      *        1.  THIS PROGRAMME WILL CREATE THE GL DETAIL        *            
      *            TRANSACTION FILE BP13F180 FOR THE VARIOUS       *            
      *            FEES RAISED AND RECEIVED ON A MONTHLY BASIS.    *            
      *                                                            *            
      *     INPUT FILES:  1. BP13F120                              *            
      *                   2. BP13K690 - GRANT                      *            
      *     OUTPUT FILES: 1. BP13F180                              *            
      *     LISTING:      1. BP13L395 (CONTROL LIST)               *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG-NO  BY   DATE    DESCRIPTION                           *            
      * ------- --- ------   -----------                           *            
      * BP131000 SN   02052001  NEW PGM                            *            
      * BP131000 SN   31052001  ADD GL-CODE IN THE REPORT          *            
      * BP131039 SN   12072001  GET SY02-SYS-DATE AS TRANS-DATE    *            
      * BP132292 SK   07102003  TO CATER TYPE 35 & 36              *            
      * BP132571 LSB  09072004  ENHANCE  TYPE 35 & 36, BATCH-TOTAL *            
      * BP134034 ESA1 04112010  CATER FOR NEW ERP GL ACCOUNTS      *            
      * BP134034 ESD1 10022011  CATER FOR INTERFACE FILE TO ERP    *            
      * BP135903 FNP1 02112015  CATER LBS/FLEXI LEASE              *            
      * BP13XXXX FNP1 22022016  REMOVE GL FOR GRANTS                            
      * BP136398 FNP1 26082016  ADD GL FOR SRG AND REG                          
      * BP136965 FNP1 25082017  INCLUDE ACCUM IN COMPUTING FOR AMT *            
      *                         FOR SRG FOR TRANS = 35/36          *            
      * BP138944 FP6  15102021  EXPAND K690 FROM 600 TO 800        *            
      * ********************************************************** *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F120 ASSIGN TO  BP13F120.                                 
                                                                                
           SELECT SY02F001 ASSIGN TO  SY02F001.                                 
                                                                                
           SELECT BP13F180 ASSIGN TO BP13F180.                                  
                                                                                
           SELECT BP13K690 ASSIGN       TO BP13K690                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K690-KEY-FLD                         
                           FILE STATUS  IS K690-STATUS.                         
                                                                                
           SELECT BP13L395 ASSIGN TO BP13L395.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F120                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORDING MODE F                                                     
           RECORD CONTAINS 150 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F120.                                                           
                                                                                
       FD  BP13F180                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORDING MODE F                                                     
           RECORD CONTAINS 120 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       COPY BP13F180.                                                           
                                                                                
       FD  BP13K690                                                             
           RECORD CONTAINS 800 CHARACTERS.                                      
       COPY BP13K690.                                                           
                                                                                
       FD BP13L395                                                              
           BLOCK CONTAINS 0 RECORDS                                             
           RECORDING MODE F                                                     
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           DATA RECORD IS BP13L395-REPORT.                                      
       01  BP13L395-REPORT               PIC X(132).                            
                                                                                
       COPY SY02F001.                                                           
                                                                                
      *                                                                         
       WORKING-STORAGE SECTION.                                                 
       01  WS-F120-EOF-FLAG               PIC X          VALUE 'N'.             
       01  WS-F180-EOF-FLAG               PIC X          VALUE 'N'.             
       01  K690-STATUS                    PIC 99         VALUE ZEROS.           
       01  WS-K690-FOUND                  PIC X          VALUE 'N'.             
       01  WS-DR-DEFER-AMT                PIC S9(11)V99   VALUE ZEROS.          
       01  WS-CR-DEFER-AMT                PIC S9(11)V99   VALUE ZEROS.          
       01  WS-F180-CASES                  PIC 9(5)       VALUE ZEROS.           
       01  WS-F180-CASES1                 PIC 9(5)       VALUE ZEROS.           
       01  WS-CR-1RM                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-DR-1RM                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-F180-CASES2                 PIC 9(5)       VALUE ZEROS.           
       01  WS-CR-2RM                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-DR-2RM                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-CR-TOT                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-DR-TOT                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-CR-CASES                    PIC 9(5)       VALUE ZEROS.           
       01  WS-DR-CASES                    PIC 9(5)       VALUE ZEROS.           
       01  WS-F180-CASES3                 PIC 9(5)       VALUE ZEROS.           
       01  WS-F180-CASES4                 PIC 9(5)       VALUE ZEROS.           
       01  WS-F180-CASES5                 PIC 9(5)       VALUE ZEROS.           
       01  WS-DEFER-GL                    PIC X(13)      VALUE SPACES.          
       01  WS-GL-1RM                      PIC X(13)      VALUE SPACES.          
       01  WS-GL-2RM                      PIC X(13)      VALUE SPACES.          
       01  WS-READ-F120-COUNT             PIC 9(5)       VALUE ZEROS.           
       01  WS-WRITE-F180-COUNT            PIC 9(5)       VALUE ZEROS.           
       01  K690-FND-CNT                   PIC 9(5)       VALUE ZEROS.           
       01  K690-NFND-CNT                  PIC 9(5)       VALUE ZEROS.           
       01  WS-F180-PERIOD                 PIC 9(2)       VALUE ZEROS.           
       01  WS-K690-READ                   PIC 9(5)       VALUE ZEROS.           
       01  WS-TOT-F180-CREDIT             PIC 9(5)       VALUE ZEROS.           
       01  WS-TOT-F180-DEBIT              PIC 9(5)       VALUE ZEROS.           
       01  WS-PAGE-COUNT                  PIC 99         VALUE ZEROS.           
       01  WS-TEM-K040-KEY.                                                     
           05  WS-TEM-K040-NUM-SCHM       PIC X(4).                             
           05  WS-TEM-K040-NUM-ACCT       PIC X(4).                             
           05  WS-TEM-K040-NUM-CHK-DG     PIC X.                                
       01  WS-YEAR                        PIC 999.                              
       01  WS-LEAP-YEAR                   PIC 99.                               
       01  WS-ODD-MONTH                   PIC 9.                                
       01  WS-MONTH                       PIC X(2).                             
           88  CHECK-MM         VALUE '04' '06' '09' '11'.                      
           88  CHECK-FEB        VALUE '02'.                                     
       01  SY02F001-EOF                   PIC X(01)    VALUE 'N'.               
       01  WS-NUM-BACKDATE                PIC X(01)    VALUE SPACES.            
                                                                                
       01  WS-GL-ACCT-VARS.                                                     
           05 WS-ACC-NO1.                                                       
              10 WS-ACC-LEAD              PIC X(01).                            
              10 WS-ACC-INTERNAL          PIC X(06).                            
              10 WS-ACC-FILLER            PIC X(02).                            
              10 WS-ACC-GL                PIC X(04).                            
                                                                                
       01  WS-GRANT-VARIABLES.                                                  
          05  WS-DR-SRG-AMT               PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-SRG-AMT               PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-REG-AMT               PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-REG-AMT               PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-SRG                   PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-SRG                   PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-REG                   PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-REG                   PIC 9(3)        VALUE ZEROS.          
          05  WS-SRG-GL                   PIC X(13)       VALUE SPACES.         
          05  WS-REG-GL                   PIC X(13)       VALUE SPACES.         
          05  WS-DR-AMORT-AMT-SRG-1RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SRG-2RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SRG-1RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SRG-2RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-REG-1RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-REG-2RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-REG-1RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-REG-2RM     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-SRG-1RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SRG-2RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SRG-1RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SRG-2RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-REG-1RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-REG-2RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-REG-1RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-REG-2RM         PIC 9(3)        VALUE ZEROS.          
          05  WS-GL-SRG-1RM               PIC X(13)       VALUE SPACES.         
          05  WS-GL-SRG-2RM               PIC X(13)       VALUE SPACES.         
          05  WS-GL-REG-1RM               PIC X(13)       VALUE SPACES.         
          05  WS-GL-REG-2RM               PIC X(13)       VALUE SPACES.         
                                                                                
                                                                                
      ****************************************************************          
      *    WORKING STORAGE FOR SYSTEM DATE FOR EDITING INTO REPORT   *          
      *    DATE.                                                     *          
      ****************************************************************          
       01  WS-CURRENT-DATE.                                                     
           05 CURRENT-CC                  PIC 99.                               
           05 CURRENT-YY                  PIC 99.                               
           05 CURRENT-MM                  PIC 99.                               
           05 CURRENT-DD                  PIC 99.                               
      ****************************************************************          
      *    GET K160-DTE-OPEN-BF AS GL TRANS DATE FOR MONTH           *          
      ****************************************************************          
       01  WS-F180-TRANS-DATE.                                                  
           05 WS-F180-TRANS-CCYY          PIC 9(4).                             
           05 WS-F180-TRANS-CCYY-N REDEFINES WS-F180-TRANS-CCYY.                
              10 WS-F180-TRANS-CC         PIC 99.                               
              10 WS-F180-TRANS-YY         PIC 99.                               
           05 WS-F180-TRANS-MM            PIC 99.                               
           05 WS-F180-TRANS-DD            PIC 99.                               
                                                                                
      ****************************************************************          
      *    PAGE TITLE FOR REPORT BP13L395.                           *          
      ****************************************************************          
       01  WS-TITLE-1.                                                          
           05  FILLER               PIC X(8)     VALUE 'BP13L395'.              
           05  FILLER               PIC X(6)     VALUE SPACES.                  
           05  FILLER               PIC X(4)     VALUE 'HDB3'.                  
           05  FILLER               PIC X(28)    VALUE SPACES.                  
           05  FILLER               PIC X(39)    VALUE                          
           'S Y S T E M   O F   C O M M I T M E N T'.                           
           05  FILLER               PIC X(13)    VALUE SPACES.                  
           05  FILLER               PIC X(7)     VALUE 'DATE : '.               
           05  L395-EDITED-DATE.                                                
               10  CURRENT-DD       PIC 99.                                     
               10  FILLER           PIC X        VALUE '/'.                     
               10  CURRENT-MM       PIC 99.                                     
               10  FILLER           PIC X        VALUE '/'.                     
               10  CURRENT-CC       PIC 99.                                     
               10  CURRENT-YY       PIC 99.                                     
           05  FILLER               PIC X(3)     VALUE SPACES.                  
           05  FILLER               PIC X(7)     VALUE 'PAGE : '.               
           05  L395-PAGE            PIC ZZZZ9.                                  
                                                                                
       01  WS-TITLE-2.                                                          
           05  FILLER                     PIC X(37)      VALUE SPACES.          
           05  FILLER                     PIC X(57)      VALUE                  
            'REPORT ON DEBITS AND CREDITS TO AND FROM CLEARING ACCOUNT'.        
           05  FILLER                     PIC X(38)      VALUE SPACES.          
                                                                                
       01  WS-TITLE-3.                                                          
           05  FILLER                     PIC X(48)      VALUE SPACES.          
           05  FILLER                     PIC X(36)      VALUE                  
            'BP13F120 AND GENERAL LEDGER BP13F180'.                             
           05  FILLER                     PIC X(48)      VALUE SPACES.          
                                                                                
      ******************************************************************        
      *    HEADERS FOR TOTAL NUMBER OF RECORDS READ/WRITTEN FROM/TO    *        
      *    FILES BP13F120 AND BP13F180.                                *        
      ******************************************************************        
       01  WS-HEADER-LINE-1.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  L395-READ-F120-CNT         PIC ZZZZ9.                            
           05  FILLER                     PIC X(44)      VALUE                  
               ' RECORDS READ FROM CLEARING ACCOUNT BP13F120'.                  
           05  FILLER                     PIC X(53)      VALUE SPACES.          
                                                                                
       01  WS-HEADER-LINE-2.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  L395-WRITE-F180-CNT        PIC ZZZZ9.                            
           05  FILLER                     PIC X(44)      VALUE                  
               ' RECORDS WRITTEN TO GENERAL LEDGER  BP13F180'.                  
           05  FILLER                     PIC X(53)      VALUE SPACES.          
      ******************************************************************        
      *    SUMMARY OF NUMBER OF CREDITS AND DEBITS RECORDS TRANSFERED  *        
      *    ACCORDING TO PAYMENT TYPES.                                 *        
      ******************************************************************        
       01  WS-SUMMARY-HEADER-1.                                                 
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(44)      VALUE                  
               'SUMMARY OF RECORDS WRITTEN TO GENERAL LEDGER'.                  
           05  FILLER                     PIC X(58)      VALUE SPACES.          
                                                                                
       01  WS-SUMMARY-HEADER-2.                                                 
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(20)      VALUE                  
               'PAYMENT TYPE        '.                                          
           05  FILLER                     PIC X(4)       VALUE SPACES.          
           05  FILLER                     PIC X(6)       VALUE                  
               'DEBITS'.                                                        
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(7)       VALUE                  
               'CREDITS'.                                                       
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(15)      VALUE                  
               'AMT DEBITED ($)'.                                               
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(15)      VALUE                  
               'AMT CREDITED($)'.                                               
           05  FILLER                     PIC X(26)      VALUE SPACES.          
                                                                                
       01  WS-SUMMARY-DETAIL-1.                                                 
           05  FILLER                     PIC X(19)      VALUE SPACES.          
           05  FILLER                     PIC X(18)      VALUE                  
               'DEFERRED INCOME  ('.                                            
           05  L395-DEFER-GL              PIC X(13)      VALUE SPACES.          
           05  FILLER                     PIC X(1)       VALUE ')'.             
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  L395-DR-CASES              PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L395-CR-CASES              PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L395-DR-DEFER-DEBIT        PIC ZZZZZZZZZZ9.99.                   
           05  FILLER                     PIC X(02)      VALUE SPACES.          
           05  L395-CR-DEFER-CREDIT       PIC ZZZZZZZZZZ9.99.                   
                                                                                
                                                                                
       01  WS-SUMMARY-DETAIL-2.                                                 
           05  FILLER                     PIC X(19)      VALUE SPACES.          
           05  L395-AMORT-DESC            PIC X(17)      VALUE SPACES.          
           05  FILLER                     PIC X(1)       VALUE '('.             
           05  L395-AMORT-GL              PIC X(13)      VALUE SPACES.          
           05  FILLER                     PIC X(1)       VALUE ')'.             
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  L395-DR-AMORT-CASES        PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L395-CR-AMORT-CASES        PIC ZZZZ9.                            
           05  FILLER                     PIC X(02)      VALUE SPACES.          
           05  L395-DR-AMORT-DEBIT        PIC ZZZZZZZZZZ9.99.                   
           05  FILLER                     PIC X(02)      VALUE SPACES.          
           05  L395-CR-AMORT-CREDIT       PIC ZZZZZZZZZZ9.99.                   
                                                                                
                                                                                
                                                                                
       01  WS-FOOTER-LINE-1.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(20)      VALUE                  
               'TOTAL               '.                                          
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  L395-DR-CASES-TOT          PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L395-CR-CASES-TOT          PIC ZZZZ9.                            
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  L395-DR-TOT                PIC ZZZZZZZZZ9.99.                    
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  L395-CR-TOT                PIC ZZZZZZZZZ9.99.                    
           05  FILLER                     PIC X(26)      VALUE SPACES.          
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       000-MAINT-ROUTINE.                                                       
                                                                                
           PERFORM 100-OPEN-FILE             THRU 100-EXIT.                     
           PERFORM 200-READ-F120             THRU 200-EXIT.                     
           PERFORM 300-PROCESS-GLTRAN-DETAIL THRU 300-EXIT                      
                   UNTIL WS-F120-EOF-FLAG = 'Y'.                                
           PERFORM 700-PRINT-REPORT          THRU 700-EXIT.                     
           PERFORM 999-CLOSE-FILES           THRU 999-EXIT.                     
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ***************************************************************           
      *    OPENING FILES SECTION                                    *           
      ***************************************************************           
       100-OPEN-FILE.                                                           
           OPEN INPUT BP13F120                                                  
                      BP13K690                                                  
                      SY02F001                                                  
               OUTPUT BP13F180                                                  
                      BP13L395.                                                 
                                                                                
           IF K690-STATUS NOT = 00 AND 97                                       
              MOVE K690-STATUS          TO RETURN-CODE                          
              DISPLAY 'ERROR OPENING BM06K690 FILE ' K690-STATUS                
              GO TO 999-CLOSE-FILES.                                            
                                                                                
           READ SY02F001 AT END MOVE 'Y' TO SY02F001-EOF.                       
           IF SY02F001-EOF = 'Y'                                                
              DISPLAY 'RECORD NOT FOUND IN SY02F001.'                           
              DISPLAY 'PROCESSING TERMINATED.'                                  
              PERFORM 999-CLOSE-FILES                                           
           ELSE                                                                 
              MOVE F001-DTE-CURRENT TO WS-F180-TRANS-DATE                       
           END-IF.                                                              
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    READ FILE BP13F120 FROM THE BEGINING                       *         
      *****************************************************************         
       200-READ-F120.                                                           
                                                                                
           READ BP13F120  AT END                                                
                MOVE 'Y' TO WS-F120-EOF-FLAG                                    
                GO TO 200-EXIT.                                                 
           PERFORM 600-CHK-PERIOD    THRU 600-EXIT.                             
           PERFORM 610-CHK-TRAN-DTE  THRU 610-EXIT.                             
           ADD 1 TO WS-READ-F120-COUNT.                                         
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    CHECKS FOR THE PAYMENT TYPE AND TRANSFER CONTROL TO CHECK   *        
      *    FOR TRANSACTION TYPE.                                       *        
      ******************************************************************        
       300-PROCESS-GLTRAN-DETAIL.                                               
                                                                                
           MOVE SPACES TO WS-NUM-BACKDATE.                                      
           IF F120-CDE-PAYMENT-TYPE = 'SA1' OR 'SA2'                            
              PERFORM 330-READ-BP13K690   THRU 330-EXIT                         
              PERFORM 310-PROCESS-REG-FEE THRU 310-EXIT                         
           END-IF.                                                              
                                                                                
           PERFORM 200-READ-F120          THRU 200-EXIT.                        
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
      *************************************************************             
      *    CHECKING FOR TRANSACTION TYPE FOR                      *             
      *    CDE-TRANS-TYPE = 27                                    *             
      *    CDE-TRANS-TYPE = 28                                    *             
      *************************************************************             
       310-PROCESS-REG-FEE.                                                     
           IF F120-CDE-TRANS-TYPE = '27'                                        
              PERFORM 400-DR-DEFER      THRU 400-EXIT                           
              PERFORM 500-CR-AMORT-1RM  THRU 500-EXIT                           
              IF WS-K690-FOUND = 'Y'                                            
                 PERFORM 410-DR-GRANT       THRU 410-EXIT                       
                 PERFORM 520-CR-AMORT-OTHER THRU 520-EXIT                       
              END-IF                                                            
           ELSE                                                                 
           IF F120-CDE-TRANS-TYPE = '28'                                        
              PERFORM 400-DR-DEFER      THRU 400-EXIT                           
              PERFORM 510-CR-AMORT-2RM  THRU 510-EXIT                           
              IF WS-K690-FOUND = 'Y'                                            
                 PERFORM 410-DR-GRANT       THRU 410-EXIT                       
                 PERFORM 520-CR-AMORT-OTHER THRU 520-EXIT                       
              END-IF                                                            
           ELSE                                                                 
           IF F120-CDE-TRANS-TYPE = '35'                                        
              PERFORM 401-CR-DEFER      THRU 401-EXIT                           
              PERFORM 501-DR-AMORT-1RM  THRU 501-EXIT                           
              IF WS-K690-FOUND = 'Y'                                            
                 PERFORM 410-DR-GRANT       THRU 410-EXIT                       
                 PERFORM 520-CR-AMORT-OTHER THRU 520-EXIT                       
      *          PERFORM 420-CR-GRANT       THRU 420-EXIT                       
      *          PERFORM 530-DR-AMORT-OTHER THRU 530-EXIT                       
              END-IF                                                            
           ELSE                                                                 
           IF F120-CDE-TRANS-TYPE = '36'                                        
              PERFORM 401-CR-DEFER      THRU 401-EXIT                           
              PERFORM 511-DR-AMORT-2RM  THRU 511-EXIT                           
              IF WS-K690-FOUND = 'Y'                                            
                 PERFORM 410-DR-GRANT       THRU 410-EXIT                       
                 PERFORM 520-CR-AMORT-OTHER THRU 520-EXIT                       
      *          PERFORM 420-CR-GRANT       THRU 420-EXIT                       
      *          PERFORM 530-DR-AMORT-OTHER THRU 530-EXIT                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       310-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *    READ BP13K690 TO GET THE AMORT AMOUNT FOR GRANT AND FOR     *        
      *    PREMIUM                                                     *        
      ******************************************************************        
       330-READ-BP13K690.                                                       
                                                                                
           MOVE SPACES            TO K690-KEY-FLD.                              
           MOVE F120-NUM-SCH-ACCT TO K690-KEY-FLD.                              
                                                                                
           READ BP13K690.                                                       
                                                                                
           EVALUATE K690-STATUS                                                 
             WHEN 00                                                            
                MOVE 'Y' TO WS-K690-FOUND                                       
                ADD 1 TO K690-FND-CNT                                           
                PERFORM 340-INITIALIZE-FIELDS    THRU 340-EXIT                  
             WHEN 23                                                            
                MOVE 'N' TO WS-K690-FOUND                                       
                ADD 1 TO K690-NFND-CNT                                          
             WHEN OTHER                                                         
                DISPLAY 'BP13K690 READ ERROR, STATUS IS '                       
                       K690-STATUS ' KEY IS ' K690-KEY-FLD                      
                       MOVE K690-STATUS TO RETURN-CODE                          
                PERFORM 999-CLOSE-FILES  THRU 999-EXIT                          
           END-EVALUATE.                                                        
                                                                                
       330-EXIT.                                                                
           EXIT.                                                                
                                                                                
       340-INITIALIZE-FIELDS.                                                   
                                                                                
           IF K690-AMT-AMORT-INCOME-ACCUM > K690-AMT-AMORT-INCOME-MTH           
              IF F120-AMT-RECEIPT = K690-AMT-AMORT-INCOME-ACCUM                 
                 MOVE 'Y' TO WS-NUM-BACKDATE                                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K690-AMT-SRG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-SRG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SRG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SRG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SRG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SRG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-REG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-REG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-REG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-REG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-REG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-REG-ACCUM                           
           END-IF.                                                              
                                                                                
       340-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    DEFERRED INCOME                                                      
      *****************************************************************         
       400-DR-DEFER.                                                            
                                                                                
           MOVE SPACES              TO   F180-GL-REC.                           
           MOVE ZEROES              TO   F180-AMT-GST-RATE.                     
           MOVE 'SA'                TO   F180-JR-SC.                            
           MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY.              
           MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM.              
           MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD.                         
           MOVE WS-F180-PERIOD      TO   F180-PERIOD.                           
           MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC.                      
           MOVE F120-AMT-RECEIPT    TO   F180-CR-AMT.                           
           MOVE '0000000574033'     TO   F180-ACC-NO1                           
                                         WS-DEFER-GL.                           
           MOVE 'DEFERRED INCOME  ' TO   F180-TRANS-DESC.                       
           ADD F180-CR-AMT          TO   WS-DR-DEFER-AMT.                       
           WRITE F180-GL-REC.                                                   
           ADD 1                    TO   WS-WRITE-F180-COUNT.                   
           ADD 1                    TO   WS-F180-CASES.                         
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    DEFERRED INCOME                                                      
      *****************************************************************         
       401-CR-DEFER.                                                            
                                                                                
           MOVE SPACES              TO   F180-GL-REC.                           
           MOVE ZEROES              TO   F180-AMT-GST-RATE.                     
           MOVE 'SA'                TO   F180-JR-SC.                            
           MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY.              
           MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM.              
           MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD.                         
           MOVE WS-F180-PERIOD      TO   F180-PERIOD.                           
           MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC.                      
           MOVE F120-AMT-RECEIPT    TO   F180-CR-AMT.                           
           MOVE '0000000574033'     TO   F180-ACC-NO1                           
                                         WS-DEFER-GL.                           
           MOVE 'DEFERRED INCOME  ' TO   F180-TRANS-DESC.                       
           ADD      F180-CR-AMT     TO   WS-CR-DEFER-AMT.                       
           WRITE F180-GL-REC.                                                   
           ADD 1                    TO   WS-WRITE-F180-COUNT.                   
           ADD 1                    TO   WS-F180-CASES1.                        
                                                                                
       401-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
       410-DR-GRANT.                                                            
                                                                                
                                                                                
      ***SRG GRANT                                                              
           IF K690-AMT-SRG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE 'SA'                TO   F180-JR-SC                          
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              MOVE 'SRG'               TO   F180-DTE-POST                       
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = K690-AMT-AMORT-SRG-ACCUM                 
              ELSE                                                              
                 IF F120-CDE-TRANS-TYPE = '35' OR '36'                          
                    COMPUTE F180-CR-AMT = K690-AMT-SRG-GRANT -                  
                                          K690-AMT-AMORT-SRG-ACCUM              
                 ELSE                                                           
                    COMPUTE F180-CR-AMT = K690-AMT-AMORT-SRG-MTH                
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '9'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '407300'            TO   WS-ACC-INTERNAL                     
              EVALUATE F120-CDE-TRANS-TYPE                                      
                WHEN '27'                                                       
                WHEN '35'                                                       
                  MOVE '5050'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT SRG GRANT OF 1RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-DR-AMORT-SRG-1RM                 
                  ADD F180-CR-AMT      TO   WS-DR-AMORT-AMT-SRG-1RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-SRG-1RM                       
                                            F180-ACC-NO1                        
                WHEN '28'                                                       
                WHEN '36'                                                       
                  MOVE '5052'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT SRG GRANT OF 2RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-DR-AMORT-SRG-2RM                 
                  ADD F180-CR-AMT      TO   WS-DR-AMORT-AMT-SRG-2RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-SRG-2RM                       
                                            F180-ACC-NO1                        
              END-EVALUATE                                                      
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF K690-AMT-REG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE 'SA'                TO   F180-JR-SC                          
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              MOVE 'REG'               TO   F180-DTE-POST                       
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = K690-AMT-AMORT-REG-ACCUM                 
              ELSE                                                              
                 IF F120-CDE-TRANS-TYPE = '35' OR '36'                          
                    COMPUTE F180-CR-AMT = K690-AMT-REG-GRANT -                  
                                          K690-AMT-AMORT-REG-ACCUM              
                 ELSE                                                           
                    COMPUTE F180-CR-AMT = K690-AMT-AMORT-REG-MTH                
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '9'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '419200'            TO   WS-ACC-INTERNAL                     
              EVALUATE F120-CDE-TRANS-TYPE                                      
                WHEN '27'                                                       
                WHEN '35'                                                       
                  MOVE '5050'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT REG GRANT OF 1RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-DR-AMORT-REG-1RM                 
                  ADD F180-CR-AMT      TO   WS-DR-AMORT-AMT-REG-1RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-REG-1RM                       
                                            F180-ACC-NO1                        
                WHEN '28'                                                       
                WHEN '36'                                                       
                  MOVE '5052'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT REG GRANT OF 2RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-DR-AMORT-REG-2RM                 
                  ADD F180-CR-AMT      TO   WS-DR-AMORT-AMT-REG-2RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-REG-2RM                       
                                            F180-ACC-NO1                        
              END-EVALUATE                                                      
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
       410-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
       420-CR-GRANT.                                                            
                                                                                
      ***SRG GRANT                                                              
           IF K690-AMT-SRG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE 'SA'                TO   F180-JR-SC                          
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              MOVE 'SRG'               TO   F180-DTE-POST                       
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = K690-AMT-AMORT-SRG-ACCUM                 
              ELSE                                                              
                 IF F120-CDE-TRANS-TYPE = '35' OR '36'                          
                    COMPUTE F180-CR-AMT = K690-AMT-SRG-GRANT -                  
                                          K690-AMT-AMORT-SRG-ACCUM              
                 ELSE                                                           
                    COMPUTE F180-CR-AMT = K690-AMT-AMORT-SRG-MTH                
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '9'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '407300'            TO   WS-ACC-INTERNAL                     
              EVALUATE F120-CDE-TRANS-TYPE                                      
                WHEN '27'                                                       
                WHEN '35'                                                       
                  MOVE '5050'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT SRG GRANT OF 1RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-CR-AMORT-SRG-1RM                 
                  ADD F180-CR-AMT      TO   WS-CR-AMORT-AMT-SRG-1RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-SRG-1RM                       
                                            F180-ACC-NO1                        
                WHEN '28'                                                       
                WHEN '36'                                                       
                  MOVE '5052'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT SRG GRANT OF 2RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-CR-AMORT-SRG-2RM                 
                  ADD F180-CR-AMT      TO   WS-CR-AMORT-AMT-SRG-2RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-SRG-2RM                       
                                            F180-ACC-NO1                        
              END-EVALUATE                                                      
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF K690-AMT-REG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE 'SA'                TO   F180-JR-SC                          
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              MOVE 'REG'               TO   F180-DTE-POST                       
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = K690-AMT-AMORT-REG-ACCUM                 
              ELSE                                                              
                 IF F120-CDE-TRANS-TYPE = '35' OR '36'                          
                    COMPUTE F180-CR-AMT = K690-AMT-REG-GRANT -                  
                                          K690-AMT-AMORT-REG-ACCUM              
                 ELSE                                                           
                    COMPUTE F180-CR-AMT = K690-AMT-AMORT-REG-MTH                
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '9'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '419200'            TO   WS-ACC-INTERNAL                     
              EVALUATE F120-CDE-TRANS-TYPE                                      
                WHEN '27'                                                       
                WHEN '35'                                                       
                  MOVE '5050'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT REG GRANT OF 1RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-CR-AMORT-REG-1RM                 
                  ADD F180-CR-AMT      TO   WS-CR-AMORT-AMT-REG-1RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-REG-1RM                       
                                            F180-ACC-NO1                        
                WHEN '28'                                                       
                WHEN '36'                                                       
                  MOVE '5052'          TO   WS-ACC-GL                           
                  MOVE 'SOC-AMORT REG GRANT OF 2RM SA'                          
                                       TO   F180-TRANS-DESC                     
                  ADD   1              TO   WS-CR-AMORT-REG-2RM                 
                  ADD F180-CR-AMT      TO   WS-CR-AMORT-AMT-REG-2RM             
                  MOVE WS-ACC-NO1      TO   WS-GL-REG-2RM                       
                                            F180-ACC-NO1                        
              END-EVALUATE                                                      
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
       420-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    AMORITSATION INCOME FOR 1 RM                               *         
      *****************************************************************         
       500-CR-AMORT-1RM.                                                        
                                                                                
           MOVE SPACES                 TO   F180-GL-REC.                        
           MOVE ZEROES                 TO   F180-AMT-GST-RATE.                  
           MOVE 'SA1'                  TO   F180-JR-SC.                         
           MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY.           
           MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM.           
           MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD.                      
           MOVE WS-F180-PERIOD         TO   F180-PERIOD.                        
           MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC.                   
           COMPUTE F180-CR-AMT = 0 - F120-AMT-RECEIPT.                          
           MOVE '9000000575050'        TO   F180-ACC-NO1                        
                                            WS-GL-1RM.                          
           MOVE 'SOC-AMORTISATION INCOME OF 1RM ' TO                            
                                            F180-TRANS-DESC.                    
           ADD F180-CR-AMT             TO   WS-CR-1RM.                          
           WRITE F180-GL-REC.                                                   
           ADD 1                       TO   WS-WRITE-F180-COUNT.                
           ADD 1                       TO   WS-F180-CASES2.                     
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    AMORITSATION INCOME FOR 1 RM                               *         
      *****************************************************************         
       501-DR-AMORT-1RM.                                                        
                                                                                
           MOVE SPACES                 TO   F180-GL-REC.                        
           MOVE ZEROES                 TO   F180-AMT-GST-RATE.                  
           MOVE 'SA1'                  TO   F180-JR-SC.                         
           MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY.           
           MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM.           
           MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD.                      
           MOVE WS-F180-PERIOD         TO   F180-PERIOD.                        
           MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC.                   
           COMPUTE F180-CR-AMT = 0 - F120-AMT-RECEIPT.                          
           MOVE '9000000575050'        TO   F180-ACC-NO1                        
                                            WS-GL-1RM.                          
           MOVE 'SOC-AMORTISATION INCOME OF 1RM ' TO                            
                                            F180-TRANS-DESC.                    
           ADD F180-CR-AMT             TO   WS-DR-1RM.                          
           WRITE F180-GL-REC.                                                   
           ADD 1                       TO   WS-WRITE-F180-COUNT.                
           ADD 1                       TO   WS-F180-CASES4.                     
                                                                                
       501-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    AMORTSATION INCOME FOR 2 RM                                *         
      *****************************************************************         
       510-CR-AMORT-2RM.                                                        
                                                                                
           MOVE SPACES                 TO   F180-GL-REC.                        
           MOVE ZEROES                 TO   F180-AMT-GST-RATE.                  
           MOVE 'SA2'                  TO   F180-JR-SC.                         
           MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY.           
           MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM.           
           MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD.                      
           MOVE WS-F180-PERIOD         TO   F180-PERIOD.                        
           MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC.                   
           COMPUTE F180-CR-AMT = 0 - F120-AMT-RECEIPT.                          
           MOVE '9000000575052'        TO   F180-ACC-NO1                        
                                            WS-GL-2RM.                          
           MOVE 'SOC-AMORTISATION INCOME OF 2RM ' TO                            
                                            F180-TRANS-DESC.                    
           ADD F180-CR-AMT             TO   WS-CR-2RM.                          
           WRITE F180-GL-REC.                                                   
           ADD 1                       TO   WS-WRITE-F180-COUNT.                
           ADD 1                       TO   WS-F180-CASES3.                     
                                                                                
       510-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
      *    AMORTSATION INCOME FOR 2 RM                                *         
      *****************************************************************         
       511-DR-AMORT-2RM.                                                        
                                                                                
           MOVE SPACES                 TO   F180-GL-REC.                        
           MOVE ZEROES                 TO   F180-AMT-GST-RATE.                  
           MOVE 'SA2'                  TO   F180-JR-SC.                         
           MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY.           
           MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM.           
           MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD.                      
           MOVE WS-F180-PERIOD         TO   F180-PERIOD.                        
           MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC.                   
           COMPUTE F180-CR-AMT = 0 - F120-AMT-RECEIPT.                          
           MOVE '9000000575052'        TO   F180-ACC-NO1                        
                                            WS-GL-2RM.                          
           MOVE 'SOC-AMORTISATION INCOME OF 2RM ' TO                            
                                            F180-TRANS-DESC.                    
           ADD F180-CR-AMT             TO   WS-DR-2RM.                          
           WRITE F180-GL-REC.                                                   
           ADD 1                       TO   WS-WRITE-F180-COUNT.                
           ADD 1                       TO   WS-F180-CASES5.                     
                                                                                
       511-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
       520-CR-AMORT-OTHER.                                                      
                                                                                
      ***SRG GRANT                                                              
           IF K690-AMT-SRG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE 'SA'                   TO   F180-JR-SC                       
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              MOVE 'SRG'                  TO   F180-DTE-POST                    
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-SRG-ACCUM             
              ELSE                                                              
                 IF F120-CDE-TRANS-TYPE = '35' OR '36'                          
                    COMPUTE F180-CR-AMT = 0 - (K690-AMT-SRG-GRANT -             
                                               K690-AMT-AMORT-SRG-ACCUM)        
                 ELSE                                                           
                    COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-SRG-MTH            
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '407300'               TO WS-ACC-INTERNAL                    
              MOVE '4033'                 TO WS-ACC-GL                          
              MOVE 'SOC-AMORT SRG GRANT OF SA'                                  
                                          TO F180-TRANS-DESC                    
              ADD   1                     TO WS-CR-SRG                          
              ADD F180-CR-AMT             TO WS-CR-SRG-AMT                      
              MOVE WS-ACC-NO1             TO WS-SRG-GL                          
                                             F180-ACC-NO1                       
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF K690-AMT-REG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE 'SA'                   TO   F180-JR-SC                       
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              MOVE 'REG'                  TO   F180-DTE-POST                    
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-REG-ACCUM             
              ELSE                                                              
                 IF F120-CDE-TRANS-TYPE = '35' OR '36'                          
                    COMPUTE F180-CR-AMT = 0 - (K690-AMT-REG-GRANT -             
                                               K690-AMT-AMORT-REG-ACCUM)        
                 ELSE                                                           
                    COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-REG-MTH            
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '419200'               TO WS-ACC-INTERNAL                    
              MOVE '4033'                 TO WS-ACC-GL                          
              MOVE 'SOC-AMORT REG GRANT OF SA'                                  
                                          TO F180-TRANS-DESC                    
              ADD   1                     TO WS-CR-REG                          
              ADD F180-CR-AMT             TO WS-CR-REG-AMT                      
              MOVE WS-ACC-NO1             TO WS-REG-GL                          
                                             F180-ACC-NO1                       
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
       520-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
       530-DR-AMORT-OTHER.                                                      
                                                                                
      ***SRG GRANT                                                              
           IF K690-AMT-SRG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE 'SA'                   TO   F180-JR-SC                       
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              MOVE 'SRG'                  TO   F180-DTE-POST                    
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-SRG-ACCUM             
              ELSE                                                              
                 COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-SRG-MTH               
              END-IF                                                            
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '9'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '407300'               TO WS-ACC-INTERNAL                    
              MOVE '4033'                 TO WS-ACC-GL                          
              MOVE 'SOC-AMORT SRG GRANT OF SA'                                  
                                          TO F180-TRANS-DESC                    
              ADD   1                     TO WS-DR-SRG                          
              ADD F180-CR-AMT             TO WS-DR-SRG-AMT                      
              MOVE WS-ACC-NO1             TO WS-SRG-GL                          
                                             F180-ACC-NO1                       
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF K690-AMT-REG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE 'SA'                   TO   F180-JR-SC                       
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              MOVE 'REG'                  TO   F180-DTE-POST                    
              IF WS-NUM-BACKDATE = 'Y'                                          
                 COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-REG-ACCUM             
              ELSE                                                              
                 COMPUTE F180-CR-AMT = 0 - K690-AMT-AMORT-REG-MTH               
              END-IF                                                            
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '9'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '419200'               TO WS-ACC-INTERNAL                    
              MOVE '4033'                 TO WS-ACC-GL                          
              MOVE 'SOC-AMORT REG GRANT OF SA'                                  
                                          TO F180-TRANS-DESC                    
              ADD   1                     TO WS-DR-REG                          
              ADD F180-CR-AMT             TO WS-DR-REG-AMT                      
              MOVE WS-ACC-NO1             TO WS-REG-GL                          
                                             F180-ACC-NO1                       
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
       530-EXIT.                                                                
           EXIT.                                                                
      *****************************************************************         
      *    CORRECTING CALENDER DATE TO FINANCIAL YEAR PERIOD          *         
      *****************************************************************         
       600-CHK-PERIOD.                                                          
                                                                                
           IF WS-F180-TRANS-MM   < 4                                            
              ADD 9  WS-F180-TRANS-MM  GIVING WS-F180-PERIOD.                   
                                                                                
           IF WS-F180-TRANS-MM   > 3                                            
              SUBTRACT 3 FROM WS-F180-TRANS-MM  GIVING WS-F180-PERIOD.          
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ****************************************************************          
      *    MOVING THE APPROPRIATE MONTH END DATE ACCORDING TO        *          
      *    CALENDER MONTH AND YEAR                                   *          
      ****************************************************************          
       610-CHK-TRAN-DTE.                                                        
           DIVIDE WS-F180-TRANS-CCYY  BY 4 GIVING WS-YEAR REMAINDER             
                                            WS-LEAP-YEAR.                       
                                                                                
           MOVE WS-F180-TRANS-MM TO WS-MONTH.                                   
           IF WS-F180-TRANS-MM = 2                                              
              IF WS-LEAP-YEAR = 0                                               
                 MOVE 29 TO WS-F180-TRANS-DD                                    
              ELSE                                                              
                 MOVE 28 TO WS-F180-TRANS-DD                                    
           ELSE                                                                 
               IF CHECK-MM                                                      
                  MOVE 30 TO WS-F180-TRANS-DD                                   
               ELSE                                                             
                  MOVE 31 TO WS-F180-TRANS-DD.                                  
                                                                                
                                                                                
       610-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ***************************************************************           
      *     PRINT REPORT OF RECORDS READ AND WRITTEN TO CLEARING    *           
      *     FILE BP13F120 AND GENERAL LEDGER BP13F180 RESPECTIVELY. *           
      ***************************************************************           
       700-PRINT-REPORT.                                                        
           ADD 1 TO WS-PAGE-COUNT.                                              
                                                                                
           MOVE WS-READ-F120-COUNT    TO L395-READ-F120-CNT.                    
           MOVE WS-WRITE-F180-COUNT   TO L395-WRITE-F180-CNT.                   
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.                       
           MOVE CORRESPONDING WS-CURRENT-DATE TO L395-EDITED-DATE.              
           MOVE WS-PAGE-COUNT                 TO L395-PAGE.                     
                                                                                
           WRITE BP13L395-REPORT FROM WS-TITLE-1 AFTER PAGE.                    
           WRITE BP13L395-REPORT FROM WS-TITLE-2 AFTER 2.                       
           WRITE BP13L395-REPORT FROM WS-TITLE-3 AFTER 2.                       
           WRITE BP13L395-REPORT FROM WS-HEADER-LINE-1 AFTER 4.                 
           WRITE BP13L395-REPORT FROM WS-HEADER-LINE-2 AFTER 2.                 
           WRITE BP13L395-REPORT FROM WS-SUMMARY-HEADER-1 AFTER 4.              
           WRITE BP13L395-REPORT FROM WS-SUMMARY-HEADER-2 AFTER 2.              
                                                                                
      *PRINT TOTAL FOR SA DEFERRED INCOME                                       
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE WS-DEFER-GL       TO  L395-DEFER-GL.                            
           MOVE WS-DR-DEFER-AMT   TO  L395-DR-DEFER-DEBIT.                      
           MOVE WS-CR-DEFER-AMT   TO  L395-CR-DEFER-CREDIT.                     
           MOVE WS-F180-CASES     TO  L395-DR-CASES.                            
           MOVE WS-F180-CASES1    TO  L395-CR-CASES.                            
           IF L395-DEFER-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 2            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SRG GRANT                                               
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE WS-SRG-GL            TO  L395-DEFER-GL.                         
           MOVE WS-DR-SRG            TO  L395-DR-CASES.                         
           MOVE WS-CR-SRG            TO  L395-CR-CASES.                         
           MOVE WS-DR-SRG-AMT        TO  L395-DR-DEFER-DEBIT.                   
           MOVE WS-CR-SRG-AMT        TO  L395-CR-DEFER-CREDIT.                  
           IF L395-DEFER-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR REG GRANT                                               
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE WS-REG-GL            TO  L395-DEFER-GL.                         
           MOVE WS-DR-REG            TO  L395-DR-CASES.                         
           MOVE WS-CR-REG            TO  L395-CR-CASES.                         
           MOVE WS-DR-REG-AMT        TO  L395-DR-DEFER-DEBIT.                   
           MOVE WS-CR-REG-AMT        TO  L395-CR-DEFER-CREDIT.                  
           IF L395-DEFER-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      *PRINT TOTAL FOR AMORT OF LEASE INCOME - 1RM                              
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SA - 1 RM'       TO  L395-AMORT-DESC.                          
           MOVE WS-GL-1RM         TO  L395-AMORT-GL.                            
           MOVE WS-DR-1RM         TO  L395-DR-AMORT-DEBIT.                      
           MOVE WS-CR-1RM         TO  L395-CR-AMORT-CREDIT.                     
           MOVE WS-F180-CASES2    TO  L395-CR-AMORT-CASES.                      
           MOVE WS-F180-CASES4    TO  L395-DR-AMORT-CASES.                      
           IF L395-AMORT-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 2            
           END-IF.                                                              
                                                                                
      *PRINT TOTAL FOR AMORT OF LEASE INCOME - 2RM                              
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SA - 2 RM'       TO  L395-AMORT-DESC.                          
           MOVE WS-GL-2RM         TO  L395-AMORT-GL.                            
           MOVE WS-DR-2RM         TO  L395-DR-AMORT-DEBIT.                      
           MOVE WS-CR-2RM         TO  L395-CR-AMORT-CREDIT.                     
           MOVE WS-F180-CASES3    TO  L395-CR-AMORT-CASES.                      
           MOVE WS-F180-CASES5    TO  L395-DR-AMORT-CASES.                      
           IF L395-AMORT-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 2            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SRG GRANT   - 1 RM                       
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SRG - 1RM'          TO  L395-AMORT-DESC.                       
           MOVE WS-GL-SRG-1RM        TO  L395-AMORT-GL.                         
           MOVE WS-DR-AMORT-SRG-1RM  TO  L395-DR-AMORT-CASES.                   
           MOVE WS-CR-AMORT-SRG-1RM  TO  L395-CR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SRG-1RM  TO L395-DR-AMORT-DEBIT.                
           MOVE WS-CR-AMORT-AMT-SRG-1RM  TO L395-CR-AMORT-CREDIT.               
           IF L395-AMORT-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SRG                - 2RM                 
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SRG - 2RM'          TO  L395-AMORT-DESC.                       
           MOVE WS-GL-SRG-2RM        TO  L395-AMORT-GL.                         
           MOVE WS-DR-AMORT-SRG-2RM  TO  L395-DR-AMORT-CASES.                   
           MOVE WS-CR-AMORT-SRG-2RM  TO  L395-CR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SRG-2RM  TO L395-DR-AMORT-DEBIT.                
           MOVE WS-CR-AMORT-AMT-SRG-2RM  TO L395-CR-AMORT-CREDIT.               
           IF L395-AMORT-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - REG GRANT   - 1 RM                       
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'REG - 1RM'          TO  L395-AMORT-DESC.                       
           MOVE WS-GL-REG-1RM        TO  L395-AMORT-GL.                         
           MOVE WS-DR-AMORT-REG-1RM  TO  L395-DR-AMORT-CASES.                   
           MOVE WS-CR-AMORT-REG-1RM  TO  L395-CR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-REG-1RM  TO L395-DR-AMORT-DEBIT.                
           MOVE WS-CR-AMORT-AMT-REG-1RM  TO L395-CR-AMORT-CREDIT.               
           IF L395-AMORT-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - REG                - 2RM                 
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'REG - 2RM'          TO  L395-AMORT-DESC.                       
           MOVE WS-GL-REG-2RM        TO  L395-AMORT-GL.                         
           MOVE WS-DR-AMORT-REG-2RM  TO  L395-DR-AMORT-CASES.                   
           MOVE WS-CR-AMORT-REG-2RM  TO  L395-CR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-REG-2RM  TO L395-DR-AMORT-DEBIT.                
           MOVE WS-CR-AMORT-AMT-REG-2RM  TO L395-CR-AMORT-CREDIT.               
           IF L395-AMORT-GL NOT = SPACES                                        
              WRITE BP13L395-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
           COMPUTE WS-DR-TOT =  WS-DR-DEFER-AMT +                               
                                WS-DR-1RM +                                     
                                WS-DR-2RM.                                      
                                                                                
                                                                                
           COMPUTE WS-DR-TOT =  WS-DR-TOT +                                     
                                WS-DR-SRG-AMT +                                 
                                WS-DR-AMORT-AMT-SRG-1RM +                       
                                WS-DR-AMORT-AMT-SRG-2RM.                        
                                                                                
                                                                                
           COMPUTE WS-DR-TOT =  WS-DR-TOT +                                     
                                WS-DR-REG-AMT +                                 
                                WS-DR-AMORT-AMT-REG-1RM +                       
                                WS-DR-AMORT-AMT-REG-2RM .                       
                                                                                
                                                                                
           COMPUTE WS-CR-TOT =  WS-CR-DEFER-AMT +                               
                                WS-CR-1RM +                                     
                                WS-CR-2RM.                                      
                                                                                
           COMPUTE WS-CR-TOT =  WS-CR-TOT +                                     
                                WS-CR-SRG-AMT +                                 
                                WS-CR-AMORT-AMT-SRG-1RM +                       
                                WS-CR-AMORT-AMT-SRG-2RM.                        
                                                                                
           COMPUTE WS-CR-TOT =  WS-CR-TOT +                                     
                                WS-CR-REG-AMT +                                 
                                WS-CR-AMORT-AMT-REG-1RM +                       
                                WS-CR-AMORT-AMT-REG-2RM .                       
                                                                                
           MOVE WS-CR-TOT         TO L395-CR-TOT.                               
           MOVE WS-DR-TOT         TO L395-DR-TOT.                               
                                                                                
           COMPUTE WS-CR-CASES =  WS-F180-CASES1   +                            
                                  WS-F180-CASES2   +                            
                                  WS-F180-CASES3   +                            
                                  WS-CR-SRG   +                                 
                                  WS-CR-AMORT-SRG-1RM +                         
                                  WS-CR-AMORT-SRG-2RM +                         
                                  WS-CR-REG   +                                 
                                  WS-CR-AMORT-REG-1RM +                         
                                  WS-CR-AMORT-REG-2RM.                          
                                                                                
           MOVE WS-CR-CASES       TO L395-CR-CASES-TOT.                         
                                                                                
           COMPUTE WS-DR-CASES =  WS-F180-CASES    +                            
                                  WS-F180-CASES4   +                            
                                  WS-F180-CASES5   +                            
                                  WS-CR-SRG   +                                 
                                  WS-CR-AMORT-SRG-1RM +                         
                                  WS-CR-AMORT-SRG-2RM +                         
                                  WS-CR-REG   +                                 
                                  WS-CR-AMORT-REG-1RM +                         
                                  WS-CR-AMORT-REG-2RM.                          
                                                                                
           MOVE WS-DR-CASES       TO L395-DR-CASES-TOT.                         
                                                                                
           WRITE BP13L395-REPORT FROM WS-FOOTER-LINE-1 AFTER 4.                 
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
      ***************************************************************           
      *     CLOSE ALL FILES AND STOP RUN.                           *           
      ***************************************************************           
       999-CLOSE-FILES.                                                         
           CLOSE BP13F120                                                       
                 BP13F180                                                       
                 BP13K690                                                       
                 SY02F001                                                       
                 BP13L395.                                                      
                                                                                
           IF K690-STATUS NOT = 00 AND 97                                       
              MOVE K690-STATUS          TO RETURN-CODE                          
              DISPLAY 'ERROR CLOSING BM06K690 FILE ' K690-STATUS.               
                                                                                
           STOP RUN.                                                            
                                                                                
       999-EXIT.                                                                
           EXIT.                                                                
