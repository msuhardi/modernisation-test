       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C089.                                                 
      *AUTHOR.        CKK.                                                      
      *DATE-WRITTEN.  14DEC2001.                                                
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : PRINT SUCC OR UNSUCC LETTER FOR BE & BTO    *            
      *                                                            *            
      *  INPUT FILES : 1.  BP13F740  -  SOC REQ FILE               *            
      *                2.  BP13K825  -  OCCUPIER FILE              *            
      *                3.  BP13K830  -  ADDRESS FILE               *            
      *                4.  BP13K813  -  SITE INFORMATION           *            
      *                                                            *            
      *  LISTINGS    : 1.  P13L089C  - CONTROL LISTING FOR SUCC    *            
      *                2.  P13L089D  - CONTROL LISTING FOR UNSUCC  *            
      *                3.  P13L089J  - PA/FTS - Top 50%            *            
      *                4.  P13L089L  - PA - 101% to 200% MAT       *            
      *                8.  P13L089V  - PA - Beyond 300% NMAT       *            
      *                9.  P13L089W  - PA - Beyond 300% MAT        *            
      *                11. P13L0893  - PA - 201% to 300% MAT       *            
      *                12. P13L0894  - PA/FTS - 51% to 100%        *            
      *                13. P13L0895  - PA/FTS - 101% to 200% NMAT  *            
      *                14. P13L0896  - PA/FTS - 201% to 300% NMAT  *            
      *                15. P13L0897  - 3GEN FLAT                   *            
      *                16. P13L0898  - FTS - Beyond 300%           *            
      * ---------------------------------------------------------- *            
      * CHG REF  BY    DATE    DESCRIPTION                         *            
      * -------- ---  ------   -----------                         *            
      * BP131064 CKK  20011204 NEW PROGRAM.                        *            
      * BP132171 ED   20020819 ADD NEW FORM (BP13PL) FOR GROPA     *            
      * BP132200 CKK  20021109 CHG BE DATE FOR NEW BE              *            
      * BP132273 SSS  20021230 REMOVE FILE COPY                    *            
      *                        ADD CONFIRMATION OF HOUSING LOAN    *            
      * BP132273 SSS  20030103 ANNEX FOR BP13PL                    *            
      * BP132360 MJ16 20030703 INCL NEW FORMS FOR SUCCESSFUL CASES *            
      * BP132455 SK   20031208 REMOVE REPORT I & J                 *            
      * BP132626 SSD  20041210 ADD 3 REPORTS FOR FLAT TYPE = 1A/2A *            
      * BP132653 CKK  20050215 ADD 3 NEW LETTERS FOR BTO           *            
      * BP132674 CKK  20050325 HARDCODE BTO SITENAME               *            
      * BP132684 CKK  20050419 HARDCODE DATE                       *            
      * BP132693 CKK  20050512 HARDCODE DATE                       *            
      * BP132710 CKK  20050622 HARDCODE DATE FOR JUN BTO           *            
      * BP132748 SSS  20050926 CATER FOR SEP 2005 BTO              *            
      * BP132756 CKK  20051017 CATER FOR AUG BE                    *            
      * BP132829 CKK  20060403 HARDCODE DATE FOR FEB BTO           *            
      * BP132881 CKK  20060723 HARDCODE DATE FOR JUL BTO           *            
      * BP132916 CKK  20061026 HARDCODE DATE FOR AUG BE            *            
      * BP132957 CKK  20061126 HARDCODE DATE FOR NOV BTO           *            
      * BP133097 SSS  20070710 CATER FOR MAY 2007 BTO              *            
      * BP133104 IL5  20070815 CATER FOR AUG 2007 BTO              *            
      * BP133147 IL5  20070921 CATER FOR JUL 2007 BE               *            
      * BP133142 SSS  20071016 CATER FOR AUG 2007 BTO              *            
      * BP133220 SSS  20071016 CATER FOR OCT 2007 BTO              *            
      * BP133220 SSS  20071016 CATER FOR OCT 2007 BTO              *            
      * BP133239 IL5  20080129 CATER FOR NOV 2007 BTO              *            
      * BP133256 IL5  20080216 CATER FOR DEC 2007 BTO              *            
      * BP133292 IL5  20080327 CATER FOR JAN 2008 BE               *            
      * BP133326 IL5  20080422 CATER FOR MAR 2008 BTO              *            
      * BP133362 IL5  20080624 CATER FOR MAY 2008 BTO              *            
      * BP133380 IL5  20080724 CATER FOR JUN 2008 BTO              *            
      * BP133476 IL5  20081118 CATER FOR SEP 2008 BE               *            
      * BP133476 IL5  20090113 CATER FOR NOV 2008 BTO              *            
      * BP133549 IL5  20090113 CATER FOR Dec 2008 BTO              *            
      * BP133582 ZDD1 20090511 REMOVED HARDCODED CODES             *            
      *                        CHANGED BP13K703 TO BP13K816        *            
      * BP133832 ZDD1 20100212 RE-ALLIGNMENT                       *            
      * BP133838 IL5  20100310 CHANGE CONDITION FOR PRINTING LTR   *            
      *                        BP13J5 AND BP13J6                   *            
      * BP133913 ZDD1 20100526 CATER FOR REVISED  FORMS            *            
      * BP134036 ZDD1 20101020 CATER FOR SBF FORMS                 *            
      * BP134396 ZDD1 20111024 CATER FOR SBF FORMS                 *            
      * BP134413 ZDD  20111216 CATER FOR FORM REVISIONS            *            
      * BP134483 ZDD  20120417 CATER FOR FORM REVISIONS            *            
      * BP134679 SMR2 20121018 REMOVE SBF LETTERS & FORM REVISIONS *            
      * BP134679 SMR2 20121115 CHANGE CONDITION FOR CONTROL LISTS  *            
      * BP134718 SMR2 20121213 ADD TXT-NEXT-LAUNCH-LTR             *            
      * BP135100 SMR2 20131014 INCLUDE NEW FORM FOR 3GEN - BP13HA  *            
      * BP135170 SMR2 20131212 INCLUDE NEW FORMS FOR SINGLE SCHEME *            
      * BP135190 SMR2 20131204 EXPAND BP13K813 TO 1000             *            
      * BP135636 SMR2 20150302 CHANGE IMP NOTES FOR >200% - BP137M *            
      * BP136096 SMR2 20160118 CHANGE IMP NOTES FOR SINGLES - HP   *            
      *                        REMOVE IMP NOTES - BP13V3/V5        *            
      *                        REMOVE HARDCODING FOR FLAT TYPE     *            
      * BP136172 SMR2 20160303 REMOVE SA FORMS BP13VB/VD/VG/VJ     *            
      * BP136169 SMR2 20160407 SWITCH THE FIELDS, UNIT & STREET    *            
      * BP136360 SMR2 20160824 STOP PRINTING FAQ FOR ZR/VL/VK/HA   *            
      * BP137685 AM25 20190218 UPDATE TEXT EXERCISE FIELD          *            
      * BP137685 IL5  20190319 CHANGE START PRINT POSITION OF NT   *            
      * BP138311 AM25 20200910 REMOVE FAQS - FORM BP13HN           *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F740  ASSIGN       TO BP13F740                            
                            FILE STATUS  IS WS-F740-STATUS.                     
                                                                                
           SELECT BP13K825  ASSIGN       TO BP13K825                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K825-KEY-FLD                        
                            FILE STATUS  IS WS-K825-STATUS.                     
                                                                                
           SELECT BP13K830  ASSIGN       TO BP13K830                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K830-KEY-FLD                        
                            ALTERNATE RECORD KEY IS  K830-NUM-REGN              
                            FILE STATUS  IS WS-K830-STATUS.                     
                                                                                
           SELECT BP13K813  ASSIGN       TO BP13K813                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K813-KEY-FLD                        
                            FILE STATUS  IS WS-K813-STATUS.                     
                                                                                
           SELECT P13L089C  ASSIGN       TO P13L089C.                           
           SELECT P13L089D  ASSIGN       TO P13L089D.                           
           SELECT P13L089J  ASSIGN       TO P13L089J.                           
           SELECT P13L089L  ASSIGN       TO P13L089L.                           
           SELECT P13L089V  ASSIGN       TO P13L089V.                           
           SELECT P13L089W  ASSIGN       TO P13L089W.                           
           SELECT P13L0893  ASSIGN       TO P13L0893.                           
           SELECT P13L0894  ASSIGN       TO P13L0894.                           
           SELECT P13L0895  ASSIGN       TO P13L0895.                           
           SELECT P13L0896  ASSIGN       TO P13L0896.                           
           SELECT P13L0897  ASSIGN       TO P13L0897.                           
           SELECT P13L0898  ASSIGN       TO P13L0898.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F740                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13F740.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD  P13L089C                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  L089C-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13L089D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  L089D-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13L089J                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L089J-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L089L                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L089L-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L089V                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L089V-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L089W                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L089W-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L0893                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L0893-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L0894                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L0894-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L0895                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L0895-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L0896                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L0896-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L0897                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L0897-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13L0898                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  L0898-PRTREC                     PIC X(90).                          
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       COPY PRIOSCH.                                                            
                                                                                
       01  WS-STATUS.                                                           
           05  WS-K825-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-F740-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K813-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F740-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L089J-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L089L-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L089V-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L089W-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L0893-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L0894-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L0895-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L0896-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L0897-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-L0898-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-SUCC          PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-UNSUCC        PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-L089C            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-L089C            PIC 9(06)  VALUE 60.                
           05  WS-CNT-PAGE-L089D            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-L089D            PIC 9(06)  VALUE 60.                
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F740-EOF                  PIC X     VALUE 'N'.                
           05  WS-K825-NME-OCCP             PIC X(66) VALUE SPACES.             
           05  WS-ALLOCSCH-TYPE             PIC X(3)  VALUE SPACES.             
           05  WS-IDX-X                     PIC 99    VALUE 01.                 
           05  WS-RECORD-CNT                PIC ZZZ9.                           
           05  WS-NUM-UNIT-OFFER            PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-UNIT-OFFER-GEN3       PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-QUEUE-START           PIC X(05) VALUE SPACES.             
           05  WS-NUM-QUEUE-MID             PIC X(05) VALUE SPACES.             
           05  WS-NUM-QUEUE-END             PIC X(05) VALUE SPACES.             
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-DTE-BALLOT                PIC X(6)  VALUE SPACES.             
                                                                                
       01  WS2-DEFAULT.                                                         
           05  WS2-MAX-LINES-L089C          PIC 9(2)   VALUE 37.                
           05  WS2-MAX-LINES-L089D          PIC 9(2)   VALUE 45.                
                                                                                
       01  WS-MTH-CONV.                                                         
           05  FILLER                  PIC X(5)    VALUE 'JAN01'.               
           05  FILLER                  PIC X(5)    VALUE 'FEB02'.               
           05  FILLER                  PIC X(5)    VALUE 'MAR03'.               
           05  FILLER                  PIC X(5)    VALUE 'APR04'.               
           05  FILLER                  PIC X(5)    VALUE 'MAY05'.               
           05  FILLER                  PIC X(5)    VALUE 'JUN06'.               
           05  FILLER                  PIC X(5)    VALUE 'JUL07'.               
           05  FILLER                  PIC X(5)    VALUE 'AUG08'.               
           05  FILLER                  PIC X(5)    VALUE 'SEP09'.               
           05  FILLER                  PIC X(5)    VALUE 'OCT10'.               
           05  FILLER                  PIC X(5)    VALUE 'NOV11'.               
           05  FILLER                  PIC X(5)    VALUE 'DEC12'.               
       01  WS-MTH-CONV-TABLE REDEFINES WS-MTH-CONV.                             
           05  WS-TF-MTH       OCCURS 12 TIMES INDEXED BY WS-IDX.               
               10  WS-TRAN-MM          PIC X(3).                                
               10  WS-NUM-MM           PIC X(2).                                
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05 FILLER                   PIC X(12) VALUE                          
             '01  JANUARY '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '02  FEBRUARY'.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '03   MARCH  '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '04   APRIL  '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '05    MAY   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '06   JUNE   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '07   JULY   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '08   AUGUST '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '09 SEPTEMBER'.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '10  OCTOBER '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '11 NOVEMBER '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '12 DECEMBER '.                                                    
       01  FILLER  REDEFINES  WS-MONTHS-IN-DIGITS-AND-WORDS.                    
           05 WS-MONTH-TABLE               OCCURS 12                            
                                           INDEXED BY WS-MTH-IND.               
              10 WS-MONTH-IN-DIGITS    PIC X(02).                               
              10 FILLER                PIC X(01).                               
              10 WS-MONTH-IN-WORDS     PIC X(09).                               
                                                                                
      *===============================                                          
      *   LINKAGE SECTION FOR AV02C015                                          
      *===============================                                          
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
       01  DJDE-LINE-NON-POD1             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13K1,BFORM=BP13K2,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-NON-POD3             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13KQ,BFORM=BLANKF,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-VA                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VA,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VC                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VC,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VF                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VF,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VE                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VE,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VI                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VI,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VH                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VH,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VK                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VK,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VL                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VL,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-HA                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13HA,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-ZR                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13ZR,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-BLANKF                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BLANKF,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V1                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V1,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V2                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V2,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V4                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V4,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13HP                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13HP,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP137M                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP137M,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER TO APPLICANT                     *            
      *------------------------------------------------------------*            
       01  L089-LINE01.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  L089-REFNO               PIC X(15) VALUE SPACES.                 
                                                                                
       01  L089-LINE02.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  L089-DATE                PIC X(10) VALUE SPACES.                 
                                                                                
       01  L089-LINE03.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  L089-NAME                PIC X(66) VALUE SPACES.                 
                                                                                
       01  L089-LINE04.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  L089-NAME2               PIC X(66) VALUE SPACES.                 
                                                                                
       01  L089-LINE05.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  L089-BLK                 PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  L089-ADDR-L2             PIC X(47) VALUE SPACES.                 
                                                                                
       01  L089-LINE06.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  L089-UNIT                PIC X(11) VALUE SPACES.                 
                                                                                
       01  L089-LINE07.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  L089-ADDR-L3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  L089-LINE08.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  L089-BAR-CODE            PIC X(09) VALUE SPACES.                 
                                                                                
       01  L089-LINE8A.                                                         
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  L089-ROOM-NO             PIC X(17) VALUE SPACES.                 
                                                                                
       01  L089-LINE8D.                                                         
           05  FILLER                   PIC X(65) VALUE SPACES.                 
           05  L089-ROOM-NO4            PIC X(17) VALUE SPACES.                 
                                                                                
       01  L089-LINE8E.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  L089-BTO-ESTATE1         PIC X(28) VALUE SPACES.                 
                                                                                
       01  L089-LINE8F.                                                         
           05  FILLER                   PIC X(33) VALUE SPACES.                 
           05  L089-ROOM-NO5            PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  L089-BTO-ESTATE2         PIC X(28) VALUE SPACES.                 
                                                                                
       01  L089-LINE8G.                                                         
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  L089-ROOM-NO6            PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(03) VALUE SPACES.                 
           05  L089-BTO-ESTATE3         PIC X(28) VALUE SPACES.                 
                                                                                
      *01  L089-LINE8H.                                                         
      *    05  FILLER                   PIC X(16) VALUE SPACES.                 
      *    05  L089-ROOM-TYPE           PIC X(17) VALUE SPACES.                 
                                                                                
       01  L089-LINE8I.                                                         
           05  FILLER                   PIC X(55) VALUE SPACES.                 
           05  L089-BTO-ESTATE4         PIC X(28) VALUE SPACES.                 
                                                                                
       01  L089-LINE8J.                                                         
           05  FILLER                   PIC X(66) VALUE SPACES.                 
           05  L089-BTO-ESTATE5         PIC X(28) VALUE SPACES.                 
                                                                                
       01  L089-LINE9A.                                                         
           05  FILLER                   PIC X(28) VALUE SPACES.                 
           05  L089-GEN3-ESTATE         PIC X(28) VALUE SPACES.                 
                                                                                
       01  L089-LINE10I-HR.                                                     
           05  FILLER                   PIC X(61) VALUE SPACES.                 
           05  L089-QUEUE-NO11          PIC ZZZZ9.                              
                                                                                
       01  L089-LINE10J-HR.                                                     
           05  FILLER                   PIC X(35) VALUE SPACES.                 
           05  L089-QUEUE-NO12          PIC ZZZZ9.                              
                                                                                
       01  L089-LINE10K-HR.                                                     
           05  FILLER                   PIC X(61) VALUE SPACES.                 
           05  L089-QUEUE-NO13          PIC ZZZZ9.                              
           05  FILLER                   PIC X(16) VALUE SPACES.                 
           05  L089-UNIT-OFFER-E        PIC ZZZ9.                               
                                                                                
       01  L089-LINE10L-HR.                                                     
           05  FILLER                   PIC X(65) VALUE SPACES.                 
           05  L089-QUEUE-NO14          PIC ZZZZ9.                              
                                                                                
       01  L089-LINE10D-BE-DATE5.                                               
           05  FILLER                   PIC X(53)  VALUE SPACES.                
           05  L089-DTE-SEL-BE5         PIC X(17) VALUE SPACES.                 
                                                                                
       01  L089-LINE11-B.                                                       
           05  FILLER                   PIC X(41) VALUE SPACES.                 
           05  L089-UNIT-OFFER-B        PIC ZZZ9.                               
                                                                                
       01  L089-LINE11-C.                                                       
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  L089-UNIT-OFFER-C        PIC ZZZ9.                               
                                                                                
       01  L089-LINE11-D.                                                       
           05  FILLER                   PIC X(23) VALUE SPACES.                 
           05  L089-UNIT-OFFER-D        PIC ZZZ9.                               
                                                                                
       01  L089-LINE11A-BALLOT.                                                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  L089-BALLOT-DTE          PIC X(70) VALUE SPACES.                 
                                                                                
       01  L089-LINE11A-BALLOT2.                                                
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  L089-BALLOT-DTE2         PIC X(70) VALUE SPACES.                 
                                                                                
       01  L089-LINE12.                                                         
           05  FILLER                   PIC X(62) VALUE SPACES.                 
           05  L089-NEXT-LAUNCH         PIC X(08) VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  L089A-HDG1.                                                          
           05  L089A-LISTING            PIC X(14) VALUE 'P13L089C'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  L089A-DATE               PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  L089A-PAGE               PIC ZZZZ9.                              
                                                                                
       01  L089A-HDG2.                                                          
           05  FILLER                   PIC X(20) VALUE SPACES.                 
           05  L089A-LISTING-TYPE       PIC X(89) VALUE SPACES.                 
                                                                                
       01  L089A-HDG4.                                                          
           05  FILLER                   PIC X(7)  VALUE ' S/N   '.              
           05  FILLER                   PIC X(9)  VALUE 'REF-NO   '.            
           05  FILLER                   PIC X(15) VALUE                         
               'APPLICANT NAMES'.                                               
           05  FILLER                   PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE '  UIN  '.              
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE 'CAT  '.                
           05  FILLER                   PIC X(5)  VALUE 'ALLOC'.                
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'FLAT'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'HHTY   '.              
           05  FILLER                   PIC X(4)  VALUE 'MCPS'.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'RES-HA1'.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'SUCC'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'NT1   '.               
           05  FILLER                   PIC X(6)  VALUE 'UNSUCC'.               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'BALLOT'.               
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE 'ZE'.                   
                                                                                
       01  L089A-HDG5.                                                          
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'REGN-NO'.              
           05  FILLER                   PIC X(40) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'SCH'.                  
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'TYPE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE '    '.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE '       '.              
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE '     '.                
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'ZONE   '.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE '   '.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'ZONE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'POS'.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'Q-POS'.                
                                                                                
       01  L089A-HDG6.                                                          
           05  FILLER                   PIC X(7)  VALUE '       '.              
           05  FILLER                   PIC X(9)  VALUE 'LOAN-TAG '.            
           05  FILLER                   PIC X(15) VALUE                         
               'REQ-STATUS     '.                                               
                                                                                
       01  L089A-DTL-1.                                                         
           05  L089A-SERIAL-NO          PIC ZZZ9.                               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  L089A-REF-NO             PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  L089A-NAME-1             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  L089A-NRIC-1             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  L089A-CAT                PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  L089A-ALLOC              PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  L089A-FLAT               PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  L089A-HHTY               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  L089A-MCPS               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(9)  VALUE SPACES.                 
           05  L089A-RES-HA1            PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  L089A-SUCC               PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  L089A-NT1                PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  L089A-UNSUCC             PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  L089A-BALLOT-POS         PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  L089A-ZONE               PIC X(2)  VALUE SPACES.                 
                                                                                
       01  L089A-DTL-2.                                                         
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  L089A-REGN-NO            PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  L089A-NAME-2             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  L089A-NRIC-2             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(79) VALUE SPACES.                 
           05  L089A-QUEUE              PIC X(5)  VALUE SPACES.                 
                                                                                
       01  L089A-DTL-3.                                                         
           05  FILLER                   PIC X(16) VALUE SPACES.                 
           05  L089A-BLK                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  L089A-UNIT               PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  L089A-ADDR2              PIC X(65) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  L089A-ADDR3              PIC X(20) VALUE SPACES.                 
                                                                                
       01  L089A-DTL-4.                                                         
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  L089A-LOAN-TAG           PIC X(6)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  L089A-REQ-STATUS         PIC X(22) VALUE SPACES.                 
                                                                                
      *=============================================================            
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-FILES             THRU 1000-EXIT.                  
           PERFORM 3000-PROCESS-RECORDS        THRU 3000-EXIT                   
                   UNTIL WS-F740-EOF = 'Y'.                                     
           PERFORM 9000-CLOSE-ROUTINE          THRU 9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       1000-OPEN-FILES.                                                         
      *=============================================================            
                                                                                
           OPEN INPUT BP13F740                                                  
                      BP13K825                                                  
                      BP13K830                                                  
                      BP13K813                                                  
               OUTPUT P13L089C                                                  
                      P13L089D                                                  
                      P13L089J                                                  
                      P13L089L                                                  
                      P13L089V                                                  
                      P13L089W                                                  
                      P13L0893                                                  
                      P13L0894                                                  
                      P13L0895                                                  
                      P13L0896                                                  
                      P13L0897                                                  
                      P13L0898.                                                 
                                                                                
           IF WS-K825-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K825 STATUS ' WS-K825-STATUS               
              MOVE     WS-K825-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K830 STATUS ' WS-K830-STATUS               
              MOVE     WS-K830-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K813 STATUS ' WS-K813-STATUS               
              MOVE     WS-K813-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-DATE WS-CURR-DATE.             
                                                                                
           STRING WS-DD '/'                                                     
                  WS-MM '/'                                                     
                  WS-CCYY DELIMITED BY SIZE                                     
                  INTO L089A-DATE.                                              
                                                                                
           MOVE SPACES                   TO L089J-PRTREC                        
                                            L089L-PRTREC                        
                                            L0893-PRTREC                        
                                            L0894-PRTREC                        
                                            L0895-PRTREC                        
                                            L0896-PRTREC.                       
                                                                                
           MOVE SPACES           TO L089J-PRTREC.                               
           WRITE L089J-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO L089J-PRTREC.                               
           WRITE L089J-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO L089L-PRTREC.                               
           WRITE L089L-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO L089L-PRTREC.                               
           WRITE L089L-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO L0893-PRTREC.                               
           WRITE L0893-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO L0893-PRTREC.                               
           WRITE L0893-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO L0894-PRTREC.                               
           WRITE L0894-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO L0894-PRTREC.                               
           WRITE L0894-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO L0895-PRTREC.                               
           WRITE L0895-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO L0895-PRTREC.                               
           WRITE L0895-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO L0896-PRTREC.                               
           WRITE L0896-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO L0896-PRTREC.                               
           WRITE L0896-PRTREC    AFTER PAGE.                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3000-PROCESS-RECORDS.                                                    
      *=============================================================            
                                                                                
           PERFORM 4000-READ-BP13F740     THRU 4000-EXIT.                       
           PERFORM 4500-MOVE-DETAILS      THRU 4500-EXIT                        
                   UNTIL WS-F740-EOF = 'Y'.                                     
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4000-READ-BP13F740.                                                      
      *=============================================================            
                                                                                
            READ BP13F740                                                       
                 AT END MOVE 'Y'  TO  WS-F740-EOF                               
                        GO TO 4000-EXIT.                                        
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4500-MOVE-DETAILS.                                                       
      *=============================================================            
                                                                                
           MOVE SPACES                    TO K825-KEY-FLD                       
                                             L089-ROOM-NO                       
                                             L089-ROOM-NO4                      
                                             L089-ROOM-NO5                      
                                             L089-ROOM-NO6                      
      *                                      L089-ROOM-TYPE                     
                                             L089-BALLOT-DTE                    
                                             L089-BALLOT-DTE2                   
                                             L089-DTE-SEL-BE5                   
                                             WS-NUM-QUEUE-START                 
                                             WS-NUM-QUEUE-MID                   
                                             WS-NUM-QUEUE-END.                  
                                                                                
           MOVE ZEROES                    TO WS-NUM-UNIT-OFFER                  
                                             WS-NUM-UNIT-OFFER-GEN3.            
                                                                                
           MOVE F740-NUM-REF              TO L089-REFNO.                        
           MOVE F740-NUM-NT-FT-QUEUE      TO L089-QUEUE-NO11                    
                                             L089-QUEUE-NO12                    
                                             L089-QUEUE-NO13                    
                                             L089-QUEUE-NO14.                   
                                                                                
      *    IF F740-CDE-FLAT-TYPE = '1A' OR 'SP'                                 
      *       MOVE 'Studio Apartment'     TO L089-ROOM-NO                       
      *    ELSE                                                                 
      *       STRING F740-CDE-FLAT-TYPE(1:1) '-room flat'                       
      *       DELIMITED BY SIZE           INTO L089-ROOM-NO                     
                                                                                
      *       STRING F740-CDE-FLAT-TYPE(1:1) '-room'                            
      *       DELIMITED BY SIZE           INTO L089-ROOM-TYPE                   
      *    END-IF.                                                              
                                                                                
           MOVE F740-NUM-REGN          TO K825-NUM-REGN.                        
           MOVE F740-NUM-NRIC1         TO K825-NUM-NRIC.                        
           PERFORM 4600-READ-K825      THRU 4600-EXIT.                          
           MOVE WS-K825-NME-OCCP       TO L089-NAME.                            
                                                                                
           IF F740-NUM-NRIC2 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO L089-NAME2                      
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN             TO K825-NUM-REGN                   
              MOVE F740-NUM-NRIC2            TO K825-NUM-NRIC                   
              PERFORM 4600-READ-K825         THRU 4600-EXIT                     
              MOVE WS-K825-NME-OCCP          TO L089-NAME2                      
           END-IF.                                                              
                                                                                
           MOVE F740-DTE-BALLOT              TO WS-DTE-BALLOT.                  
                                                                                
           EVALUATE WS-DTE-BALLOT(5:2)                                          
           WHEN 01                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'JANUARY ' F740-DTE-BALLOT(1:4)                         
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN JANUARY '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 02                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FEBRUARY ' F740-DTE-BALLOT(1:4)                        
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN FEBRUARY '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
             END-IF                                                             
                                                                                
           WHEN 03                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'MARCH ' F740-DTE-BALLOT(1:4)                           
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN MARCH '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 04                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'APRIL ' F740-DTE-BALLOT(1:4)                           
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN APRIL '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 05                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'MAY ' F740-DTE-BALLOT(1:4)                             
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN MAY '                              
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 06                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'JUNE ' F740-DTE-BALLOT(1:4)                            
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN JUNE '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 07                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'JULY ' F740-DTE-BALLOT(1:4)                            
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN JULY '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 08                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'AUGUST ' F740-DTE-BALLOT(1:4)                          
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN AUGUST '                           
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 09                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'SEPTEMBER ' F740-DTE-BALLOT(1:4)                       
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN SEPTEMBER '                        
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 10                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'OCTOBER ' F740-DTE-BALLOT(1:4)                         
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN OCTOBER '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 11                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'NOVEMBER ' F740-DTE-BALLOT(1:4)                        
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN NOVEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
                                                                                
           WHEN 12                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'DECEMBER ' F740-DTE-BALLOT(1:4)                        
                        ' Build-To-Order (BTO) Exercise '                       
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE                         
                                                                                
                 STRING 'FLAT APPLICATION IN DECEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO L089-BALLOT-DTE2                        
              END-IF                                                            
           END-EVALUATE.                                                        
                                                                                
           PERFORM 7200-READ-K813           THRU 7200-EXIT.                     
           PERFORM 4800-GET-ADDR            THRU 4800-EXIT.                     
           PERFORM 7000-CHECK-SCH           THRU 7000-EXIT.                     
                                                                                
           IF K813-NUM-GEN3-TAG = 'Y'                                           
              IF F740-NUM-GEN3 = 'Y'                                            
                 CONTINUE                                                       
      *          MOVE '5-room/3Gen flat'       TO L089-ROOM-NO                  
              ELSE                                                              
                 MOVE K813-NUM-UNIT-OFFER   TO WS-NUM-UNIT-OFFER                
                 IF K813-NUM-UNIT-OFFER-GEN3 IS NOT NUMERIC                     
                    MOVE ZEROES             TO WS-NUM-UNIT-OFFER-GEN3           
                 ELSE                                                           
                    MOVE K813-NUM-UNIT-OFFER-GEN3                               
                                            TO WS-NUM-UNIT-OFFER-GEN3           
                 END-IF                                                         
                 COMPUTE L089-UNIT-OFFER-B = WS-NUM-UNIT-OFFER -                
                                             WS-NUM-UNIT-OFFER-GEN3             
                 MOVE L089-UNIT-OFFER-B     TO L089-UNIT-OFFER-C                
                                               L089-UNIT-OFFER-D                
                                               L089-UNIT-OFFER-E                
                                                                                
                 IF K813-NUM-QUEUE-START-MGPSGEN3 IS NOT NUMERIC                
                    MOVE ZEROES        TO K813-NUM-QUEUE-START-MGPSGEN3         
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-START-MGPSGEN3                             
                                       TO WS-NUM-QUEUE-START                    
                 IF K813-NUM-QUEUE-MID-MGPSGEN3 IS NOT NUMERIC                  
                    MOVE ZEROES        TO K813-NUM-QUEUE-MID-MGPSGEN3           
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-MID-MGPSGEN3                               
                                       TO WS-NUM-QUEUE-MID                      
                 IF K813-NUM-QUEUE-END-MGPSGEN3 IS NOT NUMERIC                  
                    MOVE ZEROES        TO K813-NUM-QUEUE-END-MGPSGEN3           
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-END-MGPSGEN3                               
                                       TO WS-NUM-QUEUE-END                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE L089-ROOM-NO                TO L089-ROOM-NO4                    
                                               L089-ROOM-NO5                    
                                               L089-ROOM-NO6.                   
      *                                        L089-ROOM-TYPE.                  
                                                                                
           IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                          
              (F740-CDE-ALLOC-SCH = 'SAP' AND                                   
              (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                        
              IF F740-NUM-NT-FT-QUEUE NOT = SPACES AND LOW-VALUES               
                 IF F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-START                  
                    PERFORM 6150-PRT-BP13VA THRU 6150-EXIT                      
                 END-IF                                                         
                                                                                
                 IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-START AND               
                    F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-MID                    
                    PERFORM 6200-PRT-BP13VC THRU 6200-EXIT                      
                 END-IF                                                         
                                                                                
                 IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-MID AND                 
                    F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-END                    
                    PERFORM 6225-PRT-BP13VE THRU 6225-EXIT                      
                 END-IF                                                         
                                                                                
                 IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-END                     
                    PERFORM 6245-PRT-BP13VH THRU 6245-EXIT                      
                 END-IF                                                         
              ELSE                                                              
                 PERFORM 6280-PRT-BP13ZR    THRU 6280-EXIT                      
              END-IF                                                            
           ELSE                                                                 
            IF F740-CDE-FLAT-TYPE NOT = '1A'                                    
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 IF F740-NUM-GEN3 = 'Y' AND                                     
                    F740-CDE-REQUEST-STATUS = 'K'                               
                    PERFORM 6270-PRT-BP13HA         THRU 6270-EXIT              
                    PERFORM 6500-PRINT-CONTROL-LIST THRU 6500-EXIT              
                    ADD 1                           TO WS-F740-READ-CTR         
                    PERFORM 4000-READ-BP13F740      THRU 4000-EXIT              
                    GO TO 4500-EXIT                                             
                 END-IF                                                         
                 IF F740-NUM-NT-FT-QUEUE NOT = SPACES AND LOW-VALUES            
                    IF F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-START               
                       PERFORM 6150-PRT-BP13VA   THRU 6150-EXIT                 
                    END-IF                                                      
                                                                                
                    IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-START AND            
                       F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-MID                 
                       PERFORM 6200-PRT-BP13VC   THRU 6200-EXIT                 
                    END-IF                                                      
                                                                                
                    IF K813-NUM-MATURE-EST-TAG = 'Y'                            
                       IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-MID AND           
                          F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-END              
                          PERFORM 6220-PRT-BP13VF   THRU 6220-EXIT              
                       END-IF                                                   
                                                                                
                       IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-END               
                          PERFORM 6241-PRT-BP13VI   THRU 6241-EXIT              
                       END-IF                                                   
                    ELSE                                                        
                       IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-MID AND           
                          F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-END              
                          PERFORM 6225-PRT-BP13VE   THRU 6225-EXIT              
                       END-IF                                                   
                                                                                
                       IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-END               
                          PERFORM 6245-PRT-BP13VH   THRU 6245-EXIT              
                       END-IF                                                   
                    END-IF                                                      
                 ELSE                                                           
                    IF K813-NUM-MATURE-EST-TAG = 'Y'                            
                       PERFORM 6260-PRT-BP13VL   THRU 6260-EXIT                 
                    ELSE                                                        
                       PERFORM 6250-PRT-BP13VK   THRU 6250-EXIT                 
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
            END-IF                                                              
           END-IF.                                                              
                                                                                
           PERFORM 6500-PRINT-CONTROL-LIST  THRU 6500-EXIT.                     
                                                                                
           ADD 1 TO WS-F740-READ-CTR.                                           
           PERFORM 4000-READ-BP13F740    THRU 4000-EXIT.                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4600-READ-K825.                                                          
      *=============================================================            
                                                                                
           MOVE SPACES                   TO WS-K825-NME-OCCP.                   
           READ BP13K825.                                                       
                                                                                
           IF WS-K825-STATUS = 00 OR 02                                         
              MOVE K825-NME-OCCP         TO WS-K825-NME-OCCP                    
           ELSE                                                                 
           IF WS-K825-STATUS = 23                                               
              DISPLAY 'K825 REC NOT FOUND : '   K825-KEY-FLD                    
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K825 = '   WS-K825-STATUS              
                      ', K825-KEY-FLD = '   K825-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4800-GET-ADDR.                                                           
      *=============================================================            
                                                                                
           MOVE SPACES TO L089-LINE05                                           
                          L089-LINE06                                           
                          L089-LINE07                                           
                          L089-LINE08.                                          
                                                                                
           MOVE SPACES            TO    K830-KEY-FLD.                           
                                                                                
           MOVE F740-NUM-REF      TO    K830-KEY-FLD.                           
           READ BP13K830.                                                       
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                
                 ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                           
                 (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))               
                 MOVE K830-NUM-BLK         TO L089-BLK                          
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO L089-UNIT                         
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO L089-UNIT                         
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO L089-ADDR-L2                
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE SPACES            TO L089-ADDR-L3                      
                    DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL               
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO L089-ADDR-L3                      
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L089-BAR-CODE             
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK        TO L089-BLK                      
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                TO L089-UNIT                     
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT    TO L089-UNIT                     
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO L089-ADDR-L2              
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO L089-ADDR-L3                  
                    DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL              
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO L089-ADDR-L3                  
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                                                                                
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L089-BAR-CODE             
              END-IF                                                            
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              MOVE SPACES TO L089-LINE05                                        
                             L089-LINE06                                        
                             L089-LINE07                                        
                             L089-LINE08                                        
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                        
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4950-CALL-AV02C015.                                                      
      *=============================================================            
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       4950-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6150-PRT-BP13VA.                                                         
      *=============================================================            
      *** PA Top 50% ***                                                        
                                                                                
            ADD   1               TO    WS-L089J-WRT-CTR.                       
            MOVE  SPACES          TO    L089J-PRTREC.                           
            MOVE WS-L089J-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VA(49:4).                     
            WRITE L089J-PRTREC    FROM  DJDE-LINE-VA     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    L089J-PRTREC.                           
            WRITE L089J-PRTREC          AFTER PAGE.                             
                                                                                
            WRITE L089J-PRTREC    FROM  L089-LINE01          AFTER 1.           
            WRITE L089J-PRTREC    FROM  L089-LINE02.                            
            WRITE L089J-PRTREC    FROM  L089-LINE03          AFTER 5.           
            WRITE L089J-PRTREC    FROM  L089-LINE04.                            
            WRITE L089J-PRTREC    FROM  L089-LINE05.                            
            WRITE L089J-PRTREC    FROM  L089-LINE06.                            
            WRITE L089J-PRTREC    FROM  L089-LINE07.                            
            WRITE L089J-PRTREC    FROM  L089-LINE08          AFTER 3.           
            WRITE L089J-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L089J-PRTREC    FROM  L089-LINE8F          AFTER 5.           
            WRITE L089J-PRTREC    FROM  L089-LINE10J-HR      AFTER 1.           
            WRITE L089J-PRTREC    FROM  L089-LINE10D-BE-DATE5 AFTER 3.          
                                                                                
            MOVE SPACES           TO    L089J-PRTREC                            
                                        DJDE-LINE-VA(49:4)                      
            IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                         
               (F740-CDE-ALLOC-SCH = 'SAP' AND                                  
               (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                       
               WRITE L089J-PRTREC FROM  DJDE-BP13HP        AFTER PAGE           
            ELSE                                                                
               WRITE L089J-PRTREC FROM  DJDE-BP13V1        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    L089J-PRTREC.                           
            WRITE L089J-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO L089J-PRTREC.                              
            WRITE L089J-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO L089J-PRTREC.                              
            WRITE L089J-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO L089J-PRTREC.                              
            WRITE L089J-PRTREC    FROM DJDE-LINE-NON-POD3  AFTER PAGE.          
            MOVE SPACES           TO L089J-PRTREC.                              
            WRITE L089J-PRTREC    AFTER PAGE.                                   
                                                                                
       6150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6200-PRT-BP13VC.                                                         
      *=============================================================            
      *** PA - 51% to 100% ***                                                  
                                                                                
            ADD   1               TO    WS-L0894-WRT-CTR.                       
            MOVE  SPACES          TO    L0894-PRTREC.                           
            MOVE WS-L0894-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VC(49:4).                     
            WRITE L0894-PRTREC    FROM  DJDE-LINE-VC     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    L0894-PRTREC.                           
            WRITE L0894-PRTREC          AFTER PAGE.                             
                                                                                
            WRITE L0894-PRTREC    FROM  L089-LINE01          AFTER 1.           
            WRITE L0894-PRTREC    FROM  L089-LINE02.                            
            WRITE L0894-PRTREC    FROM  L089-LINE03          AFTER 5.           
            WRITE L0894-PRTREC    FROM  L089-LINE04.                            
            WRITE L0894-PRTREC    FROM  L089-LINE05.                            
            WRITE L0894-PRTREC    FROM  L089-LINE06.                            
            WRITE L0894-PRTREC    FROM  L089-LINE07.                            
            WRITE L0894-PRTREC    FROM  L089-LINE08          AFTER 3.           
            WRITE L0894-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L0894-PRTREC    FROM  L089-LINE8D          AFTER 3.           
            WRITE L0894-PRTREC    FROM  L089-LINE8E          AFTER 1.           
            WRITE L0894-PRTREC    FROM  L089-LINE10I-HR      AFTER 2.           
            WRITE L0894-PRTREC    FROM  L089-LINE11-C        AFTER 1.           
            WRITE L0894-PRTREC    FROM  L089-LINE10D-BE-DATE5 AFTER 2.          
                                                                                
            MOVE SPACES           TO    L0894-PRTREC                            
                                        DJDE-LINE-VC(49:4)                      
            IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                         
               (F740-CDE-ALLOC-SCH = 'SAP' AND                                  
               (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                       
               WRITE L0894-PRTREC FROM  DJDE-BP13HP        AFTER PAGE           
            ELSE                                                                
               WRITE L0894-PRTREC FROM  DJDE-BP13V1        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    L0894-PRTREC.                           
            WRITE L0894-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO L0894-PRTREC.                              
            WRITE L0894-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO L0894-PRTREC.                              
            WRITE L0894-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO L0894-PRTREC.                              
            WRITE L0894-PRTREC    FROM DJDE-LINE-NON-POD3  AFTER PAGE.          
            MOVE SPACES           TO L0894-PRTREC.                              
            WRITE L0894-PRTREC    AFTER PAGE.                                   
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6220-PRT-BP13VF.                                                         
      *=============================================================            
      *** PA - 101% to 200% MAT ***                                             
                                                                                
            ADD   1               TO    WS-L089L-WRT-CTR.                       
            MOVE  SPACES          TO    L089L-PRTREC.                           
            MOVE WS-L089L-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VF(49:4).                     
            WRITE L089L-PRTREC    FROM  DJDE-LINE-VF  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L089L-PRTREC.                           
            WRITE L089L-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L089L-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L089L-PRTREC    FROM  L089-LINE02.                            
            WRITE L089L-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L089L-PRTREC    FROM  L089-LINE04.                            
            WRITE L089L-PRTREC    FROM  L089-LINE05.                            
            WRITE L089L-PRTREC    FROM  L089-LINE06.                            
            WRITE L089L-PRTREC    FROM  L089-LINE07.                            
            WRITE L089L-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L089L-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L089L-PRTREC    FROM  L089-LINE8G       AFTER 3.              
            WRITE L089L-PRTREC    FROM  L089-LINE10I-HR   AFTER 2.              
            WRITE L089L-PRTREC    FROM  L089-LINE11-D     AFTER 1.              
            WRITE L089L-PRTREC    FROM  L089-LINE10D-BE-DATE5 AFTER 3.          
                                                                                
            MOVE SPACES           TO    L089L-PRTREC                            
                                        DJDE-LINE-VF(49:4)                      
            WRITE L089L-PRTREC    FROM  DJDE-BP13V2        AFTER PAGE.          
            MOVE SPACES           TO    L089L-PRTREC                            
            WRITE L089L-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO L089L-PRTREC.                              
            WRITE L089L-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO L089L-PRTREC.                              
            WRITE L089L-PRTREC                             AFTER PAGE.          
                                                                                
            MOVE SPACES           TO L089L-PRTREC.                              
            WRITE L089L-PRTREC    FROM DJDE-LINE-NON-POD3  AFTER PAGE.          
            MOVE SPACES           TO L089L-PRTREC.                              
            WRITE L089L-PRTREC                             AFTER PAGE.          
                                                                                
       6220-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6225-PRT-BP13VE.                                                         
      *=============================================================            
      *** PA - 101% to 200% NMAT ***                                            
                                                                                
            ADD   1               TO    WS-L0895-WRT-CTR.                       
            MOVE  SPACES          TO    L0895-PRTREC.                           
            MOVE WS-L0895-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VE(49:4).                     
            WRITE L0895-PRTREC    FROM  DJDE-LINE-VE  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L0895-PRTREC.                           
            WRITE L0895-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L0895-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L0895-PRTREC    FROM  L089-LINE02.                            
            WRITE L0895-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L0895-PRTREC    FROM  L089-LINE04.                            
            WRITE L0895-PRTREC    FROM  L089-LINE05.                            
            WRITE L0895-PRTREC    FROM  L089-LINE06.                            
            WRITE L0895-PRTREC    FROM  L089-LINE07.                            
            WRITE L0895-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L0895-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L0895-PRTREC    FROM  L089-LINE8G       AFTER 3.              
            WRITE L0895-PRTREC    FROM  L089-LINE10I-HR   AFTER 2.              
            WRITE L0895-PRTREC    FROM  L089-LINE11-D     AFTER 1.              
            WRITE L0895-PRTREC    FROM  L089-LINE10D-BE-DATE5 AFTER 3.          
                                                                                
            MOVE SPACES           TO    L0895-PRTREC                            
                                        DJDE-LINE-VE(49:4)                      
            IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                         
               (F740-CDE-ALLOC-SCH = 'SAP' AND                                  
               (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                       
               WRITE L0895-PRTREC FROM  DJDE-BP13HP        AFTER PAGE           
            ELSE                                                                
               WRITE L0895-PRTREC FROM  DJDE-BP13V2        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    L0895-PRTREC                            
            WRITE L0895-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO L0895-PRTREC.                              
            WRITE L0895-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO L0895-PRTREC.                              
            WRITE L0895-PRTREC                             AFTER PAGE.          
                                                                                
            MOVE SPACES           TO L0895-PRTREC.                              
            WRITE L0895-PRTREC    FROM DJDE-LINE-NON-POD3  AFTER PAGE.          
            MOVE SPACES           TO L0895-PRTREC.                              
            WRITE L0895-PRTREC                             AFTER PAGE.          
                                                                                
       6225-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6241-PRT-BP13VI.                                                         
      *=============================================================            
      *** PA - 201% to 300% MAT ***                                             
                                                                                
            ADD   1               TO    WS-L0893-WRT-CTR.                       
            MOVE  SPACES          TO    L0893-PRTREC.                           
            MOVE WS-L0893-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VI(49:4).                     
            WRITE L0893-PRTREC    FROM  DJDE-LINE-VI  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L0893-PRTREC.                           
            WRITE L0893-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L0893-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L0893-PRTREC    FROM  L089-LINE02.                            
            WRITE L0893-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L0893-PRTREC    FROM  L089-LINE04.                            
            WRITE L0893-PRTREC    FROM  L089-LINE05.                            
            WRITE L0893-PRTREC    FROM  L089-LINE06.                            
            WRITE L0893-PRTREC    FROM  L089-LINE07.                            
            WRITE L0893-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L0893-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L0893-PRTREC    FROM  L089-LINE8G       AFTER 3.              
            WRITE L0893-PRTREC    FROM  L089-LINE10K-HR   AFTER 2.              
      *     WRITE L0893-PRTREC    FROM  L089-LINE8H       AFTER 1.              
                                                                                
            MOVE SPACES           TO    L0893-PRTREC                            
                                        DJDE-LINE-VI(49:4)                      
            WRITE L0893-PRTREC    FROM  DJDE-BP13V4        AFTER PAGE.          
            MOVE SPACES           TO    L0893-PRTREC                            
            WRITE L0893-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO L0893-PRTREC.                              
            WRITE L0893-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO L0893-PRTREC.                              
            WRITE L0893-PRTREC                             AFTER PAGE.          
                                                                                
            MOVE SPACES           TO L0893-PRTREC.                              
            WRITE L0893-PRTREC    FROM DJDE-LINE-NON-POD3  AFTER PAGE.          
            MOVE SPACES           TO L0893-PRTREC.                              
            WRITE L0893-PRTREC                             AFTER PAGE.          
                                                                                
       6241-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6245-PRT-BP13VH.                                                         
      *=============================================================            
      *** PA - 201% to 300% NMAT ***                                            
                                                                                
            ADD   1               TO    WS-L0896-WRT-CTR.                       
            MOVE  SPACES          TO    L0896-PRTREC.                           
            MOVE WS-L0896-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VH(49:4).                     
            WRITE L0896-PRTREC    FROM  DJDE-LINE-VH  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L0896-PRTREC.                           
            WRITE L0896-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L0896-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L0896-PRTREC    FROM  L089-LINE02.                            
            WRITE L0896-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L0896-PRTREC    FROM  L089-LINE04.                            
            WRITE L0896-PRTREC    FROM  L089-LINE05.                            
            WRITE L0896-PRTREC    FROM  L089-LINE06.                            
            WRITE L0896-PRTREC    FROM  L089-LINE07.                            
            WRITE L0896-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L0896-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L0896-PRTREC    FROM  L089-LINE8G       AFTER 3.              
            WRITE L0896-PRTREC    FROM  L089-LINE10K-HR   AFTER 2.              
      *     WRITE L0896-PRTREC    FROM  L089-LINE8H       AFTER 1.              
                                                                                
            MOVE SPACES           TO    L0896-PRTREC                            
                                        DJDE-LINE-VH(49:4)                      
            IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                         
               (F740-CDE-ALLOC-SCH = 'SAP' AND                                  
               (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                       
               WRITE L0896-PRTREC FROM  DJDE-BP137M        AFTER PAGE           
            ELSE                                                                
               WRITE L0896-PRTREC FROM  DJDE-BP13V4        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    L0896-PRTREC                            
            WRITE L0896-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO L0896-PRTREC.                              
            WRITE L0896-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO L0896-PRTREC.                              
            WRITE L0896-PRTREC                             AFTER PAGE.          
                                                                                
            MOVE SPACES           TO L0896-PRTREC.                              
            WRITE L0896-PRTREC    FROM DJDE-LINE-NON-POD3  AFTER PAGE.          
            MOVE SPACES           TO L0896-PRTREC.                              
            WRITE L0896-PRTREC                             AFTER PAGE.          
                                                                                
       6245-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6250-PRT-BP13VK.                                                         
      *=============================================================            
      *** PA Beyond 300% NMAT ***                                               
                                                                                
            ADD   1               TO    WS-L089V-WRT-CTR.                       
            MOVE  SPACES          TO    L089V-PRTREC.                           
            MOVE WS-L089V-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VK(49:4).                     
            WRITE L089V-PRTREC    FROM  DJDE-LINE-VK  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L089V-PRTREC.                           
            WRITE L089V-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L089V-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L089V-PRTREC    FROM  L089-LINE02.                            
            WRITE L089V-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L089V-PRTREC    FROM  L089-LINE04.                            
            WRITE L089V-PRTREC    FROM  L089-LINE05.                            
            WRITE L089V-PRTREC    FROM  L089-LINE06.                            
            WRITE L089V-PRTREC    FROM  L089-LINE07.                            
            WRITE L089V-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L089V-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L089V-PRTREC    FROM  L089-LINE8G       AFTER 3.              
                                                                                
            MOVE SPACES           TO    L089V-PRTREC                            
                                        DJDE-LINE-VK(49:4)                      
            WRITE L089V-PRTREC    FROM  DJDE-BLANKF        AFTER PAGE.          
            MOVE SPACES           TO    L089V-PRTREC                            
            WRITE L089V-PRTREC                             AFTER PAGE.          
                                                                                
       6250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6260-PRT-BP13VL.                                                         
      *=============================================================            
      *** PA Beyond 300% MAT ***                                                
                                                                                
            ADD   1               TO    WS-L089W-WRT-CTR.                       
            MOVE  SPACES          TO    L089W-PRTREC.                           
            MOVE WS-L089W-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VL(49:4).                     
            WRITE L089W-PRTREC    FROM  DJDE-LINE-VL  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L089W-PRTREC.                           
            WRITE L089W-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L089W-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L089W-PRTREC    FROM  L089-LINE02.                            
            WRITE L089W-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L089W-PRTREC    FROM  L089-LINE04.                            
            WRITE L089W-PRTREC    FROM  L089-LINE05.                            
            WRITE L089W-PRTREC    FROM  L089-LINE06.                            
            WRITE L089W-PRTREC    FROM  L089-LINE07.                            
            WRITE L089W-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L089W-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L089W-PRTREC    FROM  L089-LINE8G       AFTER 3.              
                                                                                
            MOVE SPACES           TO    L089W-PRTREC                            
                                        DJDE-LINE-VL(49:4)                      
            WRITE L089W-PRTREC    FROM  DJDE-BLANKF        AFTER PAGE.          
            MOVE SPACES           TO    L089W-PRTREC                            
            WRITE L089W-PRTREC                             AFTER PAGE.          
                                                                                
       6260-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6270-PRT-BP13HA.                                                         
      *=============================================================            
      *** PA - 3GEN FLAT ***                                                    
                                                                                
            ADD   1               TO    WS-L0897-WRT-CTR.                       
            MOVE  SPACES          TO    L0897-PRTREC.                           
            MOVE WS-L0897-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-HA(49:4).                     
            WRITE L0897-PRTREC    FROM  DJDE-LINE-HA  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L0897-PRTREC.                           
            WRITE L0897-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L0897-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L0897-PRTREC    FROM  L089-LINE02.                            
            WRITE L0897-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L0897-PRTREC    FROM  L089-LINE04.                            
            WRITE L0897-PRTREC    FROM  L089-LINE05.                            
            WRITE L0897-PRTREC    FROM  L089-LINE06.                            
            WRITE L0897-PRTREC    FROM  L089-LINE07.                            
            WRITE L0897-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L0897-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L0897-PRTREC    FROM  L089-LINE8G       AFTER 3.              
            WRITE L0897-PRTREC    FROM  L089-LINE10L-HR   AFTER 2.              
            WRITE L0897-PRTREC    FROM  L089-LINE11-B     AFTER 1.              
            WRITE L0897-PRTREC    FROM  L089-LINE9A       AFTER 5.              
                                                                                
            MOVE SPACES           TO    L0897-PRTREC                            
                                        DJDE-LINE-HA(49:4)                      
            WRITE L0897-PRTREC    FROM  DJDE-BLANKF        AFTER PAGE.          
            MOVE SPACES           TO    L0897-PRTREC                            
            WRITE L0897-PRTREC                             AFTER PAGE.          
                                                                                
       6270-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6280-PRT-BP13ZR.                                                         
      *=============================================================            
      *** FTS - Beyond 300% ***                                                 
                                                                                
            ADD   1               TO    WS-L0898-WRT-CTR.                       
            MOVE  SPACES          TO    L0898-PRTREC.                           
            MOVE WS-L0898-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-ZR(49:4).                     
            WRITE L0898-PRTREC    FROM  DJDE-LINE-ZR  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    L0898-PRTREC.                           
            WRITE L0898-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE L0898-PRTREC    FROM  L089-LINE01    AFTER 1.                 
            WRITE L0898-PRTREC    FROM  L089-LINE02.                            
            WRITE L0898-PRTREC    FROM  L089-LINE03    AFTER 5.                 
            WRITE L0898-PRTREC    FROM  L089-LINE04.                            
            WRITE L0898-PRTREC    FROM  L089-LINE05.                            
            WRITE L0898-PRTREC    FROM  L089-LINE06.                            
            WRITE L0898-PRTREC    FROM  L089-LINE07.                            
            WRITE L0898-PRTREC    FROM  L089-LINE08    AFTER 3.                 
            WRITE L0898-PRTREC    FROM  L089-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE L0898-PRTREC    FROM  L089-LINE8G       AFTER 3.              
                                                                                
            MOVE SPACES           TO    L0898-PRTREC                            
                                        DJDE-LINE-ZR(49:4)                      
            WRITE L0898-PRTREC    FROM  DJDE-BLANKF        AFTER PAGE.          
            MOVE SPACES           TO    L0898-PRTREC                            
            WRITE L0898-PRTREC                             AFTER PAGE.          
                                                                                
       6280-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6500-PRINT-CONTROL-LIST.                                                 
      *=============================================================            
      *    PRINT CONTROL LISTING FOR SUCCESSFUL APPLICANTS                      
      *-------------------------------------------------------------            
                                                                                
           MOVE F740-NUM-REF              TO    L089A-REF-NO.                   
           MOVE F740-NUM-REGN             TO    L089A-REGN-NO.                  
           MOVE L089-NAME                 TO    L089A-NAME-1.                   
           MOVE F740-NUM-NRIC1            TO    L089A-NRIC-1.                   
           MOVE F740-CDE-NT1              TO    L089A-NT1.                      
           MOVE F740-CDE-HOUSEHOLD        TO    L089A-HHTY.                     
           MOVE F740-NUM-MCPS             TO    L089A-MCPS.                     
           MOVE F740-CDE-RESIDENT-HA1     TO    L089A-RES-HA1.                  
           MOVE F740-CDE-FLAT-TYPE        TO    L089A-FLAT.                     
           MOVE F740-CDE-ALLOC-SCH        TO    L089A-ALLOC.                    
           MOVE F740-CDE-UNSUCC           TO    L089A-UNSUCC.                   
           MOVE F740-CDE-CATEGORY         TO    L089A-CAT.                      
           MOVE F740-CDE-SUCC-NT-ZONE     TO    L089A-SUCC.                     
           MOVE F740-CDE-ZONE             TO    L089A-ZONE.                     
           MOVE L089-NAME2                TO    L089A-NAME-2.                   
           IF F740-NUM-NRIC2 (2:1) NOT = '#'                                    
              MOVE F740-NUM-NRIC2         TO    L089A-NRIC-2                    
           ELSE                                                                 
              MOVE SPACES                 TO    L089A-NRIC-2.                   
           MOVE F740-NUM-NT-FT-QUEUE      TO    L089A-QUEUE.                    
           MOVE F740-NUM-BALLOT-POSITION  TO    L089A-BALLOT-POS.               
           MOVE F740-NUM-LOAN-TAG         TO    L089A-LOAN-TAG.                 
           MOVE F740-CDE-REQUEST-STATUS   TO    L089A-REQ-STATUS.               
                                                                                
      *-----------> PREPARE ADDRESS FOR BP13L089A CONTROL LIST                  
           MOVE SPACES                    TO    L089A-DTL-3.                    
           MOVE L089-BLK                  TO    L089A-BLK.                      
           MOVE L089-UNIT                 TO    L089A-UNIT.                     
           MOVE L089-ADDR-L2              TO    L089A-ADDR2.                    
           MOVE L089-ADDR-L3              TO    L089A-ADDR3.                    
           MOVE L089-ADDR-L3              TO    L089A-ADDR3.                    
                                                                                
      * BP133380                                                                
           IF F740-NUM-ALLO-CAT = 'BTO'                                         
              IF (F740-NUM-NT-FT-QUEUE = SPACES OR LOW-VALUES) OR               
                 (F740-NUM-GEN3 = 'Y' AND F740-CDE-REQUEST-STATUS = 'K')        
                 STRING 'CONTROL LIST FOR UNSUCCESSFUL LETTERS W/O '            
                        'EMAIL ADDRESSES (APPLICATION BEYOND 300%)'             
                 DELIMITED BY SIZE INTO L089A-LISTING-TYPE                      
                 PERFORM 6700-PRINT-CONTROL-UNSUCC THRU 6700-EXIT               
              ELSE                                                              
                 STRING 'CONTROL LIST FOR SUCCESSFUL LETTERS W/O EMAIL '        
                        'ADDRESSES (APPLICATION WITHIN 300%)'                   
                 DELIMITED BY SIZE INTO L089A-LISTING-TYPE                      
                 PERFORM 6600-PRINT-CONTROL-SUCC   THRU 6600-EXIT               
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6600-PRINT-CONTROL-SUCC.                                                 
      **************************************************************            
                                                                                
           MOVE 'P13L089C'             TO L089A-LISTING.                        
           ADD    1                    TO    WS-CNT-LETTERS-SUCC.               
           MOVE   WS-CNT-LETTERS-SUCC  TO    L089A-SERIAL-NO.                   
                                                                                
           IF WS-CNT-LINE-L089C > WS2-MAX-LINES-L089C                           
              ADD   1                  TO   WS-CNT-PAGE-L089C                   
              MOVE  1                  TO   WS-CNT-LINE-L089C                   
              MOVE  WS-CNT-PAGE-L089C  TO   L089A-PAGE                          
              WRITE L089C-PRTREC       FROM L089A-HDG1 AFTER PAGE               
                                                                                
              WRITE L089C-PRTREC       FROM L089A-HDG2 AFTER 1                  
              WRITE L089C-PRTREC       FROM L089A-HDG4 AFTER 2                  
              WRITE L089C-PRTREC       FROM L089A-HDG5 AFTER 1                  
              WRITE L089C-PRTREC       FROM L089A-HDG6 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   L089C-PRTREC                        
              WRITE L089C-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   L089C-PRTREC         FROM  L089A-DTL-1 AFTER 1.              
           WRITE   L089C-PRTREC         FROM  L089A-DTL-2 AFTER 1.              
           WRITE   L089C-PRTREC         FROM  L089A-DTL-3 AFTER 1.              
           WRITE   L089C-PRTREC         FROM  L089A-DTL-4 AFTER 1.              
           MOVE    SPACES               TO    L089C-PRTREC.                     
           WRITE   L089C-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-L089C.                
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6700-PRINT-CONTROL-UNSUCC.                                               
      **************************************************************            
                                                                                
           MOVE 'P13L089D'             TO L089A-LISTING.                        
           ADD    1                    TO    WS-CNT-LETTERS-UNSUCC.             
           MOVE   WS-CNT-LETTERS-UNSUCC  TO    L089A-SERIAL-NO.                 
                                                                                
           IF WS-CNT-LINE-L089D > WS2-MAX-LINES-L089D                           
              ADD   1                  TO   WS-CNT-PAGE-L089D                   
              MOVE  1                  TO   WS-CNT-LINE-L089D                   
              MOVE  WS-CNT-PAGE-L089D  TO   L089A-PAGE                          
              WRITE L089D-PRTREC       FROM L089A-HDG1 AFTER PAGE               
                                                                                
              WRITE L089D-PRTREC       FROM L089A-HDG2 AFTER 1                  
              WRITE L089D-PRTREC       FROM L089A-HDG4 AFTER 2                  
              WRITE L089D-PRTREC       FROM L089A-HDG5 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   L089D-PRTREC                        
              WRITE L089D-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   L089D-PRTREC         FROM  L089A-DTL-1 AFTER 1.              
           WRITE   L089D-PRTREC         FROM  L089A-DTL-2 AFTER 1.              
           WRITE   L089D-PRTREC         FROM  L089A-DTL-3 AFTER 1.              
           MOVE    SPACES               TO    L089D-PRTREC.                     
           WRITE   L089D-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-L089D.                
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7000-CHECK-SCH.                                                          
      **************************************************************            
                                                                                
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
               AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                            
             WHEN F740-CDE-ALLOC-SCH = WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)          
             MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO WS-ALLOCSCH-TYPE.             
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7200-READ-K813.                                                          
      **************************************************************            
                                                                                
           MOVE SPACES                 TO K813-KEY-FLD.                         
           MOVE F740-CDE-NT1           TO K813-NUM-ZONE.                        
           MOVE F740-CDE-FLAT-TYPE     TO K813-NUM-FLAT-TYPE.                   
           MOVE F740-DTE-BALLOT        TO K813-DTE-BALLOT.                      
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE WS-K813-STATUS                                              
           WHEN 00                                                              
              MOVE K813-NME-PROJECT-LTR     TO L089-BTO-ESTATE1                 
                                               L089-BTO-ESTATE2                 
                                               L089-BTO-ESTATE3                 
                                               L089-BTO-ESTATE4                 
                                               L089-BTO-ESTATE5                 
                                                                                
              MOVE K813-TXT-SEL-PERIOD-LTR  TO L089-DTE-SEL-BE5                 
                                                                                
              STRING K813-DTE-LETTER-PRINT (7:2) '/'                            
                     K813-DTE-LETTER-PRINT (5:2) '/'                            
                     K813-DTE-LETTER-PRINT(1:4)                                 
              DELIMITED BY SIZE INTO L089-DATE                                  
                                                                                
              MOVE K813-NUM-UNIT-OFFER      TO L089-UNIT-OFFER-B                
                                               L089-UNIT-OFFER-C                
                                               L089-UNIT-OFFER-D                
                                               L089-UNIT-OFFER-E                
                                                                                
              MOVE K813-TXT-NEXT-LAUNCH-LTR TO L089-NEXT-LAUNCH                 
                                                                                
              MOVE K813-NME-PROJECT-MGPS-LTR   TO L089-GEN3-ESTATE              
                                                                                
              MOVE K813-NUM-QUEUE-START     TO WS-NUM-QUEUE-START               
              MOVE K813-NUM-QUEUE-MID       TO WS-NUM-QUEUE-MID                 
              MOVE K813-NUM-QUEUE-END       TO WS-NUM-QUEUE-END                 
                                                                                
              MOVE K813-NME-FLAT-TYPE-LTR   TO L089-ROOM-NO                     
                                                                                
           WHEN 23                                                              
              CONTINUE                                                          
                                                                                
           WHEN OTHER                                                           
              MOVE WS-K813-STATUS           TO RETURN-CODE                      
              DISPLAY 'BP13K813 READ ERROR, STATUS ' WS-K813-STATUS             
              PERFORM 9000-CLOSE-ROUTINE    THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13C089 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F740 RECORDS READ          : ' WS-F740-READ-CTR.           
           DISPLAY ' 3GEN FLAT          (BP13HA): ' WS-L0897-WRT-CTR.           
           DISPLAY ' 50%  NME/ME/FTS    (BP13VA): ' WS-L089J-WRT-CTR.           
           DISPLAY ' 100% NME/ME/FTS    (BP13VC): ' WS-L0894-WRT-CTR.           
           DISPLAY ' 200% NME/FTS       (BP13VE): ' WS-L0895-WRT-CTR.           
           DISPLAY ' 200% MAT           (BP13VF): ' WS-L089L-WRT-CTR.           
           DISPLAY ' 300% NME/FTS       (BP13VH): ' WS-L0896-WRT-CTR.           
           DISPLAY ' 300% MAT           (BP13VI): ' WS-L0893-WRT-CTR.           
           DISPLAY ' >300% NON-MAT      (BP13VK): ' WS-L089V-WRT-CTR.           
           DISPLAY ' >300% MAT          (BP13VL): ' WS-L089W-WRT-CTR.           
           DISPLAY ' >300% FTS          (BP13ZR): ' WS-L0898-WRT-CTR.           
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13F740                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 BP13K813                                                       
                 P13L089C                                                       
                 P13L089D                                                       
                 P13L089J                                                       
                 P13L089L                                                       
                 P13L089V                                                       
                 P13L089W                                                       
                 P13L0893                                                       
                 P13L0894                                                       
                 P13L0895                                                       
                 P13L0896                                                       
                 P13L0897                                                       
                 P13L0898.                                                      
                                                                                
           IF WS-K825-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K825-STAT ' WS-K825-STATUS.            
                                                                                
           IF WS-K830-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS.            
                                                                                
           IF WS-K813-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K813-STAT ' WS-K813-STATUS.            
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
