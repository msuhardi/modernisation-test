      *----------------------------------------------------------------*        
       IDENTIFICATION DIVISION.                                                 
      *----------------------------------------------------------------*        
       PROGRAM-ID.    BP13C376.                                                 
       AUTHOR.        SK.                                                       
       DATE-WRITTEN.  03/02/2004.                                               
                                                                                
      ******************************************************************        
      *                                                                *        
      *   SYSTEM NAME :  SYSTEM OF COMMITMENT  (SOC)                   *        
      *                                                                *        
      *   SYSTEM ID   :  BP13                                          *        
      *                                                                *        
      *   OBJECTIVE   :  PRINT REPORT OF SURRENDER OF STUDIO APPARTMENT*        
      *                  COMPLETIONS RECEIVED                          *        
      *                                                                *        
      *   INPUT FILES :  1.  BP13F690  -  FIS/SLS INTERFACE FILE       *        
      *                                                                *        
      *   OUPUT FILES :  1.  BP13L376                                  *        
      *----------------------------------------------------------------*        
      *                                                                *        
      *   CHGE-NO   BY    DATE      DESCRIPTION                        *        
      *   --------  ---  ---------- -----------                        *        
      *   BP132292  SK   03/02/2004 NEW PGM                            *        
      *   BP132571  SK   27/07/2004 PRINT NULL REPORT                  *        
      *   BP135903  FNP  25/11/2015 ADD INTERNAL ORDER                 *        
      *   BP136398  FNP  17/08/2016 EXPAND F690 FROM 250 TO 600        *        
      *   BP136966  FNP  08/08/2017 CHANGE OUTPUT FILE TO SEMI-COLON   *        
      *                             DELIMITED. INCLUDE GRANTS IN OUTPUT*        
      *   BP137219  FNP  20/02/2018 CATER FOR FSH GRANT/SALES PRICE    *        
      *   BP137539  FNP  22/10/2018 CHANGE PAY-TYP FOR TOPUP-LEASE     *        
      *                             CHANGE SIZE OF TEMP STORAG FOR              
      *                             DEFER INCOME AND RELATED FIELDS             
      *   BP138083  KR13 18/01/2020 ADDED EHG                          *        
      *   BP138560  FP6  29/12/2020 ADDED LHG                          *        
      *   BP138663  FP6  26/08/2021 CATER FOR CCA                      *        
      *   BP138944  FP6  14/10/2021 EXPAND F690 FROM 600 TO 800        *        
      *                             ADDED SUG                          *        
      *   BP139942  ZAR7 21/03/2024 REPALCE 410101 WITH 41CZ01         *        
      ******************************************************************        
                                                                                
      *----------------------------------------------------------------*        
       ENVIRONMENT DIVISION.                                                    
      *----------------------------------------------------------------*        
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F690  ASSIGN        TO BP13F690.                          
           SELECT SY02F001  ASSIGN        TO SY02F001.                          
           SELECT BP13L376  ASSIGN        TO BP13L376.                          
                                                                                
      *----------------------------------------------------------------*        
       DATA DIVISION.                                                           
      *----------------------------------------------------------------*        
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  BP13F690                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 800 CHARACTERS                                       
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F690.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD  BP13L376                                                             
           RECORDING MODE IS F                                                  
           RECORD CONTAINS  300 CHARACTERS.                                     
                                                                                
       01  BP13L376-REC         PIC X(300).                                     
                                                                                
      *----------------------------------------------------------------*        
       WORKING-STORAGE SECTION.                                                 
      *----------------------------------------------------------------*        
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-CNT-F690-READ        PIC 9(8)  VALUE 0.                        
                                                                                
       01  WS-SWITCHES.                                                         
           05 WS-F690-EOF             PIC X(1)  VALUE 'N'.                      
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-CCYY            PIC 9(4).                                 
           05  WS-SYS-MM              PIC 9(2).                                 
           05  WS-SYS-DD              PIC 9(2).                                 
                                                                                
       01  WS-TP-DATE.                                                          
           05  WS-TP-CCYY               PIC X(4)    VALUE SPACES.               
           05  WS-TP-MM                 PIC X(2)    VALUE SPACES.               
           05  WS-TP-DD                 PIC X(2)    VALUE SPACES.               
                                                                                
       01  WS-TP-DATE1                  REDEFINES WS-TP-DATE.                   
           05  WS-TP-CCYY1              PIC 9(4).                               
           05  WS-TP-MM1                PIC 9(2).                               
           05  WS-TP-DD1                PIC 9(2).                               
                                                                                
       01  WS-EFF-DATE.                                                         
           05  WS-EFF-CCYY              PIC 9(4)    VALUE ZEROS.                
           05  WS-EFF-MM                PIC 9(2)    VALUE ZEROS.                
           05  WS-EFF-DD                PIC 9(2)    VALUE ZEROS.                
                                                                                
       01  WS-UNIT.                                                             
           05  WS-HSELVL                PIC X(2)    VALUE SPACES.               
           05  FILLER                   PIC X(1)    VALUE '-'.                  
           05  WS-HSEMAIN               PIC X(4)    VALUE SPACES.               
           05  FILLER                   PIC X(1)    VALUE '-'.                  
           05  WS-HSESUB                PIC X(3)    VALUE SPACES.               
                                                                                
       01  WS-DTE-SURR.                                                         
           05  WS-SURR-CCYY             PIC 9(4)    VALUE ZEROS.                
           05  WS-SURR-MM               PIC 9(2)    VALUE ZEROS.                
           05  WS-SURR-DD               PIC 9(2)    VALUE ZEROS.                
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-CNT-WRITE-L376         PIC 9(8)    VALUE 0.                    
           05 WS-SN-NO                  PIC 9(5)    VALUE 0.                    
           05 WS-DIFF-MTH               PIC 9(2)    VALUE ZEROS.                
           05 WS-CNT                    PIC 9(02)   VALUE ZEROS.                
           05 CNT                       PIC 9(02)   VALUE ZEROS.                
           05 WS-AMT-VARS OCCURS 9 TIMES.                                       
              10  WS-ORG-AMT            PIC 9(6)V99.                            
              10  WS-MTH-AMT            PIC 9(6)V99.                            
              10  WS-YTD-AMT            PIC 9(6)V99.                            
              10  WS-BAL-AMT            PIC 9(6)V99.                            
              10  WS-SUR-AMT            PIC 9(6)V99.                            
              10  WS-COM-AMT            PIC S9(6)V99.                           
              10  WS-DIF-AMT            PIC S9(6)V99.                           
              10  WS-INT-ORD            PIC X(6).                               
              10  WS-PAY-TYP            PIC X(7).                               
                                                                                
       01  WS-EDITED-DATE.                                                      
           05  WS-EDITED-DD           PIC 9(2).                                 
           05  FILLER                 PIC X(1)  VALUE '/'.                      
           05  WS-EDITED-MM           PIC 9(2).                                 
           05  FILLER                 PIC X(1)  VALUE '/'.                      
           05  WS-EDITED-CCYY         PIC 9(4).                                 
                                                                                
      *-----------------------------------------------------------*             
      *    WS FOR CONTROL LISTING                                 *             
      *-----------------------------------------------------------*             
                                                                                
       01  L376-PR-HEAD-01.                                                     
           05  FILLER          PIC X(4)  VALUE ' SN'.                           
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(11) VALUE 'SCHEME A/C'.                    
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(2)  VALUE 'FT'.                            
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(9)  VALUE 'NUM AMORT'.                     
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(6)  VALUE 'TENURE'.                        
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(13) VALUE 'DEF INC/GRANT'.                 
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(10) VALUE 'MTH AMT'.                       
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(10) VALUE 'YTD AMT'.                       
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(12) VALUE 'BAL AMT'.                       
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(12) VALUE 'REQ SURR AMT'.                  
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(13) VALUE 'AMT COMPN'.                     
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(13) VALUE 'AMT DIFF'.                      
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(07) VALUE 'INT ORD'.                       
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(07) VALUE 'PAY TYP'.                       
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(10) VALUE 'TP DATE'.                       
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(10) VALUE 'EFF DATE'.                      
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(10) VALUE 'COMPL DATE'.                    
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(13) VALUE 'REQ SURR DATE'.                 
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(10) VALUE 'COMPN DATE'.                    
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(70) VALUE 'ADDRESS'.                       
           05  FILLER          PIC X(1)  VALUE ';'.                             
           05  FILLER          PIC X(3)  VALUE 'RMK'.                           
                                                                                
       01  L376-PR-DETAILS-1.                                                   
           05  L376-NUMBER           PIC ZZZ9  BLANK WHEN ZERO.                 
           05  FIL01                 PIC X(1)  VALUE SPACES.                    
           05  L376-SCH-ACC          PIC X(11) VALUE SPACES.                    
           05  FIL02                 PIC X(1)  VALUE SPACES.                    
           05  L376-PRT-FLAT         PIC X(2)  VALUE SPACES.                    
           05  FIL03                 PIC X(1)  VALUE SPACES.                    
           05  L376-AMORT-NUM        PIC ZZZ   VALUE ZEROES.                    
           05  FILLER                PIC X(6)  VALUE SPACES.                    
           05  FIL04                 PIC X(1)  VALUE SPACES.                    
           05  L376-TENURE           PIC X(6)  VALUE SPACES.                    
           05  FIL20                 PIC X(1)  VALUE SPACES.                    
           05  L376-DEF-INC          PIC $,$$$,$$9.99.                          
           05  FIL05                 PIC X(1)  VALUE SPACES.                    
           05  L376-AMORT-INC        PIC $$$,$$9.99.                            
           05  FIL06                 PIC X(2)  VALUE SPACES.                    
           05  L376-YTD-INC          PIC $$$,$$9.99.                            
           05  FIL07                 PIC X(1)  VALUE SPACES.                    
           05  L376-BAL-DEF          PIC $,$$$,$$9.99.                          
           05  FIL08                 PIC X(1)  VALUE SPACES.                    
           05  L376-SURR-AMT         PIC $,$$$,$$9.99.                          
           05  FIL09                 PIC X(1)  VALUE SPACES.                    
           05  L376-AMT-COMPEN       PIC $,$$$,$$9.99-.                         
           05  FIL10                 PIC X(1)  VALUE SPACES.                    
           05  L376-AMT-DIFF         PIC $,$$$,$$9.99-.                         
           05  FIL11                 PIC X(1)  VALUE SPACES.                    
           05  L376-INT-ORDER        PIC X(07) VALUE SPACES.                    
           05  FIL12                 PIC X(1)  VALUE SPACES.                    
           05  L376-PAY-TYPE         PIC X(07) VALUE SPACES.                    
           05  FIL13                 PIC X(1)  VALUE SPACES.                    
           05  L376-TP-DTE           PIC X(10) VALUE SPACES.                    
           05  FIL14                 PIC X(1)  VALUE SPACES.                    
           05  L376-EFF-DTE          PIC X(10) VALUE SPACES.                    
           05  FIL15                 PIC X(1)  VALUE SPACES.                    
           05  L376-COMP-DATE        PIC X(10) VALUE SPACES.                    
           05  FIL16                 PIC X(1)  VALUE SPACES.                    
           05  L376-REQ-SURR-DTE     PIC X(13) VALUE SPACES.                    
           05  FIL17                 PIC X(1)  VALUE SPACES.                    
           05  L376-DTE-LAST         PIC X(10) VALUE SPACES.                    
           05  FIL18                 PIC X(1)  VALUE SPACES.                    
           05  L376-ADDRESS          PIC X(70) VALUE SPACES.                    
           05  FIL19                 PIC X(1)  VALUE SPACES.                    
           05  L376-RMK              PIC X(3)  VALUE SPACES.                    
                                                                                
       01  L376-PR-FOOT-NOTE1.                                                  
           05  FILLER                   PIC X(05) VALUE 'RMK:'.                 
           05  FILLER                   PIC X(75) VALUE                         
               'EC = TOTAL COMPENSATION AMT GREATER THAN SURRENDER AMT'.        
                                                                                
       01  L376-PR-FOOT-NOTE2.                                                  
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(75) VALUE                         
               'ND = COMPLETION DATE RECEIVED WITH NO SURRENDER DATE'.          
                                                                                
       01  L376-PR-FOOT-NOTE3.                                                  
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(75) VALUE                         
               'NC = COMPLETION DATE RECEIVED WITH NO COMPENSATION AMT'.        
                                                                                
       01  L376-PR-NO-RECORD.                                                   
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(75) VALUE                         
               'NO RECORDS TO BE PRINTED!!!!'.                                  
                                                                                
      *----------------------------------------------------------------*        
       PROCEDURE DIVISION.                                                      
      *----------------------------------------------------------------*        
                                                                                
      *----------------------------------------------------------------*        
       0000-MAIN-ROUTINE.                                                       
      *----------------------------------------------------------------*        
                                                                                
           PERFORM  1000-OPEN-FILES      THRU    1000-EXIT.                     
           PERFORM  1100-READ-SY02F001   THRU    1100-EXIT.                     
           PERFORM  2000-READ-BP13F690   THRU    2000-EXIT.                     
           PERFORM  3000-PROCESS         THRU    3000-EXIT                      
                    UNTIL WS-F690-EOF = 'Y'.                                    
           IF WS-CNT-F690-READ < 1                                              
              WRITE BP13L376-REC  FROM  L376-PR-NO-RECORD AFTER 5               
           END-IF.                                                              
           PERFORM  4250-PRINT-FOOT-NOTE THRU    4250-EXIT.                     
           PERFORM  9000-CLOSE-ROUTINE   THRU    9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       1000-OPEN-FILES.                                                         
      *----------------------------------------------------------------*        
                                                                                
           OPEN INPUT  BP13F690                                                 
                       SY02F001                                                 
                OUTPUT BP13L376.                                                
                                                                                
           MOVE FUNCTION CURRENT-DATE   TO WS-SYSTEM-DATE.                      
           MOVE WS-SYS-DD               TO WS-EDITED-DD.                        
           MOVE WS-SYS-MM               TO WS-EDITED-MM.                        
           MOVE WS-SYS-CCYY             TO WS-EDITED-CCYY.                      
                                                                                
           WRITE BP13L376-REC  FROM  L376-PR-HEAD-01.                           
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       1100-READ-SY02F001.                                                      
      *----------------------------------------------------------------*        
                                                                                
           READ SY02F001 AT END                                                 
                GO TO 1100-EXIT                                                 
           END-READ.                                                            
                                                                                
       1100-EXIT.                                                               
           EXIT.                                                                
      *----------------------------------------------------------------*        
       2000-READ-BP13F690.                                                      
      *----------------------------------------------------------------*        
                                                                                
           READ BP13F690                                                        
                AT END                                                          
                   MOVE 'Y' TO WS-F690-EOF                                      
                NOT AT END                                                      
                   ADD 1 TO WS-CNT-F690-READ                                    
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3000-PROCESS.                                                            
      *----------------------------------------------------------------*        
                                                                                
           MOVE  0      TO WS-CNT.                                              
                                                                                
           PERFORM VARYING CNT FROM 1 BY 1 UNTIL CNT > 9                        
              MOVE ZEROES   TO  WS-ORG-AMT(CNT)                                 
                                WS-MTH-AMT(CNT)                                 
                                WS-YTD-AMT(CNT)                                 
                                WS-BAL-AMT(CNT)                                 
                                WS-SUR-AMT(CNT)                                 
                                WS-COM-AMT(CNT)                                 
                                WS-DIF-AMT(CNT)                                 
              MOVE SPACES   TO  WS-INT-ORD(CNT)                                 
                                WS-PAY-TYP(CNT)                                 
           END-PERFORM.                                                         
                                                                                
           PERFORM 3100-PROCESS1      THRU 3100-EXIT.                           
                                                                                
           PERFORM 2000-READ-BP13F690 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3100-PROCESS1.                                                           
      *----------------------------------------------------------------*        
                                                                                
           PERFORM 3500-COMPUTE-PARA THRU 3500-EXIT.                            
                                                                                
                                                                                
           PERFORM VARYING CNT FROM 1 BY 1 UNTIL CNT > WS-CNT                   
              PERFORM 4100-WRITE-BP13L376 THRU 4100-EXIT                        
           END-PERFORM.                                                         
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3500-COMPUTE-PARA.                                                       
      *----------------------------------------------------------------*        
                                                                                
      ****INITIALIZE VARIABLES                                                  
           IF F690-AMT-DEFER-INCOME NOT NUMERIC                                 
              MOVE ZEROS TO F690-AMT-DEFER-INCOME                               
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-INCOME-MTH NOT NUMERIC                             
              MOVE ZEROS TO F690-AMT-AMORT-INCOME-MTH                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-INCOME-ACCUM NOT NUMERIC                           
              MOVE ZEROS TO F690-AMT-AMORT-INCOME-ACCUM                         
           END-IF.                                                              
                                                                                
           IF F690-AMT-COMPENSATION NOT NUMERIC                                 
              MOVE ZEROS TO F690-AMT-COMPENSATION                               
           END-IF.                                                              
                                                                                
           IF F690-AMT-SELLING-PRICE NOT NUMERIC                                
              MOVE ZEROS TO F690-AMT-SELLING-PRICE                              
           END-IF.                                                              
                                                                                
           IF F690-AMT-SINGLES-PREMIUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-SINGLES-PREMIUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SGP-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-SGP-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SGP-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SGP-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SC-SPR-PREMIUM NOT NUMERIC                               
              MOVE ZEROES TO F690-AMT-SC-SPR-PREMIUM                            
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SPR-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-SPR-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SPR-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SPR-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-ELDERLY-PREMIUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-ELDERLY-PREMIUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-ELD-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-ELD-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-ELD-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-ELD-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-AHG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-AHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-AHG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-AHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-AHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-AHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-EHG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-EHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-EHG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-EHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-EHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-EHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-LHG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-LHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-LHG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-LHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-LHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-LHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SHG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-SHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SHG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-SHG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SRG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-SRG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SRG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-SRG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SRG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SRG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-REG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-REG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-REG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-REG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-REG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-REG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-FSG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-FSG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-FSG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-FSG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-FSG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-FSG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF F690-AMT-SUG-GRANT NOT NUMERIC                                    
              MOVE ZEROES TO F690-AMT-SUG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SUG-MTH NOT NUMERIC                                
              MOVE ZEROES TO F690-AMT-AMORT-SUG-MTH                             
           END-IF.                                                              
                                                                                
           IF F690-AMT-AMORT-SUG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO F690-AMT-AMORT-SUG-ACCUM                           
           END-IF.                                                              
                                                                                
      ***END INITIALIZE                                                         
                                                                                
      ***DEFER INCOME                                                           
           IF F690-AMT-DEFER-INCOME NOT = ZEROES                                
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-DEFER-INCOME       TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-INCOME-MTH   TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-INCOME-ACCUM TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-DEFER-INCOME -              
                                           F690-AMT-AMORT-INCOME-ACCUM          
                                                                                
              MOVE F690-AMT-SURRENDER-BAL      TO WS-SUR-AMT(WS-CNT)            
              MOVE F690-AMT-COMPENSATION       TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = F690-AMT-COMPENSATION -              
                                           WS-BAL-AMT(WS-CNT)                   
                                                                                
              IF F690-NUM-AMORTISE-TRANS = 'H'                                  
                 MOVE '419200'        TO WS-INT-ORD(WS-CNT)                     
                 MOVE 'FSG SP'        TO WS-PAY-TYP(WS-CNT)                     
              ELSE                                                              
                 IF F690-NUM-AMORTISE-TRANS = 'L' OR 'F'                        
                    MOVE '407600'     TO WS-INT-ORD(WS-CNT)                     
                    IF F690-CDE-TYP-ACTUSE = '01' AND                           
                       F690-CDE-MODL-DESG  = '74'                               
                       MOVE 'CCA'     TO WS-PAY-TYP(WS-CNT)                     
                    ELSE                                                        
                       MOVE 'VRL'        TO WS-PAY-TYP(WS-CNT)                  
                    END-IF                                                      
                 ELSE                                                           
                    IF F690-NUM-AMORTISE-TRANS = 'S'                            
                       IF F690-NUM-TOPUP-LEASE = 'Y'                            
                          MOVE 'SA-LTU' TO WS-PAY-TYP(WS-CNT)                   
                       ELSE                                                     
                          MOVE 'SA '     TO WS-PAY-TYP(WS-CNT)                  
                       END-IF                                                   
                       MOVE '000000'  TO WS-INT-ORD(WS-CNT)                     
                    ELSE                                                        
                       MOVE SPACES    TO WS-INT-ORD(WS-CNT)                     
                                         WS-PAY-TYP(WS-CNT)                     
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***SINGLES PREMIUM                                                        
           IF F690-AMT-SINGLES-PREMIUM NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-SINGLES-PREMIUM    TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SGP-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SGP-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-SINGLES-PREMIUM -           
                                           F690-AMT-AMORT-SGP-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '41CZ01'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-SGP'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'SGP'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***SC/SPR PREMIUM                                                         
           IF F690-AMT-SC-SPR-PREMIUM  NOT = ZEROES                             
              ADD 1 TO  WS-CNT                                                  
              MOVE F690-AMT-SC-SPR-PREMIUM     TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SPR-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SPR-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-SC-SPR-PREMIUM  -           
                                           F690-AMT-AMORT-SPR-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '41CZ01'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-SPR'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'SPR'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***ELDERLY PREMIUM                                                        
           IF F690-AMT-ELDERLY-PREMIUM NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-ELDERLY-PREMIUM    TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-ELD-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-ELD-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-ELDERLY-PREMIUM -           
                                           F690-AMT-AMORT-ELD-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '407400'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-ELD'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'ELD'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***AHG GRANT                                                              
           IF F690-AMT-AHG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-AHG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-AHG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-AHG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-AHG-GRANT       -           
                                           F690-AMT-AMORT-AHG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '407000'                    TO WS-INT-ORD(WS-CNT)            
              MOVE 'AHG'                       TO WS-PAY-TYP(WS-CNT)            
           END-IF.                                                              
                                                                                
      ***EHG GRANT                                                              
           IF F690-AMT-EHG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-EHG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-EHG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-EHG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-EHG-GRANT       -           
                                           F690-AMT-AMORT-EHG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '407900'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-EHG'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'EHG'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***LHG GRANT                                                              
           IF F690-AMT-LHG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-LHG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-LHG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-LHG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-LHG-GRANT       -           
                                           F690-AMT-AMORT-LHG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '524300'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-LHG'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'LHG'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***SHG GRANT                                                              
           IF F690-AMT-SHG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-SHG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SHG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SHG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-SHG-GRANT       -           
                                           F690-AMT-AMORT-SHG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '407800'                    TO WS-INT-ORD(WS-CNT)            
              MOVE 'SHG'                       TO WS-PAY-TYP(WS-CNT)            
           END-IF.                                                              
                                                                                
      ***SRG GRANT                                                              
           IF F690-AMT-SRG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-SRG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SRG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SRG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-SRG-GRANT       -           
                                           F690-AMT-AMORT-SRG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '407300'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-SRG'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'SRG'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF F690-AMT-REG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-REG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-REG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-REG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-REG-GRANT       -           
                                           F690-AMT-AMORT-REG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '419200'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-REG'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'REG'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ***FSG GRANT                                                              
           IF F690-AMT-FSG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-FSG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-FSG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-FSG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-FSG-GRANT       -           
                                           F690-AMT-AMORT-FSG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '41FS00'                    TO WS-INT-ORD(WS-CNT)            
              MOVE 'FSG'                       TO WS-PAY-TYP(WS-CNT)            
           END-IF.                                                              
                                                                                
      ***SUG GRANT                                                              
           IF F690-AMT-SUG-GRANT       NOT = ZEROES                             
              ADD 1 TO WS-CNT                                                   
              MOVE F690-AMT-SUG-GRANT          TO WS-ORG-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SUG-MTH      TO WS-MTH-AMT(WS-CNT)            
              MOVE F690-AMT-AMORT-SUG-ACCUM    TO WS-YTD-AMT(WS-CNT)            
              COMPUTE WS-BAL-AMT(WS-CNT) = F690-AMT-SUG-GRANT       -           
                                           F690-AMT-AMORT-SUG-ACCUM             
                                                                                
              MOVE WS-BAL-AMT(WS-CNT)          TO WS-SUR-AMT(WS-CNT)            
              MOVE 0                           TO WS-COM-AMT(WS-CNT)            
                                                                                
              COMPUTE WS-DIF-AMT(WS-CNT) = WS-COM-AMT(WS-CNT)    -              
                                           WS-BAL-AMT(WS-CNT)                   
              MOVE '418200'                    TO WS-INT-ORD(WS-CNT)            
              IF F690-CDE-TYP-ACTUSE = '01' AND                                 
                 F690-CDE-MODL-DESG  = '74'                                     
                 MOVE 'CCA-SUG'                TO WS-PAY-TYP(WS-CNT)            
              ELSE                                                              
                 MOVE 'SUG'                    TO WS-PAY-TYP(WS-CNT)            
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------------------------------------------------*        
       4000-MOVE-PARA.                                                          
      *----------------------------------------------------------------*        
                                                                                
           ADD 1 TO WS-SN-NO.                                                   
           MOVE WS-SN-NO                     TO L376-NUMBER.                    
                                                                                
           PERFORM 4300-GET-EFF-DTE          THRU 4300-EXIT.                    
                                                                                
           MOVE  F690-NUM-SCH-ACC            TO L376-SCH-ACC.                   
                                                                                
           MOVE F690-CDE-TYP-ACTUSE          TO L376-PRT-FLAT.                  
           STRING F690-DTE-KEY-ISSUE(7:2) '/'                                   
                  F690-DTE-KEY-ISSUE(5:2) '/'                                   
                  F690-DTE-KEY-ISSUE                                            
                  DELIMITED BY SIZE                                             
                  INTO  L376-TP-DTE                                             
           END-STRING.                                                          
                                                                                
           MOVE  WS-ORG-AMT(CNT)              TO L376-DEF-INC.                  
           MOVE  WS-MTH-AMT(CNT)              TO L376-AMORT-INC.                
           MOVE  WS-YTD-AMT(CNT)              TO L376-YTD-INC.                  
                                                                                
           MOVE  WS-BAL-AMT(CNT)              TO L376-BAL-DEF.                  
           MOVE  WS-DIF-AMT(CNT)              TO L376-AMT-DIFF.                 
                                                                                
           IF F690-DTE-SURRENDER-REQUEST IS NUMERIC                             
              MOVE F690-DTE-SURRENDER-REQUEST TO WS-DTE-SURR                    
           ELSE                                                                 
              MOVE ZEROS                      TO WS-DTE-SURR                    
           END-IF.                                                              
                                                                                
           PERFORM 4350-GET-DIFF-MTH    THRU 4350-EXIT.                         
                                                                                
           MOVE WS-SUR-AMT(CNT)               TO L376-SURR-AMT.                 
           MOVE WS-COM-AMT(CNT)               TO L376-AMT-COMPEN.               
                                                                                
           IF F690-DTE-SURRENDER-REQUEST NOT = SPACES AND LOW-VALUES            
              STRING F690-DTE-SURRENDER-REQUEST(7:2) '/'                        
                     F690-DTE-SURRENDER-REQUEST(5:2) '/'                        
                     F690-DTE-SURRENDER-REQUEST(1:4)                            
                     DELIMITED BY SIZE                                          
                     INTO  L376-REQ-SURR-DTE                                    
              END-STRING                                                        
           ELSE                                                                 
              MOVE SPACES                     TO L376-REQ-SURR-DTE              
           END-IF.                                                              
                                                                                
           STRING WS-EFF-DATE(7:2) '/'                                          
                  WS-EFF-DATE(5:2) '/'                                          
                  WS-EFF-DATE(1:4)                                              
                  DELIMITED BY SIZE                                             
                  INTO  L376-EFF-DTE                                            
           END-STRING.                                                          
                                                                                
           IF F690-DTE-SURRENDER-COMPLETED NOT = SPACES AND LOW-VALUES          
              STRING F690-DTE-SURRENDER-COMPLETED(7:2) '/'                      
                     F690-DTE-SURRENDER-COMPLETED(5:2) '/'                      
                     F690-DTE-SURRENDER-COMPLETED(1:4)                          
                     DELIMITED BY SIZE                                          
                     INTO  L376-COMP-DATE                                       
              END-STRING                                                        
           ELSE                                                                 
              MOVE SPACES              TO  L376-COMP-DATE                       
           END-IF.                                                              
                                                                                
           IF F690-DTE-COMPENSATION-PD NOT = SPACES AND LOW-VALUES              
              STRING F690-DTE-COMPENSATION-PD(7:2) '/'                          
                     F690-DTE-COMPENSATION-PD(5:2) '/'                          
                     F690-DTE-COMPENSATION-PD(1:4)                              
                     DELIMITED BY SIZE                                          
                     INTO L376-DTE-LAST                                         
              END-STRING                                                        
           ELSE                                                                 
              MOVE SPACES              TO L376-DTE-LAST                         
           END-IF.                                                              
                                                                                
           MOVE  F690-NUM-AMORT        TO L376-AMORT-NUM.                       
           MOVE  F690-TRANS-RMK        TO L376-RMK.                             
                                                                                
           MOVE WS-INT-ORD(CNT)        TO L376-INT-ORDER.                       
           MOVE WS-PAY-TYP(CNT)        TO L376-PAY-TYPE.                        
                                                                                
           MOVE  F690-NUM-HSELVL    TO WS-HSELVL                                
           MOVE  F690-NUM-HSEMAIN   TO WS-HSEMAIN                               
           MOVE  F690-NUM-HSESUB    TO WS-HSESUB                                
                                                                                
           STRING 'BLK-' F690-NUM-BLOCK    ' #' WS-UNIT                         
                  ' ' F690-NME-STREET                                           
                  ' S(' F690-NUM-POSTAL ')'                                     
                  DELIMITED BY SIZE                                             
                  INTO  L376-ADDRESS.                                           
                                                                                
           MOVE  F690-NUM-LEASE-TENURE TO L376-TENURE.                          
                                                                                
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4100-WRITE-BP13L376.                                                     
      *----------------------------------------------------------------*        
                                                                                
           PERFORM 4000-MOVE-PARA    THRU 4000-EXIT.                            
                                                                                
           MOVE ';' TO   FIL01  FIL02  FIL03  FIL04                             
                         FIL05  FIL06  FIL07  FIL08                             
                         FIL09  FIL10  FIL11  FIL12                             
                         FIL13  FIL14  FIL15  FIL16                             
                         FIL17  FIL18  FIL19  FIL20.                            
                                                                                
           WRITE BP13L376-REC      FROM  L376-PR-DETAILS-1.                     
                                                                                
           ADD   1                 TO    WS-CNT-WRITE-L376.                     
                                                                                
           MOVE  SPACES            TO    L376-PR-DETAILS-1.                     
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------------------------------------------------*        
       4250-PRINT-FOOT-NOTE.                                                    
      *----------------------------------------------------------------*        
                                                                                
           WRITE BP13L376-REC   FROM  L376-PR-FOOT-NOTE1 AFTER 1.               
           WRITE BP13L376-REC   FROM  L376-PR-FOOT-NOTE2 AFTER 1.               
           WRITE BP13L376-REC   FROM  L376-PR-FOOT-NOTE3 AFTER 1.               
                                                                                
       4250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4300-GET-EFF-DTE.                                                        
      *----------------------------------------------------------------*        
                                                                                
           MOVE F690-DTE-KEY-ISSUE TO WS-TP-DATE.                               
                                                                                
           IF WS-TP-DD1 < 16                                                    
              MOVE WS-TP-CCYY1  TO WS-EFF-CCYY                                  
              MOVE WS-TP-MM1    TO WS-EFF-MM                                    
              MOVE 1            TO WS-EFF-DD                                    
           ELSE                                                                 
           IF WS-TP-DD1 > 15                                                    
              COMPUTE WS-TP-MM1 =  WS-TP-MM1 + 1                                
              IF WS-TP-MM1 > 12                                                 
                 COMPUTE WS-TP-CCYY1 = WS-TP-CCYY1 + 1                          
                 MOVE 1  TO WS-TP-MM1                                           
              END-IF                                                            
                                                                                
              MOVE WS-TP-CCYY1  TO WS-EFF-CCYY                                  
              MOVE WS-TP-MM1    TO WS-EFF-MM                                    
              MOVE 1            TO WS-EFF-DD                                    
           END-IF.                                                              
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4350-GET-DIFF-MTH.                                                       
      *----------------------------------------------------------------*        
                                                                                
           COMPUTE WS-DIFF-MTH = ((WS-SURR-CCYY * 12) + WS-SURR-MM) -           
                                 ((WS-EFF-CCYY * 12) + WS-EFF-MM) + 1.          
       4350-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *----------------------------------------------------------------*        
       9000-CLOSE-ROUTINE.                                                      
      *----------------------------------------------------------------*        
                                                                                
           CLOSE BP13F690                                                       
                 SY02F001                                                       
                 BP13L376.                                                      
                                                                                
           DISPLAY '                                  '.                        
           DISPLAY '************ BP13C376 ************'.                        
           DISPLAY 'DATE : ' WS-EDITED-DATE.                                    
           DISPLAY '                                    '.                      
           DISPLAY 'NO OF RECORDS READ       (BP13F690) = '                     
                    WS-CNT-F690-READ.                                           
           DISPLAY 'NO OF RECORD PRINTED     (BP13L376) = '                     
                    WS-CNT-WRITE-L376.                                          
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
