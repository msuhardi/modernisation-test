      *-----------------------*                                         00010038
       IDENTIFICATION DIVISION.                                         00020038
      *-----------------------*                                         00030038
       PROGRAM-ID.    BP13C470.                                         00040038
      *AUTHOR.        JAI.                                              00050038
      *DATE-WRITTEN.  MARCH 28 1995.                                    00060038
                                                                        00070038
      ******************************************************************00080038
      * OBJECTIVE  - TO IDENTIFY CASES TO SEND TO CPF BOARD FOR        *00090038
      *              WITHDRAWAL                                        *00100038
      ******************************************************************00110038
      *REF NO   DATE    BY   AMENDMENTS/ENHANCEMENTS                   *00120038
      *-------  ----    ---  -----------------------                   *00130038
      *C950642  06/07/95 LJL TO TAG 'P' FOR CDE-REPAYMT-TYPE FOR SOCA. *00140038
      *BP130094 12/04/96 LJL TO CATER FOR SUB-TRANSFER.                *00150038
      *         12/04/96 LJL TO ENSURE THAT THE 'T' CODE IS SPACES WHEN*00160038
      *                      AMOUNT IS ZEROES.                         *00170038
      *BP130371 20/08/97 LJL TO CATER FOR REGN DEPOSIT FOR FIANCEE CASE*00180038
      *BP130290 08/01/98 SGK RECOMPILED TO REFLECT THE CHANGE IN F435 &*00190038
      *                      K600                                      *00200038
      *BP130315 08/06/98 RHB CATER FOR RETIREMENT ACCOUNT.             *00210038
      *BP130418 26/06/98 RHB TO CHANGE BP13K410 TO BP13K410            *00220038
      *                      TO CHANGE BP13K800 TO BP13K800            *00230038
      *                      TO CHANGE BP13K330 TO BP13K330            *00240038
      *BP130929 MCC 13/10/00 TO CHANGE BP13F435 TO AB02F860            *00250038
      *BP132042 MAL 06/11/01 TO PASS CDE-STREET TO CPFB                *00260038
      *BP132795 CG7 06/12/05 TO PASS NUM-STUDIO-APT-TAG TO CPFB        *00270038
      *BP132814 BA3 04/04/06 TO PASS AMT-CPF-BLOCK                     *00280038
      *BP132839 CLT 15/05/06 TO PASS STUDIO CASE                       *00290038
      *BP132838 SSD 11/01/07 TO PASS DBSS CASE                         *00300038
      *BP133535 JB8 10/02/09 TO GET PIDB ADDRESS BY K600-SCH-ACC       *00310038
      *                      IF KD00 NOT FND                           *00320038
      *BP134872 ESD1 16/07/13 TO ADD LEASE COMMENCEMENT DATE,          *00330038
      *                       TENURE PERIOD AND DATE APPLICATION.      *00340038
      *BP135428 ESD1 24/11/14 TO INITIALISE BP13K800 RECORD.           *00350038
      *BP135428 ESD1 07/01/15 TO MOVE ZEROES TO PURCHASE PRICE FOR     *00360038
      *                       STUDIO APPOINTMENT CASE.                 *00370038
      *BP135585 JGO1 13/03/15 TO MOVE ZEROES ON DATE FIELS FOR SA      *00380038
      *BP135901 RJB1 03/09/15 TO CATER FOR CENTS FOR HOUSING GRANT     *00390038
      *BP136088 KSJ3 29/01/16 TO CATER FOR 2ROOM FLEXI (2F)            *00400038
      *                       TO INIT F860-AMT-FULL-RESL-PRICE         *00410038
      *BP136161 KSJ3 10/03/16 TO TAG SA/SLF FOR SERS LBS CASES         *00420038
      *BP136161 KSJ3 22/03/16 TO TAG SA/SLF FOR SERS LBS CASES         *00430038
      *BP136161 KSJ3 18/04/16 TO REMOVE SERS ANNOUNCEMENT DATE CHECKING*00440038
      *BP136161 KSJ3 23/05/16 TO REMOVE 30 YEARS LEASE TENURE LIMIT FOR*00450038
      *                       LBS STUDIO TAGGING                       *00460038
      *BP136632 KSJ3 21/03/17 EXPAND BP13K600 FROM 1000 TO 1800        *00470038
      *                       MOVE K600 EHPS FIELDS TO CPF FILE        *00480038
      *BP136412 KSJ3 02/05/17 TEMP BLOCK SENDING OF EHPS RECS          *00490038
      *BP136692 KSJ3 03/05/17 PROCESS EHPS                             *00500038
      *BP136755 RJB1 12/05/17 INSPECT FOR UNPRINTABLE CHARS            *00510038
      *BP136811 KSJ3 23/05/17 ALLOW DUPLICATES IN BP13K600             *00520038
      *BP136412 RJB1 08/06/17 REMOVE INSPECT FOR UNPRINTABLE CHARS     *00530038
      *BP136883 KSJ3 02/08/17 CATER FOR BYPASS-SEND                    *00540038
      *BP136757 KSJ3 22/08/17 FIX OR CONDITION FOR BYPASS-SEND         *00550038
      *BP137205 PCL4 09/02/18 TO ADD CHECK FOR STUDIO CASES            *00560038
      *BP137230 PCL4 05/03/18 TO MOVE ZEROES TO MI DATE FOR STUDIO CASE*00570038
      *BP137038 PCL4 17/04/18 TO PASS TEL NO & EMAIL ADDRESS TO AB02F86000580038
      *BP137349 PCL4 08/06/18 TO CATER FOR FSH SCHEME                  *00590038
      *BP137582 DN8  06/12/18 TO CHECK K600-CDE-STAMP-FEE TO READ MASTER00600038
      *                       FILE                                    * 00610038
      *BP138387 KAC1 22/07/20 CATER TO CHECK FOR HARDCODED RGN 3617879E*00620038
      *BP138642 ZDD1 15/03/21 TO FACILITATE SENDING TO CPFB REG 3804609H00630038
      *BP138694 ZDD1 15/03/21 TO FACILITATE SENDING TO CPFB REG 4026049H00640038
      *BP138786 ZDD1 29/06/21 DYNAMIC CALL OF BP13C913                  00650038
      *BP138694 ZDD1 19/07/21 TO FACILITATE SENDING TO CPFB REG 3351207D00660038
      *BP138702 ZDD1 27/08/21 TO CATER FOR CCA 1F                       00670038
      *BP138292 ZDD1 30/08/21 TO CATER FOR TEMP LOAN                    00680038
      *BP138694 ZDD1 06/10/21 TO FACILITATE SENDING TO CPFB REG 4126669D00690038
      *                       4003247I AND 3705472J.                    00700038
      *BP138694 KTM3 08/10/21 TO FACILITATE SENDING TO CPFB REG 3761141G00710038
      *BP138694 ZDD1 12/10/21 TO FACILITATE SENDING TO CPFB REG 3482912H00720038
      *BP138694 ZDD1 12/10/21 TO FACILITATE SENDING TO CPFB REG 3482912H00730038
      *BP138729 ZDD1 18/10/21 TO CATER FOR MANUAL HPS.                  00740038
      *BP138292 ZDD1 15/11/21 TO CATER FOR MANUAL HPS FOR 2F SHORT LEASE00750038
      *BP138053 ZDD1 17/11/21 TO CATER FOR SOCA, SUBTR AND OUTRIGHT PURC00760038
      *BP138913 ZDD1 19/11/21 TO CATER FOR SOCA CASES                   00770038
      *BP138292 ZDD1 01/12/21 TO CATER FOR APPL1 BUYING HPS BUT         00780038
      *                       APPLICANT2 NOT BUYING HPS BUT PAY DOWNPAYM00790038
      *BP138694 ZDD1 23/12/21 TO FACILITATE SENDING TO CPFB REG 3466482Z00800038
      *                       TO FACILITATE SENDING TO CPFB REG 4190192F00810038
      *                       TO FACILITATE SENDING TO CPFB REG 4261439D00811041
      *BP139066 ZDD1 07/02/22 TO FACILITATE NO LOAN CASE                00820038
      *BP139066 ZDD1 08/02/22 TO CHECK NUMERIC FIELDS ON NO LOAN CASE   00821038
      *BP138808 ZDD1 14/02/22 TO MOVE ZEROES TO F860-CDE-REPYMT-PERIOD  00821138
      *                       FOR NO LOAN CASE                          00821238
      *BP139066 ZDD1 28/03/22 TO ENSURE K600-DTE-ORIG-LOAN-COMM EQUAL   00821340
      *                       K600-DTE-LOAN-OS                          00821440
      *BP139477 ZDD1 09/02/23 TO CATER FOR GRANT > 100,000              00821542
      ******************************************************************00822038
                                                                        00823038
      *-----------------------*                                         00824038
       ENVIRONMENT DIVISION.                                            00825038
      *-----------------------*                                         00826038
       CONFIGURATION SECTION.                                           00827038
      *-----------------------*                                         00828038
                                                                        00829038
       SOURCE-COMPUTER. IBM-3090.                                       00830038
       OBJECT-COMPUTER. IBM-3090.                                       00840038
                                                                        00850038
      *-----------------------*                                         00860038
       INPUT-OUTPUT SECTION.                                            00870038
      *-----------------------*                                         00880038
       FILE-CONTROL.                                                    00890038
      *-----------------------*                                         00900038
                                                                        00910038
           SELECT BP13F600 ASSIGN       TO BP13F600.                    00920038
           SELECT BP13F60A ASSIGN       TO BP13F60A.                    00930038
                                                                        00940038
           SELECT BP13K600 ASSIGN       TO BP13K600                     00950038
                           ORGANIZATION IS INDEXED                      00960038
                           ACCESS MODE  IS DYNAMIC                      00970038
                           RECORD KEY   IS K600-KEY-FLD                 00980038
                           ALTERNATE KEY IS K600-NUM-ALTX1              00990038
                           FILE STATUS  IS K600-STATUS.                 01000038
                                                                        01010038
           SELECT BP13K410 ASSIGN       TO BP13K410                     01020038
                           ORGANIZATION IS INDEXED                      01030038
                           ACCESS MODE  IS RANDOM                       01040038
                           RECORD KEY   IS K410-KEY-FLD                 01050038
                           FILE STATUS  IS K410-STATUS.                 01060038
                                                                        01070038
           SELECT BP13K800 ASSIGN       TO BP13K800                     01080038
                           ORGANIZATION IS INDEXED                      01090038
                           ACCESS MODE  IS RANDOM                       01100038
                           RECORD KEY   IS K800-NUM-REGN                01110038
                           FILE STATUS  IS K800-STATUS.                 01120038
                                                                        01130038
           SELECT BP13K857 ASSIGN       TO BP13K857                     01140038
                           ORGANIZATION IS INDEXED                      01150038
                           ACCESS MODE  IS RANDOM                       01160038
                           RECORD KEY   IS K857-KEY-FLD                 01170038
                           FILE STATUS  IS K857-STATUS.                 01180038
                                                                        01190038
           SELECT BP13K882 ASSIGN       TO BP13K882                     01200038
                           ORGANIZATION IS INDEXED                      01210038
                           ACCESS MODE  IS DYNAMIC                      01220038
                           RECORD KEY   IS K882-KEY-FLD                 01230038
                           FILE STATUS  IS K882-STATUS.                 01240038
                                                                        01250038
           SELECT BP13K330 ASSIGN       TO BP13K330                     01260038
                           ORGANIZATION IS INDEXED                      01270038
                           ACCESS MODE  IS DYNAMIC                      01280038
                           RECORD KEY   IS K330-KEY-FLD                 01290038
                           FILE STATUS  IS K330-STATUS.                 01300038
                                                                        01310038
           SELECT AB02F860 ASSIGN       TO AB02F860.                    01320038
                                                                        01330038
           SELECT SY02F001 ASSIGN       TO SY02F001.                    01340038
                                                                        01350038
                                                                        01360038
      *-----------------------*                                         01370038
       DATA DIVISION.                                                   01380038
      *-----------------------*                                         01390038
       FILE SECTION.                                                    01400038
      *-----------------------*                                         01410038
                                                                        01420038
       FD   BP13K600                                                    01430038
            RECORD CONTAINS 1800 CHARACTERS.                            01440038
       COPY BP13K600.                                                   01450038
                                                                        01460038
       FD   BP13K410                                                    01470038
            RECORD CONTAINS 2000 CHARACTERS.                            01480038
       COPY BP13K410.                                                   01490038
                                                                        01500038
       FD   BP13K800                                                    01510038
            RECORD CONTAINS 2000 CHARACTERS.                            01520038
       COPY BP13K800.                                                   01530038
                                                                        01540038
       FD   BP13K882                                                    01550038
            RECORD CONTAINS 2000 CHARACTERS.                            01560038
       COPY BP13K882.                                                   01570038
                                                                        01580038
       FD   BP13K330                                                    01590038
            RECORD CONTAINS 2000 CHARACTERS.                            01600038
       COPY BP13K330.                                                   01610038
                                                                        01620038
       FD   BP13K857                                                    01630038
            RECORD CONTAINS 200 CHARACTERS.                             01640038
       COPY BP13K857.                                                   01650038
                                                                        01660038
       FD  AB02F860                                                     01670038
           BLOCK CONTAINS 0 RECORDS                                     01680038
           RECORD CONTAINS 2000 CHARACTERS                              01690038
           LABEL RECORDS ARE STANDARD                                   01700038
           RECORDING MODE IS F.                                         01710038
       COPY AB02F860.                                                   01720038
                                                                        01730038
       FD  BP13F600                                                     01740038
           BLOCK CONTAINS 0 RECORDS                                     01750038
           RECORD CONTAINS 1800 CHARACTERS                              01760038
           LABEL RECORDS ARE STANDARD                                   01770038
           RECORDING MODE IS F.                                         01780038
                                                                        01790038
       01   BP13F600-REC.                                               01800038
            05 F600-KEY-FLD              PIC X(31).                     01810038
            05 FILLER                    PIC X(1769).                   01820038
                                                                        01830038
       FD  BP13F60A                                                     01840038
           BLOCK CONTAINS 0 RECORDS                                     01850038
           RECORD CONTAINS 1800 CHARACTERS                              01860038
           LABEL RECORDS ARE STANDARD                                   01870038
           RECORDING MODE IS F.                                         01880038
                                                                        01890038
       01   BP13F60A-REC                 PIC X(1800).                   01900038
                                                                        01910038
       COPY SY02F001.                                                   01920038
                                                                        01930038
                                                                        01940038
      *-----------------------*                                         01950038
       WORKING-STORAGE SECTION.                                         01960038
      *-----------------------*                                         01970038
                                                                        01980038
       01  K857-STATUS                   PIC 9(02) VALUE 0.             01990038
       01  K600-STATUS                   PIC 9(02) VALUE 0.             02000038
       01  K410-STATUS                   PIC 9(02) VALUE 0.             02010038
       01  K800-STATUS                   PIC 9(02) VALUE 0.             02020038
       01  K882-STATUS                   PIC 9(02) VALUE 0.             02030038
       01  K330-STATUS                   PIC 9(02) VALUE 0.             02040038
       01  WS-F600-EOF                   PIC X(01) VALUE 'N'.           02050038
       01  WS-K330-FOUND                 PIC X(01) VALUE 'N'.           02060038
       01  WS-K410-FOUND                 PIC X(01) VALUE 'N'.           02070038
       01  WS-K800-FOUND                 PIC X(01) VALUE 'N'.           02080038
       01  WS-K882-FOUND                 PIC X(01) VALUE 'N'.           02090038
       01  WS-BP13C913                   PIC X(08) VALUE 'BP13C913'.    02100038
                                                                        02110038
       01  WS-COUNTERS.                                                 02120038
           05 WS-CNT-F600-READ           PIC 9(07) VALUE 0.             02130038
           05 WS-CNT-K600-READ           PIC 9(07) VALUE 0.             02140038
           05 WS-CNT-K410-READ           PIC 9(07) VALUE 0.             02150038
           05 WS-CNT-K800-READ           PIC 9(07) VALUE 0.             02160038
           05 WS-CNT-K882-READ           PIC 9(07) VALUE 0.             02170038
           05 WS-CNT-K330-READ           PIC 9(07) VALUE 0.             02180038
           05 WS-CNT-K600-BYPASS         PIC 9(07) VALUE 0.             02190038
           05 WS-CNT-K600-WRT            PIC 9(07) VALUE 0.             02200038
           05 WS-CNT-K600-DEL            PIC 9(07) VALUE 0.             02210038
           05 WS-CNT-F860-WRT            PIC 9(07) VALUE 0.             02220038
                                                                        02230038
       01  WS-COMPUTATION.                                              02240038
           05 WS-DIFF-GRANT              PIC S9(06)V99 VALUE 0.         02250042
                                                                        02260038
       01  WS-EHPS-VARS.                                                02270038
           05  WS-BP13K600-REC           PIC X(1800).                   02280038
           05  WS-K600-NUM-ORIG-REGN     PIC X(10).                     02290038
           05  WS-INCOMP-FL              PIC X(1).                      02300038
           05  WS-K600-EOF               PIC X(1).                      02310038
           05  WS-I                      PIC 9(1).                      02320038
           05  WS-TBL-CO-LESSEE OCCURS 3 TIMES.                         02330038
               10  WS-CPF-CO-LESSEE      PIC X(9).                      02340038
                                                                        02350038
      *=======================================================*         02360038
      *    LINKAGE VARIABLES                                  *         02370038
      *=======================================================*         02380038
       01   WS-LINK-REC.                                                02390038
            05 WS-LINK-NUM-SCH            PIC X(4).                     02400038
            05 WS-LINK-NUM-ACC            PIC X(4).                     02410038
            05 WS-LINK-NUM-CHK            PIC X(1).                     02420038
                                                                        02430038
       COPY P13COMM8.                                                   02440038
                                                                        02450038
      *----------------------------------------------------------------*02460038
      *    SERS ALLOC SCHEME CHECKING VARIABLES                        *02470038
      *----------------------------------------------------------------*02480038
       COPY SERSCH.                                                     02490038
       01  WS-SERS-VARIABLES.                                           02500038
           05  WS-ALLOC-SCH             PIC X(03) VALUE SPACES.         02510038
           05  WS-SCH-FND               PIC X(01) VALUE 'N'.            02520038
           05  WS-DTE-SERS-ANNOUNCE     PIC X(08) VALUE SPACES.         02530038
           05  WS-NUM-SERS-LBS          PIC X(01) VALUE 'N'.            02540038
                                                                        02550038
                                                                        02560038
      ********************                                              02570038
       PROCEDURE DIVISION.                                              02580038
      ********************                                              02590038
                                                                        02600038
      *************                                                     02610038
       0000-CONTROL.                                                    02620038
      *************                                                     02630038
           PERFORM 1000-START-UP         THRU 1000-EXIT.                02640038
           PERFORM 2000-MAIN-ROUTINE     THRU 2000-EXIT                 02650038
             UNTIL WS-F600-EOF = 'Y'.                                   02660038
           PERFORM 9999-WRAP-UP          THRU 9999-EXIT.                02670038
                                                                        02680038
       0000-EXIT.                                                       02690038
            EXIT.                                                       02700038
                                                                        02710038
                                                                        02720038
      ***************                                                   02730038
       1000-START-UP.                                                   02740038
      ***************                                                   02750038
           OPEN I-O    BP13K600                                         02760038
                INPUT  BP13K330                                         02770038
                       BP13K410                                         02780038
                       BP13K800                                         02790038
                       BP13K882                                         02800038
                       BP13K857                                         02810038
                       SY02F001                                         02820038
                       BP13F600                                         02830038
                OUTPUT AB02F860                                         02840038
                       BP13F60A.                                        02850038
                                                                        02860038
           IF  K857-STATUS NOT = 0 AND 97                               02870038
               DISPLAY 'OPEN FAILED FOR BP13K857 ' K857-STATUS          02880038
               PERFORM 9999-WRAP-UP          THRU 9999-EXIT             02890038
           END-IF.                                                      02900038
                                                                        02910038
           IF  K600-STATUS NOT = 0 AND 97                               02920038
               DISPLAY 'OPEN FAILED FOR BP13K600 ' K600-STATUS          02930038
               PERFORM 9999-WRAP-UP          THRU 9999-EXIT             02940038
           END-IF.                                                      02950038
                                                                        02960038
           IF  K330-STATUS NOT = 0 AND 97                               02970038
               DISPLAY 'OPEN FAILED FOR BP13K330 ' K330-STATUS          02980038
               PERFORM 9999-WRAP-UP          THRU 9999-EXIT             02990038
           END-IF.                                                      03000038
                                                                        03010038
           IF  K410-STATUS NOT = 0 AND 97                               03020038
               DISPLAY 'OPEN FAILED FOR BP13K410 ' K410-STATUS          03030038
               PERFORM 9999-WRAP-UP          THRU 9999-EXIT             03040038
           END-IF.                                                      03050038
                                                                        03060038
           IF  K800-STATUS NOT = 0 AND 97                               03070038
               DISPLAY 'OPEN FAILED FOR BP13K800 ' K800-STATUS          03080038
               PERFORM 9999-WRAP-UP          THRU 9999-EXIT             03090038
           END-IF.                                                      03100038
                                                                        03110038
           IF  K882-STATUS NOT = 0 AND 97                               03120038
               DISPLAY 'OPEN FAILED FOR BP13K882 ' K882-STATUS          03130038
               PERFORM 9999-WRAP-UP          THRU 9999-EXIT             03140038
           END-IF.                                                      03150038
                                                                        03160038
           READ SY02F001.                                               03170038
                                                                        03180038
       1000-EXIT.                                                       03190038
            EXIT.                                                       03200038
                                                                        03210038
                                                                        03220038
      *******************                                               03230038
       2000-MAIN-ROUTINE.                                               03240038
      *******************                                               03250038
      *---------------------------------------------------------------* 03260038
      * READS BP13K600 AND PROCESS EACH RECORD UNTIL END OF FILE      * 03270038
      *---------------------------------------------------------------* 03280038
           READ BP13F600 AT END                                         03290038
                MOVE 'Y' TO WS-F600-EOF                                 03300038
                GO       TO 2000-EXIT                                   03310038
                END-READ.                                               03320038
                                                                        03330038
           ADD   1            TO WS-CNT-F600-READ.                      03340038
           MOVE F600-KEY-FLD  TO K600-KEY-FLD.                          03350038
                                                                        03360038
           READ BP13K600.                                               03370038
                                                                        03380038
      * TEST ONLY                                                       03390038
      *    MOVE SPACES TO K600-DTE-SEND                                 03400038
      * TEST ONLY                                                       03410038
                                                                        03420038
           EVALUATE K600-STATUS                                         03430038
               WHEN 00                                                  03440038
                    ADD   1       TO  WS-CNT-K600-READ                  03450038
                                                                        03460038
                    IF (K600-NUM-CPF = LOW-VALUES OR SPACES) OR         03470038
                       (K600-NUM-PREFIX   = '9') OR                     03480038
                       (K600-DTE-SEND     > SPACES)                     03490038
                       ADD   1    TO WS-CNT-K600-BYPASS                 03500038
                       DISPLAY 'WS-CNT-K600-BYPASS(1)'                  03510038
                    ELSE                                                03520038
                       PERFORM 2500-PROCESS-BP13K600 THRU 2500-EXIT     03530038
                    END-IF                                              03540038
                                                                        03550038
               WHEN 23                                                  03560038
                    DISPLAY 'RECORD NOT FOUND IN K600 ' K600-KEY-FLD    03570038
               WHEN OTHER                                               03580038
                    MOVE K600-STATUS   TO RETURN-CODE                   03590038
                    DISPLAY 'ERROR READING BP13K600, STATUS = '         03600038
                            K600-STATUS  ' KEY : ' K600-KEY-FLD         03610038
                    PERFORM 9999-WRAP-UP          THRU 9999-EXIT        03620038
           END-EVALUATE.                                                03630038
                                                                        03640038
       2000-EXIT.                                                       03650038
            EXIT.                                                       03660038
                                                                        03670038
                                                                        03680038
      ***********************                                           03690038
       2500-PROCESS-BP13K600.                                           03700038
      ***********************                                           03710038
           MOVE 'N'      TO  WS-K330-FOUND.                             03720038
           MOVE 'N'      TO  WS-K410-FOUND.                             03730038
           MOVE 'N'      TO  WS-K800-FOUND.                             03740038
           MOVE 'N'      TO  WS-K882-FOUND.                             03750038
                                                                        03760038
           MOVE SPACES   TO  BP13COMM8-REC.                             03770038
           INITIALIZE        BP13COMM8-REC.                             03780038
                                                                        03790038
           IF K600-NUM-DBSS = 'Y'                                       03800038
              PERFORM 5300-READ-MASTER-FILE THRU 5300-EXIT              03810038
           ELSE                                                         03820038
           IF K600-NUM-SUB-TRANSFER = 'Y'                               03830038
              PERFORM 5200-READ-SUBTR-FILE  THRU 5200-EXIT              03840038
           ELSE                                                         03850038
           IF K600-CDE-REPYMT = 'A' OR (K600-NUM-ORIG-REGN = '3617879E' 03860038
                                    OR '4190192F'                       03880038
                                    OR '4026049H' OR '3351207D')        03890038
              IF K600-NUM-STUDIO-TP = 'Y'                               03900038
                 PERFORM 5300-READ-MASTER-FILE THRU 5300-EXIT           03910038
              ELSE                                                      03920038
                 PERFORM 5000-READ-AO-FILE     THRU 5000-EXIT           03930038
              END-IF                                                    03940038
           ELSE                                                         03950038
           IF K600-CDE-REPYMT = 'F'                                     03960038
              PERFORM 5300-READ-MASTER-FILE THRU 5300-EXIT              03970038
            ELSE                                                        03980038
           IF K600-CDE-STAMP-FEE = 'A1'                                 03990038
                                    OR K600-NUM-ORIG-REGN = '3804609H'  04000038
              PERFORM 5300-READ-MASTER-FILE THRU 5300-EXIT              04010038
            ELSE                                                        04020038
              PERFORM 5100-READ-SO-FILE     THRU 5100-EXIT              04030038
           END-IF.                                                      04040038
                                                                        04050038
                                                                        04060038
      *--------------------------------------------------------------   04070038
      *    BLOCK SEND IF TAGGED AS BYPASS                               04080038
      *--------------------------------------------------------------   04090038
      *    FOR EHPS: CHECK CO-OWNERS IF ALREADY SUBMITTED               04100038
      *--------------------------------------------------------------   04110038
           MOVE 'N'                        TO   WS-INCOMP-FL.           04120038
                                                                        04130038
           IF K600-NUM-BYPASS-SEND NOT = SPACES AND LOW-VALUES AND      04140038
                                         ZEROES                         04150038
              MOVE 'Y'                     TO   WS-INCOMP-FL            04160038
           ELSE                                                         04170038
              IF K600-TAG-EHPS-APPLN = 'Y'                              04180038
                 MOVE BP13K600-REC         TO   WS-BP13K600-REC         04190038
                 MOVE K600-NUM-ORIG-REGN   TO   WS-K600-NUM-ORIG-REGN   04200038
                                                                        04210038
                 MOVE 'N'                  TO   WS-K600-EOF             04220038
                 MOVE SPACES               TO   BP13K600-REC            04230038
                 MOVE WS-K600-NUM-ORIG-REGN(1:8)                        04240038
                                           TO   K600-NUM-ORIG-REGN(1:8) 04250038
                                                                        04260038
                 PERFORM 2510-BP13K600-START    THRU 2510-EXIT          04270038
                 PERFORM 2520-BP13K600-READNEXT THRU 2520-EXIT          04280038
                         UNTIL WS-K600-EOF  = 'Y'                       04290038
                            OR WS-INCOMP-FL = 'Y'                       04300038
                                                                        04310038
                 MOVE WS-BP13K600-REC      TO   BP13K600-REC            04320038
              END-IF                                                    04330038
           END-IF.                                                      04340038
                                                                        04350038
      *--------------------------------------------------------------   04360038
                                                                        04370038
           IF WS-INCOMP-FL = 'Y'                                        04380038
              ADD   1   TO WS-CNT-K600-BYPASS                           04390038
              DISPLAY 'WS-CNT-K600-BYPASS(2)'                           04400038
           ELSE                                                         04410038
              IF (WS-K330-FOUND = 'Y') OR (WS-K410-FOUND = 'Y') OR      04420038
                 (WS-K800-FOUND = 'Y') OR (WS-K882-FOUND = 'Y')         04430038
                 PERFORM 3000-WRITE-AB02F860   THRU 3000-EXIT           04440038
                 PERFORM 3100-REWRITE-BP13K600 THRU 3100-EXIT           04450038
              ELSE                                                      04460038
                 ADD   1   TO WS-CNT-K600-BYPASS                        04470038
                 DISPLAY 'WS-CNT-K600-BYPASS(3)'                        04480038
              END-IF                                                    04490038
           END-IF.                                                      04500038
                                                                        04510038
       2500-EXIT.                                                       04520038
            EXIT.                                                       04530038
                                                                        04540038
                                                                        04550038
      *=============================================================    04560038
       2510-BP13K600-START.                                             04570038
      *=============================================================    04580038
                                                                        04590038
           START BP13K600 KEY >= K600-NUM-ALTX1.                        04600038
                                                                        04610038
           EVALUATE K600-STATUS                                         04620038
           WHEN 00                                                      04630038
           WHEN 02                                                      04640038
              CONTINUE                                                  04650038
                                                                        04660038
           WHEN 10                                                      04670038
           WHEN 23                                                      04680038
              MOVE 'Y'                     TO   WS-K600-EOF             04690038
                                                                        04700038
           WHEN OTHER                                                   04710038
              DISPLAY 'START BP13K600 ERROR '   K600-STATUS             04720038
              MOVE     K600-STATUS         TO   RETURN-CODE             04730038
              PERFORM  9999-WRAP-UP        THRU 9999-EXIT               04740038
           END-EVALUATE.                                                04750038
                                                                        04760038
       2510-EXIT.                                                       04770038
           EXIT.                                                        04780038
                                                                        04790038
                                                                        04800038
      *=============================================================    04810038
       2520-BP13K600-READNEXT.                                          04820038
      *=============================================================    04830038
                                                                        04840038
           READ BP13K600 NEXT RECORD.                                   04850038
                                                                        04860038
           EVALUATE K600-STATUS                                         04870038
           WHEN 00                                                      04880038
           WHEN 02                                                      04890038
              IF (WS-K600-NUM-ORIG-REGN(1:8)                            04900038
                                         NOT = K600-NUM-ORIG-REGN(1:8)) 04910038
                 MOVE 'Y'                  TO   WS-K600-EOF             04920038
              ELSE                                                      04930038
                 IF (K600-DTE-SEND     NOT = SPACES AND LOW-VALUES AND  04940038
                                             ZEROES) OR                 04950038
                    (K600-DTE-REJECTED NOT = SPACES AND LOW-VALUES AND  04960038
                                             ZEROES)                    04970038
                    CONTINUE                                            04980038
                 ELSE                                                   04990038
                    IF K600-TAG-EHPS-APPLN = 'Y'                        05000038
                       IF K600-DATE-EHPS-SUB = SPACES OR LOW-VALUES OR  05010038
                                               ZEROES                   05020038
                          IF (K600-CDE-CPF = SPACES OR LOW-VALUES OR    05030038
                                             ZEROES) AND                05040038
                             (K600-NUM-BYPASS-SEND = SPACES OR ZEROES OR05050038
                                                     LOW-VALUES)        05060038
                             MOVE 'Y'         TO   WS-INCOMP-FL         05070038
                          END-IF                                        05080038
                       END-IF                                           05090038
                    END-IF                                              05100038
                 END-IF                                                 05110038
                                                                        05120038
              END-IF                                                    05130038
                                                                        05140038
           WHEN 10                                                      05150038
           WHEN 23                                                      05160038
              MOVE 'Y'                     TO   WS-K600-EOF             05170038
                                                                        05180038
           WHEN OTHER                                                   05190038
              DISPLAY 'READNEXT BP13K600 ERROR ' K600-STATUS            05200038
              MOVE     K600-STATUS         TO   RETURN-CODE             05210038
              PERFORM  9999-WRAP-UP        THRU 9999-EXIT               05220038
           END-EVALUATE.                                                05230038
                                                                        05240038
       2520-EXIT.                                                       05250038
           EXIT.                                                        05260038
                                                                        05270038
                                                                        05280038
      *********************                                             05290038
       3000-WRITE-AB02F860.                                             05300038
      *********************                                             05310038
           PERFORM 4000-MOVE-VALUES  THRU 4000-EXIT.                    05320038
                                                                        05330038
           WRITE AB02F860-REC.                                          05340038
                                                                        05350038
           ADD  1 TO  WS-CNT-F860-WRT.                                  05360038
                                                                        05370038
       3000-EXIT.                                                       05380038
            EXIT.                                                       05390038
                                                                        05400038
                                                                        05410038
      ***********************                                           05420038
       3100-REWRITE-BP13K600.                                           05430038
      ***********************                                           05440038
           IF K600-CDE-ACTION = '1'                                     05450038
                                                                        05460038
              DELETE BP13K600                                           05470038
                                                                        05480038
              IF K600-STATUS = ZEROS                                    05490038
                 ADD  1             TO WS-CNT-K600-DEL                  05500038
              ELSE                                                      05510038
                 MOVE K600-STATUS   TO RETURN-CODE                      05520038
                 DISPLAY 'ERROR DELETING BP13K600, STATUS = '           05530038
                         K600-STATUS  ' KEY : ' K600-KEY-FLD            05540038
                 PERFORM 9999-WRAP-UP          THRU 9999-EXIT           05550038
              END-IF                                                    05560038
                                                                        05570038
           ELSE                                                         05580038
                                                                        05590038
              MOVE SPACES           TO K600-DTE-REJECTED                05600038
              MOVE F001-DTE-CURRENT TO K600-DTE-SEND                    05610038
                                                                        05620038
              REWRITE BP13K600-REC                                      05630038
                                                                        05640038
              IF K600-STATUS = ZEROS                                    05650038
                 ADD  1             TO WS-CNT-K600-WRT                  05660038
                 WRITE BP13F60A-REC FROM BP13K600-REC                   05670038
              ELSE                                                      05680038
                 MOVE K600-STATUS   TO RETURN-CODE                      05690038
                 DISPLAY 'ERROR RE-WRITING BP13K600, STATUS = '         05700038
                         K600-STATUS  ' KEY : ' K600-KEY-FLD            05710038
                 PERFORM 9999-WRAP-UP          THRU 9999-EXIT           05720038
              END-IF                                                    05730038
                                                                        05740038
           END-IF.                                                      05750038
                                                                        05760038
       3100-EXIT.                                                       05770038
            EXIT.                                                       05780038
                                                                        05790038
                                                                        05800038
      *****************                                                 05810038
       4000-MOVE-VALUES.                                                05820038
      *****************                                                 05830038
           MOVE SPACES                   TO  AB02F860-REC               05840038
                                             BP13K800-MASTER            05850038
                                                                        05860038
           PERFORM 5350-READ-BP13K800    THRU 5350-EXIT.                05870038
                                                                        05880038
           MOVE K600-CDE-ACTION          TO  F860-CDE-ACTION.           05890038
           MOVE K600-NUM-SNO             TO  F860-NUM-SNO.              05900038
           MOVE K600-NUM-CPF             TO  F860-NUM-CPF-ACCT.         05910038
           MOVE K600-NUM-PREFIX          TO  F860-NUM-PREFIX.           05920038
           MOVE K600-NUM-HDB-REF         TO  F860-NUM-HDB-REF.          05930038
           MOVE K600-NUM-ORIG-REGN       TO  F860-NUM-ORIG-REGN.        05940038
           MOVE K600-TXT-ADDRESS         TO  F860-TXT-ADDRESS.          05950038
           MOVE COMM8-CDE-ST             TO  F860-CDE-STREET.           05960038
           MOVE K600-CDE-TRANS-TYPE      TO  F860-CDE-TRANS-TYPE.       05970038
           MOVE K600-CDE-ADJ-TYPE        TO  F860-CDE-ADJ-TYPE.         05980038
           MOVE K600-CDE-REPURCHASE      TO  F860-CDE-REPURCHASE.       05990038
           MOVE K600-CDE-STAMP-FEE       TO  F860-CDE-STAMP-FEE.        06000038
           MOVE K600-CDE-CONV-FEE        TO  F860-CDE-CONV-FEE.         06010038
           MOVE K600-CDE-SURVEY-FEE      TO  F860-CDE-SURVEY-FEE.       06020038
           MOVE K600-CDE-REPYMT          TO  F860-CDE-REPYMT.           06030038
           MOVE K600-CDE-REPYMT-PERIOD   TO  F860-CDE-REPYMT-PERIOD.    06040038
           MOVE 'N'                      TO  F860-TAG-HPS-HARDCOPY.     06050038
                                                                        06060038
           MOVE K600-NUM-HP              TO  F860-NUM-CONTACT.          06070038
                                                                        06080038
           IF K600-EHPS-COVER-PRCNT NOT NUMERIC                         06090038
              MOVE ZEROES                   TO K600-EHPS-COVER-PRCNT    06100038
           END-IF.                                                      06110038
                                                                        06120038
                                                                        06130038
           IF K600-EHPS-COVER-PRCNT > 0                                 06140038
              PERFORM 5450-READ-BP13K857  THRU 5450-EXIT                06150038
              MOVE K857-NUM-EMAIL           TO F860-NUM-EMAIL           06160038
           ELSE                                                         06170038
              MOVE SPACES                   TO F860-NUM-EMAIL           06180038
           END-IF.                                                      06190038
                                                                        06200038
           IF (K600-DTE-APPLICATION = SPACES OR LOW-VALUES) OR          06210038
              (K600-DTE-APPLICATION IS NOT NUMERIC)                     06220038
               MOVE '00000000' TO F860-DTE-APLCTN                       06230038
           ELSE                                                         06240038
               MOVE K600-DTE-APPLICATION    TO F860-DTE-APLCTN          06250038
           END-IF.                                                      06260038
                                                                        06270038
           IF (K600-DTE-LEASE-COMMENCEMENT = SPACES OR LOW-VALUES) OR   06280038
              (K600-DTE-LEASE-COMMENCEMENT IS NOT NUMERIC)              06290038
               MOVE '00000000' TO F860-DTE-LEASE-COMM                   06300038
           ELSE                                                         06310038
               MOVE K600-DTE-LEASE-COMMENCEMENT TO F860-DTE-LEASE-COMM  06320038
           END-IF.                                                      06330038
                                                                        06340038
           IF K600-NUM-LEASE-TENURE IS NOT NUMERIC                      06350038
               MOVE ZEROES TO F860-NUM-LEASE-DUR                        06360038
           ELSE                                                         06370038
               MOVE K600-NUM-LEASE-TENURE    TO F860-NUM-LEASE-DUR      06380038
           END-IF.                                                      06390038
                                                                        06400038
           IF K600-CDE-ERL    = 'N '                                    06410038
              MOVE 'N0'                  TO  F860-CDE-ERL               06420038
           ELSE                                                         06430038
              MOVE K600-CDE-ERL          TO  F860-CDE-ERL               06440038
           END-IF.                                                      06450038
                                                                        06460038
           MOVE K600-NME-LESSEE             TO F860-NME-ACCOUNT-HOLDER. 06470038
                                                                        06480038
           IF K600-NUM-CPF-CO-LESSEE1  = LOW-VALUES                     06490038
              MOVE SPACES                   TO  F860-NUM-CPF-CO-OWNER1  06500038
           ELSE                                                         06510038
              MOVE K600-NUM-CPF-CO-LESSEE1  TO  F860-NUM-CPF-CO-OWNER1. 06520038
                                                                        06530038
           IF K600-NUM-CPF-CO-LESSEE2  = LOW-VALUES                     06540038
              MOVE SPACES                   TO  F860-NUM-CPF-CO-OWNER2  06550038
           ELSE                                                         06560038
              MOVE K600-NUM-CPF-CO-LESSEE2  TO  F860-NUM-CPF-CO-OWNER2. 06570038
                                                                        06580038
           IF K600-NUM-CPF-CO-LESSEE3  = LOW-VALUES                     06590038
              MOVE SPACES                   TO  F860-NUM-CPF-CO-OWNER3  06600038
           ELSE                                                         06610038
              MOVE K600-NUM-CPF-CO-LESSEE3  TO  F860-NUM-CPF-CO-OWNER3. 06620038
                                                                        06630038
           MOVE 'BP13'                      TO  F860-NUM-ORIGINATOR.    06640038
                                                                        06650038
           IF K600-AMT-MRKT-VALUE1 NUMERIC                              06660038
              MOVE K600-AMT-MRKT-VALUE1     TO  F860-AMT-MRKT-VALUE1    06670038
           END-IF.                                                      06680038
                                                                        06690038
           IF K600-AMT-MRKT-VALUE2 NUMERIC                              06700038
              MOVE K600-AMT-MRKT-VALUE2     TO  F860-AMT-MRKT-VALUE2    06710038
           END-IF.                                                      06720038
                                                                        06730038
           IF K600-AMT-PURCHASE-PRICE1 NUMERIC                          06740038
              MOVE K600-AMT-PURCHASE-PRICE1 TO  F860-AMT-PURCHASE-PRICE106750038
           END-IF.                                                      06760038
                                                                        06770038
           IF K600-AMT-PURCHASE-PRICE2 NUMERIC                          06780038
              MOVE K600-AMT-PURCHASE-PRICE2 TO  F860-AMT-PURCHASE-PRICE206790038
           END-IF.                                                      06800038
                                                                        06810038
           IF K600-AMT-UPG-COST NUMERIC                                 06820038
              MOVE K600-AMT-UPG-COST        TO  F860-AMT-UPG-COST       06830038
           END-IF.                                                      06840038
                                                                        06850038
           IF K600-AMT-STAMP-FEE NUMERIC                                06860038
              MOVE K600-AMT-STAMP-FEE       TO  F860-AMT-STAMP-FEE      06870038
           END-IF.                                                      06880038
                                                                        06890038
           IF K600-AMT-STAMP-FEE > 0                                    06900038
              NEXT SENTENCE                                             06910038
           ELSE                                                         06920038
              MOVE SPACES                   TO  F860-CDE-STAMP-FEE      06930038
           END-IF.                                                      06940038
                                                                        06950038
           IF K600-AMT-CONV-FEE NUMERIC                                 06960038
              MOVE K600-AMT-CONV-FEE        TO  F860-AMT-CONV-FEE       06970038
           END-IF.                                                      06980038
                                                                        06990038
           IF K600-AMT-CONV-FEE > 0                                     07000038
              NEXT SENTENCE                                             07010038
           ELSE                                                         07020038
              MOVE SPACES                   TO  F860-CDE-CONV-FEE       07030038
           END-IF.                                                      07040038
                                                                        07050038
           IF K600-AMT-SURVEY-FEE NUMERIC                               07060038
              MOVE K600-AMT-SURVEY-FEE      TO  F860-AMT-SURVEY-FEE     07070038
           END-IF.                                                      07080038
                                                                        07090038
           IF K600-AMT-SURVEY-FEE > 0                                   07100038
              NEXT SENTENCE                                             07110038
           ELSE                                                         07120038
              MOVE SPACES                   TO  F860-CDE-SURVEY-FEE     07130038
           END-IF.                                                      07140038
                                                                        07150038
           IF K600-CDE-REPYMT-TYPE = 'F'                                07160038
              MOVE K600-CDE-REPYMT-TYPE  TO  F860-CDE-REPYMT-TYPE       07170038
              MOVE 'N'    TO F860-TAG-HPS-HARDCOPY                      07180038
           ELSE                                                         07190038
              IF K600-CDE-REPYMT-TYPE = 'S' OR 'E' OR 'P'               07200038
                 MOVE 'P'                TO  F860-CDE-REPYMT-TYPE       07210038
              END-IF                                                    07220038
           END-IF.                                                      07230038
                                                                        07240038
           IF K600-CDE-REPYMT = 'A' AND K600-NUM-STUDIO-TP = 'Y'        07250038
              CONTINUE                                                  07260038
           ELSE                                                         07270038
             IF K600-CDE-REPYMT = 'A' OR 'T'                            07280038
                MOVE 'P'                  TO  F860-CDE-REPYMT-TYPE      07290038
                MOVE 'N'    TO F860-TAG-HPS-HARDCOPY                    07300038
             END-IF                                                     07310038
           END-IF.                                                      07320038
                                                                        07330038
           IF K600-AMT-LOAN-REPAY NUMERIC                               07340038
              MOVE K600-AMT-LOAN-REPAY    TO  F860-AMT-LOAN-REPAY       07350038
           END-IF.                                                      07360038
                                                                        07370038
           IF K600-AMT-LOAN-REPAY = ZEROES                              07380038
              MOVE SPACES          TO  F860-CDE-REPYMT                  07390038
              MOVE 'N'    TO F860-TAG-HPS-HARDCOPY                      07400038
           END-IF.                                                      07410038
                                                                        07420038
           IF K600-CDE-REPYMT-PERIOD = ZEROES AND                       07430038
              K600-CDE-REPYMT = 'A'                                     07440038
              MOVE 'N'    TO F860-TAG-HPS-HARDCOPY                      07450038
           END-IF.                                                      07460038
                                                                        07470038
           IF K600-CDE-REPYMT-TYPE = 'E'                                07480038
              MOVE 'E'                   TO  F860-CDE-REPYMT            07490038
           ELSE                                                         07500038
              IF K600-CDE-REPYMT-TYPE = 'S'                             07510038
                 MOVE 'S'                TO  F860-CDE-REPYMT            07520038
              END-IF                                                    07530038
           END-IF.                                                      07540038
                                                                        07550038
           IF K600-DTE-FINAL-REPYMT NUMERIC                             07560038
              MOVE K600-DTE-FINAL-REPYMT    TO  F860-DTE-FINAL-REPYMT   07570038
           END-IF.                                                      07580038
                                                                        07590038
           IF K600-DTE-INST-FIRST NUMERIC                               07600038
              MOVE K600-DTE-INST-FIRST      TO  F860-DTE-INST-FIRST     07610038
           END-IF.                                                      07620038
                                                                        07630038
           IF K600-DTE-INST-MTHLY NUMERIC                               07640038
              MOVE K600-DTE-INST-MTHLY      TO  F860-DTE-INST-MTHLY     07650038
           END-IF.                                                      07660038
                                                                        07670038
           IF K600-DTE-LOAN-OS NUMERIC                                  07680038
              MOVE K600-DTE-LOAN-OS         TO  F860-DTE-LOAN-OS        07690038
           END-IF.                                                      07700038
                                                                        07710038
           IF K600-DTE-ORIG-LOAN-COMM NUMERIC                           07720038
              MOVE K600-DTE-ORIG-LOAN-COMM  TO  F860-DTE-ORIG-LOAN-COMM 07730038
              MOVE K600-DTE-LOAN-OS         TO  F860-DTE-ORIG-LOAN-COMM 07731040
           END-IF.                                                      07740038
                                                                        07750038
           IF K600-DTE-PRINT NUMERIC                                    07760038
              MOVE K600-DTE-PRINT           TO  F860-DTE-PRINT          07770038
           END-IF.                                                      07780038
                                                                        07790038
           IF K600-DTE-PAYMT-CEASE NUMERIC                              07800038
              MOVE K600-DTE-PAYMT-CEASE     TO  F860-DTE-PAYMT-CEASE    07810038
           END-IF.                                                      07820038
                                                                        07830038
      *-------------------------------------*                           07840038
      *TO CATER FOR CENTS FOR HOUSING GRANT                             07850038
      *-------------------------------------*                           07860038
           IF K600-AMT-GRANT-NEW IS NOT NUMERIC                         07870038
              MOVE ZEROES TO K600-AMT-GRANT-NEW                         07880038
           END-IF.                                                      07890038
                                                                        07900038
           IF K600-AMT-GRANT NUMERIC                                    07910038
              COMPUTE WS-DIFF-GRANT = K600-AMT-GRANT-NEW -              07920038
                                      K600-AMT-GRANT                    07930038
           END-IF.                                                      07940038
                                                                        07950038
           IF WS-DIFF-GRANT > 0                                         07960038
              MOVE K600-AMT-GRANT-NEW       TO  F860-AMT-GRANT          07970038
           ELSE                                                         07980038
              MOVE K600-AMT-GRANT           TO  F860-AMT-GRANT          07990038
           END-IF.                                                      08000038
                                                                        08010038
           IF K600-AMT-ARREARS NUMERIC                                  08020038
              MOVE K600-AMT-ARREARS         TO  F860-AMT-ARREARS        08030038
           END-IF.                                                      08040038
                                                                        08050038
           IF K600-AMT-INST-FIRST NUMERIC                               08060038
              MOVE K600-AMT-INST-FIRST      TO  F860-AMT-INST-FIRST     08070038
           END-IF.                                                      08080038
                                                                        08090038
           IF K600-AMT-TOT-WDL NUMERIC                                  08100038
              MOVE K600-AMT-TOT-WDL         TO  F860-AMT-TOT-WDL        08110038
           END-IF.                                                      08120038
                                                                        08130038
           IF K600-AMT-INST-MTHLY NUMERIC                               08140038
              MOVE K600-AMT-INST-MTHLY      TO  F860-AMT-INST-MTHLY     08150038
           END-IF.                                                      08160038
                                                                        08170038
           IF K600-AMT-ORIG-LOAN NUMERIC                                08180038
              MOVE K600-AMT-ORIG-LOAN       TO  F860-AMT-ORIG-LOAN      08190038
           END-IF.                                                      08200038
                                                                        08210038
           IF K600-AMT-LOAN-OS NUMERIC                                  08220038
              MOVE K600-AMT-LOAN-OS         TO  F860-AMT-LOAN-OS        08230038
           END-IF.                                                      08240038
                                                                        08250038
           IF K600-AMT-INST NUMERIC                                     08260038
              MOVE K600-AMT-INST            TO  F860-AMT-INST           08270038
           END-IF.                                                      08280038
                                                                        08290038
           IF K600-AMT-EXISTING-BAL   NUMERIC                           08300038
              MOVE K600-AMT-EXISTING-BAL   TO  F860-AMT-EXISTING-BAL    08310038
           ELSE                                                         08320038
              MOVE ZEROES                  TO  F860-AMT-EXISTING-BAL    08330038
           END-IF.                                                      08340038
                                                                        08350038
           IF K600-AMT-CPF-CONTRA        NUMERIC                        08360038
              MOVE K600-AMT-CPF-CONTRA     TO  F860-AMT-CPF-CONTRA      08370038
           ELSE                                                         08380038
              MOVE ZEROES                  TO  F860-AMT-CPF-CONTRA      08390038
           END-IF.                                                      08400038
                                                                        08410038
           IF K600-AMT-MSS  NUMERIC                                     08420038
              MOVE K600-AMT-MSS            TO  F860-AMT-MSS             08430038
           ELSE                                                         08440038
              MOVE ZEROES                  TO  F860-AMT-MSS             08450038
           END-IF.                                                      08460038
                                                                        08470038
           IF K600-NUM-MORTGAGE-RATE NUMERIC                            08480038
              MOVE K600-NUM-MORTGAGE-RATE  TO  F860-NUM-MORTGAGE-RATE   08490038
           ELSE                                                         08500038
              MOVE ZEROES                  TO  F860-NUM-MORTGAGE-RATE   08510038
           END-IF.                                                      08520038
                                                                        08530038
      *---------------------------------------------------------------* 08540038
      *    AMT-HPS-CONTRA AND AMT-CPF-PREMIUM NOT YET UTILIZED IN SOC.  08550038
      *    STATEMENTS ARE USED TO INITIALIZE THE AMOUNTS ONLY           08560038
      *---------------------------------------------------------------* 08570038
                                                                        08580038
           IF K600-AMT-HPS-CONTRA NUMERIC                               08590038
              MOVE K600-AMT-HPS-CONTRA     TO  F860-AMT-HPS-CONTRA      08600038
           ELSE                                                         08610038
              MOVE ZEROES                  TO  F860-AMT-HPS-CONTRA      08620038
           END-IF.                                                      08630038
                                                                        08640038
           IF K600-AMT-CPF-PREMIUM NUMERIC                              08650038
              MOVE K600-AMT-CPF-PREMIUM    TO  F860-AMT-CPF-PREMIUM     08660038
           ELSE                                                         08670038
              MOVE ZEROES                  TO  F860-AMT-CPF-PREMIUM     08680038
           END-IF.                                                      08690038
                                                                        08700038
           MOVE K600-CDE-LOAN-SCHEME       TO  F860-CDE-LOAN-SCHEME.    08710038
                                                                        08720038
           IF F860-DTE-FINAL-REPYMT NOT NUMERIC                         08730038
              MOVE ZEROES                TO F860-DTE-FINAL-REPYMT       08740038
           END-IF.                                                      08750038
                                                                        08760038
           IF F860-DTE-INST-FIRST NOT NUMERIC                           08770038
              MOVE ZEROES                TO F860-DTE-INST-FIRST         08780038
           END-IF.                                                      08790038
                                                                        08800038
           IF F860-DTE-INST-MTHLY NOT NUMERIC                           08810038
              MOVE ZEROES                TO F860-DTE-INST-MTHLY         08820038
           END-IF.                                                      08830038
                                                                        08840038
           IF F860-DTE-PRINT NOT NUMERIC                                08850038
              MOVE ZEROES                TO F860-DTE-PRINT              08860038
           END-IF.                                                      08870038
                                                                        08880038
           IF F860-DTE-ORIG-LOAN-COMM NOT NUMERIC                       08890038
              MOVE ZEROES                TO F860-DTE-ORIG-LOAN-COMM     08900038
           END-IF.                                                      08910038
                                                                        08920038
           IF F860-DTE-LOAN-OS NOT NUMERIC                              08930038
              MOVE ZEROES                TO F860-DTE-LOAN-OS            08940038
           END-IF.                                                      08950038
                                                                        08960038
           IF F860-DTE-PAYMT-CEASE NOT NUMERIC                          08970038
              MOVE ZEROES                TO F860-DTE-PAYMT-CEASE        08980038
           END-IF.                                                      08990038
                                                                        09000038
           PERFORM 4100-TAG-SERS-LBS       THRU 4100-EXIT.              09010038
                                                                        09020038
           IF (K800-NUM-ALLO-SCHEME = 'FSH')                            09030038
                MOVE ' '      TO F860-NUM-STUDIO-APT-TAG                09040038
           ELSE                                                         09050038
      *--- SA, CCA, 2F SHORT LEASE VARIABLES       -------------------* 09060038
                                                                        09070038
             IF  (K800-NUM-IDP-SCHEME = 'SA ') OR                       09080038
                 (K800-NUM-FLAT-TYPE  = '1A'   OR                       09090038
                  K800-NUM-FLAT-TYPE  = '1F'   OR                       09100038
                  K800-NUM-FLAT-TYPE  = '2A')  OR                       09110038
                 (K800-NUM-FLAT-TYPE  = '2F'     AND                    09120038
                  K800-NUM-LEASE-TENURE > ZEROES AND                    09130038
                  K800-NUM-LEASE-TENURE <= 45) OR                       09140038
                 (WS-NUM-SERS-LBS     = 'Y')                            09150038
                  MOVE 'Y'    TO F860-NUM-STUDIO-APT-TAG                09160038
                  MOVE SPACES TO F860-CDE-ERL                           09170038
                  MOVE SPACES TO F860-CDE-LOAN-SCHEME                   09180038
                  MOVE ZEROES TO F860-AMT-PURCHASE-PRICE1               09190038
                  MOVE ZEROES TO F860-AMT-PURCHASE-PRICE2               09200038
                  MOVE ZEROES TO F860-DTE-ORIG-LOAN-COMM                09210038
                  MOVE ZEROES TO F860-DTE-LEASE-COMM                    09220038
                  MOVE ZEROES TO F860-DTE-LOAN-OS                       09230038
                  MOVE ZEROES TO F860-AMT-LOAN-OS                       09240038
                  MOVE ZEROES TO F860-DTE-INST-MTHLY                    09250038
                  MOVE ZEROES TO F860-DTE-FINAL-REPYMT                  09260038
                  MOVE ZEROES TO F860-AMT-INST-MTHLY                    09270038
                  MOVE ZEROES TO F860-NUM-MORTGAGE-RATE                 09280038
                  MOVE 'N'    TO F860-TAG-HPS-HARDCOPY                  09290038
             ELSE                                                       09300038
                  MOVE ' '    TO F860-NUM-STUDIO-APT-TAG                09310038
             END-IF                                                     09320038
           END-IF.                                                      09330038
                                                                        09340038
           MOVE ZEROES                     TO F860-AMT-EXISTING-BAL     09350038
                                              F860-AMT-CPF-CONTRA       09360038
                                              F860-AMT-FULL-RESL-PRICE. 09370038
                                                                        09380038
           IF K600-AMT-CPF-BLOCK NUMERIC                                09390038
              MOVE K600-AMT-CPF-BLOCK      TO  F860-AMT-CPF-BLOCK       09400038
           ELSE                                                         09410038
              MOVE ZEROES                  TO  F860-AMT-CPF-BLOCK       09420038
           END-IF.                                                      09430038
                                                                        09440038
           IF K410-AMT-LOAN NOT NUMERIC                                 09450038
              MOVE ZEROES   TO K410-AMT-LOAN                            09460038
           END-IF.                                                      09470038
                                                                        09480038
           IF K410-NUM-REPAY-PERIOD NOT NUMERIC                         09490038
              MOVE ZEROES  TO K410-NUM-REPAY-PERIOD                     09500038
           END-IF.                                                      09510038
                                                                        09520038
      *--- TEMP LOAN VARIABLES ---------------------------------------* 09530038
      *--- NO LOAN VARIABLES ---------------------------------------*   09540038
           IF K600-CDE-CPF = 'TM' OR K410-NUM-CONTRA-TYPE = 'TM'        09550038
                  MOVE SPACES TO F860-CDE-ERL                           09560038
                  MOVE SPACES TO F860-CDE-LOAN-SCHEME                   09570038
                  MOVE ZEROES TO F860-AMT-ORIG-LOAN                     09580038
                  MOVE ZEROES TO F860-DTE-ORIG-LOAN-COMM                09590038
                  MOVE ZEROES TO F860-DTE-LOAN-OS                       09600038
                  MOVE ZEROES TO F860-AMT-LOAN-OS                       09610038
                  MOVE ZEROES TO F860-DTE-INST-MTHLY                    09620038
                  MOVE ZEROES TO F860-DTE-FINAL-REPYMT                  09630038
                  MOVE ZEROES TO F860-AMT-INST-MTHLY                    09640038
                  MOVE ZEROES TO F860-NUM-MORTGAGE-RATE                 09650038
                  MOVE 'N'    TO F860-TAG-HPS-HARDCOPY                  09660038
           ELSE                                                         09670038
           IF K410-AMT-LOAN = ZEROES OR K410-NUM-REPAY-PERIOD = ZEROES  09680038
                  MOVE SPACES TO F860-CDE-ERL                           09690038
                  MOVE SPACES TO F860-CDE-LOAN-SCHEME                   09700038
                  MOVE ZEROES TO F860-AMT-ORIG-LOAN                     09710038
                  MOVE ZEROES TO F860-DTE-ORIG-LOAN-COMM                09720038
                  MOVE ZEROES TO F860-DTE-LOAN-OS                       09730038
                  MOVE ZEROES TO F860-AMT-LOAN-OS                       09740038
                  MOVE ZEROES TO F860-DTE-INST-MTHLY                    09750038
                  MOVE ZEROES TO F860-DTE-FINAL-REPYMT                  09760038
                  MOVE ZEROES TO F860-AMT-INST-MTHLY                    09770038
                  MOVE ZEROES TO F860-NUM-MORTGAGE-RATE                 09780038
                  MOVE ZEROES TO F860-CDE-REPYMT-PERIOD                 09781038
                  MOVE 'N'    TO F860-TAG-HPS-HARDCOPY                  09790038
           END-IF.                                                      09800038
                                                                        09810038
      *--- EHPS VARIABLES --------------------------------------------* 09820038
                                                                        09830038
           IF K600-TAG-EHPS-APPLN = 'Y'                                 09840038
              MOVE 'E'                     TO F860-CDE-EWDL             09850038
                                                                        09860038
              IF K600-EHPS-COVER-PRCNT NOT NUMERIC                      09870038
                 MOVE ZEROES               TO K600-EHPS-COVER-PRCNT     09880038
              END-IF                                                    09890038
                                                                        09900038
              IF K600-EHPS-COVER-PRCNT > ZEROES                         09910038
                 MOVE 'Y'                  TO F860-TAG-EHPS-APPLN       09920038
                 MOVE 'N'                  TO F860-TAG-HPS-HARDCOPY     09930038
                 MOVE K600-EHPS-VER        TO F860-EHPS-VER             09940038
                 MOVE K600-DATE-EHPS-SUB   TO F860-DATE-EHPS-SUB        09950038
                 MOVE K600-TIME-EHPS-SUB   TO F860-TIME-EHPS-SUB        09960038
                 MOVE K600-EHPS-COVER-PRCNT                             09970038
                                           TO F860-EHPS-COVER-PRCNT     09980038
                 MOVE K600-CDE-EHPS-QUE1   TO F860-CDE-EHPS-QUE1        09990038
                 MOVE K600-CDE-EHPS-QUE2   TO F860-CDE-EHPS-QUE2        10000038
                 MOVE K600-CDE-EHPS-QUE3   TO F860-CDE-EHPS-QUE3        10010038
                 MOVE K600-TEXT-EHPS-QUE1  TO F860-TEXT-EHPS-QUE1       10020038
                 MOVE K600-TEXT-EHPS-QUE2  TO F860-TEXT-EHPS-QUE2       10030038
                 MOVE K600-TEXT-EHPS-QUE3  TO F860-TEXT-EHPS-QUE3       10040038
              ELSE                                                      10050038
                 MOVE 'N'                  TO F860-TAG-EHPS-APPLN       10060038
                 MOVE ZEROES               TO F860-DATE-EHPS-SUB        10070038
                                              F860-TIME-EHPS-SUB        10080038
                                              F860-EHPS-COVER-PRCNT     10090038
              END-IF                                                    10100038
           ELSE                                                         10110038
              MOVE SPACES                  TO F860-CDE-EWDL             10120038
              MOVE 'N'                     TO F860-TAG-EHPS-APPLN       10130038
              MOVE ZEROES                  TO F860-DATE-EHPS-SUB        10140038
                                              F860-TIME-EHPS-SUB        10150038
                                              F860-EHPS-COVER-PRCNT     10160038
           END-IF.                                                      10170038
                                                                        10180038
      ********************                                              10190038
      *APPL1 BUYING HPS BUT NOT APPL2.                                  10200038
      ********************                                              10210038
                                                                        10220038
           IF (K410-NUM-HPS1 = 'Y' AND                                  10230038
               K600-NUM-CPF = K410-CPF1) AND                            10240038
              K410-TAG-EHPS-APPLN = 'N'                                 10250038
              MOVE 'Y'                     TO F860-TAG-HPS-HARDCOPY     10260038
           ELSE                                                         10270038
           IF (K410-NUM-HPS2 = 'Y' AND                                  10280038
               K600-NUM-CPF = K410-CPF2) AND                            10290038
              K410-TAG-EHPS-APPLN = 'N'                                 10300038
              MOVE 'Y'                     TO F860-TAG-HPS-HARDCOPY     10310038
           ELSE                                                         10320038
           IF (K410-NUM-HPS3 = 'Y' AND                                  10330038
               K600-NUM-CPF = K410-CPF3) AND                            10340038
              K410-TAG-EHPS-APPLN = 'N'                                 10350038
              MOVE 'Y'                     TO F860-TAG-HPS-HARDCOPY     10360038
           ELSE                                                         10370038
           IF (K410-NUM-HPS4 = 'Y' AND                                  10380038
               K600-NUM-CPF = K410-CPF4) AND                            10390038
              K410-TAG-EHPS-APPLN = 'N'                                 10400038
              MOVE 'Y'                     TO F860-TAG-HPS-HARDCOPY     10410038
           END-IF.                                                      10420038
                                                                        10430038
       4000-EXIT.                                                       10440038
            EXIT.                                                       10450038
                                                                        10460038
                                                                        10470038
      ********************                                              10480038
       4100-TAG-SERS-LBS.                                               10490038
      ********************                                              10500038
                                                                        10510038
           MOVE 'N'                      TO WS-NUM-SERS-LBS.            10520038
                                                                        10530038
      *---------------------------------------------------------------  10540038
      *    TAG FOR SERS LEASE BUY BACK SCHEME                           10550038
      *---------------------------------------------------------------  10560038
           IF (K800-NUM-LEASE-BUY-BACK = 'Y')   AND                     10570038
              (K800-NUM-LEASE-TENURE   > ZEROES)                        10580038
              MOVE K800-NUM-ALLO-SCHEME  TO WS-ALLOC-SCH                10590038
              PERFORM 4110-CHECK-SERS    THRU 4110-EXIT                 10600038
                                                                        10610038
              IF WS-SCH-FND             = 'Y' OR                        10620038
                 K800-NUM-PORT-ELIG-TAG = 'Y'                           10630038
                 MOVE 'Y'                TO WS-NUM-SERS-LBS             10640038
              END-IF                                                    10650038
           END-IF.                                                      10660038
                                                                        10670038
       4100-EXIT.                                                       10680038
            EXIT.                                                       10690038
                                                                        10700038
                                                                        10710038
      ******************                                                10720038
       4110-CHECK-SERS.                                                 10730038
      ******************                                                10740038
                                                                        10750038
           IF WS-ALLOC-SCH  NOT =  LOW-VALUES AND SPACES                10760038
              SET WS-SERS-PTR  TO 1                                     10770038
              SEARCH WS-SERS-SCH                                        10780038
                 AT END                                                 10790038
                    MOVE 'N'               TO   WS-SCH-FND              10800038
                 WHEN WS-SERS-SCHEME(WS-SERS-PTR) = WS-ALLOC-SCH        10810038
                    MOVE 'Y'               TO   WS-SCH-FND              10820038
              END-SEARCH                                                10830038
           ELSE                                                         10840038
              MOVE 'N'                     TO   WS-SCH-FND              10850038
           END-IF.                                                      10860038
                                                                        10870038
       4110-EXIT.                                                       10880038
           EXIT.                                                        10890038
                                                                        10900038
                                                                        10910038
      ******************                                                10920038
       5000-READ-AO-FILE.                                               10930038
      ******************                                                10940038
           MOVE LOW-VALUES          TO K330-KEY-FLD.                    10950038
           MOVE K600-NUM-ORIG-REGN  TO K330-KEY-FLD.                    10960038
                                                                        10970038
           START BP13K330 KEY > K330-KEY-FLD.                           10980038
                                                                        10990038
           EVALUATE K330-STATUS                                         11000038
               WHEN 00                                                  11010038
               WHEN 02                                                  11020038
                    CONTINUE                                            11030038
               WHEN 10                                                  11040038
               WHEN 23                                                  11050038
                    DISPLAY 'START RECD NOT FOUND IN K330 ' K330-KEY-FLD11060038
                    GO TO 5000-EXIT                                     11070038
               WHEN OTHER                                               11080038
                    DISPLAY 'ERROR IN READING K330, STATUS ' K330-STATUS11090038
                    DISPLAY 'REGN NO IS ' K330-KEY-FLD                  11100038
                    DISPLAY 'K600 KEY FLD  IS ' K600-KEY-FLD            11110038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 11120038
           END-EVALUATE.                                                11130038
                                                                        11140038
           READ BP13K330 NEXT.                                          11150038
                                                                        11160038
           EVALUATE K330-STATUS                                         11170038
               WHEN 00                                                  11180038
               WHEN 02                                                  11190038
                    IF K330-CURR-REG EQUAL K600-NUM-ORIG-REGN           11200038
                       MOVE K330-SCH                TO WS-LINK-NUM-SCH  11210038
                       MOVE K330-ACC(1:4)           TO WS-LINK-NUM-ACC  11220038
                       MOVE K330-ACC(5:1)           TO WS-LINK-NUM-CHK  11230038
                       PERFORM 5400-GET-CDE-STREET  THRU 5400-EXIT      11240038
                       MOVE 'Y'  TO WS-K330-FOUND                       11250038
                       ADD   1   TO WS-CNT-K330-READ                    11260038
                    ELSE                                                11270038
                       MOVE 'N'  TO WS-K330-FOUND                       11280038
                    END-IF                                              11290038
               WHEN 10                                                  11300038
               WHEN 23                                                  11310038
                    MOVE 'N'     TO WS-K330-FOUND                       11320038
                    DISPLAY 'RECORD NOT FOUND IN K330 '                 11330038
                    DISPLAY 'K600 KEY FLD IS ' K600-KEY-FLD             11340038
               WHEN OTHER                                               11350038
                    DISPLAY 'ERROR IN READING K330, STATUS ' K330-STATUS11360038
                    DISPLAY 'REGN NO IS ' K330-KEY-FLD                  11370038
                    DISPLAY 'K600 KEY FLD  IS ' K600-KEY-FLD            11380038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 11390038
           END-EVALUATE.                                                11400038
                                                                        11410038
       5000-EXIT.                                                       11420038
            EXIT.                                                       11430038
                                                                        11440038
                                                                        11450038
      ******************                                                11460038
       5100-READ-SO-FILE.                                               11470038
      ******************                                                11480038
           MOVE K600-NUM-ORIG-REGN  TO K410-KEY-FLD.                    11490038
                                                                        11500038
           READ BP13K410.                                               11510038
                                                                        11520038
           EVALUATE K410-STATUS                                         11530038
               WHEN 00                                                  11540038
                    MOVE K410-SCHEME             TO WS-LINK-NUM-SCH     11550038
                    MOVE K410-ACC                TO WS-LINK-NUM-ACC     11560038
                    MOVE K410-CHK                TO WS-LINK-NUM-CHK     11570038
                    PERFORM 5400-GET-CDE-STREET  THRU 5400-EXIT         11580038
                    MOVE 'Y'  TO WS-K410-FOUND                          11590038
                    ADD   1   TO WS-CNT-K410-READ                       11600038
               WHEN 23                                                  11610038
                    MOVE 'N'  TO WS-K410-FOUND                          11620038
                    DISPLAY 'RECORD NOT FOUND IN K410 ' K410-KEY-FLD    11630038
               WHEN OTHER                                               11640038
                    DISPLAY 'ERROR IN READING K410  STATUS' K410-STATUS 11650038
                    DISPLAY 'REGN NO IS ' K410-KEY-FLD                  11660038
                    DISPLAY 'K600 KEY FLD  IS ' K600-KEY-FLD            11670038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 11680038
           END-EVALUATE.                                                11690038
                                                                        11700038
       5100-EXIT.                                                       11710038
            EXIT.                                                       11720038
                                                                        11730038
                                                                        11740038
      **********************                                            11750038
       5200-READ-SUBTR-FILE.                                            11760038
      **********************                                            11770038
           MOVE LOW-VALUES          TO K882-KEY-FLD.                    11780038
           MOVE K600-NUM-ORIG-REGN  TO K882-KEY-FLD.                    11790038
                                                                        11800038
           START BP13K882 KEY > K882-KEY-FLD.                           11810038
                                                                        11820038
           EVALUATE K882-STATUS                                         11830038
               WHEN 00                                                  11840038
               WHEN 02                                                  11850038
                    CONTINUE                                            11860038
               WHEN 10                                                  11870038
               WHEN 23                                                  11880038
                    MOVE 'N'  TO WS-K882-FOUND                          11890038
                    DISPLAY 'RECORD NOT FOUND IN K882 ' K882-KEY-FLD    11900038
                    GO TO 5200-EXIT                                     11910038
               WHEN OTHER                                               11920038
                    DISPLAY 'ERROR IN READING K882  STATUS' K882-STATUS 11930038
                    DISPLAY 'REGN NO IS ' K882-KEY-FLD                  11940038
                    DISPLAY 'K600 KEY FLD  IS ' K600-KEY-FLD            11950038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 11960038
           END-EVALUATE.                                                11970038
                                                                        11980038
           READ BP13K882 NEXT.                                          11990038
                                                                        12000038
           EVALUATE K882-STATUS                                         12010038
               WHEN 00                                                  12020038
               WHEN 02                                                  12030038
                    IF K882-NUM-REGN-SUBTRF  EQUAL K600-NUM-ORIG-REGN   12040038
                       MOVE K882-NUM-SCH            TO WS-LINK-NUM-SCH  12050038
                       MOVE K882-NUM-ACC            TO WS-LINK-NUM-ACC  12060038
                       MOVE K882-NUM-ACC-CK         TO WS-LINK-NUM-CHK  12070038
                       PERFORM 5400-GET-CDE-STREET  THRU 5400-EXIT      12080038
                       MOVE 'Y'  TO WS-K882-FOUND                       12090038
                       ADD   1   TO WS-CNT-K882-READ                    12100038
                    ELSE                                                12110038
                       MOVE 'N'  TO WS-K882-FOUND                       12120038
                    END-IF                                              12130038
               WHEN 10                                                  12140038
               WHEN 23                                                  12150038
                    MOVE 'N'     TO WS-K882-FOUND                       12160038
                    DISPLAY 'RECORD NOT FOUND IN K882 '                 12170038
                    DISPLAY 'K600 KEY FLD IS ' K600-KEY-FLD             12180038
               WHEN OTHER                                               12190038
                    DISPLAY 'ERROR IN READING K882, STATUS ' K882-STATUS12200038
                    DISPLAY 'REGN NO IS ' K882-KEY-FLD                  12210038
                    DISPLAY 'K600 KEY FLD  IS ' K600-KEY-FLD            12220038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 12230038
           END-EVALUATE.                                                12240038
                                                                        12250038
       5200-EXIT.                                                       12260038
            EXIT.                                                       12270038
                                                                        12280038
                                                                        12290038
      ***********************                                           12300038
       5300-READ-MASTER-FILE.                                           12310038
      ***********************                                           12320038
           MOVE K600-NUM-ORIG-REGN  TO K800-NUM-REGN.                   12330038
                                                                        12340038
           READ BP13K800.                                               12350038
                                                                        12360038
           EVALUATE K800-STATUS                                         12370038
               WHEN 00                                                  12380038
                    MOVE K800-NUM-SCH            TO WS-LINK-NUM-SCH     12390038
                    MOVE K800-NUM-ACC            TO WS-LINK-NUM-ACC     12400038
                    MOVE K800-NUM-ACC-CK         TO WS-LINK-NUM-CHK     12410038
                    PERFORM 5400-GET-CDE-STREET  THRU 5400-EXIT         12420038
                    MOVE 'Y'  TO WS-K800-FOUND                          12430038
                    ADD   1   TO WS-CNT-K800-READ                       12440038
               WHEN 23                                                  12450038
                    DISPLAY 'RECORD NOT FOUND IN K800 ' K800-NUM-REGN   12460038
                    IF K600-NUM-DBSS = 'Y'                              12470038
                       MOVE SPACES               TO BP13K800-MASTER     12480038
                       INITIALIZE                   BP13K800-MASTER     12490038
                       MOVE K600-NUM-SCH         TO WS-LINK-NUM-SCH     12500038
                       MOVE K600-NUM-ACCNT       TO WS-LINK-NUM-ACC     12510038
                       MOVE K600-CDE-CDG         TO WS-LINK-NUM-CHK     12520038
                       PERFORM 5400-GET-CDE-STREET THRU 5400-EXIT       12530038
                       MOVE 'Y' TO WS-K800-FOUND                        12540038
                    ELSE                                                12550038
                       MOVE 'N' TO WS-K800-FOUND                        12560038
                    END-IF                                              12570038
               WHEN OTHER                                               12580038
                    DISPLAY 'ERROR IN READING K800  STATUS' K800-STATUS 12590038
                    DISPLAY 'REGN NO IS ' K800-NUM-REGN                 12600038
                    DISPLAY 'K600 KEY FLD  IS ' K600-KEY-FLD            12610038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 12620038
           END-EVALUATE.                                                12630038
                                                                        12640038
       5300-EXIT.                                                       12650038
            EXIT.                                                       12660038
                                                                        12670038
                                                                        12680038
      ***********************                                           12690038
       5350-READ-BP13K800.                                              12700038
      ***********************                                           12710038
           MOVE K600-NUM-ORIG-REGN  TO K800-NUM-REGN.                   12720038
                                                                        12730038
           READ BP13K800.                                               12740038
                                                                        12750038
           EVALUATE K800-STATUS                                         12760038
               WHEN 00                                                  12770038
                    MOVE 'Y'  TO WS-K800-FOUND                          12780038
                    ADD   1   TO WS-CNT-K800-READ                       12790038
               WHEN 23                                                  12800038
                    MOVE 'N'  TO F860-NUM-STUDIO-APT-TAG                12810038
                    MOVE 'N'  TO WS-K800-FOUND                          12820038
                    DISPLAY 'RECORD NOT FOUND IN K800 ' K800-NUM-REGN   12830038
               WHEN OTHER                                               12840038
                    DISPLAY 'ERROR IN READING K800  STATUS' K800-STATUS 12850038
                    DISPLAY 'REGN NO IS ' K800-NUM-REGN                 12860038
                    DISPLAY 'K600 KEY FLD  IS ' K600-KEY-FLD            12870038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 12880038
           END-EVALUATE.                                                12890038
                                                                        12900038
       5350-EXIT.                                                       12910038
            EXIT.                                                       12920038
                                                                        12930038
                                                                        12940038
      **********************                                            12950038
       5400-GET-CDE-STREET.                                             12960038
      **********************                                            12970038
           CALL WS-BP13C913 USING                                       12980038
                 WS-LINK-REC, BP13COMM8-REC                             12990038
           END-CALL.                                                    13000038
                                                                        13010038
           IF COMM8-CDE-SYSERR NOT = 0                                  13020038
              IF COMM8-CDE-SYSERR = 100                                 13030038
                 DISPLAY 'SCH-ACC NOT FOUND IN PBF TABLE'               13040038
                         COMM8-CDE-SYSERR                               13050038
              ELSE                                                      13060038
                 DISPLAY 'ERROR READING PBF TABLE' COMM8-CDE-SYSERR     13070038
              END-IF                                                    13080038
              MOVE SPACES        TO BP13COMM8-REC                       13090038
           END-IF.                                                      13100038
                                                                        13110038
       5400-EXIT.                                                       13120038
            EXIT.                                                       13130038
                                                                        13140038
      ***********************                                           13150038
       5450-READ-BP13K857.                                              13160038
      ***********************                                           13170038
                                                                        13180038
           MOVE SPACES              TO BP13K857-REC.                    13190038
           INITIALIZE                  BP13K857-REC.                    13200038
                                                                        13210038
           MOVE K600-NUM-ORIG-REGN  TO K857-NUM-REGN.                   13220038
                                                                        13230038
           READ BP13K857.                                               13240038
                                                                        13250038
           EVALUATE K857-STATUS                                         13260038
               WHEN 00                                                  13270038
                    CONTINUE                                            13280038
                                                                        13290038
               WHEN 23                                                  13300038
                    MOVE SPACES     TO BP13K857-REC                     13310038
                    INITIALIZE         BP13K857-REC                     13320038
                                                                        13330038
               WHEN OTHER                                               13340038
                    DISPLAY 'ERROR IN READING K857  STATUS' K857-STATUS 13350038
                    DISPLAY 'K857 KEY FLD  IS ' K857-NUM-REGN           13360038
                    PERFORM 9999-WRAP-UP THRU 9999-EXIT                 13370038
           END-EVALUATE.                                                13380038
                                                                        13390038
       5450-EXIT.                                                       13400038
            EXIT.                                                       13410038
                                                                        13420038
                                                                        13430038
      **************                                                    13440038
       9999-WRAP-UP.                                                    13450038
      **************                                                    13460038
           DISPLAY '******* CONTROL   TOTALS ********'.                 13470038
           DISPLAY 'PROGRAM-ID : BP13C470'.                             13480038
           DISPLAY '*********************************'.                 13490038
           DISPLAY  SPACES.                                             13500038
           DISPLAY 'TOTAL BP13F600 RECS READ     = ' WS-CNT-F600-READ.  13510038
           DISPLAY 'TOTAL BP13K600 RECS READ     = ' WS-CNT-K600-READ.  13520038
           DISPLAY 'TOTAL BP13K330 RECS READ     = ' WS-CNT-K330-READ.  13530038
           DISPLAY 'TOTAL BP13K410 RECS READ     = ' WS-CNT-K410-READ.  13540038
           DISPLAY 'TOTAL BP13K800 RECS READ     = ' WS-CNT-K800-READ.  13550038
           DISPLAY 'TOTAL BP13K882 RECS READ     = ' WS-CNT-K882-READ.  13560038
           DISPLAY 'TOTAL BP13K600 RECS BYPASSED = ' WS-CNT-K600-BYPASS.13570038
           DISPLAY 'TOTAL BP13K600 RECS RE-WRITE = ' WS-CNT-K600-WRT.   13580038
           DISPLAY 'TOTAL BP13K600 RECS DELETED  = ' WS-CNT-K600-DEL.   13590038
           DISPLAY 'TOTAL AB02F860 RECS WRITTEN  = ' WS-CNT-F860-WRT.   13600038
                                                                        13610038
           CLOSE BP13F600                                               13620038
                 BP13K600                                               13630038
                 BP13K410                                               13640038
                 BP13K800                                               13650038
                 BP13K857                                               13660038
                 BP13K882                                               13670038
                 BP13K330                                               13680038
                 AB02F860                                               13690038
                 SY02F001                                               13700038
                 BP13F60A.                                              13710038
                                                                        13720038
           IF  K857-STATUS NOT = 0                                      13730038
               MOVE K857-STATUS TO RETURN-CODE                          13740038
               DISPLAY 'CLOSE FAILED FOR BP13K857 ' K857-STATUS         13750038
           END-IF.                                                      13760038
                                                                        13770038
           IF  K600-STATUS NOT = 0                                      13780038
               MOVE K600-STATUS TO RETURN-CODE                          13790038
               DISPLAY 'CLOSE FAILED FOR BP13K600 ' K600-STATUS         13800038
           END-IF.                                                      13810038
                                                                        13820038
           IF  K410-STATUS NOT = 0                                      13830038
               MOVE K410-STATUS TO RETURN-CODE                          13840038
               DISPLAY 'CLOSE FAILED FOR BP13K410 ' K410-STATUS         13850038
           END-IF.                                                      13860038
                                                                        13870038
           IF  K800-STATUS NOT = 0                                      13880038
               MOVE K800-STATUS TO RETURN-CODE                          13890038
               DISPLAY 'CLOSE FAILED FOR BP13K800 ' K800-STATUS         13900038
           END-IF.                                                      13910038
                                                                        13920038
           IF  K882-STATUS NOT = 0                                      13930038
               MOVE K882-STATUS TO RETURN-CODE                          13940038
               DISPLAY 'CLOSE FAILED FOR BP13K882 ' K882-STATUS         13950038
           END-IF.                                                      13960038
                                                                        13970038
           IF  K330-STATUS NOT = 0                                      13980038
               MOVE K330-STATUS TO RETURN-CODE                          13990038
               DISPLAY 'CLOSE FAILED FOR BP13K330 ' K330-STATUS         14000038
           END-IF.                                                      14010038
                                                                        14020038
           STOP RUN.                                                    14030038
                                                                        14040038
       9999-EXIT.                                                       14050038
            EXIT.                                                       14060038
