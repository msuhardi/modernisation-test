      *===============================================================*         
       IDENTIFICATION DIVISION.                                                 
      *===============================================================*         
       PROGRAM-ID.    BP13C49E.                                                 
       AUTHOR.        KARL ANDRUS MAGALONA CABUG.                               
       DATE-WRITTEN.  FEBRUARY 03, 2020.                                        
      *===============================================================*         
      * OBJECTIVE  :  INTERFACE FILE TO LEAS (FLIPPED LOAN TAG TO 'P')*         
      *===============================================================*         
      *                                                               *         
      * INPUT FILE :  1. P13F49D1 - DA = 'Y' & LOAN-TAG = 'N'         *         
      *               2. BP13K800                                     *         
      *                                                               *         
      * OUTPUT FILE:  1. BP13F385 - INTERFACE FILE TO LEAS (BP27) FOR *         
      *                             DEFER ASSESSMENT CASES.           *         
      *===============================================================*         
      * REF NO   DATE       BY   AMENDMENTS/ENHANCEMENTS              *         
      *---------------------------------------------------------------*         
      * BP138170 03/02/2020 KAC1 NEW PROGRAM                          *         
      * BP138014 24/02/2020 KAC1 REVISED TO CATER FOR LEAS REQUIREMNTS*         
      * BP139025 04/01/2021 ZDD1 TO CATER FOR LTV 85 % FOR CASES ON AND         
      *                          AFTER 16 DEC 2021.                   *         
      *===============================================================*         
                                                                                
                                                                                
      **********************                                                    
       ENVIRONMENT DIVISION.                                                    
      **********************                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT  P13F49D1  ASSIGN        TO P13F49D1.                         
           SELECT  BP13F385  ASSIGN        TO BP13F385.                         
                                                                                
           SELECT  BP13K800  ASSIGN        TO BP13K800                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K800-NUM-REGN                     
                             FILE STATUS   IS WS-K800-STATUS.                   
                                                                                
           SELECT  BP13K820  ASSIGN        TO BP13K820                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K820-KEY-FLD                      
                             ALTERNATE KEY IS K820-NUM-NRIC                     
                             FILE STATUS   IS WS-K820-STATUS.                   
                                                                                
           SELECT BP13K830  ASSIGN         TO BP13K830                          
                            ORGANIZATION   IS INDEXED                           
                            ACCESS MODE    IS RANDOM                            
                            RECORD KEY     IS K830-KEY-FLD                      
                            ALTERNATE KEY  IS K830-NUM-REGN                     
                            FILE STATUS    IS WS-K830-STATUS.                   
                                                                                
           SELECT BP13K857  ASSIGN         TO BP13K857                          
                            ORGANIZATION   IS INDEXED                           
                            ACCESS MODE    IS RANDOM                            
                            RECORD KEY     IS K857-NUM-REGN                     
                            FILE STATUS    IS WS-K857-STATUS.                   
                                                                                
           SELECT BP13K734  ASSIGN         TO BP13K734                          
                            ORGANIZATION   IS INDEXED                           
                            ACCESS MODE    IS RANDOM                            
                            RECORD KEY     IS K734-KEY-FLD                      
                            FILE STATUS    IS WS-K734-STATUS.                   
                                                                                
           SELECT BP13KB20  ASSIGN         TO BP13KB20                          
                            ORGANIZATION   IS INDEXED                           
                            ACCESS MODE    IS RANDOM                            
                            RECORD KEY     IS KB20-KEY-FLD                      
                            FILE STATUS    IS WS-KB20-STATUS.                   
                                                                                
      ***************                                                           
       DATA DIVISION.                                                           
      ***************                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K857                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K857.                                                           
                                                                                
       FD   BP13K734                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K734.                                                           
                                                                                
       FD   BP13KB20                                                            
            RECORD CONTAINS 3300 CHARACTERS.                                    
       COPY BP13KB20.                                                           
                                                                                
       FD   P13F49D1                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 50 CHARACTERS                                       
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
                                                                                
       01   P13F49D1-RECORD.                                                    
            05 P13F49D1-NUM-REGN           PIC X(08).                           
            05 P13F49D1-LOAN-TAG           PIC X(01).                           
            05 P13F49D1-DTE-REGN           PIC X(08).                           
            05 FILLER                      PIC X(33).                           
                                                                                
       FD   BP13F385                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 3500 CHARACTERS                                     
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F385.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
      *                   WORKING-STORAGE AREA                         *        
      ******************************************************************        
       01  FILE-VARIABLES.                                                      
           05  WS-K800-STATUS          PIC X(2)  VALUE ZEROES.                  
           05  WS-K820-STATUS          PIC X(2)  VALUE ZEROES.                  
           05  WS-K830-STATUS          PIC 99    VALUE ZEROES.                  
           05  WS-K734-STATUS          PIC 99    VALUE ZEROES.                  
           05  WS-K857-STATUS          PIC 99    VALUE ZEROES.                  
           05  WS-KB20-STATUS          PIC 99    VALUE ZEROES.                  
           05  WS-EOF-F49D1            PIC X(1)  VALUE 'N'.                     
           05  WS-K800-FND             PIC X(1)  VALUE 'N'.                     
           05  WS-K820-FND             PIC X(1)  VALUE 'N'.                     
           05  WS-K734-FND             PIC X(1)  VALUE 'N'.                     
           05  WS-K820-EOF             PIC X(1)  VALUE 'N'.                     
                                                                                
       01  WS-COUNTERS.                                                         
           05  IDX                     PIC 9(1)  VALUE ZEROES.                  
           05  IDX2                    PIC 9(1)  VALUE ZEROES.                  
           05  WS-F49D1-READ           PIC 9(7)  VALUE ZEROES.                  
           05  WS-K800-FND-CTR         PIC 9(7)  VALUE ZEROES.                  
           05  WS-K800-NTFND-CTR       PIC 9(7)  VALUE ZEROES.                  
           05  WS-F49D1-CTR            PIC 9(7)  VALUE ZEROES.                  
           05  WS-F385-CTR             PIC 9(7)  VALUE ZEROES.                  
           05  WS-K820-CTR             PIC 9(7)  VALUE ZEROES.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-TEMP-EDN               PIC 9(1)  VALUE ZEROES.                 
           05 WS-TEMP-EDN-R REDEFINES WS-TEMP-EDN PIC X(1).                     
           05 WS-MS                    PIC X(01) VALUE SPACES.                  
           05 WS-ETHNIC                PIC X(01) VALUE SPACES.                  
           05 WS-SEX                   PIC X(01) VALUE SPACES.                  
           05 WS-KB20-NRIC             PIC X(09) VALUE SPACES.                  
           05 WS-CURRENT-DATE          PIC X(08) VALUE SPACES.                  
           05 WS-REMAINING-LEASE       PIC X(04) VALUE SPACES.                  
           05 WS-REM-LEASE REDEFINES WS-REMAINING-LEASE PIC 9(04).              
           05 WS-REM-LEASE-NUMYY       PIC Z9.                                  
           05 WS-REM-LEASE-NUMMM       PIC Z9.                                  
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
           PERFORM 1000-OPEN-ROUTINE       THRU 1000-EXIT.                      
                                                                                
           PERFORM 2000-READ-P13F49D1      THRU 2000-EXIT.                      
           PERFORM 3000-PROCESS-RECORDS    THRU 3000-EXIT                       
             UNTIL WS-EOF-F49D1 = 'Y'.                                          
                                                                                
           PERFORM 9999-CLOSE-ROUTINE      THRU 9999-EXIT.                      
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           OPEN INPUT  P13F49D1                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                       BP13K830                                                 
                       BP13K857                                                 
                       BP13K734                                                 
                       BP13KB20                                                 
               OUTPUT  BP13F385.                                                
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR OPENING BP13K800 , STAT = ' WS-K800-STATUS         
              MOVE WS-K800-STATUS             TO RETURN-CODE                    
              GO TO 9999-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR OPENING BP13K820 , STAT = ' WS-K820-STATUS         
              MOVE WS-K820-STATUS            TO RETURN-CODE                     
              GO TO 9999-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR OPENING BP13K830 , STAT = ' WS-K830-STATUS         
              MOVE WS-K830-STATUS             TO RETURN-CODE                    
              GO TO 9999-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-K857-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR OPENING BP13K857 , STAT = ' WS-K857-STATUS         
              MOVE WS-K857-STATUS             TO RETURN-CODE                    
              GO TO 9999-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-K734-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR OPENING BP13K734 , STAT = ' WS-K734-STATUS         
              MOVE WS-K734-STATUS             TO RETURN-CODE                    
              GO TO 9999-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-KB20-STATUS NOT = 00 AND 97                                    
              DISPLAY 'ERROR OPENING BP13KB20 , STAT = ' WS-KB20-STATUS         
              MOVE WS-KB20-STATUS             TO RETURN-CODE                    
              GO TO 9999-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE.                  
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       2000-READ-P13F49D1.                                                      
      ******************************************************************        
           READ P13F49D1                                                        
             AT END                                                             
                MOVE 'Y'   TO WS-EOF-F49D1                                      
                GO         TO 2000-EXIT.                                        
                                                                                
           ADD  1          TO WS-F49D1-CTR.                                     
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3000-PROCESS-RECORDS.                                                    
      ******************************************************************        
           MOVE ZEROES                             TO IDX                       
                                                      IDX2.                     
           MOVE 'N'                                TO WS-K800-FND.              
           MOVE SPACES                             TO BP13F385-REC              
                                                      BP13K800-MASTER.          
                                                                                
           INITIALIZE                                 BP13F385-REC              
                                                      BP13K800-MASTER.          
                                                                                
           MOVE P13F49D1-NUM-REGN                  TO K800-NUM-REGN.            
           PERFORM 3100-READ-BP13K800            THRU 3100-EXIT.                
                                                                                
           IF (WS-K800-FND = 'Y') AND                                           
              (K800-NUM-LOAN-TAG = 'N')                                         
               MOVE SPACES                       TO BP13K820-REC                
               MOVE 'N'                          TO WS-K820-FND                 
                                                    WS-K820-EOF                 
               IF K800-NUM-ALLO-CAT = 'DBS'                                     
                  MOVE 'DBS'             TO F385-NUM-APPLN-INTENTION            
               ELSE                                                             
                 IF K800-NUM-ALLO-SCHEME = 'FSH'                                
                    MOVE 'FSH'           TO F385-NUM-APPLN-INTENTION            
                 ELSE                                                           
                   IF K800-NUM-ALLO-SCHEME = 'FTS'                              
                      MOVE 'FTS'         TO F385-NUM-APPLN-INTENTION            
                   ELSE                                                         
                      MOVE 'SAL'         TO F385-NUM-APPLN-INTENTION            
                   END-IF                                                       
                 END-IF                                                         
               END-IF                                                           
                                                                                
               MOVE 'CNT'                TO F385-NUM-CASE-STATUS                
               MOVE K800-NUM-ROOM        TO F385-NUM-ROOM                       
                                                                                
               IF K800-NUM-ALLO-CAT = 'BE ' OR 'BTO' OR 'WIS' OR 'DBS'          
                                   OR 'SER' OR 'SBF' OR 'ROF' OR 'OBF'          
                  MOVE K800-NUM-ALLO-CAT TO F385-NUM-APPLN-TYPE                 
               ELSE                                                             
                 IF K800-NUM-ALLO-CAT = '3R ' OR 'WIA' OR 'WIB' OR 'WIC'        
                                                                OR 'WIH'        
                    MOVE 'WIS'           TO F385-NUM-APPLN-TYPE                 
                 ELSE                                                           
                    MOVE 'SAL'           TO F385-NUM-APPLN-TYPE                 
                 END-IF                                                         
               END-IF                                                           
                                                                                
               IF K800-NUM-PORT-ELIG-TAG = 'P' OR 'Y'                           
                  MOVE 'SER'             TO F385-NUM-APPLN-TYPE                 
               END-IF                                                           
                                                                                
               MOVE K800-NUM-REGN        TO F385-NUM-CASE                       
                                                                                
               IF K800-NUM-ALLO-CAT   =   'DBS'                                 
                 IF K800-DTE-REGN < '20110815'                                  
                    MOVE   'O'           TO F385-NUM-INCOME-CEILING             
                 ELSE                                                           
                   IF K800-DTE-REGN >= '20110815' AND                           
                      K800-DTE-REGN <  '20150824'                               
                      MOVE 'D'           TO F385-NUM-INCOME-CEILING             
                   ELSE                                                         
                      MOVE 'M'           TO F385-NUM-INCOME-CEILING             
                   END-IF                                                       
                 END-IF                                                         
               ELSE                                                             
                 IF K800-DTE-BALLOT <  '201109'                                 
                    MOVE    'O'          TO F385-NUM-INCOME-CEILING             
                 ELSE                                                           
                   IF K800-DTE-BALLOT >= '201109' AND                           
                      K800-DTE-BALLOT <  '201509'                               
                      MOVE   'N'         TO F385-NUM-INCOME-CEILING             
                   ELSE                                                         
                      MOVE   'M'         TO F385-NUM-INCOME-CEILING             
                   END-IF                                                       
                 END-IF                                                         
               END-IF                                                           
                                                                                
               MOVE K800-AMT-HSE-INCOME  TO F385-AMT-HSE-INCOME                 
               MOVE SPACES               TO F385-NUM-SPCL-RLCT                  
                                                                                
               IF K800-DTE-BALLOT >= '201307' AND                               
                  WS-CURRENT-DATE >= '20130828'                                 
                  MOVE '03'              TO F385-NUM-DSR-RATE                   
                  MOVE '02'              TO F385-TYP-REPAY-PERIOD               
                                            F385-TYP-AVG-AGE                    
               ELSE                                                             
                  MOVE '01'              TO F385-TYP-REPAY-PERIOD               
                                            F385-TYP-AVG-AGE                    
                  IF K800-DTE-BALLOT >= '201301'   AND                          
                     WS-CURRENT-DATE >= '20130112' AND                          
                     K800-DTE-BALLOT <  '201307'                                
                      MOVE '02'          TO F385-NUM-DSR-RATE                   
                   ELSE                                                         
                      MOVE '01'          TO F385-NUM-DSR-RATE                   
                   END-IF                                                       
               END-IF                                                           
                                                                                
               IF K800-DTE-REGN >= '20211216'                                   
                  MOVE 'V'               TO F385-NUM-REMAIN-LEASE               
               ELSE                                                             
               IF K800-DTE-REGN >= '20190510'                                   
                  MOVE 'L'               TO F385-NUM-REMAIN-LEASE               
               ELSE                                                             
                  MOVE 'Y'               TO F385-NUM-REMAIN-LEASE               
               END-IF                                                           
                                                                                
               MOVE K800-NUM-REMAINING-LEASE-MTH TO WS-REM-LEASE                
               DIVIDE WS-REM-LEASE BY 12 GIVING WS-REM-LEASE-NUMYY              
                                         REMAINDER WS-REM-LEASE-NUMMM           
                                                                                
               MOVE WS-REM-LEASE-NUMYY   TO F385-NUM-REMAIN-LEASE-YY            
               MOVE WS-REM-LEASE-NUMMM   TO F385-NUM-REMAIN-LEASE-MM            
               DISPLAY 'REM-LEASE-NUMYY = ' WS-REM-LEASE-NUMYY                  
               DISPLAY 'REM-LEASE-NUMMM = ' WS-REM-LEASE-NUMMM                  
                                                                                
               IF K800-DTE-BALLOT >= '201808'                                   
                  MOVE 'N'               TO F385-NUM-INC-MONTH                  
               ELSE                                                             
                  MOVE 'O'               TO F385-NUM-INC-MONTH                  
               END-IF                                                           
                                                                                
               MOVE SPACES               TO F385-NUM-MCYS-RATE                  
                                                                                
               MOVE K800-DTE-REGN        TO F385-DTE-FLAT-APPLN                 
                                                                                
               MOVE K800-NUM-REGN        TO K830-NUM-REGN                       
               PERFORM 3200-READ-BP13K830   THRU 3200-EXIT                      
                                                                                
      *** CORRESPONDING ADDRESS ***                                             
               IF (K830-NUM-MAIL-ADDR  = SPACES OR LOW-VALUES) OR               
                  ((K830-NUM-MAIL-LVL-CHAR = '#') AND                           
                   (K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES))              
                  MOVE K830-NUM-MAIN-BLK        TO F385-NUM-MAIN-BLK            
                  MOVE K830-NUM-SUB-BLK         TO F385-NUM-SUB-BLK             
                  MOVE K830-NUM-LVL-NUM         TO F385-NUM-LVL-NUM             
                  MOVE K830-NUM-HSEMAIN         TO F385-NUM-HSEMAIN             
                  MOVE K830-NUM-HSESUB          TO F385-NUM-HSESUB              
                  MOVE K830-NME-STREET-BLDG     TO F385-NME-STR-BLDG            
                  MOVE K830-NUM-POSTAL          TO F385-NUM-POSTAL              
               ELSE                                                             
                  MOVE K830-NUM-MAIL-MAIN-BLK   TO F385-NUM-MAIN-BLK            
                  MOVE K830-NUM-MAIL-SUB-BLK    TO F385-NUM-SUB-BLK             
                  MOVE K830-NUM-MAIL-LVL-NUM    TO F385-NUM-LVL-NUM             
                  MOVE K830-NUM-MAIL-HSEMAIN    TO F385-NUM-HSEMAIN             
                  MOVE K830-NUM-MAIL-HSESUB     TO F385-NUM-HSESUB              
                  MOVE K830-NME-MAIL-STR-BLDG   TO F385-NME-STR-BLDG            
                  MOVE K830-NUM-MAIL-POSTAL     TO F385-NUM-POSTAL              
               END-IF                                                           
                                                                                
      ****APPLICANT-DETAILS****                                                 
               MOVE 'N'                          TO WS-K820-EOF                 
               MOVE K800-NUM-REGN                TO K820-NUM-REGN               
               PERFORM 4000-STARTBR-BP13K820   THRU 4000-EXIT                   
               IF WS-K820-FND = 'Y'                                             
                 PERFORM UNTIL WS-K820-EOF = 'Y'                                
                   PERFORM 4100-READNEXT-BP13K820 THRU 4100-EXIT                
                   IF (K820-NUM-REGN = K800-NUM-REGN) AND                       
                      (WS-K820-EOF NOT = 'Y')                                   
                     IF K820-NUM-NRIC = K800-NUM-NRIC1 OR                       
                        K820-NUM-NRIC = K800-NUM-NRIC2 OR                       
                        K820-NUM-NRIC = K800-NUM-NRIC3 OR                       
                        K820-NUM-NRIC = K800-NUM-NRIC4                          
                       MOVE K820-NUM-NRIC  TO F385-NUM-APPL-NRIC(IDX)           
                       MOVE K820-NME-OCCP  TO F385-NME-APPL(IDX)                
                                                                                
                       PERFORM 3205-CONVERT-MS-ETHNIC THRU 3205-EXIT            
                       MOVE WS-MS          TO F385-NUM-APPL-MS(IDX)             
                                                                                
                       MOVE K820-NUM-CITIZENSHIP TO                             
                            F385-NUM-APPL-CITIZENSHIP(IDX)                      
                                                                                
                       MOVE K820-DTE-BIRTH TO F385-DTE-APPL-BIRTH(IDX)          
                                                                                
                       MOVE WS-SEX         TO F385-NUM-APPL-SEX(IDX)            
                       MOVE WS-ETHNIC      TO F385-NUM-APPL-ETHNIC(IDX)         
                                                                                
                       MOVE K820-NUM-RELATIONSHIP                               
                                           TO F385-NUM-APPL-RLTNSP(IDX)         
                                                                                
                       MOVE 'N'            TO WS-K734-FND                       
                       MOVE SPACES         TO BP13K734-REC                      
                                              K734-KEY-FLD                      
                       MOVE K820-NUM-REGN  TO K734-NUM-REGN                     
                       MOVE K820-NUM-NRIC  TO K734-NUM-NRIC                     
                       PERFORM 3300-READ-BP13K734 THRU 3300-EXIT                
                                                                                
                       IF WS-K734-FND = 'Y'                                     
                         PERFORM 3210-MOVE-K734-DTLS   THRU 3210-EXIT           
                       ELSE                                                     
                         MOVE '000000' TO F385-DTE-APPL-INC1 (IDX)              
                                          F385-DTE-APPL-INC2 (IDX)              
                                          F385-DTE-APPL-INC3 (IDX)              
                                          F385-DTE-APPL-INC4 (IDX)              
                                          F385-DTE-APPL-INC5 (IDX)              
                                          F385-DTE-APPL-INC6 (IDX)              
                                          F385-DTE-APPL-INC7 (IDX)              
                                          F385-DTE-APPL-INC8 (IDX)              
                                          F385-DTE-APPL-INC9 (IDX)              
                                          F385-DTE-APPL-INC10(IDX)              
                                          F385-DTE-APPL-INC11(IDX)              
                                          F385-DTE-APPL-INC12(IDX)              
                         MOVE ZEROES   TO F385-AMT-APPL-INC1 (IDX)              
                                          F385-AMT-APPL-INC2 (IDX)              
                                          F385-AMT-APPL-INC3 (IDX)              
                                          F385-AMT-APPL-INC4 (IDX)              
                                          F385-AMT-APPL-INC5 (IDX)              
                                          F385-AMT-APPL-INC6 (IDX)              
                                          F385-AMT-APPL-INC7 (IDX)              
                                          F385-AMT-APPL-INC8 (IDX)              
                                          F385-AMT-APPL-INC9 (IDX)              
                                          F385-AMT-APPL-INC10(IDX)              
                                          F385-AMT-APPL-INC11(IDX)              
                                          F385-AMT-APPL-INC12(IDX)              
                         MOVE SPACES TO F385-NUM-APPL-WITH-CPF(IDX)             
                         IF K800-DTE-BALLOT <  '201109'                         
                            MOVE K820-AMT-INCOME                                
                                 TO F385-AMT-APPL-INC12(IDX)                    
                            IF K820-AMT-INCOME > 0                              
                               MOVE '3'                                         
                                     TO F385-NUM-APPL-EMPLY-STATUS(IDX)         
                               MOVE 'Y' TO F385-NUM-APPL-WITH-CPF(IDX)          
                            ELSE                                                
                               MOVE '1'                                         
                                     TO F385-NUM-APPL-EMPLY-STATUS(IDX)         
                            END-IF                                              
                         END-IF                                                 
                       END-IF                                                   
                                                                                
                       MOVE K820-NUM-PHONE                                      
                         TO F385-NUM-APPL-PHONE-HOME(IDX)                       
                       MOVE K820-NUM-HP-PGR                                     
                         TO F385-NUM-APPL-HP-PGR(IDX)                           
                       MOVE K820-NUM-EDUCATION                                  
                         TO F385-NUM-APPL-EDN-LVL(IDX)                          
                                                                                
                       MOVE K800-NUM-REGN           TO K857-NUM-REGN            
                       PERFORM 3500-GET-EMAIL-BP13K857  THRU 3500-EXIT          
                                                                                
                       MOVE K857-NUM-EMAIL  TO F385-NUM-APPL-EMAIL(IDX)         
                                                                                
                       MOVE K820-NUM-NRIC-SPOUSE                                
                         TO F385-NUM-APPL-SPOUSE-NRIC(IDX)                      
                       MOVE K820-NUM-NHA                                        
                         TO F385-NUM-APPL-NHA(IDX)                              
                       MOVE K820-NUM-LESSEE-CHECK                               
                         TO F385-NUM-APPL-LESSEE(IDX)                           
                                                                                
                       IF F385-NUM-APPL-EMPLY-STATUS(IDX) = '3'                 
                                       OR '4' OR '5' OR '7' OR '9'              
                          MOVE 'Y' TO F385-NUM-APPL-STILL-EMPLY(IDX)            
                       ELSE                                                     
                          MOVE 'N' TO  F385-NUM-APPL-STILL-EMPLY(IDX)           
                       END-IF                                                   
                     ELSE                                                       
      **OCCUP DTLS**                                                            
                       PERFORM 3600-MOVE-OCCUP-DTLS  THRU 3600-EXIT             
                     END-IF                                                     
                   END-IF                                                       
                 END-PERFORM                                                    
               END-IF                                                           
                                                                                
               MOVE K800-NUM-REGN           TO F385-NUM-REGN                    
               MOVE 'P'                     TO F385-NUM-LOAN-TAG                
               MOVE K800-NUM-SCH-ACC        TO F385-NUM-SCH-ACCT                
               MOVE WS-CURRENT-DATE         TO F385-DTE-UPDATE                  
               MOVE 'BP13C49E'              TO F385-NUM-USERID                  
                                                                                
               WRITE BP13F385-REC                                               
               ADD 1 TO WS-F385-CTR                                             
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-P13F49D1     THRU 2000-EXIT.                       
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3100-READ-BP13K800.                                                      
      ******************************************************************        
           READ BP13K800.                                                       
                                                                                
           EVALUATE WS-K800-STATUS                                              
               WHEN 00                                                          
                    MOVE 'Y'                    TO WS-K800-FND                  
               WHEN 23                                                          
                    ADD 1                       TO WS-K800-NTFND-CTR            
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K800 : ' WS-K800-STATUS          
                            ' REGN = ' K800-NUM-REGN                            
                    MOVE WS-K800-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3200-READ-BP13K830.                                                      
      ******************************************************************        
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K830-STATUS                                              
               WHEN 00                                                          
               WHEN 02                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES             TO BP13K830-REC                     
                    DISPLAY 'REGN-NUM' K830-NUM-REGN                            
                    DISPLAY 'K830 REC NOTFND KEY: ' K830-NUM-REGN               
               WHEN OTHER                                                       
                    MOVE WS-K830-STATUS           TO RETURN-CODE                
                    DISPLAY 'ERROR READING BP13K830, STATUS '                   
                          WS-K830-STATUS                                        
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3205-CONVERT-MS-ETHNIC.                                                  
      ******************************************************************        
           MOVE SPACES           TO WS-SEX                                      
                                    WS-MS                                       
                                    WS-ETHNIC.                                  
           EVALUATE K820-NUM-SEX                                                
           WHEN '1'                                                             
                MOVE 'M'         TO WS-SEX                                      
           WHEN '2'                                                             
                MOVE 'F'         TO WS-SEX                                      
           WHEN OTHER                                                           
                MOVE SPACES      TO WS-SEX                                      
           END-EVALUATE.                                                        
                                                                                
           EVALUATE K820-NUM-MARITAL-STATUS                                     
               WHEN '1'                                                         
                     MOVE 'S'    TO WS-MS                                       
               WHEN '2'                                                         
                     MOVE 'M'    TO WS-MS                                       
               WHEN '3'                                                         
                     MOVE 'W'    TO WS-MS                                       
               WHEN '4'                                                         
                     MOVE 'D'    TO WS-MS                                       
               WHEN '5'                                                         
                     MOVE 'P'    TO WS-MS                                       
               WHEN OTHER                                                       
                     MOVE SPACES TO WS-MS                                       
           END-EVALUATE.                                                        
                                                                                
           EVALUATE K820-NUM-ETHNIC                                             
               WHEN '0'                                                         
                     MOVE 'C'    TO WS-ETHNIC                                   
               WHEN '5'                                                         
                     MOVE 'M'    TO WS-ETHNIC                                   
               WHEN '6'                                                         
                     MOVE 'I'    TO WS-ETHNIC                                   
               WHEN '7'                                                         
                     MOVE 'O'    TO WS-ETHNIC                                   
               WHEN OTHER                                                       
                     MOVE SPACES TO WS-ETHNIC                                   
           END-EVALUATE.                                                        
                                                                                
       3205-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3210-MOVE-K734-DTLS.                                                     
      ******************************************************************        
           IF K800-NUM-ALLO-CAT = 'DBS'                                         
              IF K734-NUM-EMPLY-STATUS(1:1) = SPACES OR LOW-VALUES              
                 MOVE SPACES                  TO BP13KB20-REC                   
                 MOVE K820-NUM-NRIC           TO WS-KB20-NRIC                   
                 MOVE K800-NUM-REGN           TO KB20-NUM-REGN                  
                 PERFORM 3400-READ-BP13KB20 THRU 3400-EXIT                      
                 IF K734-NUM-EMPLY-STATUS(1:1) = SPACES OR                      
                                                 LOW-VALUES                     
                    MOVE '3'          TO K734-NUM-EMPLY-STATUS(1:1)             
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K734-NUM-EMPLY-STATUS(1:1) = '4'                                  
              MOVE '3'                TO F385-NUM-APPL-EMPLY-STATUS(IDX)        
           ELSE                                                                 
             IF K734-NUM-EMPLY-STATUS(1:1) = 'A' OR 'B'                         
                MOVE '1'              TO F385-NUM-APPL-EMPLY-STATUS(IDX)        
             ELSE                                                               
                MOVE K734-NUM-EMPLY-STATUS(1:1)                                 
                                      TO F385-NUM-APPL-EMPLY-STATUS(IDX)        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE SPACES TO F385-TYP-APPL-UNEMPLY(IDX)                            
           IF K734-NUM-EMPLY-STATUS(1:1) = 'A'                                  
              MOVE 'S'                TO F385-TYP-APPL-UNEMPLY(IDX)             
           ELSE                                                                 
             IF K734-NUM-EMPLY-STATUS(1:1) = 'B'                                
                MOVE 'N'              TO F385-TYP-APPL-UNEMPLY(IDX)             
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF K734-NUM-EMPLY-STATUS(1:1) = '1' OR '2' OR '3' OR '4'             
                                               OR 'A' OR 'B'                    
              MOVE K734-DTE-INCOME(1)  TO F385-DTE-APPL-INC10(IDX)              
              MOVE K734-NUM-INCOME(1)  TO F385-AMT-APPL-INC10(IDX)              
              MOVE K734-DTE-INCOME(2)  TO F385-DTE-APPL-INC11(IDX)              
              MOVE K734-NUM-INCOME(2)  TO F385-AMT-APPL-INC11(IDX)              
              MOVE K734-DTE-INCOME(3)  TO F385-DTE-APPL-INC12(IDX)              
              MOVE K734-NUM-INCOME(3)  TO F385-AMT-APPL-INC12(IDX)              
           ELSE                                                                 
              MOVE K734-DTE-INCOME(1)  TO F385-DTE-APPL-INC1(IDX)               
              MOVE K734-NUM-INCOME(1)  TO F385-AMT-APPL-INC1(IDX)               
              MOVE K734-DTE-INCOME(2)  TO F385-DTE-APPL-INC2(IDX)               
              MOVE K734-NUM-INCOME(2)  TO F385-AMT-APPL-INC2(IDX)               
              MOVE K734-DTE-INCOME(3)  TO F385-DTE-APPL-INC3(IDX)               
              MOVE K734-NUM-INCOME(3)  TO F385-AMT-APPL-INC3(IDX)               
              MOVE K734-DTE-INCOME(4)  TO F385-DTE-APPL-INC4(IDX)               
              MOVE K734-NUM-INCOME(4)  TO F385-AMT-APPL-INC4(IDX)               
              MOVE K734-DTE-INCOME(5)  TO F385-DTE-APPL-INC5(IDX)               
              MOVE K734-NUM-INCOME(5)  TO F385-AMT-APPL-INC5(IDX)               
              MOVE K734-DTE-INCOME(6)  TO F385-DTE-APPL-INC6(IDX)               
              MOVE K734-NUM-INCOME(6)  TO F385-AMT-APPL-INC6(IDX)               
              MOVE K734-DTE-INCOME(7)  TO F385-DTE-APPL-INC7(IDX)               
              MOVE K734-NUM-INCOME(7)  TO F385-AMT-APPL-INC7(IDX)               
              MOVE K734-DTE-INCOME(8)  TO F385-DTE-APPL-INC8(IDX)               
              MOVE K734-NUM-INCOME(8)  TO F385-AMT-APPL-INC8(IDX)               
              MOVE K734-DTE-INCOME(9)  TO F385-DTE-APPL-INC9(IDX)               
              MOVE K734-NUM-INCOME(9)  TO F385-AMT-APPL-INC9(IDX)               
              MOVE K734-DTE-INCOME(10) TO F385-DTE-APPL-INC10(IDX)              
              MOVE K734-NUM-INCOME(10) TO F385-AMT-APPL-INC10(IDX)              
              MOVE K734-DTE-INCOME(11) TO F385-DTE-APPL-INC11(IDX)              
              MOVE K734-NUM-INCOME(11) TO F385-AMT-APPL-INC11(IDX)              
              MOVE K734-DTE-INCOME(12) TO F385-DTE-APPL-INC12(IDX)              
              MOVE K734-NUM-INCOME(12) TO F385-AMT-APPL-INC12(IDX)              
           END-IF.                                                              
       3210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3300-READ-BP13K734.                                                      
      ******************************************************************        
           READ BP13K734.                                                       
                                                                                
           EVALUATE WS-K734-STATUS                                              
              WHEN 00                                                           
                   MOVE 'Y'                  TO WS-K734-FND                     
              WHEN 23                                                           
                   MOVE 'N'                  TO WS-K734-FND                     
                   DISPLAY 'RECORD NOT FOUND IN BP13K734.'                      
                           ' KEY : ' K734-KEY-FLD                               
              WHEN OTHER                                                        
                    MOVE WS-K734-STATUS      TO RETURN-CODE                     
                    DISPLAY 'ERROR READING BP13K734, STATUS '                   
                          WS-K734-STATUS                                        
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3400-READ-BP13KB20.                                                      
      ******************************************************************        
           READ BP13KB20.                                                       
                                                                                
           EVALUATE WS-KB20-STATUS                                              
              WHEN 00                                                           
                   EVALUATE WS-KB20-NRIC                                        
                       WHEN KB20-NUM-APPLT1-UIN                                 
                            MOVE KB20-NUM-APPLT1-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-APPLT2-UIN                                 
                            MOVE KB20-NUM-APPLT2-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-APPLT3-UIN                                 
                            MOVE KB20-NUM-APPLT3-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-APPLT4-UIN                                 
                            MOVE KB20-NUM-APPLT4-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP1-UIN                                 
                            MOVE KB20-NUM-OCCUP1-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP2-UIN                                 
                            MOVE KB20-NUM-OCCUP2-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP3-UIN                                 
                            MOVE KB20-NUM-OCCUP3-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP4-UIN                                 
                            MOVE KB20-NUM-OCCUP4-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP5-UIN                                 
                            MOVE KB20-NUM-OCCUP5-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP6-UIN                                 
                            MOVE KB20-NUM-OCCUP6-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP7-UIN                                 
                            MOVE KB20-NUM-OCCUP7-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN KB20-NUM-OCCUP8-UIN                                 
                            MOVE KB20-NUM-OCCUP8-EMPLY-STATUS                   
                              TO K734-NUM-EMPLY-STATUS(1:1)                     
                       WHEN OTHER                                               
                            MOVE SPACES  TO K734-NUM-EMPLY-STATUS(1:1)          
                  END-EVALUATE                                                  
              WHEN 23                                                           
                   MOVE SPACES          TO  K734-NUM-EMPLY-STATUS(1:1)          
              WHEN OTHER                                                        
                    MOVE WS-KB20-STATUS           TO RETURN-CODE                
                    DISPLAY 'ERROR READING BP13KB20, STATUS '                   
                          WS-KB20-STATUS                                        
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3500-GET-EMAIL-BP13K857.                                                 
      ******************************************************************        
           READ BP13K857 KEY IS K857-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K857-STATUS                                              
               WHEN 00                                                          
               WHEN 02                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES             TO BP13K857-REC                     
                    DISPLAY 'K857 REC NOTFND KEY: ' K857-NUM-REGN               
               WHEN OTHER                                                       
                    MOVE WS-K857-STATUS           TO RETURN-CODE                
                    DISPLAY 'ERROR READING BP13K857, STATUS '                   
                          WS-K857-STATUS                                        
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3600-MOVE-OCCUP-DTLS.                                                    
      ******************************************************************        
           ADD 1  TO IDX2                                                       
           MOVE K820-NUM-NRIC TO F385-NUM-OCCP-NRIC(IDX2)                       
           MOVE K820-NME-OCCP TO F385-NME-OCCP(IDX2)                            
           PERFORM 3205-CONVERT-MS-ETHNIC THRU 3205-EXIT                        
                                                                                
           MOVE WS-MS                 TO F385-NUM-OCCP-MS(IDX2)                 
           MOVE K820-DTE-BIRTH        TO F385-DTE-OCCP-BIRTH(IDX2)              
           MOVE WS-SEX                TO F385-NUM-OCCP-SEX(IDX2)                
           MOVE WS-ETHNIC             TO F385-NUM-OCCP-ETHNIC(IDX2)             
           MOVE K820-NUM-CITIZENSHIP  TO F385-NUM-OCCP-CITIZENSHIP(IDX2)        
                                                                                
           MOVE K820-NUM-RELATIONSHIP TO F385-NUM-OCCP-RLTNSP(IDX2)             
           MOVE K820-NUM-EDUCATION    TO F385-NUM-OCCP-EDN-LVL(IDX2)            
           MOVE K820-NUM-NHA          TO F385-NUM-OCCP-NHA(IDX2)                
           MOVE K820-NUM-NRIC-SPOUSE  TO F385-NUM-OCCP-SPOUSE-NRIC(IDX2)        
           MOVE K820-NUM-LESSEE-CHECK TO F385-NUM-OCCP-LESSEE(IDX2)             
                                                                                
           MOVE 'N'                   TO WS-K734-FND                            
           MOVE SPACES                TO K734-KEY-FLD                           
           MOVE K800-NUM-REGN         TO K734-NUM-REGN                          
           MOVE K820-NUM-NRIC         TO K734-NUM-NRIC                          
           PERFORM 3300-READ-BP13K734 THRU 3300-EXIT                            
                                                                                
           IF WS-K734-FND = 'Y'                                                 
             IF K800-NUM-ALLO-CAT = 'DBS'                                       
               IF K734-NUM-EMPLY-STATUS(1:1) = SPACES OR LOW-VALUES             
                  MOVE SPACES                TO BP13KB20-REC                    
                  MOVE K820-NUM-NRIC         TO WS-KB20-NRIC                    
                  MOVE K800-NUM-REGN         TO KB20-NUM-REGN                   
                  PERFORM 3400-READ-BP13KB20 THRU 3400-EXIT                     
                  IF K734-NUM-EMPLY-STATUS(1:1) = SPACES OR LOW-VALUES          
                     MOVE '3' TO K734-NUM-EMPLY-STATUS(1:1)                     
                  END-IF                                                        
               END-IF                                                           
             END-IF                                                             
                                                                                
             IF K734-NUM-EMPLY-STATUS(1:1) = '4'                                
                MOVE '3'            TO F385-NUM-OCCP-EMPLY-STATUS(IDX2)         
             ELSE                                                               
               IF K734-NUM-EMPLY-STATUS(1:1) = 'A' OR 'B'                       
                  MOVE '1'          TO F385-NUM-OCCP-EMPLY-STATUS(IDX2)         
               ELSE                                                             
                  MOVE K734-NUM-EMPLY-STATUS(1:1)                               
                                    TO F385-NUM-OCCP-EMPLY-STATUS(IDX2)         
               END-IF                                                           
             END-IF                                                             
                                                                                
             MOVE SPACES TO F385-TYP-OCCP-UNEMPLY(IDX2)                         
             IF K734-NUM-EMPLY-STATUS(1:1) = 'A'                                
                MOVE 'S'             TO F385-TYP-OCCP-UNEMPLY(IDX2)             
             ELSE                                                               
               IF K734-NUM-EMPLY-STATUS(1:1) = 'B'                              
                  MOVE 'N'           TO F385-TYP-OCCP-UNEMPLY(IDX2)             
               END-IF                                                           
             END-IF                                                             
                                                                                
             IF K734-NUM-EMPLY-STATUS(1:1) = '1' OR '2' OR '3' OR '4'           
                                                 OR 'A' OR 'B'                  
                MOVE K734-DTE-INCOME(1)  TO F385-DTE-OCCP-INC10(IDX2)           
                MOVE K734-NUM-INCOME(1)  TO F385-AMT-OCCP-INC10(IDX2)           
                MOVE K734-DTE-INCOME(2)  TO F385-DTE-OCCP-INC11(IDX2)           
                MOVE K734-NUM-INCOME(2)  TO F385-AMT-OCCP-INC11(IDX2)           
                MOVE K734-DTE-INCOME(3)  TO F385-DTE-OCCP-INC12(IDX2)           
                MOVE K734-NUM-INCOME(3)  TO F385-AMT-OCCP-INC12(IDX2)           
             ELSE                                                               
                MOVE K734-DTE-INCOME(1)  TO F385-DTE-OCCP-INC1(IDX2)            
                MOVE K734-NUM-INCOME(1)  TO F385-AMT-OCCP-INC1(IDX2)            
                MOVE K734-DTE-INCOME(2)  TO F385-DTE-OCCP-INC2(IDX2)            
                MOVE K734-NUM-INCOME(2)  TO F385-AMT-OCCP-INC2(IDX2)            
                MOVE K734-DTE-INCOME(3)  TO F385-DTE-OCCP-INC3(IDX2)            
                MOVE K734-NUM-INCOME(3)  TO F385-AMT-OCCP-INC3(IDX2)            
                MOVE K734-DTE-INCOME(4)  TO F385-DTE-OCCP-INC4(IDX2)            
                MOVE K734-NUM-INCOME(4)  TO F385-AMT-OCCP-INC4(IDX2)            
                MOVE K734-DTE-INCOME(5)  TO F385-DTE-OCCP-INC5(IDX2)            
                MOVE K734-NUM-INCOME(5)  TO F385-AMT-OCCP-INC5(IDX2)            
                MOVE K734-DTE-INCOME(6)  TO F385-DTE-OCCP-INC6(IDX2)            
                MOVE K734-NUM-INCOME(6)  TO F385-AMT-OCCP-INC6(IDX2)            
                MOVE K734-DTE-INCOME(7)  TO F385-DTE-OCCP-INC7(IDX2)            
                MOVE K734-NUM-INCOME(7)  TO F385-AMT-OCCP-INC7(IDX2)            
                MOVE K734-DTE-INCOME(8)  TO F385-DTE-OCCP-INC8(IDX2)            
                MOVE K734-NUM-INCOME(8)  TO F385-AMT-OCCP-INC8(IDX2)            
                MOVE K734-DTE-INCOME(9)  TO F385-DTE-OCCP-INC9(IDX2)            
                MOVE K734-NUM-INCOME(9)  TO F385-AMT-OCCP-INC9(IDX2)            
                MOVE K734-DTE-INCOME(10) TO F385-DTE-OCCP-INC10(IDX2)           
                MOVE K734-NUM-INCOME(10) TO F385-AMT-OCCP-INC10(IDX2)           
                MOVE K734-DTE-INCOME(11) TO F385-DTE-OCCP-INC11(IDX2)           
                MOVE K734-NUM-INCOME(11) TO F385-AMT-OCCP-INC11(IDX2)           
                MOVE K734-DTE-INCOME(12) TO F385-DTE-OCCP-INC12(IDX2)           
                MOVE K734-NUM-INCOME(12) TO F385-AMT-OCCP-INC12(IDX2)           
             END-IF                                                             
           ELSE                                                                 
             MOVE SPACES TO F385-NUM-OCCP-WITH-CPF(IDX2)                        
             IF K800-DTE-BALLOT <  '201109'                                     
                MOVE K820-AMT-INCOME TO F385-AMT-OCCP-INC12(IDX2)               
                IF K820-AMT-INCOME > 0                                          
                   MOVE '3'          TO F385-NUM-OCCP-EMPLY-STATUS(IDX2)        
                   MOVE 'Y'          TO F385-NUM-OCCP-WITH-CPF(IDX2)            
                ELSE                                                            
                   MOVE '1'          TO F385-NUM-OCCP-EMPLY-STATUS(IDX2)        
                END-IF                                                          
             END-IF                                                             
           END-IF.                                                              
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4000-STARTBR-BP13K820.                                                   
      ******************************************************************        
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           IF WS-K820-STATUS = 00 OR 02                                         
              MOVE 'Y'                            TO WS-K820-FND                
           ELSE                                                                 
              IF WS-K820-STATUS = 23 OR 10                                      
                 MOVE 'N'                         TO WS-K820-FND                
                 ADD 1                            TO WS-K820-CTR                
              ELSE                                                              
                 DISPLAY 'BP13K820 - ERROR STARTBR : ' WS-K820-STATUS           
                 MOVE WS-K820-STATUS              TO RETURN-CODE                
                 PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4100-READNEXT-BP13K820.                                                  
      ******************************************************************        
           READ BP13K820 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K820-EOF                                      
                GO TO 4100-EXIT                                                 
           END-READ.                                                            
                                                                                
           EVALUATE WS-K820-STATUS                                              
               WHEN 00                                                          
               WHEN 02                                                          
                    IF K820-NUM-REGN = P13F49D1-NUM-REGN                        
                       IF K820-NUM-NRIC = K800-NUM-NRIC1                        
                          MOVE 1                 TO IDX                         
                       ELSE                                                     
                         IF K820-NUM-NRIC = K800-NUM-NRIC2                      
                            MOVE 2               TO IDX                         
                         ELSE                                                   
                           IF K820-NUM-NRIC = K800-NUM-NRIC3                    
                              MOVE 3             TO IDX                         
                           ELSE                                                 
                             IF K820-NUM-NRIC = K800-NUM-NRIC4                  
                                MOVE 4             TO IDX                       
      *                         MOVE K820-NUM-NRIC TO WS-NUM-NRIC4              
                             END-IF                                             
                           END-IF                                               
                         END-IF                                                 
                       END-IF                                                   
                    ELSE                                                        
                       MOVE 'Y'                    TO WS-K820-EOF               
                       IF IDX = ZEROES                                          
                          ADD 1                    TO WS-K820-CTR               
                       END-IF                                                   
                    END-IF                                                      
                                                                                
               WHEN 23                                                          
               WHEN 10                                                          
                    MOVE 'Y'                     TO WS-K820-EOF                 
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'K820 - ERROR READNEXT : ' WS-K820-STATUS           
                    MOVE WS-K820-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       9999-CLOSE-ROUTINE.                                                      
      ******************************************************************        
                                                                                
           DISPLAY '*************** CONTROL    TOTALS ***************'.         
           DISPLAY 'PROGRAM-ID : BP13C49E'.                                     
           DISPLAY '-------------------------------------------------'.         
           DISPLAY '(1) NO OF INPUT(F49D1) RECORDS READ.... : '                 
                    WS-F49D1-CTR.                                               
           DISPLAY '(2) NO OF BP13K800 NOT FOUND REC  ..... : '                 
                    WS-K800-NTFND-CTR.                                          
           DISPLAY '(2) NO OF BP13K820 NOT FOUND REC  ..... : '                 
                    WS-K820-CTR.                                                
           DISPLAY '(3) NO OF P13F385  RECORDS WRITTEN..... : '                 
                    WS-F385-CTR.                                                
                                                                                
           CLOSE    P13F49D1                                                    
                    BP13K800                                                    
                    BP13K820                                                    
                    BP13K830                                                    
                    BP13K857                                                    
                    BP13K734                                                    
                    BP13KB20                                                    
                    BP13F385.                                                   
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
