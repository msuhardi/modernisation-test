      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID. BP13C350.                                                    
       AUTHOR. MARIA.                                                           
                                                                                
      **********************************************************                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *    SYSTEM ID : BP13                                    *                
      *    OLD PROGRAM : BP13C302                              *                
      *                                                        *                
      *    OBJECTIVE :                                         *                
      *      1.  THIS IS A PROGRAM TO UPDATE SOC MASTER &      *                
      *          FROM SUB-TRANSFER FILE.                       *                
      *      2.  UPDATE CHANGE OF ADDRESS FROM SUB-TRANSFER    *                
      *          FILE TO ADDRESS FILE.                         *                
      *                                                        *                
      *     INPUT FILES:                                       *                
      *      1. SORTED SUB-TRANSFEE FILE    (BP13F880)         *                
      *          FOR DATE-SUB-TRANSFER NOT = SPACES            *                
      *                                                        *                
      *     I-O    FILES:                                      *                
      *      1. SOC MASTER (BP13K800)                          *                
      *      2. SOC EX-APPLICANT FILE (BP13K830)               *                
      *      3. TRANSACTION FILE (BP13K310) FOR PRINT LETTER   *                
      *         ON CHG OF ADDR IN BP13D306 JCL.                *                
      *                                                        *                
      *     OUTPUT FILES:                                      *                
      *      1. KIV FILE (TRANS FORMAT UNSUCCCESSFUL) BP13K800 *                
      *      2. HISTORY UPDATE FILE (BP13K840)                 *                
      *      3. SUCCESSFUL CASES (BP13OUT)                     *                
      *--------------------------------------------------------*                
      *  REVISION HISTORY:                                     *                
      *  CHGNO   BY  DATE            DETAILS:                  *                
      *  =====   ==  ====            ========                  *                
      * SOC8F   LMS 150695 - TO WRITE EXAPPL NAME TO BP13K885  *                
      * SOC8F   MS1 150695 - TO CHANGE INPUT FILE FROM BP13F880*                
      *                      BP13F880, I-O FILE FROM BP13K015  *                
      *                      TO BP13K885                       *                
      * SOC8F   MS1 300695 - CHG BP13F300 TO BP13F880          *                
      * SOC8F   LSB 170196 - DELETE BP13K885, EX-APPLN REC     *                
      *                      CREATED ONLINE, UPDATE ADDR CHG   *                
      *                      WRITE REC TO BP13K310             *                
      * BP130094EG1 260296 - REVISED FORMATTING.               *                
      * BP130418RHB 040698 - Y2K                               *                
      * BP132185CLT 040802 - UPDATE K800-DTE-AGRMT-FOR-LEASE   *                
      * BP133591JB8 220509 - UPDATE KD05-AMT-AHG-USED          *                
      * BP134641MDT 100812 - CHANGE THE RECORD LENGTH OF       *                
      *                      BP13KD05 FROM 300 TO 500 IN FD    *                
      *                      REMOVED THE VALIDATION OF         *                
      *                      F880-DTE-SUBTRF-AHG IF SPACES/LOW *                
      *                      VALUES FIELD REMOVED FROM COPYBOOK*                
      * BP135901KSJ 040915 - INCLUDE OIC IN BP13F880(1996:5)   *                
      * BP137133RJB 121217 - TO BYPASS THE COMPUTATION OF CD AMT                
      *                      WHEN TRANSACTION IS ACTED BY EXT SOL               
      * BP138117 KAC1 220120 CATER TO SKIP 2100 CHK WHEN CD-REQ=0 &*            
      *                      HALF-IDP = 'D'.                       *            
      * BP138383 ZDD1 171220 CATER TO SKIP 2100 CHK WHEN CD-REQ=0 &*            
      *                      HALF-IDP = 'S' OR 'R' OR 'Q' OR 'Y'   *            
      * BP138383 ZDD1 221220 TO CORRECT PASSING OF DATE TO CPF PAID*            
      **********************************************************                
                                                                                
      *--------------------*                                                    
       ENVIRONMENT DIVISION.                                                    
      *--------------------*                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ORGANIZATION IS INDEXED                                       
                  RECORD KEY IS K800-NUM-REGN                                   
                  ACCESS MODE IS RANDOM                                         
                  FILE STATUS IS WS-K800-FILE-STATUS.                           
                                                                                
           SELECT BP13K830 ASSIGN TO BP13K830                                   
                  ORGANIZATION IS INDEXED                                       
                  RECORD KEY IS K830-KEY-FLD                                    
                  ALTERNATE RECORD KEY IS K830-NUM-REGN                         
                  ACCESS MODE IS RANDOM                                         
                  FILE STATUS IS WS-K830-FILE-STATUS.                           
                                                                                
           SELECT BP13K310 ASSIGN TO BP13K310                                   
                  ORGANIZATION IS INDEXED                                       
                  RECORD KEY IS K310-KEY-FLD                                    
                  ACCESS MODE IS RANDOM                                         
                  FILE STATUS IS WS-K310-FILE-STATUS.                           
                                                                                
           SELECT BP13KD05 ASSIGN TO BP13KD05                                   
                  ORGANIZATION IS INDEXED                                       
                  RECORD KEY IS KD05-KEY-FLD                                    
                  ACCESS MODE IS RANDOM                                         
                  FILE STATUS IS WS-KD05-FILE-STATUS.                           
                                                                                
           SELECT BP13K022 ASSIGN TO BP13K022                                   
                  ORGANIZATION IS INDEXED                                       
                  RECORD KEY IS K022-KEY-FLD                                    
                  ALTERNATE KEY IS K022-NUM-REGN                                
                  ACCESS MODE IS RANDOM                                         
                  FILE STATUS IS WS-K022-FILE-STATUS.                           
                                                                                
           SELECT BP13F880 ASSIGN TO BP13F880                                   
                  ACCESS MODE IS SEQUENTIAL.                                    
                                                                                
           SELECT BP13F800 ASSIGN TO BP13F800                                   
                  ACCESS MODE IS SEQUENTIAL.                                    
                                                                                
           SELECT BP13OUT  ASSIGN TO BP13OUT                                    
                  ACCESS MODE IS SEQUENTIAL.                                    
                                                                                
           SELECT BP13KIV  ASSIGN TO BP13KIV                                    
                  ACCESS MODE IS SEQUENTIAL.                                    
                                                                                
           SELECT BP13F120 ASSIGN TO BP13F120                                   
                  ACCESS MODE IS SEQUENTIAL.                                    
                                                                                
           SELECT BP13F130 ASSIGN TO BP13F130                                   
                  ACCESS MODE IS SEQUENTIAL.                                    
                                                                                
           SELECT BP13L350 ASSIGN TO BP13L350.                                  
                                                                                
                                                                                
      *-------------*                                                           
       DATA DIVISION.                                                           
      *-------------*                                                           
       FILE SECTION.                                                            
       FD  BP13K800                                                             
                                   RECORD CONTAINS 2000 CHARACTERS.             
       COPY BP13K800.                                                           
                                                                                
       FD  BP13K830                                                             
                                   RECORD CONTAINS 250 CHARACTERS.              
       COPY BP13K830.                                                           
                                                                                
       FD  BP13K310                                                             
                                   RECORD CONTAINS 150 CHARACTERS.              
       COPY BP13K310.                                                           
                                                                                
       FD  BP13K022.                                                            
       COPY BP13K022.                                                           
                                                                                
       FD  BP13KD05                                                             
                                   RECORD CONTAINS 500 CHARACTERS.              
       COPY BP13KD05.                                                           
                                                                                
       FD  BP13F800                                                             
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 2000 CHARACTERS              
                                   LABEL RECORDS ARE STANDARD.                  
       COPY BP13F800.                                                           
                                                                                
       FD  BP13F880                                                             
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 2000 CHARACTERS              
                                   LABEL RECORDS ARE STANDARD.                  
       COPY BP13F880.                                                           
                                                                                
       FD  BP13F120                                                             
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 150  CHARACTERS              
                                   LABEL RECORDS ARE STANDARD.                  
       COPY BP13F120.                                                           
                                                                                
       FD  BP13F130                                                             
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 150  CHARACTERS              
                                   LABEL RECORDS ARE STANDARD.                  
       COPY BP13F130.                                                           
                                                                                
       FD  BP13OUT                                                              
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 2000 CHARACTERS              
                                   LABEL RECORDS ARE STANDARD.                  
       01  BP13OUT-REC.                                                         
           05  BP13OUT-F800        PIC X(1995).                                 
           05  BP13OUT-NUM-OIC     PIC X(5).                                    
                                                                                
       FD  BP13KIV                                                              
                                   BLOCK CONTAINS 0 RECORDS                     
                                   RECORD CONTAINS 2000 CHARACTERS              
                                   LABEL RECORDS ARE STANDARD.                  
       01  BP13KIV-REC             PIC X(2000).                                 
                                                                                
       FD  BP13L350                                                             
                                   LABEL RECORDS ARE OMITTED.                   
       01  BP13L350-REC                PIC X(133).                              
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                                 
      *-----------------------*                                                 
                                                                                
       77  WS-K800-FILE-STATUS     PIC 99       VALUE ZERO.                     
       77  WS-K830-FILE-STATUS     PIC 99       VALUE ZERO.                     
       77  WS-K310-FILE-STATUS     PIC 99       VALUE ZERO.                     
       77  WS-KD05-FILE-STATUS     PIC 99       VALUE ZERO.                     
       77  WS-K022-FILE-STATUS     PIC 99       VALUE ZERO.                     
       77  WS-F880-INPUT           PIC 9(7)     VALUE ZERO.                     
       77  WS-K800-REWRITE         PIC 9(7)     VALUE ZERO.                     
       77  WS-F800-WRITE           PIC 9(7)     VALUE ZERO.                     
       77  WS-K830-REWRITE         PIC 9(7)     VALUE ZERO.                     
       77  WS-KD05-REWRITE         PIC 9(7)     VALUE ZERO.                     
       77  WS-KD05-FOUND           PIC 9(7)     VALUE ZERO.                     
       77  WS-KD05-NOTFND          PIC 9(7)     VALUE ZERO.                     
       77  WS-K310-WRITE           PIC 9(7)     VALUE ZERO.                     
       77  WS-NO-F120-WR           PIC 9(7)     VALUE ZERO.                     
       77  WS-NO-F130-WR           PIC 9(7)     VALUE ZERO.                     
       77  WS-OUT-OUTPUT           PIC 9(7)     VALUE ZERO.                     
       77  WS-KIV-OUTPUT           PIC 9(7)     VALUE ZERO.                     
       77  WS-LINE                 PIC 9(2)     VALUE 60.                       
       77  WS-PAGE                 PIC 9(3)     VALUE ZEROES.                   
       77  WS-EOF-F880             PIC X(3)     VALUE 'NO '.                    
           88  EOF-OF-F880                      VALUE 'YES'.                    
       77  WS-FND-KD05             PIC X(1)     VALUE SPACE.                    
           88 FND-KD05                          VALUE 'Y'.                      
       77  WS-AMT-USED             PIC S9(5)V99 VALUE ZEROES.                   
                                                                                
       01  WS-SEQ                  PIC 9(3)     VALUE 0.                        
                                                                                
       01  WS-STORE-FIELDS.                                                     
           05 WS-CD                PIC S9(7)V99 VALUE +0.                       
           05 WS-AMT-REFUND        PIC S9(7)V99 VALUE +0.                       
           05 WS-ADDR-UPD          PIC X(1)     VALUE SPACES.                   
                                                                                
       01  WS-TRANS-DATE.                                                       
           05 WS-TRANS-CC          PIC X(2).                                    
           05 WS-TRANS-YYMMDD.                                                  
              10 WS-TRANS-YY       PIC X(2).                                    
              10 WS-TRANS-MM       PIC X(2).                                    
              10 WS-TRANS-DD       PIC X(2).                                    
                                                                                
      *----------------------------------------*                                
      * STORE FIELDS FOR COMPUTE-REFUND-AMOUNT *                                
      *----------------------------------------*                                
       01  WS-STORE-FOR-CRA.                                                    
           05 WS-REFUND-CASH       PIC S9(7)V99 VALUE 0.                        
           05 WS-REFUND-CPF1       PIC S9(7)V99 VALUE 0.                        
           05 WS-REFUND-CPF2       PIC S9(7)V99 VALUE 0.                        
           05 WS-REFUND-CPF3       PIC S9(7)V99 VALUE 0.                        
           05 WS-REFUND-CPF4       PIC S9(7)V99 VALUE 0.                        
           05 WS-AMT-SOC-PAID-CPF1 PIC S9(7)V99 VALUE 0.                        
           05 WS-AMT-SOC-PAID-CPF2 PIC S9(7)V99 VALUE 0.                        
           05 WS-AMT-SOC-PAID-CPF3 PIC S9(7)V99 VALUE 0.                        
           05 WS-AMT-SOC-PAID-CPF4 PIC S9(7)V99 VALUE 0.                        
                                                                                
       01  WS-EDITED-DATE.                                                      
           05 WS-EDITED-DD         PIC X(2)    VALUE SPACES.                    
           05 FILLER               PIC X       VALUE '/'.                       
           05 WS-EDITED-MM         PIC X(2)    VALUE SPACES.                    
           05 FILLER               PIC X       VALUE '/'.                       
           05 WS-EDITED-CCYY       PIC X(4)    VALUE SPACES.                    
                                                                                
       01  WS-CURR-DATE.                                                        
           05 WS-CURR-CENT         PIC X(2)    VALUE SPACES.                    
           05 WS-CURR-DTE.                                                      
              10 WS-CURR-YY        PIC X(2)    VALUE SPACES.                    
              10 WS-CURR-MM        PIC X(2)    VALUE SPACES.                    
              10 WS-CURR-DD        PIC X(2)    VALUE SPACES.                    
                                                                                
       01  PRINT-ERR1.                                                          
           05 FILLER               PIC X(10)   VALUE 'BP13-L350'.               
           05 FILLER               PIC X(04)   VALUE SPACES.                    
           05 FILLER               PIC X(86)   VALUE                            
              'ERROR LIST FOR UPDATING SUB-TRANSFER INFORMATION TO SOC          
      -        'MASTER & OCCUPIER MASTER'.                                      
           05 FILLER               PIC X(7)    VALUE 'PAGE : '.                 
           05 PRINT-PAGE           PIC ZZZ9.                                    
           05 FILLER               PIC X(2)    VALUE SPACES.                    
           05 FILLER               PIC X(7)    VALUE 'DATE : '.                 
           05 PRINT-DATE1          PIC X(10)   VALUE SPACES.                    
                                                                                
       01  PRINT-ERR2.                                                          
           05 FILLER               PIC X(2)    VALUE SPACES.                    
           05 FILLER               PIC X(7)    VALUE 'REGN NO'.                 
           05 FILLER               PIC X(5)    VALUE SPACES.                    
           05 FILLER               PIC X(10)   VALUE 'REMARKS'.                 
                                                                                
       01  PRINT-ERR3.                                                          
           05 FILLER               PIC X(2)    VALUE SPACES.                    
           05 PRT-NUM-REGN         PIC X(8)    VALUE SPACES.                    
           05 FILLER               PIC X(4)    VALUE SPACES.                    
           05 PRT-REMARKS          PIC X(60)   VALUE SPACES.                    
                                                                                
       01  PRINT-HDG1.                                                          
           05 FILLER               PIC X(10)   VALUE 'BP13-L350'.               
           05 FILLER               PIC X(11)   VALUE SPACES.                    
           05 FILLER               PIC X(79)   VALUE                            
              'CONTROL LIST FOR UPDATING SOC ON SUB-TRANSFER CASES   '.         
           05 FILLER               PIC X(13)   VALUE SPACES.                    
           05 FILLER               PIC X(7)    VALUE 'DATE : '.                 
           05 PRINT-DATE           PIC X(10)   VALUE SPACES.                    
                                                                                
       01  PRINT-REC.                                                           
           05 FILLER               PIC X(10)   VALUE SPACES.                    
           05 PRINT-DESC           PIC X(30)   VALUE SPACES.                    
           05 PRINT-TOTAL          PIC ZZZZZZZ9.                                
                                                                                
                                                                                
      *------------------*                                                      
       PROCEDURE DIVISION.                                                      
      *------------------*                                                      
      ******************************************************************        
       0000-INITIALIZATION.                                                     
      ******************************************************************        
           OPEN INPUT  BP13F880                                                 
                       BP13K022                                                 
                I-O    BP13K800                                                 
                       BP13K830                                                 
                       BP13K310                                                 
                       BP13KD05                                                 
                OUTPUT BP13OUT                                                  
                       BP13KIV                                                  
                       BP13F800                                                 
                       BP13F120                                                 
                       BP13F130                                                 
                       BP13L350.                                                
                                                                                
           IF WS-K800-FILE-STATUS NOT = ZEROES AND 97                           
              DISPLAY 'BP13K800 - OPEN ERROR ' WS-K800-FILE-STATUS              
              MOVE WS-K800-FILE-STATUS TO RETURN-CODE                           
              PERFORM 9999-FINALIZATION.                                        
                                                                                
           IF WS-K830-FILE-STATUS NOT = ZEROES AND 97                           
              DISPLAY 'BP13K830 - OPEN ERROR ' WS-K830-FILE-STATUS              
              MOVE WS-K830-FILE-STATUS TO RETURN-CODE                           
              PERFORM 9999-FINALIZATION.                                        
                                                                                
           IF WS-K310-FILE-STATUS NOT = ZEROES AND 97                           
              DISPLAY 'BP13K310 - OPEN ERROR ' WS-K310-FILE-STATUS              
              MOVE WS-K310-FILE-STATUS TO RETURN-CODE                           
              PERFORM 9999-FINALIZATION.                                        
                                                                                
           IF WS-KD05-FILE-STATUS NOT = ZEROES AND 97                           
              DISPLAY 'BP13KD05 - OPEN ERROR ' WS-KD05-FILE-STATUS              
              MOVE WS-KD05-FILE-STATUS TO RETURN-CODE                           
              PERFORM 9999-FINALIZATION.                                        
                                                                                
           IF WS-K022-FILE-STATUS NOT = ZEROES AND 97                           
              DISPLAY 'BP13K022 - OPEN ERROR ' WS-K022-FILE-STATUS              
              MOVE WS-K022-FILE-STATUS TO RETURN-CODE                           
              PERFORM 9999-FINALIZATION.                                        
                                                                                
           STRING FUNCTION CURRENT-DATE(7:2) '/'                                
                  FUNCTION CURRENT-DATE(5:2) '/'                                
                  FUNCTION CURRENT-DATE(1:4)                                    
           DELIMITED BY SIZE INTO WS-EDITED-DATE.                               
           MOVE FUNCTION CURRENT-DATE TO WS-CURR-DATE                           
                                         WS-TRANS-DATE.                         
                                                                                
           MOVE WS-EDITED-DATE TO PRINT-DATE.                                   
           MOVE WS-EDITED-DATE TO PRINT-DATE1.                                  
                                                                                
                                                                                
      ******************************************************************        
       0020-MAIN-PROCESS.                                                       
      ******************************************************************        
           PERFORM 0100-READ-BP13F880 THRU 0100-EXIT.                           
           PERFORM 0200-UPDATE-SOC    THRU 0200-EXIT                            
                   UNTIL EOF-OF-F880.                                           
           PERFORM 8000-PRINT-CONTROL THRU 8000-EXIT.                           
           PERFORM 9999-FINALIZATION.                                           
                                                                                
                                                                                
      ******************************************************************        
       0100-READ-BP13F880.                                                      
      ******************************************************************        
           READ BP13F880 AT END                                                 
                MOVE 'YES' TO WS-EOF-F880                                       
                GO TO 0100-EXIT.                                                
                                                                                
           ADD 1 TO WS-F880-INPUT.                                              
                                                                                
       0100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       0200-UPDATE-SOC.                                                         
      ******************************************************************        
           IF F880-DTE-FSA-SIGNED NOT = SPACES AND LOW-VALUES                   
              MOVE ZEROES         TO WS-AMT-REFUND                              
              MOVE F880-NUM-REGN  TO K800-NUM-REGN                              
                                                                                
              READ BP13K800                                                     
                                                                                
              IF WS-K800-FILE-STATUS = ZEROES                                   
                 PERFORM 2000-UPD-LESSEE-INFO  THRU 2000-EXIT                   
                 PERFORM 2100-UPD-AMOUNT-INFO  THRU 2100-EXIT                   
                 PERFORM 2200-REWRITE-BP13K800 THRU 2200-EXIT                   
                 PERFORM 2300-UPD-ADDRESS-INFO THRU 2300-EXIT                   
                 PERFORM 2700-UPD-AHG-USED     THRU 2700-EXIT                   
              ELSE                                                              
              IF WS-K800-FILE-STATUS = '23'                                     
                 MOVE F880-NUM-REGN               TO PRT-NUM-REGN               
                 MOVE 'RECORD NOT IN SOC MASTER ' TO PRT-REMARKS                
                 PERFORM 2400-PRINT-ERR THRU 2400-EXIT                          
                 WRITE BP13KIV-REC FROM BP13F880-REC                            
                 ADD 1 TO WS-KIV-OUTPUT                                         
              ELSE                                                              
                 DISPLAY 'ERROR IN READING BP13K800'                            
                          WS-K800-FILE-STATUS                                   
                 MOVE WS-K800-FILE-STATUS TO RETURN-CODE                        
                 GO TO 9999-FINALIZATION                                        
              END-IF                                                            
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 0100-READ-BP13F880   THRU 0100-EXIT.                         
                                                                                
       0200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2000-UPD-LESSEE-INFO.                                                    
      ******************************************************************        
           WRITE BP13F800-MASTER FROM BP13K800-MASTER.                          
           ADD 1 TO WS-F800-WRITE.                                              
                                                                                
           IF F880-NUM-NRIC1-TREE NOT = K800-NUM-NRIC1                          
              MOVE F880-NUM-NRIC1-TREE TO K800-NUM-NRIC1.                       
                                                                                
           IF F880-NUM-NRIC2-TREE NOT = K800-NUM-NRIC2                          
              MOVE F880-NUM-NRIC2-TREE TO K800-NUM-NRIC2.                       
                                                                                
           IF F880-NUM-NRIC3-TREE NOT = K800-NUM-NRIC3                          
              MOVE F880-NUM-NRIC3-TREE TO K800-NUM-NRIC3.                       
                                                                                
           IF F880-NUM-NRIC4-TREE NOT = K800-NUM-NRIC4                          
              MOVE F880-NUM-NRIC4-TREE TO K800-NUM-NRIC4.                       
                                                                                
           IF F880-NUM-IDP-SCH-TREE NOT = K800-NUM-IDP-SCHEME                   
              MOVE F880-NUM-IDP-SCH-TREE TO K800-NUM-IDP-SCHEME.                
                                                                                
           IF F880-NUM-ELIG-SCH-TREE NOT = K800-NUM-ELIG-SCHEME                 
              MOVE F880-NUM-ELIG-SCH-TREE TO K800-NUM-ELIG-SCHEME.              
                                                                                
           IF F880-CDE-PR-TAG1-TREE NOT = K800-NUM-APPL1-PR                     
              MOVE F880-CDE-PR-TAG1-TREE TO K800-NUM-APPL1-PR.                  
                                                                                
           IF F880-CDE-PR-TAG2-TREE NOT = K800-NUM-APPL2-PR                     
              MOVE F880-CDE-PR-TAG2-TREE TO K800-NUM-APPL2-PR.                  
                                                                                
           IF F880-CDE-PR-TAG3-TREE NOT = K800-NUM-APPL3-PR                     
              MOVE F880-CDE-PR-TAG3-TREE TO K800-NUM-APPL3-PR.                  
                                                                                
           IF F880-CDE-PR-TAG4-TREE NOT = K800-NUM-APPL4-PR                     
              MOVE F880-CDE-PR-TAG4-TREE TO K800-NUM-APPL4-PR.                  
                                                                                
           IF F880-NUM-HOLDING-TYPE-TREE NOT = K800-NUM-HOLDING-TYPE            
              MOVE F880-NUM-HOLDING-TYPE-TREE TO K800-NUM-HOLDING-TYPE.         
                                                                                
           IF F880-NUM-SHR-BASE-TREE NOT = K800-NUM-SHR-BASE                    
              MOVE F880-NUM-SHR-BASE-TREE TO K800-NUM-SHR-BASE.                 
                                                                                
           IF F880-NUM-SHR1-TREE NOT = K800-NUM-SHR1                            
              MOVE F880-NUM-SHR1-TREE TO K800-NUM-SHR1.                         
                                                                                
           IF F880-NUM-SHR2-TREE NOT = K800-NUM-SHR2                            
              MOVE F880-NUM-SHR2-TREE TO K800-NUM-SHR2.                         
                                                                                
           IF F880-NUM-SHR3-TREE NOT = K800-NUM-SHR3                            
              MOVE F880-NUM-SHR3-TREE TO K800-NUM-SHR3.                         
                                                                                
           IF F880-NUM-SHR4-TREE NOT = K800-NUM-SHR4                            
              MOVE F880-NUM-SHR4-TREE TO K800-NUM-SHR4.                         
                                                                                
           IF F880-NUM-SUB-TRANSFER NOT = K800-NUM-SUB-TRANSFER                 
              MOVE F880-NUM-SUB-TRANSFER TO K800-NUM-SUB-TRANSFER.              
                                                                                
           IF F880-NUM-ASPF         NOT = K800-NUM-ASPF                         
              MOVE F880-NUM-ASPF    TO K800-NUM-ASPF.                           
                                                                                
           MOVE F880-DTE-FSA-SIGNED      TO K800-DTE-SUB-TRANSFER               
                                            K800-DTE-AGRMT-FOR-LEASE.           
           MOVE F880-DTE-EFF-TRANSFER    TO K800-DTE-TR-EFFECTIVE.              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2100-UPD-AMOUNT-INFO.                                                    
      ******************************************************************        
           IF F880-AMT-NEW-CD-REQ NOT NUMERIC                                   
              MOVE   ZEROES    TO  F880-AMT-NEW-CD-REQ                          
           END-IF.                                                              
                                                                                
           IF F880-AMT-NEW-CD-REQ = ZEROES AND                                  
              K800-NUM-HALF-IDP = 'D' OR 'R' OR 'S' OR 'Q' OR 'Y'               
              CONTINUE                                                          
           ELSE                                                                 
                                                                                
             IF F880-AMT-NEW-CD-REQ > K800-AMT-CD                               
                COMPUTE WS-CD = F880-AMT-NEW-CD-REQ - K800-AMT-CD               
                MOVE F880-AMT-NEW-CD-REQ TO K800-AMT-CD                         
                ADD WS-CD                TO K800-AMT-SOC-DEBTOR                 
                PERFORM 2500-CREATE-FINANCIAL-CGO-PA THRU 2500-EXIT             
                MOVE +0 TO WS-CD                                                
             END-IF                                                             
             IF F880-AMT-NEW-CD-REQ < K800-AMT-CD                               
              IF F880-NUM-EXT-SOLICITOR-SUBT NOT = 'H'                          
                COMPUTE WS-CD = F880-AMT-NEW-CD-REQ - K800-AMT-CD               
                PERFORM 2600-CREATE-FINANCIAL-PA-CGO THRU 2600-EXIT             
      *-- EG1   PERFORM 2700-CD-TRANSFER             THRU 2700-EXIT             
                MOVE F880-AMT-NEW-CD-REQ TO K800-AMT-CD                         
              END-IF                                                            
             END-IF                                                             
           END-IF.                                                              
                                                                                
      *-- LJL, IF LESS THAN , ANY UPDATE ????                                   
      *-- LJL, FOR TRANSFEROR, ZEROS THE AMOUNT ??                              
                                                                                
           IF F880-AMT-NEW-CD-REQ = ZEROES AND                                  
              K800-NUM-HALF-IDP = 'D' OR 'R' OR 'S' OR 'Q' OR 'Y'               
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 2120-CHECK-REFUND-AMT  THRU 2120-EXIT                     
                                                                                
              PERFORM 2140-FMT-SOC-REQ-AMT   THRU 2140-EXIT                     
           END-IF.                                                              
                                                                                
           PERFORM 2160-FMT-SOC-PD-AMT    THRU 2160-EXIT.                       
                                                                                
           IF F880-AMT-NEW-CD-REQ = ZEROES AND                                  
              K800-NUM-HALF-IDP = 'D' OR 'R' OR 'S' OR 'Q' OR 'Y'               
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 2180-FMT-SUSPENSE-AMT  THRU 2180-EXIT                     
           END-IF.                                                              
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *---------------------------------------------------------------*         
      * CHECK REFUND AMOUNT TO SEE IF IT IS CORRECT                   *         
      *---------------------------------------------------------------*         
      ******************************************************************        
       2120-CHECK-REFUND-AMT.                                                   
      ******************************************************************        
           IF F880-AMT-REFUND-CASH > 0                                          
              COMPUTE WS-REFUND-CASH = F880-AMT-CD-CASH                         
                                     - F880-AMT-NEW-CD-CASH-REQ                 
              IF F880-AMT-REFUND-CASH = WS-REFUND-CASH                          
                 CONTINUE                                                       
              ELSE                                                              
                 DISPLAY ' ERROR AMT-REFUND' WS-REFUND-CASH                     
                                              F880-AMT-REFUND-CASH              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F880-AMT-REFUND-CPF1 > 0                                          
              IF F880-AMT-NEW-CD-CPF1-REQ  = 0                                  
                 COMPUTE WS-REFUND-CPF1 = F880-AMT-SOC-PAID-CPF1                
              ELSE                                                              
                 COMPUTE WS-REFUND-CPF1 = F880-AMT-SOC-PAID-CPF1                
                                        - F880-AMT-LS-CPF1                      
                                        - F880-AMT-CONV-CPF1                    
                                        - F880-AMT-NEW-CD-CPF1-REQ              
              END-IF                                                            
              IF F880-AMT-REFUND-CPF1 = WS-REFUND-CPF1                          
                 CONTINUE                                                       
              ELSE                                                              
                 DISPLAY ' ERROR AMT-REFUND' WS-REFUND-CPF1                     
                                          F880-AMT-REFUND-CPF1                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F880-AMT-REFUND-CPF2 > 0                                          
              IF F880-AMT-NEW-CD-CPF2-REQ  = 0                                  
                 COMPUTE WS-REFUND-CPF2 = F880-AMT-SOC-PAID-CPF2                
              ELSE                                                              
                 COMPUTE WS-REFUND-CPF2 = F880-AMT-SOC-PAID-CPF2                
                                        - F880-AMT-LS-CPF2                      
                                        - F880-AMT-CONV-CPF2                    
                                        - F880-AMT-NEW-CD-CPF2-REQ              
              END-IF                                                            
              IF F880-AMT-REFUND-CPF2 = WS-REFUND-CPF2                          
                 CONTINUE                                                       
              ELSE                                                              
                 DISPLAY ' ERROR AMT-REFUND' WS-REFUND-CPF2                     
                                          F880-AMT-REFUND-CPF2                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F880-AMT-REFUND-CPF3 > 0                                          
              IF F880-AMT-NEW-CD-CPF3-REQ  = 0                                  
                 COMPUTE WS-REFUND-CPF3 = F880-AMT-SOC-PAID-CPF3                
              ELSE                                                              
                 COMPUTE WS-REFUND-CPF3 = F880-AMT-SOC-PAID-CPF3                
                                        - F880-AMT-LS-CPF3                      
                                        - F880-AMT-CONV-CPF3                    
                                        - F880-AMT-NEW-CD-CPF3-REQ              
              END-IF                                                            
              IF F880-AMT-REFUND-CPF3 = WS-REFUND-CPF3                          
                 CONTINUE                                                       
              ELSE                                                              
                 DISPLAY ' ERROR AMT-REFUND' WS-REFUND-CPF3                     
                                          F880-AMT-REFUND-CPF3                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F880-AMT-REFUND-CPF4 > 0                                          
              IF F880-AMT-NEW-CD-CPF4-REQ  = 0                                  
                 COMPUTE WS-REFUND-CPF4 = F880-AMT-SOC-PAID-CPF4                
              ELSE                                                              
                 COMPUTE WS-REFUND-CPF4 = F880-AMT-SOC-PAID-CPF4                
                                        - F880-AMT-LS-CPF4                      
                                        - F880-AMT-CONV-CPF4                    
                                        - F880-AMT-NEW-CD-CPF4-REQ              
              END-IF                                                            
              IF F880-AMT-REFUND-CPF4 = WS-REFUND-CPF4                          
                 CONTINUE                                                       
              ELSE                                                              
                 DISPLAY ' ERROR AMT-REFUND' WS-REFUND-CPF4                     
                                          F880-AMT-REFUND-CPF4                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
       2120-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *---------------------------------------------------------------*         
      * COMPUTE THE NEW K800 SOC REQ. AMOUNT                          *         
      *---------------------------------------------------------------*         
      ******************************************************************        
       2140-FMT-SOC-REQ-AMT.                                                    
      ******************************************************************        
           COMPUTE K800-AMT-SOC-CASH-REQ = F880-AMT-NEW-CD-CASH-REQ             
                                        + F880-AMT-LS-CASH                      
                                        + F880-AMT-CONV-CASH                    
                                        + F880-AMT-TOPUP-CD-CASH                
                                        + F880-AMT-TOPUP-CD-CASH-CGO-PA         
                                        + F880-AMT-TOPUP-SOCA-SF-CASH           
                                        + F880-AMT-TOPUP-SOCA-CF-CASH.          
                                                                                
           MOVE     F880-AMT-NEW-CD-CASH-REQ TO K800-AMT-CD-CASH.               
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-SOC-CPF1-REQ  *                                        
      *--------------------------------*                                        
           EVALUATE F880-NUM-NRIC1-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF1-REQ TO K800-AMT-CD-CPF1                
               COMPUTE K800-AMT-SOC-CPF1-REQ = F880-AMT-LS-CPF1                 
                                             + F880-AMT-CONV-CPF1               
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF2-REQ TO K800-AMT-CD-CPF1                
               COMPUTE K800-AMT-SOC-CPF1-REQ = F880-AMT-LS-CPF2                 
                                             + F880-AMT-CONV-CPF2               
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF3-REQ TO K800-AMT-CD-CPF1                
               COMPUTE K800-AMT-SOC-CPF1-REQ = F880-AMT-LS-CPF3                 
                                             + F880-AMT-CONV-CPF3               
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF4-REQ TO K800-AMT-CD-CPF1                
               COMPUTE K800-AMT-SOC-CPF1-REQ = F880-AMT-LS-CPF4                 
                                             + F880-AMT-CONV-CPF4               
           WHEN     OTHER                                                       
               MOVE ZEROES                   TO K800-AMT-CD-CPF1                
               COMPUTE K800-AMT-SOC-CPF1-REQ = 0                                
           END-EVALUATE.                                                        
                                                                                
           COMPUTE K800-AMT-SOC-CPF1-REQ = K800-AMT-SOC-CPF1-REQ                
                                        + K800-AMT-CD-CPF1                      
                                        + F880-AMT-TOPUP-CD-CPF1                
                                        + F880-AMT-TOPUP-CD-CPF1-CGO-PA         
                                        + F880-AMT-TOPUP-SOCA-SF-CPF1           
                                        + F880-AMT-TOPUP-SOCA-CF-CPF1.          
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-SOC-CPF2-REQ  *                                        
      *--------------------------------*                                        
           EVALUATE F880-NUM-NRIC2-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF1-REQ TO K800-AMT-CD-CPF2                
               COMPUTE K800-AMT-SOC-CPF2-REQ = F880-AMT-LS-CPF1                 
                                             + F880-AMT-CONV-CPF1               
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF2-REQ TO K800-AMT-CD-CPF2                
               COMPUTE K800-AMT-SOC-CPF2-REQ = F880-AMT-LS-CPF2                 
                                             + F880-AMT-CONV-CPF2               
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF3-REQ TO K800-AMT-CD-CPF2                
               COMPUTE K800-AMT-SOC-CPF2-REQ = F880-AMT-LS-CPF3                 
                                             + F880-AMT-CONV-CPF3               
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF4-REQ TO K800-AMT-CD-CPF2                
               COMPUTE K800-AMT-SOC-CPF2-REQ = F880-AMT-LS-CPF4                 
                                             + F880-AMT-CONV-CPF4               
           WHEN     OTHER                                                       
               MOVE ZEROES                   TO K800-AMT-CD-CPF2                
               COMPUTE K800-AMT-SOC-CPF2-REQ = 0                                
           END-EVALUATE.                                                        
                                                                                
           COMPUTE K800-AMT-SOC-CPF2-REQ = K800-AMT-SOC-CPF2-REQ                
                                        + K800-AMT-CD-CPF2                      
                                        + F880-AMT-TOPUP-CD-CPF2                
                                        + F880-AMT-TOPUP-CD-CPF2-CGO-PA         
                                        + F880-AMT-TOPUP-SOCA-SF-CPF2           
                                        + F880-AMT-TOPUP-SOCA-CF-CPF2.          
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-SOC-CPF3-REQ  *                                        
      *--------------------------------*                                        
           EVALUATE F880-NUM-NRIC3-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF1-REQ TO K800-AMT-CD-CPF3                
               COMPUTE K800-AMT-SOC-CPF3-REQ = F880-AMT-LS-CPF1                 
                                             + F880-AMT-CONV-CPF1               
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF2-REQ TO K800-AMT-CD-CPF3                
               COMPUTE K800-AMT-SOC-CPF3-REQ = F880-AMT-LS-CPF2                 
                                             + F880-AMT-CONV-CPF2               
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF3-REQ TO K800-AMT-CD-CPF3                
               COMPUTE K800-AMT-SOC-CPF3-REQ = F880-AMT-LS-CPF3                 
                                             + F880-AMT-CONV-CPF3               
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF4-REQ TO K800-AMT-CD-CPF3                
               COMPUTE K800-AMT-SOC-CPF3-REQ = F880-AMT-LS-CPF4                 
                                             + F880-AMT-CONV-CPF4               
           WHEN     OTHER                                                       
               MOVE ZEROES                   TO K800-AMT-CD-CPF3                
               COMPUTE K800-AMT-SOC-CPF3-REQ = 0                                
           END-EVALUATE.                                                        
                                                                                
           COMPUTE K800-AMT-SOC-CPF3-REQ = K800-AMT-SOC-CPF3-REQ                
                                        + K800-AMT-CD-CPF3                      
                                        + F880-AMT-TOPUP-CD-CPF3                
                                        + F880-AMT-TOPUP-CD-CPF3-CGO-PA         
                                        + F880-AMT-TOPUP-SOCA-SF-CPF3           
                                        + F880-AMT-TOPUP-SOCA-CF-CPF3.          
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-SOC-CPF4-REQ  *                                        
      *--------------------------------*                                        
           EVALUATE F880-NUM-NRIC4-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF1-REQ TO K800-AMT-CD-CPF4                
               COMPUTE K800-AMT-SOC-CPF4-REQ = F880-AMT-LS-CPF1                 
                                             + F880-AMT-CONV-CPF1               
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF2-REQ TO K800-AMT-CD-CPF4                
               COMPUTE K800-AMT-SOC-CPF4-REQ = F880-AMT-LS-CPF2                 
                                             + F880-AMT-CONV-CPF2               
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF3-REQ TO K800-AMT-CD-CPF4                
               COMPUTE K800-AMT-SOC-CPF4-REQ = F880-AMT-LS-CPF3                 
                                             + F880-AMT-CONV-CPF3               
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE F880-AMT-NEW-CD-CPF4-REQ TO K800-AMT-CD-CPF4                
               COMPUTE K800-AMT-SOC-CPF4-REQ = F880-AMT-LS-CPF4                 
                                             + F880-AMT-CONV-CPF4               
           WHEN     OTHER                                                       
               MOVE ZEROES                   TO K800-AMT-CD-CPF4                
               COMPUTE K800-AMT-SOC-CPF4-REQ = 0                                
           END-EVALUATE.                                                        
                                                                                
           COMPUTE K800-AMT-SOC-CPF4-REQ = K800-AMT-SOC-CPF4-REQ                
                                        + K800-AMT-CD-CPF4                      
                                        + F880-AMT-TOPUP-CD-CPF4                
                                        + F880-AMT-TOPUP-CD-CPF4-CGO-PA         
                                        + F880-AMT-TOPUP-SOCA-SF-CPF4           
                                        + F880-AMT-TOPUP-SOCA-CF-CPF4.          
                                                                                
       2140-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2160-FMT-SOC-PD-AMT.                                                     
      ******************************************************************        
      *---------------------------------------------------------------*         
      * COMPUTE THE NEW K800 SOC PAID AMOUNTS.                        *         
      *---------------------------------------------------------------*         
           IF F880-AMT-REFUND-CASH > 0                                          
              COMPUTE K800-AMT-SOC-CASH = K800-AMT-SOC-CASH                     
                                        - F880-AMT-REFUND-CASH.                 
                                                                                
           EVALUATE F880-NUM-NRIC1-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE K800-AMT-CPF1-PAID   TO WS-AMT-SOC-PAID-CPF1                
               MOVE F880-AMT-REFUND-CPF1 TO WS-REFUND-CPF1                      
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE K800-AMT-CPF2-PAID   TO WS-AMT-SOC-PAID-CPF1                
               MOVE F880-AMT-REFUND-CPF2 TO WS-REFUND-CPF1                      
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE K800-AMT-CPF3-PAID   TO WS-AMT-SOC-PAID-CPF1                
               MOVE F880-AMT-REFUND-CPF3 TO WS-REFUND-CPF1                      
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE K800-AMT-CPF4-PAID   TO WS-AMT-SOC-PAID-CPF1                
               MOVE F880-AMT-REFUND-CPF4 TO WS-REFUND-CPF1                      
           WHEN     OTHER                                                       
               MOVE ZEROES               TO WS-AMT-SOC-PAID-CPF1                
                                            WS-REFUND-CPF1                      
           END-EVALUATE.                                                        
                                                                                
           DISPLAY 'K800-BF '   K800-AMT-CPF1-PAID.                             
           DISPLAY 'AMT-CPF1-PAID '  WS-AMT-SOC-PAID-CPF1                       
                   ' '               F880-AMT-REFUND-CPF1                       
                   ' '               F880-AMT-TOPUP-SBTR-SF-CPF1                
                   ' '               F880-AMT-TOPUP-SBTR-CF-CPF1.               
                                                                                
           EVALUATE F880-NUM-NRIC2-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE K800-AMT-CPF1-PAID   TO WS-AMT-SOC-PAID-CPF2                
               MOVE F880-AMT-REFUND-CPF1 TO WS-REFUND-CPF2                      
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE K800-AMT-CPF2-PAID   TO WS-AMT-SOC-PAID-CPF2                
               MOVE F880-AMT-REFUND-CPF2 TO WS-REFUND-CPF2                      
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE K800-AMT-CPF3-PAID   TO WS-AMT-SOC-PAID-CPF2                
               MOVE F880-AMT-REFUND-CPF3 TO WS-REFUND-CPF2                      
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE K800-AMT-CPF4-PAID   TO WS-AMT-SOC-PAID-CPF2                
               MOVE F880-AMT-REFUND-CPF4 TO WS-REFUND-CPF2                      
           WHEN     OTHER                                                       
               MOVE ZEROES               TO WS-AMT-SOC-PAID-CPF2                
                                            WS-REFUND-CPF2                      
           END-EVALUATE.                                                        
                                                                                
           DISPLAY '------------- '.                                            
           DISPLAY 'K800-BF '   K800-AMT-CPF2-PAID.                             
           DISPLAY 'AMT-CPF2-PAID '  WS-AMT-SOC-PAID-CPF2                       
                   ' '               F880-AMT-REFUND-CPF2                       
                   ' '               F880-AMT-TOPUP-SBTR-SF-CPF2                
                   ' '               F880-AMT-TOPUP-SBTR-CF-CPF2.               
                                                                                
           EVALUATE F880-NUM-NRIC3-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE K800-AMT-CPF1-PAID   TO WS-AMT-SOC-PAID-CPF3                
               MOVE F880-AMT-REFUND-CPF1 TO WS-REFUND-CPF3                      
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE K800-AMT-CPF2-PAID   TO WS-AMT-SOC-PAID-CPF3                
               MOVE F880-AMT-REFUND-CPF2 TO WS-REFUND-CPF3                      
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE K800-AMT-CPF3-PAID   TO WS-AMT-SOC-PAID-CPF3                
               MOVE F880-AMT-REFUND-CPF3 TO WS-REFUND-CPF3                      
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE K800-AMT-CPF4-PAID   TO WS-AMT-SOC-PAID-CPF3                
               MOVE F880-AMT-REFUND-CPF4 TO WS-REFUND-CPF3                      
           WHEN     OTHER                                                       
               MOVE ZEROES               TO WS-AMT-SOC-PAID-CPF3                
               MOVE ZEROES               TO WS-REFUND-CPF3                      
           END-EVALUATE.                                                        
                                                                                
           EVALUATE F880-NUM-NRIC4-TREE                                         
           WHEN     F880-NUM-NRIC1-TROR                                         
               MOVE K800-AMT-CPF1-PAID   TO WS-AMT-SOC-PAID-CPF4                
               MOVE F880-AMT-REFUND-CPF1 TO WS-REFUND-CPF4                      
           WHEN     F880-NUM-NRIC2-TROR                                         
               MOVE K800-AMT-CPF2-PAID   TO WS-AMT-SOC-PAID-CPF4                
               MOVE F880-AMT-REFUND-CPF2 TO WS-REFUND-CPF4                      
           WHEN     F880-NUM-NRIC3-TROR                                         
               MOVE K800-AMT-CPF3-PAID   TO WS-AMT-SOC-PAID-CPF4                
               MOVE F880-AMT-REFUND-CPF3 TO WS-REFUND-CPF4                      
           WHEN     F880-NUM-NRIC4-TROR                                         
               MOVE K800-AMT-CPF4-PAID   TO WS-AMT-SOC-PAID-CPF4                
               MOVE F880-AMT-REFUND-CPF4 TO WS-REFUND-CPF4                      
           WHEN     OTHER                                                       
               MOVE ZEROES               TO WS-AMT-SOC-PAID-CPF4                
               MOVE ZEROES               TO WS-REFUND-CPF4                      
           END-EVALUATE.                                                        
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-CPF1-PAID     *                                        
      *--------------------------------*                                        
              COMPUTE K800-AMT-CPF1-PAID = WS-AMT-SOC-PAID-CPF1                 
                                         - WS-REFUND-CPF1.                      
                                                                                
           DISPLAY 'K800-AF '   K800-AMT-CPF1-PAID.                             
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-CPF2-PAID     *                                        
      *--------------------------------*                                        
              COMPUTE K800-AMT-CPF2-PAID = WS-AMT-SOC-PAID-CPF2                 
                                         - WS-REFUND-CPF2.                      
           DISPLAY 'K800-AF '   K800-AMT-CPF2-PAID.                             
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-CPF3-PAID     *                                        
      *--------------------------------*                                        
              COMPUTE K800-AMT-CPF3-PAID = WS-AMT-SOC-PAID-CPF3                 
                                         - WS-REFUND-CPF3.                      
                                                                                
      *--------------------------------*                                        
      * COMPUTE K800-AMT-CPF4-PAID     *                                        
      *--------------------------------*                                        
              COMPUTE K800-AMT-CPF4-PAID = WS-AMT-SOC-PAID-CPF4                 
                                         - WS-REFUND-CPF4.                      
                                                                                
       2160-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2180-FMT-SUSPENSE-AMT.                                                   
      ******************************************************************        
           INITIALIZE K800-AMT-SUSPENSE-CASH                                    
                      K800-AMT-SUSPENSE-CPF1                                    
                      K800-AMT-SUSPENSE-CPF2                                    
                      K800-AMT-SUSPENSE-CPF3                                    
                      K800-AMT-SUSPENSE-CPF4.                                   
                                                                                
       2180-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2200-REWRITE-BP13K800.                                                   
      ******************************************************************        
           MOVE WS-CURR-DATE    TO K800-DTE-UPDATE.                             
           MOVE F880-NUM-USERID TO K800-NUM-USERID.                             
                                                                                
           REWRITE BP13K800-MASTER.                                             
                                                                                
           IF WS-K800-FILE-STATUS NOT = ZEROES                                  
              DISPLAY 'ERROR IN UPDATING BP13K800 ' WS-K800-FILE-STATUS         
              GO TO 9999-FINALIZATION.                                          
                                                                                
           ADD 1 TO WS-K800-REWRITE.                                            
                                                                                
           PERFORM 3000-WRITE-BP13OUT THRU 3000-EXIT.                           
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2300-UPD-ADDRESS-INFO.                                                   
                                                                                
           MOVE SPACES              TO  WS-ADDR-UPD.                            
           MOVE F880-NUM-REGN       TO  K830-NUM-REGN.                          
           READ BP13K830 KEY IS K830-NUM-REGN                                   
                                                                                
           IF WS-K830-FILE-STATUS = ZEROES                                      
              PERFORM 2301-UPDATE-ADDRESS THRU 2301-EXIT                        
           ELSE                                                                 
              DISPLAY 'READ-ERROR BP13K830 ' WS-K830-FILE-STATUS                
              DISPLAY 'K830-NUM-REGN = ' K830-NUM-REGN.                         
                                                                                
       2300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2301-UPDATE-ADDRESS.                                                     
      ******************************************************************        
           IF K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES                         
              IF F880-NUM-MAIL-BLK(1:4) NOT = K830-NUM-MAIN-BLK                 
              OR F880-NUM-MAIL-BLK(5:1) NOT = K830-NUM-SUB-BLK                  
              OR F880-NUM-MAIL-LVL NOT = K830-NUM-LVL-NUM                       
              OR F880-NUM-MAIL-UNIT NOT = K830-NUM-HSEMAIN                      
              OR F880-NUM-MAIL-SUB-UNIT  NOT = K830-NUM-HSESUB                  
              OR F880-NUM-MAIL-STREET-NAME  NOT = K830-NME-STREET-BLDG          
              OR F880-NUM-MAIL-POSTAL-CDE NOT = K830-NUM-POSTAL                 
                  MOVE 'R' TO WS-ADDR-UPD                                       
              ELSE                                                              
                  MOVE ' ' TO WS-ADDR-UPD                                       
           ELSE                                                                 
              IF F880-NUM-MAIL-BLK(1:4) NOT = K830-NUM-MAIL-BLK                 
              OR F880-NUM-MAIL-BLK(5:1) NOT = K830-NUM-MAIL-SUB-BLK             
              OR F880-NUM-MAIL-LVL NOT = K830-NUM-MAIL-LVL-NUM                  
              OR F880-NUM-MAIL-UNIT NOT = K830-NUM-MAIL-HSEMAIN                 
              OR F880-NUM-MAIL-SUB-UNIT  NOT = K830-NUM-MAIL-HSESUB             
              OR F880-NUM-MAIL-STREET-NAME  NOT = K830-NME-MAIL-STR-BLDG        
              OR F880-NUM-MAIL-POSTAL-CDE                                       
                               NOT = K830-NUM-MAIL-POSTAL                       
                  MOVE 'M' TO WS-ADDR-UPD                                       
              ELSE                                                              
                  MOVE ' ' TO WS-ADDR-UPD.                                      
                                                                                
           IF WS-ADDR-UPD = 'M'                                                 
              MOVE F880-NUM-MAIL-BLK(1:4) TO K830-NUM-MAIL-BLK                  
              MOVE F880-NUM-MAIL-BLK(5:1) TO K830-NUM-MAIL-SUB-BLK              
              MOVE F880-NUM-MAIL-LVL      TO K830-NUM-MAIL-LVL-NUM              
              MOVE F880-NUM-MAIL-UNIT     TO K830-NUM-MAIL-HSEMAIN              
              MOVE F880-NUM-MAIL-SUB-UNIT TO K830-NUM-MAIL-HSESUB               
              MOVE F880-NUM-MAIL-STREET-NAME TO K830-NME-MAIL-STR-BLDG          
              MOVE F880-NUM-MAIL-POSTAL-CDE TO K830-NUM-MAIL-POSTAL             
              IF F880-NUM-MAIL-ADDR-TYPE = 'H'                                  
                  MOVE '#' TO K830-NUM-MAIL-LVL-CHAR                            
                  MOVE '-' TO K830-NUM-MAIL-LVL-DASH                            
              ELSE                                                              
                  MOVE SPACES TO K830-NUM-MAIL-LVL-CHAR                         
                  MOVE SPACES TO K830-NUM-MAIL-LVL-DASH                         
              END-IF                                                            
           PERFORM 2302-REWRITE-BP13K830 THRU 2302-EXIT.                        
                                                                                
           IF WS-ADDR-UPD = 'R'                                                 
              MOVE F880-NUM-MAIL-BLK(1:4) TO K830-NUM-MAIN-BLK                  
              MOVE F880-NUM-MAIL-BLK(5:1) TO K830-NUM-SUB-BLK                   
              MOVE F880-NUM-MAIL-LVL      TO K830-NUM-LVL-NUM                   
              MOVE F880-NUM-MAIL-UNIT     TO K830-NUM-HSEMAIN                   
              MOVE F880-NUM-MAIL-SUB-UNIT TO K830-NUM-HSESUB                    
              MOVE F880-NUM-MAIL-STREET-NAME TO K830-NME-STREET-BLDG            
              MOVE F880-NUM-MAIL-POSTAL-CDE TO K830-NUM-POSTAL                  
              IF F880-NUM-MAIL-ADDR-TYPE = 'H'                                  
                  MOVE '#' TO K830-NUM-LVL-CHAR                                 
                  MOVE '-' TO K830-NUM-LVL-DASH                                 
              ELSE                                                              
                  IF F880-NUM-MAIL-LVL IS NUMERIC                               
                      MOVE '#' TO K830-NUM-LVL-CHAR                             
                      MOVE '-' TO K830-NUM-LVL-DASH                             
                  ELSE                                                          
                      MOVE SPACES TO K830-NUM-LVL-CHAR                          
                      MOVE SPACES TO K830-NUM-LVL-DASH                          
                  END-IF                                                        
              END-IF                                                            
           PERFORM 2302-REWRITE-BP13K830 THRU 2302-EXIT.                        
                                                                                
       2301-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2302-REWRITE-BP13K830.                                                   
      ******************************************************************        
           REWRITE BP13K830-REC                                                 
                                                                                
           IF WS-K830-FILE-STATUS = 00                                          
              ADD 1       TO WS-K830-REWRITE                                    
              PERFORM 2303-WRITE-K310-REC THRU 2303-EXIT                        
           ELSE                                                                 
              DISPLAY 'ERROR-REWRITE, BP13K830 = ' WS-K830-FILE-STATUS          
              DISPLAY 'BP13K830-KEY = ' K830-KEY-FLD.                           
                                                                                
       2302-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2303-WRITE-K310-REC.                                                     
      ******************************************************************        
           MOVE F880-NUM-REGN             TO K310-REGN-NO.                      
           MOVE 'PA'                      TO  K310-CDE-TRANS.                   
           MOVE  F880-NUM-SCH-ACC         TO K310-SCH-ACC.                      
           MOVE F880-DTE-FSA-SIGNED       TO K310-DTE-TRANS.                    
           MOVE K800-NUM-NEW-TOWN         TO K310-CDE-NT.                       
           MOVE K800-NUM-FLAT-TYPE        TO K310-CDE-FLAT-TYPE.                
           MOVE F880-NUM-MAIL-BLK         TO K310-NUM-BLK.                      
           MOVE F880-NUM-MAIL-LVL         TO K310-NUM-LEVEL.                    
           MOVE F880-NUM-MAIL-UNIT        TO K310-NUM-MAIN.                     
           MOVE F880-NUM-MAIL-STREET-NAME TO K310-NME-STREET.                   
           MOVE F880-NUM-MAIL-POSTAL-CDE  TO K310-NUM-POSTAL.                   
           MOVE K800-NUM-ZONE             TO K310-NUM-ZONE.                     
           MOVE F880-DTE-UPDATE           TO K310-DTE-UPDATE.                   
           MOVE F880-NUM-USERID           TO K310-USERID.                       
                                                                                
           WRITE BP13K310-TRANS-REC.                                            
                                                                                
           IF WS-K310-FILE-STATUS = ZEROES                                      
              ADD 1       TO WS-K310-WRITE                                      
           ELSE                                                                 
              DISPLAY 'ERROR IN UPDATING BP13K310 ' WS-K310-FILE-STATUS         
              DISPLAY 'BP13K310 KEY FLD = ' K310-KEY-FLD.                       
                                                                                
       2303-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2400-PRINT-ERR.                                                          
      ******************************************************************        
           IF WS-LINE > 55                                                      
              ADD 1 TO WS-PAGE                                                  
              MOVE WS-PAGE TO PRINT-PAGE                                        
              WRITE BP13L350-REC FROM PRINT-ERR1 AFTER 1                        
              WRITE BP13L350-REC FROM PRINT-ERR2 AFTER 3                        
              MOVE 0 TO WS-LINE                                                 
              MOVE SPACES TO BP13L350-REC                                       
              WRITE BP13L350-REC AFTER 2.                                       
           WRITE BP13L350-REC FROM PRINT-ERR3 AFTER 2.                          
           ADD 1 TO WS-LINE.                                                    
                                                                                
       2400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2500-CREATE-FINANCIAL-CGO-PA.                                            
      ******************************************************************        
              IF  WS-CD       NOT = 0                                           
              MOVE  SPACES             TO BP13F120-CASHTRAN                     
              MOVE F880-NUM-REGN       TO F120-NUM-REGN                         
              MOVE F880-NUM-SCH-ACC    TO F120-NUM-SCH-ACCT                     
              MOVE  WS-TRANS-DATE      TO F120-DTE-POST                         
              MOVE  F880-DTE-UPDATE    TO F120-DTE-TRANS                        
              MOVE '21'                TO F120-CDE-TRANS-TYPE                   
              MOVE 'CD'                TO F120-CDE-PAYMENT-TYPE                 
              MOVE WS-CD               TO F120-AMT-RECEIPT                      
              MOVE 'C'                 TO F120-CDE-CRDR                         
              ADD   1                  TO WS-NO-F120-WR                         
              ADD  1                   TO WS-SEQ                                
              MOVE WS-SEQ              TO F120-COUNT-HISTORY                    
              WRITE BP13F120-CASHTRAN                                           
              MOVE  SPACES               TO BP13F130-REC                        
              MOVE  '21'                 TO F130-TRANS-TYPE                     
              MOVE  'CD'                 TO F130-CDE-PAYMENT-TYPE               
              MOVE  WS-TRANS-DATE        TO F130-DTE-POST                       
              MOVE  WS-CD                TO F130-AMT-RECEIPT                    
              ADD   1                    TO WS-NO-F130-WR                       
              MOVE F880-NUM-REGN         TO F130-NUM-REGN                       
              MOVE  F880-DTE-UPDATE      TO F130-DTE-TRANS                      
              MOVE ZEROS                 TO F130-COUNT-HISTORY                  
              WRITE BP13F130-REC.                                               
                                                                                
           IF WS-CD NOT = 0                                                     
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE F880-NUM-REGN         TO F120-NUM-REGN                       
              MOVE F880-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT                   
              MOVE  WS-TRANS-DATE        TO F120-DTE-POST                       
              MOVE  F880-DTE-UPDATE      TO F120-DTE-TRANS                      
              MOVE '22'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'SOC'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE WS-CD                 TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              ADD   1                    TO WS-NO-F120-WR                       
              ADD  1                     TO WS-SEQ                              
              MOVE WS-SEQ                TO F120-COUNT-HISTORY                  
              WRITE BP13F120-CASHTRAN                                           
              MOVE  SPACES               TO BP13F130-REC                        
              MOVE  '22'                 TO F130-TRANS-TYPE                     
              MOVE  'SOC'                TO F130-CDE-PAYMENT-TYPE               
              MOVE  WS-TRANS-DATE        TO F130-DTE-POST                       
              MOVE  F880-DTE-UPDATE      TO F130-DTE-TRANS                      
              MOVE  WS-CD                TO F130-AMT-RECEIPT                    
              ADD   1                    TO WS-NO-F130-WR                       
              MOVE F880-NUM-REGN         TO F130-NUM-REGN                       
              MOVE ZEROS                 TO F130-COUNT-HISTORY                  
              WRITE BP13F130-REC.                                               
                                                                                
              MOVE 0 TO WS-SEQ.                                                 
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2600-CREATE-FINANCIAL-PA-CGO.                                            
      ******************************************************************        
              IF WS-CD < 0                                                      
              MOVE  SPACES             TO BP13F120-CASHTRAN                     
              MOVE F880-NUM-REGN       TO F120-NUM-REGN                         
              MOVE F880-NUM-SCH-ACC    TO F120-NUM-SCH-ACCT                     
              MOVE  WS-TRANS-DATE      TO F120-DTE-POST                         
              MOVE  F880-DTE-UPDATE TO F120-DTE-TRANS                           
              MOVE '26'                TO F120-CDE-TRANS-TYPE                   
              MOVE 'CD'                TO F120-CDE-PAYMENT-TYPE                 
              MOVE WS-CD               TO F120-AMT-RECEIPT                      
              MOVE 'D'                 TO F120-CDE-CRDR                         
              ADD   1                  TO WS-NO-F120-WR                         
              ADD  1                   TO WS-SEQ                                
              MOVE WS-SEQ              TO F120-COUNT-HISTORY                    
              WRITE BP13F120-CASHTRAN                                           
              MOVE  SPACES             TO BP13F120-CASHTRAN                     
              MOVE F880-NUM-REGN       TO F120-NUM-REGN                         
              MOVE F880-NUM-SCH-ACC    TO F120-NUM-SCH-ACCT                     
              MOVE  WS-TRANS-DATE      TO F120-DTE-POST                         
              MOVE  F880-DTE-UPDATE TO F120-DTE-TRANS                           
              MOVE '25'                TO F120-CDE-TRANS-TYPE                   
              MOVE 'SUS'               TO F120-CDE-PAYMENT-TYPE                 
              COMPUTE F120-AMT-RECEIPT = WS-CD * -1                             
              MOVE 'C'                 TO F120-CDE-CRDR                         
              ADD   1                  TO WS-NO-F120-WR                         
              ADD  1                   TO WS-SEQ                                
              MOVE WS-SEQ              TO F120-COUNT-HISTORY                    
              WRITE BP13F120-CASHTRAN                                           
              MOVE SPACES               TO BP13F130-REC                         
              MOVE '26'                 TO F130-TRANS-TYPE                      
              MOVE 'CD '                TO F130-CDE-PAYMENT-TYPE                
              MOVE F880-DTE-UPDATE TO F130-DTE-TRANS                            
              MOVE  WS-TRANS-DATE       TO F130-DTE-POST                        
              MOVE WS-CD                TO F130-AMT-RECEIPT                     
              ADD  1                    TO WS-NO-F130-WR                        
              MOVE F880-NUM-REGN        TO F130-NUM-REGN                        
              MOVE ZEROS                TO F130-COUNT-HISTORY                   
              WRITE BP13F130-REC                                                
              MOVE SPACES               TO BP13F130-REC                         
              MOVE '25'                 TO F130-TRANS-TYPE                      
              MOVE 'SUS'                TO F130-CDE-PAYMENT-TYPE                
              MOVE F880-DTE-UPDATE TO F130-DTE-TRANS                            
              MOVE  WS-TRANS-DATE       TO F130-DTE-POST                        
              COMPUTE F130-AMT-RECEIPT = WS-CD * -1                             
              ADD  1                    TO WS-NO-F130-WR                        
              MOVE F880-NUM-REGN        TO F130-NUM-REGN                        
              MOVE ZEROS                TO F130-COUNT-HISTORY                   
              WRITE BP13F130-REC.                                               
                                                                                
              MOVE 0 TO WS-SEQ.                                                 
              MOVE 0 TO WS-CD.                                                  
                                                                                
       2600-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2700-UPD-AHG-USED.                                                       
      ******************************************************************        
                                                                                
           IF F880-NUM-NRIC1-TREE NOT = SPACES AND LOW-VALUES                   
              MOVE F880-NUM-REGN                 TO KD05-NUM-REGN               
              MOVE F880-NUM-NRIC1-TREE           TO KD05-NUM-NRIC               
              PERFORM 2710-READ-BP13KD05       THRU 2710-EXIT                   
              IF FND-KD05                                                       
                 PERFORM 2720-COMPUTE-AHG-USED THRU 2720-EXIT                   
                 PERFORM 2730-REWRITE-BP13KD05 THRU 2730-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F880-NUM-NRIC2-TREE NOT = SPACES AND LOW-VALUES                   
              MOVE F880-NUM-REGN                 TO KD05-NUM-REGN               
              MOVE F880-NUM-NRIC2-TREE           TO KD05-NUM-NRIC               
              PERFORM 2710-READ-BP13KD05       THRU 2710-EXIT                   
              IF FND-KD05                                                       
                 PERFORM 2720-COMPUTE-AHG-USED THRU 2720-EXIT                   
                 PERFORM 2730-REWRITE-BP13KD05 THRU 2730-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F880-NUM-NRIC3-TREE NOT = SPACES AND LOW-VALUES                   
              MOVE F880-NUM-REGN                 TO KD05-NUM-REGN               
              MOVE F880-NUM-NRIC3-TREE           TO KD05-NUM-NRIC               
              PERFORM 2710-READ-BP13KD05       THRU 2710-EXIT                   
              IF FND-KD05                                                       
                 PERFORM 2720-COMPUTE-AHG-USED THRU 2720-EXIT                   
                 PERFORM 2730-REWRITE-BP13KD05 THRU 2730-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F880-NUM-NRIC4-TREE NOT = SPACES AND LOW-VALUES                   
              MOVE F880-NUM-REGN                 TO KD05-NUM-REGN               
              MOVE F880-NUM-NRIC4-TREE           TO KD05-NUM-NRIC               
              PERFORM 2710-READ-BP13KD05       THRU 2710-EXIT                   
              IF FND-KD05                                                       
                 PERFORM 2720-COMPUTE-AHG-USED THRU 2720-EXIT                   
                 PERFORM 2730-REWRITE-BP13KD05 THRU 2730-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
       2700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2710-READ-BP13KD05.                                                      
      ******************************************************************        
                                                                                
           MOVE 'N'                              TO WS-FND-KD05.                
                                                                                
           READ BP13KD05.                                                       
                                                                                
           IF WS-KD05-FILE-STATUS = 00 OR 02                                    
              MOVE 'Y'                           TO WS-FND-KD05                 
              ADD 1                              TO WS-KD05-FOUND               
           ELSE                                                                 
              IF WS-KD05-FILE-STATUS = 23                                       
                 ADD 1                           TO WS-KD05-NOTFND              
                 DISPLAY 'BP13KD05 - RECORD NOT FND , KEY : '                   
                         KD05-KEY-FLD                                           
              ELSE                                                              
                 DISPLAY 'BP13KD05 - ERROR READING : '                          
                         WS-KD05-FILE-STATUS                                    
                 GO TO 9999-FINALIZATION                                        
              END-IF                                                            
           END-IF.                                                              
                                                                                
       2710-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2720-COMPUTE-AHG-USED.                                                   
      ******************************************************************        
                                                                                
           MOVE ZEROES                       TO WS-AMT-USED.                    
                                                                                
           EVALUATE KD05-NUM-NRIC                                               
               WHEN F880-NUM-NRIC1-TREE                                         
                    COMPUTE WS-AMT-USED =                                       
                            F880-AMT-TOPUP-CD-CPF1       +                      
                            F880-AMT-TOPUP-SOCA-SF-CPF1  +                      
                            F880-AMT-TOPUP-SOCA-CF-CPF1  +                      
                            F880-AMT-TOPUP-INTEREST-CPF1 +                      
                            F880-AMT-TOPUP-CD-CPF1-CGO-PA                       
                                                                                
               WHEN F880-NUM-NRIC2-TREE                                         
                    COMPUTE WS-AMT-USED =                                       
                            F880-AMT-TOPUP-CD-CPF2       +                      
                            F880-AMT-TOPUP-SOCA-SF-CPF2  +                      
                            F880-AMT-TOPUP-SOCA-CF-CPF2  +                      
                            F880-AMT-TOPUP-INTEREST-CPF2 +                      
                            F880-AMT-TOPUP-CD-CPF2-CGO-PA                       
                                                                                
               WHEN F880-NUM-NRIC3-TREE                                         
                    COMPUTE WS-AMT-USED =                                       
                            F880-AMT-TOPUP-CD-CPF3       +                      
                            F880-AMT-TOPUP-SOCA-SF-CPF3  +                      
                            F880-AMT-TOPUP-SOCA-CF-CPF3  +                      
                            F880-AMT-TOPUP-INTEREST-CPF3 +                      
                            F880-AMT-TOPUP-CD-CPF3-CGO-PA                       
                                                                                
               WHEN F880-NUM-NRIC4-TREE                                         
                    COMPUTE WS-AMT-USED =                                       
                            F880-AMT-TOPUP-CD-CPF4       +                      
                            F880-AMT-TOPUP-SOCA-SF-CPF4  +                      
                            F880-AMT-TOPUP-SOCA-CF-CPF4  +                      
                            F880-AMT-TOPUP-INTEREST-CPF4 +                      
                            F880-AMT-TOPUP-CD-CPF4-CGO-PA                       
                                                                                
           END-EVALUATE.                                                        
                                                                                
           IF WS-AMT-USED > KD05-AMT-AHG-GRANT                                  
              MOVE KD05-AMT-AHG-GRANT      TO KD05-AMT-AHG-USED                 
           ELSE                                                                 
              MOVE WS-AMT-USED             TO KD05-AMT-AHG-USED                 
           END-IF.                                                              
                                                                                
       2720-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2730-REWRITE-BP13KD05.                                                   
      ******************************************************************        
                                                                                
           REWRITE BP13KD05-REC.                                                
                                                                                
           IF WS-KD05-FILE-STATUS = 00                                          
              ADD 1                        TO WS-KD05-REWRITE                   
           ELSE                                                                 
              DISPLAY 'BP13KD05 - ERROR REWRITING ,KEY: ' KD05-KEY-FLD          
                      ' ,STATUS: ' WS-KD05-FILE-STATUS                          
           END-IF.                                                              
                                                                                
       2730-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       3000-WRITE-BP13OUT.                                                      
      ******************************************************************        
                                                                                
           MOVE BP13F880-REC          TO   BP13OUT-REC.                         
                                                                                
           PERFORM 3100-READ-BP13K022 THRU 3100-EXIT.                           
                                                                                
           WRITE BP13OUT-REC.                                                   
           ADD 1 TO WS-OUT-OUTPUT.                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       3100-READ-BP13K022.                                                      
      ******************************************************************        
                                                                                
            MOVE SPACES          TO   K022-KEY-FLD.                             
            MOVE F880-NUM-REGN   TO   K022-NUM-REGN.                            
                                                                                
            READ BP13K022 KEY IS K022-NUM-REGN.                                 
                                                                                
            EVALUATE WS-K022-FILE-STATUS                                        
            WHEN 00                                                             
            WHEN 02                                                             
               MOVE K022-NUM-OIC TO   BP13OUT-NUM-OIC                           
            WHEN 23                                                             
               DISPLAY 'BP13K022 REC NOT FOUND : ' K022-NUM-REGN                
               MOVE SPACES       TO   BP13OUT-NUM-OIC                           
            WHEN OTHER                                                          
               DISPLAY 'BP13K022 - ERROR READING : ' WS-K022-FILE-STATUS        
               GO TO 9999-FINALIZATION                                          
            END-EVALUATE.                                                       
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       8000-PRINT-CONTROL.                                                      
      ******************************************************************        
           WRITE BP13L350-REC FROM PRINT-HDG1 AFTER 1.                          
                                                                                
           MOVE SPACES TO BP13L350-REC.                                         
           WRITE BP13L350-REC AFTER 2.                                          
                                                                                
           MOVE 'CONTROL COUNT FOR BP13C350' TO PRINT-DESC.                     
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-F880-INPUT  TO PRINT-TOTAL.                                  
           MOVE 'SUB-TRANSFER-BP13F880 READ   : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-K800-REWRITE TO PRINT-TOTAL.                                 
           MOVE 'UPDATE SOC MASTER BP13K800   : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-F800-WRITE TO PRINT-TOTAL.                                   
           MOVE 'BF IMAGE SOC REC -BP13F800   : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-KD05-FOUND TO PRINT-TOTAL.                                   
           MOVE 'CPFGRANT REC FND -BP13KD05   : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-KD05-NOTFND TO PRINT-TOTAL.                                  
           MOVE 'CPFGRANT REC NOTFND-BP13KD05 : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-KD05-REWRITE TO PRINT-TOTAL.                                 
           MOVE 'AHG USED UPDATED - BP13KD05  : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-OUT-OUTPUT  TO PRINT-TOTAL.                                  
           MOVE 'SUB-TRANSFER- VALID REC      : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-KIV-OUTPUT  TO PRINT-TOTAL.                                  
           MOVE 'ERR-SUB-TRANSFER- KIV OUTPUT : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-K830-REWRITE  TO PRINT-TOTAL.                                
           MOVE 'ADDRESS UPD - BP13K830 UPD   : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-K310-WRITE TO PRINT-TOTAL.                                   
           MOVE 'TRANS FILE - BP13K310 OUTPUT : ' TO PRINT-DESC.                
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-NO-F120-WR TO PRINT-TOTAL.                                   
           MOVE 'SATRANS FILE - BP13F120 OUTPUT : ' TO PRINT-DESC.              
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
           MOVE WS-NO-F130-WR TO PRINT-TOTAL.                                   
           MOVE 'SATRANS FILE - BP13F130 OUTPUT : ' TO PRINT-DESC.              
           WRITE BP13L350-REC FROM PRINT-REC AFTER 2.                           
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       9999-FINALIZATION.                                                       
      ******************************************************************        
           CLOSE      BP13F880                                                  
                      BP13K022                                                  
                      BP13K800                                                  
                      BP13K830                                                  
                      BP13K310                                                  
                      BP13KD05                                                  
                      BP13OUT                                                   
                      BP13KIV                                                   
                      BP13F800                                                  
                      BP13F120                                                  
                      BP13F130                                                  
                      BP13L350.                                                 
                                                                                
           IF WS-K800-FILE-STATUS NOT = ZEROES                                  
              DISPLAY 'BP13K800 - CLOSE ERROR ' WS-K800-FILE-STATUS             
              MOVE WS-K800-FILE-STATUS TO RETURN-CODE.                          
                                                                                
           IF WS-K830-FILE-STATUS NOT = ZEROES                                  
              DISPLAY 'BP13K830 - CLOSE ERROR ' WS-K830-FILE-STATUS             
              MOVE WS-K830-FILE-STATUS TO RETURN-CODE.                          
                                                                                
           IF WS-K310-FILE-STATUS NOT = ZEROES                                  
              DISPLAY 'BP13K310 - CLOSE ERROR ' WS-K310-FILE-STATUS             
              MOVE WS-K310-FILE-STATUS TO RETURN-CODE.                          
                                                                                
           IF WS-KD05-FILE-STATUS NOT = ZEROES                                  
              DISPLAY 'BP13KD05 - CLOSE ERROR ' WS-KD05-FILE-STATUS             
              MOVE WS-KD05-FILE-STATUS TO RETURN-CODE.                          
                                                                                
           IF WS-K022-FILE-STATUS NOT = ZEROES                                  
              DISPLAY 'BP13K022 - CLOSE ERROR ' WS-K022-FILE-STATUS             
              MOVE WS-K022-FILE-STATUS TO RETURN-CODE.                          
                                                                                
           STOP RUN.                                                            
      *---------------*                                                         
      * END OF SOURCE *                                                         
      *---------------*                                                         
