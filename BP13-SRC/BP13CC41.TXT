       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CC41.                                                 
      *AUTHOR.        ED1.                                                      
      *DATE-WRITTEN.  29/11/2006.                                               
      ******************************************************************        
      *                SYSTEM OF COMMITMENT (BP13)                     *        
      ******************************************************************        
      * OBJECTIVE : TO PRINT REPORT FOR CASES RETRIEVED FROM BP13CC40  *        
      *                                                                *        
      *             1) (P13LC41A) ELIGIBLE CASES -                     *        
      *                S&P RECVD BUT S&P APPT DATE/TIME IS BLANK       *        
      *                & ACCEPTANCE LTR DTE & GRANT APP DTE NOT BLANK  *        
      *                                                                *        
      *             2) (P13LC41B) NON-ELIGIBLE CASES -                 *        
      *                S&P RECVD BUT S&P APPT DATE/TIME IS BLANK       *        
      *                & ACCEPTANCE LTR DTE OR GRANT APP DTE BLANK     *        
      *                                                                *        
      *             3) (P13LC41C) SIGNED S&P RETURN DATE BLANK         *        
      *                                                                *        
      *             4) (P13LC41E) SIGNED S&P RETURN DATE AVAILABLE     *        
      *                                                                *        
      *             5) (P13FD78A) CASES FOR BP13SC12 REPORT            *        
      *                                                                *        
      *                                                                *        
      * INPUT  FILE  : BP13FD78                                        *        
      * OUTPUT FILES : P13LC41A                                        *        
      *                P13LC41B                                        *        
      *                P13LC41C                                        *        
      *                P13LC41D                                        *        
      *                P13LC41E                                        *        
      *                P13FD78A                                        *        
      *                                                                *        
      * CHG-NO    BY    ON    - DESCRIPTION                            *        
      * ---------------------------------                              *        
      * BP132937 ED1 29/11/06   NEW PROGRAM                            *        
      * BP133137 ED1 29/10/07   P13LC41A - LN-TAG = H AND S&P RCVD ONLY*        
      * BP133137 ED1 27/03/08   REMOVE APPROVE & ACCEPT DATE CHECK     *        
      *                         IN PRINTING P13LC41A & P13LC41B        *        
      * BP133137 ED1 04/04/08   ADD P13FD78A OUTPUT & INCLUDE LN-TAG   *        
      *                         "P" IN PRINTING P13LC41A               *        
      * BP133316 ED1 11/04/08   REMOVE DISPLAY WHEN CASE IS NOT ELIG   *        
      * BP133573 JB8 18/05/09   TO SEPARATE REPORT BY STREET NAME      *        
      * BP133591 JB8 30/09/11   TO PRINT FOOTNOTE FOR BP13LC41D        *        
      * BP134779 13/06/13 PCL4  TO CONVERT THE REPORT TO SENDMAIL      *        
      * BP135537 RJB1 04/05/15  CHANGE THE EMAIL RECIPIENT FROM NICKNAME        
      *                         INTO COMPLETE NAME                     *        
      * BP136477 RJB1 18/10/16  REPLACE LIM KIM HUAT TO CHUA YEE MIEN  *        
      * BP136625 RJB1 01/02/17  REMOVE NORMALA BUANG, INCLUDE CHANDRA  *        
      *                         ARUMUGAM AND MEENACHI                  *        
      * BP137087 PCL4 17/11/17  TO REMOVE EMAIL RECIPIENTS             *        
      * BP137150 PCL4 03/01/18  TO UPDATE EMAIL RECIPIENTS             *        
      * BP137155 PCL4 08/01/18  TO UPDATE EMAIL RECIPIENTS             *        
      * BP138757 KV8  23/07/21  REPLACEING KATHIJAH TO SUZANNE         *        
      * BP139030 ZAR7 07/01/22  REPLACE CHUA YEE MIEN TO LIM KOK CHUN           
      * BP139159 KAC1 28/06/22  REMOVED AFIQAH                         *        
      * BP139276 KAC1 05/04/24  Replacing LIM_Kok_Chun by KATHIJAH_BEE *        
      *                                                   _ALI_MOHAMED *        
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT   BP13FD78      ASSIGN TO BP13FD78.                           
           SELECT   P13LC41A      ASSIGN TO P13LC41A.                           
           SELECT   P13LC41B      ASSIGN TO P13LC41B.                           
           SELECT   P13LC41C      ASSIGN TO P13LC41C.                           
           SELECT   P13LC41D      ASSIGN TO P13LC41D.                           
           SELECT   P13LC41E      ASSIGN TO P13LC41E.                           
           SELECT   P13FD78A      ASSIGN TO P13FD78A.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13FD78    RECORD CONTAINS 200 CHARACTERS                          
                        RECORDING MODE IS F.                                    
       COPY BP13FD78.                                                           
                                                                                
       FD   P13LC41A    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC41A-REC PIC X(132).                                            
                                                                                
       FD   P13LC41B    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC41B-REC PIC X(132).                                            
                                                                                
       FD   P13LC41C    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC41C-REC PIC X(132).                                            
                                                                                
       FD   P13LC41D    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC41D-REC PIC X(132).                                            
                                                                                
       FD   P13LC41E    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC41E-REC PIC X(132).                                            
                                                                                
       FD P13FD78A      RECORD CONTAINS 200 CHARACTERS                          
                        BLOCK CONTAINS 0 RECORDS                                
                        LABEL RECORDS ARE STANDARD                              
                        RECORDING MODE IS F.                                    
       01 P13FD78A-REC  PIC X(200).                                             
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-EMAIL-RPT-VARIABLES.                                              
           05  WS-DATE-RPT-DTL.                                                 
               10 FILLER                PIC X(6)  VALUE 'DATE: '.               
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.                 
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'.         
           05  WS-MAIL-RPT2             PIC X(27)                               
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                                
           05  WS-MAIL-RPT3             PIC X(60) VALUE                         
               'RCPT TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.               
           05  WS-MAIL-RPT4             PIC X(60) VALUE                         
              'RCPT TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.        
           05  WS-MAIL-RPT5             PIC X(60)                               
               VALUE 'RCPT TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.            
           05  WS-MAIL-RPT6             PIC X(60)                               
               VALUE 'RCPT TO:<CHANDRA_LAGHA_ARUMUGAM@HDB.GOV.SG>'.             
           05  WS-MAIL-RPT7             PIC X(60)                               
      *        VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.           
               VALUE 'RCPT TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                    
           05  WS-MAIL-RPT7B            PIC X(60)                               
               VALUE 'RCPT TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                      
           05  WS-MAIL-RPT7C            PIC X(60)                               
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.           
           05  WS-MAIL-RPT8             PIC X(4)                                
               VALUE 'DATA'.                                                    
           05  WS-MAIL-RPT9             PIC X(40)                               
               VALUE 'FROM:Soc System - Email Alert'.                           
           05  WS-MAIL-RPT10            PIC X(60) VALUE                         
               'TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.                    
           05  WS-MAIL-RPT11            PIC X(60) VALUE                         
               'TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.            
           05  WS-MAIL-RPT12            PIC X(60)                               
               VALUE 'TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.                 
           05  WS-MAIL-RPT13A           PIC X(60)                               
               VALUE 'TO:<CHANDRA_LAGHA_ARUMUGAM@HDB.GOV.SG>'.                  
           05  WS-MAIL-RPT13B           PIC X(60)                               
      *        VALUE 'TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.                
               VALUE 'TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                         
           05  WS-MAIL-RPT13D           PIC X(60)                               
               VALUE 'TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                           
           05  WS-MAIL-RPT13E           PIC X(60)                               
               VALUE 'CC:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.                
           05  WS-MAIL-RPT15            PIC X(100) VALUE                        
               'SUBJECT : REPORT ON SIGNED S&P RETURN DATE'.                    
                                                                                
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-FD78-READ                 PIC 9(07) VALUE ZEROS.              
           05  WS-LC4A-WRITTEN              PIC 9(07) VALUE ZEROS.              
           05  WS-LC4B-WRITTEN              PIC 9(07) VALUE ZEROS.              
           05  WS-LC4C-WRITTEN              PIC 9(07) VALUE ZEROS.              
           05  WS-LC4C-WRITTEN2             PIC 9(07) VALUE ZEROS.              
           05  WS-LC4D-WRITTEN              PIC 9(07) VALUE ZEROS.              
           05  WS-FD78-WRITTEN              PIC 9(07) VALUE ZEROS.              
           05  WS-L12A-REPORT               PIC 9(07) VALUE ZEROS.              
           05  WS-L12B-REPORT               PIC 9(07) VALUE ZEROS.              
           05  WS-REC-BYPASSED              PIC 9(07) VALUE ZEROS.              
           05  WS-BREAK-LINE                PIC 9(02) VALUE ZEROS.              
           05  WS-SNOA                      PIC 9(05) VALUE ZEROES.             
           05  WS-SNOB                      PIC 9(05) VALUE ZEROES.             
           05  WS-SNOC                      PIC 9(05) VALUE ZEROES.             
           05  WS-SNOC2                     PIC 9(05) VALUE ZEROES.             
           05  WS-SNOD                      PIC 9(05) VALUE ZEROES.             
           05  WS-PAGE-CTRA                 PIC 9(04) VALUE ZEROES.             
           05  WS-PAGE-CTRB                 PIC 9(04) VALUE ZEROES.             
           05  WS-PAGE-CTRC                 PIC 9(04) VALUE ZEROES.             
           05  WS-PAGE-CTRC2                PIC 9(04) VALUE ZEROES.             
           05  WS-PAGE-CTRD                 PIC 9(04) VALUE ZEROES.             
           05  WS-LINE-CTRA                 PIC 9(02) VALUE ZEROES.             
           05  WS-LINE-CTRB                 PIC 9(02) VALUE ZEROES.             
           05  WS-LINE-CTRC                 PIC 9(02) VALUE ZEROES.             
           05  WS-LINE-CTRC2                PIC 9(02) VALUE ZEROES.             
           05  WS-LINE-CTRD                 PIC 9(02) VALUE ZEROES.             
           05  WS-NOT-ELIG                  PIC 9(04) VALUE ZEROES.             
           05  WS-REPORT-LC12               PIC 9(04) VALUE ZEROES.             
                                                                                
       01  WS-SYSTEM-DATE-TIME.                                                 
           05  WS-SYS-DATE                  PIC X(08) VALUE SPACES.             
           05  WS-SYS-TIME                  PIC X(08) VALUE SPACES.             
           05  FILLER                       PIC X(05) VALUE SPACES.             
                                                                                
       01  WS-CURRENT-DATE.                                                     
           05  WS-CUR-DD                   PIC 9(02) VALUE ZEROES.              
           05  FILLER                      PIC X(01) VALUE '/'.                 
           05  WS-CUR-MM                   PIC 9(02) VALUE ZEROES.              
           05  FILLER                      PIC X(01) VALUE '/'.                 
           05  WS-CUR-CCYY                 PIC 9(04) VALUE ZEROES.              
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-FD78-EOF                  PIC X VALUE 'N'.                     
           05 WS-MAX-LINE                  PIC 9(02) VALUE 51.                  
           05 WS-REPORT-TAG                PIC X(08) VALUE SPACES.              
           05 WS-OIC-A                     PIC X(05) VALUE SPACES.              
           05 WS-OIC-B                     PIC X(05) VALUE SPACES.              
           05 WS-DTE-C                     PIC X(08) VALUE SPACES.              
           05 WS-DTE-C2                    PIC X(08) VALUE SPACES.              
           05 WS-DTE-D                     PIC X(08) VALUE SPACES.              
           05 WS-STREET-C                  PIC X(32) VALUE SPACES.              
           05 WS-STREET-C2                 PIC X(32) VALUE SPACES.              
                                                                                
       01  WS-DTE-OTP-EXPIRY-X             PIC X(08) VALUE SPACES.              
       01  WS-DTE-OTP-EXPIRY REDEFINES WS-DTE-OTP-EXPIRY-X                      
                                           PIC 9(08).                           
       01  WS-DTE-SNP-PAYMT-DUE-X          PIC X(08) VALUE SPACES.              
       01  WS-DTE-SNP-PAYMT-DUE REDEFINES WS-DTE-SNP-PAYMT-DUE-X                
                                           PIC 9(08).                           
                                                                                
       01  HEADING-1A.                                                          
           05  FILLER              PIC X(17)     VALUE                          
               'P13LC41A     HDB3'.                                             
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(27)     VALUE                          
               'HOUSING & DEVELOPMENT BOARD'.                                   
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LC4A-DATE-HDRA      PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LC4A-PAGE-HDRA      PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  HEADING-1B.                                                          
           05  FILLER              PIC X(17)     VALUE                          
               'P13LC41B     HDB3'.                                             
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(27)     VALUE                          
               'HOUSING & DEVELOPMENT BOARD'.                                   
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LC4A-DATE-HDRB      PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LC4B-PAGE-HDR       PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  HEADING-1C.                                                          
           05  FILLER              PIC X(17)     VALUE                          
               'P13LC41C     HDB3'.                                             
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(27)     VALUE                          
               'HOUSING & DEVELOPMENT BOARD'.                                   
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LC4A-DATE-HDRC      PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LC4A-PAGE-HDRC      PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  HEADING-1C2.                                                         
           05  FILLER              PIC X(17)     VALUE                          
               'P13LC41D     HDB3'.                                             
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(27)     VALUE                          
               'HOUSING & DEVELOPMENT BOARD'.                                   
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LC4A-DATE-HDRC2     PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LC4A-PAGE-HDRC2     PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  HEADING-1D.                                                          
           05  FILLER              PIC X(17)     VALUE                          
               'P13LC41E     HDB3'.                                             
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(27)     VALUE                          
               'HOUSING & DEVELOPMENT BOARD'.                                   
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LC4A-DATE-HDRD      PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LC4A-PAGE-HDRD      PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  HEADING-2.                                                           
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(49)     VALUE                          
               'DAILY ACCUMULATIVE LIST OF CASES WHERE S&P RECVD '.             
           05  FILLER              PIC X(33)     VALUE                          
               'BUT S&P APPT DATE & TIME IS BLANK'.                             
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(22)     VALUE                          
               'USER : AGREEMENT (CYM)'.                                        
                                                                                
       01  HEADING-02C.                                                         
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(39)     VALUE                          
               'DAILY ACCUMULATIVE LIST OF CASES WHERE'.                        
           05  FILLER              PIC X(29)     VALUE                          
               ' SIGNED S&P RETURN DATE BLANK'.                                 
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(22)     VALUE                          
               'USER : AGREEMENT (CYM)'.                                        
                                                                                
       01  HEADING-02D.                                                         
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(38)     VALUE                          
               'DAILY ACCUMULATIVE LIST OF CASES WHERE'.                        
           05  FILLER              PIC X(33)     VALUE                          
               ' SIGNED S&P RETURN DATE AVAILABLE'.                             
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(22)     VALUE                          
               'USER : AGREEMENT (CYM)'.                                        
                                                                                
       01  HEADING-2A.                                                          
           05  FILLER               PIC X(38)     VALUE SPACES.                 
           05  FILLER               PIC X(50)     VALUE                         
               'REPORT ON "H" AND "P" CASES TO BE SCHEDULED'.                   
                                                                                
       01  HEADING-2B.                                                          
           05  FILLER               PIC X(38)     VALUE SPACES.                 
           05  FILLER               PIC X(50)     VALUE                         
               'REPORT ON "B" AND "N" CASES TO BE SCHEDULED'.                   
                                                                                
       01  HEADING-2C.                                                          
           05  FILLER               PIC X(16)     VALUE SPACES.                 
           05  FILLER               PIC X(38)     VALUE                         
               'REPORT ON SIGNED S&P RETURN DATE BLANK'.                        
           05  FILLER               PIC X(45)     VALUE                         
               ' WHERE EXPIRY DATE OF OTP <= PAYMENT DUE DATE'.                 
                                                                                
       01  HEADING-2C2.                                                         
           05  FILLER               PIC X(17)     VALUE SPACES.                 
           05  FILLER               PIC X(38)     VALUE                         
               'REPORT ON SIGNED S&P RETURN DATE BLANK'.                        
           05  FILLER               PIC X(49)     VALUE                         
               ' WHERE EXPIRY DATE OF OTP > PAYMENT DUE DATE'.                  
                                                                                
       01  HEADING-2D.                                                          
           05  FILLER               PIC X(41)     VALUE SPACES.                 
           05  FILLER               PIC X(45)     VALUE                         
               'REPORT ON SIGNED S&P RETURN DATE AVAILABLE'.                    
                                                                                
       01  WS-BLANK-LINE  PIC X(132)             VALUE SPACES.                  
                                                                                
       01  WS-DASH-LINE   PIC X(132)             VALUE ALL '-'.                 
                                                                                
       01  WS-LC41D-FOOT1           PIC X(132)    VALUE                         
           '   **  TO SUBMIT A CHEQUE TO "COMMISSIONER OF STAMP DUTIES"         
      -    'FOR ALL THE DBSS CASES ABOVE WHEN RETURNING THE ORIGINAL & D        
      -    'UPLICATE'.                                                          
                                                                                
       01  WS-LC41D-FOOT2           PIC X(132)    VALUE                         
           '       COPIES OF S&P.'.                                             
                                                                                
      *==============================*                                          
      * COLUMNS FOR P13LC41A REPORT  *                                          
      *==============================*                                          
       01 HEADING-3A.                                                           
          05 FILLER               PIC X(48)     VALUE                           
             'S/N   REGN NO   SCH-ACC-NO      OIC       DATE  '.                
          05 FILLER               PIC X(53)     VALUE                           
             '  ELIG LOAN  HLE EXP    OFFR-SENT   OFFR ACC  AHG/CHG'.           
          05 FILLER               PIC X(31)     VALUE                           
             '  AHG/CHG  CF  S&P RECV  NO. OF'.                                 
                                                                                
       01 HEADING-3B.                                                           
          05 FILLER               PIC X(40)     VALUE SPACES.                   
          05 FILLER               PIC X(08)     VALUE '  OTP   '.               
          05 FILLER               PIC X(53)     VALUE                           
             '  TAG  TAG    DATE        DATE        DATE      REQ  '.           
          05 FILLER               PIC X(30)     VALUE                           
             '  STATUS  TYPE   DATE     DAYS'.                                  
                                                                                
                                                                                
      *==============================*                                          
      * COLUMNS FOR P13LC41B REPORT  *                                          
      *==============================*                                          
       01 HEADING-4A.                                                           
          05 FILLER               PIC X(48)     VALUE                           
             'S/N   REGN NO   SCH-ACC-NO      OIC       DATE  '.                
          05 FILLER               PIC X(54)     VALUE                           
             '  ELIG  LOAN  HLE   OFFR-SENT  OFFR ACC  AHG/CHG  AHG/'.          
          05 FILLER               PIC X(31)     VALUE                           
             '/CHG  CF    S&P RECV    NO. OF'.                                  
                                                                                
       01 HEADING-4B.                                                           
          05 FILLER               PIC X(40)     VALUE SPACES.                   
          05 FILLER               PIC X(08)     VALUE '  OTP   '.               
          05 FILLER               PIC X(54)     VALUE                           
             '  TAG   TAG  STATUS   DATE       DATE      REQ     STA'.          
          05 FILLER               PIC X(32)     VALUE                           
             'TUS  TYPE     DATE       DAYS'.                                   
                                                                                
      *============================================*                            
      * COLUMNS FOR P13LC41C,P13LC41D AND P13LC41E *                            
      *============================================*                            
       01 HEADING-5A.                                                           
          05 FILLER               PIC X(46)     VALUE                           
             'S/N   REGN NO   SCH-ACC-NO      OIC       DATE'.                  
          05 FILLER               PIC X(51)     VALUE                           
             '       DATE PP    S&P RECV     EXP DTE    S&P APPT '.             
          05 FILLER               PIC X(28)     VALUE                           
             '  SIGNED S&P   SIGNED S&P   '.                                    
          05 LC4C-NO-DAYS-HDR1    PIC X(06)     VALUE SPACES.                   
                                                                                
       01 HEADING-5B.                                                           
          05 FILLER               PIC X(42)     VALUE SPACES.                   
          05 FILLER               PIC X(03)     VALUE 'OTP'.                    
          05 FILLER               PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(54)     VALUE                           
             'DUE        DATE         OTP        DATE     SENT DATE '.          
          05 FILLER               PIC X(17)     VALUE                           
             '   RETN DATE     '.                                               
          05 LC4C-NO-DAYS-HDR2    PIC X(04)     VALUE SPACES.                   
                                                                                
      *==================*                                                      
      * P13LC41A DETAILS *                                                      
      *==================*                                                      
       01 WS-LC4A-DETAILS.                                                      
          05 LC4A-DTL-SERIAL      PIC ZZZZ9     VALUE ZEROES.                   
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4A-REGNO           PIC X(08)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-SCH-ACC         PIC X(14)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-OIC             PIC X(05)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-DATE-OTP        PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-ELIG-TAG        PIC X         VALUE SPACE.                    
          05 FILLER               PIC X(04)     VALUE SPACES.                   
          05 LC4A-LOAN-TAG        PIC X         VALUE SPACE.                    
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-HLE-EXPIRY      PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-OFR-PRNT        PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-DATE-ACCPT      PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(04)     VALUE SPACES.                   
          05 LC4A-AHG-REQ         PIC X(01)     VALUE SPACES.                   
          05 FILLER               PIC X(07)     VALUE SPACES.                   
          05 LC4A-AHG-STATUS      PIC X(01)     VALUE SPACES.                   
          05 FILLER               PIC X(06)     VALUE SPACES.                   
          05 LC4A-CF-TYPE         PIC X(02)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-DATE-RECVD      PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4A-NO-DAYS         PIC X(03)     VALUE SPACES JUST RIGHT.        
                                                                                
       01 WS-LC4A-DETAIL2.                                                      
          05 FILLER               PIC X(16)     VALUE SPACES.                   
          05 LC4A-ADDRESS         PIC X(60)     VALUE SPACES.                   
                                                                                
      *==================*                                                      
      * P13LC41B DETAILS *                                                      
      *==================*                                                      
       01 WS-LC4B-DETAILS.                                                      
          05 LC4B-DTL-SERIAL      PIC ZZZZ9     VALUE ZEROES.                   
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4B-REGNO           PIC X(08)     VALUE SPACES.                   
          05 FILTER               PIC X(02)     VALUE SPACES.                   
          05 LC4B-SCH-ACC         PIC X(14)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4B-OIC             PIC X(05)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4B-DATE-OTP        PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4B-ELIG-TAG        PIC X         VALUE SPACE.                    
          05 FILLER               PIC X(05)     VALUE SPACES.                   
          05 LC4B-LOAN-TAG        PIC X         VALUE SPACE.                    
          05 FILLER               PIC X(04)     VALUE SPACES.                   
          05 LC4B-HLE-STATUS      PIC X(3)      VALUE SPACE.                    
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4B-OFR-PRNT        PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4B-DATE-ACCPT      PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(03)     VALUE SPACES.                   
          05 LC4B-AHG-REQ         PIC X(01)     VALUE SPACE.                    
          05 FILLER               PIC X(08)     VALUE SPACES.                   
          05 LC4B-AHG-STATUS      PIC X(01)     VALUE SPACES.                   
          05 FILLER               PIC X(06)     VALUE SPACES.                   
          05 LC4B-CF-TYPE         PIC X(02)     VALUE SPACES.                   
          05 FILLER               PIC X(03)     VALUE SPACES.                   
          05 LC4B-DATE-RECVD      PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(05)     VALUE SPACES.                   
          05 LC4B-NO-DAYS         PIC X(03)     VALUE SPACES JUST RIGHT.        
                                                                                
       01 WS-LC4B-DETAIL2.                                                      
          05 FILLER               PIC X(16)     VALUE SPACES.                   
          05 LC4B-ADDRESS         PIC X(60)     VALUE SPACES.                   
                                                                                
      *====================*                                                    
      * P13LC41C/D DETAILS *                                                    
      *====================*                                                    
       01 WS-LC4C-DETAILS.                                                      
          05 LC4C-DTL-SERIAL      PIC ZZZZ9     VALUE ZEROES.                   
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4C-REGNO           PIC X(08)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-SCH-ACC         PIC X(14)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-OIC             PIC X(05)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-DATE-OTP        PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-PP-DUE          PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-DATE-RECVD      PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-EXP-OTP         PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-DATE-APPT       PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-DATE-SENT       PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(03)     VALUE SPACES.                   
          05 LC4C-DATE-RETN       PIC X(10)     VALUE SPACES.                   
          05 FILLER               PIC X(05)     VALUE SPACES.                   
          05 LC4C-NO-DAYS         PIC X(03)     VALUE SPACES JUST RIGHT.        
                                                                                
       01 WS-LC4C-DETAIL2.                                                      
          05 FILLER               PIC X(16)     VALUE SPACES.                   
          05 LC4C-ADDRESS         PIC X(60)     VALUE SPACES.                   
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
      *-------------------------------------------------------------            
       0000-MAIN.                                                               
      *-------------------------------------------------------------            
                                                                                
           PERFORM 1000-OPEN-FILES          THRU 1000-EXIT.                     
           PERFORM 2000-READ-BP13FD78       THRU 2000-EXIT.                     
           PERFORM 3000-PROCESS-RECORD      THRU 3000-EXIT                      
                                   UNTIL WS-FD78-EOF = 'Y'.                     
           IF WS-PAGE-CTRC2 > 1                                                 
              PERFORM 6100-PRINT-FOOTNOTE  THRU 6100-EXIT                       
           END-IF.                                                              
           PERFORM 9000-CLOSING-ROUTINE     THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       1000-OPEN-FILES.                                                         
      *-------------------------------------------------------------            
                                                                                
           OPEN INPUT BP13FD78                                                  
               OUTPUT P13LC41A                                                  
                      P13LC41B                                                  
                      P13LC41C                                                  
                      P13LC41D                                                  
                      P13LC41E                                                  
                      P13FD78A.                                                 
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-SYSTEM-DATE-TIME.                   
           MOVE WS-SYS-DATE(1:4)      TO WS-CUR-CCYY.                           
           MOVE WS-SYS-DATE(5:2)      TO WS-CUR-MM.                             
           MOVE WS-SYS-DATE(7:2)      TO WS-CUR-DD.                             
                                                                                
           PERFORM 6200-HEADER-EMAIL             THRU 6200-EXIT.                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       2000-READ-BP13FD78.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13FD78                                                        
             AT END MOVE 'Y'         TO WS-FD78-EOF                             
             GO TO 2000-EXIT.                                                   
                                                                                
           ADD  1                    TO WS-FD78-READ.                           
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3000-PROCESS-RECORD.                                                     
      *-------------------------------------------------------------            
                                                                                
           IF ( FD78-NUM-ELIG-TAG NOT = 'Y') AND                                
              ( FD78-DTE-SNP-APPT = SPACES ) AND                                
              ( FD78-TME-SNP-APPT = SPACES )                                    
                ADD 1 TO WS-NOT-ELIG                                            
           END-IF.                                                              
                                                                                
           IF ( FD78-NUM-ELIG-TAG = 'Y'    ) AND                                
              ( FD78-DTE-SNP-APPT = SPACES ) AND                                
              ( FD78-TME-SNP-APPT = SPACES )                                    
                                                                                
              IF ( FD78-NUM-LOAN-TAG          = 'H' OR 'P' )                    
                                                                                
      *--> PRINT ELIGIBLE CASES                                                 
                 MOVE 'P13LC41A'               TO   WS-REPORT-TAG               
                 PERFORM 4000-MOVE-DETAILS     THRU 4000-EXIT                   
                 PERFORM 5000-PRINT-ELIG-CASES THRU 5000-EXIT                   
                 ADD 1   TO WS-LC4A-WRITTEN                                     
                                                                                
              ELSE                                                              
                IF ( FD78-NUM-LOAN-TAG = 'N' OR 'B'   )                         
                                                                                
      *--> PRINT NON-ELIGIBLE CASES                                             
                   MOVE 'P13LC41B'               TO   WS-REPORT-TAG             
                   PERFORM 4000-MOVE-DETAILS         THRU 4000-EXIT             
                   PERFORM 5100-PRINT-NON-ELIG-CASES THRU 5100-EXIT             
                   ADD 1   TO WS-LC4B-WRITTEN                                   
                END-IF                                                          
                                                                                
              END-IF                                                            
           ELSE                                                                 
              PERFORM 3100-PRINT-REPORT-CD THRU 3100-EXIT                       
           END-IF.                                                              
                                                                                
                                                                                
           PERFORM 2000-READ-BP13FD78       THRU 2000-EXIT.                     
                                                                                
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3100-PRINT-REPORT-CD.                                                    
                                                                                
           IF ( FD78-DTE-SNP-APPT      NOT = SPACES ) AND                       
              ( FD78-DTE-SNP-SIGNED    NOT = SPACES )                           
                                                                                
              IF FD78-DTE-SNP-RETURNED = SPACES                                 
                                                                                
      *--> PRINT RETURN DATE BLANK                                              
                MOVE SPACES                   TO   WS-REPORT-TAG                
                                                                                
                IF FD78-DTE-OTP-EXPIRY <= FD78-DTE-SNP-PAYMT-DUE                
                   MOVE 'P13LC41C'               TO   WS-REPORT-TAG             
                ELSE                                                            
                   MOVE 'P13LC41D'               TO   WS-REPORT-TAG             
                END-IF                                                          
                                                                                
                PERFORM 4000-MOVE-DETAILS          THRU 4000-EXIT               
                                                                                
                IF WS-REPORT-TAG = 'P13LC41C'                                   
                   PERFORM 5200-PRINT-RETN-DATE-BLANK THRU 5200-EXIT            
                   ADD 1   TO WS-LC4C-WRITTEN                                   
                ELSE                                                            
                   PERFORM 5210-PRINT-RETN-DATE-BLANK THRU 5210-EXIT            
                   ADD 1   TO WS-LC4C-WRITTEN2                                  
                END-IF                                                          
                                                                                
              ELSE                                                              
                                                                                
      *--> PRINT RETURN DATE AVAILABLE                                          
                MOVE SPACES                   TO   WS-REPORT-TAG                
                MOVE 'P13LC41E'               TO   WS-REPORT-TAG                
                PERFORM 4000-MOVE-DETAILS              THRU 4000-EXIT           
                PERFORM 5300-PRINT-RETN-DATE-AVAILABLE THRU 5300-EXIT           
                ADD 1   TO WS-LC4D-WRITTEN                                      
             END-IF                                                             
                                                                                
           ELSE                                                                 
              WRITE P13FD78A-REC FROM BP13FD78-REC                              
              ADD 1 TO WS-FD78-WRITTEN                                          
              MOVE ZEROS TO WS-DTE-SNP-PAYMT-DUE WS-DTE-OTP-EXPIRY              
                                                                                
              IF FD78-DTE-OTP-EXPIRY NOT = SPACES AND LOW-VALUES                
                 MOVE FD78-DTE-OTP-EXPIRY    TO WS-DTE-OTP-EXPIRY-X             
              END-IF                                                            
              IF FD78-DTE-SNP-PAYMT-DUE NOT = SPACES AND LOW-VALUES             
                 MOVE FD78-DTE-SNP-PAYMT-DUE TO WS-DTE-SNP-PAYMT-DUE-X          
              END-IF                                                            
                                                                                
              IF (WS-DTE-OTP-EXPIRY    = ZEROS) OR                              
                 (WS-DTE-SNP-PAYMT-DUE = ZEROS)                                 
                 ADD 1 TO WS-REC-BYPASSED                                       
                 GO TO 3100-EXIT                                                
              END-IF                                                            
                                                                                
              IF WS-DTE-OTP-EXPIRY > WS-DTE-SNP-PAYMT-DUE                       
                 ADD 1 TO WS-L12B-REPORT                                        
              ELSE                                                              
                 ADD 1 TO WS-L12A-REPORT                                        
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4000-MOVE-DETAILS.                                                       
      *-------------------------------------------------------------            
                                                                                
           IF WS-REPORT-TAG = 'P13LC41A' OR 'P13LC41B'                          
              MOVE  SPACES              TO  WS-LC4A-DETAILS                     
                                            WS-LC4A-DETAIL2                     
              MOVE  SPACES              TO  WS-LC4B-DETAILS                     
                                            WS-LC4B-DETAIL2                     
           ELSE                                                                 
              MOVE  SPACES              TO  WS-LC4C-DETAILS                     
                                            WS-LC4C-DETAIL2                     
           END-IF.                                                              
                                                                                
           MOVE  SPACES                 TO  LC4C-NO-DAYS-HDR1                   
                                            LC4C-NO-DAYS-HDR2.                  
           MOVE  FD78-NUM-REGN          TO  LC4A-REGNO                          
                                            LC4B-REGNO                          
                                            LC4C-REGNO.                         
           MOVE  FD78-NUM-OIC           TO  LC4A-OIC                            
                                            LC4B-OIC                            
                                            LC4C-OIC.                           
                                                                                
           STRING WS-CUR-DD '/'                                                 
                  WS-CUR-MM '/'                                                 
                  WS-CUR-CCYY                                                   
           DELIMITED BY SIZE          INTO  LC4A-DATE-HDRA.                     
           MOVE LC4A-DATE-HDRA          TO  LC4A-DATE-HDRB                      
                                            LC4A-DATE-HDRC                      
                                            LC4A-DATE-HDRC2                     
                                            LC4A-DATE-HDRD.                     
                                                                                
           STRING FD78-NUM-SCH-ACCNT(01:4)  '-'                                 
                  FD78-NUM-SCH-ACCNT(05:4)  '-'                                 
                  FD78-NUM-SCH-ACCNT(09:1)  '-'                                 
                  FD78-NUM-SCH-ACCNT(10:2)                                      
           DELIMITED BY SIZE          INTO  LC4A-SCH-ACC.                       
           MOVE LC4A-SCH-ACC            TO  LC4B-SCH-ACC.                       
           MOVE LC4A-SCH-ACC            TO  LC4C-SCH-ACC.                       
                                                                                
           STRING 'BLK ' FD78-BLK-NO    ' #'                                    
                         FD78-LEVEL-NO  '-'                                     
                         FD78-MAIN-UNIT ' '                                     
                         FD78-SUB-UNIT  ' '                                     
                         FD78-STREET-NAME                                       
           DELIMITED BY SIZE       INTO  LC4A-ADDRESS.                          
           MOVE LC4A-ADDRESS         TO  LC4B-ADDRESS.                          
           MOVE LC4A-ADDRESS         TO  LC4C-ADDRESS.                          
                                                                                
           IF FD78-DTE-OPTION   NOT = SPACES AND LOW-VALUES                     
                                             AND ZEROES                         
              STRING FD78-DTE-OPTION(7:2) '/'                                   
                     FD78-DTE-OPTION(5:2) '/'                                   
                     FD78-DTE-OPTION(1:4)                                       
              DELIMITED BY SIZE  INTO  LC4A-DATE-OTP                            
           END-IF.                                                              
           MOVE LC4A-DATE-OTP        TO  LC4B-DATE-OTP.                         
           MOVE LC4A-DATE-OTP        TO  LC4C-DATE-OTP.                         
                                                                                
           STRING FD78-DTE-SNP-RECV(7:2) '/'                                    
                  FD78-DTE-SNP-RECV(5:2) '/'                                    
                  FD78-DTE-SNP-RECV(1:4)                                        
           DELIMITED BY SIZE  INTO  LC4A-DATE-RECVD.                            
           MOVE LC4A-DATE-RECVD      TO  LC4B-DATE-RECVD.                       
           MOVE LC4A-DATE-RECVD      TO  LC4C-DATE-RECVD.                       
                                                                                
      *--> FOR  ELIG-CASES OR NONELIG-CASES                                     
                                                                                
           IF WS-REPORT-TAG = 'P13LC41A' OR 'P13LC41B'                          
                                                                                
              MOVE  FD78-NUM-ELIG-TAG   TO LC4A-ELIG-TAG  LC4B-ELIG-TAG         
              MOVE  FD78-NUM-CF-TYPE    TO LC4A-CF-TYPE   LC4B-CF-TYPE          
              MOVE  FD78-NUM-LOAN-TAG   TO LC4A-LOAN-TAG  LC4B-LOAN-TAG         
              MOVE  FD78-NUM-DAYS-RECV  TO LC4A-NO-DAYS   LC4B-NO-DAYS          
              MOVE  FD78-NUM-HSGNT-REQ  TO LC4A-AHG-REQ   LC4B-AHG-REQ          
              MOVE  FD78-NUM-AHG-STATUS TO LC4A-AHG-STATUS                      
                                                        LC4B-AHG-STATUS         
              MOVE  FD78-NUM-CASE-STATUS TO LC4B-HLE-STATUS                     
                                                                                
              IF FD78-DTE-OFFER-ACCEPT NOT = SPACES AND LOW-VALUES              
                                                    AND ZEROES                  
                 STRING FD78-DTE-OFFER-ACCEPT(7:2) '/'                          
                        FD78-DTE-OFFER-ACCEPT(5:2) '/'                          
                        FD78-DTE-OFFER-ACCEPT(1:4)                              
                 DELIMITED BY SIZE  INTO  LC4A-DATE-ACCPT                       
              END-IF                                                            
              MOVE LC4A-DATE-ACCPT    TO  LC4B-DATE-ACCPT                       
                                                                                
              IF FD78-DTE-OFFER-PRINTED NOT = SPACES AND LOW-VALUES             
                                                AND ZEROES                      
                 STRING FD78-DTE-OFFER-PRINTED(7:2) '/'                         
                        FD78-DTE-OFFER-PRINTED(5:2) '/'                         
                        FD78-DTE-OFFER-PRINTED(1:4)                             
                 DELIMITED BY SIZE  INTO  LC4A-OFR-PRNT                         
              END-IF                                                            
              MOVE LC4A-OFR-PRNT      TO  LC4B-OFR-PRNT                         
                                                                                
              IF FD78-DTE-HLA-EXPIRY    NOT = SPACES AND LOW-VALUES             
                                                AND ZEROES                      
                 STRING FD78-DTE-HLA-EXPIRY(7:2) '/'                            
                        FD78-DTE-HLA-EXPIRY(5:2) '/'                            
                        FD78-DTE-HLA-EXPIRY(1:4)                                
                 DELIMITED BY SIZE  INTO  LC4A-HLE-EXPIRY                       
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
      *--> FOR RETN-DTE-BLANK AND RETN-DTE-AVAILABLE REPORTS                    
                                                                                
           IF WS-REPORT-TAG = 'P13LC41C' OR 'P13LC41D'  OR 'P13LC41E'           
                                                                                
              IF FD78-DTE-SNP-APPT NOT = SPACES AND LOW-VALUES                  
                                                AND ZEROES                      
                 STRING FD78-DTE-SNP-APPT(7:2) '/'                              
                        FD78-DTE-SNP-APPT(5:2) '/'                              
                        FD78-DTE-SNP-APPT(1:4)                                  
                 DELIMITED BY SIZE  INTO  LC4C-DATE-APPT                        
              END-IF                                                            
                                                                                
              IF FD78-DTE-SNP-SIGNED NOT = SPACES AND LOW-VALUES                
                                                  AND ZEROES                    
                 STRING FD78-DTE-SNP-SIGNED(7:2) '/'                            
                        FD78-DTE-SNP-SIGNED(5:2) '/'                            
                        FD78-DTE-SNP-SIGNED(1:4)                                
                 DELIMITED BY SIZE  INTO  LC4C-DATE-SENT                        
              END-IF                                                            
                                                                                
              IF FD78-DTE-SNP-RETURNED NOT = SPACES AND LOW-VALUES              
                                                    AND ZEROES                  
                 STRING FD78-DTE-SNP-RETURNED(7:2) '/'                          
                        FD78-DTE-SNP-RETURNED(5:2) '/'                          
                        FD78-DTE-SNP-RETURNED(1:4)                              
                 DELIMITED BY SIZE  INTO  LC4C-DATE-RETN                        
              END-IF                                                            
                                                                                
              IF FD78-DTE-SNP-PAYMT-DUE NOT = SPACES AND LOW-VALUES             
                                                    AND ZEROES                  
                 STRING FD78-DTE-SNP-PAYMT-DUE(7:2) '/'                         
                        FD78-DTE-SNP-PAYMT-DUE(5:2) '/'                         
                        FD78-DTE-SNP-PAYMT-DUE(1:4)                             
                 DELIMITED BY SIZE  INTO  LC4C-PP-DUE                           
              END-IF                                                            
                                                                                
              IF FD78-DTE-OTP-EXPIRY NOT = SPACES AND LOW-VALUES                
                 STRING FD78-DTE-OTP-EXPIRY(7:2) '/'                            
                        FD78-DTE-OTP-EXPIRY(5:2) '/'                            
                        FD78-DTE-OTP-EXPIRY(1:4)                                
                 DELIMITED BY SIZE  INTO  LC4C-EXP-OTP                          
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
      *--> FOR ELIG-CASES REPORT                                                
           IF WS-REPORT-TAG = 'P13LC41A'                                        
              MOVE  FD78-NUM-DAYS-RECV     TO  LC4A-NO-DAYS                     
           END-IF.                                                              
                                                                                
      *--> FOR RETN-DTE-BLANK REPORT                                            
           IF WS-REPORT-TAG = 'P13LC41C' OR 'P13LC41D'                          
              MOVE  'NO. OF'               TO  LC4C-NO-DAYS-HDR1                
              MOVE  'DAYS'                 TO  LC4C-NO-DAYS-HDR2                
              MOVE  FD78-NUM-DAYS-SGND     TO  LC4C-NO-DAYS                     
           END-IF.                                                              
                                                                                
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5000-PRINT-ELIG-CASES.                                                   
      *-------------------------------------------------------------            
                                                                                
           ADD   1                      TO  WS-SNOA.                            
           MOVE  WS-SNOA                TO  LC4A-DTL-SERIAL.                    
                                                                                
           IF WS-LINE-CTRA > WS-MAX-LINE OR                                     
              WS-SNOA      = 1 OR                                               
              ( WS-OIC-A         NOT = SPACES AND                               
                FD78-NUM-OIC     NOT = WS-OIC-A )                               
              ADD            1   TO WS-PAGE-CTRA                                
              MOVE ZEROES        TO LC4A-PAGE-HDRA                              
              MOVE WS-PAGE-CTRA  TO LC4A-PAGE-HDRA                              
                                                                                
              IF FD78-NUM-OIC     NOT   = WS-OIC-A                              
                 MOVE SPACES           TO WS-OIC-A                              
                 MOVE FD78-NUM-OIC     TO WS-OIC-A                              
                 MOVE 1                TO WS-SNOA                               
                                          LC4A-DTL-SERIAL                       
              END-IF                                                            
                                                                                
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC41A-REC FROM WS-LC4A-DETAILS.                             
           WRITE P13LC41A-REC FROM WS-LC4A-DETAIL2.                             
           WRITE P13LC41A-REC FROM WS-BLANK-LINE.                               
           ADD 3 TO WS-LINE-CTRA.                                               
                                                                                
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5100-PRINT-NON-ELIG-CASES.                                               
      *-------------------------------------------------------------            
                                                                                
           ADD   1                      TO  WS-SNOB.                            
           MOVE  WS-SNOB                TO  LC4B-DTL-SERIAL.                    
                                                                                
           IF WS-LINE-CTRB > WS-MAX-LINE OR                                     
              WS-SNOB      = 1 OR                                               
              ( WS-OIC-B         NOT = SPACES AND                               
                FD78-NUM-OIC     NOT = WS-OIC-B )                               
              ADD            1   TO WS-PAGE-CTRB                                
              MOVE ZEROES        TO LC4B-PAGE-HDR                               
              MOVE WS-PAGE-CTRB  TO LC4B-PAGE-HDR                               
              MOVE SPACES           TO WS-OIC-B                                 
              MOVE FD78-NUM-OIC     TO WS-OIC-B                                 
              MOVE 1                TO WS-SNOB                                  
                                       LC4B-DTL-SERIAL                          
                                                                                
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC41B-REC FROM WS-LC4B-DETAILS.                             
           WRITE P13LC41B-REC FROM WS-LC4B-DETAIL2.                             
           WRITE P13LC41B-REC FROM WS-BLANK-LINE.                               
           ADD 3 TO WS-LINE-CTRB.                                               
                                                                                
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5200-PRINT-RETN-DATE-BLANK.                                              
      *-------------------------------------------------------------            
           ADD   1                      TO  WS-SNOC.                            
           MOVE  WS-SNOC                TO  LC4C-DTL-SERIAL.                    
                                                                                
           IF WS-LINE-CTRC > WS-MAX-LINE OR                                     
              WS-SNOC      = 1 OR                                               
              ( WS-DTE-C            NOT = SPACES AND                            
                FD78-DTE-SNP-SIGNED NOT = WS-DTE-C ) OR                         
              ( WS-STREET-C         NOT = SPACES AND                            
                FD78-STREET-NAME    NOT = WS-STREET-C)                          
              ADD            1   TO WS-PAGE-CTRC                                
              MOVE ZEROES        TO LC4A-PAGE-HDRC                              
              MOVE WS-PAGE-CTRC  TO LC4A-PAGE-HDRC                              
              MOVE SPACES           TO WS-DTE-C                                 
              MOVE FD78-DTE-SNP-SIGNED TO  WS-DTE-C                             
              MOVE SPACES           TO WS-STREET-C                              
              MOVE FD78-STREET-NAME TO WS-STREET-C                              
              MOVE 1                TO WS-SNOC                                  
                                       LC4C-DTL-SERIAL                          
                                                                                
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC41C-REC FROM WS-LC4C-DETAILS.                             
           WRITE P13LC41C-REC FROM WS-LC4C-DETAIL2.                             
           WRITE P13LC41C-REC FROM WS-BLANK-LINE.                               
           ADD 3 TO WS-LINE-CTRC.                                               
                                                                                
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5210-PRINT-RETN-DATE-BLANK.                                              
      *-------------------------------------------------------------            
           ADD   1                      TO  WS-SNOC2.                           
           MOVE  WS-SNOC2               TO  LC4C-DTL-SERIAL.                    
                                                                                
           IF WS-LINE-CTRC2 > WS-MAX-LINE OR                                    
              WS-SNOC2     = 1 OR                                               
              ( WS-DTE-C2           NOT = SPACES AND                            
                FD78-DTE-SNP-SIGNED NOT = WS-DTE-C2 ) OR                        
              ( WS-STREET-C2        NOT = SPACES AND                            
                FD78-STREET-NAME    NOT = WS-STREET-C2)                         
              ADD            1   TO WS-PAGE-CTRC2                               
              MOVE ZEROES        TO LC4A-PAGE-HDRC2                             
              MOVE WS-PAGE-CTRC2 TO LC4A-PAGE-HDRC2                             
              MOVE SPACES           TO WS-DTE-C2                                
              MOVE FD78-DTE-SNP-SIGNED TO  WS-DTE-C2                            
              MOVE SPACES           TO WS-STREET-C2                             
              MOVE FD78-STREET-NAME TO WS-STREET-C2                             
              MOVE 1                TO WS-SNOC2                                 
                                       LC4C-DTL-SERIAL                          
                                                                                
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC41D-REC FROM WS-LC4C-DETAILS.                             
           WRITE P13LC41D-REC FROM WS-LC4C-DETAIL2.                             
           WRITE P13LC41D-REC FROM WS-BLANK-LINE.                               
           ADD 3 TO WS-LINE-CTRC2.                                              
                                                                                
                                                                                
       5210-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5300-PRINT-RETN-DATE-AVAILABLE.                                          
      *-------------------------------------------------------------            
           ADD   1                      TO  WS-SNOD.                            
           MOVE  WS-SNOD                TO  LC4C-DTL-SERIAL.                    
                                                                                
           IF WS-LINE-CTRD > WS-MAX-LINE OR                                     
              WS-SNOD      = 1 OR                                               
              ( WS-DTE-D            NOT = SPACES AND                            
                FD78-DTE-SNP-SIGNED NOT = WS-DTE-D )                            
              ADD            1   TO WS-PAGE-CTRD                                
              MOVE ZEROES        TO LC4A-PAGE-HDRD                              
              MOVE WS-PAGE-CTRD  TO LC4A-PAGE-HDRD                              
              MOVE SPACES           TO WS-DTE-D                                 
              MOVE FD78-DTE-SNP-SIGNED TO WS-DTE-D                              
              MOVE 1                TO WS-SNOD                                  
                                       LC4C-DTL-SERIAL                          
                                                                                
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC41E-REC FROM WS-LC4C-DETAILS.                             
           WRITE P13LC41E-REC FROM WS-LC4C-DETAIL2.                             
           WRITE P13LC41E-REC FROM WS-BLANK-LINE.                               
           ADD 3 TO WS-LINE-CTRD.                                               
                                                                                
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6000-PRINT-HEADING.                                                      
      *-------------------------------------------------------------            
                                                                                
                                                                                
      *--> FOR ELIG-CASES                                                       
           IF WS-REPORT-TAG = 'P13LC41A'                                        
                WRITE P13LC41A-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41A-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41A-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41A-REC FROM HEADING-1A AFTER PAGE                   
                WRITE P13LC41A-REC FROM HEADING-2                               
                WRITE P13LC41A-REC FROM HEADING-2A                              
                WRITE P13LC41A-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41A-REC FROM HEADING-3A                              
                WRITE P13LC41A-REC FROM HEADING-3B                              
                WRITE P13LC41A-REC FROM WS-DASH-LINE                            
                                                                                
                INITIALIZE WS-LINE-CTRA                                         
                MOVE 10 TO WS-LINE-CTRA                                         
           END-IF.                                                              
                                                                                
      *--> FOR NONELIG-CASES                                                    
           IF WS-REPORT-TAG = 'P13LC41B'                                        
                WRITE P13LC41B-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41B-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41B-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41B-REC FROM HEADING-1B AFTER PAGE                   
                WRITE P13LC41B-REC FROM HEADING-2                               
                WRITE P13LC41B-REC FROM HEADING-2B                              
                WRITE P13LC41B-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41B-REC FROM HEADING-4A                              
                WRITE P13LC41B-REC FROM HEADING-4B                              
                WRITE P13LC41B-REC FROM WS-DASH-LINE                            
                                                                                
                INITIALIZE WS-LINE-CTRB                                         
                MOVE 10 TO WS-LINE-CTRB                                         
           END-IF.                                                              
                                                                                
      *--> FOR RETN-DTE-BLANK; OTP <= PYMT DUE DTE                              
           IF WS-REPORT-TAG = 'P13LC41C'                                        
                WRITE P13LC41C-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41C-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41C-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41C-REC FROM HEADING-1C AFTER PAGE                   
                WRITE P13LC41C-REC FROM HEADING-02C                             
                WRITE P13LC41C-REC FROM HEADING-2C                              
                WRITE P13LC41C-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41C-REC FROM HEADING-5A                              
                WRITE P13LC41C-REC FROM HEADING-5B                              
                WRITE P13LC41C-REC FROM WS-DASH-LINE                            
                                                                                
                INITIALIZE WS-LINE-CTRC                                         
                MOVE 10 TO WS-LINE-CTRC                                         
           END-IF.                                                              
                                                                                
      *--> FOR RETN-DTE-BLANK; OTP > PYMT DUE DTE                               
           IF WS-REPORT-TAG = 'P13LC41D'                                        
                IF WS-PAGE-CTRC2 > 1                                            
                   PERFORM 6100-PRINT-FOOTNOTE  THRU 6100-EXIT                  
                END-IF                                                          
                WRITE P13LC41D-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41D-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41D-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41D-REC FROM HEADING-1C2 AFTER PAGE                  
                WRITE P13LC41D-REC FROM HEADING-02C                             
                WRITE P13LC41D-REC FROM HEADING-2C2                             
                WRITE P13LC41D-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41D-REC FROM HEADING-5A                              
                WRITE P13LC41D-REC FROM HEADING-5B                              
                WRITE P13LC41D-REC FROM WS-DASH-LINE                            
                                                                                
                INITIALIZE WS-LINE-CTRC2                                        
                MOVE 12 TO WS-LINE-CTRC2                                        
           END-IF.                                                              
                                                                                
      *--> FOR RETN-DTE-AVAILABLE                                               
           IF WS-REPORT-TAG = 'P13LC41E'                                        
                WRITE P13LC41E-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41E-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41E-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41E-REC FROM HEADING-1D AFTER PAGE                   
                WRITE P13LC41E-REC FROM HEADING-02D                             
                WRITE P13LC41E-REC FROM HEADING-2D                              
                WRITE P13LC41E-REC FROM WS-BLANK-LINE                           
                WRITE P13LC41E-REC FROM HEADING-5A                              
                WRITE P13LC41E-REC FROM HEADING-5B                              
                WRITE P13LC41E-REC FROM WS-DASH-LINE                            
                                                                                
                INITIALIZE WS-LINE-CTRD                                         
                MOVE 10 TO WS-LINE-CTRD                                         
           END-IF.                                                              
                                                                                
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6100-PRINT-FOOTNOTE.                                                     
      *-------------------------------------------------------------            
                                                                                
           COMPUTE WS-BREAK-LINE = 56 - WS-LINE-CTRC2                           
           WRITE P13LC41D-REC FROM WS-LC41D-FOOT1 AFTER WS-BREAK-LINE.          
           WRITE P13LC41D-REC FROM WS-LC41D-FOOT2.                              
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *================================================================*        
       6200-HEADER-EMAIL.                                                       
      *================================================================*        
                                                                                
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                              
                    FUNCTION CURRENT-DATE(5:2) '/'                              
                    FUNCTION CURRENT-DATE(1:4)                                  
            DELIMITED BY SIZE INTO WS-DATE-RPT.                                 
                                                                                
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT1.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT2.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT3.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT4.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT5.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT6.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT7.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT7B.                            
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT7C.                            
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT8.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT9.                             
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT10.                            
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT11.                            
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT12.                            
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT13A.                           
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT13B.                           
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT13D.                           
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT13E.                           
            WRITE P13LC41C-REC   FROM WS-MAIL-RPT15.                            
            WRITE P13LC41C-REC   FROM WS-DATE-RPT-DTL.                          
                                                                                
            MOVE SPACES            TO P13LC41C-REC.                             
            WRITE P13LC41C-REC.                                                 
                                                                                
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT1.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT2.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT3.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT4.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT5.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT6.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT7.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT7B.                            
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT7C.                            
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT8.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT9.                             
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT10.                            
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT11.                            
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT12.                            
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT13A.                           
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT13B.                           
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT13D.                           
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT13E.                           
            WRITE P13LC41D-REC   FROM WS-MAIL-RPT15.                            
            WRITE P13LC41D-REC   FROM WS-DATE-RPT-DTL.                          
                                                                                
            MOVE SPACES            TO P13LC41D-REC.                             
            WRITE P13LC41D-REC.                                                 
                                                                                
       6200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSING-ROUTINE.                                                    
      *-------------------------------------------------------------            
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '***************************************'.                   
           DISPLAY 'PROGRAM ID     :  BP13CC41'.                                
           DISPLAY 'CURRENT DATE   : ' WS-CURRENT-DATE.                         
           DISPLAY '***************************************'.                   
           DISPLAY 'NO. OF BP13FD78 READ         : ' WS-FD78-READ.              
           DISPLAY 'NO. OF NOT ELIG              : ' WS-NOT-ELIG.               
           DISPLAY 'NO. OF LC41A : "H"/"P" CASES : ' WS-LC4A-WRITTEN.           
           DISPLAY 'NO. OF LC41B : "B"/"N" CASES : ' WS-LC4B-WRITTEN.           
           DISPLAY 'NO. OF LC41C : SENT S&P      : ' WS-LC4C-WRITTEN.           
           DISPLAY 'NO. OF LC41D : SENT S&P      : ' WS-LC4C-WRITTEN2.          
           DISPLAY 'NO. OF LC41E : RETN S&P      : ' WS-LC4D-WRITTEN.           
           DISPLAY 'NO. OF CASES PRINTED IN L12A : ' WS-L12A-REPORT.            
           DISPLAY 'NO. OF CASES PRINTED IN L12B : ' WS-L12B-REPORT.            
           DISPLAY 'NO. OF RECS BYPASSED         : ' WS-REC-BYPASSED.           
                                                                                
           CLOSE BP13FD78                                                       
                 P13LC41A                                                       
                 P13LC41B                                                       
                 P13LC41C                                                       
                 P13LC41D                                                       
                 P13LC41E                                                       
                 P13FD78A.                                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
