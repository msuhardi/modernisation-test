       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CD85.                                                 
      *AUTHOR.        JIANG BO.                                                 
      *DATE-WRITTEN.  08/10/2010.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *  OBJECTIVE :                                               *            
      *                                                            *            
      *    TO SEND EMAIL TO DBSS TEAM                              *            
      *    WITH BUY 1ST SELL LATER CASES WHICH approved by rsl/trf *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  DATE(YMD)  BY    DESCRIPTION                      *            
      * -------- ---------- ----- -------------------------------- *            
      * BP134029 2011-04-08 JB8   NEW PROGRAM                      *            
      * BP134243 2011-09-12 JB8   To include more OIC              *            
      * BP134243 2012-04-04 ab9   replace WMC1 with jk3            *            
      * BP134269 2012-05-04 IMC1  ADD EMAIL ALLERT WHEN RESALE CASE*            
      *                           IS COMPLETED                     *            
      * BP134269 2012-05-30 IMC1  ADD EMAIL ALLERT WHEN TRANSFER   *            
      *                           IS COMPLETED                     *            
      * BP134269 2012-06-20 IMC1  CHANGE LKC13 TO LSC13            *            
      * BP134571 2012-07-12 IMC1  CHANGE LSC13 TO CYM3 AND JL47    *            
      * BP134422 2012-08-27 IMC1  ADD CCC3, NST1, QWY1             *            
      * BP134744 2013-03-12 RJE1  REMOVED TGM1, KCH1, TSL39, YC1,  *            
      *                           NCK1. REMOVED GSH2 AND HBB1 FOR  *            
      *                           DP FLATS EMAILS AND ADDED INTO   *            
      *                           DBSS EMAILS                      *            
      * BP134974 2013-07-09 RJE1  REMOVED LJL1 AND NST1            *            
      * BP135032 2013-10-28 RJE1  REPLACE JK3 WITH MT21            *            
      * BP135126 2014-05-09 ESD1  USE SOC_SYSTEM@HDB.GOV.SG AS SENDER*          
      * BP135195 2014-06-13 ESD1  CATER FOR ADDITIONAL ALERT                    
      * BP134954 2014-08-04 RJB1  REFINEMENTS TO EMAIL ALERT FOR   *            
      *                           REVISED 2ND CON LOAN CASES       *            
      * BP135467 2014-09-24 RJB1  CHANGED THE SENDING OF EMAIL FOR *            
      *                           asf1 AND vn1 from CC into TO ONLY*            
      *                           FOR CASES CREATED BY RESALE      *            
      * BP135507 2014-10-07 RJB1  REMOVED ck3 ckh4 asf1 vn1 jk3 ON *            
      *                           TRANSFER RECIPIENTS              *            
      * BP135507 2015-01-20 RJB1  REPLACED ck3 WITH rc10 FOR RESALE*            
      *                           RECIPIENTS                       *            
      * BP135507 2015-02-03 RJB1  REPLACED rj10 WITH rc10          *            
      * BP136082 2016-01-08 PCL4  TO UPDATE EMAIL RECIPIENTS       *            
      * BP136477 2016-10-31 RJB1  TO REMOVE LKH2                   *            
      * BP137665 2019-01-22 ZS13  add lsc13 and hwm2               *            
      * BP137665 2019-02-08 ZS13  TO CATER FOR SBF/RPF/SERS/BTO    *            
      * BP138757 2021-06-17 KV8   REMOVED CMW2                     *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT SY02F001 ASSIGN        TO SY02F001.                           
           SELECT BP13F482 ASSIGN        TO BP13F482.                           
           SELECT BP13K800 ASSIGN        TO BP13K800                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K800-NUM-REGN                       
                           FILE STATUS   IS BP13K800-STATUS.                    
           SELECT BM06K110 ASSIGN        TO BM06K110                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K110-KEY-FLD                        
                           FILE STATUS   IS BM06K110-STATUS.                    
           SELECT BB24K010 ASSIGN        TO BB24K010                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K010-KEY-FLD                        
                                         OF BB24K010-REC                        
                           ALTERNATE KEY IS K010-ALT-KEY1                       
                           FILE STATUS   IS BB24K010-STATUS.                    
           SELECT BB24K050 ASSIGN        TO BB24K050                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K050-KEY-FLD                        
                                         OF BB24K050-REC                        
                           ALTERNATE KEY IS K050-ALT-KEY                        
                           FILE STATUS   IS BB24K050-STATUS.                    
           SELECT BB13K010 ASSIGN        TO BB13K010                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K010-KEY-FLD                        
                                         OF K010-REC-TRANSFEROR                 
                           FILE STATUS   IS BB13K010-STATUS.                    
           SELECT BB13K500 ASSIGN        TO BB13K500                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K500-KEY-FLD                        
                                         OF K500-REC-TRANSFEROR                 
                           FILE STATUS   IS BB13K500-STATUS.                    
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS BP13K022-STATUS.                    
                                                                                
           SELECT BP13RSL ASSIGN         TO BP13RSL.                            
           SELECT BP13RSL2 ASSIGN        TO BP13RSL2.                           
           SELECT BP13TRF ASSIGN         TO BP13TRF.                            
           SELECT BP13COMP ASSIGN        TO BP13COMP.                           
           SELECT BP13COM2 ASSIGN        TO BP13COM2.                           
           SELECT BP13TRFC ASSIGN        TO BP13TRFC.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD   BP13F482                                                            
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13F482.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BB24K010                                                            
            RECORD CONTAINS 5000 CHARACTERS.                                    
       COPY BB24K010.                                                           
                                                                                
       FD   BB24K050                                                            
            RECORD CONTAINS 250  CHARACTERS.                                    
       COPY BB24K050.                                                           
                                                                                
       FD   BB13K010                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BB13K010.                                                           
                                                                                
       FD   BB13K500                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BB13K500.                                                           
                                                                                
       FD  BP13RSL                                                              
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS F.                                                
       01  RSL-PRTREC  PIC X(132).                                              
                                                                                
       FD  BP13RSL2                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS F.                                                
       01  RSL2-PRTREC  PIC X(132).                                             
                                                                                
       FD  BP13COMP                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING  MODE IS F.                                                
       01  COM-PRTREC  PIC X(80).                                               
                                                                                
       FD  BP13COM2                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING  MODE IS F.                                                
       01  COM2-PRTREC  PIC X(80).                                              
                                                                                
       FD  BP13TRF                                                              
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING  MODE IS F.                                                
       01  TRF-PRTREC  PIC X(80).                                               
                                                                                
       FD  BP13TRFC                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING  MODE IS F.                                                
       01  TRFC-PRTREC  PIC X(80).                                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  WS-VARIABLES.                                                        
           05  CNT-F482-READ        PIC 9(05)  VALUE ZEROES.                    
           05  CNT-K800-NOTFND      PIC 9(05)  VALUE ZEROES.                    
           05  CNT-K800-NOTBUY1ST   PIC 9(05)  VALUE ZEROES.                    
           05  CNT-K010-NOTFND      PIC 9(05)  VALUE ZEROES.                    
           05  WS-I                 PIC 9(02)  VALUE ZEROES.                    
           05  WS-F482-EOF          PIC X(01)  VALUE SPACES.                    
               88  F482-EOF                    VALUE 'Y'.                       
           05  WS-K800-FND          PIC X(01)  VALUE SPACES.                    
               88  K800-FND                    VALUE 'Y'.                       
           05  WS-K022-FND          PIC X(01)  VALUE SPACES.                    
               88  K022-FND                    VALUE 'Y'.                       
           05  WS-BB24K010-FND      PIC X(01)  VALUE SPACES.                    
               88  BB24K010-FND                VALUE 'Y'.                       
           05  WS-BB24K050-FND      PIC X(01)  VALUE SPACES.                    
               88  BB24K050-FND                VALUE 'Y'.                       
           05  WS-BB13K010-FND      PIC X(01)  VALUE SPACES.                    
               88  BB13K010-FND                VALUE 'Y'.                       
           05  WS-BB13K500-FND      PIC X(01)  VALUE SPACES.                    
               88  BB13K500-FND                VALUE 'Y'.                       
           05  WS-BM06K110-FND      PIC X(01)  VALUE SPACES.                    
               88  BM06K110-FND                VALUE 'Y'.                       
           05  WS-BP13K022-FND      PIC X(01)  VALUE SPACES.                    
               88  BP13K022-FND                VALUE 'Y'.                       
           05  BP13K800-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BP13K022-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BM06K110-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BB24K010-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BB24K050-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BB13K010-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BB13K500-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  WS-SYS-DATE          PIC X(8)   VALUE SPACES.                    
           05  WS-RSL-HDR-WRITE     PIC X(1)   VALUE SPACES.                    
           05  WS-TRF-HDR-WRITE     PIC X(1)   VALUE SPACES.                    
           05  WS-TRFC-HDR-WRITE    PIC X(1)   VALUE SPACES.                    
           05  WS-COM-HDR-WRITE     PIC X(1)   VALUE SPACES.                    
           05  WS-RES-HDR-WRITE     PIC X(1)   VALUE SPACES.                    
           05  WS-CSM-MAIL-ID       PIC X(5)   VALUE SPACES.                    
                                                                                
      *-------------------------------------------------------------            
      * LAYOUT BP13MAIL  -  DATASET FOR EMAIL                                   
      *-------------------------------------------------------------            
       01  WS-MAILLIST.                                                         
           05  WS-RSL-OIC-LIST                PIC X(160) VALUE                  
      *        'TOtgm1  TOcym3  TOlkh2  TOkch1  TOgsh2  TOtsl39 TOhbb1          
      *        'TOyc1   TOnck1  TOcwl1  TOjk3   TOjl47  CCljl1  '.              
               'TOcym3  TOcwl1  TOmt21  TOlsc13 TOhwm2  CCrc10  CCckh4          
      -        'CCasf1  CCvn1   CCjk3'.                                         
           05  REDEFINES WS-RSL-OIC-LIST.                                       
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-RSL-TYP             PIC X(02).                        
                   20  WS-RSL-OIC             PIC X(06).                        
                                                                                
           05  WS-COM-OIC-LIST                PIC X(160) VALUE                  
      *        'TOtgm1  TOcym3  TOlkh2  TOkch1  TOgsh2  TOtsl39 TOhbb1          
      *        'TOyc1   TOnck1  TOcwl1  TOjk3   TOjl47  CCljl1  '.              
      *        'TOcym3  TOlkh2  TOcwl1  TOmt21  TOjl47'.                        
               'TOcym3  TOlsc13 TOhwm2'.                                        
           05  REDEFINES WS-COM-OIC-LIST.                                       
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-COM-TYP             PIC X(02).                        
                   20  WS-COM-OIC             PIC X(06).                        
                                                                                
           05  WS-TRF-OIC-LIST                PIC X(160) VALUE                  
      *        'TOtgm1  TOcym3  TOlkh2  TOkch1  TOjl47  TOcmw2  TOccc3          
      *        'TOnst1  TOqwy1  CCljl1'.                                        
      *        'TOcym3  TOcmw2  TOccc3  TOqwy1  TOlsc13 TOhwm2'.                
               'TOcym3  TOccc3  TOqwy1  TOlsc13 TOhwm2'.                        
           05  REDEFINES WS-TRF-OIC-LIST.                                       
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-TRF-TYP             PIC X(02).                        
                   20  WS-TRF-OIC             PIC X(06).                        
                                                                                
           05  WS-TRFC-OIC-LIST               PIC X(160) VALUE                  
      *        'TOtgm1  TOcym3  TOlkh2  TOkch1  TOcmw2  TOjl47  TOkt11          
      *        'TOccc3  TOnst1  TOqwy1  CCljl1'.                                
      *        'TOcym3  TOcmw2  TOkt11  TOccc3  TOqwy1 TOlsc13 TOhwm2'.         
               'TOcym3  TOkt11  TOccc3  TOqwy1  TOlsc13 TOhwm2'.                
           05  REDEFINES WS-TRFC-OIC-LIST.                                      
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-TRFC-TYP             PIC X(02).                       
                   20  WS-TRFC-OIC             PIC X(06).                       
                                                                                
      *for DBSS email                                                           
           05  WS-RSL-OIC-LIST1               PIC X(160) VALUE                  
               'TOcym3  TOgsh2  TOhbb1  TOcwl1  TOmt21  TOlsc13  TOhwm2         
      -        'CCrc10  CCckh4  CCasf1  CCvn1   CCjk3'.                         
           05  REDEFINES WS-RSL-OIC-LIST1.                                      
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-RSL-TYP1            PIC X(02).                        
                   20  WS-RSL-OIC1            PIC X(06).                        
                                                                                
           05  WS-COM-OIC-LIST1               PIC X(160) VALUE                  
      *        'TOcym3  TOlkh2  TOgsh2  TOhbb1  TOcwl1  TOmt21  TOjl47'.        
               'TOcym3  TOgsh2  TOhbb1  TOlsc13 TOhwm2'.                        
           05  REDEFINES WS-COM-OIC-LIST1.                                      
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-COM-TYP1            PIC X(02).                        
                   20  WS-COM-OIC1            PIC X(06).                        
                                                                                
           05  WS-TRF-OIC-LIST1               PIC X(160) VALUE                  
      *        'TOcym3  TOcmw2  TOccc3  TOqwy1  TOgsh2  TOhbb1  TOlsc13         
               'TOcym3  TOccc3  TOqwy1  TOgsh2  TOhbb1  TOlsc13                 
      -        'TOhwm2'.                                                        
           05  REDEFINES WS-TRF-OIC-LIST1.                                      
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-TRF-TYP1            PIC X(02).                        
                   20  WS-TRF-OIC1            PIC X(06).                        
                                                                                
           05  WS-TRFC-OIC-LIST1              PIC X(160) VALUE                  
      *        'TOcym3  TOcmw2  TOkt11  TOccc3  TOqwy1  TOgsh2  TOhbb1          
               'TOcym3  TOkt11  TOccc3  TOqwy1  TOgsh2  TOhbb1  TOlsc13         
      -        ' TOhwm2'.                                                       
           05  REDEFINES WS-TRFC-OIC-LIST1.                                     
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-TRFC-TYP1            PIC X(02).                       
                   20  WS-TRFC-OIC1            PIC X(06).                       
                                                                                
      *FOR CASES CREATED BY RESALE                                              
           05  WS-RES-OIC-LIST                PIC X(160) VALUE                  
               'TOrc10  TOckh4  TOasf1  TOvn1                                   
      -        'TOjk3   TOcwl1  TOmt21'.                                        
           05  REDEFINES WS-RES-OIC-LIST.                                       
               10  FILLER OCCURS 20 TIMES.                                      
                   20  WS-RES-TYP             PIC X(02).                        
                   20  WS-RES-OIC             PIC X(06).                        
                                                                                
       01  MAIL-HDR-HELO.                                                       
           05  FILLER PIC X(80)  VALUE 'HELO SGPHDB1'.                          
                                                                                
       01  MAIL-HDR-MAIL-FROM.                                                  
           05  FILLER PIC X(80)  VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.              
      * ACJOB HEADER                                                            
      *    05  FILLER PIC X(80)  VALUE 'MAIL FROM:<ACJOB@SGPHDB1>'.             
                                                                                
       01  MAIL-HDR-DATA.                                                       
           05  FILLER PIC X(80) VALUE 'DATA'.                                   
                                                                                
       01  MAIL-HDR-FROM.                                                       
           05  FILLER PIC X(80) VALUE 'FROM: SOC_SYSTEM@HDB.GOV.SG'.            
                                                                                
       01  MAIL-RSL-SUBJECT.                                                    
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS/SOC cases        
      -        ' which have been approved by resale (DP flats)'.                
                                                                                
       01  MAIL-TRF-SUBJECT.                                                    
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS cases whi        
      -        'ch have been approved by transfer (DP flats)'.                  
                                                                                
       01  MAIL-COM-SUBJECT.                                                    
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS/SOC (New         
      -        'Flats) cases which have completed rsl (DP flats)'.              
                                                                                
       01  MAIL-TRFC-SUBJECT.                                                   
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS cases whi        
      -        'ch have completed transfer (DP flats)'.                         
                                                                                
      **SUBJECT FOR DBSS EMAILS                                                 
       01  MAIL-RSLA-SUBJECT.                                                   
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS/SOC cases        
      -        ' which have been approved by resale (DBSS)'.                    
                                                                                
       01  MAIL-TRFA-SUBJECT.                                                   
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS cases whi        
      -        'ch have been approved by transfer (DBSS)'.                      
                                                                                
       01  MAIL-COMA-SUBJECT.                                                   
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS/SOC (New         
      -        'Flats) cases which have completed resale (DBSS)'.               
                                                                                
       01  MAIL-TRFB-SUBJECT.                                                   
           05  FILLER PIC X(80)  VALUE 'SUBJECT : Buy 1st DBSS cases whi        
      -        'ch have completed transfer (DBSS)'.                             
                                                                                
      *SUBJECT FOR CASES CREATED BY RESALE                                      
       01  MAIL-RES-SUBJECT.                                                    
           05  FILLER PIC X(132) VALUE 'SUBJECT : Sellers Who Have Bough        
      -        't Resale Flats with Revised 2nd Concessionary Loan and S        
      -        'ubject to CPF/Cash Cream Off'.                                  
                                                                                
       01  MAIL-HDR-DATE.                                                       
           05 FILLER                   PIC X(6)   VALUE 'DATE: '.               
           05 MAIL-DATE                PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-DTL-HDR-RSL.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              ' Regn no  Purchase flat  Disposal flat  Case no/OIC  RSL         
      -       'appr dte  RSL eff dte  '.                                        
                                                                                
       01  MAIL-DTL-HDR-COM.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              ' Regn no  Prjct Purchase flat  Disposal flat  Case no/OIC        
      -       '  Completion date  '.                                            
                                                                                
       01  MAIL-DTL-HDR-TRF.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              ' Regn no   Prjct  Purchase flat   Disposal flat   TRF dat        
      -       'e'.                                                              
                                                                                
       01  MAIL-DTL-HDR-TRFC.                                                   
           05 FILLER                   PIC X(80)  VALUE                         
              ' Regn no   Prjct  Purchase flat   Disposal flat   TRF com        
      -       'plete date'.                                                     
                                                                                
       01  MAIL-DTL-FIL-RSL.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              ' ======== ============== ============== ============ ====        
      -       '========  =========== '.                                         
                                                                                
       01  MAIL-DTL-FIL-COM.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              ' ======== ===== ============== ============== ===========        
      -       '= ==============='.                                              
                                                                                
       01  MAIL-DTL-FIL.                                                        
           05 FILLER                   PIC X(80)  VALUE                         
              ' ========  =====  ==============  ==============  =======        
      -       '========='.                                                      
                                                                                
       01  MAIL-DTL-HDR-RSL-DBS.                                                
           05 FILLER                   PIC X(52)  VALUE                         
              ' Regn no  CRM   Prjct Purchase flat  Disposal flat  '.           
           05 FILLER                   PIC X(39)  VALUE                         
              'Case no/OIC  RSL appr dte  RSL eff dte'.                         
                                                                                
       01  MAIL-DTL-HDR-COM-DBS.                                                
           05 FILLER                   PIC X(52)  VALUE                         
              ' Regn no  CRM   Prjct Purchase flat  Disposal flat'.             
           05 FILLER                   PIC X(28)  VALUE                         
              ' Case no/OIC  Complete dte'.                                     
                                                                                
       01  MAIL-DTL-HDR-TRF-DBS.                                                
           05 FILLER                   PIC X(52)  VALUE                         
              ' Regn no  CRM   Prjct Purchase flat   Disposal flat '.           
           05 FILLER                   PIC X(28)  VALUE                         
              ' TRF date'.                                                      
                                                                                
       01  MAIL-DTL-HDR-TRFC-DBS.                                               
           05 FILLER                   PIC X(52)  VALUE                         
              ' Regn no  CRM   Prjct Purchase flat   Disposal flat'.            
           05 FILLER                   PIC X(28)  VALUE                         
              'TRF complete date'.                                              
                                                                                
       01  MAIL-DTL-FIL-RSL-DBS.                                                
           05 FILLER                   PIC X(52)  VALUE                         
              ' ======== ===== ===== ============== ============== '.           
           05 FILLER                   PIC X(38)  VALUE                         
              '============ ============  ==========='.                         
                                                                                
       01  MAIL-DTL-FIL-COM-DBS.                                                
           05 FILLER                   PIC X(52)  VALUE                         
              ' ======== ===== ===== ============== =============='.            
           05 FILLER                   PIC X(28)  VALUE                         
              ' ============ ============'.                                     
                                                                                
       01  MAIL-DTL-FIL-DBS.                                                    
           05 FILLER                   PIC X(52)  VALUE                         
              ' ======== ===== ===== ==============  =============='.           
           05 FILLER                   PIC X(28)  VALUE                         
              ' ============'.                                                  
                                                                                
      *HEADER FOR CASES CREATED BY RESALE                                       
       01  MAIL-DTL-HDR-RES.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              ' Purchase flat  Disposal flat  Case no/OIC  RSL appr dte         
      -       ' RSL eff dte  '.                                                 
                                                                                
       01  MAIL-DTL-FIL-RES.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              ' ============== ============== ============ ============         
      -       ' =========== '.                                                  
                                                                                
       01  MAIL-TXT-1.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              'This is a DBSS 2nd con loan case. Please do the 1st level        
      -       ' check :'.                                                       
                                                                                
       01  MAIL-TXT-2.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              '(i) check if there is disbursed / undisbursed DBSS loan'.        
                                                                                
       01  MAIL-TXT-3.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              '(ii) then re-do the DBSS Progress Payment Schedule. '.           
                                                                                
       01  MAIL-TXT-4.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              'For 2nd level check, please check with Agreement Officers        
      -       '.'.                                                              
                                                                                
       01  MAIL-DTL-CASE-RSL.                                                   
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-REGN            PIC X(08)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-FLAT-NEW        PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-FLAT-SOLD       PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-CASE-NO-OIC     PIC X(12)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-RSL-DTE-APPRL       PIC X(10)  VALUE SPACES.                 
           05 FILLER                   PIC X(04)  VALUE SPACES.                 
           05 MAIL-RSL-DTE-EFF         PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-DTL-CASE-COM.                                                   
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-COM-REGN            PIC X(08)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-COM-PRJCT           PIC X(03)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-COM-FLAT-NEW        PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-COM-FLAT-SOLD       PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-COM-CASE-NO-OIC     PIC X(12)  VALUE SPACES.                 
           05 FILLER                   PIC X(03)  VALUE SPACES.                 
           05 MAIL-COM-DTE-APPRL       PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-DTL-CASE.                                                       
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-REGN                PIC X(08)  VALUE SPACES.                 
           05 FILLER                   PIC X(03)  VALUE SPACES.                 
           05 MAIL-PRJCT               PIC X(03)  VALUE SPACES.                 
           05 FILLER                   PIC X(03)  VALUE SPACES.                 
           05 MAIL-FLAT-NEW            PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-FLAT-SOLD           PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(05)  VALUE SPACES.                 
           05 MAIL-DTE-APPRL           PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-DTL-CASE-RSL-DBS.                                               
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-REGN-DBS        PIC X(08)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-OIC-DBS         PIC X(05)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-RSL-PRJCT-DBS       PIC X(03)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-RSL-FLAT-NEW-DBS    PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-FLAT-SOLD-DBS   PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RSL-CASE-NO-OIC-DBS PIC X(12)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-RSL-DTE-APPRL-DBS   PIC X(10)  VALUE SPACES.                 
           05 FILLER                   PIC X(03)  VALUE SPACES.                 
           05 MAIL-RSL-DTE-EFF-DBS     PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-DTL-CASE-COM-DBS.                                               
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-COM-REGN-DBS        PIC X(08)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-COM-OIC-DBS         PIC X(05)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-COM-PRJCT-DBS       PIC X(03)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-COM-FLAT-NEW-DBS    PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-COM-FLAT-SOLD-DBS   PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-COM-CASE-NO-OIC-DBS PIC X(12)  VALUE SPACES.                 
           05 FILLER                   PIC X(03)  VALUE SPACES.                 
           05 MAIL-COM-DTE-APPRL-DBS   PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-DTL-CASE-DBS.                                                   
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-REGN-DBS            PIC X(08)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-OIC-DBS             PIC X(05)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-PRJCT-DBS           PIC X(03)  VALUE SPACES.                 
           05 FILLER                   PIC X(03)  VALUE SPACES.                 
           05 MAIL-FLAT-NEW-DBS        PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-FLAT-SOLD-DBS       PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-DTE-APPRL-DBS       PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-DTL-CASE-RES.                                                   
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RES-FLAT-NEW        PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RES-FLAT-SOLD       PIC X(14)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-RES-CASE-NO-OIC     PIC X(12)  VALUE SPACES.                 
           05 FILLER                   PIC X(02)  VALUE SPACES.                 
           05 MAIL-RES-DTE-APPRL       PIC X(10)  VALUE SPACES.                 
           05 FILLER                   PIC X(04)  VALUE SPACES.                 
           05 MAIL-RES-DTE-EFF         PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-END.                                                            
           05 FILLER                   PIC X      VALUE '.'.                    
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(80)  VALUE SPACES.                 
                                                                                
       01  MAIL-TXT-FT1.                                                        
           05 FILLER                   PIC X(54)  VALUE                         
              'CRMs (Resale)- Please print the cream off panel *BB24M'.         
           05 FILLER                   PIC X(26)  VALUE                         
              'U4C and ensure Team Heads '.                                     
                                                                                
       01  MAIL-TXT-FT1A.                                                       
           05 FILLER                   PIC X(54)  VALUE                         
              'verify and sign the CPF refund cream-off amount and ca'.         
           05 FILLER                   PIC X(26)  VALUE                         
              'sh proceed cream-off      '.                                     
                                                                                
       01  MAIL-TXT-FT1B.                                                       
           05 FILLER                   PIC X(54)  VALUE                         
              'amount copy before resale completion. Please ensure th'.         
           05 FILLER                   PIC X(26)  VALUE                         
              'e signed copy is filed in '.                                     
                                                                                
       01  MAIL-TXT-FT1C.                                                       
           05 FILLER                   PIC X(80)  VALUE                         
              'LTFS for record purpose.'.                                       
                                                                                
       01  MAIL-TXT-FT2.                                                        
           05 FILLER                   PIC X(54)  VALUE                         
              'Team Heads (Resale)- Please check and confirm the crea'.         
           05 FILLER                   PIC X(26)  VALUE                         
              'm off amounts keyed in by '.                                     
                                                                                
       01  MAIL-TXT-FT2A.                                                       
           05 FILLER                   PIC X(80)  VALUE                         
              'CRM in the *BB24MU4C is correct.'.                               
                                                                                
       01  MAIL-TXT-FT3.                                                        
           05 FILLER                   PIC X(54)  VALUE                         
              '*RESL Option 3 - 12 - BB24MU4C - UPD REC CSH/CPF RFD T'.         
           05 FILLER                   PIC X(26)  VALUE                         
              'O REDUCE(REV 2ND CON LN)  '.                                     
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN-ROUTINE.                                                       
      *-------------------------------------------------------------            
            PERFORM 1000-OPEN-ROUTINE         THRU 1000-EXIT.                   
            PERFORM 2000-READ-BP13F482        THRU 2000-EXIT.                   
                                                                                
            IF F482-NUM-REGN(6:1) < '0'                                         
               PERFORM 3050-PROC-DET-RSL      THRU 3050-EXIT                    
                 UNTIL F482-EOF                                                 
            ELSE                                                                
            display 'BTO/SBF flat ' F482-NUM-REGN                               
            PERFORM 3000-PROCESS-DETAIL       THRU 3000-EXIT                    
              UNTIL F482-EOF.                                                   
                                                                                
            IF WS-RSL-HDR-WRITE = 'Y'                                           
               IF K800-NUM-REGN(1:1) = '5' OR '1' OR '2' OR '3'                 
                  MOVE SPACES TO RSL-PRTREC                                     
                  WRITE RSL-PRTREC                                              
                  WRITE RSL-PRTREC FROM  MAIL-TXT-1                             
                  MOVE SPACES TO RSL-PRTREC                                     
                  WRITE RSL-PRTREC FROM  MAIL-TXT-2                             
                  MOVE SPACES TO RSL-PRTREC                                     
                  WRITE RSL-PRTREC FROM  MAIL-TXT-3                             
                  MOVE SPACES TO RSL-PRTREC                                     
                  WRITE RSL-PRTREC                                              
                  WRITE RSL-PRTREC FROM  MAIL-TXT-4                             
               END-IF                                                           
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC                                                 
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1                              
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1A                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1B                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1C                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC                                                 
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT2                              
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT2A                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC                                                 
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT3                              
               WRITE RSL-PRTREC FROM MAIL-END                                   
            END-IF                                                              
            IF WS-TRF-HDR-WRITE = 'Y'                                           
               IF K800-NUM-REGN(1:1) = '5' OR '1' OR '2' OR '3'                 
                  MOVE SPACES TO TRF-PRTREC                                     
                  WRITE TRF-PRTREC                                              
                  WRITE TRF-PRTREC FROM  MAIL-TXT-1                             
                  MOVE SPACES TO TRF-PRTREC                                     
                  WRITE TRF-PRTREC FROM  MAIL-TXT-2                             
                  MOVE SPACES TO TRF-PRTREC                                     
                  WRITE TRF-PRTREC FROM  MAIL-TXT-3                             
                  MOVE SPACES TO TRF-PRTREC                                     
                  WRITE TRF-PRTREC                                              
                  WRITE TRF-PRTREC FROM  MAIL-TXT-4                             
               END-IF                                                           
               WRITE TRF-PRTREC FROM MAIL-END                                   
            END-IF.                                                             
            IF WS-COM-HDR-WRITE = 'Y'                                           
               IF K800-NUM-REGN(1:1) = '5' OR '1' OR '2' OR '3'                 
                  MOVE SPACES TO COM-PRTREC                                     
                  WRITE COM-PRTREC                                              
                  WRITE COM-PRTREC FROM  MAIL-TXT-1                             
                  MOVE SPACES TO COM-PRTREC                                     
                  WRITE COM-PRTREC FROM  MAIL-TXT-2                             
                  MOVE SPACES TO COM-PRTREC                                     
                  WRITE COM-PRTREC FROM  MAIL-TXT-3                             
                  MOVE SPACES TO COM-PRTREC                                     
                  WRITE COM-PRTREC                                              
                  WRITE COM-PRTREC FROM  MAIL-TXT-4                             
               END-IF                                                           
               WRITE COM-PRTREC FROM MAIL-END                                   
            END-IF.                                                             
            IF WS-TRFC-HDR-WRITE = 'Y'                                          
               IF K800-NUM-REGN(1:1) = '5' OR '1' OR '2' OR '3'                 
                  MOVE SPACES TO TRFC-PRTREC                                    
                  WRITE TRFC-PRTREC                                             
                  WRITE TRFC-PRTREC FROM  MAIL-TXT-1                            
                  MOVE SPACES TO TRFC-PRTREC                                    
                  WRITE TRFC-PRTREC FROM  MAIL-TXT-2                            
                  MOVE SPACES TO TRFC-PRTREC                                    
                  WRITE TRFC-PRTREC FROM  MAIL-TXT-3                            
                  MOVE SPACES TO TRFC-PRTREC                                    
                  WRITE TRFC-PRTREC                                             
                  WRITE TRFC-PRTREC FROM  MAIL-TXT-4                            
               END-IF                                                           
               WRITE TRFC-PRTREC FROM MAIL-END                                  
            END-IF.                                                             
            IF WS-RES-HDR-WRITE = 'Y'                                           
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC                                                 
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1                              
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1A                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1B                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT1C                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC                                                 
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT2                              
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT2A                             
               MOVE SPACES TO RSL-PRTREC                                        
               WRITE RSL-PRTREC                                                 
               WRITE RSL-PRTREC FROM  MAIL-TXT-FT3                              
               WRITE RSL-PRTREC FROM MAIL-END                                   
            END-IF.                                                             
                                                                                
            PERFORM 9000-CLOSE-ROUTINE        THRU  9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
       1000-OPEN-ROUTINE.                                                       
      *-------------------------------------------------------------            
           OPEN INPUT  BP13F482                                                 
                       SY02F001                                                 
                       BP13K800                                                 
                       BP13K022                                                 
                       BM06K110                                                 
                       BB24K010                                                 
                       BB24K050                                                 
                       BB13K010                                                 
                       BB13K500                                                 
                OUTPUT BP13RSL                                                  
                       BP13RSL2                                                 
                       BP13COMP                                                 
                       BP13COM2                                                 
                       BP13TRF                                                  
                       BP13TRFC.                                                
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BP13K800 - OPEN ERROR (' BP13K800-STATUS ')'             
              MOVE BP13K800-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BP13K022 - OPEN ERROR (' BP13K022-STATUS ')'             
              MOVE BP13K022-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BM06K110-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BM06K110 - OPEN ERROR (' BM06K110-STATUS ')'             
              MOVE BM06K110-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BB24K010-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BB24K010 - OPEN ERROR (' BB24K010-STATUS ')'             
              MOVE BB24K010-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BB24K050-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BB24K050 - OPEN ERROR (' BB24K050-STATUS ')'             
              MOVE BB24K050-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BB13K010-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BB13K010 - OPEN ERROR (' BB13K010-STATUS ')'             
              MOVE BB13K010-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BB13K500-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BB13K500 - OPEN ERROR (' BB13K500-STATUS ')'             
              MOVE BB13K500-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           READ SY02F001.                                                       
           MOVE F001-DTE-CURRENT   TO WS-SYS-DATE.                              
           STRING WS-SYS-DATE(7:2) '/'                                          
                  WS-SYS-DATE(5:2) '/'                                          
                  WS-SYS-DATE(1:4)                                              
                  DELIMITED BY SIZE INTO MAIL-DATE.                             
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       2000-READ-BP13F482.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13F482                                                        
             AT END                                                             
                MOVE 'Y'   TO WS-F482-EOF                                       
                GO         TO 2000-EXIT                                         
           END-READ.                                                            
                                                                                
           ADD 1           TO CNT-F482-READ.                                    
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       3000-PROCESS-DETAIL.                                                     
      *-------------------------------------------------------------            
                                                                                
           MOVE F482-NUM-HDBREF-NEW              TO K110-KEY-FLD                
           PERFORM 8004-READ-BM06K110          THRU 8004-EXIT                   
           IF NOT BM06K110-FND                                                  
              PERFORM 2000-READ-BP13F482       THRU 2000-EXIT                   
              GO TO 3000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE K110-REGN-NO                     TO K800-NUM-REGN               
           PERFORM 8001-READ-BP13K800          THRU 8001-EXIT                   
                                                                                
           IF K800-FND                                                          
              IF K800-NUM-BUY-SELL-TAG = 'B'                                    
                 display 'buy sell tag b  ' F482-NUM-REGN                       
                 MOVE F482-NUM-HDBREF-DISPOSAL    TO K010-NUM-HDB-REF           
                                                  OF BB24K010-REC               
                 PERFORM 8002-READ-BB24K010     THRU 8002-EXIT                  
                 IF BB24K010-FND                                                
      * EMAIL ALERT WHEN RESALE CASE IS COMPLETED                               
                    IF K010-DTE-STATUS-UPDATE(17) NOT = SPACES                  
                                                  AND LOW-VALUES                
                       PERFORM 3400-MAIL-COMP     THRU 3400-EXIT                
      *                PERFORM 3405-MAIL-COM-OIC  THRU 3405-EXIT                
                    ELSE                                                        
                       IF K010-DTE-STATUS-UPDATE(6) NOT = SPACES                
                                                    AND LOW-VALUES              
                          PERFORM 3100-MAIL-RSL     THRU 3100-EXIT              
                          PERFORM 3300-MAIL-RSL-OIC THRU 3300-EXIT              
                       END-IF                                                   
                    END-IF                                                      
                 ELSE                                                           
                    MOVE F482-NUM-HDBREF-DISPOSAL TO K010-NUM-HDB-REF           
                                                  OF K010-REC-TRANSFEROR        
                    PERFORM 8003-READ-BB13K010  THRU 8003-EXIT                  
                    IF BB13K010-FND                                             
                       IF K010-DTE-LEGAL-DOC-SIGN NOT =  SPACES AND             
                                                         LOW-VALUES             
                          PERFORM 3500-MAIL-TRF-COMP THRU 3500-EXIT             
                       ELSE                                                     
                          IF K010-DTE-TRANSFER NOT = SPACES AND                 
                                                     LOW-VALUES                 
                              PERFORM 3200-MAIL-TRF THRU 3200-EXIT              
                          END-IF                                                
                       END-IF                                                   
                    ELSE                                                        
                       MOVE  SPACES  TO  K500-KEY-FLD                           
                       INITIALIZE        K500-KEY-FLD                           
                       MOVE F482-NUM-HDBREF-DISPOSAL TO K500-NUM-HDB-REF        
                       MOVE  'S'                     TO K500-CDE-REC            
                       PERFORM 8006-READ-BB13K500  THRU 8006-EXIT               
                       IF BB13K500-FND                                          
                          IF K500-DTE-LEGAL-DOC-SIGN NOT =  SPACES AND          
                                                            LOW-VALUES          
                             PERFORM 3500-MAIL-TRF-COMP THRU 3500-EXIT          
                          ELSE                                                  
                             IF K500-DTE-TRANSFER NOT = SPACES AND              
                                                        LOW-VALUES              
                                 PERFORM 3200-MAIL-TRF THRU 3200-EXIT           
                             END-IF                                             
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 display 'not buy first  ' F482-NUM-REGN                        
                 ADD  1                        TO CNT-K800-NOTBUY1ST            
              END-IF                                                            
           ELSE                                                                 
                 display 'k800-notfnd    ' F482-NUM-REGN                        
              ADD 1                            TO CNT-K800-NOTFND               
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F482                THRU 2000-EXIT.            
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3050-PROC-DET-RSL.                                                       
      *-------------------------------------------------------------            
                                                                                
           MOVE F482-NUM-HDBREF-DISPOSAL    TO K010-NUM-HDB-REF                 
                                               OF BB24K010-REC                  
           PERFORM 8002-READ-BB24K010     THRU 8002-EXIT                        
           IF BB24K010-FND                                                      
              IF K010-DTE-STATUS-UPDATE(17) NOT = SPACES                        
                                            AND LOW-VALUES                      
                 CONTINUE                                                       
              ELSE                                                              
                 IF K010-DTE-STATUS-UPDATE(6) NOT = SPACES                      
                                              AND LOW-VALUES                    
                    PERFORM 3055-MAIL-RESL    THRU 3055-EXIT                    
                    PERFORM 3065-MAIL-RSLOIC  THRU 3065-EXIT                    
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F482                THRU 2000-EXIT.            
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3055-MAIL-RESL.                                                          
      *-------------------------------------------------------------            
                                                                                
           IF WS-RES-HDR-WRITE NOT = 'Y'                                        
              WRITE RSL-PRTREC FROM MAIL-HDR-HELO                               
              WRITE RSL-PRTREC FROM MAIL-HDR-MAIL-FROM                          
              PERFORM 3060-RSLOIC THRU 3060-EXIT                                
              WRITE RSL-PRTREC FROM MAIL-HDR-DATE                               
              WRITE RSL-PRTREC FROM MAIL-SPACES                                 
              WRITE RSL-PRTREC FROM MAIL-DTL-HDR-RES                            
              WRITE RSL-PRTREC FROM MAIL-DTL-FIL-RES                            
              MOVE 'Y'                      TO WS-RES-HDR-WRITE                 
           END-IF.                                                              
                                                                                
           STRING F482-NUM-HDBREF-NEW(1:4) '-'                                  
                  F482-NUM-HDBREF-NEW(5:4) '-'                                  
                  F482-NUM-HDBREF-NEW(9:1) '-'                                  
                  F482-NUM-HDBREF-NEW(10:2)                                     
                  DELIMITED BY SIZE INTO MAIL-RES-FLAT-NEW                      
           STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(5:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(9:1) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(10:2)                                
                  DELIMITED BY SIZE INTO MAIL-RES-FLAT-SOLD                     
           STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                            
                  K010-DTE-STATUS-UPDATE(6)(5:2) '/'                            
                  K010-DTE-STATUS-UPDATE(6)(1:4)                                
                  DELIMITED BY SIZE INTO MAIL-RES-DTE-APPRL                     
           IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                     
              STRING K010-DTE-RESL-EFF(7:2) '/'                                 
                     K010-DTE-RESL-EFF(5:2) '/'                                 
                     K010-DTE-RESL-EFF(1:4)                                     
                     DELIMITED BY SIZE INTO MAIL-RES-DTE-EFF                    
           ELSE                                                                 
              MOVE SPACES TO MAIL-RES-DTE-EFF                                   
           END-IF                                                               
           STRING K010-NUM-CASE OF BB24K010-REC                                 
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-RES-CASE-NO-OIC                
           WRITE RSL-PRTREC FROM MAIL-DTL-CASE-RES.                             
                                                                                
       3055-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3060-RSLOIC.                                                             
      *-------------------------------------------------------------            
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                     
              IF WS-RES-OIC(WS-I) NOT = SPACES AND LOW-VALUES                   
                 MOVE SPACES  TO RSL-PRTREC                                     
                 STRING 'RCPT TO:<' DELIMITED BY SIZE                           
                        WS-RES-OIC(WS-I) DELIMITED BY SPACES                    
                        '@hdb.gov.sg>'                                          
                        DELIMITED BY SPACES INTO RSL-PRTREC                     
                 WRITE RSL-PRTREC                                               
              END-IF                                                            
           END-PERFORM                                                          
           WRITE RSL-PRTREC FROM MAIL-HDR-DATA                                  
           WRITE RSL-PRTREC FROM MAIL-HDR-FROM                                  
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                     
              IF WS-RES-OIC(WS-I) NOT = SPACES AND LOW-VALUES                   
                 MOVE SPACES  TO RSL-PRTREC                                     
                 STRING WS-RES-TYP(WS-I) ':<'                                   
                        WS-RES-OIC(WS-I) '@hdb.gov.sg>'                         
                        DELIMITED BY SPACES INTO RSL-PRTREC                     
                 WRITE RSL-PRTREC                                               
              END-IF                                                            
           END-PERFORM                                                          
           WRITE RSL-PRTREC FROM MAIL-RES-SUBJECT.                              
                                                                                
       3060-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3065-MAIL-RSLOIC.                                                        
      *-------------------------------------------------------------            
                                                                                
           MOVE K010-CDE-INIT-OIC1        TO K050-CDE-INIT-OIC                  
           PERFORM 8005-READ-BB24K050   THRU 8005-EXIT                          
           IF NOT BB24K050-FND                                                  
              GO TO 3065-EXIT                                                   
           END-IF.                                                              
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-HDR-HELO                                 
           WRITE RSL2-PRTREC FROM MAIL-HDR-MAIL-FROM                            
           MOVE SPACES  TO RSL2-PRTREC                                          
           STRING 'RCPT TO:<' DELIMITED BY SIZE                                 
                   K050-NME-LOTUS-NOTES DELIMITED BY SPACES                     
                  '@hdb.gov.sg>'                                                
                  DELIMITED BY SPACES INTO RSL2-PRTREC                          
           WRITE RSL2-PRTREC                                                    
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-HDR-DATA                                 
           WRITE RSL2-PRTREC FROM MAIL-HDR-FROM                                 
           MOVE SPACES  TO RSL2-PRTREC                                          
           STRING 'TO:<' DELIMITED BY SIZE                                      
                  K050-NME-LOTUS-NOTES DELIMITED BY SPACES                      
                  '@hdb.gov.sg>' DELIMITED BY SPACES                            
                  INTO RSL2-PRTREC                                              
           WRITE RSL2-PRTREC                                                    
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-RES-SUBJECT                              
           WRITE RSL2-PRTREC FROM MAIL-HDR-DATE                                 
           WRITE RSL2-PRTREC FROM MAIL-SPACES                                   
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-DTL-HDR-RES                              
           WRITE RSL2-PRTREC FROM MAIL-DTL-FIL-RES                              
           STRING F482-NUM-HDBREF-NEW(1:4) '-'                                  
                  F482-NUM-HDBREF-NEW(5:4) '-'                                  
                  F482-NUM-HDBREF-NEW(9:1) '-'                                  
                  F482-NUM-HDBREF-NEW(10:2)                                     
                  DELIMITED BY SIZE INTO MAIL-RES-FLAT-NEW                      
           STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(5:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(9:1) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(10:2)                                
                  DELIMITED BY SIZE INTO MAIL-RES-FLAT-SOLD                     
           STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                            
                  K010-DTE-STATUS-UPDATE(6)(5:2) '/'                            
                  K010-DTE-STATUS-UPDATE(6)(1:4)                                
                  DELIMITED BY SIZE INTO MAIL-RES-DTE-APPRL                     
           IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                     
              STRING K010-DTE-RESL-EFF(7:2) '/'                                 
                  K010-DTE-RESL-EFF(5:2) '/'                                    
                  K010-DTE-RESL-EFF(1:4)                                        
                  DELIMITED BY SIZE INTO MAIL-RES-DTE-EFF                       
           ELSE                                                                 
              MOVE SPACES TO MAIL-RES-DTE-EFF                                   
           END-IF                                                               
           STRING K010-NUM-CASE OF BB24K010-REC                                 
                  '/' K010-CDE-INIT-OIC1                                        
                  DELIMITED BY SIZE INTO MAIL-RES-CASE-NO-OIC                   
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-DTL-CASE-RES.                            
                                                                                
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC                                                    
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1                                  
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1A                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1B                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1C                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC                                                    
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT2                                  
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT2A                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC                                                    
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT3                                  
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-END.                                     
                                                                                
       3065-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3100-MAIL-RSL.                                                           
      *-------------------------------------------------------------            
                                                                                
           IF WS-RSL-HDR-WRITE NOT = 'Y'                                        
              WRITE RSL-PRTREC FROM MAIL-HDR-HELO                               
              WRITE RSL-PRTREC FROM MAIL-HDR-MAIL-FROM                          
              PERFORM 3150-RSL-OIC  THRU 3150-EXIT                              
      *       PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-RSL-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
      *             MOVE SPACES  TO RSL-PRTREC                                  
      *             STRING 'RCPT TO:<' DELIMITED BY SIZE                        
      *                    WS-RSL-OIC(WS-I) DELIMITED BY SPACES                 
      *                    '@hdb.gov.sg>'                                       
      *                    DELIMITED BY SPACES INTO RSL-PRTREC                  
      *             WRITE RSL-PRTREC                                            
      *          END-IF                                                         
      *       END-PERFORM                                                       
      *       WRITE RSL-PRTREC FROM MAIL-HDR-DATA                               
      *       WRITE RSL-PRTREC FROM MAIL-HDR-FROM                               
      *       PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-RSL-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
      *             MOVE SPACES  TO RSL-PRTREC                                  
      *             STRING WS-RSL-TYP(WS-I) ':<'                                
      *                    WS-RSL-OIC(WS-I) '@hdb.gov.sg>'                      
      *                    DELIMITED BY SPACES INTO RSL-PRTREC                  
      *             WRITE RSL-PRTREC                                            
      *          END-IF                                                         
      *       END-PERFORM                                                       
      *       WRITE RSL-PRTREC FROM MAIL-RSL-SUBJECT                            
              WRITE RSL-PRTREC FROM MAIL-HDR-DATE                               
              WRITE RSL-PRTREC FROM MAIL-SPACES                                 
              IF K800-NUM-REGN(1:1) = '5'                                       
                 WRITE RSL-PRTREC FROM MAIL-DTL-HDR-RSL-DBS                     
                 WRITE RSL-PRTREC FROM MAIL-DTL-FIL-RSL-DBS                     
              ELSE                                                              
                 WRITE RSL-PRTREC FROM MAIL-DTL-HDR-RSL                         
                 WRITE RSL-PRTREC FROM MAIL-DTL-FIL-RSL                         
              END-IF                                                            
              MOVE 'Y'                      TO WS-RSL-HDR-WRITE                 
           END-IF.                                                              
                                                                                
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE K800-NUM-REGN               TO MAIL-RSL-REGN-DBS             
                                                  K022-NUM-REGN                 
              PERFORM 8010-READ-BP13K022  THRU 8010-EXIT                        
              MOVE WS-CSM-MAIL-ID   TO  MAIL-RSL-OIC-DBS                        
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-RSL-PRJCT-DBS            
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-NEW-DBS               
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-SOLD-DBS              
              STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(5:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(1:4)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-APPRL-DBS              
              IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                  
                 STRING K010-DTE-RESL-EFF(7:2) '/'                              
                     K010-DTE-RESL-EFF(5:2) '/'                                 
                     K010-DTE-RESL-EFF(1:4)                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-EFF-DBS                
              ELSE                                                              
                 MOVE SPACES TO MAIL-RSL-DTE-EFF-DBS                            
              END-IF                                                            
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-CASE-NO-OIC-DBS            
              WRITE RSL-PRTREC FROM MAIL-DTL-CASE-RSL-DBS                       
           ELSE                                                                 
              MOVE K800-NUM-REGN               TO MAIL-RSL-REGN                 
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-NEW                   
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-SOLD                  
              STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(5:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(1:4)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-APPRL                  
              IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                  
                 STRING K010-DTE-RESL-EFF(7:2) '/'                              
                     K010-DTE-RESL-EFF(5:2) '/'                                 
                     K010-DTE-RESL-EFF(1:4)                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-EFF                    
              ELSE                                                              
                 MOVE SPACES TO MAIL-RSL-DTE-EFF                                
              END-IF                                                            
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-CASE-NO-OIC                
              WRITE RSL-PRTREC FROM MAIL-DTL-CASE-RSL                           
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3150-RSL-OIC.                                                            
      *-------------------------------------------------------------            
           IF K800-NUM-REGN(1:1) NOT = '5'                                      
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-RSL-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
                    MOVE SPACES  TO RSL-PRTREC                                  
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-RSL-OIC(WS-I) DELIMITED BY SPACES                 
                           '@hdb.gov.sg>'                                       
                           DELIMITED BY SPACES INTO RSL-PRTREC                  
                    WRITE RSL-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE RSL-PRTREC FROM MAIL-HDR-DATA                               
              WRITE RSL-PRTREC FROM MAIL-HDR-FROM                               
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-RSL-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
                    MOVE SPACES  TO RSL-PRTREC                                  
                    STRING WS-RSL-TYP(WS-I) ':<'                                
                           WS-RSL-OIC(WS-I) '@hdb.gov.sg>'                      
                           DELIMITED BY SPACES INTO RSL-PRTREC                  
                    WRITE RSL-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE RSL-PRTREC FROM MAIL-RSL-SUBJECT                            
           ELSE                                                                 
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-RSL-OIC1(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO RSL-PRTREC                                  
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-RSL-OIC1(WS-I) DELIMITED BY SPACES                
                           '@hdb.gov.sg>'                                       
                           DELIMITED BY SPACES INTO RSL-PRTREC                  
                    WRITE RSL-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE RSL-PRTREC FROM MAIL-HDR-DATA                               
              WRITE RSL-PRTREC FROM MAIL-HDR-FROM                               
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-RSL-OIC1(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO RSL-PRTREC                                  
                    STRING WS-RSL-TYP1(WS-I) ':<'                               
                           WS-RSL-OIC1(WS-I) '@hdb.gov.sg>'                     
                           DELIMITED BY SPACES INTO RSL-PRTREC                  
                    WRITE RSL-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE RSL-PRTREC FROM MAIL-RSLA-SUBJECT                           
           END-IF.                                                              
                                                                                
       3150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3300-MAIL-RSL-OIC.                                                       
      *-------------------------------------------------------------            
                                                                                
           MOVE K010-CDE-INIT-OIC1        TO K050-CDE-INIT-OIC                  
           PERFORM 8005-READ-BB24K050   THRU 8005-EXIT                          
           IF NOT BB24K050-FND                                                  
              GO TO 3300-EXIT                                                   
           END-IF.                                                              
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-HDR-HELO                                 
           WRITE RSL2-PRTREC FROM MAIL-HDR-MAIL-FROM                            
           MOVE SPACES  TO RSL2-PRTREC                                          
           STRING 'RCPT TO:<' DELIMITED BY SIZE                                 
                   K050-NME-LOTUS-NOTES DELIMITED BY SPACES                     
                  '@hdb.gov.sg>'                                                
                  DELIMITED BY SPACES INTO RSL2-PRTREC                          
           WRITE RSL2-PRTREC                                                    
                                                                                
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE K800-NUM-REGN               TO K022-NUM-REGN                 
              PERFORM 8010-READ-BP13K022  THRU 8010-EXIT                        
              IF (WS-CSM-MAIL-ID NOT = SPACES AND LOW-VALUES)                   
                 MOVE SPACES  TO RSL2-PRTREC                                    
                 STRING 'RCPT TO:<' DELIMITED BY SIZE                           
                         WS-CSM-MAIL-ID DELIMITED BY SPACES                     
                        '@hdb.gov.sg>'                                          
                         DELIMITED BY SPACES INTO RSL2-PRTREC                   
                 WRITE RSL2-PRTREC                                              
              END-IF                                                            
           END-IF                                                               
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-HDR-DATA                                 
           WRITE RSL2-PRTREC FROM MAIL-HDR-FROM                                 
           MOVE SPACES  TO RSL2-PRTREC                                          
           STRING 'TO:<' DELIMITED BY SIZE                                      
                  K050-NME-LOTUS-NOTES DELIMITED BY SPACES                      
                  '@hdb.gov.sg>' DELIMITED BY SPACES                            
                  INTO RSL2-PRTREC                                              
           WRITE RSL2-PRTREC                                                    
           IF K800-NUM-REGN(1:1) = '5'                                          
              IF (WS-CSM-MAIL-ID NOT = SPACES AND LOW-VALUES)                   
                 MOVE SPACES  TO RSL2-PRTREC                                    
                 STRING 'TO:<' DELIMITED BY SIZE                                
                         WS-CSM-MAIL-ID DELIMITED BY SPACES                     
                        '@hdb.gov.sg>'                                          
                         DELIMITED BY SPACES INTO RSL2-PRTREC                   
                 WRITE RSL2-PRTREC                                              
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF K800-NUM-REGN(1:1) NOT = '5'                                      
              WRITE RSL2-PRTREC FROM MAIL-RSL-SUBJECT                           
           ELSE                                                                 
              WRITE RSL2-PRTREC FROM MAIL-RSLA-SUBJECT                          
           END-IF                                                               
           WRITE RSL2-PRTREC FROM MAIL-HDR-DATE                                 
           WRITE RSL2-PRTREC FROM MAIL-SPACES                                   
           IF K800-NUM-REGN(1:1) = '5'                                          
              WRITE RSL2-PRTREC FROM MAIL-DTL-HDR-RSL-DBS                       
              WRITE RSL2-PRTREC FROM MAIL-DTL-FIL-RSL-DBS                       
              MOVE K800-NUM-REGN               TO MAIL-RSL-REGN-DBS             
              MOVE WS-CSM-MAIL-ID              TO MAIL-RSL-OIC-DBS              
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-RSL-PRJCT-DBS            
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-NEW-DBS               
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-SOLD-DBS              
              STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(5:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(1:4)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-APPRL-DBS              
              IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                  
                 STRING K010-DTE-RESL-EFF(7:2) '/'                              
                     K010-DTE-RESL-EFF(5:2) '/'                                 
                     K010-DTE-RESL-EFF(1:4)                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-EFF-DBS                
              ELSE                                                              
                 MOVE SPACES TO MAIL-RSL-DTE-EFF-DBS                            
              END-IF                                                            
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-CASE-NO-OIC-DBS            
                                                                                
              WRITE RSL2-PRTREC FROM MAIL-DTL-CASE-RSL-DBS                      
           ELSE                                                                 
              WRITE RSL2-PRTREC FROM MAIL-DTL-HDR-RSL                           
              WRITE RSL2-PRTREC FROM MAIL-DTL-FIL-RSL                           
              MOVE K800-NUM-REGN               TO MAIL-RSL-REGN                 
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-NEW                   
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-FLAT-SOLD                  
              STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(5:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(1:4)                             
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-APPRL                  
              IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                  
                 STRING K010-DTE-RESL-EFF(7:2) '/'                              
                     K010-DTE-RESL-EFF(5:2) '/'                                 
                     K010-DTE-RESL-EFF(1:4)                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-DTE-EFF                    
              ELSE                                                              
                 MOVE SPACES TO MAIL-RSL-DTE-EFF                                
              END-IF                                                            
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-RSL-CASE-NO-OIC                
                                                                                
              WRITE RSL2-PRTREC FROM MAIL-DTL-CASE-RSL                          
           END-IF                                                               
                                                                                
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE SPACES TO RSL2-PRTREC                                        
              WRITE RSL2-PRTREC                                                 
              WRITE RSL2-PRTREC FROM  MAIL-TXT-1                                
              MOVE SPACES TO RSL2-PRTREC                                        
              WRITE RSL2-PRTREC FROM  MAIL-TXT-2                                
              MOVE SPACES TO RSL2-PRTREC                                        
              WRITE RSL2-PRTREC FROM  MAIL-TXT-3                                
              MOVE SPACES TO RSL2-PRTREC                                        
              WRITE RSL2-PRTREC                                                 
              MOVE SPACES TO RSL2-PRTREC                                        
              WRITE RSL2-PRTREC FROM  MAIL-TXT-4                                
           END-IF.                                                              
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC                                                    
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1                                  
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1A                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1B                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT1C                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC                                                    
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT2                                  
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT2A                                 
           MOVE SPACES TO RSL2-PRTREC                                           
           WRITE RSL2-PRTREC                                                    
           WRITE RSL2-PRTREC FROM MAIL-TXT-FT3                                  
                                                                                
           WRITE RSL2-PRTREC FROM MAIL-END.                                     
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3200-MAIL-TRF.                                                           
      *-------------------------------------------------------------            
                                                                                
           IF WS-TRF-HDR-WRITE NOT = 'Y'                                        
              WRITE TRF-PRTREC FROM MAIL-HDR-HELO                               
              WRITE TRF-PRTREC FROM MAIL-HDR-MAIL-FROM                          
              PERFORM 3250-TRF-OIC   THRU 3250-EXIT                             
      *       PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-TRF-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
      *             MOVE SPACES  TO TRF-PRTREC                                  
      *             STRING 'RCPT TO:<' DELIMITED BY SIZE                        
      *                    WS-TRF-OIC(WS-I) '@hdb.gov.sg>'                      
      *                    DELIMITED BY SPACES INTO TRF-PRTREC                  
      *             WRITE TRF-PRTREC                                            
      *          END-IF                                                         
      *       END-PERFORM                                                       
      *       WRITE TRF-PRTREC FROM MAIL-HDR-DATA                               
      *       WRITE TRF-PRTREC FROM MAIL-HDR-FROM                               
      *       PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-TRF-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
      *             MOVE SPACES  TO TRF-PRTREC                                  
      *             STRING WS-TRF-TYP(WS-I) ':<'                                
      *                    WS-TRF-OIC(WS-I) '@hdb.gov.sg>'                      
      *                    DELIMITED BY SPACES INTO TRF-PRTREC                  
      *             WRITE TRF-PRTREC                                            
      *          END-IF                                                         
      *       END-PERFORM                                                       
      *       WRITE TRF-PRTREC FROM MAIL-TRF-SUBJECT                            
              WRITE TRF-PRTREC FROM MAIL-HDR-DATE                               
              WRITE TRF-PRTREC FROM MAIL-SPACES                                 
              IF K800-NUM-REGN(1:1) = '5'                                       
                 WRITE TRF-PRTREC FROM MAIL-DTL-HDR-TRF-DBS                     
                 WRITE TRF-PRTREC FROM MAIL-DTL-FIL-DBS                         
              ELSE                                                              
                 WRITE TRF-PRTREC FROM MAIL-DTL-HDR-TRF                         
                 WRITE TRF-PRTREC FROM MAIL-DTL-FIL                             
              END-IF                                                            
              MOVE 'Y'                      TO WS-TRF-HDR-WRITE                 
           END-IF.                                                              
                                                                                
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE K800-NUM-REGN               TO MAIL-REGN-DBS                 
                                                  K022-NUM-REGN                 
              PERFORM 8010-READ-BP13K022  THRU 8010-EXIT                        
              MOVE WS-CSM-MAIL-ID      TO    MAIL-OIC-DBS                       
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-PRJCT-DBS                
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-FLAT-NEW-DBS                   
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-FLAT-SOLD-DBS                  
                                                                                
              IF BB13K010-FND                                                   
                 STRING K010-DTE-TRANSFER(7:2) '/'                              
                        K010-DTE-TRANSFER(5:2) '/'                              
                        K010-DTE-TRANSFER(1:4)                                  
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL-DBS               
              ELSE                                                              
                 STRING K500-DTE-TRANSFER(7:2) '/'                              
                        K500-DTE-TRANSFER(5:2) '/'                              
                        K500-DTE-TRANSFER(1:4)                                  
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL-DBS               
              END-IF                                                            
                                                                                
              WRITE  TRF-PRTREC FROM MAIL-DTL-CASE-DBS                          
           ELSE                                                                 
              MOVE K800-NUM-REGN               TO MAIL-REGN                     
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-PRJCT                    
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-FLAT-NEW                       
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-FLAT-SOLD                      
                                                                                
              IF BB13K010-FND                                                   
                 STRING K010-DTE-TRANSFER(7:2) '/'                              
                        K010-DTE-TRANSFER(5:2) '/'                              
                        K010-DTE-TRANSFER(1:4)                                  
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL                   
              ELSE                                                              
                 STRING K500-DTE-TRANSFER(7:2) '/'                              
                        K500-DTE-TRANSFER(5:2) '/'                              
                        K500-DTE-TRANSFER(1:4)                                  
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL                   
              END-IF                                                            
                                                                                
              WRITE  TRF-PRTREC FROM MAIL-DTL-CASE                              
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3250-TRF-OIC.                                                            
      *-------------------------------------------------------------            
           IF K800-NUM-REGN(1:1) NOT = '5'                                      
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRF-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
                    MOVE SPACES  TO TRF-PRTREC                                  
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-TRF-OIC(WS-I) '@hdb.gov.sg>'                      
                           DELIMITED BY SPACES INTO TRF-PRTREC                  
                    WRITE TRF-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRF-PRTREC FROM MAIL-HDR-DATA                               
              WRITE TRF-PRTREC FROM MAIL-HDR-FROM                               
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRF-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
                    MOVE SPACES  TO TRF-PRTREC                                  
                    STRING WS-TRF-TYP(WS-I) ':<'                                
                           WS-TRF-OIC(WS-I) '@hdb.gov.sg>'                      
                           DELIMITED BY SPACES INTO TRF-PRTREC                  
                    WRITE TRF-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRF-PRTREC FROM MAIL-TRF-SUBJECT                            
           ELSE                                                                 
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRF-OIC1(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO TRF-PRTREC                                  
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-TRF-OIC1(WS-I) '@hdb.gov.sg>'                     
                           DELIMITED BY SPACES INTO TRF-PRTREC                  
                    WRITE TRF-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRF-PRTREC FROM MAIL-HDR-DATA                               
              WRITE TRF-PRTREC FROM MAIL-HDR-FROM                               
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRF-OIC1(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO TRF-PRTREC                                  
                    STRING WS-TRF-TYP1(WS-I) ':<'                               
                           WS-TRF-OIC1(WS-I) '@hdb.gov.sg>'                     
                           DELIMITED BY SPACES INTO TRF-PRTREC                  
                    WRITE TRF-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRF-PRTREC FROM MAIL-TRFA-SUBJECT                           
           END-IF.                                                              
                                                                                
       3250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3400-MAIL-COMP.                                                          
      *-------------------------------------------------------------            
                                                                                
           IF WS-COM-HDR-WRITE NOT = 'Y'                                        
              WRITE COM-PRTREC FROM MAIL-HDR-HELO                               
              WRITE COM-PRTREC FROM MAIL-HDR-MAIL-FROM                          
              PERFORM 3410-COM-OIC  THRU 3410-EXIT                              
              WRITE COM-PRTREC FROM MAIL-HDR-DATE                               
              WRITE COM-PRTREC FROM MAIL-SPACES                                 
              IF K800-NUM-REGN(1:1) = '5'                                       
                 WRITE COM-PRTREC FROM MAIL-DTL-HDR-COM-DBS                     
                 WRITE COM-PRTREC FROM MAIL-DTL-FIL-COM-DBS                     
              ELSE                                                              
                 WRITE COM-PRTREC FROM MAIL-DTL-HDR-COM                         
                 WRITE COM-PRTREC FROM MAIL-DTL-FIL-COM                         
              END-IF                                                            
              MOVE 'Y'                      TO WS-COM-HDR-WRITE                 
           END-IF.                                                              
                                                                                
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE K800-NUM-REGN               TO MAIL-COM-REGN-DBS             
                                                  K022-NUM-REGN                 
              PERFORM 8010-READ-BP13K022  THRU 8010-EXIT                        
              MOVE WS-CSM-MAIL-ID      TO    MAIL-COM-OIC-DBS                   
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-COM-PRJCT-DBS            
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-NEW-DBS               
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-SOLD-DBS              
              STRING K010-DTE-STATUS-UPDATE(17)(7:2) '/'                        
                     K010-DTE-STATUS-UPDATE(17)(5:2) '/'                        
                     K010-DTE-STATUS-UPDATE(17)(1:4)                            
                     DELIMITED BY SIZE INTO MAIL-COM-DTE-APPRL-DBS              
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-COM-CASE-NO-OIC-DBS            
                                                                                
              WRITE COM-PRTREC FROM MAIL-DTL-CASE-COM-DBS                       
           ELSE                                                                 
              MOVE K800-NUM-REGN               TO MAIL-COM-REGN                 
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-COM-PRJCT                
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-NEW                   
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-SOLD                  
              STRING K010-DTE-STATUS-UPDATE(17)(7:2) '/'                        
                     K010-DTE-STATUS-UPDATE(17)(5:2) '/'                        
                     K010-DTE-STATUS-UPDATE(17)(1:4)                            
                     DELIMITED BY SIZE INTO MAIL-COM-DTE-APPRL                  
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-COM-CASE-NO-OIC                
                                                                                
              WRITE COM-PRTREC FROM MAIL-DTL-CASE-COM                           
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3405-MAIL-COM-OIC.                                                       
      *-------------------------------------------------------------            
                                                                                
           MOVE K010-CDE-INIT-OIC1        TO K050-CDE-INIT-OIC                  
           PERFORM 8005-READ-BB24K050   THRU 8005-EXIT                          
           IF NOT BB24K050-FND                                                  
              GO TO 3405-EXIT                                                   
           END-IF.                                                              
                                                                                
           WRITE COM2-PRTREC FROM MAIL-HDR-HELO                                 
           WRITE COM2-PRTREC FROM MAIL-HDR-MAIL-FROM                            
           MOVE SPACES  TO COM2-PRTREC                                          
           STRING 'RCPT TO:<' DELIMITED BY SIZE                                 
                   K050-NME-LOTUS-NOTES DELIMITED BY SPACES                     
                  '@hdb.gov.sg>'                                                
                  DELIMITED BY SPACES INTO COM2-PRTREC                          
           WRITE COM2-PRTREC                                                    
                                                                                
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE K800-NUM-REGN               TO K022-NUM-REGN                 
              PERFORM 8010-READ-BP13K022  THRU 8010-EXIT                        
              IF (WS-CSM-MAIL-ID NOT = SPACES AND LOW-VALUES)                   
                 MOVE SPACES  TO COM2-PRTREC                                    
                 STRING 'RCPT TO:<' DELIMITED BY SIZE                           
                         WS-CSM-MAIL-ID DELIMITED BY SPACES                     
                        '@hdb.gov.sg>'                                          
                         DELIMITED BY SPACES INTO COM2-PRTREC                   
                 WRITE COM2-PRTREC                                              
              END-IF                                                            
           END-IF                                                               
                                                                                
           WRITE COM2-PRTREC FROM MAIL-HDR-DATA                                 
           WRITE COM2-PRTREC FROM MAIL-HDR-FROM                                 
           MOVE SPACES  TO COM2-PRTREC                                          
           STRING 'TO:<' DELIMITED BY SIZE                                      
                  K050-NME-LOTUS-NOTES DELIMITED BY SPACES                      
                  '@hdb.gov.sg>' DELIMITED BY SPACES                            
                  INTO COM2-PRTREC                                              
           WRITE COM2-PRTREC                                                    
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE K800-NUM-REGN               TO K022-NUM-REGN                 
              PERFORM 8010-READ-BP13K022  THRU 8010-EXIT                        
              IF (WS-CSM-MAIL-ID NOT = SPACES AND LOW-VALUES)                   
                 MOVE SPACES  TO COM2-PRTREC                                    
                 STRING 'TO:<' DELIMITED BY SIZE                                
                         WS-CSM-MAIL-ID DELIMITED BY SPACES                     
                        '@hdb.gov.sg>'                                          
                         DELIMITED BY SPACES INTO COM2-PRTREC                   
                 WRITE COM2-PRTREC                                              
              END-IF                                                            
           END-IF                                                               
           IF K800-NUM-REGN(1:1) NOT = '5'                                      
              WRITE COM2-PRTREC FROM MAIL-COM-SUBJECT                           
           ELSE                                                                 
              WRITE COM2-PRTREC FROM MAIL-COMA-SUBJECT                          
           END-IF                                                               
           WRITE COM2-PRTREC FROM MAIL-HDR-DATE                                 
           WRITE COM2-PRTREC FROM MAIL-SPACES                                   
           IF K800-NUM-REGN(1:1) = '5'                                          
              WRITE COM2-PRTREC FROM MAIL-DTL-HDR-COM-DBS                       
              WRITE COM2-PRTREC FROM MAIL-DTL-FIL-COM-DBS                       
              MOVE K800-NUM-REGN               TO MAIL-COM-REGN-DBS             
              MOVE WS-CSM-MAIL-ID      TO    MAIL-COM-OIC-DBS                   
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-COM-PRJCT-DBS            
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-NEW-DBS               
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-SOLD-DBS              
              STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(5:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(1:4)                             
                     DELIMITED BY SIZE INTO MAIL-COM-DTE-APPRL-DBS              
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-COM-CASE-NO-OIC-DBS            
                                                                                
              WRITE COM2-PRTREC FROM MAIL-DTL-CASE-COM-DBS                      
           ELSE                                                                 
              WRITE COM2-PRTREC FROM MAIL-DTL-HDR-COM                           
              WRITE COM2-PRTREC FROM MAIL-DTL-FIL-COM                           
              MOVE K800-NUM-REGN               TO MAIL-COM-REGN                 
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-COM-PRJCT                
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-NEW                   
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-COM-FLAT-SOLD                  
              STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(5:2) '/'                         
                     K010-DTE-STATUS-UPDATE(6)(1:4)                             
                     DELIMITED BY SIZE INTO MAIL-COM-DTE-APPRL                  
              STRING K010-NUM-CASE OF BB24K010-REC                              
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-COM-CASE-NO-OIC                
                                                                                
              WRITE COM2-PRTREC FROM MAIL-DTL-CASE-COM                          
           END-IF                                                               
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE SPACES TO COM2-PRTREC                                        
              WRITE COM2-PRTREC                                                 
              WRITE COM2-PRTREC FROM  MAIL-TXT-1                                
              MOVE SPACES TO COM2-PRTREC                                        
              WRITE COM2-PRTREC FROM  MAIL-TXT-2                                
              MOVE SPACES TO COM2-PRTREC                                        
              WRITE COM2-PRTREC FROM  MAIL-TXT-3                                
              MOVE SPACES TO COM2-PRTREC                                        
              MOVE SPACES TO COM2-PRTREC                                        
              WRITE COM2-PRTREC                                                 
              WRITE COM2-PRTREC FROM  MAIL-TXT-4                                
           END-IF                                                               
                                                                                
           WRITE COM2-PRTREC FROM MAIL-END.                                     
                                                                                
       3405-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3410-COM-OIC.                                                            
      *-------------------------------------------------------------            
           IF K800-NUM-REGN(1:1) NOT = '5'                                      
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-COM-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
                    MOVE SPACES  TO COM-PRTREC                                  
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-COM-OIC(WS-I) DELIMITED BY SPACES                 
                           '@hdb.gov.sg>'                                       
                           DELIMITED BY SPACES INTO COM-PRTREC                  
                    WRITE COM-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE COM-PRTREC FROM MAIL-HDR-DATA                               
              WRITE COM-PRTREC FROM MAIL-HDR-FROM                               
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-RSL-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
                 IF WS-COM-OIC(WS-I) NOT = SPACES AND LOW-VALUES                
                    MOVE SPACES  TO COM-PRTREC                                  
      *             STRING WS-RSL-TYP(WS-I) ':<'                                
      *                    WS-RSL-OIC(WS-I) '@hdb.gov.sg>'                      
                    STRING WS-COM-TYP(WS-I) ':<'                                
                           WS-COM-OIC(WS-I) '@hdb.gov.sg>'                      
                           DELIMITED BY SPACES INTO COM-PRTREC                  
                    WRITE COM-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE COM-PRTREC FROM MAIL-COM-SUBJECT                            
           ELSE                                                                 
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-COM-OIC1(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO COM-PRTREC                                  
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-COM-OIC1(WS-I) DELIMITED BY SPACES                
                           '@hdb.gov.sg>'                                       
                           DELIMITED BY SPACES INTO COM-PRTREC                  
                    WRITE COM-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE COM-PRTREC FROM MAIL-HDR-DATA                               
              WRITE COM-PRTREC FROM MAIL-HDR-FROM                               
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-RSL-OIC1(WS-I) NOT = SPACES AND LOW-VALUES               
                 IF WS-COM-OIC1(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO COM-PRTREC                                  
      *             STRING WS-RSL-TYP1(WS-I) ':<'                               
      *                    WS-RSL-OIC1(WS-I) '@hdb.gov.sg>'                     
                    STRING WS-COM-TYP1(WS-I) ':<'                               
                           WS-COM-OIC1(WS-I) '@hdb.gov.sg>'                     
                           DELIMITED BY SPACES INTO COM-PRTREC                  
                    WRITE COM-PRTREC                                            
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE COM-PRTREC FROM MAIL-COMA-SUBJECT                           
           END-IF.                                                              
                                                                                
       3410-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3500-MAIL-TRF-COMP.                                                      
      *-------------------------------------------------------------            
                                                                                
           IF WS-TRFC-HDR-WRITE NOT = 'Y'                                       
              WRITE TRFC-PRTREC FROM MAIL-HDR-HELO                              
              WRITE TRFC-PRTREC FROM MAIL-HDR-MAIL-FROM                         
              PERFORM 3550-TRFC-OIC  THRU 3550-EXIT                             
      *       PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-TRFC-OIC(WS-I) NOT = SPACES AND LOW-VALUES               
      *             MOVE SPACES  TO TRFC-PRTREC                                 
      *             STRING 'RCPT TO:<' DELIMITED BY SIZE                        
      *                    WS-TRFC-OIC(WS-I) '@hdb.gov.sg>'                     
      *                    DELIMITED BY SPACES INTO TRFC-PRTREC                 
      *             WRITE TRFC-PRTREC                                           
      *          END-IF                                                         
      *       END-PERFORM                                                       
      *       WRITE TRFC-PRTREC FROM MAIL-HDR-DATA                              
      *       WRITE TRFC-PRTREC FROM MAIL-HDR-FROM                              
      *       PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
      *          IF WS-TRFC-OIC(WS-I) NOT = SPACES AND LOW-VALUES               
      *             MOVE SPACES  TO TRFC-PRTREC                                 
      *             STRING WS-TRFC-TYP(WS-I) ':<'                               
      *                    WS-TRFC-OIC(WS-I) '@hdb.gov.sg>'                     
      *                    DELIMITED BY SPACES INTO TRFC-PRTREC                 
      *             WRITE TRFC-PRTREC                                           
      *          END-IF                                                         
      *       END-PERFORM                                                       
      *       WRITE TRFC-PRTREC FROM MAIL-TRFC-SUBJECT                          
              WRITE TRFC-PRTREC FROM MAIL-HDR-DATE                              
              WRITE TRFC-PRTREC FROM MAIL-SPACES                                
              IF K800-NUM-REGN(1:1) = '5'                                       
                 WRITE TRFC-PRTREC FROM MAIL-DTL-HDR-TRFC-DBS                   
                 WRITE TRFC-PRTREC FROM MAIL-DTL-FIL-DBS                        
              ELSE                                                              
                 WRITE TRFC-PRTREC FROM MAIL-DTL-HDR-TRFC                       
                 WRITE TRFC-PRTREC FROM MAIL-DTL-FIL                            
              END-IF                                                            
              MOVE 'Y'                      TO WS-TRFC-HDR-WRITE                
           END-IF.                                                              
                                                                                
           IF K800-NUM-REGN(1:1) = '5'                                          
              MOVE K800-NUM-REGN               TO MAIL-REGN-DBS                 
                                                  K022-NUM-REGN                 
              PERFORM 8010-READ-BP13K022  THRU 8010-EXIT                        
              MOVE WS-CSM-MAIL-ID      TO    MAIL-OIC-DBS                       
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-PRJCT-DBS                
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-FLAT-NEW-DBS                   
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-FLAT-SOLD-DBS                  
                                                                                
              IF BB13K010-FND                                                   
                 STRING K010-DTE-LEGAL-DOC-SIGN(7:2) '/'                        
                        K010-DTE-LEGAL-DOC-SIGN(5:2) '/'                        
                        K010-DTE-LEGAL-DOC-SIGN(1:4)                            
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL-DBS               
              ELSE                                                              
                 STRING K500-DTE-LEGAL-DOC-SIGN(7:2) '/'                        
                        K500-DTE-LEGAL-DOC-SIGN(5:2) '/'                        
                        K500-DTE-LEGAL-DOC-SIGN(1:4)                            
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL-DBS               
              END-IF                                                            
                                                                                
              WRITE  TRFC-PRTREC FROM MAIL-DTL-CASE-DBS                         
           ELSE                                                                 
              MOVE K800-NUM-REGN               TO MAIL-REGN                     
              MOVE K800-NUM-DBSS-PRJCT         TO MAIL-PRJCT                    
              STRING K800-NUM-SCH-ACC(1:4) '-' K800-NUM-SCH-ACC(5:4) '-'        
                     K800-NUM-SCH-ACC(9:1) '-' K800-NUM-SCH-ACC(10:2)           
                     DELIMITED BY SIZE INTO MAIL-FLAT-NEW                       
              STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(5:4) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(9:1) '-'                          
                     F482-NUM-HDBREF-DISPOSAL(10:2)                             
                     DELIMITED BY SIZE INTO MAIL-FLAT-SOLD                      
                                                                                
              IF BB13K010-FND                                                   
                 STRING K010-DTE-LEGAL-DOC-SIGN(7:2) '/'                        
                        K010-DTE-LEGAL-DOC-SIGN(5:2) '/'                        
                        K010-DTE-LEGAL-DOC-SIGN(1:4)                            
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL                   
              ELSE                                                              
                 STRING K500-DTE-LEGAL-DOC-SIGN(7:2) '/'                        
                        K500-DTE-LEGAL-DOC-SIGN(5:2) '/'                        
                        K500-DTE-LEGAL-DOC-SIGN(1:4)                            
                        DELIMITED BY SIZE INTO MAIL-DTE-APPRL                   
              END-IF                                                            
                                                                                
              WRITE  TRFC-PRTREC FROM MAIL-DTL-CASE                             
           END-IF.                                                              
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3550-TRFC-OIC.                                                           
      *-------------------------------------------------------------            
           IF K800-NUM-REGN(1:1) NOT = '5'                                      
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRFC-OIC(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO TRFC-PRTREC                                 
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-TRFC-OIC(WS-I) '@hdb.gov.sg>'                     
                           DELIMITED BY SPACES INTO TRFC-PRTREC                 
                    WRITE TRFC-PRTREC                                           
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRFC-PRTREC FROM MAIL-HDR-DATA                              
              WRITE TRFC-PRTREC FROM MAIL-HDR-FROM                              
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRFC-OIC(WS-I) NOT = SPACES AND LOW-VALUES               
                    MOVE SPACES  TO TRFC-PRTREC                                 
                    STRING WS-TRFC-TYP(WS-I) ':<'                               
                           WS-TRFC-OIC(WS-I) '@hdb.gov.sg>'                     
                           DELIMITED BY SPACES INTO TRFC-PRTREC                 
                    WRITE TRFC-PRTREC                                           
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRFC-PRTREC FROM MAIL-TRFC-SUBJECT                          
           ELSE                                                                 
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRFC-OIC1(WS-I) NOT = SPACES AND LOW-VALUES              
                    MOVE SPACES  TO TRFC-PRTREC                                 
                    STRING 'RCPT TO:<' DELIMITED BY SIZE                        
                           WS-TRFC-OIC1(WS-I) '@hdb.gov.sg>'                    
                           DELIMITED BY SPACES INTO TRFC-PRTREC                 
                    WRITE TRFC-PRTREC                                           
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRFC-PRTREC FROM MAIL-HDR-DATA                              
              WRITE TRFC-PRTREC FROM MAIL-HDR-FROM                              
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                  
                 IF WS-TRFC-OIC1(WS-I) NOT = SPACES AND LOW-VALUES              
                    MOVE SPACES  TO TRFC-PRTREC                                 
                    STRING WS-TRFC-TYP1(WS-I) ':<'                              
                           WS-TRFC-OIC1(WS-I) '@hdb.gov.sg>'                    
                           DELIMITED BY SPACES INTO TRFC-PRTREC                 
                    WRITE TRFC-PRTREC                                           
                 END-IF                                                         
              END-PERFORM                                                       
              WRITE TRFC-PRTREC FROM MAIL-TRFB-SUBJECT                          
           END-IF.                                                              
                                                                                
       3550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8001-READ-BP13K800.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF BP13K800-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-K800-FND                             
           ELSE                                                                 
              IF BP13K800-STATUS = 23                                           
                 MOVE 'N'            TO WS-K800-FND                             
              ELSE                                                              
                 DISPLAY 'BP13K800 - READ ERROR (' BP13K800-STATUS ')'          
                 MOVE BP13K800-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8002-READ-BB24K010.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BB24K010 KEY IS K010-ALT-KEY1.                                  
                                                                                
           IF BB24K010-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-BB24K010-FND                         
           ELSE                                                                 
              IF BB24K010-STATUS = 23                                           
                 MOVE 'N'            TO WS-BB24K010-FND                         
              ELSE                                                              
                 DISPLAY 'BB24K010 - READ ERROR (' BB24K010-STATUS ')'          
                 MOVE BB24K010-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8003-READ-BB13K010.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BB13K010.                                                       
                                                                                
           IF BB13K010-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-BB13K010-FND                         
           ELSE                                                                 
              IF BB13K010-STATUS = 23                                           
                 MOVE 'N'            TO WS-BB13K010-FND                         
              ELSE                                                              
                 DISPLAY 'BB13K010 - READ ERROR (' BB13K010-STATUS ')'          
                 MOVE BB13K010-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8003-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8004-READ-BM06K110.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BM06K110.                                                       
                                                                                
           IF BM06K110-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-BM06K110-FND                         
           ELSE                                                                 
              IF BM06K110-STATUS = 23                                           
                 MOVE 'N'            TO WS-BM06K110-FND                         
              ELSE                                                              
                 DISPLAY 'BM06K110 - READ ERROR (' BM06K110-STATUS ')'          
                 MOVE BM06K110-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8004-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8005-READ-BB24K050.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BB24K050 KEY IS K050-ALT-KEY.                                   
                                                                                
           IF BB24K050-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-BB24K050-FND                         
           ELSE                                                                 
              IF BB24K050-STATUS = 23                                           
                 MOVE 'N'            TO WS-BB24K050-FND                         
              ELSE                                                              
                 DISPLAY 'BB24K050 - READ ERROR (' BB24K050-STATUS ')'          
                 MOVE BB24K050-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8006-READ-BB13K500.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BB13K500.                                                       
                                                                                
           IF BB13K500-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-BB13K500-FND                         
           ELSE                                                                 
              IF BB13K500-STATUS = 23                                           
                 MOVE 'N'            TO WS-BB13K500-FND                         
              ELSE                                                              
                 DISPLAY 'BB13K500 - READ ERROR (' BB13K500-STATUS ')'          
                 MOVE BB13K500-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8006-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8010-READ-BP13K022.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF BP13K022-STATUS = 00 OR 02                                        
              IF K022-NUM-OIC-APPL = SPACES OR LOW-VALUES                       
                 MOVE K022-NUM-OIC        TO    WS-CSM-MAIL-ID                  
              ELSE                                                              
                 MOVE K022-NUM-OIC-APPL   TO    WS-CSM-MAIL-ID                  
              END-IF                                                            
           ELSE                                                                 
              IF BP13K022-STATUS = 23                                           
                 MOVE SPACES         TO K022-NUM-OIC K022-NUM-OIC-APPL          
              ELSE                                                              
                 DISPLAY 'BP13K022 - READ ERROR (' BP13K022-STATUS ')'          
                 MOVE BP13K022-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY ' - BP13CD85 CONTROL TOTALS -----'.                          
           DISPLAY ' '.                                                         
           DISPLAY ' NO. OF BP13F482 RECS READ   = ' CNT-F482-READ.             
           DISPLAY ' NO. OF BP13K800 NOT FND     = ' CNT-K800-NOTFND.           
           DISPLAY ' NO. OF BP13K800 NOT BUY 1ST = ' CNT-K800-NOTBUY1ST.        
           DISPLAY ' NO. OF BB24K010 NOT FND     = ' CNT-K010-NOTFND.           
           DISPLAY ' '.                                                         
                                                                                
            CLOSE BP13F482                                                      
                  BP13K800                                                      
                  BP13K022                                                      
                  BM06K110                                                      
                  BB13K010                                                      
                  BB13K500                                                      
                  BB24K010                                                      
                  BB24K050                                                      
                  SY02F001                                                      
                  BP13RSL                                                       
                  BP13RSL2                                                      
                  BP13TRF                                                       
                  BP13COMP                                                      
                  BP13COM2                                                      
                  BP13TRFC.                                                     
           IF BP13K800-STATUS NOT = 00                                          
              DISPLAY 'BP13K800 - OPEN ERROR (' BP13K800-STATUS ')'             
           END-IF.                                                              
           IF BP13K022-STATUS NOT = 00                                          
              DISPLAY 'BP13K022 - OPEN ERROR (' BP13K022-STATUS ')'             
           END-IF.                                                              
           IF BM06K110-STATUS NOT = 00                                          
              DISPLAY 'BM06K110 - OPEN ERROR (' BM06K110-STATUS ')'             
           END-IF.                                                              
           IF BB13K010-STATUS NOT = 00                                          
              DISPLAY 'BB13K010 - CLOSE ERROR (' BB13K010-STATUS ')'            
           END-IF.                                                              
           IF BB13K500-STATUS NOT = 00                                          
              DISPLAY 'BB13K500 - CLOSE ERROR (' BB13K500-STATUS ')'            
           END-IF.                                                              
           IF BB24K010-STATUS NOT = 00                                          
              DISPLAY 'BB24K010 - CLOSE ERROR (' BB24K010-STATUS ')'            
           END-IF.                                                              
           IF BB24K050-STATUS NOT = 00                                          
              DISPLAY 'BB24K050 - CLOSE ERROR (' BB24K050-STATUS ')'            
           END-IF.                                                              
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
