      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
       PROGRAM-ID.    BP13C403.                                                 
      *AUTHOR.        KH LEE.                                                   
      *DATE-WRITTEN.  05/10/89.                                                 
                                                                                
      *===============================================================*         
      *               SYSTEM OF COMMITMENT  (BP13)                    *         
      *===============================================================*         
      *    OBJECTIVE   :                                              *         
      *       1.  THIS PROGRAM WILL PRINT OUT THE SUMMARY             *         
      *           LIST OF SALES ORDER RAISED AND KEY ISSUED,          *         
      *           FOR ALL SALES TYPE.                                 *         
      *                                                               *         
      *    INPUT FILES :                                              *         
      *       1.  BM06K110                                            *         
      *       2.  BP13F410                                            *         
      *                                                               *         
      *    LISTING     :                                              *         
      *       1.  S.O. RAISED FOR KEY ISSUED   (BP13L403)             *         
      *                                                               *         
      *    SUB-PROGRAM :                                              *         
      *       1.  BP13C913 - TO GET FLAT INFO FROM PIDB TABLE         *         
      *                                                               *         
      *===============================================================*         
      *  CHG-REQ BY   DATE   DESCRIPTION                              *         
      *  ------- --- ------  -----------                              *         
      *  C9207A9 LJL 920817  TO ALLOW SA-TP CASE TO BYPASS THE        *         
      *                      PRINTING FOR TYPE 10 TO FACILITATE       *         
      *                      PRINTING OF SA-TP CASE IN BP13L605.      *         
      *  SOC-PH8 JEP 930804  TO GET ADDRESS, BLK & STREET NAME        *         
      *                      BY CALLING SUB-PROGRAM BP13C904.         *         
      *  C9404E6 BAL 940517  TO CATER FOR SALES TYPE 2B.              *         
      *  C950330 LJL 950309  TO CATER FOR BOOKING FEE TRANSFER TO     *         
      *                      COMMITMENT DEPOSIT FOR AA CASES,         *         
      *                      SALES TYPE 1, 2, 3 EXCEPT 2B.            *         
      *                      TO ENSURE THAT BUYBACK FLATS IS          *         
      *                      PRINTED SEPARATELY.                      *         
      * BP130037 LJL 951018  TO CATER FOR THE AMALGAMATION OF         *         
      *                      SALES TYPE 1,2,2B,3,3A AND 10.           *         
      * BP130020 SSS 951010  CHG FORMAT OF RPT-ID                     *         
      * BP130418 SIA 980309  CHGE BM06K211 TO BM06K110                *         
      * BP130883 RAS 000807  TO CHANGE BP13C904 TO BP13C913           *         
      * BP130998 CLT 150501  TO CATER FOR SALES TYPE 13               *         
      * BP132378 MALC160703  BANK CASE TO DISPLAY CF-TYPE OR WARR-ACT *         
      * BP134779 PCL4130613  TO CONVERT THE REPORT TO SENDMAIL        *         
      * BP135537 RJB1230215  CHANGE THE EMAIL RECIPIENT FROM NICKNAME *         
      *                      INTO COMPLETE NAME                       *         
      * BP136339 PCL4120716  TO ADD NEW EMAIL RECIPIENTS              *         
      * BP136477 RJB 181016  TO REPLACE KIM HUAT TO YEE MIEN          *         
      * BP136625 RJB 010217  REMOVE NORMALA BUANG, INCLUDE CHANDRA    *         
      *                      ARUMUGAM AND MEENACHI                    *         
      * BP136685 PCL 030417  TO UPDATE EMAIL/REPORT FORMAT            *         
      *===============================================================*         
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F410   ASSIGN        TO  BP13F410.                        
                                                                                
           SELECT BM06K110   ASSIGN        TO  BM06K110                         
                             ACCESS MODE   IS  RANDOM                           
                             ORGANIZATION  IS  INDEXED                          
                             RECORD KEY    IS  K110-KEY-FLD                     
                             FILE STATUS   IS  K110-STATUS.                     
                                                                                
           SELECT BP13L403   ASSIGN        TO  BP13L403.                        
                                                                                
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F410                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            RECORDING MODE  IS   F.                                             
       COPY BP13F410.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD  BP13L403                                                             
                                                                                
                               BLOCK CONTAINS 0 RECORDS                         
                               RECORDING MODE IS V                              
                               LABEL RECORD IS STANDARD.                        
       01  PRINT-REC-1                   PIC X(200).                            
                                                                                
                                                                                
      ************************                                                  
       WORKING-STORAGE SECTION.                                                 
      ************************                                                  
                                                                                
                                                                                
       01  FILE-INDICATORS.                                                     
           05  K110-STATUS            PIC 9(2)    VALUE ZEROS.                  
           05  EOF-F410               PIC X       VALUE SPACES.                 
           05  K110-REC-FOUND         PIC X       VALUE SPACES.                 
                                                                                
       01  WS-COUNTERS.                                                         
           05  CNT1                   PIC 9        VALUE ZEROS.                 
           05  LINE-CNT1              PIC 9(2)     VALUE 30.                    
           05  NO-OF-PAGE1            PIC 9(4)     VALUE ZEROS.                 
           05  SEQUENCE-NO1           PIC 9(4)     VALUE ZEROS.                 
           05  TOT-LOAN-AMT1          PIC S9(8)V99 VALUE ZEROS.                 
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-PREV-SALES-TYPE     PIC X(2)    VALUE SPACES.                 
           05  WS-NAME3               PIC X(60)   VALUE SPACES.                 
           05  WS-NAME4               PIC X(60)   VALUE SPACES.                 
           05  WS-HSE-SUB.                                                      
               10  WS-HSE-SUB1        PIC X(1)    VALUE SPACE.                  
               10  WS-HSE-SUB2        PIC X(2)    VALUE SPACES.                 
           05  WS-SQL-CODE            PIC 9(4)    VALUE ZEROES.                 
                                                                                
       01  WS-CURRENT-DATE.                                                     
           05  WS-CURRENT-CC          PIC 99      VALUE ZEROES.                 
           05  WS-CURRENT-YY          PIC 99      VALUE ZEROES.                 
           05  WS-CURRENT-MM          PIC 99      VALUE ZEROES.                 
           05  WS-CURRENT-DD          PIC 99      VALUE ZEROES.                 
                                                                                
       01  WS-EDITED-DATE.                                                      
           05  WS-EDITED-DD           PIC 99      VALUE ZEROES.                 
           05  FILLER                 PIC X       VALUE '/'.                    
           05  WS-EDITED-MM           PIC 99      VALUE ZEROES.                 
           05  FILLER                 PIC X       VALUE '/'.                    
           05  WS-EDITED-CC           PIC 99      VALUE ZEROES.                 
           05  WS-EDITED-YY           PIC 99      VALUE ZEROES.                 
                                                                                
       01  WS-SO-DATE.                                                          
           05  WS-SO-YY1              PIC X(2)    VALUE SPACES.                 
           05  WS-SO-YY2              PIC X(2)    VALUE SPACES.                 
           05  WS-SO-MM               PIC X(2)    VALUE SPACES.                 
           05  WS-SO-DD               PIC X(2)    VALUE SPACES.                 
                                                                                
       01  WS-AGMT-DATE.                                                        
           05  WS-AGMT-CC             PIC X(2)    VALUE SPACES.                 
           05  WS-AGMT-YY             PIC X(2)    VALUE SPACES.                 
           05  WS-AGMT-MM             PIC X(2)    VALUE SPACES.                 
           05  WS-AGMT-DD             PIC X(2)    VALUE SPACES.                 
                                                                                
                                                                                
      *----------------------------------------------------------------*        
      *        LINKAGE FOR SUB-PROGRAM  BP13C913                       *        
      *----------------------------------------------------------------*        
       01  WS-LINK-REC.                                                         
           05  WS-LINK-NUM-SCH-ACC.                                             
               10  WS-LINK-NUM-SCH    PIC X(4).                                 
               10  WS-LINK-NUM-ACC    PIC X(5).                                 
                                                                                
       COPY P13COMM8.                                                           
                                                                                
      *----------------------------------------------------------------*        
      *        PRINT HEADINGS LINES                                    *        
      *----------------------------------------------------------------*        
       01  L403-PR-HEAD-1.                                                      
           05  RPT-ID                 PIC X(8)    VALUE 'BP13L403'.             
           05  FILLER                 PIC X(5)    VALUE SPACES.                 
           05  FILLER                 PIC X(26)   VALUE 'HDB3'.                 
           05  FILLER                 PIC X(63)   VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                 PIC X(7)    VALUE 'DATE : '.              
           05  WS-PRINT-DATE          PIC X(11)   VALUE SPACES.                 
           05  FILLER                 PIC X(7)    VALUE 'PAGE : '.              
           05  WS-PAGE                PIC ZZZ9.                                 
                                                                                
       01  L403-PR-HEAD-2.                                                      
           05  FILLER                 PIC X(33)   VALUE SPACES.                 
           05  FILLER                 PIC X(35)   VALUE                         
               'SUMMARY LIST OF SALES ORDER RAISED'.                            
           05  WS-DESC                PIC X(18)   VALUE                         
               'FOR KEY ISSUED'.                                                
           05  FILLER                 PIC X(16)   VALUE SPACES.                 
           05  FILLER                 PIC X(29)   VALUE                         
               'USER : AGREEMENT TEAM (SALES)'.                                 
                                                                                
       01  L403-PR-HEAD-4.                                                      
           05  FILLER                 PIC X(132)  VALUE ALL '-'.                
                                                                                
       01  L403-PR-HEAD-5.                                                      
           05  FILLER                 PIC X(118)  VALUE 'T O T A L : '.         
           05  WS-TOT-AMT             PIC ZZ,ZZZ,ZZ9.99.                        
                                                                                
       01  L403-PR-HEAD-6.                                                      
           05  FILLER                 PIC X(30)   VALUE                         
               ' S\N    SCH-ACC-NO'.                                            
           05  FILLER                 PIC X(30)  VALUE 'APPLICANT (S)'.         
           05  FILLER                 PIC X(33)   VALUE 'FLAT ADDRESS'.         
           05  FILLER                 PIC X(39)   VALUE                         
               'SALES AGRMT DATE  PREMIUM   LOAN AMOUNT'.                       
                                                                                
       01  L403-PR-HEAD-7.                                                      
           05  FILLER                 PIC X(8)    VALUE SPACES.                 
           05  FILLER                 PIC X(25)   VALUE 'REGN NO'.              
           05  FILLER                 PIC X(60)   VALUE 'NAME'.                 
           05  FILLER                 PIC X(38)   VALUE                         
               'SALES ORDER DATE   (%)        ($)'.                             
                                                                                
       01  L403-PR-HEAD-A.                                                      
           05  FILLER                 PIC X(45)   VALUE SPACES.                 
           05  FILLER                 PIC X(29)   VALUE                         
               'FOR ADVANCE ALLLOCATION FLAT'.                                  
                                                                                
       01  L403-PR-HEAD-B.                                                      
           05  FILLER                 PIC X(45)   VALUE SPACES.                 
           05  FILLER                 PIC X(31)   VALUE                         
               'FOR SYSTEM OF COMMMITMENT FLAT'.                                
                                                                                
       01  L403-PR-HEAD-C.                                                      
           05  FILLER                 PIC X(47)   VALUE SPACES.                 
           05  FILLER                 PIC X(24)   VALUE                         
               'FOR SITTING TENANT FLAT'.                                       
                                                                                
       01  L403-PR-HEAD-C-2B.                                                   
           05  FILLER                 PIC X(47)   VALUE SPACES.                 
           05  FILLER                 PIC X(37)   VALUE                         
               'FOR SITTING TENANT FLAT WITH DISCOUNT'.                         
                                                                                
       01  L403-PR-HEAD-D.                                                      
           05  FILLER                 PIC X(49)   VALUE SPACES.                 
           05  FILLER                 PIC X(21)   VALUE                         
               'FOR REPURCHASED FLAT'.                                          
                                                                                
       01  L403-PR-HEAD-D-3A.                                                   
           05  FILLER                 PIC X(49)   VALUE SPACES.                 
           05  FILLER                 PIC X(31)   VALUE                         
               'FOR REPURCHASED FLAT (BUY-BACK)'.                               
                                                                                
       01  L403-PR-HEAD-E.                                                      
           05  FILLER                 PIC X(52)   VALUE SPACES.                 
           05  FILLER                 PIC X(14)   VALUE 'FOR HUDC FLAT'.        
                                                                                
       01  L403-PR-HEAD-F.                                                      
           05  FILLER                 PIC X(42)   VALUE SPACES.                 
           05  FILLER                 PIC X(56)   VALUE                         
               'FOR REPURCHASED HUDC FLAT'.                                     
                                                                                
       01  L403-PR-HEAD-G.                                                      
           05  FILLER                 PIC X(42)   VALUE SPACES.                 
           05  FILLER                 PIC X(56)   VALUE                         
               'FOR STUDIO APARTMENT FLAT'.                                     
                                                                                
      *----------------------------------------------------------------*        
      *        PRINT DETAIL LINES                                      *        
      *----------------------------------------------------------------*        
       01  L403-PR-DETAIL-1.                                                    
           05  FILLER                 PIC X       VALUE SPACES.                 
           05  405-SEQ-NO             PIC ZZZ9.                                 
           05  FILLER                 PIC X(3)    VALUE SPACES.                 
           05  405-SCH-ACC-NO         PIC X(14)   VALUE SPACES.                 
           05  FILLER                 PIC X(3)    VALUE SPACES.                 
           05  405-NAME1              PIC X(32)   VALUE SPACES.                 
           05  FILLER                 PIC X(3)    VALUE SPACES.                 
           05  405-BLK-DESC           PIC X(4)    VALUE SPACES.                 
           05  405-BLK-NO             PIC X(5)    VALUE SPACES.                 
           05  FILLER                 PIC X(1)    VALUE SPACE.                  
           05  405-HEX                PIC X(1)    VALUE '#'.                    
           05  405-HOUSE-NO           PIC X(7)    VALUE SPACES.                 
           05  FILLER                 PIC X(18)   VALUE SPACES.                 
           05  405-AGMT-DATE          PIC X(10)   VALUE SPACES.                 
           05  FILLER                 PIC X(10)   VALUE SPACES.                 
           05  405-PREMIUM-RATE       PIC X(2)    VALUE SPACES.                 
           05  FILLER                 PIC X(3)    VALUE SPACES.                 
           05  405-LOAN-AMT           PIC ZZZ,ZZ9.99-.                          
                                                                                
       01  L403-PR-DETAIL-2.                                                    
           05  FILLER                 PIC X(8)    VALUE SPACES.                 
           05  405-REGN-NO            PIC X(8)    VALUE SPACES.                 
           05  405-BANK-DESC          PIC X(8)    VALUE SPACES.                 
           05  FILLER                 PIC X(1)    VALUE SPACES.                 
           05  405-NAME2              PIC X(32)   VALUE SPACES.                 
           05  FILLER                 PIC X(3)    VALUE SPACES.                 
           05  405-STREET             PIC X(30)   VALUE SPACES.                 
           05  FILLER                 PIC X(6)    VALUE SPACES.                 
           05  405-SO-DATE            PIC X(10)   VALUE SPACES.                 
                                                                                
       01  L403-PR-DETAIL-3.                                                    
           05  FILLER                 PIC X(25)   VALUE SPACES.                 
           05  405-NAME3              PIC X(32)   VALUE SPACES.                 
                                                                                
       01  L403-PR-DETAIL-4.                                                    
           05  FILLER                 PIC X(25)   VALUE SPACES.                 
           05  405-NAME4              PIC X(32)   VALUE SPACES.                 
                                                                                
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
      *    MAIN LOGIC PROCESS SECTION                                  *        
      ******************************************************************        
       000-MAIN-ROUTINE.                                                        
                                                                                
           PERFORM  100-OPEN-ROUTINE        THRU  100-EXIT.                     
           PERFORM  200-READ-BP13F410       THRU  200-EXIT.                     
           MOVE     F410-CDE-SALES-TYPE     TO    WS-PREV-SALES-TYPE.           
           PERFORM  300-PRINT-SUMMARY-LIST  THRU  300-EXIT                      
                        UNTIL EOF-F410 = 'Y'                                    
           PERFORM  800-PRINT-TOTAL         THRU  800-EXIT.                     
           PERFORM  900-CLOSE-ROUTINE       THRU  900-EXIT.                     
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    OPENING FILES SECTION                                       *        
      ******************************************************************        
       100-OPEN-ROUTINE.                                                        
           OPEN INPUT  BM06K110                                                 
                       BP13F410                                                 
                OUTPUT BP13L403.                                                
                                                                                
           IF K110-STATUS NOT = 00 AND 97                                       
             DISPLAY 'OPENING ERROR, BM06K110-STATUS = ' K110-STATUS            
             MOVE K110-STATUS TO RETURN-CODE                                    
             PERFORM 900-CLOSE-ROUTINE.                                         
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    READ SEQUENTIAL FILE BP13F410 AT END SET EOF-IND TO 'Y'     *        
      ******************************************************************        
       200-READ-BP13F410.                                                       
           READ BP13F410 AT END                                                 
                          MOVE 'Y' TO EOF-F410                                  
                          GO TO 200-EXIT.                                       
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    PRINT OUT THE SUMMARY LIST OF SALES ORDER RAISED            *        
      ******************************************************************        
       300-PRINT-SUMMARY-LIST.                                                  
           MOVE    'Y'                TO   K110-REC-FOUND.                      
           PERFORM 400-READ-BM06K110  THRU 400-EXIT.                            
           PERFORM 500-CALL-BP13C913  THRU 500-EXIT.                            
                                                                                
           IF F410-CDE-SALES-TYPE = '10'                                        
              IF F410-CDE-SA-TP = 'Y'                                           
              DISPLAY 'REGN   = ' F410-KEY-FLD                                  
           ELSE                                                                 
              PERFORM 600-PROCESS-PRINT THRU 600-EXIT                           
           ELSE                                                                 
              PERFORM 600-PROCESS-PRINT THRU 600-EXIT.                          
                                                                                
           PERFORM 200-READ-BP13F410 THRU 200-EXIT.                             
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    READ VSAM FILE BM06K110 USING F410-SCH-ACC AS A KEY         *        
      ******************************************************************        
       400-READ-BM06K110.                                                       
           MOVE F410-NUM-SCH-ACC TO  K110-KEY-FLD.                              
                                                                                
           READ BM06K110.                                                       
                                                                                
           IF K110-STATUS = 00                                                  
              MOVE 'Y' TO K110-REC-FOUND                                        
           ELSE                                                                 
           IF K110-STATUS = 23                                                  
              MOVE 'N' TO K110-REC-FOUND                                        
           ELSE                                                                 
              DISPLAY 'READ ERROR, BM06K110-STATUS = ' K110-STATUS              
              DISPLAY 'F410-NUM-SCH-ACC = ' F410-NUM-SCH-ACC                    
              MOVE K110-STATUS TO RETURN-CODE                                   
              PERFORM 900-CLOSE-ROUTINE.                                        
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    CALL BP13C913 USING F410-NUM-SCH-ACC VALUES AS A KEY TO     *        
      *                  GET FLAT INFO FROM PIDB TABLE                 *        
      ******************************************************************        
       500-CALL-BP13C913.                                                       
                                                                                
           MOVE  SPACES                TO  BP13COMM8-REC.                       
           INITIALIZE                      BP13COMM8-REC.                       
                                                                                
           MOVE  F410-NUM-SCH-ACC      TO  WS-LINK-REC.                         
           CALL 'BP13C913'          USING  WS-LINK-REC,                         
                                           BP13COMM8-REC.                       
                                                                                
           IF COMM8-CDE-SYSERR NOT = 0                                          
              MOVE  COMM8-CDE-SYSERR TO WS-SQL-CODE                             
              DISPLAY 'F410-NUM-SCH-ACC =  ' F410-NUM-SCH-ACC                   
              IF COMM8-CDE-SYSERR = 100                                         
                 DISPLAY 'SCH NOT FOUND IN PIDB TABLE  ' WS-SQL-CODE            
              ELSE                                                              
                 DISPLAY 'ERROR READING PIDB TABLE  ' WS-SQL-CODE               
           ELSE                                                                 
              MOVE COMM8-NUM-UNIT-SUB TO WS-HSE-SUB.                            
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    CHECK F410-CDE-SALES-TYPE WITH WS-PREV-SALES-TYPE           *        
      ******************************************************************        
       600-PROCESS-PRINT.                                                       
           IF F410-CDE-SALES-TYPE = WS-PREV-SALES-TYPE                          
              NEXT SENTENCE                                                     
           ELSE                                                                 
              PERFORM 800-PRINT-TOTAL     THRU 800-EXIT                         
              MOVE    F410-CDE-SALES-TYPE TO   WS-PREV-SALES-TYPE               
              MOVE    30                  TO   LINE-CNT1                        
              MOVE    0                   TO   SEQUENCE-NO1.                    
                                                                                
           PERFORM 700-PRINT-DETAIL-LINE  THRU 700-EXIT.                        
                                                                                
       600-EXIT.                                                                
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
      *    PRINT DETAIL LINE FOR KEY ISSUED DATE NOT = ZEROS OR SPACES *        
      ******************************************************************        
       700-PRINT-DETAIL-LINE.                                                   
           ADD    1            TO  SEQUENCE-NO1.                                
           MOVE   SEQUENCE-NO1 TO  405-SEQ-NO.                                  
           STRING F410-SCHEME  '-' F410-ACC '-' F410-CHK '-'                    
                  F410-LESSEE-CODE DELIMITED BY SIZE                            
                  INTO 405-SCH-ACC-NO.                                          
                                                                                
           MOVE   F410-NAME1            TO  405-NAME1.                          
           MOVE   F410-NAME2            TO  405-NAME2.                          
           MOVE   F410-NAME3            TO  405-NAME3.                          
           MOVE   F410-NAME4            TO  405-NAME4.                          
           MOVE   F410-NUM-REGN         TO  405-REGN-NO.                        
                                                                                
           IF F410-NUM-LOAN-TAG = 'B'                                           
              IF F410-NUM-CF-TYPE = 'PC' OR 'PM' OR 'MG'                        
                 STRING '(BNK/' F410-NUM-CF-TYPE ')'                            
                  DELIMITED BY SIZE     INTO 405-BANK-DESC                      
              ELSE                                                              
                 IF F410-NUM-WARRANT-ACT = 'ES'                                 
                    MOVE '(BNK/ES)'     TO 405-BANK-DESC                        
                 ELSE                                                           
                    MOVE SPACES         TO 405-BANK-DESC                        
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES               TO 405-BANK-DESC                        
           END-IF.                                                              
                                                                                
           MOVE   F410-NUM-PREMIUM-RATE TO  405-PREMIUM-RATE.                   
           IF F410-DTE-SO-EXECUTION = SPACES OR LOW-VALUES OR ZEROES            
              MOVE SPACES TO 405-SO-DATE                                        
           ELSE                                                                 
              MOVE   F410-DTE-SO-EXECUTION TO  WS-SO-DATE                       
              STRING WS-SO-DD '/' WS-SO-MM '/'                                  
                     WS-SO-YY1 WS-SO-YY2 DELIMITED BY SIZE                      
                     INTO  405-SO-DATE                                          
           END-IF.                                                              
                                                                                
           IF K110-REC-FOUND = 'Y'                                              
              MOVE K110-DTE-SO-EXECUTING TO WS-AGMT-DATE                        
           ELSE                                                                 
              MOVE ZEROES                TO WS-AGMT-DATE.                       
                                                                                
           STRING WS-AGMT-DD '/' WS-AGMT-MM '/' WS-AGMT-CC                      
                 WS-AGMT-YY DELIMITED                                           
                 BY SIZE INTO 405-AGMT-DATE.                                    
                                                                                
           MOVE  F410-AMT-LOAN TO 405-LOAN-AMT.                                 
                                                                                
           IF    K110-REC-FOUND = 'N'                                           
                 MOVE SPACES TO 405-BLK-NO 405-HOUSE-NO 405-BLK-DESC            
                 MOVE SPACES TO 405-HEX    405-STREET                           
           ELSE                                                                 
                 MOVE 'BLK '              TO  405-BLK-DESC                      
                 MOVE COMM8-NUM-BLK       TO  405-BLK-NO                        
                 MOVE '#'                 TO  405-HEX                           
                 MOVE COMM8-NME-STREET    TO  405-STREET                        
                 STRING COMM8-NUM-LEVEL   '-' COMM8-NUM-UNIT-MAIN               
                        WS-HSE-SUB1 DELIMITED BY SIZE                           
                        INTO   405-HOUSE-NO.                                    
                                                                                
           IF LINE-CNT1 > 19                                                    
              PERFORM 720-PRINT-HEADER THRU 720-EXIT.                           
                                                                                
           MOVE  SPACES      TO    PRINT-REC-1.                                 
           WRITE PRINT-REC-1 AFTER 1.                                           
           WRITE PRINT-REC-1 FROM  L403-PR-DETAIL-1 AFTER 1.                    
           MOVE  SPACES      TO    PRINT-REC-1.                                 
           WRITE PRINT-REC-1 FROM  L403-PR-DETAIL-2 AFTER 1.                    
           ADD   1           TO    LINE-CNT1.                                   
                                                                                
           MOVE F410-NAME3  TO WS-NAME3.                                        
           INSPECT WS-NAME3 REPLACING ALL LOW-VALUES BY ' '.                    
           IF WS-NAME3 = SPACES                                                 
              NEXT SENTENCE                                                     
           ELSE                                                                 
              ADD   1          TO    CNT1                                       
              MOVE  SPACES     TO    PRINT-REC-1                                
              WRITE PRINT-REC-1 FROM L403-PR-DETAIL-3 AFTER 1.                  
                                                                                
           MOVE F410-NAME4  TO WS-NAME4.                                        
           INSPECT WS-NAME4 REPLACING ALL LOW-VALUES BY ' '.                    
           IF WS-NAME4 = SPACES                                                 
              NEXT SENTENCE                                                     
           ELSE                                                                 
              ADD   1           TO   CNT1                                       
              MOVE  SPACES      TO   PRINT-REC-1                                
              WRITE PRINT-REC-1 FROM L403-PR-DETAIL-4 AFTER 1.                  
                                                                                
           IF CNT1 = 2                                                          
              ADD    1   TO LINE-CNT1                                           
              MOVE   0   TO CNT1.                                               
           COMPUTE TOT-LOAN-AMT1 = TOT-LOAN-AMT1 + F410-AMT-LOAN.               
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    PRINT HEADING LINES SECTION                                 *        
      ******************************************************************        
       720-PRINT-HEADER.                                                        
           ADD    1                   TO   NO-OF-PAGE1.                         
           MOVE   NO-OF-PAGE1         TO   WS-PAGE.                             
           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.                       
           MOVE   WS-CURRENT-CC       TO   WS-EDITED-CC.                        
           MOVE   WS-CURRENT-YY       TO   WS-EDITED-YY.                        
           MOVE   WS-CURRENT-MM       TO   WS-EDITED-MM.                        
           MOVE   WS-CURRENT-DD       TO   WS-EDITED-DD.                        
           MOVE   WS-EDITED-DATE      TO   WS-PRINT-DATE.                       
           WRITE  PRINT-REC-1 FROM L403-PR-HEAD-1 AFTER PAGE.                   
           WRITE  PRINT-REC-1 FROM L403-PR-HEAD-2 AFTER 1.                      
                                                                                
           IF  WS-PREV-SALES-TYPE = '01'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-A AFTER 1.                  
           IF  WS-PREV-SALES-TYPE = '02'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-C AFTER 1.                  
           IF  WS-PREV-SALES-TYPE = '2B'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-C-2B AFTER 1.               
           IF  WS-PREV-SALES-TYPE = '03'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-D AFTER 1.                  
           IF  WS-PREV-SALES-TYPE = '3A'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-D-3A AFTER 1.               
           IF  WS-PREV-SALES-TYPE = '5B'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-E AFTER 1.                  
           IF  WS-PREV-SALES-TYPE = '5C'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-F AFTER 1.                  
           IF  WS-PREV-SALES-TYPE = '10'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-B AFTER 1.                  
           IF  WS-PREV-SALES-TYPE = '13'                                        
               WRITE PRINT-REC-1  FROM L403-PR-HEAD-G AFTER 1.                  
                                                                                
           WRITE PRINT-REC-1 FROM L403-PR-HEAD-6 AFTER 2.                       
           WRITE PRINT-REC-1 FROM L403-PR-HEAD-7 AFTER 1.                       
           MOVE  SPACES      TO   PRINT-REC-1.                                  
           WRITE PRINT-REC-1.                                                   
           MOVE  0           TO   LINE-CNT1.                                    
                                                                                
       720-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    PRINT TOTAL LINES SECTION                                   *        
      ******************************************************************        
       800-PRINT-TOTAL.                                                         
           IF SEQUENCE-NO1 > 0                                                  
              MOVE  TOT-LOAN-AMT1 TO   WS-TOT-AMT                               
              WRITE PRINT-REC-1   FROM L403-PR-HEAD-4 AFTER 2                   
              MOVE  SPACES        TO   PRINT-REC-1                              
              WRITE PRINT-REC-1   FROM L403-PR-HEAD-5 AFTER 1                   
              WRITE PRINT-REC-1   FROM L403-PR-HEAD-4 AFTER 1.                  
                                                                                
           MOVE ZEROES TO TOT-LOAN-AMT1.                                        
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *    CLOSE FILES   AND   STOP RUN                                *        
      ******************************************************************        
       900-CLOSE-ROUTINE.                                                       
           CLOSE BM06K110                                                       
                 BP13F410                                                       
                 BP13L403.                                                      
                                                                                
           IF K110-STATUS NOT = 00                                              
              DISPLAY 'CLOSING ERROR, BM06K110-STATUS = ' K110-STATUS           
              MOVE K110-STATUS TO RETURN-CODE.                                  
                                                                                
           STOP RUN.                                                            
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
