       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CY90.                                                 
      ******************************************************************        
      *                SYSTEM OF COMMITMENT (BP13)                     *        
      ******************************************************************        
      * OBJECTIVE :                                                    *        
      *                                                                *        
      * INPUT  FILES :                                                 *        
      *                BP13F007                                        *        
      *                BP13K820  - TO COMP INCOME/AGE/                 *        
      *                BP13K828  - TO COMP INCOME/AGE                  *        
      *                BP13K593  - TO READ TOT UN-SUCC ATTEMP          *        
      *                BP13K595  - TO READ UN-SUCC APPLN               *        
      *                BP13K813  - TO DECODE NT                        *        
      * OUTPUT FILES : BP13F008                                        *        
      *                                                                *        
      * CHG-NO   BY    ON    - DESCRIPTION                             *        
      * -------------------------------------------------------------- *        
      * BP134306 ZDD1 05082011 ADD DATA FROM BP13F730                  *        
      * BP134560 IMC1 05282012 PRINT DATA TO OUTPUT IF RECORD NOT FND  *        
      * BP134598 IMC1 08082012 ADD DATA FROM BP13K895, CHANGE MAJOR    *        
      * BP134875 IMC1 07052013 ADD DATA ALLOC/ELIG SCH IN OCCURANCE    *        
      * BP134930 IMC1 23052013 CHANGE OCCURANCE IN F008 TO 15          *        
      * BP135237 IMC1 03032014 CATER FOR TRANS G3                      *        
      * BP135237 IMC1 04032014 CHANGE BP13K816 TO BP13K813             *        
      * BP135635 SMR2 13022015 CATER FOR TRANS 4 = SASTAG S1           *        
      * BP135785 FNP1 22072015 CATER FOR BP13K585 KEY EXPANSION        *        
      * BP137734 LSB1 04042019 REMOVE CHECKING FOR BALLOT HH = G TO    *        
      *                        GET F585-TRANS                                   
      * BP138080 SMP3 05112019 ADD NUM-QUEUE/REQUEST-STAT/BOOK-STAT    *        
      *                        CHANGE OCCURANCE FROM 15 TO 12          *        
      *                        ADD A DELIMITER ';' ON EACH FIELD       *        
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT   BP13F007      ASSIGN TO BP13F007.                           
                                                                                
           SELECT   BP13K595      ASSIGN TO BP13K595                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K595-KEY-FLD                        
                           ALTERNATE KEY IS K595-ALT1-KEY                       
                             FILE STATUS IS K595-STATUS.                        
                                                                                
           SELECT   BP13K828      ASSIGN TO BP13K828                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K828-KEY-FLD                        
                             FILE STATUS IS K828-STATUS.                        
                                                                                
           SELECT   BP13K820      ASSIGN TO BP13K820                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K820-KEY-FLD                        
                             FILE STATUS IS K820-STATUS.                        
                                                                                
           SELECT   BP13K593      ASSIGN TO BP13K593                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K593-KEY-FLD                        
                             FILE STATUS IS K593-STATUS.                        
                                                                                
           SELECT   BP13K813      ASSIGN TO BP13K813                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS RANDOM                              
                              RECORD KEY IS K813-KEY-FLD                        
                             FILE STATUS IS K813-STATUS.                        
                                                                                
           SELECT   BP13K585      ASSIGN TO BP13K585                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS RANDOM                              
                              RECORD KEY IS K585-KEY-FLD                        
                             FILE STATUS IS K585-STATUS.                        
                                                                                
           SELECT   BM06K110      ASSIGN TO BM06K110                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K110-KEY-FLD                        
                           ALTERNATE KEY IS K110-REGN-NO                        
                             FILE STATUS IS K110-STATUS.                        
                                                                                
           SELECT BP13K895 ASSIGN       TO BP13K895                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS K895-KEY-FLD                         
                           FILE STATUS  IS K895-STATUS.                         
                                                                                
           SELECT   BP13F008      ASSIGN TO BP13F008.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13K595                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BP13K595.                                                           
                                                                                
       FD   BP13F007                                                            
            RECORD CONTAINS 200 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F007.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K828                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K828.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K593                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K593.                                                           
                                                                                
       FD   BP13K585                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K585.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500  CHARACTERS.                                    
       COPY BM06K110.                                                           
                                                                                
       FD  BP13K895                                                             
           RECORD CONTAINS 450 CHARACTERS.                                      
       COPY BP13K895.                                                           
                                                                                
       FD   BP13F008                                                            
            RECORD CONTAINS 1000 CHARACTERS                                     
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F008.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
                                                                                
       01  WS-COUNTERS.                                                         
           05  CNT-F120-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-F007-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K825-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K828-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K895-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K820-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K593-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-F008-WRITE               PIC 9(7)  VALUE ZEROS.              
           05  CNT-CHILD                    PIC 9(1)  VALUE ZEROS.              
           05  CNT-HH-SIZE                  PIC 9(2)  VALUE ZEROS.              
                                                                                
       01  WS-VARIABLES.                                                        
           05  K820-STATUS                  PIC 99    VALUE ZEROES.             
           05  K825-STATUS                  PIC 99    VALUE ZEROES.             
           05  K828-STATUS                  PIC 99    VALUE ZEROES.             
           05  K895-STATUS                  PIC 99    VALUE ZERO.               
           05  K593-STATUS                  PIC 99    VALUE ZEROES.             
           05  K060-STATUS                  PIC 99    VALUE ZEROES.             
           05  K813-STATUS                  PIC 99    VALUE ZEROES.             
           05  K595-STATUS                  PIC 99    VALUE ZEROES.             
           05  K585-STATUS                  PIC 99    VALUE ZEROES.             
           05  K110-STATUS                  PIC 99    VALUE ZEROES.             
           05  WS-K820-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K825-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K828-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K593-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K595-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-F007-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-NRIC-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K825-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K820-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K828-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K895-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K825-FND                  PIC X(01) VALUE SPACE.              
               88  K825-FND                 VALUE 'Y'.                          
           05  WS-K828-FND                  PIC X(01) VALUE SPACE.              
               88  K828-FND                 VALUE 'Y'.                          
           05  WS-K820-FND                  PIC X(01) VALUE SPACE.              
               88  K820-FND                 VALUE 'Y'.                          
           05  WS-K593-FND                  PIC X(01) VALUE SPACE.              
               88  K593-FND                 VALUE 'Y'.                          
           05  WS-K585-FND                  PIC X(01) VALUE SPACE.              
               88  K585-FND                 VALUE 'Y'.                          
           05  WS-K895-FND                  PIC X(01) VALUE SPACE.              
               88  K895-FND                 VALUE 'Y'.                          
           05  WS-K895-EOF                  PIC X     VALUE 'N'.                
           05  WS-NUM-AGE                   PIC 9(08) VALUE ZEROES.             
           05  WS-AGE REDEFINES WS-NUM-AGE.                                     
               10  WS-AGE-CY                PIC 9(04).                          
               10  WS-AGE-MM                PIC 9(02).                          
               10  WS-AGE-DD                PIC 9(02).                          
           05  WS-F595-BALDATE              PIC X(8)  VALUE SPACES.             
           05  WS-BYPASS-2009               PIC X(1)  VALUE SPACE.              
           05  WS-BYPASS-BALLOT             PIC X(6)  VALUE SPACE.              
           05  WS-HA1-ETHNIC                PIC X(1)  VALUE SPACE.              
           05  WS-CDE-RACE                  PIC X(1)  VALUE SPACE.              
           05  WS-HA1-MS                    PIC X(01) VALUE SPACE.              
           05  WS-HA1-SEX                   PIC X(01) VALUE ZEROES.             
           05  WS-HA1-BIRTH                 PIC X(08) VALUE ZEROES.             
           05  WS-HA1-CTZN                  PIC X(02) VALUE ZEROES.             
           05  WS-HA1-AGE                   PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-REGN                  PIC 9(08) VALUE ZEROES.             
           05  WS-NUM-BIRTH                 PIC 9(08) VALUE ZEROES.             
           05  WS-HH-INCOME                 PIC 9(08) VALUE ZEROES.             
           05  WS-HA1-INCOME                PIC 9(08) VALUE ZEROES.             
           05  WS-CTR                       PIC 9(02) VALUE ZEROES.             
           05  WS-I                         PIC 9(02) VALUE ZEROES.             
           05  WS-J                         PIC 9(02) VALUE ZEROES.             
           05  WS-1ST-CTR                   PIC 9(02) VALUE ZEROES.             
           05  WS-LST-CTR                   PIC 9(02) VALUE ZEROES.             
           05  WS-START                     PIC 9(02) VALUE ZEROES.             
           05  WS-END                       PIC 9(02) VALUE ZEROES.             
           05  WS-PERIOD                    PIC 9(04) VALUE ZEROES.             
           05  WS-HH-SCP                    PIC X(3)  VALUE SPACES.             
           05  WS-HH-SCH                    PIC X(3)  VALUE SPACES.             
           05  WS-UNSUCC-TAG                PIC X(1)  VALUE SPACES.             
           05  WS-START-BALLOT              PIC X(6)  VALUE ZEROES.             
           05  FILLER REDEFINES WS-START-BALLOT.                                
               10  WS-START-YR              PIC 9(04).                          
               10  WS-START-MTH             PIC 9(02).                          
           05  WS-END-BALLOT                PIC X(6)  VALUE ZEROES.             
           05  FILLER REDEFINES WS-END-BALLOT.                                  
               10  WS-END-YR                PIC 9(04).                          
               10  WS-END-MTH               PIC 9(02).                          
           05  CNT-2R                       PIC 9(02) VALUE ZEROES.             
           05  CNT-3R                       PIC 9(02) VALUE ZEROES.             
           05  CNT-4R                       PIC 9(02) VALUE ZEROES.             
           05  CNT-5R                       PIC 9(02) VALUE ZEROES.             
           05  CNT-OT                       PIC 9(02) VALUE ZEROES.             
           05  CNT-TOT-FT                   PIC 9(02) VALUE ZEROES.             
           05  WS-PCT-2R                    PIC 9(02)V99 VALUE ZEROES.          
           05  WS-PCT-3R                    PIC 9(02)V99 VALUE ZEROES.          
           05  WS-PCT-4R                    PIC 9(02)V99 VALUE ZEROES.          
           05  WS-PCT-5R                    PIC 9(02)V99 VALUE ZEROES.          
           05  WS-PCT-OT                    PIC 9(02)V99 VALUE ZEROES.          
           05  PRT-2R                       PIC X(11) VALUE SPACES.             
           05  PRT-3R                       PIC X(11) VALUE SPACES.             
           05  PRT-4R                       PIC X(11) VALUE SPACES.             
           05  PRT-5R                       PIC X(11) VALUE SPACES.             
           05  PRT-OT                       PIC X(11) VALUE SPACES.             
           05  PRT-FLAT-CAT                 PIC X(45) VALUE SPACES.             
           05  CNT-NORTH                    PIC 9(02) VALUE ZEROES.             
           05  CNT-WEST                     PIC 9(02) VALUE ZEROES.             
           05  CNT-NORTH-EAST               PIC 9(02) VALUE ZEROES.             
           05  CNT-UNSUC                    PIC 9(02) VALUE ZEROES.             
           05  WS-PCT-NORTH                 PIC 9(02)V99 VALUE ZEROES.          
           05  WS-PCT-WEST                  PIC 9(02)V99 VALUE ZEROES.          
           05  WS-PCT-NE                    PIC 9(02)V99 VALUE ZEROES.          
           05  PRT-INC                      PIC ZZZZ9    VALUE ZEROES.          
           05  PRT-AGE                      PIC    Z9    VALUE ZEROES.          
           05  PRT-ATMPT                    PIC    Z9    VALUE ZEROES.          
           05  PRT-TOT                      PIC   ZZ9    VALUE ZEROES.          
           05  PRT-SEL-PRICE                PIC ZZZZZZZ9 VALUE ZEROES.          
           05  WS-DUP-FND                   PIC X(01)    VALUE SPACES.          
           05  WS-TAG-NEW                   PIC X(3)     VALUE SPACES.          
           05  WS-CHILD-SPR                 PIC X(1)     VALUE SPACES.          
           05  WS-NUM-AGE-YOUNG             PIC 9(02)    VALUE ZEROES.          
           05  WS-DTE-BIRTH-YOUNG           PIC X(08)    VALUE SPACES.          
           05  WS-F585-TRANS                PIC X(01)    VALUE SPACES.          
                                                                                
       01 WS-BP13K595-REC                   PIC X(500)   VALUE SPACES.          
                                                                                
      *-------------------------------------------------------*                 
      *    COPY BOOK FOR SUBROUTINE - BP13C913.               *                 
      *-------------------------------------------------------*                 
       COPY P13COMM8.                                                           
                                                                                
      *-------------------------------------------------------*                 
      *    LINKAGE VARIABLES                                  *                 
      *-------------------------------------------------------*                 
       01   WS-LINK-REC.                                                        
            05 WS-LINK-NUM-SCH            PIC X(4).                             
            05 WS-LINK-NUM-ACC            PIC X(4).                             
            05 WS-LINK-NUM-CHK            PIC X(1).                             
                                                                                
      *****************************************************************         
       PROCEDURE DIVISION.                                                      
      *****************************************************************         
                                                                                
      *===============================================================*         
       0000-MAIN.                                                               
      *===============================================================*         
                                                                                
           PERFORM 1000-OPEN-FILES          THRU 1000-EXIT.                     
                                                                                
           PERFORM 2000-READ-BP13F007       THRU 2000-EXIT.                     
                                                                                
           PERFORM 3000-PROCESS-RECORD      THRU 3000-EXIT                      
             UNTIL WS-F007-EOF = 'Y'.                                           
                                                                                
           PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       1000-OPEN-FILES.                                                         
      *===============================================================*         
                                                                                
           OPEN INPUT BP13F007                                                  
                      BP13K820                                                  
                      BP13K585                                                  
                      BP13K828                                                  
                      BP13K593                                                  
                      BP13K595                                                  
                      BP13K895                                                  
                      BP13K813                                                  
                      BM06K110                                                  
               OUTPUT BP13F008.                                                 
                                                                                
           IF K813-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K813 , STATUS = ' K813-STATUS          
              MOVE K813-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K595-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K595 , STATUS = ' K595-STATUS          
              MOVE K595-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K820 , STATUS = ' K820-STATUS          
              MOVE K820-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K828-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K828 , STATUS = ' K828-STATUS          
              MOVE K828-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K593-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K593 , STATUS = ' K593-STATUS          
              MOVE K593-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K585-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K585 , STATUS = ' K585-STATUS          
              MOVE K585-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K110-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BM06K110 , STATUS = ' K110-STATUS          
              MOVE K110-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K895-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K895 , STATUS = ' K895-STATUS          
              MOVE K895-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
            MOVE SPACES            TO  BP13F008-REC                             
                                       BP13K585-REC.                            
            INITIALIZE                 BP13F008-REC                             
                                       BP13K585-REC.                            
                                                                                
            MOVE 'LATEST'          TO  F008-REGN-LATEST                         
            MOVE '1ST'             TO  F008-REGN-NO-UNSUCC(1)                   
            MOVE '2ND'             TO  F008-REGN-NO-UNSUCC(2)                   
            MOVE '3RD'             TO  F008-REGN-NO-UNSUCC(3)                   
            MOVE '4TH'             TO  F008-REGN-NO-UNSUCC(4)                   
            MOVE '5TH'             TO  F008-REGN-NO-UNSUCC(5)                   
            MOVE '6TH'             TO  F008-REGN-NO-UNSUCC(6)                   
            MOVE '7TH'             TO  F008-REGN-NO-UNSUCC(7)                   
            MOVE '8TH'             TO  F008-REGN-NO-UNSUCC(8)                   
            MOVE '9TH'             TO  F008-REGN-NO-UNSUCC(9)                   
            MOVE '10TH'            TO  F008-REGN-NO-UNSUCC(10)                  
            MOVE '11TH'            TO  F008-REGN-NO-UNSUCC(11)                  
            MOVE '12TH'            TO  F008-REGN-NO-UNSUCC(12)                  
      *     MOVE '13TH'            TO  F008-REGN-NO-UNSUCC(13)                  
      *     MOVE '14TH'            TO  F008-REGN-NO-UNSUCC(14)                  
      *     MOVE '15TH'            TO  F008-REGN-NO-UNSUCC(15)                  
            MOVE 'NEW'             TO  F008-REGN-NEW                            
                                                                                
            PERFORM 3700-MOVE-DELIMITER     THRU 3700-EXIT.                     
                                                                                
            WRITE BP13F008-REC.                                                 
                                                                                
            MOVE SPACES            TO  BP13F008-REC.                            
            INITIALIZE                 BP13F008-REC                             
                                                                                
            MOVE 'REGN'            TO  F008-NUM-REGN                            
            MOVE 'HL'              TO  F008-HARDLUCK                            
            MOVE 'HA1'             TO  F008-HA1-NRIC                            
            MOVE 'HA2'             TO  F008-HA2-NRIC                            
            MOVE 'MODE '           TO  F008-NUM-ALLO-CAT                        
            MOVE 'NT  '            TO  F008-NUM-NT                              
            MOVE 'FT '             TO  F008-NUM-FLAT-TYP                        
            MOVE 'ALLO'            TO  F008-NUM-ALLO-SCH                        
            MOVE 'ELIG'            TO  F008-NUM-ELIG-SCH                        
            MOVE 'BALLOT'          TO  F008-DTE-BALLOT                          
            MOVE 'CAT'             TO  F008-CDE-CATEGORY                        
            MOVE 'TRY'             TO  F008-NO-TRIES                            
            MOVE 'ATM '            TO  F008-NUM-ATMPT                           
            MOVE 'MTHS'            TO  F008-NUM-MONTHS-1ST-LST                  
            MOVE 'ZONE_CAT'        TO  F008-ZONE-CAT                            
            MOVE 'FLAT_CAT'        TO  F008-FLAT-CAT                            
            MOVE 'MAJOR_FT'        TO  F008-MAJOR-FLAT                          
            MOVE 'REGN'            TO  F008-REGN-LATEST                         
            MOVE 'MODE'            TO  F008-MODE-LATEST                         
            MOVE 'BALLOT'          TO  F008-DTE-BALLOT-LATEST                   
            MOVE 'FT'              TO  F008-FT-LATEST                           
            MOVE 'ALLO'            TO  F008-ALLO-SCH-LATEST                     
            MOVE 'ELIG'            TO  F008-ELIG-SCH-LATEST                     
            MOVE 'HHINC'           TO  F008-HH-INCOME-LATEST                    
            MOVE 'MS'              TO  F008-HA1-MS-LATEST                       
            MOVE 'H1INC'           TO  F008-HA1-INCOME-LATEST                   
            MOVE 'AGE'             TO  F008-HA1-AGE-LATEST                      
            MOVE 'NT'              TO  F008-NT-LATEST                           
            MOVE 'ZONE'            TO  F008-ZONE-LATEST                         
            MOVE 'CAT'             TO  F008-ETHNIC-LATEST                       
            MOVE 'SZ'              TO  F008-HH-SIZE-LATEST                      
            MOVE 'CHLD '           TO  F008-NO-CHILD-LATEST                     
            MOVE 'HH'              TO  F008-HH-TYPE-LATEST                      
            MOVE 'CTZ'             TO  F008-HH-CTZN-LATEST                      
            MOVE 'TOT'             TO  F008-TOT-UNSUCC                          
            MOVE 'YAGE'            TO  F008-YOUNG-AGE-LATEST                    
            MOVE 'DTE BRTH'        TO  F008-DTE-BIRTH-LATEST                    
            MOVE 'TAG'             TO  F008-TAG-LATEST                          
            MOVE 'T'               TO  F008-CDE-MCPS-TAG-LATEST                 
            MOVE 'QUEUE'           TO  F008-NUM-QUEUE-LATEST                    
            MOVE 'R'               TO  F008-REQUEST-STAT-LATEST                 
            MOVE 'BK'              TO  F008-BOOK-STAT-LATEST                    
            PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 12                    
               MOVE 'REGN'         TO  F008-REGN-NO-UNSUCC(WS-I)                
               MOVE 'NT'           TO  F008-NT-UNSUCC(WS-I)                     
               MOVE 'ZONE'         TO  F008-ZONE-UNSUCC(WS-I)                   
               MOVE 'FT'           TO  F008-FT-UNSUCC(WS-I)                     
               MOVE 'MODE'         TO  F008-MODE-UNSUCC(WS-I)                   
               MOVE 'BALLOT'       TO  F008-BALLOT-UNSUCC(WS-I)                 
               MOVE 'T'            TO  F008-CDE-MCPS-TAG-UNS(WS-I)              
               MOVE 'QUEUE'        TO  F008-NUM-QUEUE-UNSUCC(WS-I)              
               MOVE 'R'            TO  F008-REQUEST-STAT-UNS(WS-I)              
               MOVE 'BK'           TO  F008-BOOK-STAT-UNSUCC(WS-I)              
            END-PERFORM.                                                        
      *     MOVE 'UNIT #'          TO   F008-UNIT-NO                            
      *     MOVE '        '        TO   F008-SELLING-PRICE                      
                                                                                
            MOVE 'REGN'            TO  F008-REGN-NEW                            
            MOVE 'MODE'            TO  F008-MODE-NEW                            
            MOVE 'BALLOT'          TO  F008-DTE-BALLOT-NEW                      
            MOVE 'FT'              TO  F008-FT-NEW                              
            MOVE 'ALLO'            TO  F008-ALLO-SCH-NEW                        
            MOVE 'ELIG'            TO  F008-ELIG-SCH-NEW                        
            MOVE 'HHINC'           TO  F008-HH-INCOME-NEW                       
            MOVE 'MS'              TO  F008-HA1-MS-NEW                          
            MOVE 'H1INC'           TO  F008-HA1-INCOME-NEW                      
            MOVE 'AGE'             TO  F008-HA1-AGE-NEW                         
            MOVE 'NT'              TO  F008-NT-NEW                              
            MOVE 'ZONE'            TO  F008-ZONE-NEW                            
            MOVE 'CAT'             TO  F008-ETHNIC-NEW                          
            MOVE 'SZ'              TO  F008-HH-SIZE-NEW                         
            MOVE 'CHLD '           TO  F008-NO-CHILD-NEW                        
            MOVE 'HH'              TO  F008-HH-TYPE-NEW                         
            MOVE 'CTZ'             TO  F008-HH-CTZN-NEW                         
            MOVE 'YAGE'            TO  F008-YOUNG-AGE-NEW                       
            MOVE 'DTE BRTH'        TO  F008-DTE-BIRTH-NEW                       
            MOVE 'TAG'             TO  F008-TAG-NEW                             
            MOVE 'T'               TO  F008-CDE-MCPS-TAG-NEW                    
            MOVE 'QUEUE'           TO  F008-NUM-QUEUE-NEW                       
            MOVE 'R'               TO  F008-REQUEST-STAT-NEW                    
            MOVE 'BK'              TO  F008-BOOK-STAT-NEW                       
                                                                                
            PERFORM 3700-MOVE-DELIMITER     THRU 3700-EXIT.                     
                                                                                
            WRITE BP13F008-REC.                                                 
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       2000-READ-BP13F007.                                                      
      *===============================================================*         
                                                                                
           MOVE SPACES        TO WS-F585-TRANS.                                 
                                                                                
           READ BP13F007                                                        
             AT END                                                             
                MOVE 'Y'                TO WS-F007-EOF                          
                GO                      TO 2000-EXIT                            
           END-READ.                                                            
                                                                                
           ADD  1                       TO CNT-F007-READ.                       
                                                                                
           IF F007-NUM-ALLO-SCH = 'FTS'                                         
              MOVE '4'      TO WS-F585-TRANS                                    
           ELSE                                                                 
              IF F007-NUM-BALLOT-HH = 'H' OR 'T'                                
                 MOVE '1'   TO WS-F585-TRANS                                    
              ELSE                                                              
                 IF F007-NUM-BALLOT-HH = 'F' OR                                 
                    F007-NUM-FT2T = 'Y'                                         
                     MOVE '2'  TO WS-F585-TRANS                                 
                 ELSE                                                           
                     MOVE '3'  TO WS-F585-TRANS                                 
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3000-PROCESS-RECORD.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                           TO BP13F008-REC.               
           INITIALIZE                               BP13F008-REC.               
                                                                                
           MOVE ZEROS                 TO CNT-WEST CNT-NORTH                     
                                         CNT-NORTH-EAST                         
           MOVE ZEROS                 TO CNT-4R CNT-5R CNT-2R CNT-3R            
                                         CNT-OT                                 
           MOVE ALL '#'               TO PRT-2R PRT-3R PRT-4R PRT-5R            
                                         PRT-OT.                                
           MOVE SPACES                TO PRT-FLAT-CAT.                          
                                                                                
           MOVE F007-NUM-NRIC1                 TO K585-NUM-NRIC                 
           MOVE WS-F585-TRANS                  TO K585-NUM-TRANS                
           PERFORM 8000-READ-BP13K585        THRU 8000-EXIT.                    
           IF NOT K585-FND                                                      
              IF F007-NUM-NRIC2(1:1) NOT = SPACES AND '#'                       
              MOVE F007-NUM-NRIC2               TO K585-NUM-NRIC                
              MOVE WS-F585-TRANS                TO K585-NUM-TRANS               
              PERFORM 8000-READ-BP13K585        THRU 8000-EXIT                  
              IF NOT K585-FND                                                   
                 PERFORM 3500-FORMAT-NEW        THRU 3500-EXIT                  
                 PERFORM 3050-WRITE-OUTPUT-COMMON THRU 3050-EXIT                
                 PERFORM 2000-READ-BP13F007     THRU 2000-EXIT                  
                 GO TO 3000-EXIT                                                
           END-IF.                                                              
                                                                                
           PERFORM 3100-FORMAT-COMMON        THRU 3100-EXIT.                    
                                                                                
           MOVE ZEROES                         TO WS-LST-CTR                    
                                                  CNT-UNSUC                     
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 20                     
              IF K585-NUM-REGN(WS-I) NOT = SPACES AND LOW-VALUES                
                 PERFORM 3200-FORMAT-UNSUCC  THRU 3200-EXIT                     
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           PERFORM 3300-UNSUCC-SUMMARY       THRU 3300-EXIT.                    
                                                                                
           IF WS-LST-CTR > ZEROES                                               
              PERFORM 3400-FORMAT-LATEST     THRU 3400-EXIT                     
              PERFORM 3500-FORMAT-NEW        THRU 3500-EXIT                     
           END-IF.                                                              
                                                                                
           PERFORM 3700-MOVE-DELIMITER      THRU 3700-EXIT.                     
                                                                                
           WRITE BP13F008-REC.                                                  
           ADD 1                               TO CNT-F008-WRITE.               
                                                                                
           PERFORM 2000-READ-BP13F007        THRU 2000-EXIT.                    
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3050-WRITE-OUTPUT-COMMON.                                                
                                                                                
           MOVE F007-NUM-NRIC1            TO F008-HA1-NRIC.                     
           MOVE F007-NUM-REGN             TO F008-NUM-REGN.                     
           MOVE F007-NUM-NRIC2            TO F008-HA2-NRIC.                     
           MOVE F007-NUM-ALLO-CAT         TO F008-NUM-ALLO-CAT.                 
           MOVE F007-NUM-FLAT-TYP         TO F008-NUM-FLAT-TYP.                 
           MOVE F007-NUM-ALLO-SCH         TO F008-NUM-ALLO-SCH.                 
           MOVE F007-NUM-ELIG-SCH         TO F008-NUM-ELIG-SCH.                 
           MOVE F007-DTE-BALLOT           TO F008-DTE-BALLOT.                   
           MOVE F007-CDE-CATEGORY         TO F008-CDE-CATEGORY.                 
                                                                                
           PERFORM 3700-MOVE-DELIMITER      THRU 3700-EXIT.                     
                                                                                
           WRITE BP13F008-REC.                                                  
           ADD 1                          TO CNT-F008-WRITE.                    
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3100-FORMAT-COMMON.                                                      
      ****************************************************************          
                                                                                
           MOVE F007-NUM-NRIC1            TO F008-HA1-NRIC.                     
           MOVE F007-NUM-REGN             TO F008-NUM-REGN.                     
           MOVE F007-NUM-NRIC2            TO F008-HA2-NRIC.                     
           MOVE F007-NUM-ALLO-CAT         TO F008-NUM-ALLO-CAT.                 
           MOVE F007-NUM-FLAT-TYP         TO F008-NUM-FLAT-TYP.                 
           MOVE F007-NUM-ALLO-SCH         TO F008-NUM-ALLO-SCH.                 
           MOVE F007-NUM-ELIG-SCH         TO F008-NUM-ELIG-SCH.                 
           MOVE F007-DTE-BALLOT           TO F008-DTE-BALLOT.                   
           MOVE F007-CDE-CATEGORY         TO F008-CDE-CATEGORY.                 
           MOVE SPACES                    TO BP13K813-REC.                      
           MOVE F007-NUM-NT               TO K813-NUM-ZONE.                     
           MOVE F007-NUM-FLAT-TYP         TO K813-NUM-FLAT-TYPE.                
           MOVE F007-DTE-BALLOT           TO K813-DTE-BALLOT.                   
                                                                                
           PERFORM 8007-READ-BP13K813 THRU 8007-EXIT                            
           MOVE K813-CDE-NT               TO F008-NUM-NT.                       
                                                                                
           MOVE F007-NUM-NRIC1            TO K593-KEY-FLD                       
                                                                                
           PERFORM 8001-READ-BP13K593   THRU 8001-EXIT                          
           MOVE K593-NUM-UNSUCC-TOT       TO PRT-ATMPT                          
           MOVE PRT-ATMPT                 TO F008-NUM-ATMPT.                    
                                                                                
           MOVE K585-NUM-UNSUCC-BTO       TO PRT-ATMPT                          
           MOVE PRT-ATMPT                 TO F008-TOT-UNSUCC.                   
                                                                                
           IF K585-FND                                                          
              IF K585-NUM-TRANS = '1'                                           
                 MOVE 'H1'                   TO F008-HARDLUCK                   
              ELSE                                                              
                 IF K585-NUM-TRANS = '2'                                        
                    MOVE 'G2'                TO F008-HARDLUCK                   
                 ELSE                                                           
                    IF K585-NUM-TRANS = '3'                                     
                       MOVE 'G3'                TO F008-HARDLUCK                
                    ELSE                                                        
                       IF K585-NUM-TRANS = '4'                                  
                          MOVE 'S1'             TO F008-HARDLUCK                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES                    TO F008-TOT-UNSUCC                 
                                                F008-HARDLUCK                   
           END-IF.                                                              
                                                                                
      *    MOVE SPACES                    TO K110-REC.                          
      *    MOVE F007-NUM-REGN             TO K110-REGN-NO.                      
      *    PERFORM 8008-READ-BM06K110    THRU 8008-EXIT.                        
      *    MOVE K110-CURR-SELLING-PRICE   TO PRT-SEL-PRICE.                     
      *    MOVE PRT-SEL-PRICE             TO F008-SELLING-PRICE.                
      *    MOVE SPACES                    TO F008-SELLING-PRICE.                
                                                                                
      *  TO CALL SUBROUTINE BP13C913,GETTING ADDRESS                            
      *    MOVE SPACES                   TO WS-LINK-REC.                        
      *    MOVE K110-SCHEME              TO WS-LINK-NUM-SCH.                    
      *    MOVE K110-ACC                 TO WS-LINK-NUM-ACC.                    
      *    MOVE K110-CHK                 TO WS-LINK-NUM-CHK.                    
      *    PERFORM 8009-CALL-BP13C913      THRU 8009-EXIT.                      
                                                                                
      *    STRING '#' COMM8-NUM-LEVEL '-' COMM8-NUM-UNIT-MAIN                   
      *         COMM8-NUM-UNIT-SUB DELIMITED BY SIZE INTO                       
      *           F008-UNIT-NO.                                                 
                                                                                
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3200-FORMAT-UNSUCC.                                                      
      ****************************************************************          
                                                                                
           ADD 1                      TO CNT-UNSUC                              
                                                                                
           MOVE WS-I                  TO WS-LST-CTR                             
           IF CNT-UNSUC = 1                                                     
              MOVE WS-I               TO WS-1ST-CTR                             
           END-IF.                                                              
                                                                                
           MOVE K585-NUM-REGN(WS-I)   TO F008-REGN-NO-UNSUCC(CNT-UNSUC)         
           MOVE SPACES                TO BP13K813-REC.                          
           MOVE K585-CDE-NT(WS-I)         TO K813-NUM-ZONE                      
           MOVE K585-CDE-FLAT-TYPE(WS-I)  TO K813-NUM-FLAT-TYPE.                
           MOVE K585-DTE-BALLOT(WS-I)     TO K813-DTE-BALLOT.                   
           PERFORM 8007-READ-BP13K813 THRU 8007-EXIT                            
           MOVE K813-CDE-NT           TO F008-NT-UNSUCC(CNT-UNSUC)              
           IF K813-CDE-NT = 'BB ' OR 'BP ' OR 'JW ' OR 'CCK' OR 'JE'            
              MOVE 'WW'               TO F008-ZONE-UNSUCC(CNT-UNSUC)            
              ADD 1                   TO CNT-WEST                               
           ELSE                                                                 
              IF K813-CDE-NT = 'HG ' OR 'PG ' OR 'SK '                          
                 MOVE 'NE'            TO F008-ZONE-UNSUCC(CNT-UNSUC)            
                 ADD 1                TO CNT-NORTH-EAST                         
              ELSE                                                              
                 IF K813-CDE-NT = 'SB ' OR 'WL ' OR 'YS '                       
                    MOVE 'NN'         TO F008-ZONE-UNSUCC(CNT-UNSUC)            
                    ADD 1             TO CNT-NORTH                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           EVALUATE K585-CDE-FLAT-TYPE(WS-I)(1:1)                               
               WHEN '2'                                                         
                    COMPUTE CNT-2R = CNT-2R + 1                                 
               WHEN '3'                                                         
                    COMPUTE CNT-3R = CNT-3R + 1                                 
               WHEN '4'                                                         
                    COMPUTE CNT-4R = CNT-4R + 1                                 
               WHEN '5'                                                         
                    COMPUTE CNT-5R = CNT-5R + 1                                 
               WHEN OTHER                                                       
                    COMPUTE CNT-OT = CNT-OT + 1                                 
           END-EVALUATE                                                         
                                                                                
           MOVE K585-CDE-FLAT-TYPE(WS-I) TO F008-FT-UNSUCC(CNT-UNSUC)           
           MOVE K585-NUM-ALLO-CAT(WS-I)  TO F008-MODE-UNSUCC(CNT-UNSUC)         
           MOVE K585-DTE-BALLOT(WS-I)  TO F008-BALLOT-UNSUCC(CNT-UNSUC).        
           MOVE K585-CDE-MCPS-TAG(WS-I)                                         
             TO F008-CDE-MCPS-TAG-UNS(CNT-UNSUC).                               
           MOVE K585-NUM-QUEUE(WS-I)                                            
             TO F008-NUM-QUEUE-UNSUCC(CNT-UNSUC).                               
           MOVE K585-CDE-REQUEST-STATUS(WS-I)                                   
             TO F008-REQUEST-STAT-UNS(CNT-UNSUC).                               
           MOVE K585-NUM-BOOK-STATUS(WS-I)                                      
             TO F008-BOOK-STAT-UNSUCC(CNT-UNSUC).                               
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3300-UNSUCC-SUMMARY.                                                     
      ****************************************************************          
                                                                                
           IF CNT-NORTH = CNT-UNSUC                                             
              MOVE 'ALL IN NORTH'         TO F008-ZONE-CAT                      
           ELSE                                                                 
              IF CNT-WEST = CNT-UNSUC                                           
                 MOVE 'ALL IN WEST'       TO F008-ZONE-CAT                      
              ELSE                                                              
                 IF CNT-NORTH-EAST = CNT-UNSUC                                  
                    MOVE 'ALL IN NORTH-EAST'  TO F008-ZONE-CAT                  
                 ELSE                                                           
                                                                                
                       IF CNT-NORTH > CNT-WEST AND                              
                          CNT-NORTH > CNT-NORTH-EAST                            
                          MOVE 'MAJORITY IN NORTH'   TO F008-ZONE-CAT           
                       ELSE                                                     
                          IF CNT-WEST  > CNT-NORTH AND                          
                             CNT-WEST  > CNT-NORTH-EAST                         
                             MOVE 'MAJORITY IN WEST'   TO F008-ZONE-CAT         
                          ELSE                                                  
                             IF CNT-NORTH-EAST > CNT-NORTH AND                  
                                CNT-NORTH-EAST > CNT-WEST                       
                                MOVE 'MAJORITY IN NORTH-EAST'                   
                                                     TO F008-ZONE-CAT           
                             ELSE                                               
                                PERFORM 3350-COMPUTE-MAJORITY                   
                                   THRU 3350-EXIT                               
                             END-IF                                             
                          END-IF                                                
                       END-IF                                                   
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           COMPUTE CNT-TOT-FT = CNT-2R + CNT-3R + CNT-4R                        
                              + CNT-5R + CNT-OT                                 
           IF CNT-2R > 0                                                        
            STRING ', ' CNT-2R ' FOR 2R' DELIMITED BY SIZE INTO PRT-2R.         
           IF CNT-3R > 0                                                        
            STRING ', ' CNT-3R ' FOR 3R' DELIMITED BY SIZE INTO PRT-3R.         
           IF CNT-4R > 0                                                        
            STRING ', ' CNT-4R ' FOR 4R' DELIMITED BY SIZE INTO PRT-4R.         
           IF CNT-5R > 0                                                        
            STRING ', ' CNT-5R ' FOR 5R' DELIMITED BY SIZE INTO PRT-5R.         
           IF CNT-OT > 0                                                        
            STRING ', ' CNT-OT ' OTHERS' DELIMITED BY SIZE INTO PRT-OT.         
                                                                                
           STRING PRT-2R PRT-3R PRT-4R PRT-5R PRT-OT                            
                  DELIMITED BY '#' INTO PRT-FLAT-CAT.                           
           MOVE PRT-FLAT-CAT(3:42)   TO F008-FLAT-CAT.                          
                                                                                
           IF CNT-TOT-FT = ZEROES                                               
              GO TO 3300-EXIT.                                                  
                                                                                
           COMPUTE WS-PCT-2R = CNT-2R / CNT-TOT-FT.                             
           COMPUTE WS-PCT-3R = CNT-3R / CNT-TOT-FT.                             
           COMPUTE WS-PCT-4R = CNT-4R / CNT-TOT-FT.                             
           COMPUTE WS-PCT-5R = CNT-5R / CNT-TOT-FT.                             
           COMPUTE WS-PCT-OT = CNT-OT / CNT-TOT-FT.                             
           IF CNT-TOT-FT = CNT-2R                                               
              MOVE 'ALL 2R'          TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF CNT-TOT-FT = CNT-3R                                               
              MOVE 'ALL 3R'          TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF CNT-TOT-FT = CNT-4R                                               
              MOVE 'ALL 4R'          TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF CNT-TOT-FT = CNT-5R                                               
              MOVE 'ALL 5R'          TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF CNT-TOT-FT = CNT-OT                                               
              MOVE 'OTHER'           TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF WS-PCT-2R > WS-PCT-3R AND WS-PCT-2R > WS-PCT-4R AND               
              WS-PCT-2R > WS-PCT-5R AND WS-PCT-2R > WS-PCT-OT                   
              MOVE 'MAJOR 3R'        TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF WS-PCT-3R > WS-PCT-2R AND WS-PCT-3R > WS-PCT-4R AND               
              WS-PCT-3R > WS-PCT-5R AND WS-PCT-3R > WS-PCT-OT                   
              MOVE 'MAJOR 3R'        TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF WS-PCT-4R > WS-PCT-2R AND WS-PCT-4R > WS-PCT-3R AND               
              WS-PCT-4R > WS-PCT-5R AND WS-PCT-4R > WS-PCT-OT                   
              MOVE 'MAJOR 4R'        TO F008-MAJOR-FLAT                         
           ELSE                                                                 
           IF WS-PCT-5R > WS-PCT-2R AND WS-PCT-5R > WS-PCT-3R AND               
              WS-PCT-5R > WS-PCT-4R AND WS-PCT-5R > WS-PCT-OT                   
              MOVE 'MAJOR 5R'        TO F008-MAJOR-FLAT                         
           ELSE                                                                 
              MOVE 'OTHER'           TO F008-MAJOR-FLAT                         
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3350-COMPUTE-MAJORITY.                                                   
      ****************************************************************          
                                                                                
           IF CNT-UNSUC > 0                                                     
                                                                                
              COMPUTE WS-PCT-NORTH = CNT-NORTH / CNT-UNSUC                      
              COMPUTE WS-PCT-WEST = CNT-WEST / CNT-UNSUC                        
              COMPUTE WS-PCT-NE = CNT-NORTH-EAST / CNT-UNSUC                    
              IF WS-PCT-NORTH > 0.5 OR                                          
                (WS-PCT-NORTH = 0.5 AND                                         
                 WS-PCT-NE < 0.5 AND                                            
                 WS-PCT-WEST < 0.5)                                             
                    MOVE 'MAJORITY IN NORTH'   TO F008-ZONE-CAT                 
              ELSE                                                              
                 IF WS-PCT-WEST > 0.5 OR                                        
                   (WS-PCT-NORTH < 0.5 AND                                      
                    WS-PCT-NE < 0.5 AND                                         
                    WS-PCT-WEST = 0.5)                                          
                      MOVE 'MAJORITY IN WEST' TO F008-ZONE-CAT                  
                 ELSE                                                           
                     IF WS-PCT-NE > 0.5 OR                                      
                       (WS-PCT-NORTH < 0.5 AND                                  
                        WS-PCT-NE = 0.5 AND                                     
                        WS-PCT-WEST < 0.5)                                      
                          MOVE 'MAJORITY IN NORTH-EAST'                         
                                                     TO F008-ZONE-CAT           
                     ELSE                                                       
                          MOVE 'OTHER'         TO F008-ZONE-CAT                 
                     END-IF                                                     
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE 'OTHER'       TO F008-ZONE-CAT                               
           END-IF.                                                              
                                                                                
       3350-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3400-FORMAT-LATEST.                                                      
      ****************************************************************          
                                                                                
           MOVE SPACES                     TO K595-KEY-FLD                      
           MOVE K585-NUM-REGN(WS-LST-CTR)  TO K595-NUM-REGN-REF                 
           PERFORM 8006-READ-BP13K595    THRU 8006-EXIT.                        
                                                                                
           MOVE K595-CDE-ALLOC-SCH         TO F008-ALLO-SCH-LATEST              
           MOVE K595-CDE-ELIG-SCH          TO F008-ELIG-SCH-LATEST              
           MOVE K595-CDE-CATEGORY          TO F008-ETHNIC-LATEST                
                                                                                
           MOVE K585-NUM-REGN(WS-LST-CTR)      TO F008-REGN-LATEST              
           MOVE K585-NUM-ALLO-CAT(WS-LST-CTR)  TO F008-MODE-LATEST              
           MOVE K585-DTE-BALLOT(WS-LST-CTR)    TO F008-DTE-BALLOT-LATEST        
           MOVE K585-CDE-FLAT-TYPE(WS-LST-CTR) TO F008-FT-LATEST                
           MOVE K585-CDE-MCPS-TAG(WS-LST-CTR)                                   
             TO F008-CDE-MCPS-TAG-LATEST                                        
           MOVE K585-NUM-QUEUE(WS-LST-CTR)                                      
             TO F008-NUM-QUEUE-LATEST                                           
           MOVE K585-CDE-REQUEST-STATUS(WS-LST-CTR)                             
             TO F008-REQUEST-STAT-LATEST                                        
           MOVE K585-NUM-BOOK-STATUS(WS-LST-CTR)                                
             TO F008-BOOK-STAT-LATEST                                           
           MOVE K585-CDE-NT(WS-LST-CTR)        TO K813-NUM-ZONE                 
           MOVE K585-CDE-FLAT-TYPE(WS-LST-CTR) TO K813-NUM-FLAT-TYPE.           
           MOVE K585-DTE-BALLOT(WS-LST-CTR)    TO K813-DTE-BALLOT.              
           PERFORM 8007-READ-BP13K813  THRU 8007-EXIT                           
           MOVE K813-CDE-NT                TO F008-NT-LATEST                    
           IF K813-CDE-NT = 'BB ' OR 'BP ' OR 'JW ' OR 'CCK' OR 'JE'            
              MOVE 'WW'                    TO F008-ZONE-LATEST                  
           ELSE                                                                 
              IF K813-CDE-NT = 'HG ' OR 'PG ' OR 'SK '                          
                 MOVE 'NE'                 TO F008-ZONE-LATEST                  
              ELSE                                                              
                 IF K813-CDE-NT = 'SB ' OR 'WL ' OR 'YS '                       
                    MOVE 'NN'              TO F008-ZONE-LATEST                  
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           MOVE K585-CDE-HOUSEHOLD(WS-LST-CTR) TO F008-HH-TYPE-LATEST           
                                                                                
           INITIALIZE  WS-NUM-AGE-YOUNG                                         
                       WS-DTE-BIRTH-YOUNG                                       
                       WS-CHILD-SPR                                             
                       WS-TAG-NEW                                               
                                                                                
           PERFORM 4000-READ-OCCUPIERS   THRU 4000-EXIT.                        
                                                                                
           MOVE WS-HH-INCOME               TO PRT-INC                           
           MOVE PRT-INC                    TO F008-HH-INCOME-LATEST             
           MOVE WS-HA1-MS                  TO F008-HA1-MS-LATEST                
           MOVE WS-HA1-INCOME              TO PRT-INC                           
           MOVE PRT-INC                    TO F008-HA1-INCOME-LATEST            
           MOVE WS-HA1-AGE                 TO PRT-AGE                           
           MOVE PRT-AGE                    TO F008-HA1-AGE-LATEST               
           MOVE CNT-HH-SIZE                TO F008-HH-SIZE-LATEST               
           MOVE CNT-CHILD                  TO F008-NO-CHILD-LATEST              
                                                                                
           IF WS-HH-SCH NOT = SPACES                                            
              MOVE 'SCH'                   TO F008-HH-CTZN-LATEST               
           ELSE                                                                 
              MOVE 'SCP'                   TO F008-HH-CTZN-LATEST               
           END-IF.                                                              
                                                                                
           MOVE K585-DTE-BALLOT(WS-1ST-CTR) TO WS-START-BALLOT.                 
           MOVE K585-DTE-BALLOT(WS-LST-CTR) TO WS-END-BALLOT.                   
           IF WS-END-YR NOT NUMERIC                                             
              MOVE ZEROES   TO WS-END-YR.                                       
           IF WS-END-MTH NOT NUMERIC                                            
              MOVE ZEROES   TO WS-END-MTH.                                      
           IF WS-START-YR NOT NUMERIC                                           
              MOVE ZEROES   TO WS-START-YR.                                     
           IF WS-START-MTH NOT NUMERIC                                          
              MOVE ZEROES   TO WS-START-MTH.                                    
           COMPUTE WS-PERIOD = (WS-END-YR * 12 + WS-END-MTH) -                  
                               (WS-START-YR * 12 + WS-START-MTH).               
           MOVE WS-PERIOD                  TO F008-NUM-MONTHS-1ST-LST.          
                                                                                
           MOVE WS-NUM-AGE-YOUNG           TO F008-YOUNG-AGE-LATEST             
           MOVE WS-DTE-BIRTH-YOUNG         TO F008-DTE-BIRTH-LATEST             
                                                                                
           EVALUATE TRUE                                                        
           WHEN K595-CDE-ELIG-SCH = 'FS' OR 'FS '                               
                MOVE 'FS '                   TO WS-TAG-NEW                      
           WHEN CNT-CHILD > 0 AND                                               
                WS-HA1-MS = 'M' AND                                             
                WS-CHILD-SPR = 'Y'                                              
                MOVE 'MSC'                   TO WS-TAG-NEW                      
           WHEN CNT-CHILD = 0 AND                                               
                WS-HA1-MS = 'M'                                                 
                MOVE 'MNC'                   TO WS-TAG-NEW                      
           WHEN CNT-CHILD > 0 AND                                               
                WS-HA1-MS = 'M' AND                                             
                WS-CHILD-SPR NOT = 'Y'                                          
                MOVE 'MPR'                   TO WS-TAG-NEW                      
           WHEN OTHER                                                           
                MOVE 'OTH'                   TO WS-TAG-NEW                      
           END-EVALUATE                                                         
                                                                                
           MOVE WS-TAG-NEW                 TO F008-TAG-LATEST.                  
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3500-FORMAT-NEW.                                                         
      ****************************************************************          
                                                                                
           MOVE SPACES                   TO K595-KEY-FLD                        
           MOVE F007-NUM-NRIC1           TO K595-ALT1-KEY                       
                                                                                
           INITIALIZE WS-BP13K595-REC                                           
                                                                                
           PERFORM 8016-READ-BP13K595    THRU 8016-EXIT.                        
                                                                                
           MOVE WS-BP13K595-REC            TO BP13K595-REC                      
                                                                                
           MOVE K595-CDE-ALLOC-SCH         TO F008-ALLO-SCH-NEW                 
           MOVE K595-CDE-ELIG-SCH          TO F008-ELIG-SCH-NEW                 
           MOVE K595-CDE-CATEGORY          TO F008-ETHNIC-NEW                   
                                                                                
           MOVE K595-NUM-REGN                  TO F008-REGN-NEW                 
           MOVE K595-NUM-ALLO-CAT              TO F008-MODE-NEW                 
           MOVE K595-DTE-BALLOT                TO F008-DTE-BALLOT-NEW           
           MOVE K595-CDE-FLAT-TYPE             TO F008-FT-NEW                   
           MOVE K595-NUM-MCPS                  TO F008-CDE-MCPS-TAG-NEW         
           MOVE K595-NUM-NT-FT-QUEUE           TO F008-NUM-QUEUE-NEW            
           MOVE K595-CDE-REQUEST-STATUS        TO F008-REQUEST-STAT-NEW         
           MOVE K595-NUM-BOOK-STATUS           TO F008-BOOK-STAT-NEW            
           MOVE K595-CDE-NT1                   TO K813-NUM-ZONE                 
           MOVE K595-CDE-FLAT-TYPE             TO K813-NUM-FLAT-TYPE.           
           MOVE K595-DTE-BALLOT                TO K813-DTE-BALLOT.              
           PERFORM 8007-READ-BP13K813  THRU 8007-EXIT                           
           MOVE K813-CDE-NT                TO F008-NT-NEW                       
           IF K813-CDE-NT = 'BB ' OR 'BP ' OR 'JW ' OR 'CCK' OR 'JE'            
              MOVE 'WW'                    TO F008-ZONE-NEW                     
           ELSE                                                                 
              IF K813-CDE-NT = 'HG ' OR 'PG ' OR 'SK '                          
                 MOVE 'NE'                 TO F008-ZONE-NEW                     
              ELSE                                                              
                 IF K813-CDE-NT = 'SB ' OR 'WL ' OR 'YS '                       
                    MOVE 'NN'              TO F008-ZONE-NEW                     
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           MOVE K595-CDE-HOUSEHOLD         TO F008-HH-TYPE-NEW                  
                                                                                
           INITIALIZE  WS-NUM-AGE-YOUNG                                         
                       WS-DTE-BIRTH-YOUNG                                       
                       WS-CHILD-SPR                                             
                       WS-TAG-NEW                                               
                       WS-HH-INCOME                                             
                       WS-HA1-MS                                                
                       WS-HA1-INCOME                                            
                       WS-HA1-AGE                                               
                       CNT-HH-SIZE                                              
                       CNT-CHILD                                                
                       WS-HH-SCH                                                
                                                                                
           IF K595-NUM-REGN NOT = SPACES AND LOW-VALUES                         
              PERFORM 6100-READ-OCCUPIERS   THRU 6100-EXIT                      
           END-IF                                                               
                                                                                
           MOVE WS-HH-INCOME               TO PRT-INC                           
           MOVE PRT-INC                    TO F008-HH-INCOME-NEW                
           MOVE WS-HA1-MS                  TO F008-HA1-MS-NEW                   
           MOVE WS-HA1-INCOME              TO PRT-INC                           
           MOVE PRT-INC                    TO F008-HA1-INCOME-NEW               
           MOVE WS-HA1-AGE                 TO PRT-AGE                           
           MOVE PRT-AGE                    TO F008-HA1-AGE-NEW                  
           MOVE CNT-HH-SIZE                TO F008-HH-SIZE-NEW                  
           MOVE CNT-CHILD                  TO F008-NO-CHILD-NEW                 
                                                                                
           IF WS-HH-SCH NOT = SPACES                                            
              MOVE 'SCH'                   TO F008-HH-CTZN-NEW                  
           ELSE                                                                 
              MOVE 'SCP'                   TO F008-HH-CTZN-NEW                  
           END-IF.                                                              
                                                                                
           MOVE WS-NUM-AGE-YOUNG           TO F008-YOUNG-AGE-NEW                
           MOVE WS-DTE-BIRTH-YOUNG         TO F008-DTE-BIRTH-NEW                
                                                                                
           EVALUATE TRUE                                                        
           WHEN K595-CDE-ELIG-SCH = 'FS' OR 'FS '                               
                MOVE 'FS '                   TO WS-TAG-NEW                      
           WHEN CNT-CHILD > 0 AND                                               
                WS-HA1-MS = 'M' AND                                             
                WS-CHILD-SPR = 'Y'                                              
                MOVE 'MSC'                   TO WS-TAG-NEW                      
           WHEN CNT-CHILD = 0 AND                                               
                WS-HA1-MS = 'M'                                                 
                MOVE 'MNC'                   TO WS-TAG-NEW                      
           WHEN CNT-CHILD > 0 AND                                               
                WS-HA1-MS = 'M' AND                                             
                WS-CHILD-SPR NOT = 'Y'                                          
                MOVE 'MPR'                   TO WS-TAG-NEW                      
           WHEN OTHER                                                           
                MOVE 'OTH'                   TO WS-TAG-NEW                      
           END-EVALUATE                                                         
                                                                                
           MOVE WS-TAG-NEW                 TO F008-TAG-NEW.                     
                                                                                
           IF F008-DTE-BALLOT-LATEST > F008-DTE-BALLOT-NEW                      
              PERFORM 3600-COMPARE THRU 3600-EXIT                               
           END-IF.                                                              
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3600-COMPARE.                                                            
      *===============================================================*         
                                                                                
            MOVE F008-REGN-LATEST                                               
                                   TO  F008-REGN-NEW.                           
            MOVE F008-MODE-LATEST                                               
                                   TO  F008-MODE-NEW.                           
            MOVE F008-DTE-BALLOT-LATEST                                         
                                   TO  F008-DTE-BALLOT-NEW.                     
            MOVE F008-FT-LATEST                                                 
                                   TO  F008-FT-NEW.                             
            MOVE F008-ALLO-SCH-NEW                                              
                                   TO  F008-ALLO-SCH-LATEST.                    
            MOVE F008-ELIG-SCH-LATEST                                           
                                   TO  F008-ELIG-SCH-NEW.                       
            MOVE F008-HH-INCOME-LATEST                                          
                                   TO  F008-HH-INCOME-NEW.                      
            MOVE F008-HA1-MS-LATEST                                             
                                   TO  F008-HA1-MS-NEW.                         
            MOVE F008-HA1-INCOME-LATEST                                         
                                   TO  F008-HA1-INCOME-NEW.                     
            MOVE F008-HA1-AGE-LATEST                                            
                                   TO  F008-HA1-AGE-NEW.                        
            MOVE F008-NT-LATEST                                                 
                                   TO  F008-NT-NEW.                             
            MOVE F008-ZONE-LATEST                                               
                                   TO  F008-ZONE-NEW.                           
            MOVE F008-ETHNIC-LATEST                                             
                                   TO  F008-ETHNIC-NEW.                         
            MOVE F008-HH-SIZE-NEW                                               
                                   TO  F008-HH-SIZE-LATEST.                     
            MOVE F008-NO-CHILD-LATEST                                           
                                   TO  F008-NO-CHILD-NEW.                       
            MOVE F008-HH-TYPE-LATEST                                            
                                   TO  F008-HH-TYPE-NEW.                        
            MOVE F008-HH-CTZN-LATEST                                            
                                   TO  F008-HH-CTZN-NEW.                        
            MOVE  F008-YOUNG-AGE-LATEST                                         
                                   TO  F008-YOUNG-AGE-NEW.                      
            MOVE  F008-DTE-BIRTH-LATEST                                         
                                   TO  F008-DTE-BIRTH-NEW.                      
            MOVE  F008-TAG-LATEST                                               
                                   TO  F008-TAG-NEW.                            
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3700-MOVE-DELIMITER.                                                     
      *===============================================================*         
                                                                                
           MOVE ';'       TO F008-FIL001  F008-FIL002  F008-FIL003              
                             F008-FIL004  F008-FIL005  F008-FIL006              
                             F008-FIL007  F008-FIL008  F008-FIL009              
                             F008-FIL010  F008-FIL011  F008-FIL012              
                             F008-FIL013  F008-FIL014  F008-FIL015              
                             F008-FIL016  F008-FIL017  F008-FIL018              
                             F008-FIL019  F008-FIL020  F008-FIL021              
                             F008-FIL022  F008-FIL023  F008-FIL024              
                             F008-FIL025  F008-FIL026  F008-FIL027              
                             F008-FIL028  F008-FIL029  F008-FIL030              
                             F008-FIL031  F008-FIL032  F008-FIL033              
                             F008-FIL034  F008-FIL035  F008-FIL036              
                             F008-FIL037  F008-FIL038  F008-FIL039              
                             F008-FIL040  F008-FIL041  F008-FIL042              
                             F008-FIL060  F008-FIL061  F008-FIL062              
                             F008-FIL063  F008-FIL064  F008-FIL065              
                             F008-FIL066  F008-FIL067  F008-FIL068              
                             F008-FIL069  F008-FIL070  F008-FIL071              
                             F008-FIL072  F008-FIL073  F008-FIL074              
                             F008-FIL075  F008-FIL076  F008-FIL077              
                             F008-FIL078  F008-FIL079  F008-FIL080              
                             F008-FIL081  F008-FIL082  F008-FIL083.             
                                                                                
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 12                     
              MOVE ';'  TO F008-FIL050(WS-I) F008-FIL051(WS-I)                  
                           F008-FIL052(WS-I) F008-FIL053(WS-I)                  
                           F008-FIL054(WS-I) F008-FIL055(WS-I)                  
                           F008-FIL056(WS-I) F008-FIL057(WS-I)                  
                           F008-FIL058(WS-I) F008-FIL059(WS-I)                  
           END-PERFORM.                                                         
                                                                                
       3700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4000-READ-OCCUPIERS.                                                     
      *===============================================================*         
                                                                                
           MOVE 0                                   TO WS-AGE                   
                                                       CNT-CHILD                
                                                       CNT-HH-SIZE              
                                                       WS-HH-INCOME             
                                                       WS-HA1-INCOME            
                                                       WS-HA1-AGE               
           MOVE SPACES                              TO WS-HA1-ETHNIC            
                                                       WS-HA1-MS                
                                                       WS-HH-SCP                
                                                       WS-HH-SCH.               
                                                                                
           MOVE 'N'                                 TO WS-K820-FOUND.           
           PERFORM 8002-START-BP13K820            THRU 8002-EXIT.               
           IF K820-FND                                                          
              PERFORM UNTIL WS-K820-EOF = 'Y'                                   
                 PERFORM 8003-READNEXT-BP13K820   THRU 8003-EXIT                
                 IF NOT WS-K820-EOF = 'Y'                                       
                    ADD 1                           TO CNT-K820-READ            
                    PERFORM 4001-COMPUTE-AGE      THRU 4001-EXIT                
                    PERFORM 4002-CHECK-CTZSHP-CDE THRU 4002-EXIT                
                 END-IF                                                         
              END-PERFORM                                                       
           END-IF.                                                              
                                                                                
           IF WS-K820-FOUND = 'N'                                               
              MOVE 'N'                               TO WS-K828-FOUND           
              PERFORM 8004-START-BP13K828            THRU 8004-EXIT             
              IF K828-FND                                                       
                 PERFORM UNTIL WS-K828-EOF = 'Y'                                
                    PERFORM 8005-READNEXT-BP13K828   THRU 8005-EXIT             
                    IF NOT WS-K828-EOF = 'Y'                                    
                       ADD 1                           TO CNT-K828-READ         
                       PERFORM 4003-COMPUTE-AGE      THRU 4003-EXIT             
                       PERFORM 4004-CHECK-CTZSHP-CDE THRU 4004-EXIT             
                    END-IF                                                      
                 END-PERFORM                                                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-K828-FOUND = 'N'                                               
              MOVE 'N'                          TO WS-K895-FND                  
              PERFORM 5000-STARTBR-BP13K895     THRU 5000-EXIT                  
              IF K895-FND                                                       
                 PERFORM UNTIL WS-K895-EOF = 'Y'                                
                    PERFORM 5100-READNXT-K895   THRU 5100-EXIT                  
                    IF NOT WS-K895-EOF = 'Y'                                    
                       ADD 1                  TO CNT-K895-READ                  
                       PERFORM 4005-COMPUTE-AGE    THRU 4005-EXIT               
                       PERFORM 4006-CHECK-CTZSHP-CDE THRU 4006-EXIT             
                    END-IF                                                      
                 END-PERFORM                                                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4001-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF K820-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K820-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K820-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K820-AMT-INCOME            
           END-IF.                                                              
           IF K585-DTE-REQUEST(WS-LST-CTR) NOT NUMERIC                          
              MOVE ZEROS              TO K585-DTE-REQUEST(WS-LST-CTR)           
           END-IF.                                                              
                                                                                
           IF K585-DTE-REQUEST(WS-LST-CTR) > ZEROS                              
              MOVE K585-DTE-REQUEST(WS-LST-CTR) TO WS-NUM-REGN                  
              IF WS-NUM-REGN > WS-NUM-BIRTH                                     
                 COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                
              ELSE                                                              
                 COMPUTE WS-NUM-AGE = 0                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF.                                                              
                                                                                
           ADD K820-AMT-INCOME                   TO WS-HH-INCOME                
                                                                                
           IF K820-NUM-NRIC = K585-NUM-NRIC1(WS-LST-CTR)                        
              MOVE WS-AGE-CY                      TO WS-HA1-AGE                 
              MOVE K820-AMT-INCOME                TO WS-HA1-INCOME              
              EVALUATE K820-NUM-MARITAL-STATUS                                  
                  WHEN '1'                                                      
                       MOVE 'S'                   TO WS-HA1-MS                  
                  WHEN '2'                                                      
                       MOVE 'M'                   TO WS-HA1-MS                  
                  WHEN '3'                                                      
                       MOVE 'W'                   TO WS-HA1-MS                  
                  WHEN '4'                                                      
                       MOVE 'D'                   TO WS-HA1-MS                  
                  WHEN '5'                                                      
                       MOVE 'P'                   TO WS-HA1-MS                  
                  WHEN OTHER                                                    
                       MOVE K820-NUM-MARITAL-STATUS TO WS-HA1-MS                
              END-EVALUATE                                                      
           END-IF.                                                              
                                                                                
       4001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4002-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K820-NUM-RELATIONSHIP NOT = '00'                                 
               IF K820-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K820-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
           IF K820-NUM-RELATIONSHIP = '41'                                      
              IF (WS-AGE-CY  < WS-NUM-AGE-YOUNG) OR                             
                 (WS-NUM-AGE-YOUNG = SPACES OR ZEROES)                          
                 MOVE WS-AGE-CY        TO WS-NUM-AGE-YOUNG                      
                 MOVE K820-DTE-BIRTH   TO WS-DTE-BIRTH-YOUNG                    
              END-IF                                                            
              IF K820-NUM-CITIZENSHIP = '10' OR 'SC'                            
                 MOVE 'Y'              TO WS-CHILD-SPR                          
              END-IF                                                            
           END-IF.                                                              
       4002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4003-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF K828-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K828-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K828-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K828-AMT-INCOME            
           END-IF.                                                              
           IF K585-DTE-REQUEST(WS-LST-CTR) NOT NUMERIC                          
              MOVE ZEROS              TO K585-DTE-REQUEST(WS-LST-CTR)           
           END-IF.                                                              
                                                                                
           MOVE K828-DTE-BIRTH                    TO WS-NUM-BIRTH               
                                                                                
           MOVE K585-DTE-REQUEST(WS-LST-CTR)      TO WS-NUM-REGN                
           IF WS-NUM-REGN > WS-NUM-BIRTH                                        
              COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                   
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF.                                                              
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF.                                                              
                                                                                
           IF K828-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K828-AMT-INCOME            
           END-IF.                                                              
                                                                                
           ADD K828-AMT-INCOME                    TO WS-HH-INCOME               
                                                                                
           IF K828-NUM-NRIC = K585-NUM-NRIC1(WS-LST-CTR)                        
              MOVE WS-AGE-CY                      TO WS-HA1-AGE                 
              MOVE K828-AMT-INCOME                TO WS-HA1-INCOME              
              EVALUATE K828-NUM-MARITAL-STATUS                                  
                  WHEN '1'                                                      
                       MOVE 'S'                   TO WS-HA1-MS                  
                  WHEN '2'                                                      
                       MOVE 'M'                   TO WS-HA1-MS                  
                  WHEN '3'                                                      
                       MOVE 'W'                   TO WS-HA1-MS                  
                  WHEN '4'                                                      
                       MOVE 'D'                   TO WS-HA1-MS                  
                  WHEN '5'                                                      
                       MOVE 'P'                   TO WS-HA1-MS                  
                  WHEN OTHER                                                    
                       MOVE K828-NUM-MARITAL-STATUS TO WS-HA1-MS                
              END-EVALUATE                                                      
           END-IF.                                                              
                                                                                
       4003-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4004-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K828-NUM-RELATIONSHIP NOT = '00'                                 
               IF K828-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K828-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
           IF K828-NUM-RELATIONSHIP = '41'                                      
              IF (WS-AGE-CY  < WS-NUM-AGE-YOUNG) OR                             
                 (WS-NUM-AGE-YOUNG = SPACES OR ZEROES)                          
                 MOVE WS-AGE-CY        TO WS-NUM-AGE-YOUNG                      
                 MOVE K828-DTE-BIRTH   TO WS-DTE-BIRTH-YOUNG                    
              END-IF                                                            
              IF K828-NUM-CITIZENSHIP = '10' OR 'SC'                            
                 MOVE 'Y'              TO WS-CHILD-SPR                          
              END-IF                                                            
           END-IF.                                                              
       4004-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4005-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF K895-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K895-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K895-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K895-AMT-INCOME            
           END-IF.                                                              
           IF K585-DTE-REQUEST(WS-LST-CTR) NOT NUMERIC                          
              MOVE ZEROS              TO K585-DTE-REQUEST(WS-LST-CTR)           
           END-IF.                                                              
                                                                                
           MOVE K895-DTE-BIRTH                    TO WS-NUM-BIRTH               
                                                                                
           MOVE K585-DTE-REQUEST(WS-LST-CTR)      TO WS-NUM-REGN                
           IF WS-NUM-REGN > WS-NUM-BIRTH                                        
              COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                   
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF.                                                              
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF.                                                              
                                                                                
           ADD K895-AMT-INCOME                    TO WS-HH-INCOME               
                                                                                
           IF K895-NUM-NRIC = K585-NUM-NRIC1(WS-LST-CTR)                        
              MOVE WS-AGE-CY                      TO WS-HA1-AGE                 
              MOVE K895-AMT-INCOME                TO WS-HA1-INCOME              
              EVALUATE K895-NUM-MARITAL-STATUS                                  
                  WHEN '1'                                                      
                       MOVE 'S'                   TO WS-HA1-MS                  
                  WHEN '2'                                                      
                       MOVE 'M'                   TO WS-HA1-MS                  
                  WHEN '3'                                                      
                       MOVE 'W'                   TO WS-HA1-MS                  
                  WHEN '4'                                                      
                       MOVE 'D'                   TO WS-HA1-MS                  
                  WHEN '5'                                                      
                       MOVE 'P'                   TO WS-HA1-MS                  
                  WHEN OTHER                                                    
                       MOVE K895-NUM-MARITAL-STATUS TO WS-HA1-MS                
              END-EVALUATE                                                      
           END-IF.                                                              
                                                                                
       4005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4006-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K895-NUM-RELATIONSHIP NOT = '00'                                 
               IF K895-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K895-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
           IF K895-NUM-RELATIONSHIP = '41'                                      
              IF (WS-AGE-CY  < WS-NUM-AGE-YOUNG) OR                             
                 (WS-NUM-AGE-YOUNG = SPACES OR ZEROES)                          
                 MOVE WS-AGE-CY        TO WS-NUM-AGE-YOUNG                      
                 MOVE K895-DTE-BIRTH   TO WS-DTE-BIRTH-YOUNG                    
              END-IF                                                            
              IF K895-NUM-CITIZENSHIP = '10' OR 'SC'                            
                 MOVE 'Y'              TO WS-CHILD-SPR                          
              END-IF                                                            
           END-IF.                                                              
       4006-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6100-READ-OCCUPIERS.                                                     
      *===============================================================*         
                                                                                
           MOVE 0                                   TO WS-AGE                   
                                                       CNT-CHILD                
                                                       CNT-HH-SIZE              
                                                       WS-HH-INCOME             
                                                       WS-HA1-INCOME            
                                                       WS-HA1-AGE               
           MOVE SPACES                              TO WS-HA1-ETHNIC            
                                                       WS-HA1-MS                
                                                       WS-HH-SCP                
                                                       WS-HH-SCH.               
                                                                                
           MOVE 'N'                                 TO WS-K820-FOUND.           
           PERFORM 8012-START-BP13K820            THRU 8012-EXIT.               
           IF K820-FND                                                          
              PERFORM UNTIL WS-K820-EOF = 'Y'                                   
                 PERFORM 8013-READNEXT-BP13K820   THRU 8013-EXIT                
                 IF NOT WS-K820-EOF = 'Y'                                       
                    ADD 1                           TO CNT-K820-READ            
                    PERFORM 6101-COMPUTE-AGE      THRU 6101-EXIT                
                    PERFORM 6102-CHECK-CTZSHP-CDE THRU 6102-EXIT                
                 END-IF                                                         
              END-PERFORM                                                       
           END-IF.                                                              
                                                                                
           IF WS-K820-FOUND = 'N'                                               
              MOVE 'N'                               TO WS-K828-FOUND           
              PERFORM 8014-START-BP13K828            THRU 8014-EXIT             
              IF K828-FND                                                       
                 PERFORM UNTIL WS-K828-EOF = 'Y'                                
                    PERFORM 8015-READNEXT-BP13K828   THRU 8015-EXIT             
                    IF NOT WS-K828-EOF = 'Y'                                    
                       ADD 1                           TO CNT-K828-READ         
                       PERFORM 6103-COMPUTE-AGE      THRU 6103-EXIT             
                       PERFORM 6104-CHECK-CTZSHP-CDE THRU 6104-EXIT             
                    END-IF                                                      
                 END-PERFORM                                                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-K828-FOUND = 'N'                                               
              MOVE 'N'                          TO WS-K895-FND                  
              PERFORM 7000-STARTBR-BP13K895     THRU 7000-EXIT                  
              IF K895-FND                                                       
                 PERFORM UNTIL WS-K895-EOF = 'Y'                                
                    PERFORM 7100-READNXT-K895   THRU 7100-EXIT                  
                    IF NOT WS-K895-EOF = 'Y'                                    
                       ADD 1                  TO CNT-K895-READ                  
                       PERFORM 6105-COMPUTE-AGE    THRU 6105-EXIT               
                       PERFORM 6106-CHECK-CTZSHP-CDE THRU 6106-EXIT             
                    END-IF                                                      
                 END-PERFORM                                                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6101-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF K820-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K820-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K820-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K820-AMT-INCOME            
           END-IF.                                                              
           IF K595-DTE-REQUEST    NOT NUMERIC                                   
              MOVE ZEROS              TO K595-DTE-REQUEST                       
           END-IF.                                                              
                                                                                
           IF K595-DTE-REQUEST > ZEROS                                          
              MOVE K595-DTE-REQUEST             TO WS-NUM-REGN                  
              IF WS-NUM-REGN > WS-NUM-BIRTH                                     
                 COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                
              ELSE                                                              
                 COMPUTE WS-NUM-AGE = 0                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF.                                                              
                                                                                
           ADD K820-AMT-INCOME                   TO WS-HH-INCOME                
                                                                                
           IF K820-NUM-NRIC = K595-NUM-NRIC1                                    
              MOVE WS-AGE-CY                      TO WS-HA1-AGE                 
              MOVE K820-AMT-INCOME                TO WS-HA1-INCOME              
              EVALUATE K820-NUM-MARITAL-STATUS                                  
                  WHEN '1'                                                      
                       MOVE 'S'                   TO WS-HA1-MS                  
                  WHEN '2'                                                      
                       MOVE 'M'                   TO WS-HA1-MS                  
                  WHEN '3'                                                      
                       MOVE 'W'                   TO WS-HA1-MS                  
                  WHEN '4'                                                      
                       MOVE 'D'                   TO WS-HA1-MS                  
                  WHEN '5'                                                      
                       MOVE 'P'                   TO WS-HA1-MS                  
                  WHEN OTHER                                                    
                       MOVE K820-NUM-MARITAL-STATUS TO WS-HA1-MS                
              END-EVALUATE                                                      
           END-IF.                                                              
                                                                                
       6101-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6102-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K820-NUM-RELATIONSHIP NOT = '00'                                 
               IF K820-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K820-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
           IF K820-NUM-RELATIONSHIP = '41'                                      
              IF (WS-AGE-CY  < WS-NUM-AGE-YOUNG) OR                             
                 (WS-NUM-AGE-YOUNG = SPACES OR ZEROES)                          
                 MOVE WS-AGE-CY        TO WS-NUM-AGE-YOUNG                      
                 MOVE K820-DTE-BIRTH   TO WS-DTE-BIRTH-YOUNG                    
              END-IF                                                            
              IF K820-NUM-CITIZENSHIP = '10' OR 'SC'                            
                 MOVE 'Y'              TO WS-CHILD-SPR                          
              END-IF                                                            
           END-IF.                                                              
       6102-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6103-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF K828-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K828-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K828-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K828-AMT-INCOME            
           END-IF.                                                              
           IF K595-DTE-REQUEST NOT NUMERIC                                      
              MOVE ZEROS              TO K595-DTE-REQUEST                       
           END-IF.                                                              
                                                                                
           MOVE K828-DTE-BIRTH                    TO WS-NUM-BIRTH               
                                                                                
           MOVE K595-DTE-REQUEST                  TO WS-NUM-REGN                
           IF WS-NUM-REGN > WS-NUM-BIRTH                                        
              COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                   
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF.                                                              
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF.                                                              
                                                                                
           IF K828-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K828-AMT-INCOME            
           END-IF.                                                              
                                                                                
           ADD K828-AMT-INCOME                    TO WS-HH-INCOME               
                                                                                
           IF K828-NUM-NRIC = K595-NUM-NRIC1                                    
              MOVE WS-AGE-CY                      TO WS-HA1-AGE                 
              MOVE K828-AMT-INCOME                TO WS-HA1-INCOME              
              EVALUATE K828-NUM-MARITAL-STATUS                                  
                  WHEN '1'                                                      
                       MOVE 'S'                   TO WS-HA1-MS                  
                  WHEN '2'                                                      
                       MOVE 'M'                   TO WS-HA1-MS                  
                  WHEN '3'                                                      
                       MOVE 'W'                   TO WS-HA1-MS                  
                  WHEN '4'                                                      
                       MOVE 'D'                   TO WS-HA1-MS                  
                  WHEN '5'                                                      
                       MOVE 'P'                   TO WS-HA1-MS                  
                  WHEN OTHER                                                    
                       MOVE K828-NUM-MARITAL-STATUS TO WS-HA1-MS                
              END-EVALUATE                                                      
           END-IF.                                                              
                                                                                
       6103-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6104-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K828-NUM-RELATIONSHIP NOT = '00'                                 
               IF K828-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K828-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
           IF K828-NUM-RELATIONSHIP = '41'                                      
              IF (WS-AGE-CY  < WS-NUM-AGE-YOUNG) OR                             
                 (WS-NUM-AGE-YOUNG = SPACES OR ZEROES)                          
                 MOVE WS-AGE-CY        TO WS-NUM-AGE-YOUNG                      
                 MOVE K828-DTE-BIRTH   TO WS-DTE-BIRTH-YOUNG                    
              END-IF                                                            
              IF K828-NUM-CITIZENSHIP = '10' OR 'SC'                            
                 MOVE 'Y'              TO WS-CHILD-SPR                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6104-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6105-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF K895-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K895-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K895-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K895-AMT-INCOME            
           END-IF.                                                              
           IF K595-DTE-REQUEST NOT NUMERIC                                      
              MOVE ZEROS              TO K595-DTE-REQUEST                       
           END-IF.                                                              
                                                                                
           MOVE K895-DTE-BIRTH                    TO WS-NUM-BIRTH               
                                                                                
           MOVE K595-DTE-REQUEST                  TO WS-NUM-REGN                
           IF WS-NUM-REGN > WS-NUM-BIRTH                                        
              COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                   
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF.                                                              
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF.                                                              
                                                                                
           ADD K895-AMT-INCOME                    TO WS-HH-INCOME               
                                                                                
           IF K895-NUM-NRIC = K595-NUM-NRIC1                                    
              MOVE WS-AGE-CY                      TO WS-HA1-AGE                 
              MOVE K895-AMT-INCOME                TO WS-HA1-INCOME              
              EVALUATE K895-NUM-MARITAL-STATUS                                  
                  WHEN '1'                                                      
                       MOVE 'S'                   TO WS-HA1-MS                  
                  WHEN '2'                                                      
                       MOVE 'M'                   TO WS-HA1-MS                  
                  WHEN '3'                                                      
                       MOVE 'W'                   TO WS-HA1-MS                  
                  WHEN '4'                                                      
                       MOVE 'D'                   TO WS-HA1-MS                  
                  WHEN '5'                                                      
                       MOVE 'P'                   TO WS-HA1-MS                  
                  WHEN OTHER                                                    
                       MOVE K895-NUM-MARITAL-STATUS TO WS-HA1-MS                
              END-EVALUATE                                                      
           END-IF.                                                              
                                                                                
                                                                                
       6105-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6106-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K895-NUM-RELATIONSHIP NOT = '00'                                 
               IF K895-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K895-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
           IF K895-NUM-RELATIONSHIP = '41'                                      
              IF (WS-AGE-CY  < WS-NUM-AGE-YOUNG) OR                             
                 (WS-NUM-AGE-YOUNG = SPACES OR ZEROES)                          
                 MOVE WS-AGE-CY        TO WS-NUM-AGE-YOUNG                      
                 MOVE K895-DTE-BIRTH   TO WS-DTE-BIRTH-YOUNG                    
              END-IF                                                            
              IF K895-NUM-CITIZENSHIP = '10' OR 'SC'                            
                 MOVE 'Y'              TO WS-CHILD-SPR                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6106-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       5000-STARTBR-BP13K895.                                                   
      *---------------------------------------------------------------*         
            MOVE 'N'             TO  WS-K895-EOF                                
                                     WS-K895-FND                                
            MOVE SPACES          TO  K895-KEY-FLD.                              
            MOVE K585-NUM-REGN(WS-LST-CTR)  TO  K895-NUM-REGN-HIST.             
                                                                                
            START BP13K895 KEY >= K895-KEY-FLD.                                 
                                                                                
            EVALUATE K895-STATUS                                                
               WHEN ZERO                                                        
                 MOVE 'N'                         TO WS-K895-EOF                
                 MOVE 'Y'                         TO WS-K895-FND                
               WHEN 23                                                          
                 MOVE 'Y'                         TO WS-K895-EOF                
                 MOVE 'N'                         TO WS-K895-FND                
               WHEN OTHER                                                       
                 DISPLAY 'READ ERROR, K895-STATUS ' K895-STATUS                 
                      ' KEY ' K895-KEY-FLD                                      
            END-EVALUATE.                                                       
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *---------------------------------------------------------------*         
       5100-READNXT-K895.                                                       
      *---------------------------------------------------------------*         
           READ BP13K895 NEXT AT END                                            
                MOVE 'Y' TO WS-K895-EOF.                                        
                                                                                
            EVALUATE K895-STATUS                                                
               WHEN ZERO                                                        
               WHEN 02                                                          
                 IF K895-NUM-REGN-HIST = K585-NUM-REGN(WS-LST-CTR)              
                    ADD 1                            TO CNT-HH-SIZE             
                    MOVE 'Y'                         TO WS-K895-FND             
                                                                                
                    IF K895-NUM-RELATIONSHIP NOT NUMERIC                        
                       MOVE ZEROES           TO K895-NUM-RELATIONSHIP           
                    END-IF                                                      
                                                                                
                    IF K895-NUM-RELATIONSHIP = 41                               
                       ADD 1                 TO CNT-CHILD                       
                    END-IF                                                      
                 ELSE                                                           
                    MOVE 'Y'                         TO WS-K895-EOF             
                 END-IF                                                         
                                                                                
               WHEN 23                                                          
                 DISPLAY 'RECORD NOT FOUND IN BP13K895 ' K895-KEY-FLD           
               WHEN OTHER                                                       
                 DISPLAY 'READ ERROR, K895-STATUS ' K895-STATUS                 
                      ' REGN = ' K895-NUM-REGN                                  
            END-EVALUATE.                                                       
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
      *---------------------------------------------------------------*         
       7000-STARTBR-BP13K895.                                                   
      *---------------------------------------------------------------*         
            MOVE 'N'             TO  WS-K895-EOF                                
                                     WS-K895-FND                                
            MOVE SPACES          TO  K895-KEY-FLD.                              
            MOVE K595-NUM-REGN              TO  K895-NUM-REGN-HIST.             
                                                                                
            START BP13K895 KEY >= K895-KEY-FLD.                                 
                                                                                
            EVALUATE K895-STATUS                                                
               WHEN ZERO                                                        
                 MOVE 'N'                         TO WS-K895-EOF                
                 MOVE 'Y'                         TO WS-K895-FND                
               WHEN 23                                                          
                 MOVE 'Y'                         TO WS-K895-EOF                
                 MOVE 'N'                         TO WS-K895-FND                
               WHEN OTHER                                                       
                 DISPLAY 'READ ERROR, K895-STATUS ' K895-STATUS                 
                      ' KEY ' K895-KEY-FLD                                      
            END-EVALUATE.                                                       
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *---------------------------------------------------------------*         
       7100-READNXT-K895.                                                       
      *---------------------------------------------------------------*         
           READ BP13K895 NEXT AT END                                            
                MOVE 'Y' TO WS-K895-EOF.                                        
                                                                                
            EVALUATE K895-STATUS                                                
               WHEN ZERO                                                        
               WHEN 02                                                          
                 IF K895-NUM-REGN-HIST = K595-NUM-REGN                          
                    ADD 1                            TO CNT-HH-SIZE             
                    MOVE 'Y'                         TO WS-K895-FND             
                                                                                
                    IF K895-NUM-RELATIONSHIP NOT NUMERIC                        
                       MOVE ZEROES           TO K895-NUM-RELATIONSHIP           
                    END-IF                                                      
                                                                                
                    IF K895-NUM-RELATIONSHIP = 41                               
                       ADD 1                 TO CNT-CHILD                       
                    END-IF                                                      
                 ELSE                                                           
                    MOVE 'Y'                         TO WS-K895-EOF             
                 END-IF                                                         
                                                                                
               WHEN 23                                                          
                 DISPLAY 'RECORD NOT FOUND IN BP13K895 ' K895-KEY-FLD           
               WHEN OTHER                                                       
                 DISPLAY 'READ ERROR, K895-STATUS ' K895-STATUS                 
                      ' REGN = ' K895-NUM-REGN                                  
            END-EVALUATE.                                                       
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=======================*                                                 
       8000-READ-BP13K585.                                                      
      *=======================*                                                 
                                                                                
           MOVE 'N'                   TO WS-K585-FND.                           
           READ BP13K585.                                                       
                                                                                
           IF K585-STATUS = 00 OR 02                                            
              MOVE 'Y'                   TO WS-K585-FND                         
           ELSE                                                                 
              IF K585-STATUS = 23 OR 10                                         
                 MOVE 'N'                TO WS-K585-FND                         
                 DISPLAY 'BP13K585 - RECORD NOT FND : ' K585-KEY-FLD            
              ELSE                                                              
                 DISPLAY 'BP13K585 - ERROR READING NEXT : '                     
                         K585-STATUS                                            
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=======================*                                                 
       8001-READ-BP13K593.                                                      
      *=======================*                                                 
                                                                                
           READ BP13K593.                                                       
                                                                                
           IF K593-STATUS = 00 OR 02                                            
              CONTINUE                                                          
           ELSE                                                                 
              IF K593-STATUS = 23 OR 10                                         
                 MOVE ZEROES       TO K593-NUM-UNSUCC-TOT                       
              ELSE                                                              
                 DISPLAY 'BP13K593 - ERROR READING NEXT : '                     
                         K593-STATUS                                            
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K593-NUM-UNSUCC-TOT NOT NUMERIC                                   
              MOVE ZEROES          TO K593-NUM-UNSUCC-TOT.                      
                                                                                
                                                                                
       8001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8002-START-BP13K820.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K820-REC               
           INITIALIZE                                BP13K820-REC.              
           MOVE 'N'                               TO WS-K820-EOF                
                                                     WS-K820-FND.               
                                                                                
           MOVE K585-NUM-REGN(WS-LST-CTR)         TO K820-NUM-REGN              
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           IF K820-STATUS = 00 OR 02                                            
              MOVE 'Y'                            TO WS-K820-FND                
           ELSE                                                                 
              IF K820-STATUS = 23 OR 10                                         
                 MOVE 'N'                         TO WS-K820-FND                
              ELSE                                                              
                 DISPLAY 'BP13K820 - ERROR STARTING : ' K820-STATUS             
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8003-READNEXT-BP13K820.                                                  
      *===============================================================*         
                                                                                
           READ BP13K820 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K820-EOF                                      
                GO          TO 3300-EXIT                                        
           END-READ.                                                            
                                                                                
           IF K820-STATUS = 00 OR 02                                            
              IF K820-NUM-REGN = K585-NUM-REGN(WS-LST-CTR)                      
                 MOVE 'Y'                         TO WS-K820-FOUND              
                 ADD 1                            TO CNT-HH-SIZE                
                                                                                
                 IF K820-NUM-RELATIONSHIP NOT NUMERIC                           
                    MOVE ZEROES           TO K820-NUM-RELATIONSHIP              
                 END-IF                                                         
                                                                                
                 IF K820-NUM-RELATIONSHIP = 41                                  
                    ADD 1                 TO CNT-CHILD                          
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'                         TO WS-K820-EOF                
              END-IF                                                            
           ELSE                                                                 
              IF K820-STATUS = 23 OR 10                                         
                 MOVE 'Y'                         TO WS-K820-EOF                
              ELSE                                                              
                 DISPLAY 'BP13K820 - ERROR READING NEXT : ' K820-STATUS         
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8003-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8004-START-BP13K828.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K828-REC               
           INITIALIZE                                BP13K828-REC.              
           MOVE 'N'                               TO WS-K828-EOF                
                                                     WS-K828-FND.               
                                                                                
           MOVE K585-NUM-REGN(WS-LST-CTR)         TO K828-NUM-REGN              
                                                                                
           START BP13K828 KEY >= K828-KEY-FLD.                                  
                                                                                
           IF K828-STATUS = 00 OR 02                                            
              MOVE 'Y'                            TO WS-K828-FND                
           ELSE                                                                 
              IF K828-STATUS = 23 OR 10                                         
                 MOVE 'N'                         TO WS-K828-FND                
              ELSE                                                              
                 DISPLAY 'BP13K828 - ERROR STARTING : ' K828-STATUS             
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8004-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8005-READNEXT-BP13K828.                                                  
      *===============================================================*         
                                                                                
           READ BP13K828 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K828-EOF                                      
                GO          TO 8005-EXIT                                        
           END-READ.                                                            
                                                                                
           IF K828-STATUS = 00 OR 02                                            
              IF K828-NUM-REGN = K585-NUM-REGN(WS-LST-CTR)                      
                 ADD 1                            TO CNT-HH-SIZE                
                 MOVE 'Y'                         TO WS-K828-FOUND              
                                                                                
                 IF K828-NUM-RELATIONSHIP NOT NUMERIC                           
                    MOVE ZEROES           TO K828-NUM-RELATIONSHIP              
                 END-IF                                                         
                                                                                
                 IF K828-NUM-RELATIONSHIP = 41                                  
                    ADD 1                 TO CNT-CHILD                          
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'                         TO WS-K828-EOF                
              END-IF                                                            
           ELSE                                                                 
              IF K828-STATUS = 23 OR 10                                         
                 MOVE 'Y'                         TO WS-K828-EOF                
              ELSE                                                              
                 DISPLAY 'BP13K828 - ERROR READING NEXT : ' K828-STATUS         
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=======================*                                                 
       8006-READ-BP13K595.                                                      
      *=======================*                                                 
                                                                                
           MOVE 'N'     TO WS-K595-EOF.                                         
           START BP13K595 KEY >= K595-KEY-FLD                                   
                                                                                
           IF K595-STATUS = 00 OR 02                                            
              PERFORM 8010-READNXT-K595 THRU 8010-EXIT                          
                UNTIL WS-K595-EOF = 'Y'                                         
           ELSE                                                                 
              IF K595-STATUS = 23 OR 10                                         
                 MOVE SPACES          TO BP13K595-REC                           
                 DISPLAY 'BP13K595 - RECORD NOT FND : ' K595-KEY-FLD            
              ELSE                                                              
                 DISPLAY 'BP13K595 - ERROR READING NEXT : '                     
                         K595-STATUS                                            
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8006-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8007-READ-BP13K813.                                                      
      *===============================================================*         
                                                                                
           READ BP13K813.                                                       
                                                                                
           IF K813-STATUS = 00                                                  
              CONTINUE                                                          
           ELSE                                                                 
              IF K813-STATUS = 23                                               
                 MOVE K813-NUM-ZONE   TO K813-CDE-NT                            
              ELSE                                                              
                 DISPLAY 'BP13K813 - ERROR READING , '                          
                         ' STATUS : ' K813-STATUS                               
                         ' KEY : ' K813-KEY-FLD                                 
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8007-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8008-READ-BM06K110.                                                      
      *===============================================================*         
                                                                                
           READ BM06K110 KEY IS K110-REGN-NO                                    
                                                                                
           IF K110-STATUS = 00 OR 02                                            
              CONTINUE                                                          
           ELSE                                                                 
              IF K110-STATUS = 23                                               
                 MOVE ZEROES          TO K110-CURR-SELLING-PRICE                
              ELSE                                                              
                 DISPLAY 'BM06K110 - ERROR READING , '                          
                         ' STATUS : ' K110-STATUS                               
                         ' KEY : ' K110-KEY-FLD                                 
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8008-EXIT.                                                               
           EXIT.                                                                
      *                                                                         
      *===============================================================*         
       8009-CALL-BP13C913.                                                      
      *===============================================================*         
                                                                                
           CALL 'BP13C913' USING                                                
                 WS-LINK-REC, BP13COMM8-REC                                     
           END-CALL.                                                            
                                                                                
           IF COMM8-CDE-SYSERR NOT = 0                                          
              IF COMM8-CDE-SYSERR = 100                                         
                 DISPLAY 'SCH-ACC NOT FOUND IN PBF TABLE'                       
                         COMM8-CDE-SYSERR                                       
              ELSE                                                              
                 DISPLAY 'ERROR READING PBF TABLE' COMM8-CDE-SYSERR             
              END-IF                                                            
              MOVE SPACES        TO BP13COMM8-REC                               
           END-IF.                                                              
                                                                                
       8009-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8010-READNXT-K595.                                                       
      *===============================================================*         
                                                                                
           READ BP13K595 NEXT RECORD                                            
                                                                                
           IF K595-STATUS = 00 OR 02                                            
              IF K585-NUM-REGN(WS-LST-CTR) = K595-NUM-REGN-REF                  
                 IF K595-NUM-RANDOM NOT = SPACES AND LOW-VALUES                 
                    MOVE K595-CDE-ALLOC-SCH  TO F008-ALLO-SCH-LATEST            
                    MOVE K595-CDE-ELIG-SCH   TO F008-ELIG-SCH-LATEST            
                    MOVE K595-CDE-CATEGORY   TO F008-ETHNIC-LATEST              
                    MOVE 'Y'     TO WS-K595-EOF                                 
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'     TO WS-K595-EOF                                    
              END-IF                                                            
           ELSE                                                                 
              IF K595-STATUS = 23 OR 10                                         
                 MOVE 'Y'     TO WS-K595-EOF                                    
              ELSE                                                              
                 DISPLAY 'ERROR BP13K595 READNEXT'                              
                 PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                      
              END-IF                                                            
           END-IF.                                                              
       8010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8012-START-BP13K820.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K820-REC               
           INITIALIZE                                BP13K820-REC.              
           MOVE 'N'                               TO WS-K820-EOF                
                                                     WS-K820-FND.               
                                                                                
           MOVE K595-NUM-REGN                     TO K820-NUM-REGN              
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           IF K820-STATUS = 00 OR 02                                            
              MOVE 'Y'                            TO WS-K820-FND                
           ELSE                                                                 
              IF K820-STATUS = 23 OR 10                                         
                 MOVE 'N'                         TO WS-K820-FND                
              ELSE                                                              
                 DISPLAY 'BP13K820 - ERROR STARTING : ' K820-STATUS             
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8012-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8013-READNEXT-BP13K820.                                                  
      *===============================================================*         
                                                                                
           READ BP13K820 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K820-EOF                                      
                GO          TO 3300-EXIT                                        
           END-READ.                                                            
                                                                                
           IF K820-STATUS = 00 OR 02                                            
              IF K820-NUM-REGN = K595-NUM-REGN                                  
                 MOVE 'Y'                         TO WS-K820-FOUND              
                 ADD 1                            TO CNT-HH-SIZE                
                                                                                
                 IF K820-NUM-RELATIONSHIP NOT NUMERIC                           
                    MOVE ZEROES           TO K820-NUM-RELATIONSHIP              
                 END-IF                                                         
                                                                                
                 IF K820-NUM-RELATIONSHIP = 41                                  
                    ADD 1                 TO CNT-CHILD                          
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'                         TO WS-K820-EOF                
              END-IF                                                            
           ELSE                                                                 
              IF K820-STATUS = 23 OR 10                                         
                 MOVE 'Y'                         TO WS-K820-EOF                
              ELSE                                                              
                 DISPLAY 'BP13K820 - ERROR READING NEXT : ' K820-STATUS         
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8013-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8014-START-BP13K828.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K828-REC               
           INITIALIZE                                BP13K828-REC.              
           MOVE 'N'                               TO WS-K828-EOF                
                                                     WS-K828-FND.               
                                                                                
           MOVE K595-NUM-REGN                     TO K828-NUM-REGN              
                                                                                
           START BP13K828 KEY >= K828-KEY-FLD.                                  
                                                                                
           IF K828-STATUS = 00 OR 02                                            
              MOVE 'Y'                            TO WS-K828-FND                
           ELSE                                                                 
              IF K828-STATUS = 23 OR 10                                         
                 MOVE 'N'                         TO WS-K828-FND                
              ELSE                                                              
                 DISPLAY 'BP13K828 - ERROR STARTING : ' K828-STATUS             
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8014-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8015-READNEXT-BP13K828.                                                  
      *===============================================================*         
                                                                                
           READ BP13K828 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K828-EOF                                      
                GO          TO 8005-EXIT                                        
           END-READ.                                                            
                                                                                
           IF K828-STATUS = 00 OR 02                                            
              IF K828-NUM-REGN = K595-NUM-REGN                                  
                 ADD 1                            TO CNT-HH-SIZE                
                 MOVE 'Y'                         TO WS-K828-FOUND              
                                                                                
                 IF K828-NUM-RELATIONSHIP NOT NUMERIC                           
                    MOVE ZEROES           TO K828-NUM-RELATIONSHIP              
                 END-IF                                                         
                                                                                
                 IF K828-NUM-RELATIONSHIP = 41                                  
                    ADD 1                 TO CNT-CHILD                          
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'                         TO WS-K828-EOF                
              END-IF                                                            
           ELSE                                                                 
              IF K828-STATUS = 23 OR 10                                         
                 MOVE 'Y'                         TO WS-K828-EOF                
              ELSE                                                              
                 DISPLAY 'BP13K828 - ERROR READING NEXT : ' K828-STATUS         
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8015-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=======================*                                                 
       8016-READ-BP13K595.                                                      
      *=======================*                                                 
                                                                                
           MOVE 'N'     TO WS-K595-EOF.                                         
           START BP13K595 KEY >= K595-ALT1-KEY                                  
                                                                                
           IF K595-STATUS = 00 OR 02                                            
              PERFORM 8017-READNXT-K595 THRU 8017-EXIT                          
                UNTIL WS-K595-EOF = 'Y'                                         
           ELSE                                                                 
              IF K595-STATUS = 23 OR 10                                         
                 MOVE SPACES          TO BP13K595-REC                           
                 DISPLAY 'BP13K595 - RECORD NOT FND : ' K595-KEY-FLD            
              ELSE                                                              
                 DISPLAY 'BP13K595 - ERROR READING NEXT : '                     
                         K595-STATUS                                            
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8016-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8017-READNXT-K595.                                                       
      *===============================================================*         
                                                                                
           READ BP13K595 NEXT RECORD                                            
                                                                                
           IF K595-STATUS = 00 OR 02                                            
              IF F007-NUM-NRIC1 = K595-NUM-NRIC1                                
                 IF (K595-NUM-ALLO-CAT = 'BTO' OR 'SBF' OR                      
                                         'BE ') AND                             
                    (K595-NUM-RANDOM NOT = SPACES AND LOW-VALUES)               
                     MOVE BP13K595-REC     TO WS-BP13K595-REC                   
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'     TO WS-K595-EOF                                    
              END-IF                                                            
           ELSE                                                                 
              IF K595-STATUS = 23 OR 10                                         
                 MOVE 'Y'     TO WS-K595-EOF                                    
              ELSE                                                              
                 DISPLAY 'ERROR BP13K595 READNEXT'                              
                 PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                      
              END-IF                                                            
           END-IF.                                                              
       8017-EXIT.                                                               
           EXIT.                                                                
      *===============================================================*         
       9000-CLOSE-FILES.                                                        
      *===============================================================*         
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '***************************************'.                   
           DISPLAY 'PROGRAM ID     :  BP13CY90'.                                
           DISPLAY '***************************************'.                   
           DISPLAY 'NO. OF BP13F007 READ          : ' CNT-F007-READ.            
           DISPLAY 'NO. OF BP13K820 READ          : ' CNT-K820-READ.            
           DISPLAY 'NO. OF BP13K825 READ          : ' CNT-K825-READ.            
           DISPLAY 'NO. OF BP13K828 READ          : ' CNT-K828-READ.            
           DISPLAY 'NO. OF RECS WRITTEN           : ' CNT-F008-WRITE.           
                                                                                
           CLOSE BP13F007                                                       
                 BP13K820                                                       
                 BP13K828                                                       
                 BP13K813                                                       
                 BP13K585                                                       
                 BP13K593                                                       
                 BP13K595                                                       
                 BP13K895                                                       
                 BM06K110                                                       
                 BP13F008.                                                      
                                                                                
           IF K813-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K813 , STATUS = ' K813-STATUS          
           END-IF.                                                              
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K820 , STATUS = ' K820-STATUS          
           END-IF.                                                              
                                                                                
           IF K828-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K828 , STATUS = ' K828-STATUS          
           END-IF.                                                              
                                                                                
           IF K593-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K593 , STATUS = ' K593-STATUS          
           END-IF.                                                              
                                                                                
           IF K595-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K595 , STATUS = ' K595-STATUS          
           END-IF.                                                              
                                                                                
           IF K585-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K585 , STATUS = ' K585-STATUS          
           END-IF.                                                              
                                                                                
           IF K110-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BM06K110 , STATUS = ' K110-STATUS          
           END-IF.                                                              
                                                                                
           IF K895-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K895 , STATUS = ' K895-STATUS          
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
