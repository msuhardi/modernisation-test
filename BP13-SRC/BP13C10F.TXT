      *===============================================================*         
       IDENTIFICATION DIVISION.                                                 
      *===============================================================*         
       PROGRAM-ID.    BP13C10F.                                                 
       AUTHOR.        KAVYA VAKA.                                               
       DATE-WRITTEN.  FEBRUARY 27, 2020.                                        
      *===============================================================*         
      * OBJECTIVE  :  TO PRINT EXCEPTION REPORT                       *         
      *===============================================================*         
      *                                                               *         
      * INPUT FILE :                                                  *         
      *               1. BP13F800                                     *         
      *               3. BM06K110                                     *         
      *               4. BP13K162                                     *         
      *                                                               *         
      * OUTPUT FILE:  1. BP13L10A                                     *         
      *               2. BP13L10B                                     *         
      *               3. BP13L10C                                     *         
      *               4. BP13L10D                                     *         
      *               5. BP13L10E                                     *         
      *               6. MAILC10A                                     *         
      *               7. MAILC10B                                     *         
      *               8. MAILC10C                                     *         
      *               9. MAILC10E                                     *         
      *                                                               *         
      *===============================================================*         
      * REF NO   DATE       BY   AMENDMENTS/ENHANCEMENTS              *         
      *---------------------------------------------------------------*         
      * BP137779 27/02/2020 KV5  NEW PROGRAM                          *         
      * BP137779 26/03/2020 KV5  INCLUDED CONDITIONS & EMAIL REPORTS  *         
      * BP138565 25/01/2021 KR13 TO CATER FOR FLAT-TYPE - '1F'.       *         
      * BP139030 07/01/2022 ZAR7 REPLACE CHUA YEE MIEN TO LIM KOK CHUN          
      * BP139276 05/04/2024 KAC1 REPLACING LIM KOK CHUN BY            *         
      *                                    KATHIJAH_BEE_ALI_MOHAMED   *         
      *===============================================================*         
                                                                                
                                                                                
      **********************                                                    
       ENVIRONMENT DIVISION.                                                    
      **********************                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT  BP13F800 ASSIGN        TO BP13F800.                          
           SELECT  BM06K110 ASSIGN        TO BM06K110                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K110-KEY-FLD                       
                            FILE STATUS   IS WS-K110-STATUS.                    
           SELECT  BP13K162 ASSIGN        TO BP13K162                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K162-KEY-FLD                       
                            FILE STATUS   IS WS-K162-STATUS.                    
           SELECT  BP13L10A ASSIGN        TO BP13L10A.                          
           SELECT  BP13L10B ASSIGN        TO BP13L10B.                          
           SELECT  BP13L10C ASSIGN        TO BP13L10C.                          
      *    SELECT  BP13L10D ASSIGN        TO BP13L10D.                          
           SELECT  BP13L10E ASSIGN        TO BP13L10E.                          
           SELECT  MAILC10A ASSIGN        TO MAILC10A.                          
           SELECT  MAILC10B ASSIGN        TO MAILC10B.                          
           SELECT  MAILC10C ASSIGN        TO MAILC10C.                          
           SELECT  MAILC10E ASSIGN        TO MAILC10E.                          
                                                                                
      ***************                                                           
       DATA DIVISION.                                                           
      ***************                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F800                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            RECORDING MODE IS F.                                                
       COPY BP13F800.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD  BP13K162                                                             
           RECORD CONTAINS 600 CHARACTERS.                                      
       COPY BP13K162.                                                           
                                                                                
       FD   BP13L10A                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   BP13L10A-REC               PIC X(150).                              
                                                                                
       FD   BP13L10B                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   BP13L10B-REC              PIC X(150).                               
                                                                                
       FD   BP13L10C                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   BP13L10C-REC              PIC X(150).                               
                                                                                
      *FD   BP13L10D                                                            
      *     BLOCK  CONTAINS 0 RECORDS                                           
      *     RECORD CONTAINS 150 CHARACTERS                                      
      *     LABEL RECORD IS OMITTED                                             
      *     RECORDING MODE IS F.                                                
      *01   BP13L10D-REC              PIC X(150).                               
                                                                                
       FD   BP13L10E                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   BP13L10E-REC              PIC X(150).                               
                                                                                
       FD   MAILC10A                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   MAILC10A-REC              PIC X(150).                               
                                                                                
       FD   MAILC10B                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   MAILC10B-REC              PIC X(150).                               
                                                                                
       FD   MAILC10C                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   MAILC10C-REC              PIC X(150).                               
                                                                                
       FD   MAILC10E                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   MAILC10E-REC              PIC X(150).                               
                                                                                
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
      *                   WORKING-STORAGE AREA                         *        
      ******************************************************************        
       01  FILE-VARIABLES.                                                      
           05  WS-EOF-F800             PIC X(1)  VALUE 'N'.                     
           05  WS-K162-EOF             PIC X(1)  VALUE 'N'.                     
           05  WS-F800-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K110-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K162-STATUS          PIC 9(02) VALUE ZEROES.                  
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F800-READ            PIC 9(7)  VALUE ZEROES.                  
           05  WS-CNT-L10A-WRITE       PIC 9(5)  VALUE ZEROES.                  
           05  WS-CNT-L10B-WRITE       PIC 9(5)  VALUE ZEROES.                  
           05  WS-CNT-L10C-WRITE       PIC 9(5)  VALUE ZEROES.                  
           05  WS-CNT-L10D-WRITE       PIC 9(5)  VALUE ZEROES.                  
           05  WS-CNT-L10E-WRITE       PIC 9(5)  VALUE ZEROES.                  
           05  WS-CNT-L10F-WRITE       PIC 9(5)  VALUE ZEROES.                  
      *    05  WS-ELDE-SING-SNZ        PIC X(1)  VALUE SPACES.                  
      *    05  WS-RES-LVY-NB           PIC X(1)  VALUE SPACES.                  
      *    05  WS-ELDE-SING-SZ         PIC X(1)  VALUE SPACES.                  
      *    05  WS-RES-LVY-B            PIC X(1)  VALUE SPACES.                  
      *    05  WS-RES-LVY-NVER         PIC X(1)  VALUE SPACES.                  
           05  WS-SINPRE-SNZ           PIC X(1)  VALUE SPACES.                  
           05  WS-ELDEPRE-ENZ          PIC X(1)  VALUE SPACES.                  
           05  WS-RESL-NTIM-N          PIC X(1)  VALUE SPACES.                  
           05  WS-RES-NTIME-NFND       PIC X(1)  VALUE SPACES.                  
           05  WS-F800-FND             PIC X(1)  VALUE 'N'.                     
           05  WS-K162-FND             PIC X(1)  VALUE 'N'.                     
           05  WS-SNO1                 PIC 9(5)  VALUE ZEROES.                  
           05  WS-SNO2                 PIC 9(5)  VALUE ZEROES.                  
           05  WS-SNO3                 PIC 9(5)  VALUE ZEROES.                  
           05  WS-SNO4                 PIC 9(5)  VALUE ZEROES.                  
           05  WS-SNO5                 PIC 9(5)  VALUE ZEROES.                  
           05  WS-LINE-CTR             PIC 9(2)  VALUE ZEROES.                  
           05  WS-PAGE-CTR             PIC 9(4)  VALUE ZEROES.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-SYSTEM-DATE           PIC 9(8)  VALUE ZEROES.                  
           05 WS-SNO-ZZZZ9             PIC ZZZZ9 VALUE ZEROES.                  
                                                                                
       01 WS-CURR-DATE.                                                         
          05  WS-CURR-CCYY             PIC 9(04).                               
          05  WS-CURR-MM               PIC 9(02).                               
          05  WS-CURR-DD               PIC 9(02).                               
                                                                                
       01  L10A-HEADER01.                                                       
           05  FILLER                  PIC X(8) VALUE 'BP13L10A'.               
           05  FILLER                  PIC X(4) VALUE SPACES.                   
           05  FILLER                  PIC X(8) VALUE 'HDBCAT 3'.               
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(20) VALUE                          
                                       'S Y S T E M   O F   '.                  
           05  FILLER                  PIC X(19) VALUE                          
                                       'C O M M I T M E N T'.                   
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(07) VALUE 'DATE : '.               
           05  L10A-DATE-HDR           PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(07) VALUE 'PAGE : '.               
           05  L10A-PAGE-HDR           PIC ZZZ9  VALUE ZEROES.                  
                                                                                
       01  L10B-HEADER01.                                                       
           05  FILLER              PIC X(8)      VALUE 'BP13L10B'.              
           05  FILLER              PIC X(4)      VALUE SPACES.                  
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                  'S Y S T E M   O F   '.                       
           05  FILLER              PIC X(19) VALUE                              
                                  'C O M M I T M E N T'.                        
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  L10B-DATE-HDR       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  L10B-PAGE-HDR       PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  L10C-HEADER01.                                                       
           05  FILLER              PIC X(8)      VALUE 'BP13L10C'.              
           05  FILLER              PIC X(4)      VALUE SPACES.                  
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                  'S Y S T E M   O F   '.                       
           05  FILLER              PIC X(19) VALUE                              
                                  'C O M M I T M E N T'.                        
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  L10C-DATE-HDR       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  L10C-PAGE-HDR       PIC ZZZ9      VALUE ZEROES.                  
                                                                                
      *01  L10D-HEADER01.                                                       
      *    05  FILLER              PIC X(8)      VALUE 'BP13L10D'.              
      *    05  FILLER              PIC X(4)      VALUE SPACES.                  
      *    05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
      *    05  FILLER              PIC X(02)     VALUE SPACES.                  
      *    05  FILLER              PIC X(20)     VALUE                          
      *                           'S Y S T E M   O F   '.                       
      *    05  FILLER              PIC X(19) VALUE                              
      *                           'C O M M I T M E N T'.                        
      *    05  FILLER              PIC X(02)     VALUE SPACES.                  
      *    05  FILLER              PIC X(07)     VALUE 'DATE : '.               
      *    05  L10D-DATE-HDR       PIC X(10)     VALUE SPACES.                  
      *    05  FILLER              PIC X(04)     VALUE SPACES.                  
      *    05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
      *    05  L10D-PAGE-HDR       PIC ZZZ9      VALUE ZEROES.                  
      *                                                                         
       01  L10E-HEADER01.                                                       
           05  FILLER              PIC X(8)      VALUE 'BP13L10E'.              
           05  FILLER              PIC X(4)      VALUE SPACES.                  
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                  'S Y S T E M   O F   '.                       
           05  FILLER              PIC X(19) VALUE                              
                                  'C O M M I T M E N T'.                        
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  L10E-DATE-HDR       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  L10E-PAGE-HDR       PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  L10A-HEADER02.                                                       
           05  FILLER              PIC X(03)    VALUE SPACES.                   
           05  L10A-HDR02          PIC X(129)   VALUE SPACES.                   
                                                                                
       01  L10B-HEADER02.                                                       
           05  FILLER              PIC X(03)    VALUE SPACES.                   
           05  L10B-HDR02          PIC X(129)   VALUE SPACES.                   
                                                                                
       01  L10C-HEADER02.                                                       
           05  FILLER              PIC X(03)    VALUE SPACES.                   
           05  L10C-HDR02          PIC X(129)   VALUE SPACES.                   
                                                                                
       01  L10D-HEADER02.                                                       
           05  FILLER              PIC X(03)    VALUE SPACES.                   
           05  L10D-HDR02          PIC X(129)   VALUE SPACES.                   
                                                                                
       01  L10E-HEADER02.                                                       
           05  FILLER              PIC X(03)    VALUE SPACES.                   
           05  L10E-HDR02          PIC X(129)   VALUE SPACES.                   
                                                                                
       01  L10T-HEADER03.                                                       
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(05)    VALUE '  S/N'.                  
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(08)    VALUE 'REGN NO '.               
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(07)    VALUE 'HH TYPE'.                
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(12)    VALUE 'LEASE TENURE'.           
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(18)    VALUE 'ELIGIBILITY SCHEM        
      -         'E'.                                                            
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(11)    VALUE 'N-TIMER TAG'.            
           05  FILLER              PIC X(04)    VALUE SPACES.                   
           05  FILLER              PIC X(22)    VALUE 'CONDITIONS NOT ME        
      -         'T FOR'.                                                        
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(22)    VALUE 'CONDITIONS NOT ME        
      -         'T FOR'.                                                        
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(25)    VALUE 'NO VERIFIED STAFF        
      -         'ID FOUND'.                                                     
           05  FILLER              PIC X(01)    VALUE SPACES.                   
                                                                                
       01  L10T-HEADER04.                                                       
           05  FILLER              PIC X(70)    VALUE SPACES.                   
           05  FILLER              PIC X(23)    VALUE 'ELDERLY/SINGLES P        
      -         'REMIUM'.                                                       
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(22)    VALUE '      REV LVY'.          
                                                                                
       01  L10T-DETAIL01.                                                       
           05  FILLER1             PIC X(01)        VALUE SPACES.               
           05  L10T-SN             PIC X(05)        VALUE SPACES.               
           05  FILLER2             PIC X(01)        VALUE SPACES.               
           05  L10T-REGN           PIC X(08)        VALUE SPACES.               
           05  FILLER3             PIC X(01)        VALUE SPACES.               
           05  L10T-HHTYPE         PIC X(01)        VALUE SPACES.               
           05  FILLER4             PIC X(07)        VALUE SPACES.               
           05  L10T-LEATEN         PIC X(02)        VALUE SPACES.               
           05  FILLER5             PIC X(11)        VALUE SPACES.               
           05  L10T-ELISCH         PIC X(03)        VALUE SPACES.               
           05  FILLER6             PIC X(16)        VALUE SPACES.               
           05  L10T-NTIMER         PIC X(01)        VALUE SPACES.               
           05  FILLER7             PIC X(13)        VALUE SPACES.               
           05  L10T-ELDSIN         PIC X(01)        VALUE SPACES.               
           05  FILLER8             PIC X(25)        VALUE SPACES.               
           05  L10T-RESNTIM-N      PIC X(01)        VALUE SPACES.               
           05  FILLER9             PIC X(20)        VALUE SPACES.               
           05  L10T-STAFF          PIC X(01)        VALUE SPACES.               
                                                                                
       01  WS-REPORT-DTL.                                                       
           05  WS-EMPTY-RPT.                                                    
               10 FILLER                  PIC X(30) VALUE SPACES.               
               10 FILLER                  PIC X(21)                             
                                          VALUE '<   EMPTY  REPORT   >'.        
           05  WS-DATE-RPT-DTL.                                                 
               10 FILLER                PIC X(6)  VALUE 'DATE: '.               
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.                 
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'.         
           05  WS-MAIL-RPT2             PIC X(27)                               
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                                
           05  WS-MAIL-RPT3             PIC X(50)                               
               VALUE 'RCPT TO:<CATHERINE_HL_TAN@HDB.GOV.SG>'.                   
           05  WS-MAIL-RPT4             PIC X(50)                               
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.           
           05  WS-MAIL-RPT5             PIC X(50)                               
               VALUE 'RCPT TO:<LAU_HONG_HUAT@HDB.GOV.SG>'.                      
           05  WS-MAIL-RPT6             PIC X(50)                               
               VALUE 'RCPT TO:<TENG_SIEW_HONG@HDB.GOV.SG>'.                     
           05  WS-MAIL-RPT7             PIC X(4)                                
               VALUE 'DATA'.                                                    
           05  WS-MAIL-RPT8             PIC X(29)                               
               VALUE 'FROM:Soc System - Email Alert'.                           
           05  WS-MAIL-RPT9             PIC X(50)                               
               VALUE 'TO:<CATHERINE_HL_TAN@HDB.GOV.SG>'.                        
           05  WS-MAIL-RPT10            PIC X(50)                               
               VALUE 'TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                
           05  WS-MAIL-RPT11            PIC X(50)                               
               VALUE 'TO:<LAU_HONG_HUAT@HDB.GOV.SG>'.                           
           05  WS-MAIL-RPT12            PIC X(50)                               
               VALUE 'TO:<TENG_SIEW_HONG@HDB.GOV.SG>'.                          
           05  WS-MAIL-RPT13            PIC X(100).                             
                                                                                
      ******************************************************************        
      *                   P R O G R A M     B O D Y                    *        
      ******************************************************************        
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
                                                                                
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
                                                                                
           PERFORM 1000-OPEN-ROUTINE       THRU 1000-EXIT.                      
                                                                                
           PERFORM 2000-READ-BP13F800      THRU 2000-EXIT                       
             UNTIL WS-EOF-F800 = 'Y'.                                           
                                                                                
           PERFORM 9999-CLOSE-ROUTINE      THRU 9999-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           OPEN INPUT  BM06K110                                                 
                       BP13K162                                                 
                       BP13F800                                                 
                OUTPUT BP13L10A                                                 
                       BP13L10B                                                 
                       BP13L10C                                                 
      *                BP13L10D                                                 
                       BP13L10E                                                 
                       MAILC10A                                                 
                       MAILC10B                                                 
                       MAILC10C                                                 
                       MAILC10E.                                                
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K110 - ERROR OPENING : ' WS-K110-STATUS              
              MOVE WS-K110-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K162-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K162 - ERROR OPENING : ' WS-K162-STATUS              
              MOVE WS-K162-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           PERFORM 7000-PRINT-HEADER       THRU 7000-EXIT.                      
           MOVE 'N'             TO WS-F800-FND                                  
      *    MOVE SPACES          TO WS-ELDE-SING-SNZ WS-RES-LVY-NB               
      *                            WS-ELDE-SING-SZ WS-RES-LVY-B                 
      *                            WS-RES-LVY-NVER                              
           MOVE SPACES          TO WS-SINPRE-SNZ WS-ELDEPRE-ENZ                 
                                   WS-RESL-NTIM-N WS-RES-NTIME-NFND             
           .                                                                    
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       2000-READ-BP13F800.                                                      
      ******************************************************************        
                                                                                
           READ BP13F800           AT   END                                     
                MOVE 'Y'           TO   WS-EOF-F800                             
                GO                 TO   2000-EXIT.                              
                                                                                
           ADD  1                  TO WS-F800-READ.                             
           PERFORM 2200-PROCESS-RECORDS THRU 2200-EXIT                          
           .                                                                    
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       2200-PROCESS-RECORDS.                                                    
      ******************************************************************        
                                                                                
           PERFORM 2300-READ-BM06K110 THRU 2300-EXIT                            
           IF F800-NUM-ALLO-SCHEME = 'SER'                                      
               GO TO 2200-EXIT                                                  
           ELSE                                                                 
            IF F800-NUM-SCH-ACC = SPACES                                        
               GO TO 2200-EXIT                                                  
           ELSE                                                                 
            IF K110-DTE-KEY-ISSUED > 0                                          
               GO TO 2200-EXIT                                                  
           ELSE                                                                 
             IF (F800-NUM-ALLO-SCHEME = 'FTS') AND                              
                (F800-NUM-ELIG-SCHEME = 'SSC' OR 'NCS') AND                     
                (F800-NUM-HOUSEHOLD = 'H' OR 'T') AND                           
                (F800-NUM-FLAT-TYPE = '2F' OR '1F') AND                         
                (F800-NUM-LEASE-TENURE > 0 AND                                  
                 F800-NUM-LEASE-TENURE < 99)                                    
                 IF (F800-NUM-ELDERLY-PREMIUM = 'Y')                            
                    IF (K110-AMT-ELDERLY-PREMIUM > 0)                           
                       CONTINUE                                                 
                    ELSE                                                        
                     MOVE SPACES                    TO L10T-DETAIL01            
                     INITIALIZE                        L10T-DETAIL01            
                     ADD 1                          TO WS-SNO2                  
                     MOVE WS-SNO2                   TO WS-SNO-ZZZZ9             
                     MOVE WS-SNO-ZZZZ9              TO L10T-SN                  
                                                       WS-CNT-L10B-WRITE        
                     MOVE F800-NUM-REGN             TO L10T-REGN                
                     MOVE F800-NUM-HOUSEHOLD        TO L10T-HHTYPE              
                     MOVE F800-NUM-LEASE-TENURE     TO L10T-LEATEN              
                     MOVE F800-NUM-ELIG-SCHEME      TO L10T-ELISCH              
                     MOVE F800-NUM-NTIMER           TO L10T-NTIMER              
                     MOVE 'Y'                       TO WS-ELDEPRE-ENZ           
                     MOVE WS-ELDEPRE-ENZ            TO L10T-ELDSIN              
                     WRITE BP13L10B-REC             FROM L10T-DETAIL01          
                     WRITE MAILC10B-REC             FROM L10T-DETAIL01          
                    END-IF                                                      
                 ELSE                                                           
                  IF (K110-AMT-SINGLES-PREMIUM > 0)                             
                      CONTINUE                                                  
                  ELSE                                                          
                   MOVE SPACES                    TO L10T-DETAIL01              
                   INITIALIZE                        L10T-DETAIL01              
                   ADD 1                          TO WS-SNO1                    
                   MOVE WS-SNO1                   TO WS-SNO-ZZZZ9               
                   MOVE WS-SNO-ZZZZ9              TO L10T-SN                    
                                                     WS-CNT-L10A-WRITE          
                   MOVE F800-NUM-REGN             TO L10T-REGN                  
                   MOVE F800-NUM-HOUSEHOLD        TO L10T-HHTYPE                
                   MOVE F800-NUM-LEASE-TENURE     TO L10T-LEATEN                
                   MOVE F800-NUM-ELIG-SCHEME      TO L10T-ELISCH                
                   MOVE F800-NUM-NTIMER           TO L10T-NTIMER                
                   MOVE 'Y'                       TO WS-SINPRE-SNZ              
                   MOVE WS-SINPRE-SNZ             TO L10T-ELDSIN                
                   WRITE BP13L10A-REC             FROM L10T-DETAIL01            
                   WRITE MAILC10A-REC             FROM L10T-DETAIL01            
                  END-IF                                                        
                 END-IF                                                         
             END-IF                                                             
             IF (F800-NUM-ALLO-SCHEME = 'STS') AND                              
                (F800-NUM-HOUSEHOLD = 'G') AND                                  
                (F800-NUM-FLAT-TYPE = '2F' OR '1F') AND                         
                (F800-NUM-LEASE-TENURE > 00 AND                                 
                 F800-NUM-LEASE-TENURE < 99)                                    
                 IF (F800-NUM-RESALE-LEVY-TAG = SPACES) AND                     
                    (F800-NUM-NTIMER = SPACES OR 'N' OR 'Y')                    
                     MOVE SPACES                  TO L10T-DETAIL01              
                     INITIALIZE                      L10T-DETAIL01              
                     ADD 1                        TO WS-SNO3                    
                     MOVE WS-SNO3                 TO WS-SNO-ZZZZ9               
                     MOVE WS-SNO-ZZZZ9            TO L10T-SN                    
                                                     WS-CNT-L10C-WRITE          
                     MOVE F800-NUM-REGN           TO L10T-REGN                  
                     MOVE F800-NUM-HOUSEHOLD      TO L10T-HHTYPE                
                     MOVE F800-NUM-LEASE-TENURE   TO L10T-LEATEN                
                     MOVE F800-NUM-ELIG-SCHEME    TO L10T-ELISCH                
                     MOVE F800-NUM-NTIMER         TO L10T-NTIMER                
                     MOVE 'Y'                     TO WS-RESL-NTIM-N             
                     MOVE WS-RESL-NTIM-N          TO L10T-RESNTIM-N             
                     WRITE BP13L10C-REC           FROM L10T-DETAIL01            
                     WRITE MAILC10C-REC           FROM L10T-DETAIL01            
                 ELSE                                                           
                  IF F800-AMT-PREMIUM > 0                                       
                     CONTINUE                                                   
                 ELSE                                                           
                  IF (F800-NUM-RESALE-LEVY-TAG = 'Y' OR                         
                     F800-NUM-NTIMER = 'Y')                                     
                     PERFORM 2400-READ-BP13K162 THRU 2400-EXIT                  
                     IF WS-K162-FND = 'N'                                       
                         MOVE SPACES                TO L10T-DETAIL01            
                         INITIALIZE                    L10T-DETAIL01            
                         ADD 1                      TO WS-SNO5                  
                         MOVE WS-SNO5               TO WS-SNO-ZZZZ9             
                         MOVE WS-SNO-ZZZZ9          TO L10T-SN                  
                                                       WS-CNT-L10E-WRITE        
                         MOVE F800-NUM-REGN         TO L10T-REGN                
                         MOVE F800-NUM-HOUSEHOLD    TO L10T-HHTYPE              
                         MOVE F800-NUM-LEASE-TENURE TO L10T-LEATEN              
                         MOVE F800-NUM-ELIG-SCHEME  TO L10T-ELISCH              
                         MOVE F800-NUM-NTIMER       TO L10T-NTIMER              
                         MOVE 'Y'                   TO WS-RES-NTIME-NFND        
                         MOVE WS-RES-NTIME-NFND     TO L10T-STAFF               
                         WRITE BP13L10E-REC         FROM L10T-DETAIL01          
                         WRITE MAILC10E-REC         FROM L10T-DETAIL01          
                     END-IF                                                     
                  END-IF                                                        
                  END-IF                                                        
                 END-IF                                                         
             END-IF                                                             
           END-IF                                                               
           END-IF                                                               
           END-IF                                                               
           .                                                                    
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************************************************             
       2300-READ-BM06K110.                                                      
      *************************************************************             
                                                                                
           MOVE SPACES                   TO K110-REC.                           
           INITIALIZE                       K110-REC.                           
                                                                                
           MOVE F800-NUM-SCH-ACC         TO K110-KEY-FLD.                       
                                                                                
           READ BM06K110.                                                       
                                                                                
           EVALUATE WS-K110-STATUS                                              
               WHEN 00                                                          
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'BM06K110 READ ERROR ' WS-K110-STATUS               
                    DISPLAY 'K110 KEY: ' F800-NUM-SCH-ACC                       
                    MOVE WS-K110-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       2300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       2400-READ-BP13K162.                                                      
      *************************************************************             
                                                                                
           MOVE SPACES                   TO BP13K162-REC.                       
           INITIALIZE                       BP13K162-REC.                       
                                                                                
           MOVE F800-NUM-REGN            TO K162-NUM-REGNO.                     
                                                                                
           START BP13K162 KEY IS >= K162-NUM-REGNO.                             
                                                                                
           EVALUATE WS-K162-STATUS                                              
               WHEN 00                                                          
                    PERFORM 2500-READNEXT-BP13K162 THRU 2500-EXIT               
                      UNTIL K162-NUM-REGNO > F800-NUM-REGN OR                   
                            WS-K162-EOF = 'Y'                                   
               WHEN OTHER                                                       
                    DISPLAY 'BP13K162 START BRW ERROR' WS-K110-STATUS           
                    DISPLAY 'START KEY:' F800-NUM-REGN                          
                    MOVE WS-K110-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       2400-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       2500-READNEXT-BP13K162.                                                  
      *************************************************************             
                                                                                
           READ BP13K162 NEXT RECORD.                                           
                                                                                
           EVALUATE WS-K162-STATUS                                              
               WHEN 00                                                          
                    IF K162-NUM-REGNO = F800-NUM-REGN                           
                       MOVE 'Y'        TO WS-K162-FND                           
                       MOVE 'Y'        TO WS-K162-EOF                           
                    ELSE                                                        
                       MOVE 'Y'        TO WS-K162-EOF                           
                       MOVE 'N'        TO WS-K162-FND                           
                    END-IF                                                      
               WHEN 23                                                          
               WHEN 10                                                          
                  MOVE 'Y'             TO WS-K162-EOF                           
                  MOVE 'N'             TO WS-K162-FND                           
               WHEN OTHER                                                       
                    DISPLAY 'BP13K162 READ NEXT ERROR' WS-K162-STATUS           
                    DISPLAY 'READ NEXT:' F800-NUM-REGN                          
                    MOVE WS-K162-STATUS  TO RETURN-CODE                         
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       2500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       5000-HEADER-EMAIL.                                                       
      ******************************************************************        
                                                                                
            WRITE MAILC10A-REC FROM WS-MAIL-RPT1.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT1.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT1.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT1.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT2.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT2.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT2.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT2.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT3.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT3.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT3.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT3.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT4.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT4.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT4.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT4.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT5.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT5.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT5.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT5.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT6.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT6.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT6.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT6.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT7.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT7.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT7.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT7.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT8.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT8.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT8.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT8.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT9.                               
            WRITE MAILC10B-REC FROM WS-MAIL-RPT9.                               
            WRITE MAILC10C-REC FROM WS-MAIL-RPT9.                               
            WRITE MAILC10E-REC FROM WS-MAIL-RPT9.                               
            WRITE MAILC10A-REC FROM WS-MAIL-RPT10.                              
            WRITE MAILC10B-REC FROM WS-MAIL-RPT10.                              
            WRITE MAILC10C-REC FROM WS-MAIL-RPT10.                              
            WRITE MAILC10E-REC FROM WS-MAIL-RPT10.                              
            WRITE MAILC10A-REC FROM WS-MAIL-RPT11.                              
            WRITE MAILC10B-REC FROM WS-MAIL-RPT11.                              
            WRITE MAILC10C-REC FROM WS-MAIL-RPT11.                              
            WRITE MAILC10E-REC FROM WS-MAIL-RPT11.                              
            WRITE MAILC10A-REC FROM WS-MAIL-RPT12.                              
            WRITE MAILC10B-REC FROM WS-MAIL-RPT12.                              
            WRITE MAILC10C-REC FROM WS-MAIL-RPT12.                              
            WRITE MAILC10E-REC FROM WS-MAIL-RPT12.                              
                                                                                
            STRING 'SUBJECT: EXCEPTION REPORT SINGLE PREMIUM'                   
                   ' SHOULD NOT BE 0('                                          
                    WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'             
              DELIMITED BY SIZE INTO WS-MAIL-RPT13.                             
                                                                                
            WRITE MAILC10A-REC FROM WS-MAIL-RPT13.                              
                                                                                
            STRING 'SUBJECT: EXCEPTION REPORT ELDERLY PREMIUM'                  
                   ' SHOULD NOT BE 0('                                          
                    WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'             
                     DELIMITED BY SIZE INTO WS-MAIL-RPT13.                      
                                                                                
            WRITE MAILC10B-REC FROM WS-MAIL-RPT13.                              
                                                                                
            STRING 'SUBJECT: EXCEPTION REPORT SECOND TIMER APPLICATION'         
                   'AND RESALE STATUS IS BLANK'                                 
                    '(' WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'         
                     DELIMITED BY SIZE INTO WS-MAIL-RPT13.                      
                                                                                
            WRITE MAILC10C-REC FROM WS-MAIL-RPT13.                              
                                                                                
            STRING 'SUBJECT: EXCEPTION REPORT RSL LEVY AND NTIMES'              
                   'STAFF NOT FND('                                             
                    WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'             
                     DELIMITED BY SIZE INTO WS-MAIL-RPT13.                      
                                                                                
            WRITE MAILC10E-REC FROM WS-MAIL-RPT13.                              
                                                                                
            STRING WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY                   
                    DELIMITED BY SIZE INTO WS-DATE-RPT.                         
                                                                                
            WRITE MAILC10A-REC FROM WS-DATE-RPT-DTL                             
            WRITE MAILC10B-REC FROM WS-DATE-RPT-DTL                             
            WRITE MAILC10C-REC FROM WS-DATE-RPT-DTL                             
            WRITE MAILC10E-REC FROM WS-DATE-RPT-DTL                             
                                                                                
            MOVE SPACES TO MAILC10A-REC.                                        
            WRITE MAILC10A-REC.                                                 
            MOVE SPACES TO MAILC10B-REC.                                        
            WRITE MAILC10B-REC.                                                 
            MOVE SPACES TO MAILC10C-REC.                                        
            WRITE MAILC10C-REC.                                                 
            MOVE SPACES TO MAILC10E-REC.                                        
            WRITE MAILC10E-REC.                                                 
                                                                                
            WRITE MAILC10A-REC FROM L10A-HEADER01.                              
            WRITE MAILC10B-REC FROM L10B-HEADER01.                              
            WRITE MAILC10C-REC FROM L10C-HEADER01.                              
            WRITE MAILC10E-REC FROM L10E-HEADER01.                              
            WRITE MAILC10A-REC FROM L10A-HEADER02.                              
            WRITE MAILC10B-REC FROM L10B-HEADER02.                              
            WRITE MAILC10C-REC FROM L10C-HEADER02.                              
            WRITE MAILC10E-REC FROM L10E-HEADER02.                              
                                                                                
            MOVE SPACES TO MAILC10A-REC.                                        
            MOVE SPACES TO MAILC10B-REC.                                        
            MOVE SPACES TO MAILC10C-REC.                                        
            MOVE SPACES TO MAILC10E-REC.                                        
            WRITE MAILC10A-REC.                                                 
            WRITE MAILC10B-REC.                                                 
            WRITE MAILC10C-REC.                                                 
            WRITE MAILC10E-REC.                                                 
                                                                                
            WRITE MAILC10A-REC FROM L10T-HEADER03.                              
            WRITE MAILC10B-REC FROM L10T-HEADER03.                              
            WRITE MAILC10C-REC FROM L10T-HEADER03.                              
            WRITE MAILC10E-REC FROM L10T-HEADER03.                              
                                                                                
            WRITE MAILC10A-REC FROM L10T-HEADER04.                              
            WRITE MAILC10B-REC FROM L10T-HEADER04.                              
            WRITE MAILC10C-REC FROM L10T-HEADER04.                              
            WRITE MAILC10E-REC FROM L10T-HEADER04.                              
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       7000-PRINT-HEADER.                                                       
      ******************************************************************        
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)      TO WS-SYSTEM-DATE               
                                                   WS-CURR-DATE.                
                                                                                
           STRING WS-SYSTEM-DATE(7:2) '/'                                       
                  WS-SYSTEM-DATE(5:2) '/'                                       
                  WS-SYSTEM-DATE(1:4)                                           
              DELIMITED BY SIZE INTO L10A-DATE-HDR                              
           STRING WS-SYSTEM-DATE(7:2) '/'                                       
                  WS-SYSTEM-DATE(5:2) '/'                                       
                  WS-SYSTEM-DATE(1:4)                                           
              DELIMITED BY SIZE INTO L10B-DATE-HDR                              
           STRING WS-SYSTEM-DATE(7:2) '/'                                       
                  WS-SYSTEM-DATE(5:2) '/'                                       
                  WS-SYSTEM-DATE(1:4)                                           
              DELIMITED BY SIZE INTO L10C-DATE-HDR                              
      *    STRING WS-SYSTEM-DATE(7:2) '/'                                       
      *           WS-SYSTEM-DATE(5:2) '/'                                       
      *           WS-SYSTEM-DATE(1:4)                                           
      *       DELIMITED BY SIZE INTO L10D-DATE-HDR                              
           STRING WS-SYSTEM-DATE(7:2) '/'                                       
                  WS-SYSTEM-DATE(5:2) '/'                                       
                  WS-SYSTEM-DATE(1:4)                                           
              DELIMITED BY SIZE INTO L10E-DATE-HDR                              
                                                                                
            STRING 'EXCEPTION REPORT SINGLE PREMIUM SHOULD NOT BE 0('           
                    WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'             
                     DELIMITED BY SIZE INTO L10A-HDR02.                         
                                                                                
            STRING 'EXCEPTION REPORT ELDERLY PREMIUM SHOULD NOT BE 0('          
                    WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'             
                     DELIMITED BY SIZE INTO L10B-HDR02.                         
                                                                                
            STRING 'EXCEPTION REPORT SECOND TIMER APPLICATION AND RESAL'        
                   'E STATUS IS BLANK('                                         
                    '(' WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'         
                     DELIMITED BY SIZE INTO L10C-HDR02.                         
                                                                                
      *     STRING 'EXCEPTION REPORT SECOND TIMER APPLICATION BUT RESAL'        
      *            'E STATUS IS BLANK('                                         
      *             WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'             
      *              DELIMITED BY SIZE INTO L10D-HDR02.                         
                                                                                
            STRING 'EXCEPTION REPORT RSL LEVY AND NTIMES STAFF NOT FND('        
                    WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY  ')'             
                     DELIMITED BY SIZE INTO L10E-HDR02.                         
                                                                                
           ADD 1                               TO WS-PAGE-CTR.                  
           MOVE ZEROES  TO L10A-PAGE-HDR L10B-PAGE-HDR L10C-PAGE-HDR            
                           L10E-PAGE-HDR                                        
      *                    L10D-PAGE-HDR L10E-PAGE-HDR                          
           MOVE WS-PAGE-CTR      TO L10A-PAGE-HDR L10B-PAGE-HDR                 
                                    L10C-PAGE-HDR L10E-PAGE-HDR                 
      *                             L10C-PAGE-HDR L10D-PAGE-HDR                 
                                                                                
           WRITE BP13L10A-REC    FROM L10A-HEADER01 AFTER PAGE.                 
           WRITE BP13L10B-REC    FROM L10B-HEADER01 AFTER PAGE.                 
           WRITE BP13L10C-REC    FROM L10C-HEADER01 AFTER PAGE.                 
      *    WRITE BP13L10D-REC    FROM L10D-HEADER01 AFTER PAGE.                 
           WRITE BP13L10E-REC    FROM L10E-HEADER01 AFTER PAGE.                 
           WRITE BP13L10A-REC    FROM L10A-HEADER02.                            
           WRITE BP13L10B-REC    FROM L10B-HEADER02.                            
           WRITE BP13L10C-REC    FROM L10C-HEADER02.                            
      *    WRITE BP13L10D-REC    FROM L10D-HEADER02.                            
           WRITE BP13L10E-REC    FROM L10E-HEADER02.                            
           WRITE BP13L10A-REC    FROM L10T-HEADER03 AFTER 2.                    
           WRITE BP13L10B-REC    FROM L10T-HEADER03 AFTER 2.                    
           WRITE BP13L10C-REC    FROM L10T-HEADER03 AFTER 2.                    
      *    WRITE BP13L10D-REC    FROM L10T-HEADER03 AFTER 2.                    
           WRITE BP13L10E-REC    FROM L10T-HEADER03 AFTER 2.                    
           WRITE BP13L10A-REC    FROM L10T-HEADER04.                            
           WRITE BP13L10B-REC    FROM L10T-HEADER04.                            
           WRITE BP13L10C-REC    FROM L10T-HEADER04.                            
      *    WRITE BP13L10D-REC    FROM L10T-HEADER04.                            
           WRITE BP13L10E-REC    FROM L10T-HEADER04.                            
                                                                                
           INITIALIZE WS-LINE-CTR.                                              
           MOVE 5  TO WS-LINE-CTR.                                              
                                                                                
           PERFORM 5000-HEADER-EMAIL           THRU 5000-EXIT.                  
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       9999-CLOSE-ROUTINE.                                                      
      ******************************************************************        
                                                                                
           DISPLAY '*************** CONTROL    TOTALS ***************'.         
           DISPLAY 'PROGRAM-ID : BP13C10A'.                                     
           DISPLAY '-------------------------------------------------'.         
           DISPLAY '(1) NO OF BP13F800 RECORDS READ............. : '            
                    WS-F800-READ.                                               
           DISPLAY '(2) NO OF BP13L10A RECORDS WRITTEN...........: '            
                    WS-CNT-L10A-WRITE.                                          
           DISPLAY '(3) NO OF BP13L10B RECORDS WRITTEN...........: '            
                    WS-CNT-L10B-WRITE.                                          
           DISPLAY '(4) NO OF BP13L10C RECORDS WRITTEN...........: '            
                    WS-CNT-L10C-WRITE.                                          
      *    DISPLAY '(5) NO OF BP13L10D RECORDS WRITTEN...........: '            
      *             WS-CNT-L10D-WRITE.                                          
           DISPLAY '(6) NO OF BP13L10E RECORDS WRITTEN...........: '            
                    WS-CNT-L10E-WRITE.                                          
                                                                                
           CLOSE    BP13F800                                                    
                    BM06K110                                                    
                    BP13K162                                                    
                    BP13L10A                                                    
                    BP13L10B                                                    
                    BP13L10C                                                    
      *             BP13L10D                                                    
                    BP13L10E                                                    
                    MAILC10A                                                    
                    MAILC10B                                                    
                    MAILC10C                                                    
                    MAILC10E.                                                   
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K110 - ERROR CLOSING : ' WS-K110-STATUS              
           END-IF.                                                              
                                                                                
           IF WS-K162-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K162 - ERROR CLOSING : ' WS-K162-STATUS              
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
