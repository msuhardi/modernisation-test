       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C399.                                                 
      *AUTHOR.        JIJO FRANCIS.                                             
      *DATE-WRITTEN.  29/09/2003.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      * OBJECTIVE :                                                *            
      *    PRINT UNDERTAKING LETTER                                *            
      *                                                            *            
      * NOTE:  CALLED BY BP13C39A                                  *            
      *        TO RECOMPILE BP13C39A AFTER AMENDMENT               *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  BY    DATE     DESCRIPTION                        *            
      * -------- ---  --------  -----------                        *            
      * BP132412 JF4  01/10/03  NEW PROGRAM.                       *            
      * BP132463 JF4  08/01/04  ADD MCPS FORM TO DOC LIST          *            
      *               13/01/04  PRINT COPY FOR DOC LIST.           *            
      * BP132482 JF4  20/02/04  PRINT LETTER DATE ON THE FORMS     *            
      * BP132531 JF4  15/05/04  INCLUDE 'APPLN FRM' IN DOC LIST FOR*            
      *                         INTERNET APPLICATIONS.             *            
      * BP132684 CKK  23/04/05  INCLUDE ADDITIONAL TEXT FOR PAYSLIP*            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
      *-------------------------------------------------------------            
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT P13P399A  ASSIGN       TO P13P399A.                           
           SELECT P13P399B  ASSIGN       TO P13P399B.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   P13P399A                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE  IS  F.                                              
       01   P13P399A-REC                   PIC X(132).                          
                                                                                
       FD   P13P399B                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE  IS  F.                                              
       01   P13P399B-REC                   PIC X(132).                          
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01 WS-LINE-CTR                      PIC 9(02)  VALUE ZEROES.             
       01 WS-CTR                           PIC 9(02)  VALUE ZEROES.             
       01 WS-SLNO                          PIC 9(02)  VALUE ZEROES.             
       01 WS-CHAR-UNDERLINE                PIC X(32)  VALUE ALL '_'.            
                                                                                
                                                                                
       01 WS-P399A-DOC-MAIN-VARS.                                               
      *-------------------------------------------------------------            
          05 P399A-DOC1-LN-1.                                                   
             10 FILLER                     PIC X(75)  VALUE SPACES.             
             10 P399A-DOC1-REGN            PIC X(08)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-2.                                                   
             10 FILLER                     PIC X(67)  VALUE SPACES.             
             10 P399A-DOC1-DATE            PIC X(10)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-3.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 P399A-DOC1-NME-APPLN1      PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 P399A-DOC1-NRIC1           PIC X(09)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-4.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 P399A-DOC1-NME-APPLN2      PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 P399A-DOC1-NRIC2           PIC X(09)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-5.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 P399A-DOC1-NME-APPLN3      PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 P399A-DOC1-NRIC3           PIC X(09)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-6.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 P399A-DOC1-NME-APPLN4      PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 P399A-DOC1-NRIC4           PIC X(09)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-7.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 P399A-DOC1-NME-APPLN1A     PIC X(66)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-8.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 P399A-DOC1-NME-APPLN2A     PIC X(66)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-9.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 P399A-DOC1-NME-APPLN3A     PIC X(66)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-10.                                                  
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 P399A-DOC1-NME-APPLN4A     PIC X(66)  VALUE SPACES.             
                                                                                
          05 P399A-DOC1-LN-11.                                                  
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(42)  VALUE ALL '_'.            
                                                                                
                                                                                
       01 WS-P399A-DOC-SUB-VARS.                                                
      *-------------------------------------------------------------            
          05 P399A-DOC2-LN-3.                                                   
             10 FILLER                     PIC X(08)  VALUE SPACES.             
             10 P399A-DOC2-SLNO            PIC Z9.                              
             10 FILLER                     PIC X(02)  VALUE '. '.               
             10 P399A-DOC2-NME-OCCP        PIC X(80)  VALUE SPACES.             
          05 P399A-DOC2-LN-4.                                                   
             10 FILLER                     PIC X(12)  VALUE SPACES.             
             10 P399A-DOC2-DOCUMENT        PIC X(81)  VALUE SPACES.             
          05 P399A-DOC2-LN-4A.                                                  
             10 FILLER                     PIC X(08)  VALUE SPACES.             
             10 P399A-DOC2-SLNO-A          PIC Z9.                              
             10 FILLER                     PIC X(02)  VALUE '. '.               
             10 P399A-DOC2-DOCUMENT-A      PIC X(81)  VALUE SPACES.             
          05 P399A-DOC2-LN-5.                                                   
             10 FILLER                     PIC X(12)  VALUE SPACES.             
             10 P399A-DOC2-BLANK-LINE      PIC X(77)  VALUE ALL '_'.            
          05 P399A-DOC2-COPY.                                                   
             10 FILLER                     PIC X(78)  VALUE SPACES.             
             10 FILLER                     PIC X(07)  VALUE                     
                                           'C O P Y'.                           
                                                                                
                                                                                
       01 WS-P399A-DOC-ESS-MBRS-VARS.                                           
      *-------------------------------------------------------------            
          05 P399A-DOC3-LN-1.                                                   
             10 FILLER                     PIC X(75)  VALUE SPACES.             
             10 P399A-DOC3-REGN            PIC X(08)  VALUE SPACES.             
          05 P399A-DOC3-LN-7.                                                   
             10 FILLER                     PIC X(55)  VALUE SPACES.             
             10 P399A-DOC3-REGN-A          PIC X(08)  VALUE SPACES.             
          05 P399A-DOC3-LN-8.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 P399A-DOC3-NME-APPLN1      PIC X(32)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 P399A-DOC3-NME-APPLN2      PIC X(32)  VALUE SPACES.             
          05 P399A-DOC3-LN-9.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 P399A-DOC3-NME-APPLN3      PIC X(32)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 P399A-DOC3-NME-APPLN4      PIC X(32)  VALUE SPACES.             
          05 P399A-DOC3-LN-10.                                                  
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 P399A-DOC3-ULINE1          PIC X(32)  VALUE ALL '_'.            
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 P399A-DOC3-ULINE2          PIC X(32)  VALUE ALL '_'.            
                                                                                
                                                                                
       01 WS-P399A-DOC-CONSENT-VARS.                                            
      *-------------------------------------------------------------            
          05 P399A-DOC6-LN-3.                                                   
             10 FILLER                     PIC X(24)  VALUE SPACES.             
             10 P399A-DOC6-NME-MINOR       PIC X(50)  VALUE SPACES.             
          05 P399A-DOC6-LN-4.                                                   
             10 FILLER                     PIC X(18)  VALUE SPACES.             
             10 P399A-DOC6-NRIC-MINOR      PIC X(09)  VALUE SPACES.             
          05 P399A-DOC6-LN-5.                                                   
             10 FILLER                     PIC X(55)  VALUE SPACES.             
             10 P399A-DOC6-AGE-MINOR       PIC Z(02)9.                          
          05 P399A-DOC6-LN-6.                                                   
             10 FILLER                     PIC X(52)  VALUE SPACES.             
             10 P399A-DOC6-NME-MARRY       PIC X(40)  VALUE SPACES.             
                                                                                
      *------------------------------------------------------------*            
      *  SEND DJDE LINE FOR LETTERS                                *            
      *------------------------------------------------------------*            
      *01  DJDE-DOC-MAIN-FORM             PIC X(80)  VALUE                      
      *     '$DJDE$ FORMS=BP13U6,COLLATE=YES,BOF=68,END;'.                      
       01  DJDE-DOC-SUB-FORM              PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13U7,COLLATE=YES,BOF=68,END;'.                      
       01  DJDE-ESS-MBRS-FORM             PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13U4,COLLATE=YES,BOF=68,END;'.                      
       01  DJDE-ORPH-SCH-FORM             PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13U5,COLLATE=YES,BOF=68,END;'.                      
       01  DJDE-MRG-CONSNT-FORM           PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13U8,COLLATE=YES,BOF=68,END;'.                      
                                                                                
      *-------------------------------------------------------------            
       LINKAGE SECTION.                                                         
      *-------------------------------------------------------------            
       01 WS-C398-PARAMETERS.                                                   
          02 WS-C398-LTR-VARS.                                                  
             05 WS-C398-NUM-REGN                   PIC X(08).                   
             05 WS-C398-PRT-DATE                   PIC X(10).                   
             05 WS-C398-ESS-MBRS                   PIC X(01).                   
             05 WS-C398-ORPHANS-DECL               PIC X(01).                   
             05 WS-C398-MCPS-FRM                   PIC X(01).                   
             05 WS-C398-APPLN-FRM                  PIC X(01).                   
             05 WS-C398-OCCUPIERS  OCCURS 12 TIMES.                             
                10 WS-C398-NRIC                    PIC X(09).                   
                10 WS-C398-CDE-OCCUPIER            PIC X(01).                   
                10 WS-C398-NME-OCCUPIER            PIC X(66).                   
                10 WS-C398-AGE-OCCUPIER            PIC 9(03).                   
                10 WS-C398-DOC-REQD.                                            
                   20 WS-C398-ID-CARD              PIC X(01).                   
                   20 WS-C398-PASS-PERMIT          PIC X(01).                   
                   20 WS-C398-BIRTH-CERTF          PIC X(01).                   
                   20 WS-C398-MARRIAGE-CERTF       PIC X(01).                   
                   20 WS-C398-PAY-SLIP             PIC X(01).                   
                   20 WS-C398-UNEMPLYMNT-DECL      PIC X(01).                   
                   20 WS-C398-STUDENT-PASS         PIC X(01).                   
                   20 WS-C398-DEATH-CERTF          PIC X(01).                   
                   20 WS-C398-NRIC-DTH-CERTF       PIC X(09).                   
                   20 WS-C398-NME-DTH-CERTF        PIC X(66).                   
                   20 WS-C398-DIVORCE-CERTF        PIC X(01).                   
                   20 WS-C398-PHOTOGRAPH           PIC X(01).                   
                   20 WS-C398-MARRIAGE-CONSENT     PIC X(01).                   
             05 FILLER                             PIC X(97).                   
          02 WS-C398-LETTER-CNT                    PIC 9(02).                   
                                                                                
                                                                                
      *-------------------------------------------------------------            
       PROCEDURE DIVISION     USING WS-C398-PARAMETERS.                         
      *-------------------------------------------------------------            
       0000-MAIN-ROUTINE.                                                       
      *-------------------------------------------------------------            
           PERFORM 1000-OPEN-FILES           THRU  1000-EXIT.                   
           PERFORM 2000-MOVE-DETAILS         THRU  2000-EXIT.                   
           PERFORM 3000-PRINT-LETTER         THRU  3000-EXIT.                   
           PERFORM 9000-CLOSE-FILES          THRU  9000-EXIT.                   
                                                                                
       0000-EXIT.                                                               
           GOBACK.                                                              
                                                                                
      *-------------------------------------------------------------            
       1000-OPEN-FILES.                                                         
      *-------------------------------------------------------------            
           OPEN  OUTPUT P13P399A                                                
                        P13P399B.                                               
                                                                                
           IF WS-C398-LETTER-CNT < 2                                            
             WRITE P13P399A-REC  FROM  DJDE-DOC-SUB-FORM    AFTER PAGE          
             MOVE  SPACES        TO    P13P399A-REC                             
             WRITE P13P399A-REC  AFTER 5                                        
                                                                                
             WRITE P13P399B-REC  FROM  DJDE-DOC-SUB-FORM    AFTER PAGE          
             MOVE  SPACES        TO    P13P399B-REC                             
             WRITE P13P399B-REC  AFTER 5                                        
                                                                                
             WRITE P13P399A-REC  FROM  DJDE-ESS-MBRS-FORM   AFTER PAGE          
             MOVE  SPACES        TO    P13P399A-REC                             
             WRITE P13P399A-REC  AFTER 5                                        
                                                                                
             WRITE P13P399A-REC  FROM  DJDE-ORPH-SCH-FORM   AFTER PAGE          
             MOVE  SPACES        TO    P13P399A-REC                             
             WRITE P13P399A-REC  AFTER 5                                        
                                                                                
             WRITE P13P399A-REC  FROM  DJDE-MRG-CONSNT-FORM AFTER PAGE          
             MOVE  SPACES        TO    P13P399A-REC                             
             WRITE P13P399A-REC  AFTER 5                                        
           END-IF.                                                              
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       2000-MOVE-DETAILS.                                                       
      *-------------------------------------------------------------            
           MOVE ZEROES     TO WS-SLNO.                                          
           MOVE WS-C398-NUM-REGN         TO P399A-DOC1-REGN                     
                                            P399A-DOC3-REGN                     
                                            P399A-DOC3-REGN-A.                  
                                                                                
           MOVE WS-C398-PRT-DATE         TO P399A-DOC1-DATE.                    
                                                                                
           MOVE WS-C398-NRIC(1)          TO P399A-DOC1-NRIC1.                   
           MOVE WS-C398-NME-OCCUPIER(1)  TO P399A-DOC1-NME-APPLN1               
                                            P399A-DOC1-NME-APPLN1A              
                                            P399A-DOC3-NME-APPLN1               
                                            P399A-DOC6-NME-MARRY.               
                                                                                
           IF WS-C398-NRIC(2) NOT = SPACES AND LOW-VALUES                       
             MOVE WS-C398-NRIC(2)          TO P399A-DOC1-NRIC2                  
             MOVE WS-C398-NME-OCCUPIER(2)  TO P399A-DOC1-NME-APPLN2             
                                              P399A-DOC1-NME-APPLN2A            
                                              P399A-DOC3-NME-APPLN2             
           ELSE                                                                 
             MOVE   ' -'                   TO P399A-DOC1-NRIC2                  
                                              P399A-DOC1-NME-APPLN2             
                                              P399A-DOC1-NME-APPLN2A            
             MOVE    SPACES                TO P399A-DOC3-NME-APPLN2             
           END-IF.                                                              
                                                                                
           IF WS-C398-NRIC(3) NOT = SPACES AND LOW-VALUES                       
             MOVE WS-C398-NRIC(3)          TO P399A-DOC1-NRIC3                  
             MOVE WS-C398-NME-OCCUPIER(3)  TO P399A-DOC1-NME-APPLN3             
                                              P399A-DOC1-NME-APPLN3A            
                                              P399A-DOC3-NME-APPLN3             
           ELSE                                                                 
             MOVE   ' -'                   TO P399A-DOC1-NRIC3                  
                                              P399A-DOC1-NME-APPLN3             
                                              P399A-DOC1-NME-APPLN3A            
             MOVE    SPACES                TO P399A-DOC3-NME-APPLN3             
           END-IF.                                                              
                                                                                
           IF WS-C398-NRIC(4) NOT = SPACES AND LOW-VALUES                       
             MOVE WS-C398-NRIC(4)          TO P399A-DOC1-NRIC4                  
             MOVE WS-C398-NME-OCCUPIER(4)  TO P399A-DOC1-NME-APPLN4             
                                              P399A-DOC1-NME-APPLN4A            
                                              P399A-DOC3-NME-APPLN4             
           ELSE                                                                 
             MOVE   ' -'                   TO P399A-DOC1-NRIC4                  
                                              P399A-DOC1-NME-APPLN4             
                                              P399A-DOC1-NME-APPLN4A            
             MOVE    SPACES                TO P399A-DOC3-NME-APPLN4             
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3000-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
      * PRINT PRODUCE DOCUMENTS - ANNEX I FORM (BP13U7)      *                  
      *------------------------------------------------------*                  
           MOVE  43        TO WS-LINE-CTR.                                      
           PERFORM 3200-ANNEX-I             THRU 3200-EXIT                      
                VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 12.                   
           PERFORM 3210-OTHER-DOCUMENTS     THRU 3210-EXIT.                     
                                                                                
      *------------------------------------------------------*                  
      * PRINT NON-DEL OF ESSENTIAL MEMBERS FORM (BP13U4)     *                  
      *------------------------------------------------------*                  
           PERFORM 3300-NON-DEL-ESS-MBRS    THRU 3300-EXIT.                     
                                                                                
      *------------------------------------------------------*                  
      * PRINT CONSENT FOR MARRIAGE OF A MINOR FORM (BP13U8)  *                  
      *------------------------------------------------------*                  
           PERFORM 3400-MARRIAGE-CONSENT    THRU 3400-EXIT                      
                VARYING WS-CTR FROM 5 BY 1 UNTIL WS-CTR > 12.                   
                                                                                
      *------------------------------------------------------*                  
      * PRINT ORPHAN SCHEME DECLARATION FORM (BP13U5)        *                  
      *------------------------------------------------------*                  
           IF WS-C398-ORPHANS-DECL = 'Y'                                        
              PERFORM 3600-ORPHAN-DECL-FRM  THRU 3600-EXIT                      
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3200-ANNEX-I.                                                            
      *-------------------------------------------------------------            
           IF WS-C398-NRIC(WS-CTR)  NOT = SPACES AND LOW-VALUES                 
              IF WS-LINE-CTR > 35                                               
                MOVE  43    TO WS-LINE-CTR                                      
              END-IF                                                            
              PERFORM 3250-CHK-REGN-LINE-CTR       THRU 3250-EXIT               
                                                                                
              IF WS-C398-ID-CARD(WS-CTR)  =  'Y'                                
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE  SPACES             TO   P399A-DOC2-DOCUMENT              
                 MOVE '. IDENTITY CARD'   TO   P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1          
                 WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1          
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-PASS-PERMIT(WS-CTR)  =  'Y'                            
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE  SPACES             TO   P399A-DOC2-DOCUMENT              
                 STRING '. PASSPORT/ENTRY OR RE-ENTRY PERMIT/'                  
                        'WORK PERMIT/EMPLOYMENT PASS/'                          
                        'SOCIAL VISIT PASS'                                     
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC   FROM P399A-DOC2-LN-4   AFTER 1            
                 WRITE P13P399B-REC   FROM P399A-DOC2-LN-4   AFTER 1            
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-BIRTH-CERTF(WS-CTR)  =  'Y'                            
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE  SPACES             TO   P399A-DOC2-DOCUMENT              
                 MOVE '. BIRTH CERTIFICATE'  TO P399A-DOC2-DOCUMENT             
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-MARRIAGE-CERTF(WS-CTR)  =  'Y'                         
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE   SPACES            TO   P399A-DOC2-DOCUMENT              
                 MOVE '. MARRIAGE CERTIFICATE'  TO P399A-DOC2-DOCUMENT          
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-PAY-SLIP(WS-CTR)  =  'Y'                               
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE   SPACES            TO   P399A-DOC2-DOCUMENT              
                 STRING '. LATEST ORIGINAL PAYSLIP/'                            
                        'GROSS INCOME LETTER FROM'                              
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 STRING '  EMPLOYER/INCOME TAX ASSESSMENT'                      
                        ' FOR SELF-EMPLOYED PERSON'                             
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-UNEMPLYMNT-DECL(WS-CTR)  =  'Y'                        
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 STRING '. STATUTORY DECLARATION TO '                           
                        'DECLARE UNEMPLOYMENT (TO EXECUTE STATUTORY'            
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 STRING '  DECLARATION ON THE DAY OF '                          
                        'SELECTION OF FLAT)'                                    
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-STUDENT-PASS(WS-CTR)  =  'Y'                           
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 STRING '. STUDENT PASS/LETTER FROM '                           
                        'INSTITUTE OF LEARNING (IF APPLICABLE)'                 
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-DEATH-CERTF(WS-CTR)  =  'Y'                            
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 STRING '. DEATH CERTIFICATE OF SPOUSE '                        
                        '(IF APPLICABLE): TO VERIFY THE '                       
                        'DEMISE OF SPOUSE'                                      
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-DIVORCE-CERTF(WS-CTR)  =  'Y'                          
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 STRING '. DECREE NISI/DECREE NISI ABSOLUTE/'                   
                        'ORDER OF COURT/DIVORCE CERTIFICATION'                  
                        DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-PHOTOGRAPH(WS-CTR)  =  'Y'                             
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 MOVE '. PASSPORT SIZE PHOTOGRAPH'                              
                                          TO   P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-MARRIAGE-CONSENT(WS-CTR)  =  'Y'                       
                 PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT               
                 MOVE    SPACES           TO   P399A-DOC2-DOCUMENT              
                 MOVE '. CONSENT FOR MARRIAGE OF A MINOR'                       
                                          TO   P399A-DOC2-DOCUMENT              
                 WRITE P13P399A-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 WRITE P13P399B-REC       FROM P399A-DOC2-LN-4  AFTER 1         
                 ADD   1    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3210-OTHER-DOCUMENTS.                                                    
      *-------------------------------------------------------------            
           IF WS-LINE-CTR > 40                                                  
              MOVE   43      TO WS-LINE-CTR                                     
           END-IF.                                                              
                                                                                
           PERFORM 3270-CHK-NRIC-LINE-CTR      THRU 3270-EXIT.                  
           MOVE    SPACES    TO   P13P399A-REC                                  
                                  P13P399B-REC.                                 
           IF WS-LINE-CTR = 0                                                   
              CONTINUE                                                          
           ELSE                                                                 
              WRITE P13P399A-REC   AFTER 2                                      
              WRITE P13P399B-REC   AFTER 2                                      
              ADD     2      TO WS-LINE-CTR                                     
           END-IF.                                                              
                                                                                
           IF WS-C398-APPLN-FRM  =  'Y'                                         
             PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT                   
             ADD  1       TO   WS-SLNO                                          
             MOVE    WS-SLNO        TO   P399A-DOC2-SLNO-A                      
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT-A                  
             STRING 'ENCLOSED  "APPLICATION FORM"  AND  "CONFIRMATION '         
                    'OF HOUSING LOAN TYPE FOR THE'                              
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT-A                
             WRITE P13P399A-REC       FROM P399A-DOC2-LN-4A  AFTER 2            
             WRITE P13P399B-REC       FROM P399A-DOC2-LN-4A  AFTER 2            
             MOVE    SPACES           TO   P399A-DOC2-DOCUMENT                  
             STRING 'PURCHASE OF A FLAT DIRECT FROM HDB" COMPLETED '            
                    'AND SIGNED BY APPLICANTS'                                  
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE  P13P399A-REC      FROM P399A-DOC2-LN-4   AFTER 1            
             WRITE  P13P399B-REC      FROM P399A-DOC2-LN-4   AFTER 1            
             ADD    3       TO   WS-LINE-CTR                                    
           END-IF.                                                              
                                                                                
           PERFORM 3270-CHK-NRIC-LINE-CTR   THRU 3270-EXIT.                     
           ADD    1       TO WS-SLNO.                                           
           MOVE    WS-SLNO          TO   P399A-DOC2-SLNO-A.                     
           MOVE    SPACES           TO   P399A-DOC2-DOCUMENT-A.                 
           STRING 'ENCLOSED "NON-DELETION OF ESSENTIAL MEMBERS '                
                  'LISTED IN SALES APPLICATION" FORM '                          
                  DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT-A.                 
           WRITE P13P399A-REC       FROM P399A-DOC2-LN-4A  AFTER 2.             
           WRITE P13P399B-REC       FROM P399A-DOC2-LN-4A  AFTER 2.             
           MOVE    SPACES           TO   P399A-DOC2-DOCUMENT.                   
           MOVE 'COMPLETED AND SIGNED BY ALL APPLICANTS'                        
                                    TO   P399A-DOC2-DOCUMENT.                   
           WRITE  P13P399A-REC      FROM P399A-DOC2-LN-4   AFTER 1.             
           WRITE  P13P399B-REC      FROM P399A-DOC2-LN-4   AFTER 1.             
           ADD    3       TO   WS-LINE-CTR.                                     
                                                                                
           IF WS-C398-ORPHANS-DECL  =  'Y'                                      
             PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT                   
             ADD  1       TO   WS-SLNO                                          
             MOVE    WS-SLNO        TO   P399A-DOC2-SLNO-A                      
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT-A                  
             MOVE 'ORPHAN SCHEME DECLARATION/UNDERTAKING'                       
                                    TO   P399A-DOC2-DOCUMENT-A                  
             WRITE  P13P399A-REC    FROM P399A-DOC2-LN-4A  AFTER 2              
             WRITE  P13P399B-REC    FROM P399A-DOC2-LN-4A  AFTER 2              
             ADD     2    TO   WS-LINE-CTR                                      
                                                                                
             PERFORM 3270-CHK-NRIC-LINE-CTR    THRU 3270-EXIT                   
             ADD    1     TO   WS-SLNO                                          
             MOVE   WS-SLNO         TO   P399A-DOC2-SLNO-A                      
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT-A                  
             MOVE 'DEATH CERTIFICATE OF PARENTS'                                
                                    TO   P399A-DOC2-DOCUMENT-A                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4A  AFTER 2              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4A  AFTER 2              
             ADD     2    TO   WS-LINE-CTR                                      
           END-IF.                                                              
                                                                                
      *------------------------------*                                          
      * UNDERTAKING FOR MCPS CASES   *                                          
      *------------------------------*                                          
           IF WS-C398-MCPS-FRM  =  'Y'                                          
             IF WS-LINE-CTR > 28                                                
                MOVE 43   TO   WS-LINE-CTR                                      
             END-IF                                                             
                                                                                
             PERFORM 3270-CHK-NRIC-LINE-CTR   THRU 3270-EXIT                    
                                                                                
             ADD   1      TO   WS-SLNO                                          
             MOVE   WS-SLNO         TO   P399A-DOC2-SLNO-A                      
             MOVE   SPACES          TO   P399A-DOC2-DOCUMENT-A                  
             STRING 'ENCLOSED "UNDERTAKING  BY PARENTS/MARRIED CHILD '          
                    'OF  APPLICANTS UNDER  MARRIED'                             
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT-A                
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4A  AFTER 2              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4A  AFTER 2              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING 'CHILD PRIORITY SCHEME(MCPS)" DULY COMPLETED AND '          
                    'SIGNED BY ALL PARTIES AND THE'                             
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING 'FOLLOWING DOCUMENTS OF YOUR PARENTS OR '                   
                    'MARRIED CHILD:'                                            
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING 'a. Identity card of your parents or married '              
                    'child to verify place of residence.'                       
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 2              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 2              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING '   If your  parents  or  married child  are '              
                    'residing  in a private residential'                        
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING '   property,  you are also required  to '                  
                    'submit  a copy of  their  Property Tax'                    
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING '   Statement for verification of their ownership '         
                    'of the property; and'                                      
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING 'b. Birth Certificate of the married '                      
                    'child to prove relationship; and'                          
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 2              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 2              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING 'c. Marriage  Certificate,  Separation  Deed,  '            
                    ' Divorce  Certificate  or  Death'                          
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 2              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 2              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING '   Certificate (whichever is applicable)  '                
                    'of your parents or married child  to'                      
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1              
                                                                                
             MOVE    SPACES         TO   P399A-DOC2-DOCUMENT                    
             STRING '   verify the marital status.'                             
                    DELIMITED BY SIZE INTO P399A-DOC2-DOCUMENT                  
             WRITE P13P399A-REC     FROM P399A-DOC2-LN-4   AFTER 1              
             WRITE P13P399B-REC     FROM P399A-DOC2-LN-4   AFTER 1              
                                                                                
             ADD   14     TO   WS-LINE-CTR                                      
           END-IF.                                                              
                                                                                
      *--------------------------*                                              
      * PRINT 4 BLANK LINES                                                     
      *--------------------------*                                              
           PERFORM  4 TIMES                                                     
              PERFORM 3280-CHK-BLANK-CTR    THRU 3280-EXIT                      
              WRITE P13P399A-REC    FROM P399A-DOC2-LN-5   AFTER 2              
              WRITE P13P399B-REC    FROM P399A-DOC2-LN-5   AFTER 2              
              ADD   2     TO   WS-LINE-CTR                                      
           END-PERFORM.                                                         
                                                                                
       3210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3250-CHK-REGN-LINE-CTR.                                                  
      *-------------------------------------------------------------            
           ADD    1       TO   WS-SLNO.                                         
           MOVE    WS-SLNO          TO   P399A-DOC2-SLNO.                       
           MOVE    SPACES           TO   P399A-DOC2-NME-OCCP.                   
           STRING WS-C398-NME-OCCUPIER(WS-CTR) DELIMITED BY '  '                
                  '   '                                                         
                  WS-C398-NRIC(WS-CTR) DELIMITED BY SIZE                        
                                    INTO P399A-DOC2-NME-OCCP.                   
                                                                                
           IF WS-LINE-CTR  >  40                                                
              MOVE  SPACES         TO   P13P399A-REC                            
                                        P13P399B-REC                            
              WRITE P13P399A-REC   FROM DJDE-DOC-SUB-FORM  AFTER PAGE           
              WRITE P13P399B-REC   FROM DJDE-DOC-SUB-FORM  AFTER PAGE           
              WRITE P13P399A-REC   FROM P399A-DOC1-LN-1    AFTER 5              
              WRITE P13P399B-REC   FROM P399A-DOC1-LN-1    AFTER 5              
              WRITE P13P399A-REC   FROM P399A-DOC1-LN-2    AFTER 2              
              WRITE P13P399B-REC   FROM P399A-DOC1-LN-2    AFTER 2              
              WRITE P13P399A-REC   FROM P399A-DOC2-LN-3    AFTER 13             
              WRITE P13P399B-REC   FROM P399A-DOC2-COPY    AFTER 7              
              WRITE P13P399B-REC   FROM P399A-DOC2-LN-3    AFTER 6              
              MOVE   1    TO   WS-LINE-CTR                                      
           ELSE                                                                 
              WRITE P13P399A-REC   FROM P399A-DOC2-LN-3    AFTER 4              
              WRITE P13P399B-REC   FROM P399A-DOC2-LN-3    AFTER 4              
              ADD    4    TO   WS-LINE-CTR                                      
           END-IF.                                                              
                                                                                
       3250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3270-CHK-NRIC-LINE-CTR.                                                  
      *-------------------------------------------------------------            
           IF WS-LINE-CTR  >  40                                                
              MOVE  SPACES       TO   P13P399A-REC                              
                                      P13P399B-REC                              
              WRITE P13P399A-REC FROM DJDE-DOC-SUB-FORM  AFTER PAGE             
              WRITE P13P399B-REC FROM DJDE-DOC-SUB-FORM  AFTER PAGE             
              WRITE P13P399A-REC    FROM P399A-DOC1-LN-1 AFTER 5                
              WRITE P13P399B-REC    FROM P399A-DOC1-LN-1 AFTER 5                
              WRITE P13P399A-REC    FROM P399A-DOC1-LN-2 AFTER 2                
              WRITE P13P399B-REC    FROM P399A-DOC1-LN-2 AFTER 2                
              WRITE P13P399B-REC    FROM P399A-DOC2-COPY AFTER 7                
              MOVE   ZEROES         TO   WS-LINE-CTR                            
              MOVE    SPACES        TO   P13P399A-REC                           
                                         P13P399B-REC                           
              WRITE P13P399A-REC    AFTER 11                                    
              WRITE P13P399B-REC    AFTER 4                                     
           END-IF.                                                              
                                                                                
       3270-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3280-CHK-BLANK-CTR.                                                      
      *-------------------------------------------------------------            
           IF WS-LINE-CTR  >  42                                                
              MOVE  SPACES       TO   P13P399B-REC                              
              WRITE P13P399B-REC FROM DJDE-DOC-SUB-FORM  AFTER PAGE             
              WRITE P13P399B-REC    FROM P399A-DOC1-LN-1 AFTER 5                
              WRITE P13P399B-REC    FROM P399A-DOC1-LN-2 AFTER 2                
              WRITE P13P399B-REC    FROM P399A-DOC2-COPY AFTER 7                
              MOVE   ZEROES         TO   WS-LINE-CTR                            
              MOVE    SPACES        TO   P13P399B-REC                           
              WRITE P13P399B-REC    AFTER 4                                     
           END-IF.                                                              
                                                                                
       3280-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3300-NON-DEL-ESS-MBRS.                                                   
      *-------------------------------------------------------------            
           MOVE  SPACES        TO   P13P399A-REC.                               
           WRITE P13P399A-REC  FROM DJDE-ESS-MBRS-FORM  AFTER PAGE.             
           WRITE P13P399A-REC  FROM P399A-DOC3-LN-1     AFTER 5.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-2     AFTER 2.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-3     AFTER 9.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-4     AFTER 1.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-5     AFTER 1.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-6     AFTER 1.                
           WRITE P13P399A-REC  FROM P399A-DOC3-LN-7     AFTER 1.                
                                                                                
           IF WS-C398-NME-OCCUPIER(1) NOT = SPACES AND LOW-VALUES               
              IF WS-C398-NME-OCCUPIER(2) NOT = SPACES AND LOW-VALUES            
                 MOVE  WS-CHAR-UNDERLINE   TO   P399A-DOC3-ULINE2               
              ELSE                                                              
                 MOVE    SPACES            TO   P399A-DOC3-ULINE2               
              END-IF                                                            
              MOVE    SPACES        TO   P13P399A-REC                           
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-10  AFTER 40             
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-8   AFTER 1              
           END-IF.                                                              
                                                                                
           IF WS-C398-NME-OCCUPIER(3) NOT = SPACES AND LOW-VALUES               
              IF WS-C398-NME-OCCUPIER(4) NOT = SPACES AND LOW-VALUES            
                 MOVE  WS-CHAR-UNDERLINE   TO   P399A-DOC3-ULINE2               
              ELSE                                                              
                 MOVE     SPACES           TO   P399A-DOC3-ULINE2               
              END-IF                                                            
              MOVE    SPACES        TO   P13P399A-REC                           
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-10  AFTER 3              
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-9   AFTER 1              
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3400-MARRIAGE-CONSENT.                                                   
      *-------------------------------------------------------------            
           IF WS-C398-MARRIAGE-CONSENT(WS-CTR) = 'Y'                            
              MOVE WS-C398-NME-OCCUPIER(WS-CTR)                                 
                                    TO   P399A-DOC6-NME-MINOR                   
              MOVE WS-C398-NRIC(WS-CTR)                                         
                                    TO   P399A-DOC6-NRIC-MINOR                  
              MOVE WS-C398-AGE-OCCUPIER(WS-CTR)                                 
                                    TO   P399A-DOC6-AGE-MINOR                   
                                                                                
              MOVE   SPACES       TO   P13P399A-REC                             
              WRITE P13P399A-REC  FROM DJDE-MRG-CONSNT-FORM AFTER PAGE          
              WRITE P13P399A-REC  FROM P399A-DOC3-LN-1     AFTER 5              
              WRITE P13P399A-REC  FROM P399A-DOC1-LN-2     AFTER 2              
              WRITE P13P399A-REC  FROM P399A-DOC6-LN-3     AFTER 8              
              WRITE P13P399A-REC  FROM P399A-DOC6-LN-4     AFTER 2              
              WRITE P13P399A-REC  FROM P399A-DOC6-LN-5     AFTER 3              
              WRITE P13P399A-REC  FROM P399A-DOC6-LN-6     AFTER 1              
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3600-ORPHAN-DECL-FRM.                                                    
      *-------------------------------------------------------------            
           MOVE  SPACES        TO   P13P399A-REC.                               
           WRITE P13P399A-REC  FROM DJDE-ORPH-SCH-FORM  AFTER PAGE.             
           WRITE P13P399A-REC  FROM P399A-DOC3-LN-1     AFTER 5.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-2     AFTER 2.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-3     AFTER 9.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-4     AFTER 1.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-5     AFTER 1.                
           WRITE P13P399A-REC  FROM P399A-DOC1-LN-6     AFTER 1.                
           WRITE P13P399A-REC  FROM P399A-DOC3-LN-7     AFTER 1.                
                                                                                
           IF WS-C398-NME-OCCUPIER(1) NOT = SPACES AND LOW-VALUES               
              IF WS-C398-NME-OCCUPIER(2) NOT = SPACES AND LOW-VALUES            
                 MOVE  WS-CHAR-UNDERLINE   TO   P399A-DOC3-ULINE2               
              ELSE                                                              
                 MOVE    SPACES            TO   P399A-DOC3-ULINE2               
              END-IF                                                            
              MOVE    SPACES        TO   P13P399A-REC                           
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-10  AFTER 40             
              MOVE    SPACES        TO   P13P399A-REC                           
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-8   AFTER 1              
           END-IF.                                                              
                                                                                
           IF WS-C398-NME-OCCUPIER(3) NOT = SPACES AND LOW-VALUES               
              IF WS-C398-NME-OCCUPIER(4) NOT = SPACES AND LOW-VALUES            
                 MOVE  WS-CHAR-UNDERLINE   TO   P399A-DOC3-ULINE2               
              ELSE                                                              
                 MOVE    SPACES            TO   P399A-DOC3-ULINE2               
              END-IF                                                            
              MOVE    SPACES        TO   P13P399A-REC                           
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-10  AFTER 3              
              MOVE    SPACES        TO   P13P399A-REC                           
              WRITE  P13P399A-REC   FROM P399A-DOC3-LN-9   AFTER 1              
           END-IF.                                                              
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-FILES.                                                        
      *-------------------------------------------------------------            
           CLOSE   P13P399A                                                     
                   P13P399B.                                                    
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
