       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C030.                                                 
      *AUTHOR.        SN.                                                       
      *DATE-WRITTEN.  18/02/02.                                                 
      *========================================================*                
      * SYSTEM OF COMMITMENT (BP13)                            *                
      *========================================================*                
      *                                                        *                
      *1. PROGRAM TO CREATE P13F853A FILE.                     *                
      * ------------------------------------------------------ *                
      * CHG-NO  CHG-DATE  BY   DESCRIPTION                     *                
      * ------  --------  --   -----------                     *                
      *BP132098 18/02/02  SN   NEW PGM                         *                
      **********************************************************                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F740 ASSIGN TO BP13F740.                                  
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD                               
                  FILE STATUS     IS K820-STATUS.                               
                                                                                
           SELECT P13F853A ASSIGN TO P13F853A.                                  
                                                                                
           SELECT P13L030A ASSIGN TO P13L030A.                                  
           SELECT P13L030B ASSIGN TO P13L030B.                                  
           SELECT P13L030C ASSIGN TO P13L030C.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
       FD  BP13F740                                                             
           RECORD    CONTAINS 500 CHARACTERS                                    
           BLOCK     CONTAINS   0 RECORDS                                       
           LABEL     RECORDS  ARE STANDARD                                      
           RECORDING MODE     IS  F.                                            
       COPY BP13F740.                                                           
                                                                                
       FD  BP13K820                                                             
           RECORD    CONTAINS 400 CHARACTERS.                                   
       COPY BP13K820.                                                           
                                                                                
       FD  P13F853A                                                             
           BLOCK     CONTAINS   0 RECORDS                                       
           LABEL     RECORDS  ARE STANDARD                                      
           RECORDING MODE     IS  F.                                            
       01  P13F853A-REC.                                                        
           05 F853A-NUM-REGN           PIC X(8).                                
           05 F853A-NUM-NRIC           PIC X(9).                                
           05 FILLER                   PIC X(1).                                
           05 F853A-NME-OCCP           PIC X(66).                               
           05 F853A-NUM-NRIC-SPOUSE    PIC X(9).                                
           05 F853A-NME-SPOUSE         PIC X(66).                               
           05 F853A-NUM-NEW-TOWN       PIC X(3).                                
           05 F853A-NUM-FLAT-TYPE      PIC X(2).                                
           05 F853A-DTE-BALLOT         PIC X(6).                                
           05 F853A-NUM-OCCP-MT        PIC X(1).                                
           05 F853A-NUM-SPOUSE-MT      PIC X(1).                                
           05 FILLER                   PIC X(62).                               
           05 F853A-DTE-UPDATE         PIC X(8).                                
           05 F853A-NUM-USERID         PIC X(8).                                
                                                                                
       FD  P13L030A                                                             
           BLOCK     CONTAINS   0 RECORDS                                       
           LABEL     RECORDS  ARE STANDARD                                      
           RECORDING MODE     IS  F.                                            
       01  P13L030A-REC    PIC X(132).                                          
                                                                                
       FD  P13L030B                                                             
           BLOCK     CONTAINS   0 RECORDS                                       
           LABEL     RECORDS  ARE STANDARD                                      
           RECORDING MODE     IS  F.                                            
       01  P13L030B-REC          PIC X(132).                                    
                                                                                
       FD  P13L030C                                                             
           BLOCK     CONTAINS   0 RECORDS                                       
           LABEL     RECORDS  ARE STANDARD                                      
           RECORDING MODE     IS  F.                                            
       01  P13L030C-REC          PIC X(132).                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  FILE-STATUS.                                                         
           03  K820-STATUS             PIC 9(02)  VALUE 0.                      
                                                                                
       01  WS-SWITCHES.                                                         
           03  WS-FOUND-SW             PIC X       VALUE 'N'.                   
           03  F740-EOF-IND            PIC X       VALUE SPACES.                
               88 F740-EOF             VALUE 'Y'.                               
           03  K820-EOF-IND            PIC X       VALUE SPACES.                
               88 K820-EOF             VALUE 'Y'.                               
                                                                                
       01  WS-TEMP.                                                             
           03  WS-NO-READ-F740         PIC 9(6)    VALUE ZERO.                  
           03  WS-NO-FOUND-K820        PIC 9(6)    VALUE ZERO.                  
           03  WS-NO-NOTFND-K820       PIC 9(6)    VALUE ZERO.                  
           03  WS-NO-READ-K820         PIC 9(6)    VALUE ZERO.                  
           03  WS-F853A-WRITE          PIC 9(6)    VALUE ZERO.                  
           03  WS-F740-REGN            PIC X(8).                                
           03  WS-PAGE-CNT             PIC 9(4)    VALUE ZERO.                  
           03  WS-PAGE-CNT1            PIC 9(4)    VALUE ZERO.                  
           03  WS-PAGE-CNT2            PIC 9(4)    VALUE ZERO.                  
           03  WS-SER-NO               PIC 9(4)    VALUE ZERO.                  
           03  WS-SER-NO1              PIC 9(4)    VALUE ZERO.                  
           03  WS-SER-NO2              PIC 9(4)    VALUE ZERO.                  
           03  WS-LINE-CNT             PIC 9(6)    VALUE ZERO.                  
           03  WS-LINE-CNT1            PIC 9(6)    VALUE ZERO.                  
           03  WS-LINE-CNT2            PIC 9(6)    VALUE ZERO.                  
           03  WS-CUR-DATE             PIC X(8).                                
           03  WS-COUNT                PIC 9(8)    VALUE ZEROS.                 
           03  WS-CNT                  PIC 9(8)    VALUE ZEROS.                 
           03  WS-COUNT1               PIC 9(8)    VALUE ZEROS.                 
           03  WS-COUNT2               PIC 9(8)    VALUE ZEROS.                 
           03  WS-MS-COUNT             PIC 9(8)    VALUE ZEROS.                 
                                                                                
       01  WS-TABLE.                                                            
           05 WS-TABLE1             OCCURS 800 TIMES.                           
              10 NUM-REGN               PIC X(8) VALUE SPACES.                  
              10 NUM-NRIC               PIC X(9) VALUE SPACES.                  
              10 NUM-MARITAL-STATUS     PIC X(1) VALUE SPACES.                  
              10 NUM-RELATIONSHIP       PIC X(2) VALUE SPACES.                  
                                                                                
                                                                                
       01  WS-TABLE2.                                                           
           05 WS-TABLE3             OCCURS 800 TIMES.                           
              10 TBL-NUM-REGN               PIC X(8) VALUE SPACES.              
              10 TBL-NUM-NRIC               PIC X(9) VALUE SPACES.              
              10 TBL-NUM-MARITAL-STATUS     PIC X(1) VALUE SPACES.              
              10 TBL-NUM-RELATIONSHIP       PIC X(2) VALUE SPACES.              
                                                                                
                                                                                
      *----------------------------------------------------------------*        
      *   HEADER RECORDS                                               *        
      *----------------------------------------------------------------*        
       01  L820-HDG1.                                                           
           05  FILLER              PIC X(8)      VALUE 'P13L030A'.              
           05  FILLER              PIC X(41)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
               'S Y S T E M   O F  C O M M I T M E N T'.                        
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE : '.               
           05  L820-DATE           PIC X(10)     VALUE SPACES.                  
                                                                                
       01  L820-HDG2.                                                           
           05  FILLER                   PIC X(42)  VALUE SPACES.                
           05  FILLER                   PIC X(46)  VALUE                        
               '  REPORT FOR MCPS DEBARMENT - ONE COUPLE FOUND'.                
           05  FILLER                   PIC X(20)  VALUE SPACES.                
           05  FILLER                   PIC X(7)   VALUE 'PAGE : '.             
           05  L820-PAGE                PIC ZZZ9.                               
                                                                                
       01  L820-HDG3.                                                           
           05  FILLER                 PIC X(132) VALUE ALL '-'.                 
                                                                                
       01  L820-HDG4.                                                           
           05  FILLER                 PIC X(03) VALUE SPACES.                   
           05  FILLER                 PIC X(10) VALUE 'S/NO '.                  
           05  FILLER                 PIC X(10) VALUE 'REGN '.                  
           05  FILLER                 PIC X(10) VALUE 'NRIC '.                  
           05  FILLER                 PIC X(20) VALUE 'MARITAL STATUS'.         
           05  FILLER                 PIC X(15) VALUE 'RELATIONSHIP'.           
                                                                                
      *----------------------------------------------------------------*        
      *   DETAIL RECORDS                                               *        
      *----------------------------------------------------------------*        
       01  L820-DTL.                                                            
           05  SER-NO                   PIC ZZZ9  VALUE ZEROES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  REGN                     PIC X(08).                              
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  NRIC                     PIC X(09).                              
           05  FILLER                   PIC X(08) VALUE SPACES.                 
           05  MS                       PIC X(01).                              
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  RELAT                    PIC X(02).                              
                                                                                
      *----------------------------------------------------------------*        
      *   HEADER RECORDS                                               *        
      *----------------------------------------------------------------*        
       01  L820B-HDG1.                                                          
           05  FILLER              PIC X(8)      VALUE 'P13L030B'.              
           05  FILLER              PIC X(41)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
               'S Y S T E M   O F  C O M M I T M E N T'.                        
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE : '.               
           05  L820-DATE1          PIC X(10)     VALUE SPACES.                  
                                                                                
       01  L820B-HDG2.                                                          
           05  FILLER                   PIC X(42)  VALUE SPACES.                
           05  FILLER                   PIC X(46)  VALUE                        
               'REPORT FOR MCPS DEBARMENT - INCOMPLETE SPOUSE '.                
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(7)   VALUE 'PAGE : '.             
           05  L820-PAGE1               PIC ZZZ9.                               
                                                                                
       01  L820B-HDG3.                                                          
           05  FILLER                 PIC X(132) VALUE ALL '-'.                 
                                                                                
       01  L820B-HDG4.                                                          
           05  FILLER                 PIC X(03) VALUE SPACES.                   
           05  FILLER                 PIC X(10) VALUE 'S/NO '.                  
           05  FILLER                 PIC X(10) VALUE 'REGN '.                  
           05  FILLER                 PIC X(10) VALUE 'NRIC '.                  
           05  FILLER                 PIC X(20) VALUE 'MARITAL STATUS'.         
           05  FILLER                 PIC X(15) VALUE 'RELATIONSHIP'.           
                                                                                
      *----------------------------------------------------------------*        
      *   DETAIL RECORDS                                               *        
      *----------------------------------------------------------------*        
       01  L820-DTL1.                                                           
           05  SER-NO1                  PIC ZZZ9  VALUE ZEROES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  REGN1                    PIC X(08).                              
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  NRIC1                    PIC X(09).                              
           05  FILLER                   PIC X(08) VALUE SPACES.                 
           05  MS1                      PIC X(01).                              
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  RELAT1                   PIC X(02).                              
                                                                                
      *----------------------------------------------------------------*        
      *   HEADER RECORDS                                               *        
      *----------------------------------------------------------------*        
       01  L820C-HDG1.                                                          
           05  FILLER              PIC X(8)      VALUE 'P13L030C'.              
           05  FILLER              PIC X(41)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
               'S Y S T E M   O F  C O M M I T M E N T'.                        
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE : '.               
           05  L820-DATE2          PIC X(10)     VALUE SPACES.                  
                                                                                
       01  L820C-HDG2.                                                          
           05  FILLER                   PIC X(42)  VALUE SPACES.                
           05  FILLER                   PIC X(66)  VALUE                        
               'ERROR REPORT FOR MCPS DEBARMENT -PARENT/SON NOTFD'.             
           05  FILLER                   PIC X(05)  VALUE SPACES.                
           05  FILLER                   PIC X(7)   VALUE 'PAGE : '.             
           05  L820-PAGE2               PIC ZZZ9.                               
                                                                                
       01  L820C-HDG3.                                                          
           05  FILLER                 PIC X(132) VALUE ALL '-'.                 
                                                                                
       01  L820C-HDG4.                                                          
           05  FILLER                 PIC X(03) VALUE SPACES.                   
           05  FILLER                 PIC X(10) VALUE 'S/NO '.                  
           05  FILLER                 PIC X(10) VALUE 'REGN '.                  
           05  FILLER                 PIC X(10) VALUE 'NRIC '.                  
           05  FILLER                 PIC X(20) VALUE 'MARITAL STATUS'.         
           05  FILLER                 PIC X(15) VALUE 'RELATIONSHIP'.           
                                                                                
      *----------------------------------------------------------------*        
      *   DETAIL RECORDS                                               *        
      *----------------------------------------------------------------*        
       01  L820-DTL2.                                                           
           05  SER-NO2                  PIC ZZZ9  VALUE ZEROES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  REGN2                    PIC X(08).                              
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  NRIC2                    PIC X(09).                              
           05  FILLER                   PIC X(08) VALUE SPACES.                 
           05  MS2                      PIC X(01).                              
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  RELAT2                   PIC X(02).                              
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       000-MAIN-PROCESS.                                                        
      *-------------------------------------------------------------            
             PERFORM 0100-OPEN-ROUTINE        THRU 0100-EXIT.                   
             PERFORM 0200-READ-BP13F740       THRU 0200-EXIT.                   
             PERFORM 0400-READ-BP13K820       THRU 0400-EXIT                    
                     UNTIL F740-EOF.                                            
             PERFORM 9999-CLOSE-ROUTINE       THRU 9999-EXIT.                   
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
       0100-OPEN-ROUTINE.                                                       
      *-------------------------------------------------------------            
           OPEN INPUT BP13F740                                                  
                      BP13K820                                                  
               OUTPUT P13F853A                                                  
                      P13L030A                                                  
                      P13L030B                                                  
                      P13L030C.                                                 
                                                                                
           IF K820-STATUS NOT = ZEROS AND '97'                                  
              DISPLAY ' ERROR OPENING BP13K820  FILE, STATUS '                  
                                                      K820-STATUS               
              MOVE K820-STATUS              TO   RETURN-CODE                    
              PERFORM 9999-CLOSE-ROUTINE    THRU 9999-EXIT.                     
                                                                                
              MOVE  60                      TO WS-LINE-CNT WS-LINE-CNT1         
                                                           WS-LINE-CNT2.        
              MOVE FUNCTION CURRENT-DATE    TO WS-CUR-DATE.                     
                                                                                
       0100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       0200-READ-BP13F740.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13F740                                                        
                AT END  MOVE 'Y' TO F740-EOF-IND                                
                GO TO 0200-EXIT.                                                
                                                                                
                MOVE F740-NUM-REGN TO WS-F740-REGN                              
                ADD 1              TO WS-NO-READ-F740.                          
                                                                                
       0200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       0400-READ-BP13K820.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES TO WS-TABLE WS-TABLE2.                                   
           MOVE SPACES                   TO    K820-KEY-FLD                     
           MOVE WS-F740-REGN             TO    K820-KEY-FLD.                    
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           EVALUATE K820-STATUS                                                 
           WHEN ZEROS                                                           
              PERFORM 0600-READNEXT-BP13K820 THRU 0600-EXIT                     
              PERFORM 0650-STORE-NRIC THRU 0650-EXIT                            
                UNTIL (K820-NUM-REGN NOT = F740-NUM-REGN) OR                    
                       K820-EOF                                                 
                 PERFORM 675-CHECK-MS-COUNT THRU 675-EXIT                       
                 INITIALIZE WS-MS-COUNT                                         
           WHEN 23                                                              
              DISPLAY 'BP13K820 RECORD NOT FOUND, KEY IS ' K820-KEY-FLD         
           WHEN OTHER                                                           
              DISPLAY 'BP13K820 START ERROR, STATUS IS ' K820-STATUS            
              DISPLAY 'RECORD KEY IS ' K820-KEY-FLD                             
           END-EVALUATE.                                                        
             PERFORM 0200-READ-BP13F740       THRU 0200-EXIT.                   
                                                                                
       0400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       0600-READNEXT-BP13K820.                                                  
      *-------------------------------------------------------------            
           READ BP13K820 NEXT RECORD AT END                                     
                MOVE 'Y' TO K820-EOF-IND.                                       
           ADD 1                     TO WS-NO-READ-K820.                        
                                                                                
       0600-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       0650-STORE-NRIC.                                                         
                                                                                
              IF K820-NUM-REGN = F740-NUM-REGN                                  
                                                                                
                 IF (K820-NUM-RELATIONSHIP = '01' OR '02' OR '12' OR            
                                            '21' OR '22' OR '31' OR             
                                            '32' OR '38' OR '42' OR             
                                            '44') OR                            
                                                                                
                   ((K820-NUM-RELATIONSHIP = '41' OR '39') AND                  
                    (K820-NUM-MARITAL-STATUS NOT = '1'))                        
                    MOVE K820-NUM-REGN        TO F853A-NUM-REGN                 
                    MOVE K820-NUM-NRIC        TO F853A-NUM-NRIC                 
                    MOVE K820-NME-OCCP        TO F853A-NME-OCCP                 
                    EVALUATE K820-NUM-MARITAL-STATUS                            
                    WHEN 1                                                      
                         MOVE 'S'  TO F853A-NUM-OCCP-MT                         
                    WHEN 2                                                      
                         MOVE 'M'  TO F853A-NUM-OCCP-MT                         
                    WHEN 3                                                      
                         MOVE 'W'  TO F853A-NUM-OCCP-MT                         
                    WHEN 4                                                      
                         MOVE 'D'  TO F853A-NUM-OCCP-MT                         
                    WHEN 5                                                      
                         MOVE 'P'  TO F853A-NUM-OCCP-MT                         
                    WHEN OTHER                                                  
                         MOVE ' '  TO F853A-NUM-OCCP-MT                         
                    END-EVALUATE                                                
                    MOVE K820-NUM-NRIC-SPOUSE TO F853A-NUM-NRIC-SPOUSE          
                    MOVE K820-NME-SPOUSE      TO F853A-NME-SPOUSE               
                    MOVE F740-CDE-NT1         TO F853A-NUM-NEW-TOWN             
                    MOVE F740-CDE-FLAT-TYPE   TO F853A-NUM-FLAT-TYPE            
                    MOVE F740-DTE-BALLOT      TO F853A-DTE-BALLOT               
                    MOVE K820-DTE-UPDATE      TO F853A-DTE-UPDATE               
                    MOVE K820-NUM-USERID      TO F853A-NUM-USERID               
                    WRITE P13F853A-REC                                          
                    ADD  1                       TO   WS-F853A-WRITE            
                    ADD  1                       TO   WS-MS-COUNT               
                    MOVE K820-NUM-REGN           TO                             
                                         NUM-REGN(WS-MS-COUNT)                  
                    MOVE K820-NUM-NRIC           TO                             
                                         NUM-NRIC(WS-MS-COUNT)                  
                    MOVE K820-NUM-MARITAL-STATUS TO                             
                                         NUM-MARITAL-STATUS(WS-MS-COUNT)        
                    MOVE K820-NUM-RELATIONSHIP   TO                             
                                         NUM-RELATIONSHIP(WS-MS-COUNT)          
                                                                                
                 ELSE                                                           
                    ADD 1                        TO WS-CNT                      
                    MOVE K820-NUM-REGN           TO                             
                                         TBL-NUM-REGN(WS-CNT)                   
                    MOVE K820-NUM-NRIC           TO                             
                                         TBL-NUM-NRIC(WS-CNT)                   
                    MOVE K820-NUM-MARITAL-STATUS TO                             
                                     TBL-NUM-MARITAL-STATUS(WS-CNT)             
                    MOVE K820-NUM-RELATIONSHIP   TO                             
                                     TBL-NUM-RELATIONSHIP(WS-CNT)               
                   DISPLAY 'KEY ' K820-KEY-FLD                                  
                     ' ST= ' K820-NUM-MARITAL-STATUS                            
                     ' REL= ' K820-NUM-RELATIONSHIP                             
                 END-IF                                                         
              END-IF.                                                           
                                                                                
              PERFORM 0600-READNEXT-BP13K820 THRU 0600-EXIT.                    
                                                                                
       0650-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       675-CHECK-MS-COUNT.                                                      
      ******************************************************************        
                                                                                
           EVALUATE TRUE                                                        
               WHEN WS-MS-COUNT = 0                                             
                    PERFORM 690-PRINT-P13L030C THRU 690-EXIT                    
               WHEN WS-MS-COUNT = 2                                             
                    PERFORM 680-PRINT-P13L030A THRU 680-EXIT                    
               WHEN OTHER                                                       
                    PERFORM 685-PRINT-P13L030B THRU 685-EXIT                    
               END-EVALUATE.                                                    
                                                                                
       675-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       690-PRINT-P13L030C.                                                      
      ******************************************************************        
           PERFORM 0780-PRINT-REPORT  THRU 0780-EXIT.                           
           PERFORM 0880-PRINT-DETL VARYING WS-COUNT2 FROM 1 BY 1                
                   UNTIL WS-COUNT2 > WS-CNT.                                    
                                                                                
       690-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       680-PRINT-P13L030A.                                                      
      ******************************************************************        
           PERFORM 0700-PRINT-REPORT  THRU 0700-EXIT.                           
           PERFORM 0800-PRINT-DETL VARYING WS-COUNT FROM 1 BY 1                 
                   UNTIL WS-COUNT > WS-MS-COUNT.                                
                                                                                
       680-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       685-PRINT-P13L030B.                                                      
      ******************************************************************        
                                                                                
           PERFORM 0750-PRINT-REPORT  THRU 0750-EXIT.                           
           PERFORM 0850-PRINT-DETL VARYING WS-COUNT1 FROM 1 BY 1                
                   UNTIL WS-COUNT1 > WS-MS-COUNT.                               
                                                                                
       685-EXIT.                                                                
           EXIT.                                                                
                                                                                
       0700-PRINT-REPORT.                                                       
      *-------------------------------------------------------------            
           IF WS-LINE-CNT > 58                                                  
              PERFORM 0725-PRINT-HEAD  THRU 0725-EXIT                           
           END-IF.                                                              
                                                                                
              ADD  1                   TO   WS-SER-NO.                          
              MOVE     WS-SER-NO       TO   SER-NO.                             
                                                                                
       0700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       0725-PRINT-HEAD.                                                         
               MOVE  ZEROES            TO   WS-LINE-CNT.                        
               ADD    1                TO   WS-PAGE-CNT.                        
               MOVE   WS-PAGE-CNT      TO   L820-PAGE.                          
               STRING WS-CUR-DATE(7:2) '/' WS-CUR-DATE(5:2) '/'                 
               WS-CUR-DATE(1:4) DELIMITED BY SIZE INTO L820-DATE.               
                                                                                
               WRITE P13L030A-REC      FROM L820-HDG1 AFTER PAGE.               
               WRITE P13L030A-REC      FROM L820-HDG2.                          
               WRITE P13L030A-REC      FROM L820-HDG3.                          
               WRITE P13L030A-REC      FROM L820-HDG4.                          
               WRITE P13L030A-REC      FROM L820-HDG3.                          
               MOVE  SPACES            TO   P13L030A-REC.                       
               WRITE  P13L030A-REC.                                             
               ADD    6                TO     WS-LINE-CNT.                      
                                                                                
       0725-EXIT.                                                               
           EXIT.                                                                
                                                                                
       0750-PRINT-REPORT.                                                       
      *-------------------------------------------------------------            
           IF WS-LINE-CNT1 > 58                                                 
              PERFORM 0775-PRINT-HEAD  THRU 0775-EXIT                           
           END-IF.                                                              
                                                                                
              ADD  1                   TO   WS-SER-NO1.                         
              MOVE     WS-SER-NO1      TO   SER-NO1.                            
                                                                                
       0750-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       0775-PRINT-HEAD.                                                         
               MOVE  ZEROES            TO   WS-LINE-CNT1.                       
               ADD    1                TO   WS-PAGE-CNT1.                       
               MOVE   WS-PAGE-CNT1     TO   L820-PAGE1.                         
               STRING WS-CUR-DATE(7:2) '/' WS-CUR-DATE(5:2) '/'                 
               WS-CUR-DATE(1:4) DELIMITED BY SIZE INTO L820-DATE1.              
                                                                                
               WRITE P13L030B-REC      FROM L820B-HDG1 AFTER PAGE.              
               WRITE P13L030B-REC      FROM L820B-HDG2.                         
               WRITE P13L030B-REC      FROM L820B-HDG3.                         
               WRITE P13L030B-REC      FROM L820B-HDG4.                         
               WRITE P13L030B-REC      FROM L820B-HDG3.                         
               MOVE  SPACES            TO   P13L030B-REC.                       
               WRITE  P13L030B-REC.                                             
               ADD    6                TO     WS-LINE-CNT1.                     
                                                                                
       0775-EXIT.                                                               
           EXIT.                                                                
                                                                                
       0780-PRINT-REPORT.                                                       
      *-------------------------------------------------------------            
           IF WS-LINE-CNT2 > 58                                                 
              PERFORM 0790-PRINT-HEAD  THRU 0790-EXIT                           
           END-IF.                                                              
                                                                                
              ADD  1                   TO   WS-SER-NO2.                         
              MOVE     WS-SER-NO2      TO   SER-NO2.                            
                                                                                
       0780-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       0790-PRINT-HEAD.                                                         
               MOVE  ZEROES            TO   WS-LINE-CNT2.                       
               ADD    1                TO   WS-PAGE-CNT2.                       
               MOVE   WS-PAGE-CNT2     TO   L820-PAGE2.                         
               STRING WS-CUR-DATE(7:2) '/' WS-CUR-DATE(5:2) '/'                 
               WS-CUR-DATE(1:4) DELIMITED BY SIZE INTO L820-DATE2.              
                                                                                
               WRITE P13L030C-REC      FROM L820C-HDG1 AFTER PAGE.              
               WRITE P13L030C-REC      FROM L820C-HDG2.                         
               WRITE P13L030C-REC      FROM L820C-HDG3.                         
               WRITE P13L030C-REC      FROM L820C-HDG4.                         
               WRITE P13L030C-REC      FROM L820C-HDG3.                         
               MOVE  SPACES            TO   P13L030C-REC.                       
               WRITE  P13L030C-REC.                                             
               ADD    6                TO     WS-LINE-CNT2.                     
                                                                                
       0790-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       0800-PRINT-DETL.                                                         
               MOVE NUM-REGN(WS-COUNT)              TO REGN.                    
               MOVE NUM-NRIC(WS-COUNT)              TO NRIC.                    
               MOVE NUM-MARITAL-STATUS(WS-COUNT)    TO MS.                      
               MOVE NUM-RELATIONSHIP(WS-COUNT)      TO RELAT.                   
                                                                                
               WRITE P13L030A-REC              FROM L820-DTL.                   
               MOVE   SPACES                   TO   P13L030A-REC                
                                                    L820-DTL.                   
               WRITE  P13L030A-REC.                                             
      *        MOVE SPACES TO SER-NO.                                           
               ADD    2                        TO     WS-LINE-CNT.              
       0800-EXIT.                                                               
           EXIT.                                                                
                                                                                
       0850-PRINT-DETL.                                                         
               MOVE NUM-REGN(WS-COUNT1)              TO REGN1.                  
               MOVE NUM-NRIC(WS-COUNT1)              TO NRIC1.                  
               MOVE NUM-MARITAL-STATUS(WS-COUNT1)    TO MS1.                    
               MOVE NUM-RELATIONSHIP(WS-COUNT1)      TO RELAT1.                 
                                                                                
               WRITE P13L030B-REC              FROM L820-DTL1.                  
               MOVE   SPACES                   TO   P13L030B-REC                
                                                    L820-DTL1.                  
               WRITE  P13L030B-REC.                                             
      *        MOVE SPACES TO SER-NO1.                                          
                                                                                
               ADD    2                        TO     WS-LINE-CNT1.             
       0850-EXIT.                                                               
           EXIT.                                                                
                                                                                
       0880-PRINT-DETL.                                                         
            IF TBL-NUM-REGN(WS-COUNT2) = SPACES                                 
                CONTINUE                                                        
            ELSE                                                                
               MOVE TBL-NUM-REGN(WS-COUNT2)              TO REGN2               
               MOVE TBL-NUM-NRIC(WS-COUNT2)              TO NRIC2               
               MOVE TBL-NUM-MARITAL-STATUS(WS-COUNT2)    TO MS2                 
               MOVE TBL-NUM-RELATIONSHIP(WS-COUNT2)      TO RELAT2              
                                                                                
               WRITE P13L030C-REC              FROM L820-DTL2                   
               MOVE   SPACES                   TO   P13L030C-REC                
                                                    L820-DTL2                   
               WRITE  P13L030C-REC                                              
               ADD    2                        TO     WS-LINE-CNT2              
             END-IF.                                                            
       0880-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       9999-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
           CLOSE BP13F740                                                       
                 BP13K820                                                       
                 P13F853A                                                       
                 P13L030A                                                       
                 P13L030B                                                       
                 P13L030C.                                                      
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY ' ERROR CLOSING BP13K820  FILE, STATUS '                  
              K820-STATUS.                                                      
                                                                                
           DISPLAY ' ** BP13CC030   **'.                                        
           DISPLAY '1) NO.OF REC READ FROM F740    = ' WS-NO-READ-F740.         
           DISPLAY '2) NO.OF REC READ FROM K820    = ' WS-NO-READ-K820.         
           DISPLAY '3) NO.OF CASES OUTPUT          = ' WS-F853A-WRITE.          
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
