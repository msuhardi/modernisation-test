*===============================================================                
*                      PROGRAM PROFILE                                          
*===============================================================                
*===============================================================                
* APPLICATION        : BP13                                                     
* APPLICATION NAME   : INFORMATION CENTRE DATABASE PHASE 2                      
* PROGRAM ID         : BP13S001                                                 
* LANGUAGE           : SAS                                                      
* DEVT PROJ REQ NO   : N950034                                                  
*                                                                               
* AUTHOR (PROFILE)   : LDW1             DATE : 06.09.96                         
* MAN-DAYS ESTIMATED : 2                                                        
*                                                                               
* PROGRAMMER         : DAVID            START DATE : 06.09.96                   
* MAN-DAYS ACTUAL    :                  END DATE   : 08.09.96                   
*                                                                               
*----------------------------------------------------------------               
* PURPOSE OF PROGRAM :                                                          
* ------------------                                                            
*                                                                               
*    THIS PROGRAM EXTRACTS SALES APPLICATION DATA AND LOAD INTO                 
*    BP13FWA1 ON THE VERY FIRST TIME.                                           
*                                                                               
*----------------------------------------------------------------               
* MODIFICATION LOG                                                              
* ----------------                                                              
*  MODIFY   DATE    CHGE REQ  DESCRIPTION OF CHANGE                             
*  ------   ----    --------  ---------------------                             
* LSB1      970110  BP130176 - NEW PGM                                          
* CLT1      980826  BP130418 - F800 : DTE-BALLOT FROM 4 TO 6                    
*                              K110 : DTE-KEY-ISSUED FROM 6 TO 8                
* YCH2      030225  BP132257 - CHG IN DB2 SELECT STATEMENT                      
* BA3       070919  BP133145 - INCLUDE REGION FROM F510                         
*                            - INCLUDE THE FF FLDS FROM K800:                   
*                                 DTE-BALLOT, NUM-ALLO-CAT,                     
*                                 AMT-CA-INCOME, NUM-LOAN-TAG,                  
*                                 NUM-AHG                                       
*===============================================================                
*                     RELATED DOCUMENTS                                         
*===============================================================                
* SCREEN LAYOUT   : NIL                                                         
* REPORT LAYOUT   : NIL                                                         
*                                                                               
* VIEW STRUCTURE  : NIL                                                         
*                                                                               
* FILE LAYOUT     : FI06.BATCH.COPYCOB(BP13FWA1)                                
*                                                                               
* DATA DEFINITION : NIL                                                         
*                                                                               
* PROCESSING RULE : NIL                                                         
*                                                                               
* PHYSICAL FLOW   : NIL                                                         
*                                                                               
* MESSAGE FILE    : NIL                                                         
*                                                                               
* SUBROUTINE USED : NIL                                                         
*                                                                               
*===============================================================                
OPTIONS SORTPGM=BEST;                                                           
                                                                                
PROC FORMAT;                                                                    
     VALUE $RGION "AMK" = "NE"                                                  
                  "BB " = "W "                                                  
                  "BD " = "E "                                                  
                  "BH " = "C "                                                  
                  "BM " = "C "                                                  
                  "BP " = "W "                                                  
                  "BT " = "C "                                                  
                  "CCK" = "W "                                                  
                  "CL " = "W "                                                  
                  "CT " = "C "                                                  
                  "GL " = "C "                                                  
                  "HG " = "NE"                                                  
                  "JE " = "W "                                                  
                  "JW " = "W "                                                  
                  "KWN" = "C "                                                  
                  "MP " = "C "                                                  
                  "PG " = "NE"                                                  
                  "PRC" = "E "                                                  
                  "QT " = "C "                                                  
                  "SB " = "N "                                                  
                  "SK " = "NE"                                                  
                  "SGN" = "NE"                                                  
                  "TAP" = "E "                                                  
                  "TP " = "C "                                                  
                  "WL " = "N "                                                  
                  "YS " = "N "                                                  
                 OTHER = "  ";                                                  
                                                                                
*-------------------------------------------------------------*                 
*  READ IN CURRENT & HISTORY SALES APPLICATION DATA APPENDED  *                 
*  TOGETHER WITH THE EXCEPTION OF REGISTRATION NUMBER STARTING*                 
*  WITH '9', SORTED ON REGISTRATION NUMBER                    *                 
*                            (ALREADY DONE THROUGH JCL)       *                 
*                                                             *                 
*  KEEP RECORDS WITH NO CANCELLATION DTE OR ITS               *                 
*  CANCELLATION DTE IS IN CURRENT MONTH                       *                 
*-------------------------------------------------------------*;                
                                                                                
DATA F800DATA;                                                                  
     INFILE F800;                                                               
     INPUT @1   NUM_STAT             $CHAR1.                                    
           @2   NUM_REGN             $CHAR8.                                    
           @10  DTE_UPDA             $CHAR8.                                    
           @18  DTE_REGN             $CHAR8.                                    
           @26  NUM_FLAT             $CHAR2.                                    
           @28  NUM_EXEC             $CHAR1.                                    
           @29  NUM_ZONE             $CHAR2.                                    
           @31  NUM_TOWN             $CHAR3.                                    
           @34  NUM_IDPS             $CHAR3.                                    
           @37  NUM_ALLS             $CHAR3.                                    
           @40  NUM_ELIG             $CHAR3.                                    
           @43  QTY_JT_B             $CHAR1.                                    
           @44  NUM_JTBM             $CHAR1.                                    
           @45  NUM_JTBR             $CHAR8.                                    
           @53  NUM_CAT              1.                                         
           @54  AMT_HSEI             5.                                         
           @59  NUM_JTAP             1.                                         
           @60  NRIC1                $CHAR9.                                    
           @69  NRIC2                $CHAR9.                                    
           @78  NRIC3                $CHAR9.                                    
           @87  NRIC4                $CHAR9.                                    
           @96  SCH_ACC              $CHAR11.                                   
           @107 DTECANC              $CHAR8.                                    
           @107 DTE_CANC             $CHAR6.                                    
           @115 NUM_CANR             $CHAR2.                                    
           @117 NUM_PRFT             $CHAR2.                                    
           @119 NUM_PRES             $CHAR3.                                    
           @122 NUM_PPO              $CHAR1.                                    
           @123 RES_SCHE             $CHAR1.                                    
           @124 CUR_REGN             $CHAR8.                                    
           @132 NUM_REOP             $CHAR1.                                    
           @133 AMT_CD               ZD9.2                                      
           @142 DTE_RAIS             $CHAR8.                                    
           @150 DTE_BALT             $CHAR6.                                    
           @156 NUM_HOUS             $CHAR1.                                    
           @157 SHORTLIS             $CHAR5.                                    
           @162 TME_QUEU             $CHAR2.                                    
           @165 DTE_BALLOT           $CHAR6.                                    
           @171 NUM_ALLO_CAT         $CHAR3.                                    
           @174 AMT_CA_INCOME        $CHAR5.                                    
           @179 NUM_LOAN_TAG         $CHAR1.                                    
           @180 NUM_AHG              $CHAR3.;                                   
                                                                                
                                                                                
                                                                                
*-------------------------------------------------------------*                 
*  DELETE 3 CANCELLED CASES THAT DID NOT HAVE SCHEME ACCOUNT  *                 
*  IN FLAT INVENTORY                                          *                 
*-------------------------------------------------------------*;                
                                                                                
     CURRENT = PUT((TODAY() - 5 ),YYMMN6.);                                     
     IF  (DTE_CANC  = '      ') OR                                              
         (DTE_CANC  = '000000') OR                                              
         (DTE_CANC  = '999999') OR                                              
         (DTE_CANC  = CURRENT);                                                 
                                                                                
*------------------------------------------------------------*                  
*   TRANSFORMATION ON FLAT TYPE                              *                  
*------------------------------------------------------------*;                 
     NUM_FLT = LEFT(NUM_FLAT);                                                  
     IF (  SUBSTR(NUM_FLT,2,1) NE 'S' AND                                       
           SUBSTR(NUM_FLT,2,1) NE 'D'      )                                    
     OR ( (SUBSTR(NUM_FLT,1,1)='G') OR                                          
          (SUBSTR(NUM_FLT,1,1)='H')     )                                       
     THEN  SUBSTR(NUM_FLT,2,1)=' ';                                             
     IF SUBSTR(NUM_FLT,1,1) NOT IN                                              
        ('1','2','3','4','5','E','G','H')                                       
     THEN NUM_FLT = '* ';                                                       
                                                                                
*------------------------------------------------------------*                  
*   TRANSFORMATION ON PRESENT FLAT TYPE                      *                  
*------------------------------------------------------------*;                 
     NUM_PRF = LEFT(NUM_PRFT);                                                  
     IF (  SUBSTR(NUM_PRF,2,1) NE 'S' AND                                       
           SUBSTR(NUM_PRF,2,1) NE 'D'      )                                    
     OR ( (SUBSTR(NUM_PRF,1,1)='G') OR                                          
          (SUBSTR(NUM_PRF,1,1)='H')     )                                       
     THEN  SUBSTR(NUM_PRF,2,1)=' ';                                             
     IF SUBSTR(NUM_PRF,1,1) NOT IN                                              
        ('1','2','3','4','5','E','G','H')                                       
     THEN NUM_PRF = '* ';                                                       
                                                                                
PROC SORT DATA=F800DATA;                                                        
    BY SCH_ACC ;                                                                
                                                                                
*-------------------------------------------------------------*                 
*  READ IN CURRENT & HISTORY FLAT INVENTORY DATA APPENDED     *                 
*  TOGETHER WITH THE EXCEPTION OF REGISTRATION NUMBER         *                 
*  BLANK OR EMPTY OR 00000000 SORTED ON REGISTRATION NUMBER   *                 
*                            (ALREADY DONE THROUGH JCL)       *                 
*-------------------------------------------------------------*;                
                                                                                
DATA F110DATA;                                                                  
     INFILE F110;                                                               
     INPUT @9   KI_DATE       $CHAR8.                                           
           @9   KEYIDATE      $CHAR6.                                           
           @17  SCH_ACC       $CHAR11.                                          
           @28  ENCBK         $CHAR16.;                                         
                                                                                
*-------------------------------------------------------------*                 
*  GET ESTATE, NEI, CON, BLK                                  *                 
*-------------------------------------------------------------*;                
DATA F100DATA;                                                                  
     INFILE F100;                                                               
     INPUT @1   ENCBK         $CHAR16.                                          
           @17  DTE_PACD      $CHAR8.;                                          
                                                                                
PROC SORT DATA=F110DATA;                                                        
    BY ENCBK;                                                                   
                                                                                
*-------------------------------------------------------------*                 
*  JOIN EST/NEI/CON/BLK                                       *                 
*-------------------------------------------------------------*;                
DATA F110PACD;                                                                  
     MERGE F110DATA(IN=A) F100DATA(IN=B);                                       
     BY ENCBK;                                                                  
     IF A;                                                                      
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING PROBABLE COMPLETION DATE                        *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F110PACD;                                                        
     BY SCH_ACC;                                                                
                                                                                
DATA F110DATE;                                                                  
     SET F110PACD;                                                              
     BY SCH_ACC;                                                                
                                                                                
*-------------------------------------------------------------*                 
*  JOIN SALES APPLICATION DATA WITH FLAT INVENTORY DATA       *                 
*-------------------------------------------------------------*;                
DATA F800DATA;                                                                  
     MERGE F800DATA(IN=A) F110DATE(IN=B);                                       
     BY SCH_ACC;                                                                
     IF A;                                                                      
     IF KEYIDATE <= ' '                                                         
       THEN KEYIDATE = '000000';                                                
                                                                                
*-------------------------------------------------------------*                 
*  KEEP RECORDS WITH NO KEY ISSUE DTE OR ITS                  *                 
*  KEY ISSUE DTE IS IN CURRENT MONTH                          *                 
*-------------------------------------------------------------*;                
     CURRENT = PUT((TODAY() - 5 ),YYMMN6.);                                     
     IF (KEYIDATE = '      ') OR                                                
        (KEYIDATE = '000000') OR                                                
        (KEYIDATE = '999999') OR                                                
        (KEYIDATE = CURRENT);                                                   
                                                                                
DATA F410DATA;                                                                  
     INFILE F410;                                                               
     INPUT @1   NUM_REGN         $CHAR8.                                        
           @9   AMT_LOAN         ZD9.2                                          
           @18  AMT_CD_CASH      ZD9.2                                          
           @27  AMT_CD_CPF1      ZD9.2                                          
           @36  AMT_CD_CPF2      ZD9.2                                          
           @45  AMT_CD_CPF3      ZD9.2                                          
           @54  AMT_CD_CPF4      ZD9.2                                          
           @63  AMT_MTHLY_CASH   ZD7.2                                          
           @70  AMT_MTHLY_CPF1   ZD7.2                                          
           @77  AMT_MTHLY_CPF2   ZD7.2                                          
           @84  AMT_MTHLY_CPF3   ZD7.2                                          
           @91  AMT_MTHLY_CPF4   ZD7.2                                          
           @98  NUM_REPAY_PERIOD $CHAR2.                                        
           @100 AMT_ICP_CASH     ZD9.2                                          
           @109 AMT_ICP_CPF1     ZD9.2                                          
           @118 AMT_ICP_CPF2     ZD9.2                                          
           @127 AMT_ICP_CPF3     ZD9.2                                          
           @136 AMT_ICP_CPF4     ZD9.2;                                         
                                                                                
TOT_CD_CPF_AMT = AMT_CD_CPF1 + AMT_CD_CPF2 +                                    
                 AMT_CD_CPF3 + AMT_CD_CPF4;                                     
TOT_AMT_MTHLY_CPF = AMT_MTHLY_CPF1 + AMT_MTHLY_CPF2 +                           
                    AMT_MTHLY_CPF3 + AMT_MTHLY_CPF4;                            
ICP_CPF_AMOUNT = AMT_ICP_CPF1 + AMT_ICP_CPF2 +                                  
                 AMT_ICP_CPF3 + AMT_ICP_CPF4;                                   
                                                                                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_REGN;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE F800DATA(IN=A) F410DATA(IN=B);                                       
     BY NUM_REGN;                                                               
     IF A;                                                                      
                                                                                
*------------------------------------------------------------*                  
*  EXTRACTING CODE TABLE DESCRIPTION                         *                  
*------------------------------------------------------------*;                 
DATA COD01 COD04 COD05 COD06 COD08 COD34A COD36 COD45;                          
     INFILE CODT;                                                               
     INPUT @1   S_NO                $2.                                         
           @3   CODE                $CHAR3.                                     
           @6   DESCRIP             $CHAR20.;                                   
     IF (S_NO = '01') OR (S_NO = '04') OR (S_NO = '05') OR                      
        (S_NO = '06') OR (S_NO = '08') OR (S_NO = '34') OR                      
        (S_NO = '36') OR (S_NO = '45');                                         
                                                                                
*------------------------------------------------------------*                  
*  SERIAL NO 01 BELONGS TO NUM-STATUS                        *                  
*------------------------------------------------------------*;                 
     IF (S_NO='01') THEN                                                        
     DO;                                                                        
        NUM_STAT=SUBSTR(CODE,1,1);                                              
        OUTPUT COD01;                                                           
     END;                                                                       
*------------------------------------------------------------*                  
*  SERIAL NO 04 BELONGS TO NUM-IDP-SCHEME                    *                  
*------------------------------------------------------------*;                 
     ELSE IF (S_NO='04') THEN                                                   
          DO;                                                                   
             NUM_IDPS=CODE;                                                     
             OUTPUT COD04;                                                      
          END;                                                                  
*------------------------------------------------------------*                  
*  SERIAL NO 05 BELONGS TO NUM-ALLO-SCHEME                   *                  
*------------------------------------------------------------*;                 
     ELSE IF (S_NO='05') THEN                                                   
          DO;                                                                   
             NUM_ALLS=CODE;                                                     
             OUTPUT COD05;                                                      
          END;                                                                  
*------------------------------------------------------------*                  
*  SERIAL NO 06 BELONGS TO NUM-ELIG-SCHEME                   *                  
*------------------------------------------------------------*;                 
     ELSE IF (S_NO='06') THEN                                                   
          DO;                                                                   
             NUM_ELIG=CODE;                                                     
             OUTPUT COD06;                                                      
          END;                                                                  
*------------------------------------------------------------*                  
*  SERIAL NO 08 BELONGS TO NUM-JT-BALLOT-MTF                 *                  
*------------------------------------------------------------*;                 
     ELSE IF (S_NO='08') THEN                                                   
          DO;                                                                   
             NUM_JTBM=SUBSTR(CODE,1,1);                                         
             OUTPUT COD08;                                                      
          END;                                                                  
*------------------------------------------------------------*                  
*  SERIAL NO 34 BELONGS TO NUM-FLAT-TYPE                     *                  
*------------------------------------------------------------*;                 
     ELSE IF (S_NO='34') THEN                                                   
          DO;                                                                   
             NUM_FLT=SUBSTR(CODE,1,2);                                          
             OUTPUT COD34A;                                                     
          END;                                                                  
*------------------------------------------------------------*                  
*  SERIAL NO 36 BELONGS TO NUM-CANCEL-REASON                 *                  
*------------------------------------------------------------*;                 
     ELSE IF (S_NO='36') THEN                                                   
          DO;                                                                   
             NUM_CANR=SUBSTR(CODE,1,2);                                         
             OUTPUT COD36;                                                      
          END;                                                                  
*------------------------------------------------------------*                  
*  SERIAL NO 45 BELONGS TO NUM-ZONE                          *                  
*------------------------------------------------------------*;                 
     ELSE IF (S_NO='45') THEN                                                   
          DO;                                                                   
             NUM_ZONE=SUBSTR(CODE,1,2);                                         
             OUTPUT COD45;                                                      
          END;                                                                  
*------------------------------------------------------------*                  
*  SERIAL NO 34 BELONGS TO NUM-PRESENT-FLAT-TYPE             *                  
*------------------------------------------------------------*;                 
DATA COD34B;                                                                    
     SET COD34A;                                                                
          NUM_PRF=NUM_FLT;                                                      
                                                                                
PROC SORT DATA=COD01;                                                           
     BY NUM_STAT;                                                               
                                                                                
PROC SORT DATA=COD04;                                                           
     BY NUM_IDPS;                                                               
                                                                                
PROC SORT DATA=COD05;                                                           
     BY NUM_ALLS;                                                               
                                                                                
PROC SORT DATA=COD06;                                                           
     BY NUM_ELIG;                                                               
                                                                                
PROC SORT DATA=COD08;                                                           
     BY NUM_JTBM;                                                               
                                                                                
PROC SORT DATA=COD34A;                                                          
     BY NUM_FLT;                                                                
                                                                                
PROC SORT DATA=COD34B;                                                          
     BY NUM_PRF;                                                                
                                                                                
PROC SORT DATA=COD36;                                                           
     BY NUM_CANR;                                                               
                                                                                
PROC SORT DATA=COD45;                                                           
     BY NUM_ZONE;                                                               
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_STATUS                                      *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_STAT;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE COD01(IN=A) F800DATA(IN=B);                                          
     BY NUM_STAT;                                                               
     IF B;                                                                      
     RENAME DESCRIP=NME_STAT;                                                   
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_IDP_SCHEME                                  *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_IDPS;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE COD04(IN=A) F800DATA(IN=B);                                          
     BY NUM_IDPS;                                                               
     IF B;                                                                      
     RENAME DESCRIP=NME_IDPS;                                                   
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_ALCTN_SCHEME                                *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_ALLS;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE COD05(IN=A) F800DATA(IN=B);                                          
     BY NUM_ALLS;                                                               
     IF B;                                                                      
     RENAME DESCRIP=NME_ALCT;                                                   
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_ELIGIBILITY_SCHEME                          *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_ELIG;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE COD06(IN=A) F800DATA(IN=B);                                          
     BY NUM_ELIG;                                                               
     IF B;                                                                      
     RENAME DESCRIP=NME_ELIG;                                                   
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_JT_BALLOT_MTF                               *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_JTBM;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE COD08(IN=A) F800DATA(IN=B);                                          
     BY NUM_JTBM;                                                               
     IF B;                                                                      
     RENAME DESCRIP=NME_JTBM;                                                   
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_FLAT_TYPE                                   *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_FLT;                                                                
                                                                                
DATA F800DATA;                                                                  
     MERGE COD34A(IN=A) F800DATA(IN=B);                                         
     BY NUM_FLT;                                                                
     IF B;                                                                      
     RENAME DESCRIP=NME_FLT;                                                    
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_PRESENT_FLAT_TYPE                           *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_PRF;                                                                
                                                                                
DATA F800DATA;                                                                  
     MERGE COD34B(IN=A) F800DATA(IN=B);                                         
     BY NUM_PRF;                                                                
     IF B;                                                                      
     RENAME DESCRIP=NME_PRF;                                                    
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_CANCEL_REASON                               *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_CANR;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE COD36(IN=A) F800DATA(IN=B);                                          
     BY NUM_CANR;                                                               
     IF B;                                                                      
     RENAME DESCRIP=NME_CANR;                                                   
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_ZONE                                        *                 
*-------------------------------------------------------------*;                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_ZONE;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE COD45(IN=A) F800DATA(IN=B);                                          
     BY NUM_ZONE;                                                               
     IF B;                                                                      
     RENAME DESCRIP=NME_ZONE;                                                   
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_TOWN                                        *                 
*-------------------------------------------------------------*;                
                                                                                
PROC SQL;                                                                       
     CONNECT TO DB2 (SSID=DSN);                                                 
        CREATE TABLE REGDIR AS                                                  
        (SELECT *                                                               
        FROM CONNECTION TO DB2                                                  
        (SELECT NUM_RGSTRN_BNDRY,                                               
                NME_RGSTRN_BNDRY                                                
        FROM    &QLF..RGSTRN_BNDRY)                                             
     AS DB2 ( NUM_TOWN,                                                         
              NME_TOWN ));                                                      
   DISCONNECT FROM DB2;                                                         
     %PUT &SQLXMSG;                                                             
     %PUT &SQLXRC;                                                              
                                                                                
PROC SORT DATA=REGDIR;                                                          
     BY NUM_TOWN;                                                               
                                                                                
DATA F800DATA;                                                                  
     SET F800DATA;                                                              
     IF NUM_TOWN='KWP' THEN  NUM_TOWN = 'KWN';                                  
                                                                                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_TOWN;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE REGDIR(IN=A) F800DATA(IN=B);                                         
     BY NUM_TOWN;                                                               
     IF B;                                                                      
                                                                                
*-------------------------------------------------------------*                 
*  EXTRACTING NME_PRES                                        *                 
*-------------------------------------------------------------*;                
DATA PRESDIR(KEEP=NUM_PRES NME_PRES);                                           
     SET REGDIR;                                                                
     RENAME NUM_TOWN = NUM_PRES;                                                
     RENAME NME_TOWN = NME_PRES;                                                
                                                                                
PROC SORT DATA=PRESDIR;                                                         
     BY NUM_PRES;                                                               
                                                                                
DATA F800DATA;                                                                  
     SET F800DATA;                                                              
     IF NUM_PRES='KWP' THEN  NUM_PRES = 'KWN';                                  
                                                                                
PROC SORT DATA=F800DATA;                                                        
     BY NUM_PRES;                                                               
                                                                                
DATA F800DATA;                                                                  
     MERGE PRESDIR(IN=A) F800DATA(IN=B);                                        
     BY NUM_PRES;                                                               
     IF B;                                                                      
                                                                                
*-------------------------------------------------------------*                 
*  TO OUTPUT TO BP13FWA1 FILE                                 *                 
*-------------------------------------------------------------*;                
                                                                                
 DATA _NULL_;                                                                   
      FILE OUT;                                                                 
      SET F800DATA;                                                             
       IF SCH_ACC = "           " THEN                                          
          DO;                                                                   
          NUM_TOWN = "   ";                                                     
          END;                                                                  
       PUT @1   NUM_REGN      $CHAR8.                                           
           @9   NUM_STAT      $CHAR1.                                           
           @10  NME_STAT      $CHAR25.                                          
           @35  DTE_REGN      $CHAR8.                                           
           @43  NUM_FLT       $CHAR2.                                           
           @45  NME_FLT       $CHAR25.                                          
           @70  NUM_EXEC      $CHAR1.                                           
           @71  NUM_ZONE      $CHAR2.                                           
           @73  NME_ZONE      $CHAR25.                                          
           @98  NUM_TOWN      $CHAR3.                                           
           @101 NME_TOWN      $CHAR30.                                          
           @131 NUM_IDPS      $CHAR3.                                           
           @134 NME_IDPS      $CHAR25.                                          
           @159 NUM_ALLS      $CHAR3.                                           
           @162 NME_ALCT      $CHAR40.                                          
           @202 QTY_JT_B      $CHAR1.                                           
           @203 NUM_JTBM      $CHAR1.                                           
           @204 NME_JTBM      $CHAR25.                                          
           @229 NUM_CAT       1.                                                
           @230 NUM_JTBR      $CHAR8.                                           
           @238 AMT_HSEI      5.                                                
           @243 NUM_JTAP      1.                                                
           @244 SCH_ACC       $CHAR11.                                          
           @255 DTECANC       $CHAR8.                                           
           @263 NUM_CANR      $CHAR2.                                           
           @265 NME_CANR      $CHAR25.                                          
           @290 NUM_PRES      $CHAR3.                                           
           @293 NME_PRES      $CHAR30.                                          
           @323 NUM_PPO       $CHAR1.                                           
           @324 RES_SCHE      $CHAR1.                                           
           @325 CUR_REGN      $CHAR8.                                           
           @333 AMT_CD        ZD9.2                                             
           @342 DTE_RAIS      $CHAR8.                                           
           @350 DTE_BALT      $CHAR6.                                           
           @356 NUM_HOUS      $CHAR1.                                           
           @357 SHORTLIS      $CHAR5.                                           
           @362 TME_QUEU      $CHAR2.                                           
           @364 DTE_UPDA      $CHAR8.                                           
           @372 NUM_REOP      $CHAR1.                                           
           @373 NUM_ELIG      $CHAR3.                                           
           @376 NME_ELIG      $CHAR40.                                          
           @416 NUM_PRF       $CHAR2.                                           
           @418 NME_PRF       $CHAR25.                                          
           @443 NRIC1         $CHAR9.                                           
           @452 NRIC2         $CHAR9.                                           
           @461 NRIC3         $CHAR9.                                           
           @470 NRIC4         $CHAR9.                                           
           @479 NUM_TOWN      $RGION.                                           
           @481 DTE_PACD      $CHAR8.                                           
           @489 NUM_ALLO_CAT  $CHAR3.                                           
           @492 AMT_CA_INCOME $CHAR5.                                           
           @497 NUM_LOAN_TAG  $CHAR1.                                           
           @498 AMT_LOAN      ZD9.2                                             
           @507 NUM_AHG       $CHAR3.                                           
           @510 AMT_CD_CASH   ZD9.2                                             
           @519 TOT_CD_CPF_AMT    ZD10.2                                        
           @529 AMT_ICP_CASH      ZD9.2                                         
           @538 ICP_CPF_AMOUNT    ZD10.2                                        
           @548 AMT_MTHLY_CASH    ZD7.2                                         
           @555 TOT_AMT_MTHLY_CPF ZD8.2                                         
           @563 NUM_REPAY_PERIOD  $CHAR2.;                                      
                                                                                
RETURN ;                                                                        
                                                                                
