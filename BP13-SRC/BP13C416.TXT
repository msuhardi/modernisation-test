      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C416.                                                 
      *AUTHOR.        TOH SHIOK KUAN.                                           
      *DATE-WRITTEN.  11/10/89.                                                 
                                                                                
      * ========================================================= *             
      * SYSTEM OF COMMITMENT  (BP13)                              *             
      * ========================================================= *             
      *    OBJECTIVE :                                            *             
      *      1. TO PRINT PAYMENT SCHEDULE FOR STAMPIMG OF         *             
      *         DEED OF ASSIGNMENT (BP13L416A)                    *             
      *         (FINAL PINK VOUCHER FOR TP AND SA/TP)             *             
      *                                                           *             
      *    I/O FILES :                                            *             
      *       INPUT  :  BP13F315 - TRANSACTION FILE (SEQ)         *             
      *                 BP13K410 - ACCUMSO FILE     (VSAM)        *             
      *      OUTPUT  :  BP13K625 - STAMP FEE MASTER (SEQ)         *             
      *                 AG07F225 - STAMPING FILE    (SEQ)         *             
      *                 BP13416A - STAMPING DOA FOR SOC FLAT      *             
      *                                                           *             
      *    FUNCTION :                                             *             
      *      1. BATCH PROGRAMMING IN COBOL                        *             
      *      2. PRINT LISTINGS OF PAYMENT SCHEDULE AND/OR         *             
      *         REFUND SCHEDULE DEPENDING ON F315-CDE-TRANS,      *             
      *         F315-CDE-SALES-TYPE AND K410-DTE-KEY-ISSUE        *             
      *                                                           *             
      * --------------------------------------------------------- *             
      * CHG REF  DATE   BY   DESCRIPTIONS                         *             
      * -------- ------ ---  ------------                         *             
      * C910262  910326 YPH  TO ADD 'DATE OF SALES ORDER' ON      *             
      *                      BP13L416A LISTING.                   *             
      * C910943  911201 TJF  CHG SPC TO BUC                       *             
      * SOCPH6   920415 RAZ  ADD BP13L416D LISTING                *             
      * SOC-PH8  930728 KPS  GET ADDR AND BUC FROM BP13F315 AND   *             
      *                      EXPAND REGN TO 8 CHARS               *             
      * C931147  940127 JEP  CATER FOR PAYMENT SYSTEM.            *             
      * C940876  940817 LJL  INCLUDE 'PAYMENT FOR LEASE/ MORTGAGE *             
      *                      STAMP FEES' TO NARRATION FIELD.      *             
      * BP130024 950910 EG   TO EXTRACT RECORD FOR PREMIUM CASES  *             
      *                      FOR PRINTING OF STAMPING OF          *             
      *                      SUPPLEMENTARY AGREEMENT(TYPE 10 ONLY)*             
      * BP130020 951010 SSS  EXCHANGE L416-HDG-1 WITH L416-HDG-2  *             
      *                      REPOSITION MAIN-HEADER TO ROW 1      *             
      * BP130037 951110 EG1  CATER FOR THE SEPERATE PRINTING OF   *             
      *                      SALES-TYPES:01-E;02-F;2B-G;03-H;3A-I *             
      * BP130181 960910 LJL  COLLECTION OF 15%, 20%, 25%,         *             
      *                         30% & 40% PREMIUM                 *             
      * BP130186 961021 SIA  TO WRITE TO BP13K630.                *             
      * BP130453 980303 SGK  INCLUDE BANK INFO & TO CATER FOR     *             
      *                      'SER' CASES                          *             
      * BP130418 980609 RHB  Y2K;FILE LENGTH                      *             
      * BP130565 981216 SRN  PRINT 3 SETS FOR EACH LISTING :      *             
      *                      FINANCE/STAMP OFFICE/SOURCE COPY     *             
      * BP130615 990320 LSB  Y2K INTEGRATED TESTING               *             
      * BP130696 990716 RAS  CREATE BP13K625 FOR E-STAMPING       *             
      * BP130790 000202 SCK  TO ADD IN IN-SOURCE DOCUMENTATION    *             
      * BP130806 030200 RAS  TO CONVERT NUM-LEASE-TERM FROM YR    *             
      *                      TO MONTHS                            *             
      * BP130821 030300 RAS  TO CATER FOR DUPLICATE RECORDS IN    *             
      *                      WRITING BP13K625 BY ADDING A FIELD   *             
      *                      CALLED NUM-DOC-CNT                   *             
      * BP130998 150501 CLT  CATER FOR SA FLAT SALES TYPE 13      *             
      * BP131036 140601 RAS  TO CATER FOR ALLOC CDES: SFC & SRC   *             
      * BP132037 161001 MCC  OFF BUDGET DISCOUNT 30%              *             
      *                      (UPDATE DUP SF AMT FROM 2 TO 1.4,    *             
      *                       TO UNDO, PERFORM REVERSE)           *             
      * BP132103 180202 CLT  AG07 8 DIGIT EXPANSION               *             
      * BP132185 300702 MALC REMOVE VOUCHER PRTNG FOR STAMP OFC   *             
      *                      MOVE DTE-KEY-ISSUE TO DOC-PREPARE    *             
      *                      REMOVE WRITING OF BP13K630           *             
      * BP132185 190802 CLT  TO CHANGE CALL OFFICER TO 62796839   *             
      *                      & CONTACT NO TO 64903783             *             
      * BP132270 301202 MALC CATER FOR STAMP-FEE DISC AND NO DISC *             
      * BP132485 040304 MJ16 TO INCLUDE CHECKING OF SERS TABLE    *             
      *                      TO INCLUDE 3 NEW ALLOC SCHEMES IN    *             
      *                      TABLE.('SFO','SRO','SJO')            *             
      * BP132707 130705 JF4  CATER FOR RP FLAT TP                 *             
      * BP132729 230905 JF4  CATER FOR EARMARKING OF STAMP REG FEES             
      * BP132729 251105 SSS2 CATER FOR PRINTING OF HEADER         *             
      * BP132878 020806 CLT1 CATER FOR 'RT' FLAT                  *             
      * BP132969 130207 MTSR MOVE SFTT CODE TO F220-TXT-INFO      *             
      * BP134218 160511 JB8  TO CATER FOR REMOVAL OF NOMINAL DUTIES             
      * BP135010 250713 JGO1 CHECK SUPP AMT FOR ADHOC CASES       *             
      * BP135096 250713 JGO1 UPDATE VOUCHER FROM 'SU' TO 'SS'     *             
      * BP135193 180314 JGO1 CHANGE F220 TO F225 OUTPUT           *             
      * BP135017 280414 JGO1 PASS F315-USERID TO F225 STAFF-ID    *             
      * BP135247 300414 JGO1 PASS F315-USERID IF ID NOT = BP13P001*             
      * BP135238 120614 JGO1 MOVE SPACES TO F225 HEADER           *             
      * BP135000 160714 JGO1 OVERWRITE STAFFID ES29416 TO 29418G  *             
      * BP135437 120814 JGO1 UPDATE VOUCHER INFO                  *             
      * BP135832 190515 JGO1 UPDATE VALUE PASSED TO F225 BANK     *             
      * BP135838 020715 ESA1 TO CATER FOR MODEL-DESIGN = '92'     *             
      * BP136159 080316 KSJ3 TO CATER FOR SALES TYPE 18           *             
      * BP138132 060120 KTM3 TO CATER FOR SALES TYPE 19           *             
      * BP138339 050820 KR13 UPDATE REPORT ID.                    *             
      * BP139164 040522 KR13 ENHANCE AGREEMENT STAMPING MODULE TO *             
      *                      VALIDATE POSTAL CODE                 *             
      * ========================================================= *             
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT B05K006   ASSIGN       TO B05K006                             
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K006-HDB-REF-SF                     
                            FILE STATUS  IS WS-K006-STATUS.                     
                                                                                
           SELECT BP13K410  ASSIGN       TO BP13K410                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K410-KEY-FLD                        
                            FILE STATUS  IS WS-K410-STATUS.                     
                                                                                
           SELECT BP13K625  ASSIGN       TO BP13K625                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K625-KEY-FLD                        
                            FILE STATUS  IS WS-K625-STATUS.                     
                                                                                
           SELECT BP13F315  ASSIGN       TO BP13F315.                           
           SELECT BP13F316  ASSIGN       TO BP13F316.                           
           SELECT AG07F225  ASSIGN       TO AG07F225.                           
                                                                                
           SELECT BP13416A  ASSIGN       TO BP13416A.                           
           SELECT BP13416D  ASSIGN       TO BP13416D.                           
           SELECT BP13416E  ASSIGN       TO BP13416E.                           
           SELECT BP13416G  ASSIGN       TO BP13416G.                           
           SELECT BP13416H  ASSIGN       TO BP13416H.                           
           SELECT BP13416I  ASSIGN       TO BP13416I.                           
           SELECT BP13416J  ASSIGN       TO BP13416J.                           
           SELECT BP13416K  ASSIGN       TO BP13416K.                           
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
      *============*                                                            
      * SFMAST  FILE                                                            
      *--------------                                                           
       FD   B05K006.                                                            
       COPY B05K006.                                                            
                                                                                
      * ACCUMSO FILE                                                            
      *--------------                                                           
       FD   BP13K410                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K410.                                                           
                                                                                
      * STAMP FEE MASTER FILE                                                   
      *--------------                                                           
       FD   BP13K625                                                            
            RECORD CONTAINS 500  CHARACTERS.                                    
       COPY BP13K625.                                                           
                                                                                
      *------------------                                                       
      * TRANSACTION FILE                                                        
      *------------------                                                       
       FD   BP13F315                                                            
            BLOCK  CONTAINS 0    RECORDS                                        
            RECORD CONTAINS 500  CHARACTERS                                     
            LABEL  RECORDS  ARE  STANDARD                                       
            RECORDING MODE  IS   F.                                             
       COPY BP13F315.                                                           
                                                                                
      *------------------                                                       
      * OUTPUT FILE FOR PRINTING OF SUPPLEMENTARY LIST.                         
      *------------------                                                       
       FD   BP13F316                                                            
            BLOCK  CONTAINS 0    RECORDS                                        
            RECORD CONTAINS 500  CHARACTERS                                     
            LABEL  RECORDS  ARE  STANDARD                                       
            RECORDING MODE  IS   F.                                             
                                                                                
       01   BP13F316-REC.                                                       
            05 FILLER            PIC X(468).                                    
            05 F316-VOUCHER-NO   PIC X(12).                                     
            05 F316-SERIAL-NO    PIC 9(04).                                     
            05 FILLER            PIC X(16).                                     
                                                                                
      *------------------                                                       
      * VOUCHER FILE                                                            
      *------------------                                                       
       FD   AG07F225                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 600 CHARACTERS.                                     
       COPY AG07F225.                                                           
                                                                                
      *---------------------------------------                                  
      * LISTING FOR STAMPING DOA FOR SOC FLAT                                   
      *---------------------------------------                                  
       FD   BP13416A                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416A-PRINT-REC          PIC X(132).                                
                                                                                
      *---------------------------------------                                  
      * AGREEMENT OF LEASE & DOA OF SOC FLAT                                    
      *---------------------------------------                                  
       FD   BP13416D                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416D-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13416E                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416E-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13416G                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416G-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13416H                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416H-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13416I                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416I-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13416J                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416J-PRINT-REC          PIC X(132).                                
                                                                                
       FD   BP13416K                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L416K-PRINT-REC          PIC X(132).                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
       COPY SERSCH.                                                             
                                                                                
       01 WS-SERS-VARIABLES.                                                    
           05 WS-ALLOC-SCH          PIC X(03).                                  
           05 WS-SCH-FND            PIC X(01).                                  
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE HEADING LINES                                   *             
      *-----------------------------------------------------------*             
       01  PRT-L416-HDG-1.                                                      
           05  L416-REPORT-ID       PIC X(10)  VALUE SPACES.                    
           05  FILLER               PIC X(08) VALUE '    HDB3'.                 
           05  FILLER               PIC X(27) VALUE SPACES.                     
           05  FILLER               PIC X(39) VALUE                             
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER               PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'DATE : '.                  
           05  L416-CURRENT-DATE    PIC X(10) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'PAGE : '.                  
           05  L416-PAGE            PIC ZZZZ9.                                  
                                                                                
       01  PRT-L416-HDG-2.                                                      
           05  FILLER               PIC X(30) VALUE                             
               'HOUSING AND DEVELOPMENT BOARD'.                                 
           05  FILLER               PIC X(20) VALUE SPACES.                     
           05  FILLER               PIC X(30) VALUE                             
               'P A Y M E N T    V O U C H E R'.                                
           05  FILLER               PIC X(25) VALUE SPACES.                     
           05  L416-COPY-NAME       PIC X(20) VALUE SPACES.                     
                                                                                
       01  PRT-L416-HDG-3.                                                      
           05  L416-REPORT-ID-DESC  PIC X(132).                                 
                                                                                
       01  PRT-L416-HDG-4.                                                      
           05  FILLER               PIC X(46) VALUE SPACES.                     
           05  FILLER               PIC X(85) VALUE ALL '-'.                    
                                                                                
       01  PRT-L416-HDG-5.                                                      
           05  FILLER               PIC X(46) VALUE                             
               'SALES UNIT (AGREEMENT TEAM)'.                                   
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(27) VALUE                             
               ' FOR FINANCE DEPARTMENT USE'.                                   
           05  FILLER               PIC X(21) VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE                             
               '¦  BATCH NO    : '.                                             
           05  L416-BATCH-NO        PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L416-HDG-6.                                                      
           05  FILLER               PIC X(46) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(48) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(34) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L416-HDG-7.                                                      
           05  FILLER               PIC X(46) VALUE 'SYSTEM CODE : 04'.         
           05  FILLER               PIC X(14) VALUE '¦ CHECKED BY :'.           
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE '¦  VOUCHER NO  :'.         
           05  L416-VOUCHER-NO      PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L416-HDG-8.                                                      
           05  FILLER               PIC X(46) VALUE                             
              'GL CODE     : 0000000104250'.                                    
           05  FILLER               PIC X(85) VALUE ALL '-'.                    
                                                                                
       01  PRT-L416-HDG-9.                                                      
           05  FILLER               PIC X(46) VALUE                             
              'DESCRIPTION : STAMP FEES'.                                       
                                                                                
       01  PRT-L416-HDG-10.                                                     
           05  FILLER               PIC X(53)   VALUE                           
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.            
           05  FILLER               PIC X(13)   VALUE  SPACES.                  
           05  FILLER               PIC X(20)   VALUE                           
              'BANK   : DBS        '.                                           
           05  FILLER               PIC X(11)   VALUE  SPACES.                  
           05  FILLER               PIC X(25)   VALUE                           
              'BANK CODE   : DBSSSGSGXXX'.                                      
                                                                                
       01  PRT-L416-HDG-10A.                                                    
           05  FILLER               PIC X(24)   VALUE                           
              'A/C NO      : 0010468600'.                                       
           05  FILLER               PIC X(42)   VALUE  SPACES.                  
                                                                                
       01  PRT-L416-HDG-11.                                                     
           05  FILLER               PIC X(11)   VALUE                           
               'REMITTANCE '.                                                   
           05  FILLER               PIC X(55)   VALUE                           
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.          
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L416A & BP13L416D SUB-HEADING LINES         *             
      *-----------------------------------------------------------*             
       01  PRT-L416-SUBHDG-1.                                                   
           05  FILLER               PIC X(69) VALUE SPACES.                     
           05  FILLER               PIC X(19) VALUE                             
               'DATE OF    MORTGAGE'.                                           
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'DUP'.                      
           05  L416-SUP-LEASE-DESC  PIC X(10) VALUE SPACES.                     
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'DUP'.                      
                                                                                
       01  PRT-L416-SUBHDG-2.                                                   
           05  FILLER               PIC X(4)  VALUE 'S/NO'.                     
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.               
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.                  
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.                    
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(25) VALUE                             
               'FLAT ADDRESS/STREET NAME'.                                      
           05  FILLER               PIC X(1)  VALUE SPACE.                      
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.                  
           05  FILLER               PIC X(9)  VALUE 'SALES ORD'.                
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.                
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(3)  VALUE 'DOA'.                      
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.                
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(2)  VALUE 'SA'.                       
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  L416-TAG-DESC        PIC X(3)  VALUE 'TAG'.                      
           05  FILLER               PIC X(6)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.                    
                                                                                
       01  PRT-L416-SUBHDG-3.                                                   
           05  FILLER               PIC X(4)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(25) VALUE ALL '-'.                    
           05  FILLER               PIC X(1)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE ALL '-'.                    
           05  FILLER               PIC X(1)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L416A & BP13L416D DETAIL LINES              *             
      *-----------------------------------------------------------*             
       01  L416-REC-DETAIL.                                                     
           05  L416-SERIAL-NO               PIC ZZZ9.                           
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L416-SCH-ACC                 PIC X(14) VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L416-REGN-NO                 PIC X(8)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L416-BLKNO                   PIC X(5)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L416-STREET                  PIC X(25) VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L416-FLATNO                  PIC X(7)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L416-SALE-DD                 PIC X(2)  VALUE SPACES.             
           05  L416-DASH1                   PIC X     VALUE SPACE.              
           05  L416-SALE-MM                 PIC X(2)  VALUE SPACES.             
           05  L416-DASH2                   PIC X     VALUE SPACE.              
           05  L416-SALE-CC                 PIC X(2)  VALUE SPACES.             
           05  L416-SALE-YY                 PIC X(2)  VALUE SPACES.             
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L416-MORT-SF                 PIC $$$,$$9.99.                     
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L416-DUP-DOA                 PIC $9.99.                          
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L416-SUP-LEASE-STAMP         PIC $$$,$$9.99.                     
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L416-DUP-SA                  PIC $9.99.                          
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L416-TAG                     PIC X.                              
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L416-DETL-AMT-TOTAL          PIC $$$$,$$9.99.                    
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L416A & BP13L416D TOTAL LINES               *             
      *-----------------------------------------------------------*             
       01  PRT-L416-DASH-LINE.                                                  
           05  FILLER                       PIC X(78)   VALUE SPACES.           
           05  FILLER                       PIC X(54)   VALUE ALL '='.          
                                                                                
       01  PRT-L416-TOTAL-LINE.                                                 
           05  FILLER                       PIC X(35) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
               'SERIAL NO : ('.                                                 
           05  L416-VR-NO-LOW               PIC X(4)  VALUE '0001'.             
           05  FILLER                       PIC X(4)  VALUE ' TO '.             
           05  L416-VR-NO-HIGH              PIC X(4)  VALUE '0025'.             
           05  FILLER                       PIC X(4)  VALUE ')'.                
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.          
           05  L416-TOTAL-MORT-SF           PIC $,$$$,$$9.99.                   
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L416-TOTAL-DUP-DOA           PIC $$9.99.                         
           05  L416-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.                   
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L416-TOTAL-DUP-SA            PIC $$9.99.                         
           05  FILLER                       PIC X(4)  VALUE SPACES.             
           05  L416-TOTAL-AMT               PIC $,$$$,$$9.99.                   
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE FOOTING LINES                                   *             
      *-----------------------------------------------------------*             
       01  PRT-L416-FTG-1.                                                      
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '.         
           05  L416-AMT-WORDS.                                                  
               10  L416-AMT-DESC1  PIC X(60)   VALUE SPACES.                    
               10  L416-AMT-DESC2  PIC X(60)   VALUE SPACES.                    
                                                                                
       01  PRT-L416-FTG-2.                                                      
           05  FILLER              PIC X(35)   VALUE SPACES.                    
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY :'.            
           05  FILLER              PIC X(15)   VALUE ALL '_'.                   
           05  FILLER              PIC X(10)   VALUE SPACES.                    
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY :'.          
           05  FILLER              PIC X(15)   VALUE ALL '_'.                   
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L416  HEADING LINES                         *             
      *-----------------------------------------------------------*             
       01  MAIN-HEADER.                                                         
           05  HEADER-LISTID             PIC X(8)  VALUE SPACES.                
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'HDB3'.                
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(39) VALUE                        
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.             
           05  HEADER-DATE               PIC X(10).                             
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.             
           05  HEADER-PAGE               PIC ZZZZ9.                             
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13416K REPORT LINES                           *             
      *-----------------------------------------------------------*             
       01  L416K-HEADER2.                                                       
           05  FILLER                    PIC X(47) VALUE SPACES.                
           05  FILLER                    PIC X(35)  VALUE                       
               'REPORT ON CASES WITH EARMARK ERROR'.                            
                                                                                
       01  L416K-HEADER3.                                                       
           05  FILLER               PIC X(4)  VALUE 'S/NO'.                     
           05  FILLER               PIC X(3)  VALUE SPACE.                      
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.               
           05  FILLER               PIC X(9)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.                  
           05  FILLER               PIC X(5)  VALUE SPACE.                      
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.            
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.             
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.        
                                                                                
       01  L416K-REC-DETAIL.                                                    
           05  L416K-SERIAL-NO              PIC ZZZ9.                           
           05  FILLER                       PIC X(3)  VALUE SPACE.              
           05  L416K-SCH-ACC                PIC X(14) VALUE SPACES.             
           05  FILLER                       PIC X(5)  VALUE SPACE.              
           05  L416K-REGN-NO                PIC X(8)  VALUE SPACES.             
           05  FILLER                       PIC X(5)  VALUE SPACE.              
           05  L416K-JR-VCHR-NO             PIC X(13) VALUE SPACES.             
           05  FILLER                       PIC X(5)  VALUE SPACES.             
           05  L416K-AMT-TOTAL              PIC $$$$,$$9.99.                    
           05  FILLER                       PIC X(5)  VALUE SPACES.             
           05  L416K-ERROR-DESC             PIC X(30).                          
                                                                                
       01  L416K-UNDERLINE                  PIC X(132) VALUE ALL '-'.           
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE ERROR MESSAGE FORMAT                            *             
      *-----------------------------------------------------------*             
       01  WS-ERRMSG-HEADER.                                                    
           05  FILLER                       PIC X(46) VALUE                     
               ' *************   ERROR MESSAGE   *************'.                
                                                                                
       01  WS-ERROR.                                                            
           05  FILLER                       PIC X(24) VALUE                     
               ' ERROR ENCOUNTERED WHEN '.                                      
           05  WS-CUR-PROC                  PIC X(21).                          
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  FILLER                       PIC X(15) VALUE                     
               ' STATUS CODE = '.                                               
           05  WS-CUR-STATUS                PIC X(2).                           
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE SUMMARY FORMAT                                  *             
      *-----------------------------------------------------------*             
       01  WS-SUMMARY-HEADER.                                                   
           05  FILLER                       PIC X     VALUE SPACES.             
           05  FILLER                       PIC X(16) VALUE ALL '*'.            
           05  FILLER                       PIC X(20) VALUE                     
               'BP13C416 SUMMARY RPT'.                                          
           05  FILLER                       PIC X(19) VALUE ALL '*'.            
                                                                                
       01  WS-READ-CASES.                                                       
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF RECORDS READ FROM TRANS FILE  (BP13F315) = '.            
           05  WS-EDIT-BP13F315-READ        PIC ZZZ9.                           
                                                                                
       01  WS-DOA-PAYMENT-PRINTED.                                              
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF DOA PAYMENTS   (BP13L416A)               = '.            
           05  WS-EDIT-L416A-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L416D-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (BP13L416D)               = '.            
           05  WS-EDIT-L416D-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L416E-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (BP13L416E)               = '.            
           05  WS-EDIT-L416E-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L416G-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (BP13L416G)               = '.            
           05  WS-EDIT-L416G-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L416H-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (BP13L416H)               = '.            
           05  WS-EDIT-L416H-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L416I-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (BP13L416I)               = '.            
           05  WS-EDIT-L416I-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L416J-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (BP13L416J)               = '.            
           05  WS-EDIT-L416J-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-STAMP-FEES-REC-WRITTEN.                                           
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF RECORDS WRITTEN TO STAMP FILE (AG07F225) = '.            
           05  WS-EDIT-AG07F225-WRITE       PIC ZZZ9.                           
                                                                                
       01  WS-F316-REC-WRITTEN.                                                 
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF RECORDS WRITTEN TO STAMP FILE (BP13F316) = '.            
           05  WS-EDIT-BP13F316-WRITE       PIC ZZZ9.                           
                                                                                
       01  WS-SUMMARY-TRAILER.                                                  
           05  FILLER                       PIC X     VALUE SPACES.             
           05  FILLER                       PIC X(55) VALUE ALL '*'.            
                                                                                
      *-----------------------------------------------------------*             
      *    CONSTANTS LIST                                         *             
      *-----------------------------------------------------------*             
       01  WS-ERROR-PROCEDURE-NAMES.                                            
           05  CLOSE-K006                   PIC X(21) VALUE                     
                   'CLOSING FILE  B05K006'.                                     
           05  CLOSE-K410                   PIC X(21) VALUE                     
                   'CLOSING FILE BP13K410'.                                     
           05  CLOSE-K625                   PIC X(21) VALUE                     
                   'CLOSING FILE BP13K625'.                                     
           05  NOTFND-IN-FIS                PIC X(23) VALUE                     
                   'REC NOT FOUND IN K310'.                                     
           05  NOTFND-IN-MST                PIC X(23) VALUE                     
                   'REC NOT FOUND IN K006'.                                     
           05  NOTFND-IN-SO                 PIC X(23) VALUE                     
                   'REC NOT FOUND IN K410'.                                     
           05  NOTFND-IN-SMF                PIC X(23) VALUE                     
                   'REC NOT FOUND IN K410'.                                     
           05  OPEN-K006                    PIC X(21) VALUE                     
                   'OPENING FILE  B05K006'.                                     
           05  OPEN-K410                    PIC X(21) VALUE                     
                   'OPENING FILE BP13K410'.                                     
           05  OPEN-K625                    PIC X(21) VALUE                     
                   'OPENING FILE BP13K625'.                                     
           05  READ-F315                    PIC X(21) VALUE                     
                   'READING FILE BP13F315'.                                     
           05  WRITE-K625                   PIC X(21) VALUE                     
                   'WRITING FILE BP13K625'.                                     
           05  READ-K006                    PIC X(21) VALUE                     
                   'READING FILE  B05K006'.                                     
           05  READ-K410                    PIC X(21) VALUE                     
                   'READING FILE BP13K410'.                                     
           05  READ-K625                    PIC X(21) VALUE                     
                   'READING FILE BP13K625'.                                     
                                                                                
       01  DUP-DOA-AMT                      PIC 9V99  VALUE 0.                  
       01  DUP-SA-AMT                       PIC 9V99  VALUE 0.                  
       01  HYPHEN                           PIC X     VALUE '-'.                
       01  MAX-REC-PER-PAGE                 PIC 9(2)  VALUE 39.                 
       01  MAX-DETLS-PER-PAGE               PIC 9(3)  VALUE 25.                 
                                                                                
      *-----------------------------------------------------------*             
      *    LEVEL-88 VARIABLES                                     *             
      *-----------------------------------------------------------*             
       01  WS-EOF                           PIC X     VALUE 'N'.                
           88  END-OF-BP13F315                        VALUE 'Y'.                
       01  WS-REPORT-ID-SW                  PIC X(1)  VALUE SPACE.              
       01  WS-PREV-REPORT-ID                PIC X(1)  VALUE SPACE.              
           88  REPORT-L416A                           VALUE 'A'.                
           88  REPORT-L416D                           VALUE 'D'.                
           88  REPORT-L416E                           VALUE 'E'.                
           88  REPORT-L416G                           VALUE 'G'.                
           88  REPORT-L416H                           VALUE 'H'.                
           88  REPORT-L416I                           VALUE 'I'.                
           88  REPORT-L416J                           VALUE 'J'.                
                                                                                
      *-----------------------------------------------------------*             
      *    OTHER VARIABLES                                        *             
      *-----------------------------------------------------------*             
       01  WS-COUNTERS.                                                         
           05  WS-BP13F315-READ-CNT         PIC 9(4)    VALUE ZEROS.            
           05  WS-BP13K625-WRITE-CNT        PIC 9(4)    VALUE ZEROES.           
           05  WS-BP13F316-WRITE-CNT        PIC 9(4)    VALUE ZEROS.            
           05  WS-AG07F225-WRITE-CNT        PIC 9(4)    VALUE ZEROES.           
      *    -----------------------                                              
      *    FOR L416A - DOA LISTING                                              
      *    -----------------------                                              
           05  WS-L416A-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416A-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416A-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L416A-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416A-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416A-SUP-CNT             PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416A-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416A-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
      *    -----------------------                                              
      *    FOR L416D -     LISTING                                              
      *    -----------------------                                              
           05  WS-L416D-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416D-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416D-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L416D-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416D-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416D-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416D-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416D-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
      *    -----------------------                                              
      *    FOR L416E -     LISTING                                              
      *    -----------------------                                              
           05  WS-L416E-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416E-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416E-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L416E-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416E-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416E-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416E-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416E-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
      *    -----------------------                                              
      *    FOR L416G -     LISTING                                              
      *    -----------------------                                              
           05  WS-L416G-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416G-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416G-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L416G-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416G-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416G-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416G-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416G-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
      *    -----------------------                                              
      *    FOR L416H -     LISTING                                              
      *    -----------------------                                              
           05  WS-L416H-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416H-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416H-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L416H-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416H-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416H-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416H-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416H-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
      *    -----------------------                                              
      *    FOR L416I -     LISTING                                              
      *    -----------------------                                              
           05  WS-L416I-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416I-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416I-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L416I-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416I-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416I-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416I-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416I-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
      *    -----------------------                                              
      *    FOR L416J -     LISTING                                              
      *    -----------------------                                              
           05  WS-L416J-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416J-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416J-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L416J-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416J-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416J-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L416J-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L416J-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    --------------------------                                           
      *    FOR L416K - ERROR LISTING                                            
      *    --------------------------                                           
           05  WS-L416K-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L416K-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L416K-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
                                                                                
       01  WS-FLATNO.                                                           
           05  WS-NUM-LEVEL                 PIC X(2).                           
           05  FILLER                       PIC X       VALUE '-'.              
           05  WS-NUM-MAIN                  PIC X(5).                           
                                                                                
       01  WS-SCH-ACC.                                                          
           05  WS-SCH                       PIC X(4).                           
           05  WS-SCH-SEP1                  PIC X.                              
           05  WS-ACC                       PIC X(4).                           
           05  WS-SCH-SEP2                  PIC X.                              
           05  WS-CHK                       PIC X.                              
           05  WS-SCH-SEP3                  PIC X.                              
           05  WS-LESCDE                    PIC X(2).                           
                                                                                
       01  WS-F315-ACC-CHK.                                                     
           05  WS-F315-ACC                  PIC X(4).                           
           05  WS-F315-CHK                  PIC X(1).                           
                                                                                
       01  WS-SO-DATE.                                                          
           05  WS-SO-CC                     PIC X(2).                           
           05  WS-SO-YY                     PIC X(2).                           
           05  WS-SO-MM                     PIC X(2).                           
           05  WS-SO-DD                     PIC X(2).                           
                                                                                
       01  WS-SALE-DATE.                                                        
           05  WS-SALE-CC                   PIC X(2).                           
           05  WS-SALE-YY                   PIC X(2).                           
           05  WS-SALE-MM                   PIC X(2).                           
           05  WS-SALE-DD                   PIC X(2).                           
                                                                                
       01  WS-TEMPORARY-BUFFER.                                                 
           05  WS-TEMP-TOTAL                PIC 9(7)V99.                        
           05  WS-TEMP-DIFF                 PIC 9(7)V99.                        
                                                                                
       01  WS-BLANK-LINE                    PIC X     VALUE SPACES.             
       01  WS-F315-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K006-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K410-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K625-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K625-EOF                      PIC X(1)  VALUE 'N'.                
       01  WS-DEF-DUP-LEASE                 PIC 99V99 VALUE ZEROS.              
       01  WS-LEASE-SF                      PIC S9(5)V99.                       
       01  WS-LEASE-STAMP                   PIC S9(5)V99 VALUE ZEROS.           
       01  WS-MORT-SF                       PIC S9(5)V99.                       
       01  WS-SUP-SF                        PIC S9(5)V99.                       
       01  WS-DUP-DOA                       PIC 9(2)V99.                        
       01  WS-DUP-SA                        PIC 9(2)V99.                        
       01  WS-ANNUAL-RENT                   PIC 9(7)V99.                        
       01  WS-NUM-HDB-REF                   PIC X(11) VALUE SPACES.             
       01  WS-NUM-DOC                       PIC X(3)  VALUE SPACES.             
       01  WS-NUM-DOC-TYP                   PIC X(1)  VALUE SPACES.             
       01  WS-NUM-DOC-CNT                   PIC 9(1)  VALUE ZEROES.             
       01  WS-AMT-STAMP-DUTY                PIC 9(13)V99 VALUE ZEROES.          
       01  WS-AMT-STAMP-DUTY-DUP            PIC 9(13)V99 VALUE ZEROES.          
       01  WS-AMT-EARMARK                   PIC 9(10)V99 VALUE ZEROES.          
       01  WS-EM-LEASE-STAMP                PIC S9(5)V99 VALUE ZEROS.           
       01  WS-EM-MORT-SF                    PIC S9(5)V99 VALUE ZEROS.           
       01  WS-EM-SUP-SF                     PIC S9(5)V99 VALUE ZEROS.           
       01  WS-EM-DUP-DOA                    PIC 9(2)V99  VALUE ZEROS.           
       01  WS-EM-DUP-SA                     PIC 9(2)V99  VALUE ZEROS.           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES USED BY F225                             *              
      *----------------------------------------------------------*              
       01  WS-NEW-VOUCHER                   PIC X      VALUE 'Y'.               
       01  WS-NEW-BATCH                     PIC X      VALUE 'Y'.               
       01  WS-NEW-HEADER                    PIC X      VALUE 'Y'.               
       01  WS-NUM-VOUCHER                   PIC X(11)  VALUE SPACES.            
       01  WS-NUM-BATCH-TYPE                PIC X(4)   VALUE SPACES.            
       01  WS-NUM-FIN-YEAR                  PIC 9(4)   VALUE ZEROES.            
       01  WS-NUM-BATCH-SERIAL              PIC 9(5)   VALUE ZEROES.            
       01  WS-SCH-ACCT-NO                   PIC X(11)  VALUE SPACES.            
       01  WS-TXT-INFO                      PIC X(50)  VALUE SPACES.            
       01  WS-CNT-DETAILS                   PIC 9(4)   VALUE ZEROES.            
       01  WS-AMT-TRANS                     PIC 9(7)V99 VALUE ZEROES.           
       01  WS-AMT-TOTAL                     PIC 9(7)V99 VALUE ZEROES.           
       01  WS-PREV-SA-TP-TAG                PIC X(1)   VALUE SPACE.             
       01  WS-STAFF-START                   PIC X(9) VALUE '29586H   '.         
       01  WS-EDITED-VOUCHER-NO.                                                
           05  WS-EDITED-NUM-DDD            PIC X(3)   VALUE SPACES.            
           05  FILLER                       PIC X(1)   VALUE '-'.               
           05  WS-EDITED-NUM-FIN-YEAR       PIC X(2)   VALUE SPACES.            
           05  FILLER                       PIC X(1)   VALUE '-'.               
           05  WS-EDITED-NUM-VR-SERIAL      PIC X(6)   VALUE SPACES.            
       01  WS-L416A-DESC.                                                       
           05  FILLER                       PIC X(35)  VALUE SPACES.            
           05  FILLER                       PIC X(46)  VALUE                    
              'DEED OF ASSIGNMENT AND SUPPLEMENTAL AGREEMENT'.                  
           05  FILLER                       PIC X(12)  VALUE                    
              'FOR SOC FLAT'.                                                   
       01  WS-L416D-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(55)  VALUE                    
              'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT'.          
       01  WS-L416E-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(01)'.        
       01  WS-L416G-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(2B)'.        
       01  WS-L416H-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(03)'.        
       01  WS-L416I-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(3A)'.        
       01  WS-L416J-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(42)  VALUE                    
              'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT '.                     
           05  FILLER                       PIC X(17)  VALUE                    
              'OF SOC FLAT(SERS)'.                                              
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AG07C907"       *              
      *----------------------------------------------------------*              
       COPY AG7C907C.                                                           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "BP13C906"       *              
      *----------------------------------------------------------*              
       COPY P13C906C.                                                           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AB05C902"       *              
      *----------------------------------------------------------*              
       COPY AB05902C.                                                           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *              
      *----------------------------------------------------------*              
       01  WS-SUBSCRIPTS.                                                       
           05  WA-SUB              PIC 999   VALUE 0.                           
           05  WF-SUB              PIC 999   VALUE 0.                           
           05  WL-SUB              PIC 999   VALUE 0.                           
           05  WS-SUB              PIC 999   VALUE 0.                           
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                           
                                                                                
       01  WA-NAMES.                                                            
           05  FILLER              PIC X(10) VALUE '3ONE      '.                
           05  FILLER              PIC X(10) VALUE '3TWO      '.                
           05  FILLER              PIC X(10) VALUE '5THREE    '.                
           05  FILLER              PIC X(10) VALUE '4FOUR     '.                
           05  FILLER              PIC X(10) VALUE '4FIVE     '.                
           05  FILLER              PIC X(10) VALUE '3SIX      '.                
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.                
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.                
           05  FILLER              PIC X(10) VALUE '4NINE     '.                
           05  FILLER              PIC X(10) VALUE '3TEN      '.                
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.                
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.                
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.                
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.                
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.                
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.                
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.                
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.                
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.                
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.                
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.                
           05  FILLER              PIC X(10) VALUE '5FORTY    '.                
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.                
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.                
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.                
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.                
           05  FILLER              PIC X(10) VALUE '6NINETY   '.                
       01  WA-NAMER REDEFINES WA-NAMES.                                         
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.                   
                                                                                
       01  WS-LITERALS.                                                         
           05  L-CENT              PIC X(5)  VALUE '4CENT'.                     
           05  L-AND               PIC X(4)  VALUE '3AND'.                      
           05  L-X                 PIC X     VALUE '%'.                         
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.                  
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.                 
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.                  
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.                    
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.                    
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.                  
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.                   
                                                                                
       01  SWITCHES.                                                            
           05  WS-SWITCH           PIC 9     VALUE 0.                           
           05  WS-THO-SW           PIC 9     VALUE 0.                           
           05  WS-CNT-SW           PIC 9     VALUE 0.                           
           05  WS-LIT-SW           PIC 9     VALUE 0.                           
           05  WS-TEN-SW           PIC 9     VALUE 0.                           
           05  WS-AND-SW           PIC 9     VALUE 0.                           
                                                                                
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                           
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.                      
       01  WS-RESULT               PIC 999   VALUE 0.                           
       01  WL-AREA.                                                             
           05  WL-ITEM1            PIC 9     VALUE 0.                           
           05  FILLER              PIC X(11) VALUE SPACE.                       
       01  WL-ITM REDEFINES WL-AREA.                                            
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.                   
                                                                                
       01  WS-CHEQUE-DETAILS.                                                   
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                         
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.                 
           05  WF-DETAILS.                                                      
               10  WF-LINE-1       PIC X(60).                                   
               10  WF-LINE-2       PIC X(60).                                   
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.                   
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).                 
                                                                                
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
       0000-CONTROL.                                                            
      ******************************************************************        
            PERFORM  0100-SET-DATE               THRU  0100-EXIT.               
            PERFORM  0200-OPEN-FILES             THRU  0200-EXIT.               
            PERFORM  1100-READ-BP13F315          THRU  1100-EXIT.               
            PERFORM  0900-CHECK-SALES-TYPE       THRU  0900-EXIT.               
            MOVE     WS-REPORT-ID-SW             TO    WS-PREV-REPORT-ID        
            MOVE     F315-CDE-SA-TP-TAG          TO    WS-PREV-SA-TP-TAG        
            PERFORM  1000-READ-AND-PRINT-LOOP    THRU  1000-EXIT                
                          UNTIL END-OF-BP13F315.                                
            PERFORM  8000-DISPLAY-STATISTICS     THRU  8000-EXIT.               
            PERFORM  9000-CLOSE-FILES            THRU  9000-EXIT.               
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0100-SET-DATE.                                                           
      ******************************************************************        
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                              
                    FUNCTION CURRENT-DATE(5:2) '/'                              
                    FUNCTION CURRENT-DATE(1:4)                                  
            DELIMITED BY SIZE INTO HEADER-DATE.                                 
                                                                                
            MOVE HEADER-DATE           TO   L416-CURRENT-DATE.                  
                                                                                
       0100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0200-OPEN-FILES.                                                         
      ******************************************************************        
      *     OPEN INPUT  B05K006                                                 
            OPEN INPUT  BP13F315                                                
                        BP13K410                                                
                 I-O    BP13K625                                                
                 OUTPUT AG07F225                                                
                        BP13F316                                                
                                                                                
                        BP13416A BP13416D BP13416E                              
                                                                                
                        BP13416G BP13416H BP13416I BP13416J                     
                        BP13416K.                                               
                                                                                
            IF WS-K006-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K006                  TO   WS-CUR-PROC              
               MOVE    WS-K006-STATUS             TO   WS-CUR-STATUS            
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.               
                                                                                
            IF WS-K410-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K410                  TO    WS-CUR-PROC             
               MOVE    WS-K410-STATUS             TO    WS-CUR-STATUS           
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
            IF WS-K625-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K625                TO    WS-CUR-PROC               
               MOVE    WS-K625-STATUS           TO    WS-CUR-STATUS             
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
      * VOUCHER NUMBER                                                          
            MOVE 'AG07K960' TO    C907-NUM-FILENME.                             
            CALL 'K960OPEN' USING AG07C907-AREA.                                
                                                                                
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR OPENING AG07K960, STATUS = '                      
                        C907-NUM-FILE-STATUS                                    
               MOVE     C907-NUM-FILE-STATUS    TO     RETURN-CODE              
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT                
            END-IF.                                                             
                                                                                
      * BATCH NUMBER (17/07/1999 - ROMAR)                                       
            MOVE 'BP13K620' TO    C906-NUM-FILENME.                             
            CALL 'K620OPEN' USING BP13C906-AREA.                                
                                                                                
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR OPENING BP13K620, STATUS = '                      
                        C906-NUM-FILE-STATUS                                    
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE              
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT                
            END-IF.                                                             
                                                                                
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')              
            MOVE SPACES              TO   WS-B902-AREA.                         
            INITIALIZE                    WS-B902-AREA.                         
            MOVE 'O'                 TO   B902-CDE-TYPE.                        
            CALL 'AB05C902'  USING WS-B902-AREA.                                
                                                                                
            IF B902-CDE-ERROR NOT = ZEROES                                      
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                           
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'                    
               PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                        
            END-IF.                                                             
                                                                                
       0200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0300-CHK-SERS.                                                           
      ******************************************************************        
      *-----------------------------------*                                     
      * SEARCH SCHEME IN ALLOC SCH TABLE  *                                     
      *-----------------------------------*                                     
           IF WS-ALLOC-SCH  NOT =  LOW-VALUES AND SPACES                        
               SET WS-SERS-PTR  TO 1                                            
               SEARCH WS-SERS-SCH                                               
                   AT END                                                       
                   MOVE 'N' TO WS-SCH-FND                                       
                   WHEN WS-SERS-SCHEME(WS-SERS-PTR) = WS-ALLOC-SCH              
                   MOVE 'Y' TO WS-SCH-FND                                       
               END-SEARCH                                                       
           ELSE                                                                 
               MOVE 'N' TO WS-SCH-FND                                           
           END-IF.                                                              
                                                                                
       0300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0900-CHECK-SALES-TYPE.                                                   
      ******************************************************************        
            MOVE F315-NUM-ALLOC-SCH  TO    WS-ALLOC-SCH.                        
            PERFORM 0300-CHK-SERS    THRU  0300-EXIT.                           
                                                                                
            IF  WS-SCH-FND = 'Y'                                                
                MOVE  'J'           TO     WS-REPORT-ID-SW                      
                MOVE  'SERS'        TO     WS-NUM-BATCH-TYPE                    
                GO TO 0900-EXIT                                                 
            END-IF.                                                             
                                                                                
            IF F315-CDE-SA-TP-TAG = 'Y'                                         
               EVALUATE F315-CDE-SALES-TYPE                                     
               WHEN     '01'                                                    
               WHEN     '02'                                                    
                        MOVE    'E'    TO     WS-REPORT-ID-SW                   
                        MOVE    'SOS ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '2B'                                                    
                        MOVE    'G'    TO     WS-REPORT-ID-SW                   
                        MOVE    'STD ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '03'                                                    
                        MOVE    'H'    TO     WS-REPORT-ID-SW                   
                        MOVE    'RP  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '3A'                                                    
                        MOVE    'I'    TO     WS-REPORT-ID-SW                   
                        MOVE    'BB  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '10'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '13'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '18'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '19'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE                 
               WHEN     OTHER                                                   
                        MOVE    ' '    TO     WS-REPORT-ID-SW                   
                        MOVE    '    ' TO     WS-NUM-BATCH-TYPE                 
               END-EVALUATE                                                     
            ELSE                                                                
               EVALUATE F315-CDE-SALES-TYPE                                     
               WHEN     '01'                                                    
               WHEN     '02'                                                    
                        MOVE    'E'    TO     WS-REPORT-ID-SW                   
                        MOVE    'SOS ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '2B'                                                    
                        MOVE    'G'    TO     WS-REPORT-ID-SW                   
                        MOVE    'STD ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '03'                                                    
                        MOVE    'H'    TO     WS-REPORT-ID-SW                   
                        MOVE    'RP  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '3A'                                                    
                        MOVE    'I'    TO     WS-REPORT-ID-SW                   
                        MOVE    'BB  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '10'                                                    
                        MOVE    'A'    TO     WS-REPORT-ID-SW                   
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '13'                                                    
                        MOVE    'A'    TO     WS-REPORT-ID-SW                   
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '18'                                                    
                        MOVE    'A'    TO     WS-REPORT-ID-SW                   
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     '19'                                                    
                        MOVE    'A'    TO     WS-REPORT-ID-SW                   
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE                 
               WHEN     OTHER                                                   
                        MOVE    ' '    TO     WS-REPORT-ID-SW                   
                        MOVE    '    ' TO     WS-NUM-BATCH-TYPE                 
               END-EVALUATE                                                     
            END-IF.                                                             
                                                                                
       0900-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1000-READ-AND-PRINT-LOOP.                                                
      ******************************************************************        
            MOVE F315-NUM-ALLOC-SCH TO WS-ALLOC-SCH.                            
            PERFORM 0300-CHK-SERS   THRU 0300-EXIT.                             
                                                                                
            IF F315-CDE-TRANS = 'ST'                                            
               IF (WS-REPORT-ID-SW    NOT = WS-PREV-REPORT-ID) OR               
                  (F315-CDE-SA-TP-TAG NOT = WS-PREV-SA-TP-TAG AND               
                   WS-SCH-FND NOT = 'Y')                                        
                   PERFORM  5000-WRITE-TRAILER-F225                             
                      THRU  5000-TRAILER-EXIT                                   
                   MOVE     ZEROES               TO  WS-CNT-DETAILS             
                   MOVE     ZEROES               TO  WS-TEMP-TOTAL              
                   MOVE     'Y'                  TO  WS-NEW-BATCH               
                                                     WS-NEW-VOUCHER             
                                                     WS-NEW-HEADER              
                   MOVE     WS-REPORT-ID-SW      TO  WS-PREV-REPORT-ID          
                   MOVE     F315-CDE-SA-TP-TAG   TO  WS-PREV-SA-TP-TAG          
               END-IF                                                           
                                                                                
               PERFORM  1050-PROCESS-RECORD      THRU 1050-EXIT                 
               PERFORM  1055-EARMARK-ACCOUNT     THRU 1055-EXIT                 
                                                                                
               IF B902-CDE-SYSERR NOT = ZEROES                                  
                  DISPLAY 'ERROR CALLING AB05C902, STATUS = '                   
                           B902-CDE-SYSERR                                      
                  MOVE     '99'                 TO RETURN-CODE                  
                  PERFORM  9000-CLOSE-FILES                                     
               END-IF                                                           
                                                                                
               IF B902-CDE-ERROR-ACCT(1) = SPACES                               
                  IF WS-NEW-HEADER = 'Y'                                        
                     PERFORM  5000-WRITE-HEADER-F225                            
                              THRU 5000-HEADER-EXIT                             
                     MOVE  'N'             TO   WS-NEW-HEADER                   
                  END-IF                                                        
                  PERFORM  1060-PRINT-RECORD        THRU 1060-EXIT              
                  MOVE F315-CDE-SA-TP-TAG  TO   WS-PREV-SA-TP-TAG               
                  PERFORM  6000-WRITE-STAMPING-FILE THRU 6000-EXIT              
               END-IF                                                           
                                                                                
            END-IF.                                                             
                                                                                
            PERFORM 1100-READ-BP13F315       THRU 1100-EXIT.                    
                                                                                
            IF NOT END-OF-BP13F315                                              
               PERFORM 0900-CHECK-SALES-TYPE THRU 0900-EXIT                     
            END-IF.                                                             
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1050-PROCESS-RECORD.                                                     
      ******************************************************************        
            PERFORM 1400-READ-K410 THRU 1400-EXIT.                              
                                                                                
            IF K410-AMT-LEASE-STAMP       NOT NUMERIC                           
               MOVE ZEROES TO K410-AMT-LEASE-STAMP.                             
                                                                                
            IF K410-AMT-LOAN              NOT NUMERIC                           
               MOVE ZEROS  TO K410-AMT-LOAN.                                    
                                                                                
            IF K410-NUM-PREMIUM-RATE      NOT NUMERIC                           
               MOVE ZEROS  TO K410-NUM-PREMIUM-RATE.                            
                                                                                
            IF K410-AMT-PREMIUM-STAMP-FEE NOT NUMERIC                           
               MOVE ZEROS  TO K410-AMT-PREMIUM-STAMP-FEE.                       
                                                                                
      * GENERATE BATCH NUMBER.                                                  
            IF WS-NEW-BATCH = 'Y'                                               
               MOVE WS-NUM-BATCH-TYPE TO C906-NUM-BATCH-TYPE                    
               MOVE  'BP13K620'       TO C906-NUM-FILENME                       
                                                                                
               CALL 'BP13C906'  USING BP13C906-AREA                             
                                                                                
               IF C906-NUM-FILE-STATUS =  '00'                                  
                  MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE           
                  MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR             
                  MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL         
                  MOVE    'N'                   TO  WS-NEW-BATCH                
               ELSE                                                             
                  DISPLAY 'ERROR CALLING BP13C906, FILE STATUS = '              
                           C906-NUM-FILE-STATUS                                 
                  MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE                  
                  PERFORM  9000-CLOSE-FILES                                     
            END-IF.                                                             
                                                                                
      * GENERATE VOUCHER NUMBER.                                                
            IF WS-NEW-VOUCHER = 'Y'                                             
      *        MOVE  'SU '      TO C907-NUM-DDD                                 
               MOVE  'SS '      TO C907-NUM-DDD                                 
               MOVE  'AG07K960' TO C907-NUM-FILENME                             
                                                                                
               CALL 'AG07C907'  USING AG07C907-AREA                             
                                                                                
               IF C907-NUM-FILE-STATUS =  '00'                                  
                  MOVE    'N'   TO    WS-NEW-VOUCHER                            
               ELSE                                                             
                  DISPLAY 'ERROR CALLING AG07C907, FILE STATUS = '              
                           C907-NUM-FILE-STATUS                                 
                  MOVE     C907-NUM-FILE-STATUS TO RETURN-CODE                  
                  PERFORM  9000-CLOSE-FILES                                     
            END-IF.                                                             
                                                                                
       1050-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1055-EARMARK-ACCOUNT.                                                    
      ******************************************************************        
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                              
            MOVE SPACES              TO   WS-B902-AREA.                         
            INITIALIZE                    WS-B902-AREA.                         
                                                                                
            STRING C907-NUM-DDD  C907-NUM-FIN-YR                                
                   C907-NUM-VR-SERIAL                                           
                   DELIMITED BY SIZE INTO B902-VR-NO                            
            END-STRING.                                                         
                                                                                
            MOVE 'E'                     TO   B902-CDE-TYPE.                    
            MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.                
            MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.                   
            MOVE 'P13C416'               TO   B902-NUM-USERID-UPDATE.           
            MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.          
            MOVE 01                      TO   B902-NUM-HDB-REF-CNT.             
            MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).              
            MOVE ZEROES                  TO   WS-AMT-EARMARK.                   
                                                                                
            PERFORM 1057-COMP-TRANS-AMT  THRU 1057-EXIT.                        
            MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).              
                                                                                
            DISPLAY '----------------'.                                         
            DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                           
            DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                        
            DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.                    
            DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.                       
            DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.               
            DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.                 
            DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).                  
            DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).                  
                                                                                
            CALL 'AB05C902'  USING WS-B902-AREA.                                
                                                                                
            DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).               
            DISPLAY '----------------'.                                         
                                                                                
            EVALUATE B902-CDE-ERROR-ACCT(1)                                     
               WHEN SPACES                                                      
                  CONTINUE                                                      
               WHEN OTHER                                                       
                  PERFORM 6500-PRINT-L416K-REPORT     THRU 6500-EXIT            
            END-EVALUATE.                                                       
                                                                                
       1055-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1057-COMP-TRANS-AMT.                                                     
      ******************************************************************        
            IF K410-AMT-LOAN = ZEROS                                            
               MOVE     ZEROES            TO  WS-EM-MORT-SF                     
               MOVE     ZEROES            TO  WS-EM-DUP-DOA                     
            ELSE                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  MOVE     K410-AMT-MORT-STAMP-FEE   TO  WS-EM-MORT-SF          
                  SUBTRACT DUP-DOA-AMT             FROM  WS-EM-MORT-SF          
                  MOVE     DUP-DOA-AMT               TO  WS-EM-DUP-DOA          
               ELSE                                                             
                  MOVE     F315-AMT-MORT-SF          TO  WS-EM-MORT-SF          
                  SUBTRACT DUP-DOA-AMT             FROM  WS-EM-MORT-SF          
                  MOVE     F315-AMT-MORT-SF-DUP      TO  WS-EM-DUP-DOA          
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
               IF K410-AMT-LEASE-STAMP       = ZEROES AND                       
                  K410-AMT-PREMIUM-STAMP-FEE = ZEROES                           
                  INITIALIZE   WS-EM-LEASE-STAMP WS-EM-DUP-SA                   
               ELSE                                                             
                  IF K410-CDE-SA-TP = 'Y'                                       
                     MOVE  WS-DEF-DUP-LEASE  TO  WS-EM-DUP-SA                   
                     COMPUTE WS-EM-LEASE-STAMP =                                
                                           K410-AMT-PREMIUM-STAMP-FEE +         
                                           K410-AMT-LEASE-STAMP -               
                                           WS-DEF-DUP-LEASE                     
                  ELSE                                                          
                     COMPUTE WS-EM-LEASE-STAMP =                                
                                           K410-AMT-PREMIUM-STAMP-FEE           
                  END-IF                                                        
               END-IF                                                           
            ELSE                                                                
               IF F315-AMT-LEASE-FEE      NOT =  ZEROES                         
               OR F315-AMT-SUPP-AGRM-SF   NOT =  ZEROES                         
                  MOVE F315-AMT-LEASE-FEE-DUP TO   WS-EM-DUP-SA                 
                  COMPUTE WS-EM-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +           
                                              F315-AMT-LEASE-FEE                
               ELSE                                                             
                  INITIALIZE   WS-EM-DUP-SA   WS-EM-LEASE-STAMP                 
               END-IF                                                           
            END-IF.                                                             
                                                                                
            DISPLAY 'NUM-REGN            = ' K410-NUM-REGN.                     
            DISPLAY 'WS-EM-MORT-SF       = ' WS-EM-MORT-SF.                     
            DISPLAY 'WS-EM-LEASE-STAMP   = ' WS-EM-LEASE-STAMP.                 
            DISPLAY 'PREMIUM-STAMP-FEE   = ' K410-AMT-PREMIUM-STAMP-FEE.        
            DISPLAY 'K410-AMT-LEASE-STAMP= ' K410-AMT-LEASE-STAMP.              
                                                                                
            COMPUTE WS-AMT-EARMARK = (WS-EM-MORT-SF + WS-EM-DUP-DOA +           
                                     WS-EM-LEASE-STAMP + WS-EM-DUP-SA).         
            DISPLAY 'WS-AMT-EARMARK     = ' WS-AMT-EARMARK.                     
                                                                                
       1057-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1060-PRINT-RECORD.                                                       
      ******************************************************************        
            IF  WS-SCH-FND = 'Y'                                                
                PERFORM 2150-HANDLE-SER  THRU  2150-EXIT                        
                GO  TO   1060-EXIT                                              
            END-IF.                                                             
                                                                                
            IF F315-CDE-SALES-TYPE = '01' OR '2B' OR '02' OR                    
                                     '03' OR '3A'                               
               PERFORM 2100-HANDLE-SALES-TYPE-TP        THRU 2100-EXIT          
            ELSE                                                                
               IF  F315-CDE-SALES-TYPE = '10' OR '13' OR '18' OR '19'           
                   IF F315-CDE-SA-TP-TAG = ' '                                  
                      PERFORM 2300-HANDLE-SALES-TYPE-10 THRU 2300-EXIT          
                   ELSE                                                         
                      IF  F315-CDE-SA-TP-TAG = 'Y'                              
                          PERFORM  2100-HANDLE-SALES-TYPE-TP                    
                             THRU  2100-EXIT                                    
                      END-IF                                                    
                   END-IF                                                       
               END-IF                                                           
            END-IF.                                                             
                                                                                
       1060-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1100-READ-BP13F315.                                                      
      ******************************************************************        
            READ BP13F315                                                       
              AT END                                                            
                 MOVE    'Y'  TO WS-EOF                                         
                 PERFORM 4200-PRINT-LAST-LINES THRU 4200-EXIT                   
                 GO TO   1100-EXIT.                                             
                                                                                
            IF F315-CDE-TRANS = 'ST'                                            
               ADD  1                 TO  WS-BP13F315-READ-CNT                  
               MOVE F315-REGN-NO      TO  K410-KEY-FLD.                         
                                                                                
            MOVE    F315-SCH          TO  WS-SCH.                               
            MOVE    F315-ACC          TO  WS-F315-ACC-CHK.                      
            MOVE    WS-F315-ACC       TO  WS-ACC.                               
            MOVE    WS-F315-CHK       TO  WS-CHK.                               
            MOVE    F315-LESSEE-CODE  TO  WS-LESCDE.                            
            MOVE    HYPHEN            TO  WS-SCH-SEP1.                          
            MOVE    HYPHEN            TO  WS-SCH-SEP2.                          
            MOVE    HYPHEN            TO  WS-SCH-SEP3.                          
            MOVE    F315-NUM-LEVEL    TO  WS-NUM-LEVEL.                         
            MOVE    F315-NUM-MAIN     TO  WS-NUM-MAIN.                          
                                                                                
            IF F315-CDE-SA-TP-TAG  =  LOW-VALUE                                 
               MOVE SPACE             TO  F315-CDE-SA-TP-TAG                    
            END-IF.                                                             
                                                                                
       1100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1400-READ-K410.                                                          
      ******************************************************************        
      *---------------------------------------------------------------*         
      *     USE F315-REGN-NO TO ACCESS BP13K410 (GET DATE, FEES ETC)  *         
      *---------------------------------------------------------------*         
            READ BP13K410.                                                      
                                                                                
            IF WS-K410-STATUS = 00                                              
               IF    K410-CDE-RELEASE-PAYMENT NOT = 'Y'                         
                     DISPLAY ' REGN ' K410-KEY-FLD                              
                     DISPLAY ' RELEASE TAG ' K410-CDE-RELEASE-PAYMENT           
               END-IF                                                           
               IF     F315-NUM-ADHOC-SF = SPACES                                
                      IF K410-DTE-SO-EXECUTION <= '20110218'                    
                         IF K410-NUM-SF-DISC = 'N'                              
                            MOVE 2.00     TO DUP-DOA-AMT                        
                                             DUP-SA-AMT                         
                                             WS-DEF-DUP-LEASE                   
                         ELSE                                                   
                            MOVE 1.40     TO DUP-DOA-AMT                        
                                             DUP-SA-AMT                         
                                             WS-DEF-DUP-LEASE                   
                         END-IF                                                 
                      ELSE                                                      
                         MOVE 0.00        TO DUP-DOA-AMT                        
                                             DUP-SA-AMT                         
                                             WS-DEF-DUP-LEASE                   
                      END-IF                                                    
                      MOVE  K410-AMT-LEASE-STAMP       TO   WS-LEASE-SF         
                      MOVE  K410-AMT-MORT-STAMP-FEE    TO   WS-MORT-SF          
                      MOVE  K410-AMT-PREMIUM-STAMP-FEE TO   WS-SUP-SF           
               ELSE                                                             
                      MOVE  F315-AMT-LEASE-FEE         TO   WS-LEASE-SF         
                      MOVE  F315-AMT-MORT-SF           TO   WS-MORT-SF          
                      MOVE  F315-AMT-SUPP-AGRM-SF      TO   WS-SUP-SF           
               END-IF                                                           
                                                                                
               MOVE    K410-DTE-SO-EXECUTION      TO   WS-SO-DATE               
               COMPUTE WS-ANNUAL-RENT = (K410-AMT-SC-CC1-NET * 12) + 1          
            ELSE                                                                
            IF WS-K410-STATUS = 23                                              
               MOVE    ZEROES                     TO   WS-LEASE-SF              
               MOVE    ZEROES                     TO   WS-MORT-SF               
               MOVE    ZEROES                     TO   WS-SUP-SF                
               MOVE    ZEROES                     TO   WS-DUP-DOA               
               MOVE    ZEROES                     TO   WS-DUP-SA                
               MOVE    SPACES                     TO   WS-SO-DATE               
               MOVE    WS-K410-STATUS             TO   WS-CUR-STATUS            
               MOVE    READ-K410                  TO   WS-CUR-PROC              
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT                
            ELSE                                                                
               MOVE    READ-K410                  TO WS-CUR-PROC                
               MOVE    WS-K410-STATUS             TO WS-CUR-STATUS              
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.               
                                                                                
       1400-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1800-READ-B05K006.                                                       
      ******************************************************************        
            MOVE  ' '                TO L416-TAG.                               
            MOVE  SPACES             TO K006-HDB-REF-SF.                        
            MOVE  K410-NUM-SCH-ACC   TO K006-HDB-REF-SF.                        
                                                                                
            READ  B05K006.                                                      
                                                                                
            IF WS-K006-STATUS = 00                                              
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  PERFORM 1810-CHECK-ADHOC-BLANK-CASES THRU 1810-EXIT           
               ELSE                                                             
                  PERFORM 1820-CHECK-ADHOC-Y-CASES     THRU 1820-EXIT           
               END-IF                                                           
            END-IF.                                                             
                                                                                
       1800-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1810-CHECK-ADHOC-BLANK-CASES.                                            
      ******************************************************************        
           IF (K006-BALANCES > K410-AMT-LEASE-STAMP) OR                         
              (K006-BALANCES = K410-AMT-LEASE-STAMP)                            
               NEXT SENTENCE                                                    
           ELSE                                                                 
               MOVE '*'          TO L416-TAG.                                   
                                                                                
       1810-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1820-CHECK-ADHOC-Y-CASES.                                                
      ******************************************************************        
           IF (K006-BALANCES > F315-AMT-LEASE-FEE) OR                           
              (K006-BALANCES = F315-AMT-LEASE-FEE)                              
               NEXT SENTENCE                                                    
           ELSE                                                                 
               MOVE '*'          TO L416-TAG.                                   
                                                                                
       1820-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2000-DISPLAY-ERROR-MESSAGE.                                              
      ******************************************************************        
            DISPLAY ' *************   ERROR MESSAGE   *************'.           
            DISPLAY 'ERROR ENCOUNTERED WHEN ' WS-CUR-PROC.                      
            DISPLAY 'STATUS CODE = ' WS-CUR-STATUS.                             
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2100-HANDLE-SALES-TYPE-TP.                                               
      ******************************************************************        
      *--------------------------------*                                        
      *     PRINT  L416X-RECORD (DOA)  *                                        
      *--------------------------------*                                        
            ADD    1                      TO  WS-CNT-DETAILS.                   
                                                                                
      *     -----------------------                                             
      *     SET UP L416X-REC-DETAIL                                             
      *     -----------------------                                             
            MOVE   WS-CNT-DETAILS         TO  L416-SERIAL-NO.                   
            MOVE   WS-SCH-ACC             TO  L416-SCH-ACC.                     
            MOVE   K410-KEY-FLD           TO  L416-REGN-NO.                     
            MOVE   F315-NUM-BLK           TO  L416-BLKNO.                       
            MOVE   F315-NME-STREET        TO  L416-STREET.                      
            MOVE   K410-DTE-SO-EXECUTION  TO  WS-SALE-DATE.                     
            MOVE   WS-SALE-CC             TO  L416-SALE-CC.                     
            MOVE   WS-SALE-YY             TO  L416-SALE-YY.                     
            MOVE   WS-SALE-MM             TO  L416-SALE-MM.                     
            MOVE   WS-SALE-DD             TO  L416-SALE-DD.                     
            MOVE   '/'                    TO  L416-DASH1  L416-DASH2.           
            MOVE   WS-FLATNO              TO  L416-FLATNO.                      
                                                                                
            IF K410-AMT-LOAN = ZEROS                                            
               MOVE     ZEROES            TO  L416-MORT-SF                      
               MOVE     ZEROES            TO  L416-TOTAL-MORT-SF                
               MOVE     ZEROES            TO  L416-DUP-DOA                      
               MOVE     ZEROES            TO  WS-MORT-SF                        
               MOVE     ZEROES            TO  WS-DUP-DOA                        
            ELSE                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  SUBTRACT DUP-DOA-AMT    FROM  WS-MORT-SF                      
                  MOVE     WS-MORT-SF     TO    L416-MORT-SF                    
                  MOVE     DUP-DOA-AMT    TO    WS-DUP-DOA                      
                  MOVE     DUP-DOA-AMT    TO    L416-DUP-DOA                    
               ELSE                                                             
                  MOVE     WS-MORT-SF           TO L416-MORT-SF                 
                  MOVE     F315-AMT-MORT-SF-DUP TO WS-DUP-DOA                   
                  MOVE     F315-AMT-MORT-SF-DUP TO L416-DUP-DOA                 
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
             IF K410-AMT-LEASE-STAMP    NOT =  ZEROES                           
                PERFORM  1800-READ-B05K006 THRU  1800-EXIT                      
                MOVE     WS-DEF-DUP-LEASE  TO    L416-DUP-SA                    
                MOVE     WS-DEF-DUP-LEASE  TO    WS-DUP-SA                      
                                                                                
                COMPUTE WS-LEASE-STAMP = K410-AMT-PREMIUM-STAMP-FEE +           
                                         K410-AMT-LEASE-STAMP -                 
                                         WS-DEF-DUP-LEASE                       
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L416-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             END-IF                                                             
            ELSE                                                                
             IF F315-AMT-LEASE-FEE      NOT =  ZEROES                           
                PERFORM  1800-READ-B05K006      THRU 1800-EXIT                  
                MOVE     F315-AMT-LEASE-FEE-DUP TO   L416-DUP-SA                
                MOVE     F315-AMT-LEASE-FEE-DUP TO   WS-DUP-SA                  
                                                                                
                COMPUTE WS-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +                
                                         F315-AMT-LEASE-FEE                     
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L416-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             END-IF                                                             
            END-IF.                                                             
                                                                                
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +              
                                     WS-LEASE-STAMP + WS-DUP-SA ).              
                                                                                
            MOVE    WS-TEMP-TOTAL         TO  L416-DETL-AMT-TOTAL.              
                                                                                
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.                   
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.                     
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                   
                                          TO  WS-TXT-INFO.                      
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.        
                                                                                
      *---------------------------------------------------------------*         
            MOVE    WS-REPORT-ID-SW       TO  WS-PREV-REPORT-ID.                
            PERFORM 2120-CLASSIFY-SALES-TYPE-TP THRU 2120-EXIT.                 
      *---------------------------------------------------------------*         
                                                                                
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                            
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT         
                MOVE    ZEROES                   TO   WS-CNT-DETAILS            
                MOVE    'Y'                      TO   WS-NEW-BATCH              
                                                      WS-NEW-VOUCHER            
                                                      WS-NEW-HEADER             
            END-IF.                                                             
                                                                                
       2100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2150-HANDLE-SER.                                                         
      ******************************************************************        
      *--------------------------------*                                        
      *     PRINT  L416J-RECORD (DOA)  *                                        
      *--------------------------------*                                        
            ADD    1                      TO  WS-CNT-DETAILS.                   
                                                                                
      *     -----------------------                                             
      *     SET UP L416J-REC-DETAIL                                             
      *     -----------------------                                             
            MOVE   WS-CNT-DETAILS         TO  L416-SERIAL-NO.                   
            MOVE   WS-SCH-ACC             TO  L416-SCH-ACC.                     
            MOVE   K410-KEY-FLD           TO  L416-REGN-NO.                     
            MOVE   F315-NUM-BLK           TO  L416-BLKNO.                       
            MOVE   F315-NME-STREET        TO  L416-STREET.                      
            MOVE   K410-DTE-SO-EXECUTION  TO  WS-SALE-DATE.                     
            MOVE   WS-SALE-CC             TO  L416-SALE-CC.                     
            MOVE   WS-SALE-YY             TO  L416-SALE-YY.                     
            MOVE   WS-SALE-MM             TO  L416-SALE-MM.                     
            MOVE   WS-SALE-DD             TO  L416-SALE-DD.                     
            MOVE   '/'                    TO  L416-DASH1  L416-DASH2.           
            MOVE   WS-FLATNO              TO  L416-FLATNO.                      
                                                                                
            IF K410-AMT-LOAN = ZEROS                                            
               MOVE     ZEROES            TO  L416-MORT-SF                      
               MOVE     ZEROES            TO  L416-TOTAL-MORT-SF                
               MOVE     ZEROES            TO  L416-DUP-DOA                      
               MOVE     ZEROES            TO  WS-MORT-SF                        
               MOVE     ZEROES            TO  WS-DUP-DOA                        
            ELSE                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  SUBTRACT DUP-DOA-AMT    FROM  WS-MORT-SF                      
                  MOVE     WS-MORT-SF     TO    L416-MORT-SF                    
                  MOVE     DUP-DOA-AMT    TO    WS-DUP-DOA                      
                  MOVE     DUP-DOA-AMT    TO    L416-DUP-DOA                    
               ELSE                                                             
                  MOVE     WS-MORT-SF           TO L416-MORT-SF                 
                  MOVE     F315-AMT-MORT-SF-DUP TO WS-DUP-DOA                   
                  MOVE     F315-AMT-MORT-SF-DUP TO L416-DUP-DOA                 
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
             IF K410-AMT-LEASE-STAMP    NOT =  ZEROES                           
                PERFORM  1800-READ-B05K006 THRU 1800-EXIT                       
                MOVE     WS-DEF-DUP-LEASE  TO  L416-DUP-SA                      
                MOVE     WS-DEF-DUP-LEASE  TO  WS-DUP-SA                        
                                                                                
                COMPUTE WS-LEASE-STAMP = K410-AMT-PREMIUM-STAMP-FEE +           
                                         K410-AMT-LEASE-STAMP -                 
                                         WS-DEF-DUP-LEASE                       
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L416-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             END-IF                                                             
            ELSE                                                                
             IF F315-AMT-LEASE-FEE      NOT =  ZEROES                           
                PERFORM  1800-READ-B05K006 THRU 1800-EXIT                       
                MOVE     F315-AMT-LEASE-FEE-DUP TO L416-DUP-SA                  
                MOVE     F315-AMT-LEASE-FEE-DUP TO WS-DUP-SA                    
                                                                                
                COMPUTE WS-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +                
                                         F315-AMT-LEASE-FEE                     
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L416-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L416-SUP-LEASE-STAMP               
             END-IF                                                             
            END-IF.                                                             
                                                                                
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +              
                                     WS-LEASE-STAMP + WS-DUP-SA ).              
                                                                                
            MOVE    WS-TEMP-TOTAL         TO  L416-DETL-AMT-TOTAL.              
                                                                                
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.                   
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.                     
            ADD     1                     TO  WS-L416J-PRINT-CNT                
            ADD     WS-MORT-SF            TO  WS-L416J-MORT-CNT                 
            ADD     WS-DUP-SA             TO  WS-L416J-DUP-SA-CNT               
            ADD     WS-DUP-DOA            TO  WS-L416J-DUP-DOA-CNT              
            ADD     WS-LEASE-STAMP        TO  WS-L416J-LEASE-CNT                
            ADD     WS-TEMP-TOTAL         TO  WS-L416J-IND-TOT-CNT              
            MOVE    WS-L416J-IND-TOT-CNT  TO  WS-AMT-TOTAL                      
            WRITE   L416J-PRINT-REC       FROM  L416-REC-DETAIL AFTER 1.        
            MOVE    'J'                   TO  WS-PREV-REPORT-ID.                
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                   
                                          TO  WS-TXT-INFO.                      
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.        
                                                                                
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                            
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT         
                MOVE    ZEROES                   TO   WS-CNT-DETAILS            
                MOVE    'Y'                      TO   WS-NEW-BATCH              
                                                      WS-NEW-VOUCHER            
                                                      WS-NEW-HEADER             
            END-IF.                                                             
                                                                                
       2150-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2120-CLASSIFY-SALES-TYPE-TP.                                             
      ******************************************************************        
            EVALUATE TRUE                                                       
            WHEN     REPORT-L416D                                               
                  ADD    1                TO  WS-L416D-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L416D-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L416D-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L416D-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L416D-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L416D-IND-TOT-CNT              
                  MOVE  WS-L416D-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L416D-PRINT-REC  FROM L416-REC-DETAIL AFTER 1           
            WHEN     REPORT-L416E                                               
                  ADD    1                TO  WS-L416E-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L416E-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L416E-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L416E-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L416E-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L416E-IND-TOT-CNT              
                  MOVE  WS-L416E-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L416E-PRINT-REC  FROM L416-REC-DETAIL AFTER 1           
            WHEN     REPORT-L416G                                               
                  ADD    1                TO  WS-L416G-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L416G-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L416G-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L416G-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L416G-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L416G-IND-TOT-CNT              
                  MOVE  WS-L416G-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L416G-PRINT-REC  FROM L416-REC-DETAIL AFTER 1           
            WHEN     REPORT-L416H                                               
                  ADD    1                TO  WS-L416H-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L416H-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L416H-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L416H-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L416H-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L416H-IND-TOT-CNT              
                  MOVE  WS-L416H-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L416H-PRINT-REC  FROM L416-REC-DETAIL AFTER 1           
            WHEN     REPORT-L416I                                               
                  ADD    1                TO  WS-L416I-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L416I-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L416I-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L416I-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L416I-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L416I-IND-TOT-CNT              
                  MOVE  WS-L416I-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L416I-PRINT-REC  FROM L416-REC-DETAIL AFTER 1           
            END-EVALUATE.                                                       
                                                                                
       2120-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2300-HANDLE-SALES-TYPE-10.                                               
      ******************************************************************        
      *--------------------------------*                                        
      *     PRINT  L416A-RECORD (DOA)  *                                        
      *--------------------------------*                                        
                                                                                
            ADD    1                      TO  WS-L416A-PRINT-CNT.               
            ADD    1                      TO  WS-CNT-DETAILS.                   
                                                                                
      *     -----------------------                                             
      *     SET UP L416A-REC-DETAIL                                             
      *     -----------------------                                             
            MOVE   WS-CNT-DETAILS         TO  L416-SERIAL-NO.                   
            MOVE   WS-SCH-ACC             TO  L416-SCH-ACC.                     
            MOVE   K410-KEY-FLD           TO  L416-REGN-NO.                     
            MOVE   F315-NUM-BLK           TO  L416-BLKNO.                       
            MOVE   F315-NME-STREET        TO  L416-STREET.                      
            MOVE   K410-DTE-SO-EXECUTION  TO  WS-SALE-DATE.                     
            MOVE   WS-SALE-CC             TO  L416-SALE-CC.                     
            MOVE   WS-SALE-YY             TO  L416-SALE-YY.                     
            MOVE   WS-SALE-MM             TO  L416-SALE-MM.                     
            MOVE   WS-SALE-DD             TO  L416-SALE-DD.                     
            MOVE   '/'                    TO  L416-DASH1  L416-DASH2.           
            MOVE   WS-FLATNO              TO  L416-FLATNO.                      
                                                                                
            IF K410-AMT-LOAN = ZEROS                                            
               MOVE     ZEROES            TO  L416-MORT-SF                      
               MOVE     ZEROES            TO  L416-TOTAL-MORT-SF                
               MOVE     ZEROES            TO  L416-DUP-DOA                      
               MOVE     ZEROES            TO  WS-MORT-SF                        
               MOVE     ZEROES            TO  WS-DUP-DOA                        
            ELSE                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  SUBTRACT DUP-DOA-AMT     FROM  WS-MORT-SF                     
                  MOVE     WS-MORT-SF        TO  L416-MORT-SF                   
                  ADD      WS-MORT-SF        TO  WS-L416A-MORT-CNT              
                                                                                
                  MOVE     DUP-DOA-AMT       TO  WS-DUP-DOA                     
                  MOVE     DUP-DOA-AMT       TO  L416-DUP-DOA                   
                  ADD      DUP-DOA-AMT       TO  WS-L416A-DUP-DOA-CNT           
               ELSE                                                             
                  MOVE    WS-MORT-SF           TO  L416-MORT-SF                 
                  ADD     WS-MORT-SF           TO  WS-L416A-MORT-CNT            
                                                                                
                  MOVE    F315-AMT-MORT-SF-DUP TO  WS-DUP-DOA                   
                  MOVE    F315-AMT-MORT-SF-DUP TO  L416-DUP-DOA                 
                  ADD     F315-AMT-MORT-SF-DUP TO  WS-L416A-DUP-DOA-CNT         
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
             IF K410-AMT-PREMIUM-STAMP-FEE =   ZEROS                            
                MOVE     ZEROS           TO    L416-SUP-LEASE-STAMP             
                MOVE     ZEROS           TO    L416-DUP-SA                      
                MOVE     ZEROS           TO    WS-DUP-SA                        
             ELSE                                                               
      * TO CREATE A RECORD FOR PRINTING OF LIST FOR STAMPING OF                 
      * SUPPLEMENTARY AGREEMENT.                                                
                PERFORM 5100-WRITE-BP13F316   THRU 5100-EXIT                    
                SUBTRACT DUP-SA-AMT      FROM  WS-SUP-SF                        
                MOVE     WS-SUP-SF       TO    L416-SUP-LEASE-STAMP             
                ADD      WS-SUP-SF       TO    WS-L416A-SUP-CNT                 
                                                                                
                MOVE     DUP-DOA-AMT     TO    WS-DUP-SA                        
                MOVE     DUP-DOA-AMT     TO    L416-DUP-SA                      
                ADD      DUP-DOA-AMT     TO    WS-L416A-DUP-SA-CNT              
             END-IF                                                             
            ELSE                                                                
             IF F315-AMT-SUPP-AGRM-SF =   ZEROS                                 
                MOVE  ZEROS             TO  L416-SUP-LEASE-STAMP                
                MOVE  ZEROS             TO  L416-DUP-SA                         
                MOVE  ZEROS             TO  WS-DUP-SA                           
             ELSE                                                               
      * TO CREATE A RECORD FOR PRINTING OF LIST FOR STAMPING OF                 
      * SUPPLEMENTARY AGREEMENT.                                                
                PERFORM 5100-WRITE-BP13F316   THRU 5100-EXIT                    
                MOVE  WS-SUP-SF         TO  L416-SUP-LEASE-STAMP                
                ADD   WS-SUP-SF         TO  WS-L416A-SUP-CNT                    
                                                                                
                MOVE  F315-AMT-SUPP-AGRM-SF-DUP TO WS-DUP-SA                    
                MOVE  F315-AMT-SUPP-AGRM-SF-DUP TO L416-DUP-SA                  
                ADD   F315-AMT-SUPP-AGRM-SF-DUP TO WS-L416A-DUP-SA-CNT          
             END-IF                                                             
            END-IF.                                                             
                                                                                
            COMPUTE WS-TEMP-TOTAL  =  (WS-MORT-SF + WS-DUP-DOA +                
                                       WS-SUP-SF  + WS-DUP-SA ).                
                                                                                
            MOVE    WS-TEMP-TOTAL         TO  L416-DETL-AMT-TOTAL.              
            ADD     WS-TEMP-TOTAL         TO  WS-L416A-IND-TOT-CNT.             
                                                                                
      *** PRINT FINANCES COPY                                                   
            WRITE   L416A-PRINT-REC     FROM  L416-REC-DETAIL AFTER 1.          
                                                                                
            MOVE   'A'                    TO  WS-PREV-REPORT-ID.                
                                                                                
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.                   
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.                     
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES         '          
                                          TO   WS-TXT-INFO.                     
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.        
                                                                                
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                            
                MOVE    WS-L416A-IND-TOT-CNT     TO   WS-AMT-TOTAL              
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT         
                MOVE    ZEROES                   TO   WS-CNT-DETAILS            
                MOVE    'Y'                      TO   WS-NEW-BATCH              
                                                      WS-NEW-VOUCHER            
                                                      WS-NEW-HEADER             
            END-IF.                                                             
                                                                                
       2300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4200-PRINT-LAST-LINES.                                                   
      ******************************************************************        
            PERFORM 5000-WRITE-TRAILER-F225                                     
               THRU 5000-TRAILER-EXIT.                                          
                                                                                
       4200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4210-PRINT-L416A-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4210-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS       TO  L416-VR-NO-HIGH.                     
            MOVE  WS-L416A-MORT-CNT    TO  L416-TOTAL-MORT-SF.                  
            MOVE  WS-L416A-DUP-DOA-CNT TO  L416-TOTAL-DUP-DOA.                  
            MOVE  WS-L416A-SUP-CNT     TO  L416-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L416A-DUP-SA-CNT  TO  L416-TOTAL-DUP-SA.                   
            MOVE  WS-L416A-IND-TOT-CNT TO  L416-TOTAL-AMT.                      
                                                                                
      *** PRINT FINANCES COPY                                                   
                                                                                
            WRITE L416A-PRINT-REC FROM PRT-L416-DASH-LINE  AFTER 2.             
            WRITE L416A-PRINT-REC FROM PRT-L416-TOTAL-LINE AFTER 1.             
            WRITE L416A-PRINT-REC FROM PRT-L416-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L416A-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L416-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L416-AMT-DESC2.                 
                                                                                
      *** FINANCES COPY                                                         
            WRITE    L416A-PRINT-REC       FROM PRT-L416-FTG-1 AFTER 3.         
            WRITE    L416A-PRINT-REC       FROM PRT-L416-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L416A-MORT-CNT               
                                                WS-L416A-DUP-DOA-CNT            
                                                WS-L416A-SUP-CNT                
                                                WS-L416A-DUP-SA-CNT             
                                                WS-L416A-IND-TOT-CNT.           
       4210-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4240-PRINT-L416D-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4240-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L416-VR-NO-HIGH.                     
            MOVE  WS-L416D-MORT-CNT     TO L416-TOTAL-MORT-SF.                  
            MOVE  WS-L416D-DUP-DOA-CNT  TO L416-TOTAL-DUP-DOA.                  
            MOVE  WS-L416D-LEASE-CNT    TO L416-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L416D-DUP-SA-CNT   TO L416-TOTAL-DUP-SA.                   
            MOVE  WS-L416D-IND-TOT-CNT  TO L416-TOTAL-AMT.                      
                                                                                
            WRITE L416D-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 2.            
            WRITE L416D-PRINT-REC  FROM PRT-L416-TOTAL-LINE AFTER 1.            
            WRITE L416D-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 1.            
            MOVE     WS-L416D-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L416-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L416-AMT-DESC2.                 
            WRITE    L416D-PRINT-REC       FROM PRT-L416-FTG-1 AFTER 3.         
            WRITE    L416D-PRINT-REC       FROM PRT-L416-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L416D-MORT-CNT               
                                                WS-L416D-DUP-DOA-CNT            
                                                WS-L416D-LEASE-CNT              
                                                WS-L416D-DUP-SA-CNT             
                                                WS-L416D-IND-TOT-CNT.           
       4240-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4250-PRINT-L416E-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4250-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L416-VR-NO-HIGH.                     
            MOVE  WS-L416E-MORT-CNT     TO L416-TOTAL-MORT-SF.                  
            MOVE  WS-L416E-DUP-DOA-CNT  TO L416-TOTAL-DUP-DOA.                  
            MOVE  WS-L416E-LEASE-CNT    TO L416-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L416E-DUP-SA-CNT   TO L416-TOTAL-DUP-SA.                   
            MOVE  WS-L416E-IND-TOT-CNT  TO L416-TOTAL-AMT.                      
                                                                                
            WRITE L416E-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 2.            
            WRITE L416E-PRINT-REC  FROM PRT-L416-TOTAL-LINE AFTER 1.            
            WRITE L416E-PRINT-REC  FROM PRT-L416-DASH-LINE AFTER 1.             
            MOVE     WS-L416E-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L416-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L416-AMT-DESC2.                 
                                                                                
            WRITE    L416E-PRINT-REC       FROM PRT-L416-FTG-1 AFTER 3.         
            WRITE    L416E-PRINT-REC       FROM PRT-L416-FTG-2 AFTER 6.         
            MOVE     ZEROES                TO   WS-L416E-MORT-CNT               
                                                WS-L416E-DUP-DOA-CNT            
                                                WS-L416E-LEASE-CNT              
                                                WS-L416E-DUP-SA-CNT             
                                                WS-L416E-IND-TOT-CNT.           
       4250-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4270-PRINT-L416G-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4270-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L416-VR-NO-HIGH.                     
            MOVE  WS-L416G-MORT-CNT     TO L416-TOTAL-MORT-SF.                  
            MOVE  WS-L416G-DUP-DOA-CNT  TO L416-TOTAL-DUP-DOA.                  
            MOVE  WS-L416G-LEASE-CNT    TO L416-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L416G-DUP-SA-CNT   TO L416-TOTAL-DUP-SA.                   
            MOVE  WS-L416G-IND-TOT-CNT  TO L416-TOTAL-AMT.                      
                                                                                
            WRITE L416G-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 2.            
            WRITE L416G-PRINT-REC  FROM PRT-L416-TOTAL-LINE AFTER 1.            
            WRITE L416G-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 1.            
            MOVE     WS-L416G-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L416-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L416-AMT-DESC2.                 
            WRITE    L416G-PRINT-REC       FROM PRT-L416-FTG-1 AFTER 3.         
            WRITE    L416G-PRINT-REC       FROM PRT-L416-FTG-2 AFTER 6.         
            MOVE     ZEROES                TO   WS-L416G-MORT-CNT               
                                                WS-L416G-DUP-DOA-CNT            
                                                WS-L416G-LEASE-CNT              
                                                WS-L416G-DUP-SA-CNT             
                                                WS-L416G-IND-TOT-CNT.           
       4270-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4280-PRINT-L416H-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4280-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L416-VR-NO-HIGH.                     
            MOVE  WS-L416H-MORT-CNT     TO L416-TOTAL-MORT-SF.                  
            MOVE  WS-L416H-DUP-DOA-CNT  TO L416-TOTAL-DUP-DOA.                  
            MOVE  WS-L416H-LEASE-CNT    TO L416-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L416H-DUP-SA-CNT   TO L416-TOTAL-DUP-SA.                   
            MOVE  WS-L416H-IND-TOT-CNT  TO L416-TOTAL-AMT.                      
                                                                                
            WRITE L416H-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 2.            
            WRITE L416H-PRINT-REC  FROM PRT-L416-TOTAL-LINE AFTER 1.            
            WRITE L416H-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 1.            
            MOVE     WS-L416H-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L416-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L416-AMT-DESC2.                 
            WRITE    L416H-PRINT-REC       FROM PRT-L416-FTG-1 AFTER 3.         
            WRITE    L416H-PRINT-REC       FROM PRT-L416-FTG-2 AFTER 6.         
            MOVE     ZEROES                TO   WS-L416H-MORT-CNT               
                                                WS-L416H-DUP-DOA-CNT            
                                                WS-L416H-LEASE-CNT              
                                                WS-L416H-DUP-SA-CNT             
                                                WS-L416H-IND-TOT-CNT.           
       4280-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4290-PRINT-L416I-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4290-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L416-VR-NO-HIGH.                     
            MOVE  WS-L416I-MORT-CNT     TO L416-TOTAL-MORT-SF.                  
            MOVE  WS-L416I-DUP-DOA-CNT  TO L416-TOTAL-DUP-DOA.                  
            MOVE  WS-L416I-LEASE-CNT    TO L416-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L416I-DUP-SA-CNT   TO L416-TOTAL-DUP-SA.                   
            MOVE  WS-L416I-IND-TOT-CNT  TO L416-TOTAL-AMT.                      
                                                                                
            WRITE L416I-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 2.            
            WRITE L416I-PRINT-REC  FROM PRT-L416-TOTAL-LINE AFTER 1.            
            WRITE L416I-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 1.            
            MOVE     WS-L416I-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L416-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L416-AMT-DESC2.                 
                                                                                
            WRITE    L416I-PRINT-REC       FROM PRT-L416-FTG-1 AFTER 3.         
            WRITE    L416I-PRINT-REC       FROM PRT-L416-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L416I-MORT-CNT               
                                                WS-L416I-DUP-DOA-CNT            
                                                WS-L416I-LEASE-CNT              
                                                WS-L416I-DUP-SA-CNT             
                                                WS-L416I-IND-TOT-CNT.           
       4290-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4295-PRINT-L416J-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4295-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L416-VR-NO-HIGH.                     
            MOVE  WS-L416J-MORT-CNT     TO L416-TOTAL-MORT-SF.                  
            MOVE  WS-L416J-DUP-DOA-CNT  TO L416-TOTAL-DUP-DOA.                  
            MOVE  WS-L416J-LEASE-CNT    TO L416-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L416J-DUP-SA-CNT   TO L416-TOTAL-DUP-SA.                   
            MOVE  WS-L416J-IND-TOT-CNT  TO L416-TOTAL-AMT.                      
                                                                                
            WRITE L416J-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 2.            
            WRITE L416J-PRINT-REC  FROM PRT-L416-TOTAL-LINE AFTER 1.            
            WRITE L416J-PRINT-REC  FROM PRT-L416-DASH-LINE  AFTER 1.            
            MOVE     WS-L416J-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L416-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L416-AMT-DESC2.                 
                                                                                
            WRITE    L416J-PRINT-REC       FROM PRT-L416-FTG-1 AFTER 3.         
            WRITE    L416J-PRINT-REC       FROM PRT-L416-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L416J-MORT-CNT               
                                                WS-L416J-DUP-DOA-CNT            
                                                WS-L416J-LEASE-CNT              
                                                WS-L416J-DUP-SA-CNT             
                                                WS-L416J-IND-TOT-CNT.           
       4295-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4620-PRINT-L416A-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13L416A'          TO L416-REPORT-ID.                         
            MOVE  WS-L416A-DESC      TO L416-REPORT-ID-DESC.                    
            MOVE 'SUPP. AGMT'        TO L416-SUP-LEASE-DESC.                    
            MOVE  SPACES             TO L416-TAG-DESC.                          
            ADD   1                  TO WS-L416A-PAGE-CNT.                      
            MOVE  WS-L416A-PAGE-CNT  TO L416-PAGE.                              
                                                                                
      ***** PRINT FINACES COPY HEADER                                           
                                                                                
            MOVE "FINANCE'S COPY"           TO L416-COPY-NAME.                  
                                                                                
            IF F315-NUM-ADHOC-SF = 'Y'                                          
               MOVE '-A'             TO L416-REPORT-ID(9:2).                    
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.           
            MOVE SPACES              TO L416-REPORT-ID(9:2).                    
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-2    AFTER 2.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-3    AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-4    AFTER 2.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-5    AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-6    AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-7    AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-8    AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-9    AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-10   AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-10A  AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-HDG-11   AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-SUBHDG-1 AFTER 3.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-SUBHDG-2 AFTER 1.              
            WRITE L416A-PRINT-REC  FROM PRT-L416-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L416A-PRINT-REC.                        
            WRITE L416A-PRINT-REC AFTER 1.                                      
                                                                                
       4620-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4710-PRINT-L416D-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13L416D'          TO L416-REPORT-ID.                         
            MOVE  WS-L416D-DESC      TO L416-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L416-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L416-TAG-DESC.                          
            ADD   1                  TO WS-L416D-PAGE-CNT.                      
            MOVE  WS-L416D-PAGE-CNT  TO L416-PAGE.                              
                                                                                
            MOVE "FINANCE'S COPY"           TO L416-COPY-NAME.                  
            IF F315-NUM-ADHOC-SF = 'Y'                                          
               MOVE '-A'             TO L416-REPORT-ID(9:2).                    
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.           
            MOVE SPACES              TO L416-REPORT-ID(9:2).                    
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-2    AFTER 2.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-3    AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-4    AFTER 2.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-5    AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-6    AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-7    AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-8    AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-9    AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-10   AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-10A  AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-HDG-11   AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-SUBHDG-1 AFTER 3.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-SUBHDG-2 AFTER 1.              
            WRITE L416D-PRINT-REC  FROM PRT-L416-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L416D-PRINT-REC.                        
            WRITE L416D-PRINT-REC AFTER 1.                                      
                                                                                
       4710-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4720-PRINT-L416E-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13L416E'          TO L416-REPORT-ID.                         
            MOVE  WS-L416E-DESC      TO L416-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L416-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L416-TAG-DESC.                          
            ADD   1                  TO WS-L416E-PAGE-CNT.                      
            MOVE  WS-L416E-PAGE-CNT  TO L416-PAGE.                              
                                                                                
            MOVE "FINANCE'S COPY"           TO L416-COPY-NAME.                  
            IF F315-NUM-ADHOC-SF = 'Y'                                          
               MOVE '-A'             TO L416-REPORT-ID(9:2).                    
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.           
            MOVE SPACES              TO L416-REPORT-ID(9:2).                    
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-2    AFTER 2.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-3    AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-4    AFTER 2.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-5    AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-6    AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-7    AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-8    AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-9    AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-10   AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-10A  AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-HDG-11   AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-SUBHDG-1 AFTER 3.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-SUBHDG-2 AFTER 1.              
            WRITE L416E-PRINT-REC  FROM PRT-L416-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L416E-PRINT-REC.                        
            WRITE L416E-PRINT-REC AFTER 1.                                      
                                                                                
       4720-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4740-PRINT-L416G-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13L416G'          TO L416-REPORT-ID.                         
            MOVE  WS-L416G-DESC      TO L416-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L416-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L416-TAG-DESC.                          
            ADD   1                  TO WS-L416G-PAGE-CNT.                      
            MOVE  WS-L416G-PAGE-CNT  TO L416-PAGE.                              
                                                                                
            MOVE "FINANCE'S COPY"           TO L416-COPY-NAME.                  
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.           
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-2    AFTER 2.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-3    AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-4    AFTER 2.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-5    AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-6    AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-7    AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-8    AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-9    AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-10   AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-10A  AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-HDG-11   AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-SUBHDG-1 AFTER 3.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-SUBHDG-2 AFTER 1.              
            WRITE L416G-PRINT-REC  FROM PRT-L416-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L416G-PRINT-REC.                        
            WRITE L416G-PRINT-REC AFTER 1.                                      
                                                                                
       4740-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4750-PRINT-L416H-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13L416H'          TO L416-REPORT-ID.                         
            MOVE  WS-L416H-DESC      TO L416-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L416-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L416-TAG-DESC.                          
            ADD   1                  TO WS-L416H-PAGE-CNT.                      
            MOVE  WS-L416H-PAGE-CNT  TO L416-PAGE.                              
                                                                                
            MOVE "FINANCE'S COPY"           TO L416-COPY-NAME.                  
            IF F315-NUM-ADHOC-SF = 'Y'                                          
               MOVE '-A'             TO L416-REPORT-ID(9:2).                    
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.           
            MOVE SPACES              TO L416-REPORT-ID(9:2).                    
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-2    AFTER 2.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-3    AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-4    AFTER 2.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-5    AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-6    AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-7    AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-8    AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-9    AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-10   AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-10A  AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-HDG-11   AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-SUBHDG-1 AFTER 3.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-SUBHDG-2 AFTER 1.              
            WRITE L416H-PRINT-REC  FROM PRT-L416-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L416H-PRINT-REC.                        
            WRITE L416H-PRINT-REC AFTER 1.                                      
                                                                                
       4750-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4760-PRINT-L416I-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13L416I'          TO L416-REPORT-ID.                         
            MOVE  WS-L416I-DESC      TO L416-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L416-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L416-TAG-DESC.                          
            ADD   1                  TO WS-L416I-PAGE-CNT.                      
            MOVE  WS-L416I-PAGE-CNT  TO L416-PAGE.                              
                                                                                
            MOVE "FINANCE'S COPY"           TO L416-COPY-NAME.                  
            IF F315-NUM-ADHOC-SF = 'Y'                                          
               MOVE '-A'             TO L416-REPORT-ID(9:2).                    
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.           
            MOVE SPACES              TO L416-REPORT-ID(9:2).                    
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-2    AFTER 2.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-3    AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-4    AFTER 2.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-5    AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-6    AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-7    AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-8    AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-9    AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-10   AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-10A  AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-HDG-11   AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-SUBHDG-1 AFTER 3.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-SUBHDG-2 AFTER 1.              
            WRITE L416I-PRINT-REC  FROM PRT-L416-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L416I-PRINT-REC.                        
            WRITE L416I-PRINT-REC AFTER 1.                                      
                                                                                
       4760-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4770-PRINT-L416J-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13L416J'          TO L416-REPORT-ID.                         
            MOVE  WS-L416J-DESC      TO L416-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L416-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L416-TAG-DESC.                          
            ADD   1                  TO WS-L416J-PAGE-CNT.                      
            MOVE  WS-L416J-PAGE-CNT  TO L416-PAGE.                              
                                                                                
            MOVE "FINANCE'S COPY"          TO L416-COPY-NAME.                   
            IF F315-NUM-ADHOC-SF = 'Y'                                          
               MOVE '-A'             TO L416-REPORT-ID(9:2).                    
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.           
            MOVE SPACES              TO L416-REPORT-ID(9:2).                    
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-2    AFTER 2.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-3    AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-4    AFTER 2.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-5    AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-6    AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-7    AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-8    AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-9    AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-10   AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-10A  AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-HDG-11   AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-SUBHDG-1 AFTER 3.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-SUBHDG-2 AFTER 1.              
            WRITE L416J-PRINT-REC  FROM PRT-L416-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L416J-PRINT-REC.                        
            WRITE L416J-PRINT-REC AFTER 1.                                      
                                                                                
       4770-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-HEADER-F225.                                                  
      ******************************************************************        
            INITIALIZE    AG07F225-HEADER.                                      
            MOVE SPACES TO     AG07F225-HEADER.                                 
                                                                                
            MOVE    C907-NUM-DDD          TO   F225-NUM-DDD.                    
            MOVE    C907-NUM-FIN-YR       TO   F225-NUM-FIN-YEAR.               
            MOVE    C907-NUM-VR-SERIAL    TO   F225-NUM-VR-SERIAL.              
            MOVE    F225-NUM-VR           TO   WS-NUM-VOUCHER.                  
            MOVE    00                    TO   F225-NUM-REC-TYP.                
            MOVE   'PV'                   TO   F225-NUM-VR-TYP.                 
            MOVE   'TL'                   TO   F225-NUM-VR-SUB-TYP.             
            MOVE   'SOC'                  TO   F225-NUM-TRANS-TYP.              
            MOVE  FUNCTION CURRENT-DATE   TO   F225-DTE-VR-CREATE               
                                               F225-DTE-VR-PRT-FINAL            
            MOVE   'BP13C416'      TO   F225-NUM-VR-CREATE-USERID               
                                        F225-NUM-VR-PRT-FINAL-USERID            
            MOVE   'STPFEE  '             TO   F225-NUM-DDD-FILE-REF.           
            MOVE   'COMMISSIONER OF STAMP DUTIES'   TO  F225-NME-PAYEE1.        
            MOVE   '55'                            TO  F225-NUM-BLK-HSE.        
            MOVE   'NEWTON ROAD'                   TO  F225-NME-STREET.         
            MOVE   'REVENUE HOUSE'                 TO  F225-NME-BLDNG.          
            MOVE   '307987'                        TO  F225-NUM-POSTAL.         
      *     MOVE   'C/O SC(STAMPING) OF SALES UNIT' TO  F225-NME-STREET.        
      *     MOVE   'NG CHOO HONG  '     TO   F225-NME-COLL-OFFCR.               
            MOVE   'SALES AGREEMENT TEAM'  TO   F225-NME-COLL-OFFCR.            
            MOVE   '64903781'           TO   F225-NUM-COLL-OFFCR-PHONE.         
            MOVE   'SALES AGREEMENT TEAM' TO   F225-NME-CONTACT-OFFCR.          
      *     MOVE   '64903783'           TO   F225-NUM-CONTACT-PHONE.            
            MOVE   '64903781'           TO   F225-NUM-CONTACT-PHONE.            
            MOVE   'DBSSSGSGXXX'        TO   F225-NUM-PAYEE-BANK.               
            MOVE   SPACES               TO   F225-NUM-PAYEE-BANK-BRNCH.         
            MOVE   '0010468600'         TO   F225-NUM-PAYEE-IBG-ACCT.           
            MOVE   SPACES               TO   F225-NUM-ROOT-ACCT.                
            MOVE   SPACES               TO   F225-NUM-PAYEE-UIN1.               
            MOVE   SPACES               TO   F225-NME-PAYEE2.                   
            MOVE   SPACES               TO   F225-NUM-PAYEE-UIN2.               
            MOVE   SPACES               TO   F225-NUM-PAYEE-TAX-REGN.           
            MOVE   SPACES               TO   F225-TXT-REJECT-HDR.               
            MOVE   'STPFEE  '           TO   F225-NUM-INTRFC-FR-HDR.            
            MOVE   'CV'                 TO   F225-NUM-ACTION-TYP.               
            MOVE   SPACES               TO   F225-NUM-PRCS-TERM.                
            MOVE   SPACES               TO   F225-NUM-ROUTE-FLAG.               
            IF F315-USERID   = 'BP13P001'                                       
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP             
                                             F225-NUM-USERID-START              
            ELSE                                                                
              IF F315-USERID(1:7)   = 'EA29418'                                 
                 MOVE '29418G'            TO F225-NUM-STAFF-ID-PREP             
                                             F225-NUM-USERID-START              
              ELSE                                                              
                 MOVE F315-USERID         TO F225-NUM-STAFF-ID-PREP             
                                             F225-NUM-USERID-START              
              END-IF                                                            
            END-IF.                                                             
            MOVE   'PREP'               TO   F225-NUM-VCHR-STATE-START.         
            MOVE   SPACES               TO   F225-DTE-PYMNT-DUE.                
                                                                                
                                                                                
            WRITE AG07F225-HEADER.                                              
                                                                                
            ADD     1                     TO   WS-AG07F225-WRITE-CNT.           
            MOVE    C907-NUM-DDD          TO   WS-EDITED-NUM-DDD.               
            MOVE    C907-NUM-FIN-YR       TO   WS-EDITED-NUM-FIN-YEAR.          
            MOVE    C907-NUM-VR-SERIAL    TO   WS-EDITED-NUM-VR-SERIAL.         
            MOVE    WS-EDITED-VOUCHER-NO  TO   L416-VOUCHER-NO.                 
                                                                                
            MOVE    SPACES                TO   L416-BATCH-NO.                   
                                                                                
            STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE                       
                   WS-NUM-FIN-YEAR     DELIMITED BY SPACE                       
                   '-'                 DELIMITED BY SIZE                        
                   WS-NUM-BATCH-SERIAL DELIMITED BY SPACE                       
                   INTO L416-BATCH-NO                                           
            END-STRING.                                                         
                                                                                
            EVALUATE TRUE                                                       
            WHEN     REPORT-L416A                                               
               PERFORM 4620-PRINT-L416A-HEADER   THRU 4620-EXIT                 
            WHEN     REPORT-L416D                                               
               PERFORM 4710-PRINT-L416D-HEADER   THRU 4710-EXIT                 
            WHEN     REPORT-L416E                                               
               PERFORM 4720-PRINT-L416E-HEADER   THRU 4720-EXIT                 
            WHEN     REPORT-L416G                                               
               PERFORM 4740-PRINT-L416G-HEADER   THRU 4740-EXIT                 
            WHEN     REPORT-L416H                                               
               PERFORM 4750-PRINT-L416H-HEADER   THRU 4750-EXIT                 
            WHEN     REPORT-L416I                                               
               PERFORM 4760-PRINT-L416I-HEADER   THRU 4760-EXIT                 
            WHEN     REPORT-L416J                                               
               PERFORM 4770-PRINT-L416J-HEADER   THRU 4770-EXIT                 
            END-EVALUATE.                                                       
                                                                                
       5000-HEADER-EXIT.                                                        
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-TRANS-DETAIL-F225.                                            
      ******************************************************************        
            INITIALIZE  AG07F225-TRANS.                                         
            MOVE    SPACES             TO    AG07F225-TRANS.                    
            MOVE    WS-NUM-VOUCHER     TO    F225-NUM-VR-T.                     
            MOVE    WS-CNT-DETAILS     TO    F225-NUM-TRANS-SERIAL.             
            MOVE   '04'                TO    F225-NUM-SYS.                      
            MOVE    WS-SCH-ACCT-NO     TO    F225-NUM-HDB-REF.                  
            MOVE   '0000000104250'     TO    F225-NUM-GL-ACCT.                  
            MOVE    WS-AMT-TRANS       TO    F225-AMT-TRANS.                    
            MOVE   'D'                 TO    F225-NUM-TRANS-DR-CR.              
            MOVE    ZEROES             TO    F225-AMT-TRANS-GST.                
            MOVE    F315-REGN-NO       TO    F225-TXT-INFO.                     
            MOVE    SPACES             TO    F225-NUM-TAX-CDE.                  
            MOVE    SPACES             TO    F225-NUM-CPF.                      
            MOVE    SPACES             TO    F225-TXT-REJECT-DTL.               
            MOVE    'STPFEE  '          TO  F225-NUM-INTRFC-FR-T.               
                                                                                
            WRITE       AG07F225-TRANS.                                         
                                                                                
            ADD     1                  TO    WS-AG07F225-WRITE-CNT.             
                                                                                
       5000-DETAIL-EXIT.                                                        
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-TRAILER-F225.                                                 
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 5000-TRAILER-EXIT                                          
            END-IF.                                                             
                                                                                
            EVALUATE TRUE                                                       
            WHEN     REPORT-L416A                                               
               PERFORM 4210-PRINT-L416A-GRAND-TOTAL THRU 4210-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' A     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L416D                                               
               PERFORM 4240-PRINT-L416D-GRAND-TOTAL THRU 4240-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' D     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L416E                                               
               PERFORM 4250-PRINT-L416E-GRAND-TOTAL THRU 4250-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' E     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L416G                                               
               PERFORM 4270-PRINT-L416G-GRAND-TOTAL THRU 4270-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' G     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L416H                                               
               PERFORM 4280-PRINT-L416H-GRAND-TOTAL THRU 4280-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' H     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L416I                                               
               PERFORM 4290-PRINT-L416I-GRAND-TOTAL THRU 4290-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' I     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L416J                                               
               PERFORM 4295-PRINT-L416J-GRAND-TOTAL THRU 4295-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' J     '       WS-AMT-TOTAL                             
            END-EVALUATE.                                                       
                                                                                
            INITIALIZE AG07F225-TRAILER.                                        
            MOVE       SPACES             TO  AG07F225-TRAILER.                 
            MOVE       WS-NUM-VOUCHER     TO  F225-NUM-VR-R.                    
            MOVE       99                 TO  F225-NUM-TRAILER-SERIAL.          
            MOVE       'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                  
                                          TO  F225-TXT-VOUCHER-NARRATION        
            MOVE       WS-CNT-DETAILS     TO  F225-QTY-VR-TRANS.                
            MOVE       WS-AMT-TOTAL       TO  F225-AMT-VR-DR-TOTAL.             
            MOVE       ZEROES             TO  F225-AMT-VR-CR-TOTAL.             
            MOVE       SPACES             TO  F225-TXT-REJECT-TLR.              
            MOVE       'STPFEE  '         TO  F225-NUM-INTRFC-FR.               
                                                                                
            WRITE      AG07F225-TRAILER.                                        
                                                                                
            ADD        1                  TO    WS-AG07F225-WRITE-CNT.          
                                                                                
       5000-TRAILER-EXIT.                                                       
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5100-WRITE-BP13F316.                                                     
      ******************************************************************        
            MOVE BP13F315-TRANS-REC       TO BP13F316-REC.                      
            STRING  C907-NUM-DDD          DELIMITED BY SIZE                     
                    C907-NUM-FIN-YR       DELIMITED BY SIZE                     
                    C907-NUM-VR-SERIAL    DELIMITED BY SIZE                     
                                          INTO F316-VOUCHER-NO.                 
            MOVE    WS-CNT-DETAILS        TO   F316-SERIAL-NO.                  
            WRITE  BP13F316-REC.                                                
            ADD    1                      TO WS-BP13F316-WRITE-CNT.             
                                                                                
       5100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       6000-WRITE-STAMPING-FILE.                                                
      ******************************************************************        
            DISPLAY '6000-WRITE-STAMPING-FILE'.                                 
            INITIALIZE BP13K625-REC.                                            
            MOVE  SPACES                TO BP13K625-REC.                        
                                                                                
            MOVE F315-REGN-NO           TO K410-NUM-REGN.                       
            PERFORM 1400-READ-K410      THRU 1400-EXIT.                         
                                                                                
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.                      
            MOVE 'DAS'                  TO WS-NUM-DOC.                          
                                                                                
      ****  WRITE DETAIL PART FOR ORIGINAL MORTGAGE STAMP FEE*******            
            MOVE  'O'                   TO WS-NUM-DOC-TYP.                      
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
               IF WS-MORT-SF > 0                                                
                  COMPUTE WS-MORT-SF = WS-MORT-SF - DUP-DOA-AMT                 
               END-IF                                                           
            END-IF.                                                             
                                                                                
            MOVE  WS-MORT-SF             TO WS-AMT-STAMP-DUTY.                  
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY-DUP.              
                                                                                
            IF WS-AMT-STAMP-DUTY > 0                                            
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT                
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT                
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY                
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP            
               WRITE BP13K625-REC                                               
               ADD   1   TO  WS-BP13K625-WRITE-CNT                              
            ELSE                                                                
               NEXT SENTENCE                                                    
            END-IF.                                                             
                                                                                
      ****  WRITE DETAIL PART FOR DUPLICATE MORTGAGE STAMP FEE*******           
            MOVE  'D'                    TO WS-NUM-DOC-TYP.                     
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY.                  
            MOVE  WS-DUP-DOA             TO WS-AMT-STAMP-DUTY-DUP.              
                                                                                
            IF WS-AMT-STAMP-DUTY-DUP > 0                                        
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT                
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT                
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY                
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP            
               WRITE BP13K625-REC                                               
               ADD   1   TO  WS-BP13K625-WRITE-CNT                              
            ELSE                                                                
               NEXT SENTENCE                                                    
            END-IF.                                                             
                                                                                
      ****  MOVE MAIN DETAILS OF SUPPLEMENTAL AGREEMENT / LEASE STAMP           
      ****  FEE (SUA / ALE)                                                     
      ****  ONLY REPORT-L416A HAS SUPPLEMENTARY SA                              
                                                                                
            IF REPORT-L416A                                                     
               MOVE  'SUA'               TO WS-NUM-DOC                          
               MOVE  'O'                 TO WS-NUM-DOC-TYP                      
                                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  IF WS-SUP-SF > 0                                              
                     COMPUTE WS-SUP-SF = WS-SUP-SF - DUP-SA-AMT                 
                  END-IF                                                        
               END-IF                                                           
                                                                                
               MOVE  WS-SUP-SF           TO WS-AMT-STAMP-DUTY                   
               MOVE  ZEROES              TO WS-AMT-STAMP-DUTY-DUP               
                                                                                
               IF WS-AMT-STAMP-DUTY > 0                                         
                  PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT             
                  PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT             
                  MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY             
                  MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP         
                  WRITE BP13K625-REC                                            
                  ADD   1   TO  WS-BP13K625-WRITE-CNT                           
               ELSE                                                             
                  NEXT SENTENCE                                                 
               END-IF                                                           
                                                                                
               MOVE  'D'                 TO WS-NUM-DOC-TYP                      
               MOVE  ZEROES              TO WS-AMT-STAMP-DUTY                   
               MOVE  WS-DUP-SA           TO WS-AMT-STAMP-DUTY-DUP               
                                                                                
               IF WS-AMT-STAMP-DUTY-DUP > 0                                     
                  PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT             
                  PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT             
                  MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY             
                  MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP         
                  WRITE BP13K625-REC                                            
                  ADD   1   TO  WS-BP13K625-WRITE-CNT                           
               ELSE                                                             
                  NEXT SENTENCE                                                 
               END-IF                                                           
                                                                                
            ELSE                                                                
               MOVE  'ALE'               TO WS-NUM-DOC                          
               MOVE  'O'                 TO WS-NUM-DOC-TYP                      
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT                
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT                
               MOVE  WS-LEASE-STAMP      TO K625-AMT-STAMP-DUTY                 
               MOVE  ZEROES              TO K625-AMT-STAMP-DUTY-DUP             
               WRITE BP13K625-REC                                               
               ADD   1                   TO WS-BP13K625-WRITE-CNT               
                                                                                
               MOVE  'D'                 TO WS-NUM-DOC-TYP                      
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT                
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT                
               MOVE  ZEROES              TO K625-AMT-STAMP-DUTY                 
               MOVE  WS-DUP-SA           TO K625-AMT-STAMP-DUTY-DUP             
               WRITE BP13K625-REC                                               
               ADD   1                   TO WS-BP13K625-WRITE-CNT               
            END-IF.                                                             
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6100-CHK-EXISTING-BP13K625.                                              
      ******************************************************************        
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.                    
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                        
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.                    
           MOVE 1                       TO K625-NUM-DOC-CNT.                    
           MOVE 'N'                     TO WS-K625-EOF.                         
                                                                                
           START BP13K625 KEY = K625-KEY-FLD.                                   
                                                                                
           EVALUATE  WS-K625-STATUS                                             
              WHEN '00'                                                         
                    PERFORM 6200-READNEXT-BP13K625 THRU 6200-EXIT               
                            UNTIL WS-K625-EOF = 'Y'                             
                    ADD  1              TO WS-NUM-DOC-CNT                       
              WHEN '10'                                                         
              WHEN '23'                                                         
                    MOVE 1              TO WS-NUM-DOC-CNT                       
              WHEN OTHER                                                        
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '             
                    MOVE WS-K625-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6200-READNEXT-BP13K625.                                                  
      ******************************************************************        
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF                    
              GO TO 6200-EXIT.                                                  
                                                                                
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                        
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                        
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                           
              MOVE 'Y'                  TO WS-K625-EOF                          
              GO TO 6200-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.                      
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6300-MAIN-DETAILS-TO-K625.                                               
      ******************************************************************        
            MOVE  SPACES                 TO BP13K625-REC.                       
            INITIALIZE                      BP13K625-REC.                       
                                                                                
            MOVE  F315-SCH-ACC           TO K625-NUM-HDB-REF.                   
            MOVE  WS-NUM-DOC             TO K625-NUM-DOC.                       
            MOVE  WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.                   
            MOVE  WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.                   
            MOVE  C907-NUM-DDD           TO K625-NUM-DDD.                       
            MOVE  C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.                  
            MOVE  C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.                 
            MOVE  C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.                
            MOVE  C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.                  
            MOVE  C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.              
            MOVE  F315-REGN-NO           TO K625-NUM-REGN.                      
            MOVE  K410-DTE-KEY-ISSUE     TO K625-DTE-DOC-PREPARE.               
            MOVE  K410-AMT-SELLING-PRICE TO K625-AMT-PURCHASE-PRICE.            
            MOVE  WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.               
            MOVE  SPACES                 TO K625-NUM-INCREASE-SCCC.             
            MOVE  K410-AMT-LOAN          TO K625-AMT-LOAN.                      
            MOVE  'BP13C416'             TO K625-NUM-SYSTEM.                    
            MOVE  FUNCTION CURRENT-DATE  TO K625-DTE-UPDATE.                    
                                                                                
      ****  STUDIO APT ARE OF 30 YRS LEASE  *******                             
      ****  IT IS OF CDE-MODL-DESG OF 80 OR 89  *******                         
            IF F315-CDE-MODL-DESG = '80' OR '89' OR '92'                        
               COMPUTE K625-NUM-LEASE-TERM = 30 * 12                            
            ELSE                                                                
               COMPUTE K625-NUM-LEASE-TERM = 99 * 12                            
            END-IF.                                                             
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6500-PRINT-L416K-REPORT.                                                 
      ******************************************************************        
           IF WS-L416K-REC-ON-PAGE-CNT > 65                                     
              PERFORM 6510-PRINT-L416-HEADER     THRU 6510-EXIT                 
           END-IF.                                                              
                                                                                
           MOVE SPACES                TO L416K-REC-DETAIL.                      
           INITIALIZE                    L416K-REC-DETAIL.                      
                                                                                
           ADD  1                     TO WS-L416K-PRINT-CNT.                    
           MOVE WS-L416K-PRINT-CNT    TO L416K-SERIAL-NO.                       
           MOVE F315-REGN-NO          TO L416K-REGN-NO.                         
                                                                                
           STRING F315-SCH-ACC(1:4) '-'                                         
                  F315-SCH-ACC(5:4) '-'                                         
                  F315-SCH-ACC(9:1) '-'                                         
                  F315-SCH-ACC(10:2)                                            
                  DELIMITED BY SIZE INTO L416K-SCH-ACC                          
           END-STRING.                                                          
                                                                                
           STRING C907-NUM-DDD    '-'                                           
                  C907-NUM-FIN-YR '-'                                           
                  C907-NUM-VR-SERIAL                                            
                  DELIMITED BY SIZE INTO L416K-JR-VCHR-NO                       
           END-STRING.                                                          
                                                                                
           MOVE WS-AMT-EARMARK    TO L416K-AMT-TOTAL.                           
                                                                                
           EVALUATE B902-CDE-ERROR-ACCT(1)                                      
              WHEN 'S0045'                                                      
                 MOVE 'B05K006 FILE ERROR'         TO L416K-ERROR-DESC          
              WHEN 'S0052'                                                      
                 MOVE 'INVALID INPUT      '        TO L416K-ERROR-DESC          
              WHEN 'S0053'                                                      
                 MOVE 'AB05K009 FILE ERROR'        TO L416K-ERROR-DESC          
              WHEN 'S0054'                                                      
                 MOVE 'B05K006 REC NOT FND'        TO L416K-ERROR-DESC          
              WHEN 'S0055'                                                      
                 MOVE 'NOT ENOUGH BALANCE'         TO L416K-ERROR-DESC          
              WHEN OTHER                                                        
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L416K-ERROR-DESC          
           END-EVALUATE.                                                        
                                                                                
           WRITE L416K-PRINT-REC  FROM L416K-REC-DETAIL  AFTER 1.               
                                                                                
           ADD   1     TO  WS-L416K-REC-ON-PAGE-CNT.                            
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       6510-PRINT-L416-HEADER.                                                  
      ******************************************************************        
           ADD  1      TO WS-L416K-PAGE-CNT.                                    
           MOVE WS-L416K-PAGE-CNT    TO  L416-PAGE.                             
           MOVE 'P13L416K'           TO  L416-REPORT-ID.                        
           WRITE L416K-PRINT-REC  FROM PRT-L416-HDG-1    AFTER PAGE.            
           WRITE L416K-PRINT-REC  FROM L416K-HEADER2     AFTER 2.               
           WRITE L416K-PRINT-REC  FROM L416K-HEADER3     AFTER 2.               
           WRITE L416K-PRINT-REC  FROM L416K-UNDERLINE   AFTER 1.               
           MOVE  6     TO  WS-L416K-REC-ON-PAGE-CNT.                            
                                                                                
       6510-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       8000-DISPLAY-STATISTICS.                                                 
      ******************************************************************        
            MOVE    WS-BP13F315-READ-CNT  TO  WS-EDIT-BP13F315-READ.            
            MOVE    WS-L416A-PRINT-CNT    TO  WS-EDIT-L416A-PRINT.              
            MOVE    WS-L416D-PRINT-CNT    TO  WS-EDIT-L416D-PRINT.              
            MOVE    WS-L416E-PRINT-CNT    TO  WS-EDIT-L416E-PRINT.              
            MOVE    WS-L416G-PRINT-CNT    TO  WS-EDIT-L416G-PRINT.              
            MOVE    WS-L416H-PRINT-CNT    TO  WS-EDIT-L416H-PRINT.              
            MOVE    WS-L416I-PRINT-CNT    TO  WS-EDIT-L416I-PRINT.              
            MOVE    WS-L416J-PRINT-CNT    TO  WS-EDIT-L416J-PRINT.              
            MOVE    WS-AG07F225-WRITE-CNT TO  WS-EDIT-AG07F225-WRITE.           
            MOVE    WS-BP13F316-WRITE-CNT TO  WS-EDIT-BP13F316-WRITE.           
                                                                                
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-SUMMARY-HEADER.                                          
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-READ-CASES.                                              
            DISPLAY WS-DOA-PAYMENT-PRINTED.                                     
            DISPLAY WS-L416D-PRINTED.                                           
            DISPLAY WS-L416E-PRINTED.                                           
            DISPLAY WS-L416G-PRINTED.                                           
            DISPLAY WS-L416H-PRINTED.                                           
            DISPLAY WS-L416I-PRINTED.                                           
            DISPLAY WS-L416J-PRINTED.                                           
            DISPLAY WS-STAMP-FEES-REC-WRITTEN.                                  
            DISPLAY WS-F316-REC-WRITTEN.                                        
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-SUMMARY-TRAILER.                                         
            DISPLAY 'NO OF RECORDS WRITTEN TO             (BP13K625) = '        
                    WS-BP13K625-WRITE-CNT.                                      
            DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = '        
                    WS-L416K-PRINT-CNT.                                         
                                                                                
       8000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       9000-CLOSE-FILES.                                                        
      ******************************************************************        
      *     CLOSE  B05K006                                                      
            CLOSE  BP13F315                                                     
                   BP13F316                                                     
                   AG07F225                                                     
                   BP13K410                                                     
                   BP13416A                                                     
                   BP13416D                                                     
                   BP13416E                                                     
                   BP13416G                                                     
                   BP13416H                                                     
                   BP13416I                                                     
                   BP13416J                                                     
                   BP13416K                                                     
                   BP13K625.                                                    
                                                                                
            IF WS-K006-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING B05K006, STAT = ' WS-K006-STATUS          
               MOVE     WS-K006-STATUS     TO  RETURN-CODE                      
            END-IF.                                                             
                                                                                
            IF WS-K410-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING BP13K410, STAT = ' WS-K410-STATUS         
               MOVE     WS-K410-STATUS      TO  RETURN-CODE                     
            END-IF.                                                             
                                                                                
            IF WS-K625-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING BP13K625, STAT = ' WS-K625-STATUS          
              MOVE     WS-K625-STATUS      TO  RETURN-CODE                      
            END-IF.                                                             
                                                                                
            MOVE 'AG07K960'  TO     C907-NUM-FILENME.                           
            CALL 'K960CLSE'  USING  AG07C907-AREA.                              
                                                                                
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR CLOSING AG07K960, STATUS = '                      
                        C907-NUM-FILE-STATUS                                    
               MOVE     C907-NUM-FILE-STATUS    TO     RETURN-CODE              
            END-IF.                                                             
                                                                                
            MOVE 'BP13K620'  TO     C906-NUM-FILENME.                           
            CALL 'K620MCLS'  USING  BP13C906-AREA.                              
                                                                                
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                       
               DISPLAY 'ERROR CLOSING BP13K620, STATUS = '                      
                        C906-NUM-FILE-STATUS                                    
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE              
            END-IF.                                                             
                                                                                
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')             
            MOVE SPACES              TO   WS-B902-AREA.                         
            INITIALIZE                    WS-B902-AREA.                         
            MOVE 'C'                 TO   B902-CDE-TYPE.                        
            CALL 'AB05C902'  USING WS-B902-AREA.                                
                                                                                
            IF B902-CDE-ERROR NOT = ZEROES                                      
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                           
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'                    
            END-IF.                                                             
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       9500-CONVT-AMT-WORD.                                                     
      ******************************************************************        
      *------------------------------------------------------------*            
      *                                                            *            
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *            
      *                              INTO AMOUNT IN WORDS          *            
      *                                                            *            
      *------------------------------------------------------------*            
            MOVE SPACES TO WF-DETAILS.                                          
            MOVE ZERO   TO WS-SWITCH                                            
                           WS-THO-SW                                            
                           WS-CNT-SW                                            
                           WS-LIT-SW                                            
                           WS-TEN-SW                                            
                           WS-AND-SW.                                           
            MOVE 60     TO WS-PLACE-COUNTER.                                    
            MOVE 1      TO WF-SUB.                                              
                                                                                
            PERFORM B000-ROUTINE THRU B990-EXIT                                 
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.          
                                                                                
       9500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       B000-ROUTINE SECTION.                                                    
      ******************************************************************        
       B000-GO.                                                                 
            IF WS-DIGIT (WS-SUB) = ZERO                                         
                 IF WS-TEN-SW = ZERO                                            
                    GO TO B800-MOVE-TYPE                                        
                 ELSE                                                           
                    GO TO B010-PROCESS.                                         
                                                                                
            IF WS-FIRST-SUB = ZERO                                              
               MOVE WS-SUB TO WS-FIRST-SUB.                                     
                                                                                
            IF WS-SWITCH = ZERO                                                 
               MOVE 1 TO WS-SWITCH.                                             
                                                                                
       B010-PROCESS.                                                            
            IF WS-SUB = 8                                                       
               MOVE 9 TO WS-CNT-SW.                                             
                                                                                
            IF WS-SUB = 9                                                       
               IF WS-CNT-SW = ZERO                                              
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                          
                                                                                
            IF WS-SUB = 2 OR 3 OR 4                                             
               MOVE 1 TO WS-THO-SW.                                             
                                                                                
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                                   
            IF WS-SUB = 3 OR 6 OR 8                                             
               IF WS-DIGIT (WS-SUB) = 1                                         
                  MOVE 1 TO WS-TEN-SW                                           
                  GO TO B990-EXIT                                               
               ELSE                                                             
                  ADD 18 TO WA-SUB                                              
            ELSE                                                                
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                        
               IF WS-TEN-SW = 1                                                 
                  MOVE 0 TO WS-TEN-SW                                           
                  ADD 10 TO WA-SUB.                                             
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                                   
            PERFORM R000-LOAD-IN.                                               
                                                                                
       B300-TENS.                                                               
            IF WS-SUB = 3 OR 6 OR 8                                             
               GO TO B990-EXIT.                                                 
                                                                                
       B400-MOVE-HUNDRED.                                                       
            IF WS-SUB = 2 OR 5                                                  
               MOVE L-HUNDRED TO WL-AREA                                        
               MOVE 1 TO WS-LIT-SW                                              
               PERFORM R000-LOAD-IN                                             
               MOVE 1 TO WS-AND-SW                                              
               GO TO B990-EXIT.                                                 
                                                                                
       B800-MOVE-TYPE.                                                          
            IF WS-SWITCH = ZERO                                                 
               GO TO B990-EXIT.                                                 
                                                                                
            IF WS-SUB = 1                                                       
               MOVE  L-MILLION TO WL-AREA                                       
               MOVE  1         TO WS-LIT-SW                                     
               MOVE  1         TO WS-AND-SW                                     
               GO TO B880-LOAD-IN.                                              
                                                                                
            IF WS-SUB = 7                                                       
               MOVE 1 TO WS-LIT-SW WS-AND-SW                                    
               IF WS-FIRST-SUB = 7  AND                                         
                  WS-DIGIT (WS-SUB) = 1                                         
                  MOVE L-DOLLAR TO WL-AREA                                      
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
                  MOVE L-DOLLARS TO WL-AREA                                     
                  GO TO B880-LOAD-IN.                                           
                                                                                
            IF WS-SUB = 4 AND WS-THO-SW = 1                                     
               MOVE 1 TO WS-AND-SW WS-LIT-SW                                    
               MOVE L-THOUSAND TO WL-AREA                                       
               GO TO B880-LOAD-IN.                                              
                                                                                
            IF WS-SUB = 9                                                       
               MOVE 1 TO WS-LIT-SW                                              
               IF WS-CNT-SW = ZERO                                              
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
               IF WS-CNT-SW = 1                                                 
                  MOVE L-CENT TO WL-AREA                                        
                  PERFORM R000-LOAD-IN                                          
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
                  MOVE L-CENTS TO WL-AREA                                       
                  PERFORM R000-LOAD-IN                                          
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN.                                           
            GO TO B990-EXIT.                                                    
                                                                                
       B880-LOAD-IN.                                                            
            PERFORM R000-LOAD-IN.                                               
                                                                                
       B990-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       R000-LOAD-IN SECTION.                                                    
      ******************************************************************        
      *------------------------------------------------------------*            
      *                                                            *            
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *            
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *            
      *                                                            *            
      *------------------------------------------------------------*            
                                                                                
       R001-GO.                                                                 
            IF WS-LIT-SW = 1                                                    
               MOVE ZERO TO WS-LIT-SW                                           
               GO TO R050-CONT.                                                 
                                                                                
            IF WS-SUB = 2 OR 5                                                  
               GO TO R050-CONT.                                                 
                                                                                
       R025-ADD-TEST.                                                           
            IF WS-AND-SW NOT = 1                                                
               GO TO R050-CONT.                                                 
                                                                                
            MOVE ZERO TO WS-AND-SW.                                             
            MOVE WL-AREA TO WL-AREA-SAVE.                                       
            MOVE L-AND TO WL-AREA.                                              
            PERFORM R200-LOADUP.                                                
            MOVE WL-AREA-SAVE TO WL-AREA.                                       
                                                                                
       R050-CONT.                                                               
            PERFORM R200-LOADUP.                                                
                                                                                
       R099-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       R200-LOADUP SECTION.                                                     
      ******************************************************************        
       R201-GO.                                                                 
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                               
            IF  WS-RESULT > WS-PLACE-COUNTER                                    
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                            
                ADD 60 TO WS-PLACE-COUNTER.                                     
                                                                                
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL                  
                    WL-ITEM (WL-SUB) = L-X.                                     
                                                                                
       R490-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       R500-LOAD SECTION.                                                       
      ******************************************************************        
       R501-GO.                                                                 
                                                                                
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                          
            ADD  1                TO WF-SUB.                                    
            IF WL-ITEM (WL-SUB) = SPACE                                         
               ADD   1     TO     WL-SUB                                        
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                              
               SUBTRACT 1  FROM   WL-SUB.                                       
                                                                                
       R990-EXIT.                                                               
            EXIT.                                                               
