      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C02E.                                                 
      *AUTHOR.        BALA                                                      
      *DTE WRITTEN.   25JUL2006.                                                
      **********************************************************                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *    SYSTEM ID   : BP13                                  *                
      **********************************************************                
      *                                                        *                
      *    OBJECTIVES  :                                       *                
      *                                                        *                
      *    1.  TO CREATE APPLICATION DATA ON DBSS REQUEST FOR  *                
      *         DEVELOPER VIA SFTP.                            *                
      *                                                        *                
      *    INPUT FILES : BP13FB78 - DBS FILE                   *                
      *                  BP13KA30 - DBS UNIT FILE              *                
      *                                                        *                
      *    OUTPUT FILE : BP13FB60 - FTP FILE TO BE SENT TO SIM *                
      *                             LIAN                       *                
      *                                                        *                
      *--------------------------------------------------------*                
      * CHG-NO   BY    DATE   DETAILS                          *                
      * ======= ====  ======  ================================ *                
      * BP132888 BA2  180706  CHANGE THE OUTPUT FILE           *                
      * BP13388  JB8  091008  READ KA30 TO GET SELECT INFO     *                
      * ====================================================== *                
                                                                                
      *-----------------------*                                                 
       ENVIRONMENT DIVISION.                                                    
      *-----------------------*                                                 
       CONFIGURATION SECTION.                                                   
      *-----------------------*                                                 
                                                                                
       SOURCE-COMPUTER. IBM-9121.                                               
       OBJECT-COMPUTER. IBM-9121.                                               
                                                                                
      *-----------------------*                                                 
       INPUT-OUTPUT SECTION.                                                    
      *-----------------------*                                                 
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13FB78 ASSIGN    TO BP13FB78.                               
                                                                                
           SELECT BP13FB60 ASSIGN    TO BP13FB60.                               
                                                                                
           SELECT BP13K200 ASSIGN       TO BP13K200                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K200-KEY-FLD                         
                           ALTERNATE RECORD KEY IS K200-NUM-REGN                
                           FILE STATUS  IS K200-STATUS.                         
                                                                                
           SELECT BP13KA30 ASSIGN       TO BP13KA30                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS KA30-KEY-FLD                         
                           ALTERNATE RECORD KEY IS KA30-NUM-REGN                
                           FILE STATUS  IS KA30-STATUS.                         
                                                                                
      *-----------------------*                                                 
       DATA DIVISION.                                                           
      *-----------------------*                                                 
       FILE SECTION.                                                            
      *-----------------------*                                                 
                                                                                
       FD   BP13FB78                                                            
            BLOCK      CONTAINS 0    RECORDS                                    
            RECORD     CONTAINS 3300 CHARACTERS                                 
            LABEL      RECORDS  ARE  STANDARD                                   
            RECORDING  MODE     IS  F.                                          
       COPY BP13FB78.                                                           
                                                                                
                                                                                
       FD   BP13FB60                                                            
            BLOCK     CONTAINS 0   RECORDS                                      
            RECORD    CONTAINS 2843 CHARACTERS                                  
            LABEL     RECORDS  ARE OMITTED                                      
            RECORDING MODE     IS  F.                                           
       COPY BP13FB60.                                                           
                                                                                
       FD   BP13K200                                                            
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY BP13K200.                                                           
                                                                                
       FD   BP13KA30                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13KA30.                                                           
                                                                                
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                                 
      *-----------------------*                                                 
                                                                                
       COPY IDPTABLE.                                                           
                                                                                
       01  WS-FILE-CONTROLS.                                                    
           05  WS-FB78-EOF-SW             PIC X(1)    VALUE 'N'.                
           05  K200-STATUS                PIC 9(2)    VALUE  0.                 
           05  KA30-STATUS                PIC 9(2)    VALUE  0.                 
                                                                                
       01  WS-RECORD-COUNTERS.                                                  
           05  WS-CNT-FB60                PIC 9(5) COMP VALUE 0.                
           05  WS-CNT-FB78                PIC 9(5) COMP VALUE 0.                
                                                                                
       01  WS-DATES.                                                            
           05  WS-EDITED-DATE.                                                  
               10  WS-EDITED-DD           PIC 9(2).                             
               10  FILLER                 PIC X(1)    VALUE '/'.                
               10  WS-EDITED-MM           PIC 9(2).                             
               10  FILLER                 PIC X(1)    VALUE '/'.                
               10  WS-EDITED-YY           PIC 9(4).                             
           05  WS-CURRENT-DATE.                                                 
               10  WS-CURR-CCYY.                                                
                   15  WS-CURR-YY         PIC 9(4).                             
               10  WS-CURR-MM             PIC 9(2).                             
               10  WS-CURR-DD             PIC 9(2).                             
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-TODAY-DATE.                                                   
               10  WS-SYS-YY              PIC 9(4).                             
               10  WS-SYS-MM              PIC 9(2).                             
               10  WS-SYS-DD              PIC 9(2).                             
           05  WS-TIME-NUM                PIC 9(9).                             
           05  WS-TIME REDEFINES WS-TIME-NUM.                                   
               10  WS-HH                  PIC 9(2).                             
               10  WS-MM                  PIC 9(2).                             
               10  WS-SS                  PIC 9(2).                             
               10  WS-GG                  PIC 9(2).                             
                                                                                
       01  WS-TEMPORARY-FIELDS.                                                 
           05  WS-TEMP-NAME               PIC X(66).                            
           05  WS-TEMP-DTE-BIRTH          PIC X(10).                            
           05  WS-TEMP-REGN               PIC X(8).                             
           05  WS-TEMP-NRIC               PIC X(9).                             
           05  WS-TEMP-MSTATUS            PIC X(1).                             
           05  WS-TEMP-INCOME             PIC X(5).                             
           05  WS-TEMP-CITIZENSHIP        PIC X(2).                             
           05  WS-TEMP-RELATIONSHIP       PIC X(2).                             
           05  WS-TEMP-LESSEE             PIC X(1).                             
           05  WS-TEMP-RACE               PIC X(1).                             
           05  WS-TEMP-SEX                PIC X(1).                             
           05  WS-TEMP-NRIC-SPOUSE        PIC X(9).                             
           05  WS-TEMP-EDN-LVL            PIC X(1).                             
           05  WS-TEMP-PHONE              PIC X(8).                             
           05  WS-TEMP-HP-PAGER           PIC X(8).                             
                                                                                
       01  WS-OTHERS.                                                           
           05  WS-OCC-REL                 PIC X(2).                             
           05  WS-TMP-REL                 PIC X(2).                             
           05  WS-TMP-EDN                 PIC 9(1).                             
           05  WS-FOUND-SW                PIC X(1)    VALUE 'N'.                
           05  WS-DESC                    PIC X(3)    VALUE SPACES.             
                                                                                
      *-----------------------*                                                 
       PROCEDURE DIVISION.                                                      
      *-----------------------*                                                 
                                                                                
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
           PERFORM  1000-OPEN-FILES         THRU 1000-EXIT.                     
           PERFORM  2000-MAIN-ROUTINE       THRU 2000-EXIT.                     
           PERFORM  9000-CLOSE-FILES        THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-FILES.                                                         
      ******************************************************************        
           OPEN INPUT  BP13FB78                                                 
                       BP13K200                                                 
                       BP13KA30                                                 
                OUTPUT BP13FB60.                                                
                                                                                
           IF K200-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K200 FILE, ' K200-STATUS               
              PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT.                   
                                                                                
           IF KA30-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13KA30 FILE, ' KA30-STATUS               
              PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT.                   
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-SYSTEM-DATE                         
           MOVE   WS-SYS-YY                TO    WS-EDITED-YY                   
                                                 WS-CURR-YY.                    
           MOVE   WS-SYS-MM                TO    WS-EDITED-MM                   
                                                 WS-CURR-MM.                    
           MOVE   WS-SYS-DD                TO    WS-EDITED-DD                   
                                                 WS-CURR-DD.                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2000-MAIN-ROUTINE.                                                       
      ******************************************************************        
           PERFORM  3000-BP13FB78-READ     THRU 3000-EXIT.                      
                                                                                
           PERFORM  4000-PROCESS-FB78-REC  THRU 4000-EXIT                       
              UNTIL WS-FB78-EOF-SW = 'Y'.                                       
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       3000-BP13FB78-READ.                                                      
      ******************************************************************        
           READ BP13FB78                                                        
              AT END MOVE 'Y'     TO WS-FB78-EOF-SW                             
              GO TO  3000-EXIT                                                  
           END-READ.                                                            
                                                                                
           ADD +1                 TO WS-CNT-FB78.                               
                                                                                
           PERFORM 3100-EDIT-NUMERIC-FIELDS    THRU 3100-EXIT.                  
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       3100-EDIT-NUMERIC-FIELDS.                                                
      **********************************************************                
           INSPECT FB78-AMT-APPLT1-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-APPLT2-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-APPLT3-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-APPLT4-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-OCCUP1-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-OCCUP2-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-OCCUP3-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-OCCUP4-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-OCCUP5-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FB78-AMT-OCCUP6-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS.                                
                                                                                
           INSPECT FB78-AMT-OCCUP7-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS.                                
                                                                                
           INSPECT FB78-AMT-OCCUP8-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS.                                
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4000-PROCESS-FB78-REC.                                                   
      **********************************************************                
                                                                                
           IF FB78-NUM-REGN      = SPACE OR LOW-VALUES                          
              PERFORM 3000-BP13FB78-READ THRU 3000-EXIT                         
              GO TO 4000-EXIT.                                                  
                                                                                
           PERFORM 4300-FB60-WRITE         THRU 4300-EXIT.                      
           PERFORM 3000-BP13FB78-READ      THRU 3000-EXIT.                      
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************************************************                
       4150-MOVE-SPOU-NRIC.                                                     
      **********************************************************                
      *--------------------------------------------------------*                
      * GET THE SPOUSE NRIC FROM FB78 AND MOVE TO K825         *                
      *--------------------------------------------------------*                
           MOVE SPACES  TO WS-TEMP-NRIC-SPOUSE.                                 
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-OCC-REL = '20'                                               
      *    ---MOVE THE HUSBUND NRIC TO WIFE'S    SPOUSE-NRIC FIELD              
                MOVE FB78-NUM-APPLT1-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN WS-OCC-REL = '00'                                               
      *    ---MOVE THE WIFE OR FIANCE NRIC TO HUSBUND'S SPOUSE-NRIC             
                MOVE '20'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '02'                                               
      *    ---MOVE THE MOTHER  NRIC TO FATHER'S  SPOUSE-NRIC FIELD              
                MOVE '12'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '12'                                               
      *    ---MOVE THE FATHER  NRIC TO MOTHER'S  SPOUSE-NRIC FIELD              
                MOVE '02'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '32'                                               
      *    ---MOVE THE FATHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC              
                MOVE '22'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '22'                                               
      *    ---MOVE THE MOTHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC              
                MOVE '32'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '98'                                               
      *    ---MOVE THE PARENTS NRIC                                             
                MOVE '98'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '01'                                               
      *    ---MOVE THE MOTHER-IN-LAW NRIC                                       
                MOVE '01'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '97'                                               
      *    ---MOVE THE MOTHER-IN-LAW NRIC                                       
                MOVE '97'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           END-EVALUATE.                                                        
                                                                                
       4150-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4175-GET-SPOUSE.                                                         
      **********************************************************                
      *--------------------------------------------------------*                
      * GET THE SPOUSE NRIC FROM FB78 AND MOVE TO K825         *                
      *--------------------------------------------------------*                
           EVALUATE TRUE                                                        
           WHEN FB78-NUM-APPLT2-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-APPLT2-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-APPLT2-UIN TO WS-TEMP-NRIC-SPOUSE                 
                                                                                
           WHEN FB78-NUM-APPLT3-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-APPLT3-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-APPLT3-UIN TO WS-TEMP-NRIC-SPOUSE                 
                                                                                
           WHEN FB78-NUM-APPLT4-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-APPLT4-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-APPLT4-UIN TO WS-TEMP-NRIC-SPOUSE                 
                                                                                
           WHEN FB78-NUM-OCCUP1-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP1-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP1-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FB78-NUM-OCCUP2-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP2-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP2-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FB78-NUM-OCCUP3-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP3-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP3-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FB78-NUM-OCCUP4-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP4-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP4-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FB78-NUM-OCCUP5-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP5-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP5-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FB78-NUM-OCCUP6-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP6-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP6-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FB78-NUM-OCCUP7-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP7-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP7-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FB78-NUM-OCCUP8-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FB78-NUM-OCCUP8-UIN NOT = WS-TEMP-NRIC                          
                MOVE FB78-NUM-OCCUP8-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           END-EVALUATE.                                                        
                                                                                
       4175-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4250-WRITE-CO-APPL.                                                      
      **********************************************************                
      *------------> APPLICANT  1                                               
           IF FB78-NUM-APPLT1-UIN NOT = SPACES                                  
              MOVE FB78-NUM-APPLT1-UIN            TO                            
                   FB60-NUM-APPLT1-UIN                                          
              MOVE FB78-NME-APPLT1                TO                            
                   FB60-NME-APPLT1                                              
              MOVE FB78-DTE-APPLT1-BIRTH          TO                            
                   FB60-DTE-APPLT1-BIRTH                                        
              MOVE FB78-NUM-APPLT1-RACE           TO                            
                   FB60-NUM-APPLT1-RACE                                         
              MOVE FB78-NUM-APPLT1-SEX            TO                            
                   FB60-NUM-APPLT1-SEX                                          
              MOVE FB78-NUM-APPLT1-MARITAL-STATUS TO                            
                   FB60-NUM-APPLT1-MARITAL-STATUS                               
              MOVE FB78-AMT-APPLT1-INCOME         TO                            
                   FB60-AMT-APPLT1-INCOME                                       
              MOVE FB78-NUM-APPLT1-EMPLY-STATUS   TO                            
                   FB60-NUM-APPLT1-EMPLY-STATUS                                 
              MOVE FB78-NME-APPLT1-OCCUPATION     TO                            
                   FB60-NME-APPLT1-OCCUPATION                                   
              MOVE FB78-NUM-APPLT1-PHONE          TO                            
                   FB60-NUM-APPLT1-PHONE                                        
              MOVE FB78-NUM-APPLT1-HP-PAGER       TO                            
                   FB60-NUM-APPLT1-HP-PAGER                                     
              MOVE FB78-NUM-APPLT1-EDN-LVL        TO                            
                   FB60-NUM-APPLT1-EDN-LVL                                      
              MOVE '00'                           TO WS-OCC-REL                 
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-APPLT1-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> APPLICANT  2                                               
           IF FB78-NUM-APPLT2-UIN NOT = SPACES                                  
              MOVE FB78-NUM-APPLT2-UIN            TO                            
                   FB60-NUM-APPLT2-UIN                                          
              MOVE FB78-NME-APPLT2                TO                            
                   FB60-NME-APPLT2                                              
              MOVE FB78-NUM-APPLT2-CITIZENSHIP    TO                            
                   FB60-NUM-APPLT2-CITIZENSHIP                                  
              MOVE FB78-DTE-APPLT2-BIRTH          TO                            
                   FB60-DTE-APPLT2-BIRTH                                        
              MOVE FB78-NUM-APPLT2-RACE           TO                            
                   FB60-NUM-APPLT2-RACE                                         
              MOVE FB78-NUM-APPLT2-SEX            TO                            
                   FB60-NUM-APPLT2-SEX                                          
              MOVE FB78-NUM-APPLT2-MARITAL-STATUS TO                            
                   FB60-NUM-APPLT2-MARITAL-STATUS                               
              MOVE FB78-NUM-APPLT2-RLTNSP-APPLT1  TO                            
                   FB60-NUM-APPLT2-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-APPLT2-INCOME         TO                            
                   FB60-AMT-APPLT2-INCOME                                       
              MOVE FB78-NUM-APPLT2-EMPLY-STATUS   TO                            
                   FB60-NUM-APPLT2-EMPLY-STATUS                                 
              MOVE FB78-NME-APPLT2-OCCUPATION     TO                            
                   FB60-NME-APPLT2-OCCUPATION                                   
              MOVE FB78-NUM-APPLT2-PHONE          TO                            
                   FB60-NUM-APPLT2-PHONE                                        
              MOVE FB78-NUM-APPLT2-HP-PAGER       TO                            
                   FB60-NUM-APPLT2-HP-PAGER                                     
              MOVE FB78-NUM-APPLT2-EDN-LVL        TO                            
                   FB60-NUM-APPLT2-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-APPLT2-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> APPLICANT  3                                               
           IF FB78-NUM-APPLT3-UIN NOT = SPACES                                  
              MOVE FB78-NUM-APPLT3-UIN            TO                            
                   FB60-NUM-APPLT3-UIN                                          
              MOVE FB78-NME-APPLT3                TO                            
                   FB60-NME-APPLT3                                              
              MOVE FB78-NUM-APPLT3-CITIZENSHIP    TO                            
                   FB60-NUM-APPLT3-CITIZENSHIP                                  
              MOVE FB78-DTE-APPLT3-BIRTH          TO                            
                   FB60-DTE-APPLT3-BIRTH                                        
              MOVE FB78-NUM-APPLT3-RACE           TO                            
                   FB60-NUM-APPLT3-RACE                                         
              MOVE FB78-NUM-APPLT3-SEX            TO                            
                   FB60-NUM-APPLT3-SEX                                          
              MOVE FB78-NUM-APPLT3-MARITAL-STATUS TO                            
                   FB60-NUM-APPLT3-MARITAL-STATUS                               
              MOVE FB78-NUM-APPLT3-RLTNSP-APPLT1  TO                            
                   FB60-NUM-APPLT3-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-APPLT3-INCOME         TO                            
                   FB60-AMT-APPLT3-INCOME                                       
              MOVE FB78-NUM-APPLT3-EMPLY-STATUS   TO                            
                   FB60-NUM-APPLT3-EMPLY-STATUS                                 
              MOVE FB78-NME-APPLT3-OCCUPATION     TO                            
                   FB60-NME-APPLT3-OCCUPATION                                   
              MOVE FB78-NUM-APPLT3-PHONE          TO                            
                   FB60-NUM-APPLT3-PHONE                                        
              MOVE FB78-NUM-APPLT3-HP-PAGER       TO                            
                   FB60-NUM-APPLT3-HP-PAGER                                     
              MOVE FB78-NUM-APPLT3-EDN-LVL        TO                            
                   FB60-NUM-APPLT3-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-APPLT3-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> APPLICANT  4                                               
           IF FB78-NUM-APPLT4-UIN NOT = SPACES                                  
              MOVE FB78-NUM-APPLT4-UIN            TO                            
                   FB60-NUM-APPLT4-UIN                                          
              MOVE FB78-NME-APPLT4                TO                            
                   FB60-NME-APPLT4                                              
              MOVE FB78-NUM-APPLT4-CITIZENSHIP    TO                            
                   FB60-NUM-APPLT4-CITIZENSHIP                                  
              MOVE FB78-DTE-APPLT4-BIRTH          TO                            
                   FB60-DTE-APPLT4-BIRTH                                        
              MOVE FB78-NUM-APPLT4-RACE           TO                            
                   FB60-NUM-APPLT4-RACE                                         
              MOVE FB78-NUM-APPLT4-SEX            TO                            
                   FB60-NUM-APPLT4-SEX                                          
              MOVE FB78-NUM-APPLT4-MARITAL-STATUS TO                            
                   FB60-NUM-APPLT4-MARITAL-STATUS                               
              MOVE FB78-NUM-APPLT4-RLTNSP-APPLT1  TO                            
                   FB60-NUM-APPLT4-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-APPLT4-INCOME         TO                            
                   FB60-AMT-APPLT4-INCOME                                       
              MOVE FB78-NUM-APPLT4-EMPLY-STATUS   TO                            
                   FB60-NUM-APPLT4-EMPLY-STATUS                                 
              MOVE FB78-NME-APPLT4-OCCUPATION     TO                            
                   FB60-NME-APPLT4-OCCUPATION                                   
              MOVE FB78-NUM-APPLT4-PHONE          TO                            
                   FB60-NUM-APPLT4-PHONE                                        
              MOVE FB78-NUM-APPLT4-HP-PAGER       TO                            
                   FB60-NUM-APPLT4-HP-PAGER                                     
              MOVE FB78-NUM-APPLT4-EDN-LVL        TO                            
                   FB60-NUM-APPLT4-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-APPLT4-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
                                                                                
       4250-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4260-WRITE-OCCUP.                                                        
      **********************************************************                
           MOVE SPACES                          TO WS-TEMP-NRIC-SPOUSE.         
                                                                                
      *------------> OCCUPANT  1                                                
           IF FB78-NUM-OCCUP1-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP1-UIN            TO                            
                   FB60-NUM-OCCUP1-UIN                                          
              MOVE FB78-NME-OCCUP1                TO                            
                   FB60-NME-OCCUP1                                              
              MOVE FB78-NUM-OCCUP1-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP1-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP1-BIRTH          TO                            
                   FB60-DTE-OCCUP1-BIRTH                                        
              MOVE FB78-NUM-OCCUP1-RACE           TO                            
                   FB60-NUM-OCCUP1-RACE                                         
              MOVE FB78-NUM-OCCUP1-SEX            TO                            
                   FB60-NUM-OCCUP1-SEX                                          
              MOVE FB78-NUM-OCCUP1-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP1-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP1-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP1-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP1-INCOME         TO                            
                   FB60-AMT-OCCUP1-INCOME                                       
              MOVE FB78-NUM-OCCUP1-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP1-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP1-OCCUPATION     TO                            
                   FB60-NME-OCCUP1-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP1-PHONE          TO                            
                   FB60-NUM-OCCUP1-PHONE                                        
              MOVE FB78-NUM-OCCUP1-HP-PAGER       TO                            
                   FB60-NUM-OCCUP1-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP1-EDN-LVL        TO                            
                   FB60-NUM-OCCUP1-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP1-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  2                                                
           IF FB78-NUM-OCCUP2-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP2-UIN            TO                            
                   FB60-NUM-OCCUP2-UIN                                          
              MOVE FB78-NME-OCCUP2                TO                            
                   FB60-NME-OCCUP2                                              
              MOVE FB78-NUM-OCCUP2-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP2-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP2-BIRTH          TO                            
                   FB60-DTE-OCCUP2-BIRTH                                        
              MOVE FB78-NUM-OCCUP2-RACE           TO                            
                   FB60-NUM-OCCUP2-RACE                                         
              MOVE FB78-NUM-OCCUP2-SEX            TO                            
                   FB60-NUM-OCCUP2-SEX                                          
              MOVE FB78-NUM-OCCUP2-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP2-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP2-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP2-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP2-INCOME         TO                            
                   FB60-AMT-OCCUP2-INCOME                                       
              MOVE FB78-NUM-OCCUP2-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP2-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP2-OCCUPATION     TO                            
                   FB60-NME-OCCUP2-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP2-PHONE          TO                            
                   FB60-NUM-OCCUP2-PHONE                                        
              MOVE FB78-NUM-OCCUP2-HP-PAGER       TO                            
                   FB60-NUM-OCCUP2-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP2-EDN-LVL        TO                            
                   FB60-NUM-OCCUP2-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP2-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  3                                                
           IF FB78-NUM-OCCUP3-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP3-UIN            TO                            
                   FB60-NUM-OCCUP3-UIN                                          
              MOVE FB78-NME-OCCUP3                TO                            
                   FB60-NME-OCCUP3                                              
              MOVE FB78-NUM-OCCUP3-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP3-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP3-BIRTH          TO                            
                   FB60-DTE-OCCUP3-BIRTH                                        
              MOVE FB78-NUM-OCCUP3-RACE           TO                            
                   FB60-NUM-OCCUP3-RACE                                         
              MOVE FB78-NUM-OCCUP3-SEX            TO                            
                   FB60-NUM-OCCUP3-SEX                                          
              MOVE FB78-NUM-OCCUP3-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP3-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP3-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP3-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP3-INCOME         TO                            
                   FB60-AMT-OCCUP3-INCOME                                       
              MOVE FB78-NUM-OCCUP3-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP3-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP3-OCCUPATION     TO                            
                   FB60-NME-OCCUP3-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP3-PHONE          TO                            
                   FB60-NUM-OCCUP3-PHONE                                        
              MOVE FB78-NUM-OCCUP3-HP-PAGER       TO                            
                   FB60-NUM-OCCUP3-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP3-EDN-LVL        TO                            
                   FB60-NUM-OCCUP3-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP3-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  4                                                
           IF FB78-NUM-OCCUP4-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP4-UIN            TO                            
                   FB60-NUM-OCCUP4-UIN                                          
              MOVE FB78-NME-OCCUP4                TO                            
                   FB60-NME-OCCUP4                                              
              MOVE FB78-NUM-OCCUP4-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP4-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP4-BIRTH          TO                            
                   FB60-DTE-OCCUP4-BIRTH                                        
              MOVE FB78-NUM-OCCUP4-RACE           TO                            
                   FB60-NUM-OCCUP4-RACE                                         
              MOVE FB78-NUM-OCCUP4-SEX            TO                            
                   FB60-NUM-OCCUP4-SEX                                          
              MOVE FB78-NUM-OCCUP4-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP4-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP4-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP4-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP4-INCOME         TO                            
                   FB60-AMT-OCCUP4-INCOME                                       
              MOVE FB78-NUM-OCCUP4-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP4-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP4-OCCUPATION     TO                            
                   FB60-NME-OCCUP4-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP4-PHONE          TO                            
                   FB60-NUM-OCCUP4-PHONE                                        
              MOVE FB78-NUM-OCCUP4-HP-PAGER       TO                            
                   FB60-NUM-OCCUP4-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP4-EDN-LVL        TO                            
                   FB60-NUM-OCCUP4-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP4-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  5                                                
           IF FB78-NUM-OCCUP5-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP5-UIN            TO                            
                   FB60-NUM-OCCUP5-UIN                                          
              MOVE FB78-NME-OCCUP5                TO                            
                   FB60-NME-OCCUP5                                              
              MOVE FB78-NUM-OCCUP5-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP5-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP5-BIRTH          TO                            
                   FB60-DTE-OCCUP5-BIRTH                                        
              MOVE FB78-NUM-OCCUP5-RACE           TO                            
                   FB60-NUM-OCCUP5-RACE                                         
              MOVE FB78-NUM-OCCUP5-SEX            TO                            
                   FB60-NUM-OCCUP5-SEX                                          
              MOVE FB78-NUM-OCCUP5-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP5-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP5-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP5-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP5-INCOME         TO                            
                   FB60-AMT-OCCUP5-INCOME                                       
              MOVE FB78-NUM-OCCUP5-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP5-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP5-OCCUPATION     TO                            
                   FB60-NME-OCCUP5-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP5-PHONE          TO                            
                   FB60-NUM-OCCUP5-PHONE                                        
              MOVE FB78-NUM-OCCUP5-HP-PAGER       TO                            
                   FB60-NUM-OCCUP5-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP5-EDN-LVL        TO                            
                   FB60-NUM-OCCUP5-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP5-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  6                                                
           IF FB78-NUM-OCCUP6-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP6-UIN            TO                            
                   FB60-NUM-OCCUP6-UIN                                          
              MOVE FB78-NME-OCCUP6                TO                            
                   FB60-NME-OCCUP6                                              
              MOVE FB78-NUM-OCCUP6-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP6-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP6-BIRTH          TO                            
                   FB60-DTE-OCCUP6-BIRTH                                        
              MOVE FB78-NUM-OCCUP6-RACE           TO                            
                   FB60-NUM-OCCUP6-RACE                                         
              MOVE FB78-NUM-OCCUP6-SEX            TO                            
                   FB60-NUM-OCCUP6-SEX                                          
              MOVE FB78-NUM-OCCUP6-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP6-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP6-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP6-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP6-INCOME         TO                            
                   FB60-AMT-OCCUP6-INCOME                                       
              MOVE FB78-NUM-OCCUP6-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP6-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP6-OCCUPATION     TO                            
                   FB60-NME-OCCUP6-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP6-PHONE          TO                            
                   FB60-NUM-OCCUP6-PHONE                                        
              MOVE FB78-NUM-OCCUP6-HP-PAGER       TO                            
                   FB60-NUM-OCCUP6-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP6-EDN-LVL        TO                            
                   FB60-NUM-OCCUP6-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP6-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  7                                                
           IF FB78-NUM-OCCUP7-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP7-UIN            TO                            
                   FB60-NUM-OCCUP7-UIN                                          
              MOVE FB78-NME-OCCUP7                TO                            
                   FB60-NME-OCCUP7                                              
              MOVE FB78-NUM-OCCUP7-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP7-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP7-BIRTH          TO                            
                   FB60-DTE-OCCUP7-BIRTH                                        
              MOVE FB78-NUM-OCCUP7-RACE           TO                            
                   FB60-NUM-OCCUP7-RACE                                         
              MOVE FB78-NUM-OCCUP7-SEX            TO                            
                   FB60-NUM-OCCUP7-SEX                                          
              MOVE FB78-NUM-OCCUP7-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP7-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP7-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP7-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP7-INCOME         TO                            
                   FB60-AMT-OCCUP7-INCOME                                       
              MOVE FB78-NUM-OCCUP7-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP7-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP7-OCCUPATION     TO                            
                   FB60-NME-OCCUP7-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP7-PHONE          TO                            
                   FB60-NUM-OCCUP7-PHONE                                        
              MOVE FB78-NUM-OCCUP7-HP-PAGER       TO                            
                   FB60-NUM-OCCUP7-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP7-EDN-LVL        TO                            
                   FB60-NUM-OCCUP7-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP7-SPOUSE-UIN                                   
                                                                                
      *------------> OCCUPANT  8                                                
           IF FB78-NUM-OCCUP8-UIN NOT = SPACES                                  
              MOVE FB78-NUM-OCCUP8-UIN            TO                            
                   FB60-NUM-OCCUP8-UIN                                          
              MOVE FB78-NME-OCCUP8                TO                            
                   FB60-NME-OCCUP8                                              
              MOVE FB78-NUM-OCCUP8-CITIZENSHIP    TO                            
                   FB60-NUM-OCCUP8-CITIZENSHIP                                  
              MOVE FB78-DTE-OCCUP8-BIRTH          TO                            
                   FB60-DTE-OCCUP8-BIRTH                                        
              MOVE FB78-NUM-OCCUP8-RACE           TO                            
                   FB60-NUM-OCCUP8-RACE                                         
              MOVE FB78-NUM-OCCUP8-SEX            TO                            
                   FB60-NUM-OCCUP8-SEX                                          
              MOVE FB78-NUM-OCCUP8-MARITAL-STATUS TO                            
                   FB60-NUM-OCCUP8-MARITAL-STATUS                               
              MOVE FB78-NUM-OCCUP8-RLTNSP-APPLT1  TO                            
                   FB60-NUM-OCCUP8-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FB78-AMT-OCCUP8-INCOME         TO                            
                   FB60-AMT-OCCUP8-INCOME                                       
              MOVE FB78-NUM-OCCUP8-EMPLY-STATUS   TO                            
                   FB60-NUM-OCCUP8-EMPLY-STATUS                                 
              MOVE FB78-NME-OCCUP8-OCCUPATION     TO                            
                   FB60-NME-OCCUP8-OCCUPATION                                   
              MOVE FB78-NUM-OCCUP8-PHONE          TO                            
                   FB60-NUM-OCCUP8-PHONE                                        
              MOVE FB78-NUM-OCCUP8-HP-PAGER       TO                            
                   FB60-NUM-OCCUP8-HP-PAGER                                     
              MOVE FB78-NUM-OCCUP8-EDN-LVL        TO                            
                   FB60-NUM-OCCUP8-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB60-NUM-OCCUP8-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
       4260-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4300-FB60-WRITE.                                                         
      **********************************************************                
                                                                                
           MOVE SPACES TO FB60-REC.                                             
                                                                                
           PERFORM  8000-MOVE-DELIMITER     THRU 8000-EXIT.                     
      * KEY FIELDS                                                              
           MOVE FB78-NUM-PROJECT                          TO                    
                FB60-NUM-PROJECT.                                               
           MOVE FB78-NUM-REGN                             TO                    
                FB60-NUM-REGN.                                                  
                                                                                
      * ESTATE APPLY FOR                                                        
           MOVE FB78-NUM-NEW-TOWN                         TO                    
                FB60-NUM-NEW-TOWN.                                              
           MOVE FB78-NUM-FLAT-TYPE                        TO                    
                FB60-NUM-FLAT-TYPE.                                             
                                                                                
      ** INTEREST IN ANOTHER HDB FLAT                                           
           MOVE FB78-NUM-FLAT-INHERIT                     TO                    
                FB60-NUM-FLAT-INHERIT.                                          
           MOVE FB78-NME-PRSN1-INHERIT                    TO                    
                FB60-NME-PRSN1-INHERIT.                                         
           MOVE FB78-NUM-PRSN1-UIN-INHERIT                TO                    
                FB60-NUM-PRSN1-UIN-INHERIT.                                     
           MOVE FB78-TXT-PRSN1-ADDR-INHERIT               TO                    
                FB60-TXT-PRSN1-ADDR-INHERIT.                                    
           MOVE FB78-NME-PRSN2-INHERIT                    TO                    
                FB60-NME-PRSN2-INHERIT.                                         
           MOVE FB78-NUM-PRSN2-UIN-INHERIT                TO                    
                FB60-NUM-PRSN2-UIN-INHERIT.                                     
           MOVE FB78-TXT-PRSN2-ADDR-INHERIT               TO                    
                FB60-TXT-PRSN2-ADDR-INHERIT.                                    
           MOVE FB78-NME-PRSN2-INHERIT                    TO                    
                FB60-NME-PRSN2-INHERIT.                                         
           MOVE FB78-NUM-PRSN2-UIN-INHERIT                TO                    
                FB60-NUM-PRSN2-UIN-INHERIT.                                     
           MOVE FB78-TXT-PRSN2-ADDR-INHERIT               TO                    
                FB60-TXT-PRSN2-ADDR-INHERIT.                                    
                                                                                
      * INTEREST IN A PRIVATE PROPERTY                                          
           MOVE FB78-NUM-OWN-PTE-PRTY                     TO                    
                FB60-NUM-OWN-PTE-PRTY.                                          
           MOVE FB78-NUM-DISPOSED-PTE-PRTY                TO                    
                FB60-NUM-DISPOSED-PTE-PRTY.                                     
                                                                                
      * CORRESPONDING ADDRESS                                                   
           MOVE FB78-NUM-MAIN-BLK                         TO                    
                FB60-NUM-MAIN-BLK.                                              
           MOVE FB78-NUM-SUB-BLK                          TO                    
                FB60-NUM-SUB-BLK.                                               
           MOVE FB78-NUM-LEVEL                            TO                    
                FB60-NUM-LEVEL.                                                 
           MOVE FB78-NUM-MAIN-UNIT                        TO                    
                FB60-NUM-MAIN-UNIT.                                             
           MOVE FB78-NUM-SUB-UNIT                         TO                    
                FB60-NUM-SUB-UNIT.                                              
           MOVE FB78-NUM-CORRESP-STREET                   TO                    
                FB60-NUM-CORRESP-STREET.                                        
           MOVE FB78-CDE-CORRESP-POST                     TO                    
                FB60-CDE-CORRESP-POST.                                          
                                                                                
      * MCPS DETAILS                                                            
           MOVE FB78-NUM-MCP-PRIORITY                     TO                    
                FB60-NUM-CHILD-PARENT-TAG.                                      
           MOVE FB78-NME-CHILD1-PARENT                    TO                    
                FB60-NME-CHILD1-PARENT.                                         
           MOVE FB78-NUM-CHILD1-PARENT-UIN                TO                    
                FB60-NUM-CHILD1-PARENT-UIN.                                     
           MOVE FB78-NUM-CHILD1-PARENT-MARSTAT            TO                    
                FB60-NUM-CHILD1-PARENT-MARSTAT.                                 
           MOVE FB78-NUM-CHILD1-PARENT-RLTNSP             TO                    
                FB60-NUM-CHILD1-PARENT-RLTNSP.                                  
           MOVE FB78-NUM-CHILD1-PARENT-CITIZEN            TO                    
                FB60-NUM-CHILD1-PARENT-CITIZEN.                                 
           MOVE FB78-NME-CHILD2-PARENT                    TO                    
                FB60-NME-CHILD2-PARENT.                                         
           MOVE FB78-NUM-CHILD2-PARENT-UIN                TO                    
                FB60-NUM-CHILD2-PARENT-UIN.                                     
           MOVE FB78-NUM-CHILD2-PARENT-MARSTAT            TO                    
                FB60-NUM-CHILD2-PARENT-MARSTAT.                                 
           MOVE FB78-NUM-CHILD2-PARENT-RLTNSP             TO                    
                FB60-NUM-CHILD2-PARENT-RLTNSP.                                  
           MOVE FB78-NUM-CHILD2-PARENT-CITIZEN            TO                    
                FB60-NUM-CHILD2-PARENT-CITIZEN.                                 
           MOVE FB78-NUM-CP-BLK-MAIN                      TO                    
                FB60-NUM-CP-BLK-MAIN.                                           
           MOVE FB78-NUM-CP-BLK-SUB                       TO                    
                FB60-NUM-CP-BLK-SUB.                                            
           MOVE FB78-NUM-CP-LEVEL                         TO                    
                FB60-NUM-CP-LEVEL.                                              
           MOVE FB78-NUM-CP-MAIN-UNIT                     TO                    
                FB60-NUM-CP-MAIN-UNIT.                                          
           MOVE FB78-NUM-CP-SUB-UNIT                      TO                    
                FB60-NUM-CP-SUB-UNIT.                                           
           MOVE FB78-NME-CP-STREET                        TO                    
                FB60-NME-CP-STREET.                                             
           MOVE FB78-NUM-CP-POST                          TO                    
                FB60-NUM-CP-POST.                                               
                                                                                
      * TCP REQUEST                                                             
           MOVE FB78-NUM-TCP-REQ                          TO                    
                FB60-NUM-TCP-REQ.                                               
           MOVE FB78-DTE-CHILD-BIRTH                      TO                    
                FB60-DTE-CHILD-BIRTH                                            
                                                                                
      * CPF HG REQUEST                                                          
           MOVE FB78-NUM-CPFHG-REQ                        TO                    
                FB60-NUM-CPFHG-REQ.                                             
           MOVE FB78-NUM-AHG-REQ                          TO                    
                FB60-NUM-AHG-REQ.                                               
                                                                                
      * HDB LOAN REQUEST                                                        
           IF FB78-NUM-APPL-LOAN-REQ = 'H'                                      
              MOVE 'Y'                                    TO                    
                   FB60-NUM-HDB-LOAN-REQ                                        
              MOVE 'N'                                    TO                    
                   FB60-NUM-BANK-LOAN-REQ                                       
           END-IF.                                                              
           IF FB78-NUM-APPL-LOAN-REQ = 'B'                                      
              MOVE 'N'                                    TO                    
                   FB60-NUM-HDB-LOAN-REQ                                        
              MOVE 'Y'                                    TO                    
                   FB60-NUM-BANK-LOAN-REQ                                       
           END-IF.                                                              
           IF FB78-NUM-APPL-LOAN-REQ = 'N'                                      
              MOVE 'N'                                    TO                    
                   FB60-NUM-HDB-LOAN-REQ                                        
              MOVE 'N'                                    TO                    
                   FB60-NUM-BANK-LOAN-REQ                                       
           END-IF.                                                              
                                                                                
      * DATE/TIME OF REQUEST                                                    
           MOVE FB78-DTE-REQUESTED                        TO                    
                FB60-DTE-REQUESTED.                                             
           MOVE FB78-TME-REQUESTED                        TO                    
                FB60-TME-REQUESTED.                                             
                                                                                
      * APPLICATION DETAILS                                                     
           MOVE FB78-NUM-STATUS(1:1)                      TO                    
                FB60-NUM-STATUS.                                                
           MOVE FB78-NUM-RACE                             TO                    
                FB60-NUM-ETHNIC.                                                
           MOVE FB78-NUM-HH                               TO                    
                FB60-NUM-HOUSEHOLD-TYPE.                                        
           MOVE FB78-CDE-ELIG-SCH                         TO                    
                FB60-CDE-ELIG-SCH.                                              
           MOVE FB78-CDE-ALLOC-SCH                        TO                    
                FB60-CDE-ALLOC-SCH.                                             
           MOVE FB78-NUM-DBSS-ELIG                        TO                    
                FB60-ELIG-TO-BUY.                                               
           MOVE FB78-NUM-EMAIL                            TO                    
                FB60-NUM-EMAIL.                                                 
                                                                                
      * BALLOTING INFORMATION                                                   
           MOVE FB78-CDE-SUCC-STATUS                      TO                    
                FB60-CDE-SUCC-STATUS.                                           
           MOVE FB78-NUM-QUEUE                            TO                    
                FB60-NUM-QUEUE.                                                 
           MOVE SPACES                                    TO                    
                FB60-DTE-BOOK-APPT.                                             
           MOVE SPACES                                    TO                    
                FB60-TME-BOOK-APPT.                                             
                                                                                
           MOVE FB78-NUM-HDB-ACT                          TO                    
                FB60-NUM-HDB-ACTING.                                            
                                                                                
      * ACCEPTANCE INFORMATION                                                  
           PERFORM 4500-READ-BP13KA30   THRU 4500-EXIT                          
           MOVE KA30-NUM-ACCEPT                        TO                       
                FB60-NUM-ACCEPTANCE                                             
           MOVE KA30-DTE-ACCEPT                        TO                       
                FB60-DTE-OPTION                                                 
           MOVE KA30-AMT-TRNSCT-SELL-PRICE             TO                       
                FB60-NUM-TRANSC-PRICE                                           
           MOVE KA30-AMT-OPTION-FEE                    TO                       
                FB60-NUM-OPTION-FEE                                             
           MOVE KA30-NUM-BLK(2:4)                      TO                       
                FB60-NUM-SELECT-BLK                                             
           MOVE SPACES                                 TO                       
                FB60-NUM-SELECT-SUB-BLK                                         
           MOVE KA30-NUM-LEVEL                         TO                       
                FB60-NUM-SELECT-LEVEL                                           
           MOVE KA30-NUM-MAIN-UNIT                     TO                       
                FB60-NUM-SELECT-MAIN-UNIT                                       
                                                                                
           PERFORM 4400-READ-BP13K200   THRU 4400-EXIT.                         
           PERFORM 4250-WRITE-CO-APPL   THRU 4250-EXIT.                         
           PERFORM 4260-WRITE-OCCUP     THRU 4260-EXIT.                         
                                                                                
           WRITE FB60-REC.                                                      
           ADD +1                 TO WS-CNT-FB60.                               
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4400-READ-BP13K200.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES        TO K200-KEY-FLD.                                  
           MOVE FB78-NUM-REGN TO K200-NUM-REGN.                                 
           READ BP13K200 KEY IS K200-NUM-REGN.                                  
                                                                                
           IF K200-STATUS = 00 OR 97                                            
              MOVE K200-DTE-BKAPPMT-DATE        TO                              
                   FB60-DTE-BOOK-APPT                                           
              MOVE K200-TME-BKAPPMT             TO                              
                   FB60-TME-BOOK-APPT                                           
           ELSE                                                                 
              IF K200-STATUS = 23                                               
                 DISPLAY '-REC NOT FND IN K200 ' FB78-NUM-REGN                  
              ELSE                                                              
                 DISPLAY '-- ERROR READING BP13K200, REGN '                     
                          FB78-NUM-REGN ', STATUS ' K200-STATUS                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4500-READ-BP13KA30.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES        TO BP13KA30-REC.                                  
           INITIALIZE            BP13KA30-REC.                                  
           MOVE FB78-NUM-REGN TO KA30-NUM-REGN.                                 
                                                                                
           READ BP13KA30 KEY IS KA30-NUM-REGN.                                  
                                                                                
           IF KA30-STATUS = 00 OR 97 OR 02                                      
              CONTINUE                                                          
           ELSE                                                                 
              IF K200-STATUS = 23                                               
                 DISPLAY '-REC NOT FND IN K200 ' FB78-NUM-REGN                  
              ELSE                                                              
                 DISPLAY '-- ERROR READING BP13K200, REGN '                     
                          FB78-NUM-REGN ', STATUS ' K200-STATUS                 
              END-IF                                                            
              MOVE SPACES        TO BP13KA30-REC                                
              INITIALIZE            BP13KA30-REC                                
           END-IF.                                                              
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------------------------------------------*             
       8000-MOVE-DELIMITER.                                                     
      *-----------------------------------------------------------*             
                                                                                
           MOVE ';' TO  FB60-FIL001 FB60-FIL011 FB60-FIL021                     
                        FB60-FIL002 FB60-FIL012 FB60-FIL022                     
                        FB60-FIL003 FB60-FIL013 FB60-FIL023                     
                        FB60-FIL004 FB60-FIL014 FB60-FIL024                     
                        FB60-FIL005 FB60-FIL015 FB60-FIL025                     
                        FB60-FIL006 FB60-FIL016 FB60-FIL026                     
                        FB60-FIL007 FB60-FIL017 FB60-FIL027                     
                        FB60-FIL008 FB60-FIL018 FB60-FIL028                     
                        FB60-FIL009 FB60-FIL019 FB60-FIL029                     
                        FB60-FIL010 FB60-FIL020 FB60-FIL030                     
                        FB60-FIL031 FB60-FIL041 FB60-FIL051                     
                        FB60-FIL032 FB60-FIL042 FB60-FIL052                     
                        FB60-FIL033 FB60-FIL043 FB60-FIL053                     
                        FB60-FIL034 FB60-FIL044 FB60-FIL054                     
                        FB60-FIL035 FB60-FIL045 FB60-FIL055                     
                        FB60-FIL036 FB60-FIL046 FB60-FIL056                     
                        FB60-FIL037 FB60-FIL047 FB60-FIL057                     
                        FB60-FIL038 FB60-FIL048 FB60-FIL058                     
                        FB60-FIL039 FB60-FIL049 FB60-FIL059                     
                        FB60-FIL040 FB60-FIL050 FB60-FIL060                     
                        FB60-FIL061 FB60-FIL071 FB60-FIL081                     
                        FB60-FIL062 FB60-FIL072 FB60-FIL082                     
                        FB60-FIL063 FB60-FIL073 FB60-FIL083                     
                        FB60-FIL064 FB60-FIL074 FB60-FIL084                     
                        FB60-FIL065 FB60-FIL075 FB60-FIL085                     
                        FB60-FIL066 FB60-FIL076 FB60-FIL086                     
                        FB60-FIL067 FB60-FIL077 FB60-FIL087                     
                        FB60-FIL068 FB60-FIL078 FB60-FIL088                     
                        FB60-FIL069 FB60-FIL079 FB60-FIL089                     
                        FB60-FIL070 FB60-FIL080 FB60-FIL090                     
                        FB60-FIL091 FB60-FIL101 FB60-FIL111                     
                        FB60-FIL092 FB60-FIL102 FB60-FIL112                     
                        FB60-FIL093 FB60-FIL103 FB60-FIL113                     
                        FB60-FIL094 FB60-FIL104 FB60-FIL114                     
                        FB60-FIL095 FB60-FIL105 FB60-FIL115                     
                        FB60-FIL096 FB60-FIL106 FB60-FIL116                     
                        FB60-FIL097 FB60-FIL107 FB60-FIL117                     
                        FB60-FIL098 FB60-FIL108 FB60-FIL118                     
                        FB60-FIL099 FB60-FIL109 FB60-FIL119                     
                        FB60-FIL100 FB60-FIL110 FB60-FIL120                     
                        FB60-FIL121 FB60-FIL131 FB60-FIL141                     
                        FB60-FIL122 FB60-FIL132 FB60-FIL142                     
                        FB60-FIL123 FB60-FIL133 FB60-FIL143                     
                        FB60-FIL124 FB60-FIL134 FB60-FIL144                     
                        FB60-FIL125 FB60-FIL135 FB60-FIL145                     
                        FB60-FIL126 FB60-FIL136 FB60-FIL146                     
                        FB60-FIL127 FB60-FIL137 FB60-FIL147                     
                        FB60-FIL128 FB60-FIL138 FB60-FIL148                     
                        FB60-FIL129 FB60-FIL139 FB60-FIL149                     
                        FB60-FIL130 FB60-FIL140 FB60-FIL150                     
                        FB60-FIL151 FB60-FIL161 FB60-FIL171                     
                        FB60-FIL152 FB60-FIL162 FB60-FIL172                     
                        FB60-FIL153 FB60-FIL163 FB60-FIL173                     
                        FB60-FIL154 FB60-FIL164 FB60-FIL174                     
                        FB60-FIL155 FB60-FIL165 FB60-FIL175                     
                        FB60-FIL156 FB60-FIL166 FB60-FIL176                     
                        FB60-FIL157 FB60-FIL167 FB60-FIL177                     
                        FB60-FIL158 FB60-FIL168 FB60-FIL178                     
                        FB60-FIL159 FB60-FIL169 FB60-FIL179                     
                        FB60-FIL160 FB60-FIL170 FB60-FIL180                     
                        FB60-FIL181 FB60-FIL191 FB60-FIL201                     
                        FB60-FIL182 FB60-FIL192 FB60-FIL202                     
                        FB60-FIL183 FB60-FIL193 FB60-FIL203                     
                        FB60-FIL184 FB60-FIL194 FB60-FIL204                     
                        FB60-FIL185 FB60-FIL195 FB60-FIL205                     
                        FB60-FIL186 FB60-FIL196 FB60-FIL206                     
                        FB60-FIL187 FB60-FIL197 FB60-FIL207                     
                        FB60-FIL188 FB60-FIL198 FB60-FIL208                     
                        FB60-FIL189 FB60-FIL199 FB60-FIL209                     
                        FB60-FIL190 FB60-FIL200 FB60-FIL210                     
                        FB60-FIL211 FB60-FIL221 FB60-FIL231                     
                        FB60-FIL212 FB60-FIL222 FB60-FIL232                     
                        FB60-FIL213 FB60-FIL223 FB60-FIL233                     
                        FB60-FIL214 FB60-FIL224 FB60-FIL234                     
                        FB60-FIL215 FB60-FIL225 FB60-FIL235                     
                        FB60-FIL216 FB60-FIL226 FB60-FIL236                     
                        FB60-FIL217 FB60-FIL227 FB60-FIL237                     
                        FB60-FIL218 FB60-FIL228 FB60-FIL238                     
                        FB60-FIL219 FB60-FIL229 FB60-FIL239                     
                        FB60-FIL220 FB60-FIL230 FB60-FIL240                     
                        FB60-FIL241 FB60-FIL242 FB60-FIL243                     
                        FB60-FIL244.                                            
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      **********************************************************                
       9000-CLOSE-FILES.                                                        
      **********************************************************                
           DISPLAY '******* CONTROL   TOTALS ********'.                         
           DISPLAY 'PROGRAM-ID : BP13C02E'.                                     
           DISPLAY '---------------------'.                                     
           DISPLAY 'NO OF BP13FB38 RECORDS READ..........: '                    
                    WS-CNT-FB78.                                                
           DISPLAY 'NO OF BP13FB60 RECORDS WRITTEN.......: '                    
                    WS-CNT-FB60.                                                
                                                                                
           CLOSE BP13FB78                                                       
                 BP13K200                                                       
                 BP13KA30                                                       
                 BP13FB60.                                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
