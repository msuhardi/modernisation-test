       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C524.                                                 
      *AUTHOR.        CHUNG SD.                                                 
      *DATE-WRITTEN.  22/01/90.                                                 
      *DATE-COMPILED.                                                           
       SKIP3                                                                    
      *REMARKS.                                                                 
      *****************************************************************         
      *                                                               *         
      *   SYSTEM NAME : SYSTEM OF COMMITMENT                          *         
      *                                                               *         
      *   OBJECTIVE   : THIS PROGRAM PRINTS SUMMARY LIST OF THE       *         
      *                 TENDER PROGRAM PRIOR TO PIGEONHILING AND      *         
      *                 AFTER  PIGEON-HOLED APPLICATION.              *         
      *                                                               *         
      *                                                               *         
      *   INPUT FILES :                                               *         
      *   1.  BP13F010 -- TENDER FILE SORTED                          *         
      *           ORGANISATION  : SEQ                                 *         
      *           ACCESS MODE   : SEQ                                 *         
      *           RECORD LENGTH : 300                                 *         
      *                                                                         
      *   1.  BP13F713 --                                             *         
      *           ORGANISATION  : SEQ                                 *         
      *           ACCESS MODE   : SEQ                                 *         
      *           RECORD LENGTH : 020                                 *         
      *                                                                         
      *   OUTPUT FILES:                                               *         
      *   1.  BP13L524 -- REPORT FILE                                 *         
      *           ORGANISATION  : SEQ                                 *         
      *           ACCESS MODE   : SEQ                                 *         
      *           RECORD LENGTH : 132                                 *         
      *                                                               *         
      *                                                               *         
      *   AMENDMENTS:                                                 *         
      *   REF      DATE      BY    DESCRIPTIONS                       *         
      *   -------  --------  ----  ------------                       *         
      *   C910299  18/04/91  LJL   TO INCLUDE REN AND RH/URO          *         
      *                            SEPARATELY.                        *         
      *   C910299  01/10/92  RAZ   TO INCLUDE PROCESS AND TIME IN     *         
      *                            REPORT.                            *         
      *   C9303B4  22/03/93  LJL   TO INCLUDE RDC (RENT DE-CONTROLLED *         
      *                            SCHEME).                           *         
      *   I920718  22/03/93  LJL   TO CONVERT TO COBOL2.              *         
      *   SOCPH9   27/09/94  JAI   TO INCLUDE TCP/JB FLAT SUPPLY      *         
      *   C9506F9  07/07/95  LSB   REPORT INDICATE CC1,CC2,CC3        *         
      *  BP130061  14/12/95  LSB   SUB-TOTAL FOR TCP                  *         
      *  BP130509  12/09/98  LSB   FLAT TYPE 1A,2A FOR STUDIO APRTMENT*         
      *  BP131024  17/07/01  CKK   CHECK FOR FLAT-TYPE = 00. BTO CASE *         
      *  BP132596  08/09/04  PGS1  WHILE PRINTING THE REPORT INCLUDE  *         
      *                            3-RM AND DELETE AWAY EXEC          *         
      *  BP132907  09/09/06  CKK7  CATER FOR 1 AND 2-ROOM REPORT      *         
      *  BP132927  10/11/06  CKK7  USE MTF COLUMN FOR PRIO (DBSS)     *         
      *  BP133142  21/09/07  LSB1  CHG REN POINTER FOR TOTAL COUNT    *         
      *  BP133832  12/02/10  ZDD1  CATER FOR 4P,5P AND SP FLAT TYPE   *         
      *  BP134914  13/06/13  SMR2  CATER FOR SAP SCHEME               *         
      *  BP135392  19/06/14  SMR2  CATER FOR 3P FLAT TYPE             *         
      *  BP136055  02/12/15  IL5   CATER FOR 2F FLAT TYPE             *         
      *  BP138600  25/02/21  SMP3  CATER FOR 1F FLAT TYPE             *         
      *****************************************************************         
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F010 ASSIGN TO BP13F010.                                  
                                                                                
           SELECT BP13F713 ASSIGN TO BP13F713.                                  
                                                                                
           SELECT BP13L524 ASSIGN TO BP13L524.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD BP13F010                                                              
            BLOCK CONTAINS    0 RECORDS                                         
            RECORD CONTAINS  600 CHARACTERS                                     
            RECORDING MODE IS F                                                 
            LABEL RECORD IS STANDARD.                                           
       COPY BP13F010.                                                           
                                                                                
       FD BP13F713                                                              
            BLOCK CONTAINS    0 RECORDS                                         
            RECORD CONTAINS  020 CHARACTERS                                     
            RECORDING MODE IS F                                                 
            LABEL RECORD IS STANDARD.                                           
       COPY BP13F713.                                                           
                                                                                
       FD  BP13L524                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
            RECORDING MODE IS F                                                 
           LABEL RECORDS ARE OMITTED.                                           
       01  PRINT-REC               PIC X(132).                                  
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-FLATNO               PIC 9.                                       
       01  WS-CNT-PAGE             PIC 9(5)    VALUE ZERO.                      
       01  WS-CNT-REC              PIC 9(3)    VALUE ZERO.                      
       01  WS-CNT                  PIC 9(2)    VALUE ZERO.                      
       01  WS-XCNT                 PIC 9       VALUE ZERO.                      
       01  WS-PREV-NT              PIC X(3)    VALUE SPACES.                    
       01  WS-NME-TYPE             PIC X(10)   VALUE SPACES.                    
       01  WS-TIME.                                                             
           05  WS-TIME-HH          PIC 9(02) VALUE 0.                           
           05  WS-TIME-MM          PIC 9(02) VALUE 0.                           
           05  WS-TIME-SS          PIC 9(02) VALUE 0.                           
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-F010-STATUS      PIC X       VALUE 'N'.                       
               88   WS-F010-EOF                VALUE 'Y'.                       
                                                                                
       01  WS-CUR-DATE.                                                         
           05  WS-DD               PIC 99.                                      
           05  FILLER              PIC X.                                       
           05  WS-MM               PIC 99.                                      
           05  FILLER              PIC X.                                       
           05  WS-YY               PIC 99.                                      
                                                                                
       01  WS-EDITED-DATE.                                                      
           05  WS-DD               PIC 99.                                      
           05  FILLER              PIC X      VALUE '/'.                        
           05  WS-MM               PIC 99.                                      
           05  FILLER              PIC X      VALUE '/'.                        
           05  WS-YY               PIC 99.                                      
                                                                                
       01  WS-FLAT-SUPPLY-TABLE.                                                
           05  WS-SUP-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-SUP-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-SUP-CAT     OCCURS 4 TIMES.                           
                       20  WS-SUP-QTY     PIC 9(5).                             
                                                                                
       01  WS-FLAT-REGISTERED-TABLE.                                            
           05  WS-REG-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-REG-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-REG-CAT     OCCURS 4 TIMES.                           
                       20  WS-REG-QTY     PIC 9(5).                             
                                                                                
       01  WS-FLAT-BALANCE-TABLE.                                               
           05  WS-BAL-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-BAL-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-BAL-CAT     OCCURS 4 TIMES.                           
                       20  WS-BAL-QTY     PIC 9(5).                             
                                                                                
       01  WS-FLAT-COM-TABLE.                                                   
           05  WS-COM-SCHEME-RECORD   OCCURS 9 TIMES.                           
               10  WS-COM-FLAT-TYPE   OCCURS 4 TIMES.                           
                   15  WS-COM-CAT     OCCURS 4 TIMES.                           
                       20  WS-COM-QTY     PIC 9(5).                             
                                                                                
      *  REPORT LAYOUT :                                                        
                                                                                
       01  L524-PRT-HEADING-1.                                                  
           05  FILLER              PIC X(8)      VALUE 'BP13L524'.              
           05  FILLER              PIC X(4)      VALUE SPACES .                 
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                    'S Y S T E M   O F   '.                     
           05  FILLER              PIC X(19)     VALUE                          
                                    'C O M M I T M E N T'.                      
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  L524-DATE           PIC X(8).                                    
           05  FILLER              PIC X(2)      VALUE ' ('.                    
           05  L524-TME-HH         PIC X(2).                                    
           05  FILLER              PIC X         VALUE ':'.                     
           05  L524-TME-MM         PIC X(2).                                    
           05  FILLER              PIC X(2)      VALUE ') '.                    
           05  FILLER              PIC X(4)      VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'PAGE : '.               
           05  L524-PAGENO         PIC ZZZZ9 .                                  
                                                                                
       01  L524-PRT-HEADING-2.                                                  
           05  FILLER                     PIC X(100) VALUE SPACES.              
           05  FILLER                     PIC X(32)  VALUE                      
               'SALES UNIT (REGISTRATION TEAM)'.                                
                                                                                
       01  L524-PRT-HEADING-3.                                                  
           05  FILLER              PIC X(19)     VALUE                          
                                   ' NEW TOWN / ZONE : '.                       
           05  L524-CDE-NT         PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(52)     VALUE                          
               'REPORT ON NUMBER OF FLATS AVAILABLE IN EACH NEW TOWN'.          
           05  FILLER              PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE                          
                                   'PROCESS : '.                                
           05  L524-PROCESS        PIC X(15)     VALUE SPACES.                  
                                                                                
      *01  L524-PRT-HEADING-4.                                                  
      *24* 05  FILLER              PIC X(12)     VALUE                          
      *                            ' NEW TOWN : '.                              
      *    05  L524-CDE-NT         PIC X(20)     VALUE SPACES.                  
      *    05  FILLER              PIC X(100)    VALUE SPACES.                  
                                                                                
       01  L524-PRT-HEADING-5.                                                  
           05  FILLER              PIC X(11) VALUE                              
               '  FLAT TYPE'.                                                   
           05  FILLER              PIC X(11) VALUE                              
               '          |'.                                                   
           05  HEAD5-DESC1         PIC X(27).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  HEAD5-DESC2         PIC X(27).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  HEAD5-DESC3         PIC X(27).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  FILLER              PIC X(26) VALUE                              
               '           TOTAL          '.                                    
                                                                                
       01  L524-PRT-HEADING-6.                                                  
           05  FILLER              PIC X(11) VALUE                              
               '-----------'.                                                   
           05  FILLER              PIC X(11) VALUE                              
               '----------|'.                                                   
           05  FILLER              PIC X(28) VALUE                              
               '---------------------------|'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '---------------------------|'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '---------------------------|'.                                  
           05  FILLER              PIC X(26) VALUE                              
               ALL '-'.                                                         
                                                                                
       01  L524-PRT-HEADING-7.                                                  
           05  FILLER              PIC X(11) VALUE                              
               '  CATEGORY'.                                                    
           05  FILLER              PIC X(11) VALUE                              
               '          |'.                                                   
           05  FILLER              PIC X(28) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL |'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL |'.                                  
           05  FILLER              PIC X(28) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL |'.                                  
           05  FILLER              PIC X(26) VALUE                              
               '  CAT1  CAT2  CAT3   TOTAL'.                                    
                                                                                
       01  L524-PRT-DETAILS.                                                    
           05  L524-NME-TYPE           PIC X(10)     VALUE SPACES.              
           05  FILLER                  PIC X(02)     VALUE SPACES.              
           05  L524-NME-SCHEME         PIC X(09)     VALUE SPACES.              
           05  FILLER                  PIC X(01)     VALUE SPACES.              
           05  L524-FLAT-RECORD    OCCURS 4 TIMES.                              
               15  L524-PRT-CAT1       PIC ZZZZ9.                               
               15  FILLER              PIC X(1).                                
               15  L524-PRT-CAT2       PIC ZZZZ9.                               
               15  FILLER              PIC X(1).                                
               15  L524-PRT-CAT3       PIC ZZZZ9.                               
               15  FILLER              PIC X(3).                                
               15  L524-PRT-TOT        PIC ZZZZ9.                               
               15  FILLER              PIC X(3).                                
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
                                                                                
      **********************************************************                
      *                                                        *                
      *    0000-MAIN-PROCESS                                   *                
      *        1000-OPEN-FILES                                 *                
      *        2000-PROCESS-BP13F010                           *                
      *            3000-SETUP-FLAT-TABLES                      *                
      *                3100-SETUP-SUPPLY-TABLE                 *                
      *                3200-SETUP-REGISTERED-TABLE             *                
      *            4000-COMPUTE-BALANCE                        *                
      *                4100-COMP-BY-SCHEME-TYPE                *                
      *                4200-COMP-BY-FLAT-TYPE                  *                
      *            5000-PRINT-FLAT-SUMMARY                     *                
      *                6000-PRINT-REPORT-HEADING               *                
      *                6100-PRINT-SUB-HEADING                  *                
      *                5100-PRINT-FLAT-DETAILS                 *                
      *                    5200-SETUP-FLAT-TYPE-QTY            *                
      *        9000-CLOSE-FILES                                *                
      **********************************************************                
                                                                                
      *******************                                                       
       0000-MAIN-PROCESS.                                                       
      *******************                                                       
                                                                                
           PERFORM  1000-OPEN-FILES                                             
              THRU  1000-EXIT.                                                  
                                                                                
           PERFORM  1500-READ-BP13F713                                          
              THRU  1500-EXIT.                                                  
                                                                                
      **  SET UP CURRENT DATE :                                                 
                                                                                
            ACCEPT WS-CUR-DATE    FROM DATE.                                    
            MOVE WS-CUR-DATE TO WS-EDITED-DATE .                                
            MOVE WS-EDITED-DATE   TO L524-DATE.                                 
                                                                                
            ACCEPT WS-TIME        FROM TIME.                                    
            MOVE WS-TIME-HH       TO L524-TME-HH.                               
            MOVE WS-TIME-MM       TO L524-TME-MM.                               
                                                                                
      **  READ AND PROCESS RECORD FROM BP13F010                                 
                                                                                
           MOVE ZEROS TO WS-FLAT-SUPPLY-TABLE                                   
                         WS-FLAT-REGISTERED-TABLE                               
                         WS-FLAT-BALANCE-TABLE                                  
                         WS-FLAT-COM-TABLE.                                     
                                                                                
           PERFORM  2000-PROCESS-BP13F010                                       
              THRU  2000-EXIT                                                   
             UNTIL  WS-F010-EOF.                                                
                                                                                
           DISPLAY '***  TOTAL NUMBER OF RECORDS PROCESSED = '                  
           WS-CNT-REC.                                                          
                                                                                
           PERFORM  9000-CLOSE-FILES                                            
              THRU  9000-EXIT.                                                  
                                                                                
       0000-EXIT.                                                               
           STOP RUN.                                                            
                                                                                
      *****************                                                         
       1000-OPEN-FILES.                                                         
      *****************                                                         
                                                                                
           OPEN   INPUT  BP13F010                                               
                         BP13F713                                               
                  OUTPUT BP13L524.                                              
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       1500-READ-BP13F713.                                                      
      ********************                                                      
                                                                                
           READ BP13F713  AT END                                                
                GO TO 1500-EXIT                                                 
           END-READ                                                             
                                                                                
           IF F713-CDE-COHORT = 'MT'                                            
              MOVE 'MTTCP/JB/RH/REN'     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'CC'                                            
              MOVE 'GRO            '     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'PA'                                            
              MOVE 'MAT/NON-MAT-PA '     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'NH'                                            
              MOVE 'NHH/UPG        '     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'TR'                                            
              MOVE 'TRANSITIONAL   '     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'RN'                                            
              MOVE 'ADD REN REQUEST'     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'BA'                                            
              MOVE 'NEW + BALANCE  '     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'C1'                                            
              MOVE 'GRO RESIDENT   '     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'C2'                                            
              MOVE 'GRO HPS-NONRES '     TO L524-PROCESS                        
           ELSE                                                                 
           IF F713-CDE-COHORT = 'C3'                                            
              MOVE 'GRO RES/NON-RES'     TO L524-PROCESS                        
           ELSE                                                                 
              MOVE F713-CDE-COHORT       TO L524-PROCESS.                       
                                                                                
       1500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***********************                                                   
       2000-PROCESS-BP13F010.                                                   
      ***********************                                                   
                                                                                
           READ BP13F010 AT END                                                 
               PERFORM 4000-COMPUTE-BALANCE                                     
                  THRU 4000-EXIT                                                
                PERFORM 5000-PRINT-FLAT-SUMMARY                                 
                   THRU 5000-EXIT                                               
                MOVE 'Y' TO WS-F010-STATUS                                      
                GO TO 2000-EXIT                                                 
           END-READ.                                                            
                                                                                
           ADD 1 TO WS-CNT-REC.                                                 
                                                                                
           IF WS-CNT-REC = 1                                                    
              IF F010-CDE-FLAT-TY = '3 ' OR '4 ' OR '5 ' OR '4P'                
                                         OR '5P' OR '4D' OR '5D'                
                 MOVE '            3-ROOM         ' TO HEAD5-DESC1              
                 MOVE '            4-ROOM         ' TO HEAD5-DESC2              
                 MOVE '            5-ROOM         ' TO HEAD5-DESC3              
              ELSE                                                              
              IF F010-CDE-FLAT-TY = '1A' OR '2A' OR 'E ' OR '1 ' OR '2 '        
                                         OR 'SP' OR 'ED' OR '2F'                
                 MOVE '           1-ROOM          ' TO HEAD5-DESC1              
                 MOVE '           2-ROOM          ' TO HEAD5-DESC2              
                 MOVE '           EXEC            ' TO HEAD5-DESC3              
              ELSE                                                              
              IF F010-CDE-FLAT-TY = '00'                                        
                 MOVE '              BTO          ' TO HEAD5-DESC1              
                 MOVE '                           ' TO HEAD5-DESC2              
                 MOVE '                           ' TO HEAD5-DESC3              
              ELSE                                                              
              IF F010-CDE-FLAT-TY = '3P'                                        
                 MOVE '           3P-ROOM         ' TO HEAD5-DESC1              
                 MOVE '            4-ROOM         ' TO HEAD5-DESC2              
                 MOVE '            5-ROOM         ' TO HEAD5-DESC3              
              ELSE                                                              
              IF F010-CDE-FLAT-TY = '1F'                                        
                 MOVE '             CCA           ' TO HEAD5-DESC1              
                 MOVE '            2-ROOM         ' TO HEAD5-DESC2              
                 MOVE '             EXEC          ' TO HEAD5-DESC3              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF  WS-PREV-NT = SPACES OR LOW-VALUES                                
               MOVE  F010-CDE-NT-ZONE  TO  WS-PREV-NT                           
           END-IF.                                                              
                                                                                
           IF  F010-CDE-NT-ZONE = WS-PREV-NT                                    
               PERFORM 3000-SETUP-FLAT-TABLES                                   
                  THRU 3000-EXIT                                                
           ELSE                                                                 
               PERFORM 4000-COMPUTE-BALANCE                                     
                  THRU 4000-EXIT                                                
               PERFORM 5000-PRINT-FLAT-SUMMARY                                  
                  THRU 5000-EXIT                                                
               MOVE  F010-CDE-NT-ZONE  TO  WS-PREV-NT                           
               MOVE  ZEROS        TO  WS-FLAT-SUPPLY-TABLE                      
                                      WS-FLAT-REGISTERED-TABLE                  
                                      WS-FLAT-BALANCE-TABLE                     
                                      WS-FLAT-COM-TABLE                         
               PERFORM 3000-SETUP-FLAT-TABLES                                   
                  THRU 3000-EXIT                                                
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       3000-SETUP-FLAT-TABLES.                                                  
      ************************                                                  
                                                                                
           IF F010-CDE-FLAT-TY = '3 '  OR '1A' OR '00' OR '1 ' OR 'SP'          
                                       OR '3P' OR '1F'                          
              MOVE  1  TO  WS-FLATNO                                            
           ELSE                                                                 
              IF F010-CDE-FLAT-TY = '4 ' OR '4D' OR '2A' OR '2 ' OR '4P'        
                                         OR '2F'                                
                 MOVE  2  TO  WS-FLATNO                                         
              ELSE                                                              
                 IF F010-CDE-FLAT-TY = '5 ' OR '5D' OR '5P' OR 'E '             
                                            OR 'ED'                             
                    MOVE  3  TO  WS-FLATNO                                      
                 ELSE                                                           
                    GO TO 3000-EXIT                                             
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 3100-SETUP-SUPPLY-TABLE                                      
              THRU 3100-EXIT.                                                   
                                                                                
           PERFORM 3200-SETUP-REGISTERED-TABLE                                  
              THRU 3200-EXIT.                                                   
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************                                                 
       3100-SETUP-SUPPLY-TABLE.                                                 
      *************************                                                 
                                                                                
           MOVE F010-NUM-MAX-PA1  TO  WS-SUP-QTY ( 1 , WS-FLATNO , 1).          
           MOVE F010-NUM-MAX-PA2  TO  WS-SUP-QTY ( 1 , WS-FLATNO , 2).          
           MOVE F010-NUM-MAX-PA3  TO  WS-SUP-QTY ( 1 , WS-FLATNO , 3).          
           MOVE F010-NUM-TOT-PA   TO  WS-SUP-QTY ( 1 , WS-FLATNO , 4).          
                                                                                
           ADD  F010-NUM-MAX-PA1  TO  WS-SUP-QTY ( 1 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 1).          
           ADD  F010-NUM-MAX-PA2  TO  WS-SUP-QTY ( 1 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 2).          
           ADD  F010-NUM-MAX-PA3  TO  WS-SUP-QTY ( 1 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 3).          
           ADD  F010-NUM-TOT-PA   TO  WS-SUP-QTY ( 1 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 4).          
                                                                                
           IF  F010-NUM-MAX-ELDER1 IS NOT NUMERIC                               
               MOVE ZEROS TO F010-NUM-MAX-ELDER1.                               
           IF  F010-NUM-MAX-ELDER2 IS NOT NUMERIC                               
               MOVE ZEROS TO F010-NUM-MAX-ELDER2.                               
           IF  F010-NUM-MAX-ELDER3 IS NOT NUMERIC                               
               MOVE ZEROS TO F010-NUM-MAX-ELDER3.                               
           IF  F010-NUM-TOT-ELDER IS NOT NUMERIC                                
               MOVE ZEROS TO F010-NUM-TOT-ELDER.                                
                                                                                
           MOVE F010-NUM-MAX-ELDER1 TO WS-SUP-QTY ( 2 , WS-FLATNO , 1).         
           MOVE F010-NUM-MAX-ELDER2 TO WS-SUP-QTY ( 2 , WS-FLATNO , 2).         
           MOVE F010-NUM-MAX-ELDER3 TO WS-SUP-QTY ( 2 , WS-FLATNO , 3).         
           MOVE F010-NUM-TOT-ELDER  TO WS-SUP-QTY ( 2 , WS-FLATNO , 4).         
                                                                                
           ADD  F010-NUM-MAX-ELDER1 TO WS-SUP-QTY ( 2 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , 4 , 1)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 1).         
           ADD  F010-NUM-MAX-ELDER2 TO WS-SUP-QTY ( 2 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , 4 , 2)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 2).         
           ADD  F010-NUM-MAX-ELDER3 TO WS-SUP-QTY ( 2 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , 4 , 3)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 3).         
           ADD  F010-NUM-TOT-ELDER  TO WS-SUP-QTY ( 2 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , 4 , 4)                  
                                       WS-SUP-QTY ( 9 , WS-FLATNO , 4).         
                                                                                
           MOVE F010-NUM-MAX-CCC1 TO  WS-SUP-QTY ( 3 , WS-FLATNO , 1).          
           MOVE F010-NUM-MAX-CCC2 TO  WS-SUP-QTY ( 3 , WS-FLATNO , 2).          
           MOVE F010-NUM-MAX-CCC3 TO  WS-SUP-QTY ( 3 , WS-FLATNO , 3).          
           MOVE F010-NUM-TOT-CCC  TO  WS-SUP-QTY ( 3 , WS-FLATNO , 4).          
                                                                                
           ADD  F010-NUM-MAX-CCC1 TO  WS-SUP-QTY ( 3 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 1).          
           ADD  F010-NUM-MAX-CCC2 TO  WS-SUP-QTY ( 3 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 2).          
           ADD  F010-NUM-MAX-CCC3 TO  WS-SUP-QTY ( 3 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 3).          
           ADD  F010-NUM-TOT-CCC  TO  WS-SUP-QTY ( 3 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 4).          
                                                                                
           MOVE F010-NUM-MAX-RH1  TO  WS-SUP-QTY ( 4 , WS-FLATNO , 1).          
           MOVE F010-NUM-MAX-RH2  TO  WS-SUP-QTY ( 4 , WS-FLATNO , 2).          
           MOVE F010-NUM-MAX-RH3  TO  WS-SUP-QTY ( 4 , WS-FLATNO , 3).          
           MOVE F010-NUM-TOT-RH   TO  WS-SUP-QTY ( 4 , WS-FLATNO , 4).          
                                                                                
           ADD  F010-NUM-MAX-RH1  TO  WS-SUP-QTY ( 4 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 1).          
           ADD  F010-NUM-MAX-RH2  TO  WS-SUP-QTY ( 4 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 2).          
           ADD  F010-NUM-MAX-RH3  TO  WS-SUP-QTY ( 4 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 3).          
           ADD  F010-NUM-TOT-RH   TO  WS-SUP-QTY ( 4 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 4).          
                                                                                
           MOVE F010-NUM-MAX-REN1 TO  WS-SUP-QTY ( 5 , WS-FLATNO , 1).          
           MOVE F010-NUM-MAX-REN2 TO  WS-SUP-QTY ( 5 , WS-FLATNO , 2).          
           MOVE F010-NUM-MAX-REN3 TO  WS-SUP-QTY ( 5 , WS-FLATNO , 3).          
           MOVE F010-NUM-TOT-REN  TO  WS-SUP-QTY ( 5 , WS-FLATNO , 4).          
                                                                                
           ADD  F010-NUM-MAX-REN1 TO  WS-SUP-QTY ( 5 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 1).          
           ADD  F010-NUM-MAX-REN2 TO  WS-SUP-QTY ( 5 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 2).          
           ADD  F010-NUM-MAX-REN3 TO  WS-SUP-QTY ( 5 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 3).          
           ADD  F010-NUM-TOT-REN  TO  WS-SUP-QTY ( 5 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 4).          
                                                                                
           MOVE F010-NUM-MAX-JB1  TO  WS-SUP-QTY ( 6 , WS-FLATNO , 1).          
           MOVE F010-NUM-MAX-JB2  TO  WS-SUP-QTY ( 6 , WS-FLATNO , 2).          
           MOVE F010-NUM-MAX-JB3  TO  WS-SUP-QTY ( 6 , WS-FLATNO , 3).          
           MOVE F010-NUM-TOT-JB   TO  WS-SUP-QTY ( 6 , WS-FLATNO , 4).          
                                                                                
           ADD  F010-NUM-MAX-JB1  TO  WS-SUP-QTY ( 6 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 1).          
           ADD  F010-NUM-MAX-JB2  TO  WS-SUP-QTY ( 6 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 2).          
           ADD  F010-NUM-MAX-JB3  TO  WS-SUP-QTY ( 6 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 3).          
           ADD  F010-NUM-TOT-JB   TO  WS-SUP-QTY ( 6 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 4).          
                                                                                
           MOVE F010-NUM-MAX-RDC1 TO  WS-SUP-QTY ( 7 , WS-FLATNO , 1).          
           MOVE F010-NUM-MAX-RDC2 TO  WS-SUP-QTY ( 7 , WS-FLATNO , 2).          
           MOVE F010-NUM-MAX-RDC3 TO  WS-SUP-QTY ( 7 , WS-FLATNO , 3).          
           MOVE F010-NUM-TOT-RDC  TO  WS-SUP-QTY ( 7 , WS-FLATNO , 4).          
                                                                                
           ADD  F010-NUM-MAX-RDC1 TO  WS-SUP-QTY ( 7 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 1).          
           ADD  F010-NUM-MAX-RDC2 TO  WS-SUP-QTY ( 7 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 2).          
           ADD  F010-NUM-MAX-RDC3 TO  WS-SUP-QTY ( 7 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 3).          
           ADD  F010-NUM-TOT-RDC  TO  WS-SUP-QTY ( 7 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 4).          
                                                                                
           IF  F010-NUM-MAX-TCP1  IS NOT NUMERIC                                
               MOVE ZEROS TO F010-NUM-MAX-TCP1.                                 
           IF  F010-NUM-MAX-TCP2  IS NOT NUMERIC                                
               MOVE ZEROS TO F010-NUM-MAX-TCP2.                                 
           IF  F010-NUM-MAX-TCP3  IS NOT NUMERIC                                
               MOVE ZEROS TO F010-NUM-MAX-TCP3.                                 
           IF  F010-NUM-TOT-TCP   IS NOT NUMERIC                                
               MOVE ZEROS TO F010-NUM-TOT-TCP.                                  
                                                                                
           MOVE F010-NUM-MAX-TCP1 TO  WS-SUP-QTY ( 8 , WS-FLATNO , 1).          
           MOVE F010-NUM-MAX-TCP2 TO  WS-SUP-QTY ( 8 , WS-FLATNO , 2).          
           MOVE F010-NUM-MAX-TCP3 TO  WS-SUP-QTY ( 8 , WS-FLATNO , 3).          
           MOVE F010-NUM-TOT-TCP  TO  WS-SUP-QTY ( 8 , WS-FLATNO , 4).          
                                                                                
           ADD  F010-NUM-MAX-TCP1 TO  WS-SUP-QTY ( 8 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , 4 , 1)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 1).          
           ADD  F010-NUM-MAX-TCP2 TO  WS-SUP-QTY ( 8 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , 4 , 2)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 2).          
           ADD  F010-NUM-MAX-TCP3 TO  WS-SUP-QTY ( 8 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , 4 , 3)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 3).          
           ADD  F010-NUM-TOT-TCP  TO  WS-SUP-QTY ( 8 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , 4 , 4)                   
                                      WS-SUP-QTY ( 9 , WS-FLATNO , 4).          
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************                                             
       3200-SETUP-REGISTERED-TABLE.                                             
      *****************************                                             
                                                                                
           MOVE F010-REG-PA1  TO  WS-REG-QTY ( 1 , WS-FLATNO , 1).              
           MOVE F010-REG-PA2  TO  WS-REG-QTY ( 1 , WS-FLATNO , 2).              
           MOVE F010-REG-PA3  TO  WS-REG-QTY ( 1 , WS-FLATNO , 3).              
           ADD  F010-REG-PA1                                                    
                F010-REG-PA2                                                    
                F010-REG-PA3  TO  WS-REG-QTY ( 1 , WS-FLATNO , 4).              
                                                                                
           ADD  F010-REG-PA1  TO  WS-REG-QTY ( 1 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F010-REG-PA2  TO  WS-REG-QTY ( 1 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F010-REG-PA3  TO  WS-REG-QTY ( 1 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 1 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 1 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
           IF   F010-REG-ELDER1 IS NOT NUMERIC                                  
                MOVE ZEROS TO F010-REG-ELDER1.                                  
           IF   F010-REG-ELDER2 IS NOT NUMERIC                                  
                MOVE ZEROS TO F010-REG-ELDER2.                                  
           IF   F010-REG-ELDER3 IS NOT NUMERIC                                  
                MOVE ZEROS TO F010-REG-ELDER3.                                  
                                                                                
           MOVE F010-REG-ELDER1 TO WS-REG-QTY ( 2 , WS-FLATNO , 1).             
           MOVE F010-REG-ELDER2 TO WS-REG-QTY ( 2 , WS-FLATNO , 2).             
           MOVE F010-REG-ELDER3 TO WS-REG-QTY ( 2 , WS-FLATNO , 3).             
           ADD  F010-REG-ELDER1                                                 
                F010-REG-ELDER2                                                 
                F010-REG-ELDER3 TO WS-REG-QTY ( 2 , WS-FLATNO , 4).             
                                                                                
           ADD  F010-REG-ELDER1 TO WS-REG-QTY ( 2 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , 4 , 1)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 1).             
           ADD  F010-REG-ELDER2 TO WS-REG-QTY ( 2 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , 4 , 2)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 2).             
           ADD  F010-REG-ELDER3 TO WS-REG-QTY ( 2 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , 4 , 3)                      
                                   WS-REG-QTY ( 9 , WS-FLATNO , 3).             
           ADD  WS-REG-QTY ( 2 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 2 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
                                                                                
           MOVE F010-REG-CCC1 TO  WS-REG-QTY ( 3 , WS-FLATNO , 1).              
           MOVE F010-REG-CCC2 TO  WS-REG-QTY ( 3 , WS-FLATNO , 2).              
           MOVE F010-REG-CCC3 TO  WS-REG-QTY ( 3 , WS-FLATNO , 3).              
           ADD  F010-REG-CCC1                                                   
                F010-REG-CCC2                                                   
                F010-REG-CCC3 TO  WS-REG-QTY ( 3 , WS-FLATNO , 4).              
                                                                                
           ADD  F010-REG-CCC1 TO  WS-REG-QTY ( 3 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F010-REG-CCC2 TO  WS-REG-QTY ( 3 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F010-REG-CCC3 TO  WS-REG-QTY ( 3 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 3 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 3 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
                                                                                
           MOVE F010-REG-RH1  TO  WS-REG-QTY ( 4 , WS-FLATNO , 1).              
           MOVE F010-REG-RH2  TO  WS-REG-QTY ( 4 , WS-FLATNO , 2).              
           MOVE F010-REG-RH3  TO  WS-REG-QTY ( 4 , WS-FLATNO , 3).              
           ADD  F010-REG-RH1                                                    
                F010-REG-RH2                                                    
                F010-REG-RH3  TO  WS-REG-QTY ( 4 , WS-FLATNO , 4).              
                                                                                
           ADD  F010-REG-RH1  TO  WS-REG-QTY ( 4 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F010-REG-RH2  TO  WS-REG-QTY ( 4 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F010-REG-RH3  TO  WS-REG-QTY ( 4 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 4 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 4 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
                                                                                
           MOVE F010-REG-REN1 TO  WS-REG-QTY ( 5 , WS-FLATNO , 1).              
           MOVE F010-REG-REN2 TO  WS-REG-QTY ( 5 , WS-FLATNO , 2).              
           MOVE F010-REG-REN3 TO  WS-REG-QTY ( 5 , WS-FLATNO , 3).              
           ADD  F010-REG-REN1                                                   
                F010-REG-REN2                                                   
                F010-REG-REN3 TO  WS-REG-QTY ( 5 , WS-FLATNO , 4).              
                                                                                
           ADD  F010-REG-REN1 TO  WS-REG-QTY ( 5 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F010-REG-REN2 TO  WS-REG-QTY ( 5 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F010-REG-REN3 TO  WS-REG-QTY ( 5 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 5 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 5 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
                                                                                
           MOVE F010-REG-JB1  TO  WS-REG-QTY ( 6 , WS-FLATNO , 1).              
           MOVE F010-REG-JB2  TO  WS-REG-QTY ( 6 , WS-FLATNO , 2).              
           MOVE F010-REG-JB3  TO  WS-REG-QTY ( 6 , WS-FLATNO , 3).              
           ADD  F010-REG-JB1                                                    
                F010-REG-JB2                                                    
                F010-REG-JB3  TO  WS-REG-QTY ( 6 , WS-FLATNO , 4).              
                                                                                
           ADD  F010-REG-JB1  TO  WS-REG-QTY ( 6 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F010-REG-JB2  TO  WS-REG-QTY ( 6 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F010-REG-JB3  TO  WS-REG-QTY ( 6 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 6 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 6 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
           MOVE F010-REG-RDC1 TO  WS-REG-QTY ( 7 , WS-FLATNO , 1).              
           MOVE F010-REG-RDC2 TO  WS-REG-QTY ( 7 , WS-FLATNO , 2).              
           MOVE F010-REG-RDC3 TO  WS-REG-QTY ( 7 , WS-FLATNO , 3).              
           ADD  F010-REG-RDC1                                                   
                F010-REG-RDC2                                                   
                F010-REG-RDC3 TO  WS-REG-QTY ( 7 , WS-FLATNO , 4).              
                                                                                
           ADD  F010-REG-RDC1 TO  WS-REG-QTY ( 7 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F010-REG-RDC2 TO  WS-REG-QTY ( 7 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F010-REG-RDC3 TO  WS-REG-QTY ( 7 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 7 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 7 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
           IF   F010-REG-TCP1 IS NOT NUMERIC                                    
                MOVE ZEROS TO F010-REG-TCP1.                                    
           IF   F010-REG-TCP2 IS NOT NUMERIC                                    
                MOVE ZEROS TO F010-REG-TCP2.                                    
           IF   F010-REG-TCP3 IS NOT NUMERIC                                    
                MOVE ZEROS TO F010-REG-TCP3.                                    
                                                                                
           MOVE F010-REG-TCP1 TO  WS-REG-QTY ( 8 , WS-FLATNO , 1).              
           MOVE F010-REG-TCP2 TO  WS-REG-QTY ( 8 , WS-FLATNO , 2).              
           MOVE F010-REG-TCP3 TO  WS-REG-QTY ( 8 , WS-FLATNO , 3).              
           ADD  F010-REG-TCP1                                                   
                F010-REG-TCP2                                                   
                F010-REG-TCP3 TO  WS-REG-QTY ( 8 , WS-FLATNO , 4).              
                                                                                
           ADD  F010-REG-TCP1 TO  WS-REG-QTY ( 8 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , 4 , 1)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 1).              
           ADD  F010-REG-TCP2 TO  WS-REG-QTY ( 8 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , 4 , 2)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 2).              
           ADD  F010-REG-TCP3 TO  WS-REG-QTY ( 8 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , 4 , 3)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 3).              
           ADD  WS-REG-QTY ( 8 , WS-FLATNO , 4)                                 
                              TO  WS-REG-QTY ( 8 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , 4 , 4)                       
                                  WS-REG-QTY ( 9 , WS-FLATNO , 4).              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4000-COMPUTE-BALANCE.                                                    
      **********************                                                    
                                                                                
           PERFORM 4100-COMP-BY-SCHEME-TYPE                                     
              THRU 4100-EXIT                                                    
           VARYING WS-CNT FROM 1 BY 1                                           
             UNTIL WS-CNT > 8.                                                  
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************                                                
       4100-COMP-BY-SCHEME-TYPE.                                                
      **************************                                                
                                                                                
           PERFORM 4200-COMP-BY-FLAT-TYPE                                       
              THRU 4200-EXIT                                                    
           VARYING WS-XCNT FROM 1 BY 1                                          
             UNTIL WS-XCNT > 3.                                                 
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       4200-COMP-BY-FLAT-TYPE.                                                  
      ************************                                                  
                                                                                
      ** COMPUTE  BALANCE UNDER EACH CATEGORY , FLAT TYPE                       
      ** AND SCHEME TYPE                                                        
                                                                                
           COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 1) =                         
              WS-SUP-QTY ( WS-CNT , WS-XCNT , 1)  -                             
              WS-REG-QTY ( WS-CNT , WS-XCNT , 1).                               
                                                                                
           COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 2) =                         
              WS-SUP-QTY ( WS-CNT , WS-XCNT , 2)  -                             
              WS-REG-QTY ( WS-CNT , WS-XCNT , 2).                               
                                                                                
           COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 3) =                         
              WS-SUP-QTY ( WS-CNT , WS-XCNT , 3)  -                             
              WS-REG-QTY ( WS-CNT , WS-XCNT , 3).                               
                                                                                
           COMPUTE WS-BAL-QTY ( WS-CNT , WS-XCNT , 4) =                         
              WS-SUP-QTY ( WS-CNT , WS-XCNT , 4)  -                             
              WS-REG-QTY ( WS-CNT , WS-XCNT , 4).                               
                                                                                
      ** COMPUTE SUB-TOTAL BALANCE UNDER EACH CATEGORY AND FLAT TYPE.           
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 1)  TO                           
                  WS-BAL-QTY ( 9 , WS-XCNT , 1).                                
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 2)  TO                           
                  WS-BAL-QTY ( 9 , WS-XCNT , 2).                                
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 3)  TO                           
                  WS-BAL-QTY ( 9 , WS-XCNT , 3).                                
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 4)  TO                           
                  WS-BAL-QTY ( 9 , WS-XCNT , 4).                                
                                                                                
      ** COMPUTE TOTAL BALANCE UNDER EACH CATEGORY AND SCHEME TYPE              
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 1)  TO                           
                  WS-BAL-QTY ( 9 , 4 , 1)                                       
                  WS-BAL-QTY ( WS-CNT , 4 , 1).                                 
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 2)  TO                           
                  WS-BAL-QTY ( 9 , 4 , 2)                                       
                  WS-BAL-QTY ( WS-CNT , 4 , 2).                                 
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 3)  TO                           
                  WS-BAL-QTY ( 9 , 4 , 3)                                       
                  WS-BAL-QTY ( WS-CNT , 4 , 3).                                 
                                                                                
           ADD WS-BAL-QTY ( WS-CNT , WS-XCNT , 4)  TO                           
                  WS-BAL-QTY ( 9 , 4 , 4)                                       
                  WS-BAL-QTY ( WS-CNT , 4 , 4).                                 
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************                                                 
       5000-PRINT-FLAT-SUMMARY.                                                 
      *************************                                                 
                                                                                
           PERFORM 6000-PRINT-REPORT-HEADING                                    
              THRU 6000-EXIT.                                                   
                                                                                
           MOVE  SPACES                TO  L524-PRT-DETAILS.                    
                                                                                
           MOVE 'SUPPLY'               TO  WS-NME-TYPE.                         
           MOVE  WS-FLAT-SUPPLY-TABLE  TO  WS-FLAT-COM-TABLE.                   
                                                                                
           PERFORM 6100-PRINT-SUB-HEADING                                       
              THRU 6100-EXIT.                                                   
                                                                                
           PERFORM 5100-PRINT-FLAT-DETAILS                                      
              THRU 5100-EXIT                                                    
           VARYING WS-CNT FROM 1 BY 1                                           
             UNTIL WS-CNT > 9.                                                  
                                                                                
           MOVE 'REGISTERED'               TO  WS-NME-TYPE.                     
           MOVE  WS-FLAT-REGISTERED-TABLE  TO  WS-FLAT-COM-TABLE.               
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
                                                                                
      *    PERFORM 6100-PRINT-SUB-HEADING                                       
      *       THRU 6100-EXIT.                                                   
                                                                                
           PERFORM 5100-PRINT-FLAT-DETAILS                                      
              THRU 5100-EXIT                                                    
           VARYING WS-CNT FROM 1 BY 1                                           
             UNTIL WS-CNT > 9.                                                  
                                                                                
           MOVE 'BALANCE'                  TO  WS-NME-TYPE.                     
           MOVE  WS-FLAT-BALANCE-TABLE     TO  WS-FLAT-COM-TABLE.               
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
                                                                                
      *    PERFORM 6100-PRINT-SUB-HEADING                                       
      *       THRU 6100-EXIT.                                                   
                                                                                
           PERFORM 5100-PRINT-FLAT-DETAILS                                      
              THRU 5100-EXIT                                                    
           VARYING WS-CNT FROM 1 BY 1                                           
             UNTIL WS-CNT > 9.                                                  
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************************************************                
       5100-PRINT-FLAT-DETAILS.                                                 
      **********************************************************                
                                                                                
           IF  WS-CNT = 1                                                       
               MOVE  'PUBLIC'    TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 2                                                       
               MOVE  'ELDERLY'   TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 3                                                       
               MOVE  'CCC    '   TO  L524-NME-SCHEME                            
               MOVE  WS-NME-TYPE TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 4                                                       
               MOVE  'URO    '   TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 5                                                       
               MOVE  'REN/TPS'   TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 6                                                       
               MOVE  'MGPS  '    TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 7                                                       
               MOVE  'RDC   '    TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 8                                                       
               MOVE  'TCP'       TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE                              
           ELSE                                                                 
           IF  WS-CNT = 9                                                       
               MOVE  'SUB-TOTAL' TO  L524-NME-SCHEME                            
               MOVE  SPACES      TO  L524-NME-TYPE.                             
                                                                                
           PERFORM 5200-SETUP-FLAT-TYPE-QTY                                     
              THRU 5200-EXIT                                                    
           VARYING WS-XCNT FROM 1 BY 1                                          
             UNTIL WS-XCNT > 4                                                  
                                                                                
           WRITE PRINT-REC  FROM L524-PRT-DETAILS.                              
                                                                                
           IF WS-CNT < 9                                                        
              MOVE ALL '-' TO PRINT-REC                                         
              WRITE PRINT-REC                                                   
           END-IF.                                                              
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************                                               
       5200-SETUP-FLAT-TYPE-QTY.                                                
      ***************************                                               
                                                                                
           MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 1 )                            
                TO  L524-PRT-CAT1 (WS-XCNT).                                    
                                                                                
           MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 2 )                            
                TO  L524-PRT-CAT2 (WS-XCNT).                                    
                                                                                
           MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 3 )                            
                TO  L524-PRT-CAT3 (WS-XCNT).                                    
                                                                                
           MOVE WS-COM-QTY  ( WS-CNT , WS-XCNT , 4 )                            
                TO  L524-PRT-TOT (WS-XCNT).                                     
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************                                               
       6000-PRINT-REPORT-HEADING.                                               
      ***************************                                               
                                                                                
            ADD        1       TO WS-CNT-PAGE.                                  
            MOVE  WS-CNT-PAGE  TO L524-PAGENO.                                  
                                                                                
            MOVE WS-PREV-NT TO L524-CDE-NT.                                     
                                                                                
            WRITE PRINT-REC FROM L524-PRT-HEADING-1 AFTER PAGE.                 
            WRITE PRINT-REC FROM L524-PRT-HEADING-3.                            
      *     WRITE PRINT-REC FROM L524-PRT-HEADING-4 AFTER 2.                    
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       6100-PRINT-SUB-HEADING.                                                  
      ************************                                                  
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC AFTER 1.                                            
                                                                                
            WRITE PRINT-REC FROM L524-PRT-HEADING-5.                            
            WRITE PRINT-REC FROM L524-PRT-HEADING-6.                            
            WRITE PRINT-REC FROM L524-PRT-HEADING-7.                            
                                                                                
            MOVE  ALL '=' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************                                                        
       9000-CLOSE-FILES.                                                        
      ******************                                                        
                                                                                
           CLOSE  BP13F010                                                      
                  BP13F713                                                      
                  BP13L524.                                                     
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
      *-------------------------------------------------------------*           
      *                             END                             *           
      *-------------------------------------------------------------*           
