       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C92F.                                                 
       AUTHOR.        KARL MAGALONA CABUG.                                      
      *DATE-WRITTEN.  03/12/2013.                                               
                                                                                
      *===============================================================*         
      *===         HDB SYSTEM OF COMMITMENT (BP13)                 ===*         
      *===============================================================*         
      *                                                               *         
      *  OBJECTIVES :                                                 *         
      *  APPLICATION PROFILE TO MND, LOAD TO SQL TABLE FOR BA         *         
      *  TO MATCH VARIOUS FILES AND FETCH DETAILS CORRESPONDING TO THE*         
      *  REGISTRATION NUMBER IN THE MASTER FILE, BP13F800             *         
      *                                                               *         
      *===============================================================*         
      * FILES DESCRIPTION :-                                          *         
      *                ACCESS      REC                                *         
      * DD NAME  I/O/E MODE        LEN  KEY          REMARKS          *         
      * -------  ----- -------     ---  ---          --------         *         
      * BP13F800 I     SEQUENTIAL  2000                               *         
      * BP13K820 I     DYNAMIC     400  K820-KEY-FLD                  *         
      * BP13K830 I     RANDOM      250  K830-KEY-FLD                  *         
      * BP13K060 I     RANDOM      25   K060-KEY-FLD                  *         
      * BP13K410 I     RANDOM      2000 K410-KEY-FLD                  *         
      * BP13K734 I     RANDOM      3000 K734-KEY-FLD                  *         
      * BP13K857 I     RANDOM      200  K857-KEY-FLD                  *         
      * BP13K840 I     RANDOM      200  K840-KEY-FLD                  *         
      * BP13FW3A 0                 500                                *         
      * BP13FW3B 0                 400                                *         
      * BP13FW3F 0                 350                                *         
      * BP13FW3G 0                 250                                *         
      *===============================================================*         
      * MODIFICATIONS :                                               *         
      *===============================================================*         
      * CHGE REQ # DATE       AUTHOR REMARKS                          *         
      * ------------------------------------------------------------- *         
      * BP135726   13/03/2013 KAM4   NEW PROGRAM MIRRORED FROM C92A   *         
      * BP135726   25/04/2014 KAM4   CATER FOR REVISED SALES FIELD    *         
      * BP135726   19/09/2014 KAM4   CATER FOR NUM-UNIT-ID FROM PIDB  *         
      * BP135726   16/02/2015 KAM4   ADDED FIELD CHECKING AND ISSUE FIX         
      * BP135919   29/09/2015 ZDD1   ADDED CA INCOME AND MAX LOAN               
      * BP136140   24/02/2016 ZDD1   ADDED NEW FIELDS                           
      * BP136140   24/02/2016 ZDD1   MOVE ZEROES WHEN NOT NUMERIC               
      *                              FOR AMT-PREMIUM                            
      * BP136893   05/01/2018 ZDD1   ADD CA-INCOME  AMT-INCOME-TP AND           
      *                              LOAN-SCH                                   
      * BP136911   13/07/2017 MRN1   USED CB4A TO GET DB2 FLDS        *         
      *                              INSTEAD OF K800/KD07/KD05        *         
      * BP137366   03/07/2018 KR13   ADDED 2 NEW O/P FILES FW3F & FW3G*         
      * BP138614   28/01/2021 FP6    ADD EHG IN AHG FIELD             *         
      *                              (SHARED FIELDS FOR EHG/AHG)     *          
      * BP138923   21/03/2022 KR13   ADDED 2 NEW O/P FILES FW3M & F955*         
      * BP138939   28/06/2022 KR13   SKIP FW3B,G WHEN CUSTID=SPACES & *         
      *                              SKIP FW3A,F,M WHEN ALL CUST=SPACES         
      * BP139506   10/03/2023 EAA2   ADDED A CHECK FOR LOW-VALUES     *         
      * BP138916   12/04/2023 EAA2   ADDED A CHECK FOR LOW-VALUES (OR)*         
      * BP139778   01/12/2023 EAA2   ADDED A FORCE EXIT IN PARAGRAPH  *         
      *                              6636-READ-BP13K845 AT END RECORD *         
      *****************************************************************         
                                                                                
      *--------------------*                                                    
       ENVIRONMENT DIVISION.                                                    
      *--------------------*                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F800  ASSIGN        TO BP13F800                           
                            FILE STATUS   IS BP13F800-STATUS.                   
                                                                                
           SELECT BP13K820  ASSIGN        TO BP13K820                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K820-KEY-FLD                       
                            FILE STATUS   IS BP13K820-STATUS.                   
                                                                                
           SELECT BP13K895 ASSIGN         TO BP13K895                           
                           ACCESS MODE    IS DYNAMIC                            
                           ORGANIZATION   IS INDEXED                            
                           RECORD KEY     IS K895-KEY-FLD                       
                           FILE STATUS    IS BP13K895-STATUS.                   
                                                                                
           SELECT BP13KD00 ASSIGN         TO BP13KD00                           
                           ACCESS MODE    IS DYNAMIC                            
                           ORGANIZATION   IS INDEXED                            
                           RECORD KEY     IS KD00-KEY-FLD                       
                           FILE STATUS    IS BP13KD00-STATUS.                   
                                                                                
           SELECT BP13K640 ASSIGN         TO BP13K640                           
                           ACCESS MODE    IS DYNAMIC                            
                           ORGANIZATION   IS INDEXED                            
                           RECORD KEY     IS K640-KEY-FLD                       
                           FILE STATUS    IS BP13K640-STATUS.                   
                                                                                
           SELECT BP13K830  ASSIGN        TO BP13K830                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K830-KEY-FLD                       
                            FILE STATUS   IS BP13K830-STATUS.                   
                                                                                
           SELECT BP13K060  ASSIGN        TO BP13K060                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K060-KEY-FLD                       
                            FILE STATUS   IS BP13K060-STATUS.                   
                                                                                
           SELECT BP13K410  ASSIGN        TO BP13K410                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K410-KEY-FLD                       
                            FILE STATUS   IS BP13K410-STATUS.                   
                                                                                
           SELECT BP13K670  ASSIGN        TO BP13K670                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K670-KEY-FLD                       
                            FILE STATUS   IS BP13K670-STATUS.                   
                                                                                
           SELECT BP13K330  ASSIGN        TO BP13K330                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K330-KEY-FLD                       
                            FILE STATUS   IS BP13K330-STATUS.                   
                                                                                
           SELECT BP13K813  ASSIGN        TO BP13K813                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K813-KEY-FLD                       
                            FILE STATUS   IS BP13K813-STATUS.                   
                                                                                
           SELECT BP13K857  ASSIGN        TO BP13K857                           
                            ORGANIZATION  IS INDEXED                            
                            ACCESS MODE   IS RANDOM                             
                            RECORD KEY    IS K857-KEY-FLD                       
                            FILE STATUS   IS BP13K857-STATUS.                   
                                                                                
           SELECT BP13K734  ASSIGN        TO BP13K734                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K734-KEY-FLD                       
                            FILE STATUS   IS BP13K734-STATUS.                   
                                                                                
           SELECT BP13KB78  ASSIGN        TO BP13KB78                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KB78-KEY-FLD                       
                            FILE STATUS   IS BP13KB78-STATUS.                   
                                                                                
           SELECT BM06K110  ASSIGN        TO BM06K110                           
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K110-KEY-FLD                       
                            ACCESS MODE   IS RANDOM                             
                            FILE STATUS   IS BM06K110-STATUS.                   
                                                                                
           SELECT BM06K100  ASSIGN        TO BM06K100                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K100-KEY-FLD                       
                            FILE STATUS   IS BM06K100-STATUS.                   
                                                                                
           SELECT BM06K130  ASSIGN        TO BM06K130                           
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K130-KEY-FLD                       
                            ACCESS MODE   IS RANDOM                             
                            FILE STATUS   IS BM06K130-STATUS.                   
                                                                                
           SELECT BB14K500  ASSIGN        TO BB14K500                           
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K500-KEY-FLD                       
                            ACCESS MODE   IS RANDOM                             
                            FILE STATUS   IS BB14K500-STATUS.                   
                                                                                
           SELECT BB14K580  ASSIGN        TO BB14K580                           
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K580-KEY-FLD                       
                            ACCESS MODE   IS RANDOM                             
                            FILE STATUS   IS BB14K580-STATUS.                   
                                                                                
           SELECT BP13K435  ASSIGN        TO BP13K435                           
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K435-KEY-FLD                       
                            ACCESS MODE   IS DYNAMIC                            
                            FILE STATUS   IS BP13K435-STATUS.                   
                                                                                
           SELECT BP13K022  ASSIGN        TO BP13K022                           
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K022-KEY-FLD                       
                            ALTERNATE KEY IS K022-NUM-REGN                      
                            ACCESS MODE   IS DYNAMIC                            
                            FILE STATUS   IS BP13K022-STATUS.                   
                                                                                
           SELECT BP13K840  ASSIGN        TO BP13K840                           
                            ORGANIZATION  IS INDEXED                            
                            ACCESS MODE   IS RANDOM                             
                            RECORD KEY    IS K840-KEY-FLD                       
                            FILE STATUS   IS BP13K840-STATUS.                   
                                                                                
           SELECT BP13K845  ASSIGN        TO BP13K845                           
                            ORGANIZATION  IS INDEXED                            
                            ACCESS MODE   IS DYNAMIC                            
                            RECORD KEY    IS K845-KEY-FLD                       
                            FILE STATUS   IS BP13K845-STATUS.                   
                                                                                
           SELECT BM06K950  ASSIGN       TO BM06K950                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K950-KEY-FLD                        
                            FILE STATUS  IS BM06K950-STATUS.                    
                                                                                
           SELECT BP13FW3A  ASSIGN        TO BP13FW3A.                          
                                                                                
           SELECT BP13FW3B  ASSIGN        TO BP13FW3B.                          
                                                                                
           SELECT BP13FW3F  ASSIGN        TO BP13FW3F.                          
                                                                                
           SELECT BP13FW3G  ASSIGN        TO BP13FW3G.                          
                                                                                
           SELECT BP13FW3M  ASSIGN        TO BP13FW3M.                          
                                                                                
           SELECT BM06F955  ASSIGN        TO BM06F955.                          
                                                                                
                                                                                
      *--------------*                                                          
       DATA DIVISION.                                                           
      *--------------*                                                          
       FILE SECTION.                                                            
                                                                                
       FD   BP13F800                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K895                                                            
            RECORD CONTAINS 450 CHARACTERS.                                     
       COPY BP13K895.                                                           
                                                                                
       FD   BP13KD00                                                            
            RECORD CONTAINS 1600 CHARACTERS.                                    
       COPY BP13KD00.                                                           
                                                                                
       FD   BP13K640                                                            
            RECORD CONTAINS 500  CHARACTERS.                                    
       COPY BP13K640.                                                           
                                                                                
       FD   BP13KB78                                                            
            RECORD CONTAINS 3300 CHARACTERS.                                    
       COPY BP13KB78.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K857                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K857.                                                           
                                                                                
       FD   BP13K060                                                            
            RECORD CONTAINS 25 CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD   BP13K410                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K410.                                                           
                                                                                
       FD   BP13K670                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K670.                                                           
                                                                                
       FD   BP13K330                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K330.                                                           
                                                                                
       FD   BP13K734                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K734.                                                           
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BM06K130                                                            
            RECORD CONTAINS 600 CHARACTERS.                                     
       COPY BM06K130.                                                           
                                                                                
       FD   BB14K500                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BB14K500.                                                           
                                                                                
       FD   BB14K580                                                            
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY BB14K580.                                                           
                                                                                
       FD   BP13K435                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K435.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K840                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K840.                                                           
                                                                                
       FD   BP13K845                                                            
            RECORD CONTAINS 2050 CHARACTERS.                                    
       COPY BP13K845.                                                           
                                                                                
       FD   BM06K950                                                            
            RECORD CONTAINS 600 CHARACTERS.                                     
       COPY BM06K950.                                                           
                                                                                
                                                                                
       FD   BP13FW3A                                                            
            RECORD CONTAINS 800 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FW3A.                                                           
                                                                                
       FD   BP13FW3B                                                            
            RECORD CONTAINS 400 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FW3B.                                                           
                                                                                
       FD   BP13FW3F                                                            
            RECORD CONTAINS 350 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FW3F.                                                           
                                                                                
       FD   BP13FW3G                                                            
            RECORD CONTAINS 250 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FW3G.                                                           
                                                                                
       FD   BP13FW3M                                                            
            RECORD CONTAINS 800 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FW3M.                                                           
                                                                                
       FD   BM06F955                                                            
            RECORD CONTAINS 350 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BM06F955.                                                           
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                                 
      *-----------------------*                                                 
      *-------------------------------------------------------*                 
      *    COPY BOOK FOR SUBROUTINE - BP13C913.               *                 
      *-------------------------------------------------------*                 
       COPY P13COMM8.                                                           
                                                                                
      *-------------------------------------------------------*                 
      *    COPY BOOK FOR SUBROUTINE - BP13CB4A.               *                 
      *-------------------------------------------------------*                 
       COPY P13COM73.                                                           
                                                                                
                                                                                
       01  WS-SQL-CODE                 PIC 9(4)  VALUE ZEROS.                   
                                                                                
       01 WS-FILE-STATUS.                                                       
          05 BP13F800-STATUS               PIC 9(02).                           
             88 BP13F800-OK                VALUE 00.                            
             88 BP13F800-EOF               VALUE 10.                            
          05 BP13K820-STATUS               PIC 9(02).                           
             88 BP13K820-OK                VALUE 00.                            
             88 BP13K820-02                VALUE 00.                            
             88 BP13K820-04                VALUE 04.                            
             88 BP13K820-EOF               VALUE 10.                            
             88 BP13K820-NFND              VALUE 23.                            
          05 BP13K895-STATUS               PIC 9(02).                           
             88 BP13K895-OK                VALUE 00.                            
             88 BP13K895-02                VALUE 00.                            
             88 BP13K895-EOF               VALUE 10.                            
             88 BP13K895-NFND              VALUE 23.                            
          05 BP13K830-STATUS               PIC 9(02).                           
             88 BP13K830-OK                VALUE 00.                            
             88 BP13K830-NFND              VALUE 23.                            
          05 BM06K110-STATUS               PIC 9(02).                           
             88 BM06K110-OK                VALUE 00.                            
             88 BM06K110-NFND              VALUE 23.                            
          05 BM06K130-STATUS               PIC 9(02).                           
             88 BM06K130-OK                VALUE 00.                            
             88 BM06K130-NFND              VALUE 23.                            
          05 BP13K060-STATUS               PIC 9(02).                           
             88 BP13K060-OK                VALUE 00.                            
             88 BP13K060-02                VALUE 02.                            
             88 BP13K060-04                VALUE 04.                            
             88 BP13K060-EOF               VALUE 10.                            
             88 BP13K060-NFND              VALUE 23.                            
          05 BP13K330-STATUS               PIC 9(02).                           
             88 BP13K330-OK                VALUE 00.                            
             88 BP13K330-NFND              VALUE 23.                            
          05 BP13K410-STATUS               PIC 9(02).                           
             88 BP13K410-OK                VALUE 00.                            
             88 BP13K410-NFND              VALUE 23.                            
          05 BP13K670-STATUS               PIC 9(02).                           
             88 BP13K670-OK                VALUE 00.                            
             88 BP13K670-NFND              VALUE 23.                            
          05 BP13K734-STATUS               PIC 9(02).                           
             88 BP13K734-OK                VALUE 00.                            
             88 BP13K734-NFND              VALUE 23.                            
          05 BP13KD00-STATUS               PIC 9(02).                           
             88 BP13KD00-OK                VALUE 00.                            
             88 BP13KD00-NFND              VALUE 23.                            
          05 BP13K640-STATUS               PIC 9(02).                           
             88 BP13K640-OK                VALUE 00.                            
             88 BP13K640-NFND              VALUE 23.                            
          05 BP13KB78-STATUS               PIC 9(02).                           
             88 BP13KB78-OK                VALUE 00.                            
             88 BP13KB78-NFND              VALUE 23.                            
          05 BB14K500-STATUS               PIC 9(02).                           
             88 BB14K500-OK                VALUE 00.                            
             88 BB14K500-NFND              VALUE 23.                            
          05 BB14K580-STATUS               PIC 9(02).                           
             88 BB14K580-OK                VALUE 00.                            
             88 BB14K580-NFND              VALUE 23.                            
          05 BP13K435-STATUS               PIC 9(02).                           
             88 BP13K435-OK                VALUE 00.                            
             88 BP13K435-02                VALUE 00.                            
             88 BP13K435-04                VALUE 04.                            
             88 BP13K435-EOF               VALUE 10.                            
             88 BP13K435-NFND              VALUE 23.                            
          05 BP13K022-STATUS               PIC 9(02).                           
             88 BP13K022-OK                VALUE 00.                            
             88 BP13K022-02                VALUE 02.                            
             88 BP13K022-NFND              VALUE 23.                            
          05 BM06K500-STATUS               PIC 9(02).                           
             88 BM06K500-OK                VALUE 00.                            
             88 BM06K500-NFND              VALUE 23.                            
          05 BP13K857-STATUS               PIC 9(02).                           
          05 BP13K813-STATUS               PIC 9(02).                           
          05 BP13K840-STATUS               PIC 9(02).                           
          05 BM06K100-STATUS               PIC 9(02).                           
          05 BP13K845-STATUS               PIC 9(02).                           
          05 BM06K950-STATUS               PIC 9(02).                           
                                                                                
       01 WS-REC-CNTR.                                                          
          05 WS-F800-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K820-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K820-REGN-CTR              PIC 9(08) VALUE ZERO.                
          05 WS-K820-NOTFD-CTR             PIC 9(08) VALUE ZERO.                
          05 WS-K895-NOTFD-CTR             PIC 9(08) VALUE ZERO.                
          05 WS-K895-REGN-CTR              PIC 9(08) VALUE ZERO.                
          05 WS-K895-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K830-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K830-NOTFD-CNT              PIC 9(08) VALUE ZERO.               
          05 WS-K060-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K410-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K410-NOTFD-CNT              PIC 9(08) VALUE ZERO.               
          05 WS-K330-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K330-NOTFD-CNT              PIC 9(08) VALUE ZERO.               
          05 WS-K734-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K734-NOTFD-CNT              PIC 9(08) VALUE ZERO.               
          05 WS-KD00-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-KD00-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K640-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K640-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-KB78-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-KB78-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K110-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K110-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K130-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K130-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K100-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K100-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K500-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K500-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K580-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K580-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K435-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K435-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K022-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K857-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K857-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K022-NOTFD-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-K845-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-K950-READ-CNT              PIC 9(08) VALUE ZERO.                
          05 WS-FW3A-WRITE-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-FW3B-WRITE-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-FW3F-WRITE-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-FW3G-WRITE-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-FW3M-WRITE-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-F955-WRITE-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-DBSS                       PIC 9(08) VALUE ZERO.                
          05 WS-NON-DBSS                   PIC 9(08) VALUE ZERO.                
          05 WS-SCH-NOTFND-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-NTBOOK-CASES               PIC 9(08) VALUE ZERO.                
          05 WS-BOOKED-CASES               PIC 9(08) VALUE ZERO.                
          05 WS-CTR                        PIC 9(02) VALUE ZERO.                
          05 WS-CSTMR-CTR                  PIC 9(02) VALUE ZERO.                
          05 WS-CUST-BLANK-CNT             PIC 9(08) VALUE ZERO.                
          05 WS-TOT-FEE                    PIC S9(7)V99.                        
          05 WS-TOT-ICP                    PIC S9(7)V99.                        
          05 WS-TOT-CD                     PIC S9(7)V99.                        
          05 WS-TOT-CD-CPF                 PIC S9(7)V99.                        
          05 WS-TOT-INSTALL                PIC S9(7)V99.                        
          05 WS-REM                        PIC S9(7)V99.                        
          05 WS-FW03-AMT-PREMIUM           PIC S9(7)V99.                        
          05 WS-ICP-CASH                   PIC S9(7)V99.                        
          05 WS-FW03-AHG-GRANT             PIC 9(5)  VALUE ZERO.                
          05 WS-FW03-AHG-GRANT-CHAR REDEFINES WS-FW03-AHG-GRANT                 
                                    PIC X(05).                                  
          05 WS-FW03-SHG-GRANT             PIC 9(5)    VALUE ZERO.              
          05 WS-FW03-SHG-GRANT-CHAR REDEFINES WS-FW03-SHG-GRANT                 
                                    PIC X(05).                                  
          05 WS-FW03-HSGNT                 PIC 9(5)    VALUE ZERO.              
          05 WS-FW03-HSGNT-CHAR     REDEFINES WS-FW03-HSGNT                     
                                    PIC X(05).                                  
          05 WS-FW03-AHG-GRANT-O           PIC 9(5)  VALUE ZERO.                
          05 WS-FW03-AHG-GRANT-CHAR-O REDEFINES WS-FW03-AHG-GRANT-O             
                                    PIC X(05).                                  
          05 WS-FW03-SHG-GRANT-O           PIC 9(5)    VALUE ZERO.              
          05 WS-FW03-SHG-GRANT-CHAR-O REDEFINES WS-FW03-SHG-GRANT-O             
                                    PIC X(05).                                  
          05 WS-FW03-HSGNT-O               PIC 9(5)    VALUE ZERO.              
          05 WS-FW03-HSGNT-CHAR-O     REDEFINES WS-FW03-HSGNT-O                 
                                    PIC X(05).                                  
                                                                                
       01 WS-TAG.                                                               
          05 WS-K820-FOUND                 PIC X(01) VALUE 'N'.                 
          05 WS-K895-FOUND                 PIC X(01) VALUE 'N'.                 
          05 WS-K435-FOUND                 PIC X(01) VALUE 'N'.                 
          05 WS-K845-FOUND                 PIC X(01) VALUE 'N'.                 
          05 WS-K950-FOUND                 PIC X(01) VALUE 'N'.                 
          05 WS-K845-EOF                   PIC X(01) VALUE 'N'.                 
          05 WS-K950-EOF                   PIC X(01) VALUE 'N'.                 
          05 WS-FOUND                      PIC X(01) VALUE 'N'.                 
                                                                                
       01 WS-HOLD-VAR.                                                          
          05 WS-APPL-STATUS                PIC X(2).                            
          05 WS-NUM-SEX                    PIC X(1).                            
          05 WS-NUM-ETHNIC                 PIC X(1).                            
          05 WS-ETHNIC                     PIC X(1) VALUE SPACES.               
          05 WS-SEX                        PIC X(1) VALUE SPACES.               
          05 WS-VALID-CUST-ID              PIC X(1) VALUE SPACES.               
          05 WS-MARITAL-STATUS             PIC X(1) VALUE SPACES.               
          05 WS-FW3B-NUM-REGN              PIC X(8)  VALUE SPACES.              
          05 WS-FW3B-HDB-REFNO             PIC X(11) VALUE SPACES.              
          05 WS-FW3B-NUM-NEW-TOWN          PIC X(3)  VALUE SPACES.              
          05 WS-FW3B-NUM-FLAT-TYPE         PIC X(2)  VALUE SPACES.              
          05 WS-NUM-OCCP                   PIC 9(1)  VALUE ZEROS.               
          05 WS-FW3A-AMT-TP-INCOME         PIC 9(5)  VALUE ZEROS.               
                                                                                
       01  WS-DATE-TIME.                                                        
           05  WS-CURR-DATE                PIC X(8) VALUE SPACES.               
           05  WS-CURR-TIME                PIC X(4) VALUE SPACES.               
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-DATE                 PIC X(08) VALUE SPACES.              
           05  FILLER                      PIC X(13) VALUE SPACES.              
                                                                                
       01  WS-CD-CPF-FW3B.                                                      
           05 WS-CD-CPF1           PIC S9(7)V99.                                
           05 WS-CD-CPF2           PIC S9(7)V99.                                
           05 WS-CD-CPF3           PIC S9(7)V99.                                
           05 WS-CD-CPF4           PIC S9(7)V99.                                
                                                                                
                                                                                
       01  WS-ICP-CPF-FW3B.                                                     
           05 WS-ICP-CPF1           PIC S9(7)V99.                               
           05 WS-ICP-CPF2           PIC S9(7)V99.                               
           05 WS-ICP-CPF3           PIC S9(7)V99.                               
           05 WS-ICP-CPF4           PIC S9(7)V99.                               
                                                                                
       01  WS-INSTALL-FW3B.                                                     
           05 WS-INSTALL1        PIC S9(5)V99.                                  
           05 WS-INSTALL2        PIC S9(5)V99.                                  
           05 WS-INSTALL3        PIC S9(5)V99.                                  
           05 WS-INSTALL4        PIC S9(5)V99.                                  
                                                                                
       01  AS-LEGAL-FEE-DEDUCT.                                                 
           05 WS-FEE-CASH        PIC S9(7)V99.                                  
           05 WS-FEE-CPF         PIC S9(7)V99.                                  
           05 WS-FEE-CPF1        PIC S9(7)V99.                                  
           05 WS-FEE-CPF2        PIC S9(7)V99.                                  
           05 WS-FEE-CPF3        PIC S9(7)V99.                                  
           05 WS-FEE-CPF4        PIC S9(7)V99.                                  
                                                                                
       01  WS-DTE-PACD.                                                         
           05 WS-DTE-PACD-YR            PIC X(04).                              
           05 WS-DTE-PACD-QTR           PIC X(02).                              
           05 WS-DTE-PACD-DD            PIC X(02)  VALUE '01'.                  
                                                                                
       01  WS-CB4A.                                                             
           05 WS-A                      PIC 9(02) VALUE ZEROES.                 
           05 WS-DB2-NUM-AHG            PIC X(03) VALUE SPACES.                 
           05 WS-DB2-NUM-SHG            PIC X(03) VALUE SPACES.                 
           05 WS-DB2-AMT-AHG-GRANT      PIC 9(06)V99 VALUE ZEROES.              
           05 WS-DB2-AMT-SHG-GRANT      PIC 9(06)V99 VALUE ZEROES.              
           05 WS-DB2-AMT-AHG-RECVR      PIC 9(06)V99 VALUE ZEROES.              
           05 WS-DB2-AMT-SHG-RECVR      PIC 9(06)V99 VALUE ZEROES.              
           05 WS-DB2-DTE-AHG-REQ        PIC X(10) VALUE SPACES.                 
           05 WS-DB2-DTE-SHG-REQ        PIC X(10) VALUE SPACES.                 
           05 WS-DB2-DTE-AHG-APRV       PIC X(10) VALUE SPACES.                 
           05 WS-DB2-DTE-SHG-APRV       PIC X(10) VALUE SPACES.                 
           05 WS-DB2-NUM-AHG-STATUS     PIC X(01) VALUE SPACES.                 
           05 WS-DB2-NUM-SHG-STATUS     PIC X(01) VALUE SPACES.                 
           05 WS-DB2-NUM-AHG-REJECT     PIC X(03) VALUE SPACES.                 
           05 WS-DB2-NUM-SHG-REJECT     PIC X(03) VALUE SPACES.                 
           05 WS-DB2-NUM-AHG-WITHDRAW   PIC X(03) VALUE SPACES.                 
           05 WS-DB2-NUM-SHG-WITHDRAW   PIC X(03) VALUE SPACES.                 
           05 WS-DB2-NUM-NOAHG-RSN      PIC X(03) VALUE SPACES.                 
           05 WS-DB2-NUM-NOSHG-RSN      PIC X(03) VALUE SPACES.                 
                                                                                
       01  WS-BP13C913                  PIC X(8)   VALUE 'BP13C913'.            
                                                                                
      *-------------------------------------------------------*                 
      *    LINKAGE VARIABLES                                  *                 
      *-------------------------------------------------------*                 
       01   WS-LINK-REC.                                                        
            05 WS-LINK-NUM-SCH            PIC X(4).                             
            05 WS-LINK-NUM-ACC            PIC X(4).                             
            05 WS-LINK-NUM-CHK            PIC X(1).                             
                                                                                
      *==================*                                                      
       PROCEDURE DIVISION.                                                      
      *==================*                                                      
                                                                                
      *----------*                                                              
       0000-MAIN.                                                               
      *----------*                                                              
           PERFORM 1000-INITIALIZE                                              
              THRU 1000-EXIT                                                    
                                                                                
           PERFORM 2000-READ-F800                                               
              THRU 2000-EXIT                                                    
                                                                                
           PERFORM 3000-PROCESS-PARA                                            
              THRU 3000-EXIT                                                    
             UNTIL BP13F800-EOF                                                 
                                                                                
           PERFORM 8000-CLOSE-FILES                                             
              THRU 8000-EXIT                                                    
           .                                                                    
      *----------*                                                              
       0000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
      ***INITIALIZES THE FLAGS AND OPENS FILES                       ***        
      ******************************************************************        
      *----------------*                                                        
       1000-INITIALIZE.                                                         
      *----------------*                                                        
           INITIALIZE WS-FILE-STATUS                                            
                      WS-REC-CNTR                                               
                      WS-HOLD-VAR                                               
           PERFORM 1200-OPEN-FILES                                              
              THRU 1200-EXIT                                                    
           .                                                                    
      *----------*                                                              
       1000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
      ***   OPENS ALL FILES IN THE RESPECTIVE MODES & REPORT ERRORS  ***        
      ******************************************************************        
      *----------------*                                                        
       1200-OPEN-FILES.                                                         
      *----------------*                                                        
           OPEN INPUT  BP13F800                                                 
                       BM06K100                                                 
                       BM06K110                                                 
                       BM06K130                                                 
                       BP13K330                                                 
                       BP13K820                                                 
                       BP13K895                                                 
                       BP13K830                                                 
                       BP13K734                                                 
                       BP13K410                                                 
                       BP13K670                                                 
                       BP13K060                                                 
                       BP13KD00                                                 
                       BP13K640                                                 
                       BP13KB78                                                 
                       BP13K857                                                 
                       BB14K500                                                 
                       BB14K580                                                 
                       BP13K435                                                 
                       BP13K022                                                 
                       BP13K813                                                 
                       BP13K840                                                 
                       BP13K845                                                 
                       BM06K950                                                 
                OUTPUT                                                          
                       BP13FW3A                                                 
                       BP13FW3B                                                 
                       BP13FW3F                                                 
                       BP13FW3G                                                 
                       BP13FW3M                                                 
                       BM06F955.                                                
                                                                                
           IF BP13K820-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K820'                         
              DISPLAY 'FILE STATUS :' BP13K820-STATUS                           
              MOVE BP13K820-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K895-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K820'                         
              DISPLAY 'FILE STATUS :' BP13K895-STATUS                           
              MOVE BP13K895-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K830-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K830'                         
              DISPLAY 'FILE STATUS :' BP13K830-STATUS                           
              MOVE BP13K830-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K060-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K060'                         
              DISPLAY 'FILE STATUS :' BP13K060-STATUS                           
              MOVE BP13K060-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K410-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K410'                         
              DISPLAY 'FILE STATUS :' BP13K410-STATUS                           
              MOVE BP13K410-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K734-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K734'                         
              DISPLAY 'FILE STATUS :' BP13K734-STATUS                           
              MOVE BP13K734-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K670-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K670'                         
              DISPLAY 'FILE STATUS :' BP13K670-STATUS                           
              MOVE BP13K670-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BM06K100-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN FAILED FOR BM06K100,STATUS '                        
                                          BM06K100-STATUS                       
              MOVE BM06K100-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END    THRU 9900-EXIT                       
           END-IF.                                                              
                                                                                
           IF BP13K857-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN FAILED FOR BP13K857,STATUS '                        
                                          BP13K857-STATUS                       
              MOVE BP13K857-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END    THRU 9900-EXIT                       
           END-IF.                                                              
                                                                                
           IF BP13K813-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN FAILED FOR BP13K813,STATUS '                        
                                          BP13K813-STATUS                       
              MOVE BP13K813-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END    THRU 9900-EXIT                       
           END-IF.                                                              
                                                                                
           IF BP13K840-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN FAILED FOR BP13K840,STATUS '                        
                                          BP13K840-STATUS                       
              MOVE BP13K840-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END    THRU 9900-EXIT                       
           END-IF.                                                              
                                                                                
           IF BP13K845-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN FAILED FOR BP13K845,STATUS '                        
                                          BP13K845-STATUS                       
              MOVE BP13K845-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END    THRU 9900-EXIT                       
           END-IF.                                                              
                                                                                
           IF BM06K950-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN FAILED FOR BM06K950,STATUS '                        
                                          BM06K950-STATUS                       
              MOVE BM06K950-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END    THRU 9900-EXIT                       
           END-IF.                                                              
                                                                                
           IF BP13K640-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K640'                         
              DISPLAY 'FILE STATUS :' BP13K640-STATUS                           
              MOVE BP13K640-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
                                                                                
           IF BP13KD00-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13KD00'                         
              DISPLAY 'FILE STATUS :' BP13KD00-STATUS                           
              MOVE BP13KD00-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13KB78-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13KB78'                         
              DISPLAY 'FILE STATUS :' BP13KB78-STATUS                           
              MOVE BP13KB78-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BM06K130-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BM06K130'                         
              DISPLAY 'FILE STATUS :' BM06K130-STATUS                           
              MOVE BM06K130-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BB14K500-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BB14K500'                         
              DISPLAY 'FILE STATUS :' BB14K500-STATUS                           
              MOVE BB14K500-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K435-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K435'                         
              DISPLAY 'FILE STATUS :' BP13K435-STATUS                           
              MOVE BP13K435-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           IF BP13K022-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K022'                         
              DISPLAY 'FILE STATUS :' BP13K022-STATUS                           
              MOVE BP13K022-STATUS          TO RETURN-CODE                      
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
                                                                                
           MOVE FUNCTION CURRENT-DATE       TO WS-SYSTEM-DATE.                  
                                                                                
      *----------*                                                              
       1200-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
      ***   READS THE INPUT FILE IN THE CORRESPONDING FORMAT         ***        
      ******************************************************************        
      *--------------*                                                          
       2000-READ-F800.                                                          
      *--------------*                                                          
                                                                                
           INITIALIZE                                                           
                      BP13F800-MASTER                                           
                                                                                
           READ BP13F800                                                        
           AT END                                                               
              IF WS-F800-READ-CNT = 0                                           
                 DISPLAY 'INPUT FILE IS EMPTY'                                  
              ELSE                                                              
                 DISPLAY 'END OF FILE REACHED FOR INPUT FILE'                   
              END-IF                                                            
              PERFORM 8000-CLOSE-FILES                                          
                 THRU 8000-EXIT                                                 
           END-READ                                                             
                                                                                
           IF BP13F800-OK                                                       
              ADD 1                        TO WS-F800-READ-CNT                  
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13F800!'                                 
              DISPLAY 'FILE STATUS  :' BP13F800-STATUS                          
              MOVE BP13F800-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END                                         
                 THRU 9900-EXIT                                                 
           END-IF                                                               
           .                                                                    
      *----------*                                                              
       2000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
       2050-CALL-BP13CB4A.                                                      
      ******************************************************************        
           MOVE SPACES TO COM73-COMMAREA.                                       
           INITIALIZE     COM73-COMMAREA.                                       
                                                                                
           MOVE 'R'                  TO  COM73-NUM-CALL-ACTION.                 
           MOVE F800-NUM-REGN        TO  COM73-NUM-RGSTRN-INPUT.                
           CALL 'BP13CB4A' USING COM73-COMMAREA.                                
                                                                                
           IF COM73-CDE-ERROR = SPACES OR ZEROES                                
              NEXT SENTENCE                                                     
           ELSE                                                                 
              MOVE SPACES                TO COM73-COMMAREA                      
              INITIALIZE                    COM73-COMMAREA                      
           END-IF.                                                              
                                                                                
           MOVE 'N' TO WS-FOUND.                                                
                                                                                
           MOVE SPACES                TO WS-CB4A.                               
           INITIALIZE                    WS-CB4A.                               
                                                                                
           PERFORM VARYING WS-A FROM 1 BY 1 UNTIL WS-A > 5                      
             IF COM73-NUM-GRANT-TYPE(WS-A) = 'AHG' OR 'EHG'                     
                MOVE 'Y' TO WS-FOUND                                            
                MOVE COM73-GRANT-AMOUNT-ELGBL(WS-A)  TO WS-DB2-NUM-AHG          
                MOVE COM73-SUM-AMT-GRANT(WS-A) TO WS-DB2-AMT-AHG-GRANT          
                MOVE COM73-SUM-AMT-RCVRY(WS-A) TO WS-DB2-AMT-AHG-RECVR          
                MOVE COM73-DTE-GRANT-RQST(WS-A) TO WS-DB2-DTE-AHG-REQ           
                MOVE COM73-DTE-APRV(WS-A) TO WS-DB2-DTE-AHG-APRV                
                MOVE COM73-RJCTN-REASON(WS-A) TO WS-DB2-NUM-AHG-REJECT          
                MOVE COM73-OPT-OUT-REASON(WS-A) TO WS-DB2-NUM-NOAHG-RSN         
               MOVE COM73-WTDRWL-REASON(WS-A) TO WS-DB2-NUM-AHG-WITHDRAW        
                MOVE COM73-GRANT-STATUS(WS-A) TO WS-DB2-NUM-AHG-STATUS          
             END-IF                                                             
             IF COM73-NUM-GRANT-TYPE(WS-A) = 'SHG'                              
                MOVE 'Y' TO WS-FOUND                                            
                MOVE COM73-GRANT-AMOUNT-ELGBL(WS-A)  TO WS-DB2-NUM-SHG          
                MOVE COM73-SUM-AMT-GRANT(WS-A) TO WS-DB2-AMT-SHG-GRANT          
                MOVE COM73-SUM-AMT-RCVRY(WS-A) TO WS-DB2-AMT-SHG-RECVR          
                MOVE COM73-DTE-GRANT-RQST(WS-A) TO WS-DB2-DTE-SHG-REQ           
                MOVE COM73-DTE-APRV(WS-A) TO WS-DB2-DTE-SHG-APRV                
                MOVE COM73-RJCTN-REASON(WS-A) TO WS-DB2-NUM-SHG-REJECT          
                MOVE COM73-OPT-OUT-REASON(WS-A) TO WS-DB2-NUM-NOSHG-RSN         
               MOVE COM73-WTDRWL-REASON(WS-A) TO WS-DB2-NUM-SHG-WITHDRAW        
                MOVE COM73-GRANT-STATUS(WS-A) TO WS-DB2-NUM-SHG-STATUS          
             END-IF                                                             
           END-PERFORM.                                                         
                                                                                
       2050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      * THIS PARA PERFORMS THE MAIN PROCESSING OF THE PROGRAM          *        
      * 1)  SEARCHES FOR ALL RECORDS IN BP13K820 CORRESPONDING TO THE  *        
      *     INPUT REGISTRATION NUMBER (NRIC IS DIFFERENT FOR EACH CASE)*        
      *     - IF NOT FOUND IN K820, READ K895                          *        
      * 2)  SEARCHES FILE, BP13K830 FOR CORRESPONDENCE ADDRESS         *        
      * 3)  SEARCHES FILE, BP13K410 FOR VARIOUS AMOUNT FIELDS          *        
      * 4)  SEARCHES FILE, BP13K734 FOR EMPLOYEMENT STATUS             *        
      * 5)  ALL THE ABOVE RESULTS ARE CAPTURED IN BP13FW03             *        
      ******************************************************************        
      *-----------------*                                                       
       3000-PROCESS-PARA.                                                       
      *-----------------*                                                       
                                                                                
           MOVE SPACES                       TO WS-APPL-STATUS                  
                                                WS-VALID-CUST-ID.               
           MOVE ZEROES                       TO WS-TOT-ICP                      
                                                WS-TOT-FEE                      
                                                WS-TOT-CD                       
                                                WS-TOT-CD-CPF                   
                                                WS-TOT-INSTALL                  
                                                WS-ICP-CASH                     
                                                WS-ICP-CPF1                     
                                                WS-ICP-CPF2                     
                                                WS-ICP-CPF3                     
                                                WS-ICP-CPF4                     
                                                WS-CD-CPF1                      
                                                WS-CD-CPF2                      
                                                WS-CD-CPF3                      
                                                WS-CD-CPF4                      
                                                WS-INSTALL1                     
                                                WS-INSTALL2                     
                                                WS-INSTALL3                     
                                                WS-INSTALL4                     
                                                WS-CSTMR-CTR.                   
           MOVE ZEROS                        TO WS-REM.                         
           MOVE ZEROS                        TO WS-NUM-OCCP                     
                                                WS-FW3A-AMT-TP-INCOME.          
                                                                                
           MOVE SPACES                       TO WS-FW3B-NUM-REGN                
                                                WS-FW3B-HDB-REFNO               
                                                WS-FW3B-NUM-NEW-TOWN            
                                                WS-FW3B-NUM-FLAT-TYPE.          
                                                                                
           MOVE SPACES                       TO BP13FW3A-REC.                   
           INITIALIZE                           BP13FW3A-REC.                   
                                                                                
           MOVE SPACES                       TO BP13FW3B-REC.                   
           INITIALIZE                           BP13FW3B-REC.                   
                                                                                
           MOVE SPACES                       TO BP13FW3F-REC.                   
           INITIALIZE                           BP13FW3F-REC.                   
                                                                                
           MOVE SPACES                       TO BP13FW3G-REC.                   
           INITIALIZE                           BP13FW3G-REC.                   
                                                                                
           MOVE SPACES                       TO BP13FW3M-REC.                   
           INITIALIZE                           BP13FW3M-REC.                   
                                                                                
           MOVE SPACES                       TO BM06F955-REC.                   
           INITIALIZE                           BM06F955-REC.                   
                                                                                
           PERFORM 2050-CALL-BP13CB4A THRU 2050-EXIT.                           
                                                                                
           IF F800-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES                      
              PERFORM 3560-READ-K110  THRU 3560-EXIT                            
              PERFORM 3730-READ-K130  THRU 3730-EXIT                            
              PERFORM 3720-READ-K500  THRU 3720-EXIT                            
              PERFORM 3740-READ-K580  THRU 3740-EXIT                            
              PERFORM 3750-START-K435 THRU 3750-EXIT                            
              PERFORM 3751-READ-K435  THRU 3751-EXIT                            
                         UNTIL BP13K435-EOF                                     
              PERFORM 3770-READ-K022  THRU 3770-EXIT                            
              PERFORM 3010-READ-PIDB THRU 3010-EXIT                             
              PERFORM 3500-READ-K410 THRU 3500-EXIT                             
                                                                                
              IF K410-DTE-KEY-ISSUE NOT = SPACES AND LOW-VALUES                 
                  PERFORM 3050-PROCESS-K410  THRU 3050-EXIT                     
              ELSE                                                              
                  PERFORM 3550-READ-K330 THRU 3550-EXIT                         
              END-IF                                                            
              ADD 1  TO WS-BOOKED-CASES                                         
           ELSE                                                                 
              ADD 1  TO WS-NTBOOK-CASES                                         
           END-IF.                                                              
                                                                                
           IF WS-APPL-STATUS = SPACES                                           
              PERFORM 6050-CHECK-APPL-STAT THRU 6050-EXIT                       
           END-IF.                                                              
                                                                                
           PERFORM 3100-MOVE-F800          THRU 3100-EXIT.                      
                                                                                
           PERFORM 3400-READ-K830          THRU 3400-EXIT.                      
                                                                                
           PERFORM 3200-START-K820         THRU 3200-EXIT.                      
           PERFORM 3300-READ-K820          THRU 3300-EXIT                       
             UNTIL BP13K820-EOF                                                 
                                                                                
           IF WS-K820-FOUND = 'Y'                                               
              ADD 1 TO WS-K820-REGN-CTR                                         
           ELSE                                                                 
              ADD 1 TO WS-K820-NOTFD-CTR                                        
              PERFORM 5000-START-K895      THRU 5000-EXIT                       
              PERFORM 5100-READ-K895       THRU 5100-EXIT                       
                UNTIL BP13K895-EOF                                              
                                                                                
              IF WS-K895-FOUND = 'Y'                                            
                 ADD 1 TO WS-K895-REGN-CTR                                      
              ELSE                                                              
                 ADD 1 TO WS-K820-NOTFD-CTR                                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-VALID-CUST-ID = 'Y'                                            
              PERFORM 6100-PREPARE-FW3A   THRU 6100-EXIT                        
           ELSE                                                                 
              ADD 1 TO WS-CUST-BLANK-CNT                                        
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-F800      THRU 2000-EXIT.                          
                                                                                
      *----------*                                                              
       3000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *----------*                                                              
       3010-READ-PIDB.                                                          
      *----------*                                                              
      *    CONTINUE.                                                            
      ****COMMENTEDOUT FOR TESTING ONLY***                                      
      *  TO CALL SUBROUTINE  P13C913,GETTING ADDRESS                            
              MOVE SPACES                   TO WS-LINK-REC.                     
              MOVE F800-NUM-SCH-ACC(1:4)    TO WS-LINK-NUM-SCH.                 
              MOVE F800-NUM-SCH-ACC(5:4)    TO WS-LINK-NUM-ACC.                 
              MOVE F800-NUM-SCH-ACC(9:1)    TO WS-LINK-NUM-CHK.                 
              PERFORM 3105-CALL-BP13C913      THRU 3105-EXIT.                   
                                                                                
              MOVE COMM8-UNIT-ID         TO FW3A-NUM-UNIT-ID.                   
                                                                                
              MOVE COMM8-NUM-BLK         TO FW3A-NUM-SEL-BLK-MAIN.              
              MOVE COMM8-NUM-LEVEL       TO FW3A-NUM-SEL-LVL.                   
              MOVE COMM8-NME-STREET      TO FW3A-NME-SEL-STREET.                
              MOVE COMM8-NUM-POSTAL-CODE TO FW3A-NUM-SEL-POSTAL.                
              MOVE COMM8-CDE-MODL-DESG   TO FW3A-NUM-FLAT-MODEL.                
              MOVE COMM8-QTY-AREA-TOTAL  TO FW3A-NUM-FLOOR-AREA.                
              MOVE COMM8-NUM-NGHBHD-CIM  TO FW3A-NUM-NGHBHD-CIM                 
              MOVE COMM8-NUM-CNTRCT-CIM  TO FW3A-NUM-CNTRCT-CIM                 
              STRING COMM8-NUM-UNIT-MAIN COMM8-NUM-UNIT-SUB                     
                DELIMITED BY SIZE INTO FW3A-NUM-SEL-UNIT.                       
                                                                                
      *----------*                                                              
       3010-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       3050-PROCESS-K410.                                                       
      *---------------*                                                         
                                                                                
                                                                                
           MOVE ZEROS TO WS-TOT-FEE.                                            
           PERFORM 3060-INITIALIZE-FIELDS  THRU 3060-EXIT.                      
                                                                                
           MOVE K410-AMT-CD-CASH       TO FW3A-AMT-CD-CASH                      
           MOVE K410-AMT-MTHLY-CASH    TO FW3A-AMT-MNTLY-INSTAL-CASH            
           MOVE K410-CDE-INTEREST-RATE TO FW3A-NUM-LOAN-RATE.                   
      *    MOVE K410-AMT-PREMIUM-NEW   TO FW3A-AMT-PREMIUM .                    
           MOVE K410-CDE-LOAN-SCH      TO FW3A-NUM-LOAN-SCH.                    
           MOVE K410-AMT-CD-CPF1       TO WS-CD-CPF1.                           
           MOVE K410-AMT-CD-CPF2       TO WS-CD-CPF2.                           
           MOVE K410-AMT-CD-CPF3       TO WS-CD-CPF3.                           
           MOVE K410-AMT-CD-CPF4       TO WS-CD-CPF4.                           
                                                                                
           COMPUTE WS-TOT-CD-CPF = WS-CD-CPF1   +                               
                                   WS-CD-CPF2   +                               
                                   WS-CD-CPF3   +                               
                                   WS-CD-CPF4                                   
                                                                                
                                                                                
           MOVE K410-AMT-MTHLY-CPF1 TO WS-INSTALL1.                             
           MOVE K410-AMT-MTHLY-CPF2 TO WS-INSTALL2.                             
           MOVE K410-AMT-MTHLY-CPF3 TO WS-INSTALL3.                             
           MOVE K410-AMT-MTHLY-CPF4 TO WS-INSTALL4.                             
                                                                                
                                                                                
           COMPUTE WS-TOT-INSTALL = K410-AMT-MTHLY-CPF1 +                       
                                    K410-AMT-MTHLY-CPF2 +                       
                                    K410-AMT-MTHLY-CPF3 +                       
                                    K410-AMT-MTHLY-CPF4.                        
                                                                                
                                                                                
           MOVE K410-AMT-LOAN            TO FW3A-AMT-LOAN-HDB.                  
      *    MOVE K410-AMT-PREMIUM-NEW     TO FW3A-AMT-PREMIUM.                   
                                                                                
           COMPUTE WS-TOT-FEE    = K410-AMT-PREMIUM-STAMP-FEE +                 
                                   K410-AMT-CONVEY-FEE        +                 
                                   K410-AMT-CONVEY-FEE-GST    +                 
                                   K410-AMT-SURVEY-FEE        +                 
                                   K410-AMT-SURVEY-FEE-GST    +                 
                                   K410-AMT-LEASE-ESCROW-FEE  +                 
                                   K410-AMT-LEASE-REGN-FEE    +                 
                                   K410-AMT-MORT-ESCROW-FEE   +                 
                                   K410-AMT-MORT-STAMP-FEE    +                 
                                   K410-AMT-MORT-REGN-FEE                       
                                                                                
           MOVE K410-CDE-INTEREST-RATE TO FW3A-NUM-LOAN-RATE.                   
           MOVE K410-AMT-MTHLY-CASH TO FW3A-AMT-MNTLY-INSTAL-CASH.              
                                                                                
           IF K410-CDE-SA-TP = 'Y'                                              
             COMPUTE WS-TOT-CD = K410-AMT-BK-TRANSFER +                         
                                 K410-AMT-RDE-TRANSFER                          
                                                                                
             MOVE WS-TOT-CD   TO FW3A-AMT-CD-CASH                               
           END-IF.                                                              
                                                                                
           MOVE ZEROS TO WS-FEE-CASH,                                           
                         WS-FEE-CPF,                                            
                         WS-FEE-CPF1,                                           
                         WS-FEE-CPF2,                                           
                         WS-FEE-CPF3,                                           
                         WS-FEE-CPF4.                                           
                                                                                
                                                                                
           IF K410-NUM-LOAN-TAG NOT = 'B'                                       
              IF K410-AMT-ICP-CASH >= WS-TOT-FEE                                
                 COMPUTE WS-FEE-CASH = WS-TOT-FEE                               
              ELSE                                                              
                                                                                
                 COMPUTE WS-FEE-CASH = K410-AMT-ICP-CASH                        
                 COMPUTE WS-FEE-CPF  = WS-TOT-FEE - WS-FEE-CASH                 
                                                                                
                 COMPUTE WS-REM = K410-AMT-ICP-CPF1 - WS-FEE-CPF                
                 IF WS-REM > ZEROS                                              
                    COMPUTE WS-FEE-CPF1 = WS-FEE-CPF                            
                 ELSE                                                           
                    COMPUTE WS-REM = (K410-AMT-ICP-CPF1 +                       
                                      K410-AMT-ICP-CPF2) -                      
                                      WS-FEE-CPF                                
                    IF WS-REM > ZEROS                                           
                       COMPUTE WS-FEE-CPF2 = WS-FEE-CPF -                       
                                             K410-AMT-ICP-CPF1                  
                    ELSE                                                        
                       COMPUTE WS-REM = (K410-AMT-ICP-CPF1 +                    
                                         K410-AMT-ICP-CPF2 +                    
                                         K410-AMT-ICP-CPF3) -                   
                                         WS-FEE-CPF                             
                       IF WS-REM > ZEROS                                        
                          COMPUTE WS-FEE-CPF3 = WS-FEE-CPF -                    
                                                K410-AMT-ICP-CPF1 -             
                                                K410-AMT-ICP-CPF2               
                       ELSE                                                     
                          COMPUTE WS-REM      = WS-FEE-CPF -                    
                                                K410-AMT-ICP-CPF1 -             
                                                K410-AMT-ICP-CPF2 -             
                                                K410-AMT-ICP-CPF3               
                          IF WS-REM > ZEROS                                     
                             COMPUTE WS-FEE-CPF4 = WS-REM                       
                          ELSE                                                  
                             COMPUTE WS-FEE-CPF4 = ZEROS                        
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                  END-IF                                                        
              END-IF                                                            
                                                                                
           ELSE                                                                 
              MOVE K410-AMT-ICP-CASH   TO WS-ICP-CASH                           
              MOVE K410-AMT-ICP-CPF1   TO WS-ICP-CPF1                           
              MOVE K410-AMT-ICP-CPF2   TO WS-ICP-CPF2                           
              MOVE K410-AMT-ICP-CPF3   TO WS-ICP-CPF3                           
              MOVE K410-AMT-ICP-CPF4   TO WS-ICP-CPF4                           
                                                                                
           END-IF.                                                              
                                                                                
                                                                                
           COMPUTE WS-ICP-CASH = K410-AMT-ICP-CASH - WS-FEE-CASH.               
           COMPUTE WS-ICP-CPF1 = K410-AMT-ICP-CPF1 - WS-FEE-CPF1.               
           COMPUTE WS-ICP-CPF2 = K410-AMT-ICP-CPF2 - WS-FEE-CPF2.               
           COMPUTE WS-ICP-CPF3 = K410-AMT-ICP-CPF3 - WS-FEE-CPF3.               
           COMPUTE WS-ICP-CPF4 = K410-AMT-ICP-CPF4 - WS-FEE-CPF4.               
                                                                                
           COMPUTE WS-TOT-ICP = WS-ICP-CPF1 +                                   
                                WS-ICP-CPF2 +                                   
                                WS-ICP-CPF3 +                                   
                                WS-ICP-CPF4.                                    
                                                                                
                                                                                
      *----------*                                                              
       3050-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *----------*                                                              
       3060-INITIALIZE-FIELDS.                                                  
      *----------*                                                              
                                                                                
           IF K410-AMT-CD-CASH NOT NUMERIC                                      
              MOVE ZEROES         TO K410-AMT-CD-CASH                           
           END-IF                                                               
                                                                                
           IF K410-AMT-CD-CPF1 NOT NUMERIC                                      
              MOVE ZEROES         TO K410-AMT-CD-CPF1                           
           END-IF                                                               
                                                                                
           IF K410-AMT-CD-CPF2 NOT NUMERIC                                      
              MOVE ZEROES         TO K410-AMT-CD-CPF2                           
           END-IF                                                               
                                                                                
           IF K410-AMT-CD-CPF3 NOT NUMERIC                                      
              MOVE ZEROES         TO K410-AMT-CD-CPF3                           
           END-IF                                                               
                                                                                
           IF K410-AMT-CD-CPF4 NOT NUMERIC                                      
              MOVE ZEROES         TO K410-AMT-CD-CPF4                           
           END-IF                                                               
                                                                                
           IF K410-AMT-ICP-CASH NOT NUMERIC                                     
              MOVE ZEROES         TO K410-AMT-ICP-CASH                          
           END-IF                                                               
                                                                                
                                                                                
           IF K410-AMT-ICP-CPF1 NOT NUMERIC                                     
              MOVE ZEROES         TO K410-AMT-ICP-CPF1                          
           END-IF                                                               
                                                                                
           IF K410-AMT-ICP-CPF2 NOT NUMERIC                                     
              MOVE ZEROES         TO K410-AMT-ICP-CPF2                          
           END-IF                                                               
                                                                                
           IF K410-AMT-ICP-CPF3 NOT NUMERIC                                     
              MOVE ZEROES         TO K410-AMT-ICP-CPF3                          
           END-IF                                                               
                                                                                
           IF K410-AMT-ICP-CPF4 NOT NUMERIC                                     
              MOVE ZEROES         TO K410-AMT-ICP-CPF4                          
           END-IF                                                               
                                                                                
           IF K410-AMT-MTHLY-CASH NOT NUMERIC                                   
              MOVE ZEROES         TO K410-AMT-MTHLY-CASH                        
           END-IF                                                               
                                                                                
                                                                                
           IF K410-AMT-MTHLY-CPF1 NOT NUMERIC                                   
              MOVE ZEROES          TO K410-AMT-MTHLY-CPF1                       
           END-IF                                                               
                                                                                
           IF K410-AMT-MTHLY-CPF2 NOT NUMERIC                                   
              MOVE ZEROES          TO K410-AMT-MTHLY-CPF2                       
           END-IF                                                               
                                                                                
           IF K410-AMT-MTHLY-CPF3 NOT NUMERIC                                   
              MOVE ZEROES          TO K410-AMT-MTHLY-CPF3                       
           END-IF                                                               
                                                                                
           IF K410-AMT-MTHLY-CPF4 NOT NUMERIC                                   
              MOVE ZEROES          TO K410-AMT-MTHLY-CPF4                       
           END-IF                                                               
                                                                                
                                                                                
           IF K410-AMT-PREMIUM-STAMP-FEE IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-PREMIUM-STAMP-FEE                
           END-IF                                                               
                                                                                
           IF K410-AMT-CONVEY-FEE        IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-CONVEY-FEE                       
           END-IF                                                               
                                                                                
           IF K410-AMT-CONVEY-FEE-GST    IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-CONVEY-FEE-GST                   
           END-IF                                                               
                                                                                
           IF K410-AMT-SURVEY-FEE        IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-SURVEY-FEE                       
           END-IF                                                               
                                                                                
           IF K410-AMT-SURVEY-FEE-GST    IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-SURVEY-FEE-GST                   
           END-IF                                                               
                                                                                
           IF K410-AMT-MORT-REGN-FEE     IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-MORT-REGN-FEE                    
           END-IF                                                               
                                                                                
           IF K410-AMT-SURVEY-FEE        IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-SURVEY-FEE                       
           END-IF                                                               
                                                                                
           IF K410-AMT-MORT-ESCROW-FEE   IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-MORT-ESCROW-FEE                  
           END-IF                                                               
                                                                                
           IF K410-AMT-MORT-STAMP-FEE    IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-MORT-STAMP-FEE                   
           END-IF                                                               
                                                                                
           IF K410-AMT-MORT-REGN-FEE     IS NOT NUMERIC                         
              MOVE ZEROES          TO K410-AMT-MORT-REGN-FEE                    
           END-IF.                                                              
      *----------*                                                              
       3060-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
      ******************************************************************        
      * THIS PARA MOVES DESIRED FIELDS FROM FBP13F800 TO BP13FW03(O/P) *        
      ******************************************************************        
      *---------------*                                                         
       3100-MOVE-F800.                                                          
      *---------------*                                                         
                                                                                
                                                                                
           MOVE F800-NUM-REGN              TO FW3A-NUM-REGN                     
                                              WS-FW3B-NUM-REGN.                 
                                                                                
           IF (F800-NUM-NEW-TOWN(1:1) = '0') OR                                 
              (F800-NUM-NEW-TOWN(1:2) = 'NN' OR 'WW' OR 'EE' OR 'WI' OR         
                                        'NW' OR 'WE' OR 'NE')                   
              MOVE SPACES                  TO FW3A-NUM-NEW-TOWN                 
           ELSE                                                                 
              MOVE F800-NUM-NEW-TOWN       TO FW3A-NUM-NEW-TOWN                 
           END-IF                                                               
                                                                                
            IF FW3A-NUM-NEW-TOWN NOT = SPACES AND LOW-VALUES                    
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '02'                   TO K060-SERIAL-NO                    
               MOVE FW3A-NUM-NEW-TOWN      TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               IF K060-CODE = 'V6 ' OR 'WIA' OR '3R '                           
                  MOVE SPACES              TO FW3A-NUM-NEW-TOWN                 
               ELSE                                                             
                  MOVE K060-CODE           TO FW3A-NUM-NEW-TOWN                 
               END-IF                                                           
            END-IF                                                              
                                                                                
           MOVE FW3A-NUM-NEW-TOWN          TO WS-FW3B-NUM-NEW-TOWN.             
                                                                                
           IF F800-NUM-FLAT-TYPE = '1A' OR '2A' OR '2F'                         
              MOVE F800-NUM-FLAT-TYPE      TO FW3A-NUM-FLAT-TYPE                
           ELSE                                                                 
             IF F800-NUM-FLAT-TYPE(1:1) = '1' OR '2' OR '3' OR '4'              
                                       OR '5' OR '6' OR 'E' OR 'S'              
                MOVE F800-NUM-FLAT-TYPE(1:1) TO FW3A-NUM-FLAT-TYPE(1:1)         
             ELSE                                                               
                MOVE SPACES                  TO FW3A-NUM-FLAT-TYPE              
             END-IF                                                             
           END-IF                                                               
                                                                                
           MOVE FW3A-NUM-FLAT-TYPE         TO WS-FW3B-NUM-FLAT-TYPE.            
                                                                                
           MOVE F800-DTE-BALLOT            TO FW3A-DTE-BALLOT                   
           IF F800-AMT-BK-PAID IS NUMERIC                                       
              MOVE F800-AMT-HSE-INCOME     TO FW3A-AMT-HSEHOLD-INCOME           
           ELSE                                                                 
              MOVE ZEROES                  TO FW3A-AMT-HSEHOLD-INCOME           
           END-IF                                                               
           MOVE F800-NUM-LOAN-TAG          TO FW3A-NUM-LOAN-TAG                 
           MOVE F800-AMT-CA-INCOME         TO FW3A-AMT-CA-INCOME                
                                                                                
      **CHECK VALID ELIG-SCH SERIAL = 06**                                      
           IF F800-NUM-ELIG-SCHEME NOT = SPACES AND LOW-VALUES                  
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '06'                   TO K060-SERIAL-NO                    
               MOVE F800-NUM-ELIG-SCHEME   TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               MOVE K060-CODE              TO FW3A-NUM-ELIG-SCH                 
            END-IF                                                              
                                                                                
      **TO CHECK VALID ALLO-SCHEME SERIAL = 05**                                
           IF F800-NUM-ALLO-SCHEME NOT = SPACES AND LOW-VALUES                  
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '05'                   TO K060-SERIAL-NO                    
               MOVE F800-NUM-ALLO-SCHEME   TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               MOVE K060-CODE              TO FW3A-NUM-ALLOC-SCH                
            END-IF                                                              
                                                                                
           IF F800-AMT-BK-PAID IS NUMERIC                                       
              MOVE F800-AMT-BK-PAID        TO FW3A-AMT-BK-PAID                  
           ELSE                                                                 
              MOVE ZEROES                  TO FW3A-AMT-BK-PAID                  
           END-IF                                                               
           MOVE F800-NUM-CAT               TO FW3A-NUM-ETHNIC                   
           IF FW3A-NUM-ETHNIC NOT = SPACES AND LOW-VALUES                       
              MOVE SPACES                  TO BP13K060-REC                      
              MOVE '09'                    TO K060-SERIAL-NO                    
              STRING FW3A-NUM-ETHNIC '  '  DELIMITED BY SIZE                    
                                         INTO K060-CODE                         
              END-STRING                                                        
              PERFORM 4000-READ-K060                                            
                 THRU 4000-EXIT                                                 
              MOVE K060-DESC(1:1)          TO FW3A-NUM-ETHNIC                   
           END-IF.                                                              
                                                                                
           MOVE F800-NUM-SCH-ACC           TO FW3A-HDB-REFNO                    
                                              WS-FW3B-HDB-REFNO.                
                                                                                
           MOVE F800-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                           TO FW3A-CITIZENSHIP-HSEHOLD          
           IF WS-APPL-STATUS = 'BK' OR 'SA' OR 'TP' OR 'AP'                     
              MOVE SPACES                  TO FW3A-DTE-CANCEL                   
                                              FW3A-CANCEL-REASON                
           ELSE                                                                 
              MOVE F800-DTE-CANCEL         TO FW3A-DTE-CANCEL                   
              MOVE F800-NUM-CANCEL-REASON  TO FW3A-CANCEL-REASON                
           END-IF                                                               
                                                                                
           MOVE F800-NUM-ALLO-CAT          TO FW3A-NUM-ALLO-CAT                 
           MOVE F800-NUM-ALLOC-TAG         TO FW3A-NUM-ALLOC-TAG                
           IF FW3A-CANCEL-REASON NOT = SPACES AND LOW-VALUES AND '00'           
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '36'                   TO K060-SERIAL-NO                    
               MOVE FW3A-CANCEL-REASON     TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               MOVE K060-CODE              TO FW3A-CANCEL-REASON                
            ELSE                                                                
               MOVE SPACES                 TO FW3A-CANCEL-REASON                
            END-IF                                                              
                                                                                
           IF F800-NUM-HOUSEHOLD         =  'H' OR 'T'                          
              MOVE 'H'                   TO FW3A-NUM-HSEHOLD-TYPE               
           ELSE                                                                 
              MOVE F800-NUM-HOUSEHOLD    TO FW3A-NUM-HSEHOLD-TYPE               
           END-IF                                                               
                                                                                
           INITIALIZE        WS-FW03-AHG-GRANT                                  
                             WS-FW03-SHG-GRANT.                                 
                                                                                
           IF ((F800-NUM-HOUSEHOLD   =  'H' OR 'T') OR                          
               (F800-CDE-BALLOT-HOUSEHOLD  = 'H' OR 'T' OR 'F'))                
               IF WS-FOUND = 'Y'                                                
                   COMPUTE WS-FW03-AHG-GRANT  = WS-DB2-AMT-AHG-GRANT -          
                                                WS-DB2-AMT-AHG-RECVR            
                                                                                
                   COMPUTE WS-FW03-SHG-GRANT  = WS-DB2-AMT-SHG-GRANT -          
                                                WS-DB2-AMT-SHG-RECVR            
               ELSE                                                             
                   PERFORM 6090-DECODE-AHG-SHG  THRU 6090-EXIT                  
               END-IF                                                           
           ELSE                                                                 
             MOVE ZEROES               TO WS-FW03-AHG-GRANT                     
                                          WS-FW03-SHG-GRANT                     
           END-IF.                                                              
                                                                                
           IF F800-NUM-REGN(1:1) = '5'                                          
             PERFORM 6080-READ-BP13KD00   THRU 6080-EXIT                        
             IF KD00-AMT-MAX-LOAN NOT NUMERIC                                   
                MOVE ZEROES              TO KD00-AMT-MAX-LOAN                   
             END-IF                                                             
             MOVE KD00-AMT-MAX-LOAN      TO FW3A-AMT-MAX-LOAN                   
             ADD    1 TO WS-DBSS                                                
           ELSE                                                                 
             PERFORM 6085-READ-BP13K640   THRU 6085-EXIT                        
             IF K640-AMT-MAX-LOAN NOT NUMERIC                                   
                MOVE ZEROES              TO K640-AMT-MAX-LOAN                   
             END-IF                                                             
             MOVE K640-AMT-MAX-LOAN      TO FW3A-AMT-MAX-LOAN                   
             ADD    1 TO WS-NON-DBSS                                            
           END-IF.                                                              
                                                                                
                                                                                
           MOVE F800-CDE-MCPS-REQ(1:1) TO FW3A-NUM-MCPS.                        
           MOVE F800-CDE-MCPS-REQ(2:1) TO FW3A-CDE-MCPS-ELIG.                   
           MOVE F800-NUM-MCPS-POSTAL   TO FW3A-NUM-MCPS-POSTAL.                 
           MOVE F800-NUM-APPS          TO FW3A-NUM-APPS.                        
           MOVE F800-NUM-APPS-ELIG-TAG TO FW3A-NUM-APPS-ELIG-TAG.               
           MOVE F800-NUM-GEN3          TO FW3A-NUM-GEN3.                        
           MOVE F800-NUM-FT2T          TO FW3A-NUM-FT2T.                        
           MOVE F800-NUM-AST-ELIG      TO FW3A-NUM-AST-ELIG.                    
           MOVE F800-NUM-PPS-ELIG      TO FW3A-NUM-PPS-ELIG.                    
           MOVE F800-NUM-BALLOT-STATUS TO FW3A-NUM-BALLOT-STATUS.               
           MOVE F800-NUM-MGPS          TO FW3A-NUM-MGPS.                        
           MOVE F800-NUM-QUEUE-MGPS    TO FW3A-NUM-QUEUE-MGPS.                  
           MOVE F800-NUM-NT-FT-QUEUE   TO FW3A-NUM-NT-FT-QUEUE.                 
           MOVE F800-DTE-SALE-AGMT     TO FW3A-DTE-SALE-AGMT.                   
           MOVE F800-DTE-2ND-CA-SENT   TO FW3A-DTE-2ND-CA-SENT.                 
           MOVE F800-DTE-SO-APPT       TO FW3A-DTE-TP-APPT.                     
           MOVE F800-DTE-REGN             TO FW3A-DTE-REGN.                     
           MOVE F800-NUM-BTO-ZONE         TO FW3A-NUM-BTO-ZONE.                 
           MOVE F800-CDE-BALLOT-HOUSEHOLD TO FW3A-NUM-BALLOT-HSEHOLD.           
           MOVE F800-NUM-DNC-REASON    TO FW3A-NUM-DNC-REASON.                  
           MOVE F800-NUM-ELDERLY       TO FW3A-NUM-ELDERLY.                     
           MOVE F800-NUM-PPO           TO FW3A-NUM-PPO.                         
           MOVE F800-NUM-NTIMER        TO FW3A-NUM-NTIMER.                      
           MOVE F800-NUM-LEASE-TENURE  TO FW3A-NUM-LEASE-TENURE.                
                                                                                
           IF F800-AMT-PREMIUM IS NOT NUMERIC                                   
              MOVE ZEROES     TO F800-AMT-PREMIUM                               
           END-IF.                                                              
           MOVE F800-AMT-PREMIUM       TO FW3A-AMT-PREMIUM .                    
                                                                                
           MOVE F800-NUM-ELDERLY-EXEMPTION                                      
                         TO FW3A-NUM-ELDERLY-EXEMPTION.                         
                                                                                
      *----------*                                                              
       3100-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *---------------------*                                                   
       3105-CALL-BP13C913.                                                      
      *---------------------*                                                   
                                                                                
           CALL WS-BP13C913 USING WS-LINK-REC, BP13COMM8-REC                    
           END-CALL.                                                            
                                                                                
           IF COMM8-CDE-SYSERR NOT = 0                                          
                                                                                
              IF COMM8-CDE-SYSERR = 100                                         
                 DISPLAY 'SCH-ACC NOT FOUND IN PBF TABLE'                       
                         COMM8-CDE-SYSERR                                       
              ELSE                                                              
                 DISPLAY 'ERROR READING PBF TABLE' COMM8-CDE-SYSERR             
              END-IF                                                            
              MOVE SPACES        TO BP13COMM8-REC                               
           END-IF.                                                              
                                                                                
       3105-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *---------------*                                                         
       3200-START-K820.                                                         
      *---------------*                                                         
           INITIALIZE  BP13K820-REC                                             
                                                                                
           MOVE 'N'                        TO WS-K820-FOUND                     
                                                                                
           MOVE SPACES                     TO K820-KEY-FLD                      
           MOVE F800-NUM-REGN              TO K820-NUM-REGN                     
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD                                   
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K820-OK                                                 
                    CONTINUE                                                    
               WHEN BP13K820-02                                                 
                    CONTINUE                                                    
               WHEN BP13K820-NFND                                               
                    DISPLAY 'KEY NOT FOUND IN BP13K820!'                        
                    DISPLAY 'KEY : ' K820-KEY-FLD                               
                    SET BP13K820-EOF       TO TRUE                              
               WHEN OTHER                                                       
                    DISPLAY 'ERROR LOCATING KEY IN BP13K820!'                   
                    DISPLAY 'KEY : ' K820-KEY-FLD                               
                    DISPLAY 'FILE STATUS :' BP13K820-STATUS                     
                    MOVE BP13K820-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
           END-EVALUATE                                                         
           .                                                                    
      *----------*                                                              
       3200-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *1) ISSUES READ NEXT FOR FILE,BP13K820                         ***        
      *2) CHECKS IF THE REGN NO. MATCHES THE ONE FROM IPUT FILE,F800 ***        
      *3) IF MATCHED MOVE VALUES NEEDED TO THE OUTPUT FILE           ***        
      *4) THE ABOVE PROCESS IS REPEATED UNTIL ALL MATCHING RECORDS   ***        
      *   ARE PROCESSED                                              ***        
      ******************************************************************        
      *---------------*                                                         
       3300-READ-K820.                                                          
      *---------------*                                                         
                                                                                
           READ BP13K820 NEXT                                                   
           AT END                                                               
              SET BP13K820-EOF             TO TRUE                              
           END-READ                                                             
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K820-OK                                                 
                 IF  K820-NUM-REGN = F800-NUM-REGN                              
                    ADD  1                 TO WS-K820-READ-CNT                  
                    MOVE 'Y'               TO WS-K820-FOUND                     
                    PERFORM 3310-PROCESS-CODES                                  
                       THRU 3310-EXIT                                           
                    PERFORM 3330-MOVE-TO-FW03                                   
                       THRU 3330-EXIT                                           
                 ELSE                                                           
                    SET BP13K820-EOF       TO TRUE                              
                 END-IF                                                         
                                                                                
               WHEN BP13K820-04                                                 
                    DISPLAY 'INVALID RECORD LENGTH!'                            
                    DISPLAY 'K820-NUM-REGN :' K820-NUM-REGN                     
                    DISPLAY 'FILE STATUS : ' BP13K820-STATUS                    
               WHEN BP13K820-EOF                                                
                    DISPLAY 'END OF FILE REACHED FOR K820!'                     
                    DISPLAY 'NUMBER OF VALID RECORDS READ:'                     
                             WS-K820-READ-CNT                                   
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K820!'                           
                    DISPLAY 'K820-NUM-REGN :' K820-NUM-REGN                     
                    DISPLAY 'FILE STATUS : ' BP13K820-STATUS                    
                    MOVE BP13K820-STATUS   TO RETURN-CODE                       
                                                                                
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3300-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *THE CODE IN BP13K820 IS DECODED USING FILE BP13K060 IN THIS PARA*        
      ******************************************************************        
      *------------------*                                                      
       3310-PROCESS-CODES.                                                      
      *------------------*                                                      
            MOVE SPACES TO WS-ETHNIC                                            
                           WS-SEX                                               
                           WS-MARITAL-STATUS                                    
                                                                                
            IF K820-NUM-ETHNIC IS NUMERIC                                       
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '42'                   TO K060-SERIAL-NO                    
               MOVE K820-NUM-ETHNIC        TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               MOVE K060-DESC              TO WS-ETHNIC                         
            ELSE                                                                
               MOVE K820-NUM-ETHNIC        TO WS-ETHNIC                         
            END-IF                                                              
                                                                                
            IF WS-ETHNIC NOT = 'C' AND 'I' AND 'M' AND 'O'                      
               MOVE SPACES              TO WS-ETHNIC                            
            END-IF                                                              
                                                                                
            IF K820-NUM-SEX IS NUMERIC                                          
               IF K820-NUM-SEX = ZERO                                           
                  MOVE SPACES                TO WS-SEX                          
               ELSE                                                             
                 MOVE SPACES                 TO BP13K060-REC                    
                 MOVE '43'                   TO K060-SERIAL-NO                  
                 MOVE K820-NUM-SEX           TO K060-CODE                       
                 PERFORM 4000-READ-K060                                         
                    THRU 4000-EXIT                                              
                 MOVE K060-DESC              TO WS-SEX                          
               END-IF                                                           
            END-IF                                                              
                                                                                
            IF K820-NUM-MARITAL-STATUS NOT = SPACES AND LOW-VALUES              
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '44'                   TO K060-SERIAL-NO                    
               MOVE K820-NUM-MARITAL-STATUS                                     
                                           TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               MOVE K060-DESC              TO WS-MARITAL-STATUS                 
            END-IF                                                              
                                                                                
            .                                                                   
      *---------*                                                               
       3310-EXIT.                                                               
      *---------*                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
      * THIS PARA MOVES DESIRED FIELDS AND DECODED VALUES FROM BP13K820*        
      * TO O/P                                                         *        
      ******************************************************************        
      *------------------*                                                      
       3330-MOVE-TO-FW03.                                                       
      *------------------*                                                      
            MOVE SPACES      TO BP13FW3B-REC.                                   
            INITIALIZE          BP13FW3B-REC.                                   
                                                                                
             IF K820-NUM-CSTMR-SOURCE = SPACES OR LOW-VALUES                    
                GO TO 3330-EXIT.                                                
                                                                                
             MOVE 'Y'                  TO WS-VALID-CUST-ID.                     
                                                                                
             MOVE K820-NUM-CSTMR-SOURCE  TO FW3B-NUM-CUSTOMER-ID.               
             MOVE K820-NUM-CITIZENSHIP   TO FW3B-NUM-CITIZENSHIP.               
             MOVE K820-DTE-BIRTH         TO FW3B-DTE-BIRTH.                     
             IF K820-AMT-INCOME NOT NUMERIC                                     
                MOVE ZEROES              TO K820-AMT-INCOME                     
             END-IF.                                                            
             MOVE K820-AMT-INCOME  TO    FW3B-AMT-INCOME.                       
             MOVE K820-NUM-EDUCATION TO  FW3B-NUM-EDU-LVL.                      
             MOVE WS-ETHNIC      TO      FW3B-NUM-RACE.                         
             MOVE WS-SEX         TO      FW3B-NUM-SEX.                          
             MOVE WS-MARITAL-STATUS      TO                                     
                     FW3B-NUM-MARITAL-STATUS.                                   
             MOVE K820-NUM-RELATIONSHIP  TO                                     
                  FW3B-NUM-RELATIONSHIP.                                        
             MOVE K820-DTE-BIRTH       TO FW3B-DTE-BIRTH.                       
             MOVE K820-AMT-INCOME      TO FW3B-AMT-INCOME.                      
                                                                                
                                                                                
             IF K820-NUM-NRIC = F800-NUM-NRIC1                                  
                MOVE WS-ICP-CPF1    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF1     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL1    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H1'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
             IF K820-NUM-NRIC = F800-NUM-NRIC2                                  
                MOVE WS-ICP-CPF2    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF2     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL2    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H2'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
             IF K820-NUM-NRIC = F800-NUM-NRIC3                                  
                MOVE WS-ICP-CPF3    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF3     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL3    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H3'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
                                                                                
             IF K820-NUM-NRIC = F800-NUM-NRIC4                                  
                MOVE WS-ICP-CPF4    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF4     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL4    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H4'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
                ADD 1               TO WS-NUM-OCCP                              
                MOVE 'O'            TO FW3B-NUM-APPL-OCCP(1:1)                  
                MOVE WS-NUM-OCCP    TO FW3B-NUM-APPL-OCCP(2:1)                  
             END-IF                                                             
             END-IF                                                             
             END-IF                                                             
             END-IF.                                                            
                                                                                
             IF F800-NUM-REGN(1:1) NOT = '5'                                    
               MOVE SPACES                 TO K734-KEY-FLD                      
               MOVE K820-KEY-FLD           TO K734-KEY-FLD                      
               PERFORM 3600-READ-K734      THRU 3600-EXIT                       
               MOVE K734-NUM-EMPLY-STATUS  TO FW3B-NUM-EMP-STAT                 
             ELSE                                                               
               MOVE SPACES            TO   KB78-KEY-FLD                         
               MOVE K820-NUM-REGN     TO   KB78-NUM-REGN                        
               PERFORM 3700-READ-KB78      THRU 3700-EXIT                       
               DISPLAY ' REGN - ' KB78-NUM-REGN                                 
                       'EMP - ' KB78-NUM-APPLT1-EMPLY-STATUS                    
               IF K820-NUM-NRIC = KB78-NUM-APPLT1-UIN                           
                 MOVE KB78-NUM-APPLT1-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-APPLT2-UIN                           
                 MOVE KB78-NUM-APPLT2-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-APPLT3-UIN                           
                 MOVE KB78-NUM-APPLT3-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-APPLT4-UIN                           
                 MOVE KB78-NUM-APPLT4-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP1-UIN                           
                 MOVE KB78-NUM-OCCUP1-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP2-UIN                           
                 MOVE KB78-NUM-OCCUP2-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP3-UIN                           
                 MOVE KB78-NUM-OCCUP3-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP4-UIN                           
                 MOVE KB78-NUM-OCCUP4-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP5-UIN                           
                 MOVE KB78-NUM-OCCUP5-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP6-UIN                           
                 MOVE KB78-NUM-OCCUP6-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP7-UIN                           
                 MOVE KB78-NUM-OCCUP7-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K820-NUM-NRIC = KB78-NUM-OCCUP8-UIN                           
                 MOVE KB78-NUM-OCCUP8-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
             END-IF.                                                            
                                                                                
             MOVE WS-FW3B-NUM-REGN       TO FW3B-NUM-REGN                       
             MOVE WS-FW3B-HDB-REFNO      TO FW3B-HDB-REFNO                      
             MOVE WS-FW3B-NUM-NEW-TOWN   TO FW3B-NUM-NEW-TOWN                   
             MOVE WS-FW3B-NUM-FLAT-TYPE  TO FW3B-NUM-FLAT-TYPE                  
                                                                                
      *      MOVE K820-NUM-EXIST-NT      TO FW3B-NUM-EXIST-NT                   
      *      MOVE K820-NUM-EXIST-FT      TO FW3B-NUM-EXIST-FT                   
                                                                                
             IF K820-AMT-INCOME-TP NOT NUMERIC                                  
                MOVE ZEROES   TO K820-AMT-INCOME-TP                             
             END-IF.                                                            
                                                                                
             MOVE K820-AMT-INCOME-TP     TO FW3B-AMT-INCOME-TP                  
             COMPUTE WS-FW3A-AMT-TP-INCOME = K820-AMT-INCOME-TP +               
                                             WS-FW3A-AMT-TP-INCOME.             
                                                                                
             MOVE K820-NUM-PHONE            TO FW3B-NUM-HP-PGR                  
             MOVE K820-NUM-HP-PGR           TO FW3B-NUM-PHONE                   
                                                                                
             MOVE K734-NUM-DIVORCE-GE3YRS   TO FW3B-NUM-DIVORCE-GE3YRS          
             MOVE K734-DTE-DIVORCE          TO FW3B-DTE-DIVORCE                 
                                                                                
             PERFORM 6610-WRITE-BP13FW3G    THRU 6610-EXIT.                     
             PERFORM 6600-WRITE-BP13FW3B    THRU 6600-EXIT.                     
                                                                                
      *---------*                                                               
       3330-EXIT.                                                               
      *---------*                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
      * THIS PARA READS FILE, BP13K830 TO FETCH THE CORRESPONDENCE ADDR*        
      ******************************************************************        
      *---------------*                                                         
       3400-READ-K830.                                                          
      *---------------*                                                         
           MOVE SPACES                     TO BP13K830-REC                      
           MOVE F800-NUM-REGN              TO K830-NUM-REGN-BK                  
                                                                                
           READ BP13K830                                                        
                                                                                
           EVALUATE TRUE                                                        
                                                                                
               WHEN BP13K830-OK                                                 
                 ADD 1                     TO WS-K830-READ-CNT                  
                 IF K830-NME-MAIL-STR-BLDG = SPACES OR LOW-VALUES               
                    MOVE K830-NUM-POSTAL   TO FW3A-NUM-CORR-POSTAL              
                                                                                
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-POSTAL                                   
                                           TO FW3A-NUM-CORR-POSTAL              
                 END-IF                                                         
                                                                                
               WHEN BP13K830-NFND                                               
                 ADD 1                     TO WS-K830-NOTFD-CNT                 
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K830!'                           
                    DISPLAY 'K830-NUM-REGN :' K830-NUM-REGN                     
                    DISPLAY 'FILE STATUS : ' BP13K830-STATUS                    
                    MOVE BP13K830-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3400-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
      ******************************************************************        
      * THIS PARA READS FILE BP13K410 TO FETCH VARIOUS AMOUNT FIELDS  *         
      ******************************************************************        
      *--------------*                                                          
       3500-READ-K410.                                                          
      *--------------*                                                          
           INITIALIZE BP13K410-REC                                              
           MOVE F800-NUM-REGN              TO K410-NUM-REGN                     
                                                                                
           READ BP13K410.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K410-OK                                                 
                     ADD 1                  TO WS-K410-READ-CNT                 
                     IF K410-NUM-LOAN-TAG = 'B'                                 
                       PERFORM 3800-READ-BP13K670  THRU 3800-EXIT               
                       MOVE K670-AMT-LOAN-QUANTUM TO FW3A-AMT-LOAN-BANK         
                       MOVE K670-NUM-LOAN-TERM TO FW3A-NUM-REPAY-PERIOD         
                     ELSE                                                       
                       MOVE ZEROES         TO FW3A-AMT-LOAN-BANK                
                     END-IF                                                     
                                                                                
                     IF K410-NUM-LOAN-TAG = 'H'                                 
                        MOVE K410-AMT-LOAN  TO FW3A-AMT-LOAN-HDB                
                        MOVE K410-NUM-REPAY-PERIOD                              
                                              TO FW3A-NUM-REPAY-PERIOD          
                     ELSE                                                       
                        MOVE ZEROES         TO FW3A-AMT-LOAN-HDB                
                     END-IF                                                     
                                                                                
                                                                                
                 MOVE 'TP'               TO WS-APPL-STATUS                      
                                                                                
               WHEN BP13K410-NFND                                               
                    ADD 1                  TO WS-K410-NOTFD-CNT                 
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K410!'                           
                    DISPLAY 'K410-NUM-REGN :' K410-NUM-REGN                     
                    DISPLAY 'FILE STATUS : ' BP13K410-STATUS                    
                    MOVE BP13K410-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE.                                                        
                                                                                
      *---------*                                                               
       3500-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      * THIS PARA READS FILE BP13K330 IF     NO KEY ISSUE IN K440     *         
      ******************************************************************        
      *--------------*                                                          
       3550-READ-K330.                                                          
      *--------------*                                                          
           INITIALIZE BP13K330-REC                                              
           MOVE F800-NUM-REGN              TO K330-CURR-REG                     
           MOVE 1                          TO K330-SEQ-NO                       
                                                                                
           READ BP13K330.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K330-OK                                                 
                    ADD 1                  TO WS-K330-READ-CNT                  
                    MOVE K330-AMT-TOPUP-CASH  TO FW3A-AMT-CD-CASH               
                    MOVE K330-AMT-TOPUP-CPF1  TO WS-CD-CPF1                     
                    MOVE K330-AMT-TOPUP-CPF2  TO WS-CD-CPF2                     
                    MOVE K330-AMT-TOPUP-CPF3  TO WS-CD-CPF3                     
                    MOVE K330-AMT-TOPUP-CPF4  TO WS-CD-CPF4                     
                    MOVE 'SA'                 TO WS-APPL-STATUS                 
                    COMPUTE WS-TOT-CD-CPF = WS-CD-CPF1   +                      
                                            WS-CD-CPF2   +                      
                                            WS-CD-CPF3   +                      
                                            WS-CD-CPF4                          
                                                                                
               WHEN BP13K330-NFND                                               
                    ADD 1                  TO WS-K330-NOTFD-CNT                 
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K330!'                           
                    DISPLAY 'K330-CUR-REG  :' K330-CUR-REG                      
                    DISPLAY 'FILE STATUS : ' BP13K330-STATUS                    
                    MOVE BP13K330-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE.                                                        
                                                                                
      *---------*                                                               
       3550-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      * THIS PARA READS FILE BM06K110 FOR SELLING PRICE               *         
      ******************************************************************        
      *--------------*                                                          
       3560-READ-K110.                                                          
      *--------------*                                                          
           INITIALIZE K110-REC.                                                 
           MOVE F800-NUM-SCH-ACC           TO K110-SCH-ACC-NO                   
                                                                                
           READ BM06K110.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BM06K110-OK                                                 
                    ADD 1                    TO WS-K110-READ-CNT                
                    MOVE K110-CURR-SELLING-PRICE  TO                            
                         FW3A-AMT-SELLING                                       
                    MOVE K110-DTE-ACCEPTANCE    TO FW3A-DTE-ACCEPTANCE          
                    MOVE K110-DTE-KEY-ISSUED    TO FW3A-DTE-KEYS-ISSUED         
                    MOVE K110-DTE-SO-EXECUTING  TO                              
                         FW3A-DTE-AGREEMENT-SIGN                                
                    MOVE K110-DTE-KEY-AVAIL     TO FW3A-DTE-KEY-AVAIL           
      *             MOVE K110-DTE-KEY-AVAIL     TO FW3A-NUM-KEY-LOCN            
                                                                                
               WHEN BM06K110-NFND                                               
                    ADD 1                    TO WS-K110-NOTFD-CNT               
                    MOVE SPACES  TO K110-REC                                    
                    MOVE ZEROES   TO FW3A-AMT-SELLING                           
                    MOVE SPACES   TO FW3A-DTE-KEY-AVAIL                         
                                     FW3A-DTE-ACCEPTANCE                        
                                     FW3A-DTE-KEYS-ISSUED                       
                                     FW3A-DTE-AGREEMENT-SIGN                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BM06K110!'                           
                    DISPLAY 'K110-REGN-NO  :' K110-REGN-NO                      
                    DISPLAY 'FILE STATUS : ' BM06K110-STATUS                    
                    MOVE BM06K110-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE.                                                        
                                                                                
      *---------*                                                               
       3560-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3561-READ-K100.                                                          
      *--------------*                                                          
           INITIALIZE K100-REC.                                                 
           IF WS-K950-FOUND = 'Y'                                               
              MOVE K950-AIX1              TO K100-KEY-FLD                       
           ELSE                                                                 
              MOVE K110-AIX1              TO K100-KEY-FLD                       
           END-IF                                                               
                                                                                
           READ BM06K100.                                                       
                                                                                
           EVALUATE BM06K100-STATUS                                             
               WHEN 00                                                          
                    CONTINUE                                                    
               WHEN 23                                                          
                    MOVE SPACES  TO K100-REC                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BM06K100!'                           
                    DISPLAY 'K100-KEY  :' K110-AIX1                             
                    DISPLAY 'FILE STATUS : ' BM06K100-STATUS                    
                    MOVE BM06K100-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END  THRU 9900-EXIT                   
           END-EVALUATE.                                                        
                                                                                
      *---------*                                                               
       3561-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      * THIS PARA FETCHES THE EMPLOYMENT STATUS FROM FILE, BP13K734    *        
      ******************************************************************        
      *--------------*                                                          
       3600-READ-K734.                                                          
      *--------------*                                                          
           READ BP13K734.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K734-OK                                                 
                    ADD 1                  TO WS-K734-READ-CNT                  
                                                                                
               WHEN BP13K734-NFND                                               
                    ADD 1                  TO WS-K734-NOTFD-CNT                 
                    MOVE SPACES            TO K734-NUM-EMPLY-STATUS             
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K734!'                           
                    DISPLAY 'K734-KEY-FLD :' K734-NUM-REGN                      
                    DISPLAY 'FILE STATUS : ' BP13K734-STATUS                    
                    MOVE BP13K734-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3600-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3700-READ-KB78.                                                          
      *--------------*                                                          
           READ BP13KB78.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13KB78-OK                                                 
                    ADD 1                  TO WS-KB78-READ-CNT                  
                                                                                
               WHEN BP13KB78-NFND                                               
                    ADD 1                  TO WS-KB78-NOTFD-CNT                 
                    MOVE SPACES            TO BP13KB78-REC                      
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13KB78!'                           
                    DISPLAY 'K734-KEY-FLD :' KB78-NUM-REGN                      
                    DISPLAY 'FILE STATUS : ' BP13KB78-STATUS                    
                    MOVE BP13KB78-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3700-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3711-DECODE-PACD.                                                        
      *--------------*                                                          
           MOVE SPACES           TO WS-DTE-PACD.                                
           INITIALIZE               WS-DTE-PACD.                                
           MOVE K130-DTE-PACD    TO WS-DTE-PACD.                                
                                                                                
           IF K130-NUM-PACD = 'Q'                                               
              EVALUATE WS-DTE-PACD-QTR                                          
                WHEN '01'                                                       
                 MOVE '01'   TO WS-DTE-PACD-QTR                                 
                WHEN '02'                                                       
                 MOVE '04'   TO WS-DTE-PACD-QTR                                 
                WHEN '03'                                                       
                 MOVE '07'   TO WS-DTE-PACD-QTR                                 
                WHEN '04'                                                       
                 MOVE '10'   TO WS-DTE-PACD-QTR                                 
                WHEN OTHER                                                      
                 CONTINUE                                                       
               END-EVALUATE                                                     
           END-IF.                                                              
                                                                                
           IF K130-NUM-PACD = 'M'                                               
               MOVE K130-DTE-PACD    TO WS-DTE-PACD                             
           END-IF.                                                              
                                                                                
      *---------*                                                               
       3711-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3720-READ-K500.                                                          
      *--------------*                                                          
           MOVE SPACES                                TO BB14K500-REC.          
           INITIALIZE                                    BB14K500-REC.          
                                                                                
           MOVE K130-CDE-BLK                          TO K500-CDE-BLK.          
                                                                                
           READ BB14K500.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BB14K500-OK                                                 
                    ADD 1                  TO WS-K500-READ-CNT                  
                    MOVE K500-DTE-BLDG-COMPLETE TO                              
      *                                FW3A-DTE-BLDG-COMPLETE                   
                                       FW3A-DTE-ECD                             
               WHEN BB14K500-NFND                                               
                    ADD 1                  TO WS-K500-NOTFD-CNT                 
                    MOVE SPACES            TO BB14K500-REC                      
      *                                       FW3A-DTE-BLDG-COMPLETE            
                                              FW3A-DTE-ECD                      
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BB14K500!'                           
                    DISPLAY 'K500-KEY-FLD :' K500-KEY-FLD                       
                    DISPLAY 'FILE STATUS : ' BB14K500-STATUS                    
                    MOVE BM06K500-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3720-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3730-READ-K130.                                                          
      *--------------*                                                          
           MOVE SPACES      TO K130-REC                                         
           MOVE K110-AIX1   TO K130-KEY-FLD.                                    
                                                                                
           READ BM06K130.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BM06K130-OK                                                 
                    ADD 1                  TO WS-K130-READ-CNT                  
                    PERFORM 3711-DECODE-PACD  THRU 3711-EXIT                    
                    MOVE WS-DTE-PACD  TO FW3A-DTE-PCD                           
                    MOVE K130-NME-LOCAL-PRCNCT                                  
                                           TO FW3A-NME-LOCAL-PRCNCT             
                    MOVE K130-DTE-HANDOVER TO FW3A-DTE-HANDOVER                 
                    MOVE K130-DTE-1ST-SOCA TO FW3A-DTE-1ST-SOCA                 
                    MOVE K130-DTE-1ST-KEY-ISSUE                                 
                                           TO FW3A-DTE-1ST-KEY-ISSUE            
               WHEN BM06K130-NFND                                               
                    ADD 1                  TO WS-K130-NOTFD-CNT                 
                    MOVE SPACES            TO K130-REC                          
                                              FW3A-NME-LOCAL-PRCNCT             
                                              FW3A-DTE-HANDOVER                 
                                              FW3A-DTE-1ST-SOCA                 
                                              FW3A-DTE-1ST-KEY-ISSUE            
                                              FW3A-DTE-PCD                      
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BM06K130!'                           
                    DISPLAY 'K130-KEY-FLD :' K130-KEY-FLD                       
                    DISPLAY 'FILE STATUS : ' BM06K130-STATUS                    
                    MOVE BM06K130-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3730-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3740-READ-K580.                                                          
      *--------------*                                                          
           MOVE SPACES                                TO BB14K580-REC.          
           INITIALIZE                                    BB14K580-REC.          
                                                                                
           MOVE F800-NUM-SCH-ACC                      TO K580-KEY-FLD.          
                                                                                
           READ BB14K580.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BB14K580-OK                                                 
                    ADD 1                  TO WS-K580-READ-CNT                  
                    MOVE K580-DTE-UNIT-DELIVERY TO                              
                                       FW3A-DTE-DPD                             
               WHEN BB14K580-NFND                                               
                    ADD 1                  TO WS-K580-NOTFD-CNT                 
                    MOVE SPACES            TO BB14K580-REC                      
                                              FW3A-DTE-DPD                      
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BB14K580!'                           
                    DISPLAY 'K580-KEY-FLD :' K580-KEY-FLD                       
                    DISPLAY 'FILE STATUS : ' BB14K580-STATUS                    
                    MOVE BB14K580-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3740-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       3750-START-K435.                                                         
      *---------------*                                                         
           INITIALIZE  BP13K820-REC                                             
                                                                                
           MOVE 'N'                        TO WS-K435-FOUND                     
           MOVE SPACES                     TO K435-KEY-FLD                      
           MOVE F800-NUM-SCH-ACC           TO K435-NUM-HDB-REF                  
                                                                                
           START BP13K435 KEY >= K435-KEY-FLD                                   
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K435-OK                                                 
                    CONTINUE                                                    
               WHEN BP13K435-02                                                 
                    CONTINUE                                                    
               WHEN BP13K435-NFND                                               
                    DISPLAY 'KEY NOT FOUND IN BP13K435!'                        
                    DISPLAY 'KEY : ' K435-KEY-FLD                               
                    SET BP13K435-EOF       TO TRUE                              
               WHEN OTHER                                                       
                    DISPLAY 'ERROR LOCATING KEY IN BP13K435!'                   
                    DISPLAY 'KEY : ' K435-KEY-FLD                               
                    DISPLAY 'FILE STATUS :' BP13K435-STATUS                     
                    MOVE BP13K435-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
           END-EVALUATE                                                         
           .                                                                    
      *----------*                                                              
       3750-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       3751-READ-K435.                                                          
      *---------------*                                                         
                                                                                
           READ BP13K435 NEXT                                                   
           AT END                                                               
              SET BP13K435-EOF             TO TRUE                              
           END-READ                                                             
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K435-OK                                                 
                 IF  F800-NUM-SCH-ACC = K435-NUM-HDB-REF                        
                    ADD  1                 TO WS-K435-READ-CNT                  
                    MOVE 'Y'               TO WS-K435-FOUND                     
                    MOVE K435-NUM-KEY-LOCN TO FW3A-NUM-KEY-LOCN                 
                 ELSE                                                           
                    SET BP13K435-EOF       TO TRUE                              
                 END-IF                                                         
                                                                                
               WHEN BP13K435-04                                                 
                    DISPLAY 'INVALID RECORD LENGTH!'                            
                    DISPLAY 'K435-KEY-FLD  :' K435-KEY-FLD                      
                    DISPLAY 'FILE STATUS : ' BP13K435-STATUS                    
               WHEN BP13K435-EOF                                                
                    DISPLAY 'END OF FILE REACHED FOR K435!'                     
                    DISPLAY 'NUMBER OF VALID RECORDS READ:'                     
                             WS-K435-READ-CNT                                   
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K435!'                           
                    DISPLAY 'K435-KEY-FLD  :' K435-KEY-FLD                      
                    DISPLAY 'FILE STATUS : ' BP13K435-STATUS                    
                    MOVE BP13K435-STATUS   TO RETURN-CODE                       
                                                                                
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3751-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3770-READ-K022.                                                          
      *--------------*                                                          
           MOVE SPACES                                TO BP13K022-REC.          
           INITIALIZE                                    BP13K022-REC.          
                                                                                
           MOVE F800-NUM-REGN             TO K022-NUM-REGN.                     
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K022-OK                                                 
               WHEN BP13K022-02                                                 
                    ADD 1                  TO WS-K022-READ-CNT                  
                    IF K022-NUM-OIC-APPL NOT = SPACES AND LOW-VALUES            
                       MOVE K022-NUM-OIC       TO FW3A-NUM-POSB-CRM             
                    ELSE                                                        
                       MOVE SPACES             TO FW3A-NUM-POSB-CRM             
                    END-IF                                                      
                    MOVE K022-CDE-ALERT        TO FW3A-NUM-ALERT                
               WHEN BP13K022-NFND                                               
                    ADD 1                  TO WS-K022-NOTFD-CNT                 
                    MOVE SPACES            TO BP13K022-REC                      
                                              FW3A-NUM-POSB-CRM                 
                                              FW3A-NUM-ALERT                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K022!'                           
                    DISPLAY 'K022-NUMREGN :' K022-NUM-REGN                      
                    DISPLAY 'FILE STATUS : ' BP13K022-STATUS                    
                    MOVE BP13K022-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       3770-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      *--------------*                                                          
       3800-READ-BP13K670.                                                      
      *--------------*                                                          
           INITIALIZE BP13K670-REC                                              
           MOVE F800-NUM-REGN              TO K670-NUM-REGN                     
                                                                                
           READ BP13K670.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K670-OK                                                 
                    CONTINUE                                                    
                                                                                
               WHEN BP13K670-NFND                                               
                    MOVE SPACES   TO BP13K670-REC                               
                    INITIALIZE       BP13K670-REC                               
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K670!'                           
                    DISPLAY 'K410-NUM-REGN :' K670-NUM-REGN                     
                    DISPLAY 'FILE STATUS : ' BP13K670-STATUS                    
                    MOVE BP13K670-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
                                                                                
           END-EVALUATE.                                                        
                                                                                
      *---------*                                                               
       3800-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      * DECODING CODES FROM BP13K820 BY READING FILE, BP13K060         *        
      ******************************************************************        
      *---------------*                                                         
       4000-READ-K060.                                                          
      *---------------*                                                         
           READ BP13K060.                                                       
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K060-OK                                                 
                    ADD 1                  TO WS-K060-READ-CNT                  
               WHEN BP13K060-NFND                                               
                    MOVE SPACES            TO K060-DESC                         
                                              K060-CODE                         
                    DISPLAY 'DESCRIPTION NOT FOUND FOR CODE :'                  
                             K060-KEY-FLD                                       
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING FILE, BP13K060!!'                    
                    DISPLAY 'ERROR CODE :' BP13K060-STATUS                      
                    MOVE BP13K060-STATUS   TO RETURN-CODE                       
                    PERFORM  9900-ABNORMAL-END                                  
                       THRU  9900-EXIT                                          
           END-EVALUATE                                                         
           .                                                                    
      *----------*                                                              
       4000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *** WRITES RECORD ONTO THE OUTPUT FILE, BP13FW03               ***        
      ******************************************************************        
      *---------------*                                                         
       5000-START-K895.                                                         
      *---------------*                                                         
           MOVE SPACES TO BP13K895-REC.                                         
           INITIALIZE     BP13K895-REC.                                         
                                                                                
           MOVE 'N'                        TO WS-K895-FOUND.                    
                                                                                
           MOVE SPACES                     TO K895-KEY-FLD.                     
           MOVE F800-NUM-REGN              TO K895-NUM-REGN-HIST                
                                                                                
           START BP13K895 KEY >= K895-KEY-FLD                                   
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K895-OK                                                 
                    CONTINUE                                                    
               WHEN BP13K895-02                                                 
                    CONTINUE                                                    
               WHEN BP13K895-NFND                                               
                    DISPLAY 'KEY NOT FOUND IN BP13K895!'                        
                    DISPLAY 'KEY : ' K895-KEY-FLD                               
                    SET BP13K895-EOF       TO TRUE                              
               WHEN OTHER                                                       
                    DISPLAY 'ERROR LOCATING KEY IN BP13K895!'                   
                    DISPLAY 'KEY : ' K895-KEY-FLD                               
                    DISPLAY 'FILE STATUS :' BP13K895-STATUS                     
                    MOVE BP13K895-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
           END-EVALUATE                                                         
           .                                                                    
      *----------*                                                              
       5000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       5100-READ-K895.                                                          
      *---------------*                                                         
                                                                                
           READ BP13K895 NEXT                                                   
           AT END                                                               
              SET BP13K895-EOF             TO TRUE                              
           END-READ                                                             
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K895-OK                                                 
                 IF  K895-NUM-REGN-HIST = F800-NUM-REGN                         
                    ADD  1                 TO WS-K895-READ-CNT                  
                    MOVE 'Y'               TO WS-K895-FOUND                     
                    PERFORM 5200-PROCESS-CODES                                  
                       THRU 5200-EXIT                                           
                    PERFORM 5400-MOVE-K895-FW03                                 
                       THRU 5400-EXIT                                           
                 ELSE                                                           
                    SET BP13K895-EOF       TO TRUE                              
                 END-IF                                                         
                                                                                
               WHEN BP13K895-EOF                                                
                    DISPLAY 'END OF FILE REACHED FOR K895!'                     
                    DISPLAY 'NUMBER OF VALID RECORDS READ:'                     
                             WS-K895-READ-CNT                                   
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K895!'                           
                    DISPLAY 'K895-NUM-REGN :' K895-NUM-REGN                     
                    DISPLAY 'FILE STATUS : ' BP13K895-STATUS                    
                    MOVE BP13K895-STATUS   TO RETURN-CODE                       
                                                                                
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
           END-EVALUATE                                                         
           .                                                                    
      *---------*                                                               
       5100-EXIT.                                                               
      *---------*                                                               
           EXIT.                                                                
      *------------------*                                                      
       5200-PROCESS-CODES.                                                      
      *------------------*                                                      
            MOVE SPACES TO WS-ETHNIC                                            
                           WS-SEX                                               
                           WS-MARITAL-STATUS                                    
                                                                                
            MOVE K895-NUM-ETHNIC           TO WS-ETHNIC                         
            IF K895-NUM-ETHNIC IS NUMERIC                                       
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '42'                   TO K060-SERIAL-NO                    
               MOVE K895-NUM-ETHNIC        TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               MOVE K060-DESC              TO WS-ETHNIC                         
            ELSE                                                                
               MOVE K895-NUM-ETHNIC        TO WS-ETHNIC                         
            END-IF                                                              
                                                                                
            IF WS-ETHNIC NOT = 'C' AND 'I' AND 'M' AND 'O'                      
               MOVE SPACES              TO WS-ETHNIC                            
            END-IF                                                              
                                                                                
            IF K895-NUM-SEX IS NUMERIC                                          
               IF K895-NUM-SEX = ZERO                                           
                  MOVE SPACES                TO WS-SEX                          
               ELSE                                                             
                 MOVE SPACES                 TO BP13K060-REC                    
                 MOVE '43'                   TO K060-SERIAL-NO                  
                 MOVE K895-NUM-SEX           TO K060-CODE                       
                 PERFORM 4000-READ-K060                                         
                    THRU 4000-EXIT                                              
                 MOVE K060-DESC              TO WS-SEX                          
               END-IF                                                           
            END-IF                                                              
                                                                                
            IF K895-NUM-MARITAL-STATUS NOT = SPACES AND LOW-VALUES              
               MOVE SPACES                 TO BP13K060-REC                      
               MOVE '44'                   TO K060-SERIAL-NO                    
               MOVE K895-NUM-MARITAL-STATUS                                     
                                           TO K060-CODE                         
               PERFORM 4000-READ-K060                                           
                  THRU 4000-EXIT                                                
               MOVE K060-DESC              TO WS-MARITAL-STATUS                 
            END-IF                                                              
                                                                                
            .                                                                   
      *---------*                                                               
       5200-EXIT.                                                               
      *---------*                                                               
            EXIT.                                                               
      *-------------------*                                                     
       5400-MOVE-K895-FW03.                                                     
      *-------------------*                                                     
            MOVE SPACES      TO BP13FW3B-REC.                                   
            INITIALIZE          BP13FW3B-REC.                                   
                                                                                
             IF K895-NUM-CSTMR-SOURCE = SPACES OR LOW-VALUES                    
                GO TO 5400-EXIT.                                                
                                                                                
             MOVE 'Y'                  TO WS-VALID-CUST-ID.                     
                                                                                
             MOVE K895-NUM-CSTMR-SOURCE  TO FW3B-NUM-CUSTOMER-ID.               
             MOVE K895-NUM-CITIZENSHIP   TO FW3B-NUM-CITIZENSHIP.               
             MOVE K895-DTE-BIRTH         TO FW3B-DTE-BIRTH.                     
             IF K895-AMT-INCOME NOT NUMERIC                                     
                MOVE ZEROES              TO K895-AMT-INCOME                     
             END-IF.                                                            
             MOVE K895-AMT-INCOME  TO    FW3B-AMT-INCOME.                       
             MOVE K895-NUM-EDUCATION TO  FW3B-NUM-EDU-LVL.                      
             MOVE WS-ETHNIC      TO      FW3B-NUM-RACE.                         
             MOVE WS-SEX         TO      FW3B-NUM-SEX.                          
             MOVE WS-MARITAL-STATUS      TO                                     
                     FW3B-NUM-MARITAL-STATUS.                                   
             MOVE K895-NUM-RELATIONSHIP  TO                                     
                  FW3B-NUM-RELATIONSHIP.                                        
             MOVE K895-DTE-BIRTH       TO FW3B-DTE-BIRTH.                       
             MOVE K895-AMT-INCOME      TO FW3B-AMT-INCOME.                      
                                                                                
                                                                                
             IF K895-NUM-NRIC = F800-NUM-NRIC1                                  
                MOVE WS-ICP-CPF1    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF1     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL1    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H1'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
             IF K895-NUM-NRIC = F800-NUM-NRIC2                                  
                MOVE WS-ICP-CPF2    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF2     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL2    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H2'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
             IF K895-NUM-NRIC = F800-NUM-NRIC3                                  
                MOVE WS-ICP-CPF3    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF3     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL3    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H3'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
                                                                                
             IF K895-NUM-NRIC = F800-NUM-NRIC4                                  
                MOVE WS-ICP-CPF4    TO FW3B-AMT-ICP-CPF                         
                MOVE WS-CD-CPF4     TO FW3B-AMT-CD-CPF                          
                MOVE WS-INSTALL4    TO FW3B-AMT-MNTLY-INSTAL-CPF                
                MOVE 'H4'           TO FW3B-NUM-APPL-OCCP                       
             ELSE                                                               
                ADD 1 TO WS-NUM-OCCP                                            
                MOVE 'O'            TO FW3B-NUM-APPL-OCCP(1:1)                  
                MOVE WS-NUM-OCCP    TO FW3B-NUM-APPL-OCCP(2:1)                  
             END-IF                                                             
             END-IF                                                             
             END-IF                                                             
             END-IF.                                                            
                                                                                
             IF F800-NUM-REGN(1:1) NOT = '5'                                    
               MOVE SPACES                 TO K734-KEY-FLD                      
               MOVE BP13K895-REC(1:17)     TO K734-KEY-FLD                      
               PERFORM 3600-READ-K734      THRU 3600-EXIT                       
               MOVE K734-NUM-EMPLY-STATUS  TO FW3B-NUM-EMP-STAT                 
             ELSE                                                               
               MOVE SPACES            TO   KB78-KEY-FLD                         
               MOVE K895-NUM-REGN     TO   KB78-NUM-REGN                        
               PERFORM 3700-READ-KB78      THRU 3700-EXIT                       
               DISPLAY ' REGN - ' KB78-NUM-REGN                                 
                       'EMP - ' KB78-NUM-APPLT1-EMPLY-STATUS                    
               IF K895-NUM-NRIC = KB78-NUM-APPLT1-UIN                           
                 MOVE KB78-NUM-APPLT1-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-APPLT2-UIN                           
                 MOVE KB78-NUM-APPLT2-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-APPLT3-UIN                           
                 MOVE KB78-NUM-APPLT3-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-APPLT4-UIN                           
                 MOVE KB78-NUM-APPLT4-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP1-UIN                           
                 MOVE KB78-NUM-OCCUP1-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP2-UIN                           
                 MOVE KB78-NUM-OCCUP2-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP3-UIN                           
                 MOVE KB78-NUM-OCCUP3-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP4-UIN                           
                 MOVE KB78-NUM-OCCUP4-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP5-UIN                           
                 MOVE KB78-NUM-OCCUP5-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP6-UIN                           
                 MOVE KB78-NUM-OCCUP6-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP7-UIN                           
                 MOVE KB78-NUM-OCCUP7-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
               IF K895-NUM-NRIC = KB78-NUM-OCCUP8-UIN                           
                 MOVE KB78-NUM-OCCUP8-EMPLY-STATUS TO FW3B-NUM-EMP-STAT         
               END-IF                                                           
             END-IF.                                                            
                                                                                
      *      MOVE SPACES                 TO KD05-KEY-FLD                        
      *      MOVE BP13K895-REC(1:17)      TO KD05-KEY-FLD                       
      *      PERFORM 3900-READ-KD05    THRU 3900-EXIT                           
      *      MOVE WS-FW03-AHG-GRANT-CHAR-O   TO FW3B-AMT-GRANT-AHG.             
      *      MOVE WS-FW03-SHG-GRANT-CHAR-O   TO FW3B-AMT-GRANT-SHG.             
      *      MOVE WS-FW03-HSGNT-CHAR-O       TO FW3B-AMT-GRANT.                 
                                                                                
      *      MOVE K895-NUM-EXIST-NT      TO FW3B-NUM-EXIST-NT                   
      *      MOVE K895-NUM-EXIST-FT      TO FW3B-NUM-EXIST-FT                   
                                                                                
             MOVE WS-FW3B-NUM-REGN       TO FW3B-NUM-REGN.                      
             MOVE WS-FW3B-HDB-REFNO      TO FW3B-HDB-REFNO.                     
             MOVE WS-FW3B-NUM-NEW-TOWN   TO FW3B-NUM-NEW-TOWN.                  
             MOVE WS-FW3B-NUM-FLAT-TYPE  TO FW3B-NUM-FLAT-TYPE.                 
                                                                                
             IF K895-AMT-INCOME-TP NOT NUMERIC                                  
                MOVE ZEROES   TO K895-AMT-INCOME-TP                             
             END-IF.                                                            
                                                                                
             MOVE K895-AMT-INCOME-TP     TO FW3B-AMT-INCOME-TP                  
             COMPUTE WS-FW3A-AMT-TP-INCOME = K895-AMT-INCOME-TP +               
                                             WS-FW3A-AMT-TP-INCOME.             
                                                                                
             MOVE K895-NUM-PHONE            TO FW3B-NUM-HP-PGR                  
             MOVE K895-NUM-HP-PGR           TO FW3B-NUM-PHONE                   
                                                                                
             MOVE K734-NUM-DIVORCE-GE3YRS   TO FW3B-NUM-DIVORCE-GE3YRS          
             MOVE K734-DTE-DIVORCE          TO FW3B-DTE-DIVORCE                 
                                                                                
             PERFORM 6610-WRITE-BP13FW3G    THRU 6610-EXIT.                     
             PERFORM 6600-WRITE-BP13FW3B    THRU 6600-EXIT.                     
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *** WRITES RECORD ONTO THE OUTPUT FILE, BP13FW03               ***        
      ******************************************************************        
                                                                                
      *--------------------*                                                    
       6050-CHECK-APPL-STAT.                                                    
      *--------------------*                                                    
                                                                                
           IF F800-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES AND ZERO             
              MOVE 'BK'                      TO WS-APPL-STATUS                  
           ELSE                                                                 
             IF F800-NUM-STATUS = 'C'                                           
                MOVE 'CA'                    TO WS-APPL-STATUS                  
             ELSE                                                               
                MOVE 'AP'                    TO WS-APPL-STATUS                  
             END-IF                                                             
           END-IF.                                                              
                                                                                
       6050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------*                                                      
       6080-READ-BP13KD00.                                                      
      *------------------*                                                      
           MOVE SPACES                         TO BP13KD00-REC.                 
           INITIALIZE                             BP13KD00-REC.                 
           MOVE F800-NUM-REGN                  TO KD00-NUM-REGN.                
           READ BP13KD00.                                                       
                                                                                
           EVALUATE BP13KD00-STATUS                                             
               WHEN 00                                                          
                    ADD 1 TO WS-KD00-READ-CNT                                   
                    EVALUATE KD00-NUM-HSGNT-ELIG                                
                       WHEN 'F'                                                 
                          MOVE 30000    TO WS-FW03-HSGNT                        
                       WHEN 'S'                                                 
                          MOVE 11000    TO WS-FW03-HSGNT                        
                       WHEN 'L'                                                 
                          MOVE 15000    TO WS-FW03-HSGNT                        
                       WHEN 'K'                                                 
                          MOVE 20000    TO WS-FW03-HSGNT                        
                       WHEN 'M'                                                 
                       WHEN 'T'                                                 
                          MOVE 40000    TO WS-FW03-HSGNT                        
                       WHEN OTHER                                               
                          MOVE ZEROES   TO WS-FW03-HSGNT                        
                    END-EVALUATE                                                
               WHEN 23                                                          
                    ADD 1  TO WS-KD00-NOTFD-CNT                                 
                    MOVE ZEROES   TO WS-FW03-HSGNT                              
               WHEN OTHER                                                       
                    DISPLAY 'BP13KD00 - READ ERROR FOR: ' KD00-KEY-FLD          
                    DISPLAY 'FILE STATUS IS: ' BP13KD00-STATUS                  
                    MOVE BP13KD00-STATUS       TO RETURN-CODE                   
                    PERFORM 9900-ABNORMAL-END  THRU 9900-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       6080-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------*                                                      
       6085-READ-BP13K640.                                                      
      *------------------*                                                      
           MOVE SPACES                         TO BP13K640-TRANS-REC.           
           INITIALIZE                             BP13K640-TRANS-REC.           
           MOVE F800-NUM-REGN                  TO K640-REGN-NO.                 
           READ BP13K640.                                                       
                                                                                
           EVALUATE BP13K640-STATUS                                             
               WHEN 00                                                          
                    ADD 1 TO WS-K640-READ-CNT                                   
               WHEN 23                                                          
                    ADD 1  TO WS-K640-NOTFD-CNT                                 
               WHEN OTHER                                                       
                    DISPLAY 'BP13K640 - READ ERROR FOR: ' K640-KEY-FLD          
                    DISPLAY 'FILE STATUS IS: ' BP13K640-STATUS                  
                    MOVE BP13K640-STATUS       TO RETURN-CODE                   
                    PERFORM 9900-ABNORMAL-END  THRU 9900-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       6085-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------*                                                      
       6090-DECODE-AHG-SHG.                                                     
      *------------------*                                                      
                                                                                
           EVALUATE WS-DB2-NUM-AHG(2:2)                                         
              WHEN '02'                                                         
                 MOVE  02500  TO WS-FW03-AHG-GRANT                              
              WHEN '05'                                                         
                 MOVE  05000  TO WS-FW03-AHG-GRANT                              
              WHEN '07'                                                         
                 MOVE  07500  TO WS-FW03-AHG-GRANT                              
              WHEN '10'                                                         
                 MOVE  10000  TO WS-FW03-AHG-GRANT                              
              WHEN '15'                                                         
                 MOVE  15000  TO WS-FW03-AHG-GRANT                              
              WHEN '17'                                                         
                 MOVE  17500  TO WS-FW03-AHG-GRANT                              
              WHEN '20'                                                         
                 MOVE  20000  TO WS-FW03-AHG-GRANT                              
              WHEN '25'                                                         
                 MOVE  25000  TO WS-FW03-AHG-GRANT                              
              WHEN '30'                                                         
                 MOVE  30000  TO WS-FW03-AHG-GRANT                              
              WHEN '35'                                                         
                 MOVE  35000  TO WS-FW03-AHG-GRANT                              
              WHEN '40'                                                         
                 MOVE  40000  TO WS-FW03-AHG-GRANT                              
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-DB2-NUM-SHG(2:2)                                         
              WHEN '02'                                                         
                 MOVE  02500  TO WS-FW03-SHG-GRANT                              
              WHEN '05'                                                         
                 MOVE  05000  TO WS-FW03-SHG-GRANT                              
              WHEN '07'                                                         
                 MOVE  07500  TO WS-FW03-SHG-GRANT                              
              WHEN '10'                                                         
                 MOVE  10000  TO WS-FW03-SHG-GRANT                              
              WHEN '15'                                                         
                 MOVE  15000  TO WS-FW03-SHG-GRANT                              
              WHEN '17'                                                         
                 MOVE  17500  TO WS-FW03-SHG-GRANT                              
              WHEN '20'                                                         
                 MOVE  20000  TO WS-FW03-SHG-GRANT                              
              WHEN '25'                                                         
                 MOVE  25000  TO WS-FW03-SHG-GRANT                              
              WHEN '30'                                                         
                 MOVE  30000  TO WS-FW03-SHG-GRANT                              
              WHEN '35'                                                         
                 MOVE  35000  TO WS-FW03-SHG-GRANT                              
              WHEN '40'                                                         
                 MOVE  40000  TO WS-FW03-SHG-GRANT                              
           END-EVALUATE.                                                        
                                                                                
       6090-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------*                                                      
       6100-PREPARE-FW3A.                                                       
      *------------------*                                                      
                                                                                
           MOVE F800-DTE-BK-APPT           TO FW3A-DTE-BK-APPT.                 
           MOVE WS-APPL-STATUS             TO FW3A-APPL-STATUS.                 
                                                                                
           MOVE   WS-ICP-CASH  TO FW3A-AMT-ICP-CASH                             
                                                                                
           MOVE   WS-TOT-CD-CPF   TO FW3A-AMT-CD-CPF                            
                                                                                
           MOVE   WS-TOT-ICP  TO FW3A-AMT-ICP-CPF                               
                                                                                
           MOVE  WS-TOT-INSTALL TO FW3A-AMT-MNTLY-INSTAL-CPF                    
                                                                                
                                                                                
           MOVE WS-FW03-AHG-GRANT-CHAR     TO FW3A-AMT-GRANT-AHG.               
           MOVE WS-FW03-SHG-GRANT-CHAR     TO FW3A-AMT-GRANT-SHG.               
           MOVE WS-FW03-HSGNT-CHAR         TO FW3A-AMT-GRANT.                   
           MOVE WS-FW3A-AMT-TP-INCOME   TO FW3A-AMT-TP-INCOME.                  
                                                                                
           PERFORM 6210-WRITE-BP13FW3F   THRU 6210-EXIT.                        
                                                                                
           PERFORM 6220-WRITE-BP13FW3M   THRU 6220-EXIT.                        
                                                                                
           PERFORM 6630-WRITE-BM06F955   THRU 6630-EXIT.                        
                                                                                
           PERFORM 6200-WRITE-BP13FW3A   THRU 6200-EXIT.                        
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       6200-WRITE-BP13FW3A.                                                     
      *--------------------*                                                    
                                                                                
           WRITE BP13FW3A-REC.                                                  
           ADD 1                        TO WS-FW3A-WRITE-CNT.                   
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       6210-WRITE-BP13FW3F.                                                     
      *--------------------*                                                    
                                                                                
           MOVE FW3A-NUM-REGN           TO FW3F-NUM-REGN                        
           MOVE FW3A-DTE-REGN           TO FW3F-DTE-REGN                        
           MOVE FW3A-DTE-ACCEPTANCE     TO FW3F-DTE-ACCEPTANCE                  
           MOVE FW3A-DTE-SALE-AGMT      TO FW3F-DTE-AGREEMENT-SIGN              
           MOVE FW3A-DTE-KEYS-ISSUED    TO FW3F-DTE-KEYS-ISSUED                 
           MOVE FW3A-NUM-ALLO-CAT       TO FW3F-NUM-ALLO-CAT                    
           MOVE FW3A-NUM-LEASE-TENURE   TO FW3F-NUM-LEASE-TENURE                
           MOVE FW3A-NUM-FLAT-TYPE      TO FW3F-NUM-SEL-FLAT-TYPE               
           MOVE FW3A-NUM-SEL-BLK-MAIN   TO FW3F-NUM-SEL-BLK                     
           MOVE FW3A-NUM-SEL-LVL        TO FW3F-NUM-SEL-LVL                     
           MOVE FW3A-NUM-SEL-UNIT       TO FW3F-NUM-SEL-UNIT                    
           MOVE FW3A-NME-SEL-STREET     TO FW3F-NME-SEL-STREET                  
           MOVE FW3A-NUM-SEL-POSTAL     TO FW3F-NUM-SEL-POSTAL                  
           MOVE FW3A-HDB-REFNO          TO FW3F-HDB-REFNO                       
           MOVE FW3A-DTE-ECD            TO FW3F-DTE-ECD                         
           MOVE FW3A-NUM-PPO            TO FW3F-NUM-PPO                         
           MOVE FW3A-AMT-CA-INCOME      TO FW3F-AMT-CA-INCOME                   
           MOVE FW3A-NUM-REPAY-PERIOD   TO FW3F-NUM-REPAY-PERIOD                
           MOVE FW3A-NUM-LOAN-TAG       TO FW3F-NUM-LOAN-TAG                    
                                                                                
           MOVE FW3A-AMT-SELLING        TO FW3F-AMT-SELLING                     
                                                                                
           MOVE FW3A-AMT-BK-PAID        TO FW3F-AMT-BK-PAID                     
                                                                                
           MOVE FW3A-AMT-LOAN-HDB       TO FW3F-AMT-LOAN-HDB                    
                                                                                
           MOVE FW3A-AMT-LOAN-BANK      TO FW3F-AMT-LOAN-BANK                   
                                                                                
           MOVE FW3A-AMT-CD-CASH        TO FW3F-AMT-CD-CASH                     
                                                                                
           MOVE FW3A-AMT-ICP-CASH       TO FW3F-AMT-ICP-CASH                    
                                                                                
           MOVE FW3A-AMT-MNTLY-INSTAL-CASH                                      
                                        TO FW3F-AMT-MNTLY-INSTAL-CASH           
           MOVE FW3A-APPL-STATUS        TO FW3F-APPL-STATUS                     
           MOVE FW3A-DTE-CANCEL         TO FW3F-DTE-CANCEL                      
           MOVE FW3A-CANCEL-REASON      TO FW3F-CANCEL-REASON                   
           MOVE WS-SYS-DATE             TO FW3F-DTE-SNAPSHOT.                   
                                                                                
           IF WS-K820-FOUND = 'Y'                                               
              MOVE K820-NUM-PHONE       TO FW3F-NUM-PHONE                       
              MOVE K820-NUM-HP-PGR      TO FW3F-NUM-HP                          
           ELSE                                                                 
              MOVE K895-NUM-PHONE       TO FW3F-NUM-PHONE                       
              MOVE K895-NUM-HP-PGR      TO FW3F-NUM-HP                          
           END-IF                                                               
                                                                                
           PERFORM 6615-READ-BP13K857   THRU 6615-EXIT                          
                                                                                
           MOVE K857-NUM-EMAIL          TO FW3F-NUM-EMAIL                       
                                                                                
           WRITE BP13FW3F-REC.                                                  
           ADD 1                        TO WS-FW3F-WRITE-CNT.                   
                                                                                
       6210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       6220-WRITE-BP13FW3M.                                                     
      *--------------------*                                                    
                                                                                
           MOVE FW3A-NUM-REGN              TO FW3M-NUM-REGN                     
           MOVE FW3A-HDB-REFNO             TO FW3M-NUM-SCH-ACC                  
           MOVE FW3A-NUM-NEW-TOWN          TO FW3M-NUM-NEW-TOWN                 
           MOVE FW3A-NUM-FLAT-TYPE         TO FW3M-NUM-FLAT-TYPE                
           MOVE FW3A-APPL-STATUS           TO FW3M-NUM-APPL-STATUS              
           MOVE FW3A-NUM-CORR-POSTAL       TO FW3M-NUM-CORR-POSTAL              
           MOVE FW3A-DTE-BK-APPT           TO FW3M-DTE-BK-APPT                  
           MOVE FW3A-DTE-BALLOT            TO FW3M-DTE-BALLOT                   
           MOVE FW3A-AMT-HSEHOLD-INCOME    TO FW3M-AMT-HSEHOLD-INCOME           
           MOVE FW3A-NUM-LOAN-TAG          TO FW3M-NUM-LOAN-TAG                 
           MOVE FW3A-NUM-ETHNIC            TO FW3M-NUM-ETHNIC                   
           MOVE FW3A-NUM-HSEHOLD-TYPE      TO FW3M-NUM-HSEHOLD-TYPE             
           MOVE FW3A-NUM-ELIG-SCH          TO FW3M-NUM-ELIG-SCH                 
           MOVE FW3A-NUM-ALLOC-SCH         TO FW3M-NUM-ALLOC-SCH                
           MOVE FW3A-CITIZENSHIP-HSEHOLD   TO FW3M-NUM-CITIZEN-HSEHOLD          
           MOVE FW3A-DTE-AGREEMENT-SIGN    TO FW3M-DTE-AGREEMENT-SIGN           
           MOVE FW3A-AMT-LOAN-HDB          TO FW3M-AMT-LOAN-HDB                 
           MOVE FW3A-AMT-LOAN-BANK         TO FW3M-AMT-LOAN-BANK                
           MOVE FW3A-NUM-LOAN-RATE         TO FW3M-NUM-LOAN-RATE                
           MOVE FW3A-NUM-REPAY-PERIOD      TO FW3M-NUM-REPAY-PERIOD             
           MOVE FW3A-AMT-BK-PAID           TO FW3M-AMT-BK-PAID                  
           MOVE FW3A-AMT-CD-CASH           TO FW3M-AMT-CD-CASH                  
           MOVE FW3A-AMT-CD-CPF            TO FW3M-AMT-CD-CPF                   
           MOVE FW3A-AMT-ICP-CASH          TO FW3M-AMT-ICP-CASH                 
           MOVE FW3A-AMT-ICP-CPF           TO FW3M-AMT-ICP-CPF                  
           MOVE FW3A-AMT-GRANT-AHG         TO FW3M-AMT-GRANT-AHG                
           MOVE FW3A-AMT-MNTLY-INSTAL-CASH TO FW3M-AMT-MNTLY-INSTAL-CASH        
           MOVE FW3A-AMT-MNTLY-INSTAL-CPF  TO FW3M-AMT-MNTLY-INSTAL-CPF         
           MOVE FW3A-DTE-CANCEL            TO FW3M-DTE-CANCEL                   
           MOVE FW3A-CANCEL-REASON         TO FW3M-CANCEL-REASON                
           MOVE FW3A-AMT-GRANT-SHG         TO FW3M-AMT-GRANT-SHG                
           MOVE FW3A-AMT-PREMIUM           TO FW3M-AMT-PREMIUM                  
           MOVE FW3A-AMT-GRANT             TO FW3M-AMT-GRANT                    
           MOVE FW3A-NUM-ALLO-CAT          TO FW3M-NUM-ALLO-CAT                 
           MOVE FW3A-NUM-ALLOC-TAG         TO FW3M-NUM-ALLOC-TAG                
           MOVE FW3A-AMT-CA-INCOME         TO FW3M-AMT-CA-INCOME                
           MOVE FW3A-AMT-MAX-LOAN          TO FW3M-AMT-MAX-LOAN                 
           MOVE FW3A-DTE-REGN              TO FW3M-DTE-REGN                     
           MOVE FW3A-NUM-BALLOT-HSEHOLD    TO FW3M-NUM-BALLOT-HSEHOLD           
           MOVE FW3A-NUM-DNC-REASON        TO FW3M-NUM-DNC-REASON               
           MOVE FW3A-NUM-ELDERLY           TO FW3M-NUM-ELDERLY                  
           MOVE FW3A-NUM-PPO               TO FW3M-NUM-PPO                      
           MOVE FW3A-NUM-NTIMER            TO FW3M-NUM-NTIMER                   
           MOVE FW3A-NUM-ELDERLY-EXEMPTION TO FW3M-NUM-ELDERLY-EXEMPTION        
           MOVE F800-NUM-JT-BALLOT-REGN    TO FW3M-NUM-JT-BALLOT-REGN           
           MOVE F800-CDE-REQ-ALLOC-SCH     TO FW3M-CDE-REQ-ALLOC-SCH            
           MOVE F800-CDE-REQ-ELIG-SCH      TO FW3M-CDE-REQ-ELIG-SCH             
           MOVE FW3A-NUM-FT2T              TO FW3M-NUM-FT2T                     
           MOVE FW3A-NUM-GEN3              TO FW3M-NUM-GEN3                     
           MOVE FW3A-NUM-MGPS              TO FW3M-NUM-MGPS                     
           MOVE FW3A-NUM-PPS-ELIG          TO FW3M-NUM-PPS-ELIG                 
           MOVE F800-NUM-PPS-QUOTA         TO FW3M-NUM-PPS-QUOTA                
           MOVE FW3A-NUM-MCPS              TO FW3M-NUM-MCPS                     
           MOVE FW3A-CDE-MCPS-ELIG         TO FW3M-CDE-MCPS-ELIG                
           MOVE FW3A-NUM-MCPS-POSTAL       TO FW3M-NUM-MCPS-POSTAL              
           MOVE FW3A-NUM-AST-ELIG          TO FW3M-NUM-AST-ELIG                 
           MOVE FW3A-NUM-BALLOT-STATUS     TO FW3M-NUM-BALLOT-STATUS            
           MOVE F800-NUM-ZONE-FT-QUEUE     TO FW3M-NUM-ZONE-FT-QUEUE            
           MOVE FW3A-NUM-QUEUE-MGPS        TO FW3M-NUM-QUEUE-MGPS               
      ****CSTMR MOVED IN 6610 FW3G PARA                                         
           MOVE F800-TME-BK-APPT           TO FW3M-TME-BK-APPT                  
           MOVE F800-DTE-BK-APPT-MGPS      TO FW3M-DTE-BK-APPT-MGPS             
      *    MOVE                            TO FW3M-TME-BK-APPT-MGPS             
      *    MOVE                            TO FW3M-NUM-BOOK-STATUS              
           MOVE F800-NUM-SMS-STATUS        TO FW3M-NUM-SMS-STATUS               
           MOVE F800-NUM-SMS-FT            TO FW3M-NUM-SMS-FT                   
           MOVE F800-NUM-RSL-STATUS        TO FW3M-NUM-RSL-STATUS               
           MOVE F800-NUM-RSL-FT            TO FW3M-NUM-RSL-FT                   
           MOVE F800-NUM-RDB-STATUS        TO FW3M-NUM-RDB-STATUS               
           MOVE F800-NUM-RDB-FT            TO FW3M-NUM-RDB-FT                   
           MOVE FW3A-NUM-APPS              TO FW3M-NUM-APPS                     
           MOVE FW3A-NUM-APPS-ELIG-TAG     TO FW3M-NUM-APPS-ELIG-TAG            
           MOVE F800-NUM-PROV-TAG          TO FW3M-NUM-PROV-TAG                 
           MOVE F800-NUM-PROV-REASON       TO FW3M-NUM-PROV-REASON              
           MOVE F800-CDE-UT-SIGNED         TO FW3M-NUM-UT-SIGNED                
           MOVE F800-NUM-DEFER-INCOME-ASSESS TO                                 
                                            FW3M-NUM-DEFER-INCOME-ASSESS        
           MOVE FW3A-NUM-KEY-LOCN          TO FW3M-NUM-KEY-LOCN                 
      *    MOVE                            TO FW3M-DTE-KEY-BORROW               
           MOVE F800-DTE-AO-APPT           TO FW3M-DTE-SALE-AGMT                
           MOVE F800-DTE-2ND-CA-SENT       TO FW3M-DTE-2ND-CA-SENT              
           MOVE FW3A-DTE-TP-APPT           TO FW3M-DTE-TP-APPT                  
           MOVE F800-TME-SO-APPT           TO FW3M-TME-TP-APPT                  
           MOVE F800-TME-AO-APPT           TO FW3M-TME-SA-APPT                  
           MOVE F800-DTE-SUB-TRANSFER-APPT TO FW3M-DTE-SUB-TRANSFER-APPT        
           MOVE K840-DTE-REINSTATE         TO FW3M-DTE-REINSTATE                
           MOVE F800-NUM-PORT-ELIG-TAG     TO FW3M-NUM-PORT-ELIG-TAG            
           MOVE F800-NUM-IDP-SCHEME        TO FW3M-NUM-IDP-SCHEME               
           MOVE F800-NUM-HALF-IDP          TO FW3M-NUM-HALF-IDP                 
           MOVE F800-NUM-HOLDING-TYPE      TO FW3M-NUM-HOLDING-TYPE             
           MOVE F800-NUM-BUY-SELL-TAG      TO FW3M-NUM-BUY-SELL-TAG             
           MOVE K410-NUM-CONTRA-TYPE       TO FW3M-NUM-CONTRA-TYPE              
           MOVE F800-CDE-APPT-TYPE         TO FW3M-NUM-APPT-TYPE                
           MOVE F800-CDE-APPT              TO FW3M-NUM-APPT                     
           MOVE F800-DTE-1ST-TP-LETTER     TO FW3M-DTE-1ST-TP-LETTER            
           MOVE F800-NUM-RESALE-LEVY-TAG   TO FW3M-NUM-RESALE-LEVY-TAG          
           IF F800-AMT-DEFER-LEVY NOT NUMERIC                                   
              MOVE ZEROES                  TO F800-AMT-DEFER-LEVY               
           END-IF                                                               
           MOVE F800-AMT-DEFER-LEVY        TO FW3M-AMT-DEFER-LEVY               
           IF F800-AMT-LEVY-INCORPORATE NOT NUMERIC                             
              MOVE ZEROES                  TO F800-AMT-LEVY-INCORPORATE         
           END-IF                                                               
           MOVE F800-AMT-LEVY-INCORPORATE  TO FW3M-AMT-LEVY-INCORPORATE         
           IF K410-AMT-LEASE-ESCROW-FEE NOT NUMERIC                             
              MOVE ZEROES                  TO K410-AMT-LEASE-ESCROW-FEE         
           END-IF                                                               
           MOVE K410-AMT-LEASE-ESCROW-FEE  TO FW3M-AMT-LEASE-ESCROW-FEE         
           IF K410-AMT-LEASE-REGN-FEE NOT NUMERIC                               
              MOVE ZEROES                  TO K410-AMT-LEASE-REGN-FEE           
           END-IF                                                               
           MOVE K410-AMT-LEASE-REGN-FEE    TO FW3M-AMT-LEASE-REGN-FEE           
           IF K410-AMT-LEASE-STAMP-CASH NOT NUMERIC                             
              MOVE ZEROES                  TO K410-AMT-LEASE-STAMP-CASH         
           END-IF                                                               
           MOVE K410-AMT-LEASE-STAMP-CASH  TO FW3M-AMT-LEASE-STAMP-CASH         
      *    MOVE K410-AMT-LEASE-STAMP-CPF1/ TO FW3M-AMT-LEASE-STAMP-CPF          
           IF F800-AMT-MORT-CONVY NOT NUMERIC                                   
               MOVE ZEROES                 TO F800-AMT-MORT-CONVY               
           END-IF                                                               
           MOVE F800-AMT-MORT-CONVY        TO FW3M-AMT-MORT-CONVY               
           IF K410-AMT-MORT-ESCROW-FEE NOT NUMERIC                              
              MOVE ZEROES                  TO K410-AMT-MORT-ESCROW-FEE          
           END-IF                                                               
           MOVE K410-AMT-MORT-ESCROW-FEE   TO FW3M-AMT-MORT-ESCROW-FEE          
           IF K410-AMT-MORT-REGN-FEE NOT NUMERIC                                
              MOVE ZEROES                  TO K410-AMT-MORT-REGN-FEE            
           END-IF                                                               
           MOVE K410-AMT-MORT-REGN-FEE     TO FW3M-AMT-MORT-REGN-FEE            
           IF K410-AMT-MORT-STAMP-FEE NOT NUMERIC                               
              MOVE ZEROES                  TO K410-AMT-MORT-STAMP-FEE           
           END-IF                                                               
           MOVE K410-AMT-MORT-STAMP-FEE    TO FW3M-AMT-MORT-STAMP-FEE           
           IF F800-AMT-CONVEY-FEE NOT NUMERIC                                   
              MOVE ZEROES                  TO F800-AMT-CONVEY-FEE               
           END-IF                                                               
           MOVE F800-AMT-CONVEY-FEE        TO FW3M-AMT-CONVEY-FEE               
           IF K410-AMT-SURVEY-FEE NOT NUMERIC                                   
              MOVE ZEROES                  TO K410-AMT-SURVEY-FEE               
           END-IF                                                               
           MOVE K410-AMT-SURVEY-FEE        TO FW3M-AMT-SURVEY-FEE               
           IF F800-AMT-CAVEAT-REGN NOT NUMERIC                                  
              MOVE ZEROES                  TO F800-AMT-CAVEAT-REGN              
           END-IF                                                               
           MOVE F800-AMT-CAVEAT-REGN       TO FW3M-AMT-CAVEAT-REGN              
                                                                                
           MOVE F800-NUM-ORIG-LOAN-TAG     TO FW3M-NUM-ORIG-LOAN-TAG            
           MOVE F800-NUM-HLA               TO FW3M-NUM-HLA                      
           MOVE F800-NUM-HLA-STATUS        TO FW3M-NUM-HLA-STATUS               
           MOVE F800-NUM-NHFL              TO FW3M-NUM-NHFL                     
           MOVE F800-AMT-CPF-WDL-ALLOW     TO FW3M-AMT-CPF-WDL-ALLOW            
           MOVE F800-NUM-WARRANT-ACT       TO FW3M-NUM-WARRANT-ACT              
           STRING WS-DB2-DTE-AHG-REQ(1:4) WS-DB2-DTE-AHG-REQ(6:2)               
                  WS-DB2-DTE-AHG-REQ(9:2)                                       
               DELIMITED BY SIZE INTO FW3M-DTE-AHG-EHG-REQ.                     
           IF FW3M-DTE-AHG-EHG-REQ NOT NUMERIC                                  
              MOVE SPACES                  TO FW3M-DTE-AHG-EHG-REQ.             
                                                                                
           STRING WS-DB2-DTE-SHG-REQ(1:4) WS-DB2-DTE-SHG-REQ(6:2)               
                  WS-DB2-DTE-SHG-REQ(9:2)                                       
               DELIMITED BY SIZE INTO FW3M-DTE-SHG-REQ.                         
           IF FW3M-DTE-SHG-REQ NOT NUMERIC                                      
              MOVE SPACES                  TO FW3M-DTE-SHG-REQ.                 
                                                                                
           STRING WS-DB2-DTE-AHG-APRV(1:4) WS-DB2-DTE-AHG-APRV(6:2)             
                  WS-DB2-DTE-AHG-APRV(9:2)                                      
               DELIMITED BY SIZE INTO FW3M-DTE-AHG-PROCESS.                     
           IF FW3M-DTE-AHG-PROCESS NOT NUMERIC                                  
              MOVE SPACES                  TO FW3M-DTE-AHG-PROCESS.             
                                                                                
           STRING WS-DB2-DTE-SHG-APRV(1:4) WS-DB2-DTE-SHG-APRV(6:2)             
                  WS-DB2-DTE-SHG-APRV(9:2)                                      
               DELIMITED BY SIZE INTO FW3M-DTE-SHG-PROCESS.                     
           IF FW3M-DTE-SHG-PROCESS NOT NUMERIC                                  
              MOVE SPACES                  TO FW3M-DTE-SHG-PROCESS.             
                                                                                
           MOVE WS-DB2-NUM-AHG             TO FW3M-NUM-AHG                      
           MOVE WS-DB2-NUM-SHG             TO FW3M-NUM-SHG                      
      *    MOVE K330-AMT-AHG-CPF           TO FW3M-AMT-AHG-CPF-USED             
           MOVE WS-DB2-NUM-AHG-REJECT      TO FW3M-NUM-AHG-REJECT               
           MOVE WS-DB2-NUM-SHG-REJECT      TO FW3M-NUM-SHG-REJECT               
           MOVE WS-DB2-NUM-NOAHG-RSN       TO FW3M-NUM-NOAHG-EHG-REASON         
           MOVE WS-DB2-NUM-NOSHG-RSN       TO FW3M-NUM-NOSHG-REASON             
           MOVE WS-DB2-NUM-AHG-WITHDRAW    TO FW3M-NUM-AHG-EHG-WITHDRAW         
           MOVE WS-DB2-NUM-SHG-WITHDRAW    TO FW3M-NUM-SHG-WITHDRAW             
           MOVE WS-DB2-NUM-AHG-STATUS      TO FW3M-NUM-AHG-STATUS               
           MOVE WS-DB2-NUM-SHG-STATUS      TO FW3M-NUM-SHG-STATUS               
           MOVE F800-NUM-CCA               TO FW3M-NUM-CCA                      
           MOVE FW3F-NUM-EMAIL             TO FW3M-NUM-EMAIL                    
           MOVE K830-NUM-BLK               TO FW3M-NUM-MAIL-BLK                 
           MOVE K830-NUM-HSELVL            TO FW3M-NUM-LVL-NUM                  
           MOVE K830-NUM-HSEMAIN           TO FW3M-NUM-MAIL-HSEMAIN(1:4)        
           MOVE K830-NUM-HSESUB            TO FW3M-NUM-MAIL-HSEMAIN(5:3)        
           MOVE F800-DTE-FILE-RECEIVED     TO FW3M-DTE-FILE-RECEIVED            
           MOVE K022-NUM-OIC               TO FW3M-NUM-OIC                      
           MOVE K022-NUM-OIC-APPL          TO FW3M-NUM-OIC-APPL                 
      *    MOVE KD00-NME-FIN               TO FW3M-NME-FIN                      
      *    MOVE                            TO FW3M-NUM-HFE                      
           MOVE F800-NUM-HLA-STATUS        TO FW3M-NUM-HFE-STATUS               
      *    MOVE                            TO FW3M-DTE-HFE-APPROVE              
                                                                                
           IF (F800-NUM-NEW-TOWN = SPACES OR LOW-VALUES) OR                     
              (F800-DTE-BALLOT   >= '201309' AND                                
               F800-NUM-ALLO-CAT = 'BTO')                                       
              PERFORM 6222-READ-BP13K813   THRU 6222-EXIT                       
           ELSE                                                                 
              MOVE F800-NUM-BTO-ZONE       TO FW3M-NUM-BTO-ZONE                 
           END-IF.                                                              
                                                                                
           WRITE BP13FW3M-REC.                                                  
           ADD 1                        TO WS-FW3M-WRITE-CNT.                   
                                                                                
       6220-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------*                                                      
       6221-READ-BP13K840.                                                      
      *------------------*                                                      
           MOVE SPACES                         TO BP13K840-REC.                 
           INITIALIZE                             BP13K840-REC.                 
           MOVE F800-NUM-REGN                  TO K840-NUM-REGN.                
           READ BP13K840.                                                       
                                                                                
           EVALUATE BP13K840-STATUS                                             
               WHEN 00                                                          
                    CONTINUE                                                    
               WHEN 23                                                          
                    MOVE SPACES               TO K840-DTE-REINSTATE             
               WHEN OTHER                                                       
                    DISPLAY 'BP13K640 - READ ERROR FOR: ' K640-KEY-FLD          
                    DISPLAY 'FILE STATUS IS: ' BP13K640-STATUS                  
                    MOVE BP13K640-STATUS       TO RETURN-CODE                   
                    PERFORM 9900-ABNORMAL-END  THRU 9900-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       6221-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------*                                                      
       6222-READ-BP13K813.                                                      
      *------------------*                                                      
           MOVE SPACES                         TO BP13K813-REC.                 
           INITIALIZE                             BP13K813-REC.                 
           MOVE F800-NUM-BTO-ZONE              TO K813-NUM-ZONE.                
           MOVE F800-NUM-FLAT-TYPE             TO K813-NUM-FLAT-TYPE            
           MOVE F800-DTE-BALLOT                TO K813-DTE-BALLOT.              
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE BP13K813-STATUS                                             
               WHEN 00                                                          
                    MOVE K813-CDE-NT          TO FW3M-NUM-BTO-ZONE              
               WHEN 23                                                          
                    MOVE F800-NUM-BTO-ZONE    TO FW3M-NUM-BTO-ZONE              
               WHEN OTHER                                                       
                    DISPLAY 'BP13K813 - READ ERROR FOR: ' K813-KEY-FLD          
                    DISPLAY 'FILE STATUS IS: ' BP13K813-STATUS                  
                    MOVE BP13K813-STATUS       TO RETURN-CODE                   
                    PERFORM 9900-ABNORMAL-END  THRU 9900-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       6222-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       6600-WRITE-BP13FW3B.                                                     
      *--------------------*                                                    
           WRITE BP13FW3B-REC.                                                  
           ADD 1                        TO WS-FW3B-WRITE-CNT.                   
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       6610-WRITE-BP13FW3G.                                                     
      *--------------------*                                                    
           IF WS-K820-FOUND = 'Y'                                               
              MOVE K820-NME-OCCP        TO FW3G-NME-OCCP                        
              MOVE K820-NUM-NRIC        TO FW3G-NUM-NRIC                        
           ELSE                                                                 
              MOVE K895-NME-OCCP        TO FW3G-NME-OCCP                        
              MOVE K895-NUM-NRIC        TO FW3G-NUM-NRIC                        
           END-IF                                                               
                                                                                
           ADD 1 TO WS-CSTMR-CTR                                                
           EVALUATE WS-CSTMR-CTR                                                
               WHEN 1                                                           
                    MOVE FW3B-NUM-CUSTOMER-ID TO FW3M-NUM-CSTMR-SOURCE1         
               WHEN 2                                                           
                    MOVE FW3B-NUM-CUSTOMER-ID TO FW3M-NUM-CSTMR-SOURCE2         
               WHEN 3                                                           
                    MOVE FW3B-NUM-CUSTOMER-ID TO FW3M-NUM-CSTMR-SOURCE3         
               WHEN 4                                                           
                    MOVE FW3B-NUM-CUSTOMER-ID TO FW3M-NUM-CSTMR-SOURCE4         
           END-EVALUATE                                                         
                                                                                
           MOVE FW3B-NUM-SEX            TO FW3G-NUM-SEX                         
           MOVE FW3B-NUM-MARITAL-STATUS TO FW3G-NUM-MARITAL-STATUS              
           MOVE FW3B-AMT-INCOME         TO FW3G-AMT-INCOME                      
           MOVE FW3B-NUM-CITIZENSHIP    TO FW3G-NUM-CITIZENSHIP                 
           MOVE FW3B-DTE-BIRTH          TO FW3G-DTE-BIRTH                       
           MOVE FW3B-NUM-EDU-LVL        TO FW3G-NUM-EDU-LVL                     
           MOVE FW3B-NUM-EMP-STAT       TO FW3G-NUM-EMP-STAT                    
           MOVE FW3B-NUM-RACE           TO FW3G-NUM-RACE                        
           MOVE FW3B-NUM-RELATIONSHIP   TO FW3G-NUM-RELATIONSHIP                
           MOVE FW3B-NUM-REGN           TO FW3G-NUM-REGN                        
                                                                                
           MOVE FW3B-AMT-CD-CPF         TO FW3G-AMT-CD-CPF                      
                                                                                
           MOVE FW3B-AMT-ICP-CPF        TO FW3G-AMT-ICP-CPF                     
                                                                                
           MOVE FW3B-AMT-MNTLY-INSTAL-CPF                                       
                                        TO FW3G-AMT-MNTLY-INSTAL-CPF            
                                                                                
           IF K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES                         
              MOVE K830-NUM-ADDR-TYPE        TO FW3G-NUM-ADDR-TYPE              
              IF K830-NUM-ADDR-TYPE = 'H'                                       
                 MOVE SPACES                 TO FW3G-NME-STREET                 
                 MOVE K830-NUM-BLK           TO FW3G-NUM-BLK                    
                 MOVE K830-NUM-LVL-CHAR      TO FW3G-NUM-LVL-CHAR               
                 MOVE K830-NUM-LVL-NUM       TO FW3G-NUM-LVL-NUM                
                 MOVE K830-NUM-LVL-DASH      TO FW3G-NUM-LVL-DASH               
                 MOVE K830-NUM-HSEMAIN       TO FW3G-NUM-HSEMAIN                
                 MOVE K830-NUM-HSESUB        TO FW3G-NUM-HSESUB                 
                 MOVE K830-NME-STREET-BLDG   TO FW3G-NME-STREET-BLDG            
                 MOVE K830-NUM-POSTAL        TO FW3G-NUM-POSTAL                 
              ELSE                                                              
                 MOVE SPACES                 TO FW3G-NME-STREET                 
                 MOVE K830-NUM-BLK           TO FW3G-NUM-BLK                    
                 MOVE K830-NUM-FLAT          TO FW3G-NUM-FLAT                   
                 MOVE K830-NME-STREET-BLDG   TO FW3G-NME-STREET-BLDG            
                 MOVE K830-NUM-POSTAL        TO FW3G-NUM-POSTAL                 
              END-IF                                                            
           ELSE                                                                 
              MOVE K830-NUM-MAIL-ADDR-TYPE   TO FW3G-NUM-ADDR-TYPE              
              IF K830-NUM-MAIL-ADDR-TYPE =  'H'                                 
                 MOVE SPACES                 TO FW3G-NME-STREET                 
                 MOVE K830-NUM-MAIL-BLK      TO FW3G-NUM-BLK                    
                 MOVE K830-NUM-MAIL-LVL-CHAR TO FW3G-NUM-LVL-CHAR               
                 MOVE K830-NUM-MAIL-LVL-NUM  TO FW3G-NUM-LVL-NUM                
                 MOVE K830-NUM-MAIL-LVL-DASH TO FW3G-NUM-LVL-DASH               
                 MOVE K830-NUM-MAIL-HSEMAIN  TO FW3G-NUM-HSEMAIN                
                 MOVE K830-NUM-MAIL-HSESUB   TO FW3G-NUM-HSESUB                 
                 MOVE K830-NME-MAIL-STR-BLDG TO FW3G-NME-STREET-BLDG            
                 MOVE K830-NUM-MAIL-POSTAL   TO FW3G-NUM-POSTAL                 
              ELSE                                                              
                 MOVE SPACES                 TO FW3G-NME-STREET                 
                 MOVE K830-NUM-MAIL-BLK      TO FW3G-NUM-BLK                    
                 MOVE K830-NUM-MAIL-FLAT     TO FW3G-NUM-FLAT                   
                 MOVE K830-NME-MAIL-STR-BLDG TO FW3G-NME-STREET-BLDG            
                 MOVE K830-NUM-MAIL-POSTAL   TO FW3G-NUM-POSTAL                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SYS-DATE             TO FW3G-DTE-SNAPSHOT.                   
           WRITE BP13FW3G-REC.                                                  
           ADD 1                        TO WS-FW3G-WRITE-CNT.                   
                                                                                
       6610-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       6630-WRITE-BM06F955.                                                     
      *--------------------*                                                    
           IF F800-NUM-STATUS = 'C'                                             
             PERFORM 6635-START-BP13K845 THRU 6635-EXIT                         
             IF WS-K845-FOUND = 'Y'                                             
               PERFORM 6640-START-BM06K950 THRU 6640-EXIT                       
               MOVE K950-SCH-ACC-NO         TO F955-NUM-SCH-ACC                 
               MOVE K950-REGN-NO            TO F955-NUM-REGN                    
               MOVE K950-FLAT-STATUS        TO F955-FLAT-STATUS                 
               MOVE K950-DTE-ACCEPTANCE     TO F955-DTE-ACCEPTANCE              
               MOVE K950-DTE-KEY-ISSUED     TO F955-DTE-KEYS-ISSUED             
               MOVE K950-NUM-LEASE-TENURE   TO F955-NUM-LEASE-TENURE            
               MOVE K950-CURR-SELLING-PRICE TO F955-AMT-SELLING                 
               MOVE K950-DTE-HANDOVER       TO F955-DTE-HANDOVER                
               MOVE K950-DTE-KEY-AVAIL      TO F955-DTE-KEY-AVAIL               
               MOVE K950-DTE-CV-SENT        TO F955-DTE-CV-SENT                 
               MOVE K950-DTE-CV-ENDORSEMENT TO F955-DTE-CV-ENDORSEMENT          
               MOVE K950-NUM-ALLOCN-QTR     TO F955-NUM-ALLOCN-QTR              
               MOVE K950-ALLOCN-STATUS      TO F955-ALLOCN-STATUS               
               MOVE K950-ALLOCN-TAG         TO F955-NUM-ALLOC-TAG               
               MOVE K950-DTE-ALLOCN         TO F955-DTE-ALLOCN                  
      *        MOVE K950-ALLOC-SCH          TO F955-NUM-ALLOC-SCH               
               MOVE K950-DTE-1ST-SALE       TO F955-DTE-1ST-SALE                
               MOVE K950-1ST-OFFER-SELLING-PRICE TO                             
                                            F955-1ST-OFFER-SELLING-PRICE        
               MOVE K950-DTE-REPRICE        TO F955-DTE-REPRICE                 
               MOVE K950-CURR-SELLING-PRICE TO F955-CURR-SELLING-PRICE          
               MOVE K950-PREV-SELLING-PRICE TO F955-PREV-SELLING-PRICE          
               MOVE K950-CDE-PROTECTED      TO F955-CDE-PROTECTED               
               MOVE K950-UPG-PREMIUM-TAG    TO F955-UPG-PREMIUM-TAG             
               MOVE K950-COST-PRICE         TO F955-COST-PRICE                  
               MOVE K950-LAND-COST          TO F955-LAND-COST                   
               MOVE K950-AMT-SC-SPR-PREMIUM TO F955-AMT-SC-SPR-PREMIUM          
               MOVE K950-AMT-SINGLES-PREMIUM TO F955-AMT-SINGLES-PREMIUM        
      *        MOVE K950-AMT-ELDERLY-PREMIUM TO F955-AMT-ELDERLY-PREMIUM        
               MOVE K950-CDE-POD-TAG        TO F955-CDE-POD-TAG                 
      *        MOVE K950-CDE-POE-TAG        TO F955-CDE-POE-TAG                 
               MOVE K950-CDE-POF-TAG        TO F955-CDE-POF-TAG                 
      *        MOVE K950-CDE-POG-TAG        TO F955-CDE-POG-TAG                 
               MOVE K950-NUM-POS            TO F955-NUM-POS                     
               MOVE K950-CDE-POW-TAG        TO F955-CDE-POW-TAG                 
               MOVE K950-AMT-POD            TO F955-AMT-POD                     
      *        MOVE K950-AMT-POE            TO F955-AMT-POE                     
               MOVE K950-AMT-POF            TO F955-AMT-POF                     
      *        MOVE K950-AMT-POG            TO F955-AMT-POG                     
               MOVE K950-AMT-POW            TO F955-AMT-POW                     
               MOVE K950-DTE-RESERVE-RELEASE TO F955-DTE-RESERVE-RELEASE        
               MOVE K950-NUM-RESERVE-RELEASE-BY TO                              
                                             F955-NUM-RESERVE-RELEASE-BY        
               MOVE K950-NUM-FEATURE        TO F955-NUM-FEATURE                 
               MOVE K950-DTE-TRANS-IN       TO F955-DTE-TRANS-IN                
               MOVE K950-DTE-VACANT         TO F955-DTE-VACANT                  
               MOVE K950-REPOSSESSED-CODE   TO F955-REPOSSESSED-CODE            
             ELSE                                                               
               GO TO 6630-EXIT                                                  
             END-IF                                                             
           ELSE                                                                 
              IF F800-NUM-SCH-ACC = SPACES OR LOW-VALUES                        
                 GO TO 6630-EXIT                                                
              END-IF                                                            
              MOVE K110-SCH-ACC-NO         TO F955-NUM-SCH-ACC                  
              MOVE K110-REGN-NO            TO F955-NUM-REGN                     
              MOVE K110-FLAT-STATUS        TO F955-FLAT-STATUS                  
              MOVE K110-DTE-ACCEPTANCE     TO F955-DTE-ACCEPTANCE               
              MOVE K110-DTE-KEY-ISSUED     TO F955-DTE-KEYS-ISSUED              
              MOVE K110-NUM-LEASE-TENURE   TO F955-NUM-LEASE-TENURE             
              MOVE K110-CURR-SELLING-PRICE TO F955-AMT-SELLING                  
              MOVE K110-DTE-HANDOVER       TO F955-DTE-HANDOVER                 
              MOVE K110-DTE-KEY-AVAIL      TO F955-DTE-KEY-AVAIL                
              MOVE K110-DTE-CV-SENT        TO F955-DTE-CV-SENT                  
              MOVE K110-DTE-CV-ENDORSEMENT TO F955-DTE-CV-ENDORSEMENT           
              MOVE K110-NUM-ALLOCN-QTR     TO F955-NUM-ALLOCN-QTR               
              MOVE K110-ALLOCN-STATUS      TO F955-ALLOCN-STATUS                
              MOVE K110-ALLOCN-TAG         TO F955-NUM-ALLOC-TAG                
              MOVE K110-DTE-ALLOCN         TO F955-DTE-ALLOCN                   
              MOVE K110-NUM-SELECTION      TO F955-NUM-SELECTION                
              MOVE K110-DTE-1ST-SALE       TO F955-DTE-1ST-SALE                 
              MOVE K110-1ST-OFFER-SELLING-PRICE TO                              
                                            F955-1ST-OFFER-SELLING-PRICE        
              MOVE K110-DTE-REPRICE        TO F955-DTE-REPRICE                  
              MOVE K110-CURR-SELLING-PRICE TO F955-CURR-SELLING-PRICE           
              MOVE K110-PREV-SELLING-PRICE TO F955-PREV-SELLING-PRICE           
              MOVE K110-CDE-PROTECTED      TO F955-CDE-PROTECTED                
              MOVE K110-UPG-PREMIUM-TAG    TO F955-UPG-PREMIUM-TAG              
              MOVE K110-COST-PRICE         TO F955-COST-PRICE                   
              MOVE K110-LAND-COST          TO F955-LAND-COST                    
              MOVE K110-AMT-SC-SPR-PREMIUM TO F955-AMT-SC-SPR-PREMIUM           
              MOVE K110-AMT-SINGLES-PREMIUM TO F955-AMT-SINGLES-PREMIUM         
              MOVE K110-AMT-ELDERLY-PREMIUM TO F955-AMT-ELDERLY-PREMIUM         
              MOVE K110-CDE-POD-TAG        TO F955-CDE-POD-TAG                  
              MOVE K110-CDE-POE-TAG        TO F955-CDE-POE-TAG                  
              MOVE K110-CDE-POF-TAG        TO F955-CDE-POF-TAG                  
              MOVE K110-CDE-POG-TAG        TO F955-CDE-POG-TAG                  
              MOVE K110-NUM-POS            TO F955-NUM-POS                      
              MOVE K110-CDE-POW-TAG        TO F955-CDE-POW-TAG                  
              MOVE K110-AMT-POD            TO F955-AMT-POD                      
              MOVE K110-AMT-POE            TO F955-AMT-POE                      
              MOVE K110-AMT-POF            TO F955-AMT-POF                      
              MOVE K110-AMT-POG            TO F955-AMT-POG                      
              MOVE K110-AMT-POW            TO F955-AMT-POW                      
              MOVE K110-DTE-RESERVE-RELEASE TO F955-DTE-RESERVE-RELEASE         
              MOVE K110-NUM-RESERVE-RELEASE-BY TO                               
                                             F955-NUM-RESERVE-RELEASE-BY        
              MOVE K110-NUM-FEATURE        TO F955-NUM-FEATURE                  
              MOVE K110-DTE-TRANS-IN       TO F955-DTE-TRANS-IN                 
              MOVE K110-DTE-VACANT         TO F955-DTE-VACANT                   
              MOVE K110-REPOSSESSED-CODE   TO F955-REPOSSESSED-CODE             
           END-IF                                                               
                                                                                
           MOVE FW3A-DTE-PCD(1:6)       TO F955-DTE-PCD                         
           MOVE FW3A-DTE-1ST-SOCA       TO F955-DTE-1ST-SOCA                    
           MOVE FW3A-DTE-1ST-KEY-ISSUE  TO F955-DTE-1ST-KEY-ISSUE               
                                                                                
           PERFORM 3561-READ-K100       THRU 3561-EXIT                          
                                                                                
           MOVE K100-DTE-POD-DUE        TO F955-DTE-POD-DUE                     
           MOVE K100-DTE-POE-DUE        TO F955-DTE-POE-DUE                     
           MOVE K100-DTE-POF-DUE        TO F955-DTE-POF-DUE                     
           MOVE K100-DTE-POG-DUE        TO F955-DTE-POG-DUE                     
           MOVE K100-DTE-POW-DUE        TO F955-DTE-POW-DUE                     
                                                                                
           WRITE BM06F955-REC.                                                  
           ADD 1                        TO WS-F955-WRITE-CNT.                   
                                                                                
       6630-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       6635-START-BP13K845.                                                     
      *---------------*                                                         
                                                                                
           MOVE SPACES                      TO K845-KEY-FLD.                    
           MOVE 'N'                         TO WS-K845-EOF WS-K845-FOUND        
                                                                                
           MOVE F800-NUM-REGN               TO K845-NUM-REGN-ACTION             
                                                                                
           START BP13K845 KEY >= K845-KEY-FLD.                                  
                                                                                
           EVALUATE BP13K845-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6636-READ-BP13K845 THRU 6636-EXIT                   
                      UNTIL WS-K845-EOF = 'Y'                                   
               WHEN 23                                                          
                    DISPLAY 'KEY NOT FOUND IN BP13K845!'                        
                    DISPLAY 'KEY : ' K845-KEY-FLD                               
               WHEN OTHER                                                       
                    DISPLAY 'ERROR LOCATING KEY IN BP13K845!'                   
                    DISPLAY 'KEY : ' K845-KEY-FLD                               
                    DISPLAY 'FILE STATUS :' BP13K845-STATUS                     
                    MOVE BP13K845-STATUS      TO RETURN-CODE                    
                    PERFORM 9900-ABNORMAL-END THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       6635-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       6636-READ-BP13K845.                                                      
      *---------------*                                                         
                                                                                
           READ BP13K845 NEXT                                                   
            AT END                                                              
              MOVE 'Y'                      TO WS-K845-EOF                      
              GO TO 6636-EXIT                                                   
           END-READ                                                             
                                                                                
           EVALUATE BP13K845-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                 IF K845-NUM-REGN-ACTION = F800-NUM-REGN                        
                    IF K845-NUM-ACTION = 'REJ'                                  
                       MOVE 'Y'             TO WS-K845-FOUND WS-K845-EOF        
                       ADD 1 TO WS-K845-READ-CNT                                
                    END-IF                                                      
                 ELSE                                                           
                    MOVE 'Y'                TO WS-K845-EOF                      
                 END-IF                                                         
               WHEN 23                                                          
                    MOVE 'Y'                TO WS-K845-EOF                      
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K845!'                           
                    DISPLAY 'K845 REGN :' K845-NUM-REGN-ACTION                  
                    DISPLAY 'FILE STATUS : ' BP13K845-STATUS                    
                    MOVE BP13K845-STATUS    TO RETURN-CODE                      
                    PERFORM 9900-ABNORMAL-END THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       6636-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       6640-START-BM06K950.                                                     
      *---------------*                                                         
           MOVE SPACES                      TO K950-KEY-FLD.                    
           MOVE 'N'                         TO WS-K950-EOF WS-K950-FOUND        
                                                                                
           MOVE K845-NUM-SCH-ACC            TO K950-NUM-SCH-ACC                 
                                                                                
           START BM06K950 KEY >= K950-KEY-FLD.                                  
                                                                                
           EVALUATE BM06K950-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6641-READ-BM06K950 THRU 6641-EXIT                   
                      UNTIL WS-K950-EOF = 'Y'                                   
               WHEN 23                                                          
                    DISPLAY 'KEY NOT FOUND IN BM06K950!'                        
                    DISPLAY 'KEY : ' K950-KEY-FLD                               
               WHEN OTHER                                                       
                    DISPLAY 'ERROR LOCATING KEY IN BM06K950!'                   
                    DISPLAY 'KEY : ' K950-KEY-FLD                               
                    DISPLAY 'FILE STATUS :' BM06K950-STATUS                     
                    MOVE BM06K950-STATUS      TO RETURN-CODE                    
                    PERFORM 9900-ABNORMAL-END THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       6640-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       6641-READ-BM06K950.                                                      
      *---------------*                                                         
                                                                                
           READ BM06K950 NEXT                                                   
            AT END                                                              
              MOVE 'Y'               TO WS-K950-EOF                             
           END-READ                                                             
                                                                                
           EVALUATE BM06K950-STATUS                                             
               WHEN 00                                                          
                    IF K950-NUM-SCH-ACC = K845-NUM-SCH-ACC                      
                       IF K950-NUM-TRANS  = 'RI'                                
                          MOVE 'Y'         TO WS-K950-FOUND WS-K950-EOF         
                          ADD 1 TO WS-K950-READ-CNT                             
                       END-IF                                                   
                    ELSE                                                        
                       MOVE 'Y'            TO WS-K950-EOF                       
                    END-IF                                                      
               WHEN 23                                                          
                    MOVE 'Y'               TO WS-K950-EOF                       
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BM06K950!'                           
                    DISPLAY 'K845 REGN :' K845-NUM-REGN-ACTION                  
                    DISPLAY 'FILE STATUS : ' BM06K950-STATUS                    
                    MOVE BM06K950-STATUS    TO RETURN-CODE                      
                    PERFORM 9900-ABNORMAL-END THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       6641-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       6615-READ-BP13K857.                                                      
      *---------------*                                                         
                                                                                
           MOVE SPACES                      TO BP13K857-REC.                    
           INITIALIZE  BP13K857-REC.                                            
                                                                                
           MOVE FW3F-NUM-REGN               TO K857-NUM-REGN.                   
                                                                                
           READ BP13K857.                                                       
                                                                                
           EVALUATE BP13K857-STATUS                                             
               WHEN 00                                                          
                    ADD 1          TO WS-K857-READ-CNT                          
               WHEN 23                                                          
                    MOVE SPACES    TO K857-NUM-EMAIL                            
                    ADD 1          TO WS-K857-NOTFD-CNT                         
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K857 : ' BP13K857-STATUS         
                            ' REGN = ' K857-NUM-REGN                            
                    MOVE BP13K857-STATUS TO RETURN-CODE                         
                    PERFORM 9900-ABNORMAL-END                                   
                       THRU 9900-EXIT                                           
           END-EVALUATE.                                                        
                                                                                
       6615-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
      *** CLOSE ALL FILES AND DISPLAY PROGRAM STATISTICS             ***        
      ******************************************************************        
      *-----------------*                                                       
       8000-CLOSE-FILES.                                                        
      *-----------------*                                                       
           CLOSE BP13F800                                                       
           IF BP13F800-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13F800!'                          
              DISPLAY 'FILE-STATUS :' BP13F800-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K820                                                       
           IF BP13K820-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K820!'                          
              DISPLAY 'FILE-STATUS :' BP13K820-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BM06K100                                                       
           IF BM06K100-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING FILE : BM06K100!'                          
              DISPLAY 'FILE-STATUS :' BM06K100-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K670                                                       
           IF BP13K670-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K670!'                          
              DISPLAY 'FILE-STATUS :' BP13K670-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K857                                                       
           IF BP13K857-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING FILE : BP13K857!'                          
              DISPLAY 'FILE-STATUS :' BP13K857-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K813                                                       
           IF BP13K813-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING FILE : BP13K813!'                          
              DISPLAY 'FILE-STATUS :' BP13K813-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K840                                                       
           IF BP13K840-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING FILE : BP13K840!'                          
              DISPLAY 'FILE-STATUS :' BP13K840-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K845                                                       
           IF BP13K845-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING FILE : BP13K845!'                          
              DISPLAY 'FILE-STATUS :' BP13K845-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BM06K950                                                       
           IF BM06K950-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING FILE : BM06K950!'                          
              DISPLAY 'FILE-STATUS :' BM06K950-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K895                                                       
           IF BP13K895-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K895!'                          
              DISPLAY 'FILE-STATUS :' BP13K895-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K830                                                       
           IF BP13K830-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K830!'                          
              DISPLAY 'FILE-STATUS :' BP13K830-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K060                                                       
           IF BP13K060-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K060!'                          
              DISPLAY 'FILE-STATUS :' BP13K060-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K410                                                       
           IF BP13K410-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K410!'                          
              DISPLAY 'FILE-STATUS :' BP13K410-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K734                                                       
           IF BP13K734-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K734!'                          
              DISPLAY 'FILE-STATUS :' BP13K734-STATUS                           
           END-IF                                                               
                                                                                
                                                                                
           CLOSE BP13KD00                                                       
           IF BP13KD00-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13KD00!'                          
              DISPLAY 'FILE-STATUS :' BP13KD00-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13K640                                                       
           IF BP13K640-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K640!'                          
              DISPLAY 'FILE-STATUS :' BP13K640-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BP13KB78                                                       
           IF BP13KB78-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13KB78!'                          
              DISPLAY 'FILE-STATUS :' BP13KB78-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BM06K130                                                       
           IF BM06K130-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BM06K130!'                          
              DISPLAY 'FILE-STATUS :' BM06K130-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BB14K500                                                       
           IF BB14K500-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BB14K500!'                          
              DISPLAY 'FILE-STATUS :' BB14K500-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE BB14K580                                                       
           IF BB14K580-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BB14K580!'                          
              DISPLAY 'FILE-STATUS :' BB14K580-STATUS                           
           END-IF                                                               
                                                                                
                                                                                
           CLOSE BP13K022                                                       
           IF BP13K022-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K022!'                          
              DISPLAY 'FILE-STATUS :' BP13K022-STATUS                           
           END-IF                                                               
                                                                                
           CLOSE                                                                
                 BP13FW3A                                                       
                 BP13FW3B                                                       
                 BP13FW3F                                                       
                 BP13FW3G                                                       
                 BP13FW3M                                                       
                 BM06F955.                                                      
                                                                                
           PERFORM 9000-DISPLAY-STATISTICS                                      
              THRU 9000-EXIT                                                    
                                                                                
           STOP RUN                                                             
           .                                                                    
      *----------*                                                              
       8000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
      ***  DISPLAYS PROGRAM STATISTICS                               ***        
      ******************************************************************        
      *-----------------------*                                                 
       9000-DISPLAY-STATISTICS.                                                 
      *-----------------------*                                                 
           DISPLAY '*================================================*'         
           DISPLAY '*== PROGRAM STATISTICS - BP13C92A    ============*'         
           DISPLAY '*================================================*'         
           DISPLAY '*NUMBER OF F800 RECS READ    :' WS-F800-READ-CNT            
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K820 RECS READ    :' WS-K820-READ-CNT            
           DISPLAY '*NUMBER OF K820 REGN FOUND   :' WS-K820-REGN-CTR            
           DISPLAY '*NUMBER OF K820 REGN NOTFD   :' WS-K820-NOTFD-CTR           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K895 RECS READ    :' WS-K895-READ-CNT            
           DISPLAY '*NUMBER OF K895 REGN FOUND   :' WS-K895-REGN-CTR            
           DISPLAY '*NUMBER OF K895 REGN NOTFD   :' WS-K895-NOTFD-CTR           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF BOOKED CASES      :' WS-BOOKED-CASES             
           DISPLAY '*NUMBER OF NOT BOOK CASES    :' WS-NTBOOK-CASES             
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K410 RECS READ    :' WS-K410-READ-CNT            
           DISPLAY '*NUMBER OF K410 NOTFD        :' WS-K410-NOTFD-CNT           
           DISPLAY '*NUMBER OF K33O RECS READ    :' WS-K330-READ-CNT            
           DISPLAY '*NUMBER OF K330 NOTFD        :' WS-K330-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K830 RECS READ    :' WS-K830-READ-CNT            
           DISPLAY '*NUMBER OF K830 NOTFD        :' WS-K830-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF DBSS CASE         :' WS-DBSS                     
           DISPLAY '*NUMBER OF NON-DBSS          :' WS-NON-DBSS                 
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF KB78 RECS READ    :' WS-KB78-READ-CNT            
           DISPLAY '*NUMBER OF KB78 NOTFD        :' WS-KB78-NOTFD-CNT           
           DISPLAY '*NUMBER OF K734 RECS READ    :' WS-K734-READ-CNT            
           DISPLAY '*NUMBER OF K734 NOTFD        :' WS-K734-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K060 RECS READ    :' WS-K060-READ-CNT            
           DISPLAY '*NUMBER OF PIDB SCH  NOTFND  :' WS-SCH-NOTFND-CNT           
           DISPLAY '*NUMBER OF BM06K110  READ    :' WS-K110-READ-CNT            
           DISPLAY '*NUMBER OF BM0K110 NOTFD     :' WS-K110-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF KD00 RECS READ    :' WS-KD00-READ-CNT            
           DISPLAY '*NUMBER OF KD00 NOTFD        :' WS-KD00-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K640 RECS READ    :' WS-K640-READ-CNT            
           DISPLAY '*NUMBER OF K640 NOTFD        :' WS-K640-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K130 RECS READ    :' WS-K130-READ-CNT            
           DISPLAY '*NUMBER OF K130 NOTFD        :' WS-K130-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K500 RECS READ    :' WS-K500-READ-CNT            
           DISPLAY '*NUMBER OF K500 NOTFD        :' WS-K500-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K580 RECS READ    :' WS-K580-READ-CNT            
           DISPLAY '*NUMBER OF K580 NOTFD        :' WS-K580-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K022 RECS READ    :' WS-K022-READ-CNT            
           DISPLAY '*NUMBER OF K022 NOTFD        :' WS-K022-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K857 RECS READ    :' WS-K857-READ-CNT            
           DISPLAY '*NUMBER OF K857 NOTFD        :' WS-K857-NOTFD-CNT           
           DISPLAY '                             :'.                            
           DISPLAY '*NUMBER OF K845 RECS READ    :' WS-K845-READ-CNT            
           DISPLAY '*NUMBER OF K950 RECS READ    :' WS-K950-READ-CNT            
           DISPLAY '*NUMBER OF BLANK CUST ID CASE:' WS-CUST-BLANK-CNT           
           DISPLAY '*NUMBER OF FW3A RECS WRITTEN :' WS-FW3A-WRITE-CNT           
           DISPLAY '*NUMBER OF FW3B RECS WRITTEN :' WS-FW3B-WRITE-CNT           
           DISPLAY '*NUMBER OF FW3F RECS WRITTEN :' WS-FW3F-WRITE-CNT           
           DISPLAY '*NUMBER OF FW3G RECS WRITTEN :' WS-FW3G-WRITE-CNT           
           DISPLAY '*NUMBER OF FW3M RECS WRITTEN :' WS-FW3M-WRITE-CNT           
           DISPLAY '*NUMBER OF F955 RECS WRITTEN :' WS-F955-WRITE-CNT           
           DISPLAY '*================================================*'         
           .                                                                    
      *----------*                                                              
       9000-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      ******************************************************************        
      ***  ABNORMAL TERMINATION OF THE PROGRAM                       ***        
      ******************************************************************        
      *-----------------*                                                       
       9900-ABNORMAL-END.                                                       
      *-----------------*                                                       
           DISPLAY ' THE PROGRAM TERMINATES NOW!!!'                             
           PERFORM 9000-DISPLAY-STATISTICS                                      
              THRU 9000-EXIT                                                    
           STOP RUN                                                             
           .                                                                    
      *----------*                                                              
       9900-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *************************************************************             
       9999-ABORT-PROCESS.                                                      
      *************************************************************             
           GOBACK.                                                              
      *********  E N D   O F   P R O G R A M   B P 1 3 C 9 2 A *********        
