       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CCA1.                                                 
      *AUTHOR.        BO JIANG.                                                 
      *DATE-WRITTEN.  22/08/08.                                                 
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : LETTER TO BUYER BEFORE NVP SERVED, TOP OF   *            
      *              : DBSS FLAT                                   *            
      *              : LETTER 1 - COVERING LETTER ON SURVEY FEE AND*            
      *              :            STAMP FEE FOR TOP                *            
      *              : LETTER 2 - AUTHORISATION LETTER ON          *            
      *              :            WITHDRAWAL CPF MONEY FOR PAYMENT *            
      *                                                            *            
      *  INPUT FILES : 1.  BP13F800  -                             *            
      *                2.  BP13K820  -                             *            
      *                3.  BP13K830  -                             *            
      *                4.  BP13KD25  -                             *            
      *                5.  BP13KD00  -                             *            
      *                6.  BM06F120  -                             *            
      *                                                            *            
      *  LETTERS     : 1.  BP13PCA1  - (BP13IA,BLANK,BP13IB,BLANK) *            
      *  REPORT      : 1.  BP13LCA1  -                             *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  BY    DATE    DESCRIPTION                         *            
      * -------- ---- -------- -----------                         *            
      * BP133387 JB8  20080804 NEW PROGRAM.                        *            
      * BP134095 PCL3 20100416 TO CATER FOR SNP CASES              *            
      * BP134095 JB8  20101213 TO DISPLAY AMT INSTEAD OF RATE      *            
      * BP134218 JB8  20110506 TO CATER FOR REMOVAL OF NOMINAL DUTIES           
      * BP134253 ESA1 20110706 TO CORRECT MISALIGNMENT             *            
      * BP134226 ZDD1 20110722 TO CATER FOR CHANGES ON FORM        *            
      * BP134486 ESA1 20120315 TO CHANGE THE DATE TO 16 OF THE MONTH            
      * BP134861 IMC1 20130528 TO CHANGE LETTER FORMAT             *            
      * BP135312 ESA1 20140502 TO UPDATE CPF COMPUTATION           *            
      * BP135452 IMC1 20140904 TO CHANGE DATE FROM 16 TO 4TH       *            
      * BP135590 IMC1 20141209 TO REMOVE DATE FOR BP13IB FORM      *            
      * BP135703 SMR2 20150323 INITIALIZE CPF AMOUNT FOR NRIC1     *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F800  ASSIGN        TO BP13F800.                          
           SELECT BM06F120  ASSIGN        TO BM06F120.                          
           SELECT SY02F001  ASSIGN        TO SY02F001.                          
                                                                                
           SELECT BP13K820  ASSIGN        TO BP13K820                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K820-KEY-FLD                       
                            FILE STATUS   IS WS-K820-STATUS.                    
                                                                                
           SELECT BP13K830  ASSIGN        TO BP13K830                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K830-KEY-FLD                       
                            ALTERNATE KEY IS K830-NUM-REGN                      
                            FILE STATUS   IS WS-K830-STATUS.                    
                                                                                
           SELECT BP13KD25  ASSIGN        TO BP13KD25                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD25-KEY-FLD                       
                            FILE STATUS   IS WS-KD25-STATUS.                    
                                                                                
           SELECT BP13KD00  ASSIGN        TO BP13KD00                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD00-KEY-FLD                       
                            FILE STATUS   IS WS-KD00-STATUS.                    
                                                                                
           SELECT BP13K024  ASSIGN        TO BP13K024                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K024-KEY-FLD                       
                            FILE STATUS   IS WS-K024-STATUS.                    
                                                                                
           SELECT BP13K022  ASSIGN        TO BP13K022                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K022-KEY-FLD                       
                            ALTERNATE KEY IS K022-NUM-REGN                      
                            FILE STATUS   IS WS-K022-STATUS.                    
                                                                                
           SELECT BP13KD35  ASSIGN        TO BP13KD35                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD35-KEY-FLD                       
                            FILE STATUS   IS WS-KD35-STATUS.                    
                                                                                
           SELECT BP13KD15  ASSIGN        TO BP13KD15                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD15-KEY-FLD                       
                            FILE STATUS   IS WS-KD15-STATUS.                    
                                                                                
           SELECT BP13PCA1  ASSIGN        TO BP13PCA1.                          
           SELECT BP13PCA2  ASSIGN        TO BP13PCA2.                          
           SELECT BP13LCA1  ASSIGN        TO BP13LCA1.                          
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       COPY SY02F001.                                                           
                                                                                
       FD   BP13F800                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13F800.                                                           
                                                                                
       FD   BM06F120                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 700 CHARACTERS.                                     
       COPY BM06F120.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13KD25                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13KD25.                                                           
                                                                                
       FD   BP13KD00                                                            
            RECORD CONTAINS 1600 CHARACTERS.                                    
       COPY BP13KD00.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BP13KD35                                                            
            RECORD CONTAINS 3500 CHARACTERS.                                    
       COPY BP13KD35.                                                           
                                                                                
       FD   BP13KD15                                                            
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY BP13KD15.                                                           
                                                                                
       FD  BP13LCA1                                                             
           RECORDING MODE  IS  F.                                               
       01  LCA1-PRTREC                      PIC X(132).                         
                                                                                
       FD  BP13PCA1                                                             
           RECORDING MODE  IS  F.                                               
       01  BP13PCA1-PRTREC                  PIC X(90).                          
                                                                                
       FD  BP13PCA2                                                             
           RECORDING MODE  IS  F.                                               
       01  BP13PCA2-PRTREC                  PIC X(90).                          
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  WS-STATUS.                                                           
           05  WS-K820-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-KD25-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-KD00-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K022-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K024-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-KD35-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-KD15-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F800-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-F120-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-BYPASS-PRT-CTR            PIC 9(06)  VALUE ZEROS.             
           05  WS-KD15-UPDATE               PIC 9(06)  VALUE ZEROS.             
           05  WS-KD15-NOTFD                PIC 9(06)  VALUE ZEROS.             
           05  WS-F800-NOTFD                PIC 9(06)  VALUE ZEROS.             
           05  WS-F120-NOTFD                PIC 9(06)  VALUE ZEROS.             
           05  WS-F800-FD-PRINT             PIC 9(06)  VALUE ZEROS.             
           05  WS-F800-LOAN-H               PIC 9(06)  VALUE ZEROS.             
           05  WS-F800-LOAN-N               PIC 9(06)  VALUE ZEROS.             
           05  WS-F800-LOAN-B               PIC 9(06)  VALUE ZEROS.             
           05  WS-F800-LOAN-O               PIC 9(06)  VALUE ZEROS.             
           05  WS-PCA1-WRT-CTR              PIC 9(06)  VALUE ZEROS.             
           05  WS-PCA2-WRT-CTR              PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-LCA1             PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LCA1             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-CUR-LINE              PIC 9(02)  VALUE 56.                
           05  WS-CTR                       PIC 9(03)  VALUE ZEROS.             
           05  WS-CNT                       PIC 9(03)  VALUE ZEROS.             
           05  WS-CNT2                      PIC 9(03)  VALUE ZEROS.             
           05  WS-SKIP                      PIC 9(06)  VALUE ZEROS.             
           05  WS-RECORD-CNT                PIC ZZZ9.                           
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F800-EOF                  PIC X     VALUE 'N'.                
           05  WS-F800-FND                  PIC X     VALUE 'N'.                
           05  WS-F120-FND                  PIC X     VALUE 'N'.                
           05  WS-K820-NME-OCCP             PIC X(66) VALUE SPACES.             
           05  WS-K820-NME-HA1              PIC X(66) VALUE SPACES.             
           05  WS-F001-EOF                  PIC X(1)  VALUE 'N'.                
               88 EOF-F001                            VALUE 'Y'.                
           05  WS-F120-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-RETCODE                   PIC S9(8)                           
                                            SIGN IS LEADING SEPARATE.           
           05  WS-NUM-TRIM                  PIC ZZZ9.                           
           05  WS-NUM-FLOOR-AREA            PIC ZZZZ9.                          
           05  WS-NUM-FLOOR-AREA-VAR REDEFINES                                  
                                            WS-NUM-FLOOR-AREA PIC 9(5).         
           05  WS-FLOOR-AREA                PIC 9(4) VALUE ZEROS.               
           05  WS-BYPASS-PRINT              PIC X(1) VALUE 'N'.                 
                                                                                
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
                                                                                
       01  WS-FORM-VARIABLES.                                                   
           05  WS-NUM-REGN                  PIC X(08)    VALUE SPACES.          
           05  WS-NUM-DATE                  PIC X(10)    VALUE SPACES.          
           05  WS-NAME-HA1                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA1                  PIC X(09)    VALUE SPACES.          
           05  WS-CPF-HA1                   PIC X(09)    VALUE SPACES.          
           05  WS-NAME-HA2                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA2                  PIC X(09)    VALUE SPACES.          
           05  WS-CPF-HA2                   PIC X(09)    VALUE SPACES.          
           05  WS-NAME-HA3                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA3                  PIC X(09)    VALUE SPACES.          
           05  WS-CPF-HA3                   PIC X(09)    VALUE SPACES.          
           05  WS-NAME-HA4                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA4                  PIC X(09)    VALUE SPACES.          
           05  WS-CPF-HA4                   PIC X(09)    VALUE SPACES.          
           05  WS-K830-BLK                  PIC X(10)    VALUE SPACES.          
           05  WS-K830-FLAT                 PIC X(11)    VALUE SPACES.          
           05  WS-K830-ADDR-L2              PIC X(47)    VALUE SPACES.          
           05  WS-K830-ADDR-L3              PIC X(20)    VALUE SPACES.          
           05  WS-BAR-CODE                  PIC X(09)    VALUE SPACES.          
           05  WS-PIDB-STREET               PIC X(47)    VALUE SPACES.          
           05  WS-PIDB-ADDRESS              PIC X(70)    VALUE SPACES.          
           05  WS-PIDB-BLK                  PIC X(05)    VALUE SPACES.          
           05  WS-PIDB-LEVEL                PIC X(02)    VALUE SPACES.          
           05  WS-PIDB-UNIT                 PIC X(04)    VALUE SPACES.          
           05  WS-PIDB-SUB-UNIT             PIC X(03)    VALUE SPACES.          
           05  WS-LS-ESCROW-FEE             PIC 9(03)V99 VALUE ZEROES.          
           05  WS-MORT-ESCROW-FEE           PIC 9(03)V99 VALUE ZEROES.          
           05  WS-SURVEY-FEE                PIC 9(06)V99 VALUE ZEROES.          
           05  WS-COMP-LEASE                PIC 9(5)V99  VALUE ZEROS.           
           05  WS-COMP-MORTGAGE             PIC 9(5)V99  VALUE ZEROS.           
           05  WS-TOTAL-FEE                 PIC 9(04)V99 VALUE ZEROES.          
           05  WS-SUM-FEE                   PIC 9(05)V99 VALUE ZEROES.          
           05  WS-AMT-PREMIUM               PIC 9(03)V99 VALUE ZEROES.          
           05  WS-AMT-INSURED               PIC 9(06)V99 VALUE ZEROES.          
           05  WS-NUM-DID                   PIC X(08)    VALUE SPACES.          
           05  WS-NME-OIC                   PIC X(30)    VALUE SPACES.          
           05  WS-CDE-MODL-DESG             PIC X(02)    VALUE SPACES.          
           05  WS-CDE-TYP-ACTLUSE           PIC X(02)    VALUE SPACES.          
           05  WS-NUM-STRATA-AREA           PIC X(04)    VALUE SPACES.          
           05  WS-IDP-SCH                   PIC X(03)    VALUE SPACES.          
           05  WS-TOTAL-CD                  PIC 9(7)V99  VALUE ZEROS.           
           05  WS-UPD-CD-CASH               PIC 9(7)V99  VALUE ZEROS.           
           05  WS-NUM-LOAN-TAG              PIC X(01)    VALUE SPACES.          
           05  WS-NUM-CF-TYPE               PIC X(02)    VALUE SPACES.          
           05  WS-NUM-ELIG-SCH              PIC X(02)    VALUE SPACES.          
           05  WS-DTE-EFF-SUBTRAN           PIC X(08)    VALUE SPACES.          
           05  WS-NUM-WARRANT-ACT           PIC X(03)    VALUE SPACES.          
           05  WS-TOTAL-FEE-AMT             PIC 9(06)V99 VALUE ZEROES.          
           05  WS-TOTAL-PCT-RATE            PIC 9(03)    VALUE ZEROES.          
           05  WS-CASH-PCT-RATE             PIC 9(03)    VALUE ZEROES.          
           05  WS-PCT-RND                   PIC 9(01)V99 VALUE ZEROES.          
           05  WS-CPF1-FEE                  PIC 9(06)V99 VALUE ZEROES.          
           05  WS-CPF2-FEE                  PIC 9(06)V99 VALUE ZEROES.          
           05  WS-CPF3-FEE                  PIC 9(06)V99 VALUE ZEROES.          
           05  WS-CPF4-FEE                  PIC 9(06)V99 VALUE ZEROES.          
           05  WS-CPF-FEE                   PIC 9(06)V99 VALUE ZEROES.          
           05  WS-CASH-FEE                  PIC 9(06)V99 VALUE ZEROES.          
           05  WS-CPF1-DIFF                 PIC 9(06)    VALUE ZEROES.          
           05  WS-CPF2-DIFF                 PIC 9(06)    VALUE ZEROES.          
           05  WS-CPF3-DIFF                 PIC 9(06)    VALUE ZEROES.          
           05  WS-CPF4-DIFF                 PIC 9(06)    VALUE ZEROES.          
           05  WS-CASH-DIFF                 PIC 9(06)    VALUE ZEROES.          
           05  WS-CHECK-DECIMAL             PIC 9(01)V99 VALUE ZEROES.          
           05  WS-CPF1-FMT                  PIC ZZZ,ZZ9.99.                     
           05  WS-CPF2-FMT                  PIC ZZZ,ZZ9.99.                     
           05  WS-CPF3-FMT                  PIC ZZZ,ZZ9.99.                     
           05  WS-CPF4-FMT                  PIC ZZZ,ZZ9.99.                     
           05  WS-CASH-FMT                  PIC ZZZ,ZZ9.99.                     
           05  WS-CASH-PCT-FMT              PIC ZZ9      VALUE ZEROES.          
           05  WS-CPF1-PCT-FMT              PIC ZZ9      VALUE ZEROES.          
           05  WS-CPF2-PCT-FMT              PIC ZZ9      VALUE ZEROES.          
           05  WS-CPF3-PCT-FMT              PIC ZZ9      VALUE ZEROES.          
           05  WS-CPF4-PCT-FMT              PIC ZZ9      VALUE ZEROES.          
                                                                                
       01  DJDE-PORTRAIT                 PIC X(130) VALUE                       
           '$DJDE$ PMODE=PORTRAIT,FONT=(R7TICP,RK161P,R7TICP,RB12BP,R7TI        
      -    'CP,RM4SCP),END;'.                                                   
                                                                                
       01  DJDE-TP13IA                   PIC X(90) VALUE                        
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13IA,NUMBER=(0000,29,65,3        
      -    '),END;'.                                                            
                                                                                
       01  DJDE-TP13IB                   PIC X(90) VALUE                        
           '$DJDE$ NUMBER=NO,FONT=(R7TICP,R7TICP,RB12BP,RK2ABP,R7TICP,R7        
      -    'TICP),FORMS=BP13IB,END;'.                                           
                                                                                
       01  DJDE-TP13KH                   PIC X(90) VALUE                        
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13KH,NUMBER=(0000,29,65,3        
      -    '),END;'.                                                            
                                                                                
       01  DJDE-BLANKF                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BLANKF,SHIFT=(0,0),END;'.               
                                                                                
      *-----------------------------------------------------------*             
      * COMMAREA FOR CALLING AB20C900                                           
      *-----------------------------------------------------------*             
       COPY AB20M97C.                                                           
      *-----------------------------------------------------------*             
      * BP13C913 PARAMETERS                                                     
      *-----------------------------------------------------------*             
       01  WS-LINK-REC.                                                         
           05 WS-LINK-NUM-SCH-ACC.                                              
              10 WS-LINK-NUM-SCH       PIC X(4).                                
              10 WS-LINK-NUM-ACC       PIC X(5).                                
       COPY P13COMM8.                                                           
      *-----------------------------------------------------------*             
      *   LINKAGE SECTION FOR AV02C015                                          
      *-----------------------------------------------------------*             
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C900"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S900.                                                        
           05  WS-S900-SELL-PR             PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-DESIGN              PIC X(3)     VALUE SPACES.           
           05  WS-S900-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S900-CD-PREV-PAID        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-TOT-ICP             PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S900-PREM-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-SURVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-ESCROW-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-REGN-FEE         PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ESCROW-FEE     PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-MORT-REGN-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LOAN                PIC S9(7)V99 VALUE ZEROES.           
           05  WS-S900-ORIG-SELL           PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-SALE-TYPE           PIC X(2)     VALUE SPACES.           
           05  WS-S900-PREMIUM-CODE        PIC X(2)     VALUE SPACES.           
           05  WS-S900-SURVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-SALES-TYPE-SURVEY   PIC X(2)     VALUE SPACES.           
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER BP13IA                           *            
      *------------------------------------------------------------*            
       01  PCA1A-LINE01.                                                        
           05  FILLER                   PIC X(71) VALUE SPACES.                 
           05  PCA1A-NUM-REGN           PIC X(08) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE02.                                                        
           05  FILLER                   PIC X(71) VALUE SPACES.                 
           05  PCA1A-DATE               PIC X(10) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE03.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-NAME               PIC X(66) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE04.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-NAME2              PIC X(66) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE4A.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-NAME3              PIC X(66) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE4B.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-NAME4              PIC X(66) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE05.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-BLK                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  PCA1A-UNIT               PIC X(11) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE06.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-ADDR-L2            PIC X(47) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE07.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-ADDR-L3            PIC X(20) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE08.                                                        
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PCA1A-BAR-CODE           PIC X(09) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE09.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PCA1A-PIDB-ADDR          PIC X(79) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE10.                                                        
           05  FILLER                   PIC X(82) VALUE SPACES.                 
           05  PCA1A-LS-ESCROW-FEE      PIC ZZ9.99.                             
                                                                                
       01  PCA1A-LINE11.                                                        
           05  FILLER                   PIC X(82) VALUE SPACES.                 
           05  PCA1A-MORT-ESCROW-FEE    PIC ZZ9.99.                             
                                                                                
       01  PCA1A-LINE12.                                                        
           05  FILLER                   PIC X(78) VALUE SPACES.                 
           05  PCA1A-SURVEY-FEE         PIC ZZZ,ZZ9.99.                         
                                                                                
       01  PCA1A-LINE13.                                                        
           05  FILLER                   PIC X(78) VALUE SPACES.                 
           05  PCA1A-TOTAL-FEE          PIC ZZZ,ZZ9.99.                         
                                                                                
       01  PCA1A-LINE14.                                                        
           05  FILLER                   PIC X(74) VALUE SPACES.                 
           05  PCA1A-AMT-INSURED        PIC ZZZ,ZZ9.99.                         
                                                                                
       01  PCA1A-LINE15.                                                        
           05  FILLER                   PIC X(21) VALUE SPACES.                 
           05  PCA1A-AMT-PREMIUM        PIC ZZ9.99.                             
                                                                                
       01  PCA1A-LINE16.                                                        
           05  FILLER                   PIC X(71) VALUE SPACES.                 
           05  PCA1A-NUM-DID            PIC X(08) VALUE SPACES.                 
                                                                                
       01  PCA1A-LINE17.                                                        
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PCA1A-NME-OIC            PIC X(30) VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER BP13IB                           *            
      *------------------------------------------------------------*            
       01  PCA1B-LINE01.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  PCA1B-NUM-REGN           PIC X(08) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE02.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  PCA1B-DATE               PIC X(10) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE03.                                                        
           05  FILLER                   PIC X(13) VALUE SPACES.                 
           05  PCA1B-ADDRESS            PIC X(78) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE04.                                                        
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PCA1B-HA1                PIC X(80) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE05.                                                        
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PCA1B-HA2                PIC X(80) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE06.                                                        
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PCA1B-HA3                PIC X(80) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE07.                                                        
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PCA1B-HA4                PIC X(80) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE08.                                                        
           05  FILLER                   PIC X(26) VALUE SPACES.                 
           05  PCA1B-CPF1               PIC X(09) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  PCA1B-CPF2               PIC X(09) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  PCA1B-CPF3               PIC X(09) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  PCA1B-CPF4               PIC X(09) VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE SPACES.                 
           05  PCA1B-CASH               PIC X(05) VALUE SPACES.                 
                                                                                
       01  PCA1B-LINE09.                                                        
           05  FILLER                   PIC X(25) VALUE SPACES.                 
           05  PCA1B-CPF1-AMT           PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(03) VALUE SPACES.                 
           05  PCA1B-CPF2-AMT           PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  PCA1B-CPF3-AMT           PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  PCA1B-CPF4-AMT           PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  PCA1B-CASH-AMT           PIC X(10) VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  LCA1-HDG1.                                                           
           05  LCA1-LISTING             PIC X(14) VALUE 'BP13LCA1'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  LCA1-DATE                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  LCA1-PAGE                PIC ZZZZ9.                              
                                                                                
       01  LCA1-HDG2.                                                           
           05  FILLER                   PIC X(41) VALUE SPACES.                 
           05  FILLER                   PIC X(25) VALUE                         
               'CONTROL LIST FOR LETTERS '.                                     
           05  FILLER                   PIC X(26) VALUE                         
               'TO BUYER BEFORE NVP SERVED'.                                    
                                                                                
       01  LCA1-HDG3.                                                           
           05  FILLER                   PIC X(5)  VALUE ' S/NO'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'REG NO  '.             
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE 'BLK  '.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(10) VALUE 'DTE-TRF  '.            
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(08) VALUE 'HSE NO'.               
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE 'ELIG'.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE 'LTAG'.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(05) VALUE 'CFTYP'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(05) VALUE 'FLR-A'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(34)                               
                                          VALUE 'INST CASH/CPF1-2-3-4'.         
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(09) VALUE 'SRVY FEE'.             
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE 'LIE SF'.               
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE 'MIE SF'.               
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(10) VALUE 'TOTAL     '.           
                                                                                
       01  LCA1-HDG4.                                                           
           05  FILLER                   PIC X(5)  VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(10) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(08) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(05) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(05) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(34) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(09) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(10) VALUE ALL '-'.                
                                                                                
       01  LCA1-DTL.                                                            
           05  LCA1-SNO                 PIC ZZZZ9 VALUE ZEROES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-NUM-REGN            PIC X(08) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-NUM-BLK             PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-NUM-DTE-TRANS       PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-NUM-HSE-NO          PIC X(08) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-NUM-ELIG-SCH        PIC X(04) VALUE SPACES.                 
           05  FILLER                   PIC X(2).                               
           05  LCA1-NUM-LOAN-TAG        PIC X(01) VALUE SPACES.                 
           05  FILLER                   PIC X(3).                               
           05  LCA1-NUM-CF-TYPE         PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-NUM-FLOOR-AREA      PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-CASH-CPF-RATE       PIC X(34) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LCA1-SURVEY-FEE          PIC ZZ,ZZ9.99 VALUE ZEROES.             
           05  FILLER                   PIC X(1).                               
           05  LCA1-LS-ESCROW-FEE       PIC ZZ9.99 VALUE ZEROES.                
           05  FILLER                   PIC X(1).                               
           05  LCA1-MORT-ESCROW-FEE     PIC ZZ9.99 VALUE ZEROES.                
           05  FILLER                   PIC X(1).                               
           05  LCA1-TOTAL-FEE           PIC ZZZ,ZZ9.99 VALUE ZEROES.            
                                                                                
      *=============================================================            
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-FILES             THRU 1000-EXIT.                  
           PERFORM 3000-PROCESS-MATCH          THRU 3000-EXIT                   
             UNTIL WS-F800-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-ROUTINE          THRU 9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1000-OPEN-FILES.                                                         
      *=============================================================            
           OPEN INPUT BP13F800                                                  
                      SY02F001                                                  
                      BP13K820                                                  
                      BM06F120                                                  
                      BP13K830                                                  
                      BP13KD25                                                  
                      BP13KD00                                                  
                      BP13K022                                                  
                      BP13K024                                                  
                      BP13KD35                                                  
                  I-O BP13KD15                                                  
               OUTPUT BP13PCA1                                                  
                      BP13PCA2                                                  
                      BP13LCA1.                                                 
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K820 STATUS ' WS-K820-STATUS               
              MOVE     WS-K820-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K830 STATUS ' WS-K830-STATUS               
              MOVE     WS-K830-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-KD25-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR KD25 STATUS ' WS-KD25-STATUS               
              MOVE     WS-KD25-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-KD00-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR KD00 STATUS ' WS-KD00-STATUS               
              MOVE     WS-KD00-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K022 STATUS ' WS-K022-STATUS               
              MOVE     WS-K022-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K024-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K024 STATUS ' WS-K024-STATUS               
              MOVE     WS-K024-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-KD35-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR KD35 STATUS ' WS-KD35-STATUS               
              MOVE     WS-KD35-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-KD15-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR KD15 STATUS ' WS-KD15-STATUS               
              MOVE     WS-KD15-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           READ SY02F001 AT END MOVE 'Y'  TO WS-F001-EOF.                       
           IF EOF-F001                                                          
              DISPLAY 'RECORD NOT FOUND IN SY01F001 '                           
              DISPLAY 'PROCESSING TERMINATED '                                  
              GO TO 9000-CLOSE-ROUTINE                                          
           ELSE                                                                 
              MOVE F001-DTE-CURRENT      TO   WS-DATE WS-CURR-DATE              
           END-IF.                                                              
                                                                                
           STRING WS-DD   '/'                                                   
                  WS-MM   '/'                                                   
                  WS-CCYY   DELIMITED BY SIZE                                   
                  INTO WS-NUM-DATE.                                             
                                                                                
           PERFORM 2000-READ-BP13F800  THRU 2000-EXIT.                          
           PERFORM 2500-READ-BM06F120  THRU 2500-EXIT.                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       2000-READ-BP13F800.                                                      
      *=============================================================            
                                                                                
            READ BP13F800 AT END                                                
                 MOVE 'Y'         TO WS-F800-EOF                                
                 MOVE HIGH-VALUES TO F800-NUM-REGN                              
                 GO TO 2000-EXIT.                                               
                                                                                
            ADD  1  TO WS-F800-READ-CTR.                                        
                                                                                
            IF F800-NUM-LOAN-TAG = 'H'                                          
               ADD 1 TO WS-F800-LOAN-H                                          
            ELSE                                                                
               IF F800-NUM-LOAN-TAG = 'B'                                       
                  ADD 1 TO WS-F800-LOAN-B                                       
               ELSE                                                             
                  IF F800-NUM-LOAN-TAG = 'N'                                    
                     ADD 1 TO WS-F800-LOAN-N                                    
                  ELSE                                                          
                     ADD 1 TO WS-F800-LOAN-O                                    
                     DISPLAY 'LOAN-TAG=OTHER ' F800-NUM-REGN                    
                             ' LOAN-TAG ' F800-NUM-LOAN-TAG                     
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       2500-READ-BM06F120.                                                      
      *=============================================================            
                                                                                
            READ BM06F120 AT END                                                
                 MOVE HIGH-VALUES TO F120-REGN-NO                               
                 GO TO 2500-EXIT.                                               
                                                                                
            ADD  1  TO WS-F120-READ-CTR.                                        
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3000-PROCESS-MATCH.                                                      
      *=============================================================            
                                                                                
           IF F120-REGN-NO = F800-NUM-REGN                                      
              MOVE 'Y'                             TO WS-F120-FND               
              PERFORM 6550-READ-BP13KD00         THRU 6550-EXIT                 
                                                                                
              IF WS-BYPASS-PRINT = 'N'                                          
                 PERFORM 3500-PROCESS-RECORDS    THRU 3500-EXIT                 
              ELSE                                                              
                 ADD 1                             TO WS-BYPASS-PRT-CTR         
              END-IF                                                            
                                                                                
              PERFORM 2000-READ-BP13F800         THRU 2000-EXIT                 
              PERFORM 2500-READ-BM06F120         THRU 2500-EXIT                 
           ELSE                                                                 
              IF F120-REGN-NO < F800-NUM-REGN                                   
                 ADD 1 TO WS-F120-NOTFD                                         
                 PERFORM 2500-READ-BM06F120      THRU 2500-EXIT                 
              ELSE                                                              
                 ADD 1 TO WS-F800-NOTFD                                         
                 MOVE 'N'                          TO WS-F120-FND               
                 PERFORM 6550-READ-BP13KD00      THRU 6550-EXIT                 
                                                                                
                 IF WS-BYPASS-PRINT = 'N'                                       
                    ADD 1 TO WS-F800-FD-PRINT                                   
                    PERFORM 3500-PROCESS-RECORDS THRU 3500-EXIT                 
                 ELSE                                                           
                    ADD 1                          TO WS-BYPASS-PRT-CTR         
                 END-IF                                                         
                                                                                
                 PERFORM 2000-READ-BP13F800      THRU 2000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3500-PROCESS-RECORDS.                                                    
      *=============================================================            
                                                                                
           INITIALIZE     PCA1A-LINE01 PCA1A-LINE02 PCA1A-LINE03                
                          PCA1A-LINE04 PCA1A-LINE4A PCA1A-LINE4B                
                          PCA1A-LINE05 PCA1A-LINE06                             
                          PCA1A-LINE07 PCA1A-LINE08 PCA1A-LINE09                
                          PCA1A-LINE10 PCA1A-LINE11 PCA1A-LINE12                
                          PCA1A-LINE13 PCA1A-LINE14 PCA1A-LINE15                
                          PCA1A-LINE16.                                         
           INITIALIZE     PCA1B-LINE01 PCA1B-LINE02 PCA1B-LINE03                
                          PCA1B-LINE04 PCA1B-LINE05 PCA1B-LINE06                
                          PCA1B-LINE07 PCA1B-LINE08 PCA1B-LINE09.               
                                                                                
           MOVE F800-NUM-REGN            TO WS-NUM-REGN                         
           MOVE F800-NUM-LOAN-TAG        TO WS-NUM-LOAN-TAG                     
           MOVE F800-NUM-CF-TYPE         TO WS-NUM-CF-TYPE                      
           MOVE F800-NUM-ELIG-SCHEME     TO WS-NUM-ELIG-SCH                     
           MOVE F800-NUM-WARRANT-ACT     TO WS-NUM-WARRANT-ACT                  
      *GET NAME OF HA1                                                          
           MOVE F800-NUM-REGN            TO K820-NUM-REGN                       
           MOVE F800-NUM-NRIC1           TO K820-NUM-NRIC WS-NRIC-HA1.          
           PERFORM 4600-READ-K820      THRU 4600-EXIT                           
           MOVE WS-K820-NME-OCCP         TO WS-NAME-HA1                         
           MOVE K820-NUM-CPF             TO WS-CPF-HA1.                         
      *GET NAME OF HA2                                                          
           IF F800-NUM-NRIC2  = SPACES OR LOW-VALUES                            
              MOVE SPACES                TO WS-NAME-HA2   WS-NRIC-HA2           
           ELSE                                                                 
              MOVE F800-NUM-NRIC2        TO K820-NUM-NRIC WS-NRIC-HA2           
              PERFORM 4600-READ-K820   THRU 4600-EXIT                           
              MOVE WS-K820-NME-OCCP      TO WS-NAME-HA2                         
              MOVE K820-NUM-CPF          TO WS-CPF-HA2                          
           END-IF.                                                              
      *GET NAME OF HA3                                                          
           IF F800-NUM-NRIC3  = SPACES OR LOW-VALUES                            
              MOVE SPACES                TO WS-NAME-HA3   WS-NRIC-HA3           
           ELSE                                                                 
              MOVE F800-NUM-NRIC3        TO K820-NUM-NRIC WS-NRIC-HA3           
              PERFORM 4600-READ-K820   THRU 4600-EXIT                           
              MOVE WS-K820-NME-OCCP      TO WS-NAME-HA3                         
              MOVE K820-NUM-CPF          TO WS-CPF-HA3                          
           END-IF.                                                              
      *GET NAME OF HA4                                                          
           IF F800-NUM-NRIC4  = SPACES OR LOW-VALUES                            
              MOVE SPACES                TO WS-NAME-HA4   WS-NRIC-HA4           
           ELSE                                                                 
              MOVE F800-NUM-NRIC4        TO K820-NUM-NRIC WS-NRIC-HA4           
              PERFORM 4600-READ-K820   THRU 4600-EXIT                           
              MOVE WS-K820-NME-OCCP      TO WS-NAME-HA4                         
              MOVE K820-NUM-CPF          TO WS-CPF-HA4                          
           END-IF.                                                              
                                                                                
           PERFORM 4800-GET-ADDR          THRU 4800-EXIT.                       
           PERFORM 6000-READ-PIDB         THRU 6000-EXIT.                       
           PERFORM 6300-GET-SURVEY-FEE    THRU 6300-EXIT.                       
           PERFORM 6500-GET-STAMP-FEE     THRU 6500-EXIT.                       
           PERFORM 6600-GET-AMT-PREMIUM   THRU 6600-EXIT.                       
           PERFORM 6700-GET-CSM           THRU 6700-EXIT.                       
           PERFORM 6800-GET-INSTALL-RATE  THRU 6800-EXIT.                       
                                                                                
           PERFORM 7500-MOVE-VALUES   THRU 7500-EXIT.                           
           IF WS-CASH-PCT-RATE NOT = ZEROES                                     
             PERFORM 7000-PRT-LETTER        THRU 7000-EXIT                      
           ELSE                                                                 
             PERFORM 7100-PRT-LETTER-KH     THRU 7100-EXIT                      
           END-IF.                                                              
           PERFORM 8000-PRN-CNTRL-LIST    THRU 8000-EXIT.                       
           PERFORM 8100-UPDATE-BP13KD15   THRU 8100-EXIT.                       
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4600-READ-K820.                                                          
      *=============================================================            
           MOVE    SPACES                TO  WS-K820-NME-OCCP                   
           READ BP13K820.                                                       
                                                                                
           IF WS-K820-STATUS = 00 OR 02                                         
              MOVE    K820-NME-OCCP      TO  WS-K820-NME-OCCP                   
           ELSE                                                                 
           IF WS-K820-STATUS = 23                                               
              DISPLAY 'K820 REC NOT FOUND : '   K820-KEY-FLD                    
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K820 = '   WS-K820-STATUS              
                      ', K820-KEY-FLD = '   K820-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4800-GET-ADDR.                                                           
      *=============================================================            
                                                                                
           MOVE F800-NUM-REGN TO K830-NUM-REGN                                  
           READ BP13K830  KEY IS K830-NUM-REGN.                                 
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                
                 ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                           
                 (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))               
                 MOVE K830-NUM-BLK         TO WS-K830-BLK                       
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO WS-K830-FLAT                      
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO WS-K830-FLAT                      
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO WS-K830-ADDR-L2             
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE SPACES            TO WS-K830-ADDR-L3                   
                    DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL               
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO WS-K830-ADDR-L3                   
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4850-CALL-AV02C015     THRU 4850-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-BAR-CODE               
                                                                                
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK        TO WS-K830-BLK                   
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                TO WS-K830-FLAT                  
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT    TO WS-K830-FLAT                  
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO WS-K830-ADDR-L2           
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO WS-K830-ADDR-L3               
                    DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL              
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO WS-K830-ADDR-L3               
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4850-CALL-AV02C015     THRU 4850-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-BAR-CODE               
              END-IF                                                            
                                                                                
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              MOVE SPACES    TO WS-K830-BLK      WS-K830-FLAT                   
                                WS-K830-ADDR-L2  WS-K830-ADDR-L3                
                                WS-BAR-CODE                                     
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-NUM-REGN                       
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-NUM-REGN                       
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                        
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4850-CALL-AV02C015.                                                      
      *=============================================================            
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       4850-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6000-READ-PIDB.                                                          
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES                         TO WS-PIDB-ADDRESS               
                                                  WS-PIDB-BLK                   
                                                  WS-PIDB-LEVEL                 
                                                  WS-PIDB-UNIT                  
                                                  WS-PIDB-SUB-UNIT              
                                                  WS-CDE-MODL-DESG              
                                                  WS-CDE-TYP-ACTLUSE            
                                                  WS-NUM-STRATA-AREA.           
           IF WS-F120-FND NOT = 'Y'                                             
              GO TO 6000-EXIT                                                   
           END-IF.                                                              
                                                                                
           STRING 'BLK ' F120-BLK-NO                                            
                  ' # ' F120-LEVEL-NO  ' - ' F120-MAIN-UNIT                     
                  ' ' F120-STREET-NAME                                          
              DELIMITED BY SIZE INTO WS-PIDB-ADDRESS.                           
           MOVE F120-BLK-NO                   TO WS-PIDB-BLK.                   
           MOVE F120-LEVEL-NO                 TO WS-PIDB-LEVEL.                 
           MOVE F120-MAIN-UNIT                TO WS-PIDB-UNIT.                  
           MOVE F120-SUB-UNIT                 TO WS-PIDB-SUB-UNIT.              
           MOVE F120-STREET-NAME              TO WS-PIDB-STREET.                
           MOVE F120-CDE-MODL-DESG            TO WS-CDE-MODL-DESG.              
           MOVE F120-CDE-TYP-ACTUSE           TO WS-CDE-TYP-ACTLUSE.            
      * GET STRATA-AREA                                                         
      * RETRIEVE FIRST 4 BYTES OF THE WHOLE NO. ONLY                            
           MOVE F120-FLOOR-AREA               TO WS-NUM-FLOOR-AREA.             
           MOVE ZEROS                         TO WS-FLOOR-AREA.                 
           ADD  WS-NUM-FLOOR-AREA-VAR         TO WS-FLOOR-AREA.                 
           MOVE WS-FLOOR-AREA                 TO WS-NUM-TRIM.                   
      * OMIT LEADING SPACES                                                     
           MOVE ZEROS                         TO WS-CNT2.                       
           MOVE SPACES                        TO WS-NUM-STRATA-AREA.            
                                                                                
           PERFORM VARYING WS-CNT FROM 1 BY 1                                   
             UNTIL WS-CNT > 4                                                   
              IF WS-NUM-TRIM(WS-CNT:1) IS NOT = SPACES                          
                 ADD 1                        TO WS-CNT2                        
                 MOVE WS-NUM-TRIM(WS-CNT:1) TO                                  
                                          WS-NUM-STRATA-AREA(WS-CNT2:1)         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6300-GET-SURVEY-FEE.                                                     
      *=============================================================            
                                                                                
           MOVE SPACES                       TO BP13KD25-REC.                   
           INITIALIZE                           BP13KD25-REC.                   
                                                                                
           MOVE F800-NUM-DBSS-PRJCT          TO KD25-NUM-PRJCT.                 
           MOVE WS-NUM-STRATA-AREA           TO KD25-NUM-STRATA-AREA.           
                                                                                
           READ BP13KD25.                                                       
                                                                                
           IF WS-KD25-STATUS = 00 OR 02                                         
              MOVE KD25-AMT-SURVEY           TO WS-SURVEY-FEE                   
           ELSE                                                                 
           IF WS-KD25-STATUS = 23                                               
              MOVE ZEROES                    TO WS-SURVEY-FEE                   
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13KD25 : ' WS-KD25-STATUS                
              DISPLAY '                KEY IS : ' KD25-KEY-FLD                  
              MOVE WS-KD25-STATUS            TO RETURN-CODE                     
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6500-GET-STAMP-FEE.                                                      
      **************************************************************            
                                                                                
           IF F800-NUM-LOAN-TAG = 'N'                                           
              MOVE ZEROES             TO  WS-MORT-ESCROW-FEE                    
           ELSE                                                                 
              COMPUTE WS-MORT-ESCROW-FEE = 38.3                                 
           END-IF.                                                              
                                                                                
           COMPUTE WS-LS-ESCROW-FEE   = 38.3                                    
                                                                                
           COMPUTE WS-TOTAL-FEE =  WS-LS-ESCROW-FEE   +                         
                                   WS-MORT-ESCROW-FEE +                         
                                   WS-SURVEY-FEE.                               
                                                                                
           COMPUTE WS-TOTAL-FEE-AMT  = WS-TOTAL-FEE.                            
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6550-READ-BP13KD00.                                                      
      *=============================================================            
                                                                                
           MOVE SPACES                        TO BP13KD00-REC.                  
           INITIALIZE                            BP13KD00-REC.                  
                                                                                
           MOVE 'Y'                           TO WS-BYPASS-PRINT.               
           MOVE SPACES                        TO WS-DTE-EFF-SUBTRAN.            
           MOVE F800-NUM-REGN                 TO KD00-NUM-REGN.                 
                                                                                
           READ BP13KD00.                                                       
                                                                                
           IF WS-KD00-STATUS = 00 OR 02                                         
              IF KD00-DTE-SNP-SIGNED NOT = SPACES AND LOW-VALUES                
                                                  AND ZEROES                    
                 MOVE 'N'                      TO WS-BYPASS-PRINT               
                 MOVE KD00-DTE-EFF-TRANSFER    TO WS-DTE-EFF-SUBTRAN            
                                                                                
                 IF KD00-DTE-EFF-TRANSFER NOT = SPACES AND LOW-VALUES           
                                                       AND ZEROES               
                    DISPLAY 'RECORD W/ DTE-EFF-TRANSFER: ' KD00-NUM-REGN        
                 END-IF                                                         
              ELSE                                                              
                 DISPLAY 'RECORD W/OUT DTE-SNP : ' KD00-NUM-REGN                
              END-IF                                                            
           ELSE                                                                 
              IF WS-KD00-STATUS = 23                                            
                 DISPLAY 'RECORD NOT FOUND IN BP13KD00,REGN='                   
                                                 F800-NUM-REGN                  
                 INITIALIZE                      BP13KD00-REC                   
              ELSE                                                              
                 DISPLAY 'ERROR READING BP13KD00 ,RC= ' WS-KD00-STATUS          
                 MOVE WS-KD00-STATUS           TO RETURN-CODE                   
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6600-GET-AMT-PREMIUM.                                                    
      *=============================================================            
                                                                                
           MOVE WS-CDE-TYP-ACTLUSE      TO  BM97-NUM-FLAT-TYPE.                 
           MOVE WS-CDE-MODL-DESG        TO  BM97-CDE-MODL-DESG.                 
           MOVE WS-CURR-DATE            TO  BM97-DTE-COMPARE.                   
                                                                                
           INITIALIZE                       BM97-NUM-ERROR                      
                                            BM97-NUM-SYSERR.                    
                                                                                
           CALL 'AB20C900' USING WS-BM97-AREA.                                  
                                                                                
           IF (BM97-NUM-ERROR = ZEROS OR SPACES) AND                            
              BM97-NUM-SYSERR = ZEROS                                           
              MOVE BM97-AMT-INSURED     TO  WS-AMT-INSURED                      
              MOVE BM97-AMT-PREMIUM     TO  WS-AMT-PREMIUM                      
           ELSE                                                                 
              MOVE BM97-NUM-SYSERR      TO  RETURN-CODE                         
              MOVE ZEROES               TO  WS-AMT-INSURED                      
              MOVE ZEROES               TO  WS-AMT-PREMIUM                      
              DISPLAY 'ERROR IN CALLING AB20C900, ' BM97-NUM-ERROR              
           END-IF.                                                              
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6700-GET-CSM.                                                            
      *=============================================================            
                                                                                
           MOVE SPACES                         TO BP13K022-REC                  
                                                  BP13K024-REC                  
                                                  WS-NUM-DID                    
                                                  WS-NME-OIC.                   
           INITIALIZE                             BP13K022-REC                  
                                                  BP13K024-REC.                 
      * GET NUM-OIC                                                             
           MOVE F800-NUM-REGN                  TO K022-NUM-REGN.                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
           IF WS-K022-STATUS = 00 OR 02                                         
              CONTINUE                                                          
           ELSE                                                                 
              IF WS-K022-STATUS = 23                                            
                 GO TO 6700-EXIT                                                
              ELSE                                                              
                 DISPLAY 'ERROR READING BP13K022 ,RC= ' WS-K022-STATUS          
                 MOVE WS-K022-STATUS           TO RETURN-CODE                   
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
      * GET NUM-DID , NME-OIC                                                   
           MOVE K022-NUM-OIC                   TO K024-NUM-OIC                  
           READ BP13K024.                                                       
           IF WS-K024-STATUS = 00 OR 02                                         
              MOVE K024-NUM-DID                TO WS-NUM-DID                    
              MOVE K024-NME-OIC                TO WS-NME-OIC                    
           ELSE                                                                 
              IF WS-K024-STATUS = 23                                            
                 CONTINUE                                                       
              ELSE                                                              
                 DISPLAY 'ERROR READ BP13K024 ,RC= ' WS-K024-STATUS             
                 MOVE WS-K024-STATUS           TO RETURN-CODE                   
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6800-GET-INSTALL-RATE.                                                   
      *=============================================================            
                                                                                
           MOVE SPACES                        TO BP13KD35-REC.                  
           INITIALIZE                            BP13KD35-REC.                  
                                                                                
           MOVE F800-NUM-REGN                 TO KD35-NUM-REGN.                 
                                                                                
           READ BP13KD35.                                                       
                                                                                
           IF WS-KD35-STATUS = 00 OR 02                                         
              CONTINUE                                                          
           ELSE                                                                 
              IF WS-KD35-STATUS = 23                                            
                 DISPLAY 'RECORD NOT FOUND IN BP13KD35,REGN='                   
                                                 F800-NUM-REGN                  
                 INITIALIZE                      BP13KD35-REC                   
              ELSE                                                              
                 DISPLAY 'ERROR READING BP13KD35 ,RC= ' WS-KD35-STATUS          
                 MOVE WS-KD35-STATUS           TO RETURN-CODE                   
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7000-PRT-LETTER.                                                         
      *=============================================================            
            ADD   1               TO    WS-PCA1-WRT-CTR.                        
                                                                                
            MOVE WS-PCA1-WRT-CTR  TO WS-RECORD-CNT.                             
            MOVE WS-RECORD-CNT    TO DJDE-TP13IA(49:4).                         
            MOVE DJDE-TP13IA      TO BP13PCA1-PRTREC                            
            WRITE BP13PCA1-PRTREC AFTER PAGE.                                   
            MOVE SPACES           TO BP13PCA1-PRTREC.                           
            WRITE BP13PCA1-PRTREC AFTER PAGE.                                   
                                                                                
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE01 AFTER 2.                   
      *     WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE02.                           
      *     WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE16.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE03 AFTER 4.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE04.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE4A.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE4B.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE05.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE06.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE07.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE08 AFTER 2.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE09 AFTER 7.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE10 AFTER 7.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE11.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE12.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE13.                           
      *     WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE14 AFTER 8.                   
      *     WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE15.                           
      *     WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE16 AFTER 14.                  
            WRITE BP13PCA1-PRTREC FROM  PCA1A-LINE17 AFTER 24.                  
      * WRITE BLANK PAGE                                                        
            WRITE BP13PCA1-PRTREC FROM DJDE-BLANKF AFTER PAGE.                  
                                                                                
      * WRITE BP13IB                                                            
            MOVE SPACES           TO BP13PCA1-PRTREC.                           
            WRITE BP13PCA1-PRTREC FROM DJDE-TP13IB AFTER PAGE.                  
            MOVE SPACES           TO BP13PCA1-PRTREC.                           
            WRITE BP13PCA1-PRTREC AFTER PAGE.                                   
                                                                                
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE01 AFTER 2.                   
      *     WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE02.                           
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE03 AFTER 9.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE04 AFTER 5.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE05 AFTER 2.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE06 AFTER 2.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE07 AFTER 2.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE08 AFTER 9.                   
            WRITE BP13PCA1-PRTREC FROM  PCA1B-LINE09 AFTER 2.                   
                                                                                
      * WRITE BLANK PAGE                                                        
            WRITE BP13PCA1-PRTREC FROM DJDE-BLANKF AFTER PAGE.                  
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7100-PRT-LETTER-KH.                                                      
      *=============================================================            
                                                                                
            ADD   1               TO    WS-PCA2-WRT-CTR.                        
                                                                                
            MOVE SPACES           TO BP13PCA2-PRTREC.                           
            WRITE BP13PCA2-PRTREC FROM DJDE-TP13KH AFTER PAGE.                  
            MOVE SPACES           TO BP13PCA2-PRTREC.                           
            WRITE BP13PCA2-PRTREC AFTER PAGE.                                   
                                                                                
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE01 AFTER 2.                   
      *     WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE02.                           
      *     WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE16.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE03 AFTER 4.                   
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE04.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE4A.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE4B.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE05.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE06.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE07.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE08 AFTER 2.                   
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE09 AFTER 7.                   
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE10 AFTER 7.                   
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE11.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE12.                           
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE13.                           
      *     WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE14 AFTER 8.                   
      *     WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE15.                           
      *     WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE16 AFTER 14.                  
            WRITE BP13PCA2-PRTREC FROM  PCA1A-LINE17 AFTER 24.                  
      * WRITE BLANK PAGE                                                        
            WRITE BP13PCA2-PRTREC FROM DJDE-BLANKF AFTER PAGE.                  
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7500-MOVE-VALUES.                                                        
      *=============================================================            
                                                                                
           MOVE ZEROES                         TO WS-CPF1-FEE                   
                                                  WS-CPF2-FEE                   
                                                  WS-CPF3-FEE                   
                                                  WS-CPF4-FEE                   
                                                  WS-CASH-FEE                   
                                                  WS-CPF1-DIFF                  
                                                  WS-CPF2-DIFF                  
                                                  WS-CPF3-DIFF                  
                                                  WS-CPF4-DIFF                  
                                                  WS-CASH-DIFF                  
                                                  WS-CPF1-FMT                   
                                                  WS-CPF2-FMT                   
                                                  WS-CPF3-FMT                   
                                                  WS-CPF4-FMT                   
                                                  WS-CASH-FMT                   
                                                  WS-CASH-PCT-FMT               
                                                  WS-CPF1-PCT-FMT               
                                                  WS-CPF2-PCT-FMT               
                                                  WS-CPF3-PCT-FMT               
                                                  WS-CPF4-PCT-FMT               
                                                  WS-PCT-RND                    
                                                  WS-TOTAL-PCT-RATE             
                                                  WS-CASH-PCT-RATE.             
                                                                                
           IF KD35-NUM-INSTAL-RATE-CPF1 IS NOT NUMERIC                          
              MOVE ZEROES TO KD35-NUM-INSTAL-RATE-CPF1                          
           END-IF.                                                              
                                                                                
           IF KD35-NUM-INSTAL-RATE-CPF2 IS NOT NUMERIC                          
              MOVE ZEROES TO KD35-NUM-INSTAL-RATE-CPF2                          
           END-IF.                                                              
                                                                                
           IF KD35-NUM-INSTAL-RATE-CPF3 IS NOT NUMERIC                          
              MOVE ZEROES TO KD35-NUM-INSTAL-RATE-CPF3                          
           END-IF.                                                              
                                                                                
           IF KD35-NUM-INSTAL-RATE-CPF4 IS NOT NUMERIC                          
              MOVE ZEROES TO KD35-NUM-INSTAL-RATE-CPF4                          
           END-IF.                                                              
                                                                                
           IF F800-NUM-REGN = '5012812A'                                        
              MOVE ZEROES                 TO KD35-NUM-INSTAL-RATE-CPF1          
           END-IF.                                                              
                                                                                
           COMPUTE WS-TOTAL-PCT-RATE = KD35-NUM-INSTAL-RATE-CPF1 +              
                                       KD35-NUM-INSTAL-RATE-CPF2 +              
                                       KD35-NUM-INSTAL-RATE-CPF3 +              
                                       KD35-NUM-INSTAL-RATE-CPF4.               
           COMPUTE WS-CASH-PCT-RATE = 100 - WS-TOTAL-PCT-RATE.                  
                                                                                
           MOVE KD35-NUM-INSTAL-RATE-CPF1        TO WS-CPF1-PCT-FMT.            
           MOVE KD35-NUM-INSTAL-RATE-CPF2        TO WS-CPF2-PCT-FMT.            
           MOVE KD35-NUM-INSTAL-RATE-CPF3        TO WS-CPF3-PCT-FMT.            
           MOVE KD35-NUM-INSTAL-RATE-CPF4        TO WS-CPF4-PCT-FMT.            
           MOVE WS-CASH-PCT-RATE                 TO WS-CASH-PCT-FMT.            
                                                                                
           IF WS-TOTAL-PCT-RATE  < 100                                          
                                                                                
              IF WS-TOTAL-PCT-RATE = 0                                          
                 MOVE WS-TOTAL-FEE-AMT           TO WS-CASH-FMT                 
                                                    WS-CASH-FEE                 
              ELSE                                                              
                 COMPUTE WS-CASH-PCT-RATE = 100 - WS-TOTAL-PCT-RATE             
                 COMPUTE WS-PCT-RND       = WS-CASH-PCT-RATE / 100              
                                                                                
                 COMPUTE WS-CASH-FEE ROUNDED                                    
                                       = WS-TOTAL-FEE-AMT * WS-PCT-RND          
                                                                                
                                                                                
                 MOVE WS-CASH-FEE          TO WS-CASH-DIFF                      
                 COMPUTE WS-CHECK-DECIMAL = WS-CASH-FEE - WS-CASH-DIFF          
                                                                                
                 IF WS-CHECK-DECIMAL < 0.5                                      
                    MOVE WS-CASH-DIFF      TO WS-CASH-FMT                       
                                           WS-CASH-FEE                          
                 ELSE                                                           
                    ADD 1                  TO WS-CASH-DIFF                      
                    MOVE WS-CASH-DIFF      TO WS-CASH-FEE                       
                    MOVE WS-CASH-FEE       TO WS-CASH-FMT                       
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE WS-CASH-FMT          TO PCA1B-CASH-AMT                       
           ELSE                                                                 
              MOVE '     -  '              TO PCA1B-CASH-AMT                    
           END-IF.                                                              
                                                                                
           MOVE WS-NUM-REGN          TO PCA1A-NUM-REGN                          
                                        PCA1B-NUM-REGN.                         
      *    MOVE WS-NUM-DATE          TO PCA1A-DATE PCA1B-DATE.                  
           MOVE WS-NAME-HA1          TO PCA1A-NAME.                             
           MOVE WS-NAME-HA2          TO PCA1A-NAME2.                            
           MOVE WS-NAME-HA3          TO PCA1A-NAME3.                            
           MOVE WS-NAME-HA4          TO PCA1A-NAME4.                            
           IF WS-NRIC-HA1 NOT = SPACES AND LOW-VALUES                           
              STRING WS-NRIC-HA1 ' / ' WS-NAME-HA1                              
                DELIMITED BY SIZE INTO PCA1B-HA1                                
              MOVE WS-CPF-HA1        TO PCA1B-CPF1                              
                                                                                
           END-IF.                                                              
           IF WS-NRIC-HA2 NOT = SPACES AND LOW-VALUES                           
              STRING WS-NRIC-HA2 ' / ' WS-NAME-HA2                              
                DELIMITED BY SIZE INTO PCA1B-HA2                                
              MOVE WS-CPF-HA2        TO PCA1B-CPF2                              
                                                                                
              IF KD35-NUM-INSTAL-RATE-CPF2 = 100                                
                 MOVE WS-TOTAL-FEE-AMT           TO WS-CPF2-FEE                 
                                                    WS-CPF2-FMT                 
              ELSE                                                              
                 COMPUTE WS-PCT-RND  = KD35-NUM-INSTAL-RATE-CPF2 / 100          
                                                                                
                 COMPUTE WS-CPF2-FEE ROUNDED                                    
                                     = WS-TOTAL-FEE-AMT * WS-PCT-RND            
                                                                                
                 MOVE WS-CPF2-FEE          TO WS-CPF2-DIFF                      
                 COMPUTE WS-CHECK-DECIMAL = WS-CPF2-FEE - WS-CPF2-DIFF          
                                                                                
                 IF WS-CHECK-DECIMAL < 0.5                                      
                    MOVE WS-CPF2-DIFF      TO WS-CPF2-FMT                       
                                              WS-CPF2-FEE                       
                 ELSE                                                           
                    ADD 1                  TO WS-CPF2-DIFF                      
                    MOVE WS-CPF2-DIFF      TO WS-CPF2-FEE                       
                    MOVE WS-CPF2-FEE       TO WS-CPF2-FMT                       
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE WS-CPF2-FMT             TO PCA1B-CPF2-AMT                    
           ELSE                                                                 
              MOVE '    -    '          TO PCA1B-CPF2                           
              MOVE '     -   '          TO PCA1B-CPF2-AMT                       
           END-IF.                                                              
           IF WS-NRIC-HA3 NOT = SPACES AND LOW-VALUES                           
              STRING WS-NRIC-HA3 ' / ' WS-NAME-HA3                              
                DELIMITED BY SIZE INTO PCA1B-HA3                                
              MOVE WS-CPF-HA3        TO PCA1B-CPF3                              
                                                                                
              IF KD35-NUM-INSTAL-RATE-CPF3 = 100                                
                 MOVE WS-TOTAL-FEE-AMT  TO WS-CPF3-FMT                          
                                           WS-CPF3-FEE                          
              ELSE                                                              
                 COMPUTE WS-PCT-RND  = KD35-NUM-INSTAL-RATE-CPF3 / 100          
                                                                                
                 COMPUTE WS-CPF3-FEE ROUNDED                                    
                                  = WS-TOTAL-FEE-AMT * WS-PCT-RND               
                                                                                
                 MOVE WS-CPF3-FEE          TO WS-CPF3-DIFF                      
                 COMPUTE WS-CHECK-DECIMAL = WS-CPF3-FEE - WS-CPF3-DIFF          
                                                                                
                 IF WS-CHECK-DECIMAL < 0.5                                      
                    MOVE WS-CPF3-DIFF      TO WS-CPF3-FMT                       
                                              WS-CPF3-FEE                       
                 ELSE                                                           
                    ADD 1                  TO WS-CPF3-DIFF                      
                    MOVE WS-CPF3-DIFF      TO WS-CPF3-FEE                       
                    MOVE WS-CPF3-FEE       TO WS-CPF3-FMT                       
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE WS-CPF3-FMT             TO PCA1B-CPF3-AMT                    
           ELSE                                                                 
              MOVE '    -    '          TO PCA1B-CPF3                           
              MOVE '    -    '          TO PCA1B-CPF3-AMT                       
           END-IF.                                                              
           IF WS-NRIC-HA4 NOT = SPACES AND LOW-VALUES                           
              STRING WS-NRIC-HA4 ' / ' WS-NAME-HA4                              
                DELIMITED BY SIZE INTO PCA1B-HA4                                
              MOVE WS-CPF-HA4        TO PCA1B-CPF4                              
                                                                                
                                                                                
              IF KD35-NUM-INSTAL-RATE-CPF4 = 100                                
                 COMPUTE WS-PCT-RND  = KD35-NUM-INSTAL-RATE-CPF4 / 100          
                                                                                
                 COMPUTE WS-CPF4-FEE ROUNDED                                    
                                     = WS-TOTAL-FEE-AMT * WS-PCT-RND            
                                                                                
                 MOVE WS-CPF4-FEE          TO WS-CPF4-DIFF                      
                 COMPUTE WS-CHECK-DECIMAL = WS-CPF4-FEE - WS-CPF4-DIFF          
                                                                                
                 IF WS-CHECK-DECIMAL < 0.5                                      
                    MOVE WS-CPF4-DIFF      TO WS-CPF4-FMT                       
                                              WS-CPF4-FEE                       
                 ELSE                                                           
                    ADD 1                  TO WS-CPF4-DIFF                      
                    MOVE WS-CPF4-DIFF      TO WS-CPF4-FEE                       
                    MOVE WS-CPF4-FEE       TO WS-CPF4-FMT                       
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE WS-CPF4-FMT             TO PCA1B-CPF4-AMT                    
           ELSE                                                                 
              MOVE '    -    '          TO PCA1B-CPF4                           
              MOVE '   -     '          TO PCA1B-CPF4-AMT                       
           END-IF.                                                              
                                                                                
           IF KD35-NUM-INSTAL-RATE-CPF1 > ZEROES                                
              COMPUTE WS-CPF-FEE  = WS-TOTAL-FEE-AMT - (WS-CASH-FEE +           
                                                        WS-CPF2-FEE +           
                                                        WS-CPF3-FEE +           
                                                        WS-CPF4-FEE)            
           ELSE                                                                 
             IF KD35-NUM-INSTAL-RATE-CPF2 > ZEROES                              
               COMPUTE WS-CPF-FEE  = WS-TOTAL-FEE-AMT - (WS-CASH-FEE +          
                                                         WS-CPF1-FEE +          
                                                         WS-CPF3-FEE +          
                                                         WS-CPF4-FEE)           
             ELSE                                                               
               IF KD35-NUM-INSTAL-RATE-CPF3 > ZEROES                            
                  COMPUTE WS-CPF-FEE  = WS-TOTAL-FEE-AMT -                      
                                                        (WS-CASH-FEE +          
                                                         WS-CPF1-FEE +          
                                                         WS-CPF2-FEE +          
                                                         WS-CPF4-FEE)           
               ELSE                                                             
                  IF KD35-NUM-INSTAL-RATE-CPF4 > ZEROES                         
                     COMPUTE WS-CPF-FEE  = WS-TOTAL-FEE-AMT -                   
                                                        (WS-CASH-FEE +          
                                                         WS-CPF1-FEE +          
                                                         WS-CPF2-FEE +          
                                                         WS-CPF3-FEE)           
                  END-IF                                                        
               END-IF                                                           
             END-IF                                                             
           END-IF                                                               
                                                                                
           IF (KD35-NUM-INSTAL-RATE-CPF1 = 0) AND                               
                      (WS-TOTAL-PCT-RATE > 0)                                   
                                                                                
              IF (KD35-NUM-INSTAL-RATE-CPF2 > KD35-NUM-INSTAL-RATE-CPF3)        
                                        AND                                     
                 (KD35-NUM-INSTAL-RATE-CPF2 > KD35-NUM-INSTAL-RATE-CPF4)        
                  MOVE WS-CPF-FEE                     TO WS-CPF2-FEE            
                  MOVE WS-CPF2-FEE                    TO WS-CPF2-FMT            
                  MOVE WS-CPF2-FMT                    TO PCA1B-CPF2-AMT         
              END-IF                                                            
                                                                                
              IF (KD35-NUM-INSTAL-RATE-CPF3 > KD35-NUM-INSTAL-RATE-CPF2)        
                                        AND                                     
                 (KD35-NUM-INSTAL-RATE-CPF3 > KD35-NUM-INSTAL-RATE-CPF4)        
                  MOVE WS-CPF-FEE                     TO WS-CPF3-FEE            
                  MOVE WS-CPF3-FEE                    TO WS-CPF3-FMT            
                  MOVE WS-CPF3-FMT                    TO PCA1B-CPF3-AMT         
              END-IF                                                            
                                                                                
              IF (KD35-NUM-INSTAL-RATE-CPF4 > KD35-NUM-INSTAL-RATE-CPF2)        
                                        AND                                     
                 (KD35-NUM-INSTAL-RATE-CPF4 > KD35-NUM-INSTAL-RATE-CPF3)        
                  MOVE WS-CPF-FEE                     TO WS-CPF4-FEE            
                  MOVE WS-CPF4-FEE                    TO WS-CPF4-FMT            
                  MOVE WS-CPF4-FMT                    TO PCA1B-CPF4-AMT         
              END-IF                                                            
                                                                                
              MOVE ZEROES                             TO WS-CPF-FEE             
           END-IF.                                                              
                                                                                
           IF KD35-NUM-INSTAL-RATE-CPF1 > ZEROES                                
              COMPUTE WS-CPF-FEE  = WS-TOTAL-FEE-AMT - (WS-CASH-FEE +           
                                                        WS-CPF2-FEE +           
                                                        WS-CPF3-FEE +           
                                                        WS-CPF4-FEE)            
              MOVE WS-CPF-FEE                     TO WS-CPF1-FEE                
              MOVE WS-CPF1-FEE                    TO WS-CPF1-FMT                
              MOVE WS-CPF1-FMT                    TO PCA1B-CPF1-AMT             
           ELSE                                                                 
              INITIALIZE                             WS-CPF1-FMT                
              MOVE WS-CPF1-FMT                    TO PCA1B-CPF1-AMT             
           END-IF.                                                              
                                                                                
           MOVE '  -  '              TO PCA1B-CASH.                             
           MOVE WS-K830-BLK          TO PCA1A-BLK.                              
           MOVE WS-K830-FLAT         TO PCA1A-UNIT.                             
           MOVE WS-K830-ADDR-L2      TO PCA1A-ADDR-L2.                          
           MOVE WS-K830-ADDR-L3      TO PCA1A-ADDR-L3.                          
           MOVE WS-BAR-CODE          TO PCA1A-BAR-CODE.                         
           MOVE WS-PIDB-ADDRESS      TO PCA1A-PIDB-ADDR.                        
           STRING 'APT ' WS-PIDB-ADDRESS                                        
              DELIMITED BY SIZE INTO PCA1B-ADDRESS.                             
           MOVE WS-LS-ESCROW-FEE     TO PCA1A-LS-ESCROW-FEE.                    
           MOVE WS-MORT-ESCROW-FEE   TO PCA1A-MORT-ESCROW-FEE.                  
           MOVE WS-SURVEY-FEE        TO PCA1A-SURVEY-FEE.                       
           MOVE WS-TOTAL-FEE         TO PCA1A-TOTAL-FEE.                        
           MOVE WS-SUM-FEE           TO PCA1A-AMT-INSURED.                      
           MOVE WS-AMT-PREMIUM       TO PCA1A-AMT-PREMIUM.                      
           MOVE WS-AMT-INSURED       TO PCA1A-AMT-INSURED.                      
           MOVE WS-NUM-DID           TO PCA1A-NUM-DID.                          
           MOVE WS-NME-OIC           TO PCA1A-NME-OIC.                          
                                                                                
       7500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *=============================================================            
       8000-PRN-CNTRL-LIST.                                                     
      *=============================================================            
                                                                                
           MOVE SPACES TO LCA1-DTL.                                             
           INITIALIZE LCA1-DTL.                                                 
                                                                                
           MOVE WS-NUM-REGN               TO LCA1-NUM-REGN.                     
           MOVE WS-PIDB-BLK               TO LCA1-NUM-BLK.                      
      *    MOVE WS-PIDB-STREET(1:28)      TO LCA1-NME-STREET.                   
           STRING '#' WS-PIDB-LEVEL '-' WS-PIDB-UNIT                            
              DELIMITED BY SIZE INTO LCA1-NUM-HSE-NO.                           
           MOVE WS-NUM-LOAN-TAG           TO LCA1-NUM-LOAN-TAG.                 
           MOVE WS-NUM-CF-TYPE            TO LCA1-NUM-CF-TYPE.                  
           MOVE WS-NUM-ELIG-SCH           TO LCA1-NUM-ELIG-SCH.                 
           MOVE WS-NUM-STRATA-AREA        TO LCA1-NUM-FLOOR-AREA.               
                                                                                
      **   STRING  WS-CASH-PCT-FMT  '%,'                                        
      **           WS-CPF1-PCT-FMT  '%,'                                        
      **           WS-CPF2-PCT-FMT  '%,'                                        
      **           WS-CPF3-PCT-FMT  '%,'                                        
      **           WS-CPF4-PCT-FMT  '%'                                         
      **              DELIMITED BY SIZE INTO LCA1-CASH-CPF-RATE.                
           STRING WS-CASH-FMT(5:6) ' '                                          
                  WS-CPF1-FMT(5:6) ' '                                          
                  WS-CPF2-FMT(5:6) ' '                                          
                  WS-CPF3-FMT(5:6) ' '                                          
                  WS-CPF4-FMT(5:6)                                              
                      DELIMITED BY SIZE INTO LCA1-CASH-CPF-RATE.                
                                                                                
           IF WS-DTE-EFF-SUBTRAN NOT = SPACES AND LOW-VALUES AND ZEROES         
              STRING  WS-DTE-EFF-SUBTRAN(7:2) '/'                               
                      WS-DTE-EFF-SUBTRAN(5:2) '/'                               
                      WS-DTE-EFF-SUBTRAN(1:4)                                   
                      DELIMITED BY SIZE INTO LCA1-NUM-DTE-TRANS                 
           ELSE                                                                 
              MOVE SPACES                 TO LCA1-NUM-DTE-TRANS                 
           END-IF.                                                              
                                                                                
      *    MOVE WS-NUM-WARRANT-ACT        TO LCA1-NUM-WARRANT-ACT.              
      *    MOVE WS-NAME-HA1               TO LCA1-HA1-NAME.                     
      *    MOVE WS-NRIC-HA1               TO LCA1-HA1-NRIC.                     
           MOVE WS-SURVEY-FEE             TO LCA1-SURVEY-FEE.                   
           MOVE WS-LS-ESCROW-FEE          TO LCA1-LS-ESCROW-FEE.                
           MOVE WS-MORT-ESCROW-FEE        TO LCA1-MORT-ESCROW-FEE.              
           MOVE WS-TOTAL-FEE-AMT          TO LCA1-TOTAL-FEE.                    
                                                                                
           ADD 1                          TO WS-CNT-LINE-LCA1.                  
           ADD 2                          TO WS-CNT-CUR-LINE.                   
           MOVE WS-CNT-LINE-LCA1          TO LCA1-SNO.                          
                                                                                
           IF WS-CNT-CUR-LINE > 55                                              
              ADD 1                       TO WS-CNT-PAGE-LCA1                   
              MOVE WS-CNT-PAGE-LCA1       TO LCA1-PAGE                          
              MOVE WS-NUM-DATE            TO LCA1-DATE                          
              WRITE LCA1-PRTREC FROM LCA1-HDG1 AFTER PAGE                       
              WRITE LCA1-PRTREC FROM LCA1-HDG2 AFTER 2                          
              WRITE LCA1-PRTREC FROM LCA1-HDG3 AFTER 3                          
              WRITE LCA1-PRTREC FROM LCA1-HDG4                                  
              MOVE 7                      TO WS-CNT-CUR-LINE                    
           END-IF.                                                              
                                                                                
           WRITE LCA1-PRTREC            FROM LCA1-DTL AFTER 2.                  
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       8100-UPDATE-BP13KD15.                                                    
      *=============================================================            
                                                                                
           MOVE SPACES                        TO BP13KD15-REC.                  
           INITIALIZE                            BP13KD15-REC.                  
                                                                                
           MOVE F800-NUM-DBSS-PRJCT           TO KD15-NUM-PRJCT.                
           MOVE WS-PIDB-BLK                   TO KD15-NUM-BLK.                  
           MOVE WS-PIDB-UNIT                  TO KD15-NUM-MAIN-UNIT.            
           MOVE WS-PIDB-SUB-UNIT              TO KD15-NUM-SUB-UNIT.             
           MOVE WS-PIDB-LEVEL                 TO KD15-NUM-LEVEL.                
                                                                                
           READ BP13KD15.                                                       
                                                                                
           IF WS-KD15-STATUS = 00 OR 02                                         
              PERFORM 8200-REWRITE-BP13KD15      THRU 8200-EXIT                 
           ELSE                                                                 
              IF WS-KD15-STATUS = 23                                            
                 ADD 1 TO WS-KD15-NOTFD                                         
                 DISPLAY 'RECORD NOT FOUND IN BP13KD15,KEY='                    
                                                 KD15-KEY-FLD                   
                         ' F800-NUM-REGN =' F800-NUM-REGN                       
                         ' F800-SCHACC =' F800-NUM-SCH-ACC                      
                 INITIALIZE                      BP13KD15-REC                   
              ELSE                                                              
                 DISPLAY 'ERROR READING BP13KD15 ,RC= ' WS-KD15-STATUS          
                 MOVE WS-KD15-STATUS           TO RETURN-CODE                   
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       8200-REWRITE-BP13KD15.                                                   
      *=============================================================            
                                                                                
           IF KD15-AMT-STAMP-SURVEY-CASH NOT NUMERIC                            
              MOVE ZEROES                TO KD15-AMT-STAMP-SURVEY-CASH          
           END-IF.                                                              
                                                                                
           IF KD15-AMT-STAMP-SURVEY-CPF1 NOT NUMERIC                            
              MOVE ZEROES                TO KD15-AMT-STAMP-SURVEY-CPF1          
           END-IF.                                                              
                                                                                
           IF KD15-AMT-STAMP-SURVEY-CPF2 NOT NUMERIC                            
              MOVE ZEROES                TO KD15-AMT-STAMP-SURVEY-CPF2          
           END-IF.                                                              
                                                                                
           IF KD15-AMT-STAMP-SURVEY-CPF3 NOT NUMERIC                            
              MOVE ZEROES                TO KD15-AMT-STAMP-SURVEY-CPF3          
           END-IF.                                                              
                                                                                
           IF KD15-AMT-STAMP-SURVEY-CPF4 NOT NUMERIC                            
              MOVE ZEROES                TO KD15-AMT-STAMP-SURVEY-CPF4          
           END-IF.                                                              
                                                                                
           MOVE WS-CASH-FEE              TO KD15-AMT-STAMP-SURVEY-CASH.         
           MOVE WS-CPF1-FEE              TO KD15-AMT-STAMP-SURVEY-CPF1.         
           MOVE WS-CPF2-FEE              TO KD15-AMT-STAMP-SURVEY-CPF2.         
           MOVE WS-CPF3-FEE              TO KD15-AMT-STAMP-SURVEY-CPF3.         
           MOVE WS-CPF4-FEE              TO KD15-AMT-STAMP-SURVEY-CPF4.         
                                                                                
           REWRITE BP13KD15-REC.                                                
                                                                                
           IF WS-KD15-STATUS = 00 OR 02                                         
              ADD 1                                  TO WS-KD15-UPDATE          
           ELSE                                                                 
               DISPLAY 'ERROR REWRITING BP13KD15 ,RC= ' WS-KD15-STATUS          
               MOVE WS-KD15-STATUS                   TO RETURN-CODE             
               GO TO 9000-CLOSE-ROUTINE                                         
           END-IF.                                                              
                                                                                
       8200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13CCA1 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F800 RECORDS READ          : ' WS-F800-READ-CTR.           
           DISPLAY ' NO OF CASES FOR BP13I0     : ' WS-PCA1-WRT-CTR.            
           DISPLAY ' NO OF CASES FOR BP13KH     : ' WS-PCA2-WRT-CTR.            
           DISPLAY ' NO OF CASES WRITE          : ' WS-CNT-LINE-LCA1.           
           DISPLAY ' NO OF CASES FOUND IN F120  : ' WS-F120-READ-CTR.           
           DISPLAY ' NO OF CASES W/OUT DATE SNP : ' WS-BYPASS-PRT-CTR.          
           DISPLAY ' NO OF CASES UPDATED KD15   : ' WS-KD15-UPDATE.             
           DISPLAY ' NO OF CASES KD15 NOTFD     : ' WS-KD15-NOTFD.              
           DISPLAY ' NO OF CASES F800 NOTFD     : ' WS-F800-NOTFD.              
           DISPLAY ' NO OF CASES F120 NOTFD     : ' WS-F120-NOTFD.              
           DISPLAY ' NO OF LET F800 FD, NO F120 : ' WS-F800-FD-PRINT.           
           DISPLAY ' NO OF LOAN-TAG=H           : ' WS-F800-LOAN-H.             
           DISPLAY ' NO OF LOAN-TAG=B           : ' WS-F800-LOAN-B.             
           DISPLAY ' NO OF LOAN-TAG=N           : ' WS-F800-LOAN-N.             
           DISPLAY ' NO OF LOAN-TAG=O           : ' WS-F800-LOAN-O.             
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13F800                                                       
                 SY02F001                                                       
                 BM06F120                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13KD25                                                       
                 BP13KD00                                                       
                 BP13K022                                                       
                 BP13K024                                                       
                 BP13KD35                                                       
                 BP13KD15                                                       
                 BP13PCA1                                                       
                 BP13PCA2                                                       
                 BP13LCA1.                                                      
                                                                                
           IF WS-K820-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K820-STAT ' WS-K820-STATUS.            
                                                                                
           IF WS-K830-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS.            
                                                                                
           IF WS-KD25-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13KD25-STAT ' WS-KD25-STATUS.            
                                                                                
           IF WS-KD00-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13KD00-STAT ' WS-KD00-STATUS.            
                                                                                
           IF WS-K022-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K022-STAT ' WS-K022-STATUS.            
                                                                                
           IF WS-K024-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K024-STAT ' WS-K024-STATUS.            
                                                                                
           IF WS-KD35-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13KD35-STAT ' WS-KD35-STATUS.            
                                                                                
           IF WS-KD15-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13KD15-STAT ' WS-KD15-STATUS.            
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
