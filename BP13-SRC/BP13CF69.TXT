       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CF69.                                                 
      *AUTHOR.        SMR2.                                                     
      *DATE-WRITTEN.  29/10/2012.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : PRINT SUCC OR UNSUCC LETTER FOR SBF - GRO   *            
      *                                                            *            
      *  INPUT FILES : 1.  BP13F740  -  SOC REQ FILE               *            
      *                2.  BP13K740  -  SOC REQ FILE               *            
      *                3.  BP13K825  -  OCCUPIER FILE              *            
      *                4.  BP13K830  -  ADDRESS FILE               *            
      *                5.  BP13K813  -  BTO/SBF SITE INFORMATION   *            
      *                                                            *            
      *  LISTINGS    : 1.  P13LF69C  -  CONTROL LISTING FOR SUCC   *            
      *                2.  P13LF69D  -  CONTROL LISTING FOR UNSUCC *            
      *                3.  P13LF69G  -  CONTROL LISTING FOR GRO    *            
      *                8.  P13LF69I  -  NON-SA QUEUE WITHIN 100%   *            
      *                9.  P13LF69L  -  NON-SA QUEUE WITHIN 200%   *            
      *               10.  P13LF69M  -  NON-SA QUEUE WITHIN 300%   *            
      *               11.  P13LF69H  -  NON-SA QUEUE BEYOND 300%   *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF   BY    DATE      DESCRIPTION                      *            
      * --------  ----  --------  -------------------------------- *            
      * BP134688  SMR2  20121029  NEW PROGRAM (SIMILAR TO BP13CB88)*            
      * BP134688  SMR2  20121115  REMOVE P13LF69G REPORT & CHANGE  *            
      *                           CONDITION FOR LF69-ROOM-NO1      *            
      * BP135162  SMR2  20140127  UPDATE HARDCODING FOR FLAT TYPE  *            
      * BP135190  SMR2  20131204  EXPAND BP13K813 TO 1000          *            
      * BP135392  SMR2  20140723  INCREASE LENGTH OF FT FIELD      *            
      * BP135625  SMR2  20150121  REMOVE HARDCODING FOR FLAT TYPE  *            
      * BP136107  SMR2  20160222  CATER FOR SINGLES AND REMOVE SA  *            
      *                           FORMS                            *            
      * BP136169  SMR2  20160407  SWITCH THE FIELDS, UNIT & STREET *            
      * BP137685  AM25  20190218  UPDATE TEXT EXERCISE FIELD       *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F740  ASSIGN       TO BP13F740                            
                            FILE STATUS  IS WS-F740-STATUS.                     
                                                                                
           SELECT BP13K825  ASSIGN       TO BP13K825                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K825-KEY-FLD                        
                            FILE STATUS  IS WS-K825-STATUS.                     
                                                                                
           SELECT BP13K830  ASSIGN       TO BP13K830                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K830-KEY-FLD                        
                            ALTERNATE RECORD KEY IS  K830-NUM-REGN              
                            FILE STATUS  IS WS-K830-STATUS.                     
                                                                                
           SELECT BP13K813  ASSIGN       TO BP13K813                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K813-KEY-FLD                        
                            FILE STATUS  IS WS-K813-STATUS.                     
                                                                                
           SELECT BP13K740  ASSIGN        TO BP13K740                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K740-KEY-FLD                       
                            FILE STATUS   IS WS-K740-STATUS.                    
                                                                                
           SELECT P13LF69C  ASSIGN       TO P13LF69C.                           
           SELECT P13LF69D  ASSIGN       TO P13LF69D.                           
           SELECT P13LF69H  ASSIGN       TO P13LF69H.                           
           SELECT P13LF69I  ASSIGN       TO P13LF69I.                           
           SELECT P13LF69L  ASSIGN       TO P13LF69L.                           
           SELECT P13LF69M  ASSIGN       TO P13LF69M.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F740                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13F740.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K740                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K740.                                                           
                                                                                
       FD  P13LF69C                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LF69C-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13LF69D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LF69D-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13LF69H                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF69H-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LF69I                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF69I-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LF69L                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF69L-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LF69M                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF69M-PRTREC                     PIC X(90).                          
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       COPY PRIOSCH.                                                            
                                                                                
       01  WS-STATUS.                                                           
           05  WS-K825-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K813-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K740-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-F740-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F740-NOT-FND              PIC 9(06)  VALUE ZEROS.             
           05  WS-F740-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF69H-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF69I-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF69L-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF69M-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-SUCC          PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-GRO           PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-UNSUCC        PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-LF69C            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LF69C            PIC 9(06)  VALUE 60.                
           05  WS-CNT-PAGE-LF69D            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LF69D            PIC 9(06)  VALUE 60.                
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F740-EOF                  PIC X     VALUE 'N'.                
           05  WS-BALLOT-SW                 PIC X(2)  VALUE SPACES.             
           05  WS-K825-NME-OCCP             PIC X(66) VALUE SPACES.             
           05  WS-ALLOCSCH-TYPE             PIC X(3)  VALUE SPACES.             
           05  WS-IDX-X                     PIC 99    VALUE 01.                 
           05  WS-RECORD-CNT                PIC ZZZ9.                           
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE-X REDEFINES WS-SENT-DATE PIC X(8).                  
           05  WS-DAYS                      PIC 9(7)  VALUE ZEROES.             
           05  WS-APPMT-TIME.                                                   
               10  WS-APPMT-HR              PIC 9(2)  VALUE 00.                 
               10  WS-APPMT-MIN             PIC 9(2)  VALUE 00.                 
           05  WS-DTE-BALLOT                PIC X(6)  VALUE SPACES.             
           05  WS-MTH-BE                    PIC X(9)  VALUE SPACES.             
                                                                                
       01  WS2-DEFAULT.                                                         
           05  WS2-MAX-LINES-LF69C          PIC 9(2)   VALUE 37.                
           05  WS2-MAX-LINES-LF69D          PIC 9(2)   VALUE 45.                
                                                                                
      *===============================                                          
      *   LINKAGE SECTION FOR AV02C015                                          
      *===============================                                          
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER TO APPLICANT                     *            
      *------------------------------------------------------------*            
       01  LF69-LINE01.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF69-REFNO               PIC X(15) VALUE SPACES.                 
                                                                                
       01  LF69-LINE01B.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF69-NUM-REGN            PIC X(14) VALUE SPACES.                 
                                                                                
       01  LF69-LINE02.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF69-DATE                PIC X(10) VALUE SPACES.                 
                                                                                
       01  LF69-LINE03.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF69-NAME                PIC X(66) VALUE SPACES.                 
                                                                                
       01  LF69-LINE04.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF69-NAME2               PIC X(66) VALUE SPACES.                 
                                                                                
       01  LF69-LINE05.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF69-BLK                 PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  LF69-ADDR-L2             PIC X(47) VALUE SPACES.                 
                                                                                
       01  LF69-LINE06.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF69-UNIT                PIC X(11) VALUE SPACES.                 
                                                                                
       01  LF69-LINE07.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF69-ADDR-L3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF69-LINE08.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LF69-BAR-CODE            PIC X(09) VALUE SPACES.                 
                                                                                
       01  LF69-LINE8A.                                                         
           05  FILLER                   PIC X(48) VALUE SPACES.                 
           05  LF69-ROOM-NO             PIC X(36) VALUE SPACES.                 
                                                                                
       01  LF69-LINE8B.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LF69-ESTATE              PIC X(33) VALUE SPACES.                 
                                                                                
       01  LF69-LINE8C.                                                         
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  LF69-ROOM-NO2            PIC X(16) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  LF69-ESTATE2             PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF69-LINE8D.                                                         
           05  FILLER                   PIC X(66) VALUE SPACES.                 
           05  LF69-ESTATE3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF69-LINE09A.                                                        
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  LF69-ELEC-WARD           PIC X(25) VALUE SPACES.                 
                                                                                
       01  LF69-LINE09B.                                                        
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  LF69-ELEC-WARD-JO        PIC X(25) VALUE SPACES.                 
                                                                                
      *** NORMAL QUEUE POSITION ***                                             
       01  LF69-LINE10A-NORM.                                                   
           05  FILLER                   PIC X(63) VALUE SPACES.                 
           05  LF69-QUEUE-NO1           PIC ZZZZ9.                              
                                                                                
      *** GRO QUEUE POSITION ***                                                
       01  LF69-LINE10A-GRO.                                                    
           05  FILLER                   PIC X(53) VALUE SPACES.                 
           05  LF69-QUEUE-NO1-GRO       PIC ZZZZ9.                              
                                                                                
       01  LF69-LINE10B-GRO.                                                    
           05  FILLER                   PIC X(54) VALUE SPACES.                 
           05  LF69-QUEUE-NO2-GRO       PIC ZZZZ9.                              
                                                                                
       01  LF69-LINE10C-GRO.                                                    
           05  FILLER                   PIC X(58) VALUE SPACES.                 
           05  LF69-QUEUE-NO3-GRO       PIC ZZZZ9.                              
                                                                                
       01  LF69-LINE10D-GRO.                                                    
           05  FILLER                   PIC X(61) VALUE SPACES.                 
           05  LF69-QUEUE-NO4-GRO       PIC ZZZZ9.                              
                                                                                
      *** UNIT OFFER ***                                                        
       01  LF69-LINE10E-OFR.                                                    
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF69-UNIT-OFFER-A        PIC ZZZ9.                               
                                                                                
       01  LF69-LINE10F-OFR.                                                    
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF69-UNIT-OFFER-B        PIC ZZZ9.                               
                                                                                
       01  LF69-LINE10G-OFR.                                                    
           05  FILLER                   PIC X(13) VALUE SPACES.                 
           05  LF69-UNIT-OFFER-C        PIC ZZZ9.                               
                                                                                
       01  LF69-LINE10H-OFR.                                                    
           05  FILLER                   PIC X(21) VALUE SPACES.                 
           05  LF69-UNIT-OFFER-D        PIC ZZZ9.                               
                                                                                
      *** SEL PERIOD LTR ***                                                    
       01  LF69-LINE10D-DATE.                                                   
           05  FILLER                   PIC X(54)  VALUE SPACES.                
           05  LF69-DTE-SEL             PIC X(17) VALUE SPACES.                 
                                                                                
       01  LF69-LINE11A-BALLOT.                                                 
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF69-BALLOT-DTE          PIC X(79) VALUE SPACES.                 
                                                                                
       01  LF69-LINE11B-BALLOT.                                                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  LF69-BALLOT-DTE1         PIC X(70) VALUE SPACES.                 
                                                                                
       01  LF69-LINE11C-BALLOT.                                                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  LF69-BALLOT-DTE2         PIC X(70) VALUE SPACES.                 
                                                                                
       01  LF69E-LINE02A.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF69E-NAME1              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF69E-NRIC1              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LF69E-LINE02B.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF69E-NAME2              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF69E-NRIC2              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LF69E-LINE02C.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF69E-NAME3              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF69E-NRIC3              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LF69E-LINE02D.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF69E-NAME4              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF69E-NRIC4              PIC X(9)  VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  LF69A-HDG1.                                                          
           05  LF69A-LISTING            PIC X(14) VALUE 'P13LF69C'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  LF69A-DATE               PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  LF69A-PAGE               PIC ZZZZ9.                              
                                                                                
       01  LF69A-HDG2.                                                          
           05  FILLER                   PIC X(20) VALUE SPACES.                 
           05  LF69A-LISTING-TYPE       PIC X(87) VALUE SPACES.                 
                                                                                
       01  LF69A-HDG4.                                                          
           05  FILLER                   PIC X(7)  VALUE ' S/N   '.              
           05  FILLER                   PIC X(9)  VALUE 'REF-NO   '.            
           05  FILLER                   PIC X(15) VALUE                         
               'APPLICANT NAMES'.                                               
           05  FILLER                   PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE '  UIN  '.              
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE 'CAT  '.                
           05  FILLER                   PIC X(5)  VALUE 'ALLOC'.                
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'FLAT'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'HHTY   '.              
           05  FILLER                   PIC X(4)  VALUE 'MCPS'.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'RES-HA1'.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'SUCC'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'NT1   '.               
           05  FILLER                   PIC X(6)  VALUE 'UNSUCC'.               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'BALLOT'.               
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE 'ZE'.                   
                                                                                
       01  LF69A-HDG5.                                                          
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'REGN-NO'.              
           05  FILLER                   PIC X(40) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'SCH'.                  
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'TYPE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE '    '.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE '       '.              
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE '     '.                
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'ZONE   '.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE '   '.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'ZONE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'POS'.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'Q-POS'.                
                                                                                
       01  LF69A-HDG6.                                                          
           05  FILLER                   PIC X(7)  VALUE '       '.              
           05  FILLER                   PIC X(9)  VALUE 'LOAN-TAG '.            
           05  FILLER                   PIC X(15) VALUE                         
               'REQ-STATUS     '.                                               
                                                                                
       01  LF69A-DTL-1.                                                         
           05  LF69A-SERIAL-NO          PIC ZZZ9.                               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF69A-REF-NO             PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF69A-NAME-1             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF69A-NRIC-1             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF69A-CAT                PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF69A-ALLOC              PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF69A-FLAT               PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LF69A-HHTY               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF69A-MCPS               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(9)  VALUE SPACES.                 
           05  LF69A-RES-HA1            PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF69A-SUCC               PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF69A-NT1                PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  LF69A-UNSUCC             PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LF69A-BALLOT-POS         PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF69A-ZONE               PIC X(2)  VALUE SPACES.                 
                                                                                
       01  LF69A-DTL-2.                                                         
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF69A-REGN-NO            PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF69A-NAME-2             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF69A-NRIC-2             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(79) VALUE SPACES.                 
           05  LF69A-QUEUE              PIC X(5)  VALUE SPACES.                 
                                                                                
       01  LF69A-DTL-3.                                                         
           05  FILLER                   PIC X(16) VALUE SPACES.                 
           05  LF69A-BLK                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF69A-UNIT               PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF69A-ADDR2              PIC X(65) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF69A-ADDR3              PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF69A-DTL-4.                                                         
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF69A-LOAN-TAG           PIC X(6)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF69A-REQ-STATUS         PIC X(22) VALUE SPACES.                 
                                                                                
       01  DJDE-LINE-NON-POD1             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13JP,BFORM=BP13JQ,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-NON-POD2             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13J8,BFORM=BLANKF,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-WQ                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WQ,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WR                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WR,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WS                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WS,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WT                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WT,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-BLANKF                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BLANKF,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13W1                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13W1,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13W9                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13W9,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
      *=============================================================            
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-FILES           THRU 1000-EXIT.                    
           PERFORM 3000-PROCESS-RECORDS      THRU 3000-EXIT                     
             UNTIL WS-F740-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-ROUTINE        THRU 9000-EXIT.                    
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       1000-OPEN-FILES.                                                         
      *=============================================================            
                                                                                
           OPEN INPUT BP13F740                                                  
                      BP13K825                                                  
                      BP13K830                                                  
                      BP13K813                                                  
                      BP13K740                                                  
               OUTPUT P13LF69C                                                  
                      P13LF69D                                                  
                      P13LF69H                                                  
                      P13LF69I                                                  
                      P13LF69L                                                  
                      P13LF69M.                                                 
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING ERROR K825 STATUS ' WS-K825-STATUS               
              MOVE WS-K825-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING ERROR K830 STATUS ' WS-K830-STATUS               
              MOVE WS-K830-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING ERROR K813 STATUS ' WS-K813-STATUS               
              MOVE WS-K813-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K740-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING ERROR K740 STATUS ' WS-K740-STATUS               
              MOVE WS-K740-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)   TO WS-DATE                         
                                                WS-CURR-DATE.                   
                                                                                
           STRING WS-DD '/' WS-MM '/' WS-CCYY                                   
           DELIMITED BY SIZE INTO LF69A-DATE.                                   
                                                                                
           MOVE SPACES                   TO LF69H-PRTREC                        
                                            LF69I-PRTREC                        
                                            LF69L-PRTREC                        
                                            LF69M-PRTREC.                       
                                                                                
           MOVE SPACES           TO LF69H-PRTREC.                               
           WRITE LF69H-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF69H-PRTREC.                               
           WRITE LF69H-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF69I-PRTREC.                               
           WRITE LF69I-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF69I-PRTREC.                               
           WRITE LF69I-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF69L-PRTREC.                               
           WRITE LF69L-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF69L-PRTREC.                               
           WRITE LF69L-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF69M-PRTREC.                               
           WRITE LF69M-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF69M-PRTREC.                               
           WRITE LF69M-PRTREC    AFTER PAGE.                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3000-PROCESS-RECORDS.                                                    
      *=============================================================            
                                                                                
           PERFORM 4000-READ-BP13F740        THRU 4000-EXIT.                    
           PERFORM 4500-MOVE-DETAILS         THRU 4500-EXIT                     
             UNTIL WS-F740-EOF = 'Y'.                                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4000-READ-BP13F740.                                                      
      *=============================================================            
                                                                                
            READ BP13F740                                                       
              AT END                                                            
                 MOVE 'Y'                    TO WS-F740-EOF                     
                 GO TO 4000-EXIT.                                               
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4500-MOVE-DETAILS.                                                       
      *=============================================================            
                                                                                
           MOVE SPACES                    TO K825-KEY-FLD                       
                                             LF69E-NAME1                        
                                             LF69E-NAME2                        
                                             LF69E-NAME3                        
                                             LF69E-NAME4                        
                                             LF69E-NRIC1                        
                                             LF69E-NRIC2                        
                                             LF69E-NRIC3                        
                                             LF69E-NRIC4                        
                                             LF69-NUM-REGN                      
                                             LF69-ROOM-NO                       
                                             LF69-ROOM-NO2                      
                                             LF69-BALLOT-DTE                    
                                             LF69-BALLOT-DTE1                   
                                             LF69-BALLOT-DTE2                   
                                             LF69-DTE-SEL.                      
                                                                                
           MOVE F740-NUM-REF              TO LF69-REFNO.                        
                                                                                
           EVALUATE   F740-NUM-WARD                                             
             WHEN 'AD '                                                         
                MOVE 'ADMIRALTY'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'AH '                                                         
                MOVE 'ANG MO KIO-HOUGANG'         TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'AR '                                                         
                MOVE 'AYER RAJAH'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BB '                                                         
                MOVE 'BUKIT BATOK'                TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BD '                                                         
                MOVE 'BEDOK'                      TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BE '                                                         
                MOVE 'BISHAN EAST'                TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BG '                                                         
                MOVE 'BUKIT GOMBAK'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BH '                                                         
                MOVE 'BRADDELL HEIGHTS'           TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BK '                                                         
                MOVE 'BUKIT BATOK EAST'           TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BL '                                                         
                MOVE 'BOON LAY'                   TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BN '                                                         
                MOVE 'BISHAN NORTH'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BP '                                                         
                MOVE 'BUKIT PANJANG'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BR '                                                         
                MOVE 'BEDOK RESERVOIR-PUNGGOL'    TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BT '                                                         
                MOVE 'BUKIT TIMAH'                TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'BV '                                                         
                MOVE 'BUONA VISTA'                TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'CA '                                                         
                MOVE 'CASHEW'                     TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'CB '                                                         
                MOVE 'CANBERRA'                   TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'CH '                                                         
                MOVE 'CHANGI-SIMEI'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'CK '                                                         
                MOVE 'CHUA CHU KANG'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'CL '                                                         
                MOVE 'CLEMENTI'                   TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'CP '                                                         
                MOVE 'CHONG PANG'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'CS '                                                         
                MOVE 'CHENG SAN-SELETAR'          TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'EU '                                                         
                MOVE 'EUNOS'                      TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'FS '                                                         
                MOVE 'FENGSHAN'                   TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'GS '                                                         
                MOVE 'GEYLANG SERAI'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'HG '                                                         
                MOVE 'HOUGANG'                    TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'HK '                                                         
                MOVE 'HONG KAH NORTH'             TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'JB '                                                         
                MOVE 'JALAN BESAR'                TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'JC '                                                         
                MOVE 'JOO CHIAT'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'JK '                                                         
                MOVE 'JALAN KAYU'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'JS '                                                         
                MOVE 'JURONG SPRING'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'JU '                                                         
                MOVE 'JURONG CENTRAL'             TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KA '                                                         
                MOVE 'KOLAM AYER'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KB '                                                         
                MOVE 'KAKI BUKIT'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KC '                                                         
                MOVE 'KAMPONG CHAI CHEE'          TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KG '                                                         
                MOVE 'KAMPONG GLAM'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KH '                                                         
                MOVE 'KEAT HONG'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KR '                                                         
                MOVE 'KEBUN BARU'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KS '                                                         
                MOVE 'KRETA AYER-KIM SENG'        TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'KU '                                                         
                MOVE 'KEMBANGAN-CHAI CHEE'        TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'MA '                                                         
                MOVE 'MARINE PARADE'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'MB '                                                         
                MOVE 'MOUNTBATTEN'                TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'MM '                                                         
                MOVE 'MOULMEIN'                   TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'MP '                                                         
                MOVE 'MACPHERSON'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'MS '                                                         
                MOVE 'MARSILING'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'NC '                                                         
                MOVE 'NEE SOON CENTRAL'           TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'NE '                                                         
                MOVE 'NEE SOON EAST'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'NS '                                                         
                MOVE 'NEE SOON SOUTH'             TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'NY '                                                         
                MOVE 'NANYANG'                    TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PA '                                                         
                MOVE 'PASIR RIS EAST'             TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PC '                                                         
                MOVE 'PUNGGOL CENTRAL'            TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PE '                                                         
                MOVE 'PUNGGOL EAST'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PI '                                                         
                MOVE 'PIONEER'                    TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PL '                                                         
                MOVE 'PAYA LEBAR'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PN '                                                         
                MOVE 'PUNGGOL NORTH'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PR '                                                         
                MOVE 'PASIR RIS WEST'             TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PS '                                                         
                MOVE 'POTONG PASIR'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PU '                                                         
                MOVE 'PUNGOL SOUTH'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'PW '                                                         
                MOVE 'PUNGOL WEST'                TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'QT '                                                         
                MOVE 'QUEENSTOWN'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'RM '                                                         
                MOVE 'RADIN MAS'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'SB '                                                         
                MOVE 'SEMBAWANG'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'SG '                                                         
                MOVE 'SERANGOON'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'SL '                                                         
                MOVE 'SIGLAP'                     TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'SW '                                                         
                MOVE 'SENGKANG WEST'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TA '                                                         
                MOVE 'TOA PAYOH EAST'             TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TB '                                                         
                MOVE 'TELOK BLANGAH'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TC '                                                         
                MOVE 'TAMPINES CENTRAL'           TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TE '                                                         
                MOVE 'TAMPINES EAST'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TG '                                                         
                MOVE 'TECK GHEE'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TH '                                                         
                MOVE 'THOMSON-TOA PAYOH'          TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TJ '                                                         
                MOVE 'TAMAN JURONG'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TL '                                                         
                MOVE 'TANGLIN-CAIRNHILL'          TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TM '                                                         
                MOVE 'TAMPINES CHANGKAT'          TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TN '                                                         
                MOVE 'TAMPINES NORTH'             TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TO '                                                         
                MOVE 'TOA PAYOH CENTRAL'          TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TP '                                                         
                MOVE 'TANJONG PAGAR-TIONG BAHRU'  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'TW '                                                         
                MOVE 'TAMPINES WEST'              TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'UP '                                                         
                MOVE 'ULU PANDAN'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'WC '                                                         
                MOVE 'WEST COAST'                 TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'WG '                                                         
                MOVE 'WOODGROVE'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'WL '                                                         
                MOVE 'WOODLANDS'                  TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'WP '                                                         
                MOVE 'WHAMPOA'                    TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'YH '                                                         
                MOVE 'YUHUA'                      TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'YK '                                                         
                MOVE 'YIO CHU KANG'               TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'YT '                                                         
                MOVE 'YEW TEE'                    TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
             WHEN 'ZH '                                                         
                MOVE 'ZHENGHUA'                   TO LF69-ELEC-WARD             
                                                     LF69-ELEC-WARD-JO          
           END-EVALUATE.                                                        
                                                                                
           MOVE F740-NUM-NT-FT-QUEUE TO LF69-QUEUE-NO1.                         
                                                                                
           STRING F740-CDE-SUCC-NT-ZONE DELIMITED BY SPACES                     
                  F740-CDE-FLAT-TYPE DELIMITED BY SPACES                        
                  '/' F740-NUM-REGN                                             
           DELIMITED BY SIZE INTO LF69-NUM-REGN.                                
                                                                                
           MOVE F740-NUM-REGN             TO K825-NUM-REGN.                     
           MOVE F740-NUM-NRIC1            TO K825-NUM-NRIC.                     
                                                                                
           PERFORM  4600-READ-K825      THRU 4600-EXIT.                         
           MOVE     WS-K825-NME-OCCP      TO LF69-NAME                          
                                             LF69E-NAME1.                       
                                                                                
           MOVE F740-NUM-NRIC1            TO LF69E-NRIC1.                       
                                                                                
           IF F740-NUM-NRIC2 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LF69-NAME2                      
                                                LF69E-NAME2                     
                                                LF69E-NRIC2                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC2            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LF69-NAME2                      
                                                LF69E-NAME2                     
              MOVE F740-NUM-NRIC2            TO LF69E-NRIC2                     
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC3 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LF69E-NAME3                     
                                                LF69E-NRIC3                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC3            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LF69E-NAME3                     
              MOVE F740-NUM-NRIC3            TO LF69E-NRIC3                     
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC4 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LF69E-NAME4                     
                                                LF69E-NRIC4                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC4            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LF69E-NAME4                     
              MOVE F740-NUM-NRIC4            TO LF69E-NRIC4                     
           END-IF.                                                              
                                                                                
           MOVE F740-DTE-BALLOT              TO WS-DTE-BALLOT.                  
                                                                                
           EVALUATE WS-DTE-BALLOT(5:2)                                          
           WHEN 01                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN JANUARY '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'JANUARY '    F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'JANUARY '    F740-DTE-BALLOT(1:4)                      
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 02                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN FEBRUARY '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'FEBRUARY '    F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'FEBRUARY '    F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 03                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN MARCH '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'MARCH '       F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'MARCH '       F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 04                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN APRIL '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'APRIL '       F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'APRIL '       F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 05                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN MAY '                              
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'MAY '         F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'MAY '         F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 06                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN JUNE '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'JUNE '        F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'JUNE '        F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 07                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN JULY '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'JULY '        F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'JULY '        F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 08                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN AUGUST '                           
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'AUGUST '      F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'AUGUST '      F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 09                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN SEPTEMBER '                        
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'SEPTEMBER '   F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'SEPTEMBER '   F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 10                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN OCTOBER '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'OCTOBER '     F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'OCTOBER '     F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 11                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN NOVEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'NOVEMBER '    F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'NOVEMBER '    F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 12                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FLAT APPLICATION IN DECEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO   LF69-BALLOT-DTE                       
                                                                                
                 STRING 'DECEMBER '    F740-DTE-BALLOT(1:4)                     
                        ' Sale of Balance Flats (SBF) Exercise'                 
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE1                  
                                                                                
                 STRING 'DECEMBER '    F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LF69-BALLOT-DTE2                  
              END-IF                                                            
           END-EVALUATE.                                                        
                                                                                
           MOVE SPACES                    TO BP13K813-REC.                      
           MOVE F740-CDE-NT1              TO K813-NUM-ZONE.                     
           MOVE F740-CDE-FLAT-TYPE        TO K813-NUM-FLAT-TYPE.                
           MOVE F740-DTE-BALLOT           TO K813-DTE-BALLOT.                   
                                                                                
           PERFORM  4700-READ-BP13K813 THRU  4700-EXIT.                         
           PERFORM  4800-GET-ADDR      THRU  4800-EXIT.                         
           PERFORM  7000-CHECK-SCH     THRU  7000-EXIT.                         
           PERFORM  7300-READ-K740     THRU  7300-EXIT.                         
                                                                                
           MOVE LF69-ESTATE                  TO LF69-ESTATE2                    
                                                LF69-ESTATE3.                   
                                                                                
           IF F740-NUM-ALLO-CAT = 'SBF'                                         
              IF F740-CDE-FLAT-TYPE NOT = '1A'                                  
                 IF K740-NUM-NT-FT-QUEUE = SPACES OR LOW-VALUES                 
                    PERFORM 6300-PRT-BP13WT    THRU 6300-EXIT                   
                 ELSE                                                           
                    IF K740-NUM-NT-FT-QUEUE >= K813-NUM-QUEUE-START AND         
                       K740-NUM-NT-FT-QUEUE <= K813-NUM-QUEUE-MID               
                       PERFORM 6000-PRT-BP13WQ THRU 6000-EXIT                   
                    END-IF                                                      
                                                                                
                    IF K740-NUM-NT-FT-QUEUE > K813-NUM-QUEUE-MID AND            
                       K740-NUM-NT-FT-QUEUE <= K813-NUM-QUEUE-END               
                       PERFORM 6100-PRT-BP13WR THRU 6100-EXIT                   
                    END-IF                                                      
                                                                                
                    IF K740-NUM-NT-FT-QUEUE > K813-NUM-QUEUE-END                
                       PERFORM 6200-PRT-BP13WS THRU 6200-EXIT                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 6500-PRINT-CONTROL-LIST   THRU 6500-EXIT.                    
                                                                                
           ADD 1                             TO WS-F740-READ-CTR.               
           PERFORM 4000-READ-BP13F740        THRU 4000-EXIT.                    
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4600-READ-K825.                                                          
      *=============================================================            
                                                                                
           MOVE SPACES                       TO WS-K825-NME-OCCP                
           READ BP13K825.                                                       
                                                                                
           IF WS-K825-STATUS = 00 OR 02                                         
              MOVE K825-NME-OCCP             TO WS-K825-NME-OCCP                
           ELSE                                                                 
           IF WS-K825-STATUS = 23                                               
              DISPLAY 'K825 REC NOT FOUND : ' K825-KEY-FLD                      
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K825 = ' WS-K825-STATUS                
                      ', K825-KEY-FLD = ' K825-KEY-FLD                          
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT.                    
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4700-READ-BP13K813.                                                      
      *=============================================================            
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE WS-K813-STATUS                                              
           WHEN '00'                                                            
              MOVE K813-NME-PROJECT-LTR      TO LF69-ESTATE                     
              MOVE K813-TXT-SEL-PERIOD-LTR   TO LF69-DTE-SEL                    
              MOVE K813-NUM-UNIT-OFFER       TO LF69-UNIT-OFFER-A               
                                                LF69-UNIT-OFFER-B               
                                                LF69-UNIT-OFFER-C               
                                                LF69-UNIT-OFFER-D               
                                                                                
              STRING K813-DTE-LETTER-PRINT(7:2) '/'                             
                     K813-DTE-LETTER-PRINT(5:2) '/'                             
                     K813-DTE-LETTER-PRINT(1:4)                                 
              DELIMITED BY SIZE INTO LF69-DATE                                  
                                                                                
              MOVE K813-NME-FLAT-TYPE-LTR    TO LF69-ROOM-NO                    
                                                LF69-ROOM-NO2                   
                                                                                
           WHEN '23'                                                            
              MOVE F740-CDE-NT1              TO LF69-ESTATE                     
              DISPLAY 'RECORD NOT FOUND IN BP13K813, KEY IS '                   
                      '02' F740-CDE-NT1                                         
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'ERROR IN READING BP13K813, STATUS '                      
                      WS-K813-STATUS                                            
           END-EVALUATE.                                                        
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4800-GET-ADDR.                                                           
      *=============================================================            
                                                                                
           MOVE SPACES TO LF69-LINE05                                           
                          LF69-LINE06                                           
                          LF69-LINE07                                           
                          LF69-LINE08.                                          
                                                                                
           MOVE SPACES            TO    K830-KEY-FLD.                           
                                                                                
           MOVE F740-NUM-REF      TO    K830-KEY-FLD.                           
           READ BP13K830.                                                       
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                
                 ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                           
                 (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))               
                 MOVE K830-NUM-BLK         TO LF69-BLK                          
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO LF69-UNIT                         
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO LF69-UNIT                         
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO LF69-ADDR-L2                
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE SPACES            TO LF69-ADDR-L3                      
                    DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL               
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO LF69-ADDR-L3                      
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LF69-BAR-CODE             
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK        TO LF69-BLK                      
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                TO LF69-UNIT                     
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT    TO LF69-UNIT                     
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO LF69-ADDR-L2              
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO LF69-ADDR-L3                  
                    DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL              
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO LF69-ADDR-L3                  
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                                                                                
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LF69-BAR-CODE             
              END-IF                                                            
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              MOVE SPACES TO LF69-LINE05                                        
                             LF69-LINE06                                        
                             LF69-LINE07                                        
                             LF69-LINE08                                        
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                        
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4950-CALL-AV02C015.                                                      
      *=============================================================            
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
                                                                                
       4950-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6000-PRT-BP13WQ.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** 100% of flat supply                                ***                
                                                                                
            ADD   1               TO    WS-LF69I-WRT-CTR.                       
            MOVE  SPACES          TO    LF69I-PRTREC.                           
            MOVE WS-LF69I-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WQ(49:4).                     
            WRITE LF69I-PRTREC    FROM  DJDE-LINE-WQ     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF69I-PRTREC.                           
            WRITE LF69I-PRTREC AFTER PAGE.                                      
            WRITE LF69I-PRTREC    FROM  LF69-LINE01    AFTER 1.                 
            WRITE LF69I-PRTREC    FROM  LF69-LINE02.                            
            WRITE LF69I-PRTREC    FROM  LF69-LINE03    AFTER 5.                 
            WRITE LF69I-PRTREC    FROM  LF69-LINE04.                            
            WRITE LF69I-PRTREC    FROM  LF69-LINE05.                            
            WRITE LF69I-PRTREC    FROM  LF69-LINE06.                            
            WRITE LF69I-PRTREC    FROM  LF69-LINE07.                            
            WRITE LF69I-PRTREC    FROM  LF69-LINE08    AFTER 3.                 
            WRITE LF69I-PRTREC    FROM  LF69-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LF69I-PRTREC    FROM  LF69-LINE8A          AFTER 2.           
            WRITE LF69I-PRTREC    FROM  LF69-LINE8B          AFTER 1.           
            WRITE LF69I-PRTREC    FROM  LF69-LINE10A-NORM    AFTER 2.           
            WRITE LF69I-PRTREC    FROM  LF69-LINE10C-GRO     AFTER 7.           
            WRITE LF69I-PRTREC    FROM  LF69-LINE10E-OFR     AFTER 1.           
            WRITE LF69I-PRTREC    FROM  LF69-LINE10D-DATE    AFTER 2.           
                                                                                
            MOVE SPACES           TO    LF69I-PRTREC                            
                                        DJDE-LINE-WQ(49:4)                      
            WRITE LF69I-PRTREC    FROM  DJDE-BP13W1        AFTER PAGE.          
            MOVE SPACES           TO    LF69I-PRTREC.                           
            WRITE LF69I-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LF69I-PRTREC.                              
            WRITE LF69I-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF69I-PRTREC.                              
            WRITE LF69I-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF69I-PRTREC.                              
            WRITE LF69I-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF69I-PRTREC.                              
            WRITE LF69I-PRTREC    AFTER PAGE.                                   
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6100-PRT-BP13WR.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** 200% of flat supply                                ***                
                                                                                
            ADD   1               TO    WS-LF69L-WRT-CTR.                       
            MOVE  SPACES          TO    LF69L-PRTREC.                           
            MOVE WS-LF69L-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WR(49:4).                     
            WRITE LF69L-PRTREC    FROM  DJDE-LINE-WR     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF69L-PRTREC.                           
            WRITE LF69L-PRTREC AFTER PAGE.                                      
            WRITE LF69L-PRTREC    FROM  LF69-LINE01    AFTER 1.                 
            WRITE LF69L-PRTREC    FROM  LF69-LINE02.                            
            WRITE LF69L-PRTREC    FROM  LF69-LINE03    AFTER 5.                 
            WRITE LF69L-PRTREC    FROM  LF69-LINE04.                            
            WRITE LF69L-PRTREC    FROM  LF69-LINE05.                            
            WRITE LF69L-PRTREC    FROM  LF69-LINE06.                            
            WRITE LF69L-PRTREC    FROM  LF69-LINE07.                            
            WRITE LF69L-PRTREC    FROM  LF69-LINE08    AFTER 3.                 
            WRITE LF69L-PRTREC    FROM  LF69-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LF69L-PRTREC    FROM  LF69-LINE8A          AFTER 2.           
            WRITE LF69L-PRTREC    FROM  LF69-LINE8B          AFTER 1.           
            WRITE LF69L-PRTREC    FROM  LF69-LINE10A-NORM    AFTER 2.           
            WRITE LF69L-PRTREC    FROM  LF69-LINE10A-GRO     AFTER 7.           
            WRITE LF69L-PRTREC    FROM  LF69-LINE10G-OFR     AFTER 1.           
            WRITE LF69L-PRTREC    FROM  LF69-LINE10D-DATE    AFTER 3.           
                                                                                
            MOVE SPACES           TO    LF69L-PRTREC                            
                                        DJDE-LINE-WR(49:4)                      
            WRITE LF69L-PRTREC    FROM  DJDE-BP13W1        AFTER PAGE.          
            MOVE SPACES           TO    LF69L-PRTREC.                           
            WRITE LF69L-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LF69L-PRTREC.                              
            WRITE LF69L-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF69L-PRTREC.                              
            WRITE LF69L-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF69L-PRTREC.                              
            WRITE LF69L-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF69L-PRTREC.                              
            WRITE LF69L-PRTREC    AFTER PAGE.                                   
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6200-PRT-BP13WS.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** 300% of flat supply                                ***                
                                                                                
            ADD   1               TO    WS-LF69M-WRT-CTR.                       
            MOVE  SPACES          TO    LF69M-PRTREC.                           
            MOVE WS-LF69M-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WS(49:4).                     
            WRITE LF69M-PRTREC    FROM  DJDE-LINE-WS     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF69M-PRTREC.                           
            WRITE LF69M-PRTREC AFTER PAGE.                                      
            WRITE LF69M-PRTREC    FROM  LF69-LINE01    AFTER 1.                 
            WRITE LF69M-PRTREC    FROM  LF69-LINE02.                            
            WRITE LF69M-PRTREC    FROM  LF69-LINE03    AFTER 5.                 
            WRITE LF69M-PRTREC    FROM  LF69-LINE04.                            
            WRITE LF69M-PRTREC    FROM  LF69-LINE05.                            
            WRITE LF69M-PRTREC    FROM  LF69-LINE06.                            
            WRITE LF69M-PRTREC    FROM  LF69-LINE07.                            
            WRITE LF69M-PRTREC    FROM  LF69-LINE08    AFTER 3.                 
            WRITE LF69M-PRTREC    FROM  LF69-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LF69M-PRTREC    FROM  LF69-LINE8A          AFTER 2.           
            WRITE LF69M-PRTREC    FROM  LF69-LINE8B          AFTER 1.           
            WRITE LF69M-PRTREC    FROM  LF69-LINE10A-NORM    AFTER 2.           
            WRITE LF69M-PRTREC    FROM  LF69-LINE10B-GRO     AFTER 7.           
            WRITE LF69M-PRTREC    FROM  LF69-LINE10G-OFR     AFTER 1.           
            WRITE LF69M-PRTREC    FROM  LF69-LINE10D-DATE    AFTER 4.           
                                                                                
            MOVE SPACES           TO    LF69M-PRTREC                            
                                        DJDE-LINE-WS(49:4)                      
            WRITE LF69M-PRTREC    FROM  DJDE-BP13W1        AFTER PAGE.          
            MOVE SPACES           TO    LF69M-PRTREC.                           
            WRITE LF69M-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LF69M-PRTREC.                              
            WRITE LF69M-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF69M-PRTREC.                              
            WRITE LF69M-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF69M-PRTREC.                              
            WRITE LF69M-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF69M-PRTREC.                              
            WRITE LF69M-PRTREC    AFTER PAGE.                                   
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6300-PRT-BP13WT.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** > 300% of flat supply                              ***                
                                                                                
            ADD   1               TO    WS-LF69H-WRT-CTR.                       
            MOVE  SPACES          TO    LF69H-PRTREC.                           
            MOVE WS-LF69H-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WT(49:4).                     
            WRITE LF69H-PRTREC    FROM  DJDE-LINE-WT     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF69H-PRTREC.                           
            WRITE LF69H-PRTREC AFTER PAGE.                                      
            WRITE LF69H-PRTREC    FROM  LF69-LINE01    AFTER 1.                 
            WRITE LF69H-PRTREC    FROM  LF69-LINE02.                            
            WRITE LF69H-PRTREC    FROM  LF69-LINE03    AFTER 5.                 
            WRITE LF69H-PRTREC    FROM  LF69-LINE04.                            
            WRITE LF69H-PRTREC    FROM  LF69-LINE05.                            
            WRITE LF69H-PRTREC    FROM  LF69-LINE06.                            
            WRITE LF69H-PRTREC    FROM  LF69-LINE07.                            
            WRITE LF69H-PRTREC    FROM  LF69-LINE08    AFTER 3.                 
            WRITE LF69H-PRTREC    FROM  LF69-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LF69H-PRTREC    FROM  LF69-LINE8A          AFTER 2.           
            WRITE LF69H-PRTREC    FROM  LF69-LINE8B          AFTER 1.           
            WRITE LF69H-PRTREC    FROM  LF69-LINE10A-NORM    AFTER 2.           
            WRITE LF69H-PRTREC    FROM  LF69-LINE10D-DATE    AFTER 10.          
                                                                                
            MOVE SPACES           TO    LF69H-PRTREC                            
                                        DJDE-LINE-WT(49:4)                      
            WRITE LF69H-PRTREC    FROM  DJDE-BP13W9        AFTER PAGE.          
            MOVE SPACES           TO    LF69H-PRTREC.                           
            WRITE LF69H-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LF69H-PRTREC.                              
            WRITE LF69H-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF69H-PRTREC.                              
            WRITE LF69H-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF69H-PRTREC.                              
            WRITE LF69H-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF69H-PRTREC.                              
            WRITE LF69H-PRTREC    AFTER PAGE.                                   
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6500-PRINT-CONTROL-LIST.                                                 
      *=============================================================            
      *    PRINT CONTROL LISTING FOR SUCCESSFUL APPLICANTS                      
      *-------------------------------------------------------------            
                                                                                
           MOVE F740-NUM-REF              TO    LF69A-REF-NO.                   
           MOVE F740-NUM-REGN             TO    LF69A-REGN-NO.                  
           MOVE LF69-NAME                 TO    LF69A-NAME-1.                   
           MOVE F740-NUM-NRIC1            TO    LF69A-NRIC-1.                   
           MOVE F740-CDE-NT1              TO    LF69A-NT1.                      
           MOVE F740-CDE-HOUSEHOLD        TO    LF69A-HHTY.                     
           MOVE F740-NUM-MCPS             TO    LF69A-MCPS.                     
           MOVE F740-CDE-RESIDENT-HA1     TO    LF69A-RES-HA1.                  
           MOVE F740-CDE-FLAT-TYPE        TO    LF69A-FLAT.                     
           MOVE F740-CDE-ALLOC-SCH        TO    LF69A-ALLOC.                    
           MOVE F740-CDE-UNSUCC           TO    LF69A-UNSUCC.                   
           MOVE F740-CDE-CATEGORY         TO    LF69A-CAT.                      
           MOVE F740-CDE-SUCC-NT-ZONE     TO    LF69A-SUCC.                     
           MOVE F740-CDE-ZONE             TO    LF69A-ZONE.                     
           MOVE LF69-NAME2                TO    LF69A-NAME-2.                   
           IF F740-NUM-NRIC2 (2:1) NOT = '#'                                    
              MOVE F740-NUM-NRIC2         TO    LF69A-NRIC-2                    
           ELSE                                                                 
              MOVE SPACES                 TO    LF69A-NRIC-2.                   
           MOVE F740-NUM-NT-FT-QUEUE      TO    LF69A-QUEUE.                    
           MOVE F740-NUM-BALLOT-POSITION  TO    LF69A-BALLOT-POS.               
           MOVE F740-NUM-LOAN-TAG         TO    LF69A-LOAN-TAG.                 
           MOVE F740-CDE-REQUEST-STATUS   TO    LF69A-REQ-STATUS.               
                                                                                
      *-----------> PREPARE ADDRESS FOR P13LB88A CONTROL LIST                   
           MOVE SPACES                    TO    LF69A-DTL-3.                    
           MOVE LF69-BLK                  TO    LF69A-BLK.                      
           MOVE LF69-UNIT                 TO    LF69A-UNIT.                     
           MOVE LF69-ADDR-L2              TO    LF69A-ADDR2.                    
           MOVE LF69-ADDR-L3              TO    LF69A-ADDR3.                    
           MOVE LF69-ADDR-L3              TO    LF69A-ADDR3.                    
                                                                                
      * BP133380                                                                
           IF F740-CDE-REQUEST-STATUS = 'U'                                     
              PERFORM 6700-PRINT-CONTROL-UNSUCC THRU 6700-EXIT                  
           ELSE                                                                 
              PERFORM 6600-PRINT-CONTROL-SUCC   THRU 6600-EXIT                  
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6600-PRINT-CONTROL-SUCC.                                                 
      **************************************************************            
                                                                                
           MOVE 'P13LF69C'             TO LF69A-LISTING.                        
           STRING 'CONTROL LIST FOR SUCCESSFUL LETTERS W/O EMAIL '              
                  'ADDRESSES (APPLICATION WITHIN 300%)'                         
                  DELIMITED BY SIZE  INTO LF69A-LISTING-TYPE.                   
           ADD    1                    TO    WS-CNT-LETTERS-SUCC.               
           MOVE   WS-CNT-LETTERS-SUCC  TO    LF69A-SERIAL-NO.                   
                                                                                
           IF WS-CNT-LINE-LF69C > WS2-MAX-LINES-LF69C                           
              ADD   1                  TO   WS-CNT-PAGE-LF69C                   
              MOVE  1                  TO   WS-CNT-LINE-LF69C                   
              MOVE  WS-CNT-PAGE-LF69C  TO   LF69A-PAGE                          
              WRITE LF69C-PRTREC       FROM LF69A-HDG1 AFTER PAGE               
                                                                                
              WRITE LF69C-PRTREC       FROM LF69A-HDG2 AFTER 1                  
              WRITE LF69C-PRTREC       FROM LF69A-HDG4 AFTER 2                  
              WRITE LF69C-PRTREC       FROM LF69A-HDG5 AFTER 1                  
              WRITE LF69C-PRTREC       FROM LF69A-HDG6 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LF69C-PRTREC                        
              WRITE LF69C-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   LF69C-PRTREC         FROM  LF69A-DTL-1 AFTER 1.              
           WRITE   LF69C-PRTREC         FROM  LF69A-DTL-2 AFTER 1.              
           WRITE   LF69C-PRTREC         FROM  LF69A-DTL-3 AFTER 1.              
           WRITE   LF69C-PRTREC         FROM  LF69A-DTL-4 AFTER 1.              
           MOVE    SPACES               TO    LF69C-PRTREC.                     
           WRITE   LF69C-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-LF69C.                
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6700-PRINT-CONTROL-UNSUCC.                                               
      **************************************************************            
                                                                                
           MOVE 'P13LF69D'             TO LF69A-LISTING.                        
           STRING 'CONTROL LIST FOR UNSUCCESSFUL LETTERS W/O EMAIL '            
                  'ADDRESSES (APPLICATION BEYOND 300%)'                         
                  DELIMITED BY SIZE  INTO LF69A-LISTING-TYPE.                   
           ADD    1                    TO    WS-CNT-LETTERS-UNSUCC.             
           MOVE   WS-CNT-LETTERS-UNSUCC  TO    LF69A-SERIAL-NO.                 
                                                                                
           IF WS-CNT-LINE-LF69D > WS2-MAX-LINES-LF69D                           
              ADD   1                  TO   WS-CNT-PAGE-LF69D                   
              MOVE  1                  TO   WS-CNT-LINE-LF69D                   
              MOVE  WS-CNT-PAGE-LF69D  TO   LF69A-PAGE                          
              WRITE LF69D-PRTREC       FROM LF69A-HDG1 AFTER PAGE               
                                                                                
              WRITE LF69D-PRTREC       FROM LF69A-HDG2 AFTER 1                  
              WRITE LF69D-PRTREC       FROM LF69A-HDG4 AFTER 2                  
              WRITE LF69D-PRTREC       FROM LF69A-HDG5 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LF69D-PRTREC                        
              WRITE LF69D-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   LF69D-PRTREC         FROM  LF69A-DTL-1 AFTER 1.              
           WRITE   LF69D-PRTREC         FROM  LF69A-DTL-2 AFTER 1.              
           WRITE   LF69D-PRTREC         FROM  LF69A-DTL-3 AFTER 1.              
           MOVE    SPACES               TO    LF69D-PRTREC.                     
           WRITE   LF69D-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-LF69D.                
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7000-CHECK-SCH.                                                          
      **************************************************************            
                                                                                
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
               AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                            
             WHEN F740-CDE-ALLOC-SCH = WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)          
             MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO WS-ALLOCSCH-TYPE.             
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **************************************************************            
       7300-READ-K740.                                                          
      **************************************************************            
                                                                                
           MOVE SPACES                       TO K740-KEY-FLD.                   
           MOVE F740-KEY-FLD                 TO K740-KEY-FLD.                   
           MOVE 'G'                          TO K740-KEY-FLD(28:1).             
                                                                                
           READ BP13K740.                                                       
                                                                                
           EVALUATE WS-K740-STATUS                                              
           WHEN ZEROES                                                          
              MOVE K740-NUM-NT-FT-QUEUE      TO LF69-QUEUE-NO1-GRO              
                                                LF69-QUEUE-NO2-GRO              
                                                LF69-QUEUE-NO3-GRO              
                                                LF69-QUEUE-NO4-GRO              
                                                                                
           WHEN 23                                                              
              DISPLAY 'KEY NOT FOUND' K740-KEY-FLD                              
                                                                                
           WHEN OTHER                                                           
              MOVE WS-K740-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       7300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13CF69 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F740 RECORDS READ          : ' WS-F740-READ-CTR.           
           DISPLAY ' NON-SA WITHIN 100% (BP13WQ): ' WS-LF69I-WRT-CTR.           
           DISPLAY ' NON-SA WITHIN 200% (BP13WR): ' WS-LF69L-WRT-CTR.           
           DISPLAY ' NON-SA WITHIN 300% (BP13WS): ' WS-LF69M-WRT-CTR.           
           DISPLAY ' NON-SA BEYOND 300% (BP13WT): ' WS-LF69H-WRT-CTR.           
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13F740                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 BP13K813                                                       
                 BP13K740                                                       
                 P13LF69C                                                       
                 P13LF69D                                                       
                 P13LF69H                                                       
                 P13LF69I                                                       
                 P13LF69L                                                       
                 P13LF69M.                                                      
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING ERROR BP13K825-STAT ' WS-K825-STATUS             
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS             
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING ERROR BP13K813-STAT ' WS-K813-STATUS             
           END-IF.                                                              
                                                                                
           IF WS-K740-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING ERROR BP13K740-STAT ' WS-K740-STATUS             
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
