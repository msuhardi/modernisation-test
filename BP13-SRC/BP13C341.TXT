      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C341.                                                 
      *AUTHOR.        JAI.                                                      
      *DATE-WRITTEN.  29/04/95.                                                 
                                                                                
      *========================================================*                
      *              SYSTEM OF COMMITMENT (BP13)               *                
      *========================================================*                
      *    OBJECTIVE :                                         *                
      *      1.  THIS IS A PROGRAM TO PRINT LETTERS.           *                
      *          LIST AFTER SIGNING SALES AGREEMENT.           *                
      *      2.  FOR CASES WHERE ALREADY SOCA AND HAS OPTED    *                
      *          NOT TO HAVE DOORS INSTALLED.                  *                
      *                                                        *                
      *     INPUT FILES:                                       *                
      *      1. SORTED BP13K310 "RZ"                           *                
      *      2. BM06K110                                       *                
      *      3. BP13K820                                       *                
      *      4. BM06K100                                       *                
      *     OUTPUT FILE :                                      *                
      *      1. BP13L341                                       *                
      *      2. BP13P341                                       *                
      *                                                        *                
      *     LISTING:                                           *                
      *     1. CONTROL LISTING (BP13L341)                      *                
      *     2. LETTERS         (BP13P341)                      *                
      * CHG REF  BY  DATE   DESCRIPTION                        *                
      * -------- --- ------ -----------                        *                
      * C950642  EG1 950721 ADDED OCS-TAG CHK BEFORE PROCESS   *                
      * SOC 8G   SSS 960304 REMOVE DISPLAY STATEMENT FOR K110  *                
      * BP130418 SIA 980309 CHGE BM06K211 TO BM06K110,         *                
      *                     CHGE BM06K210 TO BM06K100          *                
      * BP130488 LMS 981021 TO CATER FOR OCS AT BOOKING.       *                
      * BP132127 CKK 020603 TO CHANGE LETTER LAYOUT            *                
      **********************************************************                
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT BP13F310 ASSIGN TO BP13F310.                                  
                                                                                
           SELECT BM06K110 ASSIGN TO BM06K110                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K110-KEY-FLD                               
                  FILE STATUS     IS BM06K110-STATUS.                           
                                                                                
           SELECT BM06K100 ASSIGN TO BM06K100                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K100-KEY-FLD                               
                  FILE STATUS     IS BM06K100-STATUS.                           
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K800-NUM-REGN                              
                  FILE STATUS     IS BP13K800-STATUS.                           
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD                               
                  FILE STATUS     IS BP13K820-STATUS.                           
                                                                                
           SELECT BP13L341 ASSIGN TO BP13L341.                                  
                                                                                
           SELECT BP13P341 ASSIGN TO BP13P341.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F310                                                            
            BLOCK CONTAINS  0   RECORDS                                         
            RECORD CONTAINS 150 CHARACTERS                                      
            RECORDING MODE IS F.                                                
       COPY BP13F310.                                                           
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD  BP13L341                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  L341-PRINT-REC                  PIC X(132).                          
                                                                                
       FD  BP13P341                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P341-PRINT-REC                  PIC X(80).                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
       01  WS1-FILE-ACCESS-STATUS.                                              
           05 BM06K100-STATUS              PIC 9(02) VALUE ZEROS.               
           05 BM06K110-STATUS              PIC 9(02) VALUE ZEROS.               
           05 BP13K800-STATUS              PIC 9(02) VALUE ZEROS.               
           05 BP13K820-STATUS              PIC 9(02) VALUE ZEROS.               
                                                                                
       01  WS2-COUNTERS.                                                        
           05 WS2-CNT-F310-READ            PIC 9(03) VALUE ZEROS.               
           05 WS2-CNT-K110-READ            PIC 9(03) VALUE ZEROS.               
           05 WS2-CNT-K820-READ            PIC 9(03) VALUE ZEROS.               
           05 WS2-CNT-L341-WRITE           PIC 9(03) VALUE ZEROS.               
           05 WS2-CNT-P341-WRITE           PIC 9(03) VALUE ZEROS.               
           05 WS2-CNT-PRINT-L341           PIC 9(04) VALUE ZEROS.               
           05 WS2-CNT-PRINT-P341           PIC 9(04) VALUE ZEROS.               
           05 WS2-CNT-LINE-ON-PAGE         PIC 9(02) VALUE 66.                  
           05 WS2-CNT-NO-PAGE              PIC 9(05) VALUE ZEROS.               
                                                                                
       01  WS4-SWITCHES.                                                        
           05 WS4-F310-EOF-IND             PIC X(01) VALUE 'N'.                 
              88 WS4-F310-EOF                  VALUE 'Y'.                       
                                                                                
       01  WS5-DATES-VARIABLES.                                                 
           05  WS5-DATE.                                                        
               10 WS5-CC                   PIC 9(02).                           
               10 WS5-YY                   PIC 9(02).                           
               10 WS5-MM                   PIC 9(02).                           
               10 WS5-DD                   PIC 9(02).                           
           05  WS5-PRT-DATE.                                                    
               10 WS5-PRT-DD               PIC 9(02).                           
               10 FILLER                   PIC X(01) VALUE '/'.                 
               10 WS5-PRT-MM               PIC 9(02).                           
               10 FILLER                   PIC X(01) VALUE '/'.                 
               10 WS5-PRT-CC               PIC 9(02).                           
               10 WS5-PRT-YY               PIC 9(02).                           
           05  WS5-CURRENT-DATE.                                                
               10 WS5-CUR-CC               PIC 9(02).                           
               10 WS5-CUR-YY               PIC 9(02).                           
               10 WS5-CUR-MM               PIC 9(02).                           
               10 WS5-CUR-DD               PIC 9(02).                           
           05  WS5-SYSTEM-DATE.                                                 
               10 WS5-SYS-DD               PIC 9(02).                           
               10 FILLER                   PIC X(01) VALUE '/'.                 
               10 WS5-SYS-MM               PIC 9(02).                           
               10 FILLER                   PIC X(01) VALUE '/'.                 
               10 WS5-SYS-CC               PIC 9(02).                           
               10 WS5-SYS-YY               PIC 9(02).                           
                                                                                
       01  WS6-DEFAULT-VALUES.                                                  
           05 WS6-DEF-DUP-LEASE            PIC 9(02) VALUE 2.                   
           05 WS6-MAX-LINES                PIC 9(02) VALUE 60.                  
                                                                                
       01  WS7-SCH-ACC.                                                         
           05 WS7-SCH-1-4                  PIC X(04).                           
           05 WS7-SCH-5-8                  PIC X(04).                           
           05 WS7-SCH-9-9                  PIC X(01).                           
           05 WS7-SCH-10-11                PIC X(02).                           
                                                                                
       01  DJDE-LETTER-AGR                 PIC X(80) VALUE                      
           '$DJDE$ FORMS=BP1332,DUPLEX=NO,END;'.                                
                                                                                
       01  P341-LINE1.                                                          
           05 FILLER                       PIC X(61) VALUE SPACES.              
           05 P341-DATE                    PIC X(10) VALUE SPACES.              
                                                                                
       01  P341-LINE2-AGR.                                                      
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 FILLER                       PIC X(08) VALUE 'TO    : '.          
           05 FILLER                       PIC X(05) VALUE 'HBO ('.             
           05 P341-HBO-AGR                 PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(01) VALUE ')'.                 
                                                                                
       01  P341-LINE3.                                                          
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 FILLER                       PIC X(50) VALUE                      
             'INSTALLATION OF COMPONENTS FOR COMPLETED FLATS'.                  
                                                                                
       01  P341-LINE4.                                                          
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 FILLER                       PIC X(08) VALUE 'APT BLK '.          
           05 P341-BLK-NO                  PIC X(05).                           
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 P341-STREET                  PIC X(20).                           
           05 FILLER                       PIC X(01) VALUE SPACES.              
                                                                                
       01  P341-LINE5.                                                          
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 P341-FLAT-NO.                                                     
              10 FILLER                    PIC X(01) VALUE '#'.                 
              10 P341-LEVEL-NO             PIC X(02).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 P341-UNIT-NO              PIC X(04).                           
                                                                                
       01  P341-LINE6.                                                          
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 FILLER                       PIC X(15) VALUE                      
             'ACCOUNT NO   : '.                                                 
           05 P341-SCH-ACC.                                                     
              10 P341-SCH-1-4              PIC X(04).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 P341-SCH-5-8              PIC X(04).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 P341-SCH-9-9              PIC X(01).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 P341-SCH-10-11            PIC X(02).                           
                                                                                
       01  P341-LINE7.                                                          
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05 P341-INST-ITEM-DESC          PIC X(40) VALUE SPACES.              
           05 FILLER                       PIC X(29) VALUE SPACES.              
                                                                                
       01  P341-LINE8-AGR.                                                      
           05 FILLER                       PIC X(16) VALUE SPACES.              
           05 P341-CHRGE-ACC-AGR           PIC X(58) VALUE SPACES.              
           05 FILLER                       PIC X(06) VALUE SPACES.              
                                                                                
       01  P341-LINE10.                                                         
           05 FILLER                       PIC X(04) VALUE SPACES.              
           05 FILLER                       PIC X(04) VALUE 'CC: '.              
           05 FILLER                       PIC X(25)                            
              VALUE 'ACCT  BILLY HU'.                                           
                                                                                
       01  P341-LINE11.                                                         
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 FILLER                       PIC X(25)                            
              VALUE 'MA & B  UNIT'.                                             
                                                                                
       01  P341-LINE12.                                                         
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 FILLER                       PIC X(25)                            
              VALUE 'ADM & ACCOUNTING SECTION'.                                 
                                                                                
       01  P341-LINE13.                                                         
           05 FILLER                       PIC X(04) VALUE SPACES.              
           05 FILLER                       PIC X(04) VALUE 'CC: '.              
           05 P341-NEW-TOWN                PIC X(03) VALUE SPACES.              
           05 FILLER                       PIC X(01) VALUE '/'.                 
           05 P341-FLAT-TYPE               PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(01) VALUE '/'.                 
           05 P341-REGN-NO                 PIC X(08) VALUE SPACES.              
                                                                                
       01  P341-LINE14.                                                         
           05 FILLER                       PIC X(08) VALUE SPACES.              
           05 P341-OIC                     PIC X(30) VALUE SPACES.              
                                                                                
       01  L341-PRT-HEAD-01.                                                    
           05 L341-HEADER                  PIC X(14) VALUE SPACES.              
           05 FILLER                       PIC X(08) VALUE 'HDB3    '.          
           05 FILLER                       PIC X(25) VALUE SPACES.              
           05 FILLER                       PIC X(39) VALUE                      
             'S Y S T E M   O F   C O M M I T M E N T'.                         
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05 FILLER                       PIC X(07) VALUE 'DATE: '.            
           05 L341-PRINT-DATE              PIC X(10) VALUE SPACES.              
           05 FILLER                       PIC X(03) VALUE SPACES.              
           05 FILLER                       PIC X(07) VALUE 'PAGE: '.            
           05 L341-PRINT-PAGE              PIC ZZZZ9.                           
                                                                                
       01  L341-PRT-HEAD-02-AGR.                                                
           05 FILLER                       PIC X(36) VALUE SPACES.              
           05 FILLER                       PIC X(40) VALUE                      
             'CONTROL LIST OF LETTERS TO INFORM BO OF '.                        
           05 FILLER                       PIC X(18) VALUE                      
             'REJECTED OCS UNITS'.                                              
           05 FILLER                       PIC X(05) VALUE SPACES.              
           05 FILLER                       PIC X(30) VALUE                      
             'USER : AGREEMENT TEAM'.                                           
                                                                                
       01  L341-PRT-HEAD-03.                                                    
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 FILLER                       PIC X(03) VALUE 'NO.'.               
           05 FILLER                       PIC X(03) VALUE SPACES.              
           05 FILLER                       PIC X(07) VALUE 'REGN-NO'.           
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(04) VALUE 'FLAT'.              
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(15) VALUE                      
             'NAME(TRUNCATED)'.                                                 
           05 FILLER                       PIC X(07) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE                      
             'SCH-ACCT-NO'.                                                     
           05 FILLER                       PIC X(04) VALUE SPACES.              
           05 FILLER                       PIC X(03) VALUE 'BLK'.               
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE                      
             'STREET NAME'.                                                     
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(07) VALUE 'UNIT NO'.           
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(06) VALUE 'REJECT'.            
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 L341-HEADER-A                PIC X(07) VALUE '  ALLOC'.           
           05 L341-HEADER-B                PIC X(06) VALUE ' ALLOC'.            
           05 L341-HEADER-FLEXI-PRICE.                                          
              10 L341-HEADER-1             PIC X(05) VALUE SPACES.              
              10 L341-SPACE1               PIC X(04) VALUE SPACES.              
              10 L341-HEADER-2             PIC X(06) VALUE SPACES.              
           05 L341-HEADER-REMARKS REDEFINES L341-HEADER-FLEXI-PRICE.            
              10 FILLER                    PIC X(15).                           
                                                                                
       01  L341-PRT-HEAD-04.                                                    
           05 FILLER                       PIC X(16) VALUE SPACES.              
           05 FILLER                       PIC X(04) VALUE 'TYPE'.              
           05 FILLER                       PIC X(75) VALUE SPACES.              
           05 FILLER                       PIC X(04) VALUE 'DATE'.              
           05 FILLER                       PIC X(03) VALUE SPACES.              
           05 L341-HEADER-AA               PIC X(06) VALUE '  TYPE'.            
           05 L341-HEADER-BA               PIC X(06) VALUE '   SCH'.            
           05 L341-HEADER-1A               PIC X(05) VALUE SPACES.              
           05 FILLER                       PIC X(04) VALUE SPACES.              
           05 L341-HEADER-2A               PIC X(03) VALUE SPACES.              
                                                                                
       01  L341-PRT-DETAIL.                                                     
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 L341-NO                      PIC ZZZ9.                            
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 L341-REG                     PIC X(08).                           
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 L341-FLAT-TYPE               PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 L341-NAME                    PIC X(22).                           
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 L341-SCH-ACC.                                                     
              10 L341-SCH-1-4              PIC X(04).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 L341-SCH-5-8              PIC X(04).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 L341-SCH-9-9              PIC X(01).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 L341-SCH-10-11            PIC X(02).                           
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 L341-BLK-NO                  PIC X(05).                           
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 L341-STREET                  PIC X(20).                           
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 L341-FLAT-NO.                                                     
              10 FILLER                    PIC X(01) VALUE '#'.                 
              10 L341-LEVEL-NO             PIC X(02).                           
              10 FILLER                    PIC X(01) VALUE '-'.                 
              10 L341-UNIT-NO              PIC X(04).                           
           05 FILLER                       PIC X(01) VALUE SPACES.              
           05 L341-REJECT-DATE             PIC X(10) VALUE SPACES.              
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 L341-ALLOC-TYPE              PIC X(01) VALUE SPACES.              
           05 FILLER                       PIC X(03) VALUE SPACES.              
           05 L341-ALLOC-SCH               PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 L341-FLEXI-PRICE.                                                 
              10 L341-FLEXI-DUE            PIC X(10) VALUE SPACES.              
              10 FILLER                    PIC X(01) VALUE SPACES.              
              10 L341-COMP-PR              PIC ZZZZ99 VALUE ZEROS.              
              10 L341-COMP-PR-D REDEFINES L341-COMP-PR.                         
                 15 L341-COMP-PR-CHAR      PIC X(06).                           
           05 L341-REMARKS REDEFINES L341-FLEXI-PRICE.                          
               10 L341-REM                 PIC X(17).                           
                                                                                
                                                                                
      *-------------------------------------------------------------            
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       MAIN-ROUTINE SECTION.                                                    
      *-------------------------------------------------------------            
           PERFORM 100-OPEN-FILES.                                              
           PERFORM 200-MAIN-ROUTINE THRU 200-EXIT UNTIL WS4-F310-EOF.           
           PERFORM 500-CLOSE-ROUTINE.                                           
                                                                                
       MAIN-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       100-OPEN-FILES.                                                          
      *-------------------------------------------------------------            
           OPEN INPUT  BP13F310                                                 
                       BM06K100                                                 
                       BM06K110                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                OUTPUT BP13L341                                                 
                       BP13P341.                                                
                                                                                
           IF BM06K100-STATUS NOT = 0 AND NOT = 97                              
              DISPLAY ' OPENING ERROR,BM06K100-STATUS ' BM06K100-STATUS         
              MOVE BM06K100-STATUS TO RETURN-CODE                               
              PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                           
           END-IF.                                                              
                                                                                
           IF BM06K110-STATUS NOT = 0 AND NOT = 97                              
              DISPLAY ' OPENING ERROR,BM06K110-STATUS ' BM06K110-STATUS         
              MOVE BM06K110-STATUS TO RETURN-CODE                               
              PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K800-STATUS NOT = 0 AND NOT = 97                              
              DISPLAY ' OPENING ERROR, BP13K800-STATUS ' BP13K800-STATUS        
              MOVE BP13K800-STATUS TO RETURN-CODE                               
              PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K820-STATUS NOT = 0 AND NOT = 97                              
              DISPLAY ' OPENING ERROR, BP13K820-STATUS ' BP13K820-STATUS        
              MOVE BP13K820-STATUS TO RETURN-CODE                               
              PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                           
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS5-CURRENT-DATE.                      
           MOVE WS5-CUR-DD            TO WS5-SYS-DD.                            
           MOVE WS5-CUR-MM            TO WS5-SYS-MM.                            
           MOVE WS5-CUR-CC            TO WS5-SYS-CC.                            
           MOVE WS5-CUR-YY            TO WS5-SYS-YY.                            
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       200-MAIN-ROUTINE.                                                        
      *-------------------------------------------------------------            
      *   1. READ FILE BP13F310.                                   *            
      *   2. MOVE F310-SCH-ACC TO K110-KEY-FLD.                    *            
      *   3. READ BM06K110 TO RETRIEVE NECESSARY DETAILS.          *            
      *   4. READ BP13K820 TO RETRIEVE APPLICANT NAME.             *            
      *   5. PRINT LIST OF REJECTION AFTER SIGNING SALES AGREEMENT *            
      **************************************************************            
           READ BP13F310                                                        
                AT END MOVE 'Y' TO WS4-F310-EOF-IND                             
                GO TO 200-EXIT                                                  
                END-READ.                                                       
           ADD  1                         TO WS2-CNT-F310-READ.                 
                                                                                
           IF F310-CDE-OCS-TAG NOT = 'N'                                        
                GO TO 200-EXIT.                                                 
                                                                                
           MOVE F310-SCH-ACC              TO WS7-SCH-ACC.                       
           MOVE WS7-SCH-1-4               TO L341-SCH-1-4                       
                                             P341-SCH-1-4.                      
           MOVE WS7-SCH-5-8               TO L341-SCH-5-8                       
                                             P341-SCH-5-8.                      
           MOVE WS7-SCH-9-9               TO L341-SCH-9-9                       
                                             P341-SCH-9-9.                      
           MOVE WS7-SCH-10-11             TO L341-SCH-10-11                     
                                             P341-SCH-10-11.                    
           MOVE F310-REGN-NO              TO L341-REG                           
                                             P341-REGN-NO.                      
           MOVE SPACES                    TO L341-BLK-NO.                       
           MOVE SPACES                    TO L341-STREET.                       
           MOVE SPACES                    TO L341-UNIT-NO.                      
           MOVE SPACES                    TO L341-LEVEL-NO.                     
           MOVE SPACES                    TO L341-FLAT-TYPE.                    
           MOVE SPACES                    TO L341-REJECT-DATE.                  
           MOVE SPACES                    TO L341-ALLOC-TYPE.                   
           MOVE SPACES                    TO L341-ALLOC-SCH.                    
           MOVE SPACES                    TO L341-FLEXI-DUE.                    
           MOVE SPACES                    TO L341-COMP-PR-D                     
                                                                                
           MOVE F310-SCH-ACC              TO K110-KEY-FLD.                      
           PERFORM 210-READ-BM06K110      THRU 210-EXIT.                        
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       210-READ-BM06K110.                                                       
      *-------------------------------------------------------------            
      *  READ K110 FLAT INVENTORY TO GET FLAT'S DETAILS        *                
      **********************************************************                
           READ BM06K110.                                                       
                                                                                
           EVALUATE BM06K110-STATUS                                             
               WHEN 00                                                          
                    ADD  1                   TO WS2-CNT-K110-READ               
                    MOVE F310-NUM-BLK        TO L341-BLK-NO                     
                                                P341-BLK-NO                     
                    MOVE F310-NME-STREET     TO L341-STREET                     
                                                P341-STREET                     
                    MOVE F310-NUM-MAIN       TO L341-UNIT-NO                    
                                                P341-UNIT-NO                    
                    MOVE F310-NUM-LEVEL      TO L341-LEVEL-NO                   
                                                P341-LEVEL-NO                   
                    MOVE F310-CDE-FLAT-TYPE  TO L341-FLAT-TYPE                  
                                                P341-FLAT-TYPE                  
                    MOVE F310-CDE-NT         TO P341-NEW-TOWN                   
                    MOVE WS5-SYSTEM-DATE     TO P341-DATE                       
                    MOVE F310-DTE-DD         TO WS5-PRT-DD                      
                    MOVE F310-DTE-MM         TO WS5-PRT-MM                      
                    MOVE F310-DTE-CC         TO WS5-PRT-CC                      
                    MOVE F310-DTE-YY         TO WS5-PRT-YY                      
                    MOVE WS5-PRT-DATE        TO L341-REJECT-DATE                
                    MOVE K110-ALLOCN-TYPE    TO L341-ALLOC-TYPE                 
                    MOVE K110-ALLOC-SCH      TO L341-ALLOC-SCH                  
                    MOVE K110-COLOUR-SCHEME  TO L341-ALLOC-TYPE                 
                    MOVE K110-NUM-BEDROOM    TO L341-ALLOC-SCH                  
                    MOVE K110-CURR-SELLING-PRICE                                
                                             TO L341-COMP-PR                    
                    MOVE K110-AIX1           TO K100-KEY-FLD                    
                    PERFORM 220-READ-BM06K100-BLOCK THRU 220-EXIT               
               WHEN 23                                                          
                    MOVE 'RECORD NOT FOUND IN FIS' TO L341-STREET               
                    PERFORM 300-PRINT THRU 300-EXIT                             
               WHEN OTHER                                                       
                    DISPLAY ' ERROR READING, BM06K110' BM06K110-STATUS          
                    MOVE BM06K110-STATUS TO RETURN-CODE                         
                    PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       210-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------------------------------------------*            
      *  215-CHECK-PRICE-CHANGE IS USED FOR REJECTION OF FLAT                   
      *  IN 718 N4 RC3 ONLY. SOME FLATS UNDER THIS CONTRACT WERE                
      *  SOLD AT A PRICE BASED ON WRONGLY COMPUTED FLOOR AREA.                  
      *  SELLING PRICE NEEDS TO BE REVISED ACCORDINGLY.                         
      *------------------------------------------------------------*            
      *-------------------------------------------------------------            
       215-CHECK-PRICE-CHANGE.                                                  
      *-------------------------------------------------------------            
              IF (K110-ESTATE = '718' AND                                       
                  K110-NEIGHBOURHOOD = 'N4  ' AND                               
                  K110-CONTRACT-NO = 'RC3 ')                                    
                 MOVE 'PRICE CHG   ' TO L341-REMARKS                            
              ELSE                                                              
                 MOVE SPACES         TO L341-REMARKS                            
              END-IF.                                                           
                                                                                
       215-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       220-READ-BM06K100-BLOCK.                                                 
      *-------------------------------------------------------------            
           READ BM06K100.                                                       
                                                                                
           EVALUATE BM06K100-STATUS                                             
               WHEN 00                                                          
                                                                                
                    MOVE K100-DTE-OCS-DUE  TO WS5-DATE                          
                    MOVE WS5-CC            TO WS5-PRT-CC                        
                    MOVE WS5-YY            TO WS5-PRT-YY                        
                    MOVE WS5-MM            TO WS5-PRT-MM                        
                    MOVE WS5-DD            TO WS5-PRT-DD                        
                    MOVE WS5-PRT-DATE      TO L341-FLEXI-DUE                    
                    EVALUATE K100-NUM-OCS-TYPE                                  
                    WHEN     ' '                                                
                        STRING 'KITCHEN SINK AND INTERNAL TIMBER DOORS.'        
                        DELIMITED BY SIZE INTO P341-INST-ITEM-DESC              
                    WHEN     '1'                                                
                        STRING ' INTERNAL TIMBER DOORS.                '        
                        DELIMITED BY SIZE INTO P341-INST-ITEM-DESC              
                    WHEN     'D'                                                
                        STRING ' INTERNAL TIMBER DOORS.                '        
                        DELIMITED BY SIZE INTO P341-INST-ITEM-DESC              
                    WHEN   OTHER                                                
                        MOVE 'OCS TAG DATA ERROR'       TO L341-REMARKS         
                        PERFORM 300-PRINT THRU 300-EXIT                         
                    END-EVALUATE                                                
                    PERFORM 250-READ-BP13K820 THRU 250-EXIT                     
               WHEN 23                                                          
                    MOVE SPACES TO L341-FLEXI-DUE                               
                    MOVE 'ESTATE,NEIGHBOURHOOD NOT FND' TO L341-REMARKS         
                    PERFORM 300-PRINT THRU 300-EXIT                             
               WHEN OTHER                                                       
                    DISPLAY ' ERROR READING, BM06K100' BM06K100-STATUS          
                    MOVE BM06K100-STATUS TO RETURN-CODE                         
                    PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       220-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       250-READ-BP13K820.                                                       
      *-------------------------------------------------------------            
      *  READ K820 OCCUPIER FILE TO GET NAME OF APPLICANT      *                
      **********************************************************                
           MOVE F310-REGN-NO            TO K800-NUM-REGN.                       
                                                                                
           READ BP13K800.                                                       
                                                                                
           EVALUATE BP13K800-STATUS                                             
             WHEN 00                                                            
               MOVE F310-REGN-NO   TO K820-NUM-REGN                             
               MOVE K800-NUM-NRIC1 TO K820-NUM-NRIC                             
                                                                                
               READ BP13K820                                                    
                                                                                
               EVALUATE BP13K820-STATUS                                         
                 WHEN 00                                                        
                   EVALUATE K800-NUM-ROOM                                       
                      WHEN '1'                                                  
                      WHEN '2'                                                  
                      WHEN '3'                                                  
                      WHEN '4'                                                  
                      WHEN '5'                                                  
                        STRING                                                  
                           'MA & B UNDER JOB CODE 0650, '                       
                             DELIMITED  BY  SIZE                                
                           'GL A/C NO. 0-00-00-00-20-3507.'                     
                             DELIMITED  BY  SIZE                                
                            INTO P341-CHRGE-ACC-AGR                             
                      WHEN 'E'                                                  
                          STRING                                                
                            'MA & B UNDER JOB CODE 0715, '                      
                             DELIMITED  BY  SIZE                                
                            'GL A/C NO. 8-20-23-00-40-7136.'                    
                             DELIMITED  BY  SIZE                                
                             INTO P341-CHRGE-ACC-AGR                            
                      WHEN OTHER                                                
                           MOVE 'INVALID ROOM-TYPE.' TO L341-REMARKS            
                           PERFORM 300-PRINT THRU 300-EXIT                      
                   END-EVALUATE                                                 
                   MOVE K820-NME-OCCP  TO L341-NAME                             
                   MOVE F310-CDE-BO    TO P341-HBO-AGR                          
                   MOVE 'MRS YEO-SOH LAY MUI' TO P341-OIC                       
                   ADD  1              TO WS2-CNT-K820-READ                     
                        PERFORM 300-PRINT        THRU 300-EXIT                  
                        PERFORM 400-PRINT-LETTER THRU 400-EXIT                  
                 WHEN 23                                                        
                    MOVE SPACES               TO L341-NAME                      
                    MOVE 'OCCUPIER NOT FOUND' TO L341-REMARKS                   
                    PERFORM 300-PRINT THRU 300-EXIT                             
                 WHEN OTHER                                                     
                   DISPLAY ' ERROR READING, BP13K820'                           
                                 BP13K820-STATUS                                
                   MOVE BP13K820-STATUS TO RETURN-CODE                          
                   PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                      
               END-EVALUATE                                                     
              WHEN 23                                                           
                MOVE 'RECORD NOT IN SOC MASTER' TO L341-REMARKS                 
                PERFORM 300-PRINT THRU 300-EXIT                                 
              WHEN OTHER                                                        
                DISPLAY ' ERROR READING, BP13K800' BP13K800-STATUS              
                MOVE BP13K800-STATUS TO RETURN-CODE                             
                PERFORM 500-CLOSE-ROUTINE THRU 500-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       250-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       300-PRINT.                                                               
      *-------------------------------------------------------------            
           IF WS2-CNT-LINE-ON-PAGE > WS6-MAX-LINES                              
              PERFORM 320-PRINT-HEADING THRU 320-EXIT                           
           END-IF.                                                              
                                                                                
           ADD 1  TO WS2-CNT-PRINT-L341                                         
                     WS2-CNT-LINE-ON-PAGE                                       
                     WS2-CNT-L341-WRITE.                                        
                                                                                
           MOVE WS2-CNT-PRINT-L341 TO L341-NO.                                  
           WRITE L341-PRINT-REC FROM L341-PRT-DETAIL AFTER 1.                   
           MOVE SPACES TO L341-PRINT-REC.                                       
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       320-PRINT-HEADING.                                                       
      *-------------------------------------------------------------            
           MOVE SPACES                TO L341-PRINT-REC.                        
           MOVE '    REMARKS    '     TO L341-HEADER-REMARKS.                   
           MOVE SPACES                TO L341-HEADER-1A                         
                                         L341-HEADER-2A.                        
           ADD  1                     TO WS2-CNT-NO-PAGE.                       
           MOVE 'BP13L341      '      TO L341-HEADER.                           
           MOVE WS2-CNT-NO-PAGE       TO L341-PRINT-PAGE.                       
           MOVE FUNCTION CURRENT-DATE TO WS5-CURRENT-DATE.                      
           MOVE WS5-CUR-DD            TO WS5-PRT-DD.                            
           MOVE WS5-CUR-MM            TO WS5-PRT-MM.                            
           MOVE WS5-CUR-CC            TO WS5-PRT-CC.                            
           MOVE WS5-CUR-YY            TO WS5-PRT-YY.                            
           MOVE WS5-PRT-DATE          TO L341-PRINT-DATE.                       
                                                                                
           WRITE L341-PRINT-REC AFTER PAGE.                                     
           WRITE L341-PRINT-REC FROM L341-PRT-HEAD-01 AFTER 4.                  
           WRITE L341-PRINT-REC FROM L341-PRT-HEAD-02-AGR AFTER 2.              
           WRITE L341-PRINT-REC FROM L341-PRT-HEAD-03 AFTER 2.                  
           WRITE L341-PRINT-REC FROM L341-PRT-HEAD-04 AFTER 2.                  
                                                                                
           MOVE SPACES                TO L341-PRINT-REC.                        
           WRITE L341-PRINT-REC AFTER 1.                                        
                                                                                
           MOVE 1 TO WS2-CNT-LINE-ON-PAGE.                                      
                                                                                
       320-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       400-PRINT-LETTER.                                                        
      *-------------------------------------------------------------            
           ADD 1  TO WS2-CNT-P341-WRITE.                                        
           WRITE P341-PRINT-REC FROM DJDE-LETTER-AGR AFTER PAGE.                
           MOVE SPACES TO P341-PRINT-REC.                                       
           WRITE P341-PRINT-REC AFTER ADVANCING PAGE.                           
                                                                                
           WRITE P341-PRINT-REC FROM P341-LINE1 AFTER 3.                        
           WRITE P341-PRINT-REC FROM P341-LINE2-AGR AFTER 5.                    
           WRITE P341-PRINT-REC FROM P341-LINE3 AFTER 2.                        
           WRITE P341-PRINT-REC FROM P341-LINE4 AFTER 1.                        
           WRITE P341-PRINT-REC FROM P341-LINE5 AFTER 1.                        
           WRITE P341-PRINT-REC FROM P341-LINE6 AFTER 1.                        
           WRITE P341-PRINT-REC FROM P341-LINE7 AFTER 12.                       
           WRITE P341-PRINT-REC FROM P341-LINE8-AGR AFTER 7                     
           WRITE P341-PRINT-REC FROM P341-LINE14 AFTER 14                       
           WRITE P341-PRINT-REC FROM P341-LINE10 AFTER 6.                       
           WRITE P341-PRINT-REC FROM P341-LINE11 AFTER 1.                       
           WRITE P341-PRINT-REC FROM P341-LINE12 AFTER 1.                       
           WRITE P341-PRINT-REC FROM P341-LINE13 AFTER 1.                       
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       500-CLOSE-ROUTINE SECTION.                                               
      *-------------------------------------------------------------            
           CLOSE BP13F310                                                       
                 BM06K100                                                       
                 BM06K110                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13L341                                                       
                 BP13P341.                                                      
                                                                                
           DISPLAY '- BP13C341 CONTROL TOTAL -----------'.                      
           DISPLAY 'NO OF RECORDS READ FROM DAILY TRANS (BP13F310)  = '         
                   WS2-CNT-F310-READ.                                           
           DISPLAY 'NO OF RECORDS READ FROM FIS (BM06K110)          = '         
                   WS2-CNT-K110-READ.                                           
           DISPLAY 'NO OF RECORDS READ FROM OCCUPIER (BP13K820)     = '         
                   WS2-CNT-K820-READ.                                           
           DISPLAY 'NO OF REJECTED CASES PRINTED (BP13L341)         = '         
                   WS2-CNT-L341-WRITE.                                          
           DISPLAY 'NO OF LETTERS PRINTED        (BP13P340)         = '         
                   WS2-CNT-P341-WRITE.                                          
                                                                                
           STOP RUN.                                                            
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
