      *------------------------*                                        00010000
       IDENTIFICATION DIVISION.                                         00020000
      *------------------------*                                        00030000
       PROGRAM-ID.    BP13C355.                                         00040000
      *AUTHOR.        RMDU.                                             00050000
      *DATE-WRITTEN.  28071999.                                         00060000
                                                                        00070000
      * =========================================================== *   00080000
      *  SYSTEM OF COMMITMENT (BP13)                                *   00090000
      * =========================================================== *   00100000
      *                                                             *   00110000
      *  OBJECTIVE :                                                *   00120000
      *  1. TO PRINT REPORT ON AGREEMENT FOR LEASE AND DEED OF      *   00130000
      *     ASSIGNMENT (SUB-TRANSFER) FOR SOC FLAT                  *   00140000
      *                                                             *   00150000
      *  INPUT FILES:                                               *   00160000
      *  1. BP13F315                                                *   00170000
      *  2. BP13K330                                                *   00180000
      *                                                             *   00190000
      *  OUTPUT FILES:                                              *   00200000
      *  1. AG07F225      - VOUCHER STAMPING FILE                   *   00210000
      *  2. BP13K625      - STAMP FEE MASTER FILE                   *   00220000
      *                                                             *   00230000
      *  LISTING                                                    *   00240000
      *  1. P13L355A      - DRAFT REPORT                            *   00250000
      *  2. P13L355B      - SOURCE COPY (FINAL REPORT)              *   00260000
      *                                                             *   00270000
      * ----------------------------------------------------------- *   00280000
      * CHG-NO   BY  DATE      DESCRIPTION                          *   00290000
      * -------- --- --------- -----------                          *   00300000
      * BP130696 RMDU 28071999 NEW PROGRAM                          *   00310000
      * BP130615 LSB  20031999 Y2K INTEGRATED TESTING               *   00320000
      * BP130790 SCK  02022000 TO ADD IN IN-SOURCE DOCUMENTATION    *   00330000
      * BP130806 RASM 03022000 TO CONVERT NUM-LEASE-TERM FROM YR    *   00340000
      *                        TO MONTHS                            *   00350000
      * BP130821 RASM 03032000 TO CATER FOR DUPLICATE RECORDS IN    *   00360000
      *                        WRITING BP13K625 BY ADDING A FLD     *   00370000
      *                        CALLED NUM-DOC-CNT                   *   00380000
      * BP132037 MCC  16102001 OFF BUDGET DISCOUNT 30%              *   00390000
      * BP132103 CLT  16022002 AG07 8 DIGIT PHONE                   *   00400000
      * BP132208 MALC 30072002 MOVE K330-DTE-SALE-AGRM              *   00410000
      *                        TO DTE-DOC-PREPARE.                  *   00420000
      *                        TO ADD AFL DATE IN THE REPORT.       *   00430000
      *                        FOR SUB-TRANSFER THRU M810,          *   00440000
      *                        DTE-SALE-AGRM = F880-DTE-FSA-SIGNED  *   00450000
      *                        IN BP13C356.                         *   00460000
      *                        FOR SUB-TRANSFER THRU M321,          *   00470000
      *                        DTE-SALE-AGRM = DTE-SUB-TRANSFER     *   00480000
      *                        IN BP13B321.                         *   00490000
      * BP132270 MALC 31120002 CATER FOR STAMP-FEE DISC AND NO DISC *   00500000
      * BP132660 JF4  31012005 CHG K330-AMT-FLEXI-SELLPR TO         *   00510000
      *                        K330-AMT-CURR-SELLPR                 *   00520000
      * BP132969 MTSR 13022007 MOVE SFTT CODE TO F220-TXT-INFO      *   00530000
      * BP133884 ESD1 05072011 CATER FOR NOMINAL DUTIES FEE         *   00540000
      * BP134128 ESD1 13092011 CATER TO WRITE ON K625-NUM-ZERO-STAMP*   00550000
      *                        IF FEES ARE ZEROES AND TWF OR RMP.   *   00560000
      * BP134809 JGO1 22032013 UPDATE ON FORMATTING OF STAMP DUTY   *   00570000
      *                        FOR ALE AND TRA                      *   00580000
      * BP134951 JGO1 13062013 ADD SSD IN THE PAYMENT VOUCHER       *   00590000
      * BP134809 JGO1 19072013 READ BP13K410 IF WS-DTE-DOC-PREPARE  *   00600000
      *                        IS BLANK OR ZEROES                   *   00610000
      * BP134969 JGO1 29072013 UPDATE LENGTH OF SSD AMT FIELD       *   00620000
      * BP135116 JGO1 23102013 INCLUDE THE SSD AMOUNT IN EARMARK AMT*   00630000
      * BP135096 JGO1 05122013 CHANGE SU TO SS FOR VOUCHER NUMBER   *   00640000
      * BP135193 JGO1 20052014 CHANGE OUTPUT FROM F220 TO F225      *   00650000
      * BP135309 JGO1 27082014 MOVE F315-DTE-PROC INTO DTE-PREP     *   00660000
      * BP135467 JGO1 05092014 MOVE STPFEE TO F225-NUM-INTRFC-FR    *   00670000
      * BP135650 JGO1 12052015 EXCLUDE DAWSON CASES                 *   00680000
      * BP135832 JGO1 19052015 UPDATE VALUES PASSED TO F225 BANK    *   00690000
      * BP137140 PCL4 19122017 TO REDEFINE AG07 FILE ERROR CODE     *   00700000
      * BP137833 DN8  15052019 TO CATER FOR TWF WITH STAMP FEES     *   00710000
      * BP137782 DN8  22052019 TO CATER FOR TRA WITH BOTH LEASE-FEE *   00720000
      *                        AND SUB-TRANSFER-DOA AMTS            *   00730000
      * BP138339 KR13 07082020 REMOVED P13L355C - IOM8 CONVERSION.  *   00740000
      * BP139164 KV8  04052022 INCLUDED ADDRESS AND COMMENTED STREET*   00741000
      * =========================================================== *   00750000
                                                                        00760000
      *--------------------*                                            00770000
       ENVIRONMENT DIVISION.                                            00780000
      *--------------------*                                            00790000
       CONFIGURATION SECTION.                                           00800000
       SOURCE-COMPUTER. IBM-3090.                                       00810000
       OBJECT-COMPUTER. IBM-3090.                                       00820000
                                                                        00830000
       INPUT-OUTPUT SECTION.                                            00840000
       FILE-CONTROL.                                                    00850000
                                                                        00860000
           SELECT BP13F315        ASSIGN       TO BP13F315.             00870000
                                                                        00880000
           SELECT BP13K330        ASSIGN       TO BP13K330              00890000
                                  ACCESS MODE  IS DYNAMIC               00900000
                                  ORGANIZATION IS INDEXED               00910000
                                  RECORD KEY   IS K330-KEY-FLD          00920000
                                  FILE STATUS  IS WS-BP13K330-STATUS.   00930000
                                                                        00940000
           SELECT BP13K625        ASSIGN       TO BP13K625              00950000
                                  ACCESS MODE  IS DYNAMIC               00960000
                                  ORGANIZATION IS INDEXED               00970000
                                  RECORD KEY   IS K625-KEY-FLD          00980000
                                  FILE STATUS  IS WS-BP13K625-STATUS.   00990000
                                                                        01000000
           SELECT BP13K800        ASSIGN       TO BP13K800              01010000
                                  ACCESS MODE  IS RANDOM                01020000
                                  ORGANIZATION IS INDEXED               01030000
                                  RECORD KEY   IS K800-NUM-REGN         01040000
                                  FILE STATUS  IS WS-BP13K800-STATUS.   01050000
                                                                        01060000
                                                                        01070000
           SELECT BP13K893        ASSIGN       TO BP13K893              01080000
                                  ACCESS MODE  IS DYNAMIC               01090000
                                  ORGANIZATION IS INDEXED               01100000
                                  RECORD KEY   IS K893-KEY-FLD          01110000
                                  FILE STATUS  IS WS-BP13K893-STATUS.   01120000
                                                                        01130000
           SELECT BP13K410        ASSIGN       TO BP13K410              01140000
                                  ACCESS MODE  IS RANDOM                01150000
                                  ORGANIZATION IS INDEXED               01160000
                                  RECORD KEY   IS K410-KEY-FLD          01170000
                                  FILE STATUS  IS WS-BP13K410-STATUS.   01180000
                                                                        01190000
           SELECT AG07F225        ASSIGN       TO AG07F225.             01200000
                                                                        01210000
           SELECT P13L355A        ASSIGN       TO P13L355A.             01220000
                                                                        01230000
           SELECT P13L355B        ASSIGN       TO P13L355B.             01240000
                                                                        01250000
           SELECT P13L355D        ASSIGN       TO P13L355D.             01260000
                                                                        01270000
                                                                        01280000
      *--------------------*                                            01290000
       DATA DIVISION.                                                   01300000
      *--------------------*                                            01310000
       FILE SECTION.                                                    01320000
                                                                        01330000
       FD   BP13F315                                                    01340000
            RECORD CONTAINS 500 CHARACTERS                              01350000
            RECORDING MODE  IS  F.                                      01360000
       COPY BP13F315.                                                   01370000
                                                                        01380000
       FD   BP13K330                                                    01390000
            RECORD CONTAINS 2000 CHARACTERS.                            01400000
       COPY BP13K330.                                                   01410000
                                                                        01420000
       FD   BP13K625                                                    01430000
            RECORD CONTAINS 500 CHARACTERS.                             01440000
       COPY BP13K625.                                                   01450000
                                                                        01460000
       FD   BP13K800                                                    01470000
            RECORD CONTAINS 2000 CHARACTERS.                            01480000
       COPY BP13K800.                                                   01490000
                                                                        01500000
       FD   BP13K893                                                    01510000
            RECORD CONTAINS 2050 CHARACTERS.                            01520000
       COPY BP13K893.                                                   01530000
                                                                        01540000
       FD   BP13K410                                                    01550000
            RECORD CONTAINS 2000 CHARACTERS.                            01560000
       COPY BP13K410.                                                   01570000
                                                                        01580000
       FD   AG07F225                                                    01590000
            RECORD CONTAINS 600 CHARACTERS                              01600000
            RECORDING MODE  IS  F.                                      01610000
       COPY AG07F225.                                                   01620000
                                                                        01630000
       FD   P13L355A                                                    01640000
            RECORD CONTAINS 132 CHARACTERS                              01650000
            RECORDING MODE  IS  F.                                      01660000
       01   L355A-PRINT-REC            PIC X(132).                      01670000
                                                                        01680000
       FD   P13L355B                                                    01690000
            RECORD CONTAINS 132 CHARACTERS                              01700000
            RECORDING MODE  IS  F.                                      01710000
       01   L355B-PRINT-REC            PIC X(132).                      01720000
                                                                        01730000
       FD   P13L355D                                                    01740000
            RECORD CONTAINS 132 CHARACTERS                              01750000
            RECORDING MODE  IS  F.                                      01760000
       01   L355D-PRINT-REC            PIC X(132).                      01770000
                                                                        01780000
       WORKING-STORAGE SECTION.                                         01790000
       01  WS-FILE-STATUS.                                              01800000
           05  WS-BP13K330-STATUS      PIC 9(02) VALUE ZEROES.          01810000
           05  WS-BP13K625-STATUS      PIC 9(02) VALUE ZEROES.          01820000
           05  WS-BP13K800-STATUS      PIC 9(02) VALUE ZEROES.          01830000
           05  WS-BP13K893-STATUS      PIC 9(02) VALUE ZEROES.          01840000
           05  WS-BP13K410-STATUS      PIC 9(02) VALUE ZEROES.          01850000
           05  WS-AG07-STATUS          PIC 9(2)  VALUE ZEROS.           01860000
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).        01870000
                                                                        01880000
       01  WS-COUNTERS.                                                 01890000
           05  WS-LINE-CTR             PIC 9(04) VALUE ZEROES.          01900000
           05  WS-PAGENO-CTR           PIC 9(04) VALUE ZEROES.          01910000
           05  WS-BP13K330-FND         PIC 9(04) VALUE ZEROES.          01920000
           05  WS-BP13K800-FND         PIC 9(04) VALUE ZEROES.          01930000
           05  WS-BP13K893-FND         PIC X(01) VALUE SPACES.          01940000
           05  WS-BP13K893-EOF         PIC X(01) VALUE SPACES.          01950000
           05  WS-BP13F315-READ        PIC 9(04) VALUE ZEROES.          01960000
           05  WS-BP13K330-READ        PIC 9(04) VALUE ZEROES.          01970000
           05  WS-AG07F225-WRITE       PIC 9(04) VALUE ZEROES.          01980000
           05  WS-BP13K625-WRITE       PIC 9(04) VALUE ZEROES.          01990000
           05  WS-AG07F225-SERIAL      PIC 9(04) VALUE ZEROES.          02000000
           05  WS-BP13K330-NFND        PIC 9(04) VALUE ZEROES.          02010000
           05  WS-BP13K800-NFND        PIC 9(04) VALUE ZEROES.          02020000
           05  WS-BP13F315-REWRT       PIC 9(04) VALUE ZEROES.          02030000
                                                                        02040000
       01  WS-ACCUM-VARIABLES.                                          02050000
           05  WS-TOTAL                PIC S9(07)V99 VALUE ZEROES.      02060000
           05  WS-TOTAL-DOA            PIC S9(06)V99 VALUE ZEROES.      02070000
           05  WS-TOTAL-DUP-DOA        PIC S9(06)V99 VALUE ZEROES.      02080000
           05  WS-TOTAL-SSD            PIC S9(06)V99 VALUE ZEROES.      02090000
           05  WS-TOTAL-COMPUTED       PIC S9(07)V99 VALUE ZEROES.      02100000
           05  WS-TOTAL-DUP-LEASE      PIC S9(06)V99 VALUE ZEROES.      02110000
           05  WS-TOTAL-ACTUAL-LEASE   PIC S9(06)V99 VALUE ZEROES.      02120000
                                                                        02130000
       01  WS-CONSTANT.                                                 02140000
           05  WS-NEW-VOUCHER-NO       PIC X(01) VALUE 'Y'.             02150000
           05  WS-NEW-BATCH-NO         PIC X(01) VALUE 'Y'.             02160000
           05  WS-NEW-HEADER           PIC X(01) VALUE 'Y'.             02170000
           05  WS-REPORT-TYPE          PIC X(01) VALUE 'N'.             02180000
           05  WS-FOOTER-TAG           PIC X(01) VALUE SPACE.           02190000
           05  WS-STAFF-START          PIC X(9)   VALUE '29586H   '.    02200000
                                                                        02210000
       01  WS-SYSTEM-DATE.                                              02220000
           05  WS-SYS-DATE             PIC X(08) VALUE SPACES.          02230000
           05  FILLER                  PIC X(13) VALUE SPACES.          02240000
                                                                        02250000
       01  WS-VARIABLES.                                                02260000
           05  WS-DTE-DOC-PREPARE      PIC X(08)    VALUE SPACES.       02270000
           05  WS-NUM-VOUCHER          PIC X(11)    VALUE SPACES.       02280000
           05  WS-NUM-GL-ACCT          PIC X(13)    VALUE SPACES.       02290000
           05  WS-ANNUAL-RENT          PIC 9(07)V99 VALUE ZEROES.       02300000
           05  WS-NUM-BATCH-TYPE       PIC X(04)    VALUE SPACES.       02310000
           05  WS-NUM-TEMP-VOUCHER     PIC X(11)    VALUE SPACES.       02320000
           05  WS-NUM-FIN-YEAR         PIC 9(04)    VALUE ZEROES.       02330000
           05  WS-NUM-BATCH-SERIAL     PIC 9(05)    VALUE ZEROES.       02340000
                                                                        02350000
           05  WS-PLACE-COUNTER        PIC 9(03) VALUE ZEROES.          02360000
           05  WL-AREA-SAVE            PIC X(12) VALUE SPACES.          02370000
           05  WS-RESULT               PIC 9(03) VALUE ZEROES.          02380000
           05  WL-AREA.                                                 02390000
               10  WL-ITEM1            PIC 9(01) VALUE ZEROES.          02400000
               10  FILLER              PIC X(11) VALUE SPACE.           02410000
           05  WL-ITM REDEFINES WL-AREA.                                02420000
               10  WL-ITEM             PIC X(01) OCCURS 12 TIMES.       02430000
           05  WS-K625-EOF             PIC X(01) VALUE 'N'.             02440000
           05  WS-NUM-HDB-REF          PIC X(11) VALUE SPACES.          02450000
           05  WS-NUM-DOC              PIC X(03) VALUE SPACES.          02460000
           05  WS-NUM-DOC-TYP          PIC X(01) VALUE SPACES.          02470000
           05  WS-NUM-DOC-CNT          PIC 9(01) VALUE ZEROES.          02480000
           05  WS-NUM-INCREASE-SCCC    PIC X(1)  VALUE SPACES.          02490000
           05  WS-NUM-LEASE-TERM       PIC 9(4)V99  VALUE ZEROES.       02500000
           05  WS-AMT-PURCHASE-PRICE   PIC 9(13)V99 VALUE ZEROES.       02510000
           05  WS-AMT-STAMP-DUTY       PIC 9(13)V99 VALUE ZEROES.       02520000
           05  WS-AMT-STAMP-DUTY-DUP   PIC 9(13)V99 VALUE ZEROES.       02530000
           05  WS-AMT-SSD              PIC 9(13)V99 VALUE ZEROES.       02540000
           05  WS-AMT-EARMARK          PIC 9(10)V99 VALUE ZEROES.       02550000
                                                                        02560000
           05  WS-L355D-PRT-CNT        PIC 9(4)     VALUE ZEROS.        02570000
           05  WS-L355D-PAGE-CNT       PIC 9(5)     VALUE ZEROS.        02580000
           05  WS-L355D-REC-ON-PAGE-CNT  PIC 9(2)   VALUE 66.           02590000
                                                                        02600000
      *--------------------------------*                                02610000
      * FOR AMOUNT TO WORDS CONVERSION *                                02620000
      *--------------------------------*                                02630000
       01  WS-SUBSCRIPTS.                                               02640000
           05  WA-SUB                  PIC 9(03) VALUE ZEROES.          02650000
           05  WF-SUB                  PIC 9(03) VALUE ZEROES.          02660000
           05  WL-SUB                  PIC 9(03) VALUE ZEROES.          02670000
           05  WS-SUB                  PIC 9(03) VALUE ZEROES.          02680000
           05  WS-FIRST-SUB            PIC 9(03) VALUE ZEROES.          02690000
                                                                        02700000
       01  WA-NAMES.                                                    02710000
           05  FILLER                  PIC X(10) VALUE '3ONE      '.    02720000
           05  FILLER                  PIC X(10) VALUE '3TWO      '.    02730000
           05  FILLER                  PIC X(10) VALUE '5THREE    '.    02740000
           05  FILLER                  PIC X(10) VALUE '4FOUR     '.    02750000
           05  FILLER                  PIC X(10) VALUE '4FIVE     '.    02760000
           05  FILLER                  PIC X(10) VALUE '3SIX      '.    02770000
           05  FILLER                  PIC X(10) VALUE '5SEVEN    '.    02780000
           05  FILLER                  PIC X(10) VALUE '5EIGHT    '.    02790000
           05  FILLER                  PIC X(10) VALUE '4NINE     '.    02800000
           05  FILLER                  PIC X(10) VALUE '3TEN      '.    02810000
           05  FILLER                  PIC X(10) VALUE '6ELEVEN   '.    02820000
           05  FILLER                  PIC X(10) VALUE '6TWELVE   '.    02830000
           05  FILLER                  PIC X(10) VALUE '8THIRTEEN '.    02840000
           05  FILLER                  PIC X(10) VALUE '8FOURTEEN '.    02850000
           05  FILLER                  PIC X(10) VALUE '7FIFTEEN  '.    02860000
           05  FILLER                  PIC X(10) VALUE '7SIXTEEN  '.    02870000
           05  FILLER                  PIC X(10) VALUE '9SEVENTEEN'.    02880000
           05  FILLER                  PIC X(10) VALUE '8EIGHTEEN '.    02890000
           05  FILLER                  PIC X(10) VALUE '8NINETEEN '.    02900000
           05  FILLER                  PIC X(10) VALUE '6TWENTY   '.    02910000
           05  FILLER                  PIC X(10) VALUE '6THIRTY   '.    02920000
           05  FILLER                  PIC X(10) VALUE '5FORTY    '.    02930000
           05  FILLER                  PIC X(10) VALUE '5FIFTY    '.    02940000
           05  FILLER                  PIC X(10) VALUE '5SIXTY    '.    02950000
           05  FILLER                  PIC X(10) VALUE '7SEVENTY  '.    02960000
           05  FILLER                  PIC X(10) VALUE '6EIGHTY   '.    02970000
           05  FILLER                  PIC X(10) VALUE '6NINETY   '.    02980000
       01  WA-NAMER REDEFINES WA-NAMES.                                 02990000
           05  WA-NAME                 PIC X(10) OCCURS 27 TIMES.       03000000
                                                                        03010000
       01  WS-LITERALS.                                                 03020000
           05  L-CENT                  PIC X(05) VALUE '4CENT'.         03030000
           05  L-AND                   PIC X(04) VALUE '3AND'.          03040000
           05  L-X                     PIC X(01) VALUE '%'.             03050000
           05  L-MILLION               PIC X(08) VALUE '7MILLION'.      03060000
           05  L-THOUSAND              PIC X(09) VALUE '8THOUSAND'.     03070000
           05  L-DOLLARS               PIC X(08) VALUE '7DOLLARS'.      03080000
           05  L-CENTS                 PIC X(06) VALUE '6CENTS'.        03090000
           05  L-ONLY                  PIC X(06) VALUE '5ONLY '.        03100000
           05  L-HUNDRED               PIC X(08) VALUE '7HUNDRED'.      03110000
           05  L-DOLLAR                PIC X(07) VALUE '6DOLLAR'.       03120000
                                                                        03130000
       01  SWITCHES.                                                    03140000
           05  WS-SWITCH               PIC 9(01) VALUE ZEROES.          03150000
           05  WS-THO-SW               PIC 9(01) VALUE ZEROES.          03160000
           05  WS-CNT-SW               PIC 9(01) VALUE ZEROES.          03170000
           05  WS-LIT-SW               PIC 9(01) VALUE ZEROES.          03180000
           05  WS-TEN-SW               PIC 9(01) VALUE ZEROES.          03190000
           05  WS-AND-SW               PIC 9(01) VALUE ZEROES.          03200000
                                                                        03210000
       01  WS-CHEQUE-DETAILS.                                           03220000
           05  WS-AMT                  PIC 9(07)V99 VALUE ZEROES.       03230000
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         03240000
           05  WF-DETAILS.                                              03250000
               10  WF-LINE-1           PIC X(60).                       03260000
               10  WF-LINE-2           PIC X(60).                       03270000
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           03280000
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         03290000
                                                                        03300000
      *--------------------------------*                                03310000
      * VARIABLES FOR AG07C907         *                                03320000
      *--------------------------------*                                03330000
       COPY AG7C907C.                                                   03340000
                                                                        03350000
      *--------------------------------*                                03360000
      * VARIABLES FOR BP13C906         *                                03370000
      *--------------------------------*                                03380000
       COPY P13C906C.                                                   03390000
                                                                        03400000
      *--------------------------------*                                03410000
      * VARIABLES FOR AB05C902         *                                03420000
      *--------------------------------*                                03430000
       COPY AB05902C.                                                   03440000
                                                                        03450000
      *--------------------------------*                                03460000
      * REPORT LAYOUT FOR SUB-TRANSFER *                                03470000
      *--------------------------------*                                03480000
       01  L355-HEADER-01.                                              03490000
           05  L355-REPORT-ID          PIC X(10) VALUE SPACES.          03500000
           05  FILLER                  PIC X(08) VALUE '    HDB3'.      03510000
           05  FILLER                  PIC X(28) VALUE SPACES.          03520000
           05  FILLER                  PIC X(39) VALUE                  03530000
               'S Y S T E M   O F   C O M M I T M E N T'.               03540000
           05  FILLER                  PIC X(12) VALUE SPACES.          03550000
           05  FILLER                  PIC X(07) VALUE 'DATE : '.       03560000
           05  L355-CURRENT-DATE       PIC X(10) VALUE SPACES.          03570000
           05  FILLER                  PIC X(06) VALUE SPACES.          03580000
           05  FILLER                  PIC X(07) VALUE 'PAGE : '.       03590000
           05  L355-PAGE               PIC ZZZZ9.                       03600000
                                                                        03610000
       01  L355-HEADER-02.                                              03620000
           05  FILLER                  PIC X(30) VALUE                  03630000
               'HOUSING AND DEVELOPMENT BOARD'.                         03640000
           05  FILLER                  PIC X(05) VALUE SPACES.          03650000
           05  FILLER                  PIC X(70) VALUE                  03660000
               '        P A Y M E N T   V O U C H E R                   03670000
      -        '              '.                                        03680000
           05  FILLER                  PIC X(05) VALUE SPACES.          03690000
           05  L355-COPY-NAME          PIC X(20) VALUE SPACES.          03700000
                                                                        03710000
       01  L355-HEADER-2A.                                              03720000
           05  FILLER                  PIC X(35) VALUE SPACES.          03730000
           05  FILLER                  PIC X(70) VALUE                  03740000
               'AGREEMENT FOR LEASE AND DEED OF ASSIGNMENT (SUB-TRANSFER03750000
      -        ') FOR SOC FLAT'.                                        03760000
           05  FILLER                  PIC X(25) VALUE SPACES.          03770000
                                                                        03780000
       01  L355-HEADER-03.                                              03790000
           05  FILLER                  PIC X(27) VALUE                  03800000
               'SALES UNIT (AGREEMENT TEAM)'.                           03810000
           05  FILLER                  PIC X(31) VALUE SPACES.          03820000
           05  FILLER                  PIC X(27) VALUE                  03830000
               'FOR FINANCE DEPARTMENT USE'.                            03840000
           05  FILLER                  PIC X(12) VALUE SPACES.          03850000
           05  FILLER                  PIC X(12) VALUE 'BATCH NO   :'.  03860000
           05  FILLER                  PIC X(01) VALUE SPACES.          03870000
           05  L355-BATCH-NO           PIC X(15) VALUE SPACES.          03880000
                                                                        03890000
       01  L355-HEADER-04.                                              03900000
           05  FILLER                  PIC X(17) VALUE                  03910000
               'SYSTEM CODE  : 04'.                                     03920000
           05  FILLER                  PIC X(41) VALUE SPACES.          03930000
           05  FILLER                  PIC X(12) VALUE 'CHECKED BY :'.  03940000
           05  FILLER                  PIC X(27) VALUE SPACES.          03950000
           05  FILLER                  PIC X(12) VALUE 'VOUCHER NO :'.  03960000
           05  FILLER                  PIC X(01) VALUE SPACES.          03970000
           05  L355-VOUCHER-NO         PIC X(11) VALUE SPACES.          03980000
                                                                        03990000
       01  L355-HEADER-05.                                              04000000
           05  FILLER                  PIC X(28) VALUE                  04010000
              'GL CODE      : 0000000104250'.                           04020000
                                                                        04030000
       01  L355-HEADER-06.                                              04040000
           05  FILLER                  PIC X(25) VALUE                  04050000
              'DESCRIPTION  : STAMP FEES'.                              04060000
                                                                        04070000
       01  L355-HEADER-07.                                              04080000
           05  FILLER                  PIC X(44) VALUE                  04090000
              'PAYABLE TO   : COMMISSIONER OF STAMP DUTIES'.            04100000
           05  FILLER                  PIC X(14) VALUE SPACES.          04110000
           05  FILLER                  PIC X(12) VALUE 'BANK   : DBS'.  04120000
           05  FILLER                  PIC X(27) VALUE  SPACES.         04130000
           05  FILLER                  PIC X(26) VALUE                  04140000
               'BANK CODE    : DBSSSGSGXXX'.                            04150000
                                                                        04160000
       01  L355-HEADER-08.                                              04170000
           05  FILLER                  PIC X(25) VALUE                  04180000
              'A/C NO       : 0010468600'.                              04190000
           05  FILLER                  PIC X(33) VALUE SPACES.          04200000
                                                                        04210000
       01  L355-HEADER-09.                                              04220000
           05  FILLER                  PIC X(62) VALUE                  04230000
               'REMITTANCE ADVICE DESPATCH TO : C/O SC(STAMPING) OF SALE04240000
      -        'S UNIT'.                                                04250000
                                                                        04260000
       01  L355-HEADER-10.                                              04270000
           05  FILLER                  PIC X(37) VALUE SPACES.          04280000
           05  FILLER                  PIC X(13) VALUE 'FLAT ADDRESS/'. 04290000
           05  FILLER                  PIC X(19) VALUE SPACES.          04300000
           05  FILLER                  PIC X(3)  VALUE 'DOC'.           04310000
           05  FILLER                  PIC X(5)  VALUE SPACES.          04320000
           05  FILLER                  PIC X(09) VALUE 'AGREEMENT'.     04330000
           05  FILLER                  PIC X(02) VALUE SPACES.          04340000
           05  FILLER                  PIC X(05) VALUE 'DUP  '.         04350000
           05  FILLER                  PIC X(02) VALUE SPACES.          04360000
           05  FILLER                  PIC X(08) VALUE 'DOA'.           04370000
           05  FILLER                  PIC X(03) VALUE SPACES.          04380000
           05  FILLER                  PIC X(05) VALUE 'DUP '.          04390000
           05  FILLER                  PIC X(03) VALUE SPACES.          04400000
           05  FILLER                  PIC X(05) VALUE 'SSD '.          04410000
                                                                        04420000
       01  L355-HEADER-11.                                              04430000
           05  FILLER                  PIC X(04) VALUE 'S/NO'.          04440000
           05  FILLER                  PIC X(01) VALUE SPACES.          04450000
           05  FILLER                  PIC X(10) VALUE 'SCH-ACC-NO'.    04460000
           05  FILLER                  PIC X(05) VALUE SPACES.          04470000
           05  FILLER                  PIC X(07) VALUE 'REGN NO'.       04480000
           05  FILLER                  PIC X(02) VALUE SPACES.          04490000
           05  FILLER                  PIC X(05) VALUE 'BLOCK'.         04500000
           05  FILLER                  PIC X(03) VALUE SPACES.          04510000
           05  FILLER                  PIC X(11) VALUE                  04520000
               'STREET NAME'.                                           04530000
           05  FILLER                  PIC X(09) VALUE SPACES.          04540000
           05  FILLER                  PIC X(07) VALUE 'FLAT NO'.       04550000
           05  FILLER                  PIC X(05) VALUE SPACES.          04560000
           05  FILLER                  PIC X(04) VALUE 'DATE'.          04570000
           05  FILLER                  PIC X(04) VALUE SPACES.          04580000
           05  FILLER                  PIC X(09) VALUE 'FOR LEASE'.     04590000
           05  FILLER                  PIC X(03) VALUE SPACES.          04600000
           05  FILLER                  PIC X(04) VALUE 'SA'.            04610000
           05  FILLER                  PIC X(01) VALUE SPACES.          04620000
           05  FILLER                  PIC X(10) VALUE '(TRANSFER)'.    04630000
           05  FILLER                  PIC X(02) VALUE SPACES.          04640000
           05  FILLER                  PIC X(05) VALUE 'DOA  '.         04650000
           05  FILLER                  PIC X(13) VALUE SPACES.          04660000
           05  FILLER                  PIC X(05) VALUE 'TOTAL'.         04670000
                                                                        04680000
       01  L355-DETAIL.                                                 04690000
           05  L355-SNO                PIC ZZZ9.                        04700000
           05  FILLER                  PIC X(01) VALUE SPACES.          04710000
           05  L355-SCH-ACC            PIC X(14) VALUE SPACES.          04720000
           05  FILLER                  PIC X(01) VALUE SPACES.          04730000
           05  L355-REGN-NO            PIC X(08) VALUE SPACES.          04740000
           05  FILLER                  PIC X(01) VALUE SPACES.          04750000
           05  L355-BLK-NO             PIC X(05) VALUE SPACES.          04760000
           05  FILLER                  PIC X(01) VALUE SPACES.          04770000
           05  L355-STREET             PIC X(20) VALUE SPACES.          04780000
           05  FILLER                  PIC X(02) VALUE SPACES.          04790000
           05  L355-FLAT-NO.                                            04800000
               10  L355-CONST-1        PIC X(01) VALUE '#'.             04810000
               10  L355-LEVEL-NO       PIC X(02) VALUE SPACES.          04820000
               10  L355-CONST-2        PIC X(01) VALUE '-'.             04830000
               10  L355-UNIT-NO        PIC X(04) VALUE SPACES.          04840000
           05  FILLER                  PIC X(01) VALUE SPACES.          04850000
           05  L355-AFL-DATE           PIC X(10) VALUE SPACES.          04860000
           05  FILLER                  PIC X(01) VALUE SPACES.          04870000
           05  L355-LEASE              PIC $$,$$9.99.                   04880000
           05  FILLER                  PIC X(01) VALUE SPACES.          04890000
           05  L355-DUP-LEASE          PIC $9.99.                       04900000
           05  FILLER                  PIC X(02) VALUE SPACES.          04910000
           05  L355-DOA                PIC $$,$$9.99.                   04920000
           05  FILLER                  PIC X(01) VALUE SPACES.          04930000
           05  L355-DUP-DOA            PIC $9.99.                       04940000
           05  FILLER                  PIC X(01) VALUE SPACES.          04950000
           05  L355-SSD                PIC $$$,$$9.99.                  04960000
           05  FILLER                  PIC X(02) VALUE SPACES.          04970000
           05  L355-TOTAL              PIC $$$,$$9.99.                  04980000
                                                                        04990000
       01  L355-TOTAL-LINE.                                             05000000
           05  FILLER                  PIC X(20) VALUE SPACES.          05010000
           05  FILLER                  PIC X(20) VALUE 'SERIAL NO :(000105020000
      -        ' TO '.                                                  05030000
           05  L355-HIGH-NO            PIC 9(04) VALUE ZEROES.          05040000
           05  FILLER                  PIC X(01) VALUE ')'.             05050000
           05  FILLER                  PIC X(05) VALUE SPACES.          05060000
           05  FILLER                  PIC X(08) VALUE 'TOTAL : '.      05070000
           05  FILLER                  PIC X(18) VALUE SPACES.          05080000
           05  L355-TOTAL-ACTUAL-LEASE PIC $$$,$$9.99.                  05090000
           05  FILLER                  PIC X(01) VALUE SPACES.          05100000
           05  L355-TOTAL-DUP-LEASE    PIC $9.99.                       05110000
           05  FILLER                  PIC X(01) VALUE SPACES.          05120000
           05  L355-TOTAL-DOA          PIC $$$,$$9.99.                  05130000
           05  FILLER                  PIC X(01) VALUE SPACES.          05140000
           05  L355-TOTAL-DUP-DOA      PIC $9.99.                       05150000
           05  FILLER                  PIC X(01) VALUE SPACES.          05160000
           05  L355-TOTAL-SSD          PIC $$$,$$9.99.                  05170000
           05  FILLER                  PIC X(01) VALUE SPACES.          05180000
           05  L355-TOTAL-COMPUTED     PIC $$$$,$$9.99.                 05190000
                                                                        05200000
       01  L355-DASH-LINE.                                              05210000
           05  FILLER                  PIC X(77) VALUE SPACES.          05220000
           05  FILLER                  PIC X(59) VALUE ALL '-'.         05230000
                                                                        05240000
       01  L355-TRAILER-01.                                             05250000
           05  FILLER                  PIC X(12) VALUE 'NET PAYABLE:'.  05260000
           05  FILLER                  PIC X(02) VALUE SPACES.          05270000
           05  L355-AMT-WORDS.                                          05280000
               10  L355-AMT-DESC1      PIC X(60) VALUE SPACES.          05290000
               10  L355-AMT-DESC2      PIC X(60) VALUE SPACES.          05300000
                                                                        05310000
       01  L355-TRAILER-02.                                             05320000
           05  FILLER                  PIC X(30) VALUE SPACES.          05330000
           05  FILLER                  PIC X(11) VALUE 'CHECKED BY:'.   05340000
           05  FILLER                  PIC X(25) VALUE ALL '_'.         05350000
           05  FILLER                  PIC X(09) VALUE SPACES.          05360000
           05  FILLER                  PIC X(13) VALUE 'CERTIFIED BY:'. 05370000
           05  FILLER                  PIC X(25) VALUE ALL '_'.         05380000
                                                                        05390000
      *-----------------------------------------------------------*     05400000
      *    DEFINE P13C355D REPORT LINES                           *     05410000
      *-----------------------------------------------------------*     05420000
       01  L355D-HEADER2.                                               05430000
           05  FILLER                    PIC X(47) VALUE SPACES.        05440000
           05  FILLER                    PIC X(35)  VALUE               05450000
               'REPORT ON CASES WITH EARMARK ERROR'.                    05460000
                                                                        05470000
       01  L355D-HEADER3.                                               05480000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             05490000
           05  FILLER               PIC X(3)  VALUE SPACE.              05500000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       05510000
           05  FILLER               PIC X(9)  VALUE SPACES.             05520000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          05530000
           05  FILLER               PIC X(5)  VALUE SPACE.              05540000
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    05550000
           05  FILLER               PIC X(5)  VALUE SPACES.             05560000
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     05570000
           05  FILLER               PIC X(4)  VALUE SPACES.             05580000
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.05590000
                                                                        05600000
       01  L355D-REC-DETAIL.                                            05610000
           05  L355D-SERIAL-NO              PIC ZZZ9.                   05620000
           05  FILLER                       PIC X(3)  VALUE SPACE.      05630000
           05  L355D-SCH-ACC                PIC X(14) VALUE SPACES.     05640000
           05  FILLER                       PIC X(5)  VALUE SPACE.      05650000
           05  L355D-REGN-NO                PIC X(8)  VALUE SPACES.     05660000
           05  FILLER                       PIC X(5)  VALUE SPACE.      05670000
           05  L355D-JR-VCHR-NO             PIC X(13) VALUE SPACES.     05680000
           05  FILLER                       PIC X(5)  VALUE SPACES.     05690000
           05  L355D-AMT-TOTAL              PIC $$$$,$$9.99.            05700000
           05  FILLER                       PIC X(5)  VALUE SPACES.     05710000
           05  L355D-ERROR-DESC             PIC X(30).                  05720000
                                                                        05730000
       01  L355D-UNDERLINE                  PIC X(132) VALUE ALL '-'.   05740000
                                                                        05750000
                                                                        05760000
      *-------------------*                                             05770000
       PROCEDURE DIVISION.                                              05780000
      *-------------------*                                             05790000
                                                                        05800000
      *--------------------------------*                                05810000
       0000-MAIN-ROUTINE.                                               05820000
      *--------------------------------*                                05830000
           PERFORM 1000-OPEN-FILES              THRU 1000-EXIT.         05840000
           PERFORM 2000-READ-BP13F315           THRU 2000-EXIT.         05850000
           PERFORM 3000-MAIN-ROUTINE            THRU 3000-EXIT          05860000
             UNTIL F315-REGN-NO = HIGH-VALUES.                          05870000
                                                                        05880000
      *-------> TO PRINT THE FOOTER OF DRAFT REPORT                     05890000
           IF WS-REPORT-TYPE = SPACES                                   05900000
             PERFORM 4310-PRINT-DRAFT-COMPTOTAL THRU 4310-EXIT          05910000
             PERFORM 4320-PRINT-DRAFT-FOOTER    THRU 4320-EXIT          05920000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          05930000
           END-IF.                                                      05940000
                                                                        05950000
      *-------> TO PRINT THE FOOTER OF FINAL REPORT                     05960000
           IF WS-REPORT-TYPE = 'V' AND WS-FOOTER-TAG = 'Y'              05970000
             PERFORM 6700-WRITE-AG07-TRL        THRU 6700-EXIT          05980000
             PERFORM 6800-WRITE-FINAL-COMPTOTAL THRU 6800-EXIT          05990000
             PERFORM 6900-WRITE-FINAL-FOOTER    THRU 6900-EXIT          06000000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          06010000
           END-IF.                                                      06020000
                                                                        06030000
           PERFORM 9000-CLOSE-FILES             THRU 9000-EXIT.         06040000
                                                                        06050000
       0000-EXIT.                                                       06060000
           EXIT.                                                        06070000
                                                                        06080000
                                                                        06090000
      *--------------------------------*                                06100000
       1000-OPEN-FILES.                                                 06110000
      *--------------------------------*                                06120000
           OPEN INPUT  BP13K330                                         06130000
                       BP13K800                                         06140000
                       BP13K893                                         06150000
                       BP13K410                                         06160000
                I-O    BP13F315                                         06170000
                       BP13K625                                         06180000
                OUTPUT AG07F225                                         06190000
                       P13L355A                                         06200000
                       P13L355B                                         06210000
                       P13L355D.                                        06220000
                                                                        06230000
           IF WS-BP13K330-STATUS NOT = 00 AND NOT = 97                  06240000
              DISPLAY 'BP13K330 - OPEN FILE ERROR: ' WS-BP13K330-STATUS 06250000
              MOVE WS-BP13K330-STATUS  TO RETURN-CODE                   06260000
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                   06270000
           END-IF.                                                      06280000
                                                                        06290000
           IF WS-BP13K410-STATUS NOT = 00 AND NOT = 97                  06300000
              DISPLAY 'BP13K410 - OPEN FILE ERROR: ' WS-BP13K410-STATUS 06310000
              MOVE WS-BP13K410-STATUS  TO RETURN-CODE                   06320000
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                   06330000
           END-IF.                                                      06340000
                                                                        06350000
           IF WS-BP13K625-STATUS NOT = 00 AND NOT = 97                  06360000
              DISPLAY 'BP13K625 - OPEN FILE ERROR: ' WS-BP13K625-STATUS 06370000
              MOVE WS-BP13K625-STATUS  TO RETURN-CODE                   06380000
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                   06390000
           END-IF.                                                      06400000
                                                                        06410000
                                                                        06420000
      *-------> FOR VOUCHER NUMBER                                      06430000
           MOVE 'AG07K960'             TO C907-NUM-FILENME.             06440000
                                                                        06450000
           CALL 'K960OPEN' USING AG07C907-AREA.                         06460000
                                                                        06470000
           IF C907-NUM-FILE-STATUS NOT = '00' AND '97'                  06480000
             DISPLAY 'AG07K960 OPEN FILE ERROR: ' C907-NUM-FILE-STATUS  06490000
             MOVE C907-NUM-FILE-STATUS TO WS-AG07-STAT-X                06500000
             MOVE WS-AG07-STATUS       TO RETURN-CODE                   06510000
             PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                   06520000
           END-IF.                                                      06530000
                                                                        06540000
      *-------> FOR BATCH NO                                            06550000
           MOVE 'BP13K620'             TO C906-NUM-FILENME.             06560000
                                                                        06570000
           CALL 'K620OPEN' USING BP13C906-AREA.                         06580000
                                                                        06590000
           IF C906-NUM-FILE-STATUS NOT = '00' AND '97'                  06600000
             DISPLAY 'BP13K620 OPEN FILE ERROR: ' C906-NUM-FILE-STATUS  06610000
             MOVE C906-NUM-FILE-STATUS TO RETURN-CODE                   06620000
             PERFORM  9000-CLOSE-FILES THRU 9000-EXIT                   06630000
           END-IF.                                                      06640000
                                                                        06650000
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      06660000
           MOVE SPACES              TO   WS-B902-AREA.                  06670000
           INITIALIZE                    WS-B902-AREA.                  06680000
           MOVE 'O'                 TO   B902-CDE-TYPE.                 06690000
           CALL 'AB05C902'  USING WS-B902-AREA.                         06700000
                                                                        06710000
           IF B902-CDE-ERROR NOT = ZEROES                               06720000
              MOVE B902-CDE-SYSERR      TO   RETURN-CODE                06730000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             06740000
              PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                 06750000
           END-IF.                                                      06760000
                                                                        06770000
           MOVE FUNCTION CURRENT-DATE(1:8)  TO WS-SYS-DATE.             06780000
                                                                        06790000
       1000-EXIT.                                                       06800000
           EXIT.                                                        06810000
                                                                        06820000
                                                                        06830000
      *--------------------------------*                                06840000
       2000-READ-BP13F315.                                              06850000
      *--------------------------------*                                06860000
           READ BP13F315                                                06870000
             AT END MOVE HIGH-VALUES   TO F315-REGN-NO                  06880000
             GO TO  2000-EXIT.                                          06890000
                                                                        06900000
           ADD 1                       TO WS-BP13F315-READ.             06910000
                                                                        06920000
       2000-EXIT.                                                       06930000
           EXIT.                                                        06940000
                                                                        06950000
                                                                        06960000
      *--------------------------------*                                06970000
       3000-MAIN-ROUTINE.                                               06980000
      *--------------------------------*                                06990000
                                                                        07000000
      * TEST !!!                                                        07010000
      *    MOVE 'V' TO F315-CDE-RELEASE-PAYMENT                         07020000
      * TEST !!!                                                        07030000
           IF F315-FLAG-DAWSON = 'Y'                                    07040000
              PERFORM 2000-READ-BP13F315    THRU 2000-EXIT              07050000
              GO TO 3000-EXIT                                           07060000
           END-IF.                                                      07070000
                                                                        07080000
           EVALUATE TRUE                                                07090000
                                                                        07100000
           WHEN F315-CDE-RELEASE-PAYMENT = SPACES                       07110000
             MOVE SPACES                       TO WS-REPORT-TYPE        07120000
             PERFORM 4000-PROCESS-DRAFT-REPORT THRU 4000-EXIT           07130000
           WHEN F315-CDE-RELEASE-PAYMENT = 'V'                          07140000
             MOVE 'V'                          TO WS-REPORT-TYPE        07150000
             PERFORM 6000-PROCESS-FINAL-REPORT THRU 6000-EXIT           07160000
                                                                        07170000
           END-EVALUATE.                                                07180000
                                                                        07190000
           PERFORM 2000-READ-BP13F315          THRU 2000-EXIT.          07200000
                                                                        07210000
       3000-EXIT.                                                       07220000
           EXIT.                                                        07230000
                                                                        07240000
                                                                        07250000
      *------->                                                         07260000
      * FOR DRAFT REPORT COPY                                           07270000
      *--------------------------------*                                07280000
       4000-PROCESS-DRAFT-REPORT.                                       07290000
      *--------------------------------*                                07300000
           PERFORM 8000-MOVE-DATA         THRU 8000-EXIT.               07310000
                                                                        07320000
           IF WS-NEW-VOUCHER-NO  = 'Y'                                  07330000
             PERFORM 4100-PRINT-DRAFT-HDR THRU 4100-EXIT                07340000
             MOVE 'N'                     TO WS-NEW-VOUCHER-NO          07350000
           END-IF.                                                      07360000
                                                                        07370000
           PERFORM 4200-PRINT-DRAFT-DTL   THRU 4200-EXIT.               07380000
           MOVE 'U'                       TO F315-CDE-RELEASE-PAYMENT.  07390000
           MOVE WS-TOTAL                  TO F315-AMT-STAMP-DUTIES.     07400000
           REWRITE BP13F315-TRANS-REC.                                  07410000
           ADD 1                          TO WS-BP13F315-REWRT.         07420000
                                                                        07430000
       4000-EXIT.                                                       07440000
           EXIT.                                                        07450000
                                                                        07460000
                                                                        07470000
      *--------------------------------*                                07480000
       4100-PRINT-DRAFT-HDR.                                            07490000
      *--------------------------------*                                07500000
           MOVE SPACES                 TO L355A-PRINT-REC.              07510000
                                                                        07520000
           MOVE 'P13L355A'             TO L355-REPORT-ID.               07530000
                                                                        07540000
           ADD 1                       TO WS-PAGENO-CTR.                07550000
           MOVE WS-PAGENO-CTR          TO L355-PAGE.                    07560000
                                                                        07570000
           STRING WS-SYS-DATE(7:2) '/' WS-SYS-DATE(5:2) '/'             07580000
                  WS-SYS-DATE(1:4)                                      07590000
                  DELIMITED BY SIZE    INTO L355-CURRENT-DATE.          07600000
                                                                        07610000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-01 AFTER PAGE.  07620000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-02 AFTER 1.     07630000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-2A AFTER 1.     07640000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-03 AFTER 2.     07650000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-04 AFTER 2.     07660000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-05 AFTER 1.     07670000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-06 AFTER 1.     07680000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-07 AFTER 1.     07690000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-08 AFTER 1.     07700000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-09 AFTER 1.     07710000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-10 AFTER 3.     07720000
           WRITE L355A-PRINT-REC       FROM L355-HEADER-11 AFTER 1.     07730000
                                                                        07740000
           MOVE SPACES                 TO L355A-PRINT-REC.              07750000
           WRITE L355A-PRINT-REC        AFTER 1.                        07760000
                                                                        07770000
       4100-EXIT.                                                       07780000
           EXIT.                                                        07790000
                                                                        07800000
                                                                        07810000
      *--------------------------------*                                07820000
       4200-PRINT-DRAFT-DTL.                                            07830000
      *--------------------------------*                                07840000
           ADD 1                        TO WS-LINE-CTR.                 07850000
                                                                        07860000
           MOVE SPACES                  TO L355A-PRINT-REC.             07870000
           MOVE WS-LINE-CTR             TO L355-SNO.                    07880000
                                                                        07890000
           WRITE L355A-PRINT-REC        FROM L355-DETAIL AFTER 1.       07900000
                                                                        07910000
           PERFORM 4300-PRINT-DRAFT-TRL THRU 4300-EXIT.                 07920000
                                                                        07930000
       4200-EXIT.                                                       07940000
           EXIT.                                                        07950000
                                                                        07960000
                                                                        07970000
      *--------------------------------*                                07980000
       4300-PRINT-DRAFT-TRL.                                            07990000
      *--------------------------------*                                08000000
           IF WS-LINE-CTR = 25 OR F315-REGN-NO = HIGH-VALUES            08010000
             PERFORM 4310-PRINT-DRAFT-COMPTOTAL THRU 4310-EXIT          08020000
             PERFORM 4320-PRINT-DRAFT-FOOTER    THRU 4320-EXIT          08030000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          08040000
           END-IF.                                                      08050000
                                                                        08060000
       4300-EXIT.                                                       08070000
           EXIT.                                                        08080000
                                                                        08090000
                                                                        08100000
      *--------------------------------*                                08110000
       4310-PRINT-DRAFT-COMPTOTAL.                                      08120000
      *--------------------------------*                                08130000
           WRITE L355A-PRINT-REC       FROM L355-DASH-LINE AFTER 3.     08140000
                                                                        08150000
           MOVE WS-LINE-CTR            TO L355-HIGH-NO.                 08160000
           MOVE WS-TOTAL-DOA           TO L355-TOTAL-DOA.               08170000
           MOVE WS-TOTAL-SSD           TO L355-TOTAL-SSD.               08180000
           MOVE WS-TOTAL-DUP-DOA       TO L355-TOTAL-DUP-DOA.           08190000
           MOVE WS-TOTAL-DUP-LEASE     TO L355-TOTAL-DUP-LEASE.         08200000
           MOVE WS-TOTAL-ACTUAL-LEASE  TO L355-TOTAL-ACTUAL-LEASE.      08210000
           MOVE WS-TOTAL-COMPUTED      TO L355-TOTAL-COMPUTED.          08220000
                                                                        08230000
           WRITE L355A-PRINT-REC       FROM L355-TOTAL-LINE AFTER 1.    08240000
           WRITE L355A-PRINT-REC       FROM L355-DASH-LINE AFTER 1.     08250000
                                                                        08260000
       4310-EXIT.                                                       08270000
           EXIT.                                                        08280000
                                                                        08290000
                                                                        08300000
      *--------------------------------*                                08310000
       4320-PRINT-DRAFT-FOOTER.                                         08320000
      *--------------------------------*                                08330000
           MOVE WS-TOTAL-COMPUTED      TO WS-AMT.                       08340000
                                                                        08350000
           PERFORM 8300-CONVT-AMT-WORD THRU 8300-EXIT.                  08360000
                                                                        08370000
           MOVE WP-ITEM (1)            TO L355-AMT-DESC1.               08380000
           MOVE WP-ITEM (2)            TO L355-AMT-DESC2.               08390000
                                                                        08400000
           WRITE L355A-PRINT-REC       FROM L355-TRAILER-01 AFTER 2.    08410000
           WRITE L355A-PRINT-REC       FROM L355-TRAILER-02 AFTER 3.    08420000
                                                                        08430000
       4320-EXIT.                                                       08440000
           EXIT.                                                        08450000
                                                                        08460000
                                                                        08470000
      *------->                                                         08480000
      * FOR THE FINAL REPORT COPY                                       08490000
      *--------------------------------*                                08500000
       6000-PROCESS-FINAL-REPORT.                                       08510000
      *--------------------------------*                                08520000
           PERFORM 8000-MOVE-DATA        THRU 8000-EXIT.                08530000
           PERFORM 8100-CALL-BP13C906    THRU 8100-EXIT.                08540000
           PERFORM 6100-CALL-AG07C907    THRU 6100-EXIT.                08550000
           PERFORM 6105-EARMARK-ACCOUNT  THRU 6105-EXIT.                08560000
                                                                        08570000
           IF B902-CDE-SYSERR NOT = ZEROES                              08580000
              DISPLAY 'ERROR CALLING AB05C902, STATUS = '               08590000
                       B902-CDE-SYSERR                                  08600000
              MOVE     '99'                 TO RETURN-CODE              08610000
              PERFORM  9000-CLOSE-FILES                                 08620000
           END-IF.                                                      08630000
                                                                        08640000
           IF B902-CDE-ERROR-ACCT(1) = SPACES                           08650000
              IF WS-NEW-HEADER = 'Y'                                    08660000
                 PERFORM 6110-WRITE-AG07-HDR THRU 6110-EXIT             08670000
                 MOVE 'N' TO  WS-NEW-HEADER                             08680000
                 MOVE 'Y' TO  WS-FOOTER-TAG                             08690000
              END-IF                                                    08700000
              PERFORM 6200-WRITE-AG07-TRANS THRU 6200-EXIT              08710000
              PERFORM 6300-WRITE-BP13K625   THRU 6300-EXIT              08720000
           END-IF.                                                      08730000
                                                                        08740000
       6000-EXIT.                                                       08750000
           EXIT.                                                        08760000
                                                                        08770000
                                                                        08780000
      *--------------------------------*                                08790000
       6100-CALL-AG07C907.                                              08800000
      *--------------------------------*                                08810000
           IF WS-NEW-VOUCHER-NO = 'Y'                                   08820000
      *      MOVE 'SU '                    TO C907-NUM-DDD              08830000
             MOVE 'SS '                    TO C907-NUM-DDD              08840000
             MOVE 'AG07K960'               TO C907-NUM-FILENME          08850000
                                                                        08860000
             CALL 'AG07C907'               USING AG07C907-AREA          08870000
                                                                        08880000
             EVALUATE C907-NUM-FILE-STATUS                              08890000
             WHEN 00                                                    08900000
               MOVE 'N'                    TO WS-NEW-VOUCHER-NO         08910000
             WHEN OTHER                                                 08920000
               DISPLAY 'AG07C907 - ERROR IN CALLING PROGRAM : '         08930000
                                              C907-NUM-FILE-STATUS      08940000
               MOVE C907-NUM-FILE-STATUS   TO WS-AG07-STAT-X            08950000
               MOVE WS-AG07-STATUS         TO RETURN-CODE               08960000
               PERFORM 9000-CLOSE-FILES    THRU 9000-EXIT               08970000
              END-EVALUATE                                              08980000
           END-IF.                                                      08990000
                                                                        09000000
       6100-EXIT.                                                       09010000
           EXIT.                                                        09020000
                                                                        09030000
                                                                        09040000
      *--------------------------------*                                09050000
       6105-EARMARK-ACCOUNT.                                            09060000
      *--------------------------------*                                09070000
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      09080000
           MOVE SPACES              TO   WS-B902-AREA.                  09090000
           INITIALIZE                    WS-B902-AREA.                  09100000
                                                                        09110000
           STRING C907-NUM-DDD  C907-NUM-FIN-YR                         09120000
                  C907-NUM-VR-SERIAL                                    09130000
                  DELIMITED BY SIZE INTO B902-VR-NO                     09140000
           END-STRING.                                                  09150000
                                                                        09160000
           MOVE 'E'                     TO   B902-CDE-TYPE.             09170000
           MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.         09180000
           MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.            09190000
           MOVE 'P13C355'               TO   B902-NUM-USERID-UPDATE.    09200000
           MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.   09210000
           MOVE 01                      TO   B902-NUM-HDB-REF-CNT.      09220000
           MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).       09230000
           MOVE ZEROES                  TO   WS-AMT-EARMARK.            09240000
                                                                        09250000
           IF F315-AMT-LEASE-FEE NUMERIC                                09260000
              COMPUTE WS-AMT-EARMARK    = F315-AMT-LEASE-FEE     +      09270000
                                          F315-AMT-LEASE-FEE-DUP +      09280000
                                          F315-AMT-SUB-TRF-DOA   +      09290000
                                          F315-AMT-SUB-TRF-DOA-DUP +    09300000
                                          F315-AMT-SELLER-STAMP-DUTY    09310000
           ELSE                                                         09320000
              MOVE ZEROES               TO   WS-AMT-EARMARK             09330000
           END-IF.                                                      09340000
                                                                        09350000
           IF WS-AMT-EARMARK  =  ZEROES                                 09360000
              GO  TO  6105-EXIT                                         09370000
           END-IF.                                                      09380000
                                                                        09390000
           MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).       09400000
                                                                        09410000
           DISPLAY '----------------'.                                  09420000
           DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                    09430000
           DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                 09440000
           DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.             09450000
           DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.                09460000
           DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.        09470000
           DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.          09480000
           DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).           09490000
           DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).           09500000
                                                                        09510000
           CALL 'AB05C902'  USING WS-B902-AREA.                         09520000
           DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).        09530000
           DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).        09540000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              09550000
              WHEN SPACES                                               09560000
                 CONTINUE                                               09570000
              WHEN OTHER                                                09580000
                 COMPUTE WS-TOTAL-COMPUTED = WS-TOTAL-COMPUTED -        09590000
                                             WS-AMT-EARMARK             09600000
                 PERFORM 8500-PRINT-L355D-REPORT     THRU 8500-EXIT     09610000
           END-EVALUATE.                                                09620000
                                                                        09630000
       6105-EXIT.                                                       09640000
           EXIT.                                                        09650000
                                                                        09660000
                                                                        09670000
      *--------------------------------*                                09680000
       6110-WRITE-AG07-HDR.                                             09690000
      *--------------------------------*                                09700000
           INITIALIZE AG07F225-HEADER.                                  09710000
                                                                        09720000
           MOVE SPACES                 TO AG07F225-HEADER.              09730000
           MOVE C907-NUM-DDD           TO F225-NUM-DDD.                 09740000
           MOVE C907-NUM-FIN-YR        TO F225-NUM-FIN-YEAR.            09750000
           MOVE C907-NUM-VR-SERIAL     TO F225-NUM-VR-SERIAL.           09760000
           MOVE F225-NUM-VR            TO WS-NUM-VOUCHER.               09770000
           MOVE SPACES                 TO F225-NUM-ROOT-ACCT.           09780000
           MOVE  00                    TO F225-NUM-REC-TYP.             09790000
           MOVE 'PV'                   TO F225-NUM-VR-TYP.              09800000
           MOVE 'TL'                   TO F225-NUM-VR-SUB-TYP.          09810000
           MOVE 'SOC'                  TO F225-NUM-TRANS-TYP.           09820000
                                                                        09830000
           MOVE WS-SYS-DATE            TO F225-DTE-VR-CREATE            09840000
                                          F225-DTE-VR-PRT-FINAL.        09850000
                                                                        09860000
           MOVE 'BP13C355'             TO F225-NUM-VR-CREATE-USERID     09870000
                                          F225-NUM-VR-PRT-FINAL-USERID. 09880000
                                                                        09890000
           MOVE 'DBSSSGSGXXX'             TO F225-NUM-PAYEE-BANK        09900000
           MOVE SPACES                    TO F225-NUM-PAYEE-BANK-BRNCH  09910000
           MOVE '0010468600'              TO F225-NUM-PAYEE-IBG-ACCT.   09920000
           MOVE 'STPFEE  '                TO F225-NUM-DDD-FILE-REF.     09930000
           MOVE 'COMMISSIONER OF STAMP DUTIES'                          09940000
                                          TO F225-NME-PAYEE1.           09950000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN1.       09960000
           MOVE SPACES                    TO F225-NME-PAYEE2.           09970000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN2.       09980000
           MOVE SPACES                    TO F225-NUM-PAYEE-TAX-REGN.   09990000
           MOVE '55'                      TO F225-NUM-BLK-HSE.          09991000
           MOVE 'NEWTON ROAD'             TO F225-NME-STREET.           09992000
           MOVE 'REVENUE HOUSE'           TO F225-NME-BLDNG.            09993000
           MOVE '307987'                  TO F225-NUM-POSTAL.           09994000
      *    MOVE 'C/O SC(STAMPING) OF SALES UNIT'                        10000000
      *                                   TO F225-NME-STREET            10010000
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-COLL-OFFCR.       10020000
           MOVE '64903783'                TO F225-NUM-COLL-OFFCR-PHONE. 10030000
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-CONTACT-OFFCR.    10040000
           MOVE '64903783'                TO F225-NUM-CONTACT-PHONE.    10050000
           MOVE SPACES                    TO F225-TXT-REJECT-HDR.       10060000
           MOVE 'STPFEE  '                TO F225-NUM-INTRFC-FR-HDR.    10070000
           MOVE 'CV'                      TO F225-NUM-ACTION-TYP.       10080000
           MOVE SPACES                    TO F225-NUM-PRCS-TERM.        10090000
           MOVE SPACES                    TO F225-NUM-ROUTE-FLAG.       10100000
           MOVE 'Y'                   TO F225-CDE-EARMARK-STAMP-FEE.    10110000
           IF F315-USERID   = 'BP13P001'                                10120000
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     10130000
                                             F225-NUM-USERID-START      10140000
           ELSE                                                         10150000
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP     10160000
                                             F225-NUM-USERID-START      10170000
           END-IF.                                                      10180000
           MOVE 'PREP'                    TO F225-NUM-VCHR-STATE-START. 10190000
           MOVE SPACES                    TO F225-DTE-PYMNT-DUE.        10200000
                                                                        10210000
           WRITE AG07F225-HEADER.                                       10220000
                                                                        10230000
           ADD 1                         TO WS-AG07F225-WRITE.          10240000
                                                                        10250000
           PERFORM  6400-PRINT-FINAL-HDR THRU 6400-EXIT.                10260000
                                                                        10270000
       6110-EXIT.                                                       10280000
           EXIT.                                                        10290000
                                                                        10300000
                                                                        10310000
      *--------------------------------*                                10320000
       6200-WRITE-AG07-TRANS.                                           10330000
      *--------------------------------*                                10340000
           INITIALIZE AG07F225-TRANS.                                   10350000
           MOVE SPACES                 TO AG07F225-TRANS.               10360000
                                                                        10370000
           ADD 1                       TO WS-AG07F225-WRITE             10380000
                                          WS-AG07F225-SERIAL.           10390000
                                                                        10400000
           MOVE WS-NUM-VOUCHER         TO F225-NUM-VR-T.                10410000
           MOVE WS-AG07F225-SERIAL     TO F225-NUM-TRANS-SERIAL.        10420000
           MOVE '04'                   TO F225-NUM-SYS.                 10430000
           MOVE F315-SCH-ACC           TO F225-NUM-HDB-REF.             10440000
           MOVE '0000000104250'        TO F225-NUM-GL-ACCT.             10450000
           MOVE SPACES                 TO F225-NUM-TAX-CDE.             10460000
           MOVE 'D'                    TO F225-NUM-TRANS-DR-CR.         10470000
           MOVE ZEROES                 TO F225-AMT-TRANS-GST.           10480000
           MOVE F315-REGN-NO           TO F225-TXT-INFO.                10490000
           MOVE SPACES                 TO F225-NUM-CPF.                 10500000
           MOVE SPACES                 TO F225-TXT-REJECT-DTL.          10510000
           MOVE 'STPFEE  '             TO F225-NUM-INTRFC-FR-T.         10520000
                                                                        10530000
           IF F315-AMT-LEASE-FEE NUMERIC                                10540000
             MOVE WS-TOTAL              TO F225-AMT-TRANS               10550000
           ELSE                                                         10560000
             MOVE ZEROES                TO F225-AMT-TRANS.              10570000
                                                                        10580000
           WRITE AG07F225-TRANS.                                        10590000
                                                                        10600000
           PERFORM 6500-PRINT-FINAL-DTL THRU 6500-EXIT.                 10610000
                                                                        10620000
       6200-EXIT.                                                       10630000
           EXIT.                                                        10640000
                                                                        10650000
                                                                        10660000
      *--------------------------------*                                10670000
       6300-WRITE-BP13K625.                                             10680000
      *--------------------------------*                                10690000
            INITIALIZE BP13K625-REC.                                    10700000
            MOVE SPACES                    TO BP13K625-REC.             10710000
                                                                        10720000
            PERFORM 6340-ASSIGN-NUMDOC  THRU 6340-EXIT.                 10730000
            PERFORM 6350-READ-BP13K800  THRU 6350-EXIT.                 10740000
                                                                        10750000
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.              10760000
                                                                        10770000
            PERFORM 6360-WRITE-BP13K625 THRU 6360-EXIT.                 10780000
                                                                        10790000
       6300-EXIT.                                                       10800000
           EXIT.                                                        10810000
                                                                        10820000
                                                                        10830000
      *--------------------------------*                                10840000
       6310-STARTBR-BP13K330.                                           10850000
      *--------------------------------*                                10860000
           MOVE SPACES                 TO WS-NUM-INCREASE-SCCC.         10870000
           MOVE ZEROES                 TO WS-DTE-DOC-PREPARE            10880000
           MOVE ZEROES                 TO WS-AMT-PURCHASE-PRICE         10890000
                                          WS-BP13K330-FND.              10900000
                                                                        10910000
           MOVE LOW-VALUES             TO K330-KEY-FLD.                 10920000
           MOVE F315-REGN-NO           TO K330-CURR-REG.                10930000
                                                                        10940000
           START BP13K330 KEY >= K330-KEY-FLD                           10950000
                                                                        10960000
           IF WS-BP13K330-STATUS NOT = 00                               10970000
             DISPLAY 'BP13K330 READ FILE ERROR : ' WS-BP13K330-STATUS   10980000
           END-IF.                                                      10990000
                                                                        11000000
       6310-EXIT.                                                       11010000
           EXIT.                                                        11020000
                                                                        11030000
                                                                        11040000
      *--------------------------------*                                11050000
       6320-READNEXT-BP13K330.                                          11060000
      *--------------------------------*                                11070000
           READ BP13K330 NEXT AT END                                    11080000
             MOVE HIGH-VALUES          TO K330-KEY-FLD                  11090000
             GO TO 6320-EXIT.                                           11100000
                                                                        11110000
           EVALUATE WS-BP13K330-STATUS                                  11120000
           WHEN 00                                                      11130000
             IF F315-REGN-NO  = K330-CURR-REG                           11140000
               MOVE K330-AMT-CURR-SELLPR   TO WS-AMT-PURCHASE-PRICE     11150000
               MOVE K330-NUM-INCREASE-SCCC TO WS-NUM-INCREASE-SCCC      11160000
               ADD 1                       TO WS-BP13K330-FND           11170000
             END-IF                                                     11180000
           WHEN 10                                                      11190000
             IF WS-BP13K330-FND NOT > ZEROES                            11200000
                DISPLAY 'BP13K330 RECORD NOT FOUND: ' K330-CURR-REG     11210000
                ADD 1                      TO WS-BP13K330-NFND          11220000
             END-IF                                                     11230000
           WHEN 23                                                      11240000
             DISPLAY 'BP13K330 RECORD NOT FOUND: ' K330-CURR-REG        11250000
             ADD 1                         TO WS-BP13K330-NFND          11260000
                                                                        11270000
           WHEN OTHER                                                   11280000
             DISPLAY 'BP13K330 READ FILE ERROR : ' WS-BP13K330-STATUS   11290000
             MOVE WS-BP13K330-STATUS       TO RETURN-CODE               11300000
             PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT               11310000
           END-EVALUATE.                                                11320000
                                                                        11330000
       6320-EXIT.                                                       11340000
           EXIT.                                                        11350000
                                                                        11360000
                                                                        11370000
      *--------------------------------*                                11380000
       6340-ASSIGN-NUMDOC.                                              11390000
      *--------------------------------*                                11400000
           PERFORM 6310-STARTBR-BP13K330  THRU 6310-EXIT.               11410000
           PERFORM 6320-READNEXT-BP13K330 THRU 6320-EXIT                11420000
             UNTIL F315-REGN-NO  NOT = K330-CURR-REG  OR                11430000
                   K330-KEY-FLD = HIGH-VALUES.                          11440000
                                                                        11450000
           MOVE F315-CDE-SUBTRANSFER-DOC  TO   WS-NUM-DOC.              11460000
                                                                        11470000
       6340-EXIT.                                                       11480000
           EXIT.                                                        11490000
                                                                        11500000
      *--------------------------------*                                11510000
       6350-READ-BP13K800.                                              11520000
      *--------------------------------*                                11530000
           MOVE SPACES                 TO BP13K800-MASTER.              11540000
           MOVE F315-REGN-NO           TO K800-NUM-REGN.                11550000
                                                                        11560000
           READ BP13K800.                                               11570000
           EVALUATE WS-BP13K800-STATUS                                  11580000
           WHEN 00                                                      11590000
             IF K800-NUM-FLAT-TYPE = SPACES OR LOW-VALUES               11600000
               MOVE ZEROES             TO WS-NUM-LEASE-TERM             11610000
             ELSE                                                       11620000
               IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                     11630000
                 COMPUTE WS-NUM-LEASE-TERM = 30 * 12                    11640000
               ELSE                                                     11650000
                 COMPUTE WS-NUM-LEASE-TERM = 99 * 12                    11660000
               END-IF                                                   11670000
            END-IF                                                      11680000
            ADD 1                      TO WS-BP13K800-FND               11690000
           WHEN 23                                                      11700000
             PERFORM 6355-READ-BP13K893 THRU 6355-EXIT                  11710000
           WHEN OTHER                                                   11720000
             DISPLAY 'BP13K800 READ FILE ERROR : ' WS-BP13K800-STATUS   11730000
             MOVE WS-BP13K800-STATUS   TO RETURN-CODE                   11740000
             PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                   11750000
           END-EVALUATE.                                                11760000
                                                                        11770000
       6350-EXIT.                                                       11780000
           EXIT.                                                        11790000
                                                                        11800000
      *--------------------------------*                                11810000
       6355-READ-BP13K893.                                              11820000
      *--------------------------------*                                11830000
                                                                        11840000
           MOVE SPACES                 TO BP13K893-MASTER.              11850000
           INITIALIZE                     BP13K893-MASTER.              11860000
           MOVE F315-REGN-NO           TO K893-NUM-REGN-HIST.           11870000
           MOVE 'N'                    TO WS-BP13K893-EOF               11880000
                                          WS-BP13K893-FND.              11890000
                                                                        11900000
           START BP13K893 KEY >= K893-KEY-FLD.                          11910000
                                                                        11920000
           EVALUATE WS-BP13K893-STATUS                                  11930000
           WHEN 00                                                      11940000
             WHEN 00                                                    11950000
                PERFORM 6356-NEXT-BP13K893    THRU 6356-EXIT            11960000
                  UNTIL K893-NUM-REGN-HIST NOT = F315-REGN-NO           11970000
                     OR WS-BP13K893-FND = 'Y'                           11980000
           WHEN 23                                                      11990000
                 DISPLAY 'NOT FOUND IN BP13K893' WS-BP13K893-STATUS     12000000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               12010000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               12020000
           WHEN OTHER                                                   12030000
                 DISPLAY 'ERROR IN STARTBR K893' WS-BP13K893-STATUS     12040000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               12050000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               12060000
           END-EVALUATE.                                                12070000
                                                                        12080000
           IF WS-BP13K893-FND = 'Y'                                     12090000
             MOVE BP13K893-MASTER(1:2000)   TO BP13K800-MASTER          12100000
             IF K800-NUM-FLAT-TYPE = SPACES OR LOW-VALUES               12110000
               MOVE ZEROES             TO WS-NUM-LEASE-TERM             12120000
             ELSE                                                       12130000
               IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                     12140000
                 COMPUTE WS-NUM-LEASE-TERM = 30 * 12                    12150000
               ELSE                                                     12160000
                 COMPUTE WS-NUM-LEASE-TERM = 99 * 12                    12170000
               END-IF                                                   12180000
             END-IF                                                     12190000
           END-IF.                                                      12200000
                                                                        12210000
       6355-EXIT.                                                       12220000
           EXIT.                                                        12230000
                                                                        12240000
      *--------------------------------*                                12250000
       6356-NEXT-BP13K893.                                              12260000
      *--------------------------------*                                12270000
                                                                        12280000
           READ BP13K893 NEXT RECORD                                    12290000
             AT END                                                     12300000
                MOVE 'Y'                  TO WS-BP13K893-EOF            12310000
           END-READ.                                                    12320000
                                                                        12330000
           EVALUATE WS-BP13K893-STATUS                                  12340000
              WHEN 00                                                   12350000
              WHEN 02                                                   12360000
                 IF K893-NUM-REGN-HIST = F315-REGN-NO                   12370000
                    MOVE 'Y'            TO  WS-BP13K893-EOF             12380000
                    MOVE 'Y'            TO  WS-BP13K893-FND             12390000
                 END-IF                                                 12400000
              WHEN 10                                                   12410000
              WHEN 23                                                   12420000
                 DISPLAY 'NOT FOUND IN BP13K893' WS-BP13K893-STATUS     12430000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               12440000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               12450000
              WHEN OTHER                                                12460000
                 DISPLAY 'ERROR IN READ NXT K893' WS-BP13K893-STATUS    12470000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               12480000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               12490000
           END-EVALUATE.                                                12500000
                                                                        12510000
       6356-EXIT.                                                       12520000
           EXIT.                                                        12530000
                                                                        12540000
                                                                        12550000
      *--------------------------------*                                12560000
       6360-WRITE-BP13K625.                                             12570000
      *--------------------------------*                                12580000
      *----> FOR F315-AMT-SUB-TRF-DOA                                   12590000
      *      WRITE DETAIL PART FOR ORIGINAL AGREEMENT LEASE             12600000
            MOVE 'O'                      TO WS-NUM-DOC-TYP.            12610000
            MOVE F315-AMT-SUB-TRF-DOA     TO WS-AMT-STAMP-DUTY.         12620000
            MOVE ZEROES                   TO WS-AMT-STAMP-DUTY-DUP.     12630000
                                                                        12640000
               IF WS-NUM-DOC = 'TWF' AND                                12650000
                   F315-AMT-LEASE-FEE NOT = ZEROES                      12660000
                  ADD  F315-AMT-LEASE-FEE     TO WS-AMT-STAMP-DUTY      12670000
                ELSE                                                    12680000
                  CONTINUE                                              12690000
              END-IF.                                                   12700000
                                                                        12710000
            IF   F315-AMT-SELLER-STAMP-DUTY IS NOT NUMERIC              12720000
            MOVE ZEROES   TO WS-AMT-SSD                                 12730000
                             F315-AMT-SELLER-STAMP-DUTY                 12740000
            ELSE                                                        12750000
            MOVE F315-AMT-SELLER-STAMP-DUTY TO WS-AMT-SSD               12760000
            END-IF.                                                     12770000
                                                                        12780000
            IF WS-NUM-DOC = 'TRA' OR 'TWF' OR 'RMP'                     12790000
               PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT        12800000
               PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT        12810000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        12820000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    12830000
               MOVE WS-AMT-SSD            TO K625-AMT-SELLER-DUTY       12840000
               IF WS-NUM-DOC = 'TWF' OR 'RMP'                           12850000
                  IF WS-AMT-STAMP-DUTY  = ZEROES  AND                   12860000
                     K625-NUM-VRCH  NOT = WS-NUM-TEMP-VOUCHER           12870000
                     MOVE  K625-NUM-VRCH  TO      WS-NUM-TEMP-VOUCHER   12880000
                     MOVE  'Y'            TO      K625-NUM-ZERO-STAMP   12890000
                  END-IF                                                12900000
               END-IF                                                   12910000
                                                                        12920000
               IF WS-NUM-DOC = 'TRA'                                    12930000
                  IF F315-AMT-LEASE-FEE NOT = ZEROES                    12940000
                     MOVE F315-AMT-LEASE-FEE     TO K625-AMT-STAMP-DUTY 12950000
                   ELSE                                                 12960000
                     MOVE ZEROES                 TO K625-AMT-STAMP-DUTY 12970000
                  END-IF                                                12980000
                  IF F315-AMT-SUB-TRF-DOA NOT = ZEROES                  12990000
                    ADD  F315-AMT-SUB-TRF-DOA TO K625-AMT-STAMP-DUTY    13000000
                  ELSE                                                  13010000
                    ADD  ZEROES               TO K625-AMT-STAMP-DUTY    13020000
                  END-IF                                                13030000
               END-IF                                                   13040000
                                                                        13050000
               WRITE BP13K625-REC                                       13060000
               ADD 1  TO WS-BP13K625-WRITE                              13070000
                                                                        13080000
               IF WS-NUM-DOC = 'TWF' OR 'RMP' OR 'TRA'                  13090000
                  GO TO 6360-EXIT                                       13100000
               END-IF                                                   13110000
            END-IF.                                                     13120000
                                                                        13130000
      *----> FOR F315-AMT-SUB-TRF-DOA-DUP                               13140000
      *      WRITE DETAIL PART FOR DUPLICATE AGREEMENT LEASE            13150000
            MOVE 'D'                      TO WS-NUM-DOC-TYP.            13160000
            MOVE ZEROES                   TO WS-AMT-STAMP-DUTY.         13170000
            MOVE F315-AMT-SUB-TRF-DOA-DUP TO WS-AMT-STAMP-DUTY-DUP.     13180000
                                                                        13190000
            IF WS-NUM-DOC = 'TRA'                                       13200000
               PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT        13210000
               PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT        13220000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        13230000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    13240000
               MOVE WS-AMT-SSD            TO K625-AMT-SELLER-DUTY       13250000
               WRITE BP13K625-REC                                       13260000
               ADD 1  TO WS-BP13K625-WRITE                              13270000
            END-IF.                                                     13280000
                                                                        13290000
      *----> FOR F315-AMT-LEASE-FEE                                     13300000
      *      WRITE DETAIL PART FOR ORIGINAL AGREEMENT LEASE             13310000
            MOVE 'O'                    TO WS-NUM-DOC-TYP.              13320000
            MOVE 'ALE'                  TO WS-NUM-DOC.                  13330000
            PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT.          13340000
            PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT.          13350000
            IF F315-AMT-LEASE-FEE NOT = ZEROES                          13360000
              MOVE F315-AMT-LEASE-FEE     TO K625-AMT-STAMP-DUTY        13370000
            ELSE                                                        13380000
              IF F315-AMT-SUB-TRF-DOA NOT = ZEROES                      13390000
                MOVE F315-AMT-SUB-TRF-DOA   TO K625-AMT-STAMP-DUTY      13400000
              ELSE                                                      13410000
                MOVE ZEROES                 TO K625-AMT-STAMP-DUTY      13420000
              END-IF                                                    13430000
            END-IF.                                                     13440000
            MOVE ZEROES                 TO K625-AMT-STAMP-DUTY-DUP.     13450000
            WRITE BP13K625-REC.                                         13460000
            ADD 1                       TO WS-BP13K625-WRITE.           13470000
                                                                        13480000
                                                                        13490000
      *----> FOR F315-AMT-SUB-TRF-DOA                                   13500000
      *      WRITE DETAIL PART FOR DUPLICATE AGREEMENT LEASE            13510000
            MOVE 'D'                    TO WS-NUM-DOC-TYP.              13520000
            MOVE 'ALE'                  TO WS-NUM-DOC.                  13530000
            PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT.          13540000
            PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT.          13550000
            MOVE ZEROES                 TO K625-AMT-STAMP-DUTY.         13560000
            MOVE F315-AMT-LEASE-FEE-DUP TO K625-AMT-STAMP-DUTY-DUP.     13570000
            WRITE BP13K625-REC.                                         13580000
            ADD 1                       TO WS-BP13K625-WRITE.           13590000
                                                                        13600000
       6360-EXIT.                                                       13610000
           EXIT.                                                        13620000
                                                                        13630000
                                                                        13640000
      *--------------------------------*                                13650000
       6370-CHK-EXISTING-BP13K625.                                      13660000
      *--------------------------------*                                13670000
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            13680000
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                13690000
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            13700000
           MOVE 1                       TO K625-NUM-DOC-CNT.            13710000
           MOVE 'N'                     TO WS-K625-EOF.                 13720000
                                                                        13730000
           START BP13K625 KEY = K625-KEY-FLD.                           13740000
                                                                        13750000
           EVALUATE  WS-BP13K625-STATUS                                 13760000
              WHEN '00'                                                 13770000
                    PERFORM 6380-READNEXT-BP13K625 THRU 6380-EXIT       13780000
                            UNTIL WS-K625-EOF = 'Y'                     13790000
                    ADD  1              TO WS-NUM-DOC-CNT               13800000
              WHEN '10'                                                 13810000
              WHEN '23'                                                 13820000
                    MOVE 1              TO WS-NUM-DOC-CNT               13830000
              WHEN OTHER                                                13840000
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     13850000
                    MOVE WS-BP13K625-STATUS TO RETURN-CODE              13860000
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT             13870000
           END-EVALUATE.                                                13880000
                                                                        13890000
       6370-EXIT.                                                       13900000
           EXIT.                                                        13910000
                                                                        13920000
                                                                        13930000
      *--------------------------------*                                13940000
       6380-READNEXT-BP13K625.                                          13950000
      *--------------------------------*                                13960000
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            13970000
              GO TO 6380-EXIT.                                          13980000
                                                                        13990000
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                14000000
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                14010000
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   14020000
              MOVE 'Y'                  TO WS-K625-EOF                  14030000
              GO TO 6380-EXIT                                           14040000
           END-IF.                                                      14050000
                                                                        14060000
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.              14070000
                                                                        14080000
       6380-EXIT.                                                       14090000
           EXIT.                                                        14100000
                                                                        14110000
                                                                        14120000
      *--------------------------------*                                14130000
       6390-MAIN-DETAILS-TO-K625.                                       14140000
      *--------------------------------*                                14150000
            MOVE SPACES                 TO BP13K625-REC.                14160000
            INITIALIZE                     BP13K625-REC.                14170000
                                                                        14180000
            MOVE F315-REGN-NO           TO K625-NUM-REGN.               14190000
            MOVE F315-SCH-ACC           TO K625-NUM-HDB-REF.            14200000
            MOVE WS-NUM-DOC             TO K625-NUM-DOC.                14210000
            MOVE WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.            14220000
            MOVE WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.            14230000
            MOVE C907-NUM-DDD           TO K625-NUM-DDD.                14240000
            MOVE C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.           14250000
            MOVE C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.          14260000
            MOVE C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.         14270000
            MOVE C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.           14280000
            MOVE C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.       14290000
      *     MOVE WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.        14300000
            MOVE ZEROES                 TO K625-AMT-ANNUAL-RENT.        14310000
            MOVE 'BP13C355'             TO K625-NUM-SYSTEM.             14320000
            MOVE ZEROES                 TO K625-AMT-LOAN.               14330000
            MOVE WS-AMT-PURCHASE-PRICE  TO K625-AMT-PURCHASE-PRICE.     14340000
            MOVE WS-NUM-INCREASE-SCCC   TO K625-NUM-INCREASE-SCCC.      14350000
            MOVE WS-NUM-LEASE-TERM      TO K625-NUM-LEASE-TERM.         14360000
            MOVE F315-DTE-PROC          TO K625-DTE-DOC-PREPARE         14370000
            MOVE WS-SYS-DATE            TO K625-DTE-UPDATE.             14380000
                                                                        14390000
       6390-EXIT.                                                       14400000
           EXIT.                                                        14410000
                                                                        14420000
      *--------------------------------*                                14430000
       6400-PRINT-FINAL-HDR.                                            14440000
      *--------------------------------*                                14450000
           MOVE SPACES                 TO L355B-PRINT-REC.              14460000
                                                                        14470000
           ADD 1                       TO WS-PAGENO-CTR.                14480000
           MOVE WS-PAGENO-CTR          TO L355-PAGE.                    14490000
                                                                        14500000
           STRING WS-SYS-DATE(7:2) '/' WS-SYS-DATE(5:2) '/'             14510000
                  WS-SYS-DATE(1:4)                                      14520000
                  DELIMITED BY SIZE    INTO L355-CURRENT-DATE.          14530000
                                                                        14540000
           STRING WS-NUM-BATCH-TYPE ' '                                 14550000
                  WS-NUM-FIN-YEAR   '-' WS-NUM-BATCH-SERIAL             14560000
                  DELIMITED BY SIZE    INTO L355-BATCH-NO.              14570000
                                                                        14580000
           MOVE WS-NUM-VOUCHER         TO L355-VOUCHER-NO.              14590000
                                                                        14600000
           MOVE 'BP13L355'             TO L355-REPORT-ID.               14610000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-01 AFTER PAGE.  14620000
                                                                        14630000
           MOVE "FINANCE'S COPY"       TO L355-COPY-NAME.               14640000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-02 AFTER 1.     14650000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-2A AFTER 1.     14660000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-03 AFTER 2.     14670000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-04 AFTER 2.     14680000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-05 AFTER 1.     14690000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-06 AFTER 1.     14700000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-07 AFTER 1.     14710000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-08 AFTER 1.     14720000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-09 AFTER 1.     14730000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-10 AFTER 3.     14740000
           WRITE L355B-PRINT-REC       FROM L355-HEADER-11 AFTER 1.     14750000
           MOVE SPACES                 TO L355B-PRINT-REC.              14760000
           WRITE L355B-PRINT-REC        AFTER 1.                        14770000
                                                                        14780000
       6400-EXIT.                                                       14790000
           EXIT.                                                        14800000
                                                                        14810000
                                                                        14820000
      *--------------------------------*                                14830000
       6500-PRINT-FINAL-DTL.                                            14840000
      *--------------------------------*                                14850000
           ADD 1                        TO WS-LINE-CTR.                 14860000
                                                                        14870000
           MOVE SPACES                  TO L355B-PRINT-REC              14880000
           MOVE WS-LINE-CTR             TO L355-SNO.                    14890000
                                                                        14900000
           WRITE L355B-PRINT-REC        FROM L355-DETAIL AFTER 1.       14910000
                                                                        14920000
           PERFORM 6600-PRINT-FINAL-TRL THRU 6600-EXIT.                 14930000
                                                                        14940000
       6500-EXIT.                                                       14950000
           EXIT.                                                        14960000
                                                                        14970000
                                                                        14980000
      *--------------------------------*                                14990000
       6600-PRINT-FINAL-TRL.                                            15000000
      *--------------------------------*                                15010000
           IF WS-LINE-CTR = 25 OR F315-REGN-NO = HIGH-VALUES            15020000
             PERFORM 6700-WRITE-AG07-TRL        THRU 6700-EXIT          15030000
             PERFORM 6800-WRITE-FINAL-COMPTOTAL THRU 6800-EXIT          15040000
             PERFORM 6900-WRITE-FINAL-FOOTER    THRU 6900-EXIT          15050000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          15060000
           END-IF.                                                      15070000
                                                                        15080000
       6600-EXIT.                                                       15090000
           EXIT.                                                        15100000
                                                                        15110000
                                                                        15120000
      *--------------------------------*                                15130000
       6700-WRITE-AG07-TRL.                                             15140000
      *--------------------------------*                                15150000
           INITIALIZE AG07F225-TRAILER.                                 15160000
           MOVE SPACES                 TO AG07F225-TRAILER.             15170000
                                                                        15180000
           ADD 1                       TO WS-AG07F225-WRITE.            15190000
           MOVE WS-NUM-VOUCHER         TO F225-NUM-VR-R.                15200000
           MOVE 99                     TO F225-NUM-TRAILER-SERIAL.      15210000
           MOVE 'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                 15220000
                                       TO F225-TXT-VOUCHER-NARRATION.   15230000
           MOVE WS-AG07F225-SERIAL     TO F225-QTY-VR-TRANS.            15240000
           MOVE WS-TOTAL-COMPUTED      TO F225-AMT-VR-DR-TOTAL.         15250000
           MOVE ZEROES                 TO F225-AMT-VR-CR-TOTAL.         15260000
           MOVE       SPACES           TO  F225-TXT-REJECT-TLR.         15270000
           MOVE       'STPFEE  '       TO  F225-NUM-INTRFC-FR.          15280000
                                                                        15290000
           WRITE AG07F225-TRAILER.                                      15300000
                                                                        15310000
           DISPLAY 'WS-FOOTER-TAG = ' WS-FOOTER-TAG.                    15320000
           MOVE  SPACE       TO  WS-FOOTER-TAG.                         15330000
                                                                        15340000
       6700-EXIT.                                                       15350000
           EXIT.                                                        15360000
                                                                        15370000
                                                                        15380000
      *--------------------------------*                                15390000
       6800-WRITE-FINAL-COMPTOTAL.                                      15400000
      *--------------------------------*                                15410000
           WRITE L355B-PRINT-REC       FROM L355-DASH-LINE AFTER 3.     15420000
                                                                        15430000
           MOVE WS-TOTAL-DOA           TO L355-TOTAL-DOA.               15440000
           MOVE WS-TOTAL-SSD           TO L355-TOTAL-SSD.               15450000
           MOVE WS-TOTAL-DUP-DOA       TO L355-TOTAL-DUP-DOA.           15460000
           MOVE WS-TOTAL-DUP-LEASE     TO L355-TOTAL-DUP-LEASE.         15470000
           MOVE WS-TOTAL-ACTUAL-LEASE  TO L355-TOTAL-ACTUAL-LEASE.      15480000
           MOVE WS-TOTAL-COMPUTED      TO L355-TOTAL-COMPUTED.          15490000
                                                                        15500000
           MOVE WS-LINE-CTR            TO L355-HIGH-NO.                 15510000
           WRITE L355B-PRINT-REC       FROM L355-TOTAL-LINE AFTER 1.    15520000
           WRITE L355B-PRINT-REC       FROM L355-DASH-LINE AFTER 1.     15530000
                                                                        15540000
       6800-EXIT.                                                       15550000
           EXIT.                                                        15560000
                                                                        15570000
                                                                        15580000
      *--------------------------------*                                15590000
       6900-WRITE-FINAL-FOOTER.                                         15600000
      *--------------------------------*                                15610000
           MOVE WS-TOTAL-COMPUTED      TO WS-AMT.                       15620000
                                                                        15630000
           PERFORM 8300-CONVT-AMT-WORD THRU 8300-EXIT.                  15640000
                                                                        15650000
           MOVE WP-ITEM (1)            TO L355-AMT-DESC1.               15660000
           MOVE WP-ITEM (2)            TO L355-AMT-DESC2.               15670000
                                                                        15680000
           WRITE L355B-PRINT-REC        FROM L355-TRAILER-01 AFTER 2.   15690000
           WRITE L355B-PRINT-REC        FROM L355-TRAILER-02 AFTER 3.   15700000
                                                                        15710000
       6900-EXIT.                                                       15720000
           EXIT.                                                        15730000
                                                                        15740000
                                                                        15750000
      *--------------------------------*                                15760000
       8000-MOVE-DATA.                                                  15770000
      *--------------------------------*                                15780000
           MOVE SPACES                 TO L355-DETAIL.                  15790000
                                                                        15800000
           PERFORM 6310-STARTBR-BP13K330  THRU 6310-EXIT.               15810000
           PERFORM 6320-READNEXT-BP13K330 THRU 6320-EXIT                15820000
             UNTIL F315-REGN-NO  NOT = K330-CURR-REG  OR                15830000
                   K330-KEY-FLD = HIGH-VALUES.                          15840000
                                                                        15850000
           MOVE F315-DTE-PROC          TO WS-DTE-DOC-PREPARE            15860000
           IF WS-DTE-DOC-PREPARE > ZEROES                               15870000
              STRING WS-DTE-DOC-PREPARE(7:2) '/'                        15880000
                     WS-DTE-DOC-PREPARE(5:2) '/'                        15890000
                     WS-DTE-DOC-PREPARE(1:4)                            15900000
                     DELIMITED BY SIZE INTO L355-AFL-DATE               15910000
           ELSE                                                         15920000
              PERFORM 8050-READ-BP13K410 THRU 8050-EXIT                 15930000
           END-IF.                                                      15940000
                                                                        15950000
           IF F315-NUM-HSE > SPACES                                     15960000
             MOVE '#'                  TO L355-CONST-1                  15970000
             MOVE '-'                  TO L355-CONST-2                  15980000
           END-IF.                                                      15990000
                                                                        16000000
           MOVE F315-NUM-BLK           TO L355-BLK-NO.                  16010000
           MOVE F315-NME-STREET        TO L355-STREET.                  16020000
           MOVE F315-NUM-MAIN          TO L355-UNIT-NO.                 16030000
           MOVE F315-NUM-LEVEL         TO L355-LEVEL-NO.                16040000
           MOVE F315-REGN-NO           TO L355-REGN-NO.                 16050000
                                                                        16060000
           STRING F315-SCH-ACC(1:4) '-' F315-SCH-ACC(5:4) '-'           16070000
                  F315-SCH-ACC(9:1) '-' F315-SCH-ACC(10:2)              16080000
                  DELIMITED BY SIZE    INTO L355-SCH-ACC.               16090000
                                                                        16100000
           MOVE F315-AMT-LEASE-FEE       TO L355-LEASE.                 16110000
           MOVE F315-AMT-LEASE-FEE-DUP   TO L355-DUP-LEASE.             16120000
           MOVE F315-AMT-SUB-TRF-DOA     TO L355-DOA.                   16130000
           MOVE F315-AMT-SUB-TRF-DOA-DUP TO L355-DUP-DOA.               16140000
                                                                        16150000
           IF   F315-AMT-SELLER-STAMP-DUTY IS NOT NUMERIC               16160000
           MOVE ZEROES    TO L355-SSD                                   16170000
                             F315-AMT-SELLER-STAMP-DUTY                 16180000
           ELSE                                                         16190000
           MOVE F315-AMT-SELLER-STAMP-DUTY TO L355-SSD                  16200000
           END-IF.                                                      16210000
                                                                        16220000
           COMPUTE WS-TOTAL              = F315-AMT-LEASE-FEE +         16230000
                                           F315-AMT-LEASE-FEE-DUP +     16240000
                                           F315-AMT-SUB-TRF-DOA +       16250000
                                           F315-AMT-SUB-TRF-DOA-DUP +   16260000
                                           F315-AMT-SELLER-STAMP-DUTY.  16270000
                                                                        16280000
           MOVE WS-TOTAL                 TO L355-TOTAL.                 16290000
                                                                        16300000
           COMPUTE WS-TOTAL-DOA          = WS-TOTAL-DOA +               16310000
                                           F315-AMT-SUB-TRF-DOA.        16320000
                                                                        16330000
           COMPUTE WS-TOTAL-DUP-DOA      = WS-TOTAL-DUP-DOA +           16340000
                                           F315-AMT-SUB-TRF-DOA-DUP.    16350000
                                                                        16360000
           COMPUTE WS-TOTAL-ACTUAL-LEASE = WS-TOTAL-ACTUAL-LEASE +      16370000
                                           F315-AMT-LEASE-FEE.          16380000
                                                                        16390000
           COMPUTE WS-TOTAL-DUP-LEASE    = WS-TOTAL-DUP-LEASE +         16400000
                                           F315-AMT-LEASE-FEE-DUP.      16410000
                                                                        16420000
           COMPUTE WS-TOTAL-SSD          = WS-TOTAL-SSD +               16430000
                                           F315-AMT-SELLER-STAMP-DUTY.  16440000
                                                                        16450000
           COMPUTE WS-TOTAL-COMPUTED     = WS-TOTAL-COMPUTED +          16460000
                                           WS-TOTAL.                    16470000
                                                                        16480000
       8000-EXIT.                                                       16490000
           EXIT.                                                        16500000
                                                                        16510000
                                                                        16520000
      *--------------------------------*                                16530000
       8050-READ-BP13K410.                                              16540000
      *--------------------------------*                                16550000
                                                                        16560000
            INITIALIZE K410-KEY-FLD.                                    16570000
            MOVE ZEROES TO K410-DTE-TR-EFFECTIVE.                       16580000
            MOVE F315-REGN-NO      TO  K410-KEY-FLD.                    16590000
            READ BP13K410.                                              16600000
            IF WS-BP13K410-STATUS = '00'                                16610000
              AND K410-DTE-TR-EFFECTIVE > ZEROES                        16620000
                 MOVE K410-DTE-TR-EFFECTIVE TO WS-DTE-DOC-PREPARE       16630000
                 STRING WS-DTE-DOC-PREPARE(7:2) '/'                     16640000
                        WS-DTE-DOC-PREPARE(5:2) '/'                     16650000
                        WS-DTE-DOC-PREPARE(1:4)                         16660000
                        DELIMITED BY SIZE INTO L355-AFL-DATE            16670000
            ELSE                                                        16680000
                 MOVE '  /  /    '  TO L355-AFL-DATE                    16690000
            END-IF.                                                     16700000
                                                                        16710000
                                                                        16720000
       8050-EXIT.                                                       16730000
           EXIT.                                                        16740000
                                                                        16750000
                                                                        16760000
      *--------------------------------*                                16770000
       8100-CALL-BP13C906.                                              16780000
      *--------------------------------*                                16790000
           IF WS-NEW-BATCH-NO = 'Y'                                     16800000
             MOVE 'SUBT'               TO C906-NUM-BATCH-TYPE           16810000
             MOVE 'BP13K620'           TO C906-NUM-FILENME              16820000
                                                                        16830000
             CALL 'BP13C906'           USING BP13C906-AREA              16840000
                                                                        16850000
             EVALUATE C906-NUM-FILE-STATUS                              16860000
             WHEN 00                                                    16870000
               MOVE C906-NUM-BATCH-TYPE   TO WS-NUM-BATCH-TYPE          16880000
               MOVE C906-NUM-FIN-YEAR     TO WS-NUM-FIN-YEAR            16890000
               MOVE C906-NUM-BATCH-SERIAL TO WS-NUM-BATCH-SERIAL        16900000
               MOVE 'N'                   TO WS-NEW-BATCH-NO            16910000
             WHEN OTHER                                                 16920000
               DISPLAY 'BP13C906 - ERROR IN CALLING PROGRAM : '         16930000
                                            C906-NUM-FILE-STATUS        16940000
               MOVE C906-NUM-FILE-STATUS  TO RETURN-CODE                16950000
               PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                16960000
             END-EVALUATE                                               16970000
           END-IF.                                                      16980000
                                                                        16990000
       8100-EXIT.                                                       17000000
           EXIT.                                                        17010000
                                                                        17020000
                                                                        17030000
      *--------------------------------*                                17040000
       8200-INITIALIZE-VARIABLES.                                       17050000
      *--------------------------------*                                17060000
           MOVE ZEROES                 TO WS-LINE-CTR                   17070000
                                          WS-TOTAL-COMPUTED             17080000
                                          WS-TOTAL-DOA                  17090000
                                          WS-TOTAL-SSD                  17100000
                                          WS-TOTAL-DUP-DOA              17110000
                                          WS-TOTAL-DUP-LEASE            17120000
                                          WS-TOTAL-ACTUAL-LEASE         17130000
                                          WS-AG07F225-SERIAL.           17140000
                                                                        17150000
           MOVE 'Y'                    TO WS-NEW-VOUCHER-NO             17160000
                                          WS-NEW-BATCH-NO               17170000
                                          WS-NEW-HEADER.                17180000
                                                                        17190000
       8200-EXIT.                                                       17200000
           EXIT.                                                        17210000
                                                                        17220000
                                                                        17230000
      *--------------------------*                                      17240000
       8500-PRINT-L355D-REPORT.                                         17250000
      *--------------------------*                                      17260000
           IF WS-L355D-REC-ON-PAGE-CNT > 65                             17270000
              PERFORM 8510-PRINT-L355D-HEADER     THRU 8510-EXIT        17280000
           END-IF.                                                      17290000
                                                                        17300000
           MOVE SPACES        TO L355D-REC-DETAIL.                      17310000
           INITIALIZE            L355D-REC-DETAIL.                      17320000
           ADD  1             TO WS-L355D-PRT-CNT.                      17330000
           MOVE WS-L355D-PRT-CNT  TO L355D-SERIAL-NO.                   17340000
                                                                        17350000
           STRING F315-SCH-ACC(1:4) '-'                                 17360000
                  F315-SCH-ACC(5:4) '-'                                 17370000
                  F315-SCH-ACC(9:1) '-'                                 17380000
                  F315-SCH-ACC(10:2)                                    17390000
                  DELIMITED BY SIZE INTO L355D-SCH-ACC                  17400000
           END-STRING.                                                  17410000
                                                                        17420000
           MOVE F315-REGN-NO      TO L355D-REGN-NO.                     17430000
           STRING C907-NUM-DDD    '-'                                   17440000
                  C907-NUM-FIN-YR '-'                                   17450000
                  C907-NUM-VR-SERIAL                                    17460000
                  DELIMITED BY SIZE INTO L355D-JR-VCHR-NO               17470000
           END-STRING.                                                  17480000
           MOVE WS-AMT-EARMARK    TO L355D-AMT-TOTAL.                   17490000
                                                                        17500000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              17510000
              WHEN 'S0053'                                              17520000
                 MOVE 'AB05K009 FILE ERROR'        TO L355D-ERROR-DESC  17530000
              WHEN 'S0054'                                              17540000
                 MOVE 'B05K006 REC NOT FND'        TO L355D-ERROR-DESC  17550000
              WHEN 'S0045'                                              17560000
                 MOVE 'B05K006 FILE ERROR'         TO L355D-ERROR-DESC  17570000
              WHEN 'S0055'                                              17580000
                 MOVE 'DOESN''T HAVE ENOUGH BALANCE'                    17590000
                                                   TO L355D-ERROR-DESC  17600000
              WHEN OTHER                                                17610000
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L355D-ERROR-DESC  17620000
           END-EVALUATE.                                                17630000
                                                                        17640000
           WRITE L355D-PRINT-REC  FROM L355D-REC-DETAIL  AFTER 1.       17650000
                                                                        17660000
           ADD   1     TO  WS-L355D-REC-ON-PAGE-CNT.                    17670000
                                                                        17680000
       8500-EXIT.                                                       17690000
           EXIT.                                                        17700000
                                                                        17710000
                                                                        17720000
      *-------------------------*                                       17730000
       8510-PRINT-L355D-HEADER.                                         17740000
      *-------------------------*                                       17750000
           ADD  1                 TO   WS-L355D-PAGE-CNT.               17760000
           MOVE WS-L355D-PAGE-CNT TO   L355-PAGE.                       17770000
           MOVE 'P13L355D'        TO   L355-REPORT-ID.                  17780000
           WRITE L355D-PRINT-REC  FROM L355-HEADER-01    AFTER PAGE.    17790000
           WRITE L355D-PRINT-REC  FROM L355D-HEADER2     AFTER 2.       17800000
           WRITE L355D-PRINT-REC  FROM L355D-HEADER3     AFTER 2.       17810000
           WRITE L355D-PRINT-REC  FROM L355D-UNDERLINE   AFTER 1.       17820000
           MOVE  6                TO   WS-L355D-REC-ON-PAGE-CNT.        17830000
                                                                        17840000
       8510-EXIT.                                                       17850000
           EXIT.                                                        17860000
                                                                        17870000
                                                                        17880000
      *--------------------------------*                                17890000
       9000-CLOSE-FILES.                                                17900000
      *--------------------------------*                                17910000
           CLOSE BP13F315                                               17920000
                 BP13K330                                               17930000
                 BP13K410                                               17940000
                 BP13K625                                               17950000
                 BP13K800                                               17960000
                 BP13K893                                               17970000
                 AG07F225                                               17980000
                 P13L355A                                               17990000
                 P13L355B                                               18000000
                 P13L355D.                                              18010000
                                                                        18020000
           IF WS-BP13K800-STATUS NOT = 00                               18030000
              DISPLAY 'BP13K800 CLOSE FILE ERROR :' WS-BP13K800-STATUS  18040000
              MOVE WS-BP13K800-STATUS   TO RETURN-CODE                  18050000
           END-IF.                                                      18060000
                                                                        18070000
           IF WS-BP13K893-STATUS NOT = 00                               18080000
              DISPLAY 'BP13K893 CLOSE FILE ERROR :' WS-BP13K893-STATUS  18090000
              MOVE WS-BP13K893-STATUS   TO RETURN-CODE                  18100000
           END-IF.                                                      18110000
                                                                        18120000
           IF WS-BP13K410-STATUS NOT = 00                               18130000
              DISPLAY 'BP13K410 CLOSE FILE ERROR :' WS-BP13K410-STATUS  18140000
              MOVE WS-BP13K410-STATUS   TO RETURN-CODE                  18150000
           END-IF.                                                      18160000
                                                                        18170000
           IF WS-BP13K330-STATUS NOT = 00                               18180000
              DISPLAY 'BP13K330 CLOSE FILE ERROR : ' WS-BP13K330-STATUS 18190000
              MOVE WS-BP13K330-STATUS   TO RETURN-CODE                  18200000
           END-IF.                                                      18210000
                                                                        18220000
           IF WS-BP13K625-STATUS NOT = 00                               18230000
              DISPLAY 'BP13K625 CLOSE FILE ERROR : ' WS-BP13K625-STATUS 18240000
              MOVE WS-BP13K625-STATUS   TO RETURN-CODE                  18250000
           END-IF.                                                      18260000
                                                                        18270000
           MOVE 'AG07K960'              TO C907-NUM-FILENME.            18280000
                                                                        18290000
           CALL 'K960CLSE'              USING AG07C907-AREA.            18300000
                                                                        18310000
           IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                18320000
             DISPLAY 'AG07K960 CLOSE FILE ERROR :' C907-NUM-FILE-STATUS 18330000
             MOVE C907-NUM-FILE-STATUS  TO WS-AG07-STAT-X               18340000
             MOVE WS-AG07-STATUS        TO RETURN-CODE                  18350000
           END-IF.                                                      18360000
                                                                        18370000
           MOVE 'BP13K620'              TO C906-NUM-FILENME.            18380000
           CALL 'K620MCLS'              USING BP13C906-AREA.            18390000
                                                                        18400000
           IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                18410000
             DISPLAY 'BP13K620 CLOSE FILE ERROR :' C906-NUM-FILE-STATUS 18420000
             MOVE C906-NUM-FILE-STATUS  TO RETURN-CODE                  18430000
           END-IF.                                                      18440000
                                                                        18450000
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     18460000
           MOVE SPACES              TO   WS-B902-AREA.                  18470000
           INITIALIZE                    WS-B902-AREA.                  18480000
           MOVE 'C'                 TO   B902-CDE-TYPE.                 18490000
           CALL 'AB05C902'  USING WS-B902-AREA.                         18500000
                                                                        18510000
           IF B902-CDE-ERROR NOT = ZEROES                               18520000
              MOVE B902-CDE-SYSERR      TO   RETURN-CODE                18530000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             18540000
           END-IF.                                                      18550000
                                                                        18560000
           DISPLAY SPACES.                                              18570000
           DISPLAY '***********************'.                           18580000
           DISPLAY ' PROGRAM ID : BP13C355 '.                           18590000
           DISPLAY '***********************'.                           18600000
           DISPLAY SPACES.                                              18610000
           DISPLAY 'NO OF REC READ      BP13F315  : ' WS-BP13F315-READ. 18620000
           DISPLAY 'NO OF REC FOUND     BP13K330  : ' WS-BP13K330-FND.  18630000
           DISPLAY 'NO OF REC FOUND     BP13K800  : ' WS-BP13K800-FND.  18640000
           DISPLAY SPACES.                                              18650000
           DISPLAY 'NO OF REC NOT FOUND BP13K330  : ' WS-BP13K330-NFND. 18660000
           DISPLAY 'NO OF REC NOT FOUND BP13K800  : ' WS-BP13K800-NFND. 18670000
           DISPLAY 'NO OF REC WRITTEN   AG07F225  : ' WS-AG07F225-WRITE.18680000
           DISPLAY 'NO OF REC WRITTEN   BP13F315  : ' WS-BP13F315-REWRT.18690000
           DISPLAY 'NO OF REC WRITTEN   BP13K625  : ' WS-BP13K625-WRITE.18700000
           DISPLAY 'NO OF RECS WITH EARMARK ERROR : ' WS-L355D-PRT-CNT. 18710000
                                                                        18720000
           STOP RUN.                                                    18730000
                                                                        18740000
       9000-EXIT.                                                       18750000
           EXIT.                                                        18760000
                                                                        18770000
                                                                        18780000
      *--------------------------------*                                18790000
       8300-CONVT-AMT-WORD.                                             18800000
      *--------------------------------*                                18810000
            MOVE SPACES                TO WF-DETAILS.                   18820000
                                                                        18830000
            MOVE ZEROES                TO WS-SWITCH WS-THO-SW           18840000
                                          WS-CNT-SW WS-LIT-SW           18850000
                                          WS-TEN-SW WS-AND-SW.          18860000
                                                                        18870000
            MOVE 60                    TO WS-PLACE-COUNTER.             18880000
                                                                        18890000
            MOVE 1                     TO WF-SUB.                       18900000
                                                                        18910000
            PERFORM B000-ROUTINE THRU B990-EXIT                         18920000
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  18930000
                                                                        18940000
       8300-EXIT.                                                       18950000
           EXIT.                                                        18960000
                                                                        18970000
                                                                        18980000
      *--------------------------------*                                18990000
       B000-ROUTINE SECTION.                                            19000000
      *--------------------------------*                                19010000
       B000-GO.                                                         19020000
           IF WS-DIGIT (WS-SUB) = ZERO                                  19030000
             IF WS-TEN-SW = ZERO                                        19040000
               GO TO B800-MOVE-TYPE                                     19050000
             ELSE                                                       19060000
               GO TO B010-PROCESS                                       19070000
             END-IF                                                     19080000
           END-IF.                                                      19090000
                                                                        19100000
           IF WS-FIRST-SUB = ZERO                                       19110000
             MOVE WS-SUB               TO WS-FIRST-SUB.                 19120000
                                                                        19130000
           IF WS-SWITCH = ZERO                                          19140000
             MOVE 1                    TO WS-SWITCH.                    19150000
                                                                        19160000
       B010-PROCESS.                                                    19170000
           IF WS-SUB = 8                                                19180000
             MOVE 9                    TO WS-CNT-SW.                    19190000
                                                                        19200000
           IF WS-SUB = 9                                                19210000
             IF WS-CNT-SW = ZERO                                        19220000
               MOVE WS-DIGIT (WS-SUB)  TO WS-CNT-SW                     19230000
             END-IF                                                     19240000
           END-IF.                                                      19250000
                                                                        19260000
           IF WS-SUB = 2 OR 3 OR 4                                      19270000
             MOVE 1                    TO WS-THO-SW.                    19280000
                                                                        19290000
           MOVE WS-DIGIT(WS-SUB)       TO WA-SUB.                       19300000
                                                                        19310000
           IF WS-SUB = 3 OR 6 OR 8                                      19320000
             IF WS-DIGIT (WS-SUB) = 1                                   19330000
               MOVE 1                  TO WS-TEN-SW                     19340000
               GO TO B990-EXIT                                          19350000
             ELSE                                                       19360000
               ADD 18                  TO WA-SUB                        19370000
             END-IF                                                     19380000
           ELSE                                                         19390000
             IF WS-SUB = 1 OR 4 OR 7 OR 9                               19400000
               IF WS-TEN-SW = 1                                         19410000
                 MOVE 0                TO WS-TEN-SW                     19420000
                 ADD 10                TO WA-SUB                        19430000
               END-IF                                                   19440000
             END-IF                                                     19450000
           END-IF.                                                      19460000
                                                                        19470000
           MOVE WA-NAME(WA-SUB)        TO WL-AREA.                      19480000
                                                                        19490000
           PERFORM R000-LOAD-IN.                                        19500000
                                                                        19510000
       B300-TENS.                                                       19520000
           IF WS-SUB = 3 OR 6 OR 8                                      19530000
             GO TO B990-EXIT.                                           19540000
                                                                        19550000
       B400-MOVE-HUNDRED.                                               19560000
           IF WS-SUB = 2 OR 5                                           19570000
             MOVE L-HUNDRED            TO WL-AREA                       19580000
             MOVE 1                    TO WS-LIT-SW                     19590000
             PERFORM R000-LOAD-IN                                       19600000
             MOVE 1                    TO WS-AND-SW                     19610000
             GO TO B990-EXIT.                                           19620000
                                                                        19630000
       B800-MOVE-TYPE.                                                  19640000
           IF WS-SWITCH = ZERO                                          19650000
             GO TO B990-EXIT.                                           19660000
                                                                        19670000
           IF WS-SUB = 1                                                19680000
             MOVE L-MILLION            TO WL-AREA                       19690000
             MOVE 1                    TO WS-LIT-SW                     19700000
             MOVE 1                    TO WS-AND-SW                     19710000
             GO TO B880-LOAD-IN.                                        19720000
                                                                        19730000
            IF WS-SUB = 7                                               19740000
              MOVE 1 TO WS-LIT-SW WS-AND-SW                             19750000
              IF WS-FIRST-SUB = 7  AND                                  19760000
                WS-DIGIT (WS-SUB) = 1                                   19770000
                MOVE L-DOLLAR          TO WL-AREA                       19780000
                GO TO B880-LOAD-IN                                      19790000
               ELSE                                                     19800000
                 MOVE L-DOLLARS        TO WL-AREA                       19810000
                 GO TO B880-LOAD-IN                                     19820000
               END-IF                                                   19830000
            END-IF.                                                     19840000
                                                                        19850000
            IF WS-SUB = 4 AND WS-THO-SW = 1                             19860000
              MOVE 1                   TO WS-AND-SW WS-LIT-SW           19870000
              MOVE L-THOUSAND          TO WL-AREA                       19880000
              GO TO B880-LOAD-IN.                                       19890000
                                                                        19900000
            IF WS-SUB = 9                                               19910000
              MOVE 1 TO WS-LIT-SW                                       19920000
              IF WS-CNT-SW = ZERO                                       19930000
                MOVE L-ONLY            TO WL-AREA                       19940000
                GO TO B880-LOAD-IN                                      19950000
              ELSE                                                      19960000
                IF WS-CNT-SW = 1                                        19970000
                  MOVE L-CENT          TO WL-AREA                       19980000
                  PERFORM R000-LOAD-IN                                  19990000
                  MOVE L-ONLY          TO WL-AREA                       20000000
                  GO TO B880-LOAD-IN                                    20010000
                ELSE                                                    20020000
                  MOVE L-CENTS         TO WL-AREA                       20030000
                  PERFORM R000-LOAD-IN                                  20040000
                  MOVE L-ONLY          TO WL-AREA                       20050000
                  GO TO B880-LOAD-IN                                    20060000
                END-IF                                                  20070000
              END-IF                                                    20080000
            END-IF.                                                     20090000
                                                                        20100000
            GO TO B990-EXIT.                                            20110000
                                                                        20120000
       B880-LOAD-IN.                                                    20130000
            PERFORM R000-LOAD-IN.                                       20140000
                                                                        20150000
       B990-EXIT.                                                       20160000
            EXIT.                                                       20170000
                                                                        20180000
      *--------------------------------*                                20190000
       R000-LOAD-IN SECTION.                                            20200000
      *--------------------------------*                                20210000
                                                                        20220000
       R001-GO.                                                         20230000
            IF WS-LIT-SW = 1                                            20240000
               MOVE ZERO TO WS-LIT-SW                                   20250000
               GO TO R050-CONT.                                         20260000
                                                                        20270000
            IF WS-SUB = 2 OR 5                                          20280000
               GO TO R050-CONT.                                         20290000
                                                                        20300000
       R025-ADD-TEST.                                                   20310000
            IF WS-AND-SW NOT = 1                                        20320000
               GO TO R050-CONT.                                         20330000
                                                                        20340000
            MOVE ZERO TO WS-AND-SW.                                     20350000
            MOVE WL-AREA TO WL-AREA-SAVE.                               20360000
            MOVE L-AND TO WL-AREA.                                      20370000
            PERFORM R200-LOADUP.                                        20380000
            MOVE WL-AREA-SAVE TO WL-AREA.                               20390000
                                                                        20400000
       R050-CONT.                                                       20410000
            PERFORM R200-LOADUP.                                        20420000
                                                                        20430000
       R099-EXIT.                                                       20440000
            EXIT.                                                       20450000
                                                                        20460000
      *--------------------------------*                                20470000
       R200-LOADUP SECTION.                                             20480000
      *--------------------------------*                                20490000
       R201-GO.                                                         20500000
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       20510000
            IF  WS-RESULT > WS-PLACE-COUNTER                            20520000
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    20530000
                ADD 60 TO WS-PLACE-COUNTER.                             20540000
                                                                        20550000
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          20560000
                    WL-ITEM (WL-SUB) = L-X.                             20570000
                                                                        20580000
       R490-EXIT.                                                       20590000
           EXIT.                                                        20600000
                                                                        20610000
      *--------------------------------*                                20620000
       R500-LOAD SECTION.                                               20630000
      *--------------------------------*                                20640000
       R501-GO.                                                         20650000
                                                                        20660000
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  20670000
            ADD  1                TO WF-SUB.                            20680000
            IF WL-ITEM (WL-SUB) = SPACE                                 20690000
               ADD   1     TO     WL-SUB                                20700000
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      20710000
               SUBTRACT 1  FROM   WL-SUB.                               20720000
                                                                        20730000
       R990-EXIT.                                                       20740000
            EXIT.                                                       20750000
