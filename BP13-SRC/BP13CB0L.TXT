      **************************                                        00010000
       IDENTIFICATION DIVISION.                                         00020000
      **************************                                        00030000
       PROGRAM-ID.    BP13CB0L.                                         00040000
      *AUTHOR.        MARGE LAM KO.                                     00050000
      *DATE-WRITTEN.  26 APR 2017.                                      00060000
                                                                        00070000
      * =========================================================== *   00080000
      * SYSTEM OF COMMITMENT (BP13)                                 *   00090000
      * =========================================================== *   00100000
      *   OBJECTIVE   : THIS PROGRAM RETRIEVES RECORDS FROM         *   00110000
      *                 BP13FD05 AND BP13KD00 TO CREATE RECORDS TO  *   00120000
      *                 GRANT_ASMNT AND GRANT_ASMNT_PERSON          *   00130000
      *                 SO THAT THEY ARE SYNCHRONIZED               *   00140000
      *                 IF THERE IS RECOVERY, WRITE TO GRANT_RCVRY, *   00150000
      *                 EX_GRANT_ASMNT, EX_GRANT_ASMNT_PERSON INSTEAD   00160000
      *                 FOR HGT/TUG/PHG (DBSS)                      *   00170000
      *   INPUT FILES :                                             *   00180000
      *   1.  BP13FD05                                              *   00190000
      *   2.  BP13KD00 - DBSS MASTER                                *   00200000
      *   3.  BP13K800 - APPLN MASTER                               *   00210000
      *   4.  BP13K820 - TO GET CSTMR SOURCE                        *   00220000
      *   5.  BP13K893 - IF NOT IN K800                             *   00230000
      *   6.  BP13K895 - TO GET CSTMR SOURCE (IF NOT IN K820)       *   00240000
      *                                                             *   00250000
      *   TABLES:                                                   *   00260000
      *   1.  GRANT_ASMNT                                           *   00270000
      *   2.  GRANT_ASMNT_PERSON                                    *   00280000
      *   3.  GRANT_RCVRY                                           *   00290000
      *   4.  EX_GRANT_ASMNT                                        *   00300000
      *   5.  EX_GRANT_ASMNT_PERSON                                 *   00310000
      *   6.  GRANT_UPDATE_LOG                                      *   00320000
      *                                                             *   00330000
      * CHQ REQ     DATE     BY  DESCRIPTIONS                       *   00340000
      * -------- ---------- ---- ---------------------------------- *   00350000
      * BP13     26/04/2017 MRN1 NEW PROGRAM                        *   00360000
      * BP138971 15/12/2021 KR13 CATER FOR NEW FIN SERIES 'M'       *   00361002
      * =========================================================== *   00370000
                                                                        00380000
       ENVIRONMENT DIVISION.                                            00390000
                                                                        00400000
       CONFIGURATION SECTION.                                           00410000
                                                                        00420000
       SOURCE-COMPUTER. IBM-3090.                                       00430000
       OBJECT-COMPUTER. IBM-3090.                                       00440000
                                                                        00450000
       INPUT-OUTPUT SECTION.                                            00460000
                                                                        00470000
       FILE-CONTROL.                                                    00480000
                                                                        00490000
           SELECT BP13FD05 ASSIGN TO BP13FD05.                          00500000
                                                                        00510000
           SELECT BP13KD00 ASSIGN TO BP13KD00                           00520000
                  ACCESS MODE     IS RANDOM                             00530000
                  ORGANIZATION    IS INDEXED                            00540000
                  RECORD KEY      IS KD00-KEY-FLD                       00550000
                  FILE STATUS     IS WS-KD00-STATUS.                    00560000
                                                                        00570000
           SELECT BP13K800 ASSIGN TO BP13K800                           00580000
                  ACCESS MODE     IS DYNAMIC                            00590000
                  ORGANIZATION    IS INDEXED                            00600000
                  RECORD KEY      IS K800-NUM-REGN                      00610000
                  FILE STATUS     IS WS-K800-STATUS.                    00620000
                                                                        00630000
           SELECT BP13K820 ASSIGN TO BP13K820                           00640000
                  ACCESS MODE     IS DYNAMIC                            00650000
                  ORGANIZATION    IS INDEXED                            00660000
                  RECORD KEY      IS K820-KEY-FLD                       00670000
                  FILE STATUS     IS WS-K820-STATUS.                    00680000
                                                                        00690000
           SELECT BP13K893 ASSIGN TO BP13K893                           00700000
                  ACCESS MODE     IS DYNAMIC                            00710000
                  ORGANIZATION    IS INDEXED                            00720000
                  RECORD KEY      IS K893-KEY-FLD                       00730000
                  FILE STATUS     IS WS-K893-STATUS.                    00740000
                                                                        00750000
           SELECT BP13K895 ASSIGN TO BP13K895                           00760000
                  ACCESS MODE     IS DYNAMIC                            00770000
                  ORGANIZATION    IS INDEXED                            00780000
                  RECORD KEY      IS K895-KEY-FLD                       00790000
                  FILE STATUS     IS WS-K895-STATUS.                    00800000
                                                                        00810000
       DATA DIVISION.                                                   00820000
                                                                        00830000
       FILE SECTION.                                                    00840000
                                                                        00850000
       FD   BP13FD05                                                    00860000
            RECORD CONTAINS 500 CHARACTERS                              00870000
            LABEL RECORDS ARE OMITTED                                   00880000
            RECORDING MODE IS F.                                        00890000
       COPY BP13KD05.                                                   00900000
                                                                        00910000
       FD   BP13KD00                                                    00920000
            RECORD CONTAINS 1600 CHARACTERS.                            00930000
       COPY BP13KD00.                                                   00940000
                                                                        00950000
       FD   BP13K800                                                    00960000
            RECORD CONTAINS 2000 CHARACTERS.                            00970000
       COPY BP13K800.                                                   00980000
                                                                        00990000
       FD   BP13K820                                                    01000000
            RECORD IS VARYING IN SIZE FROM 01 TO 400.                   01010000
      *     RECORD CONTAINS 400 CHARACTERS.                             01020000
       COPY BP13K820.                                                   01030000
                                                                        01040000
       FD   BP13K893                                                    01050000
            RECORD CONTAINS 2050 CHARACTERS.                            01060000
       COPY BP13K893.                                                   01070000
                                                                        01080000
       FD  BP13K895                                                     01090000
           RECORD CONTAINS 450 CHARACTERS.                              01100000
       COPY BP13K895.                                                   01110000
                                                                        01120000
       COPY AV02COMM.                                                   01130000
                                                                        01140000
      *************************                                         01150000
       WORKING-STORAGE SECTION.                                         01160000
      *************************                                         01170000
                                                                        01180000
       01  WS-KD00-STATUS         PIC 9(02) VALUE ZEROES.               01190000
       01  WS-K800-STATUS         PIC 9(02) VALUE ZEROES.               01200000
       01  WS-K820-STATUS         PIC 9(02) VALUE ZEROES.               01210000
       01  WS-K893-STATUS         PIC 9(02) VALUE ZEROES.               01220000
       01  WS-K895-STATUS         PIC 9(02) VALUE ZEROES.               01230000
       01  WS-CTR                 PIC 9(02) VALUE ZEROES.               01240000
       01  WS-HGT-CTR             PIC 9(02) VALUE ZEROES.               01250000
       01  WS-TUG-CTR             PIC 9(02) VALUE ZEROES.               01260000
       01  WS-AHG-CTR             PIC 9(02) VALUE ZEROES.               01270000
       01  WS-SHG-CTR             PIC 9(02) VALUE ZEROES.               01280000
       01  WS-SUG-CTR             PIC 9(02) VALUE ZEROES.               01290000
       01  WS-PHG-CTR             PIC 9(02) VALUE ZEROES.               01300000
       01  CNT-FD05-READ          PIC 9(06) VALUE ZEROES.               01310000
       01  WS-MATCH-REC           PIC 9(06) VALUE ZEROES.               01320000
       01  WS-NOT-CREATED         PIC 9(06) VALUE ZEROES.               01330000
       01  WS-CREATED             PIC 9(06) VALUE ZEROES.               01340000
       01  CNT-ASMNT-INSERT       PIC 9(06) VALUE ZEROES.               01350000
       01  CNT-PERSN-INSERT       PIC 9(06) VALUE ZEROES.               01360000
       01  CNT-EX-ASMNT-INS       PIC 9(06) VALUE ZEROES.               01370000
       01  CNT-EX-PERSN-INS       PIC 9(06) VALUE ZEROES.               01380000
       01  CNT-RCVRY-INSERT       PIC 9(06) VALUE ZEROES.               01390000
       01  WS-GRNT-UPD-LOG        PIC 9(06) VALUE ZEROES.               01400000
       01  WS-SNO1                PIC 9(06) VALUE ZEROES.               01410000
       01  WS-SNO2                PIC 9(06) VALUE ZEROES.               01420000
       01  WS-CNT-GRANT           PIC 9(06) VALUE ZEROES.               01430000
       01  WS-CNT-PERSON          PIC 9(06) VALUE ZEROES.               01440000
       01  WS-CNT-EXGRANT         PIC 9(06) VALUE ZEROES.               01450000
       01  WS-CNT-EXPERSON        PIC 9(06) VALUE ZEROES.               01460000
       01  WS-CNT-RCVRY           PIC 9(06) VALUE ZEROES.               01470000
       01  WS-EOF-FD05            PIC X     VALUE SPACE.                01480000
       01  WS-EOF-K895            PIC X(01) VALUE 'N'.                  01490000
       01  WS-EOF-K828            PIC X(01) VALUE 'N'.                  01500000
       01  WS-FND-KD00            PIC X(01) VALUE 'N'.                  01510000
       01  WS-FND-K893            PIC X(01) VALUE 'N'.                  01520000
       01  WS-FND-K800            PIC X(01) VALUE 'N'.                  01530000
       01  WS-GRANT-ASMNT-FND     PIC X     VALUE SPACE.                01540000
       01  WS-GRANT-PRSN-FND      PIC X     VALUE SPACE.                01550000
       01  WS-PERSN-FND           PIC X     VALUE SPACE.                01560000
       01  WS-RCVRY-FND           PIC X     VALUE SPACE.                01570000
       01  WS-EX-GRANT-ASMNT-FND  PIC X     VALUE SPACE.                01580000
       01  WS-EX-GRANT-PRSN-FND   PIC X     VALUE SPACE.                01590000
       01  WS-GRANT-RCVRY-FND     PIC X     VALUE SPACE.                01600000
       01  WS-HGT-RCVRY           PIC X     VALUE SPACE.                01610000
       01  WS-AHG-RCVRY           PIC X     VALUE SPACE.                01620000
       01  WS-SHG-RCVRY           PIC X     VALUE SPACE.                01630000
       01  WS-SUG-RCVRY           PIC X     VALUE SPACE.                01640000
       01  WS-PHG-RCVRY           PIC X     VALUE SPACE.                01650000
       01  WS-HGT                 PIC X     VALUE SPACE.                01660000
       01  WS-TUG                 PIC X     VALUE SPACE.                01670000
       01  WS-AHG                 PIC X     VALUE SPACE.                01680000
       01  WS-SHG                 PIC X     VALUE SPACE.                01690000
       01  WS-SUG                 PIC X     VALUE SPACE.                01700000
       01  WS-PHG                 PIC X     VALUE SPACE.                01710000
       01  WS-EX-INSERT           PIC X     VALUE SPACE.                01720000
       01  WS-DATE                PIC X(08) VALUE SPACES.               01730000
       01  WS-TIMESTAMP           PIC X(26) VALUE SPACES.               01740000
       01  WS-GRANT-TYPE          PIC X(3)  VALUE SPACES.               01750000
       01  WS-NUM-REGN            PIC X(8)  VALUE SPACES.               01760000
       01  WS-NUM-NRIC            PIC X(9)  VALUE SPACES.               01770000
       01  WS-PREV-REGN           PIC X(8)  VALUE SPACES.               01780000
       01  WS-SQLCODE             PIC ---9.                             01790000
       01  WS-RETURN-CODE         PIC 9(02) VALUE ZEROES.               01800000
       01  WS-C-SRC               PIC X(09) VALUE SPACES.               01810000
       01  WS-RECORD-COUNT        PIC S9(06) COMP VALUE ZEROES.         01820000
       01  WS-PHG-RECVRY          PIC S9(5)V99 VALUE ZEROES.            01830000
       01  WS-DTE-CCYYMMDD.                                             01840000
           05 WS-DTE-CCYY                   PIC X(04) VALUE SPACES.     01850000
           05 WS-DTE-MM                     PIC X(02) VALUE SPACES.     01860000
           05 WS-DTE-DD                     PIC X(02) VALUE SPACES.     01870000
       01  WS-TIME-HHMMSS.                                              01880000
           05 WS-TIME-HH                    PIC X(02) VALUE SPACES.     01890000
           05 WS-TIME-MM                    PIC X(02) VALUE SPACES.     01900000
           05 WS-TIME-SS                    PIC X(02) VALUE SPACES.     01910000
           05 WS-TIME-MS                    PIC X(02) VALUE SPACES.     01920000
                                                                        01930000
       01  WS-LOG-VARIABLE.                                             01940000
           05  WS-BEFORE-IMAGE        PIC X(600).                       01950000
           05  WS-AFTER-IMAGE         PIC X(600).                       01960000
           05  WS-SOURCE              PIC X(30).                        01970000
           05  WS-RGSTRN              PIC X(8).                         01980000
           05  WS-ACTION              PIC X(1).                         01990000
           05  WS-GRNT-TYPE           PIC X(6).                         02000000
           05  WS-TIMESTAMP-LOG       PIC X(26) VALUE SPACES.           02010000
                                                                        02020000
       01  WS-SQL-STATUS.                                               02030000
           05 WS-SQL-OK                PIC S9(03) VALUE +000.           02040000
           05 WS-SQL-NFND              PIC S9(03) VALUE +100.           02050000
           05 WS-SQL-DUPREC            PIC S9(03) VALUE -803.           02060000
           05 WS-SQL-MORE-ROWS         PIC S9(03) VALUE -811.           02070000
                                                                        02080000
       01  WS-K800-K893-FIELDS.                                         02090000
           05 WS-NUM-PARENT-CHILD          PIC X(1).                    02100000
           05 WS-NUM-ALLO-SCHEME           PIC X(3).                    02110000
           05 WS-DTE-CPF-ACK-GRANT         PIC X(8).                    02120000
           05 WS-CDE-CITIZENSHIP-HH        PIC X(3).                    02130000
           05 WS-NUM-GRANT-CREDIT-TAG      PIC X(1).                    02140000
           05 WS-NUM-MONTHS-WORKED         PIC X(2).                    02150000
                                                                        02160000
       01  HGT-RECORD.                                                  02170000
           05 HGT-REC OCCURS 4 TIMES.                                   02180000
              10 HGT-KEY-FLD.                                           02190000
                 15 HGT-NUM-REGN                 PIC X(8).              02200000
                 15 HGT-NUM-NRIC                 PIC X(9).              02210000
              10 FILLER                          PIC X(2).              02220000
              10 HGT-NUM-CPF                     PIC X(9).              02230000
              10 HGT-NME-OCCP                    PIC X(66).             02240000
              10 FILLER                          PIC X(1).              02250000
              10 HGT-NUM-AHG                     PIC X(1).              02260000
              10 HGT-AMT-INCOME-AHG              PIC 9(5).              02270000
              10 HGT-AMT-AHG-GRANT               PIC S9(5)V99.          02280000
              10 HGT-AMT-AHG-USED                PIC S9(5)V99.          02290000
              10 HGT-AMT-AHG-GRANT-RECOVER       PIC S9(5)V99.          02300000
              10 FILLER                          PIC X(9).              02310000
              10 HGT-AMT-HSGNT                   PIC S9(5)V99.          02320000
              10 HGT-AMT-HSGNT-USED              PIC S9(5)V99.          02330000
              10 HGT-AMT-HSGNT-RECOVER           PIC S9(5)V99.          02340000
              10 FILLER                          PIC X(8).              02350000
              10 HGT-AMT-HSGNT-TOPUP             PIC S9(5)V99.          02360000
              10 HGT-NUM-CITIZENSHIP             PIC X(2).              02370000
              10 HGT-NUM-RELATIONSHIP            PIC X(2).              02380000
              10 HGT-NUM-MARITAL-STATUS          PIC X(1).              02390000
              10 HGT-NUM-HA-TAG                  PIC X(1).              02400000
              10 HGT-NUM-AHG-DEBAR               PIC X(1).              02410000
              10 HGT-NUM-SEX                     PIC X(1).              02420000
              10 HGT-NUM-DEBAR-SCSPR             PIC X(2).              02430000
              10 FILLER                          PIC X(1).              02440000
              10 HGT-NUM-CHG-DEBAR               PIC X(1).              02450000
              10 FILLER                          PIC X(73).             02460000
              10 HGT-DTE-HSGNT-ABORTIVE          PIC X(8).              02470000
              10 HGT-AMT-AHG-RECOVER-INT         PIC S9(5)V99.          02480000
              10 HGT-AMT-AHG-RECOVER-USED        PIC S9(5)V99.          02490000
              10 HGT-NUM-TRANSFEROR              PIC X(1).              02500000
              10 FILLER                          PIC X(26).             02510000
              10 HGT-AMT-SHG-GRANT               PIC S9(5)V99.          02520000
              10 HGT-AMT-SHG-USED                PIC S9(5)V99.          02530000
              10 HGT-AMT-SHG-GRANT-RECOVER       PIC S9(5)V99.          02540000
              10 FILLER                          PIC X(8).              02550000
              10 HGT-AMT-SHG-TOPUP               PIC S9(5)V99.          02560000
              10 HGT-AMT-THRESHOLD               PIC 9(5).              02570000
              10 FILLER                          PIC X(05).             02580000
              10 FILLER                          PIC X(1).              02590000
              10 HGT-AMT-SUG-GRANT               PIC S9(5)V99.          02600000
              10 HGT-AMT-SUG-USED                PIC S9(5)V99.          02610000
              10 HGT-AMT-SUG-GRANT-RECOVER       PIC S9(5)V99.          02620000
              10 FILLER                          PIC X(8).              02630000
              10 HGT-AMT-SUG-TOPUP               PIC S9(5)V99.          02640000
              10 FILLER                          PIC X(11).             02650000
              10 HGT-DTE-REQ                     PIC X(8).              02660000
              10 HGT-DTE-RECD                    PIC X(8).              02670000
              10 HGT-DTE-REQ-GRANT-UNUSED        PIC X(8).              02680000
              10 HGT-DTE-REQ-GRANT-USED-HA       PIC X(8).              02690000
              10 HGT-DTE-REQ-GRANT-USED-CPFB     PIC X(8).              02700000
              10 HGT-DTE-RECD-GRANT-UNUSED       PIC X(8).              02710000
              10 HGT-DTE-RECD-GRANT-USED-HA      PIC X(8).              02720000
              10 HGT-DTE-RECD-GRANT-USED-CPFB    PIC X(8).              02730000
              10 HGT-DTE-RECPT-CPFB              PIC X(8).              02740000
              10 HGT-AMT-GRANT-RECOVER-INT       PIC S9(5)V99.          02750000
              10 FILLER                          PIC X(8).              02760000
              10 HGT-NUM-1YR-CONT-EMP            PIC X(1).              02770000
              10 HGT-DTE-REPUDIATION             PIC X(8).              02780000
              10 HGT-DTE-TRANSFER                PIC X(8).              02790000
              10 FILLER                          PIC X(1).              02800000
                                                                        02810000
       01  TUG-RECORD.                                                  02820000
           05 TUG-REC OCCURS 4 TIMES.                                   02830000
              10 TUG-KEY-FLD.                                           02840000
                 15 TUG-NUM-REGN                 PIC X(8).              02850000
                 15 TUG-NUM-NRIC                 PIC X(9).              02860000
              10 FILLER                          PIC X(2).              02870000
              10 TUG-NUM-CPF                     PIC X(9).              02880000
              10 TUG-NME-OCCP                    PIC X(66).             02890000
              10 FILLER                          PIC X(1).              02900000
              10 TUG-NUM-AHG                     PIC X(1).              02910000
              10 TUG-AMT-INCOME-AHG              PIC 9(5).              02920000
              10 TUG-AMT-AHG-GRANT               PIC S9(5)V99.          02930000
              10 TUG-AMT-AHG-USED                PIC S9(5)V99.          02940000
              10 TUG-AMT-AHG-GRANT-RECOVER       PIC S9(5)V99.          02950000
              10 FILLER                          PIC X(9).              02960000
              10 TUG-AMT-HSGNT                   PIC S9(5)V99.          02970000
              10 TUG-AMT-HSGNT-USED              PIC S9(5)V99.          02980000
              10 TUG-AMT-HSGNT-RECOVER           PIC S9(5)V99.          02990000
              10 FILLER                          PIC X(8).              03000000
              10 TUG-AMT-HSGNT-TOPUP             PIC S9(5)V99.          03010000
              10 TUG-NUM-CITIZENSHIP             PIC X(2).              03020000
              10 TUG-NUM-RELATIONSHIP            PIC X(2).              03030000
              10 TUG-NUM-MARITAL-STATUS          PIC X(1).              03040000
              10 TUG-NUM-HA-TAG                  PIC X(1).              03050000
              10 TUG-NUM-AHG-DEBAR               PIC X(1).              03060000
              10 TUG-NUM-SEX                     PIC X(1).              03070000
              10 TUG-NUM-DEBAR-SCSPR             PIC X(2).              03080000
              10 FILLER                          PIC X(1).              03090000
              10 TUG-NUM-CHG-DEBAR               PIC X(1).              03100000
              10 FILLER                          PIC X(73).             03110000
              10 TUG-DTE-HSGNT-ABORTIVE          PIC X(8).              03120000
              10 TUG-AMT-AHG-RECOVER-INT         PIC S9(5)V99.          03130000
              10 TUG-AMT-AHG-RECOVER-USED        PIC S9(5)V99.          03140000
              10 TUG-NUM-TRANSFEROR              PIC X(1).              03150000
              10 FILLER                          PIC X(26).             03160000
              10 TUG-AMT-SHG-GRANT               PIC S9(5)V99.          03170000
              10 TUG-AMT-SHG-USED                PIC S9(5)V99.          03180000
              10 TUG-AMT-SHG-GRANT-RECOVER       PIC S9(5)V99.          03190000
              10 FILLER                          PIC X(8).              03200000
              10 TUG-AMT-SHG-TOPUP               PIC S9(5)V99.          03210000
              10 TUG-AMT-THRESHOLD               PIC 9(5).              03220000
              10 FILLER                          PIC X(05).             03230000
              10 FILLER                          PIC X(1).              03240000
              10 TUG-AMT-SUG-GRANT               PIC S9(5)V99.          03250000
              10 TUG-AMT-SUG-USED                PIC S9(5)V99.          03260000
              10 TUG-AMT-SUG-GRANT-RECOVER       PIC S9(5)V99.          03270000
              10 FILLER                          PIC X(8).              03280000
              10 TUG-AMT-SUG-TOPUP               PIC S9(5)V99.          03290000
              10 FILLER                          PIC X(11).             03300000
              10 TUG-DTE-REQ                     PIC X(8).              03310000
              10 TUG-DTE-RECD                    PIC X(8).              03320000
              10 TUG-DTE-REQ-GRANT-UNUSED        PIC X(8).              03330000
              10 TUG-DTE-REQ-GRANT-USED-HA       PIC X(8).              03340000
              10 TUG-DTE-REQ-GRANT-USED-CPFB     PIC X(8).              03350000
              10 TUG-DTE-RECD-GRANT-UNUSED       PIC X(8).              03360000
              10 TUG-DTE-RECD-GRANT-USED-HA      PIC X(8).              03370000
              10 TUG-DTE-RECD-GRANT-USED-CPFB    PIC X(8).              03380000
              10 TUG-DTE-RECPT-CPFB              PIC X(8).              03390000
              10 TUG-AMT-GRANT-RECOVER-INT       PIC S9(5)V99.          03400000
              10 FILLER                          PIC X(8).              03410000
              10 TUG-NUM-1YR-CONT-EMP            PIC X(1).              03420000
              10 TUG-DTE-REPUDIATION             PIC X(8).              03430000
              10 TUG-DTE-TRANSFER                PIC X(8).              03440000
              10 FILLER                          PIC X(1).              03450000
                                                                        03460000
       01  PHG-RECORD.                                                  03470000
           05 PHG-REC OCCURS 4 TIMES.                                   03480000
              10 PHG-KEY-FLD.                                           03490000
                 15 PHG-NUM-REGN                 PIC X(8).              03500000
                 15 PHG-NUM-NRIC                 PIC X(9).              03510000
              10 FILLER                          PIC X(2).              03520000
              10 PHG-NUM-CPF                     PIC X(9).              03530000
              10 PHG-NME-OCCP                    PIC X(66).             03540000
              10 FILLER                          PIC X(1).              03550000
              10 PHG-NUM-AHG                     PIC X(1).              03560000
              10 PHG-AMT-INCOME-AHG              PIC 9(5).              03570000
              10 PHG-AMT-AHG-GRANT               PIC S9(5)V99.          03580000
              10 PHG-AMT-AHG-USED                PIC S9(5)V99.          03590000
              10 PHG-AMT-AHG-GRANT-RECOVER       PIC S9(5)V99.          03600000
              10 FILLER                          PIC X(9).              03610000
              10 PHG-AMT-HSGNT                   PIC S9(5)V99.          03620000
              10 PHG-AMT-HSGNT-USED              PIC S9(5)V99.          03630000
              10 PHG-AMT-HSGNT-RECOVER           PIC S9(5)V99.          03640000
              10 FILLER                          PIC X(8).              03650000
              10 PHG-AMT-HSGNT-TOPUP             PIC S9(5)V99.          03660000
              10 PHG-NUM-CITIZENSHIP             PIC X(2).              03670000
              10 PHG-NUM-RELATIONSHIP            PIC X(2).              03680000
              10 PHG-NUM-MARITAL-STATUS          PIC X(1).              03690000
              10 PHG-NUM-HA-TAG                  PIC X(1).              03700000
              10 PHG-NUM-AHG-DEBAR               PIC X(1).              03710000
              10 PHG-NUM-SEX                     PIC X(1).              03720000
              10 PHG-NUM-DEBAR-SCSPR             PIC X(2).              03730000
              10 FILLER                          PIC X(1).              03740000
              10 PHG-NUM-CHG-DEBAR               PIC X(1).              03750000
              10 FILLER                          PIC X(73).             03760000
              10 PHG-DTE-HSGNT-ABORTIVE          PIC X(8).              03770000
              10 PHG-AMT-AHG-RECOVER-INT         PIC S9(5)V99.          03780000
              10 PHG-AMT-AHG-RECOVER-USED        PIC S9(5)V99.          03790000
              10 PHG-NUM-TRANSFEROR              PIC X(1).              03800000
              10 FILLER                          PIC X(25).             03810000
              10 PHG-AMT-NUM-SHG                 PIC X(1).              03820000
              10 PHG-AMT-SHG-GRANT               PIC S9(5)V99.          03830000
              10 PHG-AMT-SHG-USED                PIC S9(5)V99.          03840000
              10 PHG-AMT-SHG-GRANT-RECOVER       PIC S9(5)V99.          03850000
              10 FILLER                          PIC X(8).              03860000
              10 PHG-AMT-SHG-TOPUP               PIC S9(5)V99.          03870000
              10 PHG-AMT-THRESHOLD               PIC 9(5).              03880000
              10 FILLER                          PIC X(05).             03890000
              10 FILLER                          PIC X(1).              03900000
              10 PHG-AMT-SUG-GRANT               PIC S9(5)V99.          03910000
              10 PHG-AMT-SUG-USED                PIC S9(5)V99.          03920000
              10 PHG-AMT-SUG-GRANT-RECOVER       PIC S9(5)V99.          03930000
              10 FILLER                          PIC X(8).              03940000
              10 PHG-AMT-SUG-TOPUP               PIC S9(5)V99.          03950000
              10 FILLER                          PIC X(11).             03960000
              10 PHG-DTE-REQ                     PIC X(8).              03970000
              10 PHG-DTE-RECD                    PIC X(8).              03980000
              10 PHG-DTE-REQ-GRANT-UNUSED        PIC X(8).              03990000
              10 PHG-DTE-REQ-GRANT-USED-HA       PIC X(8).              04000000
              10 PHG-DTE-REQ-GRANT-USED-CPFB     PIC X(8).              04010000
              10 PHG-DTE-RECD-GRANT-UNUSED       PIC X(8).              04020000
              10 PHG-DTE-RECD-GRANT-USED-HA      PIC X(8).              04030000
              10 PHG-DTE-RECD-GRANT-USED-CPFB    PIC X(8).              04040000
              10 PHG-DTE-RECPT-CPFB              PIC X(8).              04050000
              10 PHG-AMT-GRANT-RECOVER-INT       PIC S9(5)V99.          04060000
              10 FILLER                          PIC X(8).              04070000
              10 PHG-NUM-1YR-CONT-EMP            PIC X(1).              04080000
              10 PHG-DTE-REPUDIATION             PIC X(8).              04090000
              10 PHG-DTE-TRANSFER                PIC X(8).              04100000
              10 PHG-NUM-PHG-DEBAR               PIC X(1).              04110000
                                                                        04120000
                                                                        04130000
       01  LB3G-PR-HEAD-01.                                             04140000
           05  FILLER             PIC X(08) VALUE 'BP13LB3G'.           04150000
           05  FILLER             PIC X(05) VALUE SPACES.               04160000
           05  FILLER             PIC X(08) VALUE 'HDBCAT 3'.           04170000
           05  FILLER             PIC X(24) VALUE SPACES.               04180000
           05  FILLER             PIC X(39) VALUE                       04190000
               'S Y S T E M   O F   C O M M I T M E N T'.               04200000
           05  FILLER             PIC X(17) VALUE SPACES.               04210000
           05  FILLER             PIC X(06) VALUE 'DATE: '.             04220000
           05  LB3G-DATE          PIC X(10).                            04230000
           05  FILLER             PIC X(03) VALUE SPACES.               04240000
                                                                        04250000
      *--------------------------------------------------------------*  04260000
      *                          SQLCA                               *  04270000
      *--------------------------------------------------------------*  04280000
           EXEC SQL INCLUDE SQLCA          END-EXEC.                    04290000
           EXEC SQL INCLUDE P13VGASM       END-EXEC.                    04300000
           EXEC SQL INCLUDE P13VGAPN       END-EXEC.                    04310000
           EXEC SQL INCLUDE P13VGRCV       END-EXEC.                    04320000
           EXEC SQL INCLUDE P13VGXAP       END-EXEC.                    04330000
           EXEC SQL INCLUDE P13VGXAS       END-EXEC.                    04340000
           EXEC SQL INCLUDE P13VGUPD       END-EXEC.                    04350000
                                                                        04360000
      ********************                                              04370000
       PROCEDURE DIVISION.                                              04380000
      ********************                                              04390000
                                                                        04400000
      *----------*                                                      04410000
       0000-MAIN.                                                       04420000
      *----------*                                                      04430000
                                                                        04440000
           PERFORM 0500-OPEN-FILES    THRU 0500-EXIT.                   04450000
           PERFORM 1300-READ-BP13FD05 THRU 1300-EXIT.                   04460000
           PERFORM 1500-PROCESS-REC   THRU 1500-EXIT                    04470000
                   UNTIL WS-EOF-FD05 = 'Y'.                             04480000
           PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT.                   04490000
                                                                        04500000
       0000-EXIT.                                                       04510000
           EXIT.                                                        04520000
                                                                        04530000
      *----------------*                                                04540000
       0500-OPEN-FILES.                                                 04550000
      *----------------*                                                04560000
                                                                        04570000
           OPEN INPUT  BP13FD05                                         04580000
                       BP13KD00                                         04590000
                       BP13K800                                         04600000
                       BP13K893                                         04610000
                       BP13K895                                         04620000
                       BP13K820.                                        04630000
                                                                        04640000
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                       04650000
                                                                        04660000
           ACCEPT WS-DTE-CCYYMMDD   FROM   DATE YYYYMMDD.               04670000
           ACCEPT WS-TIME-HHMMSS    FROM   TIME.                        04680000
                                                                        04690000
           PERFORM 1100-SET-DB2-TIMESTAMP THRU 1100-EXIT.               04700000
                                                                        04710000
           IF WS-KD00-STATUS NOT = 00 AND 97                            04720000
              DISPLAY 'ERROR OPENING - BP13KD00 : ' WS-KD00-STATUS      04730000
              MOVE     WS-KD00-STATUS    TO    RETURN-CODE              04740000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04750000
           END-IF.                                                      04760000
                                                                        04770000
           IF WS-K800-STATUS NOT = 00 AND 97                            04780000
              DISPLAY 'ERROR OPENING - BP13K800 : ' WS-K800-STATUS      04790000
              MOVE     WS-K800-STATUS    TO    RETURN-CODE              04800000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04810000
           END-IF.                                                      04820000
                                                                        04830000
           IF WS-K820-STATUS NOT = 00 AND 97                            04840000
              DISPLAY 'ERROR OPENING - BP13K820 : ' WS-K820-STATUS      04850000
              MOVE     WS-K820-STATUS    TO    RETURN-CODE              04860000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04870000
           END-IF.                                                      04880000
                                                                        04890000
           IF WS-K893-STATUS NOT = 00 AND 97                            04900000
              DISPLAY 'ERROR OPENING - BP13K893 : ' WS-K893-STATUS      04910000
              MOVE     WS-K893-STATUS    TO    RETURN-CODE              04920000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04930000
           END-IF.                                                      04940000
                                                                        04950000
           IF WS-K895-STATUS NOT = 00 AND 97                            04960000
              DISPLAY 'ERROR OPENING - BP13K895 : ' WS-K895-STATUS      04970000
              MOVE     WS-K895-STATUS    TO    RETURN-CODE              04980000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04990000
           END-IF.                                                      05000000
                                                                        05010000
           MOVE WS-DATE TO LB3G-DATE.                                   05020000
                                                                        05030000
                                                                        05040000
       0500-EXIT.                                                       05050000
           EXIT.                                                        05060000
      *----------------------------------------------------------------*05070000
       1100-SET-DB2-TIMESTAMP.                                          05080000
      *----------------------------------------------------------------*05090000
            EXEC SQL                                                    05100000
                 SET :WS-TIMESTAMP = CURRENT TIMESTAMP                  05110000
            END-EXEC.                                                   05120000
            IF SQLCODE NOT = 000                                        05130000
               MOVE SQLCODE          TO WS-SQLCODE                      05140000
               DISPLAY 'SQL ERROR SET DB2 TIMESTAMP'                    05150000
               DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE                 05160000
               PERFORM 9999-SQL-ERROR THRU 9999-EXIT                    05170000
            END-IF.                                                     05180000
                                                                        05190000
       1100-EXIT.                                                       05200000
           EXIT.                                                        05210000
                                                                        05220000
      *-------------------*                                             05230000
       1300-READ-BP13FD05.                                              05240000
      *-------------------*                                             05250000
                                                                        05260000
           READ BP13FD05 AT END                                         05270000
                MOVE HIGH-VALUES TO KD05-KEY-FLD                        05280000
                MOVE 'Y' TO WS-EOF-FD05                                 05290000
                GO TO 1300-EXIT.                                        05300000
                                                                        05310000
           PERFORM 1350-CHECK-NUMERIC-FD05 THRU 1350-EXIT.              05320000
           PERFORM 1360-CHECK-FD05-DATES   THRU 1360-EXIT.              05330000
                                                                        05340000
           ADD 1 TO CNT-FD05-READ.                                      05350000
                                                                        05360000
       1300-EXIT.                                                       05370000
           EXIT.                                                        05380000
                                                                        05390000
      *-----------------------*                                         05400000
       1350-CHECK-NUMERIC-FD05.                                         05410000
      *-----------------------*                                         05420000
                                                                        05430000
           IF KD05-AMT-AHG-GRANT IS NOT NUMERIC                         05440000
              MOVE ZEROES TO KD05-AMT-AHG-GRANT                         05450000
           END-IF.                                                      05460000
           IF KD05-AMT-AHG-USED IS NOT NUMERIC                          05470000
              MOVE ZEROES TO KD05-AMT-AHG-USED                          05480000
           END-IF.                                                      05490000
           IF KD05-AMT-AHG-GRANT-RECOVER IS NOT NUMERIC                 05500000
              MOVE ZEROES TO KD05-AMT-AHG-GRANT-RECOVER                 05510000
           END-IF.                                                      05520000
           IF KD05-AMT-HSGNT IS NOT NUMERIC                             05530000
              MOVE ZEROES TO KD05-AMT-HSGNT                             05540000
           END-IF.                                                      05550000
           IF KD05-AMT-HSGNT-USED IS NOT NUMERIC                        05560000
              MOVE ZEROES TO KD05-AMT-HSGNT-USED                        05570000
           END-IF.                                                      05580000
           IF KD05-AMT-HSGNT-RECOVER IS NOT NUMERIC                     05590000
              MOVE ZEROES TO KD05-AMT-HSGNT-RECOVER                     05600000
           END-IF.                                                      05610000
           IF KD05-AMT-HSGNT-TOPUP IS NOT NUMERIC                       05620000
              MOVE ZEROES TO KD05-AMT-HSGNT-TOPUP                       05630000
           END-IF.                                                      05640000
           IF KD05-AMT-AHG-RECOVER-INT IS NOT NUMERIC                   05650000
              MOVE ZEROES TO KD05-AMT-AHG-RECOVER-INT                   05660000
           END-IF.                                                      05670000
           IF KD05-AMT-AHG-RECOVER-USED IS NOT NUMERIC                  05680000
              MOVE ZEROES TO KD05-AMT-AHG-RECOVER-USED                  05690000
           END-IF.                                                      05700000
           IF KD05-AMT-SHG-GRANT IS NOT NUMERIC                         05710000
              MOVE ZEROES TO KD05-AMT-SHG-GRANT                         05720000
           END-IF.                                                      05730000
           IF KD05-AMT-SHG-USED IS NOT NUMERIC                          05740000
              MOVE ZEROES TO KD05-AMT-SHG-USED                          05750000
           END-IF.                                                      05760000
           IF KD05-AMT-SHG-GRANT-RECOVER IS NOT NUMERIC                 05770000
              MOVE ZEROES TO KD05-AMT-SHG-GRANT-RECOVER                 05780000
           END-IF.                                                      05790000
           IF KD05-AMT-SHG-TOPUP IS NOT NUMERIC                         05800000
              MOVE ZEROES TO KD05-AMT-SHG-TOPUP                         05810000
           END-IF.                                                      05820000
           IF KD05-AMT-THRESHOLD IS NOT NUMERIC                         05830000
              MOVE ZEROES TO KD05-AMT-THRESHOLD                         05840000
           END-IF.                                                      05850000
           IF KD05-AMT-SUG-GRANT IS NOT NUMERIC                         05860000
              MOVE ZEROES TO KD05-AMT-SUG-GRANT                         05870000
           END-IF.                                                      05880000
           IF KD05-AMT-SUG-USED IS NOT NUMERIC                          05890000
              MOVE ZEROES TO KD05-AMT-SUG-USED                          05900000
           END-IF.                                                      05910000
           IF KD05-AMT-SUG-GRANT-RECOVER IS NOT NUMERIC                 05920000
              MOVE ZEROES TO KD05-AMT-SUG-GRANT-RECOVER                 05930000
           END-IF.                                                      05940000
           IF KD05-AMT-SUG-TOPUP IS NOT NUMERIC                         05950000
              MOVE ZEROES TO KD05-AMT-SUG-TOPUP                         05960000
           END-IF.                                                      05970000
           IF KD05-AMT-GRANT-RECOVER-INT IS NOT NUMERIC                 05980000
              MOVE ZEROES TO KD05-AMT-GRANT-RECOVER-INT                 05990000
           END-IF.                                                      06000000
       1350-EXIT.                                                       06010000
           EXIT.                                                        06020000
                                                                        06030000
      *-------------------*                                             06040000
       1360-CHECK-FD05-DATES.                                           06050000
      *-------------------*                                             06060000
           MOVE KD05-DTE-AHG-GRANT-RECOVER TO WS-IN-DATE.               06070000
           MOVE 'CD' TO WS-IN-OPTION.                                   06080000
           CALL 'AV02C001' USING LINK-REC                               06090000
           IF WS-RETURN NOT = '000'                                     06100000
              MOVE '00010101' TO KD05-DTE-AHG-GRANT-RECOVER             06110000
           END-IF.                                                      06120000
                                                                        06130000
           MOVE KD05-DTE-HSGNT-RECOVER TO WS-IN-DATE.                   06140000
           MOVE 'CD' TO WS-IN-OPTION.                                   06150000
           CALL 'AV02C001' USING LINK-REC                               06160000
           IF WS-RETURN NOT = '000'                                     06170000
              MOVE '00010101' TO KD05-DTE-HSGNT-RECOVER                 06180000
           END-IF.                                                      06190000
                                                                        06200000
           MOVE KD05-DTE-HSGNT-ABORTIVE TO WS-IN-DATE.                  06210000
           MOVE 'CD' TO WS-IN-OPTION.                                   06220000
           CALL 'AV02C001' USING LINK-REC                               06230000
           IF WS-RETURN NOT = '000'                                     06240000
              MOVE '00010101' TO KD05-DTE-HSGNT-ABORTIVE                06250000
           END-IF.                                                      06260000
                                                                        06270000
           MOVE KD05-DTE-UPDATE TO WS-IN-DATE.                          06280000
           MOVE 'CD' TO WS-IN-OPTION.                                   06290000
           CALL 'AV02C001' USING LINK-REC                               06300000
           IF WS-RETURN NOT = '000'                                     06310000
              MOVE '00010101' TO KD05-DTE-UPDATE                        06320000
           END-IF.                                                      06330000
                                                                        06340000
           MOVE KD05-DTE-SHG-GRANT-RECOVER TO WS-IN-DATE                06350000
           MOVE 'CD' TO WS-IN-OPTION.                                   06360000
           CALL 'AV02C001' USING LINK-REC                               06370000
           IF WS-RETURN NOT = '000'                                     06380000
              MOVE '00010101' TO KD05-DTE-SHG-GRANT-RECOVER             06390000
           END-IF.                                                      06400000
                                                                        06410000
           MOVE KD05-DTE-SUG-GRANT-RECOVER TO WS-IN-DATE                06420000
           MOVE 'CD' TO WS-IN-OPTION.                                   06430000
           CALL 'AV02C001' USING LINK-REC                               06440000
           IF WS-RETURN NOT = '000'                                     06450000
              MOVE '00010101' TO KD05-DTE-SUG-GRANT-RECOVER             06460000
           END-IF.                                                      06470000
                                                                        06480000
           MOVE KD05-DTE-REQ TO WS-IN-DATE                              06490000
           MOVE 'CD' TO WS-IN-OPTION.                                   06500000
           CALL 'AV02C001' USING LINK-REC                               06510000
           IF WS-RETURN NOT = '000'                                     06520000
              MOVE '00010101' TO KD05-DTE-REQ                           06530000
           END-IF.                                                      06540000
                                                                        06550000
           MOVE KD05-DTE-RECD TO WS-IN-DATE                             06560000
           MOVE 'CD' TO WS-IN-OPTION.                                   06570000
           CALL 'AV02C001' USING LINK-REC                               06580000
           IF WS-RETURN NOT = '000'                                     06590000
              MOVE '00010101' TO KD05-DTE-RECD                          06600000
           END-IF.                                                      06610000
                                                                        06620000
           MOVE KD05-DTE-REQ-GRANT-UNUSED TO WS-IN-DATE                 06630000
           MOVE 'CD' TO WS-IN-OPTION.                                   06640000
           CALL 'AV02C001' USING LINK-REC                               06650000
           IF WS-RETURN NOT = '000'                                     06660000
              MOVE '00010101' TO KD05-DTE-REQ-GRANT-UNUSED              06670000
           END-IF.                                                      06680000
                                                                        06690000
           MOVE KD05-DTE-REQ-GRANT-USED-HA TO WS-IN-DATE                06700000
           MOVE 'CD' TO WS-IN-OPTION.                                   06710000
           CALL 'AV02C001' USING LINK-REC                               06720000
           IF WS-RETURN NOT = '000'                                     06730000
              MOVE '00010101' TO KD05-DTE-REQ-GRANT-USED-HA             06740000
           END-IF.                                                      06750000
                                                                        06760000
           MOVE KD05-DTE-REQ-GRANT-USED-CPFB TO WS-IN-DATE              06770000
           MOVE 'CD' TO WS-IN-OPTION.                                   06780000
           CALL 'AV02C001' USING LINK-REC                               06790000
           IF WS-RETURN NOT = '000'                                     06800000
              MOVE '00010101' TO KD05-DTE-REQ-GRANT-USED-CPFB           06810000
           END-IF.                                                      06820000
                                                                        06830000
           MOVE KD05-DTE-RECD-GRANT-UNUSED TO WS-IN-DATE                06840000
           MOVE 'CD' TO WS-IN-OPTION.                                   06850000
           CALL 'AV02C001' USING LINK-REC                               06860000
           IF WS-RETURN NOT = '000'                                     06870000
              MOVE '00010101' TO KD05-DTE-RECD-GRANT-UNUSED             06880000
           END-IF.                                                      06890000
                                                                        06900000
           MOVE KD05-DTE-RECD-GRANT-USED-HA TO WS-IN-DATE               06910000
           MOVE 'CD' TO WS-IN-OPTION.                                   06920000
           CALL 'AV02C001' USING LINK-REC                               06930000
           IF WS-RETURN NOT = '000'                                     06940000
              MOVE '00010101' TO KD05-DTE-RECD-GRANT-USED-HA            06950000
           END-IF.                                                      06960000
                                                                        06970000
           MOVE KD05-DTE-RECD-GRANT-USED-CPFB TO WS-IN-DATE             06980000
           MOVE 'CD' TO WS-IN-OPTION.                                   06990000
           CALL 'AV02C001' USING LINK-REC                               07000000
           IF WS-RETURN NOT = '000'                                     07010000
              MOVE '00010101' TO KD05-DTE-RECD-GRANT-USED-CPFB          07020000
           END-IF.                                                      07030000
                                                                        07040000
           MOVE KD05-DTE-RECPT-CPFB TO WS-IN-DATE                       07050000
           MOVE 'CD' TO WS-IN-OPTION.                                   07060000
           CALL 'AV02C001' USING LINK-REC                               07070000
           IF WS-RETURN NOT = '000'                                     07080000
              MOVE '00010101' TO KD05-DTE-RECPT-CPFB                    07090000
           END-IF.                                                      07100000
                                                                        07110000
           MOVE KD05-DTE-UPD-JV TO WS-IN-DATE                           07120000
           MOVE 'CD' TO WS-IN-OPTION.                                   07130000
           CALL 'AV02C001' USING LINK-REC                               07140000
           IF WS-RETURN NOT = '000'                                     07150000
              MOVE '00010101' TO KD05-DTE-UPD-JV                        07160000
           END-IF.                                                      07170000
                                                                        07180000
           MOVE KD05-DTE-REPUDIATION TO WS-IN-DATE                      07190000
           MOVE 'CD' TO WS-IN-OPTION.                                   07200000
           CALL 'AV02C001' USING LINK-REC                               07210000
           IF WS-RETURN NOT = '000'                                     07220000
              MOVE '00010101' TO KD05-DTE-REPUDIATION                   07230000
           END-IF.                                                      07240000
                                                                        07250000
           MOVE KD05-DTE-TRANSFER TO WS-IN-DATE                         07260000
           MOVE 'CD' TO WS-IN-OPTION.                                   07270000
           CALL 'AV02C001' USING LINK-REC                               07280000
           IF WS-RETURN NOT = '000'                                     07290000
              MOVE '00010101' TO KD05-DTE-TRANSFER                      07300000
           END-IF.                                                      07310000
                                                                        07320000
       1360-EXIT.                                                       07330000
           EXIT.                                                        07340000
                                                                        07350000
      *-------------------*                                             07360000
       1400-READ-BP13KD00.                                              07370000
      *-------------------*                                             07380000
           MOVE SPACES             TO BP13KD00-REC.                     07390000
           INITIALIZE                 BP13KD00-REC.                     07400000
           MOVE KD05-NUM-REGN      TO KD00-NUM-REGN.                    07410000
           MOVE 'N'                TO WS-FND-KD00.                      07420000
                                                                        07430000
           READ BP13KD00.                                               07440000
                                                                        07450000
           EVALUATE WS-KD00-STATUS                                      07460000
               WHEN 00                                                  07470000
                    MOVE 'Y' TO WS-FND-KD00                             07480000
                    PERFORM 1410-CHECK-KD00-DATES THRU 1410-EXIT        07490000
               WHEN 23                                                  07500000
                    MOVE SPACES TO BP13KD00-REC                         07510000
               WHEN OTHER                                               07520000
                    DISPLAY 'ERROR READING BP13KD00 : ' WS-KD00-STATUS  07530000
                            ' REGN = ' KD00-NUM-REGN                    07540000
                    MOVE     WS-KD00-STATUS    TO    RETURN-CODE        07550000
                    PERFORM  9000-CLOSE-FILES       THRU 9000-EXIT      07560000
           END-EVALUATE.                                                07570000
                                                                        07580000
       1400-EXIT.                                                       07590000
           EXIT.                                                        07600000
                                                                        07610000
      *-------------------*                                             07620000
       1405-READ-BP13K800.                                              07630000
      *-------------------*                                             07640000
           MOVE SPACES             TO BP13K800-MASTER.                  07650000
           INITIALIZE                 BP13K800-MASTER.                  07660000
           MOVE KD05-NUM-REGN      TO K800-NUM-REGN.                    07670000
           MOVE 'N'                TO WS-FND-K800.                      07680000
                                                                        07690000
           READ BP13K800.                                               07700000
                                                                        07710000
           EVALUATE WS-K800-STATUS                                      07720000
               WHEN 00                                                  07730000
                    MOVE 'Y' TO WS-FND-K800                             07740000
                    MOVE K800-DTE-CPF-ACK-GRANT TO WS-IN-DATE           07750000
                    MOVE 'CD' TO WS-IN-OPTION                           07760000
                    CALL 'AV02C001' USING LINK-REC                      07770000
                    IF WS-RETURN NOT = '000'                            07780000
                       MOVE '00010101' TO K800-DTE-CPF-ACK-GRANT        07790000
                    END-IF                                              07800000
                    MOVE K800-NUM-AHG-PARENT-CHILD                      07810000
                                                TO WS-NUM-PARENT-CHILD  07820000
                    MOVE K800-NUM-ALLO-SCHEME   TO WS-NUM-ALLO-SCHEME   07830000
                    MOVE K800-DTE-CPF-ACK-GRANT TO WS-DTE-CPF-ACK-GRANT 07840000
                    MOVE K800-CDE-CITIZENSHIP-HOUSEHOLD                 07850000
                                               TO WS-CDE-CITIZENSHIP-HH 07860000
                    MOVE K800-NUM-GRANT-CREDIT-TAG                      07870000
                                             TO WS-NUM-GRANT-CREDIT-TAG 07880000
                    MOVE K800-NUM-MTHS-WORKED TO WS-NUM-MONTHS-WORKED   07890000
               WHEN 23                                                  07900000
                    MOVE SPACES TO WS-NUM-PARENT-CHILD                  07910000
                                   WS-NUM-ALLO-SCHEME                   07920000
                                   WS-DTE-CPF-ACK-GRANT                 07930000
                                   WS-CDE-CITIZENSHIP-HH                07940000
                                   WS-NUM-GRANT-CREDIT-TAG              07950000
                                   WS-NUM-MONTHS-WORKED                 07960000
                    MOVE '00010101' TO WS-DTE-CPF-ACK-GRANT             07970000
                    PERFORM 1420-START-BP13K893 THRU 1420-EXIT          07980000
               WHEN OTHER                                               07990000
                    DISPLAY 'ERROR READING BP13K800 : ' WS-K800-STATUS  08000000
                            ' REGN = ' K800-NUM-REGN                    08010000
                    MOVE     WS-K800-STATUS    TO    RETURN-CODE        08020000
                    PERFORM  9000-CLOSE-FILES       THRU 9000-EXIT      08030000
           END-EVALUATE.                                                08040000
                                                                        08050000
       1405-EXIT.                                                       08060000
           EXIT.                                                        08070000
                                                                        08080000
      ******************************************************************08090000
       1410-CHECK-KD00-DATES.                                           08100000
      ******************************************************************08110000
                                                                        08120000
           MOVE KD00-DTE-HSGNT-SUBMIT TO WS-IN-DATE.                    08130000
           MOVE 'CD' TO WS-IN-OPTION.                                   08140000
           CALL 'AV02C001' USING LINK-REC                               08150000
           IF WS-RETURN NOT = '000'                                     08160000
              MOVE '00010101' TO KD00-DTE-HSGNT-SUBMIT                  08170000
           END-IF.                                                      08180000
                                                                        08190000
           MOVE KD00-DTE-HSGNT-APPROVE TO WS-IN-DATE.                   08200000
           MOVE 'CD' TO WS-IN-OPTION.                                   08210000
           CALL 'AV02C001' USING LINK-REC                               08220000
           IF WS-RETURN NOT = '000'                                     08230000
              MOVE '00010101' TO KD00-DTE-HSGNT-APPROVE                 08240000
           END-IF.                                                      08250000
                                                                        08260000
           MOVE KD00-DTE-HSGNT-REJECT TO WS-IN-DATE.                    08270000
           MOVE 'CD' TO WS-IN-OPTION.                                   08280000
           CALL 'AV02C001' USING LINK-REC                               08290000
           IF WS-RETURN NOT = '000'                                     08300000
              MOVE '00010101' TO KD00-DTE-HSGNT-REJECT                  08310000
           END-IF.                                                      08320000
                                                                        08330000
           MOVE KD00-DTE-HSGNT-CPFREQ TO WS-IN-DATE.                    08340000
           MOVE 'CD' TO WS-IN-OPTION.                                   08350000
           CALL 'AV02C001' USING LINK-REC                               08360000
           IF WS-RETURN NOT = '000'                                     08370000
              MOVE '00010101' TO KD00-DTE-HSGNT-CPFREQ                  08380000
           END-IF.                                                      08390000
                                                                        08400000
           MOVE KD00-DTE-HSGNT-SUBMIT-TOPUP TO WS-IN-DATE.              08410000
           MOVE 'CD' TO WS-IN-OPTION.                                   08420000
           CALL 'AV02C001' USING LINK-REC                               08430000
           IF WS-RETURN NOT = '000'                                     08440000
              MOVE '00010101' TO KD00-DTE-HSGNT-SUBMIT-TOPUP            08450000
           END-IF.                                                      08460000
                                                                        08470000
           MOVE KD00-DTE-HSGNT-APPROVE-TOPUP TO WS-IN-DATE.             08480000
           MOVE 'CD' TO WS-IN-OPTION.                                   08490000
           CALL 'AV02C001' USING LINK-REC                               08500000
           IF WS-RETURN NOT = '000'                                     08510000
              MOVE '00010101' TO KD00-DTE-HSGNT-APPROVE-TOPUP           08520000
           END-IF.                                                      08530000
                                                                        08540000
           MOVE KD00-DTE-HSGNT-REJECT-TOPUP TO WS-IN-DATE.              08550000
           MOVE 'CD' TO WS-IN-OPTION.                                   08560000
           CALL 'AV02C001' USING LINK-REC                               08570000
           IF WS-RETURN NOT = '000'                                     08580000
              MOVE '00010101' TO KD00-DTE-HSGNT-REJECT-TOPUP            08590000
           END-IF.                                                      08600000
                                                                        08610000
           MOVE KD00-DTE-HSGNT-CPFREQ-TOPUP TO WS-IN-DATE.              08620000
           MOVE 'CD' TO WS-IN-OPTION.                                   08630000
           CALL 'AV02C001' USING LINK-REC                               08640000
           IF WS-RETURN NOT = '000'                                     08650000
              MOVE '00010101' TO KD00-DTE-HSGNT-CPFREQ-TOPUP            08660000
           END-IF.                                                      08670000
                                                                        08680000
           MOVE KD00-DTE-PHG-SUBMIT TO WS-IN-DATE.                      08690000
           MOVE 'CD' TO WS-IN-OPTION.                                   08700000
           CALL 'AV02C001' USING LINK-REC                               08710000
           IF WS-RETURN NOT = '000'                                     08720000
              MOVE '00010101' TO KD00-DTE-PHG-SUBMIT                    08730000
           END-IF.                                                      08740000
                                                                        08750000
           MOVE KD00-DTE-PHG-APPROVE TO WS-IN-DATE.                     08760000
           MOVE 'CD' TO WS-IN-OPTION.                                   08770000
           CALL 'AV02C001' USING LINK-REC                               08780000
           IF WS-RETURN NOT = '000'                                     08790000
              MOVE '00010101' TO KD00-DTE-PHG-APPROVE                   08800000
           END-IF.                                                      08810000
                                                                        08820000
           MOVE KD00-DTE-HSGNT-REJECT TO WS-IN-DATE.                    08830000
           MOVE 'CD' TO WS-IN-OPTION.                                   08840000
           CALL 'AV02C001' USING LINK-REC                               08850000
           IF WS-RETURN NOT = '000'                                     08860000
              MOVE '00010101' TO KD00-DTE-HSGNT-REJECT                  08870000
           END-IF.                                                      08880000
                                                                        08890000
           MOVE KD00-DTE-PHG-CPFREQ TO WS-IN-DATE.                      08900000
           MOVE 'CD' TO WS-IN-OPTION.                                   08910000
           CALL 'AV02C001' USING LINK-REC                               08920000
           IF WS-RETURN NOT = '000'                                     08930000
              MOVE '00010101' TO KD00-DTE-PHG-CPFREQ                    08940000
           END-IF.                                                      08950000
                                                                        08960000
       1410-EXIT.                                                       08970000
           EXIT.                                                        08980000
                                                                        08990000
      ******************************************************************09000000
       1420-START-BP13K893.                                             09010000
      ******************************************************************09020000
                                                                        09030000
           MOVE SPACES                           TO BP13K893-MASTER.    09040000
           INITIALIZE                               BP13K893-MASTER.    09050000
                                                                        09060000
           MOVE SPACES                           TO K893-KEY-FLD.       09070000
           MOVE KD05-NUM-REGN                    TO K893-NUM-REGN-HIST. 09080000
           MOVE 'N'                              TO WS-EOF-K895         09090000
                                                    WS-FND-K893.        09100000
                                                                        09110000
           START BP13K893 KEY >= K893-KEY-FLD.                          09120000
                                                                        09130000
           EVALUATE WS-K893-STATUS                                      09140000
               WHEN 00                                                  09150000
               WHEN 02                                                  09160000
                    PERFORM 1430-READ-BP13K893    THRU 1430-EXIT        09170000
               WHEN 23                                                  09180000
                    CONTINUE                                            09190000
               WHEN OTHER                                               09200000
                    DISPLAY 'ERROR STARTING BP13K893: ' WS-K893-STATUS  09210000
                            ' REGN = ' K893-NUM-REGN-HIST               09220000
                    MOVE     WS-K893-STATUS    TO    RETURN-CODE        09230000
                    PERFORM 9000-CLOSE-FILES       THRU 9000-EXIT       09240000
           END-EVALUATE.                                                09250000
                                                                        09260000
       1420-EXIT.                                                       09270000
           EXIT.                                                        09280000
                                                                        09290000
      ******************************************************************09300000
       1430-READ-BP13K893.                                              09310000
      ******************************************************************09320000
                                                                        09330000
            READ  BP13K893 NEXT AT END                                  09340000
                  MOVE SPACES               TO K893-KEY-FLD.            09350000
                                                                        09360000
            EVALUATE WS-K893-STATUS                                     09370000
                WHEN 00                                                 09380000
                WHEN 02                                                 09390000
                     IF KD05-NUM-REGN = K893-NUM-REGN-HIST              09400000
                       MOVE 'Y' TO WS-FND-K893                          09410000
                       MOVE K893-DTE-CPF-ACK-GRANT TO WS-IN-DATE        09420000
                       MOVE 'CD' TO WS-IN-OPTION                        09430000
                       CALL 'AV02C001' USING LINK-REC                   09440000
                       IF WS-RETURN NOT = '000'                         09450000
                          MOVE '00010101' TO K893-DTE-CPF-ACK-GRANT     09460000
                       END-IF                                           09470000
                       MOVE K893-NUM-AHG-PARENT-CHILD                   09480000
                                                TO WS-NUM-PARENT-CHILD  09490000
                       MOVE K893-NUM-ALLO-SCHEME                        09500000
                                                TO WS-NUM-ALLO-SCHEME   09510000
                       MOVE K893-DTE-CPF-ACK-GRANT                      09520000
                                                TO WS-DTE-CPF-ACK-GRANT 09530000
                       MOVE K893-CDE-CITIZENSHIP-HOUSEHOLD              09540000
                                               TO WS-CDE-CITIZENSHIP-HH 09550000
                       MOVE K893-NUM-GRANT-CREDIT-TAG                   09560000
                                             TO WS-NUM-GRANT-CREDIT-TAG 09570000
                       MOVE K893-NUM-MTHS-WORKED                        09580000
                                             TO WS-NUM-MONTHS-WORKED    09590000
                     ELSE                                               09600000
                       MOVE SPACES TO BP13K893-MASTER                   09610000
                     END-IF                                             09620000
                WHEN 23                                                 09630000
                     MOVE SPACES TO WS-NUM-PARENT-CHILD                 09640000
                                    WS-NUM-ALLO-SCHEME                  09650000
                                    WS-DTE-CPF-ACK-GRANT                09660000
                                    WS-CDE-CITIZENSHIP-HH               09670000
                                    WS-NUM-GRANT-CREDIT-TAG             09680000
                                    WS-NUM-MONTHS-WORKED                09690000
                     MOVE '00010101' TO WS-DTE-CPF-ACK-GRANT            09700000
                     DISPLAY KD05-NUM-REGN ' NOT FOUND IN K893'         09710000
                WHEN OTHER                                              09720000
                     DISPLAY 'ERROR READING BP13K893 : ' WS-K893-STATUS 09730000
                             ' REGN = ' K893-NUM-REGN-HIST              09740000
                     MOVE     WS-K893-STATUS    TO    RETURN-CODE       09750000
                     PERFORM 9000-CLOSE-FILES       THRU 9000-EXIT      09760000
            END-EVALUATE.                                               09770000
                                                                        09780000
       1430-EXIT.                                                       09790000
           EXIT.                                                        09800000
                                                                        09810000
      *-----------------*                                               09820000
       1500-PROCESS-REC.                                                09830000
      *-----------------*                                               09840000
           IF WS-PREV-REGN = SPACES                                     09850000
              CONTINUE                                                  09860000
           ELSE                                                         09870000
              IF WS-PREV-REGN NOT = KD05-NUM-REGN                       09880000
                 PERFORM 1600-CREATE-TO-DB2 THRU 1600-EXIT              09890000
                 MOVE ZEROES TO WS-HGT-CTR WS-TUG-CTR WS-PHG-CTR        09900000
              END-IF                                                    09910000
           END-IF.                                                      09920000
                                                                        09930000
           PERFORM 1550-STORE-VALUES THRU 1550-EXIT.                    09940000
                                                                        09950000
           MOVE KD05-NUM-REGN TO WS-PREV-REGN.                          09960000
           PERFORM 1300-READ-BP13FD05   THRU 1300-EXIT.                 09970000
                                                                        09980000
           IF WS-EOF-FD05 = 'Y'                                         09990000
              PERFORM 1600-CREATE-TO-DB2 THRU 1600-EXIT                 10000000
           END-IF.                                                      10010000
                                                                        10020000
       1500-EXIT.                                                       10030000
           EXIT.                                                        10040000
                                                                        10050000
      *---------------------*                                           10060000
       1550-STORE-VALUES.                                               10070000
      *---------------------*                                           10080000
           PERFORM 1400-READ-BP13KD00 THRU 1400-EXIT.                   10090000
           PERFORM 1405-READ-BP13K800 THRU 1405-EXIT.                   10100000
                                                                        10110000
           IF KD00-NUM-HSGNT-STATUS NOT = SPACES AND LOW-VALUES AND 'S' 10120000
              ADD 1 TO WS-HGT-CTR                                       10130000
              MOVE 'Y' TO WS-HGT                                        10140000
              MOVE BP13KD05-REC TO HGT-REC(WS-HGT-CTR)                  10150000
              IF KD05-AMT-HSGNT-RECOVER NOT = ZEROES                    10160000
                 MOVE 'Y' TO WS-HGT-RCVRY                               10170000
              END-IF                                                    10180000
           END-IF.                                                      10190000
                                                                        10200000
           IF KD00-NUM-HSGNT-STATUS-TOPUP                               10210000
                                    NOT = SPACES AND LOW-VALUES AND 'S' 10220000
              ADD 1 TO WS-TUG-CTR                                       10230000
              MOVE 'Y' TO WS-TUG                                        10240000
              MOVE BP13KD05-REC TO TUG-REC(WS-TUG-CTR)                  10250000
           END-IF.                                                      10260000
                                                                        10270000
           IF KD00-NUM-PHG-STATUS NOT = SPACES AND LOW-VALUES AND 'S'   10280000
              ADD 1 TO WS-PHG-CTR                                       10290000
              MOVE 'Y' TO WS-PHG                                        10300000
              MOVE BP13KD05-REC TO PHG-REC(WS-PHG-CTR)                  10310000
              MOVE ZEROES TO WS-PHG-RECVRY                              10320000
              COMPUTE WS-PHG-RECVRY = KD05-AMT-AHG-GRANT-RECOVER +      10330000
                                      KD05-AMT-HSGNT-RECOVER            10340000
              IF WS-PHG-RECVRY NOT = ZEROES                             10350000
                 MOVE 'Y' TO WS-PHG-RCVRY                               10360000
              END-IF                                                    10370000
           END-IF.                                                      10380000
                                                                        10390000
       1550-EXIT.                                                       10400000
           EXIT.                                                        10410000
                                                                        10420000
      *-----------------*                                               10430000
       1600-CREATE-TO-DB2.                                              10440000
      *-----------------*                                               10450000
                                                                        10460000
           MOVE 'N' TO WS-EX-INSERT.                                    10470000
           IF WS-HGT-CTR > 0                                            10480000
              PERFORM VARYING WS-CTR FROM 1 BY 1                        10490000
                                           UNTIL WS-CTR > WS-HGT-CTR    10500000
                 PERFORM 2200-PROCESS-HGT THRU 2200-EXIT                10510000
              END-PERFORM                                               10520000
           END-IF.                                                      10530000
                                                                        10540000
           MOVE 'N' TO WS-EX-INSERT.                                    10550000
           IF WS-TUG-CTR > 0                                            10560000
              PERFORM VARYING WS-CTR FROM 1 BY 1                        10570000
                                           UNTIL WS-CTR > WS-TUG-CTR    10580000
                 PERFORM 2300-PROCESS-TUG THRU 2300-EXIT                10590000
              END-PERFORM                                               10600000
           END-IF.                                                      10610000
                                                                        10620000
           MOVE 'N' TO WS-EX-INSERT.                                    10630000
           IF WS-PHG-CTR > 0                                            10640000
              PERFORM VARYING WS-CTR FROM 1 BY 1                        10650000
                                           UNTIL WS-CTR > WS-PHG-CTR    10660000
                 PERFORM 2400-PROCESS-PHG THRU 2400-EXIT                10670000
              END-PERFORM                                               10680000
           END-IF.                                                      10690000
                                                                        10700000
           IF WS-HGT-CTR = 0 AND WS-TUG-CTR = 0 AND WS-PHG-CTR = 0      10710000
              ADD 1 TO WS-NOT-CREATED                                   10720000
           ELSE                                                         10730000
              ADD 1 TO WS-CREATED                                       10740000
           END-IF.                                                      10750000
                                                                        10760000
           MOVE ZEROES TO WS-HGT-CTR WS-TUG-CTR WS-PHG-CTR              10770000
           MOVE 'N' TO WS-HGT-RCVRY WS-PHG-RCVRY                        10780000
                       WS-HGT WS-TUG WS-PHG.                            10790000
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 4          10800000
              INITIALIZE HGT-REC(WS-CTR) TUG-REC(WS-CTR) PHG-REC(WS-CTR)10810000
           END-PERFORM.                                                 10820000
                                                                        10830000
       1600-EXIT.                                                       10840000
           EXIT.                                                        10850000
                                                                        10860000
      *-----------------*                                               10870000
       2200-PROCESS-HGT.                                                10880000
      *-----------------*                                               10890000
           MOVE 'HGT' TO WS-GRANT-TYPE.                                 10900000
                                                                        10910000
           IF WS-HGT-RCVRY = 'Y'                                        10920000
              MOVE HGT-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  10930000
              MOVE HGT-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  10940000
              PERFORM 5700-READ-GRANT-RCVRY THRU 5700-EXIT              10950000
              IF WS-GRANT-RCVRY-FND NOT = 'Y'                           10960000
                 PERFORM 5730-MOVE-RCVRY-HGT THRU 5730-EXIT             10970000
                 PERFORM 5800-INSERT-GRANT-RCVRY THRU 5800-EXIT         10980000
                 IF WS-EX-INSERT NOT = 'Y'                              10990000
                    PERFORM 6000-READ-EX-GRANT-ASMNT THRU 6000-EXIT     11000000
                    IF WS-EX-GRANT-ASMNT-FND NOT = 'Y'                  11010000
                       PERFORM 3200-MOVE-GRANT-ASMNT-HGT THRU 3200-EXIT 11020000
                       PERFORM 6100-INSERT-EX-GRANT-ASMNT THRU 6100-EXIT11030000
                    END-IF                                              11040000
                 END-IF                                                 11050000
                 PERFORM 6300-READ-EX-GRANT-PRSN THRU 6300-EXIT         11060000
                 IF WS-EX-GRANT-PRSN-FND NOT = 'Y'                      11070000
                    PERFORM 5330-MOVE-GRANT-PRSN-HGT THRU 5330-EXIT     11080000
                    PERFORM 6500-INSERT-EX-GRANT-PRSN THRU 6500-EXIT    11090000
                 END-IF                                                 11100000
              END-IF                                                    11110000
           ELSE                                                         11120000
              PERFORM 5000-READ-GRANT-ASMNT THRU 5000-EXIT              11130000
              IF WS-GRANT-ASMNT-FND NOT = 'Y'                           11140000
                 PERFORM 3200-MOVE-GRANT-ASMNT-HGT THRU 3200-EXIT       11150000
                 PERFORM 5100-INSERT-GRANT-ASMNT THRU 5100-EXIT         11160000
              END-IF                                                    11170000
              MOVE HGT-NUM-NRIC(WS-CTR)                                 11180000
                       TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON         11190000
              PERFORM 5300-READ-GRANT-PRSN THRU 5300-EXIT               11200000
              IF WS-GRANT-PRSN-FND NOT = 'Y'                            11210000
                 PERFORM 5330-MOVE-GRANT-PRSN-HGT THRU 5330-EXIT        11220000
                 PERFORM 5500-INSERT-GRANT-PRSN THRU 5500-EXIT          11230000
              END-IF                                                    11240000
           END-IF.                                                      11250000
                                                                        11260000
       2200-EXIT.                                                       11270000
           EXIT.                                                        11280000
                                                                        11290000
      *-----------------*                                               11300000
       2300-PROCESS-TUG.                                                11310000
      *-----------------*                                               11320000
           MOVE 'TUG' TO WS-GRANT-TYPE.                                 11330000
                                                                        11340000
           PERFORM 5000-READ-GRANT-ASMNT THRU 5000-EXIT                 11350000
           IF WS-GRANT-ASMNT-FND NOT = 'Y'                              11360000
              PERFORM 3300-MOVE-GRANT-ASMNT-TUG THRU 3300-EXIT          11370000
              PERFORM 5100-INSERT-GRANT-ASMNT THRU 5100-EXIT            11380000
           END-IF                                                       11390000
           MOVE TUG-NUM-NRIC(WS-CTR)                                    11400000
                      TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON          11410000
           PERFORM 5300-READ-GRANT-PRSN THRU 5300-EXIT                  11420000
           IF WS-GRANT-PRSN-FND NOT = 'Y'                               11430000
              PERFORM 5340-MOVE-GRANT-PRSN-TUG THRU 5340-EXIT           11440000
              PERFORM 5500-INSERT-GRANT-PRSN THRU 5500-EXIT             11450000
           END-IF.                                                      11460000
                                                                        11470000
       2300-EXIT.                                                       11480000
           EXIT.                                                        11490000
                                                                        11500000
      *-----------------*                                               11510000
       2400-PROCESS-PHG.                                                11520000
      *-----------------*                                               11530000
           MOVE 'PHG' TO WS-GRANT-TYPE.                                 11540000
                                                                        11550000
           IF WS-PHG-RCVRY = 'Y'                                        11560000
              MOVE PHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  11570000
              MOVE PHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  11580000
              PERFORM 5700-READ-GRANT-RCVRY THRU 5700-EXIT              11590000
              IF WS-GRANT-RCVRY-FND NOT = 'Y'                           11600000
                 PERFORM 5740-MOVE-RCVRY-PHG THRU 5740-EXIT             11610000
                 PERFORM 5800-INSERT-GRANT-RCVRY THRU 5800-EXIT         11620000
                 IF WS-EX-INSERT NOT = 'Y'                              11630000
                    PERFORM 6000-READ-EX-GRANT-ASMNT THRU 6000-EXIT     11640000
                    IF WS-EX-GRANT-ASMNT-FND NOT = 'Y'                  11650000
                       PERFORM 3400-MOVE-GRANT-ASMNT-PHG THRU 3400-EXIT 11660000
                       PERFORM 6100-INSERT-EX-GRANT-ASMNT THRU 6100-EXIT11670000
                    END-IF                                              11680000
                 END-IF                                                 11690000
                 PERFORM 6300-READ-EX-GRANT-PRSN THRU 6300-EXIT         11700000
                 IF WS-EX-GRANT-PRSN-FND NOT = 'Y'                      11710000
                    PERFORM 5350-MOVE-GRANT-PRSN-PHG THRU 5350-EXIT     11720000
                    PERFORM 6500-INSERT-EX-GRANT-PRSN THRU 6500-EXIT    11730000
                 END-IF                                                 11740000
              END-IF                                                    11750000
           ELSE                                                         11760000
              PERFORM 5000-READ-GRANT-ASMNT THRU 5000-EXIT              11770000
              IF WS-GRANT-ASMNT-FND NOT = 'Y'                           11780000
                 PERFORM 3400-MOVE-GRANT-ASMNT-PHG THRU 3400-EXIT       11790000
                 PERFORM 5100-INSERT-GRANT-ASMNT THRU 5100-EXIT         11800000
              END-IF                                                    11810000
              MOVE PHG-NUM-NRIC(WS-CTR)                                 11820000
                       TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON         11830000
              PERFORM 5300-READ-GRANT-PRSN THRU 5300-EXIT               11840000
              IF WS-GRANT-PRSN-FND NOT = 'Y'                            11850000
                 PERFORM 5350-MOVE-GRANT-PRSN-PHG THRU 5350-EXIT        11860000
                 PERFORM 5500-INSERT-GRANT-PRSN THRU 5500-EXIT          11870000
              END-IF                                                    11880000
           END-IF.                                                      11890000
                                                                        11900000
       2400-EXIT.                                                       11910000
           EXIT.                                                        11920000
                                                                        11930000
      *-------------------------*                                       11940000
       3200-MOVE-GRANT-ASMNT-HGT.                                       11950000
      *-------------------------*                                       11960000
           IF WS-HGT-RCVRY = 'Y'                                        11970000
              MOVE KD00-NUM-HSGNT-REQ                                   11980000
                    TO NUM-ELGBL-GRANT OF DCLEX-GRANT-ASMNT             11990000
              MOVE KD00-NUM-HSGNT-STATUS                                12000000
                    TO NUM-GRANT-STATUS OF DCLEX-GRANT-ASMNT            12010000
              STRING KD00-DTE-HSGNT-SUBMIT(1:4) '-'                     12020000
                     KD00-DTE-HSGNT-SUBMIT(5:2) '-'                     12030000
                     KD00-DTE-HSGNT-SUBMIT(7:2)                         12040000
                        DELIMITED BY SIZE                               12050000
                                 INTO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   12060000
              STRING KD00-DTE-HSGNT-APPROVE(1:4) '-'                    12070000
                     KD00-DTE-HSGNT-APPROVE(5:2) '-'                    12080000
                     KD00-DTE-HSGNT-APPROVE(7:2)                        12090000
                        DELIMITED BY SIZE                               12100000
                                 INTO DTE-APRV OF DCLEX-GRANT-ASMNT     12110000
              STRING KD00-DTE-HSGNT-REJECT(1:4) '-'                     12120000
                     KD00-DTE-HSGNT-REJECT(5:2) '-'                     12130000
                     KD00-DTE-HSGNT-REJECT(7:2)                         12140000
                        DELIMITED BY SIZE                               12150000
                                 INTO DTE-REJECT OF DCLEX-GRANT-ASMNT   12160000
              MOVE '0001-01-01' TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT      12170000
              MOVE SPACES  TO NUM-RJCTN-REASON OF DCLEX-GRANT-ASMNT     12180000
              MOVE SPACES  TO NUM-WTDRWL-REASON OF DCLEX-GRANT-ASMNT    12190000
              STRING KD00-DTE-HSGNT-CPFREQ(1:4) '-'                     12200000
                     KD00-DTE-HSGNT-CPFREQ(5:2) '-'                     12210000
                     KD00-DTE-HSGNT-CPFREQ(7:2)                         12220000
                       DELIMITED BY SIZE                                12230000
                      INTO DTE-GRANT-RQST OF DCLEX-GRANT-ASMNT          12240000
                                                                        12250000
              MOVE SPACES TO NUM-GRANT-DOC-RCV OF DCLEX-GRANT-ASMNT     12260000
                                                                        12270000
              MOVE '0001-01-01'                                         12280000
                   TO DTE-ACK OF DCLEX-GRANT-ASMNT                      12290000
                      DTE-GRANT-FORM-ISSUE OF DCLEX-GRANT-ASMNT         12300000
                      DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLEX-GRANT-ASMNT 12310000
                      DTE-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT     12320000
                      DTE-PYMNT OF DCLEX-GRANT-ASMNT                    12330000
              MOVE SPACES                                               12340000
                   TO NUM-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT     12350000
              MOVE '00.00.00' TO TME-APNTMT OF DCLEX-GRANT-ASMNT        12360000
              MOVE '0001-01-01' TO DTE-APNTMT OF DCLEX-GRANT-ASMNT      12370000
              MOVE SPACES                                               12380000
                         TO NUM-HALF-GRANT OF DCLEX-GRANT-ASMNT         12390000
           ELSE                                                         12400000
              MOVE KD00-NUM-HSGNT-REQ                                   12410000
                    TO NUM-ELGBL-GRANT OF DCLGRANT-ASMNT                12420000
              MOVE KD00-NUM-HSGNT-ELIG                                  12430000
                    TO NUM-GRANT-AMOUNT-ELGBL OF DCLGRANT-ASMNT         12440000
              MOVE KD00-NUM-HSGNT-STATUS                                12450000
                    TO NUM-GRANT-STATUS OF DCLGRANT-ASMNT               12460000
              STRING KD00-DTE-HSGNT-SUBMIT(1:4) '-'                     12470000
                     KD00-DTE-HSGNT-SUBMIT(5:2) '-'                     12480000
                     KD00-DTE-HSGNT-SUBMIT(7:2)                         12490000
                           DELIMITED BY SIZE                            12500000
                                    INTO DTE-SUBMIT OF DCLGRANT-ASMNT   12510000
              STRING KD00-DTE-HSGNT-APPROVE(1:4) '-'                    12520000
                     KD00-DTE-HSGNT-APPROVE(5:2) '-'                    12530000
                     KD00-DTE-HSGNT-APPROVE(7:2)                        12540000
                         DELIMITED BY SIZE                              12550000
                                    INTO DTE-APRV OF DCLGRANT-ASMNT     12560000
              STRING KD00-DTE-HSGNT-REJECT(1:4) '-'                     12570000
                     KD00-DTE-HSGNT-REJECT(5:2) '-'                     12580000
                     KD00-DTE-HSGNT-REJECT(7:2)                         12590000
                         DELIMITED BY SIZE                              12600000
                                    INTO DTE-REJECT OF DCLGRANT-ASMNT   12610000
              MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT         12620000
              MOVE SPACES TO NUM-RJCTN-REASON OF DCLGRANT-ASMNT         12630000
              MOVE SPACES TO NUM-WTDRWL-REASON OF DCLGRANT-ASMNT        12640000
              STRING KD00-DTE-HSGNT-CPFREQ(1:4) '-'                     12650000
                     KD00-DTE-HSGNT-CPFREQ(5:2) '-'                     12660000
                     KD00-DTE-HSGNT-CPFREQ(7:2)                         12670000
                   DELIMITED BY SIZE                                    12680000
                            INTO DTE-GRANT-RQST OF DCLGRANT-ASMNT       12690000
              MOVE SPACES TO NUM-GRANT-DOC-RCV OF DCLGRANT-ASMNT        12700000
              MOVE '0001-01-01'                                         12710000
                   TO DTE-ACK OF DCLGRANT-ASMNT                         12720000
                      DTE-GRANT-FORM-ISSUE OF DCLGRANT-ASMNT            12730000
                      DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLGRANT-ASMNT    12740000
                      DTE-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT        12750000
                      DTE-PYMNT OF DCLGRANT-ASMNT                       12760000
              MOVE SPACES TO NUM-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT 12770000
              MOVE '00.00.00' TO TME-APNTMT OF DCLGRANT-ASMNT           12780000
              MOVE '0001-01-01' TO DTE-APNTMT OF DCLGRANT-ASMNT         12790000
              MOVE SPACES TO NUM-HALF-GRANT OF DCLGRANT-ASMNT           12800000
           END-IF.                                                      12810000
                                                                        12820000
       3200-EXIT.                                                       12830000
           EXIT.                                                        12840000
                                                                        12850000
      *-------------------------*                                       12860000
       3300-MOVE-GRANT-ASMNT-TUG.                                       12870000
      *-------------------------*                                       12880000
                                                                        12890000
           MOVE KD00-NUM-HSGNT-REQ-TOPUP                                12900000
                      TO NUM-ELGBL-GRANT OF DCLGRANT-ASMNT.             12910000
           MOVE KD00-NUM-HSGNT-ELIG-TOPUP                               12920000
                      TO NUM-GRANT-AMOUNT-ELGBL OF DCLGRANT-ASMNT.      12930000
           MOVE KD00-NUM-HSGNT-STATUS-TOPUP                             12940000
                         TO NUM-GRANT-STATUS OF DCLGRANT-ASMNT.         12950000
           STRING KD00-DTE-HSGNT-SUBMIT-TOPUP(1:4) '-'                  12960000
                  KD00-DTE-HSGNT-SUBMIT-TOPUP(5:2) '-'                  12970000
                  KD00-DTE-HSGNT-SUBMIT-TOPUP(7:2)                      12980000
                      DELIMITED BY SIZE                                 12990000
                      INTO DTE-SUBMIT OF DCLGRANT-ASMNT.                13000000
           STRING KD00-DTE-HSGNT-APPROVE-TOPUP(1:4) '-'                 13010000
                  KD00-DTE-HSGNT-APPROVE-TOPUP(5:2) '-'                 13020000
                  KD00-DTE-HSGNT-APPROVE-TOPUP(7:2)                     13030000
                      DELIMITED BY SIZE                                 13040000
                         INTO DTE-APRV OF DCLGRANT-ASMNT.               13050000
           STRING KD00-DTE-HSGNT-REJECT-TOPUP(1:4) '-'                  13060000
                  KD00-DTE-HSGNT-REJECT-TOPUP(5:2) '-'                  13070000
                  KD00-DTE-HSGNT-REJECT-TOPUP(7:2)                      13080000
                      DELIMITED BY SIZE                                 13090000
                         INTO DTE-REJECT OF DCLGRANT-ASMNT.             13100000
           MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT.           13110000
           MOVE KD00-NUM-CHG-REJECT-TOPUP                               13120000
                                TO NUM-RJCTN-REASON OF DCLGRANT-ASMNT.  13130000
           MOVE KD00-NUM-CHG-WITHDRAW-TOPUP                             13140000
                                TO NUM-WTDRWL-REASON OF DCLGRANT-ASMNT. 13150000
           STRING KD00-DTE-HSGNT-CPFREQ-TOPUP(1:4) '-'                  13160000
                  KD00-DTE-HSGNT-CPFREQ-TOPUP(5:2) '-'                  13170000
                  KD00-DTE-HSGNT-CPFREQ-TOPUP(7:2)                      13180000
                      DELIMITED BY SIZE                                 13190000
                   INTO DTE-GRANT-RQST OF DCLGRANT-ASMNT.               13200000
           MOVE SPACES TO NUM-GRANT-DOC-RCV OF DCLGRANT-ASMNT.          13210000
           MOVE '0001-01-01'                                            13220000
                   TO DTE-ACK OF DCLGRANT-ASMNT                         13230000
                      DTE-GRANT-FORM-ISSUE OF DCLGRANT-ASMNT            13240000
                      DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLGRANT-ASMNT    13250000
                      DTE-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT        13260000
                      DTE-PYMNT OF DCLGRANT-ASMNT.                      13270000
           MOVE SPACES TO NUM-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT.   13280000
           MOVE '00.00.00' TO TME-APNTMT OF DCLGRANT-ASMNT.             13290000
           MOVE '0001-01-01' TO DTE-APNTMT OF DCLGRANT-ASMNT.           13300000
           MOVE SPACES       TO NUM-HALF-GRANT OF DCLGRANT-ASMNT.       13310000
                                                                        13320000
       3300-EXIT.                                                       13330000
           EXIT.                                                        13340000
                                                                        13350000
      *-------------------------*                                       13360000
       3400-MOVE-GRANT-ASMNT-PHG.                                       13370000
      *-------------------------*                                       13380000
                                                                        13390000
           MOVE KD00-NUM-PHG-ELIG TO NUM-ELGBL-GRANT OF DCLGRANT-ASMNT. 13400000
           MOVE PHG-AMT-NUM-SHG(WS-CTR)                                 13410000
                         TO NUM-GRANT-AMOUNT-ELGBL OF DCLGRANT-ASMNT.   13420000
           MOVE KD00-NUM-PHG-STATUS                                     13430000
                         TO NUM-GRANT-STATUS OF DCLGRANT-ASMNT.         13440000
           STRING KD00-DTE-PHG-SUBMIT(1:4) '-'                          13450000
                  KD00-DTE-PHG-SUBMIT(5:2) '-'                          13460000
                  KD00-DTE-PHG-SUBMIT(7:2)                              13470000
                      DELIMITED BY SIZE                                 13480000
                      INTO DTE-SUBMIT OF DCLGRANT-ASMNT.                13490000
           STRING KD00-DTE-PHG-APPROVE(1:4) '-'                         13500000
                  KD00-DTE-PHG-APPROVE(5:2) '-'                         13510000
                  KD00-DTE-PHG-APPROVE(7:2)                             13520000
                      DELIMITED BY SIZE                                 13530000
                         INTO DTE-APRV OF DCLGRANT-ASMNT.               13540000
           MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT            13550000
                                DTE-REJECT OF DCLGRANT-ASMNT.           13560000
           MOVE SPACES TO NUM-RJCTN-REASON OF DCLGRANT-ASMNT            13570000
                          NUM-WTDRWL-REASON OF DCLGRANT-ASMNT.          13580000
           STRING KD00-DTE-PHG-CPFREQ(1:4) '-'                          13590000
                  KD00-DTE-PHG-CPFREQ(5:2) '-'                          13600000
                  KD00-DTE-PHG-CPFREQ(7:2)                              13610000
                      DELIMITED BY SIZE                                 13620000
                   INTO DTE-GRANT-RQST OF DCLGRANT-ASMNT.               13630000
           MOVE SPACES TO NUM-GRANT-DOC-RCV OF DCLGRANT-ASMNT.          13640000
           MOVE '0001-01-01'                                            13650000
                   TO DTE-ACK OF DCLGRANT-ASMNT                         13660000
                      DTE-GRANT-FORM-ISSUE OF DCLGRANT-ASMNT            13670000
                      DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLGRANT-ASMNT    13680000
                      DTE-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT        13690000
                      DTE-PYMNT OF DCLGRANT-ASMNT.                      13700000
           MOVE SPACES TO NUM-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT.   13710000
           MOVE '00.00.00' TO TME-APNTMT OF DCLGRANT-ASMNT.             13720000
           MOVE '0001-01-01' TO DTE-APNTMT OF DCLGRANT-ASMNT.           13730000
           MOVE SPACES       TO NUM-HALF-GRANT OF DCLGRANT-ASMNT.       13740000
                                                                        13750000
       3400-EXIT.                                                       13760000
           EXIT.                                                        13770000
                                                                        13780000
      *--------------------*                                            13790000
       5000-READ-GRANT-ASMNT.                                           13800000
      *--------------------*                                            13810000
           MOVE WS-PREV-REGN     TO NUM-RGSTRN OF DCLGRANT-ASMNT.       13820000
           MOVE WS-GRANT-TYPE    TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT.   13830000
                                                                        13840000
           MOVE 'N'              TO WS-GRANT-ASMNT-FND.                 13850000
                                                                        13860000
           EXEC SQL                                                     13870000
              SELECT NUM_RGSTRN,                                        13880000
                     NUM_GRANT_TYPE,                                    13890000
                     NUM_ELGBL_GRANT,                                   13900000
                     NUM_GRANT_AMOUNT_ELGBL,                            13910000
                     NUM_GRANT_STATUS,                                  13920000
                     DTE_APRV,                                          13930000
                     DTE_CANCEL,                                        13940000
                     DTE_REJECT,                                        13950000
                     DTE_SUBMIT,                                        13960000
                     DTE_WTHDRW,                                        13970000
                     NUM_RJCTN_REASON,                                  13980000
                     NUM_WTDRWL_REASON,                                 13990000
                     TXT_CNCLTN_REASON,                                 14000000
                     DTE_GRANT_RQST,                                    14010000
                     NUM_GRANT_DOC_RCV,                                 14020000
                     DTE_ACK,                                           14030000
                     DTE_GRANT_FORM_ISSUE,                              14040000
                     DTE_GRANT_OPT_OUT_FORM_ISSUE,                      14050000
                     NUM_GRANT_OPT_OUT_REASON,                          14060000
                     DTE_GRANT_OPT_OUT_REASON,                          14070000
                     NUM_ALCTN_SCHEME,                                  14080000
                     NUM_HSHLD_CTZNSP,                                  14090000
                     NUM_WRKNG_CHILD_ASMNT,                             14100000
                     QTY_MONTH_WORK,                                    14110000
                     NUM_APPEAL_ATCHMT,                                 14120000
                     NUM_PARENT_ADRS_BLDNG,                             14130000
                     NUM_PARENT_ADRS_LEVEL,                             14140000
                     NUM_PARENT_ADRS_UNIT,                              14150000
                     TXT_PARENT_ADRS1,                                  14160000
                     TXT_PARENT_ADRS2,                                  14170000
                     NUM_PARENT_ADRS_POSTAL,                            14180000
                     DTE_PYMNT,                                         14190000
                     DTE_CPF_ACK_GRANT_RCV,                             14200000
                     NUM_GRANT_CREDIT,                                  14210000
                     TME_APNTMT,                                        14220000
                     DTE_APNTMT,                                        14230000
                     TME_CREATE_ASMNT,                                  14240000
                     NUM_UPDATE_USERID,                                 14250000
                     TME_UPDATE,                                        14260000
                     DTE_UPDATE,                                        14270000
                     NUM_SOURCE_SYSTEM,                                 14280000
                     NUM_ACNT,                                          14290000
                     NUM_SCHEME,                                        14300000
                     NUM_TNCY,                                          14310000
                     NUM_HALF_GRANT                                     14320000
              INTO  :DCLGRANT-ASMNT.NUM-RGSTRN,                         14330000
                    :DCLGRANT-ASMNT.NUM-GRANT-TYPE,                     14340000
                    :DCLGRANT-ASMNT.NUM-ELGBL-GRANT,                    14350000
                    :DCLGRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,             14360000
                    :DCLGRANT-ASMNT.NUM-GRANT-STATUS,                   14370000
                    :DCLGRANT-ASMNT.DTE-APRV,                           14380000
                    :DCLGRANT-ASMNT.DTE-CANCEL,                         14390000
                    :DCLGRANT-ASMNT.DTE-REJECT,                         14400000
                    :DCLGRANT-ASMNT.DTE-SUBMIT,                         14410000
                    :DCLGRANT-ASMNT.DTE-WTHDRW,                         14420000
                    :DCLGRANT-ASMNT.NUM-RJCTN-REASON,                   14430000
                    :DCLGRANT-ASMNT.NUM-WTDRWL-REASON,                  14440000
                    :DCLGRANT-ASMNT.TXT-CNCLTN-REASON,                  14450000
                    :DCLGRANT-ASMNT.DTE-GRANT-RQST,                     14460000
                    :DCLGRANT-ASMNT.NUM-GRANT-DOC-RCV,                  14470000
                    :DCLGRANT-ASMNT.DTE-ACK,                            14480000
                    :DCLGRANT-ASMNT.DTE-GRANT-FORM-ISSUE,               14490000
                    :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,       14500000
                    :DCLGRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,           14510000
                    :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,           14520000
                    :DCLGRANT-ASMNT.NUM-ALCTN-SCHEME,                   14530000
                    :DCLGRANT-ASMNT.NUM-HSHLD-CTZNSP,                   14540000
                    :DCLGRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,              14550000
                    :DCLGRANT-ASMNT.QTY-MONTH-WORK,                     14560000
                    :DCLGRANT-ASMNT.NUM-APPEAL-ATCHMT,                  14570000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,              14580000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,              14590000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-UNIT,               14600000
                    :DCLGRANT-ASMNT.TXT-PARENT-ADRS1,                   14610000
                    :DCLGRANT-ASMNT.TXT-PARENT-ADRS2,                   14620000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,             14630000
                    :DCLGRANT-ASMNT.DTE-PYMNT,                          14640000
                    :DCLGRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,              14650000
                    :DCLGRANT-ASMNT.NUM-GRANT-CREDIT,                   14660000
                    :DCLGRANT-ASMNT.TME-APNTMT,                         14670000
                    :DCLGRANT-ASMNT.DTE-APNTMT,                         14680000
                    :DCLGRANT-ASMNT.TME-CREATE-ASMNT,                   14690000
                    :DCLGRANT-ASMNT.NUM-UPDATE-USERID,                  14700000
                    :DCLGRANT-ASMNT.TME-UPDATE,                         14710000
                    :DCLGRANT-ASMNT.DTE-UPDATE,                         14720000
                    :DCLGRANT-ASMNT.NUM-SOURCE-SYSTEM,                  14730000
                    :DCLGRANT-ASMNT.NUM-ACNT,                           14740000
                    :DCLGRANT-ASMNT.NUM-SCHEME,                         14750000
                    :DCLGRANT-ASMNT.NUM-TNCY,                           14760000
                    :DCLGRANT-ASMNT.NUM-HALF-GRANT                      14770000
              FROM                                                      14780000
                GRANT_ASMNT                                             14790000
              WHERE NUM_RGSTRN       = :DCLGRANT-ASMNT.NUM-RGSTRN       14800000
               AND  NUM_GRANT_TYPE   = :DCLGRANT-ASMNT.NUM-GRANT-TYPE   14810000
           END-EXEC.                                                    14820000
                                                                        14830000
           EVALUATE SQLCODE                                             14840000
           WHEN WS-SQL-OK                                               14850000
                MOVE 'Y' TO WS-GRANT-ASMNT-FND                          14860000
                                                                        14870000
           WHEN WS-SQL-NFND                                             14880000
                MOVE 'N' TO WS-GRANT-ASMNT-FND                          14890000
                                                                        14900000
           WHEN OTHER                                                   14910000
                MOVE SQLCODE   TO WS-SQLCODE                            14920000
                DISPLAY 'ERROR READING GRANT_ASMNT'                     14930000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      14940000
                DISPLAY SPACES                                          14950000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              14960000
           END-EVALUATE.                                                14970000
                                                                        14980000
       5000-EXIT.                                                       14990000
           EXIT.                                                        15000000
                                                                        15010000
      *------------------------*                                        15020000
       5100-INSERT-GRANT-ASMNT.                                         15030000
      *------------------------*                                        15040000
           MOVE WS-PREV-REGN     TO NUM-RGSTRN OF DCLGRANT-ASMNT.       15050000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT.      15060000
           MOVE '0001-01-01' TO DTE-CANCEL OF DCLGRANT-ASMNT.           15070000
           MOVE SPACES TO TXT-CNCLTN-REASON OF DCLGRANT-ASMNT           15080000
                          NUM-APPEAL-ATCHMT OF DCLGRANT-ASMNT           15090000
                          NUM-PARENT-ADRS-BLDNG OF DCLGRANT-ASMNT       15100000
                          NUM-PARENT-ADRS-LEVEL OF DCLGRANT-ASMNT       15110000
                          NUM-PARENT-ADRS-UNIT OF DCLGRANT-ASMNT        15120000
                          TXT-PARENT-ADRS1 OF DCLGRANT-ASMNT            15130000
                          TXT-PARENT-ADRS2 OF DCLGRANT-ASMNT            15140000
                          NUM-PARENT-ADRS-POSTAL OF DCLGRANT-ASMNT.     15150000
           MOVE WS-NUM-ALLO-SCHEME                                      15160000
                       TO NUM-ALCTN-SCHEME OF DCLGRANT-ASMNT.           15170000
           MOVE WS-CDE-CITIZENSHIP-HH                                   15180000
                       TO NUM-HSHLD-CTZNSP OF DCLGRANT-ASMNT.           15190000
           MOVE WS-NUM-PARENT-CHILD                                     15200000
                       TO NUM-WRKNG-CHILD-ASMNT OF DCLGRANT-ASMNT.      15210000
           MOVE WS-NUM-MONTHS-WORKED                                    15220000
                                TO QTY-MONTH-WORK OF DCLGRANT-ASMNT.    15230000
           STRING WS-DTE-CPF-ACK-GRANT(1:4) '-'                         15240000
                  WS-DTE-CPF-ACK-GRANT(5:2) '-'                         15250000
                  WS-DTE-CPF-ACK-GRANT(7:2)                             15260000
                DELIMITED BY SIZE                                       15270000
                     INTO DTE-CPF-ACK-GRANT-RCV OF DCLGRANT-ASMNT.      15280000
           MOVE WS-NUM-GRANT-CREDIT-TAG                                 15290000
                       TO NUM-GRANT-CREDIT OF DCLGRANT-ASMNT.           15300000
           MOVE WS-TIMESTAMP                                            15310000
                 TO TME-CREATE-ASMNT OF DCLGRANT-ASMNT.                 15320000
           MOVE 'BP13CB0L'                                              15330000
                       TO NUM-UPDATE-USERID OF DCLGRANT-ASMNT.          15340000
                                                                        15350000
           STRING WS-TIME-HHMMSS(1:2) '.'                               15360000
                  WS-TIME-HHMMSS(3:2) '.'                               15370000
                  WS-TIME-HHMMSS(5:2)                                   15380000
                DELIMITED BY SIZE INTO TME-UPDATE OF DCLGRANT-ASMNT.    15390000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              15400000
                  WS-DTE-CCYYMMDD(5:2) '-'                              15410000
                  WS-DTE-CCYYMMDD(7:2)                                  15420000
                DELIMITED BY SIZE INTO DTE-UPDATE OF DCLGRANT-ASMNT.    15430000
                                                                        15440000
           MOVE 'BP13' TO NUM-SOURCE-SYSTEM OF DCLGRANT-ASMNT.          15450000
           MOVE KD00-NUM-SCH-ACCNT(1:4) TO NUM-SCHEME OF DCLGRANT-ASMNT.15460000
           MOVE KD00-NUM-SCH-ACCNT(5:5) TO NUM-ACNT OF DCLGRANT-ASMNT.  15470000
           MOVE KD00-NUM-SCH-ACCNT(10:2) TO NUM-TNCY OF DCLGRANT-ASMNT. 15480000
                                                                        15490000
            EXEC SQL                                                    15500000
                 INSERT INTO GRANT_ASMNT                                15510000
                        ( NUM_RGSTRN,                                   15520000
                          NUM_GRANT_TYPE,                               15530000
                          NUM_ELGBL_GRANT,                              15540000
                          NUM_GRANT_AMOUNT_ELGBL,                       15550000
                          NUM_GRANT_STATUS,                             15560000
                          DTE_APRV,                                     15570000
                          DTE_CANCEL,                                   15580000
                          DTE_REJECT,                                   15590000
                          DTE_SUBMIT,                                   15600000
                          DTE_WTHDRW,                                   15610000
                          NUM_RJCTN_REASON,                             15620000
                          NUM_WTDRWL_REASON,                            15630000
                          TXT_CNCLTN_REASON,                            15640000
                          DTE_GRANT_RQST,                               15650000
                          NUM_GRANT_DOC_RCV,                            15660000
                          DTE_ACK,                                      15670000
                          DTE_GRANT_FORM_ISSUE,                         15680000
                          DTE_GRANT_OPT_OUT_FORM_ISSUE,                 15690000
                          NUM_GRANT_OPT_OUT_REASON,                     15700000
                          DTE_GRANT_OPT_OUT_REASON,                     15710000
                          NUM_ALCTN_SCHEME,                             15720000
                          NUM_HSHLD_CTZNSP,                             15730000
                          NUM_WRKNG_CHILD_ASMNT,                        15740000
                          QTY_MONTH_WORK,                               15750000
                          NUM_APPEAL_ATCHMT,                            15760000
                          NUM_PARENT_ADRS_BLDNG,                        15770000
                          NUM_PARENT_ADRS_LEVEL,                        15780000
                          NUM_PARENT_ADRS_UNIT,                         15790000
                          TXT_PARENT_ADRS1,                             15800000
                          TXT_PARENT_ADRS2,                             15810000
                          NUM_PARENT_ADRS_POSTAL,                       15820000
                          DTE_PYMNT,                                    15830000
                          DTE_CPF_ACK_GRANT_RCV,                        15840000
                          NUM_GRANT_CREDIT,                             15850000
                          TME_APNTMT,                                   15860000
                          DTE_APNTMT,                                   15870000
                          TME_CREATE_ASMNT,                             15880000
                          NUM_UPDATE_USERID,                            15890000
                          TME_UPDATE,                                   15900000
                          DTE_UPDATE,                                   15910000
                          NUM_SOURCE_SYSTEM,                            15920000
                          NUM_ACNT,                                     15930000
                          NUM_SCHEME,                                   15940000
                          NUM_TNCY,                                     15950000
                          NUM_HALF_GRANT )                              15960000
                 VALUES ( :DCLGRANT-ASMNT.NUM-RGSTRN,                   15970000
                          :DCLGRANT-ASMNT.NUM-GRANT-TYPE,               15980000
                          :DCLGRANT-ASMNT.NUM-ELGBL-GRANT,              15990000
                          :DCLGRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,       16000000
                          :DCLGRANT-ASMNT.NUM-GRANT-STATUS,             16010000
                          :DCLGRANT-ASMNT.DTE-APRV,                     16020000
                          :DCLGRANT-ASMNT.DTE-CANCEL,                   16030000
                          :DCLGRANT-ASMNT.DTE-REJECT,                   16040000
                          :DCLGRANT-ASMNT.DTE-SUBMIT,                   16050000
                          :DCLGRANT-ASMNT.DTE-WTHDRW,                   16060000
                          :DCLGRANT-ASMNT.NUM-RJCTN-REASON,             16070000
                          :DCLGRANT-ASMNT.NUM-WTDRWL-REASON,            16080000
                          :DCLGRANT-ASMNT.TXT-CNCLTN-REASON,            16090000
                          :DCLGRANT-ASMNT.DTE-GRANT-RQST,               16100000
                          :DCLGRANT-ASMNT.NUM-GRANT-DOC-RCV,            16110000
                          :DCLGRANT-ASMNT.DTE-ACK,                      16120000
                          :DCLGRANT-ASMNT.DTE-GRANT-FORM-ISSUE,         16130000
                          :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE, 16140000
                          :DCLGRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,     16150000
                          :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,     16160000
                          :DCLGRANT-ASMNT.NUM-ALCTN-SCHEME,             16170000
                          :DCLGRANT-ASMNT.NUM-HSHLD-CTZNSP,             16180000
                          :DCLGRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,        16190000
                          :DCLGRANT-ASMNT.QTY-MONTH-WORK,               16200000
                          :DCLGRANT-ASMNT.NUM-APPEAL-ATCHMT,            16210000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,        16220000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,        16230000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-UNIT,         16240000
                          :DCLGRANT-ASMNT.TXT-PARENT-ADRS1,             16250000
                          :DCLGRANT-ASMNT.TXT-PARENT-ADRS2,             16260000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,       16270000
                          :DCLGRANT-ASMNT.DTE-PYMNT,                    16280000
                          :DCLGRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,        16290000
                          :DCLGRANT-ASMNT.NUM-GRANT-CREDIT,             16300000
                          :DCLGRANT-ASMNT.TME-APNTMT,                   16310000
                          :DCLGRANT-ASMNT.DTE-APNTMT,                   16320000
                          :DCLGRANT-ASMNT.TME-CREATE-ASMNT,             16330000
                          :DCLGRANT-ASMNT.NUM-UPDATE-USERID,            16340000
                          :DCLGRANT-ASMNT.TME-UPDATE,                   16350000
                          :DCLGRANT-ASMNT.DTE-UPDATE,                   16360000
                          :DCLGRANT-ASMNT.NUM-SOURCE-SYSTEM,            16370000
                          :DCLGRANT-ASMNT.NUM-ACNT,                     16380000
                          :DCLGRANT-ASMNT.NUM-SCHEME,                   16390000
                          :DCLGRANT-ASMNT.NUM-TNCY,                     16400000
                          :DCLGRANT-ASMNT.NUM-HALF-GRANT )              16410000
            END-EXEC.                                                   16420000
                                                                        16430000
            EVALUATE SQLCODE                                            16440000
               WHEN 000                                                 16450000
                    ADD 1                 TO CNT-ASMNT-INSERT           16460000
                    MOVE 'GRANT_ASMNT'  TO WS-SOURCE                    16470000
                    MOVE 'C'            TO WS-ACTION                    16480000
                    MOVE NUM-RGSTRN OF DCLGRANT-ASMNT TO WS-RGSTRN      16490000
                    MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT               16500000
                                                  TO WS-GRNT-TYPE       16510000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           16520000
                    MOVE DCLGRANT-ASMNT TO WS-AFTER-IMAGE               16530000
                    PERFORM 8000-INSERT-TO-LOG THRU 8000-EXIT           16540000
                    PERFORM 9100-COMMIT        THRU 9100-EXIT           16550000
                                                                        16560000
               WHEN -803                                                16570000
                    CONTINUE                                            16580000
                                                                        16590000
               WHEN OTHER                                               16600000
                    MOVE SQLCODE          TO WS-SQLCODE                 16610000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_ASMNT'         16620000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            16630000
                    DISPLAY DCLGRANT-ASMNT                              16640000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          16650000
            END-EVALUATE.                                               16660000
                                                                        16670000
       5100-EXIT.                                                       16680000
           EXIT.                                                        16690000
                                                                        16700000
      *--------------------*                                            16710000
       5300-READ-GRANT-PRSN.                                            16720000
      *--------------------*                                            16730000
           MOVE WS-PREV-REGN TO NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON.    16740000
           MOVE WS-GRANT-TYPE                                           16750000
                           TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON.  16760000
                                                                        16770000
           MOVE 'N'        TO WS-GRANT-PRSN-FND.                        16780000
                                                                        16790000
           EXEC SQL                                                     16800000
              SELECT NUM_RGSTRN,                                        16810000
                     NUM_GRANT_TYPE,                                    16820000
                     NUM_IDNTY_NO,                                      16830000
                     NUM_IDNTY_NO_TYPE,                                 16840000
                     NUM_CSTMR_SOURCE,                                  16850000
                     NUM_CPF_ACNT,                                      16860000
                     AMT_GRANT,                                         16870000
                     AMT_GRANT_USE,                                     16880000
                     NUM_ROLE_TAG,                                      16890000
                     NUM_RLTNSP,                                        16900000
                     NME_PERSON,                                        16910000
                     NUM_GENDER,                                        16920000
                     NUM_CTZNSP,                                        16930000
                     NUM_MRTL_STATUS,                                   16940000
                     AMT_INCOME,                                        16950000
                     NUM_1YR_CNTNS_EMPLY,                               16960000
                     NUM_DEBAR,                                         16970000
                     NUM_DEBAR_REASON,                                  16980000
                     NUM_RCVRY,                                         16990000
                     NUM_UPDATE_USERID,                                 17000000
                     DTE_UPDATE,                                        17010000
                     TME_UPDATE,                                        17020000
                     AMT_GRANT_THRSHD                                   17030000
              INTO  :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN,                  17040000
                    :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE,              17050000
                    :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO,                17060000
                    :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,           17070000
                    :DCLGRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,            17080000
                    :DCLGRANT-ASMNT-PERSON.NUM-CPF-ACNT,                17090000
                    :DCLGRANT-ASMNT-PERSON.AMT-GRANT,                   17100000
                    :DCLGRANT-ASMNT-PERSON.AMT-GRANT-USE,               17110000
                    :DCLGRANT-ASMNT-PERSON.NUM-ROLE-TAG,                17120000
                    :DCLGRANT-ASMNT-PERSON.NUM-RLTNSP,                  17130000
                    :DCLGRANT-ASMNT-PERSON.NME-PERSON,                  17140000
                    :DCLGRANT-ASMNT-PERSON.NUM-GENDER,                  17150000
                    :DCLGRANT-ASMNT-PERSON.NUM-CTZNSP,                  17160000
                    :DCLGRANT-ASMNT-PERSON.NUM-MRTL-STATUS,             17170000
                    :DCLGRANT-ASMNT-PERSON.AMT-INCOME,                  17180000
                    :DCLGRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,         17190000
                    :DCLGRANT-ASMNT-PERSON.NUM-DEBAR,                   17200000
                    :DCLGRANT-ASMNT-PERSON.NUM-DEBAR-REASON,            17210000
                    :DCLGRANT-ASMNT-PERSON.NUM-RCVRY,                   17220000
                    :DCLGRANT-ASMNT-PERSON.NUM-UPDATE-USERID,           17230000
                    :DCLGRANT-ASMNT-PERSON.DTE-UPDATE,                  17240000
                    :DCLGRANT-ASMNT-PERSON.TME-UPDATE,                  17250000
                    :DCLGRANT-ASMNT-PERSON.AMT-GRANT-THRSHD             17260000
              FROM                                                      17270000
                GRANT_ASMNT_PERSON                                      17280000
              WHERE                                                     17290000
                NUM_RGSTRN = :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN AND      17300000
                NUM_GRANT_TYPE = :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE  17310000
               AND  NUM_IDNTY_NO = :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO  17320000
           END-EXEC.                                                    17330000
                                                                        17340000
           EVALUATE SQLCODE                                             17350000
           WHEN WS-SQL-OK                                               17360000
                MOVE 'Y' TO WS-GRANT-PRSN-FND                           17370000
                                                                        17380000
           WHEN WS-SQL-NFND                                             17390000
                MOVE 'N' TO WS-GRANT-PRSN-FND                           17400000
                                                                        17410000
           WHEN OTHER                                                   17420000
                MOVE SQLCODE   TO WS-SQLCODE                            17430000
                DISPLAY 'ERROR READING GRANT_ASMNT_PERSON'              17440000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      17450000
                DISPLAY SPACES                                          17460000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              17470000
           END-EVALUATE.                                                17480000
                                                                        17490000
       5300-EXIT.                                                       17500000
           EXIT.                                                        17510000
                                                                        17520000
      *------------------------*                                        17530000
       5330-MOVE-GRANT-PRSN-HGT.                                        17540000
      *------------------------*                                        17550000
           IF WS-HGT-RCVRY = 'Y'                                        17560000
              MOVE HGT-AMT-HSGNT(WS-CTR)                                17570000
                      TO AMT-GRANT OF DCLEX-GRANT-ASMNT-PERSON          17580000
              MOVE HGT-AMT-HSGNT-USED(WS-CTR)                           17590000
                      TO AMT-GRANT-USE OF DCLEX-GRANT-ASMNT-PERSON      17600000
              IF HGT-AMT-HSGNT-RECOVER(WS-CTR) NOT = ZEROES             17610000
                 MOVE 'Y' TO NUM-RCVRY OF DCLEX-GRANT-ASMNT-PERSON      17620000
              END-IF                                                    17630000
              MOVE HGT-NUM-NRIC(WS-CTR)                                 17640000
                   TO NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON          17650000
              EVALUATE TRUE                                             17660000
              WHEN HGT-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               17670000
               MOVE 'UIN'                                               17680000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    17690000
              WHEN HGT-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        17700001
               MOVE 'FIN'                                               17710000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    17720000
              WHEN OTHER                                                17730000
               MOVE 'XIN'                                               17740000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    17750000
              END-EVALUATE                                              17760000
              MOVE HGT-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  17770000
              MOVE HGT-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  17780000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              17790000
              MOVE WS-C-SRC                                             17800000
                    TO NUM-CSTMR-SOURCE OF DCLEX-GRANT-ASMNT-PERSON     17810000
              MOVE HGT-NUM-NRIC(WS-CTR)                                 17820000
                   TO NUM-CPF-ACNT OF DCLEX-GRANT-ASMNT-PERSON          17830000
              MOVE HGT-NUM-HA-TAG(WS-CTR)                               17840000
                   TO NUM-ROLE-TAG OF DCLEX-GRANT-ASMNT-PERSON          17850000
              MOVE HGT-NUM-RELATIONSHIP(WS-CTR)                         17860000
                   TO NUM-RLTNSP OF DCLEX-GRANT-ASMNT-PERSON            17870000
              MOVE HGT-NME-OCCP(WS-CTR)                                 17880000
                   TO NME-PERSON OF DCLEX-GRANT-ASMNT-PERSON            17890000
              MOVE HGT-NUM-SEX(WS-CTR)                                  17900000
                   TO NUM-GENDER OF DCLEX-GRANT-ASMNT-PERSON            17910000
              MOVE HGT-NUM-CITIZENSHIP(WS-CTR)                          17920000
                   TO NUM-CTZNSP OF DCLEX-GRANT-ASMNT-PERSON            17930000
              MOVE HGT-NUM-MARITAL-STATUS(WS-CTR)                       17940000
                   TO NUM-MRTL-STATUS OF DCLEX-GRANT-ASMNT-PERSON       17950000
              MOVE HGT-AMT-INCOME-AHG(WS-CTR)                           17960000
                   TO AMT-INCOME OF DCLEX-GRANT-ASMNT-PERSON            17970000
              MOVE HGT-NUM-1YR-CONT-EMP(WS-CTR)                         17980000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLEX-GRANT-ASMNT-PERSON   17990000
              MOVE HGT-AMT-THRESHOLD(WS-CTR)                            18000000
                   TO AMT-GRANT-THRSHD OF DCLEX-GRANT-ASMNT-PERSON      18010000
              MOVE HGT-NUM-CHG-DEBAR(WS-CTR)                            18020000
                      TO NUM-DEBAR OF DCLEX-GRANT-ASMNT-PERSON          18030000
              MOVE HGT-NUM-DEBAR-SCSPR(WS-CTR)                          18040000
                      TO NUM-DEBAR-REASON OF DCLEX-GRANT-ASMNT-PERSON   18050000
           ELSE                                                         18060000
              MOVE HGT-AMT-HSGNT(WS-CTR)                                18070000
                      TO AMT-GRANT OF DCLGRANT-ASMNT-PERSON             18080000
              MOVE HGT-AMT-HSGNT-USED(WS-CTR)                           18090000
                      TO AMT-GRANT-USE OF DCLGRANT-ASMNT-PERSON         18100000
              IF HGT-AMT-HSGNT-RECOVER(WS-CTR) NOT = ZEROES             18110000
                 MOVE 'Y' TO NUM-RCVRY OF DCLGRANT-ASMNT-PERSON         18120000
              END-IF                                                    18130000
              MOVE HGT-NUM-NRIC(WS-CTR)                                 18140000
                   TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON             18150000
              EVALUATE TRUE                                             18160000
              WHEN HGT-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               18170000
               MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 18180000
              WHEN HGT-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        18190001
               MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 18200000
              WHEN OTHER                                                18210000
               MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 18220000
              END-EVALUATE                                              18230000
              MOVE HGT-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  18240000
              MOVE HGT-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  18250000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              18260000
              MOVE WS-C-SRC TO NUM-CSTMR-SOURCE OF DCLGRANT-ASMNT-PERSON18270000
              MOVE HGT-NUM-NRIC(WS-CTR)                                 18280000
                   TO NUM-CPF-ACNT OF DCLGRANT-ASMNT-PERSON             18290000
              MOVE HGT-NUM-HA-TAG(WS-CTR)                               18300000
                   TO NUM-ROLE-TAG OF DCLGRANT-ASMNT-PERSON             18310000
              MOVE HGT-NUM-RELATIONSHIP(WS-CTR)                         18320000
                   TO NUM-RLTNSP OF DCLGRANT-ASMNT-PERSON               18330000
              MOVE HGT-NME-OCCP(WS-CTR)                                 18340000
                   TO NME-PERSON OF DCLGRANT-ASMNT-PERSON               18350000
              MOVE HGT-NUM-SEX(WS-CTR)                                  18360000
                   TO NUM-GENDER OF DCLGRANT-ASMNT-PERSON               18370000
              MOVE HGT-NUM-CITIZENSHIP(WS-CTR)                          18380000
                   TO NUM-CTZNSP OF DCLGRANT-ASMNT-PERSON               18390000
              MOVE HGT-NUM-MARITAL-STATUS(WS-CTR)                       18400000
                   TO NUM-MRTL-STATUS OF DCLGRANT-ASMNT-PERSON          18410000
              MOVE HGT-AMT-INCOME-AHG(WS-CTR)                           18420000
                   TO AMT-INCOME OF DCLGRANT-ASMNT-PERSON               18430000
              MOVE HGT-NUM-1YR-CONT-EMP(WS-CTR)                         18440000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLGRANT-ASMNT-PERSON      18450000
              MOVE HGT-AMT-THRESHOLD(WS-CTR)                            18460000
                   TO AMT-GRANT-THRSHD OF DCLGRANT-ASMNT-PERSON         18470000
              MOVE HGT-NUM-CHG-DEBAR(WS-CTR)                            18480000
                      TO NUM-DEBAR OF DCLGRANT-ASMNT-PERSON             18490000
              MOVE HGT-NUM-DEBAR-SCSPR(WS-CTR)                          18500000
                      TO NUM-DEBAR-REASON OF DCLGRANT-ASMNT-PERSON      18510000
           END-IF.                                                      18520000
                                                                        18530000
       5330-EXIT.                                                       18540000
           EXIT.                                                        18550000
                                                                        18560000
      *------------------------*                                        18570000
       5340-MOVE-GRANT-PRSN-TUG.                                        18580000
      *------------------------*                                        18590000
           MOVE TUG-AMT-HSGNT-TOPUP(WS-CTR)                             18600000
                        TO AMT-GRANT OF DCLGRANT-ASMNT-PERSON.          18610000
           MOVE ZEROES  TO AMT-GRANT-USE OF DCLGRANT-ASMNT-PERSON.      18620000
           MOVE 'N'     TO NUM-RCVRY OF DCLGRANT-ASMNT-PERSON.          18630000
           MOVE TUG-NUM-NRIC(WS-CTR)                                    18640000
                TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON.               18650000
           EVALUATE TRUE                                                18660000
           WHEN TUG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'                  18670000
            MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON    18680000
           WHEN TUG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'           18690001
            MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON    18700000
           WHEN OTHER                                                   18710000
            MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON    18720000
           END-EVALUATE.                                                18730000
           MOVE TUG-NUM-REGN(WS-CTR) TO WS-NUM-REGN.                    18740000
           MOVE TUG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC.                    18750000
           PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT.                18760000
           MOVE WS-C-SRC TO NUM-CSTMR-SOURCE OF DCLGRANT-ASMNT-PERSON.  18770000
           MOVE TUG-NUM-NRIC(WS-CTR)                                    18780000
                TO NUM-CPF-ACNT OF DCLGRANT-ASMNT-PERSON.               18790000
           MOVE TUG-NUM-HA-TAG(WS-CTR)                                  18800000
                TO NUM-ROLE-TAG OF DCLGRANT-ASMNT-PERSON.               18810000
           MOVE TUG-NUM-RELATIONSHIP(WS-CTR)                            18820000
                TO NUM-RLTNSP OF DCLGRANT-ASMNT-PERSON.                 18830000
           MOVE TUG-NME-OCCP(WS-CTR)                                    18840000
                TO NME-PERSON OF DCLGRANT-ASMNT-PERSON.                 18850000
           MOVE TUG-NUM-SEX(WS-CTR)                                     18860000
                TO NUM-GENDER OF DCLGRANT-ASMNT-PERSON.                 18870000
           MOVE TUG-NUM-CITIZENSHIP(WS-CTR)                             18880000
                TO NUM-CTZNSP OF DCLGRANT-ASMNT-PERSON.                 18890000
           MOVE TUG-NUM-MARITAL-STATUS(WS-CTR)                          18900000
                TO NUM-MRTL-STATUS OF DCLGRANT-ASMNT-PERSON.            18910000
           MOVE TUG-AMT-INCOME-AHG(WS-CTR)                              18920000
                TO AMT-INCOME OF DCLGRANT-ASMNT-PERSON.                 18930000
           MOVE TUG-NUM-1YR-CONT-EMP(WS-CTR)                            18940000
                TO NUM-1YR-CNTNS-EMPLY OF DCLGRANT-ASMNT-PERSON.        18950000
           MOVE TUG-AMT-THRESHOLD(WS-CTR)                               18960000
                TO AMT-GRANT-THRSHD OF DCLGRANT-ASMNT-PERSON.           18970000
           MOVE SPACES                                                  18980000
                   TO NUM-DEBAR OF DCLGRANT-ASMNT-PERSON.               18990000
           MOVE TUG-NUM-DEBAR-SCSPR(WS-CTR)                             19000000
                   TO NUM-DEBAR-REASON OF DCLGRANT-ASMNT-PERSON.        19010000
                                                                        19020000
       5340-EXIT.                                                       19030000
           EXIT.                                                        19040000
                                                                        19050000
      *------------------------*                                        19060000
       5350-MOVE-GRANT-PRSN-PHG.                                        19070000
      *------------------------*                                        19080000
           COMPUTE WS-PHG-RECVRY = PHG-AMT-AHG-GRANT-RECOVER(WS-CTR) +  19090000
                                   PHG-AMT-HSGNT-RECOVER(WS-CTR).       19100000
           IF WS-PHG-RCVRY = 'Y'                                        19110000
              MOVE PHG-AMT-SHG-GRANT(WS-CTR)                            19120000
                      TO AMT-GRANT OF DCLEX-GRANT-ASMNT-PERSON          19130000
              MOVE PHG-AMT-SHG-USED(WS-CTR)                             19140000
                      TO AMT-GRANT-USE OF DCLEX-GRANT-ASMNT-PERSON      19150000
              IF WS-PHG-RECVRY NOT = ZEROES                             19160000
                 MOVE 'Y' TO NUM-RCVRY OF DCLEX-GRANT-ASMNT-PERSON      19170000
              END-IF                                                    19180000
              MOVE PHG-NUM-NRIC(WS-CTR)                                 19190000
                   TO NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON          19200000
              EVALUATE TRUE                                             19210000
              WHEN PHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               19220000
               MOVE 'UIN'                                               19230000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    19240000
              WHEN PHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        19250001
               MOVE 'FIN'                                               19260000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    19270000
              WHEN OTHER                                                19280000
               MOVE 'XIN'                                               19290000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    19300000
              END-EVALUATE                                              19310000
              MOVE PHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  19320000
              MOVE PHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  19330000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              19340000
              MOVE WS-C-SRC                                             19350000
                    TO NUM-CSTMR-SOURCE OF DCLEX-GRANT-ASMNT-PERSON     19360000
              MOVE PHG-NUM-NRIC(WS-CTR)                                 19370000
                   TO NUM-CPF-ACNT OF DCLEX-GRANT-ASMNT-PERSON          19380000
              MOVE PHG-NUM-HA-TAG(WS-CTR)                               19390000
                   TO NUM-ROLE-TAG OF DCLEX-GRANT-ASMNT-PERSON          19400000
              MOVE PHG-NUM-RELATIONSHIP(WS-CTR)                         19410000
                   TO NUM-RLTNSP OF DCLEX-GRANT-ASMNT-PERSON            19420000
              MOVE PHG-NME-OCCP(WS-CTR)                                 19430000
                   TO NME-PERSON OF DCLEX-GRANT-ASMNT-PERSON            19440000
              MOVE PHG-NUM-SEX(WS-CTR)                                  19450000
                   TO NUM-GENDER OF DCLEX-GRANT-ASMNT-PERSON            19460000
              MOVE PHG-NUM-CITIZENSHIP(WS-CTR)                          19470000
                   TO NUM-CTZNSP OF DCLEX-GRANT-ASMNT-PERSON            19480000
              MOVE PHG-NUM-MARITAL-STATUS(WS-CTR)                       19490000
                   TO NUM-MRTL-STATUS OF DCLEX-GRANT-ASMNT-PERSON       19500000
              MOVE PHG-AMT-INCOME-AHG(WS-CTR)                           19510000
                   TO AMT-INCOME OF DCLEX-GRANT-ASMNT-PERSON            19520000
              MOVE PHG-NUM-1YR-CONT-EMP(WS-CTR)                         19530000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLEX-GRANT-ASMNT-PERSON   19540000
              MOVE PHG-AMT-THRESHOLD(WS-CTR)                            19550000
                   TO AMT-GRANT-THRSHD OF DCLEX-GRANT-ASMNT-PERSON      19560000
              MOVE PHG-NUM-PHG-DEBAR(WS-CTR)                            19570000
                      TO NUM-DEBAR OF DCLEX-GRANT-ASMNT-PERSON          19580000
              MOVE PHG-NUM-DEBAR-SCSPR(WS-CTR)                          19590000
                      TO NUM-DEBAR-REASON OF DCLEX-GRANT-ASMNT-PERSON   19600000
           ELSE                                                         19610000
              MOVE PHG-AMT-SHG-GRANT(WS-CTR)                            19620000
                      TO AMT-GRANT OF DCLGRANT-ASMNT-PERSON             19630000
              MOVE PHG-AMT-SHG-USED(WS-CTR)                             19640000
                      TO AMT-GRANT-USE OF DCLGRANT-ASMNT-PERSON         19650000
              IF WS-PHG-RECVRY NOT = ZEROES                             19660000
                 MOVE 'Y' TO NUM-RCVRY OF DCLGRANT-ASMNT-PERSON         19670000
              END-IF                                                    19680000
              MOVE PHG-NUM-NRIC(WS-CTR)                                 19690000
                   TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON             19700000
              EVALUATE TRUE                                             19710000
              WHEN PHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               19720000
               MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 19730000
              WHEN PHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        19740001
               MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 19750000
              WHEN OTHER                                                19760000
               MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 19770000
              END-EVALUATE                                              19780000
              MOVE PHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  19790000
              MOVE PHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  19800000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              19810000
              MOVE WS-C-SRC TO NUM-CSTMR-SOURCE OF DCLGRANT-ASMNT-PERSON19820000
              MOVE PHG-NUM-NRIC(WS-CTR)                                 19830000
                   TO NUM-CPF-ACNT OF DCLGRANT-ASMNT-PERSON             19840000
              MOVE PHG-NUM-HA-TAG(WS-CTR)                               19850000
                   TO NUM-ROLE-TAG OF DCLGRANT-ASMNT-PERSON             19860000
              MOVE PHG-NUM-RELATIONSHIP(WS-CTR)                         19870000
                   TO NUM-RLTNSP OF DCLGRANT-ASMNT-PERSON               19880000
              MOVE PHG-NME-OCCP(WS-CTR)                                 19890000
                   TO NME-PERSON OF DCLGRANT-ASMNT-PERSON               19900000
              MOVE PHG-NUM-SEX(WS-CTR)                                  19910000
                   TO NUM-GENDER OF DCLGRANT-ASMNT-PERSON               19920000
              MOVE PHG-NUM-CITIZENSHIP(WS-CTR)                          19930000
                   TO NUM-CTZNSP OF DCLGRANT-ASMNT-PERSON               19940000
              MOVE PHG-NUM-MARITAL-STATUS(WS-CTR)                       19950000
                   TO NUM-MRTL-STATUS OF DCLGRANT-ASMNT-PERSON          19960000
              MOVE PHG-AMT-INCOME-AHG(WS-CTR)                           19970000
                   TO AMT-INCOME OF DCLGRANT-ASMNT-PERSON               19980000
              MOVE PHG-NUM-1YR-CONT-EMP(WS-CTR)                         19990000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLGRANT-ASMNT-PERSON      20000000
              MOVE PHG-AMT-THRESHOLD(WS-CTR)                            20010000
                   TO AMT-GRANT-THRSHD OF DCLGRANT-ASMNT-PERSON         20020000
              MOVE PHG-NUM-PHG-DEBAR(WS-CTR)                            20030000
                      TO NUM-DEBAR OF DCLGRANT-ASMNT-PERSON             20040000
              MOVE PHG-NUM-DEBAR-SCSPR(WS-CTR)                          20050000
                      TO NUM-DEBAR-REASON OF DCLGRANT-ASMNT-PERSON      20060000
           END-IF.                                                      20070000
                                                                        20080000
       5350-EXIT.                                                       20090000
           EXIT.                                                        20100000
                                                                        20110000
      *------------------------*                                        20120000
       5500-INSERT-GRANT-PRSN.                                          20130000
      *------------------------*                                        20140000
           MOVE WS-GRANT-TYPE                                           20150000
                   TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON.          20160000
           MOVE WS-PREV-REGN TO NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON.    20170000
                                                                        20180000
           MOVE 'BP13CB0L'                                              20190000
                   TO NUM-UPDATE-USERID OF DCLGRANT-ASMNT-PERSON.       20200000
                                                                        20210000
           STRING WS-TIME-HHMMSS(1:2) '.'                               20220000
                  WS-TIME-HHMMSS(3:2) '.'                               20230000
                  WS-TIME-HHMMSS(5:2)                                   20240000
                  DELIMITED BY SIZE                                     20250000
                  INTO TME-UPDATE OF DCLGRANT-ASMNT-PERSON.             20260000
                                                                        20270000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              20280000
                  WS-DTE-CCYYMMDD(5:2) '-'                              20290000
                  WS-DTE-CCYYMMDD(7:2)                                  20300000
                  DELIMITED BY SIZE                                     20310000
                  INTO DTE-UPDATE OF DCLGRANT-ASMNT-PERSON.             20320000
                                                                        20330000
            EXEC SQL                                                    20340000
                 INSERT INTO GRANT_ASMNT_PERSON                         20350000
                        ( NUM_RGSTRN,                                   20360000
                          NUM_GRANT_TYPE,                               20370000
                          NUM_IDNTY_NO,                                 20380000
                          NUM_IDNTY_NO_TYPE,                            20390000
                          NUM_CSTMR_SOURCE,                             20400000
                          NUM_CPF_ACNT,                                 20410000
                          AMT_GRANT,                                    20420000
                          AMT_GRANT_USE,                                20430000
                          NUM_ROLE_TAG,                                 20440000
                          NUM_RLTNSP,                                   20450000
                          NME_PERSON,                                   20460000
                          NUM_GENDER,                                   20470000
                          NUM_CTZNSP,                                   20480000
                          NUM_MRTL_STATUS,                              20490000
                          AMT_INCOME,                                   20500000
                          NUM_1YR_CNTNS_EMPLY,                          20510000
                          NUM_DEBAR,                                    20520000
                          NUM_DEBAR_REASON,                             20530000
                          NUM_RCVRY,                                    20540000
                          NUM_UPDATE_USERID,                            20550000
                          DTE_UPDATE,                                   20560000
                          TME_UPDATE,                                   20570000
                          AMT_GRANT_THRSHD )                            20580000
                 VALUES ( :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN,            20590000
                          :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE,        20600000
                          :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO,          20610000
                          :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,     20620000
                          :DCLGRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,      20630000
                          :DCLGRANT-ASMNT-PERSON.NUM-CPF-ACNT,          20640000
                          :DCLGRANT-ASMNT-PERSON.AMT-GRANT,             20650000
                          :DCLGRANT-ASMNT-PERSON.AMT-GRANT-USE,         20660000
                          :DCLGRANT-ASMNT-PERSON.NUM-ROLE-TAG,          20670000
                          :DCLGRANT-ASMNT-PERSON.NUM-RLTNSP,            20680000
                          :DCLGRANT-ASMNT-PERSON.NME-PERSON,            20690000
                          :DCLGRANT-ASMNT-PERSON.NUM-GENDER,            20700000
                          :DCLGRANT-ASMNT-PERSON.NUM-CTZNSP,            20710000
                          :DCLGRANT-ASMNT-PERSON.NUM-MRTL-STATUS,       20720000
                          :DCLGRANT-ASMNT-PERSON.AMT-INCOME,            20730000
                          :DCLGRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,   20740000
                          :DCLGRANT-ASMNT-PERSON.NUM-DEBAR,             20750000
                          :DCLGRANT-ASMNT-PERSON.NUM-DEBAR-REASON,      20760000
                          :DCLGRANT-ASMNT-PERSON.NUM-RCVRY,             20770000
                          :DCLGRANT-ASMNT-PERSON.NUM-UPDATE-USERID,     20780000
                          :DCLGRANT-ASMNT-PERSON.DTE-UPDATE,            20790000
                          :DCLGRANT-ASMNT-PERSON.TME-UPDATE,            20800000
                          :DCLGRANT-ASMNT-PERSON.AMT-GRANT-THRSHD )     20810000
            END-EXEC.                                                   20820000
                                                                        20830000
            EVALUATE SQLCODE                                            20840000
               WHEN 000                                                 20850000
                    ADD 1                 TO CNT-PERSN-INSERT           20860000
                    MOVE 'GRANT_ASMNT_PERSON'  TO WS-SOURCE             20870000
                    MOVE 'C'            TO WS-ACTION                    20880000
                    MOVE NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON            20890000
                                                  TO WS-RGSTRN          20900000
                    MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON        20910000
                                                  TO WS-GRNT-TYPE       20920000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           20930000
                    MOVE DCLGRANT-ASMNT-PERSON TO WS-AFTER-IMAGE        20940000
                    PERFORM 8000-INSERT-TO-LOG THRU 8000-EXIT           20950000
                    PERFORM 9100-COMMIT        THRU 9100-EXIT           20960000
                                                                        20970000
               WHEN -803                                                20980000
                    CONTINUE                                            20990000
                                                                        21000000
               WHEN OTHER                                               21010000
                    MOVE SQLCODE          TO WS-SQLCODE                 21020000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_ASMNT_PERSON'  21030000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            21040000
                    DISPLAY DCLGRANT-ASMNT-PERSON                       21050000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          21060000
            END-EVALUATE.                                               21070000
                                                                        21080000
       5500-EXIT.                                                       21090000
           EXIT.                                                        21100000
                                                                        21110000
      *-------------------------------------------------------------    21120000
       5600-GET-CSTMR-SOURCE.                                           21130000
      *-------------------------------------------------------------    21140000
                                                                        21150000
           MOVE SPACES                        TO BP13K820-REC.          21160000
           INITIALIZE                            BP13K820-REC.          21170000
                                                                        21180000
           MOVE SPACES                        TO WS-C-SRC.              21190000
           MOVE WS-NUM-REGN                   TO K820-NUM-REGN.         21200000
           MOVE WS-NUM-NRIC                   TO K820-NUM-NRIC.         21210000
                                                                        21220000
           READ BP13K820.                                               21230000
                                                                        21240000
           IF WS-K820-STATUS = 00                                       21250000
              MOVE K820-NUM-CSTMR-SOURCE     TO WS-C-SRC                21260000
           ELSE                                                         21270000
              IF WS-K820-STATUS = 23                                    21280000
                 PERFORM 5610-STARTBR-BP13K895   THRU 5610-EXIT         21290000
              ELSE                                                      21300000
                 DISPLAY 'ERROR READING BP13K820, STAT ' WS-K820-STATUS 21310000
                         ', KEY-FLD = ' K820-KEY-FLD                    21320000
                 PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT              21330000
              END-IF                                                    21340000
           END-IF.                                                      21350000
                                                                        21360000
       5600-EXIT.                                                       21370000
            EXIT.                                                       21380000
                                                                        21390000
      ************************                                          21400000
       5610-STARTBR-BP13K895.                                           21410000
      ************************                                          21420000
                                                                        21430000
           MOVE SPACES                     TO BP13K895-REC.             21440000
           INITIALIZE                         BP13K895-REC.             21450000
                                                                        21460000
           MOVE 'N'                        TO WS-EOF-K895.              21470000
                                                                        21480000
           MOVE WS-NUM-REGN                TO K895-NUM-REGN-HIST.       21490000
           MOVE WS-NUM-NRIC                TO K895-NUM-NRIC-HIST.       21500000
                                                                        21510000
           START BP13K895 KEY >= K895-KEY-FLD.                          21520000
                                                                        21530000
           EVALUATE WS-K895-STATUS                                      21540000
               WHEN 00                                                  21550000
               WHEN 02                                                  21560000
                    PERFORM 5620-READNEXT-BP13K895 THRU 5620-EXIT       21570000
                    PERFORM 5630-PROCESS-BP13K895  THRU 5630-EXIT       21580000
                      UNTIL WS-EOF-K895 = 'Y'                           21590000
               WHEN 20                                                  21600000
               WHEN 23                                                  21610000
                    CONTINUE                                            21620000
                                                                        21630000
               WHEN OTHER                                               21640000
                  DISPLAY 'START ERROR BP13K895 : ' WS-K895-STATUS      21650000
                          ' REGN : ' K895-NUM-REGN                      21660000
                  MOVE     WS-K895-STATUS    TO    RETURN-CODE          21670000
                  PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT        21680000
           END-EVALUATE.                                                21690000
                                                                        21700000
       5610-EXIT.                                                       21710000
           EXIT.                                                        21720000
                                                                        21730000
      ************************                                          21740000
       5620-READNEXT-BP13K895.                                          21750000
      ************************                                          21760000
                                                                        21770000
           READ BP13K895 NEXT RECORD                                    21780000
                         AT END MOVE 'Y' TO WS-EOF-K895.                21790000
                                                                        21800000
       5620-EXIT.                                                       21810000
           EXIT.                                                        21820000
                                                                        21830000
      ************************                                          21840000
       5630-PROCESS-BP13K895.                                           21850000
      ************************                                          21860000
                                                                        21870000
           IF WS-NUM-REGN = K895-NUM-REGN-HIST AND                      21880000
              WS-NUM-NRIC = K895-NUM-NRIC-HIST                          21890000
              MOVE  K895-NUM-CSTMR-SOURCE     TO WS-C-SRC               21900000
           ELSE                                                         21910000
              MOVE 'Y'                        TO WS-EOF-K895            21920000
           END-IF.                                                      21930000
                                                                        21940000
           PERFORM 5620-READNEXT-BP13K895        THRU 5620-EXIT.        21950000
                                                                        21960000
       5630-EXIT.                                                       21970000
           EXIT.                                                        21980000
                                                                        21990000
      *----------------------*                                          22000000
       5700-READ-GRANT-RCVRY.                                           22010000
      *----------------------*                                          22020000
           MOVE WS-NUM-REGN   TO NUM-RGSTRN OF DCLGRANT-RCVRY.          22030000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-RCVRY.      22040000
           MOVE WS-NUM-NRIC   TO NUM-IDNTY-NO OF DCLGRANT-RCVRY.        22050000
                                                                        22060000
           MOVE 'N'              TO WS-GRANT-RCVRY-FND.                 22070000
                                                                        22080000
           EXEC SQL                                                     22090000
              SELECT NUM_RGSTRN,                                        22100000
                     NUM_GRANT_TYPE,                                    22110000
                     TME_CREATE,                                        22120000
                     NUM_IDNTY_NO,                                      22130000
                     NUM_IDNTY_NO_TYPE,                                 22140000
                     AMT_GRANT_RCVR,                                    22150000
                     AMT_GRANT_RCVR_INTRST,                             22160000
                     DTE_RQST_RCVR,                                     22170000
                     DTE_RCV_RCVR_GRANT,                                22180000
                     DTE_ACK_GRANT_RCVRY_CPF,                           22190000
                     DTE_GRANT_ABORT,                                   22200000
                     DTE_GRANT_RPDT,                                    22210000
                     NUM_TRNSFR,                                        22220000
                     DTE_TRNSFR,                                        22230000
                     NUM_ACNT,                                          22240000
                     NUM_SCHEME,                                        22250000
                     NUM_TNCY,                                          22260000
                     DTE_CPF_GRANT_RQST,                                22270000
                     DTE_CPF_GRANT_RCV,                                 22280000
                     DTE_UNUSED_GRANT_RQST,                             22290000
                     DTE_UNUSED_GRANT_RCV,                              22300000
                     DTE_USED_GRANT_RQST,                               22310000
                     DTE_USED_GRANT_RCV                                 22320000
              INTO  :DCLGRANT-RCVRY.NUM-RGSTRN,                         22330000
                    :DCLGRANT-RCVRY.NUM-GRANT-TYPE,                     22340000
                    :DCLGRANT-RCVRY.TME-CREATE,                         22350000
                    :DCLGRANT-RCVRY.NUM-IDNTY-NO,                       22360000
                    :DCLGRANT-RCVRY.NUM-IDNTY-NO-TYPE,                  22370000
                    :DCLGRANT-RCVRY.AMT-GRANT-RCVR,                     22380000
                    :DCLGRANT-RCVRY.AMT-GRANT-RCVR-INTRST,              22390000
                    :DCLGRANT-RCVRY.DTE-RQST-RCVR,                      22400000
                    :DCLGRANT-RCVRY.DTE-RCV-RCVR-GRANT,                 22410000
                    :DCLGRANT-RCVRY.DTE-ACK-GRANT-RCVRY-CPF,            22420000
                    :DCLGRANT-RCVRY.DTE-GRANT-ABORT,                    22430000
                    :DCLGRANT-RCVRY.DTE-GRANT-RPDT,                     22440000
                    :DCLGRANT-RCVRY.NUM-TRNSFR,                         22450000
                    :DCLGRANT-RCVRY.DTE-TRNSFR,                         22460000
                    :DCLGRANT-RCVRY.NUM-ACNT,                           22470000
                    :DCLGRANT-RCVRY.NUM-SCHEME,                         22480000
                    :DCLGRANT-RCVRY.NUM-TNCY,                           22490000
                    :DCLGRANT-RCVRY.DTE-CPF-GRANT-RQST,                 22500000
                    :DCLGRANT-RCVRY.DTE-CPF-GRANT-RCV,                  22510000
                    :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RQST,              22520000
                    :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RCV,               22530000
                    :DCLGRANT-RCVRY.DTE-USED-GRANT-RQST,                22540000
                    :DCLGRANT-RCVRY.DTE-USED-GRANT-RCV                  22550000
              FROM                                                      22560000
                GRANT_RCVRY                                             22570000
              WHERE                                                     22580000
                NUM_RGSTRN = :DCLGRANT-RCVRY.NUM-RGSTRN AND             22590000
                NUM_GRANT_TYPE = :DCLGRANT-RCVRY.NUM-GRANT-TYPE AND     22600000
                NUM_IDNTY_NO = :DCLGRANT-RCVRY.NUM-IDNTY-NO             22610000
           END-EXEC.                                                    22620000
                                                                        22630000
           EVALUATE SQLCODE                                             22640000
           WHEN WS-SQL-OK                                               22650000
           WHEN WS-SQL-DUPREC                                           22660000
           WHEN WS-SQL-MORE-ROWS                                        22670000
                MOVE 'Y' TO WS-GRANT-RCVRY-FND                          22680000
                                                                        22690000
           WHEN WS-SQL-NFND                                             22700000
                MOVE 'N' TO WS-GRANT-RCVRY-FND                          22710000
                                                                        22720000
           WHEN OTHER                                                   22730000
                MOVE SQLCODE   TO WS-SQLCODE                            22740000
                DISPLAY 'ERROR READING GRANT_RCVRY'                     22750000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      22760000
                DISPLAY SPACES                                          22770000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              22780000
           END-EVALUATE.                                                22790000
                                                                        22800000
       5700-EXIT.                                                       22810000
           EXIT.                                                        22820000
                                                                        22830000
      *-------------------*                                             22840000
       5730-MOVE-RCVRY-HGT.                                             22850000
      *-------------------*                                             22860000
           MOVE HGT-AMT-HSGNT-RECOVER(WS-CTR)                           22870000
                         TO AMT-GRANT-RCVR OF DCLGRANT-RCVRY.           22880000
           MOVE HGT-AMT-GRANT-RECOVER-INT(WS-CTR)                       22890000
                         TO AMT-GRANT-RCVR-INTRST OF DCLGRANT-RCVRY.    22900000
           STRING HGT-DTE-HSGNT-ABORTIVE(WS-CTR)(1:4) '-'               22910000
                  HGT-DTE-HSGNT-ABORTIVE(WS-CTR)(5:2) '-'               22920000
                  HGT-DTE-HSGNT-ABORTIVE(WS-CTR)(7:2)                   22930000
                DELIMITED BY SIZE                                       22940000
                INTO DTE-GRANT-ABORT OF DCLGRANT-RCVRY.                 22950000
                                                                        22960000
           MOVE WS-PREV-REGN      TO NUM-RGSTRN OF DCLGRANT-RCVRY.      22970000
           MOVE HGT-NUM-NRIC(WS-CTR)                                    22980000
                                  TO NUM-IDNTY-NO OF DCLGRANT-RCVRY.    22990000
           EVALUATE TRUE                                                23000000
           WHEN HGT-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'                  23010000
             MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          23020000
           WHEN HGT-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'           23030001
             MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          23040000
           WHEN OTHER                                                   23050000
             MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          23060000
           END-EVALUATE.                                                23070000
           STRING HGT-DTE-REQ(WS-CTR)(1:4) '-'                          23080000
                  HGT-DTE-REQ(WS-CTR)(5:2) '-'                          23090000
                  HGT-DTE-REQ(WS-CTR)(7:2)                              23100000
                DELIMITED BY SIZE                                       23110000
                   INTO DTE-RQST-RCVR OF DCLGRANT-RCVRY.                23120000
           STRING HGT-DTE-RECPT-CPFB(WS-CTR)(1:4) '-'                   23130000
                  HGT-DTE-RECPT-CPFB(WS-CTR)(5:2) '-'                   23140000
                  HGT-DTE-RECPT-CPFB(WS-CTR)(7:2)                       23150000
                DELIMITED BY SIZE                                       23160000
                   INTO DTE-ACK-GRANT-RCVRY-CPF OF DCLGRANT-RCVRY.      23170000
           STRING HGT-DTE-REPUDIATION(WS-CTR)(1:4) '-'                  23180000
                  HGT-DTE-REPUDIATION(WS-CTR)(5:2) '-'                  23190000
                  HGT-DTE-REPUDIATION(WS-CTR)(7:2)                      23200000
                DELIMITED BY SIZE                                       23210000
                   INTO DTE-GRANT-RPDT OF DCLGRANT-RCVRY.               23220000
           MOVE HGT-NUM-TRANSFEROR(WS-CTR)                              23230000
                         TO NUM-TRNSFR OF DCLGRANT-RCVRY.               23240000
           STRING HGT-DTE-TRANSFER(WS-CTR)(1:4) '-'                     23250000
                  HGT-DTE-TRANSFER(WS-CTR)(5:2) '-'                     23260000
                  HGT-DTE-TRANSFER(WS-CTR)(7:2)                         23270000
                DELIMITED BY SIZE                                       23280000
                INTO DTE-TRNSFR OF DCLGRANT-RCVRY.                      23290000
           STRING HGT-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(1:4) '-'          23300000
                  HGT-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(5:2) '-'          23310000
                  HGT-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(7:2)              23320000
                DELIMITED BY SIZE                                       23330000
                INTO DTE-CPF-GRANT-RQST OF DCLGRANT-RCVRY.              23340000
           STRING HGT-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(1:4) '-'         23350000
                  HGT-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(5:2) '-'         23360000
                  HGT-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(7:2)             23370000
                DELIMITED BY SIZE                                       23380000
                INTO DTE-CPF-GRANT-RCV OF DCLGRANT-RCVRY.               23390000
           STRING HGT-DTE-REQ-GRANT-UNUSED(WS-CTR)(1:4) '-'             23400000
                  HGT-DTE-REQ-GRANT-UNUSED(WS-CTR)(5:2) '-'             23410000
                  HGT-DTE-REQ-GRANT-UNUSED(WS-CTR)(7:2)                 23420000
                DELIMITED BY SIZE                                       23430000
                INTO DTE-UNUSED-GRANT-RQST OF DCLGRANT-RCVRY.           23440000
           STRING HGT-DTE-RECD-GRANT-UNUSED(WS-CTR)(1:4) '-'            23450000
                  HGT-DTE-RECD-GRANT-UNUSED(WS-CTR)(5:2) '-'            23460000
                  HGT-DTE-RECD-GRANT-UNUSED(WS-CTR)(7:2)                23470000
                DELIMITED BY SIZE                                       23480000
                INTO DTE-UNUSED-GRANT-RCV OF DCLGRANT-RCVRY.            23490000
           STRING HGT-DTE-REQ-GRANT-USED-HA(WS-CTR)(1:4) '-'            23500000
                  HGT-DTE-REQ-GRANT-USED-HA(WS-CTR)(5:2) '-'            23510000
                  HGT-DTE-REQ-GRANT-USED-HA(WS-CTR)(7:2)                23520000
                DELIMITED BY SIZE                                       23530000
                INTO DTE-USED-GRANT-RQST OF DCLGRANT-RCVRY.             23540000
           STRING HGT-DTE-RECD-GRANT-USED-HA(WS-CTR)(1:4) '-'           23550000
                  HGT-DTE-RECD-GRANT-USED-HA(WS-CTR)(5:2) '-'           23560000
                  HGT-DTE-RECD-GRANT-USED-HA(WS-CTR)(7:2)               23570000
                DELIMITED BY SIZE                                       23580000
                INTO DTE-USED-GRANT-RCV OF DCLGRANT-RCVRY.              23590000
                                                                        23600000
       5730-EXIT.                                                       23610000
           EXIT.                                                        23620000
                                                                        23630000
      *-------------------*                                             23640000
       5740-MOVE-RCVRY-PHG.                                             23650000
      *-------------------*                                             23660000
           COMPUTE WS-PHG-RECVRY = PHG-AMT-AHG-GRANT-RECOVER(WS-CTR) +  23670000
                                   PHG-AMT-HSGNT-RECOVER(WS-CTR).       23680000
           MOVE WS-PHG-RECVRY TO AMT-GRANT-RCVR OF DCLGRANT-RCVRY.      23690000
           MOVE PHG-AMT-GRANT-RECOVER-INT(WS-CTR)                       23700000
                      TO AMT-GRANT-RCVR-INTRST OF DCLGRANT-RCVRY.       23710000
           MOVE '0001-01-01' TO DTE-GRANT-ABORT OF DCLGRANT-RCVRY.      23720000
                                                                        23730000
           MOVE WS-PREV-REGN      TO NUM-RGSTRN OF DCLGRANT-RCVRY.      23740000
           MOVE PHG-NUM-NRIC(WS-CTR)                                    23750000
                                  TO NUM-IDNTY-NO OF DCLGRANT-RCVRY.    23760000
           EVALUATE TRUE                                                23770000
           WHEN PHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'                  23780000
             MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          23790000
           WHEN PHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'           23800001
             MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          23810000
           WHEN OTHER                                                   23820000
             MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          23830000
           END-EVALUATE.                                                23840000
           STRING PHG-DTE-REQ(WS-CTR)(1:4) '-'                          23850000
                  PHG-DTE-REQ(WS-CTR)(5:2) '-'                          23860000
                  PHG-DTE-REQ(WS-CTR)(7:2)                              23870000
                DELIMITED BY SIZE                                       23880000
                   INTO DTE-RQST-RCVR OF DCLGRANT-RCVRY.                23890000
           STRING PHG-DTE-RECPT-CPFB(WS-CTR)(1:4) '-'                   23900000
                  PHG-DTE-RECPT-CPFB(WS-CTR)(5:2) '-'                   23910000
                  PHG-DTE-RECPT-CPFB(WS-CTR)(7:2)                       23920000
                DELIMITED BY SIZE                                       23930000
                   INTO DTE-ACK-GRANT-RCVRY-CPF OF DCLGRANT-RCVRY.      23940000
           STRING PHG-DTE-REPUDIATION(WS-CTR)(1:4) '-'                  23950000
                  PHG-DTE-REPUDIATION(WS-CTR)(5:2) '-'                  23960000
                  PHG-DTE-REPUDIATION(WS-CTR)(7:2)                      23970000
                DELIMITED BY SIZE                                       23980000
                   INTO DTE-GRANT-RPDT OF DCLGRANT-RCVRY.               23990000
           MOVE PHG-NUM-TRANSFEROR(WS-CTR)                              24000000
                         TO NUM-TRNSFR OF DCLGRANT-RCVRY.               24010000
           STRING PHG-DTE-TRANSFER(WS-CTR)(1:4) '-'                     24020000
                  PHG-DTE-TRANSFER(WS-CTR)(5:2) '-'                     24030000
                  PHG-DTE-TRANSFER(WS-CTR)(7:2)                         24040000
                DELIMITED BY SIZE                                       24050000
                   INTO DTE-TRNSFR OF DCLGRANT-RCVRY.                   24060000
           STRING PHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(1:4) '-'          24070000
                  PHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(5:2) '-'          24080000
                  PHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(7:2)              24090000
                DELIMITED BY SIZE                                       24100000
                   INTO DTE-CPF-GRANT-RQST OF DCLGRANT-RCVRY.           24110000
           STRING PHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(1:4) '-'         24120000
                  PHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(5:2) '-'         24130000
                  PHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(7:2)             24140000
                DELIMITED BY SIZE                                       24150000
                   INTO DTE-CPF-GRANT-RCV OF DCLGRANT-RCVRY.            24160000
           STRING PHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(1:4) '-'             24170000
                  PHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(5:2) '-'             24180000
                  PHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(7:2)                 24190000
                DELIMITED BY SIZE                                       24200000
                   INTO DTE-UNUSED-GRANT-RQST OF DCLGRANT-RCVRY.        24210000
           STRING PHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(1:4) '-'            24220000
                  PHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(5:2) '-'            24230000
                  PHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(7:2)                24240000
                DELIMITED BY SIZE                                       24250000
                   INTO DTE-UNUSED-GRANT-RCV OF DCLGRANT-RCVRY.         24260000
           STRING PHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(1:4) '-'            24270000
                  PHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(5:2) '-'            24280000
                  PHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(7:2)                24290000
                DELIMITED BY SIZE                                       24300000
                   INTO DTE-USED-GRANT-RQST OF DCLGRANT-RCVRY.          24310000
           STRING PHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(1:4) '-'           24320000
                  PHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(5:2) '-'           24330000
                  PHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(7:2)               24340000
                DELIMITED BY SIZE                                       24350000
                   INTO DTE-USED-GRANT-RCV OF DCLGRANT-RCVRY.           24360000
                                                                        24370000
       5740-EXIT.                                                       24380000
           EXIT.                                                        24390000
                                                                        24400000
      *------------------------*                                        24410000
       5800-INSERT-GRANT-RCVRY.                                         24420000
      *------------------------*                                        24430000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-RCVRY.      24440000
           MOVE WS-TIMESTAMP  TO TME-CREATE OF DCLGRANT-RCVRY.          24450000
           MOVE '0001-01-01' TO DTE-RCV-RCVR-GRANT OF DCLGRANT-RCVRY.   24460000
           MOVE KD00-NUM-SCH-ACCNT(1:4)                                 24470000
                         TO NUM-SCHEME OF DCLGRANT-RCVRY.               24480000
           MOVE KD00-NUM-SCH-ACCNT(5:5)                                 24490000
                         TO NUM-ACNT OF DCLGRANT-RCVRY.                 24500000
           MOVE KD00-NUM-SCH-ACCNT(10:2)                                24510000
                         TO NUM-TNCY OF DCLGRANT-RCVRY.                 24520000
           MOVE 'BP13CB0L' TO NUM-UPDATE-USERID OF DCLGRANT-RCVRY.      24530000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              24540000
                  WS-DTE-CCYYMMDD(5:2) '-'                              24550000
                  WS-DTE-CCYYMMDD(7:2)                                  24560000
                  DELIMITED BY SIZE                                     24570000
                  INTO DTE-UPDATE OF DCLGRANT-RCVRY.                    24580000
           STRING WS-TIME-HHMMSS(1:2) '.'                               24590000
                  WS-TIME-HHMMSS(3:2) '.'                               24600000
                  WS-TIME-HHMMSS(5:2)                                   24610000
                  DELIMITED BY SIZE                                     24620000
                  INTO TME-UPDATE OF DCLGRANT-RCVRY.                    24630000
                                                                        24640000
            EXEC SQL                                                    24650000
                 INSERT INTO GRANT_RCVRY                                24660000
                        ( NUM_RGSTRN,                                   24670000
                          NUM_GRANT_TYPE,                               24680000
                          TME_CREATE,                                   24690000
                          NUM_IDNTY_NO,                                 24700000
                          NUM_IDNTY_NO_TYPE,                            24710000
                          AMT_GRANT_RCVR,                               24720000
                          AMT_GRANT_RCVR_INTRST,                        24730000
                          DTE_RQST_RCVR,                                24740000
                          DTE_RCV_RCVR_GRANT,                           24750000
                          DTE_ACK_GRANT_RCVRY_CPF,                      24760000
                          DTE_GRANT_ABORT,                              24770000
                          DTE_GRANT_RPDT,                               24780000
                          NUM_TRNSFR,                                   24790000
                          DTE_TRNSFR,                                   24800000
                          NUM_ACNT,                                     24810000
                          NUM_SCHEME,                                   24820000
                          NUM_TNCY,                                     24830000
                          DTE_CPF_GRANT_RQST,                           24840000
                          DTE_CPF_GRANT_RCV,                            24850000
                          DTE_UNUSED_GRANT_RQST,                        24860000
                          DTE_UNUSED_GRANT_RCV,                         24870000
                          DTE_USED_GRANT_RQST,                          24880000
                          DTE_USED_GRANT_RCV,                           24890000
                          NUM_UPDATE_USERID,                            24900000
                          DTE_UPDATE,                                   24910000
                          TME_UPDATE )                                  24920000
                 VALUES ( :DCLGRANT-RCVRY.NUM-RGSTRN,                   24930000
                          :DCLGRANT-RCVRY.NUM-GRANT-TYPE,               24940000
                          :DCLGRANT-RCVRY.TME-CREATE,                   24950000
                          :DCLGRANT-RCVRY.NUM-IDNTY-NO,                 24960000
                          :DCLGRANT-RCVRY.NUM-IDNTY-NO-TYPE,            24970000
                          :DCLGRANT-RCVRY.AMT-GRANT-RCVR,               24980000
                          :DCLGRANT-RCVRY.AMT-GRANT-RCVR-INTRST,        24990000
                          :DCLGRANT-RCVRY.DTE-RQST-RCVR,                25000000
                          :DCLGRANT-RCVRY.DTE-RCV-RCVR-GRANT,           25010000
                          :DCLGRANT-RCVRY.DTE-ACK-GRANT-RCVRY-CPF,      25020000
                          :DCLGRANT-RCVRY.DTE-GRANT-ABORT,              25030000
                          :DCLGRANT-RCVRY.DTE-GRANT-RPDT,               25040000
                          :DCLGRANT-RCVRY.NUM-TRNSFR,                   25050000
                          :DCLGRANT-RCVRY.DTE-TRNSFR,                   25060000
                          :DCLGRANT-RCVRY.NUM-ACNT,                     25070000
                          :DCLGRANT-RCVRY.NUM-SCHEME,                   25080000
                          :DCLGRANT-RCVRY.NUM-TNCY,                     25090000
                          :DCLGRANT-RCVRY.DTE-CPF-GRANT-RQST,           25100000
                          :DCLGRANT-RCVRY.DTE-CPF-GRANT-RCV,            25110000
                          :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RQST,        25120000
                          :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RCV,         25130000
                          :DCLGRANT-RCVRY.DTE-USED-GRANT-RQST,          25140000
                          :DCLGRANT-RCVRY.DTE-USED-GRANT-RCV,           25150000
                          :DCLGRANT-RCVRY.NUM-UPDATE-USERID,            25160000
                          :DCLGRANT-RCVRY.DTE-UPDATE,                   25170000
                          :DCLGRANT-RCVRY.TME-UPDATE )                  25180000
            END-EXEC.                                                   25190000
                                                                        25200000
            EVALUATE SQLCODE                                            25210000
               WHEN 000                                                 25220000
                    ADD 1                 TO CNT-RCVRY-INSERT           25230000
                    MOVE 'GRANT_RCVRY'  TO WS-SOURCE                    25240000
                    MOVE 'C'            TO WS-ACTION                    25250000
                    MOVE NUM-RGSTRN OF DCLGRANT-RCVRY TO WS-RGSTRN      25260000
                    MOVE NUM-GRANT-TYPE OF DCLGRANT-RCVRY               25270000
                                        TO WS-GRNT-TYPE                 25280000
                    MOVE SPACES         TO WS-BEFORE-IMAGE              25290000
                    MOVE DCLGRANT-RCVRY TO WS-AFTER-IMAGE               25300000
                    PERFORM 8000-INSERT-TO-LOG THRU 8000-EXIT           25310000
                    PERFORM 9100-COMMIT        THRU 9100-EXIT           25320000
                                                                        25330000
               WHEN -803                                                25340000
                    CONTINUE                                            25350000
                                                                        25360000
               WHEN OTHER                                               25370000
                    MOVE SQLCODE          TO WS-SQLCODE                 25380000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_RCVRY'         25390000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            25400000
                    DISPLAY DCLGRANT-RCVRY                              25410000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          25420000
            END-EVALUATE.                                               25430000
                                                                        25440000
       5800-EXIT.                                                       25450000
           EXIT.                                                        25460000
                                                                        25470000
      *-------------------------*                                       25480000
       6000-READ-EX-GRANT-ASMNT.                                        25490000
      *-------------------------*                                       25500000
           MOVE WS-NUM-REGN      TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT.    25510000
           MOVE WS-GRANT-TYPE    TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT.25520000
                                                                        25530000
           MOVE 'N'              TO WS-EX-GRANT-ASMNT-FND.              25540000
                                                                        25550000
           EXEC SQL                                                     25560000
              SELECT NUM_RGSTRN,                                        25570000
                     NUM_GRANT_TYPE,                                    25580000
                     TME_CREATE,                                        25590000
                     NUM_ELGBL_GRANT,                                   25600000
                     NUM_GRANT_AMOUNT_ELGBL,                            25610000
                     NUM_GRANT_STATUS,                                  25620000
                     DTE_APRV,                                          25630000
                     DTE_CANCEL,                                        25640000
                     DTE_REJECT,                                        25650000
                     DTE_SUBMIT,                                        25660000
                     DTE_WTHDRW,                                        25670000
                     NUM_RJCTN_REASON,                                  25680000
                     NUM_WTDRWL_REASON,                                 25690000
                     TXT_CNCLTN_REASON,                                 25700000
                     DTE_GRANT_RQST,                                    25710000
                     NUM_GRANT_DOC_RCV,                                 25720000
                     DTE_ACK,                                           25730000
                     DTE_GRANT_FORM_ISSUE,                              25740000
                     DTE_GRANT_OPT_OUT_FORM_ISSUE,                      25750000
                     NUM_GRANT_OPT_OUT_REASON,                          25760000
                     DTE_GRANT_OPT_OUT_REASON,                          25770000
                     NUM_ALCTN_SCHEME,                                  25780000
                     NUM_HSHLD_CTZNSP,                                  25790000
                     NUM_WRKNG_CHILD_ASMNT,                             25800000
                     QTY_MONTH_WORK,                                    25810000
                     NUM_APPEAL_ATCHMT,                                 25820000
                     NUM_PARENT_ADRS_BLDNG,                             25830000
                     NUM_PARENT_ADRS_LEVEL,                             25840000
                     NUM_PARENT_ADRS_UNIT,                              25850000
                     TXT_PARENT_ADRS1,                                  25860000
                     TXT_PARENT_ADRS2,                                  25870000
                     NUM_PARENT_ADRS_POSTAL,                            25880000
                     DTE_PYMNT,                                         25890000
                     DTE_CPF_ACK_GRANT_RCV,                             25900000
                     NUM_GRANT_CREDIT,                                  25910000
                     TME_APNTMT,                                        25920000
                     DTE_APNTMT,                                        25930000
                     TME_CREATE_ASMNT,                                  25940000
                     NUM_UPDATE_USERID,                                 25950000
                     TME_UPDATE,                                        25960000
                     DTE_UPDATE,                                        25970000
                     NUM_SOURCE_SYSTEM,                                 25980000
                     NUM_ACNT,                                          25990000
                     NUM_SCHEME,                                        26000000
                     NUM_TNCY,                                          26010000
                     NUM_HALF_GRANT                                     26020000
              INTO  :DCLEX-GRANT-ASMNT.NUM-RGSTRN,                      26030000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-TYPE,                  26040000
                    :DCLEX-GRANT-ASMNT.TME-CREATE,                      26050000
                    :DCLEX-GRANT-ASMNT.NUM-ELGBL-GRANT,                 26060000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,          26070000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-STATUS,                26080000
                    :DCLEX-GRANT-ASMNT.DTE-APRV,                        26090000
                    :DCLEX-GRANT-ASMNT.DTE-CANCEL,                      26100000
                    :DCLEX-GRANT-ASMNT.DTE-REJECT,                      26110000
                    :DCLEX-GRANT-ASMNT.DTE-SUBMIT,                      26120000
                    :DCLEX-GRANT-ASMNT.DTE-WTHDRW,                      26130000
                    :DCLEX-GRANT-ASMNT.NUM-RJCTN-REASON,                26140000
                    :DCLEX-GRANT-ASMNT.NUM-WTDRWL-REASON,               26150000
                    :DCLEX-GRANT-ASMNT.TXT-CNCLTN-REASON,               26160000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-RQST,                  26170000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-DOC-RCV,               26180000
                    :DCLEX-GRANT-ASMNT.DTE-ACK,                         26190000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-FORM-ISSUE,            26200000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,    26210000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,        26220000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,        26230000
                    :DCLEX-GRANT-ASMNT.NUM-ALCTN-SCHEME,                26240000
                    :DCLEX-GRANT-ASMNT.NUM-HSHLD-CTZNSP,                26250000
                    :DCLEX-GRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,           26260000
                    :DCLEX-GRANT-ASMNT.QTY-MONTH-WORK,                  26270000
                    :DCLEX-GRANT-ASMNT.NUM-APPEAL-ATCHMT,               26280000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,           26290000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,           26300000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-UNIT,            26310000
                    :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS1,                26320000
                    :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS2,                26330000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,          26340000
                    :DCLEX-GRANT-ASMNT.DTE-PYMNT,                       26350000
                    :DCLEX-GRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,           26360000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-CREDIT,                26370000
                    :DCLEX-GRANT-ASMNT.TME-APNTMT,                      26380000
                    :DCLEX-GRANT-ASMNT.DTE-APNTMT,                      26390000
                    :DCLEX-GRANT-ASMNT.TME-CREATE-ASMNT,                26400000
                    :DCLEX-GRANT-ASMNT.NUM-UPDATE-USERID,               26410000
                    :DCLEX-GRANT-ASMNT.TME-UPDATE,                      26420000
                    :DCLEX-GRANT-ASMNT.DTE-UPDATE,                      26430000
                    :DCLEX-GRANT-ASMNT.NUM-SOURCE-SYSTEM,               26440000
                    :DCLEX-GRANT-ASMNT.NUM-ACNT,                        26450000
                    :DCLEX-GRANT-ASMNT.NUM-SCHEME,                      26460000
                    :DCLEX-GRANT-ASMNT.NUM-TNCY,                        26470000
                    :DCLEX-GRANT-ASMNT.NUM-HALF-GRANT                   26480000
              FROM                                                      26490000
                EX_GRANT_ASMNT                                          26500000
              WHERE NUM_RGSTRN       = :DCLEX-GRANT-ASMNT.NUM-RGSTRN    26510000
               AND  NUM_GRANT_TYPE   = :DCLEX-GRANT-ASMNT.NUM-GRANT-TYPE26520000
           END-EXEC.                                                    26530000
                                                                        26540000
           EVALUATE SQLCODE                                             26550000
           WHEN WS-SQL-OK                                               26560000
                MOVE 'Y' TO WS-EX-GRANT-ASMNT-FND                       26570000
                                                                        26580000
           WHEN WS-SQL-NFND                                             26590000
                MOVE 'N' TO WS-EX-GRANT-ASMNT-FND                       26600000
                                                                        26610000
           WHEN OTHER                                                   26620000
                MOVE SQLCODE   TO WS-SQLCODE                            26630000
                DISPLAY 'ERROR READING EX_GRANT_ASMNT'                  26640000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      26650000
                DISPLAY SPACES                                          26660000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              26670000
           END-EVALUATE.                                                26680000
                                                                        26690000
       6000-EXIT.                                                       26700000
           EXIT.                                                        26710000
                                                                        26720000
      *--------------------------*                                      26730000
       6100-INSERT-EX-GRANT-ASMNT.                                      26740000
      *--------------------------*                                      26750000
           MOVE WS-PREV-REGN  TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT.       26760000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT.   26770000
           MOVE WS-TIMESTAMP TO TME-CREATE OF DCLEX-GRANT-ASMNT.        26780000
           MOVE '0001-01-01' TO DTE-CANCEL OF DCLEX-GRANT-ASMNT.        26790000
           MOVE 'GR'   TO TXT-CNCLTN-REASON OF DCLEX-GRANT-ASMNT.       26800000
           MOVE WS-NUM-ALLO-SCHEME                                      26810000
                       TO NUM-ALCTN-SCHEME OF DCLEX-GRANT-ASMNT.        26820000
           MOVE WS-CDE-CITIZENSHIP-HH                                   26830000
                       TO NUM-HSHLD-CTZNSP OF DCLEX-GRANT-ASMNT.        26840000
           MOVE WS-NUM-PARENT-CHILD                                     26850000
                       TO NUM-WRKNG-CHILD-ASMNT OF DCLEX-GRANT-ASMNT.   26860000
           MOVE WS-NUM-MONTHS-WORKED                                    26870000
                                TO QTY-MONTH-WORK OF DCLEX-GRANT-ASMNT. 26880000
           MOVE SPACES TO NUM-APPEAL-ATCHMT OF DCLEX-GRANT-ASMNT.       26890000
           MOVE SPACES                                                  26900000
                 TO NUM-PARENT-ADRS-BLDNG OF DCLEX-GRANT-ASMNT          26910000
                    NUM-PARENT-ADRS-LEVEL OF DCLEX-GRANT-ASMNT          26920000
                    NUM-PARENT-ADRS-UNIT OF DCLEX-GRANT-ASMNT           26930000
                    TXT-PARENT-ADRS1 OF DCLEX-GRANT-ASMNT               26940000
                    TXT-PARENT-ADRS2 OF DCLEX-GRANT-ASMNT               26950000
                    NUM-PARENT-ADRS-POSTAL OF DCLEX-GRANT-ASMNT         26960000
           STRING WS-DTE-CPF-ACK-GRANT(1:4) '-'                         26970000
                  WS-DTE-CPF-ACK-GRANT(5:2) '-'                         26980000
                  WS-DTE-CPF-ACK-GRANT(7:2)                             26990000
                DELIMITED BY SIZE                                       27000000
                   INTO DTE-CPF-ACK-GRANT-RCV OF DCLEX-GRANT-ASMNT.     27010000
           MOVE WS-NUM-GRANT-CREDIT-TAG                                 27020000
                 TO NUM-GRANT-CREDIT OF DCLEX-GRANT-ASMNT.              27030000
           MOVE WS-TIMESTAMP                                            27040000
                 TO TME-CREATE-ASMNT OF DCLEX-GRANT-ASMNT.              27050000
           MOVE 'BP13CB0L'                                              27060000
                 TO NUM-UPDATE-USERID OF DCLEX-GRANT-ASMNT.             27070000
                                                                        27080000
           STRING WS-TIME-HHMMSS(1:2) '.'                               27090000
                  WS-TIME-HHMMSS(3:2) '.'                               27100000
                  WS-TIME-HHMMSS(5:2)                                   27110000
                DELIMITED BY SIZE INTO TME-UPDATE OF DCLEX-GRANT-ASMNT. 27120000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              27130000
                  WS-DTE-CCYYMMDD(5:2) '-'                              27140000
                  WS-DTE-CCYYMMDD(7:2)                                  27150000
                DELIMITED BY SIZE INTO DTE-UPDATE OF DCLEX-GRANT-ASMNT. 27160000
                                                                        27170000
           MOVE 'BP13' TO NUM-SOURCE-SYSTEM OF DCLEX-GRANT-ASMNT.       27180000
           MOVE KD00-NUM-SCH-ACCNT(1:4)                                 27190000
                           TO NUM-SCHEME OF DCLEX-GRANT-ASMNT.          27200000
           MOVE KD00-NUM-SCH-ACCNT(5:5)                                 27210000
                           TO NUM-ACNT OF DCLEX-GRANT-ASMNT.            27220000
           MOVE KD00-NUM-SCH-ACCNT(10:2)                                27230000
                           TO NUM-TNCY OF DCLEX-GRANT-ASMNT.            27240000
                                                                        27250000
            EXEC SQL                                                    27260000
                 INSERT INTO EX_GRANT_ASMNT                             27270000
                        ( NUM_RGSTRN,                                   27280000
                          NUM_GRANT_TYPE,                               27290000
                          TME_CREATE,                                   27300000
                          NUM_ELGBL_GRANT,                              27310000
                          NUM_GRANT_AMOUNT_ELGBL,                       27320000
                          NUM_GRANT_STATUS,                             27330000
                          DTE_APRV,                                     27340000
                          DTE_CANCEL,                                   27350000
                          DTE_REJECT,                                   27360000
                          DTE_SUBMIT,                                   27370000
                          DTE_WTHDRW,                                   27380000
                          NUM_RJCTN_REASON,                             27390000
                          NUM_WTDRWL_REASON,                            27400000
                          TXT_CNCLTN_REASON,                            27410000
                          DTE_GRANT_RQST,                               27420000
                          NUM_GRANT_DOC_RCV,                            27430000
                          DTE_ACK,                                      27440000
                          DTE_GRANT_FORM_ISSUE,                         27450000
                          DTE_GRANT_OPT_OUT_FORM_ISSUE,                 27460000
                          NUM_GRANT_OPT_OUT_REASON,                     27470000
                          DTE_GRANT_OPT_OUT_REASON,                     27480000
                          NUM_ALCTN_SCHEME,                             27490000
                          NUM_HSHLD_CTZNSP,                             27500000
                          NUM_WRKNG_CHILD_ASMNT,                        27510000
                          QTY_MONTH_WORK,                               27520000
                          NUM_APPEAL_ATCHMT,                            27530000
                          NUM_PARENT_ADRS_BLDNG,                        27540000
                          NUM_PARENT_ADRS_LEVEL,                        27550000
                          NUM_PARENT_ADRS_UNIT,                         27560000
                          TXT_PARENT_ADRS1,                             27570000
                          TXT_PARENT_ADRS2,                             27580000
                          NUM_PARENT_ADRS_POSTAL,                       27590000
                          DTE_PYMNT,                                    27600000
                          DTE_CPF_ACK_GRANT_RCV,                        27610000
                          NUM_GRANT_CREDIT,                             27620000
                          TME_APNTMT,                                   27630000
                          DTE_APNTMT,                                   27640000
                          TME_CREATE_ASMNT,                             27650000
                          NUM_UPDATE_USERID,                            27660000
                          TME_UPDATE,                                   27670000
                          DTE_UPDATE,                                   27680000
                          NUM_SOURCE_SYSTEM,                            27690000
                          NUM_ACNT,                                     27700000
                          NUM_SCHEME,                                   27710000
                          NUM_TNCY,                                     27720000
                          NUM_HALF_GRANT )                              27730000
                 VALUES ( :DCLEX-GRANT-ASMNT.NUM-RGSTRN,                27740000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-TYPE,            27750000
                          :DCLEX-GRANT-ASMNT.TME-CREATE,                27760000
                          :DCLEX-GRANT-ASMNT.NUM-ELGBL-GRANT,           27770000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,    27780000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-STATUS,          27790000
                          :DCLEX-GRANT-ASMNT.DTE-APRV,                  27800000
                          :DCLEX-GRANT-ASMNT.DTE-CANCEL,                27810000
                          :DCLEX-GRANT-ASMNT.DTE-REJECT,                27820000
                          :DCLEX-GRANT-ASMNT.DTE-SUBMIT,                27830000
                          :DCLEX-GRANT-ASMNT.DTE-WTHDRW,                27840000
                          :DCLEX-GRANT-ASMNT.NUM-RJCTN-REASON,          27850000
                          :DCLEX-GRANT-ASMNT.NUM-WTDRWL-REASON,         27860000
                          :DCLEX-GRANT-ASMNT.TXT-CNCLTN-REASON,         27870000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-RQST,            27880000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-DOC-RCV,         27890000
                          :DCLEX-GRANT-ASMNT.DTE-ACK,                   27900000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-FORM-ISSUE,      27910000
                        :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,27920000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,  27930000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,  27940000
                          :DCLEX-GRANT-ASMNT.NUM-ALCTN-SCHEME,          27950000
                          :DCLEX-GRANT-ASMNT.NUM-HSHLD-CTZNSP,          27960000
                          :DCLEX-GRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,     27970000
                          :DCLEX-GRANT-ASMNT.QTY-MONTH-WORK,            27980000
                          :DCLEX-GRANT-ASMNT.NUM-APPEAL-ATCHMT,         27990000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,     28000000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,     28010000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-UNIT,      28020000
                          :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS1,          28030000
                          :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS2,          28040000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,    28050000
                          :DCLEX-GRANT-ASMNT.DTE-PYMNT,                 28060000
                          :DCLEX-GRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,     28070000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-CREDIT,          28080000
                          :DCLEX-GRANT-ASMNT.TME-APNTMT,                28090000
                          :DCLEX-GRANT-ASMNT.DTE-APNTMT,                28100000
                          :DCLEX-GRANT-ASMNT.TME-CREATE-ASMNT,          28110000
                          :DCLEX-GRANT-ASMNT.NUM-UPDATE-USERID,         28120000
                          :DCLEX-GRANT-ASMNT.TME-UPDATE,                28130000
                          :DCLEX-GRANT-ASMNT.DTE-UPDATE,                28140000
                          :DCLEX-GRANT-ASMNT.NUM-SOURCE-SYSTEM,         28150000
                          :DCLEX-GRANT-ASMNT.NUM-ACNT,                  28160000
                          :DCLEX-GRANT-ASMNT.NUM-SCHEME,                28170000
                          :DCLEX-GRANT-ASMNT.NUM-TNCY,                  28180000
                          :DCLEX-GRANT-ASMNT.NUM-HALF-GRANT )           28190000
            END-EXEC.                                                   28200000
                                                                        28210000
            EVALUATE SQLCODE                                            28220000
               WHEN 000                                                 28230000
                    MOVE 'Y'               TO WS-EX-INSERT              28240000
                    ADD 1                  TO CNT-EX-ASMNT-INS          28250000
                    MOVE 'EX_GRANT_ASMNT'  TO WS-SOURCE                 28260000
                    MOVE 'C'               TO WS-ACTION                 28270000
                    MOVE NUM-RGSTRN OF DCLEX-GRANT-ASMNT TO WS-RGSTRN   28280000
                    MOVE NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT            28290000
                                                  TO WS-GRNT-TYPE       28300000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           28310000
                    MOVE DCLEX-GRANT-ASMNT TO WS-AFTER-IMAGE            28320000
                    PERFORM 8000-INSERT-TO-LOG   THRU 8000-EXIT         28330000
                    PERFORM 9100-COMMIT          THRU 9100-EXIT         28340000
                                                                        28350000
               WHEN -803                                                28360000
                    CONTINUE                                            28370000
                                                                        28380000
               WHEN OTHER                                               28390000
                    MOVE SQLCODE          TO WS-SQLCODE                 28400000
                    DISPLAY 'SQL ERROR (INSERT) IN EX_GRANT_ASMNT'      28410000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            28420000
                    DISPLAY DCLEX-GRANT-ASMNT                           28430000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          28440000
            END-EVALUATE.                                               28450000
                                                                        28460000
       6100-EXIT.                                                       28470000
           EXIT.                                                        28480000
                                                                        28490000
      *------------------------*                                        28500000
       6300-READ-EX-GRANT-PRSN.                                         28510000
      *------------------------*                                        28520000
           MOVE WS-NUM-REGN TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON.  28530000
           MOVE WS-GRANT-TYPE                                           28540000
                          TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON.28550000
           MOVE WS-NUM-NRIC TO NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON.28560000
                                                                        28570000
           MOVE 'N'              TO WS-EX-GRANT-PRSN-FND.               28580000
                                                                        28590000
           EXEC SQL                                                     28600000
              SELECT NUM_RGSTRN,                                        28610000
                     NUM_GRANT_TYPE,                                    28620000
                     TME_CREATE,                                        28630000
                     NUM_IDNTY_NO,                                      28640000
                     NUM_IDNTY_NO_TYPE,                                 28650000
                     NUM_CSTMR_SOURCE,                                  28660000
                     NUM_CPF_ACNT,                                      28670000
                     AMT_GRANT,                                         28680000
                     AMT_GRANT_USE,                                     28690000
                     NUM_ROLE_TAG,                                      28700000
                     NUM_RLTNSP,                                        28710000
                     NME_PERSON,                                        28720000
                     NUM_GENDER,                                        28730000
                     NUM_CTZNSP,                                        28740000
                     NUM_MRTL_STATUS,                                   28750000
                     AMT_INCOME,                                        28760000
                     NUM_1YR_CNTNS_EMPLY,                               28770000
                     NUM_DEBAR,                                         28780000
                     NUM_DEBAR_REASON,                                  28790000
                     NUM_RCVRY,                                         28800000
                     NUM_UPDATE_USERID,                                 28810000
                     DTE_UPDATE,                                        28820000
                     TME_UPDATE,                                        28830000
                     AMT_GRANT_THRSHD                                   28840000
              INTO  :DCLEX-GRANT-ASMNT-PERSON.NUM-RGSTRN,               28850000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-GRANT-TYPE,           28860000
                    :DCLEX-GRANT-ASMNT-PERSON.TME-CREATE,               28870000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO,             28880000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,        28890000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,         28900000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-CPF-ACNT,             28910000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT,                28920000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-USE,            28930000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-ROLE-TAG,             28940000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-RLTNSP,               28950000
                    :DCLEX-GRANT-ASMNT-PERSON.NME-PERSON,               28960000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-GENDER,               28970000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-CTZNSP,               28980000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-MRTL-STATUS,          28990000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-INCOME,               29000000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,      29010000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR,                29020000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR-REASON,         29030000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-RCVRY,                29040000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-UPDATE-USERID,        29050000
                    :DCLEX-GRANT-ASMNT-PERSON.DTE-UPDATE,               29060000
                    :DCLEX-GRANT-ASMNT-PERSON.TME-UPDATE,               29070000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-THRSHD          29080000
              FROM                                                      29090000
                EX_GRANT_ASMNT_PERSON                                   29100000
             WHERE                                                      29110000
              NUM_RGSTRN = :DCLEX-GRANT-ASMNT-PERSON.NUM-RGSTRN AND     29120000
              NUM_GRANT_TYPE = :DCLEX-GRANT-ASMNT-PERSON.NUM-GRANT-TYPE 29130000
             AND  NUM_IDNTY_NO = :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO 29140000
           END-EXEC.                                                    29150000
                                                                        29160000
           EVALUATE SQLCODE                                             29170000
           WHEN WS-SQL-OK                                               29180000
                MOVE 'Y' TO WS-EX-GRANT-PRSN-FND                        29190000
                                                                        29200000
           WHEN WS-SQL-NFND                                             29210000
                MOVE 'N' TO WS-EX-GRANT-PRSN-FND                        29220000
                                                                        29230000
           WHEN OTHER                                                   29240000
                MOVE SQLCODE   TO WS-SQLCODE                            29250000
                DISPLAY 'ERROR READING EX_GRANT_ASMNT_PERSON'           29260000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      29270000
                DISPLAY SPACES                                          29280000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              29290000
           END-EVALUATE.                                                29300000
                                                                        29310000
       6300-EXIT.                                                       29320000
           EXIT.                                                        29330000
                                                                        29340000
      *--------------------------*                                      29350000
       6500-INSERT-EX-GRANT-PRSN.                                       29360000
      *--------------------------*                                      29370000
                                                                        29380000
           MOVE WS-PREV-REGN TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON. 29390000
           MOVE WS-GRANT-TYPE                                           29400000
                      TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON.    29410000
           MOVE 'BP13CB0L'                                              29420000
                      TO NUM-UPDATE-USERID OF DCLEX-GRANT-ASMNT-PERSON. 29430000
                                                                        29440000
           MOVE WS-TIMESTAMP TO TME-CREATE OF DCLEX-GRANT-ASMNT-PERSON. 29450000
                                                                        29460000
           STRING WS-TIME-HHMMSS(1:2) '.'                               29470000
                  WS-TIME-HHMMSS(3:2) '.'                               29480000
                  WS-TIME-HHMMSS(5:2)                                   29490000
                  DELIMITED BY SIZE                                     29500000
                  INTO TME-UPDATE OF DCLEX-GRANT-ASMNT-PERSON.          29510000
                                                                        29520000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              29530000
                  WS-DTE-CCYYMMDD(5:2) '-'                              29540000
                  WS-DTE-CCYYMMDD(7:2)                                  29550000
                  DELIMITED BY SIZE                                     29560000
                  INTO DTE-UPDATE OF DCLEX-GRANT-ASMNT-PERSON.          29570000
                                                                        29580000
            EXEC SQL                                                    29590000
                 INSERT INTO EX_GRANT_ASMNT_PERSON                      29600000
                        ( NUM_RGSTRN,                                   29610000
                          NUM_GRANT_TYPE,                               29620000
                          TME_CREATE,                                   29630000
                          NUM_IDNTY_NO,                                 29640000
                          NUM_IDNTY_NO_TYPE,                            29650000
                          NUM_CSTMR_SOURCE,                             29660000
                          NUM_CPF_ACNT,                                 29670000
                          AMT_GRANT,                                    29680000
                          AMT_GRANT_USE,                                29690000
                          NUM_ROLE_TAG,                                 29700000
                          NUM_RLTNSP,                                   29710000
                          NME_PERSON,                                   29720000
                          NUM_GENDER,                                   29730000
                          NUM_CTZNSP,                                   29740000
                          NUM_MRTL_STATUS,                              29750000
                          AMT_INCOME,                                   29760000
                          NUM_1YR_CNTNS_EMPLY,                          29770000
                          NUM_DEBAR,                                    29780000
                          NUM_DEBAR_REASON,                             29790000
                          NUM_RCVRY,                                    29800000
                          NUM_UPDATE_USERID,                            29810000
                          DTE_UPDATE,                                   29820000
                          TME_UPDATE,                                   29830000
                          AMT_GRANT_THRSHD )                            29840000
                 VALUES ( :DCLEX-GRANT-ASMNT-PERSON.NUM-RGSTRN,         29850000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-GRANT-TYPE,     29860000
                          :DCLEX-GRANT-ASMNT-PERSON.TME-CREATE,         29870000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO,       29880000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,  29890000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,   29900000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CPF-ACNT,       29910000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT,          29920000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-USE,      29930000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-ROLE-TAG,       29940000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-RLTNSP,         29950000
                          :DCLEX-GRANT-ASMNT-PERSON.NME-PERSON,         29960000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-GENDER,         29970000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CTZNSP,         29980000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-MRTL-STATUS,    29990000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-INCOME,         30000000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,30010000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR,          30020000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR-REASON,   30030000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-RCVRY,          30040000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-UPDATE-USERID,  30050000
                          :DCLEX-GRANT-ASMNT-PERSON.DTE-UPDATE,         30060000
                          :DCLEX-GRANT-ASMNT-PERSON.TME-UPDATE,         30070000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-THRSHD )  30080000
            END-EXEC.                                                   30090000
                                                                        30100000
            EVALUATE SQLCODE                                            30110000
               WHEN 000                                                 30120000
                    ADD 1                 TO CNT-EX-PERSN-INS           30130000
                    MOVE 'EX_GRANT_ASMNT_PERSON'  TO WS-SOURCE          30140000
                    MOVE 'C'            TO WS-ACTION                    30150000
                    MOVE NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON         30160000
                                                  TO WS-RGSTRN          30170000
                    MOVE NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON     30180000
                                                  TO WS-GRNT-TYPE       30190000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           30200000
                    MOVE DCLEX-GRANT-ASMNT-PERSON TO WS-AFTER-IMAGE     30210000
                    PERFORM 8000-INSERT-TO-LOG  THRU 8000-EXIT          30220000
                    PERFORM 9100-COMMIT         THRU 9100-EXIT          30230000
                                                                        30240000
               WHEN -803                                                30250000
                    CONTINUE                                            30260000
                                                                        30270000
               WHEN OTHER                                               30280000
                    MOVE SQLCODE          TO WS-SQLCODE                 30290000
                    DISPLAY 'SQL ERROR (INS) IN EX_GRANT_ASMNT_PERSON'  30300000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            30310000
                    DISPLAY DCLEX-GRANT-ASMNT-PERSON                    30320000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          30330000
            END-EVALUATE.                                               30340000
                                                                        30350000
       6500-EXIT.                                                       30360000
           EXIT.                                                        30370000
                                                                        30380000
      *--------------------*                                            30390000
       8000-INSERT-TO-LOG.                                              30400000
      *--------------------*                                            30410000
            EXEC SQL                                                    30420000
                 SET :WS-TIMESTAMP-LOG = CURRENT TIMESTAMP              30430000
            END-EXEC.                                                   30440000
            IF SQLCODE NOT = 000                                        30450000
               MOVE SQLCODE          TO WS-SQLCODE                      30460000
               DISPLAY 'SQL ERROR SET DB2 TIMESTAMP'                    30470000
               DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE                 30480000
               PERFORM 9999-SQL-ERROR THRU 9999-EXIT                    30490000
            END-IF.                                                     30500000
                                                                        30510000
           MOVE WS-TIMESTAMP-LOG TO TME-UPDATE OF DCLGRANT-UPDATE-LOG.  30520000
           MOVE 'BP13CB0L'  TO NUM-UPDATE-USERID OF DCLGRANT-UPDATE-LOG.30530000
           MOVE WS-SOURCE   TO NUM-SOURCE-RECORD OF DCLGRANT-UPDATE-LOG.30540000
           MOVE WS-ACTION     TO NUM-ACTION OF DCLGRANT-UPDATE-LOG.     30550000
           MOVE WS-RGSTRN     TO NUM-RGSTRN OF DCLGRANT-UPDATE-LOG.     30560000
           MOVE WS-GRNT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-UPDATE-LOG.  30570000
           MOVE WS-BEFORE-IMAGE TO TXT-BEFORE-IMAGE-TEXT                30580000
                                              OF DCLGRANT-UPDATE-LOG.   30590000
           MOVE LENGTH OF WS-BEFORE-IMAGE TO TXT-BEFORE-IMAGE-LEN       30600000
                                              OF DCLGRANT-UPDATE-LOG.   30610000
           MOVE WS-AFTER-IMAGE TO TXT-AFTER-IMAGE-TEXT                  30620000
                                              OF DCLGRANT-UPDATE-LOG.   30630000
           MOVE LENGTH OF WS-AFTER-IMAGE TO TXT-AFTER-IMAGE-LEN         30640000
                                              OF DCLGRANT-UPDATE-LOG.   30650000
            EXEC SQL                                                    30660000
                 INSERT INTO GRANT_UPDATE_LOG                           30670000
                        ( TME_UPDATE,                                   30680000
                          NUM_UPDATE_USERID,                            30690000
                          NUM_SOURCE_RECORD,                            30700000
                          NUM_ACTION,                                   30710000
                          NUM_RGSTRN,                                   30720000
                          NUM_GRANT_TYPE,                               30730000
                          TXT_BEFORE_IMAGE,                             30740000
                          TXT_AFTER_IMAGE )                             30750000
                 VALUES ( :DCLGRANT-UPDATE-LOG.TME-UPDATE,              30760000
                          :DCLGRANT-UPDATE-LOG.NUM-UPDATE-USERID,       30770000
                          :DCLGRANT-UPDATE-LOG.NUM-SOURCE-RECORD,       30780000
                          :DCLGRANT-UPDATE-LOG.NUM-ACTION,              30790000
                          :DCLGRANT-UPDATE-LOG.NUM-RGSTRN,              30800000
                          :DCLGRANT-UPDATE-LOG.NUM-GRANT-TYPE,          30810000
                          :DCLGRANT-UPDATE-LOG.TXT-BEFORE-IMAGE,        30820000
                          :DCLGRANT-UPDATE-LOG.TXT-AFTER-IMAGE )        30830000
            END-EXEC.                                                   30840000
                                                                        30850000
            EVALUATE SQLCODE                                            30860000
               WHEN 000                                                 30870000
                    ADD 1                 TO WS-GRNT-UPD-LOG            30880000
                                                                        30890000
               WHEN -803                                                30900000
                    CONTINUE                                            30910000
                                                                        30920000
               WHEN OTHER                                               30930000
                    MOVE SQLCODE          TO WS-SQLCODE                 30940000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_UPDATE_LOG'    30950000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            30960000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          30970000
            END-EVALUATE.                                               30980000
                                                                        30990000
       8000-EXIT.                                                       31000000
           EXIT.                                                        31010000
                                                                        31020000
      *-----------------*                                               31030000
       9000-CLOSE-FILES.                                                31040000
      *-----------------*                                               31050000
                                                                        31060000
           DISPLAY '******  BP13CB0L *************'.                    31070000
           DISPLAY 'RECS READ FROM  BP13FD05      : ' CNT-FD05-READ.    31080000
           DISPLAY 'RECS CREATED TO GRANT_ASMNT   : ' CNT-ASMNT-INSERT. 31090000
           DISPLAY 'RECS CREATED TO PERSON TABLE  : ' CNT-PERSN-INSERT. 31100000
           DISPLAY 'RECS CREATED TO GRANT_RCVRY   : ' CNT-RCVRY-INSERT. 31110000
           DISPLAY 'RECS CREATED TO EX_GRANT_ASMNT: ' CNT-EX-ASMNT-INS. 31120000
           DISPLAY 'RECS CREATED TO EX_GRANT_PERSN: ' CNT-EX-PERSN-INS. 31130000
           DISPLAY 'RECS WRITTEN TO UPDATE LOG    : ' WS-GRNT-UPD-LOG.  31140000
                                                                        31150000
           CLOSE BP13FD05                                               31160000
                 BP13K800                                               31170000
                 BP13K893                                               31180000
                 BP13K895                                               31190000
                 BP13K820.                                              31200000
                                                                        31210000
           STOP RUN.                                                    31220000
                                                                        31230000
           IF WS-KD00-STATUS NOT = 00 AND 97                            31240000
              DISPLAY 'ERROR CLOSING - BP13KD00 : ' WS-KD00-STATUS      31250000
              MOVE     WS-KD00-STATUS    TO    RETURN-CODE              31260000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                31270000
           END-IF.                                                      31280000
                                                                        31290000
           IF WS-K800-STATUS NOT = 00 AND 97                            31300000
              DISPLAY 'ERROR CLOSING - BP13K800 : ' WS-K800-STATUS      31310000
              MOVE     WS-K800-STATUS    TO    RETURN-CODE              31320000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                31330000
           END-IF.                                                      31340000
                                                                        31350000
           IF WS-K820-STATUS NOT = 00 AND 97                            31360000
              DISPLAY 'ERROR CLOSING - BP13K820 : ' WS-K820-STATUS      31370000
              MOVE     WS-K820-STATUS    TO    RETURN-CODE              31380000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                31390000
           END-IF.                                                      31400000
                                                                        31410000
           IF WS-K893-STATUS NOT = 00 AND 97                            31420000
              DISPLAY 'ERROR CLOSING - BP13K893 : ' WS-K893-STATUS      31430000
              MOVE     WS-K893-STATUS    TO    RETURN-CODE              31440000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                31450000
           END-IF.                                                      31460000
                                                                        31470000
           IF WS-K895-STATUS NOT = 00 AND 97                            31480000
              DISPLAY 'ERROR CLOSING - BP13K895 : ' WS-K895-STATUS      31490000
              MOVE     WS-K895-STATUS    TO    RETURN-CODE              31500000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                31510000
           END-IF.                                                      31520000
                                                                        31530000
       9000-EXIT.                                                       31540000
            EXIT.                                                       31550000
                                                                        31560000
      ***************************************************************** 31570000
       9100-COMMIT.                                                     31580000
      ***************************************************************** 31590000
           EXEC SQL                                                     31600000
                COMMIT                                                  31610000
           END-EXEC                                                     31620000
                                                                        31630000
           EVALUATE SQLCODE                                             31640000
           WHEN 000                                                     31650000
                CONTINUE                                                31660000
           WHEN OTHER                                                   31670000
                PERFORM 9999-SQL-ERROR    THRU 9999-EXIT                31680000
           END-EVALUATE.                                                31690000
                                                                        31700000
       9100-EXIT.                                                       31710000
           EXIT.                                                        31720000
                                                                        31730000
      *---------------------------------------------------------------- 31740000
       9999-SQL-ERROR.                                                  31750000
      *---------------------------------------------------------------- 31760000
           CALL 'DBATIAR'  USING SQLCA.                                 31770000
           EXEC SQL ROLLBACK               END-EXEC.                    31780000
           MOVE 99                         TO    RETURN-CODE.           31790000
           PERFORM 9000-CLOSE-FILES        THRU  9000-EXIT.             31800000
                                                                        31810000
       9999-EXIT.                                                       31820000
           EXIT.                                                        31830000
