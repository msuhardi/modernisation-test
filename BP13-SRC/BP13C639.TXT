       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13C639                                                   
      *AUTHOR.       LSB.                                                       
      *DATE-WRITTEN. 02/09/1997.                                                
      * ======================================================== *              
      * SYSTEM OF COMMITMENT (BP13)                              *              
      * ======================================================== *              
      *    OBJECTIVE :                                           *              
      *      OUTPUT OCCUPERS RECORDS WHERE FOUND TO HAVE PARENT  *              
      *      AND SINGLE SON IN THE APPLICATION FOR 5-YR CHECK    *              
      *                                                          *              
      *    INPUT FILES:                                          *              
      *      1. BP13F558 - OCCUP FILE                            *              
      *      2. BP13F500                                         *              
      *      3. BP13F713                                         *              
      *      4. BP13K060                                         *              
      *                                                          *              
      *    LISTINGS:                                             *              
      *    P13L639A - CASES WITH SINGLE SON/PARENT/IN-LAW        *              
      *               CASES WITH MARRIED SON/PARENT/IN-LAW       *              
      *    P13L639B - CASES WITH HUSBAND/WIFE                    *              
      *    P13L639C - PARENT WITH SINGLE CHILD AS OCCUPIER       *              
      *                                                          *              
      * ======================================================== *              
      * CHG REF  BY  DATE    DESCRIPTION                         *              
      * -------- --- ------  -----------                         *              
      * BP130323  LSB 970902 NEW PGM                             *              
      * BP130377  LSB 971015 - CHG BP13F800 TO BP13F500          *              
      * BP130413  LSB 971219 - MARIIED COUPLE WITH FATHER/MOTHER *              
      *                        TAKE LONGER MTH FR  FATHER/MOTHER *              
      *                        SET 10-YR = YES, IF SAME FLAT     *              
      * BP130445 SSS 980206  - EXPAND F558 RECL FROM 150 TO 400  *              
      * BP130458 LSB 980305  - ADD BP13F713                      *              
      * BP130445 LSB 980305  - MARRIED CHILD MUST BE HA, SMS FLAT*              
      *                        STORE ON DP FLAT,ELSE GET RSL FLAT*              
      * BP130645 EVM 990722  - TO STORE HDB-REF-TR FOR VERIFICA- *              
      *                        TION OF MTH-RESIDE, INDICATE HSE- *              
      *                        GRANT CASES                       *              
      * BP130652 NOR 990919  - EXPAND F500 RECL FROM 300 TO 500  *              
      * BP130789 SRA 000115  - IF APPL IS DIVORCEE & MARRIED CHIL*              
      *                        D,CAPTURE THE LONGER MTH-RESIDE.  *              
      * BP130810 SRA 000117  - IF GRANDPARENT & PARENT ARE HA &  *              
      *                        SAME FLAT,CAPTURE THE LONGER MTH- *              
      *                        RESIDE.                           *              
      * BP130819 SRA 000411  - IF SMS-SALES-TYEP=7J,8B,8E,7C,8A,8D              
      *                        DEBARMENT=62,64,66,GA,GB THE MOVE *              
      *                        HDB-REF-SMS TO FLAT,FOR FURTHER CHK              
      * BP130819 SRA 000412  - HA1 & CHILD(FU), THEN CAPTURE THE *              
      *                        LONGER MTH-RESIDE.                *              
      * BP130819 SRA 000412  - HA1 & 1 PARENT(FU) & BRO/SIS(FU)  *              
      *                        THEN CAPTURE LONGER MTH-RESIDE.   *              
      * BP130819 SRA 000413  - HA1 & 1 PARENT(HA2)& BRO/SIS(FU)  *              
      *                        THEN CAPTURE LONGER MTH-RESIDE.   *              
      * BP130819 SRA 000428  - HA1 & 1 PARENT(HA2)& BRO/SIS(HA3) *              
      *                        THEN CAPTURE LONGER MTH-RESIDE.   *              
      * BP130857 SSS 000707  - REMOVE 'TEAM'                     *              
      * BP130897 AKT 000803  - EXPAND F558 RECL FROM 400 TO 600  *              
      * BP131015 ANC 010926  - WRITE RECORDS NOT HAVING PARENT & *              
      *                        CHILD APPLICATION.                *              
      * BP131064 ANC 020105  - WRITE ONLY MULTI-TIER RECORDS IN  *              
      *                        P13F558A & P13F558B FILES.        *              
      * BP132059 ANC 020204  - CHGE DEBARMENT-3 TO DEBARMENT-4   *              
      * BP132603 JF4 281004  - CHANGE 10-YR TIMEBAR TO 5-YR      *              
      * BP139518 EAA2 280223 TO INCLUDE 6 SALES TYPE CODE IN     *              
      *                      HOUSEHOLD DETERMINATION             *              
      *                      (8L/8M/8N/8R/8S/8T)                 *              
      * ======================================================== *              
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F500   ASSIGN TO BP13F500.                                
           SELECT BP13F713   ASSIGN TO BP13F713.                                
           SELECT BP13F558   ASSIGN TO BP13F558.                                
           SELECT P13F558A   ASSIGN TO P13F558A.                                
           SELECT P13F558B   ASSIGN TO P13F558B.                                
                                                                                
           SELECT BP13K060 ASSIGN TO BP13K060                                   
                  ORGANIZATION    IS INDEXED                                    
                  ACCESS MODE     IS DYNAMIC                                    
                  RECORD KEY      IS K060-KEY-FLD                               
                  FILE STATUS     IS K060-FILE-STATUS.                          
                                                                                
           SELECT P13L639A   ASSIGN TO P13L639A.                                
           SELECT P13L639B   ASSIGN TO P13L639B.                                
           SELECT P13L639C   ASSIGN TO P13L639C.                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F500                                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            RECORDING MODE IS F                                                 
            LABEL RECORDS ARE STANDARD.                                         
       COPY BP13F500.                                                           
                                                                                
       FD   BP13F713                                                            
            RECORD CONTAINS 20 CHARACTERS                                       
            BLOCK CONTAINS 0 RECORDS                                            
            RECORDING MODE IS F                                                 
            LABEL RECORDS ARE STANDARD.                                         
       COPY BP13F713.                                                           
                                                                                
       FD   BP13F558                                                            
            RECORD CONTAINS 600 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            RECORDING MODE IS F                                                 
            LABEL RECORDS ARE STANDARD.                                         
       COPY BP13F558.                                                           
                                                                                
       FD   BP13K060.                                                           
       COPY BP13K060.                                                           
                                                                                
       FD   P13F558A                                                            
            RECORD CONTAINS 600 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            RECORDING MODE IS F                                                 
            LABEL RECORDS ARE STANDARD.                                         
                                                                                
       01   P13F558A-REC           PIC X(600).                                  
                                                                                
       FD   P13F558B                                                            
            RECORD CONTAINS 600 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            RECORDING MODE IS F                                                 
            LABEL RECORDS ARE STANDARD.                                         
                                                                                
       01   P13F558B-REC           PIC X(600).                                  
                                                                                
       FD   P13L639A          BLOCK CONTAINS 0 RECORDS                          
                              RECORD CONTAINS 132 CHARACTERS                    
                              RECORDING MODE IS F.                              
       01   P13L639A-REC      PIC X(132).                                       
                                                                                
       FD   P13L639B          BLOCK CONTAINS 0 RECORDS                          
                              RECORD CONTAINS 132 CHARACTERS                    
                              RECORDING MODE IS F.                              
       01   P13L639B-REC      PIC X(132).                                       
                                                                                
       FD   P13L639C          BLOCK CONTAINS 0 RECORDS                          
                              RECORD CONTAINS 132 CHARACTERS                    
                              RECORDING MODE IS F.                              
       01   P13L639C-REC      PIC X(132).                                       
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01  L639A-TOP-TITLE1.                                                    
           05  FILLER                  PIC X(07) VALUE 'P13L639'.               
           05  FILLER                  PIC X(05) VALUE SPACES.                  
           05  FILLER                  PIC X(07) VALUE 'HDBCAT3'.               
           05  FILLER                  PIC X(18) VALUE SPACES.                  
           05  FILLER                  PIC X(43) VALUE                          
                 'S Y S T E M    O F   C O M M I T M E N T'.                    
           05  FILLER                  PIC X(12) VALUE SPACES.                  
           05  FILLER                  PIC X(07) VALUE 'DATE : '.               
           05  L639-DATE               PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(07) VALUE 'PAGE : '.               
           05  WS-EDITED-PAGENO        PIC Z(04).                               
                                                                                
       01  L639A-TOP-TITLE2.                                                    
           05  FILLER                  PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X(56) VALUE                          
             'REPORT ON VERIFY 5-YRS TIME BAR FOR MULTI-TIER FAMILY '.          
           05  FILLER                  PIC X(39) VALUE SPACES.                  
                                                                                
       01  L639A-HEADER-LINE.                                                   
           05  FILLER                  PIC X(04) VALUE ' S/N'.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'REGN NO'.               
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'NRIC NO'.               
           05  FILLER                  PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(11) VALUE 'HDB-REF-SMS'.           
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(13) VALUE 'HDB-REF-RSL'.           
           05  FILLER                  PIC X(04) VALUE 'HH  '.                  
           05  FILLER                  PIC X(10) VALUE 'MTH S-SMS '.            
           05  FILLER                  PIC X(07) VALUE 'S-RSL  '.               
           05  FILLER                  PIC X(12) VALUE 'MARRIED-ST'.            
           05  FILLER                  PIC X(12) VALUE 'RELATIONSHIP'.          
           05  FILLER                  PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE 'ST  '.                  
           05  FILLER                  PIC X(04) VALUE 'HA  '.                  
           05  FILLER                  PIC X(10) VALUE 'SMS-DATE  '.            
           05  FILLER                  PIC X(05) VALUE 'HSE-G'.                 
                                                                                
       01  L639A-DET-LINE.                                                      
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639A-SERNO             PIC X(4)  VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639A-REGN-NO           PIC X(8)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639A-NRIC-NO           PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639A-HDB-SMS           PIC X(11) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639A-HDB-RSL           PIC X(11) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639A-HHTY              PIC X     VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639A-MTH-RESIDE        PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639A-MTH-SUBLET-SMS    PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639A-MTH-SUBLET-RSL    PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639A-MARITAL           PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639A-RELATION          PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639A-SALE-TYPE         PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639A-APPLN             PIC X     VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639A-SOLD-DATE         PIC X(08) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639A-HSE-GRANT         PIC X     VALUE SPACES.                  
                                                                                
       01  L639B-TOP-TITLE2.                                                    
           05  FILLER                  PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X(56) VALUE                          
             'REPORT ON VERIFY 5-YRS TIME BAR FOR HUSBAND/WIFE CASE '.          
           05  FILLER                  PIC X(39) VALUE SPACES.                  
                                                                                
       01  L639B-HEADER-LINE.                                                   
           05  FILLER                  PIC X(04) VALUE ' S/N'.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'REGN NO'.               
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'NRIC NO'.               
           05  FILLER                  PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(11) VALUE 'HDB-REF-SMS'.           
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(13) VALUE 'HDB-REF-RSL'.           
           05  FILLER                  PIC X(04) VALUE 'HH  '.                  
           05  FILLER                  PIC X(10) VALUE 'MTH S-SMS '.            
           05  FILLER                  PIC X(07) VALUE 'S-RSL  '.               
           05  FILLER                  PIC X(12) VALUE 'MARRIED-ST'.            
           05  FILLER                  PIC X(12) VALUE 'RELATIONSHIP'.          
           05  FILLER                  PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE 'ST  '.                  
           05  FILLER                  PIC X(04) VALUE 'HA  '.                  
           05  FILLER                  PIC X(10) VALUE 'SMS DATE  '.            
           05  FILLER                  PIC X(05) VALUE 'HSE-G'.                 
                                                                                
       01  L639B-DET-LINE.                                                      
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639B-SERNO             PIC X(4)  VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639B-REGN-NO           PIC X(8)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639B-NRIC-NO           PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639B-HDB-SMS           PIC X(11) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639B-HDB-RSL           PIC X(11) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639B-HHTY              PIC X     VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639B-MTH-RESIDE        PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639B-MTH-SUBLET-SMS    PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639B-MTH-SUBLET-RSL    PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639B-MARITAL           PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639B-RELATION          PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639B-SALE-TYPE         PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639B-APPLN             PIC X     VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639B-SOLD-DATE         PIC X(08) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639B-HSE-GRANT         PIC X     VALUE SPACES.                  
                                                                                
       01  L639C-TOP-TITLE3.                                                    
           05  FILLER                  PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X(64) VALUE                          
           'REPORT ON HUSBAND/WIFE CASE, SINGLE SON UPG MOVE-IN LATER'.         
           05  FILLER                  PIC X(08) VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
                  'USER : APPLICATION TEAM'.                                    
                                                                                
       01  L639C-HEADER-LINE.                                                   
           05  FILLER                  PIC X(04) VALUE ' S/N'.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'REGN NO'.               
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'NRIC NO'.               
           05  FILLER                  PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(11) VALUE 'HDB-REF-SMS'.           
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(13) VALUE 'HDB-REF-RSL'.           
           05  FILLER                  PIC X(04) VALUE 'HH  '.                  
           05  FILLER                  PIC X(10) VALUE 'MTH S-SMS '.            
           05  FILLER                  PIC X(07) VALUE 'S-RSL  '.               
           05  FILLER                  PIC X(12) VALUE 'MARRIED-ST'.            
           05  FILLER                  PIC X(12) VALUE 'RELATIONSHIP'.          
           05  FILLER                  PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE 'ST  '.                  
           05  FILLER                  PIC X(04) VALUE 'HA  '.                  
           05  FILLER                  PIC X(10) VALUE 'SMS DATE  '.            
           05  FILLER                  PIC X(05) VALUE 'HSE-G'.                 
                                                                                
       01  L639C-DET-LINE.                                                      
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639C-SERNO             PIC X(4)  VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639C-REGN-NO           PIC X(8)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639C-NRIC-NO           PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639C-HDB-SMS           PIC X(11) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639C-HDB-RSL           PIC X(11) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639C-HHTY              PIC X     VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639C-MTH-RESIDE        PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639C-MTH-SUBLET-SMS    PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639C-MTH-SUBLET-RSL    PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639C-MARITAL           PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639C-RELATION          PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE SPACES.                  
           05  L639C-SALE-TYPE         PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L639C-APPLN             PIC X     VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639C-SOLD-DATE         PIC X(08) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  L639C-HSE-GRANT         PIC X     VALUE SPACES.                  
                                                                                
       01  WORK-AREAS.                                                          
           05  WS-MATCH            PIC 9(8)    VALUE 0.                         
           05  WS-UNMATCH-F500     PIC 9(8)    VALUE 0.                         
           05  WS-UNMATCH-F558     PIC 9(8)    VALUE 0.                         
           05  WS-READ-F500        PIC 9(8)    VALUE 0.                         
           05  WS-READ-F558        PIC 9(8)    VALUE 0.                         
           05  WS-WRITE-F558A      PIC 9(8)    VALUE 0.                         
           05  WS-WRITE-F558B      PIC 9(8)    VALUE 0.                         
           05  K060-FILE-STATUS    PIC XX      VALUE SPACES.                    
           05  WS-APPL-NO          PIC X(1)    VALUE SPACES.                    
           05  WS-APPL-YES         PIC X(1)    VALUE SPACES.                    
           05  WS-APPL-SINGLE-NO   PIC X(1)    VALUE SPACES.                    
           05  WS-APPL-SINGLE-YES  PIC X(1)    VALUE SPACES.                    
           05  WS-APPL-NHH         PIC X(1)    VALUE SPACES.                    
           05  WS-APPL-SINGLE-NHH  PIC X(1)    VALUE SPACES.                    
           05  WS-PARENT-NHH       PIC X(1)    VALUE SPACES.                    
           05  WS-SINGLE-NHH       PIC X(1)    VALUE SPACES.                    
           05  WS-PARENT-UPG-YES   PIC X(1)    VALUE SPACES.                    
           05  WS-PARENT-UPG-NO    PIC X(1)    VALUE SPACES.                    
           05  WS-HA-PARENT-UPG-YES  PIC X(1)    VALUE SPACES.                  
           05  WS-HA-PARENT-UPG-NO   PIC X(1)    VALUE SPACES.                  
           05  WS-HA-PARENT-NHH      PIC X(1)    VALUE SPACES.                  
           05  WS-SINGLE-UPG-YES   PIC X(1)    VALUE SPACES.                    
           05  WS-SINGLE-UPG-NO    PIC X(1)    VALUE SPACES.                    
           05  WS-SINGLE-OCCP-NO   PIC X(1)    VALUE SPACES.                    
           05  WS-SINGLE-OCCP-YES  PIC X(1)    VALUE SPACES.                    
           05  WS-MARRIED-NHH      PIC X(1)    VALUE SPACES.                    
           05  WS-MARRIED-UPG-YES  PIC X(1)    VALUE SPACES.                    
           05  WS-MARRIED-UPG-NO   PIC X(1)    VALUE SPACES.                    
           05  WS-HA-MARRIED-NHH   PIC X(1)    VALUE SPACES.                    
           05  WS-HA-MARRIED-UPG-YES  PIC X(1)    VALUE SPACES.                 
           05  WS-HA-MARRIED-UPG-NO   PIC X(1)    VALUE SPACES.                 
           05  WS-APPL-DIVOR-NO    PIC X(1)    VALUE SPACES.                    
           05  WS-APPL-DIVOR-YES   PIC X(1)    VALUE SPACES.                    
           05  WS-DIVOR-NHH        PIC X(1)    VALUE SPACES.                    
           05  WS-DIVOR-UPG-YES    PIC X(1)    VALUE SPACES.                    
           05  WS-DIVOR-UPG-NO     PIC X(1)    VALUE SPACES.                    
           05  WS-SPOUSE-NO        PIC X(1)    VALUE SPACES.                    
           05  WS-SPOUSE-YES       PIC X(1)    VALUE SPACES.                    
           05  WS-HA-GRANDPARENT-UPG-YES  PIC X(1)    VALUE SPACES.             
           05  WS-HA-GRANDPARENT-UPG-NO   PIC X(1)    VALUE SPACES.             
           05  WS-BRO-UPG-YES      PIC X(1)    VALUE SPACES.                    
           05  WS-BRO-UPG-NO       PIC X(1)    VALUE SPACES.                    
           05  WS-F558-SUB         PIC 9(2)    VALUE ZERO.                      
           05  WS-F558-STORED      PIC 9(2)    VALUE ZERO.                      
           05  WS-PAGENO-A         PIC 9(4)    VALUE ZEROES.                    
           05  WS-LINE-CNT-A       PIC 9(2)    VALUE 90.                        
           05  WS-SERNO-A          PIC 9(4)    VALUE ZEROES.                    
           05  WS-PAGENO-B         PIC 9(4)    VALUE ZEROES.                    
           05  WS-LINE-CNT-B       PIC 9(2)    VALUE 90.                        
           05  WS-SERNO-B          PIC 9(4)    VALUE ZEROES.                    
           05  WS-PAGENO-C         PIC 9(4)    VALUE ZEROES.                    
           05  WS-LINE-CNT-C       PIC 9(2)    VALUE 90.                        
           05  WS-SERNO-C          PIC 9(4)    VALUE ZEROES.                    
           05  WS-MTH-SINGLE       PIC 9(3)    VALUE ZEROES.                    
           05  WS-MTH-MARRIED      PIC 9(3)    VALUE ZEROES.                    
           05  WS-MTH-PARENT       PIC 9(3)    VALUE ZEROES.                    
           05  WS-MTH-HA-PARENT    PIC 9(3)    VALUE ZEROES.                    
           05  WS-MTH-APPL         PIC 9(3)    VALUE ZEROES.                    
           05  WS-MTH-APPL-SINGLE  PIC 9(3)    VALUE ZEROES.                    
           05  WS-MTH-HA-GRANDPARENT    PIC 9(3)    VALUE ZEROES.               
           05  WS-CHK-MONTH        PIC 9(3)    VALUE ZEROES.                    
           05  WS-DESC             PIC X(20)   VALUE SPACES.                    
           05  WS-REGN-CNT-A       PIC 9(02)   VALUE ZEROS.                     
           05  WS-REGN-CNT-B       PIC 9(02)   VALUE ZEROS.                     
           05  WS-REGN-CNT-C       PIC 9(02)   VALUE ZEROS.                     
           05  WS-APPL-FLAT        PIC X(11)   VALUE SPACES.                    
           05  WS-PARENT-FLAT      PIC X(11)   VALUE SPACES.                    
           05  WS-PARENT-FLAT-2ND  PIC X(11)   VALUE SPACES.                    
           05  WS-SON-FLAT         PIC X(11)   VALUE SPACES.                    
           05  WS-DIVOR-FLAT       PIC X(11)   VALUE SPACES.                    
           05  WS-HA-DIVOR-FLAT    PIC X(11)   VALUE SPACES.                    
           05  WS-SPOUSE-FLAT      PIC X(11)   VALUE SPACES.                    
           05  WS-BRO-FLAT         PIC X(11)   VALUE SPACES.                    
           05  WS-HA-PARENT-FLAT   PIC X(11)   VALUE SPACES.                    
           05  WS-HSE-GRANT        PIC X(01)   VALUE SPACES.                    
           05  WS-WRITE-FLAG       PIC X(01)   VALUE 'N'.                       
                                                                                
       01  WS-DATE                       PIC X(8)   VALUE SPACES.               
                                                                                
       COPY WSF558.                                                             
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       000-MAIN.                                                                
      *-------------------------------------------------------------            
           OPEN INPUT  BP13F500                                                 
                       BP13F713                                                 
                       BP13F558                                                 
                       BP13K060                                                 
                OUTPUT P13F558A                                                 
                       P13F558B                                                 
                       P13L639A                                                 
                       P13L639B                                                 
                       P13L639C.                                                
                                                                                
           IF K060-FILE-STATUS NOT = ZEROS AND 97                               
              DISPLAY 'OPENING ERROR, K060-STATUS ' K060-FILE-STATUS            
              MOVE K060-FILE-STATUS     TO RETURN-CODE                          
              PERFORM 900-CLOSE-ROUTINE THRU 900-EXIT.                          
                                                                                
            READ BP13F713 AT END                                                
              DISPLAY 'BP13F713-REC EMPTY '                                     
              PERFORM 900-CLOSE-ROUTINE THRU 900-EXIT.                          
                                                                                
            IF F713-CDE-COHORT = 'OP'                                           
               MOVE 60  TO WS-CHK-MONTH                                         
            ELSE                                                                
               MOVE 60  TO WS-CHK-MONTH                                         
            END-IF.                                                             
                                                                                
            MOVE FUNCTION CURRENT-DATE TO WS-DATE.                              
                                                                                
            STRING WS-DATE(7:2) '/'                                             
                   WS-DATE(5:2) '/'                                             
                   WS-DATE(1:4) DELIMITED BY SIZE INTO L639-DATE.               
                                                                                
           PERFORM 100-READ-F500     THRU 100-EXIT.                             
           PERFORM 200-READ-F558     THRU 200-EXIT.                             
                                                                                
           PERFORM 300-CHECK-RELATIONSHIP THRU 300-EXIT                         
                   UNTIL F500-NUM-REGN = HIGH-VALUES                            
                     AND F558-NUM-REGN = HIGH-VALUES.                           
           PERFORM 900-CLOSE-ROUTINE.                                           
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
       100-READ-F500.                                                           
      *-------------------------------------------------------------            
           READ BP13F500                                                        
                AT END MOVE HIGH-VALUES TO F500-NUM-REGN                        
                       GO TO 100-EXIT.                                          
                                                                                
           ADD 1 TO WS-READ-F500.                                               
                                                                                
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
       200-READ-F558.                                                           
      *-------------------------------------------------------------            
           READ BP13F558                                                        
                AT END MOVE HIGH-VALUES TO F558-NUM-REGN                        
                       GO TO 200-EXIT.                                          
                                                                                
           ADD 1 TO WS-READ-F558.                                               
                                                                                
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ** MARRIED STATUS  1 = SINGLE                                             
      **                 2 = MARRIED                                            
      **                 3 = WIDOWED                                            
      **                 4 = DIVORCDE                                           
      **                 5 = SEPARATED                                          
       300-CHECK-RELATIONSHIP.                                                  
                                                                                
                                                                                
           MOVE 1      TO WS-F558-SUB.                                          
           MOVE 0      TO WS-F558-STORED.                                       
           MOVE 0      TO WS-REGN-CNT-A.                                        
           MOVE 0      TO WS-REGN-CNT-B.                                        
           MOVE 0      TO WS-REGN-CNT-C.                                        
           MOVE 0      TO WS-MTH-APPL,                                          
                          WS-MTH-APPL-SINGLE,                                   
                          WS-MTH-SINGLE,                                        
                          WS-MTH-MARRIED,                                       
                          WS-MTH-PARENT,                                        
                          WS-MTH-HA-PARENT,                                     
                          WS-MTH-HA-GRANDPARENT.                                
                                                                                
           MOVE SPACES TO WS-HSE-GRANT.                                         
                                                                                
           MOVE SPACES TO WS-APPL-NO,                                           
                          WS-APPL-YES,                                          
                          WS-APPL-SINGLE-NO,                                    
                          WS-APPL-SINGLE-YES,                                   
                          WS-PARENT-UPG-NO,                                     
                          WS-PARENT-UPG-YES,                                    
                          WS-SINGLE-UPG-NO,                                     
                          WS-SINGLE-UPG-YES                                     
                          WS-MARRIED-UPG-NO                                     
                          WS-MARRIED-UPG-YES,                                   
                          WS-APPL-NHH,                                          
                          WS-APPL-SINGLE-NHH,                                   
                          WS-PARENT-NHH,                                        
                          WS-SINGLE-NHH,                                        
                          WS-MARRIED-NHH,                                       
                          WS-APPL-DIVOR-NO,                                     
                          WS-APPL-DIVOR-YES,                                    
                          WS-DIVOR-NHH,                                         
                          WS-DIVOR-UPG-YES,                                     
                          WS-DIVOR-UPG-NO,                                      
                          WS-APPL-FLAT,                                         
                          WS-HA-PARENT-FLAT,                                    
                          WS-PARENT-FLAT,                                       
                          WS-PARENT-FLAT-2ND,                                   
                          WS-SON-FLAT,                                          
                          WS-DIVOR-FLAT,                                        
                          WS-HA-DIVOR-FLAT,                                     
                          WS-SINGLE-OCCP-NO,                                    
                          WS-SINGLE-OCCP-YES,                                   
                          WS-SPOUSE-NO,                                         
                          WS-SPOUSE-YES,                                        
                          WS-SPOUSE-FLAT,                                       
                          WS-HA-PARENT-UPG-YES,                                 
                          WS-HA-PARENT-UPG-NO,                                  
                          WS-HA-GRANDPARENT-UPG-YES,                            
                          WS-HA-GRANDPARENT-UPG-NO,                             
                          WS-BRO-UPG-NO,                                        
                          WS-BRO-UPG-YES,                                       
                          WS-BRO-FLAT,                                          
                          WS-HA-PARENT-NHH,                                     
                          WS-HA-MARRIED-UPG-NO,                                 
                          WS-HA-MARRIED-UPG-YES,                                
                          WS-HA-MARRIED-NHH.                                    
                                                                                
           IF F500-NUM-REGN = F558-NUM-REGN                                     
              ADD 1 TO WS-MATCH                                                 
              PERFORM 400-SAVE-RECORDS THRU 400-EXIT                            
                 UNTIL F558-NUM-REGN NOT = F500-NUM-REGN                        
                 OR F558-NUM-REGN = HIGH-VALUES                                 
              PERFORM 450-WRITE-OUTPUT   THRU 450-EXIT                          
              PERFORM 100-READ-F500     THRU 100-EXIT                           
           ELSE                                                                 
              IF F500-NUM-REGN > F558-NUM-REGN                                  
                 PERFORM 200-READ-F558  THRU 200-EXIT                           
                 ADD 1 TO WS-UNMATCH-F558                                       
              ELSE                                                              
                 ADD 1 TO WS-UNMATCH-F500                                       
                 PERFORM 100-READ-F500  THRU 100-EXIT.                          
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
       400-SAVE-RECORDS.                                                        
      *-------------------------------------------------------------            
           IF (F558-NUM-NRIC = F500-NUM-NRIC1) OR                               
              (F558-NUM-NRIC = F500-NUM-NRIC2) OR                               
              (F558-NUM-NRIC = F500-NUM-NRIC3) OR                               
              (F558-NUM-NRIC = F500-NUM-NRIC4)                                  
              MOVE 'Y' TO  F558-NUM-APPLN                                       
           END-IF.                                                              
                                                                                
           IF F558-CDE-SALES-TYPE-SMS = '6' OR '6J' OR '8C' OR '8D'             
                                            OR '8F'                             
              MOVE 'Y' TO WS-HSE-GRANT                                          
           END-IF.                                                              
                                                                                
           IF F558-CDE-FILE-STATUS-RSL = 'GS' OR 'PG' OR 'FG'                   
              MOVE 'Y' TO WS-HSE-GRANT                                          
           END-IF.                                                              
                                                                                
           MOVE BP13F558-REC TO WS-F558-REC (WS-F558-SUB).                      
           ADD 1 TO WS-F558-SUB.                                                
           ADD 1 TO WS-F558-STORED.                                             
                                                                                
           IF F558-NUM-MTH-RESIDE IS NOT NUMERIC                                
              MOVE ZEROS TO F558-NUM-MTH-RESIDE.                                
                                                                                
           IF (F558-NUM-NRIC = F500-NUM-NRIC1) OR                               
              (F558-NUM-NRIC = F500-NUM-NRIC2) OR                               
              (F558-NUM-NRIC = F500-NUM-NRIC3) OR                               
              (F558-NUM-NRIC = F500-NUM-NRIC4)                                  
      ***                                                                       
      *** APPL-SINGLE (5YR=NO)                                                  
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '00') AND                            
                  (F558-NUM-MARITAL-STATUS = '1')                               
                  MOVE F558-NUM-MTH-RESIDE TO WS-MTH-APPL-SINGLE                
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-APPL-FLAT                  
                  END-IF                                                        
                  DISPLAY 'APPL-SINGLE-NO= ' F558-NUM-REGN                      
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y' TO WS-APPL-SINGLE-NO                                 
               END-IF                                                           
      ***                                                                       
      *** APPL-SINGLE (5YR=YES)                                                 
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '00') AND                            
                  (F558-NUM-MARITAL-STATUS = '1')                               
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-APPL-SINGLE         
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-APPL-FLAT                  
                  END-IF                                                        
                  DISPLAY 'APPL-SINGLE-YES= ' F558-NUM-REGN                     
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-APPL-SINGLE-YES         
               END-IF                                                           
      ***                                                                       
      *** SINGLE-SON-UPG (5YR=YES)                                              
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '41' ) AND                           
                  (F558-NUM-MARITAL-STATUS = '1' OR '3' OR '4' OR '5')          
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-SINGLE              
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'UPG-SINGLE-YES= ' F558-NUM-REGN                      
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-SINGLE-UPG-YES          
               END-IF                                                           
      ***                                                                       
      *** SINGLE-SON-UPG (5YR=NO)                                               
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '41' ) AND                           
                  (F558-NUM-MARITAL-STATUS = '1' OR '3' OR '4' OR '5')          
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-SINGLE              
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'UPG-SINGLE-NO= ' F558-NUM-REGN                       
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-SINGLE-UPG-NO           
               END-IF                                                           
                                                                                
      * DIVORCED/WIDOWED/SEPARATED - APPL (5-YR=NO)                             
      *                                                                         
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '00') AND                            
                  (F558-NUM-MARITAL-STATUS = '3' OR '4' OR '5')                 
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-DIVOR-FLAT           
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-DIVOR-FLAT           
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-HA-DIVOR-FLAT              
                  END-IF                                                        
                  DISPLAY 'APPL-DIVOR-NO= ' F558-NUM-REGN                       
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-APPL-DIVOR-NO           
               END-IF                                                           
                                                                                
      * DIVORCED/WIDOWED/SEPARATED - APPL (5-YR=YES)                            
      *                                                                         
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '00') AND                            
                  (F558-NUM-MARITAL-STATUS = '3' OR '4' OR '5')                 
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-DIVOR-FLAT           
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-DIVOR-FLAT           
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-HA-DIVOR-FLAT              
                  END-IF                                                        
                  DISPLAY 'APPL-DIVOR-YES= ' F558-NUM-REGN                      
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y' TO WS-APPL-DIVOR-YES                                 
               END-IF                                                           
                                                                                
      ***                                                                       
      *** MARRIED-SON-UPG (5YR=YES)                                             
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '41'  OR '42' ) AND                  
                  (F558-NUM-MARITAL-STATUS = '2')                               
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-MARRIED             
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'HA-UPG-MARRIED-YES= ' F558-NUM-REGN                  
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO                            
                                                  WS-HA-MARRIED-UPG-YES         
               END-IF                                                           
      ***                                                                       
      *** MARRIED-SON-UPG (5YR=NO)                                              
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '41' OR '42' ) AND                   
                  (F558-NUM-MARITAL-STATUS = '2')                               
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-MARRIED             
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'HA-UPG-MARRIED-NO= ' F558-NUM-REGN                   
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO                            
                                                  WS-HA-MARRIED-UPG-NO          
               END-IF                                                           
      ***                                                                       
      *** HA PARENT-UPG (5YR=YES)                                               
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '02' OR '12' OR '22' OR '32')        
                  MOVE F558-NUM-MTH-RESIDE TO WS-MTH-HA-PARENT                  
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-PARENT-FLAT          
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-PARENT-FLAT          
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-HA-PARENT-FLAT             
                  END-IF                                                        
                  DISPLAY 'UPG-HA-PARENT-YES= ' F558-NUM-REGN                   
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                      TO WS-HA-PARENT-UPG-YES         
               END-IF                                                           
      ***                                                                       
      *** HA PARENT-UPG (5YR=NO)                                                
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '02' OR '12' OR '22' OR '32')        
                  MOVE F558-NUM-MTH-RESIDE TO WS-MTH-HA-PARENT                  
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-PARENT-FLAT          
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-HA-PARENT-FLAT          
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-HA-PARENT-FLAT             
                  END-IF                                                        
                  DISPLAY 'UPG-HA-PARENT-NO= ' F558-NUM-REGN                    
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-HA-PARENT-UPG-NOUPG-NO  
               END-IF                                                           
                                                                                
      ***                                                                       
      *** HA GRANDPARENT-UPG (5YR=YES)                                          
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '01' OR '11' OR '21' OR '31')        
                  MOVE F558-NUM-MTH-RESIDE TO WS-MTH-HA-GRANDPARENT             
                  DISPLAY 'UPG-HA-GRANDPARENT-YES= ' F558-NUM-REGN              
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO                            
                                               WS-HA-GRANDPARENT-UPG-YES        
               END-IF                                                           
      ***                                                                       
      *** HA GRANDPARENT-UPG (5YR=NO)                                           
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '01' OR '11' OR '21' OR '31')        
                  MOVE F558-NUM-MTH-RESIDE TO WS-MTH-HA-GRANDPARENT             
                  DISPLAY 'UPG-HA-PARENT-NO= ' F558-NUM-REGN                    
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO                            
                                                WS-HA-GRANDPARENT-UPG-NO        
               END-IF                                                           
                                                                                
                                                                                
           END-IF.                                                              
      ***                                                                       
      *** APPL (5YR=NO)                                                         
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '00') AND                            
                  (F558-NUM-MARITAL-STATUS  = '2')                              
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-APPL                
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-APPL-FLAT                  
                  END-IF                                                        
                  DISPLAY 'APPL-NO= ' F558-NUM-REGN                             
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-APPL-NO                 
               END-IF.                                                          
      ***                                                                       
      *** APPL (5YR=YES)                                                        
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '00') AND                            
                  (F558-NUM-MARITAL-STATUS  = '2')                              
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-APPL                
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-APPL-FLAT               
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-APPL-FLAT                  
                  END-IF                                                        
                  DISPLAY 'APPL-YES= ' F558-NUM-REGN                            
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-APPL-YES                
               END-IF.                                                          
      ***                                                                       
      *** NON-HA PARENT-UPG (5YR=YES)                                           
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '02' OR '12' OR '22' OR '32')        
                  MOVE F558-NUM-MTH-RESIDE TO WS-MTH-PARENT                     
                  IF WS-PARENT-FLAT NOT = SPACES AND                            
                     F558-NUM-HDB-REF-SMS NOT = SPACES                          
                     MOVE F558-NUM-HDB-REF-SMS TO WS-PARENT-FLAT-2ND            
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                     
                     MOVE F558-NUM-HDB-REF-SMS TO WS-PARENT-FLAT                
                  ELSE                                                          
                     MOVE F558-NUM-HDB-REF-RSL TO WS-PARENT-FLAT                
                  END-IF                                                        
                  DISPLAY 'UPG-PARENT-YES= ' F558-NUM-REGN                      
                          ' IC= ' F558-NUM-NRIC                                 
                          ' 1ST-FLAT ' WS-PARENT-FLAT                           
                          ' 2ND-FLAT ' WS-PARENT-FLAT-2ND                       
                  MOVE 'Y'                     TO WS-PARENT-UPG-YES             
               END-IF.                                                          
      ***                                                                       
      *** NON-HA, MARRIED-SON-UPG (5YR=YES)                                     
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '41'  OR '42') AND                   
                  (F558-NUM-MARITAL-STATUS = '2')                               
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-MARRIED             
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'UPG-MARRIED-YES= ' F558-NUM-REGN                     
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-MARRIED-UPG-YES         
               END-IF.                                                          
      ***                                                                       
      *** PARENT-UPG (5YR=NO)                                                   
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '02' OR '12' OR '22' OR '32')        
                  MOVE F558-NUM-MTH-RESIDE TO WS-MTH-PARENT                     
                  IF WS-PARENT-FLAT NOT = SPACES AND                            
                     F558-NUM-HDB-REF-SMS NOT = SPACES                          
                     MOVE F558-NUM-HDB-REF-SMS TO WS-PARENT-FLAT-2ND            
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                     
                     MOVE F558-NUM-HDB-REF-SMS TO WS-PARENT-FLAT                
                  ELSE                                                          
                     MOVE F558-NUM-HDB-REF-RSL TO WS-PARENT-FLAT                
                  END-IF                                                        
                  DISPLAY 'UPG-PARENT-NO= ' F558-NUM-REGN                       
                          ' IC= ' F558-NUM-NRIC                                 
                          ' 1ST-FLAT ' WS-PARENT-FLAT                           
                          ' 2ND-FLAT ' WS-PARENT-FLAT-2ND                       
                  MOVE 'Y'                     TO WS-PARENT-UPG-NO              
               END-IF.                                                          
      ***                                                                       
      *** MARRIED-SON-UPG (5YR=NO)                                              
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '41' OR '42' ) AND                   
                  (F558-NUM-MARITAL-STATUS = '2')                               
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-MARRIED             
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'UPG-MARRIED-NO= ' F558-NUM-REGN                      
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-MARRIED-UPG-NO          
               END-IF.                                                          
      ***                                                                       
      *** SINGLE-OCCP-UPG (5YR=YES)                                             
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '41' ) AND                           
                  (F558-NUM-MARITAL-STATUS = '1' OR '3' OR '4' OR '5')          
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-MARRIED             
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'SINGLE-OCCP-NO= ' F558-NUM-REGN                      
                         ' IC= ' F558-NUM-NRIC                                  
                  MOVE 'Y'                        TO WS-SINGLE-OCCP-YES         
               END-IF.                                                          
      ***                                                                       
      *** SINGLE-OCCP-UPG (5YR=NO)                                              
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '41' ) AND                           
                  (F558-NUM-MARITAL-STATUS = '1' OR '3' OR '4' OR '5')          
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-MARRIED             
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SON-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SON-FLAT                   
                  END-IF                                                        
                  DISPLAY 'SINGLE-OCCP-NO= ' F558-NUM-REGN                      
                         ' IC= ' F558-NUM-NRIC                                  
                  MOVE 'Y'                        TO WS-SINGLE-OCCP-NO          
               END-IF.                                                          
      *                                                                         
      * SPOUSE OR FIANCE/FIANCEE UPG-NO (5-YR=NO)                               
      *                                                                         
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '20' OR '09')                        
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-APPL-SINGLE         
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SPOUSE-FLAT             
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SPOUSE-FLAT             
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SPOUSE-FLAT                
                  END-IF                                                        
                  DISPLAY 'SPOUSE-UPG-NO= ' F558-NUM-REGN                       
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-SPOUSE-NO               
               END-IF.                                                          
      *                                                                         
      * SPOUSE OR FIANCE/FIANCEE UPG-YES (5-YR=YES)                             
      *                                                                         
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '20'  OR '09')                       
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-APPL-SINGLE         
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SPOUSE-FLAT             
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-SPOUSE-FLAT             
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-SPOUSE-FLAT                
                  END-IF                                                        
                  DISPLAY 'SPOUSE-UPG-YES= ' F558-NUM-REGN                      
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-SPOUSE-YES              
               END-IF.                                                          
                                                                                
      ***                                                                       
      *** SIBLING-SINGLE-UPG (5YR=YES)                                          
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE NOT < WS-CHK-MONTH) AND                  
                  (F558-CDE-RELATIONSHIP = '06' ) AND                           
                  (F558-NUM-MARITAL-STATUS = '1' OR '2' OR '3' OR '4' OR        
                                             '5')                               
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-SINGLE              
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-BRO-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-BRO-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-BRO-FLAT                   
                  END-IF                                                        
                  DISPLAY 'SIBLING-SINGLE-YES= ' F558-NUM-REGN                  
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-BRO-UPG-YES             
                                                                                
               END-IF.                                                          
      ***                                                                       
      *** SIBLING-SINGLE-UPG (5YR=NO)                                           
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'G' OR '3') AND                         
                  (F558-NUM-MTH-RESIDE > 0 AND < WS-CHK-MONTH) AND              
                  (F558-CDE-RELATIONSHIP = '06' ) AND                           
                  (F558-NUM-MARITAL-STATUS = '1' OR '2' OR '3' OR '4' OR        
                                             '5')                               
                  MOVE F558-NUM-MTH-RESIDE        TO WS-MTH-SINGLE              
                  IF F558-CDE-FILE-STATUS-SMS NOT = 'OM'                        
                     IF F558-NUM-MTH-RESIDE-RSL IS NOT NUMERIC                  
                        MOVE F558-NUM-HDB-REF-SMS TO WS-BRO-FLAT                
                     END-IF                                                     
                  ELSE                                                          
                     IF (F558-CDE-SALES-TYPE-SMS = '7C' OR '7J' OR '8A'         
                                        OR '8B' OR '8E' OR '7 ' OR '8L'         
                                        OR '8M' OR '8N' OR '8R' OR '8S'         
                                        OR '8T') AND                            
                        (F558-NUM-DEBARMENT-4 = '62' OR '64' OR '66'            
                                                 OR 'GA' OR 'GB')               
                        MOVE F558-NUM-HDB-REF-SMS TO WS-BRO-FLAT                
                     END-IF                                                     
                  END-IF                                                        
                  IF F558-NUM-MTH-RESIDE-RSL IS NUMERIC                         
                     MOVE F558-NUM-HDB-REF-RSL TO WS-BRO-FLAT                   
                  END-IF                                                        
                  DISPLAY 'SIBLING-SINGLE-NO= ' F558-NUM-REGN                   
                          ' IC= ' F558-NUM-NRIC                                 
                  MOVE 'Y'                        TO WS-BRO-UPG-NO              
                                                                                
               END-IF.                                                          
                                                                                
      *** NHH OR OCCUP OR EX-LESSEE (5YR=NO)                                    
      ***                                                                       
               IF (F558-CDE-HOUSEHOLD = 'H') OR                                 
                  (F558-CDE-HOUSEHOLD = 'G' AND                                 
                        F558-CDE-FILE-STATUS-SMS = 'OM' AND                     
                        F558-NUM-MTH-RESIDE = ZEROS)                            
                  IF F558-CDE-RELATIONSHIP = '00'                               
                     IF F558-NUM-MARITAL-STATUS = '1'                           
                         MOVE 'Y'  TO WS-APPL-SINGLE-NHH                        
                     ELSE                                                       
                         MOVE 'Y'  TO WS-APPL-NHH                               
                  ELSE                                                          
                  IF F558-CDE-RELATIONSHIP = '41' OR '42' OR '09'               
                     IF F558-NUM-MARITAL-STATUS = '1'                           
                         MOVE 'Y'  TO WS-SINGLE-NHH                             
                     ELSE                                                       
      *** MARRIED NHH MUST BE APPLICANTS                                        
                     IF F558-NUM-APPLN = 'Y'                                    
                         MOVE 'Y'  TO WS-HA-MARRIED-NHH                         
                     ELSE                                                       
                         MOVE 'Y'  TO WS-MARRIED-NHH                            
                     END-IF                                                     
                  ELSE                                                          
                 IF F558-CDE-RELATIONSHIP = '02' OR '12' OR '22' OR '32'        
                     IF F558-NUM-APPLN = 'Y'                                    
                         MOVE 'Y'  TO WS-HA-PARENT-NHH                          
                     ELSE                                                       
                         MOVE 'Y'  TO WS-PARENT-NHH                             
                     END-IF                                                     
                  END-IF                                                        
              END-IF.                                                           
                                                                                
           PERFORM 200-READ-F558   THRU   200-EXIT.                             
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
       450-WRITE-OUTPUT.                                                        
      *-------------------------------------------------------------            
           MOVE 'N' TO WS-WRITE-FLAG.                                           
                                                                                
           IF WS-PARENT-UPG-YES = 'Y'                                           
              IF WS-APPL-DIVOR-NO = 'Y'                                         
                 MOVE 'Y' TO WS-APPL-SINGLE-NO                                  
                 MOVE WS-HA-DIVOR-FLAT TO WS-APPL-FLAT                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-PARENT-UPG-NO = 'Y'                                            
              IF WS-APPL-DIVOR-YES = 'Y'                                        
                 MOVE WS-HA-DIVOR-FLAT TO WS-APPL-FLAT                          
                 MOVE 'Y' TO WS-APPL-SINGLE-YES                                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-SINGLE-UPG-YES = 'Y'                                           
              IF WS-APPL-DIVOR-NO = 'Y'                                         
                 MOVE WS-HA-DIVOR-FLAT TO WS-APPL-FLAT                          
                 MOVE 'Y' TO WS-APPL-NO                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-SINGLE-UPG-NO = 'Y'                                            
              IF WS-APPL-DIVOR-YES = 'Y'                                        
                 MOVE WS-HA-DIVOR-FLAT TO WS-APPL-FLAT                          
                 MOVE 'Y' TO WS-APPL-YES                                        
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-SINGLE-OCCP-YES = 'Y'                                          
              IF WS-APPL-DIVOR-NO = 'Y'                                         
                 MOVE WS-HA-DIVOR-FLAT TO WS-APPL-FLAT                          
                 MOVE 'Y' TO WS-APPL-NO                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-SINGLE-OCCP-NO = 'Y'                                           
              IF WS-APPL-DIVOR-YES = 'Y'                                        
                 MOVE WS-HA-DIVOR-FLAT TO WS-APPL-FLAT                          
                 MOVE 'Y' TO WS-APPL-YES                                        
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF ((WS-APPL-SINGLE-NO = 'Y' AND WS-PARENT-UPG-YES = 'Y') AND        
               (WS-APPL-FLAT = WS-PARENT-FLAT))                                 
              OR                                                                
              ((WS-APPL-SINGLE-YES = 'Y' AND WS-PARENT-UPG-NO = 'Y') AND        
               (WS-APPL-FLAT = WS-PARENT-FLAT))                                 
              OR                                                                
              ((WS-APPL-NO = 'Y' AND WS-SINGLE-UPG-YES = 'Y') AND               
               (WS-APPL-FLAT = WS-SON-FLAT))                                    
              OR                                                                
              ((WS-APPL-YES = 'Y' AND WS-SINGLE-UPG-NO = 'Y') AND               
               (WS-APPL-FLAT = WS-SON-FLAT))                                    
              OR                                                                
              ((WS-APPL-NO = 'Y' AND WS-SINGLE-OCCP-YES = 'Y') AND              
               (WS-APPL-FLAT = WS-SON-FLAT))                                    
              OR                                                                
              ((WS-APPL-YES = 'Y' AND WS-SINGLE-OCCP-NO = 'Y') AND              
               (WS-APPL-FLAT = WS-SON-FLAT))                                    
                  PERFORM 500-SINGLE-SON-CASE THRU 500-EXIT                     
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
                  GO TO 450-EXIT                                                
                                                                                
           END-IF.                                                              
                                                                                
           IF (WS-APPL-NO = 'Y' AND WS-HA-PARENT-UPG-YES = 'Y')                 
              OR                                                                
              ((WS-APPL-NO = 'Y' AND WS-HA-PARENT-NHH = 'Y') AND                
               (WS-HA-PARENT-UPG-NO = SPACES) AND                               
               (WS-SPOUSE-NO = SPACES))                                         
              OR                                                                
              (WS-APPL-YES = 'Y' AND WS-HA-PARENT-UPG-NO = 'Y')                 
              OR                                                                
              ((WS-APPL-NO = 'Y' AND WS-HA-MARRIED-NHH = 'Y') AND               
               (WS-HA-MARRIED-UPG-NO = SPACES) AND                              
               (WS-SPOUSE-NO = SPACES))                                         
              OR                                                                
              (WS-APPL-NO  = 'Y' AND WS-HA-MARRIED-UPG-YES = 'Y')               
              OR                                                                
              (WS-APPL-YES = 'Y' AND WS-HA-MARRIED-UPG-NO = 'Y')                
              OR                                                                
              (WS-APPL-DIVOR-YES = 'Y' AND WS-PARENT-UPG-YES = 'Y')             
              OR                                                                
              (WS-APPL-DIVOR-YES = 'Y' AND WS-HA-MARRIED-UPG-NO  = 'Y')         
              OR                                                                
              (WS-APPL-DIVOR-NO  = 'Y' AND WS-HA-MARRIED-UPG-YES = 'Y')         
              OR                                                                
              (WS-APPL-NHH = 'Y' AND WS-HA-MARRIED-UPG-NO = 'Y')                
              OR                                                                
              (WS-APPL-NHH = 'Y' AND WS-HA-MARRIED-NHH = 'Y'                    
                                 AND WS-MARRIED-UPG-NO = 'Y')                   
              OR                                                                
              (WS-APPL-NO  = 'Y' AND WS-HA-MARRIED-UPG-YES = 'Y'                
                                 AND WS-MARRIED-UPG-NO = 'Y')                   
              OR                                                                
              (WS-HA-GRANDPARENT-UPG-YES = 'Y' AND                              
                                 WS-HA-PARENT-UPG-NO = 'Y')                     
              OR                                                                
              (WS-HA-GRANDPARENT-UPG-NO  = 'Y' AND                              
                                 WS-HA-PARENT-UPG-YES = 'Y')                    
                  PERFORM 500-SINGLE-SON-CASE THRU 500-EXIT                     
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
                  GO TO 450-EXIT                                                
                                                                                
           END-IF.                                                              
                                                                                
      * HUSBAND/WIFE CASE, SPOUSE MOVE IN LATER                                 
      * FIANCE/FIANCEE, FIANCE MOVE IN LATER                                    
      * NOTE :: NO UPGRADER PARENT, UPGRADER SINGLE SON                         
                                                                                
           IF ( (WS-APPL-YES = 'Y' AND WS-SPOUSE-NO = 'Y')                      
                 AND (WS-APPL-FLAT = WS-SPOUSE-FLAT)                            
                 AND (WS-PARENT-UPG-NO = SPACES)                                
                 AND (WS-SINGLE-UPG-NO = SPACES))                               
              OR                                                                
              ( (WS-APPL-NO = 'Y' AND WS-SPOUSE-YES = 'Y')                      
                 AND (WS-APPL-FLAT = WS-SPOUSE-FLAT)                            
                 AND (WS-PARENT-UPG-NO = SPACES)                                
                 AND (WS-SINGLE-UPG-NO = SPACES))                               
                  PERFORM 600-HUSBAND-WIFE THRU 600-EXIT                        
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
                  GO TO 450-EXIT                                                
                                                                                
           END-IF.                                                              
      *                                                                         
      * APPLICANT-SINGLE WITH FIANCE AND                                        
      * FIANCE MOVE IN LATER                                                    
      *                                                                         
           IF ( (WS-APPL-SINGLE-YES = 'Y' AND WS-SPOUSE-NO = 'Y')               
                 AND (WS-APPL-FLAT = WS-SPOUSE-FLAT)                            
                 AND (WS-PARENT-UPG-NO = SPACES)                                
                 AND (WS-SINGLE-UPG-NO = SPACES))                               
              OR                                                                
              ( (WS-APPL-SINGLE-NO = 'Y' AND WS-SPOUSE-YES = 'Y')               
                 AND (WS-APPL-FLAT = WS-SPOUSE-FLAT)                            
                 AND (WS-PARENT-UPG-NO = SPACES)                                
                 AND (WS-SINGLE-UPG-NO = SPACES))                               
                  PERFORM 600-HUSBAND-WIFE THRU 600-EXIT                        
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
                  GO TO 450-EXIT                                                
                                                                                
           END-IF.                                                              
                                                                                
      *                                                                         
      * HUSBAND/WIFE AND FATHER/MOTHER CASES                                    
      * IF MOTHER MOVE IN LATER THAN FATHER                                     
      * SAME FLAT, UPDATE 5-YR = YES                                            
      *                                                                         
           IF ((WS-APPL-YES = 'Y' OR WS-APPL-NHH = 'Y') AND                     
               (WS-PARENT-UPG-NO = 'Y' AND WS-PARENT-UPG-YES = 'Y') AND         
               (WS-PARENT-FLAT = WS-PARENT-FLAT-2ND))                           
                  PERFORM 600-HUSBAND-WIFE THRU 600-EXIT                        
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
                  GO TO 450-EXIT                                                
           END-IF.                                                              
      *                                                                         
      * APPL - SINGLE SON, 5-YR = 'YES' OR NHH                                  
      * FATHER/MOTHER , ONE OF THEM MOVE IN LATER                               
      * NOTE :: NO UPGRADER PARENT, UPGRADER SINGLE SON                         
      *                                                                         
           IF ( (WS-APPL-SINGLE-YES = 'Y')                                      
                 AND (WS-PARENT-UPG-NO = 'Y')                                   
                 AND (WS-PARENT-UPG-YES = 'Y')                                  
                 AND (WS-PARENT-FLAT = WS-PARENT-FLAT-2ND)                      
                 AND (WS-SINGLE-UPG-NO = SPACES))                               
              OR                                                                
              ( (WS-APPL-SINGLE-NHH = 'Y')                                      
                 AND (WS-PARENT-UPG-NO = 'Y')                                   
                 AND (WS-PARENT-UPG-YES = 'Y')                                  
                 AND (WS-PARENT-FLAT = WS-PARENT-FLAT-2ND)                      
                 AND (WS-SINGLE-UPG-NO = SPACES))                               
                  PERFORM 600-HUSBAND-WIFE THRU 600-EXIT                        
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
           END-IF.                                                              
                                                                                
      ** APPL-SINGLE-NHH OR APPL-NHH                                            
      ** HA-UPG-PARENTS                                                         
      ** HA-UPG-SINGLE-SIBLING                                                  
      **                                                                        
      ** CHANGE BY SRA.                                                         
                                                                                
           IF ((WS-APPL-NHH = 'Y' OR WS-APPL-SINGLE-NHH = 'Y') AND              
              ((WS-HA-PARENT-UPG-YES = 'Y') AND (WS-BRO-UPG-NO = 'Y') OR        
             (WS-HA-PARENT-UPG-NO = 'Y') AND (WS-BRO-UPG-YES = 'Y')) AND        
               (WS-HA-PARENT-FLAT = WS-BRO-FLAT))                               
                  PERFORM 600-HUSBAND-WIFE THRU 600-EXIT                        
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
                                                                                
           END-IF.                                                              
                                                                                
      ** APPL-SINGLE-NHH                                                        
      ** UPG-PARENTS                                                            
      ** UPG-SINGLE-SIBLING                                                     
      **                                                                        
      ** CHANGE BY SRA.                                                         
                                                                                
           IF ((WS-APPL-NHH = 'Y' OR WS-APPL-SINGLE-NHH = 'Y') AND              
              ((WS-PARENT-UPG-YES = 'Y') AND (WS-BRO-UPG-NO = 'Y') OR           
               (WS-PARENT-UPG-NO = 'Y') AND (WS-BRO-UPG-YES = 'Y')) AND         
               (WS-PARENT-FLAT = WS-BRO-FLAT))                                  
                  PERFORM 600-HUSBAND-WIFE THRU 600-EXIT                        
                      VARYING WS-F558-SUB FROM 1 BY 1 UNTIL                     
                      WS-F558-SUB > WS-F558-STORED                              
                                                                                
           END-IF.                                                              
                                                                                
       450-EXIT.                                                                
           EXIT.                                                                
                                                                                
       500-SINGLE-SON-CASE.                                                     
      *-------------------------------------------------------------            
           PERFORM 7000-PRINT-REPORT-A THRU 7000-EXIT.                          
           MOVE WS-F558-REC (WS-F558-SUB) TO P13F558A-REC.                      
           WRITE P13F558A-REC.                                                  
           ADD 1 TO WS-WRITE-F558A.                                             
           MOVE 'Y' TO WS-WRITE-FLAG.                                           
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
       600-HUSBAND-WIFE.                                                        
      *-------------------------------------------------------------            
           PERFORM 8000-PRINT-REPORT-B THRU 8000-EXIT.                          
           MOVE WS-F558-REC (WS-F558-SUB) TO P13F558B-REC.                      
           WRITE P13F558B-REC.                                                  
           ADD 1 TO WS-WRITE-F558B.                                             
           MOVE 'Y' TO WS-WRITE-FLAG.                                           
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       610-COUPLE-SINGLE-SON.                                                   
      *-------------------------------------------------------------            
           PERFORM 8500-PRINT-REPORT-C THRU 8500-EXIT.                          
           MOVE WS-F558-REC (WS-F558-SUB) TO P13F558A-REC.                      
           WRITE P13F558A-REC.                                                  
           ADD 1 TO WS-WRITE-F558A.                                             
                                                                                
       610-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       7000-PRINT-REPORT-A.                                                     
      *-------------------------------------------------------------            
            IF WS-LINE-CNT-A > 55                                               
               PERFORM 7100-HEADING  THRU 7100-EXIT                             
            END-IF.                                                             
                                                                                
            ADD      01              TO WS-REGN-CNT-A.                          
                                                                                
            IF WS-REGN-CNT-A = 01                                               
               MOVE WS-F558-NUM-REGN(WS-F558-SUB) TO L639A-REGN-NO              
               ADD       01             TO WS-SERNO-A                           
               MOVE WS-SERNO-A          TO L639A-SERNO                          
               MOVE WS-HSE-GRANT        TO L639A-HSE-GRANT                      
            ELSE                                                                
               MOVE SPACES              TO L639A-REGN-NO                        
               MOVE SPACES              TO L639A-SERNO                          
                                           L639A-HSE-GRANT                      
            END-IF.                                                             
                                                                                
            MOVE WS-F558-NUM-NRIC(WS-F558-SUB) TO L639A-NRIC-NO.                
            MOVE WS-F558-NUM-HDB-REF-SMS(WS-F558-SUB) TO L639A-HDB-SMS.         
            MOVE WS-F558-NUM-HDB-REF-RSL(WS-F558-SUB) TO L639A-HDB-RSL.         
            MOVE WS-F558-CDE-HOUSEHOLD(WS-F558-SUB) TO L639A-HHTY.              
            MOVE WS-F558-NUM-MTH-RESIDE(WS-F558-SUB) TO L639A-MTH-RESIDE.       
            MOVE WS-F558-NUM-APPLN(WS-F558-SUB) TO L639A-APPLN.         .       
            MOVE WS-F558-NUM-SUBLET-SMS(WS-F558-SUB)                            
                                              TO L639A-MTH-SUBLET-SMS.          
            MOVE WS-F558-NUM-SUBLET-RSL(WS-F558-SUB)                            
                                               TO L639A-MTH-SUBLET-RSL.         
                                                                                
            MOVE  SPACES                TO   K060-KEY-FLD.                      
            MOVE  WS-F558-NUM-MARITAL-STATUS(WS-F558-SUB) TO K060-CODE.         
            MOVE   21                   TO   K060-SERIAL-NO.                    
            PERFORM 7200-DECODE-DESC    THRU 7200-EXIT.                         
            MOVE  WS-DESC               TO L639A-MARITAL.                       
                                                                                
            MOVE  SPACES                TO   K060-KEY-FLD.                      
            MOVE  WS-F558-CDE-RELATIONSHIP(WS-F558-SUB) TO K060-CODE.           
            MOVE   35                   TO   K060-SERIAL-NO.                    
            PERFORM 7200-DECODE-DESC    THRU 7200-EXIT.                         
            MOVE WS-DESC                TO   L639A-RELATION.                    
            MOVE WS-F558-CDE-SALES-TYPE-SMS(WS-F558-SUB)                        
                                        TO L639A-SALE-TYPE.                     
            MOVE WS-F558-DTE-FLAT-SOLD-SMS(WS-F558-SUB)                         
                                        TO L639A-SOLD-DATE.                     
            IF L639A-SERNO = SPACES                                             
               ADD      01              TO WS-LINE-CNT-A                        
               WRITE P13L639A-REC FROM L639A-DET-LINE AFTER 1                   
            ELSE                                                                
               ADD      02              TO WS-LINE-CNT-A                        
               WRITE P13L639A-REC FROM L639A-DET-LINE AFTER 2.                  
                                                                                
       7000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       7100-HEADING.                                                            
      *-------------------------------------------------------------            
            ADD      01        TO WS-PAGENO-A.                                  
            MOVE WS-PAGENO-A   TO WS-EDITED-PAGENO.                             
            MOVE     01        TO WS-LINE-CNT-A.                                
            WRITE  P13L639A-REC FROM L639A-TOP-TITLE1 AFTER PAGE.               
            WRITE  P13L639A-REC FROM L639A-TOP-TITLE2 AFTER 2.                  
            WRITE  P13L639A-REC FROM L639A-HEADER-LINE AFTER 2.                 
            ADD      06        TO WS-LINE-CNT-A.                                
                                                                                
       7100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       7200-DECODE-DESC.                                                        
      *-------------------------------------------------------------            
            READ BP13K060.                                                      
                                                                                
            EVALUATE K060-FILE-STATUS                                           
                WHEN 00                                                         
                     MOVE K060-DESC     TO   WS-DESC                            
                WHEN 23                                                         
                     MOVE SPACES        TO   WS-DESC                            
                WHEN OTHER                                                      
                     DISPLAY 'ERROR WHILE READING K060, FS -> '                 
                                        K060-FILE-STATUS                        
            END-EVALUATE.                                                       
                                                                                
       7200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8000-PRINT-REPORT-B.                                                     
      *-------------------------------------------------------------            
            IF WS-LINE-CNT-B > 55                                               
               PERFORM 8100-HEADING  THRU 8100-EXIT                             
            END-IF.                                                             
                                                                                
            ADD      01              TO WS-REGN-CNT-B.                          
                                                                                
            IF WS-REGN-CNT-B = 01                                               
               MOVE WS-F558-NUM-REGN(WS-F558-SUB) TO L639B-REGN-NO              
               ADD       01             TO WS-SERNO-B                           
               MOVE WS-SERNO-B          TO L639B-SERNO                          
               MOVE WS-HSE-GRANT        TO L639B-HSE-GRANT                      
            ELSE                                                                
               MOVE SPACES              TO L639B-REGN-NO                        
               MOVE SPACES              TO L639B-SERNO                          
                                           L639B-HSE-GRANT                      
            END-IF.                                                             
                                                                                
            MOVE WS-F558-NUM-NRIC(WS-F558-SUB) TO L639B-NRIC-NO.                
            MOVE WS-F558-NUM-HDB-REF-SMS(WS-F558-SUB) TO L639B-HDB-SMS.         
            MOVE WS-F558-NUM-HDB-REF-RSL(WS-F558-SUB) TO L639B-HDB-RSL.         
            MOVE WS-F558-CDE-HOUSEHOLD(WS-F558-SUB) TO L639B-HHTY.              
            MOVE WS-F558-NUM-MTH-RESIDE(WS-F558-SUB) TO L639B-MTH-RESIDE.       
            MOVE WS-F558-NUM-APPLN(WS-F558-SUB) TO L639B-APPLN.         .       
            MOVE WS-F558-NUM-SUBLET-SMS(WS-F558-SUB)                            
                                              TO L639B-MTH-SUBLET-SMS.          
            MOVE WS-F558-NUM-SUBLET-RSL(WS-F558-SUB)                            
                                               TO L639B-MTH-SUBLET-RSL.         
                                                                                
            MOVE  SPACES                TO   K060-KEY-FLD.                      
            MOVE  WS-F558-NUM-MARITAL-STATUS(WS-F558-SUB) TO K060-CODE.         
            MOVE   21                   TO   K060-SERIAL-NO.                    
            PERFORM 7200-DECODE-DESC    THRU 7200-EXIT.                         
            MOVE  WS-DESC               TO L639B-MARITAL.                       
                                                                                
            MOVE  SPACES                TO   K060-KEY-FLD.                      
            MOVE  WS-F558-CDE-RELATIONSHIP(WS-F558-SUB) TO K060-CODE.           
            MOVE   35                   TO   K060-SERIAL-NO.                    
            PERFORM 7200-DECODE-DESC    THRU 7200-EXIT.                         
            MOVE WS-DESC                TO   L639B-RELATION.                    
            MOVE WS-F558-CDE-SALES-TYPE-SMS(WS-F558-SUB)                        
                                        TO L639B-SALE-TYPE.                     
            MOVE WS-F558-DTE-FLAT-SOLD-SMS(WS-F558-SUB)                         
                                        TO L639B-SOLD-DATE.                     
            IF L639B-SERNO = SPACES                                             
               ADD      01              TO WS-LINE-CNT-B                        
               WRITE P13L639B-REC FROM L639B-DET-LINE AFTER 1                   
            ELSE                                                                
               ADD      02              TO WS-LINE-CNT-B                        
               WRITE P13L639B-REC FROM L639B-DET-LINE AFTER 2.                  
                                                                                
       8000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8100-HEADING.                                                            
      *-------------------------------------------------------------            
            ADD      01        TO WS-PAGENO-B.                                  
            MOVE WS-PAGENO-B   TO WS-EDITED-PAGENO.                             
            MOVE     01        TO WS-LINE-CNT-B.                                
            WRITE  P13L639B-REC FROM L639A-TOP-TITLE1 AFTER PAGE.               
            WRITE  P13L639B-REC FROM L639B-TOP-TITLE2 AFTER 2.                  
            WRITE  P13L639B-REC FROM L639B-HEADER-LINE AFTER 2.                 
            ADD      06        TO WS-LINE-CNT-B.                                
                                                                                
       8100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8500-PRINT-REPORT-C.                                                     
      *-------------------------------------------------------------            
            IF WS-LINE-CNT-C > 55                                               
               PERFORM 8600-HEADING  THRU 8600-EXIT                             
            END-IF.                                                             
                                                                                
            ADD      01              TO WS-REGN-CNT-C.                          
                                                                                
            IF WS-REGN-CNT-C = 01                                               
               MOVE WS-F558-NUM-REGN(WS-F558-SUB) TO L639C-REGN-NO              
               ADD       01             TO WS-SERNO-C                           
               MOVE WS-SERNO-C          TO L639C-SERNO                          
               MOVE WS-HSE-GRANT        TO L639C-HSE-GRANT                      
            ELSE                                                                
               MOVE SPACES              TO L639C-REGN-NO                        
               MOVE SPACES              TO L639C-SERNO                          
                                           L639C-HSE-GRANT                      
            END-IF.                                                             
                                                                                
            MOVE WS-F558-NUM-NRIC(WS-F558-SUB) TO L639C-NRIC-NO.                
            MOVE WS-F558-NUM-HDB-REF-SMS(WS-F558-SUB) TO L639C-HDB-SMS.         
            MOVE WS-F558-NUM-HDB-REF-RSL(WS-F558-SUB) TO L639C-HDB-RSL.         
            MOVE WS-F558-CDE-HOUSEHOLD(WS-F558-SUB) TO L639C-HHTY.              
            MOVE WS-F558-NUM-MTH-RESIDE(WS-F558-SUB) TO L639C-MTH-RESIDE.       
            MOVE WS-F558-NUM-APPLN(WS-F558-SUB) TO L639C-APPLN.         .       
            MOVE WS-F558-NUM-SUBLET-SMS(WS-F558-SUB)                            
                                              TO L639C-MTH-SUBLET-SMS.          
            MOVE WS-F558-NUM-SUBLET-RSL(WS-F558-SUB)                            
                                               TO L639C-MTH-SUBLET-RSL.         
                                                                                
            MOVE  SPACES                TO   K060-KEY-FLD.                      
            MOVE  WS-F558-NUM-MARITAL-STATUS(WS-F558-SUB) TO K060-CODE.         
            MOVE   21                   TO   K060-SERIAL-NO.                    
            PERFORM 7200-DECODE-DESC    THRU 7200-EXIT.                         
            MOVE  WS-DESC               TO L639C-MARITAL.                       
                                                                                
            MOVE  SPACES                TO   K060-KEY-FLD.                      
            MOVE  WS-F558-CDE-RELATIONSHIP(WS-F558-SUB) TO K060-CODE.           
            MOVE   35                   TO   K060-SERIAL-NO.                    
            PERFORM 7200-DECODE-DESC    THRU 7200-EXIT.                         
            MOVE WS-DESC                TO   L639C-RELATION.                    
            MOVE WS-F558-CDE-SALES-TYPE-SMS(WS-F558-SUB)                        
                                        TO L639C-SALE-TYPE.                     
            MOVE WS-F558-DTE-FLAT-SOLD-SMS(WS-F558-SUB)                         
                                        TO L639C-SOLD-DATE.                     
            IF L639C-SERNO = SPACES                                             
               ADD      01              TO WS-LINE-CNT-C                        
               WRITE P13L639C-REC FROM L639C-DET-LINE AFTER 1                   
            ELSE                                                                
               ADD      02              TO WS-LINE-CNT-C                        
               WRITE P13L639C-REC FROM L639C-DET-LINE AFTER 2.                  
                                                                                
       8500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8600-HEADING.                                                            
      *-------------------------------------------------------------            
            ADD      01        TO WS-PAGENO-C.                                  
            MOVE WS-PAGENO-C   TO WS-EDITED-PAGENO.                             
            MOVE     01        TO WS-LINE-CNT-C.                                
            WRITE  P13L639C-REC FROM L639A-TOP-TITLE1 AFTER PAGE.               
            WRITE  P13L639C-REC FROM L639C-TOP-TITLE3 AFTER 2.                  
            WRITE  P13L639C-REC FROM L639C-HEADER-LINE AFTER 2.                 
            ADD      06        TO WS-LINE-CNT-C.                                
                                                                                
       8600-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       900-CLOSE-ROUTINE.                                                       
      *-------------------------------------------------------------            
                                                                                
           IF K060-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'ERROR CLOSING BP13K060, STATUS ' K060-FILE-STATUS        
              MOVE K060-FILE-STATUS      TO RETURN-CODE.                        
                                                                                
           DISPLAY '                      '.                                    
           DISPLAY 'BP13C639              DATE : ' WS-DATE.                     
           DISPLAY '-------------------------------------'.                     
           DISPLAY 'NO OF RECORDS READ    :'                                    
           DISPLAY '   BP13F500           : '  WS-READ-F500.                    
           DISPLAY '   BP13F558           : '  WS-READ-F558.                    
           DISPLAY 'NO OF RECORDS WRITTEN :'                                    
           DISPLAY '   P13F558A           : ' WS-WRITE-F558A.                   
           DISPLAY '   P13F558B           : ' WS-WRITE-F558B.                   
           DISPLAY 'NO MATCH              : ' WS-MATCH.                         
           DISPLAY 'NO UNMATCH -BP13F500  : ' WS-UNMATCH-F500.                  
           DISPLAY 'NO UNMATCH -BP13F558  : ' WS-UNMATCH-F558.                  
           DISPLAY '                      '.                                    
                                                                                
           CLOSE BP13F500                                                       
                 BP13F558                                                       
                 BP13F713                                                       
                 P13F558A                                                       
                 P13F558B                                                       
                 BP13K060                                                       
                 P13L639A                                                       
                 P13L639B                                                       
                 P13L639C.                                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
