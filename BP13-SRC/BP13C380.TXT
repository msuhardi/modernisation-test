      *------------------------------------------------------------*            
       IDENTIFICATION DIVISION.                                                 
      *------------------------------------------------------------*            
       PROGRAM-ID.   BP13C380.                                                  
      *AUTHOR.       SK.                                                        
      *DATE-WRITTEN. 20/07/2004.                                                
      *------------------------------------------------------------*            
      *                SYSTEM OF COMMITMENT  (BP13)                *            
      *------------------------------------------------------------*            
      *                                                            *            
      *  OBJECTIVE   : 1. OUTPUT TRANSFEROR REC FOUND IN BP13K671  *            
      *                   TO BP13K677 (FIN HISTORY FILE)           *            
      *                2. UPDATE BANK ORIGINATION FILE (BP13K671)  *            
      *                   WITH NEW TRANSFEREE FROM BP13F880        *            
      *                                                            *            
      *  INPUT FILES : 1.  BP13F880  -  SUBTRANSFOR FILE           *            
      *                2.  BP13K671  -  BANK ORIGINATION FILE      *            
      *                3.  BP13K677  -  ORIGINATION HISTORY FILE   *            
      *------------------------------------------------------------*            
      * CHG REQ# BY   DATE      DESCRIPTION                        *            
      * -------- ---- --------  -----------------------------------*            
      * BP132526 SK   20/07/04  NEW PROGRAM.                       *            
      *------------------------------------------------------------*            
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *------------------------------------------------------------*            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
      *------------------------------------------------------------*            
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *------------------------------------------------------------*            
                                                                                
           SELECT BP13F880 ASSIGN TO BP13F880.                                  
                                                                                
           SELECT BP13K671 ASSIGN TO BP13K671                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K671-KEY-FLD                               
                  FILE STATUS     IS WS-K671-STATUS.                            
                                                                                
           SELECT BP13K677 ASSIGN TO BP13K677                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K677-KEY-FLD                               
                  FILE STATUS     IS WS-K677-STATUS.                            
                                                                                
      *------------------------------------------------------------*            
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *------------------------------------------------------------*            
                                                                                
       FD   BP13F880                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            BLOCK CONTAINS     0 RECORDS                                        
            RECORDING MODE    IS F                                              
            LABEL RECORDS    ARE STANDARD.                                      
                                                                                
       COPY BP13F880.                                                           
                                                                                
       FD   BP13K671                                                            
            RECORD CONTAINS 3000 CHARACTERS.                                    
                                                                                
       COPY BP13K671.                                                           
                                                                                
       FD   BP13K677                                                            
            RECORD CONTAINS 3500 CHARACTERS.                                    
                                                                                
       COPY BP13K677.                                                           
                                                                                
      *------------------------------------------------------------*            
       WORKING-STORAGE SECTION.                                                 
      *------------------------------------------------------------*            
                                                                                
       01  WORK-FILE-VARS.                                                      
           05  WS-K671-FOUND                  PIC X(01)  VALUE 'N'.             
           05  WS-F880-EOF                    PIC X(01)  VALUE 'N'.             
           05  WS-K677-EOF                    PIC X(01)  VALUE 'N'.             
                                                                                
           05  WS-F880-READ                   PIC 9(08)  VALUE 0.               
           05  WS-K671-UPDATE                 PIC 9(08)  VALUE 0.               
           05  WS-K677-WRITE                  PIC 9(08)  VALUE 0.               
                                                                                
           05  WS-K671-STATUS                 PIC 9(02)  VALUE 0.               
           05  WS-K677-STATUS                 PIC 9(02)  VALUE 0.               
                                                                                
       01  WS-OTHER-VARS.                                                       
           05  WS-K677-SEQ                    PIC 9(02)  VALUE 0.               
           05  WS-POS1                        PIC 9(01)  VALUE 0.               
           05  WS-POS2                        PIC 9(01)  VALUE 0.               
           05  WS-K671-REC                    PIC X(3000) VALUE SPACES.         
                                                                                
           05  WS-REFUND-TABLE.                                                 
               10 WS-REFUND-TABLE1            OCCURS 4 TIMES.                   
                  15  WS-AMT-RFND-SOC-CPF     PIC 9(7)V99 VALUE ZEROS.          
                  15  WS-AMT-RFND-BANK-CPF    PIC 9(7)V99 VALUE ZEROS.          
                                                                                
       01  WORK-REC-VARS.                                                       
           05  WS-F671-REC.                                                     
               10 FILLER                        PIC X(19).                      
               10 WS-F671-CPFNO                 OCCURS 4 TIMES.                 
                  15 WS-F671-CPF-NO             PIC X(09).                      
               10 WS-F671-AMT-CPFAVAIL          OCCURS 4 TIMES.                 
                  15 WS-F671-AMT-CPF-AVAIL      PIC S9(7)V99.                   
               10 WS-F671-AMT-RETIRE            OCCURS 4 TIMES.                 
                  15 WS-F671-AMT-CPF-RETIRE     PIC S9(6)V99.                   
               10 FILLER                        PIC X(49).                      
               10 WS-F671-SOCCPF                OCCURS 4 TIMES.                 
                  15 WS-F671-SOC-CPF            PIC S9(7)V99.                   
                  15 WS-F671-SOC-CPF-RETIRE     PIC S9(6)V99.                   
                  15 WS-F671-SOC-CPF-PAID       PIC S9(7)V99.                   
               10 FILLER                        PIC X(32).                      
               10 WS-F671-LUMPCPF               OCCURS 4 TIMES.                 
                  15 WS-F671-LUMP-CPF           PIC S9(7)V99.                   
               10 WS-F671-LUMPCPF-RETIRE        OCCURS 4 TIMES.                 
                  15 WS-F671-LUMP-CPF-RETIRE    PIC S9(7)V99.                   
               10 WS-F671-LUMPCPF-PAID          OCCURS 4 TIMES.                 
                  15 WS-F671-LUMP-CPF-PAID      PIC S9(7)V99.                   
               10 FILLER                        PIC X(27).                      
               10 WS-F671-CPF-BALANCE           OCCURS 4 TIMES.                 
                  15 WS-F671-CPF-BAL            PIC S9(7)V99.                   
               10 WS-F671-CPF-RETIRE-BALANCE    OCCURS 4 TIMES.                 
                  15 WS-F671-CPF-RETIRE-BAL     PIC S9(7)V99.                   
               10 FILLER                        PIC X(23).                      
               10 WS-F671-LSE-STAMP             OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-STAMP-CPF      PIC S9(5)V99.                   
               10 WS-F671-LSE-STAMPPAID         OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-STAMP-CPF-PAID PIC S9(5)V99.                   
               10 FILLER                        PIC X(30).                      
               10 WS-F671-SALE-CONNY            OCCURS 4 TIMES.                 
                  15 WS-F671-SALE-CONVY-CPF     PIC S9(5)V99.                   
               10 WS-F671-SALE-CONNYPAID        OCCURS 4 TIMES.                 
                  15 WS-F671-SALE-CONVY-CPF-PAID PIC S9(5)V99.                  
               10 FILLER                        PIC X(30).                      
               10 WS-F671-MORT-CONNY            OCCURS 4 TIMES.                 
                  15 WS-F671-MORT-CONVY-CPF     PIC S9(5)V99.                   
               10 WS-F671-MORT-CONNYPAID        OCCURS 4 TIMES.                 
                  15 WS-F671-MORT-CONVY-CPF-PAID PIC S9(5)V99.                  
               10 FILLER                        PIC X(19).                      
               10 WS-F671-SRVY-FEE              OCCURS 4 TIMES.                 
                  15 WS-F671-SRVY-FEE-CPF       PIC S9(3)V99.                   
               10 WS-F671-SRVY-FEEPAID          OCCURS 4 TIMES.                 
                  15 WS-F671-SRVY-FEE-CPF-PAID  PIC S9(3)V99.                   
               10 FILLER                        PIC X(19).                      
               10 WS-F671-LSE-ESCR              OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-ESCR-CPF       PIC S9(3)V99.                   
               10 WS-F671-LSE-ESCRPAID          OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-ESCR-CPF-PAID  PIC S9(3)V99.                   
               10 FILLER                        PIC X(19).                      
               10 WS-F671-LSE-REGN              OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-REGN-CPF       PIC S9(3)V99.                   
               10 WS-F671-LSE-REGNPAID          OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-REGN-CPF-PAID  PIC S9(3)V99.                   
               10 FILLER                        PIC X(15).                      
               10 WS-F671-CAVTREGN              OCCURS 4 TIMES.                 
                  15 WS-F671-CAV-REGN-CPF       PIC S9(3)V99.                   
               10 WS-F671-CAV-REGNPAID          OCCURS 4 TIMES.                 
                  15 WS-F671-CAV-REGN-CPF-PAID  PIC S9(3)V99.                   
               10 FILLER                        PIC X(21).                      
               10 WS-F671-SOLCPF                OCCURS 4 TIMES.                 
                  15 WS-F671-SOL-CPF            PIC S9(5)V99.                   
               10 WS-F671-SOL-CPFPAID           OCCURS 4 TIMES.                 
                  15 WS-F671-SOL-CPF-PAID       PIC S9(5)V99.                   
               10 WS-F671-DTE-VALUE             OCCURS 4 TIMES.                 
                  15 WS-F671-DTE-VALUE-CPF      PIC X(08).                      
               10 FILLER                        PIC X(08).                      
               10 WS-F671-CHQCPF1               OCCURS 3 TIMES.                 
                  15 WS-F671-CHQ-CPF1           PIC X(40).                      
               10 WS-F671-CHQCPF2               OCCURS 3 TIMES.                 
                  15 WS-F671-CHQ-CPF2           PIC X(40).                      
               10 WS-F671-CHQCPF3               OCCURS 3 TIMES.                 
                  15 WS-F671-CHQ-CPF3           PIC X(40).                      
               10 WS-F671-CHQCPF4               OCCURS 3 TIMES.                 
                  15 WS-F671-CHQ-CPF4           PIC X(40).                      
               10 WS-F671-SOC-CPFBAL            OCCURS 4 TIMES.                 
                  15 WS-F671-SOC-CPF-BAL        PIC S9(7)V99.                   
               10 WS-F671-LMP-CPFBAL            OCCURS 4 TIMES.                 
                  15 WS-F671-LMP-CPF-BAL        PIC S9(7)V99.                   
               10 WS-F671-LSE-STMPBAL           OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-CPF-STAMP-BAL  PIC S9(5)V99.                   
               10 WS-F671-SALE-CONVYBAL         OCCURS 4 TIMES.                 
                  15 WS-F671-SALE-CPF-CONVY-BAL PIC S9(5)V99.                   
               10 WS-F671-MORT-CONVYBAL         OCCURS 4 TIMES.                 
                  15 WS-F671-MORT-CPF-CONVY-BAL PIC S9(5)V99.                   
               10 WS-F671-SRVY-FEEBAL           OCCURS 4 TIMES.                 
                  15 WS-F671-SRVY-CPF-FEE-BAL   PIC S9(3)V99.                   
               10 WS-F671-LSE-ESCRBAL           OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-ESCR-CPF-BAL   PIC S9(3)V99.                   
               10 WS-F671-LSE-REGNBAL           OCCURS 4 TIMES.                 
                  15 WS-F671-LSE-REGN-CPF-BAL   PIC S9(3)V99.                   
               10 WS-F671-CAV-REGNBAL           OCCURS 4 TIMES.                 
                  15 WS-F671-CAV-REGN-CPF-BAL   PIC S9(3)V99.                   
               10 WS-F671-SOL-CPFBAL            OCCURS 4 TIMES.                 
                  15 WS-F671-SOL-CPF-BAL        PIC S9(5)V99.                   
               10 FILLER                        PIC X(28).                      
               10 WS-F671-REGN-DEPOSIT          OCCURS 4 TIMES.                 
                  15 WS-F671-REGN-CPF-DEPOSIT   PIC S9(5)V99.                   
               10 FILLER                        PIC X(85).                      
               10 FILLER                        PIC X(19).                      
               10 WS-F671-FRESH-CVCPF           OCCURS 4 TIMES.                 
                  15 WS-F671-FRESH-CV-CPF       PIC S9(3)V99.                   
               10 WS-F671-FRESH-CVCPF-PD        OCCURS 4 TIMES.                 
                  15 WS-F671-FRESH-CV-CPF-PAID  PIC S9(3)V99.                   
               10 WS-F671-FRESH-CVCPF-BAL       OCCURS 4 TIMES.                 
                  15 WS-F671-FRESH-CV-CPF-BAL   PIC S9(3)V99.                   
               10 FILLER                        PIC X(05).                      
               10 WS-F671-BYR-WCVCPF            OCCURS 4 TIMES.                 
                  15 WS-F671-BYR-WCV-CPF        PIC S9(3)V99.                   
               10 WS-F671-BYR-WCVCPF-PD         OCCURS 4 TIMES.                 
                  15 WS-F671-BYR-WCV-CPF-PAID   PIC S9(3)V99.                   
               10 WS-F671-BYR-WCVCPF-BAL        OCCURS 4 TIMES.                 
                  15 WS-F671-BYR-WCV-CPF-BAL    PIC S9(3)V99.                   
               10 FILLER                        PIC X(05).                      
               10 WS-F671-BNK-WCVCPF            OCCURS 4 TIMES.                 
                  15 WS-F671-BNK-WCV-CPF        PIC S9(3)V99.                   
               10 WS-F671-BNK-WCVCPF-PD         OCCURS 4 TIMES.                 
                  15 WS-F671-BNK-WCV-CPF-PAID   PIC S9(3)V99.                   
               10 WS-F671-BNK-WCVCPF-BAL        OCCURS 4 TIMES.                 
                  15 WS-F671-BNK-WCV-CPF-BAL    PIC S9(3)V99.                   
               10 FILLER                        PIC X(07).                      
               10 WS-F671-SBTR-SFCPF            OCCURS 4 TIMES.                 
                  15 WS-F671-SBTR-SF-CPF        PIC S9(5)V99.                   
               10 WS-F671-SBTR-SFCPF-PAID       OCCURS 4 TIMES.                 
                  15 WS-F671-SBTR-SF-CPF-PAID   PIC S9(5)V99.                   
               10 WS-F671-SBTR-SFCPF-BAL        OCCURS 4 TIMES.                 
                  15 WS-F671-SBTR-SF-CPF-BAL    PIC S9(5)V99.                   
               10 FILLER                        PIC X(07).                      
               10 WS-F671-SBTR-CFCPF            OCCURS 4 TIMES.                 
                  15 WS-F671-SBTR-CF-CPF        PIC S9(5)V99.                   
               10 WS-F671-SBTR-CFCPF-PAID       OCCURS 4 TIMES.                 
                  15 WS-F671-SBTR-CF-CPF-PAID   PIC S9(5)V99.                   
               10 WS-F671-SBTR-CFCPF-BAL        OCCURS 4 TIMES.                 
                  15 WS-F671-SBTR-CF-CPF-BAL    PIC S9(5)V99.                   
               10 FILLER                        PIC X(609).                     
                                                                                
           05  WS-F671A-REC.                                                    
               10 FILLER                        PIC X(19).                      
               10 WS-F671A-CPFNO                OCCURS 4 TIMES.                 
                  15 WS-F671A-CPF-NO            PIC X(09).                      
               10 WS-F671A-AMT-CPFAVAIL         OCCURS 4 TIMES.                 
                  15 WS-F671A-AMT-CPF-AVAIL     PIC S9(7)V99.                   
               10 WS-F671A-AMT-RETIRE           OCCURS 4 TIMES.                 
                  15 WS-F671A-AMT-CPF-RETIRE    PIC S9(6)V99.                   
               10 FILLER                        PIC X(49).                      
               10 WS-F671A-SOCCPF               OCCURS 4 TIMES.                 
                  15 WS-F671A-SOC-CPF           PIC S9(7)V99.                   
                  15 WS-F671A-SOC-CPF-RETIRE    PIC S9(6)V99.                   
                  15 WS-F671A-SOC-CPF-PAID      PIC S9(7)V99.                   
               10 FILLER                        PIC X(32).                      
               10 WS-F671A-LUMPCPF              OCCURS 4 TIMES.                 
                  15 WS-F671A-LUMP-CPF          PIC S9(7)V99.                   
               10 WS-F671A-LUMPCPF-RETIRE       OCCURS 4 TIMES.                 
                  15 WS-F671A-LUMP-CPF-RETIRE   PIC S9(7)V99.                   
               10 WS-F671A-LUMPCPF-PAID         OCCURS 4 TIMES.                 
                  15 WS-F671A-LUMP-CPF-PAID     PIC S9(7)V99.                   
               10 FILLER                        PIC X(27).                      
               10 WS-F671A-CPF-BALANCE          OCCURS 4 TIMES.                 
                  15 WS-F671A-CPF-BAL           PIC S9(7)V99.                   
               10 WS-F671A-CPF-RETIRE-BALANCE   OCCURS 4 TIMES.                 
                  15 WS-F671A-CPF-RETIRE-BAL    PIC S9(7)V99.                   
               10 FILLER                        PIC X(23).                      
               10 WS-F671A-LSE-STAMP            OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-STAMP-CPF     PIC S9(5)V99.                   
               10 WS-F671A-LSE-STAMPPAID        OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-STAMP-CPF-PAID PIC S9(5)V99.                  
               10 FILLER                        PIC X(30).                      
               10 WS-F671A-SALE-CONNY           OCCURS 4 TIMES.                 
                  15 WS-F671A-SALE-CONVY-CPF    PIC S9(5)V99.                   
               10 WS-F671A-SALE-CONNYPAID       OCCURS 4 TIMES.                 
                  15 WS-F671A-SALE-CONVY-CPF-PAID PIC S9(5)V99.                 
               10 FILLER                        PIC X(30).                      
               10 WS-F671A-MORT-CONNY           OCCURS 4 TIMES.                 
                  15 WS-F671A-MORT-CONVY-CPF    PIC S9(5)V99.                   
               10 WS-F671A-MORT-CONNYPAID       OCCURS 4 TIMES.                 
                  15 WS-F671A-MORT-CONVY-CPF-PAID PIC S9(5)V99.                 
               10 FILLER                        PIC X(19).                      
               10 WS-F671A-SRVY-FEE             OCCURS 4 TIMES.                 
                  15 WS-F671A-SRVY-FEE-CPF      PIC S9(3)V99.                   
               10 WS-F671A-SRVY-FEEPAID         OCCURS 4 TIMES.                 
                  15 WS-F671A-SRVY-FEE-CPF-PAID PIC S9(3)V99.                   
               10 FILLER                        PIC X(19).                      
               10 WS-F671A-LSE-ESCR             OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-ESCR-CPF      PIC S9(3)V99.                   
               10 WS-F671A-LSE-ESCRPAID         OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-ESCR-CPF-PAID PIC S9(3)V99.                   
               10 FILLER                        PIC X(19).                      
               10 WS-F671A-LSE-REGN             OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-REGN-CPF      PIC S9(3)V99.                   
               10 WS-F671A-LSE-REGNPAID         OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-REGN-CPF-PAID PIC S9(3)V99.                   
               10 FILLER                        PIC X(15).                      
               10 WS-F671A-CAVTREGN             OCCURS 4 TIMES.                 
                  15 WS-F671A-CAV-REGN-CPF      PIC S9(3)V99.                   
               10 WS-F671A-CAV-REGNPAID         OCCURS 4 TIMES.                 
                  15 WS-F671A-CAV-REGN-CPF-PAID PIC S9(3)V99.                   
               10 FILLER                        PIC X(21).                      
               10 WS-F671A-SOLCPF               OCCURS 4 TIMES.                 
                  15 WS-F671A-SOL-CPF           PIC S9(5)V99.                   
               10 WS-F671A-SOL-CPFPAID          OCCURS 4 TIMES.                 
                  15 WS-F671A-SOL-CPF-PAID      PIC S9(5)V99.                   
               10 WS-F671A-DTE-VALUE            OCCURS 4 TIMES.                 
                  15 WS-F671A-DTE-VALUE-CPF     PIC X(08).                      
               10 FILLER                        PIC X(08).                      
               10 WS-F671A-CHQCPF1              OCCURS 3 TIMES.                 
                  15 WS-F671A-CHQ-CPF1          PIC X(40).                      
               10 WS-F671A-CHQCPF2              OCCURS 3 TIMES.                 
                  15 WS-F671A-CHQ-CPF2          PIC X(40).                      
               10 WS-F671A-CHQCPF3              OCCURS 3 TIMES.                 
                  15 WS-F671A-CHQ-CPF3          PIC X(40).                      
               10 WS-F671A-CHQCPF4              OCCURS 3 TIMES.                 
                  15 WS-F671A-CHQ-CPF4          PIC X(40).                      
               10 WS-F671A-SOC-CPFBAL           OCCURS 4 TIMES.                 
                  15 WS-F671A-SOC-CPF-BAL       PIC S9(7)V99.                   
               10 WS-F671A-LMP-CPFBAL           OCCURS 4 TIMES.                 
                  15 WS-F671A-LMP-CPF-BAL       PIC S9(7)V99.                   
               10 WS-F671A-LSE-STMPBAL          OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-CPF-STAMP-BAL PIC S9(5)V99.                   
               10 WS-F671A-SALE-CONVYBAL        OCCURS 4 TIMES.                 
                  15 WS-F671A-SALE-CPF-CONVY-BAL PIC S9(5)V99.                  
               10 WS-F671A-MORT-CONVYBAL        OCCURS 4 TIMES.                 
                  15 WS-F671A-MORT-CPF-CONVY-BAL PIC S9(5)V99.                  
               10 WS-F671A-SRVY-FEEBAL          OCCURS 4 TIMES.                 
                  15 WS-F671A-SRVY-CPF-FEE-BAL  PIC S9(3)V99.                   
               10 WS-F671A-LSE-ESCRBAL          OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-ESCR-CPF-BAL  PIC S9(3)V99.                   
               10 WS-F671A-LSE-REGNBAL          OCCURS 4 TIMES.                 
                  15 WS-F671A-LSE-REGN-CPF-BAL  PIC S9(3)V99.                   
               10 WS-F671A-CAV-REGNBAL          OCCURS 4 TIMES.                 
                  15 WS-F671A-CAV-REGN-CPF-BAL  PIC S9(3)V99.                   
               10 WS-F671A-SOL-CPFBAL           OCCURS 4 TIMES.                 
                  15 WS-F671A-SOL-CPF-BAL       PIC S9(5)V99.                   
               10 FILLER                        PIC X(28).                      
               10 WS-F671A-REGN-DEPOSIT         OCCURS 4 TIMES.                 
                  15 WS-F671A-REGN-CPF-DEPOSIT  PIC S9(5)V99.                   
               10 FILLER                        PIC X(85).                      
               10 FILLER                        PIC X(19).                      
               10 WS-F671A-FRESH-CVCPF          OCCURS 4 TIMES.                 
                  15 WS-F671A-FRESH-CV-CPF      PIC S9(3)V99.                   
               10 WS-F671A-FRESH-CVCPF-PD       OCCURS 4 TIMES.                 
                  15 WS-F671A-FRESH-CV-CPF-PAID PIC S9(3)V99.                   
               10 WS-F671A-FRESH-CVCPF-BAL      OCCURS 4 TIMES.                 
                  15 WS-F671A-FRESH-CV-CPF-BAL  PIC S9(3)V99.                   
               10 FILLER                        PIC X(05).                      
               10 WS-F671A-BYR-WCVCPF           OCCURS 4 TIMES.                 
                  15 WS-F671A-BYR-WCV-CPF       PIC S9(3)V99.                   
               10 WS-F671A-BYR-WCVCPF-PD        OCCURS 4 TIMES.                 
                  15 WS-F671A-BYR-WCV-CPF-PAID  PIC S9(3)V99.                   
               10 WS-F671A-BYR-WCVCPF-BAL       OCCURS 4 TIMES.                 
                  15 WS-F671A-BYR-WCV-CPF-BAL   PIC S9(3)V99.                   
               10 FILLER                        PIC X(05).                      
               10 WS-F671A-BNK-WCVCPF           OCCURS 4 TIMES.                 
                  15 WS-F671A-BNK-WCV-CPF       PIC S9(3)V99.                   
               10 WS-F671A-BNK-WCVCPF-PD        OCCURS 4 TIMES.                 
                  15 WS-F671A-BNK-WCV-CPF-PAID  PIC S9(3)V99.                   
               10 WS-F671A-BNK-WCVCPF-BAL       OCCURS 4 TIMES.                 
                  15 WS-F671A-BNK-WCV-CPF-BAL   PIC S9(3)V99.                   
               10 FILLER                        PIC X(07).                      
               10 WS-F671A-SBTR-SFCPF           OCCURS 4 TIMES.                 
                  15 WS-F671A-SBTR-SF-CPF       PIC S9(5)V99.                   
               10 WS-F671A-SBTR-SFCPF-PAID      OCCURS 4 TIMES.                 
                  15 WS-F671A-SBTR-SF-CPF-PAID  PIC S9(5)V99.                   
               10 WS-F671A-SBTR-SFCPF-BAL       OCCURS 4 TIMES.                 
                  15 WS-F671A-SBTR-SF-CPF-BAL   PIC S9(5)V99.                   
               10 FILLER                        PIC X(07).                      
               10 WS-F671A-SBTR-CFCPF           OCCURS 4 TIMES.                 
                  15 WS-F671A-SBTR-CF-CPF       PIC S9(5)V99.                   
               10 WS-F671A-SBTR-CFCPF-PAID      OCCURS 4 TIMES.                 
                  15 WS-F671A-SBTR-CF-CPF-PAID  PIC S9(5)V99.                   
               10 WS-F671A-SBTR-CFCPF-BAL       OCCURS 4 TIMES.                 
                  15 WS-F671A-SBTR-CF-CPF-BAL   PIC S9(5)V99.                   
               10 FILLER                        PIC X(609).                     
                                                                                
       01 WS-F880-REC.                                                          
           05 FILLER                           PIC X(35).                       
           05 WS-F880-TROR-INFO1 OCCURS 4.                                      
              10 WS-F880-NUM-NRIC-TROR         PIC X(9).                        
              10 WS-F880-NUM-SHR-TROR          PIC X(3).                        
              10 WS-F880-NUM-DEMISE-TROR       PIC X.                           
           05 FILLER                           PIC X(11).                       
           05 WS-F880-TREE-INFO1 OCCURS 4.                                      
              10 WS-F880-NUM-NRIC-TREE         PIC X(9).                        
              10 WS-F880-CDE-PR-TAG-TREE       PIC X.                           
              10 WS-F880-NUM-SHR-TREE          PIC X(3).                        
           05 FILLER                           PIC X(218).                      
           05 WS-F880-LEASE-STAMP OCCURS 4.                                     
              10 WS-F880-AMT-LS-CPF            PIC S9(5)V99.                    
           05 FILLER                           PIC X(22).                       
           05 WS-F880-CONV-FEE OCCURS 4.                                        
              10 WS-F880-AMT-CONV-CPF          PIC S9(5)V99.                    
           05 FILLER                           PIC X(18).                       
           05 WS-F880-SOC-PAID OCCURS 4.                                        
              10 WS-F880-AMT-SOC-PAID-CPF      PIC S9(7)V99.                    
           05 FILLER                           PIC X(09).                       
           05 WS-F880-CD-PAID OCCURS 4.                                         
              10 WS-F880-AMT-CD-CPF            PIC S9(7)V99.                    
           05 FILLER                           PIC X(18).                       
           05 WS-F880-NEW-CD-REQ OCCURS 4.                                      
              10 WS-F880-NEW-CD-REQ-CPF        PIC S9(7)V99.                    
           05 FILLER                           PIC X(09).                       
           05 WS-F880-REFUND OCCURS 4.                                          
              10 WS-F880-AMT-REFUND-CPF        PIC S9(7)V99.                    
           05 FILLER                           PIC X(35).                       
           05 WS-F880-REFUND-INTEREST OCCURS 4.                                 
              10 WS-F880-AMT-REFUND-INT-CPF    PIC S9(5)V99.                    
           05 FILLER                           PIC X(9).                        
           05 WS-F880-TOPUP-CD-CGO-PA OCCURS 4.                                 
              10 WS-F880-AMT-TOPUP-CD-CGOPA-CPF PIC S9(7)V99.                   
           05 FILLER                           PIC X(7).                        
           05 WS-F880-TOPUP-INTEREST OCCURS 4.                                  
              10 WS-F880-AMT-TOPUP-INT-CPF     PIC S9(5)V99.                    
           05 FILLER                           PIC X(09).                       
           05 WS-F880-TOPUP-CD OCCURS 4.                                        
              10 WS-F880-AMT-TOPUP-CD-CPF      PIC S9(7)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-TOPUP-SOCA-SF OCCURS 4.                                   
              10 WS-F880-AMT-TOPUP-SOCA-SF-CPF PIC S9(5)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-TOPUP-SOCA-CF OCCURS 4.                                   
              10 WS-F880-AMT-TOPUP-SOCA-CF-CPF PIC S9(5)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-TOPUP-SBTR-SF OCCURS 4.                                   
              10 WS-F880-AMT-TOPUP-SBTR-SF-CPF PIC S9(5)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-TOPUP-SBTR-CF OCCURS 4.                                   
              10 WS-F880-AMT-TOPUP-SBTR-CF-CPF PIC S9(5)V99.                    
           05 FILLER                           PIC X(15).                       
           05 WS-F880-LS-TREE OCCURS 4.                                         
              10 WS-F880-AMT-LS-CPF-TREE       PIC S9(5)V99.                    
           05 FILLER                           PIC X(22).                       
           05 WS-F880-CONV-TREE OCCURS 4.                                       
              10 WS-F880-AMT-CONV-CPF-TREE     PIC S9(5)V99.                    
           05 FILLER                           PIC X(260).                      
           05 WS-F880-CAVEAT OCCURS 4.                                          
              10 WS-F880-AMT-CAVEAT-CPF        PIC S9(3)V99.                    
           05 FILLER                           PIC X(9).                        
           05 WS-F880-LUMPSUM OCCURS 4.                                         
              10 WS-F880-AMT-LUMPSUM-CPF       PIC S9(7)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-MORT-CF OCCURS 4.                                         
              10 WS-F880-AMT-MORT-CF-CPF       PIC S9(5)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-SOLICIT   OCCURS 4.                                       
              10 WS-F880-AMT-SOLICIT-CPF       PIC S9(5)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-LIE-SF   OCCURS 4.                                        
              10 WS-F880-AMT-LIE-SF-CPF        PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-LIE-RF   OCCURS 4.                                        
              10 WS-F880-AMT-LIE-RF-CPF        PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-SURVEY   OCCURS 4.                                        
              10 WS-F880-AMT-SURVEY-CPF        PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-CAVEAT-TREE OCCURS 4.                                     
              10 WS-F880-AMT-CAVEAT-CPF-TREE   PIC S9(3)V99.                    
           05 FILLER                           PIC X(9).                        
           05 WS-F880-LUMPSUM-TREE OCCURS 4.                                    
              10 WS-F880-AMT-LUMPSUM-CPF-TREE  PIC S9(7)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-MORT-CF-TREE OCCURS 4.                                    
              10 WS-F880-AMT-MORT-CF-CPF-TREE  PIC S9(5)V99.                    
           05 FILLER                           PIC X(7).                        
           05 WS-F880-SOLICIT-TREE OCCURS 4.                                    
              10 WS-F880-AMT-SOLICIT-CPF-TREE  PIC S9(5)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-LIE-SF-TREE OCCURS 4.                                     
              10 WS-F880-AMT-LIE-SF-CPF-TREE   PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-LIE-RF-TREE OCCURS 4.                                     
              10 WS-F880-AMT-LIE-RF-CPF-TREE   PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-SURVEY-TREE OCCURS 4.                                     
              10 WS-F880-AMT-SURVEY-CPF-TREE   PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-FRESH-CV-TREE OCCURS 4.                                   
              10 WS-F880-AMT-FRESH-CV-CPF-TREE PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-BUYER-WCV OCCURS 4.                                       
              10 WS-F880-AMT-BUYER-WCV-CPF     PIC S9(3)V99.                    
           05 FILLER                           PIC X(5).                        
           05 WS-F880-BANK-WCV OCCURS 4.                                        
              10 WS-F880-AMT-BANK-WCV-CPF      PIC S9(3)V99.                    
           05 FILLER                           PIC X(175).                      
                                                                                
       01  WS-DATE-VARS.                                                        
           05  WS-SYSTEM-DATE.                                                  
               10  WS-SYS-CCYY                  PIC 9(04).                      
               10  WS-SYS-MM                    PIC 9(02).                      
               10  WS-SYS-DD                    PIC 9(02).                      
                                                                                
           05 WS-EDITED-DATE                    PIC X(10) VALUE SPACES.         
                                                                                
      *------------------------------------------------------------*            
       PROCEDURE DIVISION.                                                      
      *------------------------------------------------------------*            
                                                                                
      *------------------------------------------------------------*            
       0000-MAIN.                                                               
      *------------------------------------------------------------*            
                                                                                
           PERFORM 1000-OPEN-FILES    THRU 1000-EXIT.                           
           PERFORM 1200-READ-F880     THRU 1200-EXIT.                           
           PERFORM 2000-PROCESS       THRU 2000-EXIT                            
                   UNTIL WS-F880-EOF = 'Y'.                                     
                                                                                
           PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       1000-OPEN-FILES.                                                         
      *------------------------------------------------------------*            
                                                                                
           OPEN INPUT  BP13F880                                                 
                I-O    BP13K671                                                 
                       BP13K677.                                                
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'OPEN BP13K671 FAIL. STATUS - '                        
                                            WS-K671-STATUS                      
                 MOVE  WS-K671-STATUS       TO RETURN-CODE                      
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K677-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'OPEN BP13K677 FAIL. STATUS - '                        
                                            WS-K677-STATUS                      
                 MOVE  WS-K677-STATUS       TO RETURN-CODE                      
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
           MOVE FUNCTION CURRENT-DATE       TO WS-SYSTEM-DATE.                  
                                                                                
           STRING  WS-SYSTEM-DATE(7:2) '/'                                      
                   WS-SYSTEM-DATE(5:2) '/'                                      
                   WS-SYSTEM-DATE(1:4)                                          
                   DELIMITED BY SIZE                                            
                   INTO WS-EDITED-DATE                                          
           END-STRING.                                                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       1200-READ-F880.                                                          
      *------------------------------------------------------------*            
                                                                                
           READ BP13F880                                                        
                AT END                                                          
                   MOVE 'Y' TO WS-F880-EOF                                      
                NOT AT END                                                      
                   ADD 1    TO WS-F880-READ                                     
           END-READ.                                                            
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       2000-PROCESS.                                                            
      *------------------------------------------------------------*            
                                                                                
           MOVE 'N'                  TO WS-K671-FOUND.                          
           MOVE SPACES               TO WS-K671-REC.                            
           INITIALIZE                   WS-REFUND-TABLE.                        
                                                                                
           PERFORM 2100-READ-K671    THRU 2100-EXIT.                            
                                                                                
           IF WS-K671-FOUND = 'Y'                                               
              MOVE BP13K671-REC           TO WS-K671-REC                        
                                                                                
              PERFORM 8500-INIT-K671      THRU 8500-EXIT                        
              PERFORM 2500-MOVE-F880-CASH-TO-K671                               
                                          THRU 2500-EXIT                        
                                                                                
              MOVE BP13K671-REC           TO WS-F671-REC                        
              MOVE BP13F880-REC           TO WS-F880-REC                        
                                                                                
              PERFORM 2600-CHECK-REFUND   THRU 2600-EXIT                        
              PERFORM 3000-CHECK-NRIC     THRU 3000-EXIT                        
                                                                                
              PERFORM 4000-REWRITE-K671   THRU 4000-EXIT                        
              PERFORM 5000-READ-K677      THRU 5000-EXIT                        
              PERFORM 5200-WRITE-K677     THRU 5200-EXIT                        
           END-IF.                                                              
                                                                                
           PERFORM 1200-READ-F880    THRU 1200-EXIT.                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       2100-READ-K671.                                                          
      *------------------------------------------------------------*            
                                                                                
           MOVE LOW-VALUES     TO K671-NUM-REGN.                                
           MOVE F880-NUM-REGN  TO K671-NUM-REGN.                                
                                                                                
           READ BP13K671.                                                       
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
                 MOVE 'Y'  TO WS-K671-FOUND                                     
              WHEN 23                                                           
                 DISPLAY ' NOT FOUND IN BP13K671 - ' F880-NUM-REGN              
              WHEN OTHER                                                        
                 DISPLAY 'ERRROR READING BP13K671. STATUS - '                   
                                            WS-K671-STATUS                      
                 MOVE WS-K671-STATUS        TO RETURN-CODE                      
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       2500-MOVE-F880-CASH-TO-K671.                                             
      *------------------------------------------------------------*            
                                                                                
           MOVE F880-DTE-UPDATE    TO K671-DTE-SUBTRF.                          
           MOVE 'Y'                TO K671-NUM-SUBTRF.                          
                                                                                
           ADD  F880-AMT-TOPUP-CD-CASH                                          
                                   TO K671-AMT-SOC-CASH.                        
           ADD  F880-AMT-TOPUP-SOCA-SF-CASH                                     
                                   TO K671-AMT-LSE-STMP-CASH.                   
           ADD  F880-AMT-TOPUP-SOCA-CF-CASH                                     
                                   TO K671-AMT-SALE-CONVY-CASH.                 
           ADD  F880-AMT-MORT-CF-CASH-TREE                                      
                                   TO K671-AMT-MORT-CONVY-CASH.                 
           ADD  F880-AMT-CAVEAT-CASH-TREE                                       
                                   TO K671-AMT-CAVEAT-REGN-CASH.                
           ADD  F880-AMT-LUMPSUM-CASH-TREE                                      
                                   TO K671-AMT-LUMPSUM-CASH.                    
           ADD  F880-AMT-SOLICIT-CASH-TREE                                      
                                   TO K671-AMT-SOLICIT-CASH.                    
           ADD  F880-AMT-LSE-ESCR-CASH-TREE                                     
                                   TO K671-AMT-LSE-ESCR-CASH.                   
           ADD  F880-AMT-LSE-REGN-CASH-TREE                                     
                                   TO K671-AMT-LSE-REGN-CASH.                   
           ADD  F880-AMT-SRVY-FEE-CASH-TREE                                     
                                   TO K671-AMT-SRVY-FEE-CASH.                   
           ADD  F880-AMT-FRESH-CV-CASH-TREE                                     
                                   TO K671-AMT-FRESH-CAVEAT-CASH.               
           ADD  F880-AMT-BUYER-WCV-CASH                                         
                                   TO K671-AMT-BUYER-WCV-CASH.                  
           ADD  F880-AMT-BANK-WCV-CASH                                          
                                   TO K671-AMT-BANK-WCV-CASH.                   
           ADD  F880-AMT-TOPUP-SBTR-SF-CASH                                     
                                   TO K671-AMT-SBTR-SF-CASH.                    
           ADD  F880-AMT-TOPUP-SBTR-CF-CASH                                     
                                   TO K671-AMT-SBTR-CF-CASH.                    
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       2600-CHECK-REFUND.                                                       
      *------------------------------------------------------------*            
      *FOR TRANSFOR NO LONGER FOUND AS TRANSFEREE (OUT-GOING HA)   *            
      *FOUND IN K671, NOT FOUND IN F880 CASES                      *            
      *COMPUTE REFUND AMOUNT & BLANK OFF IN K671                   *            
      *------------------------------------------------------------*            
                                                                                
           MOVE 0 TO WS-POS1.                                                   
                                                                                
           IF WS-F671-CPF-NO(1) NOT = SPACES AND LOW-VALUES                     
              IF WS-F671-CPF-NO(1) NOT = WS-F880-NUM-NRIC-TREE(1) AND           
                                         WS-F880-NUM-NRIC-TREE(2) AND           
                                         WS-F880-NUM-NRIC-TREE(3) AND           
                                         WS-F880-NUM-NRIC-TREE(4)               
                 MOVE 1  TO WS-POS1                                             
                 PERFORM 2700-COMPUTE-REFUND    THRU 2700-EXIT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-F671-CPF-NO(2) NOT = SPACES AND LOW-VALUES                     
              IF WS-F671-CPF-NO(2) NOT = WS-F880-NUM-NRIC-TREE(1) AND           
                                         WS-F880-NUM-NRIC-TREE(2) AND           
                                         WS-F880-NUM-NRIC-TREE(3) AND           
                                         WS-F880-NUM-NRIC-TREE(4)               
                 MOVE 2  TO WS-POS1                                             
                 PERFORM 2700-COMPUTE-REFUND    THRU 2700-EXIT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-F671-CPF-NO(3) NOT = SPACES AND LOW-VALUES                     
              IF WS-F671-CPF-NO(3) NOT = WS-F880-NUM-NRIC-TREE(1) AND           
                                         WS-F880-NUM-NRIC-TREE(2) AND           
                                         WS-F880-NUM-NRIC-TREE(3) AND           
                                         WS-F880-NUM-NRIC-TREE(4)               
                 MOVE 3  TO WS-POS1                                             
                 PERFORM 2700-COMPUTE-REFUND    THRU 2700-EXIT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-F671-CPF-NO(4) NOT = SPACES AND LOW-VALUES                     
              IF WS-F671-CPF-NO(4) NOT = WS-F880-NUM-NRIC-TREE(1) AND           
                                         WS-F880-NUM-NRIC-TREE(2) AND           
                                         WS-F880-NUM-NRIC-TREE(3) AND           
                                         WS-F880-NUM-NRIC-TREE(4)               
                 MOVE 4  TO WS-POS1                                             
                 PERFORM 2700-COMPUTE-REFUND    THRU 2700-EXIT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
       2600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
      *- COMPUTE REFUND TO BE PAID TO OUT-GOING HA                 *            
      *- REFUND AMT IS UPDATED IN BP13K677 BANKLOAN MEMO HISTORY   *            
      *------------------------------------------------------------*            
                                                                                
      *------------------------------------------------------------*            
       2700-COMPUTE-REFUND.                                                     
      *------------------------------------------------------------*            
                                                                                
           MOVE WS-F880-AMT-REFUND-CPF(WS-POS1)                                 
                                 TO WS-AMT-RFND-SOC-CPF(WS-POS1).               
           ADD  WS-F671-LUMP-CPF-PAID(WS-POS1)                                  
                                  TO WS-AMT-RFND-BANK-CPF(WS-POS1).             
           ADD  WS-F671-MORT-CONVY-CPF(WS-POS1)                                 
                                  TO WS-AMT-RFND-BANK-CPF(WS-POS1).             
           ADD  WS-F671-SOL-CPF-PAID(WS-POS1)                                   
                                  TO WS-AMT-RFND-BANK-CPF(WS-POS1).             
           ADD  WS-F671-LSE-ESCR-CPF-PAID(WS-POS1)                              
                                  TO WS-AMT-RFND-BANK-CPF(WS-POS1).             
           ADD  WS-F671-LSE-REGN-CPF-PAID(WS-POS1)                              
                                  TO WS-AMT-RFND-BANK-CPF(WS-POS1).             
           ADD  WS-F671-SRVY-FEE-CPF-PAID(WS-POS1)                              
                                  TO WS-AMT-RFND-BANK-CPF(WS-POS1).             
                                                                                
           PERFORM 2800-BLANK-CPF-PAID    THRU 2800-EXIT.                       
                                                                                
       2700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
      * FOR OUT-GOING HA, ZEROS AMT FIELDS IN BP13K671             *            
      *------------------------------------------------------------*            
                                                                                
      *------------------------------------------------------------*            
       2800-BLANK-CPF-PAID.                                                     
      *------------------------------------------------------------*            
                                                                                
           MOVE SPACES      TO WS-F671-CPF-NO             (WS-POS1).            
                                                                                
           MOVE ZEROS       TO WS-F671-SOC-CPF-PAID       (WS-POS1)             
                               WS-F671-LUMP-CPF-PAID      (WS-POS1)             
                               WS-F671-LSE-STAMP-CPF-PAID (WS-POS1)             
                               WS-F671-SALE-CONVY-CPF-PAID(WS-POS1)             
                               WS-F671-MORT-CONVY-CPF     (WS-POS1)             
                               WS-F671-SRVY-FEE-CPF-PAID  (WS-POS1)             
                               WS-F671-LSE-ESCR-CPF-PAID  (WS-POS1)             
                               WS-F671-LSE-REGN-CPF-PAID  (WS-POS1)             
                               WS-F671-CAV-REGN-CPF-PAID  (WS-POS1)             
                               WS-F671-SOL-CPF-PAID       (WS-POS1).            
                                                                                
       2800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       3000-CHECK-NRIC.                                                         
      *------------------------------------------------------------*            
                                                                                
           MOVE 0 TO WS-POS1 WS-POS2.                                           
           MOVE WS-F671-REC  TO WS-F671A-REC.                                   
                                                                                
           IF WS-F880-NUM-NRIC-TREE(1) NOT = SPACES AND LOW-VALUES              
              MOVE 1 TO WS-POS1                                                 
              EVALUATE WS-F880-NUM-NRIC-TREE(1)                                 
                 WHEN WS-F671-CPF-NO(1)                                         
                    MOVE 1 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(2)                                         
                    MOVE 2 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(3)                                         
                    MOVE 3 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(4)                                         
                    MOVE 4 TO WS-POS2                                           
                 WHEN OTHER                                                     
                    MOVE 0 TO WS-POS2                                           
                    PERFORM 3300-MOVE-NEW-NRIC-TO-K671  THRU 3300-EXIT          
              END-EVALUATE                                                      
              IF WS-POS2 NOT = 0                                                
                 PERFORM 3200-COMPUTE-CPF-REQ  THRU 3200-EXIT                   
                 PERFORM 3400-SWAP-NRIC        THRU 3400-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-F880-NUM-NRIC-TREE(2) NOT = SPACES AND LOW-VALUES              
              MOVE 2 TO WS-POS1                                                 
              EVALUATE WS-F880-NUM-NRIC-TREE(2)                                 
                 WHEN WS-F671-CPF-NO(1)                                         
                    MOVE 1 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(2)                                         
                    MOVE 2 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(3)                                         
                    MOVE 3 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(4)                                         
                    MOVE 4 TO WS-POS2                                           
                 WHEN OTHER                                                     
                    MOVE 0 TO WS-POS2                                           
                    PERFORM 3300-MOVE-NEW-NRIC-TO-K671  THRU 3300-EXIT          
              END-EVALUATE                                                      
              IF WS-POS2 NOT = 0                                                
                 PERFORM 3400-SWAP-NRIC        THRU 3400-EXIT                   
                 PERFORM 3200-COMPUTE-CPF-REQ  THRU 3200-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-F880-NUM-NRIC-TREE(3) NOT = SPACES AND LOW-VALUES              
              MOVE 3 TO WS-POS1                                                 
              EVALUATE WS-F880-NUM-NRIC-TREE(3)                                 
                 WHEN WS-F671-CPF-NO(1)                                         
                    MOVE 1 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(2)                                         
                    MOVE 2 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(3)                                         
                    MOVE 3 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(4)                                         
                    MOVE 4 TO WS-POS2                                           
                 WHEN OTHER                                                     
                    MOVE 0 TO WS-POS2                                           
                    PERFORM 3300-MOVE-NEW-NRIC-TO-K671  THRU 3300-EXIT          
              END-EVALUATE                                                      
              IF WS-POS2 NOT = 0                                                
                 PERFORM 3200-COMPUTE-CPF-REQ  THRU 3200-EXIT                   
                 PERFORM 3400-SWAP-NRIC        THRU 3400-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-F880-NUM-NRIC-TREE(4) NOT = SPACES AND LOW-VALUES              
              MOVE 4 TO WS-POS1                                                 
              EVALUATE WS-F880-NUM-NRIC-TREE(4)                                 
                 WHEN WS-F671-CPF-NO(1)                                         
                    MOVE 1 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(2)                                         
                    MOVE 2 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(3)                                         
                    MOVE 3 TO WS-POS2                                           
                 WHEN WS-F671-CPF-NO(4)                                         
                    MOVE 4 TO WS-POS2                                           
                 WHEN OTHER                                                     
                    MOVE 0 TO WS-POS2                                           
                    PERFORM 3300-MOVE-NEW-NRIC-TO-K671  THRU 3300-EXIT          
              END-EVALUATE                                                      
              IF WS-POS2 NOT = 0                                                
                 PERFORM 3200-COMPUTE-CPF-REQ  THRU 3200-EXIT                   
                 PERFORM 3400-SWAP-NRIC        THRU 3400-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
      * ADD NEW REQUIRED AMOUNT TO BP13K671 REQ-AMT                *            
      *------------------------------------------------------------*            
                                                                                
      *------------------------------------------------------------*            
       3200-COMPUTE-CPF-REQ.                                                    
      *------------------------------------------------------------*            
                                                                                
      ***1. SOC                                                                 
           ADD WS-F880-AMT-TOPUP-CD-CPF(WS-POS1) TO                             
                              WS-F671-SOC-CPF (WS-POS2).                        
                                                                                
      ***2. LUMPSUM                                                             
           ADD WS-F880-AMT-LUMPSUM-CPF-TREE(WS-POS1) TO                         
                              WS-F671-LUMP-CPF (WS-POS2).                       
                                                                                
      ***3. LSE STAMP                                                           
           ADD WS-F880-AMT-TOPUP-SOCA-SF-CPF(WS-POS1) TO                        
                              WS-F671-LSE-STAMP-CPF(WS-POS2).                   
                                                                                
      ***4. CONVEY                                                              
           ADD WS-F880-AMT-TOPUP-SOCA-CF-CPF(WS-POS1) TO                        
                              WS-F671-SALE-CONVY-CPF(WS-POS2).                  
                                                                                
      ***5. MORT CONVRY                                                         
           ADD WS-F880-AMT-MORT-CF-CPF-TREE(WS-POS1) TO                         
                              WS-F671-MORT-CONVY-CPF(WS-POS2).                  
                                                                                
      ***6. SURVEY                                                              
           ADD WS-F880-AMT-SURVEY-CPF-TREE(WS-POS1) TO                          
                              WS-F671-SRVY-FEE-CPF(WS-POS2).                    
                                                                                
      ***7. LSE ESCR                                                            
           ADD WS-F880-AMT-LIE-SF-CPF-TREE(WS-POS1) TO                          
                              WS-F671-LSE-ESCR-CPF(WS-POS2).                    
                                                                                
      ***8. LSE REGN                                                            
           ADD WS-F880-AMT-LIE-RF-CPF-TREE(WS-POS1) TO                          
                              WS-F671-LSE-REGN-CPF(WS-POS2).                    
                                                                                
      ***9. CAVEAT                                                              
           ADD WS-F880-AMT-CAVEAT-CPF-TREE(WS-POS1) TO                          
                              WS-F671-CAV-REGN-CPF(WS-POS2).                    
                                                                                
      **10. SOLICITOR                                                           
           ADD WS-F880-AMT-SOLICIT-CPF-TREE(WS-POS1) TO                         
                              WS-F671-SOL-CPF(WS-POS2).                         
                                                                                
      **11. FRESH CAVEAT                                                        
           ADD WS-F880-AMT-FRESH-CV-CPF-TREE(WS-POS1) TO                        
                              WS-F671-FRESH-CV-CPF(WS-POS2).                    
                                                                                
      **12. BUYERS WCV & BANKS WCV                                              
           EVALUATE WS-F671-CPF-NO(WS-POS2)                                     
              WHEN WS-F880-NUM-NRIC-TROR(1)                                     
                   ADD WS-F880-AMT-BUYER-WCV-CPF(1) TO                          
                                   WS-F671-BYR-WCV-CPF(WS-POS2)                 
                   ADD WS-F880-AMT-BANK-WCV-CPF(1) TO                           
                                   WS-F671-BNK-WCV-CPF(WS-POS2)                 
              WHEN WS-F880-NUM-NRIC-TROR(2)                                     
                   ADD WS-F880-AMT-BUYER-WCV-CPF(2) TO                          
                                   WS-F671-BYR-WCV-CPF(WS-POS2)                 
                   ADD WS-F880-AMT-BANK-WCV-CPF(2) TO                           
                                   WS-F671-BNK-WCV-CPF(WS-POS2)                 
              WHEN WS-F880-NUM-NRIC-TROR(3)                                     
                   ADD WS-F880-AMT-BUYER-WCV-CPF(3) TO                          
                                   WS-F671-BYR-WCV-CPF(WS-POS2)                 
                   ADD WS-F880-AMT-BANK-WCV-CPF(3) TO                           
                                   WS-F671-BNK-WCV-CPF(WS-POS2)                 
              WHEN WS-F880-NUM-NRIC-TROR(4)                                     
                   ADD WS-F880-AMT-BUYER-WCV-CPF(4) TO                          
                                   WS-F671-BYR-WCV-CPF(WS-POS2)                 
                   ADD WS-F880-AMT-BANK-WCV-CPF(4) TO                           
                                   WS-F671-BNK-WCV-CPF(WS-POS2)                 
           END-EVALUATE.                                                        
                                                                                
      **13. SUB-TRANS SF                                                        
           ADD WS-F880-AMT-TOPUP-SBTR-SF-CPF(WS-POS1) TO                        
                              WS-F671-SBTR-SF-CPF(WS-POS2).                     
                                                                                
      **14. SUB-TRANS CF                                                        
           ADD WS-F880-AMT-TOPUP-SBTR-CF-CPF(WS-POS1) TO                        
                              WS-F671-SBTR-CF-CPF(WS-POS2).                     
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       3300-MOVE-NEW-NRIC-TO-K671.                                              
      *------------------------------------------------------------*            
                                                                                
           MOVE  WS-F880-NUM-NRIC-TREE(WS-POS1) TO                              
                              WS-F671A-CPF-NO (WS-POS1).                        
                                                                                
           MOVE  WS-F880-AMT-TOPUP-CD-CPF(WS-POS1) TO                           
                              WS-F671A-SOC-CPF (WS-POS1).                       
                                                                                
           MOVE  WS-F880-AMT-LUMPSUM-CPF-TREE(WS-POS1) TO                       
                              WS-F671A-LUMP-CPF (WS-POS1).                      
                                                                                
           MOVE  WS-F880-AMT-LS-CPF-TREE(WS-POS1) TO                            
                              WS-F671A-LSE-STAMP-CPF(WS-POS1).                  
                                                                                
           MOVE  WS-F880-AMT-CONV-CPF-TREE(WS-POS1) TO                          
                              WS-F671A-SALE-CONVY-CPF(WS-POS1).                 
                                                                                
           MOVE  WS-F880-AMT-MORT-CF-CPF-TREE(WS-POS1) TO                       
                              WS-F671A-MORT-CONVY-CPF(WS-POS1).                 
                                                                                
           MOVE  WS-F880-AMT-SURVEY-CPF-TREE(WS-POS1) TO                        
                              WS-F671A-SRVY-FEE-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F880-AMT-LIE-SF-CPF-TREE(WS-POS1) TO                        
                              WS-F671A-LSE-ESCR-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F880-AMT-LIE-RF-CPF-TREE(WS-POS1) TO                        
                              WS-F671A-LSE-REGN-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F880-AMT-CAVEAT-CPF-TREE(WS-POS1) TO                        
                              WS-F671A-CAV-REGN-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F880-AMT-SOLICIT-CPF-TREE(WS-POS1) TO                       
                              WS-F671A-SOL-CPF(WS-POS1).                        
                                                                                
           MOVE  WS-F880-AMT-FRESH-CV-CPF-TREE(WS-POS1) TO                      
                              WS-F671A-FRESH-CV-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F880-AMT-BUYER-WCV-CPF(WS-POS1) TO                          
                              WS-F671A-BYR-WCV-CPF(WS-POS1).                    
                                                                                
           MOVE  WS-F880-AMT-BANK-WCV-CPF(WS-POS1) TO                           
                              WS-F671A-BNK-WCV-CPF(WS-POS1)                     
                                                                                
           MOVE  WS-F880-AMT-TOPUP-SBTR-SF-CPF(WS-POS1) TO                      
                              WS-F671A-SBTR-SF-CPF(WS-POS1).                    
                                                                                
           MOVE  WS-F880-AMT-TOPUP-SBTR-CF-CPF(WS-POS1) TO                      
                              WS-F671A-SBTR-CF-CPF(WS-POS1).                    
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       3400-SWAP-NRIC.                                                          
      *------------------------------------------------------------*            
      *WS-F671-REC = OLD K671-RECORD WITH COMPUTED REQUIREMENT AMT *            
      *              AND ADDED CASH (FROM BP13F880)                *            
      *WS-F671A-REC= NEW RECORD TO UPDATE BP13K671 WHICH SIMILAR TO*            
      *              BP13F880                                      *            
      *------------------------------------------------------------*            
                                                                                
           MOVE  WS-F671-CPF-NO (WS-POS2) TO                                    
                              WS-F671A-CPF-NO (WS-POS1).                        
                                                                                
      *** REQUIRED                                                              
                                                                                
           MOVE  WS-F671-SOC-CPF (WS-POS2) TO                                   
                              WS-F671A-SOC-CPF (WS-POS1).                       
                                                                                
           MOVE  WS-F671-LUMP-CPF (WS-POS2) TO                                  
                              WS-F671A-LUMP-CPF (WS-POS1).                      
                                                                                
           MOVE  WS-F671-LSE-STAMP-CPF(WS-POS2) TO                              
                              WS-F671A-LSE-STAMP-CPF(WS-POS1).                  
                                                                                
           MOVE  WS-F671-SALE-CONVY-CPF(WS-POS2) TO                             
                              WS-F671A-SALE-CONVY-CPF(WS-POS1).                 
                                                                                
           MOVE  WS-F671-MORT-CONVY-CPF(WS-POS2) TO                             
                              WS-F671A-MORT-CONVY-CPF(WS-POS1).                 
                                                                                
           MOVE  WS-F671-SRVY-FEE-CPF(WS-POS2) TO                               
                              WS-F671A-SRVY-FEE-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F671-LSE-ESCR-CPF(WS-POS2) TO                               
                              WS-F671A-LSE-ESCR-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F671-LSE-REGN-CPF(WS-POS2) TO                               
                              WS-F671A-LSE-REGN-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F671-CAV-REGN-CPF(WS-POS2) TO                               
                              WS-F671A-CAV-REGN-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F671-SOL-CPF(WS-POS2) TO                                    
                              WS-F671A-SOL-CPF(WS-POS1).                        
                                                                                
           MOVE  WS-F671-FRESH-CV-CPF(WS-POS2) TO                               
                              WS-F671A-FRESH-CV-CPF(WS-POS1).                   
                                                                                
           MOVE  WS-F671-BYR-WCV-CPF(WS-POS2) TO                                
                              WS-F671A-BYR-WCV-CPF(WS-POS1).                    
                                                                                
           MOVE  WS-F671-BNK-WCV-CPF(WS-POS2) TO                                
                              WS-F671A-BNK-WCV-CPF(WS-POS1).                    
                                                                                
           MOVE  WS-F671-SBTR-SF-CPF(WS-POS2) TO                                
                              WS-F671A-SBTR-SF-CPF(WS-POS1).                    
                                                                                
           MOVE  WS-F671-SBTR-CF-CPF(WS-POS2) TO                                
                              WS-F671A-SBTR-CF-CPF(WS-POS1).                    
                                                                                
      *** PAID                                                                  
                                                                                
           MOVE  WS-F671-SOC-CPF-PAID (WS-POS2) TO                              
                              WS-F671A-SOC-CPF-PAID (WS-POS1).                  
                                                                                
           MOVE  WS-F671-LUMP-CPF-PAID (WS-POS2) TO                             
                              WS-F671A-LUMP-CPF-PAID (WS-POS1).                 
                                                                                
           MOVE  WS-F671-LSE-STAMP-CPF-PAID(WS-POS2) TO                         
                              WS-F671A-LSE-STAMP-CPF-PAID(WS-POS1).             
                                                                                
           MOVE  WS-F671-SALE-CONVY-CPF-PAID(WS-POS2) TO                        
                              WS-F671A-SALE-CONVY-CPF-PAID(WS-POS1).            
                                                                                
           MOVE  WS-F671-MORT-CONVY-CPF-PAID(WS-POS2) TO                        
                              WS-F671A-MORT-CONVY-CPF-PAID(WS-POS1).            
                                                                                
           MOVE  WS-F671-SRVY-FEE-CPF-PAID(WS-POS2) TO                          
                              WS-F671A-SRVY-FEE-CPF-PAID(WS-POS1).              
                                                                                
           MOVE  WS-F671-LSE-ESCR-CPF-PAID(WS-POS2) TO                          
                              WS-F671A-LSE-ESCR-CPF-PAID(WS-POS1).              
                                                                                
           MOVE  WS-F671-LSE-REGN-CPF-PAID(WS-POS2) TO                          
                              WS-F671A-LSE-REGN-CPF-PAID(WS-POS1).              
                                                                                
           MOVE  WS-F671-CAV-REGN-CPF-PAID(WS-POS2) TO                          
                              WS-F671A-CAV-REGN-CPF-PAID(WS-POS1).              
                                                                                
           MOVE  WS-F671-SOL-CPF-PAID(WS-POS2) TO                               
                              WS-F671A-SOL-CPF-PAID(WS-POS1).                   
                                                                                
           MOVE  WS-F671-FRESH-CV-CPF-PAID(WS-POS2) TO                          
                              WS-F671A-FRESH-CV-CPF-PAID(WS-POS1).              
                                                                                
           MOVE  WS-F671-BYR-WCV-CPF-PAID(WS-POS2) TO                           
                              WS-F671A-BYR-WCV-CPF-PAID(WS-POS1).               
                                                                                
           MOVE  WS-F671-BNK-WCV-CPF-PAID(WS-POS2) TO                           
                              WS-F671A-BNK-WCV-CPF-PAID(WS-POS1).               
                                                                                
           MOVE  WS-F671-SBTR-SF-CPF-PAID(WS-POS2) TO                           
                              WS-F671A-SBTR-SF-CPF-PAID(WS-POS1).               
                                                                                
           MOVE  WS-F671-SBTR-CF-CPF-PAID(WS-POS2) TO                           
                              WS-F671A-SBTR-CF-CPF-PAID(WS-POS1).               
                                                                                
      *** BALANCE                                                               
                                                                                
           MOVE  WS-F671-SOC-CPF-BAL (WS-POS2) TO                               
                              WS-F671A-SOC-CPF-BAL (WS-POS1).                   
                                                                                
           MOVE  WS-F671-LMP-CPF-BAL (WS-POS2) TO                               
                              WS-F671A-LMP-CPF-BAL (WS-POS1).                   
                                                                                
           MOVE  WS-F671-LSE-CPF-STAMP-BAL(WS-POS2) TO                          
                              WS-F671A-LSE-CPF-STAMP-BAL(WS-POS1).              
                                                                                
           MOVE  WS-F671-SALE-CPF-CONVY-BAL(WS-POS2) TO                         
                              WS-F671A-SALE-CPF-CONVY-BAL(WS-POS1).             
                                                                                
           MOVE  WS-F671-MORT-CPF-CONVY-BAL(WS-POS2) TO                         
                              WS-F671A-MORT-CPF-CONVY-BAL(WS-POS1).             
                                                                                
           MOVE  WS-F671-SRVY-CPF-FEE-BAL(WS-POS2) TO                           
                              WS-F671A-SRVY-CPF-FEE-BAL(WS-POS1).               
                                                                                
           MOVE  WS-F671-LSE-ESCR-CPF-BAL(WS-POS2) TO                           
                              WS-F671A-LSE-ESCR-CPF-BAL(WS-POS1).               
                                                                                
           MOVE  WS-F671-LSE-REGN-CPF-BAL(WS-POS2) TO                           
                              WS-F671A-LSE-REGN-CPF-BAL(WS-POS1).               
                                                                                
           MOVE  WS-F671-CAV-REGN-CPF-BAL(WS-POS2) TO                           
                              WS-F671A-CAV-REGN-CPF-BAL(WS-POS1).               
                                                                                
           MOVE  WS-F671-SOL-CPF-BAL(WS-POS2) TO                                
                              WS-F671A-SOL-CPF-BAL(WS-POS1).                    
                                                                                
           MOVE  WS-F671-FRESH-CV-CPF-BAL(WS-POS2) TO                           
                              WS-F671A-FRESH-CV-CPF-BAL(WS-POS1).               
                                                                                
           MOVE  WS-F671-BYR-WCV-CPF-BAL(WS-POS2) TO                            
                              WS-F671A-BYR-WCV-CPF-BAL(WS-POS1).                
                                                                                
           MOVE  WS-F671-BNK-WCV-CPF-BAL(WS-POS2) TO                            
                              WS-F671A-BNK-WCV-CPF-BAL(WS-POS1).                
                                                                                
           MOVE  WS-F671-SBTR-SF-CPF-BAL(WS-POS2) TO                            
                              WS-F671A-SBTR-SF-CPF-BAL(WS-POS1).                
                                                                                
           MOVE  WS-F671-SBTR-CF-CPF-BAL(WS-POS2) TO                            
                              WS-F671A-SBTR-CF-CPF-BAL(WS-POS1).                
                                                                                
      *** RETIRE                                                                
                                                                                
           MOVE  WS-F671-AMT-CPF-RETIRE(WS-POS2) TO                             
                              WS-F671A-AMT-CPF-RETIRE (WS-POS1).                
                                                                                
           MOVE  WS-F671-SOC-CPF-RETIRE (WS-POS2) TO                            
                              WS-F671A-SOC-CPF-RETIRE (WS-POS1).                
                                                                                
           MOVE  WS-F671-LUMP-CPF-RETIRE (WS-POS2) TO                           
                              WS-F671A-LUMP-CPF-RETIRE (WS-POS1).               
                                                                                
           MOVE  WS-F671-CPF-RETIRE-BAL (WS-POS2) TO                            
                              WS-F671A-CPF-RETIRE-BAL (WS-POS1).                
                                                                                
      *** CPF AVAIL                                                             
                                                                                
           MOVE  WS-F671-AMT-CPF-AVAIL(WS-POS2) TO                              
                              WS-F671A-AMT-CPF-AVAIL (WS-POS1).                 
                                                                                
      *** REGN DEPOSIT                                                          
                                                                                
           MOVE  WS-F671-REGN-CPF-DEPOSIT(WS-POS2) TO                           
                              WS-F671A-REGN-CPF-DEPOSIT(WS-POS1).               
                                                                                
      *** CPF-DATE VALUE & CHEQUE                                               
                                                                                
           MOVE  WS-F671-DTE-VALUE-CPF(WS-POS2) TO                              
                              WS-F671A-DTE-VALUE-CPF (WS-POS1).                 
                                                                                
           MOVE  WS-F671-CHQ-CPF1(WS-POS2) TO                                   
                              WS-F671A-CHQ-CPF1(WS-POS1).                       
                                                                                
           MOVE  WS-F671-CHQ-CPF2(WS-POS2) TO                                   
                              WS-F671A-CHQ-CPF2(WS-POS1).                       
                                                                                
           MOVE  WS-F671-CHQ-CPF3(WS-POS2) TO                                   
                              WS-F671A-CHQ-CPF3(WS-POS1).                       
                                                                                
           IF WS-POS1 NOT = WS-POS2                                             
              PERFORM 3500-BLANK-OLD-NRIC  THRU 3500-EXIT                       
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       3500-BLANK-OLD-NRIC.                                                     
      *------------------------------------------------------------*            
                                                                                
           MOVE  SPACES    TO WS-F671A-CPF-NO        (WS-POS2).                 
                                                                                
           MOVE  ZEROS     TO WS-F671A-SOC-CPF       (WS-POS2)                  
                              WS-F671A-LUMP-CPF      (WS-POS2)                  
                              WS-F671A-LSE-STAMP-CPF (WS-POS2)                  
                              WS-F671A-SALE-CONVY-CPF(WS-POS2)                  
                              WS-F671A-MORT-CONVY-CPF(WS-POS2)                  
                              WS-F671A-SRVY-FEE-CPF  (WS-POS2)                  
                              WS-F671A-LSE-ESCR-CPF  (WS-POS2)                  
                              WS-F671A-LSE-REGN-CPF  (WS-POS2)                  
                              WS-F671A-CAV-REGN-CPF  (WS-POS2)                  
                              WS-F671A-SOL-CPF       (WS-POS2)                  
                              WS-F671A-FRESH-CV-CPF  (WS-POS2)                  
                              WS-F671A-BYR-WCV-CPF   (WS-POS2)                  
                              WS-F671A-BNK-WCV-CPF   (WS-POS2)                  
                              WS-F671A-SBTR-SF-CPF   (WS-POS2)                  
                              WS-F671A-SBTR-CF-CPF   (WS-POS2).                 
                                                                                
           MOVE  ZEROS     TO WS-F671A-SOC-CPF-PAID       (WS-POS2)             
                              WS-F671A-LUMP-CPF-PAID      (WS-POS2)             
                              WS-F671A-LSE-STAMP-CPF-PAID (WS-POS2)             
                              WS-F671A-SALE-CONVY-CPF-PAID(WS-POS2)             
                              WS-F671A-MORT-CONVY-CPF-PAID(WS-POS2)             
                              WS-F671A-SRVY-FEE-CPF-PAID  (WS-POS2)             
                              WS-F671A-LSE-ESCR-CPF-PAID  (WS-POS2)             
                              WS-F671A-LSE-REGN-CPF-PAID  (WS-POS2)             
                              WS-F671A-CAV-REGN-CPF-PAID  (WS-POS2)             
                              WS-F671A-SOL-CPF-PAID       (WS-POS2)             
                              WS-F671A-FRESH-CV-CPF-PAID  (WS-POS2)             
                              WS-F671A-BYR-WCV-CPF-PAID   (WS-POS2)             
                              WS-F671A-BNK-WCV-CPF-PAID   (WS-POS2)             
                              WS-F671A-SBTR-SF-CPF-PAID   (WS-POS2)             
                              WS-F671A-SBTR-CF-CPF-PAID   (WS-POS2).            
                                                                                
           MOVE  ZEROS     TO WS-F671A-SOC-CPF-BAL       (WS-POS2)              
                              WS-F671A-LMP-CPF-BAL       (WS-POS2)              
                              WS-F671A-LSE-CPF-STAMP-BAL (WS-POS2)              
                              WS-F671A-SALE-CPF-CONVY-BAL(WS-POS2)              
                              WS-F671A-MORT-CPF-CONVY-BAL(WS-POS2)              
                              WS-F671A-SRVY-CPF-FEE-BAL  (WS-POS2)              
                              WS-F671A-LSE-ESCR-CPF-BAL  (WS-POS2)              
                              WS-F671A-LSE-REGN-CPF-BAL  (WS-POS2)              
                              WS-F671A-CAV-REGN-CPF-BAL  (WS-POS2)              
                              WS-F671A-SOL-CPF-BAL       (WS-POS2)              
                              WS-F671A-FRESH-CV-CPF-BAL  (WS-POS2)              
                              WS-F671A-BYR-WCV-CPF-BAL   (WS-POS2)              
                              WS-F671A-BNK-WCV-CPF-BAL   (WS-POS2)              
                              WS-F671A-SBTR-SF-CPF-BAL   (WS-POS2)              
                              WS-F671A-SBTR-CF-CPF-BAL   (WS-POS2).             
                                                                                
           MOVE ZEROS      TO WS-F671A-AMT-CPF-RETIRE (WS-POS2)                 
                              WS-F671A-SOC-CPF-RETIRE (WS-POS2)                 
                              WS-F671A-LUMP-CPF-RETIRE(WS-POS2)                 
                              WS-F671A-CPF-RETIRE-BAL (WS-POS2).                
                                                                                
           MOVE ZEROS      TO WS-F671A-AMT-CPF-AVAIL   (WS-POS2)                
                              WS-F671A-REGN-CPF-DEPOSIT(WS-POS2).               
                                                                                
           MOVE SPACES     TO WS-F671A-DTE-VALUE-CPF (WS-POS2)                  
                              WS-F671A-CHQ-CPF1      (WS-POS2)                  
                              WS-F671A-CHQ-CPF2      (WS-POS2)                  
                              WS-F671A-CHQ-CPF3      (WS-POS2).                 
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       4000-REWRITE-K671.                                                       
      *------------------------------------------------------------*            
                                                                                
           MOVE WS-F671A-REC  TO BP13K671-REC.                                  
                                                                                
           REWRITE BP13K671-REC.                                                
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
                 ADD 1  TO WS-K671-UPDATE                                       
              WHEN OTHER                                                        
                 DISPLAY 'ERRROR UPDATING BP13K671. STATUS - '                  
                                            WS-K671-STATUS                      
                 MOVE WS-K671-STATUS        TO RETURN-CODE                      
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5000-READ-K677.                                                          
      *------------------------------------------------------------*            
                                                                                
           MOVE 0                       TO WS-K677-SEQ.                         
           MOVE 'N'                     TO WS-K677-EOF.                         
           MOVE LOW-VALUES              TO K677-KEY-FLD.                        
           MOVE F880-NUM-REGN           TO K677-NUM-REGN.                       
                                                                                
           START BP13K677 KEY >= K677-KEY-FLD.                                  
                                                                                
           EVALUATE WS-K677-STATUS                                              
              WHEN 00                                                           
                 PERFORM 5100-READNEXT-K677  THRU 5100-EXIT                     
                    UNTIL WS-K677-EOF = 'Y'                                     
              WHEN 10                                                           
              WHEN 23                                                           
                 MOVE 'Y' TO WS-K677-EOF                                        
              WHEN OTHER                                                        
                 DISPLAY 'ERRROR READING BP13K677. STATUS - '                   
                                            WS-K677-STATUS                      
                 MOVE WS-K677-STATUS        TO RETURN-CODE                      
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5100-READNEXT-K677.                                                      
      *------------------------------------------------------------*            
                                                                                
           READ BP13K677 NEXT RECORD                                            
                AT END                                                          
                   MOVE 'Y'      TO WS-K677-EOF                                 
           END-READ.                                                            
                                                                                
           IF F880-NUM-REGN NOT = K677-NUM-REGN                                 
              MOVE 'Y'           TO WS-K677-EOF                                 
           ELSE                                                                 
              MOVE K677-NUM-SEQ  TO WS-K677-SEQ                                 
           END-IF.                                                              
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5200-WRITE-K677.                                                         
      *------------------------------------------------------------*            
                                                                                
           PERFORM 5300-MOVE-VALUES  THRU 5300-EXIT.                            
                                                                                
           WRITE BP13K677-REC.                                                  
                                                                                
           EVALUATE WS-K677-STATUS                                              
              WHEN 00                                                           
                 ADD 1 TO WS-K677-WRITE                                         
              WHEN OTHER                                                        
                 DISPLAY 'ERRROR WRITING BP13K677. STATUS - '                   
                                            WS-K677-STATUS                      
                 MOVE WS-K677-STATUS        TO RETURN-CODE                      
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5300-MOVE-VALUES.                                                        
      *------------------------------------------------------------*            
                                                                                
           MOVE SPACES                  TO BP13K677-REC.                        
           INITIALIZE BP13K677-REC REPLACING ALPHANUMERIC DATA BY               
                      SPACES NUMERIC DATA BY ZEROS.                             
           MOVE K671-NUM-REGN           TO K677-NUM-REGN.                       
           ADD  1                       TO WS-K677-SEQ.                         
           MOVE WS-K677-SEQ             TO K677-NUM-SEQ.                        
           MOVE WS-K671-REC             TO K677-REC2.                           
                                                                                
           MOVE WS-AMT-RFND-SOC-CPF(1)  TO K677-AMT-RFND-SOC-CPF1-REQ.          
           MOVE WS-AMT-RFND-SOC-CPF(2)  TO K677-AMT-RFND-SOC-CPF2-REQ.          
           MOVE WS-AMT-RFND-SOC-CPF(3)  TO K677-AMT-RFND-SOC-CPF3-REQ.          
           MOVE WS-AMT-RFND-SOC-CPF(4)  TO K677-AMT-RFND-SOC-CPF4-REQ.          
                                                                                
           MOVE WS-AMT-RFND-BANK-CPF(1) TO K677-AMT-RFND-BANK-CPF1-REQ.         
           MOVE WS-AMT-RFND-BANK-CPF(2) TO K677-AMT-RFND-BANK-CPF2-REQ.         
           MOVE WS-AMT-RFND-BANK-CPF(3) TO K677-AMT-RFND-BANK-CPF3-REQ.         
           MOVE WS-AMT-RFND-BANK-CPF(4) TO K677-AMT-RFND-BANK-CPF4-REQ.         
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       8500-INIT-K671.                                                          
      *------------------------------------------------------------*            
                                                                                
      *LUMP SUM                                                                 
           IF K671-AMT-LUMPSUM-CASH    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CASH                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF1    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF1-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF1-BAL    NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-BAL    NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-BAL    NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-BAL    NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4-BAL            
           END-IF.                                                              
                                                                                
      *LUMP SUM RETIRE                                                          
           IF K671-AMT-LUMPSUM-CPF1-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4-RETIRE         
           END-IF.                                                              
                                                                                
      *IDP FEES                                                                 
           IF K671-AMT-SOC-CASH        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CASH                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF1        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF1-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF1-RETIRE NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1-RETIRE             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2-RETIRE NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2-RETIRE             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3-RETIRE NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3-RETIRE             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4-RETIRE NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4-RETIRE             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF1-BAL    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1-BAL                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2-BAL    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2-BAL                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3-BAL    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3-BAL                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4-BAL    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4-BAL                
           END-IF.                                                              
                                                                                
           IF K671-AMT-CPF1-AVAIL      NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-CPF1-AVAIL                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-CPF2-AVAIL      NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-CPF2-AVAIL                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-CPF3-AVAIL      NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-CPF3-AVAIL                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-CPF4-AVAIL      NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-CPF4-AVAIL                  
           END-IF.                                                              
                                                                                
      *LEASE STAMP FEE                                                          
           IF K671-AMT-LSE-STMP-CASH   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CASH               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF1   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF1-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF2-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF3-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF4-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-BAL NOT NUMERIC                            
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF1-BAL         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2-BAL NOT NUMERIC                            
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF2-BAL         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3-BAL NOT NUMERIC                            
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF3-BAL         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4-BAL NOT NUMERIC                            
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF4-BAL         
           END-IF.                                                              
                                                                                
      *SALE CONVEY FEE                                                          
           IF K671-AMT-SALE-CONVY-CASH NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CASH             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF1             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF2             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF3             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF4             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF1-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF2-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF3-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF4-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF1-BAL          
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF2-BAL          
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF3-BAL          
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF4-BAL          
           END-IF.                                                              
                                                                                
      *MORT CONVEY FEE                                                          
           IF K671-AMT-MORT-CONVY-CASH NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CASH             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF1             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF2             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF3             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF4             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF1-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF2-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF3-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF4-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF1-BAL          
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF2-BAL          
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF3-BAL          
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4-BAL NOT NUMERIC                          
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF4-BAL          
           END-IF.                                                              
                                                                                
      *SURVEY FEE                                                               
           IF K671-AMT-SRVY-FEE-CASH   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SRVY-FEE-CASH               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF1   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SRVY-FEE-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SRVY-FEE-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SRVY-FEE-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SRVY-FEE-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF1-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF2-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF3-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF4-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF1-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF1-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF2-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF3-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-SRVY-FEE-CPF4-BAL            
           END-IF.                                                              
                                                                                
      *LEASE ESCROW FEE                                                         
           IF K671-AMT-LSE-ESCR-CASH   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-ESCR-CASH               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF1   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-ESCR-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-ESCR-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-ESCR-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-ESCR-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF1-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF2-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF3-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF4-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF1-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF1-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF2-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF3-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-ESCR-CPF4-BAL            
           END-IF.                                                              
                                                                                
      *LEASE REGN FEE                                                           
           IF K671-AMT-LSE-REGN-CASH   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-REGN-CASH               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF1   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-REGN-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-REGN-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-REGN-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-REGN-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF1-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF2-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF3-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF4-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF1-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF1-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF2-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF3-BAL            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4-BAL NOT NUMERIC                            
              MOVE ZEROES              TO K671-AMT-LSE-REGN-CPF4-BAL            
           END-IF.                                                              
                                                                                
      *SOLICITOR BILL                                                           
           IF K671-AMT-SOLICIT-CASH        NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-SOLICIT-CASH                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF1        NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-SOLICIT-CPF1                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2        NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-SOLICIT-CPF2                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3        NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-SOLICIT-CPF3                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4        NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-SOLICIT-CPF4                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF1-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF2-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF3-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF4-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF1-BAL NOT NUMERIC                             
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF1-BAL                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2-BAL NOT NUMERIC                             
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF2-BAL                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3-BAL NOT NUMERIC                             
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF3-BAL                
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4-BAL NOT NUMERIC                             
              MOVE ZEROES          TO  K671-AMT-SOLICIT-CPF4-BAL                
           END-IF.                                                              
                                                                                
      *CAVEAT REGN FEE                                                          
           IF K671-AMT-CAVEAT-REGN-CASH NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CASH           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF1           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF2           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF3           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF4           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF1-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF2-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF3-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF4-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-BAL NOT NUMERIC                         
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF1-BAL           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2-BAL NOT NUMERIC                         
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF2-BAL           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3-BAL NOT NUMERIC                         
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF3-BAL           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4-BAL NOT NUMERIC                         
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF4-BAL           
           END-IF.                                                              
                                                                                
      *REGN DEPOSIT                                                             
           IF K671-AMT-REGN-DEPOSIT-CASH NOT NUMERIC                            
              MOVE ZEROES               TO K671-AMT-REGN-DEPOSIT-CASH           
           END-IF.                                                              
                                                                                
           IF K671-AMT-REGN-DEPOSIT-CPF1 NOT NUMERIC                            
              MOVE ZEROES               TO  K671-AMT-REGN-DEPOSIT-CPF1          
           END-IF.                                                              
                                                                                
           IF K671-AMT-REGN-DEPOSIT-CPF2 NOT NUMERIC                            
              MOVE ZEROES               TO  K671-AMT-REGN-DEPOSIT-CPF2          
           END-IF.                                                              
                                                                                
           IF K671-AMT-REGN-DEPOSIT-CPF3 NOT NUMERIC                            
              MOVE ZEROES               TO  K671-AMT-REGN-DEPOSIT-CPF3          
           END-IF.                                                              
                                                                                
           IF K671-AMT-REGN-DEPOSIT-CPF4 NOT NUMERIC                            
              MOVE ZEROES               TO  K671-AMT-REGN-DEPOSIT-CPF4          
           END-IF.                                                              
                                                                                
      *FRESH CAVEAT FEE                                                         
           IF K671-AMT-FRESH-CAVEAT-CASH  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CASH              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAVEAT-CPF1  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAVEAT-CPF2  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAVEAT-CPF3  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAVEAT-CPF4  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF1-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF1-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF2-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF2-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF3-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF3-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF4-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF4-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF1-BAL NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF1-BAL             
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF2-BAL NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF2-BAL             
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF3-BAL NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF3-BAL             
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF4-BAL NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF4-BAL             
           END-IF.                                                              
                                                                                
      *SUB TRAN STAMP FEE                                                       
           IF K671-AMT-SBTR-SF-CPF1 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF1-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4-BAL               
           END-IF.                                                              
                                                                                
      *SUB TRAN CONVEY FEE                                                      
           IF K671-AMT-SBTR-CF-CPF1 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF1-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4-BAL               
           END-IF.                                                              
                                                                                
      *BUYERS WCV                                                               
           IF K671-AMT-BUYER-WCV-CASH NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CASH                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF1 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF1                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF2 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF2                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF3 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF3                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF4 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF4                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF1-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF1-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF2-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF2-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF3-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF3-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF4-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF4-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF1-BAL  NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF1-BAL             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF2-BAL  NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF2-BAL             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF3-BAL  NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF3-BAL             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF4-BAL  NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF4-BAL             
           END-IF.                                                              
                                                                                
      *BUYERS WCV                                                               
           IF K671-AMT-BANK-WCV-CASH NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CASH                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF1 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF1                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF2 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF2                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF3 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF3                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF4 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF4                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF4-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF1-BAL  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF1-BAL              
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF2-BAL  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF2-BAL              
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF3-BAL  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF3-BAL              
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF4-BAL  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF4-BAL              
           END-IF.                                                              
                                                                                
      *SUBTRAN SF                                                               
           IF K671-AMT-SBTR-SF-CASH NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CASH                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF1 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF1-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4-BAL               
           END-IF.                                                              
                                                                                
      *SUBTRAN CF                                                               
           IF K671-AMT-SBTR-CF-CASH NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CASH                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF1 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF1-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3-BAL               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4-BAL NOT NUMERIC                             
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4-BAL               
           END-IF.                                                              
                                                                                
       8500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       9000-CLOSE-ROUTINE.                                                      
      *------------------------------------------------------------*            
                                                                                
           CLOSE BP13F880                                                       
                 BP13K671                                                       
                 BP13K677.                                                      
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'CLOSE BP13K671 FAIL. STATUS-'                         
                                         WS-K671-STATUS                         
                 MOVE WS-K671-STATUS  TO RETURN-CODE                            
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K677-STATUS                                              
              WHEN 00                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'CLOSE BP13K677 FAIL. STATUS-'                         
                                         WS-K677-STATUS                         
                 MOVE WS-K677-STATUS  TO RETURN-CODE                            
           END-EVALUATE.                                                        
                                                                                
           DISPLAY '*----------- BP13C380 -------------*'.                      
           DISPLAY 'DATE : ' WS-EDITED-DATE.                                    
           DISPLAY SPACES.                                                      
           DISPLAY ' 1. BP13F880 READ      : '  WS-F880-READ.                   
           DISPLAY ' 2. BP13K671 UPDATE    : '  WS-K671-UPDATE.                 
           DISPLAY ' 3. BP13K677 WRITE     : '  WS-K677-WRITE.                  
           DISPLAY SPACES.                                                      
           DISPLAY '*----------------------------------*'.                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
      *                      END OF PROGRAM                        *            
      *------------------------------------------------------------*            
