       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CB95.                                                 
      *AUTHOR.        PAULO CAMIA LEGASPI.                                      
      *DATE-WRITTEN.  05/05/2010.                                               
      ******************************************************************        
      *                SYSTEM OF COMMITMENT (BP13)                     *        
      ******************************************************************        
      * OBJECTIVE : TO READ BP13F730 TO GET BTO APPLICATION DATA       *        
      *           : TO READ BP13K825 TO GET AGE/INCOME/HH-SIZE         *        
      *                                                                *        
      * INPUT  FILES : SY02F001                                        *        
      *                BP13F730                                        *        
      *                BP13K825                                        *        
      *                BP13K595                                        *        
      *                BP13K813                                        *        
      *                BP13K585                                        *        
      *                BP13K587                                        *        
      * OUTPUT FILES : BP13F55A                                        *        
      *                                                                *        
      * CHG-NO   BY    ON    - DESCRIPTION                             *        
      * -------------------------------------------------------------- *        
      * BP133891 PCL3 05/05/10 NEW PROGRAM                             *        
      * BP133952 JB8  07/07/10 TO CATER FOR EMPTY FIELDS               *        
      * BP133950 JB8  08/07/10 TO DECODE NT                            *        
      * BP133961 PCL3 14/07/10 TO ADD SBF OCT 2009                     *        
      * BP133921 PCL3 08/09/10 TO ADD SBF AUG 2010                     *        
      * BP133921 PCL3 15/09/10 TO BYPASS CANCELLED CASES               *        
      * BP134137 PCL3 09/02/11 TO ADD 201101 TO 201109 DTE-BALLOT      *        
      * BP134247 PCL3 08/06/11 TO ADD REQUEST-STATUS                   *        
      * BP134304 PCL3 01/08/11 TO ADD READING OF BP13K585, BP13K813 AND*        
      *                        BP13K587.                               *        
      * BP134304 LSB3 16/08/11 TO ADD NE-TAG, PENDING TAG              *        
      * BP134562 IMC1 13/04/12 CHANGE DATE RANGE FROM 2011 TO 2013     *        
      * BP134562 IMC1 08/06/12 INTEGRATE BP13CF94 FUNCTIONALITY        *        
      * BP134620 IMC1 24/07/12 MOVE MGPS AND MCPS INFO                 *        
      * BP134803 IMC1 13/03/13 ADD HA1,HA2,YC CITIZENSHIP              *        
      * BP134924 IMC1 28/05/13 CATER TO AST CHANGE                     *        
      * BP134931 IMC1 16/07/13 ADD NEW BP13F730 OUTPUT FOR PPS         *        
      * BP135002 IMC1 26/07/13 ADD FT2T FIELD                          *        
      * BP134996 IMC1 02/08/13 CHECK FOR FTS SCHEME BEFORE ADDING HH INC        
      * BP135059 SMR2 23/09/13 CATER FOR 3GEN & SEX-HA1 CHANGES        *        
      * BP135089 SMR2 30/09/13 CATER FOR BTO-ZONE & ADDITIONAL-FLAT    *        
      * BP135089 SMR2 03/10/13 CATER FOR CDE-BALLOT-HOUSEHOLD          *        
      * BP135148 SMR2 28/11/13 CHANGE 201309 (SBF) TO 201311 (SBF)              
      * BP135190 SMR2 04/12/13 EXPAND BP13K813 TO 1000                 *        
      * BP135251 ZDD1 24/03/14 ADD BTOSBF AND FTS COUNT                *        
      * BP135251 IMC1 03/06/14 BYPASS COUNTING FOR GRO CASES           *        
      * BP135251 IMC1 13/06/14 OUTPUT BP13F55Y AND BP13F55Z            *        
      * BP13     IMC1 21/07/14 BYPASS FTS CASES FOR F55Y AND F55Z      *        
      * BP135338 IMC1 29/09/14 EXTEND DATE BALLOT UPTO 201509          *        
      * BP135338 IMC1 29/10/14 ADD ALLO-CAT TO BP13F55Z                *        
      *                        INCLUDE 'B' WHEN CHECKING F730-NUM-MCPS *        
      * BP135546 SMR2 17/02/15 CATER FOR DATE BALLOT 201502, 201505,   *        
      *                        201508 AND 201511 / DELETE 201503 /     *        
      *                        CATER FOR FTS-Y201307 & FTSPA-Y201307   *        
      * BP135546 SMR2 13/05/15 DECODE CITIZENSHIP & MARITAL STATUS     *        
      * BP135785 FNP1 22/07/15 CATER FOR BP13K585 KEY EXPANSION        *        
      * BP136005 FNP1 03/11/15 ADD SPS, ELDERLY AND PPO COLUMNS                 
      * BP136124 FNP1 19/02/16 EXPAND AGE FIELDS TO 3 BYTES, ADD DTEREG         
      * BP136363 FNP1 25/08/16 CATER FOR DTE-BALLOT 201608, 201611,    *        
      *                        201702, 201705, 201708, 201711          *        
      * BP136888 FNP1 15/06/17 CATER FOR DTE-BALLOT ROF MODE           *        
      *                        DECODE NT ONLY FOR NUMERIC VALUES                
      * BP136902 SMR2 17/08/17 BYPASS WRITING TO BP13F55Y AND BP13F55Z *        
      *                        WHEN RECORD IS NON-ELDERLY              *        
      * BP137358 FNP1 25/05/18 CATER FOR DTE-BALLOT 201802, 201805,    *        
      *                        201808, 201811                          *        
      * BP137786  KV6 18/04/19 CATER FOR DTE-BALLOT OBF MODE           *        
      * BP138017 FNP1 30/05/19 CATER FOR DTE-BALLOT 201902, 201905,    *        
      *                        201909, 201911                                   
      * BP138417 KR13 24/08/20 REMOVE 2013 AND ADD 2020 & 2021.        *        
      * BP138603 KR13 02/01/21 ADD CCA TAG.                            *        
      * BP139220 KR13 03/06/22 REMOVE 2014 AND ADD 2022.               *        
      * BP139554 FP10 15/05/23 REMOVE 2015-2017, ADD 2023-2025         *        
      * BP139778 MRR5 31/10/23 REPL 202308, 202311 WITH 202310, 202312 *        
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT   SY02F001      ASSIGN TO SY02F001.                           
           SELECT   BP13F730      ASSIGN TO BP13F730.                           
                                                                                
           SELECT   BP13K595      ASSIGN TO BP13K595                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K595-KEY-FLD                        
                    ALTERNATE RECORD KEY IS K595-NUM-NRIC1                      
                    ALTERNATE RECORD KEY IS K595-NUM-NRIC2                      
                    ALTERNATE RECORD KEY IS K595-NUM-NRIC3                      
                    ALTERNATE RECORD KEY IS K595-NUM-NRIC4                      
                             FILE STATUS IS K595-STATUS.                        
                                                                                
           SELECT   BP13K730      ASSIGN TO BP13K730                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K730-KEY-NEW                        
                    ALTERNATE RECORD KEY IS K730-ALT1-KEY                       
                    ALTERNATE RECORD KEY IS K730-ALT2-KEY                       
                             FILE STATUS IS K730-STATUS.                        
                                                                                
           SELECT   BP13K585      ASSIGN TO BP13K585                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS RANDOM                              
                              RECORD KEY IS K585-KEY-FLD                        
                             FILE STATUS IS K585-STATUS.                        
                                                                                
           SELECT   BP13K587      ASSIGN TO BP13K587                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS RANDOM                              
                              RECORD KEY IS K587-KEY-FLD                        
                             FILE STATUS IS K587-STATUS.                        
                                                                                
           SELECT   BP13K820      ASSIGN TO BP13K820                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K820-KEY-FLD                        
                             FILE STATUS IS K820-STATUS.                        
                                                                                
           SELECT   BP13K825      ASSIGN TO BP13K825                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K825-KEY-FLD                        
                             FILE STATUS IS K825-STATUS.                        
                                                                                
           SELECT   BP13K828      ASSIGN TO BP13K828                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K828-KEY-FLD                        
                             FILE STATUS IS K828-STATUS.                        
                                                                                
           SELECT   BP13K813      ASSIGN TO BP13K813                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS DYNAMIC                             
                              RECORD KEY IS K813-KEY-FLD                        
                             FILE STATUS IS K813-STATUS.                        
                                                                                
           SELECT   BP13K060      ASSIGN TO BP13K060                            
                            ORGANIZATION IS INDEXED                             
                             ACCESS MODE IS RANDOM                              
                              RECORD KEY IS K060-KEY-FLD                        
                             FILE STATUS IS K060-STATUS.                        
                                                                                
           SELECT   BP13F55A      ASSIGN TO BP13F55A.                           
                                                                                
           SELECT   P13F730A      ASSIGN TO P13F730A.                           
                                                                                
           SELECT   BP13F55Y      ASSIGN TO BP13F55Y.                           
                                                                                
           SELECT   BP13F55Z      ASSIGN TO BP13F55Z.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       COPY SY02F001.                                                           
                                                                                
                                                                                
       FD  BP13K595                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BP13K595.                                                           
                                                                                
       FD  BP13K730                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BP13K730.                                                           
                                                                                
       FD  BP13K585                                                             
           RECORD CONTAINS 2000 CHARACTERS.                                     
       COPY BP13K585.                                                           
                                                                                
       FD  BP13K587                                                             
           RECORD CONTAINS 2000 CHARACTERS.                                     
       COPY BP13K587.                                                           
                                                                                
       FD   BP13F730                                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F730.                                                           
                                                                                
       FD   BP13K060                                                            
            RECORD CONTAINS 25 CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K828                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K828.                                                           
                                                                                
       FD   BP13F55A                                                            
            RECORD CONTAINS 1200 CHARACTERS                                     
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F55A.                                                           
                                                                                
       FD   P13F730A                                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       01   P13F730A-REC      PIC X(500).                                       
                                                                                
       FD   BP13F55Y                                                            
            RECORD CONTAINS 250 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F55Y.                                                           
                                                                                
       FD   BP13F55Z                                                            
            RECORD CONTAINS 400 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F55Z.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
                                                                                
       01  WS-COUNTERS.                                                         
           05  CNT-F120-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-F730-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K825-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K828-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-K820-READ                PIC 9(7)  VALUE ZEROS.              
           05  CNT-F55A-WRITE               PIC 9(7)  VALUE ZEROS.              
           05  CNT-F55Y-WRITE               PIC 9(7)  VALUE ZEROS.              
           05  CNT-F55Z-WRITE               PIC 9(7)  VALUE ZEROS.              
           05  CNT-F73A-WRITE               PIC 9(7)  VALUE ZEROS.              
           05  CNT-BYPASS                   PIC 9(7)  VALUE ZEROS.              
           05  CNT-K595-NRIC1               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K595-NRIC2               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K595-NRIC3               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K595-NRIC4               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K595-NOTFND              PIC 9(7)  VALUE ZEROS.              
           05  CNT-K730-NRIC1               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K730-NRIC2               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K730-NRIC3               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K730-NRIC4               PIC 9(7)  VALUE ZEROS.              
           05  CNT-K730-NOTFND              PIC 9(7)  VALUE ZEROS.              
           05  CNT-CHILD                    PIC 9(1)  VALUE ZEROS.              
           05  CNT-HH-SIZE                  PIC 9(2)  VALUE ZEROS.              
           05  CNT-CANCEL                   PIC 9(7)  VALUE ZEROS.              
                                                                                
       01  WS-K595-LATEST.                                                      
           05  WS-NUM-REGNO            PIC X(8)  VALUE SPACES.                  
           05  WS-NUM-ALLO-CAT         PIC X(3)  VALUE SPACES.                  
           05  WS-DTE-BALLOT           PIC X(6)  VALUE SPACES.                  
           05  WS-CDE-FLAT-TYPE        PIC X(2)  VALUE SPACES.                  
           05  WS-CDE-ELIG-SCH         PIC X(3)  VALUE SPACES.                  
           05  WS-CDE-ALLO-SCH         PIC X(3)  VALUE SPACES.                  
           05  WS-CDE-NT1              PIC X(3)  VALUE SPACES.                  
           05  WS-CDE-NT1-F730         PIC X(3)  VALUE SPACES.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-HH-NRICS.                                                     
               10  WS-HH-NRIC OCCURS 20 TIMES                                   
                                            PIC X(09) VALUE SPACES.             
           05  K820-STATUS                  PIC 99    VALUE ZEROES.             
           05  K825-STATUS                  PIC 99    VALUE ZEROES.             
           05  K828-STATUS                  PIC 99    VALUE ZEROES.             
           05  K060-STATUS                  PIC 99    VALUE ZEROES.             
           05  K813-STATUS                  PIC 99    VALUE ZEROES.             
           05  K595-STATUS                  PIC 99    VALUE ZEROES.             
           05  K730-STATUS                  PIC 99    VALUE ZEROES.             
           05  K585-STATUS                  PIC 99    VALUE ZEROES.             
           05  K587-STATUS                  PIC 99    VALUE ZEROES.             
           05  WS-K820-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K825-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K828-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K595-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-K730-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-HIST-FND                  PIC X(1)  VALUE 'N'.                
           05  WS-F730-EOF                  PIC X(1)  VALUE 'N'.                
           05  WS-NRIC-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K825-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K820-FOUND                PIC X(1)  VALUE 'N'.                
           05  WS-K825-FND                  PIC X(01) VALUE SPACE.              
               88  K825-FND                 VALUE 'Y'.                          
           05  WS-K828-FND                  PIC X(01) VALUE SPACE.              
               88  K828-FND                 VALUE 'Y'.                          
           05  WS-K820-FND                  PIC X(01) VALUE SPACE.              
               88  K820-FND                 VALUE 'Y'.                          
           05  WS-HH-SIZE                   PIC 99    VALUE ZEROES.             
           05  WS-NUM-AGE                   PIC 9(08) VALUE ZEROES.             
           05  WS-AGE REDEFINES WS-NUM-AGE.                                     
               10  WS-AGE-CY                PIC 9(04).                          
               10  WS-AGE-MM                PIC 9(02).                          
               10  WS-AGE-DD                PIC 9(02).                          
           05  WS-F595-BALDATE              PIC X(8)  VALUE SPACES.             
           05  WS-HA1-ETHNIC                PIC X(1)  VALUE SPACE.              
           05  WS-HA2-ETHNIC                PIC X(1)  VALUE SPACE.              
           05  WS-CDE-RACE                  PIC X(1)  VALUE SPACE.              
           05  WS-HA1-MS                    PIC X(01) VALUE SPACE.              
           05  WS-HA2-MS                    PIC X(01) VALUE SPACE.              
           05  WS-HA1-SEX                   PIC X(01) VALUE SPACES.             
           05  WS-HA2-SEX                   PIC X(01) VALUE SPACES.             
           05  WS-HA1-BIRTH                 PIC X(08) VALUE ZEROES.             
           05  WS-HA2-BIRTH                 PIC X(08) VALUE ZEROES.             
           05  WS-HA1-CTZN                  PIC X(02) VALUE ZEROES.             
           05  WS-HA2-CTZN                  PIC X(02) VALUE ZEROES.             
           05  WS-NUM-REGN                  PIC 9(08) VALUE ZEROES.             
           05  WS-NUM-BIRTH                 PIC 9(08) VALUE ZEROES.             
           05  WS-CTR                       PIC 9(02) VALUE ZEROES.             
           05  WS-HH-SCP                    PIC X(3)  VALUE SPACES.             
           05  WS-HH-SCH                    PIC X(3)  VALUE SPACES.             
           05  WS-BALLOT-HOUSEHOLD          PIC X(1)  VALUE SPACES.             
           05  WS-NUM-DTEBAL.                                                   
               10 WS-DTE-BAL-YY             PIC 9(04) VALUE ZEROES.             
               10 WS-DTE-BAL-MM             PIC 9(02) VALUE ZEROES.             
           05  WS-NUM-DTEBAL-HIST.                                              
               10 WS-DTE-BAL-HIST-YY        PIC 9(04) VALUE ZEROES.             
               10 WS-DTE-BAL-HIST-MM        PIC 9(02) VALUE ZEROES.             
           05  WS-CNT-DTEBAL                PIC 9(02) VALUE ZEROES.             
           05  WS-TRY                       PIC 9(02) VALUE ZEROES.             
           05  WS-TRY-BTO-SBF               PIC 9(02) VALUE ZEROES.             
           05  WS-TRY-FTS                   PIC 9(02) VALUE ZEROES.             
           05  WS-TRY-FTS-Y201307           PIC 9(02) VALUE ZEROES.             
           05  WS-TRY-FTSPA-Y201307         PIC 9(02) VALUE ZEROES.             
           05  WS-PRT-CTR1                  PIC 9(05) VALUE ZEROES.             
           05  WS-PRT-CTR2                  PIC 9(05) VALUE ZEROES.             
           05  WS-SNO1                      PIC 9(5)  VALUE ZEROES.             
           05  WS-SNO2                      PIC 9(5)  VALUE ZEROES.             
           05  WS-MATURE                    PIC X(1)  VALUE SPACES.             
           05  WS-NUM-HA1-AGE               PIC 9(4)  VALUE ZEROES.             
           05  WS-K585-FOUND                PIC X(01) VALUE 'N'.                
           05  WS-NUM-FLAT-CATEGORY         PIC X(10) VALUE SPACES.             
           05  WS-NME-PROJECT-LTR           PIC X(50) VALUE SPACES.             
           05  WS-NUM-ADD-FLAT              PIC X(01) VALUE SPACES.             
           05  WS-NUM-AGE-CHILD             PIC 9(3)  VALUE ZEROES.             
           05  WS-NUM-CHILD-CIT             PIC X(02) VALUE SPACES.             
           05  WS-BALLOT-DTE.                                                   
               10  WS-BALLOT-DTE-YR         PIC 9(4)  VALUE ZEROES.             
               10  WS-BALLOT-DTE-MON        PIC 9(2)  VALUE ZEROES.             
           05  WS-BALLOT-END.                                                   
               10  WS-BALLOT-YR             PIC 9(4)  VALUE ZEROES.             
               10  WS-BALLOT-MON            PIC 9(2)  VALUE ZEROES.             
           05  WS-F730-REC-NFND             PIC X(01) VALUE 'N'.                
           05  WS-SPACE                     PIC X(01) VALUE 'N'.                
           05  WS-F585-TRANS                PIC X(01) VALUE SPACES.             
                                                                                
      *****************************************************************         
       PROCEDURE DIVISION.                                                      
      *****************************************************************         
                                                                                
      *===============================================================*         
       0000-MAIN.                                                               
      *===============================================================*         
                                                                                
           PERFORM 1000-OPEN-FILES          THRU 1000-EXIT.                     
           PERFORM 2000-READ-BP13F730       THRU 2000-EXIT.                     
           PERFORM 3000-PROCESS-RECORD      THRU 3000-EXIT                      
             UNTIL WS-F730-EOF = 'Y'.                                           
                                                                                
           PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       1000-OPEN-FILES.                                                         
      *===============================================================*         
                                                                                
           OPEN INPUT SY02F001                                                  
                      BP13F730                                                  
                      BP13K820                                                  
                      BP13K825                                                  
                      BP13K828                                                  
                      BP13K595                                                  
                      BP13K730                                                  
                      BP13K813                                                  
                      BP13K060                                                  
                      BP13K585                                                  
                      BP13K587                                                  
               OUTPUT BP13F55A                                                  
                      P13F730A                                                  
                      BP13F55Y                                                  
                      BP13F55Z.                                                 
                                                                                
           READ SY02F001.                                                       
                                                                                
           IF K585-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K585 , STATUS = ' K585-STATUS          
              MOVE K585-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K587-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K587 , STATUS = ' K587-STATUS          
              MOVE K587-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K813-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K813 , STATUS = ' K813-STATUS          
              MOVE K813-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K595-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K595 , STATUS = ' K595-STATUS          
              MOVE K595-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K730-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K730 , STATUS = ' K730-STATUS          
              MOVE K730-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
                                                                                
           IF K825-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K825 , STATUS = ' K825-STATUS          
              MOVE K825-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K820 , STATUS = ' K820-STATUS          
              MOVE K820-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K828-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K828 , STATUS = ' K828-STATUS          
              MOVE K825-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
           IF K060-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR OPENING BP13K060 , STATUS = ' K060-STATUS          
              MOVE K060-STATUS               TO RETURN-CODE                     
              GO TO 9000-CLOSE-FILES                                            
           END-IF.                                                              
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       2000-READ-BP13F730.                                                      
      *===============================================================*         
                                                                                
           MOVE SPACES        TO WS-F585-TRANS.                                 
                                                                                
           READ BP13F730                                                        
             AT END                                                             
                MOVE 'Y'                TO WS-F730-EOF                          
                GO                      TO 2000-EXIT                            
           END-READ.                                                            
                                                                                
           ADD  1                       TO CNT-F730-READ.                       
                                                                                
           IF CNT-F730-READ = 1                                                 
             MOVE F730-DTE-BALLOT    TO WS-BALLOT-END                           
                                                                                
             COMPUTE WS-BALLOT-YR = WS-BALLOT-YR   - 1                          
                                                                                
             IF WS-BALLOT-MON = 12                                              
                MOVE  01     TO   WS-BALLOT-MON                                 
                ADD   01     TO   WS-BALLOT-YR                                  
             ELSE                                                               
                COMPUTE WS-BALLOT-MON = WS-BALLOT-MON + 1                       
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF F730-CDE-ALLOC-SCH = 'FTS'                                        
              MOVE '4'     TO WS-F585-TRANS                                     
           ELSE                                                                 
              IF F730-CDE-BALLOT-HOUSEHOLD = 'H' OR 'T'                         
                 MOVE '1'         TO WS-F585-TRANS                              
              ELSE                                                              
                 IF F730-CDE-BALLOT-HOUSEHOLD = 'G' OR 'F'                      
                    IF F730-NUM-FT2T = 'Y'                                      
                       MOVE '2'   TO WS-F585-TRANS                              
                    ELSE                                                        
                       MOVE '3'   TO WS-F585-TRANS                              
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3000-PROCESS-RECORD.                                                     
      *===============================================================*         
                                                                                
           PERFORM 3100-GENERATE-OUTPUT              THRU 3100-EXIT.            
           PERFORM 7500-FILL-EMPTY-FIELDS            THRU 7500-EXIT.            
           PERFORM 7600-POPULATE-BP13F55Y            THRU 7600-EXIT.            
           PERFORM 8000-WRITE-BP13F55A               THRU 8000-EXIT.            
           PERFORM 8100-WRITE-P13F730A               THRU 8100-EXIT.            
           IF F55Y-NUM-HH =  'G' AND                                            
              F55Y-NUM-ALLO-SCHEME = 'FTS'  AND                                 
             (F55Y-NUM-ELDERLY = ' ' OR 'N')                                    
              ADD 1 TO CNT-BYPASS                                               
           ELSE                                                                 
              PERFORM 8200-WRITE-BP13F55Y               THRU 8200-EXIT          
              PERFORM 8300-WRITE-BP13F55Z               THRU 8300-EXIT          
           END-IF                                                               
                                                                                
           PERFORM 2000-READ-BP13F730                THRU 2000-EXIT.            
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3010-INITIALIZE.                                                         
      *===============================================================*         
                                                                                
           MOVE SPACES                    TO WS-CDE-NT1                         
                                             WS-CDE-NT1-F730                    
                                             WS-MATURE.                         
                                                                                
           MOVE ZEROES                    TO WS-NUM-HA1-AGE.                    
                                                                                
       3010-EXIT.                                                               
           EXIT.                                                                
      *===============================================================*         
       3100-GENERATE-OUTPUT.                                                    
      *===============================================================*         
                                                                                
           MOVE SPACES                           TO BP13F55A-REC                
                                                    BP13F55Y-REC                
                                                    BP13F55Z-REC                
           INITIALIZE                               BP13F55A-REC                
                                                    BP13F55Y-REC                
                                                    BP13F55Z-REC                
                                                    WS-NUM-AGE-CHILD            
                                                    WS-NUM-CHILD-CIT            
           MOVE SPACES                         TO WS-BALLOT-HOUSEHOLD.          
                                                                                
           PERFORM 4000-READ-OCCUPIERS         THRU 4000-EXIT.                  
           PERFORM 4800-READ-APPLICANT         THRU 4800-EXIT.                  
           PERFORM 7700-POPULATE-BP13F55Z      THRU 7700-EXIT.                  
      *    PERFORM 5000-PROCESS-NRIC-K730      THRU 5000-EXIT.                  
           PERFORM 6000-PROCESS-NRIC-K595      THRU 6000-EXIT.                  
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3200-START-BP13K820.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K820-REC               
           INITIALIZE                                BP13K820-REC.              
           MOVE 'N'                               TO WS-K820-EOF                
                                                     WS-K820-FND.               
                                                                                
           MOVE F730-NUM-REGN                     TO K820-NUM-REGN              
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           IF K820-STATUS = 00 OR 02                                            
              MOVE 'Y'                            TO WS-K820-FND                
           ELSE                                                                 
              IF K820-STATUS = 23 OR 10                                         
                 MOVE 'N'                         TO WS-K820-FND                
              ELSE                                                              
                 DISPLAY 'BP13K820 - ERROR STARTING : ' K820-STATUS             
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3300-READNEXT-BP13K820.                                                  
      *===============================================================*         
                                                                                
           READ BP13K820 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K820-EOF                                      
                GO          TO 3300-EXIT                                        
           END-READ.                                                            
                                                                                
           IF K820-STATUS = 00 OR 02                                            
              IF K820-NUM-REGN = F730-NUM-REGN                                  
                 MOVE 'Y'                         TO WS-K820-FOUND              
                 ADD 1                            TO CNT-HH-SIZE                
                                                                                
                 IF K820-NUM-RELATIONSHIP NOT NUMERIC                           
                    MOVE ZEROES           TO K820-NUM-RELATIONSHIP              
                 END-IF                                                         
                                                                                
                 IF K820-NUM-RELATIONSHIP = 41                                  
                    ADD 1                 TO CNT-CHILD                          
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'                         TO WS-K820-EOF                
              END-IF                                                            
           ELSE                                                                 
              IF K820-STATUS = 23 OR 10                                         
                 MOVE 'Y'                         TO WS-K820-EOF                
              ELSE                                                              
                 DISPLAY 'BP13K820 - ERROR READING NEXT : ' K820-STATUS         
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3400-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF F730-DTE-REQUEST NOT NUMERIC                                      
              MOVE ZEROES                         TO WS-NUM-REGN                
           ELSE                                                                 
              MOVE F730-DTE-REQUEST               TO WS-NUM-REGN                
           END-IF.                                                              
           IF K820-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K820-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K820-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K820-AMT-INCOME            
           END-IF.                                                              
                                                                                
           IF WS-NUM-REGN > WS-NUM-BIRTH                                        
              COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                   
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF                                                               
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF                                                               
                                                                                
           IF F730-CDE-ALLOC-SCH = 'FTS' AND                                    
             (K820-NUM-NRIC NOT = F730-NUM-NRIC1 AND F730-NUM-NRIC2 AND         
                                  F730-NUM-NRIC3 AND F730-NUM-NRIC4)            
              CONTINUE                                                          
           ELSE                                                                 
              ADD K820-AMT-INCOME                TO F55A-AMT-HSE-INCOME         
                                                    F55Y-AMT-HSE-INCOME         
           END-IF.                                                              
                                                                                
           EVALUATE K820-NUM-NRIC                                               
               WHEN F730-NUM-NRIC1                                              
                    MOVE K820-NUM-NRIC           TO F55A-NUM-NRIC1              
                                                    F55Y-NUM-NRIC1              
                    MOVE WS-AGE-CY(2:3)          TO F55A-NUM-AGE-HA1            
                                                    F55Y-NUM-AGE-APP1           
                    MOVE WS-AGE-CY(3:2)          TO F55Y-NUM-AGE-HA1            
                    MOVE K820-NUM-ETHNIC         TO WS-HA1-ETHNIC               
                    MOVE K820-NUM-SEX            TO WS-HA1-SEX                  
                    MOVE K820-NUM-MARITAL-STATUS TO                             
                                                 F55A-NUM-MARITAL-HA1           
                                                 F55Y-NUM-MARITAL-HA1           
                    MOVE K820-NUM-CITIZENSHIP    TO F55A-NUM-CITIZEN-HA1        
                                                    F55Y-NUM-CITIZEN-HA1        
               WHEN F730-NUM-NRIC2                                              
                    MOVE K820-NUM-NRIC           TO F55A-NUM-NRIC2              
                                                    F55Y-NUM-NRIC2              
                    MOVE WS-AGE-CY(2:3)          TO F55A-NUM-AGE-HA2            
                                                    F55Y-NUM-AGE-APP2           
                    MOVE WS-AGE-CY(3:2)          TO F55Y-NUM-AGE-HA2            
                    MOVE K820-NUM-ETHNIC         TO WS-HA2-ETHNIC               
                    MOVE K820-NUM-SEX            TO WS-HA2-SEX                  
                    MOVE K820-NUM-MARITAL-STATUS TO                             
                                                 F55Y-NUM-MARITAL-HA2           
                    MOVE K820-NUM-CITIZENSHIP    TO F55A-NUM-CITIZEN-HA2        
                                                    F55Y-NUM-CITIZEN-HA2        
           END-EVALUATE.                                                        
                                                                                
           IF K820-NUM-RELATIONSHIP = 41 AND                                    
              K820-NUM-MARITAL-STATUS   = 1                                     
              IF WS-NUM-AGE-CHILD = ZEROES                                      
                 MOVE WS-AGE-CY(2:3)       TO WS-NUM-AGE-CHILD                  
                 MOVE K820-NUM-CITIZENSHIP TO WS-NUM-CHILD-CIT                  
              ELSE                                                              
                 IF WS-AGE-CY   < WS-NUM-AGE-CHILD                              
                    MOVE WS-AGE-CY(2:3)   TO WS-NUM-AGE-CHILD                   
                    MOVE K820-NUM-CITIZENSHIP TO WS-NUM-CHILD-CIT               
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       3500-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K820-NUM-RELATIONSHIP NOT = '00'                                 
               IF K820-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K820-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4000-READ-OCCUPIERS.                                                     
      *===============================================================*         
                                                                                
           MOVE 0                                   TO WS-HH-SIZE               
                                                       WS-AGE                   
                                                       CNT-CHILD                
                                                       CNT-HH-SIZE              
                                                       WS-NUM-HA1-AGE.          
           MOVE SPACES                              TO WS-HH-NRICS              
                                                       WS-HA1-ETHNIC            
                                                       WS-HA1-SEX               
                                                       WS-HA2-ETHNIC            
                                                       WS-HA2-SEX               
                                                       WS-HH-SCP                
                                                       WS-HH-SCH.               
                                                                                
           MOVE 'N'                                 TO WS-K820-FOUND.           
           PERFORM 3200-START-BP13K820            THRU 3200-EXIT.               
           IF K820-FND                                                          
              PERFORM UNTIL WS-K820-EOF = 'Y'                                   
                 PERFORM 3300-READNEXT-BP13K820   THRU 3300-EXIT                
                 IF NOT WS-K820-EOF = 'Y'                                       
                    ADD 1                           TO CNT-K820-READ            
                    PERFORM 3400-COMPUTE-AGE      THRU 3400-EXIT                
                    PERFORM 3500-CHECK-CTZSHP-CDE THRU 3500-EXIT                
                 END-IF                                                         
              END-PERFORM                                                       
              MOVE WS-NUM-CHILD-CIT      TO F55A-NUM-YOUNG-CHILD-CITIZEN        
                                            F55Y-NUM-YOUNG-CHILD-CITIZEN        
           END-IF.                                                              
                                                                                
           IF WS-K820-FOUND = 'N'                                               
              MOVE 'N'                              TO WS-K825-FOUND            
              PERFORM 4200-START-BP13K825                THRU 4200-EXIT         
              IF K825-FND                                                       
                 PERFORM UNTIL WS-K825-EOF = 'Y'                                
                    PERFORM 4300-READNEXT-BP13K825       THRU 4300-EXIT         
                        IF NOT WS-K825-EOF = 'Y'                                
                           ADD 1                       TO CNT-K825-READ         
                           PERFORM 4400-COMPUTE-AGE      THRU 4400-EXIT         
                           PERFORM 4450-CHECK-CTZSHP-CDE THRU 4450-EXIT         
                        END-IF                                                  
                 END-PERFORM                                                    
               END-IF                                                           
               MOVE WS-NUM-CHILD-CIT     TO F55A-NUM-YOUNG-CHILD-CITIZEN        
                                            F55Y-NUM-YOUNG-CHILD-CITIZEN        
           ELSE                                                                 
              MOVE 'Y'                               TO WS-K825-FOUND           
           END-IF.                                                              
                                                                                
           IF WS-K825-FOUND = 'N'                                               
              PERFORM 4010-START-BP13K828            THRU 4010-EXIT             
              IF K828-FND                                                       
                 PERFORM UNTIL WS-K828-EOF = 'Y'                                
                    PERFORM 4020-READNEXT-BP13K828   THRU 4020-EXIT             
                    IF NOT WS-K828-EOF = 'Y'                                    
                       ADD 1                           TO CNT-K828-READ         
                       PERFORM 4500-COMPUTE-AGE      THRU 4500-EXIT             
                       PERFORM 4550-CHECK-CTZSHP-CDE THRU 4550-EXIT             
                    END-IF                                                      
                 END-PERFORM                                                    
                 MOVE WS-NUM-CHILD-CIT   TO F55A-NUM-YOUNG-CHILD-CITIZEN        
                                            F55Y-NUM-YOUNG-CHILD-CITIZEN        
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF  WS-HH-SCH NOT = SPACES                                           
               MOVE 'SCH'           TO F55A-CDE-CITIZENSHIP-HOUSEHOLD           
                                       F55Y-CDE-CITIZENSHIP-HOUSEHOLD           
           ELSE                                                                 
               MOVE 'SCP'           TO F55A-CDE-CITIZENSHIP-HOUSEHOLD           
                                       F55Y-CDE-CITIZENSHIP-HOUSEHOLD           
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4010-START-BP13K828.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K828-REC               
           INITIALIZE                                BP13K828-REC.              
           MOVE 'N'                               TO WS-K828-EOF                
                                                     WS-K828-FND.               
                                                                                
           MOVE F730-NUM-REGN                     TO K828-NUM-REGN              
                                                                                
           START BP13K828 KEY >= K828-KEY-FLD.                                  
                                                                                
           IF K828-STATUS = 00 OR 02                                            
              MOVE 'Y'                            TO WS-K828-FND                
           ELSE                                                                 
              IF K828-STATUS = 23 OR 10                                         
                 MOVE 'N'                         TO WS-K828-FND                
              ELSE                                                              
                 DISPLAY 'BP13K828 - ERROR STARTING : ' K828-STATUS             
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4020-READNEXT-BP13K828.                                                  
      *===============================================================*         
                                                                                
           READ BP13K828 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K828-EOF                                      
                GO          TO 4020-EXIT                                        
           END-READ.                                                            
                                                                                
           IF K828-STATUS = 00 OR 02                                            
              IF K828-NUM-REGN = F730-NUM-REGN                                  
                 ADD 1                            TO CNT-HH-SIZE                
                                                                                
                 IF K828-NUM-RELATIONSHIP NOT NUMERIC                           
                    MOVE ZEROES           TO K828-NUM-RELATIONSHIP              
                 END-IF                                                         
                                                                                
                 IF K828-NUM-RELATIONSHIP = 41                                  
                    ADD 1                 TO CNT-CHILD                          
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'                         TO WS-K828-EOF                
              END-IF                                                            
           ELSE                                                                 
              IF K828-STATUS = 23 OR 10                                         
                 MOVE 'Y'                         TO WS-K828-EOF                
              ELSE                                                              
                 DISPLAY 'BP13K828 - ERROR READING NEXT : ' K828-STATUS         
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4200-START-BP13K825.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K825-REC               
           INITIALIZE                                BP13K825-REC.              
           MOVE 'N'                               TO WS-K825-EOF                
                                                     WS-K825-FND.               
                                                                                
           MOVE F730-NUM-REGN                     TO K825-NUM-REGN              
                                                                                
           START BP13K825 KEY >= K825-KEY-FLD.                                  
                                                                                
           IF K825-STATUS = 00 OR 02                                            
              MOVE 'Y'                            TO WS-K825-FND                
           ELSE                                                                 
              IF K825-STATUS = 23 OR 10                                         
                 MOVE 'N'                         TO WS-K825-FND                
              ELSE                                                              
                 DISPLAY 'BP13K825 - ERROR STARTING : ' K825-STATUS             
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4300-READNEXT-BP13K825.                                                  
      *===============================================================*         
                                                                                
           READ BP13K825 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K825-EOF                                      
                GO          TO 4300-EXIT                                        
           END-READ.                                                            
                                                                                
           IF K825-STATUS = 00 OR 02                                            
              IF K825-NUM-REGN = F730-NUM-REGN                                  
                 MOVE 'Y'                         TO WS-K825-FOUND              
                 ADD 1                            TO CNT-HH-SIZE                
                                                                                
                 IF K825-NUM-RELATIONSHIP NOT NUMERIC                           
                    MOVE ZEROES           TO K825-NUM-RELATIONSHIP              
                 END-IF                                                         
                                                                                
                 IF K825-NUM-RELATIONSHIP = 41                                  
                    ADD 1                 TO CNT-CHILD                          
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'                         TO WS-K825-EOF                
              END-IF                                                            
           ELSE                                                                 
              IF K825-STATUS = 23 OR 10                                         
                 MOVE 'Y'                         TO WS-K825-EOF                
              ELSE                                                              
                 DISPLAY 'BP13K825 - ERROR READING NEXT : ' K825-STATUS         
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4400-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF F730-DTE-REQUEST NOT NUMERIC                                      
              MOVE ZEROES                         TO WS-NUM-REGN                
           ELSE                                                                 
              MOVE F730-DTE-REQUEST               TO WS-NUM-REGN                
           END-IF.                                                              
           IF K825-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K825-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
                                                                                
           IF K825-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K825-AMT-INCOME            
           END-IF.                                                              
                                                                                
           IF WS-NUM-REGN > WS-NUM-BIRTH                                        
              COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                   
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF                                                               
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF                                                               
                                                                                
           IF K825-NUM-NRIC = F730-NUM-NRIC1                                    
              MOVE WS-AGE-CY                TO WS-NUM-HA1-AGE                   
           END-IF                                                               
                                                                                
           IF F730-CDE-ALLOC-SCH = 'FTS' AND                                    
             (K825-NUM-NRIC NOT = F730-NUM-NRIC1 AND F730-NUM-NRIC2 AND         
                                  F730-NUM-NRIC3 AND F730-NUM-NRIC4)            
              CONTINUE                                                          
           ELSE                                                                 
              ADD K825-AMT-INCOME                TO F55A-AMT-HSE-INCOME         
                                                    F55Y-AMT-HSE-INCOME         
           END-IF.                                                              
                                                                                
           EVALUATE K825-NUM-NRIC                                               
               WHEN F730-NUM-NRIC1                                              
                    MOVE K825-NUM-NRIC            TO F55A-NUM-NRIC1             
                                                     F55Y-NUM-NRIC1             
                    MOVE WS-AGE-CY(2:3)           TO F55A-NUM-AGE-HA1           
                                                     F55Y-NUM-AGE-APP1          
                    MOVE WS-AGE-CY(3:2)           TO F55Y-NUM-AGE-HA1           
                    MOVE K825-NUM-ETHNIC          TO WS-HA1-ETHNIC              
                    MOVE K825-NUM-SEX             TO WS-HA1-SEX                 
                    MOVE K825-NUM-MARITAL-STATUS  TO                            
                                                  F55A-NUM-MARITAL-HA1          
                                                  F55Y-NUM-MARITAL-HA1          
                    MOVE K825-NUM-CITIZENSHIP    TO F55A-NUM-CITIZEN-HA1        
                                                    F55Y-NUM-CITIZEN-HA1        
               WHEN F730-NUM-NRIC2                                              
                    MOVE K825-NUM-NRIC           TO F55A-NUM-NRIC2              
                                                    F55Y-NUM-NRIC2              
                    MOVE WS-AGE-CY(2:3)          TO F55A-NUM-AGE-HA2            
                                                    F55Y-NUM-AGE-APP2           
                    MOVE WS-AGE-CY(3:2)          TO F55Y-NUM-AGE-HA2            
                    MOVE K825-NUM-ETHNIC         TO WS-HA2-ETHNIC               
                    MOVE K825-NUM-SEX            TO WS-HA2-SEX                  
                    MOVE K825-NUM-MARITAL-STATUS TO                             
                                                 F55Y-NUM-MARITAL-HA2           
                    MOVE K825-NUM-CITIZENSHIP    TO F55A-NUM-CITIZEN-HA2        
                                                    F55Y-NUM-CITIZEN-HA2        
           END-EVALUATE.                                                        
                                                                                
           IF K825-NUM-RELATIONSHIP = 41 AND                                    
              K825-NUM-MARITAL-STATUS   = 1                                     
              IF WS-NUM-AGE-CHILD = ZEROES                                      
                 MOVE WS-AGE-CY(2:3)       TO WS-NUM-AGE-CHILD                  
                 MOVE K825-NUM-CITIZENSHIP TO WS-NUM-CHILD-CIT                  
              ELSE                                                              
                 IF WS-AGE-CY < WS-NUM-AGE-CHILD                                
                    MOVE WS-AGE-CY(2:3)   TO WS-NUM-AGE-CHILD                   
                    MOVE K825-NUM-CITIZENSHIP TO WS-NUM-CHILD-CIT               
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4450-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K825-NUM-RELATIONSHIP NOT = '00'                                 
               IF K825-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K825-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
       4450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4500-COMPUTE-AGE.                                                        
      *===============================================================*         
                                                                                
           IF F730-DTE-REQUEST NOT NUMERIC                                      
              MOVE ZEROES                         TO WS-NUM-REGN                
           ELSE                                                                 
              MOVE F730-DTE-REQUEST               TO WS-NUM-REGN                
           END-IF.                                                              
           IF K828-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K828-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
           IF K828-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K828-AMT-INCOME            
           END-IF.                                                              
                                                                                
           IF WS-NUM-REGN > WS-NUM-BIRTH                                        
              COMPUTE WS-NUM-AGE = WS-NUM-REGN - WS-NUM-BIRTH                   
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF.                                                              
                                                                                
           IF WS-AGE-MM > 0                                                     
              COMPUTE WS-AGE-CY = WS-AGE-CY + 1                                 
           END-IF.                                                              
                                                                                
           IF K828-NUM-NRIC = F730-NUM-NRIC1                                    
              MOVE WS-AGE-CY                TO WS-NUM-HA1-AGE                   
           END-IF                                                               
                                                                                
           IF K828-AMT-INCOME NOT NUMERIC                                       
              MOVE ZEROES                         TO K828-AMT-INCOME            
           END-IF                                                               
                                                                                
           IF F730-CDE-ALLOC-SCH = 'FTS' AND                                    
             (K828-NUM-NRIC NOT = F730-NUM-NRIC1 AND F730-NUM-NRIC2 AND         
                                  F730-NUM-NRIC3 AND F730-NUM-NRIC4)            
              CONTINUE                                                          
           ELSE                                                                 
              ADD K828-AMT-INCOME                TO F55A-AMT-HSE-INCOME         
                                                    F55Y-AMT-HSE-INCOME         
           END-IF.                                                              
                                                                                
           EVALUATE K828-NUM-NRIC                                               
               WHEN F730-NUM-NRIC1                                              
                    MOVE K828-NUM-NRIC            TO F55A-NUM-NRIC1             
                                                     F55Y-NUM-NRIC1             
                    MOVE WS-AGE-CY(2:3)           TO F55A-NUM-AGE-HA1           
                                                     F55Y-NUM-AGE-APP1          
                    MOVE WS-AGE-CY(3:2)           TO F55Y-NUM-AGE-HA1           
                    MOVE K828-NUM-ETHNIC          TO WS-HA1-ETHNIC              
                    MOVE K828-NUM-SEX             TO WS-HA1-SEX                 
                    MOVE K828-NUM-MARITAL-STATUS  TO                            
                                                  F55A-NUM-MARITAL-HA1          
                                                  F55Y-NUM-MARITAL-HA1          
               WHEN F730-NUM-NRIC2                                              
                    MOVE K828-NUM-NRIC           TO F55A-NUM-NRIC2              
                                                    F55Y-NUM-NRIC2              
                    MOVE WS-AGE-CY(2:3)          TO F55A-NUM-AGE-HA2            
                                                    F55Y-NUM-AGE-APP2           
                    MOVE WS-AGE-CY(3:2)          TO F55Y-NUM-AGE-HA2            
                    MOVE K828-NUM-ETHNIC         TO WS-HA2-ETHNIC               
                    MOVE K828-NUM-SEX            TO WS-HA2-SEX                  
                    MOVE K828-NUM-MARITAL-STATUS TO                             
                                                 F55Y-NUM-MARITAL-HA2           
                    MOVE K828-NUM-CITIZENSHIP    TO F55A-NUM-CITIZEN-HA2        
                                                    F55Y-NUM-CITIZEN-HA2        
           END-EVALUATE.                                                        
                                                                                
           IF K828-NUM-RELATIONSHIP = 41 AND                                    
              K828-NUM-MARITAL-STATUS   = 1                                     
              IF WS-NUM-AGE-CHILD = ZEROES                                      
                 MOVE WS-AGE-CY(2:3)      TO WS-NUM-AGE-CHILD                   
                 MOVE K828-NUM-CITIZENSHIP TO WS-NUM-CHILD-CIT                  
              ELSE                                                              
                 IF WS-AGE-CY < WS-NUM-AGE-CHILD                                
                    MOVE WS-AGE-CY(2:3)   TO WS-NUM-AGE-CHILD                   
                    MOVE K828-NUM-CITIZENSHIP TO WS-NUM-CHILD-CIT               
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4550-CHECK-CTZSHP-CDE.                                                   
      *===============================================================*         
                                                                                
            IF K828-NUM-RELATIONSHIP NOT = '00'                                 
               IF K828-NUM-CITIZENSHIP   = '10' OR 'SC'                         
                  MOVE 'SCH'              TO WS-HH-SCH                          
               ELSE                                                             
                  IF K828-NUM-CITIZENSHIP NOT = '10' AND 'SC'                   
                     MOVE 'SCP'           TO WS-HH-SCP                          
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
       4550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=====================*                                                   
       4600-READ-BP13K585.                                                      
      *=====================*                                                   
                                                                                
           MOVE SPACES                              TO BP13K585-REC.            
           INITIALIZE                                  BP13K585-REC.            
                                                                                
           MOVE 'N'                                 TO WS-K585-FOUND.           
           MOVE F730-NUM-NRIC1                      TO K585-NUM-NRIC.           
           MOVE WS-F585-TRANS                       TO K585-NUM-TRANS.          
                                                                                
           READ BP13K585.                                                       
                                                                                
           IF K585-STATUS = 00                                                  
              MOVE 'Y'                       TO WS-K585-FOUND                   
              MOVE K585-NUM-UNSUCC-BTO       TO F55A-NUM-TRY-HARDLUCK           
           ELSE                                                                 
              IF K585-STATUS = 23                                               
                 PERFORM 4700-READ-BP13K587  THRU 4700-EXIT                     
              ELSE                                                              
                 DISPLAY 'BP13K585 - ERROR READING , '                          
                         ' STATUS : ' K585-STATUS                               
                         ' KEY : ' K585-KEY-FLD                                 
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=====================*                                                   
       4700-READ-BP13K587.                                                      
      *=====================*                                                   
                                                                                
           MOVE SPACES                              TO BP13K587-REC.            
           INITIALIZE                                  BP13K587-REC.            
                                                                                
           MOVE F730-NUM-NRIC1                      TO K587-NUM-NRIC.           
           MOVE WS-F585-TRANS                       TO K587-NUM-TRANS           
                                                                                
           READ BP13K587.                                                       
                                                                                
           IF K587-STATUS = 00                                                  
              MOVE 'Y'                       TO WS-K585-FOUND                   
              MOVE K587-NUM-UNSUCC-BTO       TO F55A-NUM-TRY-HARDLUCK           
           ELSE                                                                 
              IF K587-STATUS = 23                                               
                 CONTINUE                                                       
              ELSE                                                              
                 DISPLAY 'BP13K587 - ERROR READING , '                          
                         ' STATUS : ' K585-STATUS                               
                         ' KEY : ' K585-KEY-FLD                                 
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4800-READ-APPLICANT.                                                     
      *===============================================================*         
                                                                                
           MOVE ZEROES                         TO WS-NUM-DTEBAL                 
                                                  WS-CNT-DTEBAL.                
           MOVE ZEROES                         TO WS-TRY.                       
           MOVE ZEROES                         TO WS-TRY-BTO-SBF.               
           MOVE ZEROES                         TO WS-TRY-FTS.                   
           MOVE ZEROES                         TO WS-TRY-FTS-Y201307.           
           MOVE ZEROES                         TO WS-TRY-FTSPA-Y201307.         
           MOVE F730-NUM-REGN                  TO F55A-NUM-REGN.                
           MOVE F730-NUM-NRIC1                 TO F55A-NUM-NRIC1.               
           MOVE F730-NUM-ALLO-CAT              TO F55A-CDE-SALES-MODE.          
           MOVE F730-DTE-BALLOT                TO F55A-DTE-QUARTER.             
                                                                                
           IF F730-DTE-BALLOT NOT = SPACES AND LOW-VALUES AND ZEROES            
              MOVE F730-DTE-BALLOT             TO WS-NUM-DTEBAL                 
              COMPUTE WS-DTE-BAL-YY             = WS-DTE-BAL-YY - 1             
              COMPUTE WS-DTE-BAL-MM             = WS-DTE-BAL-MM + 1             
           END-IF.                                                              
                                                                                
           MOVE F730-CDE-FLAT-TYPE             TO F55A-NUM-FLAT-TYPE.           
           MOVE F730-CDE-HOUSEHOLD             TO F55A-NUM-HH.                  
           MOVE F730-CDE-ALLOC-SCH             TO F55A-NUM-ALLO-SCHEME.         
           MOVE F730-CDE-ELIG-SCH              TO F55A-NUM-ELIG-SCHEME.         
           MOVE F730-NUM-WAIT-TIME             TO F55A-NUM-ATTMP.               
           IF F730-NUM-FT2T = 'Y'                                               
              MOVE 'F'                         TO F55A-NUM-BAL-HH               
           ELSE                                                                 
              IF F730-CDE-BALLOT-HOUSEHOLD = SPACES OR LOW-VALUES               
                 MOVE F730-CDE-HOUSEHOLD       TO F55A-NUM-BAL-HH               
              ELSE                                                              
                 MOVE F730-CDE-BALLOT-HOUSEHOLD   TO F55A-NUM-BAL-HH            
              END-IF                                                            
           END-IF.                                                              
           MOVE F730-NUM-NT-FT-QUEUE           TO F55A-NUM-QUEUE.               
           MOVE F730-CDE-REQUEST-STATUS        TO F55A-NUM-REQSTAT.             
                                                                                
           MOVE F730-DTE-BK-APPT               TO F55A-DTE-BK-APPT.             
                                                                                
           MOVE BP13F730-REC(476:09)           TO F55A-NUM-SCH-ACCNT.           
                                                                                
           MOVE BP13F730-REC(462:1)            TO F55A-CDE-INV-BK.              
           MOVE BP13F730-REC(463:1)            TO F55A-CDE-NOT-BK.              
           MOVE BP13F730-REC(464:1)            TO F55A-CDE-INV-DBK.             
           MOVE BP13F730-REC(465:1)            TO F55A-CDE-NOT-DBK.             
           MOVE BP13F730-REC(467:1)            TO F55A-CDE-NOT-CBK.             
           MOVE BP13F730-REC(470:1)            TO F55A-CDE-INV-H.               
           MOVE BP13F730-REC(471:1)            TO F55A-CDE-NOT-H.               
           MOVE BP13F730-REC(472:1)            TO F55A-CDE-INV-G.               
           MOVE BP13F730-REC(473:1)            TO F55A-CDE-NOT-G.               
           MOVE BP13F730-REC(474:1)            TO F55A-CDE-INV-CBK.             
           MOVE BP13F730-REC(475:1)            TO F55A-CDE-PENDING.             
           MOVE BP13F730-REC(495:1)            TO F55A-NUM-NE                   
                                                  F55Y-NUM-NE.                  
                                                                                
           IF F730-NUM-HARDLUCK = '1'                                           
              MOVE 'H1'                        TO F55A-NUM-HARDLUCK             
           ELSE                                                                 
              IF F730-NUM-HARDLUCK = '2'                                        
                 MOVE 'G2'                     TO F55A-NUM-HARDLUCK             
              ELSE                                                              
                IF F730-NUM-HARDLUCK = '3'                                      
                   MOVE 'G3'                   TO F55A-NUM-HARDLUCK             
                END-IF                                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *                                                                         
      * THIS PROGRAM IS FOR REPORTING PURPOSE, NO NEED TO CHECK                 
      * CDE-RESIDENT-HA1 NOT = SPACE BECAUSE CASE HAVE NOT PASS TO              
      * MHA FOR DETERMINE MCPS                                                  
      *                                                                         
           IF F730-NUM-ALLO-CAT NOT = 'DBS'                                     
              IF (F730-NUM-MCPS = 'M' OR 'C' OR 'P' OR 'B') AND                 
                 (F730-CDE-ALLOC-SCH = 'PA')                                    
                 IF (F730-CDE-RESIDENT-HA1 NOT = 'H' AND 'M' AND 'P')           
                    MOVE 'MCP'             TO F55A-NUM-ALLO-SCHEME              
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE F730-CDE-NT1                 TO WS-CDE-NT1                      
                                                WS-CDE-NT1-F730.                
           IF WS-CDE-NT1 IS NUMERIC                                             
              PERFORM 5500-DECODE-NT         THRU 5500-EXIT                     
           END-IF.                                                              
           MOVE WS-CDE-NT1                   TO F55A-NUM-TOWN                   
                                                F730-CDE-NT1.                   
                                                                                
           MOVE WS-NUM-FLAT-CATEGORY         TO F55A-NUM-FLAT-CATEGORY.         
           MOVE WS-NME-PROJECT-LTR           TO F55A-NME-PROJECT-LTR.           
           MOVE F730-CDE-NT1                 TO F55A-NUM-BTO-ZONE.              
           MOVE WS-NUM-ADD-FLAT              TO F55A-NUM-ADDITIONAL-FLAT        
                                                                                
      **                                                                        
      ** DECODE ETHNIC                                                          
      **                                                                        
           IF WS-HA1-ETHNIC = 0 OR 1 OR 2 OR 3 OR 4                             
              MOVE 2                           TO WS-CDE-RACE                   
           ELSE IF WS-HA1-ETHNIC = 5                                            
              MOVE 1                           TO WS-CDE-RACE                   
           ELSE IF WS-HA1-ETHNIC = 6                                            
              MOVE 3                           TO WS-CDE-RACE                   
           ELSE IF WS-HA1-ETHNIC = 7 OR 9 OR ' '                                
              MOVE 4                           TO WS-CDE-RACE                   
           END-IF.                                                              
                                                                                
           MOVE 09                             TO K060-SERIAL-NO                
           MOVE WS-CDE-RACE                    TO K060-CODE                     
           PERFORM 4900-READ-BP13K060        THRU 4900-EXIT                     
           MOVE K060-DESC(1:10)                TO F55A-NUM-ETHNIC.              
                                                                                
      **                                                                        
      ** DECODE SEX-HA1                                                         
      **                                                                        
           MOVE 43                             TO K060-SERIAL-NO                
           MOVE WS-HA1-SEX                     TO K060-CODE                     
           PERFORM 4900-READ-BP13K060        THRU 4900-EXIT                     
           MOVE K060-DESC(1:10)                TO F55A-NUM-SEX-HA1.             
                                                                                
           MOVE CNT-CHILD                      TO F55A-NUM-CHILD.               
           MOVE CNT-HH-SIZE                    TO F55A-NUM-HH-SIZE.             
                                                                                
           IF F730-NUM-NRIC1 NOT = SPACES AND LOW-VALUES                        
              PERFORM 4600-READ-BP13K585     THRU 4600-EXIT                     
           END-IF.                                                              
                                                                                
           IF (F730-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                  
                   (WS-K585-FOUND = 'N')                                        
              PERFORM 4600-READ-BP13K585     THRU 4600-EXIT                     
           END-IF.                                                              
                                                                                
           IF (F730-NUM-NRIC3 NOT = SPACES AND LOW-VALUES) AND                  
                   (WS-K585-FOUND = 'N')                                        
              PERFORM 4600-READ-BP13K585     THRU 4600-EXIT                     
           END-IF.                                                              
                                                                                
           IF (F730-NUM-NRIC4 NOT = SPACES AND LOW-VALUES) AND                  
              (WS-K585-FOUND = 'N')                                             
              PERFORM 4600-READ-BP13K585     THRU 4600-EXIT                     
           END-IF.                                                              
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=====================*                                                   
       4900-READ-BP13K060.                                                      
      *=====================*                                                   
                                                                                
           READ BP13K060.                                                       
                                                                                
           IF K060-STATUS = 00                                                  
              CONTINUE                                                          
           ELSE                                                                 
              IF K060-STATUS = 23                                               
                 MOVE SPACES                     TO K060-DESC                   
              ELSE                                                              
                 DISPLAY 'BP13K060 - ERROR READING , '                          
                         ' STATUS : ' K060-STATUS                               
                         ' KEY : ' K060-KEY-FLD                                 
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5000-PROCESS-NRIC-K730.                                                  
      *===============================================================*         
                                                                                
           PERFORM 5100-START-BP13K730-NRIC1        THRU 5100-EXIT.             
                                                                                
           IF WS-NRIC-FOUND = 'N'                                               
              PERFORM 5150-START-BP13K730-NRIC2     THRU 5150-EXIT              
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5050-INITIALIZE-BP13K730.                                                
      *===============================================================*         
                                                                                
           MOVE 'N'                        TO WS-K730-EOF                       
                                              WS-NRIC-FOUND.                    
                                                                                
           MOVE SPACES                     TO BP13K730-REC.                     
           INITIALIZE                         BP13K730-REC.                     
                                                                                
       5050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5100-START-BP13K730-NRIC1.                                               
      *===============================================================*         
                                                                                
           PERFORM 5050-INITIALIZE-BP13K730    THRU 5050-EXIT.                  
                                                                                
           MOVE F730-NUM-NRIC1                   TO K730-NUM-NRIC1.             
                                                                                
           START BP13K730 KEY >= K730-NUM-NRIC1.                                
                                                                                
           EVALUATE K730-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 5200-READNEXT-BP13K730     THRU 5200-EXIT           
                    PERFORM 5300-PROCESS-BP13K730-IC1  THRU 5300-EXIT           
                            UNTIL WS-K730-EOF = 'Y'                             
               WHEN 20                                                          
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                  DISPLAY 'START ERROR BP13K730 : ' K730-STATUS                 
                          ' NRIC : ' K730-NUM-NRIC1                             
                  PERFORM 9000-CLOSE-FILES             THRU 9000-EXIT           
           END-EVALUATE.                                                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5150-START-BP13K730-NRIC2.                                               
      ******************************************************************        
                                                                                
           PERFORM 5050-INITIALIZE-BP13K730    THRU 5050-EXIT.                  
                                                                                
           MOVE F730-NUM-NRIC1                   TO K730-NUM-NRIC2.             
                                                                                
           START BP13K730 KEY >= K730-NUM-NRIC2.                                
                                                                                
           EVALUATE K730-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 5200-READNEXT-BP13K730     THRU 5200-EXIT           
                    PERFORM 5450-PROCESS-BP13K730-IC2  THRU 5450-EXIT           
                            UNTIL WS-K730-EOF = 'Y'                             
               WHEN 20                                                          
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                  DISPLAY 'START ERROR BP13K730 : ' K730-STATUS                 
                          ' NRIC : ' K730-NUM-NRIC2                             
                  PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT               
           END-EVALUATE.                                                        
                                                                                
       5150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5200-READNEXT-BP13K730.                                                  
      *===============================================================*         
                                                                                
           READ BP13K730 NEXT RECORD                                            
                         AT END MOVE 'Y' TO WS-K730-EOF.                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5300-PROCESS-BP13K730-IC1.                                               
      *===============================================================*         
                                                                                
           IF K730-NUM-NRIC1 = F730-NUM-NRIC1                                   
              ADD 1                               TO CNT-K730-NRIC1             
              MOVE 'Y'                            TO WS-NRIC-FOUND              
              IF K730-NUM-REGN = F730-NUM-REGN                                  
                 MOVE K730-NUM-AST-SUCC      TO F730-NUM-AST-SUCC               
                 MOVE K730-NUM-PPS-SUCC      TO F730-NUM-PPS-SUCC               
                 MOVE K730-CDE-RESIDENT-HA2  TO F730-CDE-RESIDENT-HA2           
              END-IF                                                            
              PERFORM 5400-CHECK-BP13K730-FLDS  THRU 5400-EXIT                  
              PERFORM 5200-READNEXT-BP13K730    THRU 5200-EXIT                  
           ELSE                                                                 
              MOVE 'Y'                            TO WS-K730-EOF                
           END-IF.                                                              
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5400-CHECK-BP13K730-FLDS.                                                
      ******************************************************************        
                                                                                
                                                                                
           IF (K730-NUM-ALLO-CAT = 'BTO') OR                                    
              (K730-NUM-ALLO-CAT = 'SBF') OR                                    
              (K730-NUM-ALLO-CAT = 'ROF') OR                                    
              (K730-NUM-ALLO-CAT = 'OBF')                                       
                                                                                
              MOVE K730-CDE-NT1                       TO WS-CDE-NT1             
              IF WS-CDE-NT1 IS NUMERIC                                          
                 PERFORM 5500-DECODE-NT                THRU 5500-EXIT           
              END-IF                                                            
              MOVE WS-CDE-NT1                         TO K730-CDE-NT1           
                                                                                
              IF WS-NUM-DTEBAL > 0                                              
                 IF K730-DTE-BALLOT >= WS-NUM-DTEBAL AND                        
                    K730-DTE-BALLOT <= F730-DTE-BALLOT                          
                       IF K730-DTE-BALLOT >= WS-BALLOT-END                      
                          IF K730-CDE-ALLOC-SCH = 'GRO'                         
                             CONTINUE                                           
                          ELSE                                                  
                             IF K730-NUM-ALLO-CAT = 'BTO'                       
                                ADD 1          TO WS-TRY                        
                             END-IF                                             
                             IF K730-NUM-ALLO-CAT = 'BTO' OR 'SBF'              
                               ADD 1           TO WS-TRY-BTO-SBF                
                             END-IF                                             
                             IF K730-CDE-ALLOC-SCH = 'FTS' AND                  
                                K730-CDE-HOUSEHOLD NOT = 'G' AND                
                                F730-NUM-ALLO-CAT = 'BTO'                       
                                ADD 1          TO WS-TRY-FTS                    
                             END-IF                                             
                          END-IF                                                
                       END-IF                                                   
                 END-IF                                                         
              END-IF                                                            
              IF K730-DTE-BALLOT >= '201307'                                    
                 IF (F730-CDE-ALLOC-SCH = 'FTS') AND                            
                    (K730-NUM-ALLO-CAT = 'BTO')                                 
                    ADD 1                  TO WS-TRY-FTSPA-Y201307              
                 END-IF                                                         
                 IF (K730-CDE-ALLOC-SCH = 'FTS') AND                            
                    (K730-CDE-HOUSEHOLD NOT = 'G') AND                          
                    (K730-NUM-ALLO-CAT = 'BTO')                                 
                    ADD 1                  TO WS-TRY-FTS-Y201307                
                 END-IF                                                         
              END-IF                                                            
                                                                                
              EVALUATE K730-DTE-BALLOT                                          
                  WHEN '201802'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN13          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT13            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT13            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT13        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT13          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'ROF' OR 'OBF'                    
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN14          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT14            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT14            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT14        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT14          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201805'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN15          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT15            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT15            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT15        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT15          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN16          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT16            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT16            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT16        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT16          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201808'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN17          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT17            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT17            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT17        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT17          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'ROF' OR 'OBF'                    
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN18          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT18            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT18            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT18        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT18          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201811'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN19          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT19            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT19            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT19        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT19          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN20          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT20            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT20            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT20        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT20          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201902'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN21          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT21            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT21            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT21        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT21          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'ROF'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN22          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT22            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT22            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT22        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT22          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201905'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN23          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT23            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT23            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT23        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT23          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN24          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT24            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT24            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT24        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT24          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201909'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN25          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT25            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT25            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT25        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT25          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'ROF'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN26          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT26            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT26            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT26        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT26          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201911'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN27          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT27            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT27            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT27        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT27          
                       ELSE                                                     
                       IF K730-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K730-NUM-REGN        TO F55A-NUM-REGN28          
                          MOVE K730-CDE-FLAT-TYPE   TO F55A-NUM-FT28            
                          MOVE K730-CDE-NT1         TO F55A-NUM-NT28            
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT28        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT28          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '202002'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN29         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT29           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT29           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT29        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT29         
                  WHEN '202008'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN30         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT30           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT30           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT30        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT30         
                  WHEN '202011'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN31         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT31           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT31           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT31        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT31         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN32         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT32           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT32           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT32        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT32         
                       END-IF                                                   
                  WHEN '202102'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN33         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT33           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT33           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT33        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT33         
                  WHEN '202105'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN34         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT34           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT34           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT34        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT34         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN35         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT35           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT35           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT35        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT35         
                       END-IF                                                   
                  WHEN '202108'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN36         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT36           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT36           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT36        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT36         
                  WHEN '202111'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN37         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT37           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT37           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT37        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT37         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN38         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT38           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT38           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT38        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT38         
                       END-IF                                                   
                  WHEN '202202'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN39         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT39           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT39           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT39        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT39         
                  WHEN '202205'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN40         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT40           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT40           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT40        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT40         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN41         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT41           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT41           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT41        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT41         
                       END-IF                                                   
                  WHEN '202208'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN42         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT42           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT42           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT42        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT42         
                  WHEN '202211'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN43         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT43           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT43           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT43        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT43         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN44         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT44           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT44           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT44        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT44         
                       END-IF                                                   
                  WHEN '202302'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN45         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT45           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT45           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT45        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT45         
                  WHEN '202305'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN46         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT46           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT46           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT46        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT46         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN47         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT47           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT47           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT47        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT47         
                       END-IF                                                   
                  WHEN '202310'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN48         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT48           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT48           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT48        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT48         
                  WHEN '202312'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN49         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT49           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT49           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT49        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT49         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN50         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT50           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT50           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT50        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT50         
                       END-IF                                                   
                  WHEN '202402'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN51         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT51           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT51           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT51        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT51         
                  WHEN '202405'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN52         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT52           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT52           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT52        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT52         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN53         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT53           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT53           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT53        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT53         
                       END-IF                                                   
                  WHEN '202408'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN54         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT54           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT54           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT54        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT54         
                  WHEN '202411'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN55         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT55           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT55           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT55        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT55         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN56         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT56           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT56           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT56        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT56         
                       END-IF                                                   
                  WHEN '202502'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN57         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT57           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT57           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT57        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT57         
                  WHEN '202505'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN58         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT58           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT58           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT58        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT59         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN59         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT59           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT59           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT59        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT59         
                       END-IF                                                   
                  WHEN '202508'                                                 
                       MOVE K730-NUM-REGN            TO F55A-NUM-REGN60         
                       MOVE K730-CDE-FLAT-TYPE       TO F55A-NUM-FT60           
                       MOVE K730-CDE-NT1             TO F55A-NUM-NT60           
                       MOVE K730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT60        
                       MOVE K730-CDE-REQUEST-STATUS  TO F55A-NUM-STAT60         
                  WHEN '202511'                                                 
                       IF K730-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN61         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT61           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT61           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT61        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT61         
                       ELSE                                                     
                          MOVE K730-NUM-REGN         TO F55A-NUM-REGN62         
                          MOVE K730-CDE-FLAT-TYPE    TO F55A-NUM-FT62           
                          MOVE K730-CDE-NT1          TO F55A-NUM-NT62           
                          MOVE K730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT62        
                          MOVE K730-CDE-REQUEST-STATUS                          
                                                     TO F55A-NUM-STAT62         
                       END-IF                                                   
                  END-EVALUATE                                                  
           END-IF.                                                              
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5450-PROCESS-BP13K730-IC2.                                               
      ******************************************************************        
                                                                                
           IF K730-NUM-NRIC2 = F730-NUM-NRIC1                                   
              ADD 1                               TO CNT-K730-NRIC2             
              MOVE 'Y'                            TO WS-NRIC-FOUND              
              PERFORM 5400-CHECK-BP13K730-FLDS  THRU 5400-EXIT                  
              PERFORM 5200-READNEXT-BP13K730    THRU 5200-EXIT                  
           ELSE                                                                 
              MOVE 'Y'                            TO WS-K730-EOF                
           END-IF.                                                              
                                                                                
       5450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5500-DECODE-NT.                                                          
      *===============================================================*         
                                                                                
           MOVE SPACES                         TO BP13K813-REC.                 
           INITIALIZE                             BP13K813-REC.                 
                                                                                
           MOVE SPACES                         TO K813-KEY-FLD.                 
           MOVE WS-CDE-NT1                     TO K813-NUM-ZONE.                
                                                                                
           PERFORM 5600-START-BP13K813       THRU 5600-EXIT                     
                                                                                
           IF K813-CDE-NT NOT = SPACES                                          
              MOVE K813-CDE-NT                 TO WS-CDE-NT1                    
           END-IF.                                                              
                                                                                
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5600-START-BP13K813.                                                     
      *===============================================================*         
                                                                                
           START BP13K813 KEY >= K813-KEY-FLD.                                  
                                                                                
           EVALUATE K813-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 5700-READ-BP13K813  THRU 5700-EXIT                  
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR STARTING BP13K813: ' K813-STATUS             
                            ' KEY = ' K813-KEY-FLD                              
                    PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       5600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5700-READ-BP13K813.                                                      
      *===============================================================*         
                                                                                
            READ  BP13K813 NEXT AT END                                          
                  MOVE SPACES               TO K813-KEY-FLD.                    
                                                                                
            EVALUATE K813-STATUS                                                
                WHEN 00                                                         
                WHEN 02                                                         
                     MOVE K813-NUM-MATURE-EST-TAG TO WS-MATURE                  
                     IF K813-NUM-ZONE = WS-CDE-NT1                              
                        MOVE K813-NUM-FLAT-CATEGORY                             
                          TO WS-NUM-FLAT-CATEGORY                               
                        MOVE K813-NME-PROJECT-LTR                               
                          TO WS-NME-PROJECT-LTR                                 
                        MOVE K813-NUM-ADDITIONAL-FLAT                           
                          TO WS-NUM-ADD-FLAT                                    
                     END-IF                                                     
                WHEN 23                                                         
                     CONTINUE                                                   
                WHEN OTHER                                                      
                     DISPLAY 'ERROR READING BP13K813 : ' K813-STATUS            
                             ' KEY = ' K813-KEY-FLD                             
                     PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                
            END-EVALUATE.                                                       
                                                                                
       5700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *===============================================================*         
       6000-PROCESS-NRIC-K595.                                                  
      *===============================================================*         
                                                                                
           IF WS-NRIC-FOUND = 'N'                                               
              MOVE 'N'  TO  WS-F730-REC-NFND                                    
           ELSE                                                                 
              MOVE 'Y'  TO  WS-F730-REC-NFND                                    
           END-IF.                                                              
                                                                                
           PERFORM 6100-START-BP13K595-NRIC1        THRU 6100-EXIT.             
                                                                                
           IF WS-NRIC-FOUND = 'N'                                               
              PERFORM 6500-START-BP13K595-NRIC2     THRU 6500-EXIT              
           END-IF.                                                              
                                                                                
           IF WS-NRIC-FOUND = 'N'                                               
              PERFORM 6700-START-BP13K595-NRIC3     THRU 6700-EXIT              
           END-IF.                                                              
                                                                                
           IF WS-NRIC-FOUND = 'N'                                               
              PERFORM 6900-START-BP13K595-NRIC4     THRU 6900-EXIT              
           END-IF.                                                              
                                                                                
           IF WS-NRIC-FOUND = 'N'                                               
              ADD 1                                 TO CNT-K595-NOTFND          
           END-IF.                                                              
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6050-INITIALIZE-BP13K595.                                                
      *===============================================================*         
                                                                                
           MOVE 'N'                        TO WS-K595-EOF                       
                                              WS-NRIC-FOUND.                    
                                                                                
           MOVE SPACES                     TO BP13K595-REC.                     
           INITIALIZE                         BP13K595-REC.                     
                                                                                
           MOVE SPACES                     TO WS-NUM-REGNO.                     
                                                                                
       6050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6100-START-BP13K595-NRIC1.                                               
      *===============================================================*         
                                                                                
           PERFORM 6050-INITIALIZE-BP13K595    THRU 6050-EXIT.                  
                                                                                
           MOVE F730-NUM-NRIC1                   TO K595-NUM-NRIC1.             
                                                                                
           START BP13K595 KEY >= K595-NUM-NRIC1.                                
                                                                                
           EVALUATE K595-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6200-READNEXT-BP13K595     THRU 6200-EXIT           
                    PERFORM 6300-PROCESS-BP13K595-IC1  THRU 6300-EXIT           
                            UNTIL WS-K595-EOF = 'Y'                             
               WHEN 20                                                          
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                  DISPLAY 'START ERROR BP13K595 : ' K595-STATUS                 
                          ' NRIC : ' K595-NUM-NRIC1                             
                  PERFORM 9000-CLOSE-FILES             THRU 9000-EXIT           
           END-EVALUATE.                                                        
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6200-READNEXT-BP13K595.                                                  
      *===============================================================*         
                                                                                
           READ BP13K595 NEXT RECORD                                            
                         AT END MOVE 'Y' TO WS-K595-EOF.                        
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       6300-PROCESS-BP13K595-IC1.                                               
      *===============================================================*         
                                                                                
           IF K595-NUM-NRIC1 = F730-NUM-NRIC1                                   
            IF WS-NUM-REGNO NOT = K595-NUM-REGN                                 
              ADD 1                               TO CNT-K595-NRIC1             
              MOVE 'Y'                            TO WS-NRIC-FOUND              
              PERFORM 6400-CHECK-BP13K595-FLDS  THRU 6400-EXIT                  
              PERFORM 6200-READNEXT-BP13K595    THRU 6200-EXIT                  
            ELSE                                                                
              PERFORM 6200-READNEXT-BP13K595    THRU 6200-EXIT                  
            END-IF                                                              
           ELSE                                                                 
              MOVE 'Y'                            TO WS-K595-EOF                
           END-IF.                                                              
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6400-CHECK-BP13K595-FLDS.                                                
      ******************************************************************        
                                                                                
            IF F730-DTE-BALLOT = K595-DTE-BALLOT                                
               GO TO 6400-EXIT                                                  
            END-IF                                                              
                                                                                
            IF K595-CDE-BALLOT-HOUSEHOLD NOT = SPACE AND LOW-VALUE              
               MOVE K595-CDE-BALLOT-HOUSEHOLD TO WS-BALLOT-HOUSEHOLD            
            ELSE                                                                
               MOVE K595-CDE-HOUSEHOLD        TO WS-BALLOT-HOUSEHOLD            
            END-IF.                                                             
                                                                                
           IF WS-BALLOT-HOUSEHOLD = 'H' OR 'T'                                  
             IF K595-NUM-ALLO-CAT = 'BTO' OR 'BE ' OR 'SBF'                     
              IF (K595-CDE-REQUEST-STATUS = 'S' OR 'P') OR                      
                 (K595-NUM-BOOK-STATUS = 'BF' OR 'LF' OR 'WF')                  
                  MOVE 'Y'                            TO F55A-NUM-ZERO          
              END-IF                                                            
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF K595-CDE-REQUEST-STATUS NOT = 'C' AND                             
              K595-NUM-RANDOM NOT = SPACES                                      
            IF (K595-NUM-ALLO-CAT = 'BTO') OR                                   
               (K595-NUM-ALLO-CAT = 'SBF') OR                                   
               (K595-NUM-ALLO-CAT = 'ROF') OR                                   
               (K595-NUM-ALLO-CAT = 'OBF')                                      
              MOVE K595-CDE-NT1                       TO WS-CDE-NT1             
              IF WS-CDE-NT1 IS NUMERIC                                          
                 PERFORM 5500-DECODE-NT                THRU 5500-EXIT           
              END-IF                                                            
              MOVE WS-CDE-NT1                         TO K595-CDE-NT1           
                                                                                
              IF WS-NUM-DTEBAL > 0                                              
                 IF K595-DTE-BALLOT >= WS-NUM-DTEBAL AND                        
                    K595-DTE-BALLOT <= F730-DTE-BALLOT                          
                    IF K595-CDE-ALLOC-SCH NOT = 'GRO'                           
                     IF K595-DTE-BALLOT = F730-DTE-BALLOT                       
                       IF WS-F730-REC-NFND = 'N'                                
                          IF K595-NUM-ALLO-CAT = 'BTO'                          
                             ADD 1          TO WS-TRY                           
                          END-IF                                                
                          IF K595-NUM-ALLO-CAT = 'BTO' OR 'SBF'                 
                            ADD 1           TO WS-TRY-BTO-SBF                   
                          END-IF                                                
                          IF K595-CDE-ALLOC-SCH     = 'FTS' AND                 
                             K595-CDE-HOUSEHOLD NOT = 'G' AND                   
                             F730-DTE-BALLOT NOT = K595-DTE-BALLOT AND          
                             K595-NUM-ALLO-CAT   = 'BTO'                        
                             ADD 1          TO WS-TRY-FTS                       
                          END-IF                                                
                          MOVE K595-NUM-REGN  TO WS-NUM-REGNO                   
                       END-IF                                                   
                     END-IF                                                     
                    END-IF                                                      
                    IF K595-CDE-ALLOC-SCH NOT = 'GRO'                           
                     IF K595-DTE-BALLOT < F730-DTE-BALLOT                       
                         IF K595-DTE-BALLOT >= WS-BALLOT-END                    
                            IF K595-NUM-ALLO-CAT = 'BTO'                        
                               ADD 1          TO WS-TRY                         
                            END-IF                                              
                            IF K595-NUM-ALLO-CAT = 'BTO' OR 'SBF'               
                              ADD 1           TO WS-TRY-BTO-SBF                 
                            END-IF                                              
                            IF K595-CDE-ALLOC-SCH     = 'FTS' AND               
                               K595-CDE-HOUSEHOLD NOT = 'G'   AND               
                               K595-DTE-BALLOT NOT = F730-DTE-BALLOT AND        
                               K595-NUM-ALLO-CAT   = 'BTO'                      
                               ADD 1          TO WS-TRY-FTS                     
                            END-IF                                              
                            MOVE K595-NUM-REGN  TO WS-NUM-REGNO                 
                         END-IF                                                 
                     END-IF                                                     
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              IF K595-DTE-BALLOT >= '201307'                                    
                 IF (F730-CDE-ALLOC-SCH = 'FTS') AND                            
                    (K595-NUM-ALLO-CAT = 'BTO')                                 
                    ADD 1                  TO WS-TRY-FTSPA-Y201307              
                 END-IF                                                         
                 IF (K595-CDE-ALLOC-SCH = 'FTS') AND                            
                    (K595-CDE-HOUSEHOLD NOT = 'G') AND                          
                    (K595-NUM-ALLO-CAT = 'BTO')                                 
                    ADD 1                  TO WS-TRY-FTS-Y201307                
                 END-IF                                                         
              END-IF                                                            
                                                                                
              EVALUATE K595-DTE-BALLOT                                          
                  WHEN '201802'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN13          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT13            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT13            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT13        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT13          
                       ELSE                                                     
                       IF K595-NUM-ALLO-CAT = 'ROF' OR 'OBF'                    
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN14          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT14            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT14            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT14        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT14          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201805'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN15          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT15            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT15            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT15        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT15          
                       ELSE                                                     
                       IF K595-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN16          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT16            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT16            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT16        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT16          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201808'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN17          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT17            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT17            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT17        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT17          
                       ELSE                                                     
                       IF K595-NUM-ALLO-CAT = 'ROF' OR 'OBF'                    
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN18          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT18            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT18            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT18        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT18          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201811'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN19          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT19            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT19            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT19        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT19          
                       ELSE                                                     
                       IF K595-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN20          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT20            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT20            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT20        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT20          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201902'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN21          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT21            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT21            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT21        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT21          
                                                                                
                       IF K595-NUM-ALLO-CAT = 'ROF'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN22          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT22            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT22            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT22        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT22          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201905'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN23          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT23            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT23            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT23        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT23          
                       ELSE                                                     
                       IF K595-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN24          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT24            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT24            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT24        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT24          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201909'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN25          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT25            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT25            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT25        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT25          
                       ELSE                                                     
                       IF K595-NUM-ALLO-CAT = 'ROF'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN26          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT26            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT26            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT26        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT26          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '201911'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN27          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT27            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT27            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT27        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT27          
                       ELSE                                                     
                       IF K595-NUM-ALLO-CAT = 'SBF'                             
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN28          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT28            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT28            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT28        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT28          
                       END-IF                                                   
                       END-IF                                                   
                  WHEN '202002'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN29        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT29          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT29          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT29        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT29        
                  WHEN '202008'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN30        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT30          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT30          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT30        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT30        
                  WHEN '202011'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN31        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT31          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT31          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT31        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT31        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN32          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT32            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT32            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT32        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT32          
                       END-IF                                                   
                  WHEN '202102'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN33        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT33          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT33          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT33        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT33        
                  WHEN '202105'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN34        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT34          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT34          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT34        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT34        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN35          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT35            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT35            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT35        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT35          
                       END-IF                                                   
                  WHEN '202108'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN36        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT36          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT36          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT36        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT36        
                  WHEN '202111'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN37        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT37          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT37          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT37        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT37        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN38          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT38            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT38            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT38        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT38          
                       END-IF                                                   
                  WHEN '202202'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN39        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT39          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT39          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT39        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT39        
                  WHEN '202205'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN40        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT40          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT40          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT40        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT40        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN41          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT41            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT41            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT41        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT41          
                       END-IF                                                   
                  WHEN '202208'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN42        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT42          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT42          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT42        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT42        
                  WHEN '202211'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN43        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT43          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT43          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT43        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT43        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN44          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT44            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT44            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT44        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT44          
                       END-IF                                                   
                  WHEN '202302'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN45        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT45          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT45          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT45        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT45        
                  WHEN '202305'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN46        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT46          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT46          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT46        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT46        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN47          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT47            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT47            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT47        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT47          
                       END-IF                                                   
                  WHEN '202310'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN48        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT48          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT48          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT48        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT48        
                  WHEN '202312'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN49        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT49          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT49          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT49        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT49        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN50          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT50            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT50            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT50        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT50          
                       END-IF                                                   
                  WHEN '202402'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN51        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT51          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT51          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT51        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT51        
                  WHEN '202405'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN52        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT52          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT52          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT52        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT52        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN53          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT53            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT53            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT53        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT53          
                       END-IF                                                   
                  WHEN '202408'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN54        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT54          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT54          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT54        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT54        
                  WHEN '202411'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN55        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT55          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT55          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT55        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT55        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN56          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT56            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT56            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT56        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT56          
                       END-IF                                                   
                  WHEN '202502'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN57        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT57          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT57          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT57        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT57        
                  WHEN '202505'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN58        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT58          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT58          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT58        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT58        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN59          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT59            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT59            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT59        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT59          
                       END-IF                                                   
                  WHEN '202508'                                                 
                       MOVE K595-NUM-REGN             TO F55A-NUM-REGN60        
                       MOVE K595-CDE-FLAT-TYPE        TO F55A-NUM-FT60          
                       MOVE K595-CDE-NT1              TO F55A-NUM-NT60          
                       MOVE K595-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT60        
                       MOVE K595-CDE-REQUEST-STATUS   TO F55A-NUM-STAT60        
                  WHEN '202511'                                                 
                       IF K595-NUM-ALLO-CAT = 'BTO'                             
                          MOVE K595-NUM-REGN          TO F55A-NUM-REGN61        
                          MOVE K595-CDE-FLAT-TYPE     TO F55A-NUM-FT61          
                          MOVE K595-CDE-NT1           TO F55A-NUM-NT61          
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT61        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT61        
                       ELSE                                                     
                          MOVE K595-NUM-REGN        TO F55A-NUM-REGN62          
                          MOVE K595-CDE-FLAT-TYPE   TO F55A-NUM-FT62            
                          MOVE K595-CDE-NT1         TO F55A-NUM-NT62            
                          MOVE K595-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT62        
                          MOVE K595-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT62          
                       END-IF                                                   
                  END-EVALUATE                                                  
                  PERFORM 7900-MOVE-BALLOT-HIST-K595   THRU 7900-EXIT           
            END-IF                                                              
           ELSE                                                                 
            ADD 1                                  TO CNT-CANCEL                
           END-IF.                                                              
                                                                                
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6500-START-BP13K595-NRIC2.                                               
      ******************************************************************        
                                                                                
           PERFORM 6050-INITIALIZE-BP13K595    THRU 6050-EXIT.                  
                                                                                
           MOVE F730-NUM-NRIC1                   TO K595-NUM-NRIC2.             
                                                                                
           START BP13K595 KEY >= K595-NUM-NRIC2.                                
                                                                                
           EVALUATE K595-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6200-READNEXT-BP13K595     THRU 6200-EXIT           
                    PERFORM 6600-PROCESS-BP13K595-IC2  THRU 6600-EXIT           
                            UNTIL WS-K595-EOF = 'Y'                             
               WHEN 20                                                          
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                  DISPLAY 'START ERROR BP13K595 : ' K595-STATUS                 
                          ' NRIC : ' K595-NUM-NRIC2                             
                  PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT               
           END-EVALUATE.                                                        
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6600-PROCESS-BP13K595-IC2.                                               
      ******************************************************************        
                                                                                
           IF K595-NUM-NRIC2 = F730-NUM-NRIC1                                   
              ADD 1                               TO CNT-K595-NRIC2             
              MOVE 'Y'                            TO WS-NRIC-FOUND              
              PERFORM 6400-CHECK-BP13K595-FLDS  THRU 6400-EXIT                  
              PERFORM 6200-READNEXT-BP13K595    THRU 6200-EXIT                  
           ELSE                                                                 
              MOVE 'Y'                            TO WS-K595-EOF                
           END-IF.                                                              
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6700-START-BP13K595-NRIC3.                                               
      ******************************************************************        
                                                                                
           PERFORM 6050-INITIALIZE-BP13K595        THRU 6050-EXIT.              
                                                                                
           MOVE F730-NUM-NRIC1                       TO K595-NUM-NRIC3.         
                                                                                
           START BP13K595 KEY >= K595-NUM-NRIC3.                                
                                                                                
           EVALUATE K595-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6200-READNEXT-BP13K595     THRU 6200-EXIT           
                    PERFORM 6800-PROCESS-BP13K595-IC3  THRU 6800-EXIT           
                            UNTIL WS-K595-EOF = 'Y'                             
               WHEN 20                                                          
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                  DISPLAY 'START ERROR BP13K595 : ' K595-STATUS                 
                          ' NRIC : ' K595-NUM-NRIC3                             
                  PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT               
           END-EVALUATE.                                                        
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6800-PROCESS-BP13K595-IC3.                                               
      ******************************************************************        
                                                                                
           IF K595-NUM-NRIC3 = F730-NUM-NRIC1                                   
              ADD 1                               TO CNT-K595-NRIC3             
              MOVE 'Y'                            TO WS-NRIC-FOUND              
              PERFORM 6400-CHECK-BP13K595-FLDS  THRU 6400-EXIT                  
              PERFORM 6200-READNEXT-BP13K595    THRU 6200-EXIT                  
           ELSE                                                                 
              MOVE 'Y'                            TO WS-K595-EOF                
           END-IF.                                                              
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6900-START-BP13K595-NRIC4.                                               
      ******************************************************************        
                                                                                
           PERFORM 6050-INITIALIZE-BP13K595        THRU 6050-EXIT.              
                                                                                
           MOVE F730-NUM-NRIC1                       TO K595-NUM-NRIC4.         
                                                                                
           START BP13K595 KEY >= K595-NUM-NRIC4.                                
                                                                                
           EVALUATE K595-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6200-READNEXT-BP13K595     THRU 6200-EXIT           
                    PERFORM 7000-PROCESS-BP13K595-IC4  THRU 7000-EXIT           
                      UNTIL WS-K595-EOF = 'Y'                                   
               WHEN 20                                                          
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                  DISPLAY 'START ERROR BP13K595 : ' K595-STATUS                 
                          ' NRIC : ' K595-NUM-NRIC4                             
                  PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT               
           END-EVALUATE.                                                        
                                                                                
       6900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       7000-PROCESS-BP13K595-IC4.                                               
      ******************************************************************        
                                                                                
           IF K595-NUM-NRIC4 = F730-NUM-NRIC1                                   
              ADD 1                               TO CNT-K595-NRIC4             
              MOVE 'Y'                            TO WS-NRIC-FOUND              
              PERFORM 6400-CHECK-BP13K595-FLDS  THRU 6400-EXIT                  
              PERFORM 6200-READNEXT-BP13K595    THRU 6200-EXIT                  
           ELSE                                                                 
              MOVE 'Y'                            TO WS-K595-EOF                
           END-IF.                                                              
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       7500-FILL-EMPTY-FIELDS.                                                  
      *===============================================================*         
                                                                                
           IF F55A-NUM-HH-SIZE = SPACES OR ZEROS OR LOW-VALUES                  
              MOVE '02'                           TO F55A-NUM-HH-SIZE           
           END-IF.                                                              
                                                                                
                                                                                
      *    IF F730-NUM-ALLO-CAT = 'BTO'                                         
           EVALUATE F730-DTE-BALLOT                                             
                  WHEN '201802'                                                 
                     IF (F55A-NUM-REGN13 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN13             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT13               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT13               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT13           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT13             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN14 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'ROF' OR 'OBF')                    
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN14             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT14               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT14               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT14           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT14             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '201805'                                                 
                     IF (F55A-NUM-REGN15 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN15             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT15               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT15               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT15           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT15             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN16 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN16             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT16               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT16               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT16           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT16             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '201808'                                                 
                     IF (F55A-NUM-REGN17 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN17             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT17               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT17               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT17           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT17             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN18 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'ROF' OR 'OBF')                    
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN18             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT18               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT18               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT18           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT18             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '201811'                                                 
                     IF (F55A-NUM-REGN19 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN19             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT19               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT19               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT19           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT19             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN20 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN20             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT20               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT20               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT20           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT20             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '201902'                                                 
                     IF (F55A-NUM-REGN21 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN21             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT21               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT21               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT21           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT21             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN22 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'ROF')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN22             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT22               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT22               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT22           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT22             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '201905'                                                 
                     IF (F55A-NUM-REGN23 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN23             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT23               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT23               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT23           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT23             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN24 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN24             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT24               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT24               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT24           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT24             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '201909'                                                 
                     IF (F55A-NUM-REGN25 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN25             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT25               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT25               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT25           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT25             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN26 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'ROF')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN26             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT26               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT26               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT26           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT26             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '201911'                                                 
                     IF (F55A-NUM-REGN27 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN27             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT27               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT27               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT27           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT27             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                     IF (F55A-NUM-REGN28 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                       MOVE F730-NUM-REGN        TO F55A-NUM-REGN28             
                       MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT28               
                       MOVE F730-CDE-NT1         TO F55A-NUM-NT28               
                       MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT28           
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                 TO F55A-NUM-STAT28             
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202002'                                                 
                     IF (F55A-NUM-REGN29 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN29        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT29          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT29          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT29        
                       MOVE F730-CDE-REQUEST-STATUS                             
                                                      TO F55A-NUM-STAT29        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202008'                                                 
                     IF (F55A-NUM-REGN30 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN30        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT30          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT30          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT30        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT30        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202011'                                                 
                     IF (F55A-NUM-REGN31 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN31        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT31          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT31          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT31        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT31        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN32 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN32          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT32            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT32            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT32        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT32          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202102'                                                 
                     IF (F55A-NUM-REGN33 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN33        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT33          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT33          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT33        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT33        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202105'                                                 
                     IF (F55A-NUM-REGN34 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN34        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT34          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT34          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT34        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT34        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN35 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN35          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT35            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT35            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT35        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT35          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202108'                                                 
                     IF (F55A-NUM-REGN36 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN36        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT36          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT36          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT36        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT36        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202111'                                                 
                     IF (F55A-NUM-REGN37 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN37        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT37          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT37          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT37        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT37        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN38 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN38          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT38            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT38            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT38        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT38          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202202'                                                 
                     IF (F55A-NUM-REGN39 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN39        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT39          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT39          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT39        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT39        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202205'                                                 
                     IF (F55A-NUM-REGN40 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN40        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT40          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT40          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT40        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT40        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN41 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN41          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT41            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT41            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT41        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT41          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202208'                                                 
                     IF (F55A-NUM-REGN42 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN42        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT42          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT42          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT42        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT42        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202211'                                                 
                     IF (F55A-NUM-REGN43 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN43        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT43          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT43          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT43        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT43        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN44 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN44          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT44            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT44            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT44        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT44          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202302'                                                 
                     IF (F55A-NUM-REGN45 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN45        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT45          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT45          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT45        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT45        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202305'                                                 
                     IF (F55A-NUM-REGN46 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN46        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT46          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT46          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT46        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT46        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN47 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN47          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT47            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT47            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT47        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT47          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202310'                                                 
                     IF (F55A-NUM-REGN48 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN48        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT48          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT48          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT48        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT48        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202312'                                                 
                     IF (F55A-NUM-REGN49 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN49        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT49          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT49          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT49        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT49        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN50 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN50          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT50            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT50            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT50        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT50          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202402'                                                 
                     IF (F55A-NUM-REGN51 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN51        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT51          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT51          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT51        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT51        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202405'                                                 
                     IF (F55A-NUM-REGN52 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN52        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT52          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT52          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT52        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT52        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN53 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN53          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT53            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT53            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT53        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT53          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202408'                                                 
                     IF (F55A-NUM-REGN54 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN54        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT54          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT54          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT54        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT54        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202411'                                                 
                     IF (F55A-NUM-REGN55 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN55        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT55          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT55          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT55        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT55        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN56 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN56          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT56            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT56            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT56        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT56          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202502'                                                 
                     IF (F55A-NUM-REGN57 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN57        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT57          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT57          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT57        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT57        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202505'                                                 
                     IF (F55A-NUM-REGN58 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN58        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT58          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT58          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT58        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT58        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN59 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN59          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT59            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT59            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT59        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT59          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                  WHEN '202508'                                                 
                     IF (F55A-NUM-REGN60 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                       MOVE F730-NUM-REGN             TO F55A-NUM-REGN60        
                       MOVE F730-CDE-FLAT-TYPE        TO F55A-NUM-FT60          
                       MOVE F730-CDE-NT1              TO F55A-NUM-NT60          
                       MOVE F730-NUM-BOOK-STATUS    TO F55A-NUM-BKSTAT60        
                       MOVE F730-CDE-REQUEST-STATUS   TO F55A-NUM-STAT60        
                       IF F730-DTE-BALLOT >= WS-BALLOT-END                      
                          MOVE 'Y'   TO WS-SPACE                                
                       END-IF                                                   
                     END-IF                                                     
                  WHEN '202511'                                                 
                     IF (F55A-NUM-REGN61 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'BTO')                             
                          MOVE F730-NUM-REGN          TO F55A-NUM-REGN61        
                          MOVE F730-CDE-FLAT-TYPE     TO F55A-NUM-FT61          
                          MOVE F730-CDE-NT1           TO F55A-NUM-NT61          
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT61        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                      TO F55A-NUM-STAT61        
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
                     IF (F55A-NUM-REGN62 = SPACES OR LOW-VALUES) AND            
                        (F730-NUM-ALLO-CAT = 'SBF')                             
                          MOVE F730-NUM-REGN        TO F55A-NUM-REGN62          
                          MOVE F730-CDE-FLAT-TYPE   TO F55A-NUM-FT62            
                          MOVE F730-CDE-NT1         TO F55A-NUM-NT62            
                          MOVE F730-NUM-BOOK-STATUS TO F55A-NUM-BKSTAT62        
                          MOVE F730-CDE-REQUEST-STATUS                          
                                                    TO F55A-NUM-STAT62          
                          IF F730-DTE-BALLOT >= WS-BALLOT-END                   
                            MOVE 'Y'   TO WS-SPACE                              
                          END-IF                                                
                     END-IF                                                     
           END-EVALUATE                                                         
             IF WS-SPACE = 'Y'                                                  
                IF F730-CDE-ALLOC-SCH NOT = 'GRO'                               
                   IF F730-NUM-ALLO-CAT = 'BTO'                                 
                      ADD 1          TO WS-TRY                                  
                   END-IF                                                       
                   IF F730-NUM-ALLO-CAT = 'BTO' OR 'SBF'                        
                     ADD 1           TO WS-TRY-BTO-SBF                          
                   END-IF                                                       
                   IF F730-CDE-ALLOC-SCH = 'FTS' AND                            
                      F730-CDE-HOUSEHOLD NOT = 'G' AND                          
                      F730-NUM-ALLO-CAT  = 'BTO'                                
                      ADD 1          TO WS-TRY-FTS                              
                   END-IF                                                       
                   MOVE 'N'  TO WS-SPACE                                        
                END-IF                                                          
             END-IF                                                             
             IF F730-DTE-BALLOT >= '201307'                                     
                IF (F730-CDE-ALLOC-SCH = 'FTS') AND                             
                   (F730-NUM-ALLO-CAT = 'BTO')                                  
                   ADD 1                   TO WS-TRY-FTSPA-Y201307              
                END-IF                                                          
                IF (F730-CDE-ALLOC-SCH = 'FTS') AND                             
                   (F730-CDE-HOUSEHOLD NOT = 'G') AND                           
                   (F730-NUM-ALLO-CAT = 'BTO')                                  
                   ADD 1                   TO WS-TRY-FTS-Y201307                
                END-IF                                                          
             END-IF                                                             
      *    END-IF.                                                              
                                                                                
           IF WS-CNT-DTEBAL > 0                                                 
              MOVE WS-CNT-DTEBAL               TO F55A-NUM-PAST-APPLN           
           END-IF.                                                              
                                                                                
           IF WS-TRY > 0                                                        
              MOVE WS-TRY                      TO F55A-NUM-TRY-BTO              
           END-IF.                                                              
                                                                                
           IF WS-TRY-BTO-SBF > 0                                                
              MOVE WS-TRY-BTO-SBF              TO F55A-NUM-TRY-BTOSBF           
           END-IF.                                                              
                                                                                
      * IF AT LEAST 1 CASE IS FTS, ALL BTO ARE COUNTED AS FTS CASE              
           IF WS-TRY-FTS > 0                                                    
              MOVE WS-TRY                      TO F55A-NUM-TRY-FTS              
           END-IF.                                                              
                                                                                
      * COUNT ALL FTS CASES FROM BALLOT DATE 201307 ONWARDS                     
           IF WS-TRY-FTS-Y201307 > 0                                            
              MOVE WS-TRY-FTS-Y201307  TO F55A-NUM-TRY-FTS-Y201307              
           END-IF.                                                              
                                                                                
      * COUNT ALL CASES FROM BALLOT DATE 201307 ONWARDS                         
           IF WS-TRY-FTSPA-Y201307 > 0                                          
              MOVE WS-TRY-FTSPA-Y201307   TO F55A-NUM-TRY-FTSPA-Y201307         
           END-IF.                                                              
                                                                                
           MOVE F730-NUM-APPS          TO F55A-NUM-APPS                         
           MOVE F730-NUM-APPS-ELIG-TAG TO F55A-NUM-APPS-ELIG-TAG                
           MOVE F730-NUM-PPS-ELIG-TAG  TO F55A-NUM-PPS-ELIG-TAG                 
           MOVE F730-NUM-MGPS          TO F55A-NUM-MGPS                         
           MOVE F730-NUM-MCPS          TO F55A-NUM-MCP                          
           MOVE F730-NUM-CCA           TO F55A-NUM-CCA                          
           MOVE F730-CDE-RESIDENT-HA1  TO F55A-CDE-RESIDENT-HA1                 
           MOVE F730-NUM-FT2T          TO F55A-NUM-FT2T                         
           MOVE F730-NUM-GEN3          TO F55A-NUM-GEN3                         
           MOVE F730-NUM-AST           TO F55A-NUM-AST                          
           MOVE F730-NUM-YOUNG-CHILD-AGE-SC                                     
                                  TO F55A-NUM-AGE-YOUNG-CHILD-SC.               
           MOVE F730-NUM-YOUNG-CHILD-AGE-NSC                                    
                                  TO F55A-NUM-AGE-YOUNG-CHILD-NSC.              
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55A-NUM-CITIZEN-HA1 = '10'                                  
                  MOVE 'SC'                   TO F55A-NUM-CITIZEN-HA1           
              WHEN F55A-NUM-CITIZEN-HA1 = '20'                                  
                  MOVE 'SP'                   TO F55A-NUM-CITIZEN-HA1           
              WHEN F55A-NUM-CITIZEN-HA1 = SPACES                                
                  CONTINUE                                                      
              WHEN OTHER                                                        
                  MOVE 'NC'                   TO F55A-NUM-CITIZEN-HA1           
           END-EVALUATE.                                                        
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55A-NUM-CITIZEN-HA2 = '10'                                  
                  MOVE 'SC'                   TO F55A-NUM-CITIZEN-HA2           
              WHEN F55A-NUM-CITIZEN-HA2 = '20'                                  
                  MOVE 'SP'                   TO F55A-NUM-CITIZEN-HA2           
              WHEN F55A-NUM-CITIZEN-HA2 = SPACES                                
                  CONTINUE                                                      
              WHEN OTHER                                                        
                  MOVE 'NC'                   TO F55A-NUM-CITIZEN-HA2           
           END-EVALUATE.                                                        
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55A-NUM-YOUNG-CHILD-CITIZEN = '10'                          
                  MOVE 'SC'             TO F55A-NUM-YOUNG-CHILD-CITIZEN         
              WHEN F55A-NUM-YOUNG-CHILD-CITIZEN = '20'                          
                  MOVE 'SP'             TO F55A-NUM-YOUNG-CHILD-CITIZEN         
              WHEN F55A-NUM-YOUNG-CHILD-CITIZEN = SPACES                        
                  CONTINUE                                                      
              WHEN OTHER                                                        
                  MOVE 'NC'             TO F55A-NUM-YOUNG-CHILD-CITIZEN         
           END-EVALUATE.                                                        
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55A-NUM-MARITAL-HA1 = '1'                                   
                  MOVE 'S'                    TO F55A-NUM-MARITAL-HA1           
              WHEN F55A-NUM-MARITAL-HA1 = '2'                                   
                  MOVE 'M'                    TO F55A-NUM-MARITAL-HA1           
              WHEN F55A-NUM-MARITAL-HA1 = '3'                                   
                  MOVE 'W'                    TO F55A-NUM-MARITAL-HA1           
              WHEN F55A-NUM-MARITAL-HA1 = '4'                                   
                  MOVE 'D'                    TO F55A-NUM-MARITAL-HA1           
              WHEN F55A-NUM-MARITAL-HA1 = '5'                                   
                  MOVE 'P'                    TO F55A-NUM-MARITAL-HA1           
           END-EVALUATE.                                                        
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55A-NUM-MARITAL-HA2 = '1'                                   
                  MOVE 'S'                    TO F55A-NUM-MARITAL-HA2           
              WHEN F55A-NUM-MARITAL-HA2 = '2'                                   
                  MOVE 'M'                    TO F55A-NUM-MARITAL-HA2           
              WHEN F55A-NUM-MARITAL-HA2 = '3'                                   
                  MOVE 'W'                    TO F55A-NUM-MARITAL-HA2           
              WHEN F55A-NUM-MARITAL-HA2 = '4'                                   
                  MOVE 'D'                    TO F55A-NUM-MARITAL-HA2           
              WHEN F55A-NUM-MARITAL-HA2 = '5'                                   
                  MOVE 'P'                    TO F55A-NUM-MARITAL-HA2           
           END-EVALUATE.                                                        
                                                                                
           MOVE F730-NUM-ELDERLY           TO F55A-NUM-ELDERLY.                 
           MOVE F730-NUM-PPO               TO F55A-NUM-PPO.                     
           MOVE F730-NUM-NTIMER            TO F55A-NUM-NTIMER.                  
           MOVE F730-DTE-REQUEST           TO F55A-DTE-REGN.                    
                                                                                
           IF (F730-NUM-MCPS = 'B' OR 'M' OR 'C' OR 'P') OR                     
              (F730-NUM-APPS = 'Y' OR 'F')                                      
              MOVE 'Y'                     TO F55A-NUM-SPS                      
           ELSE                                                                 
              MOVE 'N'                     TO F55A-NUM-SPS                      
           END-IF.                                                              
                                                                                
       7500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       7600-POPULATE-BP13F55Y.                                                  
      *===============================================================*         
                                                                                
           MOVE F730-NUM-REGN                  TO F55Y-NUM-REGN.                
           MOVE F730-NUM-NRIC1                 TO F55Y-NUM-NRIC1.               
           MOVE F730-NUM-ALLO-CAT              TO F55Y-CDE-SALES-MODE.          
           MOVE F730-DTE-BALLOT                TO F55Y-DTE-BALLOT.              
                                                                                
           MOVE F730-CDE-FLAT-TYPE             TO F55Y-NUM-FLAT-TYPE.           
           MOVE F730-CDE-HOUSEHOLD             TO F55Y-NUM-HH.                  
           MOVE F730-CDE-ALLOC-SCH             TO F55Y-NUM-ALLO-SCHEME.         
           MOVE F730-CDE-ELIG-SCH              TO F55Y-NUM-ELIG-SCHEME.         
           MOVE F730-NUM-WAIT-TIME             TO F55Y-NUM-ATTMP.               
           IF F730-NUM-FT2T = 'Y'                                               
              MOVE 'F'                         TO F55Y-NUM-BAL-HH               
           ELSE                                                                 
              IF F730-CDE-BALLOT-HOUSEHOLD = SPACES OR LOW-VALUES               
                 MOVE F730-CDE-HOUSEHOLD       TO F55Y-NUM-BAL-HH               
              ELSE                                                              
                 MOVE F730-CDE-BALLOT-HOUSEHOLD   TO F55Y-NUM-BAL-HH            
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F730-NUM-ALLO-CAT NOT = 'DBS'                                     
              IF (F730-NUM-MCPS = 'M' OR 'C' OR 'P' OR 'B') AND                 
                 (F730-CDE-ALLOC-SCH = 'PA')                                    
                 IF (F730-CDE-RESIDENT-HA1 NOT = 'H' AND 'M' AND 'P')           
                    MOVE 'MCP'             TO F55Y-NUM-ALLO-SCHEME              
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-CDE-NT1-F730              TO WS-CDE-NT1.                     
           IF WS-CDE-NT1 IS NUMERIC                                             
              PERFORM 5500-DECODE-NT         THRU 5500-EXIT                     
           END-IF                                                               
           MOVE WS-CDE-NT1                   TO F55Y-NUM-TOWN                   
           MOVE WS-NUM-FLAT-CATEGORY         TO F55Y-NUM-FLAT-CATEGORY.         
           MOVE WS-NME-PROJECT-LTR           TO F55Y-NME-PROJECT-LTR.           
           MOVE WS-CDE-NT1-F730              TO F55Y-NUM-BTO-ZONE.              
           MOVE WS-NUM-ADD-FLAT              TO F55Y-NUM-ADDITIONAL-FLAT        
                                                                                
      **                                                                        
      ** DECODE ETHNIC                                                          
      **                                                                        
           IF WS-HA1-ETHNIC = 0 OR 1 OR 2 OR 3 OR 4                             
              MOVE 2                           TO WS-CDE-RACE                   
           ELSE IF WS-HA1-ETHNIC = 5                                            
              MOVE 1                           TO WS-CDE-RACE                   
           ELSE IF WS-HA1-ETHNIC = 6                                            
              MOVE 3                           TO WS-CDE-RACE                   
           ELSE IF WS-HA1-ETHNIC = 7 OR 9 OR ' '                                
              MOVE 4                           TO WS-CDE-RACE                   
           END-IF.                                                              
                                                                                
           MOVE 09                             TO K060-SERIAL-NO                
           MOVE WS-CDE-RACE                    TO K060-CODE                     
           PERFORM 4900-READ-BP13K060        THRU 4900-EXIT                     
           MOVE K060-DESC(1:10)                TO F55Y-NUM-ETHNIC.              
                                                                                
      **                                                                        
      ** DECODE SEX-HA1                                                         
      **                                                                        
           MOVE 43                             TO K060-SERIAL-NO                
           MOVE WS-HA1-SEX                     TO K060-CODE                     
           PERFORM 4900-READ-BP13K060        THRU 4900-EXIT                     
           MOVE K060-DESC(1:10)                TO F55Y-NUM-SEX-HA1.             
                                                                                
           MOVE CNT-CHILD                      TO F55Y-NUM-CHILD.               
           MOVE CNT-HH-SIZE                    TO F55Y-NUM-HH-SIZE.             
                                                                                
           MOVE F730-NUM-MGPS          TO F55Y-NUM-MGPS                         
           MOVE F730-NUM-MCPS          TO F55Y-NUM-MCP                          
           MOVE F730-NUM-PPS-ELIG-TAG  TO F55Y-NUM-PPS-ELIG-TAG.                
                                                                                
           MOVE F730-NUM-APPS          TO F55Y-NUM-APPS                         
           MOVE F730-NUM-APPS-ELIG-TAG TO F55Y-NUM-APPS-ELIG-TAG                
           MOVE F730-NUM-PPS-ELIG-TAG  TO F55Y-NUM-PPS-ELIG-TAG                 
           MOVE F730-NUM-MGPS          TO F55Y-NUM-MGPS                         
           MOVE F730-NUM-MCPS          TO F55Y-NUM-MCP                          
           MOVE F730-CDE-RESIDENT-HA1  TO F55Y-CDE-RESIDENT-HA1                 
           MOVE F730-NUM-FT2T          TO F55Y-NUM-FT2T                         
           MOVE F730-NUM-GEN3          TO F55Y-NUM-GEN3                         
           MOVE F730-NUM-AST           TO F55Y-NUM-AST                          
           MOVE F730-NUM-YOUNG-CHILD-AGE-SC                                     
                                       TO F55Y-NUM-AGE-YOUNG-CHILD-SC           
                                          F55Y-NUM-AGE-YCHILD-SC.               
           MOVE F730-NUM-YOUNG-CHILD-AGE-NSC                                    
                                       TO F55Y-NUM-AGE-YOUNG-CHILD-NSC          
                                          F55Y-NUM-AGE-YCHILD-NSC.              
           EVALUATE TRUE                                                        
              WHEN F55Y-NUM-CITIZEN-HA1 = '10'                                  
                  MOVE 'SC'                   TO F55Y-NUM-CITIZEN-HA1           
              WHEN F55Y-NUM-CITIZEN-HA1 = '20'                                  
                  MOVE 'SP'                   TO F55Y-NUM-CITIZEN-HA1           
              WHEN F55Y-NUM-CITIZEN-HA1 = SPACES                                
                  CONTINUE                                                      
              WHEN OTHER                                                        
                  MOVE 'NC'                   TO F55Y-NUM-CITIZEN-HA1           
           END-EVALUATE                                                         
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55Y-NUM-CITIZEN-HA2 = '10'                                  
                  MOVE 'SC'                   TO F55Y-NUM-CITIZEN-HA2           
              WHEN F55Y-NUM-CITIZEN-HA2 = '20'                                  
                  MOVE 'SP'                   TO F55Y-NUM-CITIZEN-HA2           
              WHEN F55Y-NUM-CITIZEN-HA2 = SPACES                                
                  CONTINUE                                                      
              WHEN OTHER                                                        
                  MOVE 'NC'                   TO F55Y-NUM-CITIZEN-HA2           
           END-EVALUATE                                                         
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55Y-NUM-YOUNG-CHILD-CITIZEN = '10'                          
                  MOVE 'SC'             TO F55Y-NUM-YOUNG-CHILD-CITIZEN         
              WHEN F55Y-NUM-YOUNG-CHILD-CITIZEN = '20'                          
                  MOVE 'SP'             TO F55Y-NUM-YOUNG-CHILD-CITIZEN         
              WHEN F55Y-NUM-YOUNG-CHILD-CITIZEN = SPACES                        
                  CONTINUE                                                      
              WHEN OTHER                                                        
                  MOVE 'NC'             TO F55Y-NUM-YOUNG-CHILD-CITIZEN         
           END-EVALUATE                                                         
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55Y-NUM-MARITAL-HA1 = '1'                                   
                  MOVE 'S'                    TO F55Y-NUM-MARITAL-HA1           
              WHEN F55Y-NUM-MARITAL-HA1 = '2'                                   
                  MOVE 'M'                    TO F55Y-NUM-MARITAL-HA1           
              WHEN F55Y-NUM-MARITAL-HA1 = '3'                                   
                  MOVE 'W'                    TO F55Y-NUM-MARITAL-HA1           
              WHEN F55Y-NUM-MARITAL-HA1 = '4'                                   
                  MOVE 'D'                    TO F55Y-NUM-MARITAL-HA1           
              WHEN F55Y-NUM-MARITAL-HA1 = '5'                                   
                  MOVE 'P'                    TO F55Y-NUM-MARITAL-HA1           
           END-EVALUATE                                                         
                                                                                
           EVALUATE TRUE                                                        
              WHEN F55Y-NUM-MARITAL-HA2 = '1'                                   
                  MOVE 'S'                    TO F55Y-NUM-MARITAL-HA2           
              WHEN F55Y-NUM-MARITAL-HA2 = '2'                                   
                  MOVE 'M'                    TO F55Y-NUM-MARITAL-HA2           
              WHEN F55Y-NUM-MARITAL-HA2 = '3'                                   
                  MOVE 'W'                    TO F55Y-NUM-MARITAL-HA2           
              WHEN F55Y-NUM-MARITAL-HA2 = '4'                                   
                  MOVE 'D'                    TO F55Y-NUM-MARITAL-HA2           
              WHEN F55Y-NUM-MARITAL-HA2 = '5'                                   
                  MOVE 'P'                    TO F55Y-NUM-MARITAL-HA2           
           END-EVALUATE                                                         
                                                                                
           IF WS-TRY > 0                                                        
              MOVE WS-TRY                      TO F55Y-NUM-TRY-BTO              
           END-IF.                                                              
                                                                                
           IF WS-TRY-BTO-SBF > 0                                                
              MOVE WS-TRY-BTO-SBF              TO F55Y-NUM-TRY-BTOSBF           
           END-IF.                                                              
                                                                                
      * IF AT LEAST 1 CASE IS FTS, ALL BTO ARE COUNTED AS FTS CASE              
           IF WS-TRY-FTS > 0                                                    
              MOVE WS-TRY                      TO F55Y-NUM-TRY-FTS              
           END-IF.                                                              
                                                                                
      * COUNT ALL FTS CASES FROM BALLOT DATE 201307 ONWARDS                     
           IF WS-TRY-FTS-Y201307 > 0                                            
              MOVE WS-TRY-FTS-Y201307      TO F55Y-NUM-TRY-FTS-Y201307          
           END-IF.                                                              
                                                                                
      * COUNT ALL CASES FROM BALLOT DATE 201307 ONWARDS                         
           IF WS-TRY-FTSPA-Y201307 > 0                                          
              MOVE WS-TRY-FTSPA-Y201307    TO F55Y-NUM-TRY-FTSPA-Y201307        
           END-IF.                                                              
                                                                                
           MOVE F730-NUM-ELDERLY           TO F55Y-NUM-ELDERLY.                 
           MOVE F730-NUM-PPO               TO F55Y-NUM-PPO.                     
           MOVE F730-NUM-NTIMER            TO F55Y-NUM-NTIMER.                  
                                                                                
           IF (F730-NUM-MCPS = 'B' OR 'M' OR 'C' OR 'P') OR                     
              (F730-NUM-APPS = 'Y' OR 'F')                                      
              MOVE 'Y'                     TO F55Y-NUM-SPS                      
           ELSE                                                                 
              MOVE 'N'                     TO F55Y-NUM-SPS                      
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(9:6) TO F55Y-TME-UPDATE                   
           MOVE FUNCTION CURRENT-DATE(1:8) TO F55Y-DTE-UPDATE.                  
                                                                                
       7600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       7700-POPULATE-BP13F55Z.                                                  
      *===============================================================*         
                                                                                
           MOVE F730-NUM-REGN                  TO F55Z-NUM-REGN.                
           MOVE F730-DTE-BALLOT                TO F55Z-DTE-BALLOT.              
                                                                                
           IF F730-DTE-BALLOT NOT = SPACES AND LOW-VALUES AND ZEROES            
              MOVE F730-DTE-BALLOT             TO WS-NUM-DTEBAL-HIST            
              COMPUTE WS-DTE-BAL-HIST-YY   = WS-DTE-BAL-HIST-YY - 1             
              COMPUTE WS-DTE-BAL-HIST-MM   = WS-DTE-BAL-HIST-MM + 1             
           END-IF.                                                              
                                                                                
           MOVE WS-NUM-DTEBAL-HIST    TO  F55Z-DTE-BALLOT-HIST(1)               
                                                                                
           INITIALIZE WS-CTR                                                    
           MOVE 2             TO WS-CTR                                         
                                                                                
           PERFORM VARYING WS-CTR FROM 2 BY 1 UNTIL WS-CTR = 12                 
              IF WS-DTE-BAL-HIST-MM = 12                                        
                 MOVE  01     TO   WS-DTE-BAL-HIST-MM                           
                 ADD   01     TO   WS-DTE-BAL-HIST-YY                           
              ELSE                                                              
                 COMPUTE WS-DTE-BAL-HIST-MM = WS-DTE-BAL-HIST-MM + 1            
              END-IF                                                            
              MOVE WS-NUM-DTEBAL-HIST  TO  F55Z-DTE-BALLOT-HIST(WS-CTR)         
           END-PERFORM.                                                         
                                                                                
      * CURRENT BALLOT WILL ALWAYS BE THE LAST OCCURENCE                        
                                                                                
           MOVE F730-NUM-REGN           TO F55Z-NUM-REGN-HIST(12).              
           MOVE F730-DTE-BALLOT         TO F55Z-DTE-BALLOT-HIST(12).            
           MOVE F730-CDE-NT1            TO F55Z-NUM-NT-HIST(12).                
           MOVE F730-CDE-FLAT-TYPE      TO F55Z-NUM-FT-HIST(12).                
           MOVE F730-NUM-BOOK-STATUS    TO F55Z-NUM-BKSTAT-HIST(12).            
           MOVE F730-CDE-REQUEST-STATUS TO F55Z-NUM-RQSTAT-HIST(12).            
           MOVE F730-NUM-ALLO-CAT       TO F55Z-NUM-ALLO-CAT(12).               
                                                                                
           MOVE F730-DTE-REQUEST        TO F55Z-DTE-REGN.                       
           MOVE FUNCTION CURRENT-DATE(9:6) TO F55Z-TME-UPDATE.                  
           MOVE FUNCTION CURRENT-DATE(1:8) TO F55Z-DTE-UPDATE.                  
                                                                                
       7700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       7800-MOVE-BALLOT-HIST-F730.                                              
      *===============================================================*         
                                                                                
           INITIALIZE WS-CTR                                                    
           MOVE 1             TO WS-CTR                                         
           MOVE 'N'           TO WS-HIST-FND                                    
                                                                                
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR = 12                 
                OR WS-HIST-FND = 'Y'                                            
                                                                                
              IF WS-DTE-BALLOT = F55Z-DTE-BALLOT-HIST(WS-CTR)                   
                 CONTINUE                                                       
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       7800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       7900-MOVE-BALLOT-HIST-K595.                                              
      *===============================================================*         
                                                                                
           INITIALIZE WS-CTR                                                    
           MOVE 1             TO WS-CTR                                         
           MOVE 'N'           TO WS-HIST-FND                                    
                                                                                
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR = 12                 
                OR WS-HIST-FND = 'Y'                                            
                                                                                
              IF K595-DTE-BALLOT = F55Z-DTE-BALLOT-HIST(WS-CTR)                 
                 MOVE K595-NUM-REGN      TO F55Z-NUM-REGN-HIST(WS-CTR)          
                 MOVE K595-DTE-BALLOT    TO F55Z-DTE-BALLOT-HIST(WS-CTR)        
                 MOVE K595-CDE-NT1       TO F55Z-NUM-NT-HIST(WS-CTR)            
                 MOVE K595-CDE-FLAT-TYPE TO F55Z-NUM-FT-HIST(WS-CTR)            
                 MOVE K595-NUM-BOOK-STATUS                                      
                   TO F55Z-NUM-BKSTAT-HIST(WS-CTR)                              
                 MOVE K595-CDE-REQUEST-STATUS                                   
                   TO F55Z-NUM-RQSTAT-HIST(WS-CTR)                              
                 MOVE K595-NUM-ALLO-CAT  TO F55Z-NUM-ALLO-CAT(WS-CTR)           
                 MOVE 'Y'                TO WS-HIST-FND                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       7900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8000-WRITE-BP13F55A.                                                     
      *===============================================================*         
                                                                                
           WRITE BP13F55A-REC.                                                  
           ADD 1                          TO CNT-F55A-WRITE.                    
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8100-WRITE-P13F730A.                                                     
      *===============================================================*         
                                                                                
           INITIALIZE P13F730A-REC                                              
                                                                                
           MOVE BP13F730-REC              TO P13F730A-REC.                      
                                                                                
           WRITE P13F730A-REC.                                                  
           ADD 1                          TO CNT-F73A-WRITE.                    
                                                                                
       8100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8200-WRITE-BP13F55Y.                                                     
      *===============================================================*         
                                                                                
           WRITE BP13F55Y-REC.                                                  
           ADD 1                          TO CNT-F55Y-WRITE.                    
                                                                                
       8200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       8300-WRITE-BP13F55Z.                                                     
      *===============================================================*         
                                                                                
           WRITE BP13F55Z-REC.                                                  
           ADD 1                          TO CNT-F55Z-WRITE.                    
                                                                                
       8300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       9000-CLOSE-FILES.                                                        
      *===============================================================*         
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '***************************************'.                   
           DISPLAY 'PROGRAM ID     :  BP13CB95'.                                
           DISPLAY '***************************************'.                   
           DISPLAY 'NO. OF BP13F730 READ          : ' CNT-F730-READ.            
           DISPLAY 'NO. OF BP13K820 READ          : ' CNT-K820-READ.            
           DISPLAY 'NO. OF BP13K825 READ          : ' CNT-K825-READ.            
           DISPLAY 'NO. OF BP13K828 READ          : ' CNT-K828-READ.            
           DISPLAY 'NO. OF BP13K595-NRIC1 READ    : ' CNT-K595-NRIC1.           
           DISPLAY 'NO. OF BP13K595-NRIC2 READ    : ' CNT-K595-NRIC2.           
           DISPLAY 'NO. OF BP13K595-NRIC3 READ    : ' CNT-K595-NRIC3.           
           DISPLAY 'NO. OF BP13K595-NRIC4 READ    : ' CNT-K595-NRIC4.           
           DISPLAY 'NO. OF BP13K595-NRIC NOT FOUND: ' CNT-K595-NOTFND.          
           DISPLAY 'NO. OF BP13K730-NRIC1 READ    : ' CNT-K730-NRIC1.           
           DISPLAY 'NO. OF BP13K730-NRIC2 READ    : ' CNT-K730-NRIC2.           
           DISPLAY 'NO. OF BP13K730-NRIC NOT FOUND: ' CNT-K730-NOTFND.          
           DISPLAY 'NO. OF CANCELLED CASES        : ' CNT-CANCEL.               
           DISPLAY 'NO. OF RECS WRITTEN BP13F55A  : ' CNT-F55A-WRITE.           
           DISPLAY 'NO. OF RECS WRITTEN P13F730A  : ' CNT-F73A-WRITE.           
           DISPLAY 'NO. OF RECS WRITTEN BP13F55Y  : ' CNT-F55Y-WRITE.           
           DISPLAY 'NO. OF RECS WRITTEN BP13F55Z  : ' CNT-F55Z-WRITE.           
           DISPLAY 'NO. OF RECS BYPASS F55Y/F55Z  : ' CNT-BYPASS.               
                                                                                
           CLOSE SY02F001                                                       
                 BP13F730                                                       
                 BP13K060                                                       
                 BP13K820                                                       
                 BP13K825                                                       
                 BP13K828                                                       
                 BP13K595                                                       
                 BP13K730                                                       
                 BP13K813                                                       
                 BP13K585                                                       
                 BP13K587                                                       
                 BP13F55A                                                       
                 P13F730A                                                       
                 BP13F55Y                                                       
                 BP13F55Z.                                                      
                                                                                
           IF K585-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K585 , STATUS = ' K585-STATUS          
           END-IF.                                                              
                                                                                
           IF K060-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K060 , STATUS = ' K060-STATUS          
           END-IF.                                                              
                                                                                
           IF K813-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K813 , STATUS = ' K813-STATUS          
           END-IF.                                                              
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K820 , STATUS = ' K820-STATUS          
           END-IF.                                                              
                                                                                
           IF K825-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K825 , STATUS = ' K825-STATUS          
           END-IF.                                                              
                                                                                
           IF K828-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K828 , STATUS = ' K828-STATUS          
           END-IF.                                                              
                                                                                
           IF K595-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K595 , STATUS = ' K595-STATUS          
           END-IF.                                                              
                                                                                
           IF K730-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K730 , STATUS = ' K730-STATUS          
           END-IF.                                                              
                                                                                
           IF K587-STATUS NOT = 00 AND 97                                       
              DISPLAY 'ERROR CLOSING BP13K587 , STATUS = ' K587-STATUS          
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
