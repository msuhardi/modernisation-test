      *------------------------*                                                
       IDENTIFICATION DIVISION.                                                 
      *------------------------*                                                
       PROGRAM-ID.    BP13C426.                                                 
      *AUTHOR.        RML.                                                      
      *DATE-WRITTEN.  28/05/1993.                                               
                                                                                
      * ============================================================ *          
      *                   SYSTEM OF COMMITMENT (BP13)                *          
      * ============================================================ *          
      *  OBJECTIVE :                                                 *          
      *    1.  THIS IS THE PROGRAM TO PRINT OUT LETTERS TO INFORM    *          
      *        APPLICANTS TO SIGN SALES ORDER FOR SALES TYPE 2B.     *          
      *                                                              *          
      *  INPUT FILES : 1. BP13F310  -  DAILY TRANSACTION FILE        *          
      *                2. BP13K800  -  SOC APPLICATION MASTER        *          
      *                3. BP13K820  -  SOC OCCUPIER FILE             *          
      *                4. BP13K830  -  CORR ADDRESS FILE             *          
      *                5. BM06K110  -  FLATINV FILE                  *          
      *                                                              *          
      * ------------------------------------------------------------ *          
      * CHG REF  BY   DATE     DESCRIPTION                           *          
      * -------- ---  ------   -----------                           *          
      * 5900507  LKH  040590   DETERMINE IF THE FLAT IS UNDER HDB OR *          
      *                        TC, THEN PRT APPROPRIATE SC-CC AMT.   *          
      * C910181  YPH  060391   NEW FORMAT FOR SALES ORDER TYPE 1     *          
      * C910481  ACK  120891   PRINT EXPIRED DATE FOR TP AND REMOVE  *          
      *                        THE PRINTING OF SC/CC.                *          
      * C9103420 TJF  011291   CHANGE SPC TO BUC.                    *          
      * SOC8A    RML  280593   RETRIEVE ADDRESS FROM BP13K830.       *          
      * SOC8B    RML  220793   REFER TO BP13K800/K820.               *          
      * C9309A1  JEP  011193   TO CHECK FOR FOREIGN ADDRESS          *          
      * N940006  LMS  110194   TO READ APPLICANTS' INFO FROM K820    *          
      *                        WHEN APPLICANTS EXIST.                *          
      * C940256  LSB  140494   DO NOT CLOSE FILE IF ADDR NOT FOUND   *          
      * C9404E6  LJL  170594   TO CATER FOR SALES TYPE 2B ,IE        *          
      *                        SITTING TENANT SCHEME                 *          
      *                        (K110-FLAT-STATUS = 'SD')             *          
      * C940256  BAL  290694   RE-ALIGN THE PRINTING FORMAT AND CALL *          
      *                        AB20C901 TO PRINT AMT-ISURED AND      *          
      *                        AMT-PREMIUM.                          *          
      *                        TO PRINT ALSO BP1305 FORM.            *          
      * N940017  YPH  221294   HANDLE LOW-VALUES OF NRICS            *          
      * BP130020 SSS  13101995 REPOSITION 624B-LIST TO COL 1         *          
      * BP130037 LJL  24101995 CATER FOR SALES TYPE 1,2,2B,3 & 3A    *          
      * BP130046 EG1  01111995 CATER FOR JUNKMAIL OPTION.            *          
      * BP130107 SSS  10041996 CALL AB20C900 INSTEAD OF AB20C901     *          
      * BP130173 SSS  17091996 DUPLEX FOR FORM-05 (BP1305)           *          
      * BP130270 LJL  14041997 STAMP DUTY PAYABLE AT MARKET RATE,    *          
      *                        NOT DISCOUNTED SELLING PRICE FOR      *          
      *                        SALES TYPE 2B.                        *          
      * BP130270 RHB  17041997 ADD PRINTING OF WORKSHEET.            *          
      * BP130345 SGK  02081997 TO INCLUDE GRANT IN SC/CC CALC AND    *          
      *                        AMERICAN ASSURANCE COMPANY.           *          
      * BP130480 SGK  16041998 TO REFLECT THE AB03K050 KEY-FLD &     *          
      *                        SIZE CHANGES.                         *          
      * BP130418 CLT  28081998 TO CATER FOR Y2K.                     *          
      * BP130636 JMS  12021999 TO CATER FOR RECOVERY OF TC.          *          
      * BP130669 JMS  03061999 TO ADD SALES-TYPE-SURVEY.             *          
      * BP130885 RAS  26062000 TO CHANGE BP13C902 TO BP13C903        *          
      * BP130998 CLT  02042001 ENHANCE AB20C900 FOR SA FLAT          *          
      * BP130925 ANC  04072001 REMOVE K800-NUM-LESSEE                *          
      * BP132037 CKK  16102001 TO REDUCE 30% IN STAMP FEE DUE TO     *          
      *                        2001 OFF-BUDGET MEASURE               *          
      * BP132037 CKK  07112001 TO CHANGE 18000 TO WS-LS-LEAVE        *          
      * BP132097 MALC 11022002 TO CATER FOR MARRIED CHILD PRIO SCHEME*          
      * BP132125 MCC  07042002 ROUNDING OF ODD CENTS                 *          
      * BP132096 CKK  22042002 TO PRINT BARCODE FOR QMS AND REMOVE   *          
      *                        PRINTING OF JUNK-MAIL LETTER          *          
      * BP132127 CKK  13052002 CHANGE LETTER LAYOUT DUE TO RELOCATION*          
      * BP132160 AS1  27062002 MOVE THE BAR CODE FROM TOP TO BOTTOM  *          
      * BP132237 MALC 28102002 REMOVE 30% OFF-BUDGET DISCOUNT        *          
      * BP132263 MALC 14112002 TO CATER FOR CHANGE OF GST            *          
      * BP132352 CKK7 12062003 TO READ K022 AND K024                 *          
      * BP132352 SK   070603  TO REMOVE PRINTING HP NUMBER           *          
      * BP132399 MALC 120803  REMOVE CD COMPUTATION                  *          
      * BP132429 MALC 141103  TO HARDCODE 5% GST                     *          
      * BP132588 JF4  240804  PASS SYSTEM DATE TO AB20C900 PROGRAM   *          
      * BP132717 JF4  080705  CATER FOR CD CASH REFUND               *          
      * BP135109 RJE1 201213  LETTERHEADS WITH NEW PUBLIC MAILBOX    *          
      *                       EMAIL ADDRESSES                        *          
      * BP139485 KAC1 020124  TO CALL BP13C90D FOR 9 % GST           *          
      * ============================================================ *          
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F310  ASSIGN        TO BP13F310.                          
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS BP13K022-STATUS.                    
                                                                                
           SELECT BP13K024  ASSIGN       TO BP13K024                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K024-KEY-FLD                        
                            FILE STATUS  IS BP13K024-STATUS.                    
                                                                                
           SELECT AB03K050  ASSIGN        TO AB03K050                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K050-KEY                           
                            FILE STATUS   IS AB03K050-STATUS.                   
           SELECT BP13K800  ASSIGN        TO BP13K800                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K800-NUM-REGN                      
                            FILE STATUS   IS BP13K800-STATUS.                   
           SELECT BP13K820  ASSIGN        TO BP13K820                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K820-KEY-FLD                       
                            FILE STATUS   IS BP13K820-STATUS.                   
           SELECT BP13K830  ASSIGN        TO BP13K830                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K830-KEY-FLD                       
                            ALTERNATE RECORD KEY IS K830-NUM-REGN               
                            FILE STATUS   IS BP13K830-STATUS.                   
           SELECT BM06K110  ASSIGN        TO BM06K110                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K110-KEY-FLD                       
                            FILE STATUS   IS BM06K110-STATUS.                   
           SELECT P13L426C  ASSIGN        TO P13L426C.                          
           SELECT P13L426D  ASSIGN        TO P13L426D.                          
           SELECT P13L426E  ASSIGN        TO P13L426E.                          
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F310                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13F310.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   AB03K050                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY AB03K050.                                                           
                                                                                
       FD   P13L426C                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   L426C-PRTREC               PIC X(132).                              
                                                                                
       FD   P13L426D                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   L426D-PRTREC               PIC X(132).                              
                                                                                
       FD   P13L426E                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   L426E-PRTREC               PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY AB20M97C.                                                           
                                                                                
       01  WS-C908-PARAMETERS.                                                  
           05  WS-INPUT-PARAMETERS.                                             
               10  WS-C908-TXT-IN-SIZE       PIC 9(2).                          
               10  WS-C908-TXT-INPUT         PIC X(30).                         
           05  WS-OUTPUT-PARAMETERS.                                            
               10  WS-C908-TXT-OUT-SIZE      PIC 9(2).                          
               10  WS-C908-TXT-OUTPUT        PIC X(40).                         
           05  WS-C908-RETCODE               PIC S9(04)  COMP.                  
                                                                                
       05  BP13K022-STATUS             PIC 99       VALUE ZEROS.                
       05  BP13K024-STATUS             PIC 99       VALUE ZEROS.                
       01  BM06K110-STATUS             PIC 99       VALUE ZEROES.               
       01  BP13K820-STATUS             PIC 99       VALUE ZEROES.               
       01  BP13K800-STATUS             PIC 99       VALUE ZEROES.               
       01  BP13K830-STATUS             PIC 99       VALUE ZEROES.               
       01  AB03K050-STATUS             PIC 99       VALUE ZEROES.               
       01  WS-AMT-SC-CC                PIC 9(4)V99  VALUE ZEROES.               
       01  WS-AMT-SC-CC1               PIC 9(4)V99  VALUE ZEROES.               
       01  WS-AMT-SC-CC2               PIC 9(4)V99  VALUE ZEROES.               
       01  WS-AMT-SC-CC3               PIC 9(4)V99  VALUE ZEROES.               
       01  WS-NUMBER                   PIC 9(2)     VALUE 60.                   
       01  WS-ERR-NO                   PIC 9(2)     VALUE 60.                   
       01  NO-OF-READ-F310             PIC 9(6)     VALUE ZEROES.               
       01  NO-OF-LETTER                PIC 9(6)     VALUE ZEROES.               
       01  NO-OF-GIRO                  PIC 9(6)     VALUE ZEROES.               
       01  NO-OF-ERROR                 PIC 9(6)     VALUE ZEROES.               
       01  NO-OF-PAGE                  PIC 9(5)     VALUE ZEROES.               
       01  NO-OF-ERR-PAGE              PIC 9(5)     VALUE ZEROES.               
       01  WS-SC-CC1-AMT               PIC 9(5)V99  VALUE ZEROS.                
       01  WS-SC-CC2-AMT               PIC 9(5)V99  VALUE ZEROS.                
       01  WS-SC-CC3-AMT               PIC 9(5)V99  VALUE ZEROS.                
       01  WS-S903-SC-CC1-GST          PIC 9(4)V99  VALUE ZEROS.                
       01  WS-S903-SC-CC2-GST          PIC 9(4)V99  VALUE ZEROS.                
       01  WS-S903-SC-CC3-GST          PIC 9(4)V99  VALUE ZEROS.                
       01  WS-S903-SC-TC1-GST          PIC 9(4)V99  VALUE ZEROS.                
       01  WS-S903-SC-TC2-GST          PIC 9(4)V99  VALUE ZEROS.                
       01  WS-S903-SC-TC3-GST          PIC 9(4)V99  VALUE ZEROS.                
       01  WS-SC-CC-NUM-AMT            PIC 9(4)V99  VALUE ZEROS.                
       01  WS-SC-CC-NUM-AMT-GST        PIC 9(4)V99  VALUE ZEROS.                
       01  WS-K820-EOF                 PIC X        VALUE 'N'.                  
       01  WS-K050-EOF                 PIC X        VALUE 'N'.                  
                                                                                
       01  WS-AB03K050-REC             PIC X(200)  VALUE SPACES.                
       01  WS-K820-KEY.                                                         
           05  WS-K820-REGN            PIC X(8)    VALUE SPACES.                
           05  FILLER                  PIC X(9)    VALUE SPACES.                
                                                                                
       01  WS-SC-CC-DESC.                                                       
           05  FILLER                   PIC X(1)   VALUE '('.                   
           05  WS-SC-CC-AMT             PIC ZZ9.99 VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '+'.                   
           05  WS-SC-CC-AMT-GST         PIC   9.99 VALUE SPACES.                
           05  FILLER                   PIC X(3)   VALUE 'GST'.                 
           05  WS-SC-CC-SIGN            PIC X(1)   VALUE '-'.                   
           05  WS-SC-CC-REBATE-AMT      PIC   Z.ZZ VALUE SPACES.                
           05  WS-SC-CC-REBATE-DESC     PIC X(3)   VALUE 'REB'.                 
           05  WS-SC-CC-SIGN2           PIC X(1)   VALUE '-'.                   
           05  WS-SC-CC-GRANT-AMT       PIC   Z.ZZ VALUE SPACES.                
           05  WS-SC-CC-GRANT-DESC      PIC X(3)   VALUE 'GRT'.                 
           05  WS-SC-CC-SIGN3           PIC X(1)   VALUE '-'.                   
           05  WS-SC-CC-REB-SP-AMT      PIC   Z.ZZ VALUE SPACES.                
           05  WS-SC-CC-REB-SP-DESC     PIC X(3)   VALUE 'SP)'.                 
                                                                                
       01  WS-WORKSHEET-VAR.                                                    
           05  WS-K110-CSPRICE-OFFER        PIC 9(8)      VALUE ZEROES.         
           05  WS-K110-CSPRICE              PIC 9(8)      VALUE ZEROES.         
           05  WS-COMP-LS-FEE               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-CV-FEE               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-TOTAL                PIC S9(8)V99  VALUE ZEROES.         
           05  WS-LS-LEAVE                  PIC S9(8)V99  VALUE ZEROES.         
           05  WS-CONV-LEAVE                PIC S9(8)V99  VALUE ZEROES.         
           05  WS-ROUND-CONVFEE             PIC S9(8)V99  VALUE ZEROES.         
           05  WS-TOTAL-SELLPR              PIC S9(8)V99  VALUE ZEROES.         
           05  WS-BALANCE-AMT               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-MAX-LOAN-AMT              PIC S9(7)V99  VALUE ZEROES.         
           05  WS-TOTAL-CD                  PIC S9(7)V99  VALUE ZEROES.         
           05  WS-UPD-CD-CASH               PIC S9(7)V99  VALUE ZEROES.         
           05  WS-TOTAL-FEES                PIC S9(6)V99  VALUE ZEROES.         
           05  WS-COMP-SURVEY-FEE           PIC S9(5)V99  VALUE ZEROES.         
           05  WS-COMP-LEASE                PIC S9(5)V99  VALUE ZEROES.         
           05  WS-COMP-MORTGAGE             PIC S9(5)V99  VALUE ZEROES.         
           05  WS-TOT-STAMP-FEE             PIC S9(5)V99  VALUE ZEROES.         
           05  WS-MORT-STAMP-FEE            PIC S9(5)V99  VALUE ZEROES.         
           05  WS-TOT-SCCC                  PIC S9(5)V99  VALUE ZEROES.         
           05  WS-INTREST-RATE              PIC 9(2)V99   VALUE ZEROES.         
           05  WS-MTHLY-INSTAL              PIC 9(5)V99   VALUE ZEROES.         
           05  WS-LOAN-ROUND-DOWN.                                              
               10  WS-LOAN-INT-5            PIC 9(5)      VALUE ZEROS.          
               10  WS-LOAN-INT-2            PIC 9(2)V99   VALUE ZEROS.          
                                                                                
           05  K022-FOUND                   PIC X     VALUE 'N'.                
           05  K024-FOUND                   PIC X     VALUE 'N'.                
           05  WS-FIRST-CASE                PIC X     VALUE 'Y'.                
           05  WS-NUM-OIC                   PIC X(5).                           
           05  WS-OIC-TABLE.                                                    
               10 WS-OIC-TAB OCCURS 5 TIMES PIC X.                              
           05  WS-OIC-EMAIL-TABLE.                                              
               10 WS-OIC-EMAIL-TAB OCCURS 5 TIMES PIC X.                        
                                                                                
           05  WS-CNT-K024                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K022                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CTR                       PIC 9     VALUE ZEROS.              
           05  WS-CTR2                      PIC 9     VALUE ZEROS.              
           05  WS-EMAIL                     PIC X(19)  VALUE SPACES.            
           05  WS-HDR-PHONE-DID             PIC X(25)  VALUE SPACES.            
                                                                                
           05  WS-COMPARE-DATE.                                                 
               10  WS-COMPARE-YY           PIC 9(4)   VALUE ZEROS.              
               10  WS-COMPARE-MM           PIC 99     VALUE ZEROS.              
                   88  FIRST-HALF              VALUE 01 02 03 04 05 06.         
                   88  SECOND-HALF             VALUE 07 08 09 10 11 12.         
               10  WS-COMPARE-DD           PIC 99     VALUE ZEROS.              
                                                                                
           05  WS-COMPUTE-DATE.                                                 
               10  WS-COMPUTE-CC        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-YY        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-MM        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-DD        PIC 99     VALUE ZEROS.                 
                                                                                
       01  WS-LINK-S900.                                                        
           05  WS-S900-SELL-PR             PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-DESIGN              PIC X(3)     VALUE SPACES.           
           05  WS-S900-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S900-CD-PREV-PAID        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-TOT-ICP             PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S900-PREM-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-SURVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-ESCROW-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-REGN-FEE         PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ESCROW-FEE     PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-MORT-REGN-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LOAN                PIC S9(7)V99 VALUE ZEROES.           
           05  WS-S900-ORIG-SELL           PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-SALE-TYPE           PIC X(2)     VALUE SPACES.           
           05  WS-S900-PREMIUM-CODE        PIC X(2)     VALUE SPACES.           
           05  WS-S900-SURVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-SALES-TYPE-SURVEY   PIC X(2)     VALUE SPACES.           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C901"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S901.                                                        
           05  WS-S901-INT                 PIC 9V9(4)   VALUE ZEROES.           
           05  WS-S901-FAC                 PIC 9(2)     VALUE ZEROES.           
           05  WS-S901-ERL                 PIC X        VALUE SPACE.            
           05  WS-S901-LOAN-AMT            PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-ERL-LOAN-AMT        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S901-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S901-DESIGN              PIC X(3)     VALUE SPACES.           
           05  FILLER                      PIC X(1)     VALUE SPACE.            
           05  WS-S901-MTH-INSTAL          PIC S9(5)V99 VALUE +0.               
           05  WS-S901-SUB-INSTAL          PIC S9(5)V99 VALUE +0.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C905"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S905.                                                        
           05  WS-S905-SC-CC1              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC2              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC3              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-TOTAL-AMT        PIC 9(7)V99  VALUE ZEROES.           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C903"          *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S903.                                                        
           05  WS-S903-NUM-SCH-ACC          PIC X(9)     VALUE SPACES.          
           05  WS-S903-SO-EFF-DATE.                                             
               10  WS-S903-SO-EFF-CC        PIC 9(2)     VALUE ZEROES.          
               10  WS-S903-SO-EFF-YYMMDD    PIC 9(6)     VALUE ZEROES.          
           05  WS-S903-DESIGN-TY            PIC X(3)     VALUE SPACES.          
           05  WS-S903-ROOM-TY              PIC X(2)     VALUE SPACES.          
           05  WS-S903-SC-CC1               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC2               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC3               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-TOTAL-AMT         PIC 9(7)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT1            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT2            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT3            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-CURR-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-SC-NEXT-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-RET-CODE             PIC X(2)     VALUE SPACES.          
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "AV02C021"          *             
      *-----------------------------------------------------------*             
       COPY P13GST01.                                                           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C90B"          *             
      *-----------------------------------------------------------*             
       COPY P13GST02.                                                           
                                                                                
      *------------------------*                                                
      *  LINKAGE FOR AV02C015  *                                                
      *------------------------*                                                
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE         PIC X(6).                           
           05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                           
                                                                                
       01  WS-DTE-WEF.                                                          
           05  WS-WEF-CC                 PIC X(2)  VALUE SPACES.                
           05  WS-WEF-YY                 PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X(1)  VALUE SPACE.                 
           05  WS-WEF-MM                 PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X(1)  VALUE SPACE.                 
           05  WS-WEF-DD                 PIC X(2)  VALUE SPACES.                
                                                                                
       01  WS-DTE-SCCC.                                                         
           05  WS-SCCC-DD                PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X     VALUE '/'.                   
           05  WS-SCCC-MM                PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X     VALUE '/'.                   
           05  WS-SCCC-CC                PIC X(2)  VALUE SPACES.                
           05  WS-SCCC-YY                PIC X(2)  VALUE SPACES.                
                                                                                
       01  WS-NAME                       PIC X(66) VALUE SPACES.                
                                                                                
       01  WS-SWITCHES.                                                         
           05  F310-EOF                  PIC X     VALUE 'N'.                   
                                                                                
       01  FOUND-FLAG.                                                          
           05  K820-NOT-FOUND            PIC X     VALUE 'N'.                   
           05  K800-NOT-FOUND            PIC X     VALUE 'N'.                   
           05  K110-NOT-FOUND            PIC X     VALUE 'N'.                   
           05  K830-NOT-FOUND            PIC X     VALUE 'N'.                   
                                                                                
       01  WS-DTE-EXPIRED-TP             PIC 9(8)  VALUE ZEROS.                 
                                                                                
       01  WS-CURRENT-DATE               PIC 9(8).                              
       01  WS-CUR-DATE.                                                         
           05  WS-CUR-CC                 PIC 99.                                
           05  WS-CUR-YY                 PIC 99.                                
           05  WS-CUR-MM                 PIC 99.                                
           05  WS-CUR-DD                 PIC 99.                                
       01  WS-EDITED-DTE                 PIC X(10).                             
                                                                                
       01  PARAM-LIST.                                                          
           05  WS-RETCODE              PIC X(2)     VALUE SPACES.               
           05  WS-SQL-RETCODE          PIC S9(3)    VALUE ZEROES.               
           05  WS-SCHACC               PIC X(11)    VALUE SPACES.               
           05  WS-AMT-SCNXT-TOT        PIC S9(4)V99 VALUE ZEROES.               
           05  WS-AMT-SCCUR-TOT        PIC S9(4)V99 VALUE ZEROES.               
           05  WS-AMT-SCPREV-TOT       PIC S9(4)V99 VALUE ZEROES.               
           05  WS-DTE-EFF-SCNXT        PIC X(10)    VALUE SPACES.               
           05  WS-DTE-EFF-SCCUR        PIC X(10)    VALUE SPACES.               
           05  WS-DTE-EFF-SCPREV       PIC X(10)    VALUE SPACES.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1326)                 *             
      *-----------------------------------------------------------*             
                                                                                
       01  L426-LINE-OIC.                                                       
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  L426-OIC-NAME           PIC X(30) VALUE SPACES.                  
           05  FILLER                  PIC X(26) VALUE SPACES.                  
                                                                                
       01  L426-LINE-OIC1.                                                      
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  L426-OIC-DESG           PIC X(24) VALUE SPACES.                  
           05  FILLER                  PIC X(32) VALUE SPACES.                  
                                                                                
       01  L426-LINE-BARCODE.                                                   
           05  FILLER                  PIC X(66) VALUE SPACES.                  
           05  L426-BARCODE-REGN       PIC X(13) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-A.                                                      
           05  FILLER                  PIC X(28) VALUE SPACES.                  
           05  426A-BOTCCC.                                                     
               10  426A-BO             PIC X(2)  VALUE SPACES.                  
               10  426A-SLASH1         PIC X     VALUE SPACES.                  
               10  426A-TC             PIC X(2)  VALUE SPACES.                  
               10  426A-SLASH2         PIC X     VALUE SPACES.                  
               10  426A-CC             PIC X(2)  VALUE SPACES.                  
           05  FILLER                  PIC X(40) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-1.                                                      
           05  FILLER                  PIC X(28) VALUE SPACES.                  
           05  426A-ALLOC-NT           PIC X(3)  VALUE 'XX'.                    
           05  FILLER                  PIC X     VALUE '/'.                     
           05  426A-RM-TY              PIC X(2)  VALUE 'X'.                     
           05  FILLER                  PIC X     VALUE '/'.                     
           05  426A-REGN-NO1           PIC X(8)  VALUE SPACES.                  
           05  FILLER                  PIC XX    VALUE ' ('.                    
           05  426A-ALLOC-SCH          PIC X(3)  VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE ')'.                     
                                                                                
       01  426A-PR-HEAD-2A.                                                     
           05  FILLER                  PIC X(28) VALUE SPACES.                  
           05  426A-SCHEME             PIC X(4)  VALUE 'XXXX'.                  
           05  FILLER                  PIC X     VALUE '-'.                     
           05  426A-ACC                PIC X(5)  VALUE 'XXXXX'.                 
           05  FILLER                  PIC X     VALUE '-'.                     
           05  426A-ACC-TYPE           PIC X(2)  VALUE SPACES.                  
           05  FILLER                  PIC X(36) VALUE SPACES.                  
           05  L426-HDR-PHONE-DID      PIC X(24) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-2B.                                                     
           05  FILLER                  PIC X(77) VALUE SPACES.                  
           05  426A-DATE               PIC X(10) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-3.                                                      
           05  FILLER                  PIC X(11) VALUE SPACES.                  
           05  426A-APPL-NAME          PIC X(66) VALUE SPACES.                  
           05  FILLER                  PIC X(8)  VALUE SPACES.                  
           05  L426-EMAIL              PIC X(19) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-3B.                                                     
           05  FILLER                  PIC X(11)   VALUE SPACES.                
           05  426A-COAPPL-NAME        PIC X(66).                               
                                                                                
       01  426A-PR-HEAD-4.                                                      
           05  FILLER                  PIC X(11) VALUE SPACES.                  
           05  426A-BLK-NO             PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(2)  VALUE SPACES.                  
           05  426A-NUM-FLAT.                                                   
               10  426A-CHAR           PIC X     VALUE SPACES.                  
               10  426A-LEVEL          PIC X(2)  VALUE SPACES.                  
               10  426A-DASH           PIC X     VALUE SPACE.                   
               10  426A-HSE-MAIN       PIC X(4)  VALUE SPACES.                  
               10  426A-HSE-SUB        PIC X(3)  VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-5.                                                      
           05  FILLER                  PIC X(11) VALUE SPACES.                  
           05  426A-STREET-NAME        PIC X(65) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-6.                                                      
           05  FILLER                  PIC X(11) VALUE SPACES.                  
           05  426A-POSTAL-CD          PIC X(16) VALUE SPACES.                  
           05  426A-DOT                PIC X(1)  VALUE SPACE .                  
           05  FILLER                  PIC X(97) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-7.                                                      
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  426A-BAR-CODE           PIC X(09) VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-9A.                                                     
           05  FILLER                  PIC X(18) VALUE SPACES.                  
           05  426A-F310-BLK-NO        PIC X(5)  VALUE 'XXXXX'.                 
           05  FILLER                  PIC X(2)  VALUE ' #'.                    
           05  426A-F310-LEVEL-NO      PIC X(2)  VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE '-'.                     
           05  426A-F310-MAIN-UNIT     PIC X(5)  VALUE SPACES.                  
           05  FILLER                  PIC X(2)  VALUE SPACES.                  
           05  426A-F310-STREET-NAME   PIC X(20) VALUE ALL 'X'.                 
           05  FILLER                  PIC X(2)  VALUE SPACES.                  
           05  426A-COUNTRY-NAME       PIC X(10) VALUE 'SINGAPORE '.            
           05  426A-F310-POST-CODE     PIC X(6)  VALUE SPACES.                  
           05  426A-F310-DOT           PIC X(1)  VALUE SPACE.                   
                                                                                
       01  426A-PR-HEAD-10.                                                     
           05  FILLER                  PIC X(26) VALUE SPACES.                  
           05  426A-SELLING-PRICE      PIC $$$,$$$,$$9.                         
           05  FILLER                  PIC X(18) VALUE SPACES.                  
           05  426A-SITTING-TENANT     PIC X(6).                                
                                                                                
       01  426A-PR-HEAD-10A.                                                    
           05  FILLER                     PIC X(72)  VALUE SPACES.              
           05  426A-AMT-INSURED           PIC ZZZ,ZZ9.99.                       
           05  426A-AMT-I-R REDEFINES 426A-AMT-INSURED                          
                                          PIC X(10).                            
       01  426A-PR-HEAD-10B.                                                    
           05  FILLER                     PIC X(22)  VALUE SPACES.              
           05  426A-AMT-PREMIUM           PIC ZZ9.99.                           
           05  426A-AMT-P-R REDEFINES 426A-AMT-PREMIUM                          
                                          PIC X(6).                             
       01  426A-PR-HEAD-11.                                                     
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(12) VALUE 'ED FOR TP :'.           
           05  426A-DTE-EXPIRED-TP     PIC X(10) VALUE SPACES.                  
           05  426A-DTE-DES1           PIC X(3)  VALUE SPACES.                  
           05  426A-DTE-EXPIRED-DES    PIC X(3)  VALUE SPACES.                  
           05  426A-DTE-DES2           PIC X(2)  VALUE SPACES.                  
                                                                                
       01  426A-PR-HEAD-12.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(03)  VALUE 'SC:'.               
           05  426A-AMT-CURR-SCCC         PIC ZZ9.99.                           
           05  FILLER                     PIC X(5)   VALUE ' WEF '.             
           05  426A-DTE-CURR-SCCC         PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  426A-CURR-GST-DESC         PIC X(45)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L426-BARCODE1-PREFIX       PIC X(2)   VALUE SPACES.              
           05  L426-BARCODE1-REGN         PIC X(8)   VALUE SPACES.              
                                                                                
       01  426A-PR-HEAD-13.                                                     
           05  FILLER                     PIC X(13)  VALUE SPACES.              
           05  426A-AMT-NEXT-SCCC         PIC ZZ9.99.                           
           05  FILLER                     PIC X(5)   VALUE ' WEF '.             
           05  426A-DTE-NEXT-SCCC         PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  426A-NEXT-GST-DESC         PIC X(48)  VALUE SPACES.              
                                                                                
       01  426A-MISC.                                                           
           05  426A-ALP-ROOM              PIC X(2)   VALUE SPACES.              
           05  426A-ROOM                  PIC X(2)   VALUE SPACES.              
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1326)                 *             
      *    AND CONTRACT PERSONS                                   *             
      *-----------------------------------------------------------*             
       01  L426-DTL-HAND-PHONE.                                                 
           05  FILLER                     PIC X(53)  VALUE SPACES.              
           05  L426-ASSIST-HP             PIC X(12)  VALUE SPACES.              
                                                                                
       01  L426-DTL-DID.                                                        
           05  FILLER                     PIC X(50)  VALUE SPACES.              
           05  L426-CHG-APPT-DID          PIC X(8)   VALUE SPACES.              
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT  FOR WORKSHEET                        *             
      *-----------------------------------------------------------*             
       01  L310-PR-HEAD-09.                                                     
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L211-CDE-NT                 PIC X(3)  VALUE 'XXX'.               
           05  FILLER                      PIC X     VALUE '/'.                 
           05  L211-RECOM-RM-TYPE          PIC X(2)  VALUE 'X'.                 
           05  FILLER                      PIC X     VALUE '/'.                 
           05  L211-REGN-NO                PIC X(8)  VALUE SPACES.              
                                                                                
       01  L310-PR-HEAD-10.                                                     
           05  FILLER                      PIC X(49) VALUE SPACES.              
           05  L211-AMT-SELL-PRICE         PIC $$$,$$$,$$9.                     
           05  FILLER                      PIC X(2)  VALUE SPACES.              
           05  L211-AMT-LS-FEE             PIC ZZ,ZZZ,ZZ9.99.                   
                                                                                
       01  L310-PR-HEAD-12.                                                     
           05  FILLER                      PIC X(28) VALUE SPACES.              
           05  L211-ACT-CV-FEE             PIC Z,ZZ9.99.                        
           05  FILLER                      PIC X(6)  VALUE SPACES.              
           05  L211-GST-CV-FEE             PIC ZZ9.99.                          
           05  FILLER                      PIC X(17) VALUE SPACES.              
           05  L211-AMT-CV-FEE             PIC ZZZ,ZZ9.99.                      
                                                                                
       01  L310-PR-HEAD-TOTAL.                                                  
           05  FILLER                      PIC X(61) VALUE SPACES.              
           05  L211-AMT-TOTAL              PIC ZZZ,ZZZ,ZZ9.99.                  
                                                                                
      *==> PART-A PRINT NOTES                                                   
       01  L310-PR-LINE-15.                                                     
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L310-SYS-DATE               PIC X(10) VALUE SPACES.              
                                                                                
       01  L310-PR-LINE-16.                                                     
           05  FILLER                      PIC X(17)  VALUE SPACES.             
           05  L310-AMT-CURR-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-CURR-SCCC          PIC X(10)  VALUE SPACES.             
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-CURR-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
       01  L310-PR-LINE-17.                                                     
           05  FILLER                      PIC X(17) VALUE SPACES.              
           05  L310-AMT-NEXT-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-NEXT-SCCC          PIC X(10)  VALUE SPACES.             
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-NEXT-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
      *==> PART-B PRINT VARIABLES                                               
       01  L400C-PR-LINE-1.                                                     
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-REPAY-PRD           PIC ZZ9.                                
           05  FILLER                   PIC X(6)   VALUE ' YEARS'.              
                                                                                
       01  L400C-PR-LINE-2.                                                     
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-INT-RATE            PIC Z9.99.                              
           05  FILLER                   PIC X(2)   VALUE ' %'.                  
                                                                                
       01  L400C-PR-LINE-3.                                                     
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-SELLING-PRICE       PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-4.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-LEASE-FEE           PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-5.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORT-STAMP-FEE      PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-6.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORTGAGE-FEE        PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-7.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-TOT-STAMP-FEE       PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-8.                                                     
           05  FILLER                   PIC X(24)  VALUE SPACES.                
           05  FILLER                   PIC X      VALUE '('.                   
           05  400C-SURVEY-FEE-ACT      PIC Z,ZZ9.99.                           
           05  FILLER                   PIC X(3)   VALUE ' + '.                 
           05  400C-SURVEY-FEE-GST      PIC ZZ9.99.                             
           05  FILLER                   PIC X(8)   VALUE ' GST)'.               
           05  400C-TOT-SURVEY-FEE      PIC ZZZ,ZZ9.99.                         
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400C-TOT-FEES            PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-9.                                                     
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-TOT-SELLPR          PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-10.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CASH             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-11.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF1             PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400C-CD-CPF1-TXT         PIC X(5)   VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-12.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF2             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-13.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF3             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-14.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF4             PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X      VALUE SPACES.                
           05  400C-TOTAL-CD            PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-15.                                                    
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-BALANCE-AMT         PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-16.                                                    
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-MAX-LOAN-AMT        PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-17.                                                    
           05  FILLER                   PIC X(64)  VALUE SPACES.                
           05  400C-MTHLY-INSTAL        PIC Z,ZZ9.99.                           
                                                                                
       01  L400C-PR-LINE-18.                                                    
           05  FILLER                   PIC X(64)  VALUE SPACES.                
           05  400C-SC-CC-AMT           PIC Z,ZZ9.99.                           
                                                                                
       01  426C-PR-HEAD16.                                                      
           05  624B-LIST               PIC X(8)  VALUE SPACES.                  
           05  FILLER                  PIC X(35) VALUE SPACES.                  
           05  FILLER                  PIC X(29) VALUE                          
               '  SYSTEM  OF  COMMITMENT '.                                     
           05  FILLER                  PIC X(30) VALUE SPACES.                  
           05  FILLER                  PIC X(9)  VALUE '  PAGE : '.             
           05  624B-PAGE               PIC ZZZZ9.                               
           05  FILLER                  PIC X(16) VALUE SPACES.                  
                                                                                
       01  426C-PR-HEAD17.                                                      
           05  FILLER                  PIC X(33) VALUE SPACES.                  
           05  FILLER                  PIC X(65) VALUE                          
               'CONTROL LIST FOR APPOINTMENT LETTERS / GIRO FORMS'.             
           05  FILLER                  PIC X(13) VALUE 'DATE :'.                
           05  624B-DATE               PIC X(10) VALUE SPACES.                  
                                                                                
       01  426C-PR-HEAD18.                                                      
           05  FILLER                  PIC X(39) VALUE                          
               '    REGN-NO   NAME'.                                            
           05  FILLER                  PIC X(50) VALUE                          
               'NRIC       BLOCK     STREET-NAME                  '.            
           05  FILLER                  PIC X(50) VALUE                          
               'UNIT-NO    SELLING-PRICE   SCH-ACC-NO'.                         
                                                                                
       01  426C-PR-HEAD19.                                                      
           05  FILLER                  PIC X(4)  VALUE SPACES.                  
           05  624B-REGN-NO            PIC X(8)  VALUE SPACES.                  
           05  FILLER                  PIC X(2)  VALUE SPACES.                  
           05  624B-NAME               PIC X(22) VALUE SPACES.                  
           05  FILLER                  PIC X(3)  VALUE SPACES.                  
           05  624B-NRIC               PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(2)  VALUE SPACES.                  
           05  624B-BLK-NO             PIC X(5)  VALUE SPACES.                  
           05  FILLER                  PIC X(5)  VALUE SPACES.                  
           05  624B-STREET-NAME        PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  624B-LEVEL-NO           PIC X(2)  VALUE SPACES.                  
           05  624B-DASH               PIC X     VALUE SPACE.                   
           05  624B-MAIN-UNIT          PIC X(5)  VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE SPACES.                  
           05  624B-SELLING-PR         PIC $ZZZZZZZ9.                           
           05  FILLER                  PIC X(3)  VALUE SPACES.                  
           05  624B-SCH-ACC-NO         PIC X(11) VALUE SPACES.                  
           05  FILLER                  PIC X(18) VALUE SPACES.                  
                                                                                
       01  426C-PR-HEAD20.                                                      
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               'NO LETTERS PRINTED   : '.                                       
           05  624B-TOTAL              PIC ZZZZZ9.                              
           05  FILLER                  PIC X(90) VALUE SPACES.                  
                                                                                
       01  426C-PR-HEAD21.                                                      
           05  FILLER                  PIC X(33) VALUE SPACES.                  
           05  FILLER                  PIC X(64) VALUE                          
               'ERROR LISTS FOR APPOINTMENT LETTERS  ( S.O )'.                  
           05  FILLER                  PIC X(7)  VALUE 'DATE :'.                
           05  426C-DATE               PIC X(10) VALUE SPACES.                  
                                                                                
       01  426C-PR-HEAD22.                                                      
           05  FILLER                  PIC X(32) VALUE '  REGN-NO'.             
           05  FILLER                  PIC X(51) VALUE                          
               'BLOCK   STREET-NAME                     UNIT-NO   '.            
           05  FILLER                  PIC X(52) VALUE                          
               '  RM   SELLING-PRICE      ERROR-MESSAGE'.                       
                                                                                
       01  426C-PR-HEAD23.                                                      
           05  FILLER                  PIC X(2)  VALUE SPACES.                  
           05  426C-REGN               PIC X(8)  VALUE SPACES.                  
           05  FILLER                  PIC X(22) VALUE SPACES.                  
           05  426C-BLK-NO             PIC X(5)  VALUE SPACES.                  
           05  FILLER                  PIC X(3)  VALUE SPACES.                  
           05  426C-STREET-NAME        PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X(12) VALUE SPACES.                  
           05  426C-LEVEL-NO           PIC X(2)  VALUE SPACES.                  
           05  FILLER                  PIC X     VALUE '-'.                     
           05  426C-MAIN-UNIT          PIC X(5)  VALUE SPACES.                  
           05  FILLER                  PIC X(5)  VALUE SPACES.                  
           05  426C-ROOM               PIC X(2)  VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE SPACES.                  
           05  426C-SELLING-PR         PIC $$$$$$$$9.                           
           05  FILLER                  PIC X(6)  VALUE SPACES.                  
           05  426C-ERR-MESG           PIC X(22) VALUE SPACES.                  
           05  FILLER                  PIC X(2)  VALUE SPACES.                  
                                                                                
       01  426C-PR-HEAD24.                                                      
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               'TOTAL ERRORS PRINTED : '.                                       
           05  426C-TOTAL-ERROR        PIC ZZZZZ9.                              
           05  FILLER                  PIC X(90) VALUE SPACES.                  
                                                                                
       01  BLANK-LINE                   PIC X(80)  VALUE SPACES.                
                                                                                
      *-------------------*                                                     
       PROCEDURE DIVISION.                                                      
      *-------------------*                                                     
                                                                                
      *-------------------------------------------------------------            
       MAIN.                                                                    
      *-------------------------------------------------------------            
           OPEN INPUT BP13F310                                                  
                      BP13K820                                                  
                      BP13K022                                                  
                      BP13K024                                                  
                      AB03K050                                                  
                      BP13K800                                                  
                      BM06K110                                                  
                      BP13K830                                                  
               OUTPUT P13L426D                                                  
                      P13L426E                                                  
                      P13L426C.                                                 
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN ERROR, BP13K800-STATUS ' BP13K800-STATUS            
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  1400-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K022-STATUS ' BP13K022-STATUS          
              MOVE     BP13K022-STATUS TO RETURN-CODE                           
              PERFORM  1400-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K024-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K024-STATUS ' BP13K024-STATUS          
              MOVE     BP13K024-STATUS TO RETURN-CODE                           
              PERFORM  1400-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN ERROR, BP13K820-STATUS ' BP13K820-STATUS            
              MOVE     BP13K820-STATUS TO RETURN-CODE                           
              PERFORM  1400-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K830-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN ERROR, BP13K830-STATUS ' BP13K830-STATUS            
              MOVE     BP13K830-STATUS TO RETURN-CODE                           
              PERFORM  1400-CLOSE-ROUTINE.                                      
                                                                                
           IF BM06K110-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPEN ERROR, BM6K110-STATUS ' BM06K110-STATUS             
              MOVE     BM06K110-STATUS TO RETURN-CODE                           
              PERFORM  1400-CLOSE-ROUTINE.                                      
                                                                                
           MOVE FUNCTION CURRENT-DATE TO  WS-CUR-DATE.                          
                                                                                
           MOVE WS-CUR-DATE           TO  WS-CURRENT-DATE.                      
           STRING WS-CUR-DATE(7:2) '/' WS-CUR-DATE(5:2) '/'                     
                  WS-CUR-DATE(1:4)                                              
                  DELIMITED BY SIZE INTO WS-EDITED-DTE.                         
                                                                                
           PERFORM  100-MOVE-GST-RATE     THRU   100-EXIT.                      
           PERFORM  200-READ-F310-REC     THRU   200-EXIT.                      
           PERFORM  300-PRINT-LETTER      THRU   300-EXIT                       
                        UNTIL F310-EOF = 'Y'.                                   
           PERFORM  1000-PRINT-TOTAL.                                           
           PERFORM  1400-CLOSE-ROUTINE.                                         
                                                                                
                                                                                
      *-------------------------------------------------------------            
       100-MOVE-GST-RATE.                                                       
      *-------------------------------------------------------------            
      *-----------------------------------------------------------*             
      *    CALL BP13C90D TO GET GST-RATE                          *             
      *-----------------------------------------------------------*             
           CALL 'BP13C90D' USING WS-COMM-AREA-GST.                              
                                                                                
       100-EXIT.                                                                
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       200-READ-F310-REC.                                                       
      *-------------------------------------------------------------            
           READ BP13F310                                                        
                AT END MOVE 'Y'  TO  F310-EOF                                   
                       GO TO 200-EXIT.                                          
                                                                                
           ADD  1  TO  NO-OF-READ-F310.                                         
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       300-PRINT-LETTER.                                                        
      *-------------------------------------------------------------            
      *    PRINT LETTERS FOR SALES EXECUTION                      *             
      *-----------------------------------------------------------*             
           IF F310-CDE-SALES-TYPE = '2B'                                        
              NEXT SENTENCE                                                     
           ELSE                                                                 
              PERFORM 200-READ-F310-REC  THRU  200-EXIT                         
              GO TO   300-EXIT.                                                 
                                                                                
           MOVE 'N' TO K820-NOT-FOUND                                           
                       K110-NOT-FOUND                                           
                       K800-NOT-FOUND                                           
                       K830-NOT-FOUND.                                          
                                                                                
           PERFORM 305-ACCESS-FILE-BP13K800 THRU 305-EXIT.                      
                                                                                
           IF K800-NOT-FOUND = 'N'                                              
              PERFORM 330-ACCESS-FILE-BM06K110 THRU 330-EXIT                    
                                                                                
              IF K110-NOT-FOUND = 'N'                                           
                 PERFORM 310-ACCESS-FILE-BP13K820 THRU 310-EXIT                 
                                                                                
                 IF K820-NOT-FOUND = 'Y'                                        
                    MOVE 'NOT FND IN OCCUP FILE' TO 426C-ERR-MESG               
                    PERFORM 1100-ERROR-ROUTINE                                  
                 ELSE                                                           
                    PERFORM 350-PROCESS-DOC THRU 350-EXIT                       
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 200-READ-F310-REC THRU 200-EXIT.                             
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       305-ACCESS-FILE-BP13K800.                                                
      *-------------------------------------------------------------            
      *    USE F310-REGN-NO TO ACCESS APPL MASTER FILE - BP13K800 *             
      *-----------------------------------------------------------*             
           MOVE F310-REGN-NO TO K800-NUM-REGN.                                  
           READ BP13K800.                                                       
                                                                                
           IF BP13K800-STATUS NOT = 00                                          
              MOVE    'Y' TO K800-NOT-FOUND                                     
              DISPLAY 'REC NOT FOUND IN K800 = ' BP13K800-STATUS                
              DISPLAY '    K800-NUM-REGN     = ' F310-REGN-NO                   
           ELSE                                                                 
              PERFORM 307-CHECK-CD-AMOUNT THRU 307-EXIT.                        
                                                                                
       305-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       307-CHECK-CD-AMOUNT.                                                     
      *-------------------------------------------------------------            
      *    CHECK IF NO COMMITMENT DEPOSIT AMOUNT AND BOOKING FEE  *             
      *-----------------------------------------------------------*             
           IF K800-AMT-CD > ZEROS                                               
              MOVE 'Y' TO K800-NOT-FOUND.                                       
                                                                                
           IF K800-NUM-ALLOC-TAG = 'AI' OR 'AW'                                 
              MOVE 'Y' TO K800-NOT-FOUND.                                       
                                                                                
           IF K800-DTE-EXPIRED-TP = '00000000' OR LOW-VALUE OR SPACES           
              MOVE '00000000'            TO WS-DTE-EXPIRED-TP                   
           ELSE                                                                 
              MOVE K800-DTE-EXPIRED-TP   TO WS-DTE-EXPIRED-TP.                  
                                                                                
       307-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       310-ACCESS-FILE-BP13K820.                                                
      *-------------------------------------------------------------            
           MOVE     K800-NUM-REGN   TO    K820-NUM-REGN.                        
           MOVE     K800-NUM-NRIC1  TO    K820-NUM-NRIC.                        
           PERFORM  315-GET-NAME    THRU  315-EXIT.                             
           MOVE     WS-NAME         TO    426A-APPL-NAME.                       
                                                                                
           IF (K800-NUM-NRIC2(2:1) NOT = '#'                  ) AND             
              (K800-NUM-NRIC2      NOT = SPACES AND LOW-VALUES)                 
              MOVE K800-NUM-REGN   TO K820-NUM-REGN                             
              MOVE K800-NUM-NRIC2  TO K820-NUM-NRIC                             
              PERFORM 315-GET-NAME THRU 315-EXIT                                
              MOVE WS-NAME TO 426A-COAPPL-NAME                                  
           ELSE                                                                 
              MOVE SPACES  TO 426A-COAPPL-NAME.                                 
                                                                                
       310-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       315-GET-NAME.                                                            
      *-------------------------------------------------------------            
           READ BP13K820.                                                       
                                                                                
           IF BP13K820-STATUS  NOT = 00 AND 02                                  
              MOVE     'Y'      TO   K820-NOT-FOUND                             
              MOVE     SPACES   TO   WS-NAME                                    
              DISPLAY 'REC NOT FOUND IN K820 = ' BP13K820-STATUS                
              DISPLAY '    K820-NUM-REGN     = ' K800-NUM-REGN                  
              DISPLAY '    K800-NUM-NRIC     = ' K820-NUM-NRIC                  
           ELSE                                                                 
              MOVE     K820-NME-OCCP    TO    WS-NAME                           
              PERFORM  320-GET-ADDRESS  THRU  320-EXIT.                         
                                                                                
       315-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       320-GET-ADDRESS.                                                         
      *-------------------------------------------------------------            
           MOVE F310-REGN-NO TO K830-NUM-REGN.                                  
                                                                                
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           IF BP13K830-STATUS = 00                                              
              IF K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES                     
                 IF K830-NUM-ADDR-TYPE  =  'H'                                  
                    MOVE SPACES            TO 426A-STREET-NAME                  
                                              426A-BLK-NO                       
                    MOVE K830-NUM-BLK      TO 426A-BLK-NO                       
                    MOVE K830-NME-STREET   TO 426A-STREET-NAME                  
                    MOVE K830-NUM-LVL-CHAR TO 426A-CHAR                         
                    MOVE K830-NUM-LVL-NUM  TO 426A-LEVEL                        
                    MOVE K830-NUM-LVL-DASH TO 426A-DASH                         
                    MOVE K830-NUM-HSEMAIN  TO 426A-HSE-MAIN                     
                    MOVE K830-NUM-HSESUB   TO 426A-HSE-SUB                      
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES         TO 426A-POSTAL-CD                    
                       MOVE SPACES         TO 426A-DOT                          
                    ELSE                                                        
                       STRING 'SINGAPORE ' K830-NUM-POSTAL                      
                       DELIMITED BY SIZE   INTO 426A-POSTAL-CD                  
                       MOVE '.'            TO 426A-DOT                          
                    END-IF                                                      
                 ELSE                                                           
                    MOVE SPACES            TO 426A-STREET-NAME                  
                                              426A-BLK-NO                       
                    MOVE K830-NUM-BLK         TO 426A-BLK-NO                    
                    MOVE K830-NME-STREET-BLDG TO 426A-STREET-NAME               
                    MOVE K830-NUM-FLAT        TO 426A-NUM-FLAT                  
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES         TO 426A-POSTAL-CD                    
                       MOVE SPACES         TO 426A-DOT                          
                    ELSE                                                        
                       STRING 'SINGAPORE ' K830-NUM-POSTAL                      
                       DELIMITED BY SIZE INTO 426A-POSTAL-CD                    
                       MOVE '.'            TO 426A-DOT                          
                    END-IF                                                      
                 END-IF                                                         
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                     MOVE SPACES          TO WS-LINK-AV02C015                   
                     MOVE K830-NUM-POSTAL TO AV02C015-IN-POSTCODE               
                     PERFORM 550-CALL-AV02C015 THRU 550-EXIT                    
                     MOVE AV02C015-OUT-POSTCODE-CHKSUM TO 426A-BAR-CODE         
              ELSE                                                              
                 IF K830-NUM-MAIL-ADDR-TYPE =  'H'                              
                    MOVE SPACES                 TO 426A-STREET-NAME             
                                                   426A-BLK-NO                  
                    MOVE K830-NUM-MAIL-BLK      TO 426A-BLK-NO                  
                    MOVE K830-NME-MAIL-STREET   TO 426A-STREET-NAME             
                    MOVE K830-NUM-MAIL-LVL-CHAR TO 426A-CHAR                    
                    MOVE K830-NUM-MAIL-LVL-NUM  TO 426A-LEVEL                   
                    MOVE K830-NUM-MAIL-LVL-DASH TO 426A-DASH                    
                    MOVE K830-NUM-MAIL-HSEMAIN  TO 426A-HSE-MAIN                
                    MOVE K830-NUM-MAIL-HSESUB   TO 426A-HSE-SUB                 
                    IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR           
                                              ZEROES                            
                       MOVE SPACES              TO 426A-POSTAL-CD               
                       MOVE SPACES              TO 426A-DOT                     
                    ELSE                                                        
                       STRING 'SINGAPORE ' K830-NUM-MAIL-POSTAL                 
                       DELIMITED BY SIZE      INTO 426A-POSTAL-CD               
                       MOVE '.'                 TO 426A-DOT                     
                    END-IF                                                      
                 ELSE                                                           
                    MOVE SPACES                 TO 426A-STREET-NAME             
                                                   426A-BLK-NO                  
                    MOVE K830-NUM-MAIL-BLK      TO 426A-BLK-NO                  
                    MOVE K830-NME-MAIL-STR-BLDG TO 426A-STREET-NAME             
                    MOVE K830-NUM-MAIL-FLAT     TO 426A-NUM-FLAT                
                    IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR           
                                              ZEROES                            
                       MOVE SPACES              TO 426A-POSTAL-CD               
                       MOVE SPACES              TO 426A-DOT                     
                    ELSE                                                        
                      STRING 'SINGAPORE ' K830-NUM-MAIL-POSTAL                  
                      DELIMITED BY SIZE       INTO 426A-POSTAL-CD               
                      MOVE '.'                  TO 426A-DOT                     
                    END-IF                                                      
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                     MOVE SPACES               TO WS-LINK-AV02C015              
                     MOVE K830-NUM-MAIL-POSTAL TO AV02C015-IN-POSTCODE          
                     PERFORM 550-CALL-AV02C015 THRU 550-EXIT                    
                     MOVE AV02C015-OUT-POSTCODE-CHKSUM TO 426A-BAR-CODE.        
                                                                                
           IF BP13K830-STATUS = 23                                              
              MOVE SPACES  TO   426A-STREET-NAME 426A-BLK-NO                    
                                426A-NUM-FLAT    426A-POSTAL-CD                 
                                426A-DOT                                        
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' BP13K830-STATUS            
              DISPLAY '    K830-NUM-REGN         = ' K830-NUM-REGN.             
                                                                                
           IF BP13K830-STATUS NOT = 00 AND 23 AND 02                            
              DISPLAY 'ERROR READING BP13K830    = ' BP13K830-STATUS            
              DISPLAY '      K830-NUM-REGN       = ' K830-NUM-REGN.             
                                                                                
       320-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       330-ACCESS-FILE-BM06K110.                                                
      *-------------------------------------------------------------            
           MOVE F310-SCH-ACC TO K110-KEY-FLD.                                   
           READ BM06K110.                                                       
                                                                                
           IF BM06K110-STATUS = 00                                              
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'REC NOT FOUND IN K110 = ' BM06K110-STATUS                
              DISPLAY '    K110-KEY-FLD      = ' F310-SCH-ACC                   
              MOVE    'Y'  TO K110-NOT-FOUND.                                   
                                                                                
       330-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       350-PROCESS-DOC.                                                         
      *-------------------------------------------------------------            
           IF F310-CDE-ECD = '*'                                                
              MOVE 'ECD'          TO 426A-DTE-EXPIRED-DES                       
              MOVE '(  '          TO 426A-DTE-DES1                              
              MOVE ')'            TO 426A-DTE-DES2                              
           ELSE                                                                 
              MOVE SPACES         TO 426A-DTE-EXPIRED-DES                       
              MOVE SPACES         TO 426A-DTE-DES1                              
              MOVE SPACES         TO 426A-DTE-DES2.                             
                                                                                
           STRING WS-DTE-EXPIRED-TP(7:2) '/'                                    
                  WS-DTE-EXPIRED-TP(5:2) '/'                                    
                  WS-DTE-EXPIRED-TP(1:4)                                        
                  DELIMITED BY SIZE INTO 426A-DTE-EXPIRED-TP.                   
                                                                                
           PERFORM 400-CALL-BP13C903      THRU  400-EXIT.                       
           PERFORM 450-GET-REGN-CHKDIGIT  THRU  450-EXIT.                       
           PERFORM 500-GET-PRINTING-INFO  THRU  500-EXIT.                       
           PERFORM 600-PROCESS-PRINT      THRU  600-EXIT.                       
           PERFORM 3000-PRINT-WORKSHEET   THRU  3000-EXIT.                      
                                                                                
       350-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       400-CALL-BP13C903.                                                       
      *-------------------------------------------------------------            
           MOVE     WS-CUR-DATE          TO    WS-S903-SO-EFF-DATE.             
           MOVE     ZEROES               TO    WS-S903-SC-CC1                   
                                               WS-S903-SC-CC2                   
                                               WS-S903-SC-CC3.                  
           MOVE     ZEROES               TO    WS-S903-SC-REBATE1               
                                               WS-S903-SC-REBATE2               
                                               WS-S903-SC-REBATE3               
                                               WS-S903-SC-GRANT1                
                                               WS-S903-SC-GRANT2                
                                               WS-S903-SC-GRANT3                
                                               WS-S903-SC-REC-TC1               
                                               WS-S903-SC-REC-TC2               
                                               WS-S903-SC-REC-TC3               
                                               WS-S903-SC-TOTAL-AMT.            
           MOVE     F310-SCH-ACC(1:9)    TO    WS-S903-NUM-SCH-ACC.             
           MOVE     F310-CDE-TYP-ACTUSE  TO    WS-S903-ROOM-TY.                 
           MOVE     F310-CDE-MODL-DESG   TO    WS-S903-DESIGN-TY.               
                                                                                
      *-----------------------------------------------------------*             
      *    CALL BP13C903 TO GET THE SC-CC1,SC-CC2 AND SC-CC3      *             
      *-----------------------------------------------------------*             
           CALL 'BP13C903' USING WS-LINK-S903.                                  
                                                                                
      *-----------------------------------------------------------*             
      *    CALL AV02C021 TO COMPUTE THE GST FOR SC-CC1 & SC-CC2   *             
      *-----------------------------------------------------------*             
           MOVE  WS-S903-SC-CC1     TO WS-AMT-NETT.                             
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST         TO WS-S903-SC-CC1-GST.                      
                                                                                
           MOVE  WS-S903-SC-REC-TC1 TO WS-AMT-NETT.                             
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST         TO WS-S903-SC-TC1-GST.                      
                                                                                
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z' ) OR                          
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SPP' OR 'SSP' OR               
                                       'SPS' OR 'SRP')                          
              COMPUTE WS-SC-CC1-AMT  =  WS-S903-SC-CC1     +                    
                                        WS-S903-SC-CC1-GST +                    
                                        WS-S903-SC-REC-TC1 +                    
                                        WS-S903-SC-TC1-GST                      
           ELSE                                                                 
               COMPUTE WS-SC-CC1-AMT =  WS-S903-SC-CC1     +                    
                                        WS-S903-SC-CC1-GST -                    
                                        WS-S903-SC-REBATE1 -                    
                                        WS-S903-SC-GRANT1  -                    
                                        WS-S903-SC-REB-SP1                      
           END-IF.                                                              
                                                                                
           MOVE WS-S903-SC-CURR-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-CC                TO WS-SCCC-CC.                         
           MOVE WS-WEF-YY                TO WS-SCCC-YY.                         
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      =  'N' OR 'Z' ) OR                     
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SPP' OR 'SSP' OR           
                                           'SPS' OR 'SRP')                      
               COMPUTE WS-SC-CC-NUM-AMT  =  WS-S903-SC-CC1 +                    
                                            WS-S903-SC-REC-TC1                  
               COMPUTE                                                          
                    WS-SC-CC-NUM-AMT-GST =  WS-S903-SC-CC1-GST +                
                                            WS-S903-SC-TC1-GST                  
               MOVE WS-SC-CC-NUM-AMT     TO WS-SC-CC-AMT                        
               MOVE WS-SC-CC-NUM-AMT-GST TO WS-SC-CC-AMT-GST                    
           ELSE                                                                 
               MOVE WS-S903-SC-CC1       TO WS-SC-CC-AMT                        
               MOVE WS-S903-SC-CC1-GST   TO WS-SC-CC-AMT-GST                    
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      =  'N' OR 'Z' ) OR                     
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SPP' OR 'SSP' OR           
                                           'SPS' OR 'SRP')                      
               MOVE ')'                  TO WS-SC-CC-SIGN                       
               MOVE ZEROES               TO WS-SC-CC-REBATE-AMT                 
               MOVE SPACES               TO WS-SC-CC-REBATE-DESC                
               MOVE SPACES               TO WS-SC-CC-SIGN2                      
               MOVE ZEROES               TO WS-SC-CC-GRANT-AMT                  
               MOVE SPACES               TO WS-SC-CC-GRANT-DESC                 
               MOVE SPACES               TO WS-SC-CC-SIGN3                      
               MOVE ZEROES               TO WS-SC-CC-REB-SP-AMT                 
               MOVE SPACES               TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE1         =  ZEROES                              
              IF WS-S903-SC-GRANT1       =  ZEROES                              
                 IF WS-S903-SC-REB-SP1   =  ZEROES OR                           
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REBATE-AMT              
                    MOVE  ' SP)'         TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY       = '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE1    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY       = '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY       = '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT            TO 426A-AMT-CURR-SCCC                  
                                            L310-AMT-CURR-SCCC.                 
           MOVE WS-DTE-SCCC              TO 426A-DTE-CURR-SCCC                  
                                            L310-DTE-CURR-SCCC.                 
           MOVE WS-SC-CC-DESC            TO 426A-CURR-GST-DESC                  
                                            L310-CURR-GST-DESC.                 
                                                                                
            IF WS-S903-SC-CC2     =         WS-S903-SC-CC1                      
               MOVE WS-S903-SC-CC1-GST TO   WS-S903-SC-CC2-GST                  
            ELSE                                                                
               MOVE WS-S903-SC-CC2  TO      WS-AMT-NETT                         
               CALL 'AV02C021'      USING   WS-COMM-AREA-GST                    
               MOVE WS-AMT-GST      TO      WS-S903-SC-CC2-GST                  
            END-IF.                                                             
                                                                                
            IF WS-S903-SC-REC-TC1 =         WS-S903-SC-REC-TC2                  
               MOVE WS-S903-SC-TC1-GST TO   WS-S903-SC-TC2-GST                  
            ELSE                                                                
               MOVE WS-S903-SC-REC-TC2 TO   WS-AMT-NETT.                        
                                                                                
           CALL 'AV02C021'          USING   WS-COMM-AREA-GST.                   
           MOVE WS-AMT-GST          TO      WS-S903-SC-TC2-GST.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z' ) OR                          
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SPP' OR 'SSP' OR               
                                       'SPS' OR 'SRP')                          
              COMPUTE WS-SC-CC2-AMT  =  WS-S903-SC-CC2     +                    
                                        WS-S903-SC-CC2-GST +                    
                                        WS-S903-SC-REC-TC2 +                    
                                        WS-S903-SC-TC2-GST                      
           ELSE                                                                 
               COMPUTE WS-SC-CC2-AMT =  WS-S903-SC-CC2     +                    
                                        WS-S903-SC-CC2-GST -                    
                                        WS-S903-SC-REBATE2 -                    
                                        WS-S903-SC-GRANT2 -                     
                                        WS-S903-SC-REB-SP2                      
           END-IF.                                                              
                                                                                
           MOVE WS-S903-SC-NEXT-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-CC                TO WS-SCCC-CC.                         
           MOVE WS-WEF-YY                TO WS-SCCC-YY.                         
                                                                                
           IF (K800-NUM-SCCC-ELGBTY       =  'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME       = 'SPO' OR 'SSP' OR 'SPP' OR          
                                            'SPS' OR 'SRP')                     
               COMPUTE WS-SC-CC-NUM-AMT   = WS-S903-SC-CC2  +                   
                                            WS-S903-SC-REC-TC2                  
               COMPUTE                                                          
                    WS-SC-CC-NUM-AMT-GST  = WS-S903-SC-CC2-GST  +               
                                            WS-S903-SC-TC2-GST                  
               MOVE WS-SC-CC-NUM-AMT     TO WS-SC-CC-AMT                        
               MOVE WS-SC-CC-NUM-AMT-GST TO WS-SC-CC-AMT-GST                    
           ELSE                                                                 
               MOVE WS-S903-SC-CC2       TO WS-SC-CC-AMT                        
               MOVE WS-S903-SC-CC2-GST   TO WS-SC-CC-AMT-GST                    
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY       =  'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME       = 'SPO' OR 'SSP' OR 'SPP' OR          
                                            'SPS' OR 'SRP')                     
               MOVE ')'                  TO WS-SC-CC-SIGN                       
               MOVE ZEROES               TO WS-SC-CC-REBATE-AMT                 
               MOVE SPACES               TO WS-SC-CC-REBATE-DESC                
               MOVE SPACES               TO WS-SC-CC-SIGN2                      
               MOVE ZEROES               TO WS-SC-CC-GRANT-AMT                  
               MOVE SPACES               TO WS-SC-CC-GRANT-DESC                 
               MOVE SPACES               TO WS-SC-CC-SIGN3                      
               MOVE ZEROES               TO WS-SC-CC-REB-SP-AMT                 
               MOVE SPACES               TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE2         =  ZEROES                              
              IF WS-S903-SC-GRANT2       =  ZEROES                              
                 IF WS-S903-SC-REB-SP2   =  ZEROES OR                           
                    WS-S903-ROOM-TY       = '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-REBATE-AMT                 
                 MOVE ' GRT '            TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY       = '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE2    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY       = '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY       = '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT            TO 426A-AMT-NEXT-SCCC                  
                                            L310-AMT-NEXT-SCCC.                 
           MOVE WS-DTE-SCCC              TO 426A-DTE-NEXT-SCCC                  
                                            L310-DTE-NEXT-SCCC.                 
           MOVE WS-SC-CC-DESC            TO 426A-NEXT-GST-DESC                  
                                            L310-NEXT-GST-DESC.                 
                                                                                
           IF WS-S903-SC-CC2 = WS-S903-SC-CC3                                   
              MOVE WS-S903-SC-CC2-GST TO WS-S903-SC-CC3-GST                     
           ELSE                                                                 
              MOVE WS-S903-SC-CC3     TO WS-AMT-NETT                            
              CALL 'AV02C021'     USING  WS-COMM-AREA-GST                       
              MOVE WS-AMT-GST         TO WS-S903-SC-CC3-GST                     
           END-IF.                                                              
                                                                                
           IF WS-S903-SC-REC-TC2 = WS-S903-SC-REC-TC3                           
              MOVE WS-S903-SC-TC2-GST TO WS-S903-SC-TC3-GST                     
           ELSE                                                                 
              MOVE WS-S903-SC-REC-TC3 TO  WS-AMT-NETT                           
              CALL 'AV02C021'     USING   WS-COMM-AREA-GST                      
              MOVE WS-AMT-GST         TO  WS-S903-SC-TC3-GST                    
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z' ) OR                          
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SSP' OR 'SPP' OR               
                                       'SPS' OR 'SRP')                          
               COMPUTE WS-SC-CC3-AMT =  WS-S903-SC-CC3     +                    
                                        WS-S903-SC-CC3-GST +                    
                                        WS-S903-SC-REC-TC3 +                    
                                        WS-S903-SC-TC3-GST                      
           ELSE                                                                 
               COMPUTE WS-SC-CC3-AMT =  WS-S903-SC-CC3     +                    
                                        WS-S903-SC-CC3-GST +                    
                                        WS-S903-SC-REBATE3 -                    
                                        WS-S903-SC-GRANT3  -                    
                                        WS-S903-SC-REB-SP3                      
           END-IF.                                                              
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       450-GET-REGN-CHKDIGIT.                                                   
      *-------------------------------------------------------------            
           STRING 'SL' K800-NUM-REGN DELIMITED BY SIZE                          
             INTO  WS-C908-TXT-INPUT.                                           
                                                                                
           MOVE SPACES               TO WS-C908-TXT-OUTPUT.                     
           MOVE 10                   TO WS-C908-TXT-IN-SIZE.                    
           MOVE ZEROS                TO WS-C908-RETCODE                         
                                        WS-C908-TXT-OUT-SIZE.                   
                                                                                
           CALL 'BP13C908'    USING WS-C908-PARAMETERS.                         
                                                                                
           IF WS-C908-RETCODE = ZEROS                                           
              MOVE WS-C908-TXT-OUTPUT(1:WS-C908-TXT-OUT-SIZE) TO                
                   L426-BARCODE-REGN                                            
              DISPLAY 'BARCODE : ' L426-BARCODE-REGN                            
           ELSE                                                                 
              DISPLAY 'ERROR IN BP13C908-REGN: ' WS-C908-TXT-INPUT              
              MOVE SPACES                 TO  L426-BARCODE-REGN.                
                                                                                
       450-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       500-GET-PRINTING-INFO.                                                   
      *-------------------------------------------------------------            
           MOVE K110-ALLOC-SCH       TO   426A-ALLOC-SCH.                       
           MOVE K800-NUM-REGN        TO   426A-REGN-NO1                         
                                          L426-BARCODE1-REGN.                   
                                                                                
           MOVE 'SL'   TO L426-BARCODE1-PREFIX.                                 
                                                                                
           MOVE K800-NUM-NEW-TOWN    TO   426A-ALLOC-NT                         
                                          L211-CDE-NT.                          
           MOVE F310-SCH             TO   426A-SCHEME.                          
           MOVE F310-ACC             TO   426A-ACC.                             
           MOVE F310-LESSEE-CODE     TO   426A-ACC-TYPE.                        
                                                                                
           IF F310-CDE-TYP-ACTUSE = 06                                          
              MOVE 'E ' TO 426A-RM-TY, 426A-ALP-ROOM,                           
                           L211-RECOM-RM-TYPE                                   
           ELSE                                                                 
              IF F310-CDE-TYP-ACTUSE = 08                                       
                 MOVE 'MG' TO 426A-RM-TY, 426A-ALP-ROOM,                        
                              L211-RECOM-RM-TYPE                                
              ELSE                                                              
                 IF (F310-CDE-TYP-ACTUSE = 04) AND                              
                    (F310-CDE-MODL-DESG = 06)                                   
                     MOVE '4S' TO 426A-RM-TY, 426A-ALP-ROOM,                    
                                  L211-RECOM-RM-TYPE                            
                 ELSE                                                           
                     MOVE F310-CDE-TYP-ACTUSE TO 426A-RM-TY, 426A-ROOM,         
                          L211-RECOM-RM-TYPE.                                   
                                                                                
           MOVE F310-NUM-BLK            TO 426A-F310-BLK-NO.                    
           MOVE F310-NME-STREET         TO 426A-F310-STREET-NAME.               
           MOVE F310-NUM-LEVEL          TO 426A-F310-LEVEL-NO.                  
           MOVE F310-NUM-MAIN           TO 426A-F310-MAIN-UNIT.                 
                                                                                
           IF   F310-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES                
                MOVE '.'                TO 426A-COUNTRY-NAME                    
                MOVE SPACES             TO 426A-F310-POST-CODE                  
                MOVE SPACES             TO 426A-F310-DOT                        
           ELSE                                                                 
                MOVE 'SINGAPORE'        TO 426A-COUNTRY-NAME                    
                MOVE F310-NUM-POSTAL    TO 426A-F310-POST-CODE                  
                MOVE '.'                TO 426A-F310-DOT.                       
                                                                                
           MOVE K110-CURR-SELLING-PRICE TO 426A-SELLING-PRICE.                  
                                                                                
           IF K110-FLAT-STATUS  = 'SD'                                          
              MOVE '- (SD)'                TO 426A-SITTING-TENANT               
           ELSE                                                                 
              MOVE SPACES                  TO 426A-SITTING-TENANT.              
                                                                                
           MOVE F310-CDE-BO TO 426A-BO.                                         
           MOVE '/'         TO 426A-SLASH1 426A-SLASH2.                         
           MOVE F310-CDE-CC TO 426A-CC.                                         
           MOVE F310-CDE-TC TO 426A-TC.                                         
                                                                                
      * GET AMT-INSURED & AMT-PREMIUM                                           
           MOVE F310-CDE-TYP-ACTUSE     TO  BM97-NUM-FLAT-TYPE.                 
           MOVE F310-CDE-MODL-DESG      TO  BM97-CDE-MODL-DESG.                 
                                                                                
           MOVE WS-CURRENT-DATE         TO  BM97-DTE-COMPARE.                   
                                                                                
           INITIALIZE                       BM97-NUM-ERROR                      
                                            BM97-NUM-SYSERR.                    
                                                                                
           CALL 'AB20C900' USING WS-BM97-AREA.                                  
                                                                                
           IF BM97-NUM-ERROR = ZEROS OR SPACES AND                              
              BM97-NUM-SYSERR = ZEROS                                           
              MOVE BM97-AMT-INSURED     TO  426A-AMT-INSURED                    
              MOVE BM97-AMT-PREMIUM     TO  426A-AMT-PREMIUM                    
           ELSE                                                                 
              MOVE BM97-NUM-SYSERR      TO  RETURN-CODE                         
              DISPLAY 'ERROR IN CALLING AB20C900, ' BM97-NUM-ERROR              
              MOVE SPACES               TO  426A-AMT-I-R                        
                                            426A-AMT-P-R.                       
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       550-CALL-AV02C015.                                                       
      *-------------------------------------------------------------            
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       600-PROCESS-PRINT.                                                       
      *-------------------------------------------------------------            
      *    PRINT APPOINTMENT LETTERS (S.O) FOR SALE TYPE 01       *             
      *-----------------------------------------------------------*             
           PERFORM 830-READ-BP13K022 THRU 830-EXIT.                             
           PERFORM 840-GET-CSM-INFO  THRU 840-EXIT.                             
                                                                                
           ADD   1                   TO NO-OF-LETTER.                           
                                                                                
           MOVE  WS-EDITED-DTE       TO 426A-DATE                               
                                                                                
           MOVE  SPACES              TO L426E-PRTREC.                           
           WRITE L426E-PRTREC           AFTER PAGE.                             
                                                                                
           WRITE L426E-PRTREC FROM 426A-PR-HEAD-1   AFTER 5.                    
           WRITE L426E-PRTREC FROM 426A-PR-HEAD-2B  AFTER 0.                    
           WRITE L426E-PRTREC FROM 426A-PR-HEAD-2A  AFTER 1.                    
           WRITE L426E-PRTREC FROM 426A-PR-HEAD-3   AFTER 2.                    
           WRITE L426E-PRTREC FROM 426A-PR-HEAD-3B  AFTER 1.                    
                                                                                
           IF 426A-PR-HEAD-4 NOT = SPACES                                       
              IF K830-NUM-ADDR-TYPE = 'H'                                       
                 WRITE L426E-PRTREC FROM 426A-PR-HEAD-4 AFTER 1                 
                 MOVE SPACES        TO   426A-PR-HEAD-4                         
              ELSE                                                              
                 WRITE L426E-PRTREC FROM 426A-PR-HEAD-4 AFTER 1                 
                 MOVE SPACES        TO   426A-PR-HEAD-4.                        
                                                                                
            IF 426A-PR-HEAD-5 NOT = SPACES                                      
               IF K830-NUM-ADDR-TYPE = 'H'                                      
                  WRITE L426E-PRTREC FROM 426A-PR-HEAD-5 AFTER 1                
                  MOVE SPACES        TO   426A-PR-HEAD-5                        
               ELSE                                                             
                  WRITE L426E-PRTREC FROM 426A-PR-HEAD-5 AFTER 1                
                  MOVE SPACES        TO   426A-PR-HEAD-5.                       
                                                                                
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-6   AFTER 1.                   
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-7   AFTER 3.                   
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-9A  AFTER 6.                   
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-10  AFTER 2.                   
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-10A AFTER 17.                  
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-10B AFTER 1.                   
                                                                                
            WRITE L426E-PRTREC FROM L426-LINE-OIC       AFTER 15.               
            WRITE L426E-PRTREC FROM L426-LINE-OIC1      AFTER 1.                
                                                                                
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-11     AFTER 2.                
            WRITE L426E-PRTREC FROM L426-LINE-BARCODE   AFTER 0.                
                                                                                
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-12     AFTER 1.                
            WRITE L426E-PRTREC FROM 426A-PR-HEAD-13     AFTER 1.                
                                                                                
            MOVE     SPACES                TO   426A-DTE-EXPIRED-DES.           
            PERFORM  700-PRINT-DETAIL-LIST THRU 700-EXIT.                       
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       700-PRINT-DETAIL-LIST.                                                   
      *-------------------------------------------------------------            
      *    PRINT CONTROL LIST FOR APPOINTMENT LETTERS (S.O)       *             
      *-----------------------------------------------------------*             
           IF WS-NUMBER > 46                                                    
              PERFORM 800-PRINT-HEADING.                                        
                                                                                
           PERFORM 900-PRINT-DETAIL.                                            
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       800-PRINT-HEADING.                                                       
      *-------------------------------------------------------------            
           ADD     1                 TO     NO-OF-PAGE.                         
           WRITE   L426C-PRTREC      FROM   426C-PR-HEAD16 AFTER PAGE.          
                                                                                
           WRITE   L426C-PRTREC      FROM   426C-PR-HEAD17.                     
           WRITE   L426C-PRTREC      FROM   426C-PR-HEAD18 AFTER 3.             
           MOVE    SPACES            TO     L426C-PRTREC.                       
           WRITE   L426C-PRTREC      AFTER  2.                                  
           MOVE    0                 TO     WS-NUMBER.                          
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       830-READ-BP13K022.                                                       
      ******************************************************************        
           MOVE 'N'          TO K022-FOUND.                                     
                                                                                
           MOVE F310-REGN-NO TO K022-NUM-REGN.                                  
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF BP13K022-STATUS = 00                                              
              MOVE 'Y' TO K022-FOUND                                            
           ELSE                                                                 
           IF BP13K022-STATUS = 23                                              
              MOVE 'N' TO K022-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K022 = '  BP13K022-STATUS              
              MOVE 'N' TO K022-FOUND.                                           
                                                                                
           MOVE 'N'          TO K024-FOUND.                                     
           IF K022-FOUND = 'Y'                                                  
              ADD 1                       TO   WS-CNT-K022                      
              MOVE K022-NUM-OIC           TO   K024-NUM-OIC                     
              PERFORM 835-READ-BP13K024   THRU 835-EXIT                         
           END-IF.                                                              
                                                                                
       830-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       835-READ-BP13K024.                                                       
      ******************************************************************        
           READ BP13K024 KEY IS K024-KEY-FLD.                                   
                                                                                
           IF BP13K024-STATUS = 00                                              
              MOVE 'Y' TO K024-FOUND                                            
           ELSE                                                                 
           IF BP13K024-STATUS = 23                                              
              MOVE 'N' TO K024-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K024 = '  BP13K024-STATUS              
              MOVE 'N' TO K024-FOUND.                                           
                                                                                
           IF K024-FOUND = 'Y'                                                  
              ADD   1  TO WS-CNT-K024                                           
           END-IF.                                                              
                                                                                
       835-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       840-GET-CSM-INFO.                                                        
      ******************************************************************        
           MOVE SPACES TO L426-HDR-PHONE-DID                                    
                          L426-DTL-HAND-PHONE                                   
      *                   L426-EMAIL                                            
                          L426-DTL-DID                                          
                          L426-OIC-NAME                                         
                          L426-OIC-DESG                                         
                          WS-HDR-PHONE-DID                                      
                          WS-EMAIL.                                             
                                                                                
           IF K024-FOUND = 'Y'                                                  
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 5               
                 MOVE SPACES TO WS-OIC-EMAIL-TAB(WS-CTR)                        
                 MOVE SPACES TO WS-OIC-TAB(WS-CTR)                              
              END-PERFORM                                                       
                                                                                
              MOVE K024-NME-OIC                 TO L426-OIC-NAME                
              MOVE 'CUSTOMER SERVICE MANAGER'   TO L426-OIC-DESG                
              MOVE K024-NUM-DID                 TO L426-HDR-PHONE-DID           
                                                   L426-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L426-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           ELSE                                                                 
              MOVE '1800-8663066(TOLL-FREE)'    TO WS-HDR-PHONE-DID             
              MOVE FUNCTION LOWER-CASE(WS-HDR-PHONE-DID)                        
                                                TO L426-HDR-PHONE-DID           
              MOVE '64903783'                   TO L426-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L426-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           END-IF.                                                              
                                                                                
      *    MOVE FUNCTION LOWER-CASE(WS-EMAIL)   TO L426-EMAIL.                  
                                                                                
       840-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       900-PRINT-DETAIL.                                                        
      *-------------------------------------------------------------            
            ADD    1                 TO    WS-NUMBER.                           
            MOVE   K800-NUM-REGN     TO    624B-REGN-NO.                        
            MOVE   426A-APPL-NAME    TO    624B-NAME.                           
            MOVE   F310-NUM-BLK      TO    624B-BLK-NO.                         
            MOVE   F310-NME-STREET   TO    624B-STREET-NAME.                    
            MOVE   F310-NUM-LEVEL    TO    624B-LEVEL-NO.                       
            MOVE   F310-NUM-MAIN     TO    624B-MAIN-UNIT.                      
            MOVE   '-'               TO    624B-DASH.                           
            MOVE   K110-CURR-SELLING-PRICE TO   624B-SELLING-PR.                
            MOVE   F310-SCH-ACC      TO    624B-SCH-ACC-NO.                     
            MOVE   K800-NUM-NRIC1    TO    624B-NRIC.                           
            WRITE  L426C-PRTREC      FROM  426C-PR-HEAD19 AFTER 1.              
                                                                                
            IF 426A-COAPPL-NAME NOT = SPACES                                    
               ADD   1                TO   WS-NUMBER                            
               MOVE  SPACES           TO   426C-PR-HEAD19                       
               MOVE  426A-COAPPL-NAME TO   624B-NAME                            
               MOVE  K800-NUM-NRIC2   TO   624B-NRIC                            
               WRITE L426C-PRTREC     FROM 426C-PR-HEAD19 AFTER 1.              
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       1000-PRINT-TOTAL.                                                        
      *-------------------------------------------------------------            
      *     1.  OUTPUT TOTAL NUMBERS OF LETTERS PRINTED           *             
      *     2.  OUTPUT TOTAL NUMBERS OF GIRO FORMS PRINTED        *             
      *     3.  OUTPUT TOTAL NUMBERS OF ERRORS PRINTED            *             
      *-----------------------------------------------------------*             
            MOVE NO-OF-LETTER TO 624B-TOTAL.                                    
            WRITE L426C-PRTREC FROM 426C-PR-HEAD20 AFTER 3.                     
                                                                                
            IF NO-OF-ERROR NOT = 0                                              
               MOVE  NO-OF-ERROR TO    426C-TOTAL-ERROR                         
               WRITE L426C-PRTREC FROM 426C-PR-HEAD24 AFTER 3.                  
                                                                                
                                                                                
      *-------------------------------------------------------------            
       1100-ERROR-ROUTINE.                                                      
      *-------------------------------------------------------------            
      *     PRINT ERROR LIST FOR APPOINTMENT LETTERS (S.O)        *             
      *-----------------------------------------------------------*             
            IF WS-ERR-NO > 46                                                   
               PERFORM 1200-PRINT-ERR-HEADING.                                  
                                                                                
            PERFORM 1300-PRINT-ERROR.                                           
                                                                                
                                                                                
      *-------------------------------------------------------------            
       1200-PRINT-ERR-HEADING.                                                  
      *-------------------------------------------------------------            
            ADD     1                TO     NO-OF-ERR-PAGE.                     
            MOVE    NO-OF-ERR-PAGE   TO     624B-PAGE.                          
            MOVE   'P13L426C'        TO     624B-LIST.                          
            WRITE   L426C-PRTREC     FROM   426C-PR-HEAD16 AFTER PAGE.          
            MOVE    WS-EDITED-DTE    TO     426C-DATE.                          
                                                                                
            WRITE   L426C-PRTREC     FROM   426C-PR-HEAD21 AFTER 2.             
            WRITE   L426C-PRTREC     FROM   426C-PR-HEAD22 AFTER 3.             
            MOVE    SPACES           TO     L426C-PRTREC.                       
            WRITE   L426C-PRTREC     AFTER  2.                                  
            MOVE    0                TO     WS-ERR-NO.                          
                                                                                
                                                                                
      *-------------------------------------------------------------            
       1300-PRINT-ERROR.                                                        
      *-------------------------------------------------------------            
            ADD    1                        TO   NO-OF-ERROR.                   
            ADD    1                        TO   WS-ERR-NO.                     
            MOVE   F310-REGN-NO             TO   426C-REGN.                     
            MOVE   F310-NUM-BLK             TO   426C-BLK-NO.                   
            MOVE   F310-NME-STREET          TO   426C-STREET-NAME.              
            MOVE   F310-NUM-LEVEL           TO   426C-LEVEL-NO.                 
            MOVE   F310-NUM-MAIN            TO   426C-MAIN-UNIT.                
            MOVE   F310-CDE-TYP-ACTUSE      TO   426C-ROOM.                     
            MOVE   K110-CURR-SELLING-PRICE  TO   426C-SELLING-PR.               
            WRITE  L426C-PRTREC FROM 426C-PR-HEAD23   AFTER 1.                  
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3000-PRINT-WORKSHEET.                                                    
      *-------------------------------------------------------------            
            PERFORM 3100-COMPUTE-COMM-DEPOSIT    THRU 3100-EXIT.                
            PERFORM 3200-COMPUTE-LSTAMP-FEE      THRU 3200-EXIT.                
            PERFORM 3300-COMPUTE-CONVEY-FEE      THRU 3300-EXIT.                
            PERFORM 3400-COMPUTE-PARTB-WSHEET    THRU 3400-EXIT.                
            PERFORM 3500-PROCESS-PRINT-WSHEET    THRU 3500-EXIT.                
                                                                                
       3000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3100-COMPUTE-COMM-DEPOSIT.                                               
      *-------------------------------------------------------------            
           IF K110-CURR-SELLING-PRICE IS NUMERIC                                
             MOVE K110-CURR-SELLING-PRICE      TO WS-K110-CSPRICE               
             MOVE K110-1ST-OFFER-SELLING-PRICE TO WS-K110-CSPRICE-OFFER         
           ELSE                                                                 
             MOVE ZEROES                       TO WS-K110-CSPRICE               
                                                  WS-K110-CSPRICE-OFFER.        
                                                                                
           MOVE WS-K110-CSPRICE-OFFER TO L211-AMT-SELL-PRICE.                   
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3200-COMPUTE-LSTAMP-FEE.                                                 
      *-------------------------------------------------------------            
      *==> 0.007 --> 0.01 (REMOVE 2001 OFF-BUDGET DISCOUNT)                     
      *==> 0.014 --> 0.02 (REMOVE 2001 OFF-BUDGET DISCOUNT)                     
      *==> 0.021 --> 0.03 (REMOVE 2001 OFF-BUDGET DISCOUNT)                     
                                                                                
           IF WS-K110-CSPRICE-OFFER NOT > 180000                                
              COMPUTE WS-COMP-LS-FEE = 0.01 * WS-K110-CSPRICE-OFFER             
           ELSE                                                                 
              COMPUTE WS-LS-LEAVE = WS-K110-CSPRICE-OFFER - 180000              
              IF WS-LS-LEAVE NOT  > 180000                                      
                 COMPUTE WS-COMP-LS-FEE = 0.01 * 180000 +                       
                                         (0.02 * WS-LS-LEAVE)                   
              ELSE                                                              
                 COMPUTE WS-LS-LEAVE   = WS-K110-CSPRICE-OFFER - 360000         
                 COMPUTE WS-COMP-LS-FEE = (0.01 * 180000) +                     
                                          (0.02 * 180000) +                     
                                          (0.03 * WS-LS-LEAVE).                 
      *==> SC/CC AD VALOREM                                                     
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z') OR                           
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SSP' OR 'SPP' OR               
                                       'SPS' OR 'SRP')                          
              COMPUTE WS-S905-SC-CC1 = WS-S903-SC-CC1 +                         
                                       WS-S903-SC-REC-TC1                       
              COMPUTE WS-S905-SC-CC2 = WS-S903-SC-CC2 +                         
                                       WS-S903-SC-REC-TC2                       
              COMPUTE WS-S905-SC-CC3 = WS-S903-SC-CC3 +                         
                                       WS-S903-SC-REC-TC3                       
              MOVE ZEROES           TO WS-S905-SC-TOTAL-AMT                     
           ELSE                                                                 
              MOVE WS-S903-SC-CC1   TO WS-S905-SC-CC1                           
              MOVE WS-S903-SC-CC2   TO WS-S905-SC-CC2                           
              MOVE WS-S903-SC-CC3   TO WS-S905-SC-CC3                           
              MOVE ZEROES           TO WS-S905-SC-TOTAL-AMT                     
           END-IF.                                                              
                                                                                
      *==> CALL BP13C905 TO GET THE AD VALOREM STAMP FEE                        
      *    COMPUTE THE SC/CC AD-VALOREM , USE PURE SC-CC ONLY!                  
                                                                                
           CALL 'BP13C905' USING WS-LINK-S905.                                  
           IF WS-S905-SC-TOTAL-AMT IS NUMERIC                                   
              ADD  WS-S905-SC-TOTAL-AMT  TO  WS-COMP-LS-FEE.                    
      *==> $1.40 FOR DUPLICATE SALES AGREEMENT (2001 OFF-BUDGET)                
      *==> $2 FOR DUPLICATE SALES AGREEMENT (ORIGINAL)                          
           ADD  2                        TO  WS-COMP-LS-FEE.                    
                                                                                
           MOVE WS-COMP-LS-FEE           TO L211-AMT-LS-FEE.                    
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3300-COMPUTE-CONVEY-FEE.                                                 
      *-------------------------------------------------------------            
           IF WS-K110-CSPRICE NOT > 30000                                       
              COMPUTE WS-COMP-CV-FEE = 0.0009 * WS-K110-CSPRICE                 
           ELSE                                                                 
              COMPUTE WS-CONV-LEAVE = WS-K110-CSPRICE - 30000                   
              IF WS-CONV-LEAVE NOT  > 30000                                     
                 COMPUTE WS-COMP-CV-FEE = 0.0009 * 30000 +                      
                                          (0.00072 * WS-CONV-LEAVE)             
              ELSE                                                              
                 COMPUTE WS-CONV-LEAVE  = WS-K110-CSPRICE -  60000              
                 COMPUTE WS-COMP-CV-FEE = (0.0009 * 30000) +                    
                                          (0.00072 * 30000) +                   
                                          (0.00060 * WS-CONV-LEAVE).            
                                                                                
      *==> THE MINIMUM CONVEY FEE IS $20                                        
      *    ROUND IT UP TO THE NEAREST DOLLAR EG. $51.20 BECOME $52.00           
                                                                                
            IF WS-COMP-CV-FEE NOT > 20                                          
               MOVE 20              TO  WS-COMP-CV-FEE                          
            ELSE                                                                
               ADD 0.49             TO  WS-COMP-CV-FEE                          
               COMPUTE WS-ROUND-CONVFEE ROUNDED = WS-COMP-CV-FEE / 100          
               COMPUTE WS-COMP-CV-FEE          = WS-ROUND-CONVFEE * 100.        
                                                                                
      *==> COMPUTING GST FOR CONVEYANCING FEES                                  
            MOVE  WS-COMP-CV-FEE    TO   WS-AMT-NETT                            
                                         L211-ACT-CV-FEE.                       
                                                                                
            CALL 'AV02C021' USING WS-COMM-AREA-GST.                             
                                                                                
            ADD   WS-AMT-GST        TO   WS-COMP-CV-FEE.                        
            MOVE  WS-AMT-GST        TO   L211-GST-CV-FEE.                       
            MOVE  WS-COMP-CV-FEE    TO   L211-AMT-CV-FEE.                       
                                                                                
      * TO REMOVE ODD CENTS                                                     
            MOVE SPACES             TO   WS-COMM-AREA-ODDCENTS.                 
            INITIALIZE                   WS-COMM-AREA-ODDCENTS.                 
                                                                                
            MOVE  WS-COMP-CV-FEE    TO   WS-COMM-ODD-TOTAL-FEE.                 
            MOVE  WS-NUM-GST-RATE   TO   WS-COMM-ODD-GST-RATE.                  
                                                                                
            CALL 'BP13C90B' USING WS-COMM-AREA-ODDCENTS.                        
                                                                                
            IF WS-COMM-ODD-CENTS-SW = 'Y'                                       
               MOVE WS-COMM-ODD-GST       TO WS-AMT-GST                         
                                             L211-GST-CV-FEE                    
               MOVE WS-COMM-ODD-BASE-FEE  TO L211-ACT-CV-FEE                    
               MOVE WS-COMM-ODD-TOTAL-FEE TO WS-COMP-CV-FEE                     
                                             L211-AMT-CV-FEE                    
            END-IF.                                                             
                                                                                
            COMPUTE   WS-COMP-TOTAL   =   WS-COMP-LS-FEE +                      
                                          WS-COMP-CV-FEE.                       
                                                                                
            MOVE WS-COMP-TOTAL      TO  L211-AMT-TOTAL.                         
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3400-COMPUTE-PARTB-WSHEET.                                               
      *-------------------------------------------------------------            
           MOVE ZEROES                   TO WS-TOTAL-CD.                        
                                                                                
           IF K800-AMT-CD-CPF1 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF1      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF2 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF2      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF3 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF3      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF4 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF4      TO WS-TOTAL-CD.                        
                                                                                
           IF K800-AMT-CD-CASH IS NOT NUMERIC                                   
              MOVE ZEROES              TO K800-AMT-CD-CASH                      
           END-IF.                                                              
           IF K800-AMT-CD-REFUND IS NOT NUMERIC                                 
              MOVE ZEROES              TO K800-AMT-CD-REFUND                    
           END-IF.                                                              
                                                                                
           MOVE ZEROES              TO WS-UPD-CD-CASH.                          
           COMPUTE WS-UPD-CD-CASH = K800-AMT-CD-CASH -                          
                                    K800-AMT-CD-REFUND.                         
                                                                                
      *-------------------------------------------------------------            
      *   CD TO BE PAID                                                         
      *-------------------------------------------------------------            
           PERFORM 3420-CALL-BP13C900  THRU 3420-EXIT.                          
           ADD WS-LOAN-INT-2           TO WS-S900-TOT-ICP.                      
           MOVE ZEROES                 TO WS-LOAN-INT-2.                        
           MOVE WS-LOAN-ROUND-DOWN     TO WS-MAX-LOAN-AMT.                      
           PERFORM 3420-CALL-BP13C900  THRU 3420-EXIT.                          
                                                                                
           COMPUTE WS-TOTAL-CD = WS-TOTAL-CD + WS-LOAN-INT-2.                   
           COMPUTE WS-TOT-STAMP-FEE = WS-COMP-LEASE + WS-MORT-STAMP-FEE         
                                    + WS-COMP-MORTGAGE.                         
           COMPUTE WS-TOTAL-FEES    = WS-TOT-STAMP-FEE +                        
                                      WS-COMP-SURVEY-FEE.                       
           COMPUTE WS-TOTAL-SELLPR  = WS-TOTAL-FEES +                           
                                      WS-K110-CSPRICE.                          
           COMPUTE WS-BALANCE-AMT   = WS-TOTAL-SELLPR - WS-TOTAL-CD.            
                                                                                
           MOVE K110-CURR-SELLING-PRICE  TO 400C-SELLING-PRICE.                 
           MOVE WS-COMP-LEASE            TO 400C-LEASE-FEE.                     
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
           MOVE WS-MORT-STAMP-FEE        TO 400C-MORT-STAMP-FEE.                
           MOVE WS-COMP-MORTGAGE         TO 400C-MORTGAGE-FEE.                  
           MOVE WS-TOT-STAMP-FEE         TO 400C-TOT-STAMP-FEE.                 
           MOVE WS-TOTAL-FEES            TO 400C-TOT-FEES.                      
           MOVE WS-TOTAL-SELLPR          TO 400C-TOT-SELLPR.                    
           MOVE WS-TOTAL-CD              TO 400C-TOTAL-CD.                      
           MOVE WS-UPD-CD-CASH           TO 400C-CD-CASH.                       
           MOVE WS-LOAN-INT-2            TO 400C-CD-CPF1.                       
           MOVE '(ICP)'                  TO 400C-CD-CPF1-TXT.                   
           MOVE K800-AMT-CD-CPF2         TO 400C-CD-CPF2.                       
           MOVE K800-AMT-CD-CPF3         TO 400C-CD-CPF3.                       
           MOVE K800-AMT-CD-CPF4         TO 400C-CD-CPF4.                       
           MOVE WS-BALANCE-AMT           TO 400C-BALANCE-AMT.                   
           MOVE WS-MAX-LOAN-AMT          TO 400C-MAX-LOAN-AMT.                  
                                                                                
      *==> GET INTEREST RATE                                                    
           MOVE  FUNCTION CURRENT-DATE(1:8) TO  WS-COMPARE-DATE.                
                                                                                
           MOVE WS-COMPARE-DATE          TO WS-COMPUTE-DATE.                    
           MOVE 01                       TO WS-COMPUTE-DD.                      
           PERFORM 3410-READ-AB03K050  THRU 3410-EXIT.                          
                                                                                
      *==> TO GET INSTALMENT                                                    
           MOVE  'N'                     TO WS-S901-ERL.                        
           MOVE  F310-CDE-TYP-ACTUSE     TO WS-S901-RM.                         
           MOVE  F310-CDE-MODL-DESG      TO WS-S901-DESIGN.                     
           MOVE  25                      TO WS-S901-REPAY-PD.                   
                                                                                
           COMPUTE WS-S901-INT = WS-INTREST-RATE * 0.01.                        
           MOVE  WS-MAX-LOAN-AMT         TO WS-S901-LOAN-AMT.                   
           MOVE  ZEROES                  TO WS-S901-ERL-LOAN-AMT.               
           CALL  'BP13C901' USING WS-LINK-S901.                                 
           MOVE  WS-S901-MTH-INSTAL      TO WS-MTHLY-INSTAL.                    
           MOVE  WS-MTHLY-INSTAL         TO 400C-MTHLY-INSTAL.                  
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3410-READ-AB03K050.                                                      
      *-------------------------------------------------------------            
           MOVE LOW-VALUES            TO K050-DTE-INT-EFF.                      
           MOVE 'P'                   TO K050-CDE-LOAN-SCH.                     
                                                                                
           START AB03K050 KEY > K050-KEY.                                       
                                                                                
           IF  AB03K050-STATUS NOT = 00                                         
                  DISPLAY 'ERROR READING AB03K050, STATUS '                     
                                              AB03K050-STATUS                   
                  MOVE AB03K050-STATUS TO RETURN-CODE                           
                  PERFORM  1400-CLOSE-ROUTINE                                   
           END-IF.                                                              
                                                                                
           MOVE  'N'            TO     WS-K050-EOF                              
           PERFORM UNTIL K050-DTE-INT-EFF >= WS-COMPUTE-DATE                    
                                          OR                                    
                         WS-K050-EOF = 'Y'                                      
              MOVE  AB03K050-REC     TO  WS-AB03K050-REC                        
              READ  AB03K050   NEXT  AT  END  MOVE 'Y' TO WS-K050-EOF           
                                              GO TO 3410-CHECK-DATE             
              END-READ                                                          
              IF  AB03K050-STATUS NOT = 00                                      
                  DISPLAY 'ERROR READING AB03K050, STATUS '                     
                                              AB03K050-STATUS                   
                  MOVE AB03K050-STATUS TO RETURN-CODE                           
                  PERFORM  1400-CLOSE-ROUTINE                                   
              END-IF                                                            
              IF K050-CDE-LOAN-SCH NOT = 'P'                                    
                 MOVE 'Y'   TO   WS-K050-EOF                                    
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       3410-CHECK-DATE.                                                         
                                                                                
              IF  K050-DTE-INT-EFF  > WS-COMPUTE-DATE  OR                       
                  K050-CDE-LOAN-SCH NOT = 'P'                                   
                  MOVE  WS-AB03K050-REC    TO    AB03K050-REC                   
              END-IF.                                                           
                                                                                
              IF  K050-DTE-INT-EFF IS NOT NUMERIC                               
                  DISPLAY 'NO RECORD MATCHED IN AB03K050  '                     
                  MOVE '99'            TO RETURN-CODE                           
                  PERFORM  1400-CLOSE-ROUTINE                                   
              END-IF.                                                           
                                                                                
             MOVE K050-PCT-PA-INT    TO WS-INTREST-RATE.                        
             MOVE K050-CDE-PA-FACTOR TO WS-S901-FAC.                            
                                                                                
             MOVE 25                 TO 400C-REPAY-PRD.                         
             MOVE WS-INTREST-RATE    TO 400C-INT-RATE.                          
                                                                                
       3410-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3420-CALL-BP13C900.                                                      
      *-------------------------------------------------------------            
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-SELL-PR.                    
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE 25                       TO WS-S900-REPAY-PD.                   
           MOVE '10'                     TO WS-S900-SALE-TYPE.                  
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY.          
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE '00'                     TO WS-S900-PREMIUM-CODE.               
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
                                                                                
           CALL 'BP13C900' USING WS-LINK-S900.                                  
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE  =  WS-S900-LS-ESCROW-FEE +                    
                                     WS-S900-LS-REGN-FEE.                       
                                                                                
           MOVE WS-S900-MORT-ST-FEE     TO WS-MORT-STAMP-FEE.                   
                                                                                
           COMPUTE WS-COMP-MORTGAGE =  WS-S900-MORT-ESCROW-FEE +                
                                       WS-S900-MORT-REGN-FEE.                   
           MOVE WS-S900-LOAN        TO WS-LOAN-ROUND-DOWN.                      
                                                                                
           COMPUTE WS-AMT-SC-CC     =   WS-SC-CC1-AMT +                         
                                        WS-SC-CC2-AMT +                         
                                        WS-SC-CC3-AMT.                          
           COMPUTE WS-AMT-SC-CC     =   WS-SC-CC1-AMT +                         
                                        (WS-SC-CC2-AMT * 2).                    
           MOVE    WS-AMT-SC-CC     TO  400C-SC-CC-AMT.                         
                                                                                
       3420-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3500-PROCESS-PRINT-WSHEET.                                               
      *-------------------------------------------------------------            
      *==> PRINT PARTA                                                          
           MOVE  SPACES         TO   L426D-PRTREC.                              
           MOVE  F310-REGN-NO   TO   L211-REGN-NO.                              
           WRITE L426D-PRTREC   FROM L310-PR-HEAD-09 AFTER PAGE.                
           WRITE L426D-PRTREC   FROM L310-PR-HEAD-10 AFTER 5.                   
           WRITE L426D-PRTREC   FROM L310-PR-HEAD-12 AFTER 2.                   
           WRITE L426D-PRTREC   FROM L310-PR-HEAD-TOTAL AFTER 2.                
                                                                                
      *==> PRINT PARTB                                                          
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-1  AFTER 5.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-2  AFTER 1.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-3  AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-4  AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-5  AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-6  AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-7  AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-8  AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-9  AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-10 AFTER 3.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-11 AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-12 AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-13 AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-14 AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-15 AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-16 AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-17 AFTER 2.                  
           WRITE L426D-PRTREC   FROM L400C-PR-LINE-18 AFTER 2.                  
                                                                                
      *==> PRINT NOTE                                                           
           MOVE   WS-EDITED-DTE   TO L310-SYS-DATE.                             
           WRITE  L426D-PRTREC  FROM L310-PR-LINE-15 AFTER 10.                  
           WRITE  L426D-PRTREC  FROM L310-PR-LINE-16 AFTER 1.                   
           WRITE  L426D-PRTREC  FROM L310-PR-LINE-17 AFTER 1.                   
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       1400-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
           DISPLAY ' '.                                                         
           DISPLAY '---------  BP13C426 ----------'.                            
           DISPLAY ' '.                                                         
           DISPLAY 'NO OF INPUT F310 READ : ' NO-OF-READ-F310.                  
                                                                                
           CLOSE BP13F310                                                       
                 BP13K022                                                       
                 BP13K024                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 AB03K050                                                       
                 BM06K110                                                       
                 P13L426D                                                       
                 P13L426E                                                       
                 P13L426C.                                                      
                                                                                
           IF BP13K800-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, BP13K800-STATUS ' BP13K800-STATUS.        
           IF BP13K022-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, BP13K022-STATUS ' BP13K022-STATUS.        
           IF BP13K024-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, BP13K024-STATUS ' BP13K024-STATUS.        
           IF BP13K820-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, BP23K820-STATUS ' BP13K820-STATUS.        
           IF BP13K830-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, BP13K830-STATUS ' BP13K830-STATUS.        
           IF BM06K110-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, BM06K110-STATUS ' BM06K110-STATUS.        
                                                                                
           STOP RUN.                                                            
