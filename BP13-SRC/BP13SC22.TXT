/*-----------------------------------------------------------------*/           
/* SYSTEM OF COMMITMENT - DBSS  (BP13)                             */           
/* OBJECTIVE   : REPORT FOR BOOKED AND NOTBOOKED FLAT FOR BE/BTO/  */           
/*               DBS/BE&BTO/BE&DBS/BTO&DBS/BE&BTO&DB/TOTAL         */           
/* INPUT FILES : BP13F593                                          */           
/* DATE        : AUG 22 2007                                       */           
/* AUTHOR      : BALA AMUTHAN                                      */           
/*-----------------------------------------------------------------*/           
/*-----------------------------------------------------------------*/           
/* PROGRAM TO PRINT STATUS OF DBSS LOAN ACCOUNT ON EVERY MONTH     */           
/*-----------------------------------------------------------------*/           
/* CHG-NO   BY  ON           DESCRIPTION                           */           
/* -------- --  --           ------------                          */           
/* BP133111 BA2 22/08/2007   NEW PRG.                              */           
/*-----------------------------------------------------------------*/           
                                                                                
OPTIONS  NODATE NONUMBER;                                                       
                                                                                
PROC FORMAT;                                                                    
     PICTURE FMT LOW-0='000,009'                                                
                 0-HIGH='000,009';                                              
                                                                                
DATA BP13F593;                                                                  
     INFILE BP13F593;                                                           
     INPUT @01   NRIC                     $9.                                   
           @18   UNSUCC_TOT               2.                                    
           @20   UNSUCC_BE                2.                                    
           @22   UNSUCC_BTO               2.                                    
           @24   UNSUCC_DBS               2.                                    
           @1814 BOOK_REG_NO              $8.;                                  
                                                                                
PROC SORT;                                                                      
     BY UNSUCC_TOT;                                                             
/*------------------------------------*/                                        
/* SORTING FOR BE CASES.              */                                        
/*------------------------------------*/                                        
    DATA BE_DATA;                                                               
        SET BP13F593;                                                           
        WHERE UNSUCC_BE > 00 AND UNSUCC_BTO = 0 AND UNSUCC_DBS = 0;             
                                                                                
    PROC SORT; BY UNSUCC_TOT;                                                   
                                                                                
/*------------------------------------*/                                        
/* SORTING FOR BTO CASES.             */                                        
/*------------------------------------*/                                        
    DATA BTO_DATA;                                                              
        SET BP13F593;                                                           
        WHERE UNSUCC_BTO > 0 AND UNSUCC_BE = 0 AND UNSUCC_DBS = 0;              
                                                                                
    PROC SORT; BY UNSUCC_TOT;                                                   
                                                                                
/*------------------------------------*/                                        
/* SORTING FOR DBS CASES.             */                                        
/*------------------------------------*/                                        
    DATA DBS_DATA;                                                              
        SET BP13F593;                                                           
        WHERE UNSUCC_DBS > 0 AND UNSUCC_BE = 0 AND UNSUCC_BTO = 0;              
                                                                                
    PROC SORT; BY UNSUCC_TOT;                                                   
                                                                                
/*------------------------------------*/                                        
/* SORTING FOR BE&BTO CASES.          */                                        
/*------------------------------------*/                                        
    DATA BE_BTO_DATA;                                                           
        SET BP13F593;                                                           
        WHERE UNSUCC_BE > 0 AND UNSUCC_BTO > 0 AND UNSUCC_DBS = 0;              
                                                                                
    PROC SORT; BY UNSUCC_TOT;                                                   
                                                                                
/*------------------------------------*/                                        
/* SORTING FOR BE&DBS CASES.          */                                        
/*------------------------------------*/                                        
    DATA BE_DBS_DATA;                                                           
        SET BP13F593;                                                           
        WHERE UNSUCC_BE > 0 AND UNSUCC_DBS > 0 AND UNSUCC_BTO = 0;              
                                                                                
    PROC SORT; BY UNSUCC_TOT;                                                   
                                                                                
/*------------------------------------*/                                        
/* SORTING FOR BTO&DBS CASES.         */                                        
/*------------------------------------*/                                        
    DATA BTO_DBS_DATA;                                                          
        SET BP13F593;                                                           
        WHERE UNSUCC_BTO > 0 AND UNSUCC_DBS > 0 AND UNSUCC_BE = 0;              
                                                                                
    PROC SORT; BY UNSUCC_TOT;                                                   
                                                                                
/*------------------------------------*/                                        
/* SORTING FOR BE,BTO&DBS CASES.      */                                        
/*------------------------------------*/                                        
    DATA BE_BTO_DBS_DATA;                                                       
        SET BP13F593;                                                           
        WHERE UNSUCC_BE > 0 AND UNSUCC_BTO > 0 AND UNSUCC_DBS > 0;              
                                                                                
    PROC SORT; BY UNSUCC_TOT;                                                   
                                                                                
DATA SY02F001;                                                                  
     INFILE SY02F001 END = EOF1;                                                
     INPUT  @01  DATE_CYM_CURR        YYMMDD8.                                  
            @21  DATE_CYM_PREV        $6.;                                      
                                                                                
     CALL SYMPUT ('CURR_DTE',(PUT(DATE_CYM_CURR,DDMMYY10.)));                   
                                                                                
                                                                                
/*---------------------------------------------------------*/                   
/* (1)  PROCESS FOR PRINTING BE CASES.                     */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22A NOTITLES HEADER = HH_BE;                                     
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET BE_DATA END=EOF NOBS=TOTAL;                                            
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE = 0; WS_GRT_NOT_BOOK_CASE = 0; WS_GRT_TOT = 0;        
    END;                                                                        
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE = 0; WS_NOT_BOOK_CASE = 0;                                
         WS_BOOK_NOT_BOOK_CASE = 0;                                             
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @02 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH_BE:                                                                        
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22A - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12   'BE TOTAL';                                                       
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
                                                                                
RETURN;                                                                         
                                                                                
/*---------------------------------------------------------*/                   
/* (2)  PROCESS FOR PRINTING BTO CASES.                    */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22B NOTITLES HEADER = HH_BTO;                                    
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET BTO_DATA END=EOF NOBS=TOTAL;                                           
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE = 0; WS_GRT_NOT_BOOK_CASE = 0; WS_GRT_TOT = 0;        
                                                                                
       END;                                                                     
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE = 0; WS_NOT_BOOK_CASE = 0;                                
         WS_BOOK_NOT_BOOK_CASE = 0;                                             
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @02 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH_BTO:                                                                       
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22B - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12  'BTO TOTAL ';                                                      
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
  RETURN;                                                                       
                                                                                
/*---------------------------------------------------------*/                   
/* (3)  PROCESS FOR PRINTING DBS CASES.                    */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22C NOTITLES HEADER = HH_DBS;                                    
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET DBS_DATA END=EOF NOBS=TOTAL;                                           
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE = 0; WS_GRT_NOT_BOOK_CASE = 0; WS_GRT_TOT = 0;        
                                                                                
       END;                                                                     
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE = 0; WS_NOT_BOOK_CASE = 0;                                
         WS_BOOK_NOT_BOOK_CASE = 0;                                             
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @02 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH_DBS:                                                                       
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22C - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12  'DBS TOTAL ';                                                      
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
  RETURN;                                                                       
                                                                                
/*---------------------------------------------------------*/                   
/* (4)  PROCESS FOR PRINTING BE & BTO CASES.               */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22D NOTITLES HEADER = HH_BE_BTO;                                 
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET BE_BTO_DATA END=EOF NOBS=TOTAL;                                        
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE=0; WS_GRT_NOT_BOOK_CASE=0; WS_GRT_TOT=0;              
                                                                                
       END;                                                                     
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE=0; WS_NOT_BOOK_CASE=0;                                    
         WS_BOOK_NOT_BOOK_CASE=0;                                               
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @01 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH_BE_BTO:                                                                    
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22D - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12  'BE & BTO TOTAL ';                                                 
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
  RETURN;                                                                       
                                                                                
/*---------------------------------------------------------*/                   
/* (5)  PROCESS FOR PRINTING BE & DBS CASES.               */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22E NOTITLES HEADER = HH_BE_DBS;                                 
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET BE_DBS_DATA END=EOF NOBS=TOTAL;                                        
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE = 0; WS_GRT_NOT_BOOK_CASE = 0; WS_GRT_TOT = 0;        
                                                                                
       END;                                                                     
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE = 0; WS_NOT_BOOK_CASE = 0;                                
         WS_BOOK_NOT_BOOK_CASE = 0;                                             
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @02 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH_BE_DBS:                                                                    
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22E - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12  'BE & DBS TOTAL ';                                                 
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
  RETURN;                                                                       
                                                                                
/*---------------------------------------------------------*/                   
/* (6)  PROCESS FOR PRINTING BTO & DBS CASES.              */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22F NOTITLES HEADER = HH_BTO_DBS;                                
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET BTO_DBS_DATA END=EOF NOBS=TOTAL;                                       
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE = 0; WS_GRT_NOT_BOOK_CASE = 0; WS_GRT_TOT = 0;        
                                                                                
       END;                                                                     
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE = 0; WS_NOT_BOOK_CASE = 0;                                
         WS_BOOK_NOT_BOOK_CASE = 0;                                             
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @02 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH_BTO_DBS:                                                                   
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22F - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12  'BTO & DBS TOTAL ';                                                
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
  RETURN;                                                                       
                                                                                
/*---------------------------------------------------------*/                   
/* (7)  PROCESS FOR PRINTING BE,BTO & DBS CASES.           */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22G NOTITLES HEADER = HH_BE_BTO_DBS;                             
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET BE_BTO_DBS_DATA END=EOF NOBS=TOTAL;                                    
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE = 0; WS_GRT_NOT_BOOK_CASE = 0; WS_GRT_TOT = 0;        
                                                                                
       END;                                                                     
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE = 0; WS_NOT_BOOK_CASE = 0;                                
         WS_BOOK_NOT_BOOK_CASE = 0;                                             
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @02 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH_BE_BTO_DBS:                                                                
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22G - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12  'BE, BTO & DBS TOTAL ';                                            
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
  RETURN;                                                                       
                                                                                
/*---------------------------------------------------------*/                   
/* (8)  PROCESS FOR PRINTING ALL CASES.                    */                   
/*---------------------------------------------------------*/                   
                                                                                
DATA _NULL_;                                                                    
                                                                                
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE P13LC22H NOTITLES HEADER = HH;                                        
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
     SET BP13F593 END = EOF NOBS=TOTAL;                                         
         BY UNSUCC_TOT;                                                         
                                                                                
     IF _N_ = 1 THEN                                                            
       DO;                                                                      
         LENGTH WS_BOOK_CASE               8.;                                  
         LENGTH WS_NOT_BOOK_CASE           8.;                                  
         LENGTH WS_BOOK_NOT_BOOK_CASE      8.;                                  
         LENGTH WS_GRT_BOOK_CASE           8.;                                  
         LENGTH WS_GRT_NOT_BOOK_CASE       8.;                                  
         LENGTH WS_GRT_TOT                 8.;                                  
                                                                                
         RETAIN WS_BOOK_CASE  WS_NOT_BOOK_CASE  WS_BOOK_NOT_BOOK_CASE           
                WS_GRT_BOOK_CASE  WS_GRT_NOT_BOOK_CASE  WS_GRT_TOT;             
                                                                                
         WS_GRT_BOOK_CASE = 0; WS_GRT_NOT_BOOK_CASE = 0; WS_GRT_TOT = 0;        
                                                                                
       END;                                                                     
                                                                                
     IF FIRST.UNSUCC_TOT THEN                                                   
       DO;                                                                      
         WS_BOOK_CASE = 0; WS_NOT_BOOK_CASE = 0;                                
         WS_BOOK_NOT_BOOK_CASE = 0;                                             
       END;                                                                     
                                                                                
     IF BOOK_REG_NO ^= '        '  THEN                                         
       DO;                                                                      
         WS_BOOK_CASE + 1;                                                      
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_BOOK_CASE + 1;                                                  
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
     ELSE                                                                       
       DO;                                                                      
         WS_NOT_BOOK_CASE + 1;                                                  
         WS_BOOK_NOT_BOOK_CASE + 1;                                             
         WS_GRT_NOT_BOOK_CASE + 1;                                              
         WS_GRT_TOT + 1;                                                        
       END;                                                                     
                                                                                
     IF LAST.UNSUCC_TOT THEN                                                    
       DO;                                                                      
         PUT @02 UNSUCC_TOT                FMT.                                 
             @17 WS_BOOK_CASE              FMT.                                 
             @34 WS_NOT_BOOK_CASE          FMT.                                 
             @53 WS_BOOK_NOT_BOOK_CASE     FMT.;                                
       END;                                                                     
                                                                                
     IF EOF THEN                                                                
       DO;                                                                      
         PUT @01 ' '/;                                                          
         PUT @01 '       TOTAL  '                                               
             @17 WS_GRT_BOOK_CASE          FMT.                                 
             @34 WS_GRT_NOT_BOOK_CASE      FMT.                                 
             @53 WS_GRT_TOT                FMT.;                                
       END;                                                                     
                                                                                
RETURN;                                                                         
                                                                                
  HH:                                                                           
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01  'P13LC22H - 100%'                                                 
        @40   'S Y S T E M   O F   C O M M I T M E N T'                         
        @93  'PAGE : ' @101 PAGE 4./                                            
        @40  'REPORT OF BOOKED AND NOT BOOKED FLAT'                             
        @93  'DATE : ' @101 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @12  'ALL CASES           ';                                            
    PUT @01 ' '/;                                                               
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' NO.ATTEMPT     BOOKED FLAT      FLAT NOT BOOKED      TOTAL   ';   
    PUT @01 ' -------------------------------------------------------------';   
    PUT @01 ' '/;                                                               
  RETURN;                                                                       
                                                                                
