      **************************                                        00010000
       IDENTIFICATION DIVISION.                                         00020000
      **************************                                        00030000
       PROGRAM-ID.    BP13CB0C.                                         00040000
      *AUTHOR.        MARGE LAM KO.                                     00050000
      *DATE-WRITTEN.  31 AUG 2015.                                      00060000
                                                                        00070000
      * =========================================================== *   00080000
      * SYSTEM OF COMMITMENT (BP13)                                 *   00090000
      * =========================================================== *   00100000
      *   OBJECTIVE   : THIS PROGRAM PROCESSES REVERSAL TRANSACTIONS*   00110000
      *                 FROM PAYMENT SYSTEM TO SERS GRANT.          *   00120000
      *                 DROP FROM GRANT_ASMNT AND GRANT_ASMNT_PERSON*   00130000
      *                 AND MOVE TO GRANT_RCVRY, EX_GRANT_ASMNT, AND*   00140000
      *                 EX_GRANT_ASMNT_PERSON TABLES                *   00150000
      *                 DELETE BOTH REVERSAL AND NON-REVERSAL FROM  *   00160000
      *                 BP13KD10 FILE                               *   00170000
      *                                                             *   00180000
      *   INPUT FILES :                                             *   00190000
      *   1.  AG07F630 -- VOUCHER TRANSACTION FILE                  *   00200000
      *   2.  P13FD10A -- SORTED REVERSAL VOUCHER OIC FILE          *   00210000
      *   3.  BP13KD10 -- VOUCHER OIC FILE                          *   00220000
      *                                                             *   00230000
      *   OUTPUT FILES:                                             *   00240000
      *   1.  BP13F125 -- FILE FOR FINANCIAL HISTORY                *   00250000
      *   2.  P13FD10B -- SRR/RER AND SRG/REG VOUCHER OIC DELETED   *   00260000
      *   3.  BP13LB0C -- CONTROL LISTING                           *   00270000
      *                                                             *   00280000
      * CHQ REQ     DATE     BY  DESCRIPTIONS                       *   00290000
      * -------- ---------- ---- ---------------------------------- *   00300000
      * BP135978 31/08/2015 MRN1 NEW PROGRAM                        *   00310000
      * BP136028 25/11/2015 MRN1 TO CATER FOR NUM-TRANS = 'RER'     *   00320000
      * BP136147 02/12/2015 MRN1 TO CATER FOR NUM-TRANS = 'ASR'     *   00330000
      * BP136181 28/04/2016 MRN1 NEW FIELDS AND NEW TABLE FOR UPD LOG   00340000
      * BP136285 07/06/2016 MRN1 WHEN ASR, MOVE BOTH AHG/SHG IN F125*   00350000
      *                          USING VR DTLS INSTEAD OF PAYEE DTLS*   00360000
      * BP136622 03/04/2017 MRN1 NEW FIELD GRANT EXCESS             *   00370000
      * BP136884 03/01/2018 MRN1 CATER FOR FSR                      *   00380000
      * BP138233 06/12/2022 PP11 CATER FOR EHR                      *   00381001
      * =========================================================== *   00390000
                                                                        00400000
       ENVIRONMENT DIVISION.                                            00410000
                                                                        00420000
       CONFIGURATION SECTION.                                           00430000
                                                                        00440000
       SOURCE-COMPUTER. IBM-3090.                                       00450000
       OBJECT-COMPUTER. IBM-3090.                                       00460000
                                                                        00470000
       INPUT-OUTPUT SECTION.                                            00480000
                                                                        00490000
       FILE-CONTROL.                                                    00500000
                                                                        00510000
           SELECT BP13KD10 ASSIGN TO BP13KD10                           00520000
                  ACCESS MODE     IS DYNAMIC                            00530000
                  ORGANIZATION    IS INDEXED                            00540000
                  RECORD KEY      IS KD10-KEY-FLD                       00550000
                  FILE STATUS     IS WS-KD10-STATUS.                    00560000
                                                                        00570000
           SELECT SY08K010 ASSIGN TO SY08K010                           00580000
                  ACCESS MODE     IS RANDOM                             00590000
                  ORGANIZATION    IS INDEXED                            00600000
                  RECORD KEY      IS K010-NUM-USERID                    00610000
                  ALTERNATE KEY   IS K010-NUM-LOTUS-NCKNM               00620000
                  FILE STATUS     IS WS-K010-STATUS.                    00630000
                                                                        00640000
           SELECT AG07F630   ASSIGN       TO AG07F630.                  00650000
                                                                        00660000
           SELECT P13FD10A   ASSIGN       TO P13FD10A.                  00670000
                                                                        00680000
           SELECT P13FD10B   ASSIGN       TO P13FD10B.                  00690000
                                                                        00700000
           SELECT BP13F125   ASSIGN       TO BP13F125.                  00710000
                                                                        00720000
           SELECT BP13LB0C   ASSIGN       TO BP13LB0C.                  00730000
                                                                        00740000
       DATA DIVISION.                                                   00750000
                                                                        00760000
       FILE SECTION.                                                    00770000
                                                                        00780000
       FD   BP13KD10                                                    00790000
            RECORD CONTAINS  1400 CHARACTERS.                           00800000
       COPY BP13KD10.                                                   00810000
                                                                        00820000
       FD  SY08K010                                                     00830000
           RECORD CONTAINS 100 CHARACTERS.                              00840000
       COPY SY08K010.                                                   00850000
                                                                        00860000
       FD   AG07F630                                                    00870000
            BLOCK CONTAINS     0 RECORDS                                00880000
            RECORD CONTAINS  130 CHARACTERS                             00890000
            LABEL RECORD IS STANDARD                                    00900000
            RECORDING MODE IS F.                                        00910000
       COPY AG07F630.                                                   00920000
                                                                        00930000
       FD   P13FD10A                                                    00940000
            BLOCK CONTAINS     0 RECORDS                                00950000
            RECORD CONTAINS  1400 CHARACTERS                            00960000
            LABEL RECORD IS STANDARD                                    00970000
            RECORDING MODE IS F.                                        00980000
       COPY BP13FD10.                                                   00990000
                                                                        01000000
       FD   P13FD10B                                                    01010000
            BLOCK CONTAINS     0 RECORDS                                01020000
            RECORD CONTAINS  1400 CHARACTERS                            01030000
            LABEL RECORD IS STANDARD                                    01040000
            RECORDING MODE IS F.                                        01050000
       01   WS-BP13FD10-REC       PIC X(1400).                          01060000
                                                                        01070000
       FD   BP13F125                                                    01080000
            BLOCK CONTAINS     0 RECORDS                                01090000
            RECORD CONTAINS  150 CHARACTERS                             01100000
            LABEL RECORD IS STANDARD                                    01110000
            RECORDING MODE IS F.                                        01120000
       COPY BP13F125.                                                   01130000
                                                                        01140000
       FD   BP13LB0C                                                    01150000
            RECORD CONTAINS   132 CHARACTERS                            01160000
            LABEL RECORDS ARE OMITTED                                   01170000
            RECORDING MODE IS F.                                        01180000
       01   PRINT-REC             PIC X(132).                           01190000
                                                                        01200000
      *************************                                         01210000
       WORKING-STORAGE SECTION.                                         01220000
      *************************                                         01230000
                                                                        01240000
       01  WS-AMT-RECEIPT         PIC S9(7)V99 VALUE ZEROES.            01250000
       01  WS-NRIC                PIC X(09) VALUE SPACES.               01260000
       01  WS-NUM-GRANT           PIC X(03) VALUE SPACES.               01270000
       01  WS-CTR                 PIC 9(02) VALUE ZEROES.               01280000
       01  WS-NUM-CPF-PAYEE       PIC X(09) VALUE SPACES.               01290000
       01  CNT-F125-WRITE         PIC 9(05) VALUE ZEROES.               01300000
       01  CNT-F630-READ          PIC 9(05) VALUE ZEROES.               01310000
       01  CNT-FD10-WRITE         PIC 9(05) VALUE ZEROES.               01320000
       01  CNT-KD10-READ          PIC 9(05) VALUE ZEROES.               01330000
       01  CNT-FD10-READ          PIC 9(05) VALUE ZEROES.               01340000
       01  CNT-KD10-DELETE        PIC 9(05) VALUE ZEROES.               01350000
       01  CNT-ASMNT-UPD          PIC 9(05) VALUE ZEROES.               01360000
       01  WS-INBOX-DELETE        PIC 9(05) VALUE ZEROES.               01370000
       01  CNT-LINE-ON-PAGE       PIC 9(05) VALUE ZEROES.               01380000
       01  CNT-PRT-CASES          PIC 9(05) VALUE ZEROES.               01390000
       01  CNT-PAGE               PIC 9(05) VALUE ZEROES.               01400000
       01  WS-EX-GRANT-INS        PIC 9(05) VALUE ZEROES.               01410000
       01  WS-EX-PRSN-INS         PIC 9(05) VALUE ZEROES.               01420000
       01  WS-RCVRY-INS           PIC 9(05) VALUE ZEROES.               01430000
       01  WS-GRANT-DELETE        PIC 9(05) VALUE ZEROES.               01440000
       01  WS-PERSON-DELETE       PIC 9(05) VALUE ZEROES.               01450000
       01  WS-MATCH-REC           PIC 9(05) VALUE ZEROES.               01460000
       01  WS-GRNT-UPD-LOG        PIC 9(05) VALUE ZEROES.               01470000
       01  WS-F630-EOF            PIC X     VALUE SPACE.                01480000
       01  WS-FD10-EOF            PIC X     VALUE SPACE.                01490000
       01  WS-CURSOR-EOF          PIC X     VALUE SPACE.                01500000
       01  WS-K010-STATUS         PIC 9(02) VALUE ZEROES.               01510000
       01  WS-KD10-STATUS         PIC 9(02) VALUE ZEROES.               01520000
       01  WS-KD10-REGN-FND       PIC X     VALUE SPACE.                01530000
       01  WS-GRANT-ASMNT-FND     PIC X     VALUE SPACE.                01540000
       01  WS-ASMNT-UPDATED       PIC X     VALUE SPACE.                01550000
       01  WS-VOUCHER-NOTFND      PIC X     VALUE SPACE.                01560000
       01  WS-DATE                PIC X(08) VALUE SPACES.               01570000
       01  WS-TIMESTAMP           PIC X(26) VALUE SPACES.               01580000
       01  WS-TIMESTAMP-LOG       PIC X(26) VALUE SPACES.               01590000
       01  WS-SQLCODE             PIC ---9.                             01600000
       01  WS-RETURN-CODE         PIC 9(02) VALUE ZEROES.               01610000
       01  WS-DTE-CCYYMMDD.                                             01620000
           05 WS-DTE-CCYY                   PIC X(04) VALUE SPACES.     01630000
           05 WS-DTE-MM                     PIC X(02) VALUE SPACES.     01640000
           05 WS-DTE-DD                     PIC X(02) VALUE SPACES.     01650000
       01  WS-TIME-HHMMSS.                                              01660000
           05 WS-TIME-HH                    PIC X(02) VALUE SPACES.     01670000
           05 WS-TIME-MM                    PIC X(02) VALUE SPACES.     01680000
           05 WS-TIME-SS                    PIC X(02) VALUE SPACES.     01690000
           05 WS-TIME-MS                    PIC X(02) VALUE SPACES.     01700000
                                                                        01710000
       01  WS-SCHEDULE-NO.                                              01720000
           05  WS-SCHEDULE-NUM    PIC X(08).                            01730000
           05  WS-DOC-NO          PIC X(06).                            01740000
                                                                        01750000
       01  WS-LOG-VARIABLE.                                             01760000
           05  WS-BEFORE-IMAGE        PIC X(600).                       01770000
           05  WS-AFTER-IMAGE         PIC X(600).                       01780000
           05  WS-SOURCE              PIC X(30).                        01790000
           05  WS-RGSTRN              PIC X(8).                         01800000
           05  WS-ACTION              PIC X(1).                         01810000
           05  WS-GRNT-TYPE           PIC X(6).                         01820000
                                                                        01830000
       01  WS-SQL-STATUS.                                               01840000
           05 WS-SQL-OK                PIC S9(03) VALUE +000.           01850000
           05 WS-SQL-NFND              PIC S9(03) VALUE +100.           01860000
           05 WS-SQL-DUPREC            PIC S9(03) VALUE -803.           01870000
                                                                        01880000
       01  LB0C-PR-HEAD-01.                                             01890000
           05  FILLER             PIC X(08) VALUE 'BP13LB0C'.           01900000
           05  FILLER             PIC X(05) VALUE SPACES.               01910000
           05  FILLER             PIC X(08) VALUE 'HDBCAT 3'.           01920000
           05  FILLER             PIC X(24) VALUE SPACES.               01930000
           05  FILLER             PIC X(39) VALUE                       01940000
               'S Y S T E M   O F   C O M M I T M E N T'.               01950000
           05  FILLER             PIC X(17) VALUE SPACES.               01960000
           05  FILLER             PIC X(06) VALUE 'DATE: '.             01970000
           05  LB0C-DATE          PIC X(10).                            01980000
           05  FILLER             PIC X(03) VALUE SPACES.               01990000
           05  FILLER             PIC X(06) VALUE 'PAGE :'.             02000000
           05  LB0C-PAGE          PIC ZZ9 .                             02010000
                                                                        02020000
       01  LB0C-PR-HEAD-02.                                             02030000
           05  FILLER             PIC X(40) VALUE SPACES.               02040000
           05  FILLER             PIC X(47) VALUE                       02050000
               '  LIST OF TRANSACTIONS PASSED FROM VOUCHER FILE'.       02060000
           05  FILLER             PIC X(33) VALUE SPACES.               02070000
                                                                        02080000
       01  LB0C-PR-HEAD-03.                                             02090000
           05  FILLER             PIC X(24)                             02100000
                  VALUE '    S/NO  VOUCHER NO'.                         02110000
           05  FILLER             PIC X(43)                             02120000
                  VALUE 'REGN NO        AMOUNT       RECEIPT NO'.       02130000
           05  FILLER             PIC X(42)                             02140000
                  VALUE 'PAYMT RELEASE DTE     PAYMT TYPE'.             02150000
           05  FILLER             PIC X(06)                             02160000
                  VALUE 'REMARK'.                                       02170000
           05  FILLER             PIC X(17) VALUE SPACES.               02180000
                                                                        02190000
       01  LB0C-PR-DETAILS.                                             02200000
           05  FILLER             PIC X(01) VALUE SPACES.               02210000
           05  LB0C-SNO           PIC ZZZZZ9 .                          02220000
           05  FILLER             PIC X(03) VALUE SPACES.               02230000
           05  LB0C-VOUCHER-NO    PIC X(11).                            02240000
           05  FILLER             PIC X(03) VALUE SPACES.               02250000
           05  LB0C-REG-NO        PIC X(08).                            02260000
           05  FILLER             PIC X(03) VALUE SPACES.               02270000
           05  LB0C-AMT           PIC $$$$$$$9.99DB.                    02280000
           05  FILLER             PIC X(02) VALUE SPACES.               02290000
           05  LB0C-NUM-RECEIPT   PIC X(14).                            02300000
           05  FILLER             PIC X(08) VALUE SPACES.               02310000
           05  LB0C-DTE-POST      PIC X(08).                            02320000
           05  FILLER             PIC X(09) VALUE SPACES.               02330000
           05  LB0C-PAYMENT-TYPE  PIC X(09).                            02340000
           05  FILLER             PIC X(08) VALUE SPACES.               02350000
           05  LB0C-REMARK        PIC X(20).                            02360000
                                                                        02370000
       COPY BE08W001.                                                   02380000
                                                                        02390000
      *--------------------------------------------------------------*  02400000
      *                          SQLCA                               *  02410000
      *--------------------------------------------------------------*  02420000
           EXEC SQL INCLUDE SQLCA          END-EXEC.                    02430000
           EXEC SQL INCLUDE P13VGASM       END-EXEC.                    02440000
           EXEC SQL INCLUDE P13VGAPN       END-EXEC.                    02450000
           EXEC SQL INCLUDE P13VGRCV       END-EXEC.                    02460000
           EXEC SQL INCLUDE P13VGXAP       END-EXEC.                    02470000
           EXEC SQL INCLUDE P13VGXAS       END-EXEC.                    02480000
           EXEC SQL INCLUDE P13VGUPD       END-EXEC.                    02490000
                                                                        02500000
      ********************                                              02510000
       PROCEDURE DIVISION.                                              02520000
      ********************                                              02530000
                                                                        02540000
      *----------*                                                      02550000
       0000-MAIN.                                                       02560000
      *----------*                                                      02570000
                                                                        02580000
           PERFORM 1000-OPEN-FILES   THRU 1000-EXIT.                    02590000
           PERFORM 2000-READ-F630    THRU 2000-EXIT.                    02600000
           PERFORM 2100-READ-FD10    THRU 2100-EXIT.                    02610000
           PERFORM 3000-PROCESS-REC  THRU 3000-EXIT                     02620000
                   UNTIL WS-F630-EOF = 'Y'.                             02630000
           PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT.                    02640000
                                                                        02650000
       0000-EXIT.                                                       02660000
           EXIT.                                                        02670000
                                                                        02680000
      *----------------*                                                02690000
       1000-OPEN-FILES.                                                 02700000
      *----------------*                                                02710000
                                                                        02720000
           OPEN INPUT  AG07F630                                         02730000
                       P13FD10A                                         02740000
                       SY08K010                                         02750000
                I-O    BP13KD10                                         02760000
                OUTPUT BP13F125                                         02770000
                       BP13LB0C                                         02780000
                       P13FD10B.                                        02790000
                                                                        02800000
           IF WS-KD10-STATUS NOT = 0 AND 97                             02810000
              DISPLAY 'ERROR OPENING - BP13KD10 : ' WS-KD10-STATUS      02820000
              MOVE WS-KD10-STATUS TO RETURN-CODE                        02830000
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                   02840000
           END-IF.                                                      02850000
                                                                        02860000
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                       02870000
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)        02880000
              DELIMITED BY SIZE INTO LB0C-DATE.                         02890000
                                                                        02900000
           ACCEPT WS-DTE-CCYYMMDD   FROM   DATE YYYYMMDD.               02910000
           ACCEPT WS-TIME-HHMMSS    FROM   TIME.                        02920000
                                                                        02930000
           PERFORM 1500-SET-DB2-TIMESTAMP THRU 1500-EXIT.               02940000
                                                                        02950000
       1000-EXIT.                                                       02960000
           EXIT.                                                        02970000
                                                                        02980000
      *----------------------------------------------------------------*02990000
       1500-SET-DB2-TIMESTAMP.                                          03000000
      *----------------------------------------------------------------*03010000
            EXEC SQL                                                    03020000
                 SET :WS-TIMESTAMP = CURRENT TIMESTAMP                  03030000
            END-EXEC.                                                   03040000
            IF SQLCODE NOT = 000                                        03050000
               MOVE SQLCODE          TO WS-SQLCODE                      03060000
               DISPLAY 'SQL ERROR SET DB2 TIMESTAMP'                    03070000
               DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE                 03080000
               PERFORM 9999-SQL-ERROR THRU 9999-EXIT                    03090000
            END-IF.                                                     03100000
                                                                        03110000
       1500-EXIT.                                                       03120000
           EXIT.                                                        03130000
                                                                        03140000
      *---------------*                                                 03150000
       2000-READ-F630.                                                  03160000
      *---------------*                                                 03170000
                                                                        03180000
           READ AG07F630 AT END                                         03190000
                MOVE HIGH-VALUES TO AG07F630-REC                        03200000
                MOVE 'Y' TO WS-F630-EOF                                 03210000
                GO TO 2000-EXIT.                                        03220000
           ADD 1 TO CNT-F630-READ.                                      03230000
                                                                        03240000
       2000-EXIT.                                                       03250000
           EXIT.                                                        03260000
                                                                        03270000
      *---------------*                                                 03280000
       2100-READ-FD10.                                                  03290000
      *---------------*                                                 03300000
                                                                        03310000
           READ P13FD10A AT END                                         03320000
                MOVE HIGH-VALUES TO BP13FD10-REC                        03330000
                MOVE 'Y' TO WS-FD10-EOF                                 03340000
                GO TO 2100-EXIT.                                        03350000
           ADD 1 TO CNT-FD10-READ.                                      03360000
                                                                        03370000
       2100-EXIT.                                                       03380000
           EXIT.                                                        03390000
                                                                        03400000
      *-----------------*                                               03410000
       3000-PROCESS-REC.                                                03420000
      *-----------------*                                               03430000
                                                                        03440000
           IF F630-NUM-VR = FD10-NUM-VR                                 03450000
              ADD  1                    TO WS-MATCH-REC                 03460000
              PERFORM 3100-PROCESS-REC  THRU 3100-EXIT                  03470000
              MOVE SPACES               TO LB0C-PR-DETAILS              03480000
                                           LB0C-REMARK                  03490000
              PERFORM 6000-PRINT-REPORT THRU 6000-EXIT                  03500000
              PERFORM 2000-READ-F630    THRU 2000-EXIT                  03510000
              PERFORM 2100-READ-FD10    THRU 2100-EXIT                  03520000
           ELSE                                                         03530000
              IF F630-NUM-VR > FD10-NUM-VR                              03540000
                 PERFORM 2100-READ-FD10    THRU 2100-EXIT               03550000
              ELSE                                                      03560000
                 MOVE SPACES   TO LB0C-PR-DETAILS                       03570000
                                  LB0C-REMARK                           03580000
                                  BP13KD10-REC                          03590000
                 INITIALIZE       BP13KD10-REC                          03600000
                 MOVE 'REVERSAL VRNO NTFND'    TO LB0C-REMARK           03610000
                 MOVE 'Y'      TO WS-VOUCHER-NOTFND                     03620000
                 PERFORM 6000-PRINT-REPORT THRU 6000-EXIT               03630000
                 PERFORM 2000-READ-F630    THRU 2000-EXIT               03640000
              END-IF                                                    03650000
           END-IF.                                                      03660000
                                                                        03670000
       3000-EXIT.                                                       03680000
           EXIT.                                                        03690000
                                                                        03700000
      *-----------------*                                               03710000
       3100-PROCESS-REC.                                                03720000
      *-----------------*                                               03730000
                                                                        03740000
           IF FD10-NUM-TRANS = 'ASR'                                    03750000
              MOVE 'AHG' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT            03760000
                            NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON     03770000
              PERFORM 4100-READ-GRANT-ASMNT THRU 4100-EXIT              03780000
              IF WS-GRANT-ASMNT-FND = 'Y'                               03790000
                 PERFORM 4000-UPDATE-GRANT-ASMNT THRU 4000-EXIT         03800000
                 IF WS-ASMNT-UPDATED = 'Y'                              03810000
                    PERFORM 4200-INSERT-TO-EX-GRANT THRU 4200-EXIT      03820000
                    PERFORM 4300-DELETE-GRANT-ASMNT THRU 4300-EXIT      03830000
                    PERFORM 5000-PROCESS-PERSON     THRU 5000-EXIT      03840000
                 END-IF                                                 03850000
              END-IF                                                    03860000
              MOVE 'SHG' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT            03870000
                            NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON     03880000
              PERFORM 4100-READ-GRANT-ASMNT THRU 4100-EXIT              03890000
              IF WS-GRANT-ASMNT-FND = 'Y'                               03900000
                 PERFORM 4000-UPDATE-GRANT-ASMNT THRU 4000-EXIT         03910000
                 IF WS-ASMNT-UPDATED = 'Y'                              03920000
                    PERFORM 4200-INSERT-TO-EX-GRANT THRU 4200-EXIT      03930000
                    PERFORM 4300-DELETE-GRANT-ASMNT THRU 4300-EXIT      03940000
                    PERFORM 5000-PROCESS-PERSON     THRU 5000-EXIT      03950000
                 END-IF                                                 03960000
              END-IF                                                    03970000
           ELSE                                                         03980000
              PERFORM 4100-READ-GRANT-ASMNT THRU 4100-EXIT              03990000
              IF WS-GRANT-ASMNT-FND = 'Y'                               04000000
                 PERFORM 4000-UPDATE-GRANT-ASMNT THRU 4000-EXIT         04010000
                 IF WS-ASMNT-UPDATED = 'Y'                              04020000
                    PERFORM 4200-INSERT-TO-EX-GRANT THRU 4200-EXIT      04030000
                    PERFORM 4300-DELETE-GRANT-ASMNT THRU 4300-EXIT      04040000
                    PERFORM 5000-PROCESS-PERSON     THRU 5000-EXIT      04050000
                 END-IF                                                 04060000
              END-IF                                                    04070000
           END-IF                                                       04080000
           PERFORM 3150-PROCESS-KD10  THRU 3150-EXIT.                   04090000
           IF FD10-NUM-TRANS = 'SRR'                                    04100000
              PERFORM 7000-DELETE-INTRAY THRU 7000-EXIT.                04110000
                                                                        04120000
       3100-EXIT.                                                       04130000
           EXIT.                                                        04140000
                                                                        04150000
      *-------------------*                                             04160000
       3150-PROCESS-KD10.                                               04170000
      *-------------------*                                             04180000
                                                                        04190000
      * MOVE REVERSAL TO FINANCIAL HISTORY AND DELETE FROM KD10         04200000
           MOVE SPACES                   TO KD10-KEY-FLD.               04210000
           MOVE FD10-NUM-TRANS           TO KD10-NUM-TRANS.             04220000
           MOVE FD10-NUM-REGN            TO KD10-NUM-REGN.              04230000
           PERFORM 3200-READ-BP13KD10    THRU 3200-EXIT.                04240000
           IF WS-KD10-REGN-FND = 'Y'                                    04250000
              MOVE FD10-NUM-OIC          TO KD10-NUM-OIC                04260000
              MOVE SPACES                TO WS-BP13FD10-REC             04270000
              MOVE BP13KD10-REC          TO WS-BP13FD10-REC             04280000
              WRITE WS-BP13FD10-REC                                     04290000
              ADD 1                      TO CNT-FD10-WRITE              04300000
              PERFORM 3160-MOVE-TO-F125  THRU 3160-EXIT                 04310000
              PERFORM 3170-DELETE-KD10   THRU 3170-EXIT                 04320000
                                                                        04330000
      * DELETE NON-REVERSAL FROM KD10                                   04340000
              MOVE SPACES                TO KD10-KEY-FLD                04350000
              EVALUATE FD10-NUM-TRANS                                   04360000
               WHEN 'SRR'                                               04370000
                 MOVE 'SRG   ' TO KD10-NUM-TRANS                        04380000
               WHEN 'RER'                                               04390000
                 MOVE 'REG   ' TO KD10-NUM-TRANS                        04400000
               WHEN 'FSR'                                               04410000
                 MOVE 'FSG   ' TO KD10-NUM-TRANS                        04420000
               WHEN 'ASR'                                               04430000
                 MOVE 'ASG   ' TO KD10-NUM-TRANS                        04440000
               WHEN 'SUR'                                               04450000
                 MOVE 'SUG   ' TO KD10-NUM-TRANS                        04460000
               WHEN 'PHR'                                               04470000
                 MOVE 'PHG   ' TO KD10-NUM-TRANS                        04480000
               WHEN 'AHR'                                               04490000
                 MOVE 'AHG   ' TO KD10-NUM-TRANS                        04500000
               WHEN 'HGR'                                               04510000
                 MOVE 'HGT   ' TO KD10-NUM-TRANS                        04520000
               WHEN 'TUR'                                               04530000
                 MOVE 'TUG   ' TO KD10-NUM-TRANS                        04540000
               WHEN 'ATR'                                               04550000
                 MOVE 'ATG   ' TO KD10-NUM-TRANS                        04560000
               WHEN 'EHR'                                               04561000
                 MOVE 'EHG   ' TO KD10-NUM-TRANS                        04562000
              END-EVALUATE                                              04570000
              MOVE FD10-NUM-REGN         TO KD10-NUM-REGN               04580000
              PERFORM 3200-READ-BP13KD10 THRU 3200-EXIT                 04590000
              IF WS-KD10-REGN-FND = 'Y'                                 04600000
                 PERFORM 3170-DELETE-KD10   THRU 3170-EXIT              04610000
              END-IF                                                    04620000
           END-IF.                                                      04630000
                                                                        04640000
       3150-EXIT.                                                       04650000
           EXIT.                                                        04660000
                                                                        04670000
      *-------------------*                                             04680000
       3160-MOVE-TO-F125.                                               04690000
      *-------------------*                                             04700000
           IF FD10-NUM-TRANS = 'ASR'                                    04710000
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 16      04720000
               IF KD10-NUM-VOUCH-CR-DR(WS-CTR) = 'C'                    04730000
                  IF KD10-NUM-VOUCH-GL(WS-CTR) = '0407600403488' OR     04740000
                                                 '8407600408785' OR     04750000
                                                 '0407000573488'        04760000
                     MOVE 'AHG'                  TO WS-NUM-GRANT        04770000
                  END-IF                                                04780000
                  IF KD10-NUM-VOUCH-GL(WS-CTR) = '0407000403488' OR     04790000
                                                 '8407000408785' OR     04800000
                                                 '0407800573488'        04810000
                     MOVE 'SHG'                  TO WS-NUM-GRANT        04820000
                  END-IF                                                04830000
                  MOVE KD10-NUM-VOUCH-NRIC(WS-CTR) TO WS-NRIC           04840000
                                                     WS-NUM-CPF-PAYEE   04850000
                  MOVE KD10-AMT-VOUCH(WS-CTR)    TO WS-AMT-RECEIPT      04860000
                  PERFORM 3300-WRITE-TO-BP13F125   THRU 3300-EXIT       04870000
                  MOVE SPACES TO WS-NRIC                                04880000
               END-IF                                                   04890000
              END-PERFORM                                               04900000
           ELSE                                                         04910000
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 4       04920000
                 IF KD10-NUM-CPF-PAYEE(WS-CTR) NOT = SPACES             04930000
                                               AND LOW-VALUES           04940000
                                               AND ZEROES               04950000
                    MOVE KD10-NUM-GRANT(WS-CTR)     TO WS-NUM-GRANT     04960000
                    MOVE KD10-NUM-CPF-PAYEE(WS-CTR) TO WS-NRIC          04970000
                    MOVE KD10-NUM-CPF-PAYEE(WS-CTR) TO WS-NUM-CPF-PAYEE 04980000
                    MOVE ZEROES                     TO WS-AMT-RECEIPT   04990000
                    IF KD10-AMT-CPF-GRANT-PAYEE(WS-CTR) IS NUMERIC      05000000
                       MOVE KD10-AMT-CPF-GRANT-PAYEE(WS-CTR)            05010000
                                                    TO WS-AMT-RECEIPT   05020000
                    ELSE                                                05030000
                       MOVE ZEROES                  TO WS-AMT-RECEIPT   05040000
                    END-IF                                              05050000
                    PERFORM 3300-WRITE-TO-BP13F125   THRU 3300-EXIT     05060000
                    MOVE SPACES TO WS-NRIC                              05070000
                 END-IF                                                 05080000
              END-PERFORM                                               05090000
           END-IF.                                                      05100000
                                                                        05110000
       3160-EXIT.                                                       05120000
           EXIT.                                                        05130000
                                                                        05140000
      *---------------------*                                           05150000
       3170-DELETE-KD10.                                                05160000
      *---------------------*                                           05170000
                                                                        05180000
           DELETE BP13KD10.                                             05190000
                                                                        05200000
           EVALUATE WS-KD10-STATUS                                      05210000
               WHEN 00                                                  05220000
                    ADD 1 TO CNT-KD10-DELETE                            05230000
               WHEN OTHER                                               05240000
                    DISPLAY 'ERROR DELETING BP13KD10-REC ...'           05250000
                    MOVE WS-KD10-STATUS TO RETURN-CODE                  05260000
                    PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT            05270000
           END-EVALUATE.                                                05280000
                                                                        05290000
       3170-EXIT.                                                       05300000
           EXIT.                                                        05310000
                                                                        05320000
      *-------------------*                                             05330000
       3200-READ-BP13KD10.                                              05340000
      *-------------------*                                             05350000
                                                                        05360000
           READ BP13KD10.                                               05370000
           IF WS-KD10-STATUS = 0                                        05380000
              MOVE 'Y'    TO WS-KD10-REGN-FND                           05390000
              ADD 1       TO CNT-KD10-READ                              05400000
           ELSE                                                         05410000
              IF WS-KD10-STATUS = 23                                    05420000
                 MOVE 'N' TO WS-KD10-REGN-FND                           05430000
                 DISPLAY 'REGNO NOT FOUND IN BP13KD10 : ' KD10-NUM-REGN 05440000
                 MOVE WS-KD10-STATUS      TO RETURN-CODE                05450000
              ELSE                                                      05460000
                 DISPLAY 'ERROR READING - BP13KD10 : ' WS-KD10-STATUS   05470000
                 MOVE WS-KD10-STATUS      TO RETURN-CODE                05480000
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                05490000
              END-IF                                                    05500000
           END-IF.                                                      05510000
                                                                        05520000
       3200-EXIT.                                                       05530000
           EXIT.                                                        05540000
                                                                        05550000
      *------------------------*                                        05560000
       3300-WRITE-TO-BP13F125.                                          05570000
      *------------------------*                                        05580000
                                                                        05590000
           MOVE SPACES              TO BP13F125-CASHTRAN.               05600000
                                                                        05610000
           MOVE '35'                TO F125-CDE-TRANS-TYPE.             05620000
                                                                        05630000
           COMPUTE WS-AMT-RECEIPT = WS-AMT-RECEIPT * -1.                05640000
           MOVE WS-AMT-RECEIPT      TO F125-AMT-RECEIPT.                05650000
           MOVE FD10-NUM-REGN       TO F125-NUM-REGN.                   05660000
                                                                        05670000
           EVALUATE WS-NUM-GRANT                                        05680000
            WHEN 'SRR'                                                  05690000
              MOVE 'SRG'            TO F125-CDE-PAYMENT-TYPE            05700000
            WHEN 'RER'                                                  05710000
              MOVE 'REG'            TO F125-CDE-PAYMENT-TYPE            05720000
            WHEN 'FSR'                                                  05730000
              MOVE 'FSG'            TO F125-CDE-PAYMENT-TYPE            05740000
            WHEN 'SUR'                                                  05750000
              MOVE 'SUG'            TO F125-CDE-PAYMENT-TYPE            05760000
            WHEN 'PHR'                                                  05770000
              MOVE 'PHG'            TO F125-CDE-PAYMENT-TYPE            05780000
            WHEN 'AHR'                                                  05790000
              MOVE 'AHG'            TO F125-CDE-PAYMENT-TYPE            05800000
            WHEN 'HGR'                                                  05810000
              MOVE 'HGT'            TO F125-CDE-PAYMENT-TYPE            05820000
            WHEN 'TUR'                                                  05830000
              MOVE 'TUG'            TO F125-CDE-PAYMENT-TYPE            05840000
            WHEN 'ATR'                                                  05850000
              MOVE 'ATG'            TO F125-CDE-PAYMENT-TYPE            05860000
            WHEN 'EHR'                                                  05861000
              MOVE 'EHG'            TO F125-CDE-PAYMENT-TYPE            05862000
            WHEN OTHER                                                  05870000
              MOVE WS-NUM-GRANT     TO F125-CDE-PAYMENT-TYPE            05880000
           END-EVALUATE.                                                05890000
                                                                        05900000
           MOVE WS-NRIC             TO F125-NUM-NRIC.                   05910000
           MOVE SPACES              TO F125-NME-NAME.                   05920000
           MOVE WS-NUM-CPF-PAYEE    TO F125-CDE-CPF-APPL.               05930000
           MOVE F630-NUM-BATCH      TO WS-SCHEDULE-NUM.                 05940000
           MOVE F630-NUM-VR-SERIAL  TO WS-DOC-NO.                       05950000
           MOVE WS-SCHEDULE-NO      TO F125-NUM-RECPT-JRNO.             05960000
           MOVE F630-NUM-VR-DDD     TO F125-NUM-VR-DDD.                 05970000
           MOVE F630-NUM-VR-YY      TO F125-NUM-VR-YY.                  05980000
           MOVE F630-DTE-TRANS      TO F125-DTE-TRANS                   05990000
                                       F125-DTE-POST.                   06000000
           MOVE SPACES              TO F125-CDE-APPLT-CPF.              06010000
           MOVE ZERO                TO F125-COUNT-HISTORY.              06020000
                                                                        06030000
           WRITE BP13F125-CASHTRAN.                                     06040000
           ADD 1       TO CNT-F125-WRITE.                               06050000
                                                                        06060000
       3300-EXIT.                                                       06070000
           EXIT.                                                        06080000
                                                                        06090000
      *----------------------*                                          06100000
       4000-UPDATE-GRANT-ASMNT.                                         06110000
      *----------------------*                                          06120000
           MOVE DCLGRANT-ASMNT TO WS-BEFORE-IMAGE.                      06130000
           MOVE FD10-NUM-REGN      TO NUM-RGSTRN OF DCLGRANT-ASMNT.     06140000
                                                                        06150000
           EVALUATE FD10-NUM-TRANS                                      06160000
            WHEN 'SRR'                                                  06170000
              MOVE 'SRG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06180000
            WHEN 'RER'                                                  06190000
              MOVE 'REG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06200000
            WHEN 'FSR'                                                  06210000
              MOVE 'FSG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06220000
            WHEN 'SUR'                                                  06230000
              MOVE 'SUG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06240000
            WHEN 'PHR'                                                  06250000
              MOVE 'PHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06260000
            WHEN 'AHR'                                                  06270000
              MOVE 'AHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06280000
            WHEN 'HGR'                                                  06290000
              MOVE 'HGT   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06300000
            WHEN 'TUR'                                                  06310000
              MOVE 'TUG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06320000
            WHEN 'ATR'                                                  06330000
              MOVE 'ATG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06340000
            WHEN 'EHR'                                                  06341000
              MOVE 'EHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         06342000
           END-EVALUATE.                                                06350000
                                                                        06360000
           MOVE 'JVR'       TO TXT-CNCLTN-REASON OF DCLGRANT-ASMNT.     06370000
           MOVE 'BP13CB0C ' TO NUM-UPDATE-USERID OF DCLGRANT-ASMNT.     06380000
                                                                        06390000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              06400000
                  WS-DTE-CCYYMMDD(5:2) '-'                              06410000
                  WS-DTE-CCYYMMDD(7:2)                                  06420000
                  DELIMITED BY SIZE INTO DTE-UPDATE OF DCLGRANT-ASMNT.  06430000
                                                                        06440000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              06450000
                  WS-DTE-CCYYMMDD(5:2) '-'                              06460000
                  WS-DTE-CCYYMMDD(7:2)                                  06470000
                  DELIMITED BY SIZE INTO DTE-CANCEL OF DCLGRANT-ASMNT.  06480000
                                                                        06490000
           STRING WS-TIME-HHMMSS(1:2) '.'                               06500000
                  WS-TIME-HHMMSS(3:2) '.'                               06510000
                  WS-TIME-HHMMSS(5:2)                                   06520000
                  DELIMITED BY SIZE INTO TME-UPDATE OF DCLGRANT-ASMNT.  06530000
                                                                        06540000
           EXEC SQL                                                     06550000
              UPDATE GRANT_ASMNT                                        06560000
              SET TXT_CNCLTN_REASON = :DCLGRANT-ASMNT.TXT-CNCLTN-REASON,06570000
                  NUM_UPDATE_USERID = :DCLGRANT-ASMNT.NUM-UPDATE-USERID,06580000
                  TME_UPDATE        = :DCLGRANT-ASMNT.TME-UPDATE,       06590000
                  DTE_UPDATE        = :DCLGRANT-ASMNT.DTE-UPDATE,       06600000
                  DTE_CANCEL        = :DCLGRANT-ASMNT.DTE-CANCEL        06610000
              WHERE NUM_RGSTRN      = :DCLGRANT-ASMNT.NUM-RGSTRN        06620000
               AND  NUM_GRANT_TYPE  = :DCLGRANT-ASMNT.NUM-GRANT-TYPE    06630000
           END-EXEC.                                                    06640000
                                                                        06650000
           EVALUATE SQLCODE                                             06660000
           WHEN WS-SQL-OK                                               06670000
                ADD 1          TO CNT-ASMNT-UPD                         06680000
                MOVE 'Y' TO WS-ASMNT-UPDATED                            06690000
                MOVE 'GRANT_ASMNT'  TO WS-SOURCE                        06700000
                MOVE 'U'            TO WS-ACTION                        06710000
                MOVE NUM-RGSTRN OF DCLGRANT-ASMNT     TO WS-RGSTRN      06720000
                MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT TO WS-GRNT-TYPE   06730000
                MOVE DCLGRANT-ASMNT TO WS-AFTER-IMAGE                   06740000
                PERFORM 6400-INSERT-TO-LOG     THRU 6400-EXIT           06750000
           WHEN WS-SQL-NFND                                             06760000
                MOVE 'N' TO WS-ASMNT-UPDATED                            06770000
                MOVE SQLCODE   TO WS-SQLCODE                            06780000
                DISPLAY 'CASE NOTFND IN GRANT_ASMNT'                    06790000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE ' '                  06800000
                        'REGNO : ' NUM-RGSTRN OF DCLGRANT-ASMNT ' '     06810000
                        'GRANT TYPE: ' NUM-GRANT-TYPE OF DCLGRANT-ASMNT 06820000
                DISPLAY SPACES                                          06830000
           WHEN OTHER                                                   06840000
                MOVE SQLCODE   TO WS-SQLCODE                            06850000
                DISPLAY 'ERROR UPDATING GRANT_ASMNT'                    06860000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      06870000
                DISPLAY SPACES                                          06880000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              06890000
           END-EVALUATE.                                                06900000
                                                                        06910000
       4000-EXIT.                                                       06920000
           EXIT.                                                        06930000
                                                                        06940000
      *------------------------*                                        06950000
       4100-READ-GRANT-ASMNT.                                           06960000
      *------------------------*                                        06970000
           MOVE 'N' TO WS-GRANT-ASMNT-FND.                              06980000
           MOVE FD10-NUM-REGN    TO NUM-RGSTRN OF DCLGRANT-ASMNT.       06990000
                                                                        07000000
           EVALUATE FD10-NUM-TRANS                                      07010000
            WHEN 'SRR'                                                  07020000
              MOVE 'SRG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07030000
            WHEN 'RER'                                                  07040000
              MOVE 'REG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07050000
            WHEN 'FSR'                                                  07060000
              MOVE 'FSG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07070000
            WHEN 'SUR'                                                  07080000
              MOVE 'SUG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07090000
            WHEN 'PHR'                                                  07100000
              MOVE 'PHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07110000
            WHEN 'AHR'                                                  07120000
              MOVE 'AHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07130000
            WHEN 'HGR'                                                  07140000
              MOVE 'HGT   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07150000
            WHEN 'TUR'                                                  07160000
              MOVE 'TUG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07170000
            WHEN 'ATR'                                                  07180000
              MOVE 'ATG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07190000
            WHEN 'EHR'                                                  07191000
              MOVE 'EHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT         07192000
           END-EVALUATE.                                                07200000
                                                                        07210000
           EXEC SQL                                                     07220000
              SELECT NUM_RGSTRN,                                        07230000
                     NUM_GRANT_TYPE,                                    07240000
                     NUM_ELGBL_GRANT,                                   07250000
                     NUM_GRANT_AMOUNT_ELGBL,                            07260000
                     NUM_GRANT_STATUS,                                  07270000
                     DTE_APRV,                                          07280000
                     DTE_CANCEL,                                        07290000
                     DTE_REJECT,                                        07300000
                     DTE_SUBMIT,                                        07310000
                     DTE_WTHDRW,                                        07320000
                     NUM_RJCTN_REASON,                                  07330000
                     NUM_WTDRWL_REASON,                                 07340000
                     TXT_CNCLTN_REASON,                                 07350000
                     DTE_GRANT_RQST,                                    07360000
                     NUM_GRANT_DOC_RCV,                                 07370000
                     DTE_ACK,                                           07380000
                     DTE_GRANT_FORM_ISSUE,                              07390000
                     DTE_GRANT_OPT_OUT_FORM_ISSUE,                      07400000
                     NUM_GRANT_OPT_OUT_REASON,                          07410000
                     DTE_GRANT_OPT_OUT_REASON,                          07420000
                     NUM_ALCTN_SCHEME,                                  07430000
                     NUM_HSHLD_CTZNSP,                                  07440000
                     NUM_WRKNG_CHILD_ASMNT,                             07450000
                     QTY_MONTH_WORK,                                    07460000
                     NUM_APPEAL_ATCHMT,                                 07470000
                     NUM_PARENT_ADRS_BLDNG,                             07480000
                     NUM_PARENT_ADRS_LEVEL,                             07490000
                     NUM_PARENT_ADRS_UNIT,                              07500000
                     TXT_PARENT_ADRS1,                                  07510000
                     TXT_PARENT_ADRS2,                                  07520000
                     NUM_PARENT_ADRS_POSTAL,                            07530000
                     DTE_PYMNT,                                         07540000
                     DTE_CPF_ACK_GRANT_RCV,                             07550000
                     NUM_GRANT_CREDIT,                                  07560000
                     TME_APNTMT,                                        07570000
                     DTE_APNTMT,                                        07580000
                     TME_CREATE_ASMNT,                                  07590000
                     NUM_UPDATE_USERID,                                 07600000
                     TME_UPDATE,                                        07610000
                     DTE_UPDATE,                                        07620000
                     NUM_SOURCE_SYSTEM,                                 07630000
                     NUM_ACNT,                                          07640000
                     NUM_SCHEME,                                        07650000
                     NUM_TNCY,                                          07660000
                     NUM_HALF_GRANT                                     07670000
              INTO  :DCLGRANT-ASMNT.NUM-RGSTRN,                         07680000
                    :DCLGRANT-ASMNT.NUM-GRANT-TYPE,                     07690000
                    :DCLGRANT-ASMNT.NUM-ELGBL-GRANT,                    07700000
                    :DCLGRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,             07710000
                    :DCLGRANT-ASMNT.NUM-GRANT-STATUS,                   07720000
                    :DCLGRANT-ASMNT.DTE-APRV,                           07730000
                    :DCLGRANT-ASMNT.DTE-CANCEL,                         07740000
                    :DCLGRANT-ASMNT.DTE-REJECT,                         07750000
                    :DCLGRANT-ASMNT.DTE-SUBMIT,                         07760000
                    :DCLGRANT-ASMNT.DTE-WTHDRW,                         07770000
                    :DCLGRANT-ASMNT.NUM-RJCTN-REASON,                   07780000
                    :DCLGRANT-ASMNT.NUM-WTDRWL-REASON,                  07790000
                    :DCLGRANT-ASMNT.TXT-CNCLTN-REASON,                  07800000
                    :DCLGRANT-ASMNT.DTE-GRANT-RQST,                     07810000
                    :DCLGRANT-ASMNT.NUM-GRANT-DOC-RCV,                  07820000
                    :DCLGRANT-ASMNT.DTE-ACK,                            07830000
                    :DCLGRANT-ASMNT.DTE-GRANT-FORM-ISSUE,               07840000
                    :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,       07850000
                    :DCLGRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,           07860000
                    :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,           07870000
                    :DCLGRANT-ASMNT.NUM-ALCTN-SCHEME,                   07880000
                    :DCLGRANT-ASMNT.NUM-HSHLD-CTZNSP,                   07890000
                    :DCLGRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,              07900000
                    :DCLGRANT-ASMNT.QTY-MONTH-WORK,                     07910000
                    :DCLGRANT-ASMNT.NUM-APPEAL-ATCHMT,                  07920000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,              07930000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,              07940000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-UNIT,               07950000
                    :DCLGRANT-ASMNT.TXT-PARENT-ADRS1,                   07960000
                    :DCLGRANT-ASMNT.TXT-PARENT-ADRS2,                   07970000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,             07980000
                    :DCLGRANT-ASMNT.DTE-PYMNT,                          07990000
                    :DCLGRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,              08000000
                    :DCLGRANT-ASMNT.NUM-GRANT-CREDIT,                   08010000
                    :DCLGRANT-ASMNT.TME-APNTMT,                         08020000
                    :DCLGRANT-ASMNT.DTE-APNTMT,                         08030000
                    :DCLGRANT-ASMNT.TME-CREATE-ASMNT,                   08040000
                    :DCLGRANT-ASMNT.NUM-UPDATE-USERID,                  08050000
                    :DCLGRANT-ASMNT.TME-UPDATE,                         08060000
                    :DCLGRANT-ASMNT.DTE-UPDATE,                         08070000
                    :DCLGRANT-ASMNT.NUM-SOURCE-SYSTEM,                  08080000
                    :DCLGRANT-ASMNT.NUM-ACNT,                           08090000
                    :DCLGRANT-ASMNT.NUM-SCHEME,                         08100000
                    :DCLGRANT-ASMNT.NUM-TNCY,                           08110000
                    :DCLGRANT-ASMNT.NUM-HALF-GRANT                      08120000
              FROM                                                      08130000
                GRANT_ASMNT                                             08140000
              WHERE NUM_RGSTRN       = :DCLGRANT-ASMNT.NUM-RGSTRN       08150000
               AND  NUM_GRANT_TYPE   = :DCLGRANT-ASMNT.NUM-GRANT-TYPE   08160000
           END-EXEC.                                                    08170000
                                                                        08180000
           EVALUATE SQLCODE                                             08190000
           WHEN WS-SQL-OK                                               08200000
                MOVE 'Y' TO WS-GRANT-ASMNT-FND                          08210000
           WHEN WS-SQL-NFND                                             08220000
                MOVE SQLCODE   TO WS-SQLCODE                            08230000
                DISPLAY 'CASE NOTFND IN GRANT_ASMNT'                    08240000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      08250000
                DISPLAY 'REGNO : ' NUM-RGSTRN OF DCLGRANT-ASMNT         08260000
                DISPLAY 'GRANT TYPE: ' NUM-GRANT-TYPE OF DCLGRANT-ASMNT 08270000
                DISPLAY SPACES                                          08280000
                                                                        08290000
           WHEN OTHER                                                   08300000
                MOVE SQLCODE   TO WS-SQLCODE                            08310000
                DISPLAY 'ERROR READING GRANT_ASMNT'                     08320000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      08330000
                DISPLAY SPACES                                          08340000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              08350000
           END-EVALUATE.                                                08360000
                                                                        08370000
       4100-EXIT.                                                       08380000
           EXIT.                                                        08390000
                                                                        08400000
      *----------------------*                                          08410000
       4200-INSERT-TO-EX-GRANT.                                         08420000
      *----------------------*                                          08430000
           MOVE NUM-RGSTRN OF DCLGRANT-ASMNT                            08440000
                    TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT.                 08450000
           MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT                        08460000
                    TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT.             08470000
           MOVE NUM-ELGBL-GRANT OF DCLGRANT-ASMNT                       08480000
                    TO NUM-ELGBL-GRANT OF DCLEX-GRANT-ASMNT.            08490000
           MOVE NUM-GRANT-AMOUNT-ELGBL OF DCLGRANT-ASMNT                08500000
                    TO NUM-GRANT-AMOUNT-ELGBL OF DCLEX-GRANT-ASMNT.     08510000
           MOVE NUM-GRANT-STATUS OF DCLGRANT-ASMNT                      08520000
                    TO NUM-GRANT-STATUS OF DCLEX-GRANT-ASMNT.           08530000
           MOVE DTE-APRV OF DCLGRANT-ASMNT                              08540000
                    TO DTE-APRV OF DCLEX-GRANT-ASMNT.                   08550000
           MOVE DTE-CANCEL OF DCLGRANT-ASMNT                            08560000
                    TO DTE-CANCEL OF DCLEX-GRANT-ASMNT.                 08570000
           MOVE DTE-REJECT OF DCLGRANT-ASMNT                            08580000
                    TO DTE-REJECT OF DCLEX-GRANT-ASMNT.                 08590000
           MOVE DTE-SUBMIT OF DCLGRANT-ASMNT                            08600000
                    TO DTE-SUBMIT OF DCLEX-GRANT-ASMNT.                 08610000
           MOVE DTE-WTHDRW OF DCLGRANT-ASMNT                            08620000
                    TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT.                 08630000
           MOVE NUM-RJCTN-REASON OF DCLGRANT-ASMNT                      08640000
                    TO NUM-RJCTN-REASON OF DCLEX-GRANT-ASMNT.           08650000
           MOVE NUM-WTDRWL-REASON OF DCLGRANT-ASMNT                     08660000
                    TO NUM-WTDRWL-REASON OF DCLEX-GRANT-ASMNT.          08670000
           MOVE TXT-CNCLTN-REASON OF DCLGRANT-ASMNT                     08680000
                    TO TXT-CNCLTN-REASON OF DCLEX-GRANT-ASMNT.          08690000
           MOVE DTE-GRANT-RQST OF DCLGRANT-ASMNT                        08700000
                    TO DTE-GRANT-RQST OF DCLEX-GRANT-ASMNT.             08710000
           MOVE NUM-GRANT-DOC-RCV OF DCLGRANT-ASMNT                     08720000
                    TO NUM-GRANT-DOC-RCV OF DCLEX-GRANT-ASMNT.          08730000
           MOVE DTE-ACK OF DCLGRANT-ASMNT                               08740000
                    TO DTE-ACK OF DCLEX-GRANT-ASMNT.                    08750000
           MOVE DTE-GRANT-FORM-ISSUE OF DCLGRANT-ASMNT                  08760000
                    TO DTE-GRANT-FORM-ISSUE OF DCLEX-GRANT-ASMNT.       08770000
           MOVE DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLGRANT-ASMNT          08780000
                 TO DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLEX-GRANT-ASMNT.  08790000
           MOVE NUM-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT              08800000
                 TO NUM-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT.      08810000
           MOVE DTE-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT              08820000
                 TO DTE-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT.      08830000
           MOVE NUM-ALCTN-SCHEME OF DCLGRANT-ASMNT                      08840000
                 TO NUM-ALCTN-SCHEME OF DCLEX-GRANT-ASMNT.              08850000
           MOVE NUM-HSHLD-CTZNSP OF DCLGRANT-ASMNT                      08860000
                 TO NUM-HSHLD-CTZNSP OF DCLEX-GRANT-ASMNT.              08870000
           MOVE NUM-WRKNG-CHILD-ASMNT OF DCLGRANT-ASMNT                 08880000
                 TO NUM-WRKNG-CHILD-ASMNT OF DCLEX-GRANT-ASMNT.         08890000
           MOVE QTY-MONTH-WORK OF DCLGRANT-ASMNT                        08900000
                 TO QTY-MONTH-WORK OF DCLEX-GRANT-ASMNT.                08910000
           MOVE NUM-APPEAL-ATCHMT OF DCLGRANT-ASMNT                     08920000
                 TO NUM-APPEAL-ATCHMT OF DCLEX-GRANT-ASMNT.             08930000
           MOVE NUM-PARENT-ADRS-BLDNG OF DCLGRANT-ASMNT                 08940000
                 TO NUM-PARENT-ADRS-BLDNG OF DCLEX-GRANT-ASMNT.         08950000
           MOVE NUM-PARENT-ADRS-LEVEL OF DCLGRANT-ASMNT                 08960000
                 TO NUM-PARENT-ADRS-LEVEL OF DCLEX-GRANT-ASMNT.         08970000
           MOVE NUM-PARENT-ADRS-UNIT OF DCLGRANT-ASMNT                  08980000
                 TO NUM-PARENT-ADRS-UNIT OF DCLEX-GRANT-ASMNT.          08990000
           MOVE TXT-PARENT-ADRS1 OF DCLGRANT-ASMNT                      09000000
                 TO TXT-PARENT-ADRS1 OF DCLEX-GRANT-ASMNT.              09010000
           MOVE TXT-PARENT-ADRS2 OF DCLGRANT-ASMNT                      09020000
                 TO TXT-PARENT-ADRS2 OF DCLEX-GRANT-ASMNT.              09030000
           MOVE NUM-PARENT-ADRS-POSTAL OF DCLGRANT-ASMNT                09040000
                 TO NUM-PARENT-ADRS-POSTAL OF DCLEX-GRANT-ASMNT.        09050000
           MOVE DTE-PYMNT OF DCLGRANT-ASMNT                             09060000
                 TO DTE-PYMNT OF DCLEX-GRANT-ASMNT.                     09070000
           MOVE DTE-CPF-ACK-GRANT-RCV OF DCLGRANT-ASMNT                 09080000
                 TO DTE-CPF-ACK-GRANT-RCV OF DCLEX-GRANT-ASMNT.         09090000
           MOVE NUM-GRANT-CREDIT OF DCLGRANT-ASMNT                      09100000
                 TO NUM-GRANT-CREDIT OF DCLEX-GRANT-ASMNT.              09110000
           MOVE TME-APNTMT OF DCLGRANT-ASMNT                            09120000
                 TO TME-APNTMT OF DCLEX-GRANT-ASMNT.                    09130000
           MOVE DTE-APNTMT OF DCLGRANT-ASMNT                            09140000
                 TO DTE-APNTMT OF DCLEX-GRANT-ASMNT.                    09150000
           MOVE TME-CREATE-ASMNT OF DCLGRANT-ASMNT                      09160000
                 TO TME-CREATE-ASMNT OF DCLEX-GRANT-ASMNT.              09170000
           MOVE NUM-SOURCE-SYSTEM OF DCLGRANT-ASMNT                     09180000
                 TO NUM-SOURCE-SYSTEM OF DCLEX-GRANT-ASMNT.             09190000
           MOVE NUM-ACNT OF DCLGRANT-ASMNT                              09200000
                 TO NUM-ACNT OF DCLEX-GRANT-ASMNT.                      09210000
           MOVE NUM-SCHEME OF DCLGRANT-ASMNT                            09220000
                 TO NUM-SCHEME OF DCLEX-GRANT-ASMNT.                    09230000
           MOVE NUM-TNCY OF DCLGRANT-ASMNT                              09240000
                 TO NUM-TNCY OF DCLEX-GRANT-ASMNT.                      09250000
           MOVE NUM-HALF-GRANT OF DCLGRANT-ASMNT                        09260000
                 TO NUM-HALF-GRANT OF DCLEX-GRANT-ASMNT.                09270000
                                                                        09280000
           MOVE 'BP13CB0C ' TO NUM-UPDATE-USERID OF DCLEX-GRANT-ASMNT.  09290000
                                                                        09300000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              09310000
                  WS-DTE-CCYYMMDD(5:2) '-'                              09320000
                  WS-DTE-CCYYMMDD(7:2)                                  09330000
                 DELIMITED BY SIZE INTO DTE-UPDATE OF DCLEX-GRANT-ASMNT.09340000
                                                                        09350000
           STRING WS-TIME-HHMMSS(1:2) '.'                               09360000
                  WS-TIME-HHMMSS(3:2) '.'                               09370000
                  WS-TIME-HHMMSS(5:2)                                   09380000
                 DELIMITED BY SIZE INTO TME-UPDATE OF DCLEX-GRANT-ASMNT.09390000
                                                                        09400000
            MOVE WS-TIMESTAMP TO TME-CREATE OF DCLEX-GRANT-ASMNT.       09410000
                                                                        09420000
            EXEC SQL                                                    09430000
                 INSERT INTO EX_GRANT_ASMNT                             09440000
                        ( NUM_RGSTRN,                                   09450000
                          NUM_GRANT_TYPE,                               09460000
                          TME_CREATE,                                   09470000
                          NUM_ELGBL_GRANT,                              09480000
                          NUM_GRANT_AMOUNT_ELGBL,                       09490000
                          NUM_GRANT_STATUS,                             09500000
                          DTE_APRV,                                     09510000
                          DTE_CANCEL,                                   09520000
                          DTE_REJECT,                                   09530000
                          DTE_SUBMIT,                                   09540000
                          DTE_WTHDRW,                                   09550000
                          NUM_RJCTN_REASON,                             09560000
                          NUM_WTDRWL_REASON,                            09570000
                          TXT_CNCLTN_REASON,                            09580000
                          DTE_GRANT_RQST,                               09590000
                          NUM_GRANT_DOC_RCV,                            09600000
                          DTE_ACK,                                      09610000
                          DTE_GRANT_FORM_ISSUE,                         09620000
                          DTE_GRANT_OPT_OUT_FORM_ISSUE,                 09630000
                          NUM_GRANT_OPT_OUT_REASON,                     09640000
                          DTE_GRANT_OPT_OUT_REASON,                     09650000
                          NUM_ALCTN_SCHEME,                             09660000
                          NUM_HSHLD_CTZNSP,                             09670000
                          NUM_WRKNG_CHILD_ASMNT,                        09680000
                          QTY_MONTH_WORK,                               09690000
                          NUM_APPEAL_ATCHMT,                            09700000
                          NUM_PARENT_ADRS_BLDNG,                        09710000
                          NUM_PARENT_ADRS_LEVEL,                        09720000
                          NUM_PARENT_ADRS_UNIT,                         09730000
                          TXT_PARENT_ADRS1,                             09740000
                          TXT_PARENT_ADRS2,                             09750000
                          NUM_PARENT_ADRS_POSTAL,                       09760000
                          DTE_PYMNT,                                    09770000
                          DTE_CPF_ACK_GRANT_RCV,                        09780000
                          NUM_GRANT_CREDIT,                             09790000
                          TME_APNTMT,                                   09800000
                          DTE_APNTMT,                                   09810000
                          TME_CREATE_ASMNT,                             09820000
                          NUM_UPDATE_USERID,                            09830000
                          TME_UPDATE,                                   09840000
                          DTE_UPDATE,                                   09850000
                          NUM_SOURCE_SYSTEM,                            09860000
                          NUM_ACNT,                                     09870000
                          NUM_SCHEME,                                   09880000
                          NUM_TNCY,                                     09890000
                          NUM_HALF_GRANT )                              09900000
                 VALUES ( :DCLEX-GRANT-ASMNT.NUM-RGSTRN,                09910000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-TYPE,            09920000
                          :DCLEX-GRANT-ASMNT.TME-CREATE,                09930000
                          :DCLEX-GRANT-ASMNT.NUM-ELGBL-GRANT,           09940000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,    09950000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-STATUS,          09960000
                          :DCLEX-GRANT-ASMNT.DTE-APRV,                  09970000
                          :DCLEX-GRANT-ASMNT.DTE-CANCEL,                09980000
                          :DCLEX-GRANT-ASMNT.DTE-REJECT,                09990000
                          :DCLEX-GRANT-ASMNT.DTE-SUBMIT,                10000000
                          :DCLEX-GRANT-ASMNT.DTE-WTHDRW,                10010000
                          :DCLEX-GRANT-ASMNT.NUM-RJCTN-REASON,          10020000
                          :DCLEX-GRANT-ASMNT.NUM-WTDRWL-REASON,         10030000
                          :DCLEX-GRANT-ASMNT.TXT-CNCLTN-REASON,         10040000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-RQST,            10050000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-DOC-RCV,         10060000
                          :DCLEX-GRANT-ASMNT.DTE-ACK,                   10070000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-FORM-ISSUE,      10080000
                        :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,10090000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,  10100000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,  10110000
                          :DCLEX-GRANT-ASMNT.NUM-ALCTN-SCHEME,          10120000
                          :DCLEX-GRANT-ASMNT.NUM-HSHLD-CTZNSP,          10130000
                          :DCLEX-GRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,     10140000
                          :DCLEX-GRANT-ASMNT.QTY-MONTH-WORK,            10150000
                          :DCLEX-GRANT-ASMNT.NUM-APPEAL-ATCHMT,         10160000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,     10170000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,     10180000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-UNIT,      10190000
                          :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS1,          10200000
                          :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS2,          10210000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,    10220000
                          :DCLEX-GRANT-ASMNT.DTE-PYMNT,                 10230000
                          :DCLEX-GRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,     10240000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-CREDIT,          10250000
                          :DCLEX-GRANT-ASMNT.TME-APNTMT,                10260000
                          :DCLEX-GRANT-ASMNT.DTE-APNTMT,                10270000
                          :DCLEX-GRANT-ASMNT.TME-CREATE-ASMNT,          10280000
                          :DCLEX-GRANT-ASMNT.NUM-UPDATE-USERID,         10290000
                          :DCLEX-GRANT-ASMNT.TME-UPDATE,                10300000
                          :DCLEX-GRANT-ASMNT.DTE-UPDATE,                10310000
                          :DCLEX-GRANT-ASMNT.NUM-SOURCE-SYSTEM,         10320000
                          :DCLEX-GRANT-ASMNT.NUM-ACNT,                  10330000
                          :DCLEX-GRANT-ASMNT.NUM-SCHEME,                10340000
                          :DCLEX-GRANT-ASMNT.NUM-TNCY,                  10350000
                          :DCLEX-GRANT-ASMNT.NUM-HALF-GRANT )           10360000
            END-EXEC.                                                   10370000
                                                                        10380000
            EVALUATE SQLCODE                                            10390000
               WHEN 000                                                 10400000
                    ADD 1                 TO WS-EX-GRANT-INS            10410000
                    MOVE 'EX_GRANT_ASMNT'  TO WS-SOURCE                 10420000
                    MOVE 'C'            TO WS-ACTION                    10430000
                    MOVE NUM-RGSTRN OF DCLEX-GRANT-ASMNT TO WS-RGSTRN   10440000
                    MOVE NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT            10450000
                                                  TO WS-GRNT-TYPE       10460000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           10470000
                    MOVE DCLEX-GRANT-ASMNT TO WS-AFTER-IMAGE            10480000
                    PERFORM 6400-INSERT-TO-LOG     THRU 6400-EXIT       10490000
                                                                        10500000
               WHEN -803                                                10510000
                    DISPLAY 'RECORD ALREADY EXIST IN EX_GRANT_ASMNT'    10520000
                    DISPLAY NUM-RGSTRN OF DCLEX-GRANT-ASMNT ' '         10530000
                            NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT         10540000
                                                                        10550000
               WHEN OTHER                                               10560000
                    MOVE SQLCODE          TO WS-SQLCODE                 10570000
                    DISPLAY 'SQL ERROR (INSERT) IN EX_GRANT_ASMNT'      10580000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            10590000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          10600000
            END-EVALUATE.                                               10610000
                                                                        10620000
       4200-EXIT.                                                       10630000
           EXIT.                                                        10640000
                                                                        10650000
      *----------------------*                                          10660000
       4300-DELETE-GRANT-ASMNT.                                         10670000
      *----------------------*                                          10680000
            MOVE DCLGRANT-ASMNT                   TO WS-BEFORE-IMAGE.   10690000
            MOVE NUM-RGSTRN OF DCLGRANT-ASMNT     TO WS-RGSTRN.         10700000
            MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT TO WS-GRNT-TYPE.      10710000
                                                                        10720000
            EXEC SQL                                                    10730000
                 DELETE FROM GRANT_ASMNT                                10740000
                 WHERE NUM_RGSTRN      = :DCLGRANT-ASMNT.NUM-RGSTRN     10750000
                 AND   NUM_GRANT_TYPE  = :DCLGRANT-ASMNT.NUM-GRANT-TYPE 10760000
            END-EXEC.                                                   10770000
                                                                        10780000
            EVALUATE SQLCODE                                            10790000
               WHEN 000                                                 10800000
                    ADD 1                 TO WS-GRANT-DELETE            10810000
                    MOVE 'GRANT_ASMNT'  TO WS-SOURCE                    10820000
                    MOVE 'D'            TO WS-ACTION                    10830000
                    MOVE SPACES         TO WS-AFTER-IMAGE               10840000
                    PERFORM 6400-INSERT-TO-LOG     THRU 6400-EXIT       10850000
                                                                        10860000
               WHEN 100                                                 10870000
                    DISPLAY 'RECORD NOT EXIST IN GRANT_ASMNT'           10880000
                    DISPLAY WS-RGSTRN ' ' WS-GRNT-TYPE                  10890000
                                                                        10900000
               WHEN OTHER                                               10910000
                    MOVE SQLCODE          TO WS-SQLCODE                 10920000
                    DISPLAY 'SQL ERROR (DELETE) IN GRANT_ASMNT TABLE '  10930000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            10940000
            END-EVALUATE.                                               10950000
                                                                        10960000
       4300-EXIT.                                                       10970000
           EXIT.                                                        10980000
                                                                        10990000
      *================================================================*11000000
       5000-PROCESS-PERSON.                                             11010000
      *================================================================*11020000
           PERFORM 5100-OPEN-CURSOR     THRU 5100-EXIT.                 11030000
           PERFORM 5200-FETCH-CURSOR    THRU 5200-EXIT                  11040000
                   UNTIL (SQLCODE = WS-SQL-NFND)                        11050000
                      OR (WS-CURSOR-EOF) = 'Y'.                         11060000
           PERFORM 5300-CLOSE-CURSOR    THRU 5300-EXIT.                 11070000
                                                                        11080000
       5000-EXIT.                                                       11090000
           EXIT.                                                        11100000
                                                                        11110000
      *================================================================*11120000
       5100-OPEN-CURSOR.                                                11130000
      *================================================================*11140000
           INITIALIZE SQLCODE.                                          11150000
           MOVE 'N'                   TO WS-CURSOR-EOF.                 11160000
                                                                        11170000
           MOVE FD10-NUM-REGN  TO NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON.  11180000
                                                                        11190000
           EVALUATE FD10-NUM-TRANS                                      11200000
            WHEN 'SRR'                                                  11210000
              MOVE 'SRG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11220000
            WHEN 'RER'                                                  11230000
              MOVE 'REG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11240000
            WHEN 'FSR'                                                  11250000
              MOVE 'FSG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11260000
            WHEN 'SUR'                                                  11270000
              MOVE 'SUG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11280000
            WHEN 'PHR'                                                  11290000
              MOVE 'PHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11300000
            WHEN 'AHR'                                                  11310000
              MOVE 'AHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11320000
            WHEN 'HGR'                                                  11330000
              MOVE 'HGT   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11340000
            WHEN 'TUR'                                                  11350000
              MOVE 'TUG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11360000
            WHEN 'ATR'                                                  11370000
              MOVE 'ATG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11380000
            WHEN 'EHR'                                                  11381000
              MOVE 'EHG   ' TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON  11382000
           END-EVALUATE.                                                11390000
                                                                        11400000
      *------------------------------------------*                      11410000
      *  DECLARE CURSOR - GRANT ASSESSMENT PERSON                       11420000
      *------------------------------------------*                      11430000
           EXEC SQL                                                     11440000
             DECLARE CURSOR CURSOR FOR                                  11450000
               SELECT NUM_RGSTRN,                                       11460000
                      NUM_GRANT_TYPE,                                   11470000
                      NUM_IDNTY_NO,                                     11480000
                      NUM_IDNTY_NO_TYPE,                                11490000
                      NUM_CSTMR_SOURCE,                                 11500000
                      NUM_CPF_ACNT,                                     11510000
                      AMT_GRANT,                                        11520000
                      AMT_GRANT_USE,                                    11530000
                      NUM_ROLE_TAG,                                     11540000
                      NUM_RLTNSP,                                       11550000
                      NME_PERSON,                                       11560000
                      NUM_GENDER,                                       11570000
                      NUM_CTZNSP,                                       11580000
                      NUM_MRTL_STATUS,                                  11590000
                      AMT_INCOME,                                       11600000
                      NUM_1YR_CNTNS_EMPLY,                              11610000
                      NUM_DEBAR,                                        11620000
                      NUM_DEBAR_REASON,                                 11630000
                      NUM_RCVRY,                                        11640000
                      NUM_UPDATE_USERID,                                11650000
                      DTE_UPDATE,                                       11660000
                      TME_UPDATE,                                       11670000
                      AMT_GRANT_THRSHD,                                 11680000
                      AMT_GRANT_EXCESS                                  11690000
               FROM                                                     11700000
                 GRANT_ASMNT_PERSON                                     11710000
               WHERE                                                    11720000
                 NUM_RGSTRN = :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN AND     11730000
                 NUM_GRANT_TYPE = :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE 11740000
               ORDER BY NUM_IDNTY_NO                                    11750000
           END-EXEC.                                                    11760000
                                                                        11770000
      *----------------------------------------*                        11780000
      *  OPEN CURSOR - GRANT ASSESSMENT PERSON *                        11790000
      *----------------------------------------*                        11800000
           EXEC SQL                                                     11810000
             OPEN CURSOR                                                11820000
           END-EXEC.                                                    11830000
                                                                        11840000
           EVALUATE SQLCODE                                             11850000
           WHEN 0                                                       11860000
             CONTINUE                                                   11870000
           WHEN OTHER                                                   11880000
             MOVE SQLCODE            TO WS-SQLCODE                      11890000
             DISPLAY 'OPEN CURSOR ERROR'                                11900000
             GO TO 9999-SQL-ERROR                                       11910000
           END-EVALUATE.                                                11920000
                                                                        11930000
       5100-EXIT.                                                       11940000
            EXIT.                                                       11950000
                                                                        11960000
      *================================================================*11970000
       5200-FETCH-CURSOR.                                               11980000
      *================================================================*11990000
                                                                        12000000
           EXEC SQL                                                     12010000
             FETCH CURSOR                                               12020000
               INTO                                                     12030000
                 :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN,                     12040000
                 :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE,                 12050000
                 :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO,                   12060000
                 :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,              12070000
                 :DCLGRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,               12080000
                 :DCLGRANT-ASMNT-PERSON.NUM-CPF-ACNT,                   12090000
                 :DCLGRANT-ASMNT-PERSON.AMT-GRANT,                      12100000
                 :DCLGRANT-ASMNT-PERSON.AMT-GRANT-USE,                  12110000
                 :DCLGRANT-ASMNT-PERSON.NUM-ROLE-TAG,                   12120000
                 :DCLGRANT-ASMNT-PERSON.NUM-RLTNSP,                     12130000
                 :DCLGRANT-ASMNT-PERSON.NME-PERSON,                     12140000
                 :DCLGRANT-ASMNT-PERSON.NUM-GENDER,                     12150000
                 :DCLGRANT-ASMNT-PERSON.NUM-CTZNSP,                     12160000
                 :DCLGRANT-ASMNT-PERSON.NUM-MRTL-STATUS,                12170000
                 :DCLGRANT-ASMNT-PERSON.AMT-INCOME,                     12180000
                 :DCLGRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,            12190000
                 :DCLGRANT-ASMNT-PERSON.NUM-DEBAR,                      12200000
                 :DCLGRANT-ASMNT-PERSON.NUM-DEBAR-REASON,               12210000
                 :DCLGRANT-ASMNT-PERSON.NUM-RCVRY,                      12220000
                 :DCLGRANT-ASMNT-PERSON.NUM-UPDATE-USERID,              12230000
                 :DCLGRANT-ASMNT-PERSON.DTE-UPDATE,                     12240000
                 :DCLGRANT-ASMNT-PERSON.TME-UPDATE,                     12250000
                 :DCLGRANT-ASMNT-PERSON.AMT-GRANT-THRSHD,               12260000
                 :DCLGRANT-ASMNT-PERSON.AMT-GRANT-EXCESS                12270000
           END-EXEC.                                                    12280000
                                                                        12290000
           EVALUATE SQLCODE                                             12300000
           WHEN WS-SQL-OK                                               12310000
             PERFORM 5400-INSERT-TO-EX-PERSON THRU 5400-EXIT            12320000
             IF AMT-GRANT OF DCLGRANT-ASMNT-PERSON NOT = ZEROES         12330000
                PERFORM 5500-INSERT-TO-RECOVERY  THRU 5500-EXIT         12340000
             END-IF                                                     12350000
             PERFORM 5600-DELETE-GRANT-PERSON THRU 5600-EXIT            12360000
           WHEN WS-SQL-NFND                                             12370000
             MOVE 'Y'                  TO WS-CURSOR-EOF                 12380000
           WHEN OTHER                                                   12390000
             MOVE SQLCODE            TO WS-SQLCODE                      12400000
             DISPLAY 'FETCH CURSOR ERROR'                               12410000
             GO TO 9999-SQL-ERROR                                       12420000
           END-EVALUATE.                                                12430000
                                                                        12440000
       5200-EXIT.                                                       12450000
            EXIT.                                                       12460000
                                                                        12470000
      *---------------------------------------------------------------* 12480000
       5300-CLOSE-CURSOR.                                               12490000
      *---------------------------------------------------------------* 12500000
           INITIALIZE SQLCODE.                                          12510000
                                                                        12520000
      *-----------------------------------*                             12530000
      * CLOSE CURSOR - GRANT ASSESSMENT   *                             12540000
      *-----------------------------------*                             12550000
           EXEC SQL CLOSE CURSOR                                        12560000
           END-EXEC.                                                    12570000
                                                                        12580000
           EVALUATE SQLCODE                                             12590000
              WHEN 0                                                    12600000
                   CONTINUE                                             12610000
              WHEN OTHER                                                12620000
                MOVE SQLCODE TO WS-SQLCODE                              12630000
                DISPLAY 'CLOSE CURSOR ERROR'                            12640000
                GO TO 9999-SQL-ERROR                                    12650000
           END-EVALUATE.                                                12660000
                                                                        12670000
       5300-EXIT.                                                       12680000
           EXIT.                                                        12690000
                                                                        12700000
      *------------------------*                                        12710000
       5400-INSERT-TO-EX-PERSON.                                        12720000
      *------------------------*                                        12730000
           MOVE NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON                     12740000
                TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON.              12750000
           MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON                 12760000
                TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON.          12770000
           MOVE NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON                   12780000
                TO NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON.            12790000
           MOVE NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON              12800000
                TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON.       12810000
           MOVE NUM-CSTMR-SOURCE OF DCLGRANT-ASMNT-PERSON               12820000
                TO NUM-CSTMR-SOURCE OF DCLEX-GRANT-ASMNT-PERSON.        12830000
           MOVE NUM-CPF-ACNT OF DCLGRANT-ASMNT-PERSON                   12840000
                TO NUM-CPF-ACNT OF DCLEX-GRANT-ASMNT-PERSON.            12850000
           MOVE AMT-GRANT OF DCLGRANT-ASMNT-PERSON                      12860000
                TO AMT-GRANT OF DCLEX-GRANT-ASMNT-PERSON.               12870000
           MOVE AMT-GRANT-USE OF DCLGRANT-ASMNT-PERSON                  12880000
                TO AMT-GRANT-USE OF DCLEX-GRANT-ASMNT-PERSON.           12890000
           MOVE NUM-ROLE-TAG OF DCLGRANT-ASMNT-PERSON                   12900000
                TO NUM-ROLE-TAG OF DCLEX-GRANT-ASMNT-PERSON.            12910000
           MOVE NUM-RLTNSP OF DCLGRANT-ASMNT-PERSON                     12920000
                TO NUM-RLTNSP OF DCLEX-GRANT-ASMNT-PERSON.              12930000
           MOVE NME-PERSON OF DCLGRANT-ASMNT-PERSON                     12940000
                TO NME-PERSON OF DCLEX-GRANT-ASMNT-PERSON.              12950000
           MOVE NUM-GENDER OF DCLGRANT-ASMNT-PERSON                     12960000
                TO NUM-GENDER OF DCLEX-GRANT-ASMNT-PERSON.              12970000
           MOVE NUM-CTZNSP OF DCLGRANT-ASMNT-PERSON                     12980000
                TO NUM-CTZNSP OF DCLEX-GRANT-ASMNT-PERSON.              12990000
           MOVE NUM-MRTL-STATUS OF DCLGRANT-ASMNT-PERSON                13000000
                TO NUM-MRTL-STATUS OF DCLEX-GRANT-ASMNT-PERSON.         13010000
           MOVE AMT-INCOME OF DCLGRANT-ASMNT-PERSON                     13020000
                TO AMT-INCOME OF DCLEX-GRANT-ASMNT-PERSON.              13030000
           MOVE NUM-1YR-CNTNS-EMPLY OF DCLGRANT-ASMNT-PERSON            13040000
                TO NUM-1YR-CNTNS-EMPLY OF DCLEX-GRANT-ASMNT-PERSON.     13050000
           MOVE NUM-DEBAR OF DCLGRANT-ASMNT-PERSON                      13060000
                TO NUM-DEBAR OF DCLEX-GRANT-ASMNT-PERSON.               13070000
           MOVE NUM-DEBAR-REASON OF DCLGRANT-ASMNT-PERSON               13080000
                TO NUM-DEBAR-REASON OF DCLEX-GRANT-ASMNT-PERSON.        13090000
           MOVE NUM-RCVRY OF DCLGRANT-ASMNT-PERSON                      13100000
                TO NUM-RCVRY OF DCLEX-GRANT-ASMNT-PERSON.               13110000
           MOVE AMT-GRANT-THRSHD OF DCLGRANT-ASMNT-PERSON               13120000
                TO AMT-GRANT-THRSHD OF DCLEX-GRANT-ASMNT-PERSON.        13130000
           MOVE AMT-GRANT-EXCESS OF DCLGRANT-ASMNT-PERSON               13140000
                TO AMT-GRANT-EXCESS OF DCLEX-GRANT-ASMNT-PERSON.        13150000
                                                                        13160000
           MOVE 'BP13CB0C '                                             13170000
                   TO NUM-UPDATE-USERID OF DCLEX-GRANT-ASMNT-PERSON.    13180000
                                                                        13190000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              13200000
                  WS-DTE-CCYYMMDD(5:2) '-'                              13210000
                  WS-DTE-CCYYMMDD(7:2)                                  13220000
                  DELIMITED BY SIZE                                     13230000
                  INTO DTE-UPDATE OF DCLEX-GRANT-ASMNT-PERSON.          13240000
                                                                        13250000
           STRING WS-TIME-HHMMSS(1:2) '.'                               13260000
                  WS-TIME-HHMMSS(3:2) '.'                               13270000
                  WS-TIME-HHMMSS(5:2)                                   13280000
                  DELIMITED BY SIZE                                     13290000
                  INTO TME-UPDATE OF DCLEX-GRANT-ASMNT-PERSON.          13300000
                                                                        13310000
            MOVE WS-TIMESTAMP TO TME-CREATE OF DCLEX-GRANT-ASMNT-PERSON.13320000
                                                                        13330000
            EXEC SQL                                                    13340000
                 INSERT INTO EX_GRANT_ASMNT_PERSON                      13350000
                        ( NUM_RGSTRN,                                   13360000
                          NUM_GRANT_TYPE,                               13370000
                          TME_CREATE,                                   13380000
                          NUM_IDNTY_NO,                                 13390000
                          NUM_IDNTY_NO_TYPE,                            13400000
                          NUM_CSTMR_SOURCE,                             13410000
                          NUM_CPF_ACNT,                                 13420000
                          AMT_GRANT,                                    13430000
                          AMT_GRANT_USE,                                13440000
                          NUM_ROLE_TAG,                                 13450000
                          NUM_RLTNSP,                                   13460000
                          NME_PERSON,                                   13470000
                          NUM_GENDER,                                   13480000
                          NUM_CTZNSP,                                   13490000
                          NUM_MRTL_STATUS,                              13500000
                          AMT_INCOME,                                   13510000
                          NUM_1YR_CNTNS_EMPLY,                          13520000
                          NUM_DEBAR,                                    13530000
                          NUM_DEBAR_REASON,                             13540000
                          NUM_RCVRY,                                    13550000
                          NUM_UPDATE_USERID,                            13560000
                          DTE_UPDATE,                                   13570000
                          TME_UPDATE,                                   13580000
                          AMT_GRANT_THRSHD,                             13590000
                          AMT_GRANT_EXCESS )                            13600000
                 VALUES ( :DCLEX-GRANT-ASMNT-PERSON.NUM-RGSTRN,         13610000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-GRANT-TYPE,     13620000
                          :DCLEX-GRANT-ASMNT-PERSON.TME-CREATE,         13630000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO,       13640000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,  13650000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,   13660000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CPF-ACNT,       13670000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT,          13680000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-USE,      13690000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-ROLE-TAG,       13700000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-RLTNSP,         13710000
                          :DCLEX-GRANT-ASMNT-PERSON.NME-PERSON,         13720000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-GENDER,         13730000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CTZNSP,         13740000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-MRTL-STATUS,    13750000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-INCOME,         13760000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,13770000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR,          13780000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR-REASON,   13790000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-RCVRY,          13800000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-UPDATE-USERID,  13810000
                          :DCLEX-GRANT-ASMNT-PERSON.DTE-UPDATE,         13820000
                          :DCLEX-GRANT-ASMNT-PERSON.TME-UPDATE,         13830000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-THRSHD,   13840000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-EXCESS )  13850000
            END-EXEC.                                                   13860000
                                                                        13870000
            EVALUATE SQLCODE                                            13880000
               WHEN 000                                                 13890000
                    ADD 1                 TO WS-EX-PRSN-INS             13900000
                    MOVE 'EX_GRANT_ASMNT_PERSON'  TO WS-SOURCE          13910000
                    MOVE 'C'            TO WS-ACTION                    13920000
                    MOVE NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON         13930000
                                                  TO WS-RGSTRN          13940000
                    MOVE NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON     13950000
                                                  TO WS-GRNT-TYPE       13960000
                    MOVE SPACES                   TO WS-BEFORE-IMAGE    13970000
                    MOVE DCLEX-GRANT-ASMNT-PERSON TO WS-AFTER-IMAGE     13980000
                    PERFORM 6400-INSERT-TO-LOG     THRU 6400-EXIT       13990000
                                                                        14000000
               WHEN -803                                                14010000
                    DISPLAY 'RECORD EXIST IN EX_GRANT_ASMNT_PERSON'     14020000
                    DISPLAY NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON ' '  14030000
                        NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON ' '  14040000
                          NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON      14050000
                                                                        14060000
               WHEN OTHER                                               14070000
                    MOVE SQLCODE          TO WS-SQLCODE                 14080000
                    DISPLAY 'SQL ERR (INSERT) IN EX_GRANT_ASMNT_PERSON' 14090000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            14100000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          14110000
            END-EVALUATE.                                               14120000
                                                                        14130000
       5400-EXIT.                                                       14140000
           EXIT.                                                        14150000
                                                                        14160000
      *------------------------*                                        14170000
       5500-INSERT-TO-RECOVERY.                                         14180000
      *------------------------*                                        14190000
           MOVE NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON                     14200000
                             TO NUM-RGSTRN OF DCLGRANT-RCVRY.           14210000
           MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON                 14220000
                             TO NUM-GRANT-TYPE OF DCLGRANT-RCVRY.       14230000
           MOVE NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON                   14240000
                             TO NUM-IDNTY-NO OF DCLGRANT-RCVRY.         14250000
           MOVE NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON              14260000
                             TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY.    14270000
                                                                        14280000
           IF FD10-DTE-PREPARE-VR = SPACES OR LOW-VALUES                14290000
              MOVE '0001-01-01' TO DTE-RQST-RCVR OF DCLGRANT-RCVRY      14300000
           ELSE                                                         14310000
              STRING FD10-DTE-PREPARE-VR(1:4) '-'                       14320000
                     FD10-DTE-PREPARE-VR(5:2) '-'                       14330000
                     FD10-DTE-PREPARE-VR(7:2) DELIMITED BY SIZE         14340000
                     INTO DTE-RQST-RCVR OF DCLGRANT-RCVRY               14350000
           END-IF.                                                      14360000
                                                                        14370000
           IF F630-DTE-TRANS = SPACES OR LOW-VALUES                     14380000
              MOVE '0001-01-01' TO DTE-RCV-RCVR-GRANT OF DCLGRANT-RCVRY 14390000
           ELSE                                                         14400000
              STRING F630-DTE-TRANS(1:4) '-'                            14410000
                     F630-DTE-TRANS(5:2) '-'                            14420000
                     F630-DTE-TRANS(7:2) DELIMITED BY SIZE              14430000
                     INTO DTE-RCV-RCVR-GRANT OF DCLGRANT-RCVRY          14440000
           END-IF.                                                      14450000
                                                                        14460000
           MOVE WS-TIMESTAMP TO TME-CREATE OF DCLGRANT-RCVRY.           14470000
                                                                        14480000
           MOVE 'BP13CB0C '                                             14490000
                   TO NUM-UPDATE-USERID OF DCLGRANT-RCVRY.              14500000
                                                                        14510000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              14520000
                  WS-DTE-CCYYMMDD(5:2) '-'                              14530000
                  WS-DTE-CCYYMMDD(7:2)                                  14540000
                  DELIMITED BY SIZE                                     14550000
                  INTO DTE-UPDATE OF DCLGRANT-RCVRY.                    14560000
                                                                        14570000
           STRING WS-TIME-HHMMSS(1:2) '.'                               14580000
                  WS-TIME-HHMMSS(3:2) '.'                               14590000
                  WS-TIME-HHMMSS(5:2)                                   14600000
                  DELIMITED BY SIZE                                     14610000
                  INTO TME-UPDATE OF DCLGRANT-RCVRY.                    14620000
                                                                        14630000
            MOVE ZEROES TO AMT-GRANT-RCVR-INTRST OF DCLGRANT-RCVRY      14640000
                           AMT-GRANT-RCVR OF DCLGRANT-RCVRY.            14650000
            MOVE '0001-01-01' TO DTE-TRNSFR OF DCLGRANT-RCVRY           14660000
                              DTE-ACK-GRANT-RCVRY-CPF OF DCLGRANT-RCVRY 14670000
                              DTE-GRANT-ABORT OF DCLGRANT-RCVRY         14680000
                              DTE-GRANT-RPDT OF DCLGRANT-RCVRY          14690000
                              DTE-CPF-GRANT-RQST OF DCLGRANT-RCVRY      14700000
                              DTE-CPF-GRANT-RCV OF DCLGRANT-RCVRY       14710000
                              DTE-UNUSED-GRANT-RQST OF DCLGRANT-RCVRY   14720000
                              DTE-UNUSED-GRANT-RCV OF DCLGRANT-RCVRY    14730000
                              DTE-USED-GRANT-RQST OF DCLGRANT-RCVRY     14740000
                              DTE-USED-GRANT-RCV OF DCLGRANT-RCVRY.     14750000
                                                                        14760000
            MOVE SPACES    TO NUM-TRNSFR OF DCLGRANT-RCVRY              14770000
                              NUM-ACNT OF DCLGRANT-RCVRY                14780000
                              NUM-SCHEME OF DCLGRANT-RCVRY              14790000
                              NUM-TNCY OF DCLGRANT-RCVRY.               14800000
                                                                        14810000
            PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 16        14820000
              IF FD10-NUM-VOUCH-NRIC(WS-CTR) = NUM-IDNTY-NO OF          14830000
                                               DCLGRANT-ASMNT-PERSON    14840000
                 IF FD10-NUM-VOUCH-CR-DR(WS-CTR) = 'C'                  14850000
                    MOVE FD10-AMT-VOUCH(WS-CTR)                         14860000
                                   TO AMT-GRANT-RCVR OF DCLGRANT-RCVRY  14870000
                 END-IF                                                 14880000
              END-IF                                                    14890000
            END-PERFORM.                                                14900000
                                                                        14910000
            EXEC SQL                                                    14920000
                 INSERT INTO GRANT_RCVRY                                14930000
                        ( NUM_RGSTRN,                                   14940000
                          NUM_GRANT_TYPE,                               14950000
                          TME_CREATE,                                   14960000
                          NUM_IDNTY_NO,                                 14970000
                          NUM_IDNTY_NO_TYPE,                            14980000
                          AMT_GRANT_RCVR,                               14990000
                          AMT_GRANT_RCVR_INTRST,                        15000000
                          DTE_RQST_RCVR,                                15010000
                          DTE_RCV_RCVR_GRANT,                           15020000
                          DTE_ACK_GRANT_RCVRY_CPF,                      15030000
                          DTE_GRANT_ABORT,                              15040000
                          DTE_GRANT_RPDT,                               15050000
                          NUM_TRNSFR,                                   15060000
                          DTE_TRNSFR,                                   15070000
                          NUM_ACNT,                                     15080000
                          NUM_SCHEME,                                   15090000
                          NUM_TNCY,                                     15100000
                          DTE_CPF_GRANT_RQST,                           15110000
                          DTE_CPF_GRANT_RCV,                            15120000
                          DTE_UNUSED_GRANT_RQST,                        15130000
                          DTE_UNUSED_GRANT_RCV,                         15140000
                          DTE_USED_GRANT_RQST,                          15150000
                          DTE_USED_GRANT_RCV,                           15160000
                          NUM_UPDATE_USERID,                            15170000
                          DTE_UPDATE,                                   15180000
                          TME_UPDATE )                                  15190000
                 VALUES ( :DCLGRANT-RCVRY.NUM-RGSTRN,                   15200000
                          :DCLGRANT-RCVRY.NUM-GRANT-TYPE,               15210000
                          :DCLGRANT-RCVRY.TME-CREATE,                   15220000
                          :DCLGRANT-RCVRY.NUM-IDNTY-NO,                 15230000
                          :DCLGRANT-RCVRY.NUM-IDNTY-NO-TYPE,            15240000
                          :DCLGRANT-RCVRY.AMT-GRANT-RCVR,               15250000
                          :DCLGRANT-RCVRY.AMT-GRANT-RCVR-INTRST,        15260000
                          :DCLGRANT-RCVRY.DTE-RQST-RCVR,                15270000
                          :DCLGRANT-RCVRY.DTE-RCV-RCVR-GRANT,           15280000
                          :DCLGRANT-RCVRY.DTE-ACK-GRANT-RCVRY-CPF,      15290000
                          :DCLGRANT-RCVRY.DTE-GRANT-ABORT,              15300000
                          :DCLGRANT-RCVRY.DTE-GRANT-RPDT,               15310000
                          :DCLGRANT-RCVRY.NUM-TRNSFR,                   15320000
                          :DCLGRANT-RCVRY.DTE-TRNSFR,                   15330000
                          :DCLGRANT-RCVRY.NUM-ACNT,                     15340000
                          :DCLGRANT-RCVRY.NUM-SCHEME,                   15350000
                          :DCLGRANT-RCVRY.NUM-TNCY,                     15360000
                          :DCLGRANT-RCVRY.DTE-CPF-GRANT-RQST,           15370000
                          :DCLGRANT-RCVRY.DTE-CPF-GRANT-RCV,            15380000
                          :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RQST,        15390000
                          :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RCV,         15400000
                          :DCLGRANT-RCVRY.DTE-USED-GRANT-RQST,          15410000
                          :DCLGRANT-RCVRY.DTE-USED-GRANT-RCV,           15420000
                          :DCLGRANT-RCVRY.NUM-UPDATE-USERID,            15430000
                          :DCLGRANT-RCVRY.DTE-UPDATE,                   15440000
                          :DCLGRANT-RCVRY.TME-UPDATE )                  15450000
            END-EXEC.                                                   15460000
                                                                        15470000
            EVALUATE SQLCODE                                            15480000
               WHEN 000                                                 15490000
                    ADD 1                 TO WS-RCVRY-INS               15500000
                    MOVE 'GRANT_RCVRY'  TO WS-SOURCE                    15510000
                    MOVE 'C'            TO WS-ACTION                    15520000
                    MOVE NUM-RGSTRN OF DCLGRANT-RCVRY TO WS-RGSTRN      15530000
                    MOVE NUM-GRANT-TYPE OF DCLGRANT-RCVRY               15540000
                                                  TO WS-GRNT-TYPE       15550000
                    MOVE SPACES         TO WS-BEFORE-IMAGE              15560000
                    MOVE DCLGRANT-RCVRY TO WS-AFTER-IMAGE               15570000
                    PERFORM 6400-INSERT-TO-LOG     THRU 6400-EXIT       15580000
                                                                        15590000
               WHEN -803                                                15600000
                    DISPLAY 'RECORD EXIST IN GRANT_RCVRY'               15610000
                    DISPLAY NUM-RGSTRN OF DCLGRANT-RCVRY ' '            15620000
                            NUM-GRANT-TYPE OF DCLGRANT-RCVRY ' '        15630000
                            NUM-IDNTY-NO OF DCLGRANT-RCVRY              15640000
                                                                        15650000
               WHEN OTHER                                               15660000
                    MOVE SQLCODE          TO WS-SQLCODE                 15670000
                    DISPLAY 'SQL ERR (INSERT) IN GRANT_RCVRY'           15680000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            15690000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          15700000
            END-EVALUATE.                                               15710000
                                                                        15720000
       5500-EXIT.                                                       15730000
           EXIT.                                                        15740000
                                                                        15750000
      *------------------------*                                        15760000
       5600-DELETE-GRANT-PERSON.                                        15770000
      *------------------------*                                        15780000
           MOVE DCLGRANT-ASMNT-PERSON               TO WS-BEFORE-IMAGE. 15790000
           MOVE NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON     TO WS-RGSTRN.   15800000
           MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON TO WS-GRNT-TYPE 15810000
                                                                        15820000
            EXEC SQL                                                    15830000
              DELETE FROM GRANT_ASMNT_PERSON                            15840000
              WHERE NUM_RGSTRN   = :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN    15850000
              AND NUM_GRANT_TYPE = :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE15860000
              AND NUM_IDNTY_NO   = :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO  15870000
            END-EXEC.                                                   15880000
                                                                        15890000
            EVALUATE SQLCODE                                            15900000
               WHEN 000                                                 15910000
                    ADD 1                 TO WS-PERSON-DELETE           15920000
                    MOVE 'GRANT_ASMNT_PERSON'  TO WS-SOURCE             15930000
                    MOVE 'D'                   TO WS-ACTION             15940000
                    MOVE SPACES                TO WS-AFTER-IMAGE        15950000
                    PERFORM 6400-INSERT-TO-LOG THRU 6400-EXIT           15960000
                                                                        15970000
               WHEN 100                                                 15980000
                    DISPLAY 'RECORD NOT EXIST IN GRANT_ASMNT_PERSON'    15990000
                    DISPLAY NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON ' '     16000000
                            NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON     16010000
                                                                        16020000
               WHEN OTHER                                               16030000
                    MOVE SQLCODE          TO WS-SQLCODE                 16040000
                    DISPLAY 'SQL ERROR (DELETE) IN GRANT_ASMNT_PERSON'  16050000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            16060000
            END-EVALUATE.                                               16070000
                                                                        16080000
       5600-EXIT.                                                       16090000
           EXIT.                                                        16100000
                                                                        16110000
      *------------------*                                              16120000
       6000-PRINT-REPORT.                                               16130000
      *------------------*                                              16140000
                                                                        16150000
           IF CNT-LINE-ON-PAGE > 46                                     16160000
              MOVE 1 TO CNT-LINE-ON-PAGE                                16170000
              PERFORM 6100-REPORT-HEADING THRU 6100-EXIT                16180000
           ELSE                                                         16190000
              ADD 1 TO CNT-LINE-ON-PAGE                                 16200000
           END-IF.                                                      16210000
                                                                        16220000
           IF CNT-LINE-ON-PAGE = 1                                      16230000
              PERFORM 6100-REPORT-HEADING THRU 6100-EXIT                16240000
           END-IF.                                                      16250000
                                                                        16260000
           ADD 1 TO CNT-PRT-CASES.                                      16270000
                                                                        16280000
           MOVE CNT-PRT-CASES         TO LB0C-SNO.                      16290000
                                                                        16300000
           IF WS-VOUCHER-NOTFND = 'Y'                                   16310000
              MOVE F630-NUM-REGN         TO LB0C-REG-NO                 16320000
              MOVE F630-NUM-VR           TO LB0C-VOUCHER-NO             16330000
              MOVE F630-AMT-TRANS        TO LB0C-AMT                    16340000
           ELSE                                                         16350000
              IF FD10-NUM-REGN NOT = SPACES AND LOW-VALUES AND ZEROES   16360000
                 MOVE FD10-NUM-REGN      TO LB0C-REG-NO                 16370000
              ELSE                                                      16380000
                 MOVE F630-NUM-REGN      TO LB0C-REG-NO                 16390000
              END-IF                                                    16400000
                                                                        16410000
              IF FD10-NUM-VR NOT = SPACES AND LOW-VALUES AND ZEROES     16420000
                 MOVE FD10-NUM-VR        TO LB0C-VOUCHER-NO             16430000
              ELSE                                                      16440000
                 MOVE F630-NUM-VR        TO LB0C-VOUCHER-NO             16450000
              END-IF                                                    16460000
              MOVE ZEROES                TO WS-AMT-RECEIPT              16470000
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 4       16480000
                 IF KD10-AMT-CPF-GRANT-PAYEE(WS-CTR) NOT NUMERIC        16490000
                    MOVE ZEROES     TO KD10-AMT-CPF-GRANT-PAYEE(WS-CTR) 16500000
                 END-IF                                                 16510000
              END-PERFORM                                               16520000
                                                                        16530000
              MOVE FD10-NUM-TRANS    TO LB0C-PAYMENT-TYPE               16540000
                                                                        16550000
              COMPUTE WS-AMT-RECEIPT = KD10-AMT-CPF-GRANT-PAYEE(1) +    16560000
                                       KD10-AMT-CPF-GRANT-PAYEE(2) +    16570000
                                       KD10-AMT-CPF-GRANT-PAYEE(3) +    16580000
                                       KD10-AMT-CPF-GRANT-PAYEE(4)      16590000
              MOVE WS-AMT-RECEIPT     TO LB0C-AMT                       16600000
           END-IF.                                                      16610000
                                                                        16620000
           MOVE F630-DTE-TRANS        TO LB0C-DTE-POST.                 16630000
           MOVE F630-NUM-BATCH        TO WS-SCHEDULE-NUM.               16640000
           MOVE F630-NUM-VR-SERIAL    TO WS-DOC-NO.                     16650000
           MOVE WS-SCHEDULE-NO        TO LB0C-NUM-RECEIPT.              16660000
           WRITE PRINT-REC          FROM LB0C-PR-DETAILS.               16670000
                                                                        16680000
       6000-EXIT.                                                       16690000
           EXIT.                                                        16700000
                                                                        16710000
      *--------------------*                                            16720000
       6100-REPORT-HEADING.                                             16730000
      *--------------------*                                            16740000
                                                                        16750000
            ADD 1           TO CNT-PAGE.                                16760000
            MOVE CNT-PAGE   TO LB0C-PAGE.                               16770000
            MOVE SPACES     TO PRINT-REC.                               16780000
            WRITE PRINT-REC AFTER PAGE.                                 16790000
            WRITE PRINT-REC FROM LB0C-PR-HEAD-01 AFTER 2.               16800000
            WRITE PRINT-REC FROM LB0C-PR-HEAD-02 AFTER 3.               16810000
            WRITE PRINT-REC FROM LB0C-PR-HEAD-03 AFTER 3.               16820000
            MOVE ALL '-'    TO PRINT-REC.                               16830000
            WRITE PRINT-REC.                                            16840000
            MOVE SPACES     TO PRINT-REC.                               16850000
            WRITE PRINT-REC AFTER 1.                                    16860000
                                                                        16870000
       6100-EXIT.                                                       16880000
           EXIT.                                                        16890000
                                                                        16900000
      *--------------------*                                            16910000
       6400-INSERT-TO-LOG.                                              16920000
      *--------------------*                                            16930000
            EXEC SQL                                                    16940000
                 SET :WS-TIMESTAMP-LOG = CURRENT TIMESTAMP              16950000
            END-EXEC.                                                   16960000
            IF SQLCODE NOT = 000                                        16970000
               MOVE SQLCODE          TO WS-SQLCODE                      16980000
               DISPLAY 'SQL ERROR SET DB2 TIMESTAMP'                    16990000
               DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE                 17000000
               PERFORM 9999-SQL-ERROR THRU 9999-EXIT                    17010000
            END-IF.                                                     17020000
                                                                        17030000
           MOVE WS-TIMESTAMP-LOG TO TME-UPDATE OF DCLGRANT-UPDATE-LOG.  17040000
           MOVE 'BP13CB0C'  TO NUM-UPDATE-USERID OF DCLGRANT-UPDATE-LOG.17050000
           MOVE WS-SOURCE   TO NUM-SOURCE-RECORD OF DCLGRANT-UPDATE-LOG.17060000
           MOVE WS-ACTION     TO NUM-ACTION OF DCLGRANT-UPDATE-LOG.     17070000
           MOVE WS-RGSTRN     TO NUM-RGSTRN OF DCLGRANT-UPDATE-LOG.     17080000
           MOVE WS-GRNT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-UPDATE-LOG.  17090000
           MOVE WS-BEFORE-IMAGE TO TXT-BEFORE-IMAGE-TEXT                17100000
                                              OF DCLGRANT-UPDATE-LOG.   17110000
           MOVE LENGTH OF WS-BEFORE-IMAGE TO TXT-BEFORE-IMAGE-LEN       17120000
                                              OF DCLGRANT-UPDATE-LOG.   17130000
           MOVE WS-AFTER-IMAGE TO TXT-AFTER-IMAGE-TEXT                  17140000
                                              OF DCLGRANT-UPDATE-LOG.   17150000
           MOVE LENGTH OF WS-AFTER-IMAGE TO TXT-AFTER-IMAGE-LEN         17160000
                                              OF DCLGRANT-UPDATE-LOG.   17170000
            EXEC SQL                                                    17180000
                 INSERT INTO GRANT_UPDATE_LOG                           17190000
                        ( TME_UPDATE,                                   17200000
                          NUM_UPDATE_USERID,                            17210000
                          NUM_SOURCE_RECORD,                            17220000
                          NUM_ACTION,                                   17230000
                          NUM_RGSTRN,                                   17240000
                          NUM_GRANT_TYPE,                               17250000
                          TXT_BEFORE_IMAGE,                             17260000
                          TXT_AFTER_IMAGE )                             17270000
                 VALUES ( :DCLGRANT-UPDATE-LOG.TME-UPDATE,              17280000
                          :DCLGRANT-UPDATE-LOG.NUM-UPDATE-USERID,       17290000
                          :DCLGRANT-UPDATE-LOG.NUM-SOURCE-RECORD,       17300000
                          :DCLGRANT-UPDATE-LOG.NUM-ACTION,              17310000
                          :DCLGRANT-UPDATE-LOG.NUM-RGSTRN,              17320000
                          :DCLGRANT-UPDATE-LOG.NUM-GRANT-TYPE,          17330000
                          :DCLGRANT-UPDATE-LOG.TXT-BEFORE-IMAGE,        17340000
                          :DCLGRANT-UPDATE-LOG.TXT-AFTER-IMAGE )        17350000
            END-EXEC.                                                   17360000
                                                                        17370000
            EVALUATE SQLCODE                                            17380000
               WHEN 000                                                 17390000
                    ADD 1                 TO WS-GRNT-UPD-LOG            17400000
                                                                        17410000
               WHEN -803                                                17420000
                    CONTINUE                                            17430000
                                                                        17440000
               WHEN OTHER                                               17450000
                    MOVE SQLCODE          TO WS-SQLCODE                 17460000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_UPDATE_LOG'    17470000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            17480000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          17490000
            END-EVALUATE.                                               17500000
                                                                        17510000
       6400-EXIT.                                                       17520000
           EXIT.                                                        17530000
                                                                        17540000
      *--------------------*                                            17550000
       7000-DELETE-INTRAY.                                              17560000
      *--------------------*                                            17570000
           MOVE SPACES                    TO BE08W001-COMMAREA.         17580000
           INITIALIZE                        BE08W001-COMMAREA.         17590000
           MOVE 'D'                       TO W001-IN-TXN-TYPE.          17600000
           MOVE 'BP13'                    TO W001-IN-SYSTEM-ID.         17610000
           MOVE '0068'                    TO W001-IN-NUM-PRCS-CTGRY.    17620000
           MOVE FD10-NUM-REGN             TO W001-IN-NUM-CASE-REF.      17630000
           MOVE '000001'                  TO W001-IN-NUM-BRNCH.         17640000
           MOVE FD10-NUM-USERID           TO K010-NUM-USERID.           17650000
           PERFORM 7100-GET-STAFF-ID      THRU 7100-EXIT.               17660000
           MOVE K010-NUM-HDB-STAFF-ID     TO W001-IN-NUM-STAFF.         17670000
           MOVE FD10-NUM-REGN             TO W001-IN-HDBREF.            17680000
                                                                        17690000
           CALL 'BE08C001'    USING BE08W001-COMMAREA                   17700000
           IF W001-OUT-RTN-MSGCDE = ZEROES                              17710000
              ADD 1 TO WS-INBOX-DELETE                                  17720000
           ELSE                                                         17730000
              DISPLAY 'ERROR IN BE08C001 ' FD10-NUM-REGN ' '            17740000
              DISPLAY W001-OUT-RTN-MSGNO '-' W001-OUT-RTN-DESC          17750000
      *       MOVE 99 TO RETURN-CODE                                    17760000
           END-IF.                                                      17770000
                                                                        17780000
       7000-EXIT.                                                       17790000
           EXIT.                                                        17800000
                                                                        17810000
      *---------------------------------------------------------------* 17820000
       7100-GET-STAFF-ID.                                               17830000
      *---------------------------------------------------------------* 17840000
           READ SY08K010 KEY IS K010-NUM-USERID.                        17850000
           EVALUATE WS-K010-STATUS                                      17860000
           WHEN 00                                                      17870000
                CONTINUE                                                17880000
           WHEN 10                                                      17890000
           WHEN 23                                                      17900000
                DISPLAY 'SY08K010 RECORD NOT FOUND: '                   17910000
                         K010-NUM-USERID                                17920000
           WHEN OTHER                                                   17930000
                DISPLAY 'SY08K010 READ ERROR: ' WS-K010-STATUS          17940000
                MOVE WS-K010-STATUS       TO RETURN-CODE                17950000
                PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT             17960000
           END-EVALUATE.                                                17970000
                                                                        17980000
       7100-EXIT.                                                       17990000
           EXIT.                                                        18000000
                                                                        18010000
      *-----------------*                                               18020000
       9000-CLOSE-FILES.                                                18030000
      *-----------------*                                               18040000
                                                                        18050000
           DISPLAY '******  BP13CB0C *************'.                    18060000
           DISPLAY 'NO OF RECS READ FROM  AG07F630  : ' CNT-F630-READ.  18070000
           DISPLAY 'NO OF RECS READ FROM  BP13FD10  : ' CNT-FD10-READ.  18080000
           DISPLAY 'NO OF RECS MATCHED F630/FD10    : ' WS-MATCH-REC.   18090000
           DISPLAY 'NO OF RECS READ FROM  BP13KD10  : ' CNT-KD10-READ.  18100000
           DISPLAY 'NO OF FD10 WRITTEN TO BP13FD10  : ' CNT-FD10-WRITE. 18110000
           DISPLAY 'NO OF RECS WRITTEN TO BP13F125  : ' CNT-F125-WRITE. 18120000
           DISPLAY 'NO OF RECS DELETED FR BP13KD10  : ' CNT-KD10-DELETE.18130000
           DISPLAY 'NO OF RECS UPDATED IN ASMNT TBLE: ' CNT-ASMNT-UPD.  18140000
           DISPLAY 'NO OF RECS MOVED TO EX GRANT ASMT:' WS-EX-GRANT-INS.18150000
           DISPLAY 'NO OF RECS MOVED TO EX GRANT PRSN:' WS-EX-PRSN-INS. 18160000
           DISPLAY 'NO OF RECS MOVED TO GRANT RCVRY : ' WS-RCVRY-INS.   18170000
           DISPLAY 'NO OF RECS CREATED IN UPDATE LOG: ' WS-GRNT-UPD-LOG 18180000
           DISPLAY 'NO OF RECS DELETED FROM IN-TRAY : ' WS-INBOX-DELETE.18190000
           DISPLAY 'NO OF RECS WRITTEN TO BP13LB0C  : ' CNT-PRT-CASES.  18200000
                                                                        18210000
           CLOSE BP13KD10                                               18220000
                 AG07F630                                               18230000
                 SY08K010                                               18240000
                 P13FD10A                                               18250000
                 P13FD10B                                               18260000
                 BP13LB0C                                               18270000
                 BP13F125.                                              18280000
                                                                        18290000
           IF WS-KD10-STATUS NOT = 0 AND 97                             18300000
              DISPLAY ' CLOSING ERROR, WS-KD10-STATUS ' WS-KD10-STATUS  18310000
              MOVE WS-KD10-STATUS TO RETURN-CODE.                       18320000
                                                                        18330000
           STOP RUN.                                                    18340000
                                                                        18350000
       9000-EXIT.                                                       18360000
            EXIT.                                                       18370000
                                                                        18380000
      *---------------------------------------------------------------- 18390000
       9999-SQL-ERROR.                                                  18400000
      *---------------------------------------------------------------- 18410000
           CALL 'DBATIAR'  USING SQLCA.                                 18420000
           EXEC SQL ROLLBACK               END-EXEC.                    18430000
           MOVE 99                         TO    WS-RETURN-CODE.        18440000
           PERFORM 9000-CLOSE-FILES        THRU  9000-EXIT.             18450000
                                                                        18460000
       9999-EXIT.                                                       18470000
           EXIT.                                                        18480000
