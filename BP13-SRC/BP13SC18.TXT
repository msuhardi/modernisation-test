/*-----------------------------------------------------------------*/           
/* SYSTEM OF COMMITMENT - DBSS  (BP13)                             */           
/* OBJECTIVE   : REPORT FOR UNDER HDB LOAN                         */           
/* INPUT FILES : BP13FD04                                          */           
/* DATE        : MAY 21 2007                                       */           
/* AUTHOR      : BALA AMUTHAN                                      */           
/*-----------------------------------------------------------------*/           
/*-----------------------------------------------------------------*/           
/* PROGRAM TO PRINT STATUS OF DBSS LOAN ACCOUNT ON EVERY MONTH     */           
/*-----------------------------------------------------------------*/           
/* CHG-NO   BY  ON           DESCRIPTION                           */           
/* -------- --  --           ------------                          */           
/* BP133052 BA2 21/05/2007   NEW PRG.                              */           
/* BP133131 JB8 07/03/2008   SEPERATE THE REPORT BY PROJECT NAME   */           
/* BP133314 JB8 05/06/2009   PRINT TOTAL AT LAST.                  */           
/*-----------------------------------------------------------------*/           
                                                                                
     PROC FORMAT;                                                               
        PICTURE NUMBA (ROUND) 0-HIGH = '09.999';                                
                                                                                
DATA BP13FD04;                                                                  
     INFILE BP13FD04;                                                           
     INPUT @22   NUM_PJT                  $CHAR3.                               
           @25   SELL_PRICE               $8.                                   
           @289  LOAN_GRT                 ZDV9.2                                
           @1663 TYP_ACTUSE               $CHAR2.;                              
                                                                                
  /* READING BP13KA10 FOR GETTING PROJECT NAME                       */         
        LENGTH KA10_KEY $3;                                                     
        KA10_KEY = NUM_PJT;                                                     
        INFILE BP13KA10 VSAM KEY = KA10_KEY;                                    
        INPUT @;                                                                
        RC = _IORC_;                                                            
        IF RC = 0 THEN                                                          
           DO;                                                                  
              INPUT @38  NME_PJT      $CHAR30.;                                 
           END;                                                                 
                                                                                
   IF LOAN_GRT > 0;                                                             
                                                                                
    LENGTH ROOMTYPE $5.;                                                        
    IF TYP_ACTUSE =  '06' THEN                                                  
       ROOMTYPE='EX' || ' ' || 'RM';                                            
    ELSE                                                                        
       ROOMTYPE= ' ' || TRIM(SUBSTR(TYP_ACTUSE,2,1)) || ' ' || 'RM';            
                                                                                
                                                                                
PROC SORT;                                                                      
     BY NUM_PJT TYP_ACTUSE;                                                     
                                                                                
DATA SY02F001;                                                                  
     INFILE SY02F001 END = EOF1;                                                
     INPUT  @01  DATE_CYM_CURR        YYMMDD8.                                  
            @21  DATE_YMD_PREV        YYMMDD8.;                                 
                                                                                
     CALL SYMPUT ('CURR_DTE',(PUT(DATE_CYM_CURR,DDMMYY10.)));                   
     CALL SYMPUT ('PREV_DTE',(PUT(DATE_YMD_PREV,DDMMYY10.)));                   
                                                                                
DATA BP13TEMP;                                                                  
                                                                                
     SET BP13FD04 END = EOF NOBS=TOTAL;                                         
         BY NUM_PJT TYP_ACTUSE;                                                 
     OPTIONS PAGESIZE = 55 LS = 132 NODATE;                                     
     FILE BP13LC18 NOTITLES HEADER = HH;                                        
                                                                                
     IF TOTAL = 0 THEN                                                          
        DO;                                                                     
          PUT _PAGE_;                                                           
          PUT // @1 '*** NO RECORDS PRINTED IN THIS RUN';                       
        END;                                                                    
                                                                                
                                                                                
     IF FIRST.NUM_PJT THEN                                                      
        DO;                                                                     
          PUT _PAGE_;                                                           
          LENGTH NO_UNIT           5.;                                          
          LENGTH SELL_PRICE_TYP    8.;                                          
          LENGTH LOAN_GRT_TYP      8.;                                          
          LENGTH AVG_SELL_PRICE    8.;                                          
          LENGTH AVG_LOAN_GRT      8.;                                          
          LENGTH TOT_PER_TYPE      8.;                                          
          LENGTH AVG_PER           8.;                                          
                                                                                
          LENGTH TOT_UNITS         8.;                                          
          LENGTH TOT_SELL_PRICE    8.;                                          
          LENGTH TOT_LOAN_GRT      8.;                                          
          LENGTH TOT_AVG_SELL      8.;                                          
          LENGTH TOT_AVG_LOAN      8.;                                          
          LENGTH TOT_PER           8.;                                          
          LENGTH TOT_PER_AVE       8.;                                          
                                                                                
          RETAIN NO_UNIT SELL_PRICE_TYP LOAN_GRT_TYP AVG_SELL_PRICE             
                 TOT_SELL_PRICE TOT_LOAN_GRT TOT_AVG_SELL TOT_AVG_LOAN          
                 TOT_PER AVG_PER TOT_UNITS TOT_PER_AVE TOT_PER_TYPE             
                 AVG_LOAN_GRT;                                                  
                                                                                
          NO_UNIT=0; SELL_PRICE_TYP=0; LOAN_GRT_TYP=0; AVG_SELL_PRICE=0;        
          AVG_LOAN_GRT=0; TOT_SELL_PRICE=0; TOT_LOAN_GRT=0;                     
          TOT_AVG_SELL=0; TOT_AVG_LOAN=0; TOT_PER=0; AVG_PER=0;                 
          TOT_UNITS=0; TOT_PER_AVE=0; TOT_PER_TYPE=0;                           
        END;                                                                    
                                                                                
     IF FIRST.TYP_ACTUSE THEN                                                   
        DO;                                                                     
          NO_UNIT=0;                                                            
          SELL_PRICE_TYP=0;                                                     
          LOAN_GRT_TYP=0;                                                       
          AVG_SELL_PRICE=0;                                                     
          AVG_LOAN_GRT=0;                                                       
          TOT_PER_TYPE=0;                                                       
          AVG_PER=0;                                                            
       END;                                                                     
                                                                                
     IF SELL_PRICE = '        ' THEN                                            
        SELL_PRICE=0;                                                           
                                                                                
     IF LOAN_GRT = '           ' THEN                                           
        LOAN_GRT=0;                                                             
                                                                                
     NO_UNIT = NO_UNIT + 1;                                                     
     TOT_UNITS + 1;                                                             
     SELL_PRICE_TYP=SELL_PRICE_TYP+SELL_PRICE;                                  
     TOT_SELL_PRICE=TOT_SELL_PRICE+SELL_PRICE;                                  
     LOAN_GRT_TYP=LOAN_GRT_TYP+LOAN_GRT;                                        
     TOT_LOAN_GRT=TOT_LOAN_GRT+LOAN_GRT;                                        
                                                                                
                                                                                
    IF LAST.TYP_ACTUSE THEN                                                     
      DO;                                                                       
        IF TYP_ACTUSE = '01' THEN                                               
           DO;                                                                  
              F_1R_UNIT + NO_UNIT;                                              
              F_1R_PRICE + SELL_PRICE_TYP;                                      
              F_1R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
        IF TYP_ACTUSE = '02' THEN                                               
           DO;                                                                  
              F_2R_UNIT + NO_UNIT;                                              
              F_2R_PRICE + SELL_PRICE_TYP;                                      
              F_2R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
        IF TYP_ACTUSE = '03' THEN                                               
           DO;                                                                  
              F_3R_UNIT + NO_UNIT;                                              
              F_3R_PRICE + SELL_PRICE_TYP;                                      
              F_3R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
        IF TYP_ACTUSE = '04' THEN                                               
           DO;                                                                  
              F_4R_UNIT + NO_UNIT;                                              
              F_4R_PRICE + SELL_PRICE_TYP;                                      
              F_4R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
                                                                                
        IF TYP_ACTUSE = '05' THEN                                               
           DO;                                                                  
              F_5R_UNIT + NO_UNIT;                                              
              F_5R_PRICE + SELL_PRICE_TYP;                                      
              F_5R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
        IF TYP_ACTUSE = '06' THEN                                               
           DO;                                                                  
              F_6R_UNIT + NO_UNIT;                                              
              F_6R_PRICE + SELL_PRICE_TYP;                                      
              F_6R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
        IF TYP_ACTUSE = '07' THEN                                               
           DO;                                                                  
              F_7R_UNIT + NO_UNIT;                                              
              F_7R_PRICE + SELL_PRICE_TYP;                                      
              F_7R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
        IF TYP_ACTUSE = '08' THEN                                               
           DO;                                                                  
              F_8R_UNIT + NO_UNIT;                                              
              F_8R_PRICE + SELL_PRICE_TYP;                                      
              F_8R_GRANT + LOAN_GRT_TYP;                                        
           END;                                                                 
         AVG_SELL_PRICE=SELL_PRICE_TYP/NO_UNIT;                                 
         TOT_AVG_SELL=TOT_AVG_SELL+AVG_SELL_PRICE;                              
                                                                                
         AVG_LOAN_GRT=LOAN_GRT_TYP/NO_UNIT;                                     
         TOT_AVG_LOAN=TOT_AVG_LOAN+AVG_LOAN_GRT;                                
                                                                                
         TOT_PER_TYPE=(LOAN_GRT_TYP/SELL_PRICE_TYP)*100;                        
                                                                                
         AVG_PER=(AVG_LOAN_GRT/AVG_SELL_PRICE)*100;                             
                                                                                
                                                                                
         IF TOT_PER_TYPE = '        ' THEN                                      
            TOT_PER_TYPE=0;                                                     
                                                                                
         IF AVG_PER = '        ' THEN                                           
            AVG_PER=0;                                                          
                                                                                
         LINK HH1;                                                              
         PUT @01    ' |  '                                                      
         PUT @05    ROOMTYPE $9.                                                
         PUT @14    '|     '                                                    
         PUT @20    NO_UNIT   5.                                                
         PUT @25    '    |'                                                     
         PUT @30    SELL_PRICE_TYP COMMA15.                                     
         PUT @45    ' | '                                                       
         PUT @47    AVG_SELL_PRICE COMMA14.2                                    
         PUT @61    '|'                                                         
         PUT @62    LOAN_GRT_TYP   COMMA16.2                                    
         PUT @78    '|'                                                         
         PUT @79    AVG_LOAN_GRT   COMMA14.2                                    
         PUT @93    '|    '                                                     
         PUT @98    TOT_PER_TYPE   NUMBA                                        
         PUT @104   '  |   '                                                    
         PUT @110   AVG_PER        NUMBA                                        
         PUT @116   '     '                                                     
         PUT @121   '|'                                                         
         PUT @122   '           ';                                              
         LINK HH2;                                                              
       END;                                                                     
                                                                                
    IF LAST.NUM_PJT THEN                                                        
       DO;                                                                      
         FNL_NO_UNIT+TOT_UNITS;                                                 
         FNL_SELL_PRICE_TYP+TOT_SELL_PRICE;                                     
         FNL_LOAN_GRT_TYP+TOT_LOAN_GRT;                                         
         FNL_AVG_SELL_PRICE+TOT_AVG_SELL;                                       
         FNL_AVG_LOAN_GRT+TOT_AVG_LOAN;                                         
                                                                                
         TOT_PER=(TOT_LOAN_GRT/TOT_SELL_PRICE)*100;                             
         TOT_PER_AVE=(TOT_AVG_LOAN/TOT_AVG_SELL)*100;                           
                                                                                
         LINK HH1;                                                              
         PUT @01    ' |  '                                                      
         PUT @05    '  TOTAL  '                                                 
         PUT @14    '|     '                                                    
         PUT @20    TOT_UNITS   5.                                              
         PUT @25    '    |'                                                     
         PUT @30    TOT_SELL_PRICE COMMA15.                                     
         PUT @45    ' | '                                                       
         PUT @47    TOT_AVG_SELL   COMMA14.2                                    
         PUT @61    '|'                                                         
         PUT @62    TOT_LOAN_GRT   COMMA16.2                                    
         PUT @78    '|'                                                         
         PUT @79    TOT_AVG_LOAN   COMMA14.2                                    
         PUT @93    '|    '                                                     
         PUT @98    TOT_PER        NUMBA                                        
         PUT @104   '  |   '                                                    
         PUT @110   TOT_PER_AVE    NUMBA                                        
         PUT @116   '     '                                                     
         PUT @121   '|'                                                         
         PUT @122   '           ';                                              
         LINK HH2;                                                              
      END;                                                                      
                                                                                
    IF EOF THEN                                                                 
       DO;                                                                      
         NME_PJT = 'TOTAL';                                                     
                                                                                
         PUT _PAGE_;                                                            
                                                                                
         IF F_1R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_1R_AVR_PRC=(F_1R_PRICE/F_1R_UNIT);                             
               F_1R_AVR_GRT=(F_1R_GRANT/F_1R_UNIT);                             
               F_1R_TOT_PER=(F_1R_GRANT/F_1R_PRICE)*100;                        
               F_1R_AVG_PER=(F_1R_AVR_GRT/F_1R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   1 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_1R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_1R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_1R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_1R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_1R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_1R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_1R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         IF F_2R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_2R_AVR_PRC=(F_2R_PRICE/F_2R_UNIT);                             
               F_2R_AVR_GRT=(F_2R_GRANT/F_2R_UNIT);                             
               F_2R_TOT_PER=(F_2R_GRANT/F_2R_PRICE)*100;                        
               F_2R_AVG_PER=(F_2R_AVR_GRT/F_2R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   2 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_2R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_2R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_2R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_2R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_2R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_2R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_2R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         IF F_3R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_3R_AVR_PRC=(F_3R_PRICE/F_3R_UNIT);                             
               F_3R_AVR_GRT=(F_3R_GRANT/F_3R_UNIT);                             
               F_3R_TOT_PER=(F_3R_GRANT/F_3R_PRICE)*100;                        
               F_3R_AVG_PER=(F_3R_AVR_GRT/F_3R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   3 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_3R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_3R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_3R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_3R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_3R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_3R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_3R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         IF F_4R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_4R_AVR_PRC=(F_4R_PRICE/F_4R_UNIT);                             
               F_4R_AVR_GRT=(F_4R_GRANT/F_4R_UNIT);                             
               F_4R_TOT_PER=(F_4R_GRANT/F_4R_PRICE)*100;                        
               F_4R_AVG_PER=(F_4R_AVR_GRT/F_4R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   4 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_4R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_4R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_4R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_4R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_4R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_4R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_4R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         IF F_5R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_5R_AVR_PRC=(F_5R_PRICE/F_5R_UNIT);                             
               F_5R_AVR_GRT=(F_5R_GRANT/F_5R_UNIT);                             
               F_5R_TOT_PER=(F_5R_GRANT/F_5R_PRICE)*100;                        
               F_5R_AVG_PER=(F_5R_AVR_GRT/F_5R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   5 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_5R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_5R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_5R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_5R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_5R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_5R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_5R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         IF F_6R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_6R_AVR_PRC=(F_6R_PRICE/F_6R_UNIT);                             
               F_6R_AVR_GRT=(F_6R_GRANT/F_6R_UNIT);                             
               F_6R_TOT_PER=(F_6R_GRANT/F_6R_PRICE)*100;                        
               F_6R_AVG_PER=(F_6R_AVR_GRT/F_6R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   6 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_6R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_6R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_6R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_6R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_6R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_6R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_6R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         IF F_7R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_7R_AVR_PRC=(F_7R_PRICE/F_7R_UNIT);                             
               F_7R_AVR_GRT=(F_7R_GRANT/F_7R_UNIT);                             
               F_7R_TOT_PER=(F_7R_GRANT/F_7R_PRICE)*100;                        
               F_7R_AVG_PER=(F_7R_AVR_GRT/F_7R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   7 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_7R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_7R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_7R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_7R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_7R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_7R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_7R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         IF F_8R_UNIT > 0 THEN                                                  
            DO;                                                                 
               F_8R_AVR_PRC=(F_8R_PRICE/F_8R_UNIT);                             
               F_8R_AVR_GRT=(F_8R_GRANT/F_8R_UNIT);                             
               F_8R_TOT_PER=(F_8R_GRANT/F_8R_PRICE)*100;                        
               F_8R_AVG_PER=(F_8R_AVR_GRT/F_8R_AVR_PRC)*100;                    
               LINK HH1;                                                        
               PUT @01    ' |  '                                                
               PUT @05    '   8 RM  '                                           
               PUT @14    '|     '                                              
               PUT @20    F_8R_UNIT   5.                                        
               PUT @25    '    |'                                               
               PUT @30    F_8R_PRICE     COMMA15.                               
               PUT @45    ' | '                                                 
               PUT @47    F_8R_AVR_PRC   COMMA14.2                              
               PUT @61    '|'                                                   
               PUT @62    F_8R_GRANT     COMMA16.2                              
               PUT @78    '|'                                                   
               PUT @79    F_8R_AVR_GRT   COMMA14.2                              
               PUT @93    '|    '                                               
               PUT @98    F_8R_TOT_PER   NUMBA                                  
               PUT @104   '  |   '                                              
               PUT @110   F_8R_AVG_PER   NUMBA                                  
               PUT @116   '     '                                               
               PUT @121   '|'                                                   
               PUT @122   '           ';                                        
               LINK HH2;                                                        
            END;                                                                
         FNL_TOT_PER_TYPE=(FNL_LOAN_GRT_TYP/FNL_SELL_PRICE_TYP)*100;            
         FNL_AVG_PER=(FNL_AVG_LOAN_GRT/FNL_AVG_SELL_PRICE)*100;                 
         LINK HH1;                                                              
         PUT @01    ' |  '                                                      
         PUT @05    '  TOTAL  '                                                 
         PUT @14    '|     '                                                    
         PUT @20    FNL_NO_UNIT 5.                                              
         PUT @25    '    |'                                                     
         PUT @30    FNL_SELL_PRICE_TYP  COMMA15.                                
         PUT @45    ' | '                                                       
         PUT @47    FNL_AVG_SELL_PRICE  COMMA14.2                               
         PUT @61    '|'                                                         
         PUT @62    FNL_LOAN_GRT_TYP    COMMA16.2                               
         PUT @78    '|'                                                         
         PUT @79    FNL_AVG_LOAN_GRT    COMMA14.2                               
         PUT @93    '|    '                                                     
         PUT @98    FNL_TOT_PER_TYPE    NUMBA                                   
         PUT @104   '  |   '                                                    
         PUT @110   FNL_AVG_PER         NUMBA                                   
         PUT @116   '     '                                                     
         PUT @121   '|'                                                         
         PUT @122   '           ';                                              
         LINK HH2;                                                              
      END;                                                                      
                                                                                
RETURN;                                                                         
                                                                                
  HH:                                                                           
    PAGE+1;                                                                     
    CURRENT=DATE();                                                             
    PUT @01 '  '/;                                                              
    PUT /@01       'BP13LC18'                                                   
        @12        'HDBCAT3'                                                    
        @46   'S Y S T E M   O F   C O M M I T M E N T'                         
        @105 'PAGE : ' @113 PAGE 4./                                            
        @02  NME_PJT CHAR30.                                                    
        @39  'AVERAGE % OF LOAN GRANTED FOR DBSS CASES UNDER HDB LOAN'          
        @105 'DATE : ' @113 "&CURR_DTE"/                                        
    PUT @01 ' '/;                                                               
    PUT @02 ' __________________________________________________________________
____________________________________________________';                          
                                                                                
    PUT @02   '|           |              |'                                    
    PUT @30   '                               |'                                
    PUT @62   '                               |'                                
    PUT @94   '                           |';                                   
                                                                                
    PUT @02   '|           |              |'                                    
    PUT @30   '        SELLING PRICES         |'                                
    PUT @62   '         LOAN GRANTED          |'                                
    PUT @94   '    % OF LOAN GRANTED      |';                                   
                                                                                
    PUT @02   '|___________|______________|'                                    
    PUT @30   '_______________________________|'                                
    PUT @62   '_______________________________|'                                
    PUT @94   '___________________________|';                                   
                                                                                
    LINK HH1;                                                                   
                                                                                
    PUT @02   '|ROOM TYPE  | NO. OF UNITS |'                                    
    PUT @30   '     TOTAL      |   AVERAGE    |'                                
    PUT @62   '     TOTAL      |   AVERAGE    |'                                
    PUT @94   '    TOTAL   |   AVERAGE    |';                                   
                                                                                
    LINK HH2;                                                                   
    RETURN;                                                                     
                                                                                
  HH1:                                                                          
    PUT @02   '|           |              |'                                    
    PUT @30   '                |              |'                                
    PUT @62   '                |              |'                                
    PUT @94   '            |              |';                                   
    RETURN;                                                                     
                                                                                
  HH2:                                                                          
    PUT @02   '|___________|______________|'                                    
    PUT @30   '________________|______________|'                                
    PUT @62   '________________|______________|'                                
    PUT @94   '____________|______________|';                                   
    RETURN;                                                                     
                                                                                
