      *===============================================================*         
       IDENTIFICATION DIVISION.                                                 
      *===============================================================*         
       PROGRAM-ID.    BP13CD38.                                                 
       AUTHOR.        CATHERINE TAN WEI LING.                                   
       DATE-WRITTEN.  APR 16, 2012.                                             
      *===============================================================*         
      * OBJECTIVE  :  PRINT BTO SHORTLISTED CASES WITH EMAIL ADDRESS. *         
      *===============================================================*         
      *                                                               *         
      * INPUT FILE :                                                  *         
      *               1. BP13F800                                     *         
      *               2. BP13K857                                     *         
      *                                                               *         
      * OUTPUT FILE:  1. P13LD35A                                     *         
      *               2. P13LD35B                                     *         
      *               3. P13LD35C                                     *         
      *               4. P13LD35D                                     *         
      *               5. P13F203A                                     *         
      *               6. P13F203B                                     *         
      *               7. P13F203C                                     *         
      *               8. P13F203D                                     *         
      *                                                               *         
      *===============================================================*         
      * REF NO   DATE       BY   AMENDMENTS/ENHANCEMENTS              *         
      *---------------------------------------------------------------*         
      * BP134481 16/04/2012 CT2  NEW PROGRAM FOR SORTING EIP CASES    *         
      * BP134796 16/04/2012 CT2  ADD MATURE ESTATE TAG                *         
      * BP135190 04/12/2013 SMR2 EXPAND BP13K813 TO 1000              *         
      *===============================================================*         
                                                                                
                                                                                
      **********************                                                    
       ENVIRONMENT DIVISION.                                                    
      **********************                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT  BP13F800  ASSIGN        TO BP13F800.                         
                                                                                
           SELECT  BP13K857  ASSIGN        TO BP13K857                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K857-KEY-FLD                      
                             FILE STATUS   IS WS-K857-STATUS.                   
                                                                                
           SELECT  BP13K813  ASSIGN        TO BP13K813                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K813-KEY-FLD                      
                             FILE STATUS   IS WS-K813-STATUS.                   
                                                                                
           SELECT  P13LD35A  ASSIGN        TO P13LD35A.                         
                                                                                
           SELECT  P13F203A  ASSIGN        TO P13F203A.                         
                                                                                
           SELECT  P13LD35B  ASSIGN        TO P13LD35B.                         
                                                                                
           SELECT  P13F203B  ASSIGN        TO P13F203B.                         
                                                                                
           SELECT  P13LD35C  ASSIGN        TO P13LD35C.                         
                                                                                
           SELECT  P13F203C  ASSIGN        TO P13F203C.                         
                                                                                
      ***************                                                           
       DATA DIVISION.                                                           
      ***************                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F800                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F800.                                                           
                                                                                
       FD   BP13K857                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K857.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   P13LD35A                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   P13LD35A-REC               PIC X(132).                              
                                                                                
                                                                                
       FD   P13F203A                                                            
            RECORD CONTAINS 200 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       01   P13F203A-REC               PIC X(200).                              
                                                                                
       FD   P13LD35B                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   P13LD35B-REC               PIC X(132).                              
                                                                                
                                                                                
       FD   P13F203B                                                            
            RECORD CONTAINS 200 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       01   P13F203B-REC               PIC X(200).                              
                                                                                
       FD   P13LD35C                                                            
            BLOCK  CONTAINS 0 RECORDS                                           
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL RECORD IS OMITTED                                             
            RECORDING MODE IS F.                                                
       01   P13LD35C-REC               PIC X(132).                              
                                                                                
                                                                                
       FD   P13F203C                                                            
            RECORD CONTAINS 200 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       01   P13F203C-REC               PIC X(200).                              
                                                                                
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
      *                   WORKING-STORAGE AREA                         *        
      ******************************************************************        
                                                                                
       COPY BP13F23A.                                                           
                                                                                
       01  FILE-VARIABLES.                                                      
           05  WS-EOF-F800             PIC X(1)  VALUE 'N'.                     
           05  WS-K857-FOUND           PIC X(1)  VALUE 'N'.                     
           05  WS-K857-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K813-STATUS          PIC 9(02) VALUE ZEROES.                  
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F800-READ            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K813-FND             PIC 9(7)  VALUE ZEROES.                  
           05  WS-K813-NFND            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K857-FND             PIC 9(7)  VALUE ZEROES.                  
           05  WS-K857-NFND            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K857-NCAT            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K857-EMAIL           PIC 9(7)  VALUE ZEROES.                  
           05  WS-PAGE-CTR             PIC 9(4)  VALUE ZEROES.                  
           05  WS-SNO-A                PIC 9(7)  VALUE ZEROES.                  
           05  WS-SNO-B                PIC 9(7)  VALUE ZEROES.                  
           05  WS-SNO-C                PIC 9(7)  VALUE ZEROES.                  
           05  WS-SNO-D                PIC 9(7)  VALUE ZEROES.                  
           05  WS-CNT-OUTA             PIC 9(7)  VALUE ZEROES.                  
           05  WS-CNT-OUTB             PIC 9(7)  VALUE ZEROES.                  
           05  WS-CNT-OUTC             PIC 9(7)  VALUE ZEROES.                  
           05  WS-CNT-OUTD             PIC 9(7)  VALUE ZEROES.                  
           05  WS-F800-QUEUE           PIC 9(5)  VALUE ZEROES.                  
           05  WS-K813-MID             PIC 9(5)  VALUE ZEROES.                  
           05  WS-K813-END             PIC 9(5)  VALUE ZEROES.                  
           05  WS-TYPE-APPMT           PIC X(2)  VALUE SPACES.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-SYSTEM-DATE           PIC 9(8)  VALUE ZEROES.                  
           05 WS-SNO-ZZZZ9             PIC ZZZZ9 VALUE ZEROES.                  
                                                                                
       01  LD35-HEADER01.                                                       
           05  LD35-TITLE-HDR      PIC X(17)     VALUE 'BP13LD35'.              
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                  'S Y S T E M   O F   '.                       
           05  FILLER              PIC X(19) VALUE                              
                                  'C O M M I T M E N T'.                        
           05  FILLER              PIC X(15)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LD35-DATE-HDR       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LD35-PAGE-HDR       PIC ZZZ9      VALUE ZEROES.                  
                                                                                
       01  LD35-HEADER02.                                                       
           05  FILLER              PIC X(45)     VALUE SPACES.                  
           05  FILLER              PIC X(52)     VALUE                          
               'REPORT ON BTO SHORLISTED CASES WITH EMAIL ADDRESS'.             
                                                                                
       01  LD35-HEADER03.                                                       
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(07)    VALUE '    S/N'.                
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(08)    VALUE 'REGN NO '.               
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(05)    VALUE 'QUEUE'.                  
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(05)    VALUE 'ZONE '.                  
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(02)    VALUE 'FT'.                     
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(13)    VALUE 'EMAIL ADDRESS'.          
           05  FILLER              PIC X(02)    VALUE SPACES.                   
                                                                                
       01  LD35-DETAIL01.                                                       
           05  FILLER              PIC X(01)        VALUE SPACES.               
           05  LD35-SN             PIC X(07)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LD35-REGN           PIC X(08)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LD35-QUEUE          PIC X(05)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LD35-ZONE           PIC X(05)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LD35-FT             PIC X(02)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LD35-EMAIL          PIC X(50)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
                                                                                
      ******************************************************************        
      *                   P R O G R A M     B O D Y                    *        
      ******************************************************************        
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
                                                                                
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
                                                                                
           PERFORM 1000-OPEN-ROUTINE       THRU 1000-EXIT.                      
                                                                                
           PERFORM 2000-READ-BP13F800      THRU 2000-EXIT.                      
                                                                                
           PERFORM 3000-PROCESS-RECORDS    THRU 3000-EXIT                       
             UNTIL WS-EOF-F800 = 'Y'.                                           
                                                                                
           PERFORM 9999-CLOSE-ROUTINE      THRU 9999-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           OPEN INPUT  BP13F800                                                 
                       BP13K857                                                 
                       BP13K813                                                 
              OUTPUT   P13LD35A                                                 
                       P13F203A                                                 
                       P13LD35B                                                 
                       P13F203B                                                 
                       P13LD35C                                                 
                       P13F203C.                                                
                                                                                
           IF WS-K857-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K857 - ERROR OPENING : ' WS-K857-STATUS              
              MOVE WS-K857-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE         THRU 9999-EXIT                
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K813 - ERROR OPENING : ' WS-K813-STATUS              
              MOVE WS-K813-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE         THRU 9999-EXIT                
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)          TO WS-SYSTEM-DATE.          
           MOVE 1                                   TO LD35-PAGE-HDR.           
                                                                                
           STRING WS-SYSTEM-DATE(7:2) '/'                                       
                  WS-SYSTEM-DATE(5:2) '/'                                       
                  WS-SYSTEM-DATE(1:4)                                           
                  DELIMITED BY SIZE INTO LD35-DATE-HDR.                         
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       2000-READ-BP13F800.                                                      
      ******************************************************************        
                                                                                
           READ BP13F800           AT   END                                     
                MOVE 'Y'           TO   WS-EOF-F800                             
                GO                 TO   2000-EXIT.                              
                                                                                
           IF F800-NUM-NT-FT-QUEUE NOT NUMERIC                                  
              MOVE ZEROES          TO F800-NUM-NT-FT-QUEUE                      
           END-IF.                                                              
                                                                                
           MOVE F800-NUM-NT-FT-QUEUE TO WS-F800-QUEUE.                          
                                                                                
           ADD  1                    TO WS-F800-READ.                           
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3000-PROCESS-RECORDS.                                                    
      ******************************************************************        
                                                                                
           PERFORM 4000-READ-BP13K857                   THRU 4000-EXIT.         
           PERFORM 5000-READ-BP13K813                   THRU 5000-EXIT.         
                                                                                
           IF WS-K857-FOUND = 'Y'                                               
                                                                                
                  IF (WS-F800-QUEUE <= WS-K813-MID) AND                         
                     (WS-F800-QUEUE > 0)                                        
                     IF F800-NUM-FLAT-TYPE(1:1) = '1'                           
                         MOVE 'E2'                    TO WS-TYPE-APPMT          
                                                                                
                         PERFORM 6200-WRITE-P13LD35B     THRU 6200-EXIT         
                         PERFORM 6600-WRITE-P13F203B     THRU 6600-EXIT         
                     ELSE                                                       
                         IF F800-NUM-ALLO-SCHEME = 'FTS'                        
                            MOVE 'E3'     TO WS-TYPE-APPMT                      
                            PERFORM 6300-WRITE-P13LD35C THRU 6300-EXIT          
                            PERFORM 6700-WRITE-P13F203C THRU 6700-EXIT          
                         ELSE                                                   
                            MOVE 'E1'     TO WS-TYPE-APPMT                      
                            PERFORM 6100-WRITE-P13LD35A THRU 6100-EXIT          
                            PERFORM 6500-WRITE-P13F203A THRU 6500-EXIT          
                         END-IF                                                 
                     END-IF                                                     
                  END-IF                                                        
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F800                   THRU 2000-EXIT.         
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4000-READ-BP13K857.                                                      
      ******************************************************************        
                                                                                
           MOVE SPACES                                TO BP13K857-REC.          
           INITIALIZE                                    BP13K857-REC.          
                                                                                
           MOVE 'N'                                   TO WS-K857-FOUND.         
           MOVE F800-NUM-REGN                         TO K857-NUM-REGN.         
                                                                                
           READ BP13K857.                                                       
                                                                                
           EVALUATE WS-K857-STATUS                                              
               WHEN 00                                                          
                    IF K857-NUM-EMAIL NOT = SPACES AND LOW-VALUES               
                       MOVE 'Y'                       TO WS-K857-FOUND          
                    ELSE                                                        
                       MOVE 'N'                       TO WS-K857-FOUND          
                       ADD 1                          TO WS-K857-EMAIL          
                    END-IF                                                      
                                                                                
                    ADD 1                             TO WS-K857-FND            
               WHEN 23                                                          
                    ADD 1                             TO WS-K857-NFND           
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K857 : ' WS-K857-STATUS          
                            ' REGN = ' K857-NUM-REGN                            
                    PERFORM  9999-CLOSE-ROUTINE     THRU 9999-EXIT              
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5000-READ-BP13K813.                                                      
      ******************************************************************        
                                                                                
           MOVE SPACES                            TO BP13K813-REC.              
           INITIALIZE                                BP13K813-REC.              
                                                                                
           MOVE ZEROES                            TO WS-K813-MID                
                                                     WS-K813-END.               
                                                                                
           IF F800-NUM-ALLO-CAT    = 'BTO'                                      
              MOVE F800-NUM-BTO-ZONE              TO K813-NUM-ZONE              
           ELSE                                                                 
              IF F800-NUM-ALLO-CAT = 'SBF'                                      
                 MOVE F800-NUM-NEW-TOWN           TO K813-NUM-ZONE              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE F800-NUM-FLAT-TYPE                TO K813-NUM-FLAT-TYPE.        
           MOVE F800-DTE-BALLOT                   TO K813-DTE-BALLOT.           
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE WS-K813-STATUS                                              
               WHEN 00                                                          
                    ADD 1                         TO WS-K813-FND                
                    IF K813-NUM-QUEUE-MID NOT NUMERIC                           
                       MOVE ZEROES                TO K813-NUM-QUEUE-MID         
                    END-IF                                                      
                                                                                
                    MOVE K813-NUM-QUEUE-MID       TO WS-K813-MID                
                    IF K813-NUM-QUEUE-END NOT NUMERIC                           
                       MOVE ZEROES                TO K813-NUM-QUEUE-END         
                    END-IF                                                      
                                                                                
                    MOVE K813-NUM-QUEUE-END       TO WS-K813-END                
                                                                                
               WHEN 23                                                          
                    ADD 1                         TO WS-K813-NFND               
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K813 : ' WS-K813-STATUS          
                            ' ZONE = ' K813-NUM-ZONE                            
                    PERFORM  9999-CLOSE-ROUTINE     THRU 9999-EXIT              
           END-EVALUATE.                                                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       5100-PRINT-HEADER-A.                                                     
      ******************************************************************        
                                                                                
           MOVE 'P13LD35A (100%)'         TO LD35-TITLE-HDR.                    
           WRITE P13LD35A-REC    FROM LD35-HEADER01 AFTER PAGE.                 
           WRITE P13LD35A-REC    FROM LD35-HEADER02 AFTER 2.                    
           WRITE P13LD35A-REC    FROM LD35-HEADER03.                            
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5200-PRINT-HEADER-B.                                                     
      ******************************************************************        
                                                                                
           MOVE 'P13LD35B (100%)'         TO LD35-TITLE-HDR.                    
           WRITE P13LD35B-REC    FROM LD35-HEADER01 AFTER PAGE.                 
           WRITE P13LD35B-REC    FROM LD35-HEADER02 AFTER 2.                    
           WRITE P13LD35B-REC    FROM LD35-HEADER03.                            
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5300-PRINT-HEADER-C.                                                     
      ******************************************************************        
                                                                                
           MOVE 'P13LD35C (100%)'         TO LD35-TITLE-HDR.                    
           WRITE P13LD35C-REC    FROM LD35-HEADER01 AFTER PAGE.                 
           WRITE P13LD35C-REC    FROM LD35-HEADER02 AFTER 2.                    
           WRITE P13LD35C-REC    FROM LD35-HEADER03.                            
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6000-MOVE-BP13F23A.                                                      
      ******************************************************************        
                                                                                
           MOVE SPACES                        TO BP13F23A-REC.                  
           INITIALIZE                            BP13F23A-REC.                  
                                                                                
           MOVE F800-NUM-REGN                 TO F23A-NUM-REGN.                 
           MOVE F800-NUM-FLAT-TYPE            TO F23A-NUM-FLAT-TYPE.            
           MOVE WS-TYPE-APPMT                 TO F23A-TYPE-APPMT.               
           MOVE F800-DTE-BALLOT               TO F23A-DTE-BALLOT.               
           MOVE F800-NUM-NT-FT-QUEUE          TO F23A-NUM-QUEUE.                
           MOVE K813-NME-PROJECT-LTR          TO F23A-NUM-PRJ-NME.              
           MOVE K813-TXT-SEL-PERIOD-LTR       TO F23A-NUM-SEL-PERIOD.           
           MOVE K857-NUM-EMAIL                TO F23A-NUM-EMAIL.                
           MOVE K813-NUM-UNIT-OFFER           TO F23A-NUM-UNIT-OFFER.           
           MOVE K813-NUM-MATURE-EST-TAG   TO F23A-NUM-MATURE-EST-TAG.           
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6100-WRITE-P13LD35A.                                                     
      ******************************************************************        
                                                                                
           ADD 1                              TO WS-SNO-A.                      
                                                                                
           IF WS-SNO-A = 1                                                      
              PERFORM 5100-PRINT-HEADER-A   THRU 5100-EXIT                      
           END-IF.                                                              
                                                                                
           MOVE SPACES                        TO LD35-DETAIL01.                 
           INITIALIZE                            LD35-DETAIL01.                 
                                                                                
           MOVE WS-SNO-A                      TO LD35-SN.                       
           MOVE F800-NUM-REGN                 TO LD35-REGN.                     
           MOVE F800-NUM-ZONE                 TO LD35-ZONE.                     
           MOVE F800-NUM-NT-FT-QUEUE          TO LD35-QUEUE.                    
           MOVE F800-NUM-FLAT-TYPE            TO LD35-FT.                       
           MOVE K857-NUM-EMAIL                TO LD35-EMAIL.                    
                                                                                
           WRITE P13LD35A-REC              FROM LD35-DETAIL01.                  
           ADD 1                             TO WS-CNT-OUTA.                    
                                                                                
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6200-WRITE-P13LD35B.                                                     
      ******************************************************************        
                                                                                
           ADD 1                              TO WS-SNO-B.                      
                                                                                
           IF WS-SNO-B = 1                                                      
              PERFORM 5200-PRINT-HEADER-B   THRU 5200-EXIT                      
           END-IF.                                                              
                                                                                
           MOVE SPACES                        TO LD35-DETAIL01.                 
           INITIALIZE                            LD35-DETAIL01.                 
                                                                                
           MOVE WS-SNO-B                      TO LD35-SN.                       
           MOVE F800-NUM-REGN                 TO LD35-REGN.                     
           MOVE F800-NUM-ZONE                 TO LD35-ZONE.                     
           MOVE F800-NUM-NT-FT-QUEUE          TO LD35-QUEUE.                    
           MOVE F800-NUM-FLAT-TYPE            TO LD35-FT.                       
           MOVE K857-NUM-EMAIL                TO LD35-EMAIL.                    
                                                                                
           WRITE P13LD35B-REC              FROM LD35-DETAIL01.                  
           ADD 1                             TO WS-CNT-OUTB.                    
                                                                                
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6300-WRITE-P13LD35C.                                                     
      ******************************************************************        
                                                                                
           ADD 1                              TO WS-SNO-C.                      
                                                                                
           IF WS-SNO-C = 1                                                      
              PERFORM 5300-PRINT-HEADER-C   THRU 5300-EXIT                      
           END-IF.                                                              
                                                                                
           MOVE SPACES                        TO LD35-DETAIL01.                 
           INITIALIZE                            LD35-DETAIL01.                 
                                                                                
           MOVE WS-SNO-C                      TO LD35-SN.                       
           MOVE F800-NUM-REGN                 TO LD35-REGN.                     
           MOVE F800-NUM-ZONE                 TO LD35-ZONE.                     
           MOVE F800-NUM-NT-FT-QUEUE          TO LD35-QUEUE.                    
           MOVE F800-NUM-FLAT-TYPE            TO LD35-FT.                       
           MOVE K857-NUM-EMAIL                TO LD35-EMAIL.                    
                                                                                
           WRITE P13LD35C-REC              FROM LD35-DETAIL01.                  
           ADD 1                             TO WS-CNT-OUTC.                    
                                                                                
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6500-WRITE-P13F203A.                                                     
      ******************************************************************        
                                                                                
           PERFORM 6000-MOVE-BP13F23A       THRU 6000-EXIT.                     
                                                                                
           MOVE SPACES                        TO P13F203A-REC.                  
           INITIALIZE                            P13F203A-REC.                  
                                                                                
           WRITE P13F203A-REC               FROM BP13F23A-REC.                  
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6600-WRITE-P13F203B.                                                     
      ******************************************************************        
                                                                                
           PERFORM 6000-MOVE-BP13F23A       THRU 6000-EXIT.                     
                                                                                
           MOVE SPACES                        TO P13F203B-REC.                  
           INITIALIZE                            P13F203B-REC.                  
                                                                                
           WRITE P13F203B-REC               FROM BP13F23A-REC.                  
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6700-WRITE-P13F203C.                                                     
      ******************************************************************        
                                                                                
           PERFORM 6000-MOVE-BP13F23A       THRU 6000-EXIT.                     
                                                                                
           MOVE SPACES                        TO P13F203C-REC.                  
           INITIALIZE                            P13F203C-REC.                  
                                                                                
           WRITE P13F203C-REC               FROM BP13F23A-REC.                  
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       9999-CLOSE-ROUTINE.                                                      
      ******************************************************************        
                                                                                
           DISPLAY '*************** CONTROL    TOTALS ***************'.         
           DISPLAY 'PROGRAM-ID : BP13CD35'.                                     
           DISPLAY '-------------------------------------------------'.         
           DISPLAY ' (1) NO OF BP13F800 RECORDS READ............. : '           
                    WS-F800-READ.                                               
           DISPLAY ' (2) NO OF BP13K813 RECORDS FOUND............ : '           
                    WS-K813-FND.                                                
           DISPLAY ' (3) NO OF BP13K813 RECORDS NOT FOUND........ : '           
                    WS-K813-NFND.                                               
           DISPLAY ' (4) NO OF BP13K857 RECORDS FOUND............ : '           
                    WS-K857-FND.                                                
           DISPLAY ' (5) NO OF BP13K857 RECORDS NOT FOUND........ : '           
                    WS-K857-NFND.                                               
           DISPLAY ' (6) NO OF BP13K857 RECORDS W/ BLANK EMAIL... : '           
                    WS-K857-EMAIL.                                              
           DISPLAY ' (7) NO OF F800/K857 RECORDS W/ BLANK QUEUE.. : '           
                    WS-K857-NCAT.                                               
           DISPLAY ' (8) NO OF P13LD35A RECORDS WRITTEN.......... : '           
                    WS-CNT-OUTA.                                                
           DISPLAY '( 9) NO OF P13F203A RECORDS WRITTEN.......... : '           
                    WS-CNT-OUTA.                                                
           DISPLAY '(10) NO OF P13LD35B RECORDS WRITTEN.......... : '           
                    WS-CNT-OUTB.                                                
           DISPLAY '(11) NO OF P13F203B RECORDS WRITTEN.......... : '           
                    WS-CNT-OUTB.                                                
           DISPLAY '(10) NO OF P13LD35C RECORDS WRITTEN.......... : '           
                    WS-CNT-OUTC.                                                
           DISPLAY '(11) NO OF P13F203C RECORDS WRITTEN.......... : '           
                    WS-CNT-OUTC.                                                
                                                                                
           CLOSE    BP13F800                                                    
                    BP13K857                                                    
                    BP13K813                                                    
                    P13LD35A                                                    
                    P13F203A                                                    
                    P13LD35B                                                    
                    P13F203B                                                    
                    P13LD35C                                                    
                    P13F203C.                                                   
                                                                                
           IF WS-K857-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K857 - ERROR CLOSING : ' WS-K857-STATUS              
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K813 - ERROR CLOSING : ' WS-K813-STATUS              
           END-IF.                                                              
                                                                                
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
