       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C145.                                                 
      *AUTHOR.        CKK7                                                      
      *DATE-WRITTEN.  20MAY2003.                                                
      * ====================================================== *                
      *                                                        *                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT  (SOC)           *                
      *                                                        *                
      *    SYSTEM ID   : BP13                                  *                
      *                                                        *                
      *    OBJECTIVES :                                        *                
      *                                                        *                
      *    1. UPDATE OF OIC FILE.                              *                
      *    2. TO ASSIGN REGN TO OIC'S FOR WIS APPLICATION      *                
      *       APPLIED FFOR THE DAY.                            *                
      *                                                        *                
      *    INPUT FILES  : BP13F800 - TRANSACTION FILE          *                
      *    I-O            BP13K022 - OIC FILE                  *                
      *                   BP13K024 - CONTROL FILE              *                
      *                                                        *                
      *--------------------------------------------------------*                
      * CHG-NO  BY  DATE      DETAILS                          *                
      *=======  === ========= =================================*                
      *BP132352 CKK 20030502  NEW PGM                          *                
      *BP132432 MJ1620031021  REMOVED PROCESSING FOR NON-BANK  *                
      *                       LOAN CASES                       *                
      *BP133416 JB8 20080916  CATER FOR DIFF OIC IN BP13K024   *                
      *BP133639 ZDD120090706  TO ASSIGN CASES TO THE SAME OIC  *                
      *                       FOR THE SAME PERSON(EXCEPT DBSS) *                
      *         ZDD120090729  TO INCLUDE TAGGING IF THE CASE   *                
      *                       WAS ASSIGNED TO THE PREVIOUS OIC *                
      *BP133657 ZDD120090805  TO CATER FOR DUPLICATE RECORD    *                
      *BP133639 ZDD120090805  TO CATER FOR CHECKING ON HA2-HA4 *                
      *         ZDD120090813  TO CONTINUE CHECKING ON HA2-HA4  *                
      *                       TO GET THE LATEST REG-NUM        *                
      *BP133636 ZDD120090904  TO READ BP13K730 BEFORE BP13K595 *                
      *BP13XXXX ZDD120101013  TO NOT TO CHECK ON 6 SERIES REGN *                
      *BP137993 AM2520190906  CATER FOR NEW CDE-POST-BOOK A&B  *                
      *========================================================*                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F800 ASSIGN TO BP13F800.                                  
                                                                                
           SELECT BP13K022 ASSIGN TO BP13K022                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K022-KEY-FLD                               
                  ALTERNATE KEY   IS K022-NUM-REGN                              
                  FILE STATUS     IS WS-K022-STATUS.                            
                                                                                
           SELECT BP13K024 ASSIGN TO BP13K024                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K024-KEY-FLD                               
                  FILE STATUS     IS WS-K024-STATUS.                            
                                                                                
           SELECT BP13K595 ASSIGN TO BP13K595                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K595-KEY-FLD                               
                  ALTERNATE   KEY IS K595-NUM-NRIC1                             
                                     WITH DUPLICATES                            
                  ALTERNATE   KEY IS K595-NUM-NRIC2                             
                                     WITH DUPLICATES                            
                  ALTERNATE   KEY IS K595-NUM-NRIC3                             
                                     WITH DUPLICATES                            
                  ALTERNATE   KEY IS K595-NUM-NRIC4                             
                                     WITH DUPLICATES                            
                  FILE STATUS     IS WS-K595-STATUS.                            
                                                                                
           SELECT BP13K730 ASSIGN TO BP13K730                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K730-KEY-NEW                               
                  ALTERNATE   KEY IS K730-ALT1-KEY                              
                                     WITH DUPLICATES                            
                  ALTERNATE   KEY IS K730-ALT2-KEY                              
                                     WITH DUPLICATES                            
                  FILE STATUS     IS WS-K730-STATUS.                            
                                                                                
           SELECT P13L145A ASSIGN TO P13L145A.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F800                                                            
            RECORDING MODE    F                                                 
            BLOCK CONTAINS    0 RECORDS                                         
            LABEL RECORDS   ARE STANDARD                                        
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13F800.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BP13K595                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K595.                                                           
                                                                                
       FD   BP13K730                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K730.                                                           
                                                                                
       FD   P13L145A                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE  IS F.                                               
       01   P13L145A-REC    PIC X(132).                                         
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-FILE-CONTROLS.                                                    
           05  WS-F800-EOF-SW                 PIC X(1)  VALUE 'N'.              
           05  WS-K022-EOF-SW                 PIC X(1)  VALUE 'N'.              
           05  WS-K024-EOF-SW                 PIC X(1)  VALUE 'N'.              
           05  WS-K022-STATUS                 PIC 9(2)  VALUE 0.                
           05  WS-K024-STATUS                 PIC 9(2)  VALUE 0.                
           05  WS-K595-STATUS                 PIC 9(2)  VALUE 0.                
           05  WS-K730-STATUS                 PIC 9(2)  VALUE 0.                
           05  WS-CNT-READ-F800               PIC 9(6)  VALUE ZEROS.            
           05  WS-CNT-WRIT-L145               PIC 9(6)  VALUE ZEROS.            
           05  WS-SKIPPED                     PIC 9(6)  VALUE ZEROS.            
           05  WS-OIC-ASSIGNED                PIC 9(6)  VALUE ZEROS.            
           05  WS-REG-NUM                     PIC X(8)  VALUE SPACES.           
                                                                                
       01  WS-L145-CONTROLS.                                                    
           05  WS-L145-LINECTR-A              PIC 9(2)  VALUE 60.               
           05  WS-L145-PAGECTR-A              PIC 9(5)  VALUE ZEROS.            
           05  WS-L145-SNO-A                  PIC 9(5)  VALUE 0.                
                                                                                
       01  WS-MISCELLANEOUS-VARS.                                               
           05  WS-BLANK-LINE                  PIC X(132) VALUE SPACES.          
           05  WS-REGN-ALLOC-CTR              PIC 9(6)  VALUE ZEROS.            
           05  WS-PREV-OIC                    PIC X(5).                         
           05  WS-ALLO-CAT-PREV               PIC X(1).                         
           05  WS-CNT                         PIC 9(3)  VALUE 0.                
           05  WS-SKIP                        PIC 9(1)  VALUE 0.                
           05  WS-FLAG                        PIC X(1)  VALUE 'N'.              
           05  WS-FLAG-K595                   PIC X(1)  VALUE 'N'.              
           05  WS-FLAG-K730                   PIC X(1)  VALUE 'N'.              
           05  WS-DONE                        PIC X(1)  VALUE 'N'.              
           05  WS-OIC-FND                     PIC X(1)  VALUE 'N'.              
           05  WS-READ-FLAG-BL                PIC X(1)  VALUE 'N'.              
           05  WS-FOUND                       PIC X(1)  VALUE 'N'.              
           05  WS-WRITE-K022                  PIC X(1)  VALUE 'N'.              
           05  WS-NOT-EXISTING                PIC X(1)  VALUE 'N'.              
           05  WS-PREV-OIC-TAG                PIC X(1)  VALUE 'N'.              
           05  WS-K730-FOUND                  PIC X(1)  VALUE 'N'.              
                                                                                
       01  WS-TIME-DATES.                                                       
           05  WS-SYSTEM-DATE.                                                  
               10  WS-SYS-CCYY.                                                 
                   15  WS-SYS-CC              PIC 9(2).                         
                   15  WS-SYS-YY              PIC 9(2).                         
               10  WS-SYS-MM                  PIC 9(2).                         
               10  WS-SYS-DD                  PIC 9(2).                         
                                                                                
           05  WS-EDITED-DATE.                                                  
               10  WS-EDITED-DD               PIC 9(2).                         
               10  FILLER                     PIC X(1)  VALUE '/'.              
               10  WS-EDITED-MM               PIC 9(2).                         
               10  FILLER                     PIC X(1)  VALUE '/'.              
               10  WS-EDITED-YY               PIC 9(4).                         
                                                                                
      *============================================================*            
      *         BP13L145  -  R E P O R T    L A Y O U T            *            
      *============================================================*            
                                                                                
       01  L145-HEADER-1A.                                                      
           05  FILLER              PIC X(08)     VALUE 'P13L145A'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  L145-RUN-DATE-A     PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  L145-PAGE-NO-A      PIC ZZZZ9 .                                  
                                                                                
       01  L145-HEADER-2A.                                                      
           05  FILLER              PIC X(41)     VALUE SPACES.                  
           05  FILLER              PIC X(55)     VALUE                          
           '        REPORT ON CASES ASSIGNED TO OIC          '.                 
                                                                                
                                                                                
       01  L145-HEADER-03.                                                      
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE ' S/N '.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'NT '.                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'ZONE'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'FT '.                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'REGNO   '.              
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'REGN DATE '.            
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE 'OIC  '.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(30)     VALUE 'OIC NAME'.              
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'ALLOC CAT'.             
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE 'LOAN TAG'.              
                                                                                
       01  L145-HEADER-04.                                                      
           05  FILLER              PIC X(130)    VALUE ALL '-'.                 
                                                                                
       01  L145-DETAIL.                                                         
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  L145-SNO            PIC ZZZZ9.                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L145-NT             PIC X(03).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L145-ZONE           PIC X(04).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L145-FT             PIC X(03).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L145-REGNO          PIC X(08).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L145-DTE-REGN       PIC X(10).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L145-OIC            PIC X(05).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L145-NME-OIC        PIC X(30).                                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  L145-ALLO-CAT       PIC X(03).                                   
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  L145-LOAN-TAG       PIC X(03).                                   
                                                                                
      ****************************************************************          
       PROCEDURE DIVISION.                                                      
      ****************************************************************          
       0000-MAIN-ROUTINE.                                                       
      ****************************************************************          
                                                                                
           PERFORM 1000-OPEN-ROUTINE      THRU 1000-EXIT.                       
                                                                                
           PERFORM 3000-PROCESS-F800      THRU 3000-EXIT                        
                  UNTIL WS-F800-EOF-SW = 'Y'.                                   
                                                                                
           PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT.                       
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       1000-OPEN-ROUTINE.                                                       
      ****************************************************************          
                                                                                
           OPEN INPUT  BP13F800                                                 
                       BP13K595                                                 
                       BP13K730                                                 
                I-O    BP13K022                                                 
                       BP13K024                                                 
                OUTPUT P13L145A.                                                
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K022 OPEN ERROR, STATUS IS ' WS-K022-STATUS          
              MOVE WS-K022-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K024-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K024 OPEN ERROR, STATUS IS ' WS-K024-STATUS          
              MOVE WS-K024-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K595-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K595 OPEN ERROR, STATUS IS ' WS-K595-STATUS          
              MOVE WS-K595-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K730-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K730 OPEN ERROR, STATUS IS ' WS-K730-STATUS          
              MOVE WS-K730-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-SYSTEM-DATE.                 
           MOVE   WS-SYS-DD           TO WS-EDITED-DD.                          
           MOVE   WS-SYS-MM           TO WS-EDITED-MM.                          
           MOVE   WS-SYS-CCYY         TO WS-EDITED-YY.                          
           MOVE   WS-EDITED-DATE      TO L145-RUN-DATE-A.                       
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       2000-READ-F800.                                                          
      ****************************************************************          
                                                                                
           READ BP13F800                                                        
              AT END MOVE 'Y' TO WS-F800-EOF-SW                                 
              GO TO 3000-EXIT                                                   
           END-READ.                                                            
                                                                                
           ADD  +1                TO WS-CNT-READ-F800.                          
                                                                                
                                                                                
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       2100-READ-K021.                                                          
      ****************************************************************          
                                                                                
           START BP13K022 KEY >= K022-NUM-REGN.                                 
                                                                                
           IF WS-K022-STATUS = 00 OR 02                                         
              READ BP13K022 NEXT RECORD                                         
              IF WS-K022-STATUS = 00 OR 02                                      
                 IF K022-NUM-REGN = WS-REG-NUM                                  
                    MOVE 'Y' TO WS-FOUND                                        
                 ELSE                                                           
                    MOVE 'N' TO WS-FOUND                                        
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
           IF WS-K022-STATUS = 23                                               
              MOVE 'N' TO WS-FOUND                                              
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR WITH START READ OF BP13K022. STATUS IS '           
                       WS-K022-STATUS                                           
              MOVE WS-K022-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       2500-READ-K024.                                                          
      ****************************************************************          
                                                                                
           MOVE  LOW-VALUES   TO K024-KEY-FLD.                                  
           MOVE  'N'          TO WS-FLAG.                                       
           START BP13K024 KEY >  K024-KEY-FLD.                                  
                                                                                
           IF WS-K024-STATUS = 00                                               
                 PERFORM UNTIL WS-FLAG = 'Y'                                    
                    READ BP13K024 NEXT RECORD                                   
                         AT END MOVE 'Y' TO WS-FLAG                             
                    END-READ                                                    
                    IF WS-K024-STATUS = 00               AND                    
                       K024-CDE-LAST-REC-BL = 'Y'        AND                    
                      (K024-CDE-POST-BOOK = 'N' OR 'A' OR 'B')                  
                       MOVE 'N'                TO K024-CDE-LAST-REC-BL          
                       PERFORM 5100-REWRITE-K024  THRU 5100-EXIT                
                       MOVE 'Y' TO WS-FLAG                                      
                    END-IF                                                      
                 END-PERFORM                                                    
           ELSE                                                                 
              DISPLAY 'ERROR WITH START READ OF BP13K024. STATUS IS '           
                       WS-K024-STATUS                                           
              MOVE WS-K024-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-IF.                                                              
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       2550-READ-K024.                                                          
      ****************************************************************          
                                                                                
           READ BP13K024.                                                       
                                                                                
           EVALUATE WS-K024-STATUS                                              
             WHEN 00                                                            
                IF (K024-CDE-POST-BOOK = 'N' OR 'A' OR 'B') AND                 
                   K024-CDE-BLOCK = 'N'                                         
                   MOVE 'Y' TO WS-WRITE-K022                                    
                ELSE                                                            
                   MOVE 'N' TO WS-WRITE-K022                                    
                END-IF                                                          
             WHEN 23                                                            
                   MOVE 'N' TO WS-WRITE-K022                                    
             WHEN OTHER                                                         
              DISPLAY 'ERROR WITH READ OF BP13K022. STATUS IS '                 
                       WS-K022-STATUS                                           
              MOVE WS-K022-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
             END-EVALUATE.                                                      
                                                                                
       2550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3000-PROCESS-F800.                                                       
      ****************************************************************          
                                                                                
           PERFORM 2000-READ-F800    THRU 2000-EXIT.                            
                                                                                
           MOVE SPACES               TO K022-NUM-REGN                           
                                        WS-REG-NUM.                             
           MOVE F800-NUM-REGN        TO K022-NUM-REGN                           
                                        WS-REG-NUM.                             
           MOVE 'N'                  TO WS-FOUND.                               
           PERFORM 2100-READ-K021 THRU 2100-EXIT.                               
           IF WS-FOUND = 'Y'                                                    
              ADD 1 TO WS-SKIPPED                                               
              GO    TO 3000-EXIT                                                
           END-IF.                                                              
                                                                                
           MOVE 'N'                  TO WS-K730-FOUND                           
                                        WS-FLAG-K730.                           
                                                                                
           PERFORM 3001-READ-K731    THRU 3001-EXIT.                            
           MOVE 'N'                  TO WS-FLAG-K730.                           
           PERFORM 3003-READ-K732    THRU 3003-EXIT.                            
                                                                                
                                                                                
           IF WS-K730-FOUND = 'N'                                               
             MOVE 'N'                  TO WS-NOT-EXISTING                       
                                          WS-FLAG-K595                          
                                                                                
             PERFORM 3010-READ-K596    THRU 3010-EXIT                           
             MOVE 'N'                  TO WS-FLAG-K595                          
             PERFORM 3030-READ-K597    THRU 3030-EXIT                           
             MOVE 'N'                  TO WS-FLAG-K595                          
             PERFORM 3050-READ-K598    THRU 3050-EXIT                           
             MOVE 'N'                  TO WS-FLAG-K595                          
             PERFORM 3070-READ-K599    THRU 3070-EXIT                           
           END-IF.                                                              
                                                                                
           IF WS-REG-NUM NOT = SPACES AND LOW-VALUES                            
              MOVE 'Y' TO WS-NOT-EXISTING                                       
           ELSE                                                                 
              MOVE 'N' TO WS-NOT-EXISTING                                       
           END-IF.                                                              
                                                                                
           MOVE 'N'                  TO WS-PREV-OIC-TAG.                        
                                                                                
           IF WS-NOT-EXISTING = 'N'                                             
              PERFORM 3100-PROCESS-BANKLOAN  THRU 3100-EXIT                     
           ELSE                                                                 
                MOVE LOW-VALUES            TO K022-KEY-FLD                      
                MOVE WS-REG-NUM            TO K022-NUM-REGN                     
                MOVE 'N'                   TO WS-FOUND                          
                PERFORM 2100-READ-K021     THRU 2100-EXIT                       
                IF WS-FOUND = 'Y'                                               
                  MOVE SPACES              TO K024-KEY-FLD                      
                                                                                
                  IF K022-NUM-OIC-APPL = SPACES OR LOW-VALUES                   
                    MOVE K022-NUM-OIC        TO K024-KEY-FLD                    
                  ELSE                                                          
                    MOVE K022-NUM-OIC-APPL   TO K024-KEY-FLD                    
                  END-IF                                                        
                                                                                
                  PERFORM 2550-READ-K024   THRU 2550-EXIT                       
                                                                                
                  IF WS-WRITE-K022 = 'Y'                                        
                     MOVE 'Y' TO WS-PREV-OIC-TAG                                
                     PERFORM 5000-WRITE-K022  THRU 5000-EXIT                    
                     ADD 1 TO WS-OIC-ASSIGNED                                   
                  ELSE                                                          
                       PERFORM 3100-PROCESS-BANKLOAN  THRU 3100-EXIT            
                  END-IF                                                        
                ELSE                                                            
                     PERFORM 3100-PROCESS-BANKLOAN  THRU 3100-EXIT              
                END-IF                                                          
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3001-READ-K731.                                                          
      ****************************************************************          
                                                                                
           MOVE SPACES TO BP13K730-REC                                          
                          WS-REG-NUM.                                           
                                                                                
           MOVE F800-NUM-NRIC1 TO K730-NUM-NRIC1.                               
                                                                                
           START BP13K730 KEY >= K730-ALT1-KEY.                                 
                                                                                
           EVALUATE WS-K730-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                 PERFORM 3002-READNEXT-K731 THRU 3002-EXIT                      
                        UNTIL       WS-FLAG-K730 = 'Y' OR                       
                         F800-NUM-NRIC1 NOT =  K730-NUM-NRIC1                   
             WHEN 23                                                            
                  MOVE 'N' TO WS-NOT-EXISTING                                   
             WHEN OTHER                                                         
              DISPLAY 'ERROR WITH START READ OF BP13K730. STATUS IS '           
                       WS-K730-STATUS                                           
              MOVE WS-K730-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3002-READNEXT-K731.                                                      
      ****************************************************************          
                                                                                
           READ BP13K730 NEXT AT END MOVE 'Y' TO WS-FLAG-K730                   
                                     GO TO 3002-EXIT.                           
                                                                                
           IF F800-NUM-NRIC1 =  K730-NUM-NRIC1                                  
               IF K730-NUM-REGN(1:1) NOT = '5' AND '6'                          
                 IF K730-NUM-REGN > WS-REG-NUM                                  
                   IF K730-NUM-REGN NOT = F800-NUM-REGN                         
                     MOVE K730-NUM-REGN TO WS-REG-NUM                           
                     MOVE 'Y' TO WS-K730-FOUND                                  
                   END-IF                                                       
                 END-IF                                                         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3003-READ-K732.                                                          
      ****************************************************************          
                                                                                
           MOVE SPACES TO BP13K730-REC.                                         
                                                                                
                                                                                
           MOVE F800-NUM-NRIC1 TO K730-NUM-NRIC2.                               
                                                                                
           START BP13K730 KEY >= K730-ALT2-KEY.                                 
                                                                                
           EVALUATE WS-K730-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                 PERFORM 3004-READNEXT-K732 THRU 3004-EXIT                      
                        UNTIL       WS-FLAG-K730 = 'Y' OR                       
                         F800-NUM-NRIC1 NOT =  K730-NUM-NRIC2                   
             WHEN 23                                                            
                  MOVE 'N' TO WS-NOT-EXISTING                                   
             WHEN OTHER                                                         
              DISPLAY 'ERROR WITH START READ OF BP13K730. STATUS IS '           
                       WS-K730-STATUS                                           
              MOVE WS-K730-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3003-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3004-READNEXT-K732.                                                      
      ****************************************************************          
                                                                                
           READ BP13K730 NEXT AT END MOVE 'Y' TO WS-FLAG-K730                   
                                     GO TO 3004-EXIT.                           
                                                                                
           IF F800-NUM-NRIC1 =  K730-NUM-NRIC2                                  
               IF K730-NUM-REGN(1:1) NOT = '5' AND '6'                          
                 IF K730-NUM-REGN > WS-REG-NUM                                  
                   IF K730-NUM-REGN NOT = F800-NUM-REGN                         
                      MOVE K730-NUM-REGN TO WS-REG-NUM                          
                      MOVE 'Y' TO WS-K730-FOUND                                 
                   END-IF                                                       
                 END-IF                                                         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3004-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ****************************************************************          
       3010-READ-K596.                                                          
      ****************************************************************          
                                                                                
           MOVE SPACES TO BP13K595-REC                                          
                          WS-REG-NUM.                                           
                                                                                
           MOVE F800-NUM-NRIC1 TO K595-NUM-NRIC1.                               
                                                                                
           START BP13K595 KEY >= K595-ALT1-KEY.                                 
                                                                                
           EVALUATE WS-K595-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                 PERFORM 3020-READNEXT-K596 THRU 3020-EXIT                      
                        UNTIL       WS-FLAG-K595 = 'Y' OR                       
                         F800-NUM-NRIC1 NOT =  K595-NUM-NRIC1                   
             WHEN 23                                                            
                  MOVE 'N' TO WS-NOT-EXISTING                                   
             WHEN OTHER                                                         
              DISPLAY 'ERROR WITH START READ OF BP13K595. STATUS IS '           
                       WS-K595-STATUS                                           
              MOVE WS-K595-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3020-READNEXT-K596.                                                      
      ****************************************************************          
                                                                                
           READ BP13K595 NEXT AT END MOVE 'Y' TO WS-FLAG-K595                   
                                     GO TO 3020-EXIT.                           
                                                                                
           IF F800-NUM-NRIC1 =  K595-NUM-NRIC1                                  
               IF K595-NUM-REGN(1:1) NOT = '5' AND '6'                          
                 IF K595-NUM-REGN > WS-REG-NUM                                  
                   IF K595-NUM-REGN NOT = F800-NUM-REGN                         
                     MOVE K595-NUM-REGN TO WS-REG-NUM                           
                   END-IF                                                       
                 END-IF                                                         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3030-READ-K597.                                                          
      ****************************************************************          
                                                                                
           MOVE SPACES TO BP13K595-REC.                                         
                                                                                
                                                                                
           MOVE F800-NUM-NRIC1 TO K595-NUM-NRIC2.                               
                                                                                
           START BP13K595 KEY >= K595-ALT2-KEY.                                 
                                                                                
           EVALUATE WS-K595-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                 PERFORM 3040-READNEXT-K597 THRU 3040-EXIT                      
                        UNTIL       WS-FLAG-K595 = 'Y' OR                       
                         F800-NUM-NRIC1 NOT =  K595-NUM-NRIC2                   
             WHEN 23                                                            
                  MOVE 'N' TO WS-NOT-EXISTING                                   
             WHEN OTHER                                                         
              DISPLAY 'ERROR WITH START READ OF BP13K595. STATUS IS '           
                       WS-K595-STATUS                                           
              MOVE WS-K595-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3030-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3040-READNEXT-K597.                                                      
      ****************************************************************          
                                                                                
           READ BP13K595 NEXT AT END MOVE 'Y' TO WS-FLAG-K595                   
                                     GO TO 3040-EXIT.                           
                                                                                
           IF F800-NUM-NRIC1 =  K595-NUM-NRIC2                                  
               IF K595-NUM-REGN(1:1) NOT = '5' AND '6'                          
                 IF K595-NUM-REGN > WS-REG-NUM                                  
                   IF K595-NUM-REGN NOT = F800-NUM-REGN                         
                      MOVE K595-NUM-REGN TO WS-REG-NUM                          
                   END-IF                                                       
                 END-IF                                                         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3040-EXIT.                                                               
           EXIT.                                                                
      ****************************************************************          
       3050-READ-K598.                                                          
      ****************************************************************          
                                                                                
           MOVE SPACES TO BP13K595-REC.                                         
                                                                                
                                                                                
           MOVE F800-NUM-NRIC1 TO K595-NUM-NRIC3.                               
                                                                                
           START BP13K595 KEY >= K595-ALT3-KEY.                                 
                                                                                
           EVALUATE WS-K595-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                 PERFORM 3060-READNEXT-K598 THRU 3060-EXIT                      
                        UNTIL       WS-FLAG-K595 = 'Y' OR                       
                         F800-NUM-NRIC1 NOT =  K595-NUM-NRIC3                   
             WHEN 23                                                            
                  MOVE 'N' TO WS-NOT-EXISTING                                   
             WHEN OTHER                                                         
              DISPLAY 'ERROR WITH START READ OF BP13K595. STATUS IS '           
                       WS-K595-STATUS                                           
              MOVE WS-K595-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3060-READNEXT-K598.                                                      
      ****************************************************************          
                                                                                
           READ BP13K595 NEXT AT END MOVE 'Y' TO WS-FLAG-K595                   
                                     GO TO 3060-EXIT.                           
                                                                                
           IF F800-NUM-NRIC1 =  K595-NUM-NRIC3                                  
               IF K595-NUM-REGN(1:1) NOT = '5' AND '6'                          
                 IF K595-NUM-REGN > WS-REG-NUM                                  
                   IF K595-NUM-REGN NOT = F800-NUM-REGN                         
                      MOVE K595-NUM-REGN TO WS-REG-NUM                          
                   END-IF                                                       
                 END-IF                                                         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3060-EXIT.                                                               
           EXIT.                                                                
      ****************************************************************          
       3070-READ-K599.                                                          
      ****************************************************************          
                                                                                
           MOVE SPACES TO BP13K595-REC.                                         
                                                                                
                                                                                
           MOVE F800-NUM-NRIC1 TO K595-NUM-NRIC4.                               
                                                                                
           START BP13K595 KEY >= K595-ALT4-KEY.                                 
                                                                                
           EVALUATE WS-K595-STATUS                                              
             WHEN 00                                                            
             WHEN 02                                                            
                 PERFORM 3080-READNEXT-K599 THRU 3080-EXIT                      
                        UNTIL       WS-FLAG-K595 = 'Y' OR                       
                         F800-NUM-NRIC1 NOT =  K595-NUM-NRIC4                   
             WHEN 23                                                            
                  MOVE 'N' TO WS-NOT-EXISTING                                   
             WHEN OTHER                                                         
              DISPLAY 'ERROR WITH START READ OF BP13K595. STATUS IS '           
                       WS-K595-STATUS                                           
              MOVE WS-K595-STATUS              TO RETURN-CODE                   
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3070-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3080-READNEXT-K599.                                                      
      ****************************************************************          
                                                                                
           READ BP13K595 NEXT AT END MOVE 'Y' TO WS-FLAG-K595                   
                                     GO TO 3080-EXIT.                           
                                                                                
           IF F800-NUM-NRIC1 =  K595-NUM-NRIC4                                  
               IF K595-NUM-REGN(1:1) NOT = '5' AND '6'                          
                 IF K595-NUM-REGN > WS-REG-NUM                                  
                   IF K595-NUM-REGN NOT = F800-NUM-REGN                         
                      MOVE K595-NUM-REGN TO WS-REG-NUM                          
                   END-IF                                                       
                  MOVE 'Y' TO WS-NOT-EXISTING                                   
                 END-IF                                                         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3080-EXIT.                                                               
           EXIT.                                                                
      ****************************************************************          
       3100-PROCESS-BANKLOAN.                                                   
      ****************************************************************          
                                                                                
           PERFORM 2500-READ-K024  THRU 2500-EXIT.                              
                                                                                
           MOVE  0                    TO WS-CNT.                                
           MOVE 'N'                   TO WS-FLAG.                               
                                                                                
           PERFORM UNTIL WS-FLAG = 'Y'                                          
           MOVE 'N'                     TO WS-OIC-FND                           
           PERFORM 4500-READNEXT-K024  THRU 4500-EXIT                           
             UNTIL WS-OIC-FND = 'Y'                                             
                OR WS-K024-EOF-SW = 'Y'                                         
           IF WS-K024-EOF-SW = 'Y'                                              
              ADD 1                    TO WS-CNT                                
              MOVE  LOW-VALUES   TO K024-KEY-FLD                                
              START BP13K024 KEY >  K024-KEY-FLD                                
              MOVE 'N'                      TO WS-OIC-FND                       
              MOVE 'N'                      TO WS-K024-EOF-SW                   
              PERFORM 4500-READNEXT-K024  THRU 4500-EXIT                        
                UNTIL WS-OIC-FND = 'Y'                                          
                   OR WS-K024-EOF-SW = 'Y'                                      
              MOVE  'N'          TO WS-K024-EOF-SW                              
              IF WS-DONE = 'Y'                                                  
                 MOVE  'N'          TO WS-DONE                                  
                 WRITE P13L145A-REC    FROM WS-BLANK-LINE                       
                 ADD 1                 TO WS-L145-LINECTR-A                     
              END-IF                                                            
           END-IF                                                               
              IF K024-CDE-BLOCK NOT = 'Y'                                       
                 IF K024-NUM-RATIO = K024-NUM-CUR-CNT                           
                    SUBTRACT K024-NUM-RATIO FROM K024-NUM-MAX-CNT               
                             GIVING WS-SKIP                                     
                    IF WS-SKIP <= K024-NUM-SKIP                                 
                       MOVE 1                     TO K024-NUM-CUR-CNT           
                       MOVE ZEROES                TO K024-NUM-SKIP              
                       MOVE 'Y'           TO K024-CDE-LAST-REC-BL               
                       PERFORM 5100-REWRITE-K024  THRU 5100-EXIT                
                       PERFORM 5000-WRITE-K022    THRU 5000-EXIT                
                       ADD 1                      TO WS-REGN-ALLOC-CTR          
                       MOVE 'Y'                   TO WS-FLAG                    
                       MOVE 'Y'                   TO WS-DONE                    
                    ELSE                                                        
                       ADD  1                     TO K024-NUM-SKIP              
                       PERFORM 5100-REWRITE-K024  THRU 5100-EXIT                
                    END-IF                                                      
                 ELSE                                                           
                    ADD   1                    TO K024-NUM-CUR-CNT              
                    MOVE 'Y'              TO K024-CDE-LAST-REC-BL               
                    PERFORM 5000-WRITE-K022    THRU 5000-EXIT                   
                    PERFORM 5100-REWRITE-K024  THRU 5100-EXIT                   
                    ADD 1                      TO WS-REGN-ALLOC-CTR             
                    MOVE 'Y'                   TO WS-FLAG                       
                    MOVE 'Y'                   TO WS-DONE                       
                 END-IF                                                         
              END-IF                                                            
              IF WS-CNT > 1                                                     
                 MOVE 'Y'                         TO WS-FLAG                    
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           IF WS-CNT > 1                                                        
              DISPLAY 'ERROR: ALL OIC''S MARKED AS BLOCK.'                      
              PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                         
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ****************************************************************          
       4500-READNEXT-K024.                                                      
      ****************************************************************          
                                                                                
            READ BP13K024 NEXT RECORD                                           
               AT END MOVE 'Y' TO WS-K024-EOF-SW                                
               GO TO 4500-EXIT                                                  
            END-READ.                                                           
                                                                                
            IF WS-K024-STATUS = 00                                              
               IF (K024-CDE-POST-BOOK = 'N' OR 'A' OR 'B')                      
                  MOVE 'Y'                    TO WS-OIC-FND                     
               END-IF                                                           
            ELSE                                                                
            IF WS-K024-STATUS = 46                                              
               MOVE 'Y'                       TO WS-K024-EOF-SW                 
            ELSE                                                                
               DISPLAY 'ERROR READING BP13K024. STATUS IS '                     
                        WS-K024-STATUS                                          
               MOVE WS-K024-STATUS              TO RETURN-CODE                  
               PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                    
            END-IF.                                                             
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       5000-WRITE-K022.                                                         
      ****************************************************************          
                                                                                
            MOVE SPACES                    TO BP13K022-REC.                     
            INITIALIZE                        BP13K022-REC.                     
            IF WS-PREV-OIC-TAG = 'Y'                                            
               MOVE 'Y'                    TO K022-NUM-PRE-OIC-TAG              
            ELSE                                                                
               MOVE 'N'                    TO K022-NUM-PRE-OIC-TAG              
            END-IF.                                                             
            MOVE K024-NUM-OIC              TO K022-NUM-OIC.                     
            MOVE F800-NUM-REGN             TO K022-NUM-REGN.                    
            MOVE F800-NUM-ALLO-CAT         TO K022-CDE-ALLO-CAT.                
            MOVE F800-NUM-LOAN-TAG         TO K022-CDE-BANKLOAN.                
            IF K024-CDE-POST-BOOK = 'A' OR 'B'                                  
               MOVE K024-NUM-OIC           TO K022-NUM-OIC-APPL                 
            END-IF.                                                             
            MOVE 'BP13C145'                TO K022-NUM-USERID                   
            MOVE WS-SYSTEM-DATE            TO K022-DTE-UPDATE.                  
                                                                                
            WRITE BP13K022-REC.                                                 
                                                                                
            EVALUATE WS-K022-STATUS                                             
            WHEN 00                                                             
               CONTINUE                                                         
            WHEN OTHER                                                          
               DISPLAY 'ERROR WRITING BP13K022. STATUS IS '                     
                        WS-K022-STATUS ' / ' K022-NUM-REGN                      
               MOVE  WS-K022-STATUS          TO RETURN-CODE                     
               PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
            END-EVALUATE.                                                       
                                                                                
            PERFORM 8000-PRINT-RPT-A    THRU 8000-EXIT.                         
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       5100-REWRITE-K024.                                                       
      ****************************************************************          
                                                                                
            MOVE 'BP13C145'            TO K024-NUM-USERID.                      
            MOVE WS-SYSTEM-DATE        TO K024-DTE-UPDATE.                      
                                                                                
            REWRITE BP13K024-REC.                                               
                                                                                
            EVALUATE WS-K024-STATUS                                             
            WHEN 00                                                             
               CONTINUE                                                         
            WHEN OTHER                                                          
               DISPLAY 'ERROR WRITING BP13K024. STATUS IS '                     
                        WS-K024-STATUS                                          
               MOVE WS-K024-STATUS              TO RETURN-CODE                  
               PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       8000-PRINT-RPT-A.                                                        
      ****************************************************************          
                                                                                
           ADD  1                             TO WS-L145-SNO-A.                 
           MOVE WS-L145-SNO-A                 TO L145-SNO.                      
                                                                                
           PERFORM 8500-MOVE-VALUES     THRU 8500-EXIT.                         
                                                                                
           IF WS-L145-LINECTR-A >= 55                                           
              ADD                   1   TO WS-L145-PAGECTR-A                    
              MOVE WS-L145-PAGECTR-A    TO L145-PAGE-NO-A                       
              WRITE P13L145A-REC    FROM L145-HEADER-1A  AFTER PAGE             
              WRITE P13L145A-REC    FROM L145-HEADER-2A                         
              WRITE P13L145A-REC    FROM L145-HEADER-03  AFTER 2                
              WRITE P13L145A-REC    FROM L145-HEADER-04                         
              WRITE P13L145A-REC    FROM L145-DETAIL                            
              MOVE                  6 TO WS-L145-LINECTR-A                      
           ELSE                                                                 
              ADD                   1 TO WS-L145-LINECTR-A                      
              WRITE P13L145A-REC    FROM L145-DETAIL                            
           END-IF.                                                              
                                                                                
           ADD 1                    TO WS-CNT-WRIT-L145.                        
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       8500-MOVE-VALUES.                                                        
      ****************************************************************          
                                                                                
           MOVE F800-NUM-NEW-TOWN             TO L145-NT.                       
           MOVE F800-NUM-ZONE                 TO L145-ZONE                      
           MOVE F800-NUM-FLAT-TYPE            TO L145-FT.                       
           STRING F800-DTE-REGN(7:2) '/'                                        
                  F800-DTE-REGN(5:2) '/'                                        
                  F800-DTE-REGN(1:4)                                            
                  DELIMITED BY SIZE         INTO L145-DTE-REGN.                 
           MOVE F800-NUM-REGN                 TO L145-REGNO.                    
           MOVE K022-NUM-OIC                  TO L145-OIC.                      
           MOVE K024-NME-OIC                  TO L145-NME-OIC.                  
           MOVE F800-NUM-ALLO-CAT             TO L145-ALLO-CAT.                 
           MOVE F800-NUM-LOAN-TAG             TO L145-LOAN-TAG.                 
                                                                                
       8500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       9999-CLOSE-ROUTINE.                                                      
      ****************************************************************          
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '*===========BP13C145 CONTROL TOTALS============*'.          
           DISPLAY SPACES.                                                      
           DISPLAY 'BP13F800 RECORDS READ        = ' WS-CNT-READ-F800.          
           DISPLAY 'NO OF REGNO ALLOCATED TO OIC = ' WS-REGN-ALLOC-CTR.         
           DISPLAY 'NO OF REGNO ASSIGNED TO THE  = ' WS-OIC-ASSIGNED.           
           DISPLAY 'SAME OIC(WITH PREVIOUS APPLICATION)'.                       
           DISPLAY SPACES.                                                      
           DISPLAY 'NO OF SKIPPED CASES          = ' WS-SKIPPED.                
           DISPLAY SPACES.                                                      
           DISPLAY '*==============================================*'.          
                                                                                
           CLOSE BP13F800                                                       
                 BP13K595                                                       
                 BP13K024                                                       
                 BP13K022                                                       
                 BP13K730                                                       
                 P13L145A.                                                      
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K022 CLOSE ERROR, STATUS IS ' WS-K022-STATUS         
              MOVE WS-K022-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           IF WS-K024-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K024 CLOSE ERROR, STATUS IS ' WS-K024-STATUS         
              MOVE WS-K024-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           IF WS-K595-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K595 CLOSE ERROR, STATUS IS ' WS-K595-STATUS         
              MOVE WS-K595-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           IF WS-K730-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K730 CLOSE ERROR, STATUS IS ' WS-K730-STATUS         
              MOVE WS-K730-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
       9999-EXIT.                                                               
           EXIT.                                                                
