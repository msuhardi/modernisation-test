      *------------*                                                            
       IDENTIFICATION DIVISION.                                                 
      *------------*                                                            
       PROGRAM-ID.    BP13CC44.                                                 
      *AUTHOR.        EDEN ROSE DINGAL.                                         
      *DATE-WRITTEN.  8 DEC 2006.                                               
                                                                                
      * =========================================================== *           
      * SYSTEM OF COMMITMENT  (BP13)                                *           
      * =========================================================== *           
      *  OBJECTIVES : 1) TO READ BP13FD04 AND PRINT REPORTS         *           
      *                  A) P13LC44A - <= 1MO                       *           
      *                  B) P13LC44B - >  1MO  TO <= 2MO            *           
      *                  C) P13LC44C - >  2MO  TO < 3MO             *           
      *                  D) P13LC44D - >= 3MO                       *           
      *                                                             *           
      *                                                             *           
      *  INPUT-OUTPUT FILES :                                       *           
      *  ====================                                       *           
      *  TYPE  DD NAME   ACCESS   KEYLENGTH                         *           
      *  --    ----      ---      -----                             *           
      *  I     BP13FD04   SEQ.       08                             *           
      *  I     BP13K800  RANDOM      08                             *           
      *  I     BP13K820  RANDOM      17                             *           
      *  I     BP13KA10  RANDOM      03                             *           
      *  I     SY02F001  RANDOM                                     *           
      *  O     P13LC44A   SEQ.       132                            *           
      *  O     P13LC44B   SEQ.       132                            *           
      *  O     P13LC44C   SEQ.       132                            *           
      *  O     P13LC44D   SEQ.       132                            *           
      *                                                             *           
      * ------------------------------ *                                        
      * CHG-NO   DATE   BY   DESCRIPTION                            *           
      * ---- --- -           ------                                 *           
      * BP132936 081206 ED1  NEW PGM                                *           
      * BP133051 070507 ED1  REMOVED PASSING OF RETN CDE IF NOTFND  *           
      *          140507 ED1  CHGED RETRIEVAL OF DTE HEADERS         *           
      * BP133052 160507 ED1  ADDED TOTAL PER PROJECT                *           
      * BP133091 151207 LMS1 EXPANSION OF BP13FD04 FROM 1300 TO 1700*           
      * BP133686 060110 JB8  READ SY02F001 TO GET LAST DAY OF PRE MTH           
      * BP135161 090414 IMC1 CATER FOR X ACCOUNT CASES              *           
      * =========================================================== *           
                                                                                
      *------------*                                                            
       ENVIRONMENT DIVISION.                                                    
      *------------*                                                            
       CONFIGURATION SECTION.                                                   
      *------------*                                                            
                                                                                
         SOURCE-COMPUTER.   IBM-3090.                                           
         OBJECT-COMPUTER.   IBM-3090.                                           
                                                                                
      *------------*                                                            
       INPUT-OUTPUT SECTION.                                                    
      *------------*                                                            
         FILE-CONTROL.                                                          
           SELECT BP13FD04 ASSIGN TO BP13FD04.                                  
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K800-NUM-REGN                                   
                FILE STATUS  IS WS-K800-STATUS.                                 
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K820-KEY-FLD                                    
                FILE STATUS  IS WS-K820-STATUS.                                 
                                                                                
           SELECT BP13KA10 ASSIGN TO BP13KA10                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS KA10-KEY-FLD                                    
                FILE STATUS  IS WS-KA10-STATUS.                                 
                                                                                
           SELECT AC15K010 ASSIGN TO AC15K010                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K010-ACCESS-KEY                                 
                FILE STATUS  IS WS-K010-STATUS.                                 
                                                                                
           SELECT P13LC44A  ASSIGN TO P13LC44A.                                 
           SELECT P13LC44B  ASSIGN TO P13LC44B.                                 
           SELECT P13LC44C  ASSIGN TO P13LC44C.                                 
           SELECT P13LC44D  ASSIGN TO P13LC44D.                                 
                                                                                
                                                                                
      *------------*                                                            
       DATA DIVISION.                                                           
      *------------*                                                            
      *------------*                                                            
       FILE SECTION.                                                            
      *------------*                                                            
                                                                                
       FD   BP13FD04                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 1700 CHARACTERS                                     
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FD04.                                                           
                                                                                
       FD   BP13K800           RECORD CONTAINS 2000 CHARACTERS.                 
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820           RECORD CONTAINS 400 CHARACTERS.                  
       COPY BP13K820.                                                           
                                                                                
       FD   BP13KA10           RECORD CONTAINS 800 CHARACTERS.                  
       COPY BP13KA10.                                                           
                                                                                
       FD   AC15K010           RECORD CONTAINS 200  CHARACTERS.                 
       COPY AC15K010.                                                           
                                                                                
       COPY SY02F001.                                                           
       COPY AV02COMM.                                                           
                                                                                
       FD   P13LC44A    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC44A-REC PIC X(132).                                            
                                                                                
       FD   P13LC44B    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC44B-REC PIC X(132).                                            
                                                                                
       FD   P13LC44C    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC44C-REC PIC X(132).                                            
                                                                                
       FD   P13LC44D    BLOCK  CONTAINS 0 RECORDS                               
                        RECORD CONTAINS 132 CHARACTERS                          
                        LABEL RECORD IS OMITTED                                 
                        RECORDING MODE IS F.                                    
       01   P13LC44D-REC PIC X(132).                                            
                                                                                
      *-------------------------------                                          
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------                                          
       01  WS-COUNTERS.                                                         
           05 WS-CNT-FD04-READ       PIC 9(7) VALUE ZEROES.                     
           05 WS-CNT-LC44A-WRITE     PIC 9(7) VALUE ZEROES.                     
           05 WS-CNT-LC44B-WRITE     PIC 9(7) VALUE ZEROES.                     
           05 WS-CNT-LC44C-WRITE     PIC 9(7) VALUE ZEROES.                     
           05 WS-CNT-LC44D-WRITE     PIC 9(7) VALUE ZEROES.                     
           05 WS-SNOA                PIC 9(5) VALUE ZEROES.                     
           05 WS-SNOB                PIC 9(5) VALUE ZEROES.                     
           05 WS-SNOC                PIC 9(5) VALUE ZEROES.                     
           05 WS-SNOD                PIC 9(5) VALUE ZEROES.                     
           05 WS-PAGE-CTRA           PIC 9(4) VALUE ZEROES.                     
           05 WS-PAGE-CTRB           PIC 9(4) VALUE ZEROES.                     
           05 WS-PAGE-CTRC           PIC 9(4) VALUE ZEROES.                     
           05 WS-PAGE-CTRD           PIC 9(4) VALUE ZEROES.                     
           05 WS-LINE-CTRA           PIC 9(2) VALUE ZEROES.                     
           05 WS-LINE-CTRB           PIC 9(2) VALUE ZEROES.                     
           05 WS-LINE-CTRC           PIC 9(2) VALUE ZEROES.                     
           05 WS-LINE-CTRD           PIC 9(2) VALUE ZEROES.                     
           05 WS-PROJ-AMT-A          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-PROJ-AMT-B          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-PROJ-AMT-C          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-PROJ-AMT-D          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-TOTAL-LC4A          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-TOTAL-LC4B          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-TOTAL-LC4C          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-TOTAL-LC4D          PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-TOTAL-AMT           PIC 9(7)V99 VALUE ZEROES.                  
           05 WS-TOTAL-CASES         PIC 9(7)    VALUE ZEROES.                  
           05  WS-REPUD-MONTH      PIC 9(09)     VALUE 0.                       
           05  WS-CURR-MONTH       PIC 9(09)     VALUE 0.                       
                                                                                
       01  WS-DTE-REPUDIATE.                                                    
           05  WS-DTE-REPUD-YYYY   PIC 9(4)      VALUE ZEROES.                  
           05  WS-DTE-REPUD-MM     PIC 9(2)      VALUE ZEROES.                  
                                                                                
       01  WS-DTE-CURRENT.                                                      
           05  WS-DTE-CURR-YYYY    PIC 9(4)      VALUE ZEROES.                  
           05  WS-DTE-CURR-MM      PIC 9(2)      VALUE ZEROES.                  
                                                                                
                                                                                
       01  WS-FILE-STATUS.                                                      
           05 WS-K800-STATUS         PIC 9(2) VALUE ZEROES.                     
           05 WS-K820-STATUS         PIC 9(2) VALUE ZEROES.                     
           05 WS-K010-STATUS         PIC 9(2) VALUE ZEROES.                     
           05 WS-KA10-STATUS         PIC 9(2) VALUE ZEROES.                     
                                                                                
       01  WS-FLAGS.                                                            
           05 WS-FLG-FD04-EOF        PIC X    VALUE 'N'.                        
           05 WS-PRNT-PROJ-A         PIC X    VALUE 'N'.                        
           05 WS-PRNT-PROJ-B         PIC X    VALUE 'N'.                        
           05 WS-PRNT-PROJ-C         PIC X    VALUE 'N'.                        
           05 WS-PRNT-PROJ-D         PIC X    VALUE 'N'.                        
           05 WS-PRINTED-A           PIC X    VALUE 'N'.                        
           05 WS-PRINTED-B           PIC X    VALUE 'N'.                        
           05 WS-PRINTED-C           PIC X    VALUE 'N'.                        
           05 WS-PRINTED-D           PIC X    VALUE 'N'.                        
                                                                                
       01  WS-DATE-HDR               PIC X(10) VALUE SPACES.                    
       01  WS-MAX-LINE               PIC 99    VALUE 54.                        
       01  WS-PROJECT-A              PIC X(3)  VALUE SPACES.                    
       01  WS-PROJECT-B              PIC X(3)  VALUE SPACES.                    
       01  WS-PROJECT-C              PIC X(3)  VALUE SPACES.                    
       01  WS-PROJECT-D              PIC X(3)  VALUE SPACES.                    
                                                                                
       01  WS-DATE.                                                             
           05  WS-CCYY               PIC X(4).                                  
           05  WS-MM                 PIC X(2).                                  
           05  WS-MM-R REDEFINES WS-MM.                                         
               10 WS-MTH             PIC 9(2).                                  
           05  WS-DD                 PIC X(2).                                  
                                                                                
       01  WS-LASTDATE               PIC X(08).                                 
       01  WS-LASTDATE-R REDEFINES WS-LASTDATE.                                 
           05  WS-LAST-CCYY          PIC 9(4).                                  
           05  WS-LAST-MM            PIC 9(2).                                  
           05  WS-LAST-DD            PIC 9(2).                                  
                                                                                
       01  WS-VAR-PROC-TYP       PIC      X(30)   VALUE SPACES.                 
       01  WS-VAR-FILE-STATUS    PIC      X(6)    VALUE SPACE.                  
       01  WS-LC44-HDR           PIC      X(8)    VALUE SPACES.                 
                                                                                
       01 WS-MONTH-NAME.                                                        
          05 WS-STRING PIC X(36) VALUE                                          
                'JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC'.                         
          05 WS-MONTH  REDEFINES WS-STRING OCCURS 12 TIMES PIC XXX.             
                                                                        01010000
       01  WS-BLANK-LINE  PIC X(132)             VALUE SPACES.                  
                                                                                
       01  WS-DASH-LINE   PIC X(132)             VALUE ALL '-'.                 
                                                                                
       01  HEADING-1.                                                           
           05  LC44-HDR            PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE '     HDB3'.             
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(27)     VALUE                          
               'HOUSING & DEVELOPMENT BOARD'.                                   
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LC44-DATE-HDR       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LC44-PAGE-HDR       PIC ZZZZ      VALUE ZEROES.                  
                                                                                
       01  HEADING-2.                                                           
           05  FILLER              PIC X(30)     VALUE SPACES.                  
           05  LC44-TITLE          PIC X(80)     VALUE SPACES.                  
                                                                                
       01  HEADING-3.                                                           
           05  FILLER              PIC X(10)     VALUE 'PROJECT : '.            
           05  LC44-PROJECT        PIC X(30)     VALUE SPACES.                  
                                                                                
       01  HEADING-4.                                                           
           05  FILLER              PIC X(65)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'FLAT'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'A/C'.                   
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'ARREARS'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'ARREARS'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE 'LATE PAYMENT'.          
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'DATE'.                  
                                                                                
       01  HEADING-5.                                                           
           05  FILLER              PIC X(03)     VALUE 'S/N'.                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'REGN NO'.               
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'SCH-ACC-NO'.            
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE 'NAME/ADDRESS'.          
           05  FILLER              PIC X(21)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'TYPE'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'STATUS'.                
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE 'MONTH'.                 
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'AMOUNT'.                
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE 'CHARGES'.               
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE 'TERMINATE'.             
                                                                                
       01  WS-LC44-DETAILS.                                                     
          05 LC44-DTL-SERIAL      PIC ZZZZ9     VALUE ZEROES.                   
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC44-REGNO           PIC X(08)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC44-SCH-ACC         PIC X(14)     VALUE SPACES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC44-NAME1           PIC X(30)     VALUE SPACES.                   
          05 FILLER               PIC X(04)     VALUE SPACES.                   
          05 LC44-FLAT-TYPE       PIC X(02)     VALUE SPACES.                   
          05 FILLER               PIC X(05)     VALUE SPACES.                   
          05 LC44-ACCT-STAT       PIC X(01)     VALUE SPACES.                   
          05 FILLER               PIC X(05)     VALUE SPACES.                   
          05 LC44-MO-ARREAR       PIC    Z9.99  VALUE ZEROES.                   
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC44-AMT-ARREAR      PIC ZZZ,ZZ9.99 VALUE ZEROES.                  
          05 FILLER               PIC X(03)     VALUE SPACES.                   
          05 LC44-LTE-PYMNT-CHRGE PIC ZZZ,ZZ9.99 VALUE ZEROES.                  
          05 FILLER               PIC X(03)     VALUE SPACES.                   
          05 LC44-DTE-TERMINATE   PIC X(10)     VALUE SPACES.                   
                                                                                
       01 WS-LC44-DETAIL2.                                                      
          05 FILLER               PIC X(32)     VALUE SPACES.                   
          05 LC44-NAME2           PIC X(30)     VALUE SPACES.                   
                                                                                
       01 WS-LC44-DETAIL3.                                                      
          05 FILLER               PIC X(32)     VALUE SPACES.                   
          05 LC44-ADDRESS         PIC X(52)     VALUE SPACES.                   
                                                                                
      *----------- PROJECT TOTALS ----------------*                             
                                                                                
       01 WS-LC44-UNDERSCORE.                                                   
          05 FILLER               PIC X(85)      VALUE SPACES.                  
          05 FILLER               PIC X(12)      VALUE                          
             '____________'.                                                    
                                                                                
       01 WS-LC44-PROJ-TOTAL-A.                                                 
          05 FILLER               PIC X(18)      VALUE                          
             'CASES < = 1 MTH : '.                                              
          05 LC44-CASES-A         PIC ZZZ,ZZ9     VALUE ZEROES.                 
          05 FILLER               PIC X(61)      VALUE SPACES.                  
          05 LC44-PROJ-AMT-A      PIC ZZZ,ZZ9.99 VALUE ZEROES.                  
                                                                                
       01 WS-LC44-PROJ-TOTAL-B.                                                 
          05 FILLER               PIC X(29)      VALUE                          
             'CASES > 1 MTH TO <= 2 MTHS : '.                                   
          05 LC44-CASES-B         PIC ZZZ,ZZ9     VALUE ZEROES.                 
          05 FILLER               PIC X(50)      VALUE SPACES.                  
          05 LC44-PROJ-AMT-B      PIC ZZZ,ZZ9.99 VALUE ZEROES.                  
                                                                                
       01 WS-LC44-PROJ-TOTAL-C.                                                 
          05 FILLER               PIC X(29)      VALUE                          
             'CASES > 2 MTHS TO < 3 MTHS : '.                                   
          05 LC44-CASES-C         PIC ZZZ,ZZ9     VALUE ZEROES.                 
          05 FILLER               PIC X(50)      VALUE SPACES.                  
          05 LC44-PROJ-AMT-C      PIC ZZZ,ZZ9.99 VALUE ZEROES.                  
                                                                                
       01 WS-LC44-PROJ-TOTAL-D.                                                 
          05 FILLER               PIC X(18)      VALUE                          
             'CASES >= 3 MTHS : '.                                              
          05 LC44-CASES-D         PIC ZZZ,ZZ9     VALUE ZEROES.                 
          05 FILLER               PIC X(61)      VALUE SPACES.                  
          05 LC44-PROJ-AMT-D      PIC ZZZ,ZZ9.99 VALUE ZEROES.                  
                                                                                
      *----------- SUMMARY OF TOTALS ----------------*                          
                                                                                
       01 WS-LC44-HDR1-TOTAL.                                                   
          05 FILLER               PIC X(17)     VALUE                           
             'CASES IN ARREARS:'.                                               
                                                                                
       01 WS-LC44-HDR2-TOTAL.                                                   
          05 FILLER               PIC X(27)     VALUE SPACES.                   
          05 FILLER               PIC X(07)     VALUE 'AMT ($)'.                
          05 FILLER               PIC X(07)     VALUE SPACES.                   
          05 FILLER               PIC X(05)     VALUE 'CASES'.                  
                                                                                
       01 WS-LC44-DASHES.                                                       
          05 FILLER               PIC X(50)     VALUE ALL '-'.                  
                                                                                
       01 WS-LC44-DTL1-TOTAL.                                                   
          05 FILLER               PIC X(08)     VALUE '<= 1 MTH'.               
          05 FILLER               PIC X(15)     VALUE SPACES.                   
          05 LC4A-AMT-TOTAL       PIC Z,ZZZ,ZZ9.99 VALUE ZEROES.                
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4A-CASES-TOTAL     PIC Z,ZZZ,ZZ9 VALUE ZEROES.                   
                                                                                
       01 WS-LC44-DTL2-TOTAL.                                                   
          05 FILLER               PIC X(21)     VALUE                           
             '>  1 MTH TO <= 2 MTHS'.                                           
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4B-AMT-TOTAL       PIC Z,ZZZ,ZZ9.99 VALUE ZEROES.                
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4B-CASES-TOTAL     PIC Z,ZZZ,ZZ9 VALUE ZEROES.                   
                                                                                
       01 WS-LC44-DTL3-TOTAL.                                                   
          05 FILLER               PIC X(21)     VALUE                           
             '>  2 MTHS TO < 3 MTHS'.                                           
          05 FILLER               PIC X(02)     VALUE SPACES.                   
          05 LC4C-AMT-TOTAL       PIC Z,ZZZ,ZZ9.99 VALUE ZEROES.                
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4C-CASES-TOTAL     PIC Z,ZZZ,ZZ9 VALUE ZEROES.                   
                                                                                
       01 WS-LC44-DTL4-TOTAL.                                                   
          05 FILLER               PIC X(20)     VALUE                           
             '>= 3 MTHS'.                                                       
          05 FILLER               PIC X(03)     VALUE SPACES.                   
          05 LC4D-AMT-TOTAL       PIC Z,ZZZ,ZZ9.99 VALUE ZEROES.                
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4D-CASES-TOTAL     PIC Z,ZZZ,ZZ9 VALUE ZEROES.                   
                                                                                
       01 WS-LC44-GRAND-TOTAL.                                                  
          05 FILLER               PIC X(11)     VALUE 'GRAND TOTAL'.            
          05 FILLER               PIC X(12)     VALUE SPACES.                   
          05 LC4D-GRND-TOT-AMT    PIC Z,ZZZ,ZZ9.99 VALUE ZEROES.                
          05 FILLER               PIC X(01)     VALUE SPACES.                   
          05 LC4D-GRNT-TOT-CASES  PIC Z,ZZZ,ZZ9 VALUE ZEROES.                   
                                                                                
                                                                                
      *-------------------------------                                          
       PROCEDURE DIVISION.                                                      
      *-------------------------------                                          
                                                                                
      *-------------------------------                                          
       0000-MAIN-ROUTINE.                                                       
      *-------------------------------                                          
           PERFORM 1000-START-UP          THRU 1000-EXIT.                       
           PERFORM 2000-FD04-READ         THRU 2000-EXIT.                       
           PERFORM 3000-PROCESS-RECORDS   THRU 3000-EXIT                        
                   UNTIL WS-FLG-FD04-EOF = 'Y'.                                 
           PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT.                       
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       1000-START-UP.                                                           
      *-------------------------------                                          
           OPEN INPUT  BP13FD04                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                       BP13KA10                                                 
                       SY02F001                                                 
                       AC15K010                                                 
               OUTPUT  P13LC44A                                                 
                       P13LC44B                                                 
                       P13LC44C                                                 
                       P13LC44D.                                                
                                                                                
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 - FILE OPEN ERROR'                              
              MOVE WS-K800-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 - FILE OPEN ERROR'                              
              MOVE WS-K820-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K010 - FILE OPEN ERROR'                              
              MOVE WS-K010-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-KA10-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13KA10 - FILE OPEN ERROR'                              
              MOVE WS-KA10-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           READ SY02F001.                                                       
                                                                                
           MOVE F001-DTE-CURRENT                 TO WS-DATE                     
           MOVE F001-DTE-LAST-DAY-PREV           TO WS-LASTDATE.                
                                                                                
           STRING WS-DD '/' WS-MM '/' WS-CCYY                                   
           DELIMITED BY SIZE                   INTO WS-DATE-HDR.                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------                                          
       2000-FD04-READ.                                                          
      *-------------------------------                                          
           READ BP13FD04                                                        
              AT END MOVE 'Y' TO WS-FLG-FD04-EOF                                
                     GO TO 2000-EXIT.                                           
                                                                                
           ADD 1 TO WS-CNT-FD04-READ.                                           
                                                                                
           IF FD04-CDE-ACCT-STAT = 'X'                                          
              PERFORM 2100-COMPUTE-MONTH-EX   THRU 2100-EXIT                    
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------                                          
       2100-COMPUTE-MONTH-EX.                                                   
      *-------------------------------                                          
                                                                                
           MOVE BP13FD04-REC(1401:8)   TO WS-DTE-REPUDIATE                      
           MOVE F001-DTE-LAST-DAY-PREV TO WS-DTE-CURRENT                        
                                                                                
           COMPUTE WS-REPUD-MONTH = WS-DTE-REPUD-YYYY * 12 +                    
                                    WS-DTE-REPUD-MM                             
                                                                                
           COMPUTE WS-CURR-MONTH  = WS-DTE-CURR-YYYY * 12 +                     
                                    WS-DTE-CURR-MM                              
                                                                                
                                                                                
           COMPUTE FD04-NUM-MTH-INSTAL = WS-REPUD-MONTH - WS-CURR-MONTH.        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       3000-PROCESS-RECORDS.                                                    
      *-------------------------------                                          
           IF FD04-AMT-ARR-INSTAL NOT NUMERIC                                   
              MOVE  0 TO FD04-AMT-ARR-INSTAL                                    
           END-IF.                                                              
                                                                                
           PERFORM 3050-READ-BP13K800            THRU 3050-EXIT.                
                                                                                
           IF WS-K800-STATUS = 00                                               
                                                                                
              PERFORM 4000-MOVE-REPORT-DTLS      THRU 4000-EXIT                 
              PERFORM 5000-RETRIEVE-FIELDS       THRU 5000-EXIT                 
                                                                                
              IF FD04-NUM-MTH-INSTAL <= 1 AND                                   
                 FD04-NUM-MTH-INSTAL > 0                                        
                 PERFORM 6000-PRINT-P13LC44A     THRU 6000-EXIT                 
                                                                                
                 ADD FD04-AMT-ARR-INSTAL TO WS-TOTAL-LC4A                       
                                            WS-TOTAL-AMT                        
              END-IF                                                            
                                                                                
              IF FD04-NUM-MTH-INSTAL >  1 AND                                   
                 FD04-NUM-MTH-INSTAL <= 2                                       
                 PERFORM 6100-PRINT-P13LC44B     THRU 6100-EXIT                 
                                                                                
                 ADD FD04-AMT-ARR-INSTAL TO WS-TOTAL-LC4B                       
                                            WS-TOTAL-AMT                        
              END-IF                                                            
                                                                                
              IF FD04-NUM-MTH-INSTAL >  2 AND                                   
                 FD04-NUM-MTH-INSTAL <  3                                       
                 PERFORM 6200-PRINT-P13LC44C     THRU 6200-EXIT                 
                                                                                
                 ADD FD04-AMT-ARR-INSTAL TO WS-TOTAL-LC4C                       
                                            WS-TOTAL-AMT                        
              END-IF                                                            
                                                                                
              IF FD04-NUM-MTH-INSTAL >= 3                                       
                 PERFORM 6300-PRINT-P13LC44D     THRU 6300-EXIT                 
                                                                                
                 ADD FD04-AMT-ARR-INSTAL TO WS-TOTAL-LC4D                       
                                            WS-TOTAL-AMT                        
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
           PERFORM 2000-FD04-READ           THRU 2000-EXIT.                     
           PERFORM 3100-CHECK-PROJECT-TOTAL THRU 3100-EXIT.                     
                                                                                
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       3050-READ-BP13K800.                                                      
      *-------------------------------                                          
      *    RETRIEVE OCCUPIERS                                                   
      *-------------------------------------                                    
           MOVE FD04-NUM-REGN TO K800-NUM-REGN.                                 
           READ BP13K800.                                                       
                                                                                
           IF WS-K800-STATUS = 00                                               
              CONTINUE                                                          
                                                                                
           ELSE                                                                 
             IF WS-K800-STATUS = 23                                             
                DISPLAY 'BP13K800 - REC NOT FND ' WS-K800-STATUS                
                        ',KEY IS '  K800-NUM-REGN                               
             ELSE                                                               
                DISPLAY 'BP13K800 - ERROR ON READ ' WS-K800-STATUS              
                        ',KEY IS '  K800-NUM-REGN                               
             END-IF                                                             
           END-IF.                                                              
                                                                                
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       3100-CHECK-PROJECT-TOTAL.                                                
      *-------------------------------                                          
           IF WS-FLG-FD04-EOF = 'Y'                                             
                                                                                
              IF WS-PRINTED-A = 'Y'                                             
                 MOVE 'P13LC44A' TO WS-LC44-HDR                                 
                 PERFORM 3200-PRINT-PROJECT-TOTALS  THRU 3200-EXIT              
              END-IF                                                            
                                                                                
              IF WS-PRINTED-B = 'Y'                                             
                 MOVE 'P13LC44B' TO WS-LC44-HDR                                 
                 PERFORM 3200-PRINT-PROJECT-TOTALS  THRU 3200-EXIT              
              END-IF                                                            
                                                                                
              IF WS-PRINTED-C = 'Y'                                             
                 MOVE 'P13LC44C' TO WS-LC44-HDR                                 
                 PERFORM 3200-PRINT-PROJECT-TOTALS  THRU 3200-EXIT              
              END-IF                                                            
                                                                                
              IF WS-PRINTED-D = 'Y'                                             
                 MOVE 'P13LC44D' TO WS-LC44-HDR                                 
                 PERFORM 3200-PRINT-PROJECT-TOTALS  THRU 3200-EXIT              
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       3200-PRINT-PROJECT-TOTALS.                                               
      *-------------------------------                                          
           EVALUATE WS-LC44-HDR                                                 
              WHEN 'P13LC44A'                                                   
                   MOVE WS-SNOA       TO LC44-CASES-A                           
                   MOVE WS-PROJ-AMT-A TO LC44-PROJ-AMT-A                        
                   WRITE P13LC44A-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44A-REC FROM WS-BLANK-LINE                        
                   WRITE P13LC44A-REC FROM WS-LC44-PROJ-TOTAL-A                 
                   WRITE P13LC44A-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44A-REC FROM WS-BLANK-LINE                        
                   ADD  5                  TO WS-LINE-CTRA                      
                                                                                
              WHEN 'P13LC44B'                                                   
                   MOVE WS-SNOB       TO LC44-CASES-B                           
                   MOVE WS-PROJ-AMT-B TO LC44-PROJ-AMT-B                        
                   WRITE P13LC44B-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44B-REC FROM WS-BLANK-LINE                        
                   WRITE P13LC44B-REC FROM WS-LC44-PROJ-TOTAL-B                 
                   WRITE P13LC44B-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44B-REC FROM WS-BLANK-LINE                        
                   ADD  5                  TO WS-LINE-CTRB                      
                                                                                
              WHEN 'P13LC44C'                                                   
                   MOVE WS-SNOC       TO LC44-CASES-C                           
                   MOVE WS-PROJ-AMT-C TO LC44-PROJ-AMT-C                        
                   WRITE P13LC44C-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44C-REC FROM WS-BLANK-LINE                        
                   WRITE P13LC44C-REC FROM WS-LC44-PROJ-TOTAL-C                 
                   WRITE P13LC44C-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44C-REC FROM WS-BLANK-LINE                        
                   ADD  5                  TO WS-LINE-CTRC                      
                                                                                
              WHEN 'P13LC44D'                                                   
                   MOVE WS-SNOD       TO LC44-CASES-D                           
                   MOVE WS-PROJ-AMT-D TO LC44-PROJ-AMT-D                        
                   WRITE P13LC44D-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44D-REC FROM WS-BLANK-LINE                        
                   WRITE P13LC44D-REC FROM WS-LC44-PROJ-TOTAL-D                 
                   WRITE P13LC44D-REC FROM WS-LC44-UNDERSCORE                   
                   WRITE P13LC44D-REC FROM WS-BLANK-LINE                        
                   ADD  5                  TO WS-LINE-CTRD                      
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       4000-MOVE-REPORT-DTLS.                                                   
      *-------------------------------                                          
           MOVE SPACES               TO  WS-LC44-DETAILS                        
                                         WS-LC44-DETAIL2                        
                                         WS-LC44-DETAIL3                        
                                         LC44-PROJECT.                          
                                                                                
           IF FD04-NUM-MTH-INSTAL  NOT NUMERIC                                  
              MOVE 0 TO FD04-NUM-MTH-INSTAL                                     
           END-IF.                                                              
           IF FD04-AMT-ARR-INSTAL  NOT NUMERIC                                  
              MOVE 0 TO FD04-AMT-ARR-INSTAL                                     
           END-IF.                                                              
                                                                                
           MOVE FD04-NUM-REGN        TO  LC44-REGNO.                            
           MOVE FD04-CDE-TYP-ACTUSE  TO  LC44-FLAT-TYPE.                        
           MOVE FD04-CDE-ACCT-STAT   TO  LC44-ACCT-STAT.                        
           MOVE FD04-NUM-MTH-INSTAL  TO  LC44-MO-ARREAR.                        
           MOVE FD04-AMT-ARR-INSTAL  TO  LC44-AMT-ARREAR.                       
           MOVE WS-DATE-HDR          TO  LC44-DATE-HDR.                         
                                                                                
           STRING FD04-NUM-SCH-ACCNT(01:4) '-'                                  
                  FD04-NUM-SCH-ACCNT(05:4) '-'                                  
                  FD04-NUM-SCH-ACCNT(09:1) '-'                                  
                  FD04-NUM-SCH-ACCNT(10:2)                                      
           DELIMITED BY SIZE       INTO  LC44-SCH-ACC.                          
                                                                                
           STRING 'BLK ' FD04-NUM-BLK      ' #'                                 
                         FD04-LEVEL-NO     '-'                                  
                         FD04-MAIN-UNIT    ' ' DELIMITED BY SIZE                
                         FD04-SUB-UNIT     ' ' DELIMITED BY '   '               
                         FD04-STREET-NAME      DELIMITED BY '   '               
                         INTO  LC44-ADDRESS.                                    
                                                                                
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       5000-RETRIEVE-FIELDS.                                                    
      *-------------------------------                                          
           IF K800-NUM-NRIC1 NOT = SPACES AND LOW-VALUES AND ZEROES             
              MOVE SPACES                TO   BP13K820-REC                      
              MOVE K800-NUM-NRIC1        TO   K820-NUM-NRIC                     
              MOVE FD04-NUM-REGN         TO   K820-NUM-REGN                     
              PERFORM 5010-READ-BP13K820           THRU 5010-EXIT               
              MOVE K820-NME-OCCP         TO   LC44-NAME1                        
           END-IF.                                                              
                                                                                
           IF K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES AND ZEROES             
              MOVE SPACES                TO   BP13K820-REC                      
              MOVE K800-NUM-NRIC2        TO   K820-NUM-NRIC                     
              MOVE FD04-NUM-REGN         TO   K820-NUM-REGN                     
              PERFORM 5010-READ-BP13K820 THRU 5010-EXIT                         
              MOVE K820-NME-OCCP         TO   LC44-NAME2                        
           END-IF.                                                              
                                                                                
           PERFORM 5100-RETRIEVE-LTE-PYMNT-CHRGE THRU 5100-EXIT.                
           PERFORM 5200-RETRIEVE-PROJECT-NAME    THRU 5200-EXIT.                
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       5010-READ-BP13K820.                                                      
      *-------------------------------                                          
           READ BP13K820.                                                       
                                                                                
           IF WS-K820-STATUS = 00                                               
              CONTINUE                                                          
           ELSE                                                                 
                                                                                
             MOVE SPACES TO K820-NME-OCCP                                       
                                                                                
             IF WS-K820-STATUS = 23                                             
                DISPLAY 'BP13K820-REC NOT FND'                                  
                        ',KEY IS ' K820-NUM-REGN K820-NUM-NRIC                  
             ELSE                                                               
                DISPLAY 'BP13K820 - ERROR ON READ ' WS-K820-STATUS              
                        ',KEY IS ' K820-NUM-REGN K820-NUM-NRIC                  
             END-IF                                                             
           END-IF.                                                              
                                                                                
                                                                                
       5010-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------           
       5100-RETRIEVE-LTE-PYMNT-CHRGE.                                           
      *--------------------------------------------------------------           
      *    RETRIEVE LATE PAYMENT CHARGE FROM AC15K010             *             
      *-----------------------------------------------------------*             
           MOVE FD04-NUM-SCH-ACCNT TO K010-ACCESS-KEY.                          
           READ AC15K010.                                                       
                                                                                
           IF WS-K010-STATUS = 00                                               
              IF K010-PF-BAL-OS NOT NUMERIC                                     
                 MOVE 0 TO K010-PF-BAL-OS                                       
              END-IF                                                            
              MOVE K010-PF-BAL-OS  TO LC44-LTE-PYMNT-CHRGE                      
                                                                                
           ELSE                                                                 
                                                                                
             MOVE 0                TO LC44-LTE-PYMNT-CHRGE                      
                                                                                
             IF WS-K010-STATUS = 23                                             
                DISPLAY 'AC15K010 - REC NOT FND'                                
                        ',KEY IS '   K010-ACCESS-KEY                            
             ELSE                                                               
                DISPLAY 'AC15K010 - ERROR ON READ ' WS-K010-STATUS              
                        ',KEY IS '   K010-ACCESS-KEY                            
             END-IF                                                             
           END-IF.                                                              
                                                                                
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------           
       5200-RETRIEVE-PROJECT-NAME.                                              
      *--------------------------------------------------------------           
           MOVE FD04-NUM-PROJECT   TO KA10-KEY-FLD.                             
           READ BP13KA10.                                                       
                                                                                
           IF WS-KA10-STATUS = 00                                               
              MOVE KA10-NME-PRJCT TO LC44-PROJECT                               
           ELSE                                                                 
                                                                                
             MOVE 'PROJECT NOT FOUND' TO LC44-PROJECT                           
                                                                                
             IF WS-KA10-STATUS = 23                                             
                DISPLAY 'BP13KA10 - REC NOT FND '                               
                        ',KEY IS '   KA10-KEY-FLD                               
             ELSE                                                               
                DISPLAY 'BP13KA10 - ERROR ON READ ' WS-KA10-STATUS              
                        ',KEY IS '   KA10-KEY-FLD                               
             END-IF                                                             
           END-IF.                                                              
                                                                                
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------                                          
       6000-PRINT-P13LC44A.                                                     
      *-------------------------------                                          
           ADD   1                      TO  WS-SNOA.                            
           MOVE  WS-SNOA                TO  LC44-DTL-SERIAL.                    
           MOVE  SPACES                 TO  LC44-TITLE                          
                                            LC44-HDR.                           
           MOVE  'P13LC44A'             TO  LC44-HDR.                           
           MOVE  'N'                    TO  WS-PRNT-PROJ-A.                     
           MOVE  'Y'                    TO  WS-PRINTED-A.                       
                                                                                
           IF WS-PROJECT-A = SPACES                                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-A                             
           END-IF.                                                              
                                                                                
           IF FD04-CDE-ACCT-STAT = 'X'                                          
              STRING 'LIST OF DBSS EX-ACCOUNTS WITH ARREARS '                   
                     '<= 1 MTH AS AT '                                          
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           ELSE                                                                 
              STRING 'LIST OF DBSS ACCOUNTS WITH ARREARS '                      
                     '<= 1 MTH AS AT '                                          
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           END-IF                                                               
                                                                                
           IF FD04-NUM-PROJECT NOT = WS-PROJECT-A                               
              COMPUTE      WS-SNOA = WS-SNOA - 1                                
              MOVE WS-SNOA       TO LC44-CASES-A                                
              MOVE WS-PROJ-AMT-A TO LC44-PROJ-AMT-A                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-A                             
              MOVE 1                TO WS-SNOA LC44-DTL-SERIAL                  
              MOVE 'Y'              TO WS-PRNT-PROJ-A                           
              MOVE 0                  TO WS-PROJ-AMT-A                          
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-A                          
           ELSE                                                                 
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-A                          
           END-IF.                                                              
                                                                                
           IF WS-PRNT-PROJ-A = 'Y'                                              
             WRITE P13LC44A-REC FROM WS-LC44-UNDERSCORE                         
             WRITE P13LC44A-REC FROM WS-BLANK-LINE                              
             WRITE P13LC44A-REC FROM WS-LC44-PROJ-TOTAL-A                       
             WRITE P13LC44A-REC FROM WS-LC44-UNDERSCORE                         
             WRITE P13LC44A-REC FROM WS-BLANK-LINE                              
             ADD  5                  TO WS-LINE-CTRA                            
           END-IF.                                                              
                                                                                
           IF WS-LINE-CTRA > WS-MAX-LINE OR                                     
              WS-SNOA        =  1        OR                                     
              WS-PRNT-PROJ-A = 'Y'                                              
              ADD            1   TO WS-PAGE-CTRA                                
              MOVE ZEROES        TO LC44-PAGE-HDR                               
              MOVE WS-PAGE-CTRA  TO LC44-PAGE-HDR                               
              PERFORM 7000-PRINT-HEADING THRU 7000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC44A-REC FROM WS-LC44-DETAILS.                             
           WRITE P13LC44A-REC FROM WS-LC44-DETAIL2.                             
           WRITE P13LC44A-REC FROM WS-LC44-DETAIL3.                             
           WRITE P13LC44A-REC FROM WS-BLANK-LINE.                               
           ADD   4            TO   WS-LINE-CTRA.                                
           ADD   1            TO   WS-CNT-LC44A-WRITE.                          
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------                                          
       6100-PRINT-P13LC44B.                                                     
      *-------------------------------                                          
           ADD   1                      TO  WS-SNOB.                            
           MOVE  WS-SNOB                TO  LC44-DTL-SERIAL.                    
           MOVE  SPACES                 TO  LC44-TITLE                          
                                            LC44-HDR.                           
           MOVE  'P13LC44B'             TO  LC44-HDR.                           
           MOVE  'N'                    TO  WS-PRNT-PROJ-B.                     
           MOVE  'Y'                    TO  WS-PRINTED-B.                       
                                                                                
           IF WS-PROJECT-B = SPACES                                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-B                             
           END-IF.                                                              
                                                                                
           IF FD04-CDE-ACCT-STAT = 'X'                                          
              STRING 'LIST OF DBSS EX-ACCOUNTS WITH ARREARS '                   
                     '> 1 MTH TO <= 2 MTHS AS AT '                              
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           ELSE                                                                 
              STRING 'LIST OF DBSS ACCOUNTS WITH ARREARS '                      
                     '> 1 MTH TO <= 2 MTHS AS AT '                              
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           END-IF                                                               
                                                                                
           IF FD04-NUM-PROJECT NOT = WS-PROJECT-B                               
              COMPUTE      WS-SNOB = WS-SNOB - 1                                
              MOVE WS-SNOB       TO LC44-CASES-B                                
              MOVE WS-PROJ-AMT-B TO LC44-PROJ-AMT-B                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-B                             
              MOVE 1                TO WS-SNOB LC44-DTL-SERIAL                  
              MOVE 'Y'              TO WS-PRNT-PROJ-B                           
              MOVE 0                  TO WS-PROJ-AMT-B                          
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-B                          
           ELSE                                                                 
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-B                          
           END-IF.                                                              
                                                                                
           IF WS-PRNT-PROJ-B = 'Y'                                              
             WRITE P13LC44B-REC FROM WS-LC44-UNDERSCORE                         
             WRITE P13LC44B-REC FROM WS-BLANK-LINE                              
             WRITE P13LC44B-REC FROM WS-LC44-PROJ-TOTAL-B                       
             WRITE P13LC44B-REC FROM WS-LC44-UNDERSCORE                         
             WRITE P13LC44B-REC FROM WS-BLANK-LINE                              
             ADD  5                  TO WS-LINE-CTRB                            
           END-IF.                                                              
                                                                                
           IF WS-LINE-CTRB > WS-MAX-LINE OR                                     
              WS-SNOB        =  1        OR                                     
              WS-PRNT-PROJ-B = 'Y'                                              
              ADD            1   TO WS-PAGE-CTRB                                
              MOVE ZEROES        TO LC44-PAGE-HDR                               
              MOVE WS-PAGE-CTRB  TO LC44-PAGE-HDR                               
              PERFORM 7000-PRINT-HEADING THRU 7000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC44B-REC FROM WS-LC44-DETAILS.                             
           WRITE P13LC44B-REC FROM WS-LC44-DETAIL2.                             
           WRITE P13LC44B-REC FROM WS-LC44-DETAIL3.                             
           WRITE P13LC44B-REC FROM WS-BLANK-LINE.                               
           ADD   4            TO   WS-LINE-CTRB.                                
           ADD   1            TO   WS-CNT-LC44B-WRITE.                          
                                                                                
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------                                          
       6200-PRINT-P13LC44C.                                                     
      *-------------------------------                                          
           ADD   1                      TO  WS-SNOC.                            
           MOVE  WS-SNOC                TO  LC44-DTL-SERIAL.                    
           MOVE  SPACES                 TO  LC44-TITLE                          
                                            LC44-HDR.                           
           MOVE  'P13LC44C'             TO  LC44-HDR.                           
           MOVE  'N'                    TO  WS-PRNT-PROJ-C.                     
           MOVE  'Y'                    TO  WS-PRINTED-C.                       
                                                                                
           IF WS-PROJECT-C = SPACES                                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-C                             
           END-IF.                                                              
                                                                                
           IF FD04-CDE-ACCT-STAT = 'X'                                          
              STRING 'LIST OF DBSS EX-ACCOUNTS WITH ARREARS '                   
                     '> 2 MTH TO < 3 MTHS AS AT '                               
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           ELSE                                                                 
              STRING 'LIST OF DBSS ACCOUNTS WITH ARREARS '                      
                     '> 2 MTH TO < 3 MTHS AS AT '                               
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           END-IF                                                               
                                                                                
           IF FD04-NUM-PROJECT NOT = WS-PROJECT-C                               
              COMPUTE      WS-SNOC = WS-SNOC - 1                                
              MOVE WS-SNOC       TO LC44-CASES-C                                
              MOVE WS-PROJ-AMT-C TO LC44-PROJ-AMT-C                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-C                             
              MOVE 1                TO WS-SNOC LC44-DTL-SERIAL                  
              MOVE 'Y'              TO WS-PRNT-PROJ-C                           
              MOVE 0                  TO WS-PROJ-AMT-C                          
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-C                          
           ELSE                                                                 
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-C                          
           END-IF.                                                              
                                                                                
           IF WS-PRNT-PROJ-C = 'Y'                                              
             WRITE P13LC44C-REC FROM WS-LC44-UNDERSCORE                         
             WRITE P13LC44C-REC FROM WS-BLANK-LINE                              
             WRITE P13LC44C-REC FROM WS-LC44-PROJ-TOTAL-C                       
             WRITE P13LC44C-REC FROM WS-LC44-UNDERSCORE                         
             WRITE P13LC44C-REC FROM WS-BLANK-LINE                              
             ADD  5                  TO WS-LINE-CTRC                            
           END-IF.                                                              
                                                                                
           IF WS-LINE-CTRC > WS-MAX-LINE OR                                     
              WS-SNOC        =  1        OR                                     
              WS-PRNT-PROJ-C = 'Y'                                              
              ADD            1   TO WS-PAGE-CTRC                                
              MOVE ZEROES        TO LC44-PAGE-HDR                               
              MOVE WS-PAGE-CTRC  TO LC44-PAGE-HDR                               
              PERFORM 7000-PRINT-HEADING THRU 7000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC44C-REC FROM WS-LC44-DETAILS.                             
           WRITE P13LC44C-REC FROM WS-LC44-DETAIL2.                             
           WRITE P13LC44C-REC FROM WS-LC44-DETAIL3.                             
           WRITE P13LC44C-REC FROM WS-BLANK-LINE.                               
           ADD   4            TO   WS-LINE-CTRC.                                
           ADD   1            TO   WS-CNT-LC44C-WRITE.                          
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------                                          
       6300-PRINT-P13LC44D.                                                     
      *-------------------------------                                          
           ADD   1                      TO  WS-SNOD.                            
           MOVE  WS-SNOD                TO  LC44-DTL-SERIAL.                    
           MOVE  SPACES                 TO  LC44-TITLE                          
                                            LC44-HDR.                           
           MOVE  'P13LC44D'             TO  LC44-HDR.                           
           MOVE  'N'                    TO  WS-PRNT-PROJ-D.                     
           MOVE  'Y'                    TO  WS-PRINTED-D.                       
                                                                                
           IF WS-PROJECT-D = SPACES                                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-D                             
           END-IF.                                                              
                                                                                
           IF FD04-CDE-ACCT-STAT = 'X'                                          
              STRING 'LIST OF DBSS EX-ACCOUNTS WITH ARREARS '                   
                     '>= 3 MTHS AS AT '                                         
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           ELSE                                                                 
              STRING 'LIST OF DBSS ACCOUNTS WITH ARREARS '                      
                     '>= 3 MTHS AS AT '                                         
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE          INTO  LC44-TITLE                       
           END-IF                                                               
                                                                                
           IF FD04-NUM-PROJECT NOT = WS-PROJECT-D                               
              COMPUTE      WS-SNOD = WS-SNOD - 1                                
              MOVE WS-SNOD       TO LC44-CASES-D                                
              MOVE WS-PROJ-AMT-D TO LC44-PROJ-AMT-D                             
              MOVE FD04-NUM-PROJECT TO WS-PROJECT-D                             
              MOVE 1                TO WS-SNOD LC44-DTL-SERIAL                  
              MOVE 'Y'              TO WS-PRNT-PROJ-D                           
              MOVE 0                  TO WS-PROJ-AMT-D                          
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-D                          
           ELSE                                                                 
              ADD FD04-AMT-ARR-INSTAL TO WS-PROJ-AMT-D                          
           END-IF.                                                              
                                                                                
           IF WS-PRNT-PROJ-D = 'Y'                                              
             WRITE P13LC44D-REC FROM WS-LC44-UNDERSCORE                         
             WRITE P13LC44D-REC FROM WS-BLANK-LINE                              
             WRITE P13LC44D-REC FROM WS-LC44-PROJ-TOTAL-D                       
             WRITE P13LC44D-REC FROM WS-BLANK-LINE                              
             WRITE P13LC44D-REC FROM WS-LC44-UNDERSCORE                         
             ADD  5                  TO WS-LINE-CTRD                            
           END-IF.                                                              
                                                                                
           IF WS-LINE-CTRD > WS-MAX-LINE OR                                     
              WS-SNOD        =  1        OR                                     
              WS-PRNT-PROJ-D = 'Y'                                              
              ADD            1   TO WS-PAGE-CTRD                                
              MOVE ZEROES        TO LC44-PAGE-HDR                               
              MOVE WS-PAGE-CTRD  TO LC44-PAGE-HDR                               
              PERFORM 7000-PRINT-HEADING THRU 7000-EXIT                         
           END-IF.                                                              
                                                                                
           WRITE P13LC44D-REC FROM WS-LC44-DETAILS.                             
           WRITE P13LC44D-REC FROM WS-LC44-DETAIL2.                             
           WRITE P13LC44D-REC FROM WS-LC44-DETAIL3.                             
           WRITE P13LC44D-REC FROM WS-BLANK-LINE.                               
           ADD   4            TO   WS-LINE-CTRD.                                
           ADD   1            TO   WS-CNT-LC44D-WRITE.                          
                                                                                
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------                                          
       6400-PRINT-TOTAL-PAGE.                                                   
      *-------------------------------                                          
           MOVE  SPACES               TO  LC44-TITLE                            
                                          LC44-HDR.                             
           MOVE  'P13LC44 '           TO  LC44-HDR.                             
                                                                                
           IF FD04-CDE-ACCT-STAT = 'X'                                          
              STRING 'SUMMARY LIST OF DBSS EX-ACCOUNTS WITH '                   
                     'ARREARS AS AT '                                           
                   WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY         
              DELIMITED BY SIZE       INTO  LC44-TITLE                          
           ELSE                                                                 
              STRING 'SUMMARY LIST OF DBSS ACCOUNTS WITH ARREARS AS AT '        
                    WS-LAST-DD ' ' WS-MONTH(WS-LAST-MM) ' ' WS-LAST-CCYY        
              DELIMITED BY SIZE       INTO  LC44-TITLE                          
           END-IF                                                               
                                                                                
           MOVE 1                     TO   LC44-PAGE-HDR.                       
           MOVE WS-TOTAL-LC4A         TO   LC4A-AMT-TOTAL.                      
           MOVE WS-TOTAL-LC4B         TO   LC4B-AMT-TOTAL.                      
           MOVE WS-TOTAL-LC4C         TO   LC4C-AMT-TOTAL.                      
           MOVE WS-TOTAL-LC4D         TO   LC4D-AMT-TOTAL.                      
           MOVE WS-TOTAL-AMT          TO   LC4D-GRND-TOT-AMT.                   
           MOVE WS-CNT-LC44A-WRITE    TO   LC4A-CASES-TOTAL.                    
           MOVE WS-CNT-LC44B-WRITE    TO   LC4B-CASES-TOTAL.                    
           MOVE WS-CNT-LC44C-WRITE    TO   LC4C-CASES-TOTAL.                    
           MOVE WS-CNT-LC44D-WRITE    TO   LC4D-CASES-TOTAL.                    
                                                                                
           COMPUTE WS-TOTAL-CASES =                                             
               WS-CNT-LC44A-WRITE + WS-CNT-LC44B-WRITE +                        
               WS-CNT-LC44C-WRITE + WS-CNT-LC44D-WRITE.                         
                                                                                
           MOVE WS-TOTAL-CASES        TO   LC4D-GRNT-TOT-CASES.                 
                                                                                
           WRITE P13LC44D-REC FROM HEADING-1 AFTER PAGE.                        
           WRITE P13LC44D-REC FROM HEADING-2.                                   
           WRITE P13LC44D-REC FROM WS-BLANK-LINE.                               
           WRITE P13LC44D-REC FROM WS-BLANK-LINE.                               
                                                                                
           WRITE P13LC44D-REC FROM WS-LC44-HDR1-TOTAL.                          
           WRITE P13LC44D-REC FROM WS-LC44-HDR2-TOTAL.                          
           WRITE P13LC44D-REC FROM WS-LC44-DASHES.                              
           WRITE P13LC44D-REC FROM WS-LC44-DTL1-TOTAL.                          
           WRITE P13LC44D-REC FROM WS-LC44-DTL2-TOTAL.                          
           WRITE P13LC44D-REC FROM WS-LC44-DTL3-TOTAL.                          
           WRITE P13LC44D-REC FROM WS-LC44-DTL4-TOTAL.                          
           WRITE P13LC44D-REC FROM WS-BLANK-LINE.                               
           WRITE P13LC44D-REC FROM WS-LC44-GRAND-TOTAL.                         
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------                                          
       7000-PRINT-HEADING.                                                      
      *-------------------------------                                          
           EVALUATE LC44-HDR                                                    
              WHEN 'P13LC44A'                                                   
                  WRITE P13LC44A-REC FROM WS-BLANK-LINE AFTER PAGE              
                  WRITE P13LC44A-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44A-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44A-REC FROM HEADING-1                             
                  WRITE P13LC44A-REC FROM HEADING-2                             
                  WRITE P13LC44A-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44A-REC FROM HEADING-3                             
                  WRITE P13LC44A-REC FROM HEADING-4                             
                  WRITE P13LC44A-REC FROM HEADING-5                             
                  WRITE P13LC44A-REC FROM WS-DASH-LINE                          
                                                                                
                  INITIALIZE WS-LINE-CTRA                                       
                  MOVE 10 TO WS-LINE-CTRA                                       
                                                                                
              WHEN 'P13LC44B'                                                   
                  WRITE P13LC44B-REC FROM WS-BLANK-LINE AFTER PAGE              
                  WRITE P13LC44B-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44B-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44B-REC FROM HEADING-1                             
                  WRITE P13LC44B-REC FROM HEADING-2                             
                  WRITE P13LC44B-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44B-REC FROM HEADING-3                             
                  WRITE P13LC44B-REC FROM HEADING-4                             
                  WRITE P13LC44B-REC FROM HEADING-5                             
                  WRITE P13LC44B-REC FROM WS-DASH-LINE                          
                                                                                
                  INITIALIZE WS-LINE-CTRB                                       
                  MOVE 10 TO WS-LINE-CTRB                                       
                                                                                
              WHEN 'P13LC44C'                                                   
                  WRITE P13LC44C-REC FROM WS-BLANK-LINE AFTER PAGE              
                  WRITE P13LC44C-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44C-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44C-REC FROM HEADING-1                             
                  WRITE P13LC44C-REC FROM HEADING-2                             
                  WRITE P13LC44C-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44C-REC FROM HEADING-3                             
                  WRITE P13LC44C-REC FROM HEADING-4                             
                  WRITE P13LC44C-REC FROM HEADING-5                             
                  WRITE P13LC44C-REC FROM WS-DASH-LINE                          
                                                                                
                  INITIALIZE WS-LINE-CTRC                                       
                  MOVE 10 TO WS-LINE-CTRC                                       
                                                                                
              WHEN 'P13LC44D'                                                   
                  WRITE P13LC44D-REC FROM WS-BLANK-LINE AFTER PAGE              
                  WRITE P13LC44D-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44D-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44D-REC FROM HEADING-1                             
                  WRITE P13LC44D-REC FROM HEADING-2                             
                  WRITE P13LC44D-REC FROM WS-BLANK-LINE                         
                  WRITE P13LC44D-REC FROM HEADING-3                             
                  WRITE P13LC44D-REC FROM HEADING-4                             
                  WRITE P13LC44D-REC FROM HEADING-5                             
                  WRITE P13LC44D-REC FROM WS-DASH-LINE                          
                                                                                
                  INITIALIZE WS-LINE-CTRD                                       
                  MOVE 10 TO WS-LINE-CTRD                                       
                                                                                
           END-EVALUATE.                                                        
                                                                                
       7000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------                                          
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------                                          
           PERFORM 6400-PRINT-TOTAL-PAGE  THRU 6400-EXIT.                       
                                                                                
           CLOSE BP13FD04                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 SY02F001                                                       
                 AC15K010                                                       
                 P13LC44A                                                       
                 P13LC44B                                                       
                 P13LC44C                                                       
                 P13LC44D.                                                      
                                                                                
           DISPLAY ' RUN   DATE :  ' WS-DATE-HDR.                               
           DISPLAY ' *------ BP13CC44 AUDIT TRAIL ------*'.                     
           DISPLAY '    '.                                                      
           DISPLAY 'NO. OF RECORDS READ FROM DAILY TRANS (BP13FD04) = '         
                   WS-CNT-FD04-READ.                                            
           DISPLAY 'NO. OF RECORDS WRITTEN TO            (P13LC44A) = '         
                   WS-CNT-LC44A-WRITE.                                          
           DISPLAY 'NO. OF RECORDS WRITTEN TO            (P13LC44B) = '         
                   WS-CNT-LC44B-WRITE.                                          
           DISPLAY 'NO. OF RECORDS WRITTEN TO            (P13LC44C) = '         
                   WS-CNT-LC44C-WRITE.                                          
           DISPLAY 'NO. OF RECORDS WRITTEN TO            (P13LC44D) = '         
                   WS-CNT-LC44D-WRITE.                                          
                                                                                
           IF WS-K800-STATUS NOT = 00                                           
              MOVE 'CLOSING BP13K800 FILE ERROR' TO WS-VAR-PROC-TYP             
              MOVE WS-K800-STATUS                TO WS-VAR-FILE-STATUS          
              MOVE WS-K800-STATUS                TO RETURN-CODE                 
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00                                           
              MOVE 'CLOSING BP13K820 FILE ERROR' TO WS-VAR-PROC-TYP             
              MOVE WS-K820-STATUS                TO WS-VAR-FILE-STATUS          
              MOVE WS-K820-STATUS                TO RETURN-CODE                 
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00                                           
              MOVE 'CLOSING BP13K010 FILE ERROR' TO WS-VAR-PROC-TYP             
              MOVE WS-K010-STATUS                TO WS-VAR-FILE-STATUS          
              MOVE WS-K010-STATUS                TO RETURN-CODE                 
           END-IF.                                                              
                                                                                
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
