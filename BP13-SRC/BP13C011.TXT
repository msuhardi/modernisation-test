       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID. BP13C011.                                                    
       AUTHOR.     SURESH.                                                      
       DATE-WRITTEN. 08-08-2002.                                                
       DATE-COMPILED.                                                           
      *-----------------------------------------------------------*             
      *        SYSTEM OF COMMITMENT - BP13                        *             
      *-----------------------------------------------------------*             
      * OBJECTIVES : TO MATCH 'MA' CASES IN BP13.K853.MCPS WITH   *             
      *              CASES IN K410. IF NOT FOUND, TO BE DELETED.  *             
      *                                                           *             
      *                                                           *             
      * INPUT  FILE   : BP13F853                                  *             
      *               : BP13F703                                  *             
      *               : BP13K410                                  *             
      * OUTPUT FILE   : BP13F41A                                  *             
      *                 BP13F41B                                  *             
      *                 BP13F41C                                  *             
      *                                                           *             
      * REQ NO.   DATE    BY  DESCRIPTION                         *             
      * -------   ----    --- -----------                         *             
      * BP132200 08082002 SN  NEW PROGRAM                         *             
      * BP132412 01102003 SK  PRINT HEADING FOR REPORT 'E'        *             
      *-----------------------------------------------------------*             
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F703   ASSIGN TO BP13F703.                                
                                                                                
           SELECT BP13F853   ASSIGN TO BP13F853.                                
                                                                                
           SELECT  BP13K410   ASSIGN       TO  BP13K410                         
                   ACCESS MODE             IS  RANDOM                           
                   ORGANIZATION            IS  INDEXED                          
                   RECORD KEY              IS  K410-KEY-FLD                     
                   FILE STATUS             IS  BP13K410-STATUS.                 
                                                                                
           SELECT  BP13K800   ASSIGN       TO  BP13K800                         
                   ACCESS MODE             IS  RANDOM                           
                   ORGANIZATION            IS  INDEXED                          
                   RECORD KEY              IS  K800-NUM-REGN                    
                   FILE STATUS             IS  BP13K800-STATUS.                 
                                                                                
           SELECT  P04K010    ASSIGN       TO  P04K010                          
                   ACCESS MODE             IS  DYNAMIC                          
                   ORGANIZATION            IS  INDEXED                          
                   RECORD KEY              IS  K010-PRIME-KEY                   
                   FILE STATUS             IS  P04K010-STATUS.                  
                                                                                
           SELECT BP13011A   ASSIGN TO BP13011A.                                
                                                                                
           SELECT BP13011B   ASSIGN TO BP13011B.                                
                                                                                
           SELECT BP13011C   ASSIGN TO BP13011C.                                
                                                                                
           SELECT BP13011D   ASSIGN TO BP13011D.                                
                                                                                
           SELECT P13L011A   ASSIGN TO P13L011A.                                
                                                                                
           SELECT P13L011B   ASSIGN TO P13L011B.                                
                                                                                
           SELECT P13L011C   ASSIGN TO P13L011C.                                
                                                                                
           SELECT P13L011D   ASSIGN TO P13L011D.                                
                                                                                
           SELECT P13L011E   ASSIGN TO P13L011E.                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD BP13F703                                                              
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13F703.                                                           
                                                                                
       FD BP13F853                                                              
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13F853.                                                           
                                                                                
       FD BP13K410                                                              
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K410.                                                           
                                                                                
       FD BP13K800                                                              
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   P04K010                                                             
            RECORD     CONTAINS 300 CHARACTERS.                                 
       COPY P04K010.                                                            
                                                                                
       FD BP13011A.                                                             
       01 BP13011A-REC     PIC X(300).                                          
                                                                                
       FD BP13011B.                                                             
       01 BP13011B-REC     PIC X(300).                                          
                                                                                
       FD BP13011C.                                                             
       01 BP13011C-REC     PIC X(300).                                          
                                                                                
       FD BP13011D.                                                             
       01 BP13011D-REC     PIC X(300).                                          
                                                                                
       FD  P13L011A                                                             
           BLOCK     CONTAINS 0   RECORDS                                       
           RECORD    CONTAINS 132 CHARACTERS                                    
           LABEL     RECORDS  ARE OMITTED                                       
           RECORDING MODE     IS  F.                                            
       01  PRINT-RECA             PIC X(132).                                   
                                                                                
       FD  P13L011B                                                             
           BLOCK     CONTAINS 0   RECORDS                                       
           RECORD    CONTAINS 132 CHARACTERS                                    
           LABEL     RECORDS  ARE OMITTED                                       
           RECORDING MODE     IS  F.                                            
       01  PRINT-RECB             PIC X(132).                                   
                                                                                
       FD  P13L011C                                                             
           BLOCK     CONTAINS 0   RECORDS                                       
           RECORD    CONTAINS 132 CHARACTERS                                    
           LABEL     RECORDS  ARE OMITTED                                       
           RECORDING MODE     IS  F.                                            
       01  PRINT-RECC             PIC X(132).                                   
                                                                                
       FD  P13L011D                                                             
           BLOCK     CONTAINS 0   RECORDS                                       
           RECORD    CONTAINS 132 CHARACTERS                                    
           LABEL     RECORDS  ARE OMITTED                                       
           RECORDING MODE     IS  F.                                            
       01  PRINT-RECD             PIC X(132).                                   
                                                                                
       FD  P13L011E                                                             
           BLOCK     CONTAINS 0   RECORDS                                       
           RECORD    CONTAINS 132 CHARACTERS                                    
           LABEL     RECORDS  ARE OMITTED                                       
           RECORDING MODE     IS  F.                                            
       01  PRINT-RECE             PIC X(132).                                   
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-CONTROL-COUNT.                                                    
           05  WS-F853-READ            PIC 9(8)        VALUE ZEROS.             
           05  WS-F703-READ            PIC 9(8)        VALUE ZEROS.             
           05  WS-K010-READ            PIC 9(4)        VALUE ZEROES.            
           05  WS-F011A-WRITE          PIC 9(4)        VALUE ZEROES.            
           05  WS-F011B-WRITE          PIC 9(4)        VALUE ZEROES.            
           05  WS-F011C-WRITE          PIC 9(4)        VALUE ZEROES.            
           05  WS-F011D-WRITE          PIC 9(4)        VALUE ZEROES.            
           05  WS-F011E-WRITE          PIC 9(4)        VALUE ZEROES.            
           05  WS-VALID-MA             PIC 9(4)        VALUE ZEROES.            
           05  WS-TOTAL-MA             PIC 9(4)        VALUE ZEROES.            
           05  WS-MATCH-REC            PIC 9(8)        VALUE ZEROS.             
           05  WS-F011-WRITE           PIC 9(04)       VALUE ZEROES.            
           05  WS-F853-READ1           PIC ZZZZ9(4)    VALUE ZEROS.             
           05  WS-F703-READ1           PIC ZZZZ9(4)    VALUE ZEROS.             
           05  WS-MATCH-REC1           PIC ZZZZ9(4)    VALUE ZEROS.             
                                                                                
       01 WS-F703-KEY.                                                          
           05  WS-F703-BALLOT          PIC X(6) VALUE SPACES.                   
           05  WS-F703-NT              PIC X(3) VALUE SPACES.                   
           05  WS-F703-FLAT            PIC X(2) VALUE SPACES.                   
                                                                                
       01 WS-F853-KEY.                                                          
           05  WS-F853-BALLOT          PIC X(6) VALUE SPACES.                   
           05  WS-F853-NT              PIC X(3) VALUE SPACES.                   
           05  WS-F853-FLAT            PIC X(2) VALUE SPACES.                   
                                                                                
       01  BP13K410-STATUS             PIC X(2)    VALUE SPACES.                
       01  BP13K800-STATUS             PIC X(2)    VALUE SPACES.                
       01  P04K010-STATUS              PIC X(02)   VALUE SPACES.                
       01  WS-SYS-DATE                 PIC 9(8)    VALUE ZEROES.                
       01  WS-PRT-DATE                 PIC X(10)   VALUE SPACES.                
       01  WS-EOF                      PIC X(01)   VALUE 'N'.                   
       01  WS-LINE-CNT1                PIC 99      VALUE 61.                    
       01  WS-LINE-CNT2                PIC 99      VALUE 61.                    
       01  WS-LINE-CNT3                PIC 99      VALUE 61.                    
       01  WS-LINE-CNT4                PIC 99      VALUE 61.                    
       01  WS-LINE-CNT5                PIC 99      VALUE 61.                    
       01  WS-PAGE-CNT1                PIC 9(5)    VALUE ZERO.                  
       01  WS-PAGE-CNT2                PIC 9(5)    VALUE ZERO.                  
       01  WS-PAGE-CNT3                PIC 9(5)    VALUE ZERO.                  
       01  WS-PAGE-CNT4                PIC 9(5)    VALUE ZERO.                  
       01  WS-PAGE-CNT5                PIC 9(5)    VALUE ZERO.                  
       01  WS-TYPE                     PIC X(1)    VALUE SPACES.                
                                                                                
       01  L011A-PR-HEAD-01.                                                    
           05  L011-ID             PIC X(8)      VALUE 'P13L011A'.              
           05  FILLER              PIC X(4)      VALUE SPACES.                  
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                    'S Y S T E M   O F   '.                     
           05  FILLER              PIC X(19)     VALUE                          
                                    'C O M M I T M E N T'.                      
           05  FILLER              PIC X(15)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  13S1-DATE           PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(4)      VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'PAGE : '.               
           05  13S1-PAGENO         PIC ZZZZ9 .                                  
                                                                                
       01  L011A-PR-HEAD-02.                                                    
           05  FILLER              PIC X(39)     VALUE SPACES .                 
           05  FILLER              PIC X(53)     VALUE                          
               ' LIST OF RECORDS FOUND IN K410                       '.         
           05  FILLER              PIC X(40)     VALUE SPACES.                  
                                                                                
       01  L011B-PR-HEAD-02.                                                    
           05  FILLER              PIC X(39)     VALUE SPACES .                 
           05  FILLER              PIC X(53)     VALUE                          
               ' LIST OF RECORDS NOT FOUND IN K410 & K800            '.         
           05  FILLER              PIC X(40)     VALUE SPACES.                  
                                                                                
       01  L011C-PR-HEAD-02.                                                    
           05  FILLER              PIC X(39)     VALUE SPACES .                 
           05  FILLER              PIC X(51)     VALUE                          
               ' LIST OF RECORDS NOT FOUND IN K410 BUT FND IN K800 '.           
           05  FILLER              PIC X(42)     VALUE                          
               'AND THE STATUS = C                        '.                    
                                                                                
       01  L011D-PR-HEAD-02.                                                    
           05  FILLER              PIC X(39)     VALUE SPACES .                 
           05  FILLER              PIC X(51)     VALUE                          
               ' LIST OF RECORDS NOT FOUND IN K410 BUT FND IN K800 '.           
           05  FILLER              PIC X(42)     VALUE                          
               'AND THE STATUS NOT = C                    '.                    
                                                                                
       01  L011E-PR-HEAD-02.                                                    
           05  FILLER              PIC X(39)     VALUE SPACES .                 
           05  FILLER              PIC X(51)     VALUE                          
               ' NOT FOUND IN DEBARMENT. NO ACTION WILL BE TAKEN'.              
                                                                                
       01  L011A-PR-HEAD-03.                                                    
           05  FILLER              PIC X(24)                                    
                  VALUE '   S/NO     REGN NO     '.                             
           05  FILLER              PIC X(38)                                    
                  VALUE 'NRIC NO           DEBARMENT-KEY(44)   '.               
           05  FILLER              PIC X(39) VALUE SPACES.                      
           05  FILLER              PIC X(31)     VALUE SPACES.                  
                                                                                
       01  L011A-PR-DETAILS.                                                    
           05  L011A-SNO           PIC ZZZZZ9 .                                 
           05  FILLER              PIC X(06)     VALUE SPACES .                 
           05  L011A-REG-NO        PIC X(08).                                   
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L011A-NRIC          PIC X(9).                                    
           05  FILLER              PIC X(4)      VALUE SPACES .                 
           05  L011A-K010-KEY      PIC X(44)     VALUE SPACES.                  
           05  FILLER              PIC X(49)     VALUE SPACES .                 
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------*                 
       0000-MAIN.                                                               
      *-------------------------------------------------------*                 
            PERFORM 0500-OPEN-FILES       THRU 0500-EXIT.                       
            PERFORM 1000-READ-BP13F703    THRU 1000-EXIT.                       
            PERFORM 2000-READ-BP13F853    THRU 2000-EXIT.                       
            PERFORM 3000-PROCESS          THRU 3000-EXIT                        
                     UNTIL WS-F853-KEY = HIGH-VALUES.                           
            PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT.                       
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       0500-OPEN-FILES.                                                         
      *-------------------------------------------------------*                 
            OPEN INPUT  BP13F703                                                
                        BP13F853                                                
                        BP13K410                                                
                        BP13K800                                                
                        P04K010                                                 
                 OUTPUT BP13011A                                                
                        BP13011B                                                
                        BP13011C                                                
                        BP13011D                                                
                        P13L011A                                                
                        P13L011B                                                
                        P13L011C                                                
                        P13L011D                                                
                        P13L011E.                                               
            MOVE FUNCTION CURRENT-DATE(1:8)   TO WS-SYS-DATE.                   
                                                                                
            STRING WS-SYS-DATE (7:2), '/',                                      
                   WS-SYS-DATE (5:2), '/',                                      
                   WS-SYS-DATE (1:4)                                            
                   DELIMITED BY SIZE                                            
                   INTO                                                         
                   WS-PRT-DATE.                                                 
                                                                                
            MOVE WS-PRT-DATE                  TO 13S1-DATE.                     
                                                                                
       0500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       1000-READ-BP13F703.                                                      
      *-------------------------------------------------------*                 
            READ BP13F703 AT END                                                
                 MOVE HIGH-VALUES TO WS-F703-KEY                                
                 GO TO 1000-EXIT.                                               
             MOVE F703-DTE-BALLOT-NEW     TO WS-F703-BALLOT                     
             MOVE F703-NUM-NT             TO WS-F703-NT                         
             MOVE F703-NUM-FLAT           TO WS-F703-FLAT                       
             ADD 1                        TO WS-F703-READ.                      
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       2000-READ-BP13F853.                                                      
      *-------------------------------------------------------*                 
            READ BP13F853 AT END                                                
                 MOVE HIGH-VALUES TO WS-F853-KEY                                
                 GO TO 2000-EXIT.                                               
            MOVE F853-DTE-BALLOT      TO WS-F853-BALLOT                         
            MOVE F853-NUM-NEW-TOWN    TO WS-F853-NT                             
            MOVE F853-NUM-FLAT-TYPE   TO WS-F853-FLAT                           
            ADD 1                 TO WS-F853-READ.                              
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       2500-READ-BP13K410.                                                      
      *-------------------------------------------------------*                 
            READ BP13K410 KEY IS K410-KEY-FLD                                   
              IF BP13K410-STATUS = 00                                           
                 MOVE 'N'             TO WS-EOF                                 
                 MOVE ZEROES          TO WS-VALID-MA                            
                 MOVE F853-NUM-NRIC   TO K010-NUM-UINFIN                        
                 START P04K010 KEY >= K010-NUM-UINFIN                           
                 IF P04K010-STATUS = 00                                         
                    PERFORM 2700-READNEXT-K010 THRU 2700-EXIT UNTIL             
                       K010-NUM-UINFIN NOT = F853-NUM-NRIC                      
                         OR WS-EOF = 'Y'                                        
                   IF WS-VALID-MA = ZEROES                                      
                     DISPLAY 'NO MA CASES IN DEBAR(1): ' F853-NUM-REGN          
                     ADD 1                TO WS-TOTAL-MA                        
                     PERFORM 3400-PRINT-E THRU 3400-EXIT                        
                   END-IF                                                       
                 ELSE                                                           
                     IF P04K010-STATUS = 23                                     
                        DISPLAY 'REC. NOT FOUND ' F853-NUM-NRIC                 
                     ELSE                                                       
                        DISPLAY 'READ ERROR IN P04K010 ' P04K010-STATUS         
                     END-IF                                                     
                 END-IF                                                         
              ELSE                                                              
      ****  RECS NOT FOUND IN K410 *****                                        
                 IF BP13K410-STATUS = 23                                        
                    MOVE F853-NUM-REGN         TO K800-NUM-REGN                 
                    READ BP13K800 KEY IS K800-NUM-REGN                          
                                                                                
                    IF BP13K800-STATUS = 23                                     
                       PERFORM 3100-NOT-FOUND-K800  THRU 3100-EXIT              
                    END-IF                                                      
                                                                                
                    IF BP13K800-STATUS = 00 AND K800-NUM-STATUS = 'C'           
                       PERFORM 3200-FOUND-K800-CANCEL THRU 3200-EXIT            
                    END-IF                                                      
                                                                                
                    IF BP13K800-STATUS = 00 AND                                 
                       K800-NUM-STATUS NOT = 'C'                                
                       PERFORM 3300-FOUND-K800 THRU 3300-EXIT                   
                    END-IF                                                      
                 ELSE                                                           
                    DISPLAY 'READ ERROR, BP13K410-STATUS = '                    
                                                     BP13K410-STATUS            
                    MOVE BP13K410-STATUS TO RETURN-CODE                         
                    GO TO 9000-CLOSE-FILES                                      
                 END-IF                                                         
              END-IF.                                                           
                                                                                
       2500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       2700-READNEXT-K010.                                                      
      *-------------------------------------------------------*                 
             READ P04K010 NEXT AT END                                           
                  MOVE 'Y'         TO WS-EOF                                    
                  GO TO 2700-EXIT.                                              
                                                                                
             IF P04K010-STATUS = 00                                             
                IF K010-NUM-UINFIN = F853-NUM-NRIC AND                          
                   K010-REASON-CODE = 'MA'                                      
                   ADD 1                    TO WS-VALID-MA                      
                   MOVE    SPACES           TO BP13011A-REC                     
                   WRITE   BP13011A-REC FROM P04K010-REC                        
                   ADD 1                    TO WS-F011A-WRITE                   
                   IF WS-LINE-CNT1 >  60                                        
                      MOVE 1 TO WS-LINE-CNT1                                    
                      MOVE 'A'             TO WS-TYPE                           
                      PERFORM 5000-PRINT-HEADING THRU 5000-EXIT                 
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011A-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECA FROM L011A-PR-DETAILS                    
                   ELSE                                                         
                      ADD 1 TO WS-LINE-CNT1                                     
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011A-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECA FROM L011A-PR-DETAILS                    
                   END-IF                                                       
                END-IF                                                          
             ELSE                                                               
                IF P04K010-STATUS = 23                                          
                   DISPLAY 'REC. NOT FOUND ' K010-PRIME-KEY                     
                ELSE                                                            
                   DISPLAY 'READ ERROR IN P04K010 ' P04K010-STATUS              
                END-IF                                                          
             END-IF.                                                            
                                                                                
       2700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------*                 
       2800-READNEXT-K010.                                                      
      *-------------------------------------------------------*                 
             READ P04K010 NEXT AT END                                           
                  MOVE 'Y'         TO WS-EOF                                    
                  GO TO 2800-EXIT.                                              
                                                                                
             IF P04K010-STATUS = 00                                             
                IF K010-NUM-UINFIN = F853-NUM-NRIC AND                          
                   K010-REASON-CODE = 'MA'                                      
                   ADD 1                    TO WS-VALID-MA                      
                   MOVE    SPACES           TO BP13011B-REC                     
                   WRITE   BP13011B-REC FROM P04K010-REC                        
                   ADD 1                    TO WS-F011B-WRITE                   
                   IF WS-LINE-CNT2 >  60                                        
                      MOVE 1 TO WS-LINE-CNT2                                    
                      MOVE 'B'             TO WS-TYPE                           
                      PERFORM 5000-PRINT-HEADING THRU 5000-EXIT                 
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011B-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECB FROM L011A-PR-DETAILS                    
                   ELSE                                                         
                      ADD 1 TO WS-LINE-CNT2                                     
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011B-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECB FROM L011A-PR-DETAILS                    
                   END-IF                                                       
                END-IF                                                          
             ELSE                                                               
                IF P04K010-STATUS = 23                                          
                   DISPLAY 'REC. NOT FOUND ' K010-PRIME-KEY                     
                ELSE                                                            
                   DISPLAY 'READ ERROR IN P04K010 ' P04K010-STATUS              
                END-IF                                                          
             END-IF.                                                            
                                                                                
       2800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------*                 
       2900-READNEXT-K010.                                                      
      *-------------------------------------------------------*                 
             READ P04K010 NEXT AT END                                           
                  MOVE 'Y'         TO WS-EOF                                    
                  GO TO 2900-EXIT.                                              
                                                                                
             IF P04K010-STATUS = 00                                             
                IF K010-NUM-UINFIN = F853-NUM-NRIC  AND                         
                   K010-REASON-CODE = 'MA'                                      
                   ADD 1                    TO WS-VALID-MA                      
                   MOVE    SPACES           TO BP13011C-REC                     
                   WRITE   BP13011C-REC FROM P04K010-REC                        
                   ADD 1                    TO WS-F011C-WRITE                   
                   IF WS-LINE-CNT3 >  60                                        
                      MOVE 1 TO WS-LINE-CNT3                                    
                      MOVE 'C'             TO WS-TYPE                           
                      PERFORM 5000-PRINT-HEADING THRU 5000-EXIT                 
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011C-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECC FROM L011A-PR-DETAILS                    
                   ELSE                                                         
                      ADD 1 TO WS-LINE-CNT3                                     
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011C-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECC FROM L011A-PR-DETAILS                    
                   END-IF                                                       
                END-IF                                                          
             ELSE                                                               
                IF P04K010-STATUS = 23                                          
                   DISPLAY 'REC. NOT FOUND ' K010-PRIME-KEY                     
                ELSE                                                            
                   DISPLAY 'READ ERROR IN P04K010 ' P04K010-STATUS              
                END-IF                                                          
             END-IF.                                                            
                                                                                
       2900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------*                 
       2950-READNEXT-K010.                                                      
      *-------------------------------------------------------*                 
             READ P04K010 NEXT AT END                                           
                  MOVE 'Y'         TO WS-EOF                                    
                  GO TO 2950-EXIT.                                              
                                                                                
             IF P04K010-STATUS = 00                                             
                IF K010-NUM-UINFIN = F853-NUM-NRIC  AND                         
                   K010-REASON-CODE = 'MA'                                      
                   ADD 1                    TO WS-VALID-MA                      
                   MOVE    SPACES           TO BP13011D-REC                     
                   WRITE   BP13011D-REC FROM P04K010-REC                        
                   ADD 1                    TO WS-F011D-WRITE                   
                   IF WS-LINE-CNT4 >  60                                        
                      MOVE 1 TO WS-LINE-CNT4                                    
                      MOVE 'D'             TO WS-TYPE                           
                      PERFORM 5000-PRINT-HEADING THRU 5000-EXIT                 
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011D-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECD FROM L011A-PR-DETAILS                    
                   ELSE                                                         
                      ADD 1 TO WS-LINE-CNT4                                     
                      MOVE SPACES          TO L011A-PR-DETAILS                  
                      MOVE WS-F011D-WRITE  TO L011A-SNO                         
                      MOVE F853-NUM-REGN   TO L011A-REG-NO                      
                      MOVE F853-NUM-NRIC   TO L011A-NRIC                        
                      MOVE K010-PRIME-KEY  TO L011A-K010-KEY                    
                      WRITE PRINT-RECD FROM L011A-PR-DETAILS                    
                   END-IF                                                       
                END-IF                                                          
             ELSE                                                               
                IF P04K010-STATUS = 23                                          
                   DISPLAY 'REC. NOT FOUND ' K010-PRIME-KEY                     
                ELSE                                                            
                   DISPLAY 'READ ERROR IN P04K010 ' P04K010-STATUS              
                END-IF                                                          
             END-IF.                                                            
                                                                                
       2950-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------*                 
       3000-PROCESS.                                                            
      *-------------------------------------------------------*                 
                                                                                
            IF WS-F703-BALLOT = WS-F853-BALLOT                                  
               PERFORM 4000-PROCESS              THRU 4000-EXIT                 
               PERFORM 2000-READ-BP13F853        THRU 2000-EXIT                 
               ADD  1                            TO WS-MATCH-REC                
            ELSE                                                                
               IF WS-F703-KEY > WS-F853-KEY                                     
                  PERFORM 2000-READ-BP13F853     THRU 2000-EXIT                 
               ELSE                                                             
                  IF WS-F703-KEY < WS-F853-KEY                                  
                     MOVE HIGH-VALUES TO WS-F853-KEY                            
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
       3000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       3100-NOT-FOUND-K800.                                                     
      *-------------------------------------------------------*                 
                                                                                
            MOVE 'N'             TO WS-EOF.                                     
            MOVE ZEROES          TO WS-VALID-MA.                                
            MOVE F853-NUM-NRIC   TO K010-NUM-UINFIN.                            
            START P04K010 KEY >= K010-NUM-UINFIN.                               
                                                                                
            IF P04K010-STATUS = 00                                              
               PERFORM 2800-READNEXT-K010 THRU 2800-EXIT UNTIL                  
               K010-NUM-UINFIN NOT = F853-NUM-NRIC                              
               OR WS-EOF = 'Y'                                                  
               IF WS-VALID-MA = ZEROES                                          
                  DISPLAY 'NO MA CASES IN DEBAR(2): ' F853-NUM-REGN             
                  ADD 1                TO WS-TOTAL-MA                           
                  PERFORM 3400-PRINT-E THRU 3400-EXIT                           
               END-IF                                                           
            ELSE                                                                
               IF P04K010-STATUS = 23                                           
                  DISPLAY 'REC. NOT FOUND ' F853-NUM-NRIC                       
               ELSE                                                             
                  DISPLAY 'READ ERROR IN P04K010 (3100)' P04K010-STATUS         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       3200-FOUND-K800-CANCEL.                                                  
      *-------------------------------------------------------*                 
                                                                                
            MOVE 'N'             TO WS-EOF.                                     
            MOVE ZEROES          TO WS-VALID-MA.                                
            MOVE F853-NUM-NRIC   TO K010-NUM-UINFIN.                            
            START P04K010 KEY >= K010-NUM-UINFIN.                               
                                                                                
            IF P04K010-STATUS = 00                                              
               PERFORM 2900-READNEXT-K010 THRU 2900-EXIT UNTIL                  
               K010-NUM-UINFIN NOT = F853-NUM-NRIC                              
               OR WS-EOF = 'Y'                                                  
               IF WS-VALID-MA = ZEROES                                          
                  DISPLAY 'NO MA CASES IN DEBAR(3): ' F853-NUM-REGN             
                  ADD 1                TO WS-TOTAL-MA                           
                  PERFORM 3400-PRINT-E THRU 3400-EXIT                           
               END-IF                                                           
            ELSE                                                                
               IF P04K010-STATUS = 23                                           
                  DISPLAY 'REC. NOT FOUND ' F853-NUM-NRIC                       
               ELSE                                                             
                  DISPLAY 'READ ERROR IN P04K010 (3200)' P04K010-STATUS         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       3300-FOUND-K800.                                                         
      *-------------------------------------------------------*                 
                                                                                
            MOVE 'N'             TO WS-EOF.                                     
            MOVE ZEROES          TO WS-VALID-MA.                                
            MOVE F853-NUM-NRIC   TO K010-NUM-UINFIN.                            
            START P04K010 KEY >= K010-NUM-UINFIN.                               
                                                                                
            IF P04K010-STATUS = 00                                              
               PERFORM 2950-READNEXT-K010 THRU 2950-EXIT UNTIL                  
               K010-NUM-UINFIN NOT = F853-NUM-NRIC                              
               OR WS-EOF = 'Y'                                                  
               IF WS-VALID-MA = ZEROES                                          
                  DISPLAY 'NO MA CASES IN DEBAR(4): ' F853-NUM-REGN             
                  ADD 1                TO WS-TOTAL-MA                           
                  PERFORM 3400-PRINT-E THRU 3400-EXIT                           
               END-IF                                                           
            ELSE                                                                
               IF P04K010-STATUS = 23                                           
                  DISPLAY 'REC. NOT FOUND ' F853-NUM-NRIC                       
               ELSE                                                             
                  DISPLAY 'READ ERROR IN P04K010 (3300)' P04K010-STATUS         
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       3400-PRINT-E.                                                            
      *-------------------------------------------------------*                 
                                                                                
           ADD 1 TO WS-F011E-WRITE.                                             
                                                                                
           IF WS-LINE-CNT5 > 60                                                 
              MOVE 1 TO WS-LINE-CNT5                                            
              MOVE 'E'                   TO WS-TYPE                             
              PERFORM 5000-PRINT-HEADING THRU 5000-EXIT                         
              MOVE SPACES                TO L011A-PR-DETAILS                    
              MOVE WS-F011E-WRITE        TO L011A-SNO                           
              MOVE F853-NUM-REGN         TO L011A-REG-NO                        
              MOVE F853-NUM-NRIC         TO L011A-NRIC                          
              WRITE PRINT-RECE FROM L011A-PR-DETAILS                            
           ELSE                                                                 
              ADD 1 TO WS-LINE-CNT5                                             
              MOVE SPACES                TO L011A-PR-DETAILS                    
              MOVE WS-F011E-WRITE        TO L011A-SNO                           
              MOVE F853-NUM-REGN         TO L011A-REG-NO                        
              MOVE F853-NUM-NRIC         TO L011A-NRIC                          
              WRITE PRINT-RECE FROM L011A-PR-DETAILS                            
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       4000-PROCESS.                                                            
      *-------------------------------------------------------*                 
               MOVE F853-NUM-REGN         TO K410-KEY-FLD.                      
               PERFORM 2500-READ-BP13K410 THRU 2500-EXIT.                       
                                                                                
       4000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       5000-PRINT-HEADING.                                                      
      *-------------------------------------------------------*                 
            IF WS-TYPE = 'A'                                                    
               ADD 1               TO WS-PAGE-CNT1                              
               MOVE WS-PAGE-CNT1   TO 13S1-PAGENO                               
               MOVE 'P13M011A'     TO L011-ID                                   
               MOVE SPACES         TO PRINT-RECA                                
               WRITE PRINT-RECA FROM L011A-PR-HEAD-01 AFTER PAGE                
               WRITE PRINT-RECA FROM L011A-PR-HEAD-02 AFTER 2                   
               WRITE PRINT-RECA FROM L011A-PR-HEAD-03 AFTER 2                   
               ADD 6               TO WS-LINE-CNT1                              
            END-IF.                                                             
                                                                                
            IF WS-TYPE = 'B'                                                    
               ADD 1               TO WS-PAGE-CNT2                              
               MOVE WS-PAGE-CNT2   TO 13S1-PAGENO                               
               MOVE 'P13M011B'     TO L011-ID                                   
               MOVE SPACES         TO PRINT-RECB                                
               WRITE PRINT-RECB FROM L011A-PR-HEAD-01 AFTER PAGE                
               WRITE PRINT-RECB FROM L011B-PR-HEAD-02 AFTER 2                   
               WRITE PRINT-RECB FROM L011A-PR-HEAD-03 AFTER 2                   
               ADD 6               TO WS-LINE-CNT2                              
            END-IF.                                                             
                                                                                
            IF WS-TYPE = 'C'                                                    
               ADD 1               TO WS-PAGE-CNT3                              
               MOVE WS-PAGE-CNT3   TO 13S1-PAGENO                               
               MOVE 'P13M011C'     TO L011-ID                                   
               MOVE SPACES         TO PRINT-RECC                                
               WRITE PRINT-RECC FROM L011A-PR-HEAD-01 AFTER PAGE                
               WRITE PRINT-RECC FROM L011C-PR-HEAD-02 AFTER 2                   
               WRITE PRINT-RECC FROM L011A-PR-HEAD-03 AFTER 2                   
               ADD 6               TO WS-LINE-CNT3                              
            END-IF.                                                             
                                                                                
            IF WS-TYPE = 'D'                                                    
               ADD 1               TO WS-PAGE-CNT4                              
               MOVE WS-PAGE-CNT4   TO 13S1-PAGENO                               
               MOVE 'P13M011D'     TO L011-ID                                   
               MOVE SPACES         TO PRINT-RECD                                
               WRITE PRINT-RECD FROM L011A-PR-HEAD-01 AFTER PAGE                
               WRITE PRINT-RECD FROM L011D-PR-HEAD-02 AFTER 2                   
               WRITE PRINT-RECD FROM L011A-PR-HEAD-03 AFTER 2                   
               ADD 6               TO WS-LINE-CNT4                              
            END-IF.                                                             
                                                                                
            IF WS-TYPE = 'E'                                                    
               ADD 1               TO WS-PAGE-CNT5                              
               MOVE WS-PAGE-CNT5   TO 13S1-PAGENO                               
               MOVE 'P13M011E'     TO L011-ID                                   
               MOVE SPACES         TO PRINT-RECE                                
               WRITE PRINT-RECE FROM L011A-PR-HEAD-01 AFTER PAGE                
               WRITE PRINT-RECE FROM L011E-PR-HEAD-02 AFTER 2                   
               WRITE PRINT-RECE FROM L011A-PR-HEAD-03 AFTER 2                   
               ADD 6               TO WS-LINE-CNT5                              
            END-IF.                                                             
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------*                 
       9000-CLOSE-FILES.                                                        
      *-------------------------------------------------------*                 
            MOVE WS-F853-READ       TO  WS-F853-READ1                           
            MOVE WS-F703-READ       TO  WS-F703-READ1                           
            MOVE WS-MATCH-REC       TO  WS-MATCH-REC1                           
                                                                                
            DISPLAY '   '.                                                      
            DISPLAY 'SUMMARY REPORT   BP13C011   RUNDATE ' WS-PRT-DATE.         
            DISPLAY '______________________________________________'.           
            DISPLAY '   '.                                                      
            DISPLAY 'NO OF RECORDS READ FROM BP13F703   : '                     
                                            WS-F703-READ1                       
            DISPLAY 'NO OF RECORDS READ FROM BP13F853   : '                     
                                            WS-F853-READ1                       
            DISPLAY 'NO OF RECORDS MATCHED(F703 & F853) : '                     
                                            WS-MATCH-REC1                       
            DISPLAY 'NO OF RECORDS WRITTEN TO BP13011A  : '                     
            DISPLAY '                 (FND IN K410)       '                     
                                            WS-F011A-WRITE                      
            DISPLAY 'NO OF RECORDS WRITTEN TO BP13011B  : '                     
            DISPLAY '            (NOT FND IN K410 & K800) '                     
                                            WS-F011B-WRITE                      
            DISPLAY 'NO OF RECORDS WRITTEN TO BP13011C  : '                     
            DISPLAY '     (NOT FND IN K410 & STATUS = C ) '                     
                                            WS-F011C-WRITE                      
            DISPLAY 'NO OF RECORDS WRITTEN TO BP13011D  : '                     
            DISPLAY ' (NOT FND IN K410 & STATUS NOT = C ) '                     
                                            WS-F011D-WRITE                      
            DISPLAY 'NO OF RECORDS WRITTEN TO BP13011E  : '                     
            DISPLAY ' (NOT FND IN DEBAR. NO ACTION TAKEN  '                     
                                            WS-F011E-WRITE                      
            DISPLAY 'NO OF RECORDS NOT FOUND IN DEBAR   : '                     
            DISPLAY ' (NOT FND IN K010)                   '                     
                                            WS-TOTAL-MA                         
                                                                                
            CLOSE BP13F703                                                      
                  BP13F853                                                      
                  BP13K410                                                      
                  BP13K800                                                      
                  P04K010                                                       
                  BP13011A                                                      
                  BP13011B                                                      
                  BP13011C                                                      
                  BP13011D                                                      
                  P13L011A                                                      
                  P13L011B                                                      
                  P13L011C                                                      
                  P13L011D                                                      
                  P13L011E.                                                     
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
