      *------------------------*                                        00010013
       IDENTIFICATION DIVISION.                                         00020013
      *------------------------*                                        00030013
       PROGRAM-ID.    BP13C420.                                         00040013
       AUTHOR.        LKH.                                              00050013
       DATE-WRITTEN.  09/11/89.                                         00060013
                                                                        00070013
      * ====================================================== *        00080013
      *    SYSTEM NAME : SYSTEM OF COMMITMENT(TAKE POSSESSION) *        00090013
      *    SYSTEM ID : BP13                                    *        00100013
      * ====================================================== *        00110013
      *                                                        *        00120013
      *    OBJECTIVE  :                                        *        00130013
      *        1.  TO EXTRACT THE CD TO BE TRANSFERED TO       *        00140013
      *            MORTGAGE LOAN, DEBIT FROM RFF MASTER        *        00150013
      *            (BP13K800).                                 *        00160013
      *                                                        *        00170013
      *        2.  TO WRITE DEBIT RECORDS FROM FINAL SALES     *        00180013
      *            ORDER FILE (BP13F430) AND WRITE TO THE SOC  *        00190013
      *            HISTORY FILE (BP13F130).                    *        00200013
      *                                                        *        00210013
      *        3.  TO WRITE TRANSFER TO THE ACCUMULATED  MTL   *        00220013
      *            TRANSFER FILE (AB03F001).                   *        00230013
      *                                                        *        00240013
      *        4.  TO WRITE TRANSFER TO THE MTL PRINT FILE     *        00250013
      *            (BP13F450) FOR PRINTING PURPOSE.            *        00260013
      *                                                        *        00270013
      *     INPUT/OUTPUT FILES:                                *        00280013
      *           1. BP13F430 (FINAL SALES ORDER FILE)         *        00290013
      *           2. BP13K800 (APPLICANT MASTER)               *        00300013
      *           3. BP13F130 (SOC HISTORY MASTER)             *        00310013
      *           4. AB03F001 (ACCUMULATED MTL TRANSFER FILE)  *        00320013
      *           5. BP13F450 (MTL PRINT FILE)                 *        00330013
      *                                                        *        00340013
      * CHG-NO  BY   ON       DESCRIPTION                      *        00350013
      * ------  --   --       -----------                      *        00360013
      * C930317 LITO 930503 - TO CHANGE BP13F440 TO AB03F001   *        00370013
      *                       DUE TO SMS PHASE 3B.             *        00380013
      * I920718 LMS  930504 - TO CONVERT TO COBOL II.          *        00390013
      * SOC-PH8 RML  930730 - REFER TO BP13K800.               *        00400013
      * C950330 LJL  950419 - TO CATER FOR AA BK FEE TR.       *        00410013
      * BP130037LJL  951018 - TO CATER FOR AMALGAMATION OF     *        00420013
      *                     - SALES TYPE 1,2,2B,3,3A AND 10.   *        00430013
      * BP130037LJL  951018 - TO CATER FOR AMALGAMATION OF     *        00440013
      * BP130418CLT  980828 - TO CATER FOR Y2K.                *        00450013
      * BP130883CLT  031100 - MOVE BO CODE TO F450-CDE-BO.     *        00460013
      * BP132301CLT  131203 - EXPAND BP13F430 TO 1000 BYTES.   *        00470013
      * BP132341CLT  190503 - CATER FOR SERS CONTRA CD.        *        00480013
      * BP132717JF4  080705 - CATER FOR CD CASH REFUND         *        00490013
      * BP133783PCL3 091125 - ADD SY02F001 TO READ CURRENT DATE*        00500013
      * BP135259ESD1 140321 - CATER FOR TO PULL NUM-BO FROM PIDB*       00510013
      * BP136869 LSB 170619 - DROP F130-NME-NAME, CATER FOR SA *        00520013
      *                       2-ROOM FLEXI WITH TEMP LOAN      *        00530013
      * BP136869 KSJ3170725 - TO PASS F430-DTE-SALE-EFF TO     *        00540013
      *                       F440-DTE-TRANS.                  *        00550013
      * BP137429 PLC4180725 - TO CATER FOR BK-FEE-TR TO CD FOR *        00560013
      *                       DDS CASES.                       *        00570013
      *                       K800-NUM-HALF-IDP = 'D' OR 'F'   *        00580013
      * BP137438 DN8 181018 - TO CATER FOR SOC PAID FOR CF AND *        00590013
      *                       SF FOR DDS CASES.                *        00600013
      *                       K800-NUM-HALF-IDP = 'D' OR 'F'   *        00610013
      * BP137582 DN8 051218 - TO CATER FOR SOC PAID FOR        *        00611013
      *                       BK-FEE-TR FOR                    *        00612013
      *                       K800-NUM-HALF-IDP = 'D' OR 'F'   *        00613013
      * BP138126 ZDD 140421 - TO CATER FOR FSH TP SALES TYPE 19*        00614015
      *                       DYNAMIC CALL FOR BP13C913        *        00615015
      * ====================================================== *        00620013
                                                                        00630013
      *------------------------*                                        00640013
       ENVIRONMENT DIVISION.                                            00650013
      *------------------------*                                        00660013
       CONFIGURATION SECTION.                                           00670013
      *------------------------*                                        00680013
                                                                        00690013
       SOURCE-COMPUTER. IBM-3090.                                       00700013
       OBJECT-COMPUTER. IBM-3090.                                       00710013
                                                                        00720013
      *------------------------*                                        00730013
       INPUT-OUTPUT SECTION.                                            00740013
      *------------------------*                                        00750013
       FILE-CONTROL.                                                    00760013
                                                                        00770013
           SELECT BP13K800 ASSIGN TO BP13K800                           00780013
                ORGANIZATION IS INDEXED                                 00790013
                ACCESS MODE  IS DYNAMIC                                 00800013
                RECORD KEY   IS K800-NUM-REGN                           00810013
                FILE STATUS  IS K800-STATUS.                            00820013
                                                                        00830013
           SELECT BP13K130 ASSIGN TO BP13K130                           00840013
                ORGANIZATION IS INDEXED                                 00850013
                ACCESS MODE  IS DYNAMIC                                 00860013
                RECORD KEY   IS K130-KEY-FLD                            00870013
                FILE STATUS  IS K130-STATUS.                            00880013
                                                                        00890013
           SELECT BP13F130 ASSIGN TO BP13F130.                          00900013
           SELECT SY02F001 ASSIGN TO SY02F001.                          00910013
                                                                        00920013
           SELECT BP13F430 ASSIGN TO BP13F430.                          00930013
           SELECT BP13F440 ASSIGN TO BP13F440.                          00940013
           SELECT BP13F450 ASSIGN TO BP13F450.                          00950013
                                                                        00960013
                                                                        00970013
      *------------------------*                                        00980013
       DATA DIVISION.                                                   00990013
      *------------------------*                                        01000013
       FILE SECTION.                                                    01010013
      *------------------------*                                        01020013
                                                                        01030013
       COPY SY02F001.                                                   01040013
                                                                        01050013
       FD  BP13F430           BLOCK CONTAINS 0 RECORDS                  01060013
                              RECORD CONTAINS 1000 CHARACTERS           01070013
                              LABEL RECORDS ARE STANDARD                01080013
                              RECORDING MODE IS F.                      01090013
       COPY BP13F430.                                                   01100013
                                                                        01110013
       FD  BP13K800           RECORD CONTAINS 2000 CHARACTERS.          01120013
       COPY BP13K800.                                                   01130013
                                                                        01140013
       FD  BP13K130           RECORD CONTAINS 150 CHARACTERS.           01150013
       COPY BP13K130.                                                   01160013
                                                                        01170013
       FD  BP13F130           BLOCK CONTAINS 0 RECORDS                  01180013
                              RECORD CONTAINS 150 CHARACTERS            01190013
                              LABEL RECORDS ARE STANDARD                01200013
                              RECORDING MODE IS F.                      01210013
       COPY BP13F130.                                                   01220013
                                                                        01230013
       FD  BP13F440           BLOCK CONTAINS 0 RECORDS                  01240013
                              RECORD CONTAINS 100 CHARACTERS            01250013
                              LABEL RECORDS ARE STANDARD                01260013
                              RECORDING MODE IS F.                      01270013
       COPY BP13F440.                                                   01280013
                                                                        01290013
       FD  BP13F450           BLOCK CONTAINS 0 RECORDS                  01300013
                              RECORD CONTAINS 200 CHARACTERS            01310013
                              LABEL RECORDS ARE STANDARD                01320013
                              RECORDING MODE IS F.                      01330013
       COPY BP13F450.                                                   01340013
                                                                        01350013
                                                                        01360013
      *------------------------*                                        01370013
       WORKING-STORAGE SECTION.                                         01380013
      *------------------------*                                        01390013
                                                                        01400013
       01  WS-FILE-STATUS.                                              01410013
           05  K800-STATUS           PIC 9(2)    VALUE ZEROS.           01420013
           05  K130-STATUS           PIC 9(2)    VALUE ZEROS.           01430013
                                                                        01440013
       01  WS-COUNTERS.                                                 01450013
           05  WS-READ-CNT           PIC 9(5)    VALUE ZEROS.           01460013
           05  WS-WRITE-F130-CNT     PIC 9(5)    VALUE ZEROS.           01470013
           05  WS-WRITE-F440-CNT     PIC 9(5)    VALUE ZEROS.           01480013
           05  WS-WRITE-F450-CNT     PIC 9(5)    VALUE ZEROS.           01490013
           05  WS-DEBIT-CNT          PIC 9(5)    VALUE ZEROS.           01500013
                                                                        01510013
       01  WS-PROGRAM-SWITCHES.                                         01520013
           05  WS-EOF-F430           PIC X       VALUE SPACES.          01530013
           05  WS-K800-REC-FND       PIC X       VALUE SPACES.          01540013
           05  WS-K040-REC-FND       PIC X       VALUE SPACES.          01550013
           05  WS-CHECK-CD-AMT       PIC X       VALUE SPACES.          01560013
           05  WS-EOF-1              PIC X       VALUE 'N'.             01570013
           05  WS-F001-EOF           PIC X(1)    VALUE 'N'.             01580013
               88 EOF-F001                       VALUE 'Y'.             01590013
                                                                        01600013
       01  WS-DATE.                                                     01610013
           05  WS-CC                 PIC X(2).                          01620013
           05  WS-YY                 PIC X(2).                          01630013
           05  WS-MM                 PIC X(2).                          01640013
           05  WS-DD                 PIC X(2).                          01650013
                                                                        01660013
       01  WS-UPD-AMT-CD             PIC S9(7)V99 VALUE ZEROS.          01670013
       01  WS-AMT-SOC-PAID           PIC S9(7)V99 VALUE ZEROS.          01680013
       01  WS-UPD-AMT-SOC-CASH       PIC S9(7)V99 VALUE ZEROS.          01690013
                                                                        01700013
       01  WS-AMT-CD-DEBIT           PIC S9(7)V99 VALUE ZEROS.          01710013
       01  WS-EDIT-CD-DEBIT          PIC Z,ZZZ,ZZ9.99- VALUE ZEROS.     01720013
       01  WS-BP13C913               PIC X(08)    VALUE 'BP13C913'.     01721015
                                                                        01730013
       01  WS-NUM-RECEIPT-JRNO.                                         01740013
           05  WS-RECEIPT-CD         PIC X(2).                          01750013
           05  WS-RECEIPT-DATE.                                         01760013
               10  WS-RECEIPT-DD     PIC 9(2).                          01770013
               10  WS-RECEIPT-MM     PIC 9(2).                          01780013
               10  WS-SLASH          PIC X.                             01790013
               10  WS-RECEIPT-YY     PIC 9(2).                          01800013
           05  WS-NUM-DOC            PIC 9(5)   VALUE ZEROES.           01810013
                                                                        01820013
       01  SQL-CODE                    PIC 9(4).                        01830013
                                                                        01840013
      *----------------------------------------------------------------*01850013
      *        LINKAGE FOR SUB-PROGRAM BP13C913                        *01860013
      *----------------------------------------------------------------*01870013
       01  WS-LINK-REC.                                                 01880013
           05  WS-LINK-NUM-SCH-ACC.                                     01890013
               10  WS-LINK-NUM-SCH     PIC X(4).                        01900013
               10  WS-LINK-NUM-ACC     PIC X(5).                        01910013
                                                                        01920013
       COPY P13COMM8.                                                   01930013
                                                                        01940013
      *------------------------*                                        01950013
       PROCEDURE DIVISION.                                              01960013
      *------------------------*                                        01970013
                                                                        01980013
      *------------------------*                                        01990013
       001-MAIN.                                                        02000013
      *------------------------*                                        02010013
           PERFORM 010-START-PROCESS  THRU 010-EXIT.                    02020013
           PERFORM 020-READ-F430      THRU 020-EXIT.                    02030013
           PERFORM 030-PROCESS-UPDATE THRU 030-EXIT                     02040013
                   UNTIL WS-EOF-F430 = 'Y'.                             02050013
           PERFORM 040-END-PROCESS    THRU 040-EXIT.                    02060013
                                                                        02070013
       001-EXIT.                                                        02080013
           EXIT.                                                        02090013
                                                                        02100013
                                                                        02110013
      *------------------------*                                        02120013
       010-START-PROCESS.                                               02130013
      *------------------------*                                        02140013
           OPEN INPUT BP13F430                                          02150013
                      SY02F001                                          02160013
                I-O   BP13K800                                          02170013
                      BP13K130                                          02180013
               OUTPUT BP13F130                                          02190013
                      BP13F440                                          02200013
                      BP13F450.                                         02210013
                                                                        02220013
           IF K800-STATUS NOT = 0 AND 97                                02230013
              DISPLAY 'OPENING ERROR K800-STATUS IS ' K800-STATUS       02240013
              PERFORM 040-END-PROCESS THRU 040-EXIT.                    02250013
                                                                        02260013
           IF K130-STATUS NOT = 0 AND 97                                02270013
              DISPLAY 'OPENING ERROR K130-STATUS IS ' K130-STATUS       02280013
              PERFORM 040-END-PROCESS THRU 040-EXIT.                    02290013
                                                                        02300013
           READ SY02F001 AT END MOVE 'Y'  TO WS-F001-EOF.               02310013
                                                                        02320013
           IF EOF-F001                                                  02330013
              DISPLAY 'RECORD NOT FOUND IN SY01F001 '                   02340013
              DISPLAY 'PROCESSING TERMINATED '                          02350013
              PERFORM 040-END-PROCESS                 THRU 040-EXIT     02360013
           ELSE                                                         02370013
              MOVE F001-DTE-CURRENT                   TO WS-DATE        02380013
           END-IF.                                                      02390013
                                                                        02400013
           MOVE SPACES                TO WS-PROGRAM-SWITCHES.           02410013
           MOVE ZEROS                 TO WS-COUNTERS.                   02420013
           MOVE 'N'                   TO WS-EOF-F430.                   02430013
                                                                        02440013
       010-EXIT.                                                        02450013
           EXIT.                                                        02460013
                                                                        02470013
                                                                        02480013
      ******************************************************************02490013
      *             INITIAL READING OF BP13F430 FILE                   *02500013
      ******************************************************************02510013
      *------------------------*                                        02520013
       020-READ-F430.                                                   02530013
      *------------------------*                                        02540013
           READ BP13F430 AT END                                         02550013
                         MOVE 'Y' TO WS-EOF-F430                        02560013
                         GO TO 020-EXIT.                                02570013
                                                                        02580013
           ADD 1 TO WS-READ-CNT.                                        02590013
                                                                        02600013
       020-EXIT.                                                        02610013
           EXIT.                                                        02620013
                                                                        02630013
                                                                        02640013
      *------------------------*                                        02650013
       030-PROCESS-UPDATE.                                              02660013
      *------------------------*                                        02670013
           IF F430-CDE-SALES-TYP = '10' OR '1B' OR '3A' OR              02680013
                                   '1 ' OR '1A' OR '2 ' OR              02690013
                                   '3 ' OR '5B' OR '5C' OR              02700014
                                   '19'                                 02701014
              CONTINUE                                                  02710013
           ELSE                                                         02720013
              IF (F430-CDE-SALES-TYP = '13' OR '18') AND                02730013
                 (F430-AMT-LOAN-GRANTD NOT = ZEROS)                     02740013
                 CONTINUE                                               02750013
              ELSE                                                      02760013
                  PERFORM 020-READ-F430    THRU 020-EXIT                02770013
                  GO TO 030-EXIT                                        02780013
              END-IF                                                    02790013
           END-IF.                                                      02800013
                                                                        02810013
           PERFORM 100-READ-BP13K800 THRU 100-EXIT.                     02820013
                                                                        02830013
           IF WS-K800-REC-FND = 'Y'                                     02840013
              DISPLAY ' REGN FND' F430-NUM-REG                          02850013
              PERFORM 110-CHECK-CD-AMT THRU 110-EXIT                    02860013
           ELSE                                                         02870013
              DISPLAY ' REGN NOT-FND' F430-NUM-REG.                     02880013
                                                                        02890013
           PERFORM 020-READ-F430    THRU 020-EXIT.                      02900013
                                                                        02910013
       030-EXIT.                                                        02920013
           EXIT.                                                        02930013
                                                                        02940013
                                                                        02950013
      *------------------------*                                        02960013
       040-END-PROCESS.                                                 02970013
      *------------------------*                                        02980013
           CLOSE   BP13F430                                             02990013
                   SY02F001                                             03000013
                   BP13K800                                             03010013
                   BP13K130                                             03020013
                   BP13F130                                             03030013
                   BP13F440                                             03040013
                   BP13F450.                                            03050013
                                                                        03060013
           IF K800-STATUS NOT = 0 AND 97                                03070013
              DISPLAY 'CLOSING ERROR, K800-STATUS IS ' K800-STATUS.     03080013
           IF K130-STATUS NOT = 0 AND 97                                03090013
              DISPLAY 'CLOSING ERROR, K130-STATUS IS ' K130-STATUS.     03100013
                                                                        03110013
           DISPLAY ' ******** BP13C420 **********'.                     03120013
           DISPLAY 'NO OF RECORDS READ FROM BP13F430 = ' WS-READ-CNT.   03130013
           DISPLAY 'NO OF RECORDS WRITE TO  BP13F440 = '                03140013
                   WS-WRITE-F440-CNT.                                   03150013
           DISPLAY 'NO OF RECORDS WRITE TO  BP13F450 = '                03160013
                   WS-WRITE-F450-CNT.                                   03170013
           DISPLAY 'NO OF DEBIT CASES = ' WS-DEBIT-CNT.                 03180013
           MOVE     WS-AMT-CD-DEBIT TO WS-EDIT-CD-DEBIT.                03190013
           DISPLAY 'WS-AMT-CD-DEBIT = ' WS-EDIT-CD-DEBIT.               03200013
                                                                        03210013
           STOP RUN.                                                    03220013
                                                                        03230013
       040-EXIT.                                                        03240013
           EXIT.                                                        03250013
                                                                        03260013
                                                                        03270013
      ******************************************************************03280013
      *    USE THE REG  NUMBER IN BP13F430 FILE TO ACCESS THE RECORDS  *03290013
      *    IN BP13K800 FILE.                                           *03300013
      ******************************************************************03310013
      *------------------------*                                        03320013
       100-READ-BP13K800.                                               03330013
      *------------------------*                                        03340013
           MOVE 'Y'           TO WS-K800-REC-FND.                       03350013
           MOVE F430-NUM-REG  TO K800-NUM-REGN.                         03360013
                                                                        03370013
           READ BP13K800.                                               03380013
                                                                        03390013
           IF K800-STATUS = ZEROES                                      03400013
              NEXT SENTENCE                                             03410013
           ELSE                                                         03420013
              IF K800-STATUS = 23                                       03430013
                 DISPLAY 'REC NOT FOUND IN BP13K800 '                   03440013
                      F430-NUM-REG                                      03450013
                 MOVE 'N' TO WS-K800-REC-FND                            03460013
              ELSE                                                      03470013
                 DISPLAY 'ERROR READING BP13K800, STATUS : '            03480013
                      K800-STATUS                                       03490013
                 PERFORM 040-END-PROCESS    THRU 040-EXIT.              03500013
                                                                        03510013
       100-EXIT.                                                        03520013
           EXIT.                                                        03530013
                                                                        03540013
                                                                        03550013
      ******************************************************************03560013
      *    TO CHECK WHETHER THE K800-AMT-CD IS EQUAL TO ZEROS          *03570013
      ******************************************************************03580013
      *------------------------*                                        03590013
       110-CHECK-CD-AMT.                                                03600013
      *------------------------*                                        03610013
           IF K800-AMT-CD NOT NUMERIC                                   03620013
              MOVE ZEROES    TO K800-AMT-CD.                            03630013
                                                                        03640013
           IF K800-AMT-CD-REFUND NOT NUMERIC                            03650013
              MOVE ZEROES    TO K800-AMT-CD-REFUND.                     03660013
                                                                        03670013
           COMPUTE WS-UPD-AMT-CD = K800-AMT-CD -                        03680013
                                   K800-AMT-CD-REFUND.                  03690013
                                                                        03700013
           IF K800-NUM-HALF-IDP = 'D' OR 'F'                            03710013
              COMPUTE WS-UPD-AMT-CD = F430-AMT-TOT-CD-IDP               03720013
           ELSE                                                         03730013
           IF WS-UPD-AMT-CD = F430-AMT-TOT-CD-IDP                       03740013
              NEXT SENTENCE                                             03750013
           ELSE                                                         03760013
              DISPLAY 'F430-NUM-REG = ' F430-NUM-REG                    03770013
              DISPLAY 'ERROR CD AMOUNT NOT EQUAL'                       03780013
              DISPLAY 'TOTAL-AMT-CD-REQ   = ' WS-UPD-AMT-CD             03790013
              DISPLAY 'SO-CD-TRF-TO-IDP   = ' F430-AMT-TOT-CD-IDP       03800013
              GO TO 110-EXIT.                                           03810013
                                                                        03820013
           IF K800-AMT-SOC-SERCNTR-PAID IS NOT NUMERIC                  03830013
              MOVE ZEROS TO  K800-AMT-SOC-SERCNTR-PAID.                 03840013
                                                                        03850013
           IF K800-AMT-SOC-CASH  NOT NUMERIC                            03860013
              MOVE ZEROES    TO K800-AMT-SOC-CASH.                      03870013
                                                                        03880013
           COMPUTE WS-UPD-AMT-SOC-CASH = K800-AMT-SOC-CASH -            03890013
                                         K800-AMT-CD-REFUND.            03900013
                                                                        03910013
           COMPUTE WS-AMT-SOC-PAID = WS-UPD-AMT-SOC-CASH +              03920013
                                     K800-AMT-SOC-SERCNTR-PAID +        03930013
                                     K800-AMT-CPF1-PAID +               03940013
                                     K800-AMT-CPF2-PAID +               03950013
                                     K800-AMT-CPF3-PAID +               03960013
                                     K800-AMT-CPF4-PAID.                03970013
                                                                        03980013
           IF K800-NUM-HALF-IDP = 'D' OR 'F'                            03990013
              ADD 1 TO WS-NUM-DOC                                       04000013
           ELSE                                                         04010013
           IF WS-UPD-AMT-CD   = ZEROES AND                              04020013
              WS-AMT-SOC-PAID = ZEROES                                  04030013
              GO TO 110-EXIT                                            04040013
           ELSE                                                         04050013
              ADD 1 TO WS-NUM-DOC.                                      04060013
                                                                        04070013
           PERFORM 200-PROCESS-CD-AMT THRU 200-EXIT.                    04080013
                                                                        04090013
           IF K800-NUM-HALF-IDP = 'D' OR 'F'                            04100013
      *       COMPUTE WS-AMT-SOC-PAID =  F430-AMT-TOT-CD-IDP +          04110013
      *                                  WS-AMT-SOC-PAID                04120013
              DISPLAY 'WS-AMT-SOC-PAID ' WS-AMT-SOC-PAID                04121013
           END-IF.                                                      04130013
                                                                        04140013
           IF WS-AMT-SOC-PAID = ZEROES                                  04150013
              NEXT SENTENCE                                             04160013
           ELSE                                                         04170013
              PERFORM 300-PROCESS-SOC-PAID THRU 300-EXIT.               04180013
                                                                        04190013
       110-EXIT.                                                        04200013
           EXIT.                                                        04210013
                                                                        04220013
                                                                        04230013
      *------------------------*                                        04240013
       200-PROCESS-CD-AMT.                                              04250013
      *------------------------*                                        04260013
           IF WS-UPD-AMT-CD = ZEROES                                    04270013
              NEXT SENTENCE                                             04280013
           ELSE                                                         04290013
              PERFORM 210-UPDATE-BP13F130 THRU 210-EXIT                 04300013
              PERFORM 220-WRITE-BP13F440  THRU 220-EXIT                 04310013
              PERFORM 230-WRITE-BP13F450  THRU 230-EXIT.                04320013
                                                                        04330013
           PERFORM 240-REWRITE-BP13K800 THRU 240-EXIT.                  04340013
                                                                        04350013
       200-EXIT.                                                        04360013
           EXIT.                                                        04370013
                                                                        04380013
                                                                        04390013
      *------------------------*                                        04400013
       210-UPDATE-BP13F130.                                             04410013
      *------------------------*                                        04420013
           MOVE SPACES                TO BP13F130-REC.                  04430013
           MOVE '17'                  TO F130-TRANS-TYPE.               04440013
           MOVE K800-NUM-REGN         TO F130-NUM-REGN.                 04450013
           MOVE K800-NUM-NRIC1        TO F130-NUM-NRIC.                 04460013
           MOVE WS-DATE               TO F130-DTE-POST.                 04470013
           MOVE ZEROS                 TO F130-COUNT-HISTORY.            04480013
           MOVE SPACES                TO F130-NUM-CPF-APPL.             04490013
           MOVE 'CD '                 TO F130-CDE-PAYMENT-TYPE.         04500013
           MOVE WS-DD                 TO WS-RECEIPT-DD.                 04510013
           MOVE WS-MM                 TO WS-RECEIPT-MM.                 04520013
           MOVE WS-YY                 TO WS-RECEIPT-YY.                 04530013
           MOVE 'JR'                  TO WS-RECEIPT-CD.                 04540013
           MOVE '/'                   TO WS-SLASH.                      04550013
           MOVE WS-NUM-RECEIPT-JRNO   TO F130-NUM-RECPT-JRNO.           04560013
           COMPUTE F130-AMT-RECEIPT = 0 - WS-UPD-AMT-CD.                04570013
           MOVE 'D'                   TO F130-CDE-AMT-TYPE.             04580013
           MOVE WS-DATE               TO F130-DTE-TRANS.                04590013
           MOVE F430-NUM-HDB-REF      TO F130-NUM-SCH-ACCT.             04600013
                                                                        04610013
           PERFORM 250-WRITE-BP13K130    THRU  250-EXIT.                04620013
                                                                        04630013
           WRITE BP13F130-REC.                                          04640013
           ADD  1                        TO WS-WRITE-F130-CNT.          04650013
                                                                        04660013
       210-EXIT.                                                        04670013
           EXIT.                                                        04680013
                                                                        04690013
                                                                        04700013
      *------------------------*                                        04710013
       220-WRITE-BP13F440.                                              04720013
      *------------------------*                                        04730013
           MOVE SPACES                   TO BP13F440-REC.               04740013
           INITIALIZE BP13F440-REC.                                     04750013
           MOVE WS-DD                    TO F440-DTE-TRANS-DD           04760013
                                            F440-DTE-JR-DD-NW.          04770013
           MOVE WS-MM                    TO F440-DTE-TRANS-MM           04780013
                                            F440-DTE-JR-MM-NW.          04790013
           MOVE WS-YY                    TO F440-DTE-TRANS-YY           04800013
                                            F440-DTE-JR-YY-NW.          04810013
           MOVE WS-CC                    TO F440-DTE-TRANS-CC.          04820013
           MOVE F430-DTE-SALE-EFF        TO F440-DTE-TRANS              04830013
           MOVE F430-AMT-TOT-CD-IDP      TO F440-AMT-INST-LOAN          04840013
                                            F440-AMT-TOTL.              04850013
           MOVE 'CD'                     TO F440-TXT-DESC.              04860013
           MOVE 'C'                      TO F440-CDE-CR-DR.             04870013
           MOVE 'JR'                     TO F440-CDE-JR-TYP-NW.         04880013
           MOVE 'SO'                     TO F440-CDE-TRANS-POSTNG.      04890013
           MOVE F430-NUM-HDB-REF         TO F440-NUM-HDB-REF.           04900013
                                                                        04910013
           WRITE BP13F440-REC.                                          04920013
           ADD 1 TO WS-WRITE-F440-CNT.                                  04930013
                                                                        04940013
       220-EXIT.                                                        04950013
           EXIT.                                                        04960013
                                                                        04970013
                                                                        04980013
      *------------------------*                                        04990013
       230-WRITE-BP13F450.                                              05000013
      *------------------------*                                        05010013
           MOVE SPACES                    TO  BP13F450-REC.             05020013
           MOVE K800-NUM-NEW-TOWN         TO  F450-CDE-NT.              05030013
                                                                        05040013
      *    IF K800-NUM-BO NOT = SPACES                                  05050013
      *       MOVE K800-NUM-BO            TO  F450-CDE-BO               05060013
      *    ELSE                                                         05070013
           MOVE  SPACES                TO  BP13COMM8-REC                05080013
           INITIALIZE                      BP13COMM8-REC                05090013
                                                                        05100013
           MOVE  K800-NUM-SCH-ACC(1:9) TO  WS-LINK-REC                  05110013
                                                                        05120013
           CALL WS-BP13C913    USING  WS-LINK-REC,                      05130015
                                      BP13COMM8-REC                     05140013
                                                                        05150013
           IF COMM8-CDE-SYSERR NOT = 0                                  05160013
              MOVE COMM8-CDE-SYSERR TO SQL-CODE                         05170013
              MOVE SPACES           TO F450-CDE-BO                      05180013
              IF COMM8-CDE-SYSERR = 100                                 05190013
                 DISPLAY 'SCHEME-ACCT-NO = ' WS-LINK-REC                05200013
                 DISPLAY 'SCH-ACC NOT FOUND INF PIDB TABLE ' SQL-CODE   05210013
              ELSE                                                      05220013
                 DISPLAY 'ERROR IN READING PIDB TABLE   ' SQL-CODE      05230013
              END-IF                                                    05240013
           ELSE                                                         05250013
              MOVE COMM8-NUM-MGMT   TO F450-CDE-BO                      05260013
           END-IF.                                                      05270013
      *    END-IF.                                                      05280013
                                                                        05290013
           MOVE SPACES                   TO F450-CDE-TC.                05300013
           MOVE SPACES                   TO F450-CDE-CC.                05310013
           MOVE K800-NUM-REGN            TO F450-NUM-REGN.              05320013
           MOVE F430-DTE-EXE-SALE-AGRMT  TO F450-DTE-SO-EXECUTION.      05330013
           MOVE F430-DTE-SALE-EFF        TO F450-DTE-SO-EFFECTIVE.      05340013
           MOVE K800-NUM-SCH-ACC         TO F450-NUM-SCH-ACC.           05350013
                                                                        05360013
           COMPUTE F450-AMT-LOAN = F430-AMT-LOAN-GRANTD.                05370013
           STRING 'JR' WS-DD WS-MM '/' WS-YY DELIMITED BY SIZE          05380013
                  INTO F450-CDE-JR-VR.                                  05390013
                                                                        05400013
           MOVE F430-NUM-CPF1            TO F450-CPF1.                  05410013
           MOVE F430-NME-LESSEE1         TO F450-NAME1.                 05420013
           MOVE F430-NME-LESSEE2         TO F450-NAME2.                 05430013
           MOVE F430-NUM-CPF2            TO F450-CPF2.                  05440013
           MOVE F430-NME-LESSEE3         TO F450-NAME3.                 05450013
           MOVE F430-NUM-CPF3            TO F450-CPF3.                  05460013
           MOVE F430-NME-LESSEE4         TO F450-NAME4.                 05470013
           MOVE F430-NUM-CPF4            TO F450-CPF4.                  05480013
                                                                        05490013
           WRITE BP13F450-REC.                                          05500013
           ADD 1 TO WS-WRITE-F450-CNT.                                  05510013
                                                                        05520013
       230-EXIT.                                                        05530013
           EXIT.                                                        05540013
                                                                        05550013
                                                                        05560013
      *------------------------*                                        05570013
       240-REWRITE-BP13K800.                                            05580013
      *------------------------*                                        05590013
           COMPUTE WS-AMT-CD-DEBIT = WS-AMT-CD-DEBIT +                  05600013
                                     WS-UPD-AMT-CD.                     05610013
           IF K800-NUM-CD-REFUND = 'Y'  AND K800-AMT-CD-REFUND > 0      05620013
              MOVE K800-AMT-CD-REFUND TO K800-AMT-CD                    05630013
                                         K800-AMT-CD-CASH               05640013
                                         K800-AMT-SOC-CASH              05650013
           ELSE                                                         05660013
              COMPUTE K800-AMT-CD       = ZEROES                        05670013
              COMPUTE K800-AMT-SOC-CASH = ZEROES                        05680013
           END-IF.                                                      05690013
           COMPUTE K800-AMT-SOC-SERCNTR-PAID = ZEROES.                  05700013
           COMPUTE K800-AMT-CPF1-PAID = ZEROES.                         05710013
           COMPUTE K800-AMT-CPF2-PAID = ZEROES.                         05720013
           COMPUTE K800-AMT-CPF3-PAID = ZEROES.                         05730013
           COMPUTE K800-AMT-CPF4-PAID = ZEROES.                         05740013
                                                                        05750013
           REWRITE BP13K800-MASTER.                                     05760013
                                                                        05770013
           IF K800-STATUS = ZEROES                                      05780013
              ADD 1 TO WS-DEBIT-CNT                                     05790013
           ELSE                                                         05800013
              DISPLAY 'ERROR REWRITING BP13K800, STATUS : '             05810013
                       K800-STATUS                                      05820013
              PERFORM 040-END-PROCESS    THRU 040-EXIT.                 05830013
                                                                        05840013
       240-EXIT.                                                        05850013
           EXIT.                                                        05860013
                                                                        05870013
                                                                        05880013
      *------------------------*                                        05890013
       250-WRITE-BP13K130.                                              05900013
      *------------------------*                                        05910013
           WRITE BP13K130-CDHIST   FROM   BP13F130-REC.                 05920013
                                                                        05930013
           IF K130-STATUS = ZEROES                                      05940013
              NEXT SENTENCE                                             05950013
           ELSE                                                         05960013
              IF K130-STATUS = 22                                       05970013
                 ADD 1        TO  F130-COUNT-HISTORY                    05980013
                 GO TO 250-WRITE-BP13K130                               05990013
              ELSE                                                      06000013
                 DISPLAY 'ERROR WRITING BP13K130, STATUS : '            06010013
                         K130-STATUS                                    06020013
                 PERFORM 040-END-PROCESS    THRU 040-EXIT.              06030013
                                                                        06040013
       250-EXIT.                                                        06050013
           EXIT.                                                        06060013
                                                                        06070013
                                                                        06080013
      *------------------------*                                        06090013
       300-PROCESS-SOC-PAID.                                            06100013
      *------------------------*                                        06110013
           MOVE SPACES                TO BP13F130-REC.                  06120013
           MOVE '20'                  TO F130-TRANS-TYPE.               06130013
           MOVE K800-NUM-REGN         TO F130-NUM-REGN.                 06140013
           MOVE K800-NUM-NRIC1        TO F130-NUM-NRIC.                 06150013
           MOVE WS-DATE               TO F130-DTE-POST.                 06160013
           MOVE ZEROS                 TO F130-COUNT-HISTORY.            06170013
           MOVE SPACES                TO F130-NUM-CPF-APPL.             06180013
           MOVE 'SOC'                 TO F130-CDE-PAYMENT-TYPE.         06190013
           MOVE WS-DD                 TO WS-RECEIPT-DD.                 06200013
           MOVE WS-MM                 TO WS-RECEIPT-MM.                 06210013
           MOVE WS-YY                 TO WS-RECEIPT-YY.                 06220013
           MOVE 'JR'                  TO WS-RECEIPT-CD.                 06230013
           MOVE '/'                   TO WS-SLASH.                      06240013
           MOVE WS-NUM-RECEIPT-JRNO   TO F130-NUM-RECPT-JRNO.           06250013
           COMPUTE F130-AMT-RECEIPT = 0 - WS-AMT-SOC-PAID.              06260013
           MOVE 'D'                   TO F130-CDE-AMT-TYPE.             06270013
           MOVE WS-DATE               TO F130-DTE-TRANS                 06280013
           MOVE F430-NUM-HDB-REF      TO F130-NUM-SCH-ACCT.             06290013
                                                                        06300013
           WRITE BP13F130-REC.                                          06310013
           ADD  1                        TO WS-WRITE-F130-CNT.          06320013
                                                                        06330013
       300-EXIT.                                                        06340013
           EXIT.                                                        06350013
