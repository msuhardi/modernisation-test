       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CB88.                                                 
      *AUTHOR.        ZDD1.                                                     
      *DATE-WRITTEN.  02MAR2010.                                                
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : PRINT SUCC OR UNSUCC LETTER FOR BTO         *            
      *                                                            *            
      *  INPUT FILES : 1.  BP13F740  -  SOC REQ FILE               *            
      *                2.  BP13K740                                *            
      *                3.  BP13K825  -  OCCUPIER FILE              *            
      *                4.  BP13K830  -  ADDRESS FILE               *            
      *                5.  BP13K813  -  CODE TRANSCRIPTION         *            
      *                6.  SY02F001  -  DATE FILE                  *            
      *                                                            *            
      *  LISTINGS    : 1.  P13LB88A  - SUCC AND LOAN = H           *            
      *                3.  P13LB88C  - CONTROL LISTING FOR SUCC    *            
      *                4.  P13LB88D  - CONTROL LISTING FOR UNSUCC  *            
      *                6.  P13LB88G  - CONTROL LISTING FOR GRO     *            
      *                16. P13LB88M  - SUCC SBF R LETTERS          *            
      *                17. P13LB88N  - UNSUCC SBF LETTERS          *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  BY    DATE    DESCRIPTION                         *            
      * -------- ---  ------   -----------                         *            
      * BP133737 ZDD  20091118 NEW PROGRAM.                        *            
      * BP133870 ZDD  20100517 INCLUDE JDE                         *            
      * BP133913 ZDD  20100526 INCLUDE NEW FORM FOR WITH OUT QUEUE *            
      * BP134036 ZDD  20101013 CATER FOR SBF                       *            
      * BP134071 ZDD  20101111 INCLUDE NEW FORM BP13KD             *            
      * BP134393 ZDD  20111024 include new form for sbf            *            
      * BP134413 ZDD  20111216 CATER FOR FORM REVISIONS            *            
      * BP134679 SMR2 20121022 REMOVE SBF LETTERS & FORM REVISIONS *            
      * BP134679 SMR2 20121115 REMOVE P13LB88G & FORM REVISIONS    *            
      * BP135190 SMR2 20131204 EXPAND BP13K813 TO 1000             *            
      * BP135636 SMR2 20150316 NEW IMP NOTES FOR UNSUCC LETTERS-7N *            
      * BP136096 SMR2 20160118 NEW IMP NOTES FOR SINGLES - HQ/HS   *            
      *                        REMOVE IMP NOTES - BP13V8/V0        *            
      *                        REMOVE HARDCODING FOR FLAT TYPE     *            
      * BP136172 SMR2 20160303 REMOVE SA FORMS BP13VN/VP/VS/VV/VY  *            
      * BP136169 SMR2 20160407 SWITCH THE FIELDS, UNIT & STREET    *            
      *                        REMOVE FORMS - BP13VR/VU            *            
      * BP137685 AM25 20190218 UPDATE TEXT EXERCISE FIELD          *            
      * BP137685 IL5  20190319 CHANGE PRINT POSITION OF NT FIELD   *            
      * BP138311 AM25 20200910 REMOVE FAQS - FORM BP13HN           *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F740  ASSIGN       TO BP13F740                            
                            FILE STATUS  IS WS-F740-STATUS.                     
                                                                                
           SELECT BP13K825  ASSIGN       TO BP13K825                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K825-KEY-FLD                        
                            FILE STATUS  IS WS-K825-STATUS.                     
                                                                                
           SELECT BP13K830  ASSIGN       TO BP13K830                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K830-KEY-FLD                        
                            ALTERNATE RECORD KEY IS  K830-NUM-REGN              
                            FILE STATUS  IS WS-K830-STATUS.                     
                                                                                
           SELECT BP13K813  ASSIGN       TO BP13K813                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K813-KEY-FLD                        
                            FILE STATUS  IS WS-K813-STATUS.                     
                                                                                
           SELECT BP13K740  ASSIGN        TO BP13K740                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K740-KEY-FLD                       
                            FILE STATUS   IS WS-K740-STATUS.                    
                                                                                
           SELECT P13LB88C  ASSIGN       TO P13LB88C.                           
           SELECT P13LB88D  ASSIGN       TO P13LB88D.                           
           SELECT P13LB88M  ASSIGN       TO P13LB88M.                           
           SELECT P13LB882  ASSIGN       TO P13LB882.                           
           SELECT P13LB883  ASSIGN       TO P13LB883.                           
           SELECT P13LB884  ASSIGN       TO P13LB884.                           
           SELECT P13LB885  ASSIGN       TO P13LB885.                           
           SELECT P13LB886  ASSIGN       TO P13LB886.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F740                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13F740.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K740                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K740.                                                           
                                                                                
       FD  P13LB88C                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LB88C-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13LB88D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LB88D-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13LB88M                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LB88M-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LB882                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LB882-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LB883                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LB883-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LB884                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LB884-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LB885                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LB885-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LB886                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LB886-PRTREC                     PIC X(90).                          
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       COPY PRIOSCH.                                                            
                                                                                
       01  WS-STATUS.                                                           
           05  BP13F740-STATUS              PIC 99    VALUE ZEROS.              
           05  WS-K825-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K813-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K740-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-F740-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F740-NOT-FND              PIC 9(06)  VALUE ZEROS.             
           05  WS-F740-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LB88M-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LB882-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LB883-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LB884-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LB885-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LB886-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-SUCC          PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-GRO           PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-UNSUCC        PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-LB88C            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LB88C            PIC 9(06)  VALUE 60.                
           05  WS-CNT-PAGE-LB88D            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LB88D            PIC 9(06)  VALUE 60.                
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F740-EOF                  PIC X     VALUE 'N'.                
           05  WS-BALLOT-SW                 PIC X(2)  VALUE SPACES.             
           05  WS-K825-NME-OCCP             PIC X(66) VALUE SPACES.             
           05  WS-ALLOCSCH-TYPE             PIC X(3)  VALUE SPACES.             
           05  WS-IDX-X                     PIC 99    VALUE 01.                 
           05  WS-RECORD-CNT                PIC ZZZ9.                           
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE-X REDEFINES WS-SENT-DATE PIC X(8).                  
           05  WS-DAYS                      PIC 9(7)  VALUE ZEROES.             
           05  WS-APPMT-TIME.                                                   
               10  WS-APPMT-HR              PIC 9(2)  VALUE 00.                 
               10  WS-APPMT-MIN             PIC 9(2)  VALUE 00.                 
           05  WS-DTE-BALLOT                PIC X(6)  VALUE SPACES.             
           05  WS-MTH-BE                    PIC X(9)  VALUE SPACES.             
                                                                                
       01  WS2-DEFAULT.                                                         
           05  WS2-MAX-LINES-LB88C          PIC 9(2)   VALUE 37.                
           05  WS2-MAX-LINES-LB88D          PIC 9(2)   VALUE 45.                
                                                                                
      *===============================                                          
      *   LINKAGE SECTION FOR AV02C015                                          
      *===============================                                          
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER TO APPLICANT                     *            
      *------------------------------------------------------------*            
       01  LB88-LINE01.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LB88-REFNO               PIC X(15) VALUE SPACES.                 
                                                                                
       01  LB88-LINE01B.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LB88-NUM-REGN            PIC X(14) VALUE SPACES.                 
                                                                                
       01  LB88-LINE02.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LB88-DATE                PIC X(10) VALUE SPACES.                 
                                                                                
       01  LB88-LINE03.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LB88-NAME                PIC X(66) VALUE SPACES.                 
                                                                                
       01  LB88-LINE04.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LB88-NAME2               PIC X(66) VALUE SPACES.                 
                                                                                
       01  LB88-LINE05.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LB88-BLK                 PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  LB88-ADDR-L2             PIC X(47) VALUE SPACES.                 
                                                                                
       01  LB88-LINE06.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LB88-UNIT                PIC X(11) VALUE SPACES.                 
                                                                                
       01  LB88-LINE07.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LB88-ADDR-L3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  LB88-LINE08.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LB88-BAR-CODE            PIC X(09) VALUE SPACES.                 
                                                                                
       01  LB88-LINE8A.                                                         
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  LB88-ROOM-NO1            PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(03) VALUE SPACES.                 
           05  LB88-ESTATE1             PIC X(28) VALUE SPACES.                 
                                                                                
       01  LB88-LINE8B.                                                         
           05  FILLER                   PIC X(55) VALUE SPACES.                 
           05  LB88-ESTATE2             PIC X(28) VALUE SPACES.                 
                                                                                
       01  LB88-LINE8C.                                                         
           05  FILLER                   PIC X(32) VALUE SPACES.                 
           05  LB88-ROOM-NO2            PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  LB88-ESTATE3             PIC X(28) VALUE SPACES.                 
                                                                                
       01  LB88-LINE8D.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LB88-ESTATE4             PIC X(28) VALUE SPACES.                 
                                                                                
       01  LB88-LINE8E.                                                         
           05  FILLER                   PIC X(67) VALUE SPACES.                 
           05  LB88-ROOM-NO3            PIC X(17) VALUE SPACES.                 
                                                                                
       01  LB88-LINE8F.                                                         
           05  FILLER                   PIC X(67) VALUE SPACES.                 
           05  LB88-ESTATE5             PIC X(28) VALUE SPACES.                 
                                                                                
       01  LB88-LINE09A.                                                        
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  LB88-ELEC-WARD           PIC X(25) VALUE SPACES.                 
                                                                                
       01  LB88-LINE09B.                                                        
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  LB88-ELEC-WARD-JO        PIC X(25) VALUE SPACES.                 
                                                                                
      *** NORMAL QUEUE POSITION ***                                             
       01  LB88-LINE10A-NORM.                                                   
           05  FILLER                   PIC X(63) VALUE SPACES.                 
           05  LB88-QUEUE-NO1           PIC ZZZZ9.                              
                                                                                
       01  LB88-LINE10B-NORM.                                                   
           05  FILLER                   PIC X(34) VALUE SPACES.                 
           05  LB88-QUEUE-NO2           PIC ZZZZ9.                              
                                                                                
      *** GRO QUEUE POSITION ***                                                
       01  LB88-LINE10A-GRO.                                                    
           05  FILLER                   PIC X(57) VALUE SPACES.                 
           05  LB88-QUEUE-NO1-GRO       PIC ZZZZ9.                              
                                                                                
       01  LB88-LINE10B-GRO.                                                    
           05  FILLER                   PIC X(58) VALUE SPACES.                 
           05  LB88-QUEUE-NO2-GRO       PIC ZZZZ9.                              
                                                                                
       01  LB88-LINE10C-GRO.                                                    
           05  FILLER                   PIC X(60) VALUE SPACES.                 
           05  LB88-QUEUE-NO3-GRO       PIC ZZZZ9.                              
                                                                                
       01  LB88-LINE10D-GRO.                                                    
           05  FILLER                   PIC X(56) VALUE SPACES.                 
           05  LB88-QUEUE-NO4-GRO       PIC ZZZZ9.                              
                                                                                
       01  LB88-LINE10E-GRO.                                                    
           05  FILLER                   PIC X(54) VALUE SPACES.                 
           05  LB88-QUEUE-NO5-GRO       PIC ZZZZ9.                              
                                                                                
      *** UNIT OFFER ***                                                        
       01  LB88-LINE10E-OFR.                                                    
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LB88-UNIT-OFFER-A        PIC ZZZ9.                               
                                                                                
       01  LB88-LINE10F-OFR.                                                    
           05  FILLER                   PIC X(13) VALUE SPACES.                 
           05  LB88-UNIT-OFFER-B        PIC ZZZ9.                               
                                                                                
       01  LB88-LINE10G-OFR.                                                    
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LB88-UNIT-OFFER-C        PIC ZZZ9.                               
                                                                                
      *** SEL PERIOD LTR ***                                                    
       01  LB88-LINE10D-DATE.                                                   
           05  FILLER                   PIC X(22)  VALUE SPACES.                
           05  LB88-DTE-SEL             PIC X(30) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10D-DATE-JU.                                                
           05  FILLER                   PIC X(72)  VALUE SPACES.                
           05  LB88-DTE-SEL-JU          PIC X(30) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10E-DATE.                                                   
           05  FILLER                   PIC X(69)  VALUE SPACES.                
           05  LB88-DTE-SEL-A           PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10F-DATE.                                                   
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  LB88-DTE-SEL-B           PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10F-DATE-KD.                                                
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  LB88-DTE-SEL-B-KD        PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10F-DATE-KN.                                                
           05  FILLER                   PIC X(39)  VALUE SPACES.                
           05  LB88-DTE-SEL-B-KN        PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10F-DATE-JR.                                                
           05  FILLER                   PIC X(42)  VALUE SPACES.                
           05  LB88-DTE-SEL-B-JR        PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10G-DATE.                                                   
           05  FILLER                   PIC X(68)  VALUE SPACES.                
           05  LB88-DTE-SEL-C           PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10H-DATE.                                                   
           05  FILLER                   PIC X(27)  VALUE SPACES.                
           05  LB88-DTE-SEL-H           PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10I-DATE.                                                   
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  LB88-DTE-SEL-D           PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE10J-DATE.                                                   
           05  FILLER                   PIC X(53)  VALUE SPACES.                
           05  LB88-DTE-SEL-E           PIC X(18) VALUE SPACES.                 
                                                                                
       01  LB88-LINE11A-BALLOT.                                                 
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LB88-BALLOT-DTE          PIC X(70) VALUE SPACES.                 
                                                                                
       01  LB88-LINE11B-BALLOT.                                                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  LB88-BALLOT-DTE1         PIC X(70) VALUE SPACES.                 
                                                                                
       01  LB88-LINE11C-BALLOT.                                                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  LB88-BALLOT-DTE2         PIC X(70) VALUE SPACES.                 
                                                                                
       01  LB88E-LINE02A.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LB88E-NAME1              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LB88E-NRIC1              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LB88E-LINE02B.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LB88E-NAME2              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LB88E-NRIC2              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LB88E-LINE02C.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LB88E-NAME3              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LB88E-NRIC3              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LB88E-LINE02D.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LB88E-NAME4              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LB88E-NRIC4              PIC X(9)  VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  LB88A-HDG1.                                                          
           05  LB88A-LISTING            PIC X(14) VALUE 'P13LB88C'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  LB88A-DATE               PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  LB88A-PAGE               PIC ZZZZ9.                              
                                                                                
       01  LB88A-HDG2.                                                          
           05  FILLER                   PIC X(20) VALUE SPACES.                 
           05  LB88A-LISTING-TYPE       PIC X(87) VALUE SPACES.                 
                                                                                
       01  LB88A-HDG4.                                                          
           05  FILLER                   PIC X(7)  VALUE ' S/N   '.              
           05  FILLER                   PIC X(9)  VALUE 'REF-NO   '.            
           05  FILLER                   PIC X(15) VALUE                         
               'APPLICANT NAMES'.                                               
           05  FILLER                   PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE '  UIN  '.              
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE 'CAT  '.                
           05  FILLER                   PIC X(5)  VALUE 'ALLOC'.                
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'FLAT'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'HHTY   '.              
           05  FILLER                   PIC X(4)  VALUE 'MCPS'.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'RES-HA1'.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'SUCC'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'NT1   '.               
           05  FILLER                   PIC X(6)  VALUE 'UNSUCC'.               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'BALLOT'.               
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE 'ZE'.                   
                                                                                
       01  LB88A-HDG5.                                                          
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'REGN-NO'.              
           05  FILLER                   PIC X(40) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'SCH'.                  
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'TYPE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE '    '.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE '       '.              
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE '     '.                
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'ZONE   '.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE '   '.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'ZONE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'POS'.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'Q-POS'.                
                                                                                
       01  LB88A-HDG6.                                                          
           05  FILLER                   PIC X(7)  VALUE '       '.              
           05  FILLER                   PIC X(9)  VALUE 'LOAN-TAG '.            
           05  FILLER                   PIC X(15) VALUE                         
               'REQ-STATUS     '.                                               
                                                                                
       01  LB88A-DTL-1.                                                         
           05  LB88A-SERIAL-NO          PIC ZZZ9.                               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LB88A-REF-NO             PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LB88A-NAME-1             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LB88A-NRIC-1             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LB88A-CAT                PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LB88A-ALLOC              PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LB88A-FLAT               PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LB88A-HHTY               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LB88A-MCPS               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(9)  VALUE SPACES.                 
           05  LB88A-RES-HA1            PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LB88A-SUCC               PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LB88A-NT1                PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  LB88A-UNSUCC             PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LB88A-BALLOT-POS         PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LB88A-ZONE               PIC X(2)  VALUE SPACES.                 
                                                                                
       01  LB88A-DTL-2.                                                         
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LB88A-REGN-NO            PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LB88A-NAME-2             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LB88A-NRIC-2             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(79) VALUE SPACES.                 
           05  LB88A-QUEUE              PIC X(5)  VALUE SPACES.                 
                                                                                
       01  LB88A-DTL-3.                                                         
           05  FILLER                   PIC X(16) VALUE SPACES.                 
           05  LB88A-BLK                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LB88A-UNIT               PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LB88A-ADDR2              PIC X(65) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LB88A-ADDR3              PIC X(20) VALUE SPACES.                 
                                                                                
       01  LB88A-DTL-4.                                                         
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LB88A-LOAN-TAG           PIC X(6)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LB88A-REQ-STATUS         PIC X(22) VALUE SPACES.                 
                                                                                
       01  DJDE-LINE-NON-POD1             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13K1,BFORM=BP13K2,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-NON-POD2             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13KQ,BFORM=BLANKF,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-VM                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VM,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VO                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VO,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VQ                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VQ,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VX                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VX,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VW                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VW,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-VT                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13VT,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-BLANKF                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BLANKF,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V6                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V6,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V7                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V7,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13V9                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13V9,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP137N                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP137N,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13HQ                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13HQ,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13HS                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13HS,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
                                                                                
      *=============================================================            
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-FILES             THRU 1000-EXIT.                  
           PERFORM 3000-PROCESS-RECORDS        THRU 3000-EXIT                   
                   UNTIL WS-F740-EOF = 'Y'.                                     
           PERFORM 9000-CLOSE-ROUTINE          THRU 9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       1000-OPEN-FILES.                                                         
      *=============================================================            
                                                                                
           OPEN INPUT BP13F740                                                  
                      BP13K825                                                  
                      BP13K830                                                  
                      BP13K813                                                  
                      BP13K740                                                  
               OUTPUT P13LB88C                                                  
                      P13LB88D                                                  
                      P13LB88M                                                  
                      P13LB882                                                  
                      P13LB883                                                  
                      P13LB884                                                  
                      P13LB885                                                  
                      P13LB886.                                                 
                                                                                
           IF WS-K825-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K825 STATUS ' WS-K825-STATUS               
              MOVE     WS-K825-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K830 STATUS ' WS-K830-STATUS               
              MOVE     WS-K830-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K813 STATUS ' WS-K813-STATUS               
              MOVE     WS-K813-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K740-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K740 STATUS ' WS-K740-STATUS               
              MOVE     WS-K740-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-DATE WS-CURR-DATE.             
                                                                                
           STRING WS-DD '/'                                                     
                  WS-MM '/'                                                     
                  WS-CCYY DELIMITED BY SIZE                                     
                  INTO LB88A-DATE.                                              
                                                                                
           MOVE SPACES                   TO LB88M-PRTREC                        
                                            LB882-PRTREC                        
                                            LB883-PRTREC                        
                                            LB884-PRTREC                        
                                            LB885-PRTREC                        
                                            LB886-PRTREC.                       
                                                                                
           MOVE SPACES           TO LB88M-PRTREC.                               
           WRITE LB88M-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LB88M-PRTREC.                               
           WRITE LB88M-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LB882-PRTREC.                               
           WRITE LB882-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LB882-PRTREC.                               
           WRITE LB882-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LB883-PRTREC.                               
           WRITE LB883-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LB883-PRTREC.                               
           WRITE LB883-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LB884-PRTREC.                               
           WRITE LB884-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LB884-PRTREC.                               
           WRITE LB884-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LB885-PRTREC.                               
           WRITE LB885-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LB885-PRTREC.                               
           WRITE LB885-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LB886-PRTREC.                               
           WRITE LB886-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LB886-PRTREC.                               
           WRITE LB886-PRTREC    AFTER PAGE.                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3000-PROCESS-RECORDS.                                                    
      *=============================================================            
                                                                                
           PERFORM 4000-READ-BP13F740     THRU 4000-EXIT.                       
           PERFORM 4500-MOVE-DETAILS      THRU 4500-EXIT                        
                   UNTIL WS-F740-EOF = 'Y'.                                     
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4000-READ-BP13F740.                                                      
      *=============================================================            
                                                                                
            READ BP13F740                                                       
                 AT END MOVE 'Y'  TO  WS-F740-EOF                               
                        GO TO 4000-EXIT.                                        
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4500-MOVE-DETAILS.                                                       
      *=============================================================            
                                                                                
           MOVE SPACES                    TO K825-KEY-FLD                       
                                             LB88E-NAME1                        
                                             LB88E-NAME2                        
                                             LB88E-NAME3                        
                                             LB88E-NAME4                        
                                             LB88E-NRIC1                        
                                             LB88E-NRIC2                        
                                             LB88E-NRIC3                        
                                             LB88E-NRIC4                        
                                             LB88-NUM-REGN                      
                                             LB88-ROOM-NO1                      
                                             LB88-ROOM-NO2                      
                                             LB88-ROOM-NO3                      
                                             LB88-BALLOT-DTE                    
                                             LB88-BALLOT-DTE1                   
                                             LB88-BALLOT-DTE2                   
                                             LB88-DTE-SEL                       
                                             LB88-DTE-SEL-JU                    
                                             LB88-DTE-SEL-A                     
                                             LB88-DTE-SEL-B                     
                                             LB88-DTE-SEL-B-KD                  
                                             LB88-DTE-SEL-B-KN                  
                                             LB88-DTE-SEL-B-JR                  
                                             LB88-DTE-SEL-C                     
                                             LB88-DTE-SEL-D                     
                                             LB88-DTE-SEL-E                     
                                             LB88-DTE-SEL-H.                    
                                                                                
           MOVE F740-NUM-REF              TO LB88-REFNO.                        
                                                                                
      *    IF F740-CDE-FLAT-TYPE = '1A'                                         
      *       MOVE 'Studio Apartment'     TO LB88-ROOM-NO1                      
      *    ELSE                                                                 
      *       STRING F740-CDE-FLAT-TYPE(1:1) '-room flat'                       
      *       DELIMITED BY SIZE           INTO LB88-ROOM-NO1                    
      *    END-IF.                                                              
                                                                                
      *    MOVE LB88-ROOM-NO1               TO LB88-ROOM-NO2                    
      *                                        LB88-ROOM-NO3.                   
                                                                                
           EVALUATE   F740-NUM-WARD                                             
             WHEN 'AD '                                                         
                MOVE 'ADMIRALTY'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'AH '                                                         
                MOVE 'ANG MO KIO-HOUGANG'         TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'AR '                                                         
                MOVE 'AYER RAJAH'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BB '                                                         
                MOVE 'BUKIT BATOK'                TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BD '                                                         
                MOVE 'BEDOK'                      TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BE '                                                         
                MOVE 'BISHAN EAST'                TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BG '                                                         
                MOVE 'BUKIT GOMBAK'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BH '                                                         
                MOVE 'BRADDELL HEIGHTS'           TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BK '                                                         
                MOVE 'BUKIT BATOK EAST'           TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BL '                                                         
                MOVE 'BOON LAY'                   TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BN '                                                         
                MOVE 'BISHAN NORTH'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BP '                                                         
                MOVE 'BUKIT PANJANG'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BR '                                                         
                MOVE 'BEDOK RESERVOIR-PUNGGOL'    TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BT '                                                         
                MOVE 'BUKIT TIMAH'                TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'BV '                                                         
                MOVE 'BUONA VISTA'                TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'CA '                                                         
                MOVE 'CASHEW'                     TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'CB '                                                         
                MOVE 'CANBERRA'                   TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'CH '                                                         
                MOVE 'CHANGI-SIMEI'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'CK '                                                         
                MOVE 'CHUA CHU KANG'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'CL '                                                         
                MOVE 'CLEMENTI'                   TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'CP '                                                         
                MOVE 'CHONG PANG'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'CS '                                                         
                MOVE 'CHENG SAN-SELETAR'          TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'EU '                                                         
                MOVE 'EUNOS'                      TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'FS '                                                         
                MOVE 'FENGSHAN'                   TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'GS '                                                         
                MOVE 'GEYLANG SERAI'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'HG '                                                         
                MOVE 'HOUGANG'                    TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'HK '                                                         
                MOVE 'HONG KAH NORTH'             TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'JB '                                                         
                MOVE 'JALAN BESAR'                TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'JC '                                                         
                MOVE 'JOO CHIAT'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'JK '                                                         
                MOVE 'JALAN KAYU'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'JS '                                                         
                MOVE 'JURONG SPRING'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'JU '                                                         
                MOVE 'JURONG CENTRAL'             TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KA '                                                         
                MOVE 'KOLAM AYER'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KB '                                                         
                MOVE 'KAKI BUKIT'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KC '                                                         
                MOVE 'KAMPONG CHAI CHEE'          TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KG '                                                         
                MOVE 'KAMPONG GLAM'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KH '                                                         
                MOVE 'KEAT HONG'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KR '                                                         
                MOVE 'KEBUN BARU'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KS '                                                         
                MOVE 'KRETA AYER-KIM SENG'        TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'KU '                                                         
                MOVE 'KEMBANGAN-CHAI CHEE'        TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'MA '                                                         
                MOVE 'MARINE PARADE'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'MB '                                                         
                MOVE 'MOUNTBATTEN'                TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'MM '                                                         
                MOVE 'MOULMEIN'                   TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'MP '                                                         
                MOVE 'MACPHERSON'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'MS '                                                         
                MOVE 'MARSILING'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'NC '                                                         
                MOVE 'NEE SOON CENTRAL'           TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'NE '                                                         
                MOVE 'NEE SOON EAST'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'NS '                                                         
                MOVE 'NEE SOON SOUTH'             TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'NY '                                                         
                MOVE 'NANYANG'                    TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PA '                                                         
                MOVE 'PASIR RIS EAST'             TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PC '                                                         
                MOVE 'PUNGGOL CENTRAL'            TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PE '                                                         
                MOVE 'PUNGGOL EAST'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PI '                                                         
                MOVE 'PIONEER'                    TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PL '                                                         
                MOVE 'PAYA LEBAR'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PN '                                                         
                MOVE 'PUNGGOL NORTH'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PR '                                                         
                MOVE 'PASIR RIS WEST'             TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PS '                                                         
                MOVE 'POTONG PASIR'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PU '                                                         
                MOVE 'PUNGOL SOUTH'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'PW '                                                         
                MOVE 'PUNGOL WEST'                TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'QT '                                                         
                MOVE 'QUEENSTOWN'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'RM '                                                         
                MOVE 'RADIN MAS'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'SB '                                                         
                MOVE 'SEMBAWANG'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'SG '                                                         
                MOVE 'SERANGOON'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'SL '                                                         
                MOVE 'SIGLAP'                     TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'SW '                                                         
                MOVE 'SENGKANG WEST'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TA '                                                         
                MOVE 'TOA PAYOH EAST'             TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TB '                                                         
                MOVE 'TELOK BLANGAH'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TC '                                                         
                MOVE 'TAMPINES CENTRAL'           TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TE '                                                         
                MOVE 'TAMPINES EAST'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TG '                                                         
                MOVE 'TECK GHEE'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TH '                                                         
                MOVE 'THOMSON-TOA PAYOH'          TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TJ '                                                         
                MOVE 'TAMAN JURONG'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TL '                                                         
                MOVE 'TANGLIN-CAIRNHILL'          TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TM '                                                         
                MOVE 'TAMPINES CHANGKAT'          TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TN '                                                         
                MOVE 'TAMPINES NORTH'             TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TO '                                                         
                MOVE 'TOA PAYOH CENTRAL'          TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TP '                                                         
                MOVE 'TANJONG PAGAR-TIONG BAHRU'  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'TW '                                                         
                MOVE 'TAMPINES WEST'              TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'UP '                                                         
                MOVE 'ULU PANDAN'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'WC '                                                         
                MOVE 'WEST COAST'                 TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'WG '                                                         
                MOVE 'WOODGROVE'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'WL '                                                         
                MOVE 'WOODLANDS'                  TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'WP '                                                         
                MOVE 'WHAMPOA'                    TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'YH '                                                         
                MOVE 'YUHUA'                      TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'YK '                                                         
                MOVE 'YIO CHU KANG'               TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'YT '                                                         
                MOVE 'YEW TEE'                    TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
             WHEN 'ZH '                                                         
                MOVE 'ZHENGHUA'                   TO LB88-ELEC-WARD             
                                                     LB88-ELEC-WARD-JO          
           END-EVALUATE.                                                        
                                                                                
           MOVE F740-NUM-NT-FT-QUEUE TO LB88-QUEUE-NO1                          
                                        LB88-QUEUE-NO2.                         
                                                                                
           STRING F740-CDE-SUCC-NT-ZONE DELIMITED BY SPACES                     
                  F740-CDE-FLAT-TYPE DELIMITED BY SPACES                        
                  '/' F740-NUM-REGN                                             
                  DELIMITED BY SIZE INTO LB88-NUM-REGN.                         
                                                                                
           MOVE F740-NUM-REGN          TO K825-NUM-REGN.                        
                                                                                
           MOVE F740-NUM-NRIC1            TO K825-NUM-NRIC.                     
                                                                                
           PERFORM  4600-READ-K825      THRU 4600-EXIT.                         
           MOVE     WS-K825-NME-OCCP      TO LB88-NAME                          
                                             LB88E-NAME1.                       
                                                                                
           MOVE F740-NUM-NRIC1            TO LB88E-NRIC1.                       
                                                                                
           IF F740-NUM-NRIC2 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LB88-NAME2                      
                                                LB88E-NAME2                     
                                                LB88E-NRIC2                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC2            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LB88-NAME2                      
                                                LB88E-NAME2                     
              MOVE F740-NUM-NRIC2            TO LB88E-NRIC2                     
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC3 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LB88E-NAME3                     
                                                LB88E-NRIC3                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC3            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LB88E-NAME3                     
              MOVE F740-NUM-NRIC3            TO LB88E-NRIC3                     
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC4 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LB88E-NAME4                     
                                                LB88E-NRIC4                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC4            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LB88E-NAME4                     
              MOVE F740-NUM-NRIC4            TO LB88E-NRIC4                     
           END-IF.                                                              
                                                                                
           MOVE F740-DTE-BALLOT TO              WS-DTE-BALLOT.                  
                                                                                
           EVALUATE WS-DTE-BALLOT(5:2)                                          
           WHEN 01                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN JANUARY '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'JANUARY '    F740-DTE-BALLOT(1:4)                      
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'JANUARY '    F740-DTE-BALLOT(1:4)                      
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 02                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN FEBRUARY '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'FEBRUARY '    F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'FEBRUARY '    F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 03                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN MARCH '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'MARCH '       F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'MARCH '       F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 04                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN APRIL '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'APRIL '       F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'APRIL '       F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 05                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN MAY '                              
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'MAY '         F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'MAY '         F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 06                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN JUNE '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'JUNE '        F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'JUNE '        F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 07                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN JULY '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'JULY '        F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'JULY '        F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 08                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN AUGUST '                           
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'AUGUST '      F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'AUGUST '      F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 09                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN SEPTEMBER '                        
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'SEPTEMBER '   F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'SEPTEMBER '   F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 10                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN OCTOBER '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'OCTOBER '     F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'OCTOBER '     F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 11                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN NOVEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'NOVEMBER '    F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'NOVEMBER '    F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 12                                                              
              IF F740-NUM-ALLO-CAT = 'BTO'                                      
                 STRING 'FLAT APPLICATION IN DECEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' BUILD-TO-ORDER (BTO) EXERCISE'                        
                 DELIMITED BY SIZE INTO   LB88-BALLOT-DTE                       
                                                                                
                 STRING 'DECEMBER '    F740-DTE-BALLOT(1:4)                     
                        ' Build-To-Order (BTO) Exercise'                        
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE1                  
                                                                                
                 STRING 'DECEMBER '    F740-DTE-BALLOT(1:4)                     
                 DELIMITED BY SIZE INTO       LB88-BALLOT-DTE2                  
              END-IF                                                            
           END-EVALUATE.                                                        
                                                                                
           MOVE SPACES                    TO BP13K813-REC.                      
           MOVE F740-CDE-NT1              TO K813-NUM-ZONE.                     
           MOVE F740-CDE-FLAT-TYPE        TO K813-NUM-FLAT-TYPE.                
           MOVE F740-DTE-BALLOT           TO K813-DTE-BALLOT.                   
                                                                                
           PERFORM  4700-READ-BP13K813 THRU  4700-EXIT.                         
           PERFORM  4800-GET-ADDR      THRU  4800-EXIT.                         
           PERFORM  7000-CHECK-SCH     THRU  7000-EXIT.                         
           PERFORM  7300-READ-K740     THRU  7300-EXIT.                         
                                                                                
           IF F740-CDE-NT1 = 'CT '                                              
              MOVE 'The Pinnacle@Duxton    ' TO  LB88-ESTATE1                   
           END-IF.                                                              
                                                                                
           MOVE LB88-ESTATE1                 TO LB88-ESTATE2                    
                                                LB88-ESTATE3                    
                                                LB88-ESTATE4                    
                                                LB88-ESTATE5.                   
                                                                                
           IF F740-NUM-ALLO-CAT = 'BTO'                                         
              IF F740-CDE-FLAT-TYPE NOT = '1A'                                  
                 IF K740-NUM-NT-FT-QUEUE NOT = SPACES AND LOW-VALUES            
                    IF K740-NUM-NT-FT-QUEUE <= K813-NUM-QUEUE-START             
                       PERFORM 6000-PRT-BP13VM THRU 6000-EXIT                   
                    END-IF                                                      
                                                                                
                    IF K740-NUM-NT-FT-QUEUE > K813-NUM-QUEUE-START AND          
                       K740-NUM-NT-FT-QUEUE <= K813-NUM-QUEUE-MID               
                       PERFORM 6100-PRT-BP13VO THRU 6100-EXIT                   
                    END-IF                                                      
                                                                                
                    IF K740-NUM-NT-FT-QUEUE > K813-NUM-QUEUE-MID AND            
                       K740-NUM-NT-FT-QUEUE <= K813-NUM-QUEUE-END               
                       PERFORM 6220-PRT-BP13VQ THRU 6220-EXIT                   
                    END-IF                                                      
                                                                                
                    IF K740-NUM-NT-FT-QUEUE > K813-NUM-QUEUE-END                
                       PERFORM 6280-PRT-BP13VT THRU 6280-EXIT                   
                    END-IF                                                      
                 ELSE                                                           
                    IF K813-NUM-MATURE-EST-TAG = 'Y'                            
                       PERFORM 6230-PRT-BP13VX THRU 6230-EXIT                   
                    ELSE                                                        
                       PERFORM 6240-PRT-BP13VW THRU 6240-EXIT                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 6500-PRINT-CONTROL-LIST  THRU 6500-EXIT.                     
                                                                                
           ADD 1 TO WS-F740-READ-CTR.                                           
           PERFORM 4000-READ-BP13F740    THRU 4000-EXIT.                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4600-READ-K825.                                                          
      *=============================================================            
                                                                                
           MOVE    SPACES                TO  WS-K825-NME-OCCP                   
           READ BP13K825.                                                       
                                                                                
           IF WS-K825-STATUS = 00 OR 02                                         
              MOVE    K825-NME-OCCP      TO  WS-K825-NME-OCCP                   
           ELSE                                                                 
           IF WS-K825-STATUS = 23                                               
              DISPLAY 'K825 REC NOT FOUND : '   K825-KEY-FLD                    
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K825 = '   WS-K825-STATUS              
                      ', K825-KEY-FLD = '   K825-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4700-READ-BP13K813.                                                      
      *=============================================================            
                                                                                
            READ BP13K813.                                                      
            EVALUATE WS-K813-STATUS                                             
               WHEN '00'                                                        
                  MOVE K813-NME-PROJECT-LTR     TO LB88-ESTATE1                 
                  MOVE K813-TXT-SEL-PERIOD-LTR  TO LB88-DTE-SEL                 
                                                   LB88-DTE-SEL-A               
                                                   LB88-DTE-SEL-B               
                                                   LB88-DTE-SEL-B-KD            
                                                   LB88-DTE-SEL-B-KN            
                                                   LB88-DTE-SEL-B-JR            
                                                   LB88-DTE-SEL-C               
                                                   LB88-DTE-SEL-D               
                                                   LB88-DTE-SEL-E               
                                                   LB88-DTE-SEL-H               
                                                   LB88-DTE-SEL-JU              
                  MOVE K813-NUM-UNIT-OFFER      TO LB88-UNIT-OFFER-A            
                                                   LB88-UNIT-OFFER-B            
                                                   LB88-UNIT-OFFER-C            
                  MOVE K813-NME-FLAT-TYPE-LTR   TO LB88-ROOM-NO1                
                                                   LB88-ROOM-NO2                
                                                   LB88-ROOM-NO3                
                                                                                
               string K813-DTE-LETTER-PRINT(7:2) '/'                            
                      K813-DTE-LETTER-PRINT(5:2) '/'                            
                      K813-DTE-LETTER-PRINT(1:4)   DELIMITED BY SIZE            
                      INTO LB88-DATE                                            
               WHEN '23'                                                        
                  MOVE F740-CDE-NT1     TO LB88-ESTATE1                         
                  DISPLAY 'RECORD NOT FOUND IN BP13K813, KEY IS '               
                          '02' F740-CDE-NT1                                     
               WHEN OTHER                                                       
                  DISPLAY 'ERROR IN READING BP13K813, STATUS '                  
                          WS-K813-STATUS                                        
            END-EVALUATE.                                                       
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4800-GET-ADDR.                                                           
      *=============================================================            
                                                                                
           MOVE SPACES TO LB88-LINE05                                           
                          LB88-LINE06                                           
                          LB88-LINE07                                           
                          LB88-LINE08.                                          
                                                                                
           MOVE SPACES            TO    K830-KEY-FLD.                           
                                                                                
           MOVE F740-NUM-REF      TO    K830-KEY-FLD.                           
           READ BP13K830.                                                       
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                
                 ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                           
                 (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))               
                 MOVE K830-NUM-BLK         TO LB88-BLK                          
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO LB88-UNIT                         
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO LB88-UNIT                         
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO LB88-ADDR-L2                
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE SPACES            TO LB88-ADDR-L3                      
                    DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL               
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO LB88-ADDR-L3                      
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LB88-BAR-CODE             
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK        TO LB88-BLK                      
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                TO LB88-UNIT                     
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT    TO LB88-UNIT                     
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO LB88-ADDR-L2              
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO LB88-ADDR-L3                  
                    DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL              
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO LB88-ADDR-L3                  
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                                                                                
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LB88-BAR-CODE             
              END-IF                                                            
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              MOVE SPACES TO LB88-LINE05                                        
                             LB88-LINE06                                        
                             LB88-LINE07                                        
                             LB88-LINE08                                        
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                        
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4950-CALL-AV02C015.                                                      
      *=============================================================            
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       4950-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6000-PRT-BP13VM.                                                         
      *=============================================================            
      *** Successful GRO with PA queue positions within top 50% ***             
      *** of flat supply - NMEs only                            ***             
                                                                                
            ADD   1               TO    WS-LB88M-WRT-CTR.                       
            MOVE  SPACES          TO    LB88M-PRTREC.                           
            MOVE WS-LB88M-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VM(49:4).                     
            WRITE LB88M-PRTREC    FROM  DJDE-LINE-VM     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LB88M-PRTREC.                           
            WRITE LB88M-PRTREC AFTER PAGE.                                      
            WRITE LB88M-PRTREC    FROM  LB88-LINE01    AFTER 1.                 
            WRITE LB88M-PRTREC    FROM  LB88-LINE02.                            
            WRITE LB88M-PRTREC    FROM  LB88-LINE03    AFTER 5.                 
            WRITE LB88M-PRTREC    FROM  LB88-LINE04.                            
            WRITE LB88M-PRTREC    FROM  LB88-LINE05.                            
            WRITE LB88M-PRTREC    FROM  LB88-LINE06.                            
            WRITE LB88M-PRTREC    FROM  LB88-LINE07.                            
            WRITE LB88M-PRTREC    FROM  LB88-LINE08    AFTER 3.                 
            WRITE LB88M-PRTREC    FROM  LB88-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LB88M-PRTREC    FROM  LB88-LINE8C          AFTER 5.           
            WRITE LB88M-PRTREC    FROM  LB88-LINE10B-NORM    AFTER 1.           
            WRITE LB88M-PRTREC    FROM  LB88-LINE10A-GRO     AFTER 6.           
            WRITE LB88M-PRTREC    FROM  LB88-LINE10J-DATE    AFTER 2.           
                                                                                
            MOVE SPACES           TO    LB88M-PRTREC                            
                                        DJDE-LINE-VM(49:4)                      
            IF F740-CDE-ALLOC-SCH = 'GRO' AND F740-NUM-ELDERLY = 'S'            
               WRITE LB88M-PRTREC FROM  DJDE-BP13HQ        AFTER PAGE           
            ELSE                                                                
               WRITE LB88M-PRTREC FROM  DJDE-BP13V6        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LB88M-PRTREC.                           
            WRITE LB88M-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LB88M-PRTREC.                              
            WRITE LB88M-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LB88M-PRTREC.                              
            WRITE LB88M-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LB88M-PRTREC.                              
            WRITE LB88M-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LB88M-PRTREC.                              
            WRITE LB88M-PRTREC    AFTER PAGE.                                   
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6100-PRT-BP13VO.                                                         
      *=============================================================            
      *** Successful GRO with PA queue positions within 51% to ***              
      *** 100% of flat supply - NMEs only                      ***              
                                                                                
            ADD   1               TO    WS-LB886-WRT-CTR.                       
            MOVE  SPACES          TO    LB886-PRTREC.                           
            MOVE WS-LB886-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VO(49:4).                     
            WRITE LB886-PRTREC    FROM  DJDE-LINE-VO     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LB886-PRTREC.                           
            WRITE LB886-PRTREC AFTER PAGE.                                      
            WRITE LB886-PRTREC    FROM  LB88-LINE01    AFTER 1.                 
            WRITE LB886-PRTREC    FROM  LB88-LINE02.                            
            WRITE LB886-PRTREC    FROM  LB88-LINE03    AFTER 5.                 
            WRITE LB886-PRTREC    FROM  LB88-LINE04.                            
            WRITE LB886-PRTREC    FROM  LB88-LINE05.                            
            WRITE LB886-PRTREC    FROM  LB88-LINE06.                            
            WRITE LB886-PRTREC    FROM  LB88-LINE07.                            
            WRITE LB886-PRTREC    FROM  LB88-LINE08    AFTER 3.                 
            WRITE LB886-PRTREC    FROM  LB88-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LB886-PRTREC    FROM  LB88-LINE8E          AFTER 3.           
            WRITE LB886-PRTREC    FROM  LB88-LINE8D          AFTER 1.           
            WRITE LB886-PRTREC    FROM  LB88-LINE10A-NORM    AFTER 2.           
            WRITE LB886-PRTREC    FROM  LB88-LINE10B-GRO     AFTER 7.           
            WRITE LB886-PRTREC    FROM  LB88-LINE10E-OFR     AFTER 1.           
            WRITE LB886-PRTREC    FROM  LB88-LINE10J-DATE    AFTER 2.           
                                                                                
            MOVE SPACES           TO    LB886-PRTREC                            
                                        DJDE-LINE-VO(49:4)                      
            IF F740-CDE-ALLOC-SCH = 'GRO' AND F740-NUM-ELDERLY = 'S'            
               WRITE LB886-PRTREC FROM  DJDE-BP13HQ        AFTER PAGE           
            ELSE                                                                
               WRITE LB886-PRTREC FROM  DJDE-BP13V6        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LB886-PRTREC.                           
            WRITE LB886-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LB886-PRTREC.                              
            WRITE LB886-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LB886-PRTREC.                              
            WRITE LB886-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LB886-PRTREC.                              
            WRITE LB886-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LB886-PRTREC.                              
            WRITE LB886-PRTREC    AFTER PAGE.                                   
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6220-PRT-BP13VQ.                                                         
      *=============================================================            
      *** Successful GRO with PA queue positions within 101% to ***             
      *** 200% of flat supply                                   ***             
                                                                                
            ADD   1               TO    WS-LB885-WRT-CTR.                       
            MOVE  SPACES          TO    LB885-PRTREC.                           
            MOVE WS-LB885-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VQ(49:4).                     
            WRITE LB885-PRTREC    FROM  DJDE-LINE-VQ     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LB885-PRTREC.                           
            WRITE LB885-PRTREC AFTER PAGE.                                      
            WRITE LB885-PRTREC    FROM  LB88-LINE01    AFTER 1.                 
            WRITE LB885-PRTREC    FROM  LB88-LINE02.                            
            WRITE LB885-PRTREC    FROM  LB88-LINE03    AFTER 5.                 
            WRITE LB885-PRTREC    FROM  LB88-LINE04.                            
            WRITE LB885-PRTREC    FROM  LB88-LINE05.                            
            WRITE LB885-PRTREC    FROM  LB88-LINE06.                            
            WRITE LB885-PRTREC    FROM  LB88-LINE07.                            
            WRITE LB885-PRTREC    FROM  LB88-LINE08       AFTER 3.              
            WRITE LB885-PRTREC    FROM  LB88-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LB885-PRTREC    FROM  LB88-LINE8A          AFTER 3.           
            WRITE LB885-PRTREC    FROM  LB88-LINE10A-NORM    AFTER 2.           
            WRITE LB885-PRTREC    FROM  LB88-LINE10E-GRO     AFTER 7.           
            WRITE LB885-PRTREC    FROM  LB88-LINE10F-OFR     AFTER 1.           
            WRITE LB885-PRTREC    FROM  LB88-LINE10J-DATE    AFTER 3.           
                                                                                
            MOVE SPACES           TO    LB885-PRTREC                            
                                        DJDE-LINE-VQ(49:4)                      
            IF F740-CDE-ALLOC-SCH = 'GRO' AND F740-NUM-ELDERLY = 'S'            
               WRITE LB885-PRTREC FROM  DJDE-BP13HQ        AFTER PAGE           
            ELSE                                                                
               WRITE LB885-PRTREC FROM  DJDE-BP13V7        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LB885-PRTREC.                           
            WRITE LB885-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LB885-PRTREC.                              
            WRITE LB885-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LB885-PRTREC.                              
            WRITE LB885-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LB885-PRTREC.                              
            WRITE LB885-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LB885-PRTREC.                              
            WRITE LB885-PRTREC    AFTER PAGE.                                   
                                                                                
       6220-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6230-PRT-BP13VX.                                                         
      *=============================================================            
      *** Successful GRO with PA queue positions within beyond ***              
      *** 300% of flat supply - Mature Estates only            ***              
                                                                                
            ADD   1               TO    WS-LB882-WRT-CTR.                       
            MOVE  SPACES          TO    LB882-PRTREC.                           
            MOVE WS-LB882-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VX(49:4).                     
            WRITE LB882-PRTREC    FROM  DJDE-LINE-VX     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LB882-PRTREC.                           
            WRITE LB882-PRTREC AFTER PAGE.                                      
            WRITE LB882-PRTREC    FROM  LB88-LINE01    AFTER 1.                 
            WRITE LB882-PRTREC    FROM  LB88-LINE02.                            
            WRITE LB882-PRTREC    FROM  LB88-LINE03    AFTER 5.                 
            WRITE LB882-PRTREC    FROM  LB88-LINE04.                            
            WRITE LB882-PRTREC    FROM  LB88-LINE05.                            
            WRITE LB882-PRTREC    FROM  LB88-LINE06.                            
            WRITE LB882-PRTREC    FROM  LB88-LINE07.                            
            WRITE LB882-PRTREC    FROM  LB88-LINE08    AFTER 3.                 
            WRITE LB882-PRTREC    FROM  LB88-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LB882-PRTREC    FROM  LB88-LINE8A           AFTER 3.          
            WRITE LB882-PRTREC    FROM  LB88-LINE10A-NORM     AFTER 2.          
            WRITE LB882-PRTREC    FROM  LB88-LINE10J-DATE     AFTER 10.         
                                                                                
            MOVE SPACES           TO    LB882-PRTREC                            
                                        DJDE-LINE-VX(49:4)                      
            WRITE LB882-PRTREC    FROM  DJDE-BP137N        AFTER PAGE.          
            MOVE SPACES           TO    LB882-PRTREC.                           
            WRITE LB882-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LB882-PRTREC.                              
            WRITE LB882-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LB882-PRTREC.                              
            WRITE LB882-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LB882-PRTREC.                              
            WRITE LB882-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LB882-PRTREC.                              
            WRITE LB882-PRTREC    AFTER PAGE.                                   
                                                                                
       6230-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6240-PRT-BP13VW.                                                         
      *=============================================================            
      *** Successful GRO with PA queue positions within beyond ***              
      *** 300% of flat supply - NMEs only                      ***              
                                                                                
            ADD   1               TO    WS-LB883-WRT-CTR.                       
            MOVE  SPACES          TO    LB883-PRTREC.                           
            MOVE WS-LB883-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VW(49:4).                     
            WRITE LB883-PRTREC    FROM  DJDE-LINE-VW     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LB883-PRTREC.                           
            WRITE LB883-PRTREC AFTER PAGE.                                      
            WRITE LB883-PRTREC    FROM  LB88-LINE01    AFTER 1.                 
            WRITE LB883-PRTREC    FROM  LB88-LINE02.                            
            WRITE LB883-PRTREC    FROM  LB88-LINE03    AFTER 5.                 
            WRITE LB883-PRTREC    FROM  LB88-LINE04.                            
            WRITE LB883-PRTREC    FROM  LB88-LINE05.                            
            WRITE LB883-PRTREC    FROM  LB88-LINE06.                            
            WRITE LB883-PRTREC    FROM  LB88-LINE07.                            
            WRITE LB883-PRTREC    FROM  LB88-LINE08    AFTER 3.                 
            WRITE LB883-PRTREC    FROM  LB88-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LB883-PRTREC    FROM  LB88-LINE8A          AFTER 3.           
            WRITE LB883-PRTREC    FROM  LB88-LINE10A-NORM    AFTER 2.           
            WRITE LB883-PRTREC    FROM  LB88-LINE10J-DATE    AFTER 14.          
                                                                                
            MOVE SPACES           TO    LB883-PRTREC                            
                                        DJDE-LINE-VW(49:4)                      
            WRITE LB883-PRTREC    FROM  DJDE-BP137N        AFTER PAGE.          
            MOVE SPACES           TO    LB883-PRTREC.                           
            WRITE LB883-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LB883-PRTREC.                              
            WRITE LB883-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LB883-PRTREC.                              
            WRITE LB883-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LB883-PRTREC.                              
            WRITE LB883-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LB883-PRTREC.                              
            WRITE LB883-PRTREC    AFTER PAGE.                                   
                                                                                
       6240-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6280-PRT-BP13VT.                                                         
      *=============================================================            
      *** Successful GRO with PA queue positions within 201% to ***             
      *** 300% of flat supply                                   ***             
                                                                                
            ADD   1               TO    WS-LB884-WRT-CTR.                       
            MOVE  SPACES          TO    LB884-PRTREC.                           
            MOVE WS-LB884-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-VT(49:4).                     
            WRITE LB884-PRTREC    FROM  DJDE-LINE-VT     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LB884-PRTREC.                           
            WRITE LB884-PRTREC AFTER PAGE.                                      
            WRITE LB884-PRTREC    FROM  LB88-LINE01    AFTER 1.                 
            WRITE LB884-PRTREC    FROM  LB88-LINE02.                            
            WRITE LB884-PRTREC    FROM  LB88-LINE03    AFTER 5.                 
            WRITE LB884-PRTREC    FROM  LB88-LINE04.                            
            WRITE LB884-PRTREC    FROM  LB88-LINE05.                            
            WRITE LB884-PRTREC    FROM  LB88-LINE06.                            
            WRITE LB884-PRTREC    FROM  LB88-LINE07.                            
            WRITE LB884-PRTREC    FROM  LB88-LINE08    AFTER 3.                 
            WRITE LB884-PRTREC    FROM  LB88-LINE11A-BALLOT  AFTER 6.           
                                                                                
            WRITE LB884-PRTREC    FROM  LB88-LINE8A          AFTER 3.           
            WRITE LB884-PRTREC    FROM  LB88-LINE10A-NORM    AFTER 2.           
            WRITE LB884-PRTREC    FROM  LB88-LINE10E-GRO     AFTER 7.           
            WRITE LB884-PRTREC    FROM  LB88-LINE10F-OFR     AFTER 1.           
            WRITE LB884-PRTREC    FROM  LB88-LINE10J-DATE    AFTER 4.           
                                                                                
            MOVE SPACES           TO    LB884-PRTREC                            
                                        DJDE-LINE-VT(49:4)                      
            IF F740-CDE-ALLOC-SCH = 'GRO' AND F740-NUM-ELDERLY = 'S'            
               WRITE LB884-PRTREC FROM  DJDE-BP13HS        AFTER PAGE           
            ELSE                                                                
               WRITE LB884-PRTREC FROM  DJDE-BP13V9        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LB884-PRTREC.                           
            WRITE LB884-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LB884-PRTREC.                              
            WRITE LB884-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LB884-PRTREC.                              
            WRITE LB884-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LB884-PRTREC.                              
            WRITE LB884-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LB884-PRTREC.                              
            WRITE LB884-PRTREC    AFTER PAGE.                                   
                                                                                
       6280-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6500-PRINT-CONTROL-LIST.                                                 
      *=============================================================            
      *    PRINT CONTROL LISTING FOR SUCCESSFUL APPLICANTS                      
      *-------------------------------------------------------------            
                                                                                
           MOVE F740-NUM-REF              TO    LB88A-REF-NO.                   
           MOVE F740-NUM-REGN             TO    LB88A-REGN-NO.                  
           MOVE LB88-NAME                 TO    LB88A-NAME-1.                   
           MOVE F740-NUM-NRIC1            TO    LB88A-NRIC-1.                   
           MOVE F740-CDE-NT1              TO    LB88A-NT1.                      
           MOVE F740-CDE-HOUSEHOLD        TO    LB88A-HHTY.                     
           MOVE F740-NUM-MCPS             TO    LB88A-MCPS.                     
           MOVE F740-CDE-RESIDENT-HA1     TO    LB88A-RES-HA1.                  
           MOVE F740-CDE-FLAT-TYPE        TO    LB88A-FLAT.                     
           MOVE F740-CDE-ALLOC-SCH        TO    LB88A-ALLOC.                    
           MOVE F740-CDE-UNSUCC           TO    LB88A-UNSUCC.                   
           MOVE F740-CDE-CATEGORY         TO    LB88A-CAT.                      
           MOVE F740-CDE-SUCC-NT-ZONE     TO    LB88A-SUCC.                     
           MOVE F740-CDE-ZONE             TO    LB88A-ZONE.                     
           MOVE LB88-NAME2                TO    LB88A-NAME-2.                   
           IF F740-NUM-NRIC2 (2:1) NOT = '#'                                    
              MOVE F740-NUM-NRIC2         TO    LB88A-NRIC-2                    
           ELSE                                                                 
              MOVE SPACES                 TO    LB88A-NRIC-2.                   
           MOVE F740-NUM-NT-FT-QUEUE      TO    LB88A-QUEUE.                    
           MOVE F740-NUM-BALLOT-POSITION  TO    LB88A-BALLOT-POS.               
           MOVE F740-NUM-LOAN-TAG         TO    LB88A-LOAN-TAG.                 
           MOVE F740-CDE-REQUEST-STATUS   TO    LB88A-REQ-STATUS.               
                                                                                
      *-----------> PREPARE ADDRESS FOR BP13LB88A CONTROL LIST                  
           MOVE SPACES                    TO    LB88A-DTL-3.                    
           MOVE LB88-BLK                  TO    LB88A-BLK.                      
           MOVE LB88-UNIT                 TO    LB88A-UNIT.                     
           MOVE LB88-ADDR-L2              TO    LB88A-ADDR2.                    
           MOVE LB88-ADDR-L3              TO    LB88A-ADDR3.                    
           MOVE LB88-ADDR-L3              TO    LB88A-ADDR3.                    
                                                                                
      * BP133380                                                                
           IF F740-CDE-REQUEST-STATUS = 'U'                                     
              PERFORM 6700-PRINT-CONTROL-UNSUCC THRU 6700-EXIT                  
           ELSE                                                                 
              PERFORM 6600-PRINT-CONTROL-SUCC   THRU 6600-EXIT                  
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6600-PRINT-CONTROL-SUCC.                                                 
      **************************************************************            
                                                                                
           MOVE 'P13LB88C'             TO LB88A-LISTING.                        
           STRING 'CONTROL LIST FOR SUCCESSFUL LETTERS W/O EMAIL '              
                  'ADDRESSES (APPLICATION WITHIN 300%)'                         
                  DELIMITED BY SIZE  INTO LB88A-LISTING-TYPE.                   
           ADD    1                    TO    WS-CNT-LETTERS-SUCC.               
           MOVE   WS-CNT-LETTERS-SUCC  TO    LB88A-SERIAL-NO.                   
                                                                                
           IF WS-CNT-LINE-LB88C > WS2-MAX-LINES-LB88C                           
              ADD   1                  TO   WS-CNT-PAGE-LB88C                   
              MOVE  1                  TO   WS-CNT-LINE-LB88C                   
              MOVE  WS-CNT-PAGE-LB88C  TO   LB88A-PAGE                          
              WRITE LB88C-PRTREC       FROM LB88A-HDG1 AFTER PAGE               
                                                                                
              WRITE LB88C-PRTREC       FROM LB88A-HDG2 AFTER 1                  
              WRITE LB88C-PRTREC       FROM LB88A-HDG4 AFTER 2                  
              WRITE LB88C-PRTREC       FROM LB88A-HDG5 AFTER 1                  
              WRITE LB88C-PRTREC       FROM LB88A-HDG6 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LB88C-PRTREC                        
              WRITE LB88C-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   LB88C-PRTREC         FROM  LB88A-DTL-1 AFTER 1.              
           WRITE   LB88C-PRTREC         FROM  LB88A-DTL-2 AFTER 1.              
           WRITE   LB88C-PRTREC         FROM  LB88A-DTL-3 AFTER 1.              
           WRITE   LB88C-PRTREC         FROM  LB88A-DTL-4 AFTER 1.              
           MOVE    SPACES               TO    LB88C-PRTREC.                     
           WRITE   LB88C-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-LB88C.                
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6700-PRINT-CONTROL-UNSUCC.                                               
      **************************************************************            
                                                                                
           MOVE 'P13LB88D'             TO LB88A-LISTING.                        
           STRING 'CONTROL LIST FOR UNSUCCESSFUL LETTERS W/O EMAIL '            
                  'ADDRESSES (APPLICATION BEYOND 300%)'                         
                  DELIMITED BY SIZE  INTO LB88A-LISTING-TYPE.                   
           ADD    1                    TO    WS-CNT-LETTERS-UNSUCC.             
           MOVE   WS-CNT-LETTERS-UNSUCC  TO    LB88A-SERIAL-NO.                 
                                                                                
           IF WS-CNT-LINE-LB88D > WS2-MAX-LINES-LB88D                           
              ADD   1                  TO   WS-CNT-PAGE-LB88D                   
              MOVE  1                  TO   WS-CNT-LINE-LB88D                   
              MOVE  WS-CNT-PAGE-LB88D  TO   LB88A-PAGE                          
              WRITE LB88D-PRTREC       FROM LB88A-HDG1 AFTER PAGE               
                                                                                
              WRITE LB88D-PRTREC       FROM LB88A-HDG2 AFTER 1                  
              WRITE LB88D-PRTREC       FROM LB88A-HDG4 AFTER 2                  
              WRITE LB88D-PRTREC       FROM LB88A-HDG5 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LB88D-PRTREC                        
              WRITE LB88D-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   LB88D-PRTREC         FROM  LB88A-DTL-1 AFTER 1.              
           WRITE   LB88D-PRTREC         FROM  LB88A-DTL-2 AFTER 1.              
           WRITE   LB88D-PRTREC         FROM  LB88A-DTL-3 AFTER 1.              
           MOVE    SPACES               TO    LB88D-PRTREC.                     
           WRITE   LB88D-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-LB88D.                
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7000-CHECK-SCH.                                                          
      **************************************************************            
                                                                                
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
               AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                            
             WHEN F740-CDE-ALLOC-SCH = WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)          
             MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO WS-ALLOCSCH-TYPE.             
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **************************************************************            
       7300-READ-K740.                                                          
      **************************************************************            
                                                                                
           MOVE SPACES                 TO K740-KEY-FLD                          
           MOVE F740-KEY-FLD           TO K740-KEY-FLD                          
           MOVE 'G'                    TO K740-KEY-FLD(28:1)                    
                                                                                
           READ BP13K740                                                        
                                                                                
           EVALUATE WS-K740-STATUS                                              
              WHEN 00                                                           
                 MOVE  K740-NUM-NT-FT-QUEUE TO LB88-QUEUE-NO1-GRO               
                                               LB88-QUEUE-NO2-GRO               
                                               LB88-QUEUE-NO3-GRO               
                                               LB88-QUEUE-NO4-GRO               
                                               LB88-QUEUE-NO5-GRO               
              WHEN 23                                                           
                 DISPLAY 'KEY NOT FOUND' K740-KEY-FLD                           
              WHEN OTHER                                                        
                   MOVE WS-K740-STATUS TO RETURN-CODE                           
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       7300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13CB88 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F740 RECORDS READ          : ' WS-F740-READ-CTR.           
           DISPLAY ' 50%  NON-MAT & MAT (BP13VM): ' WS-LB88M-WRT-CTR.           
           DISPLAY ' 100% NON-MAT & MAT (BP13VO): ' WS-LB886-WRT-CTR.           
           DISPLAY ' 200% NON-MAT & MAT (BP13VQ): ' WS-LB885-WRT-CTR.           
           DISPLAY ' 300% NON-MAT & MAT (BP13VT): ' WS-LB884-WRT-CTR.           
           DISPLAY ' >300% NON-MAT      (BP13VW): ' WS-LB883-WRT-CTR.           
           DISPLAY ' >300% MAT          (BP13VX): ' WS-LB882-WRT-CTR.           
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13F740                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 BP13K813                                                       
                 BP13K740                                                       
                 P13LB88C                                                       
                 P13LB88D                                                       
                 P13LB88M                                                       
                 P13LB882                                                       
                 P13LB883                                                       
                 P13LB884                                                       
                 P13LB885                                                       
                 P13LB886.                                                      
                                                                                
           IF WS-K825-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K825-STAT ' WS-K825-STATUS.            
                                                                                
           IF WS-K830-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS.            
                                                                                
           IF WS-K813-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K813-STAT ' WS-K813-STATUS.            
                                                                                
           IF WS-K740-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K740-STAT ' WS-K740-STATUS.            
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
