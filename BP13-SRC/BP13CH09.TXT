       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CH09                                                  
       AUTHOR.        MICHAEL ARRIOLA.                                          
      *DATE-WRITTEN.  13/08/2008.                                               
      * =========================================================== *           
      *              SYSTEM OF COMMITMENT (BP13)                    *           
      * =========================================================== *           
      *   OBJECTIVE  :  GEN RPT ON APPLN/REGN (NOT) ABLE TO BOOKED  *           
      *                                                             *           
      *   INPUT      :  BP13F800 -- SEQUENTIAL FILE                 *           
      *                 BP13K268 --     BOOKED REGN                 *           
      *                 BP13KH15 -- NOT BOOKED REGN                 *           
      *                 BP13KH10 -- NOT BOOKED NRIC                 *           
      *                 BP13K595 -- LOG FILE OF BOOK STATUS         *           
      *   OUTPUT     :  P13LH09A -- REPORT ON NOT BOOKED CASES(BTO) *           
      *                 P13LH09B -- REPORT ON BOOKED CASES(BTO)     *           
      *                 P13LH09C -- REPORT ON NOT BOOKED CASES(SBF) *           
      *                 P13LH09D -- REPORT ON BOOKED CASES(SBF)     *           
      *                                                             *           
      *   AMENDMENTS:                                               *           
      *    REF      DATE     BY          DESCRIPTIONS               *           
      * -------- ---------- ---- ---------------------------------- *           
      * BP133367 13/08/2008 MSD1 NEW PROGRAM                        *           
      * BP133367 01/04/2009 JB8  TO USE BALLOT-HOUSEHOLD INSTEAD OF *           
      *                          NUM-HOUSEHOLD                      *           
      * BP135039 12/09/2013 IMC1 ADD BALLOT HH, ALLO SCH, FT2T      *           
      * BP135089 04/10/2013 IMC1 MOVE SELN CNT BASED ON HH TYPE     *           
      * BP135474 25/07/2014 IMC1 ADD FLAT TYPE TO REPORT            *           
      * BP136160 16/03/2016 FNP1 CATER FOR BALLOT HH = 'N' AND 'STS'*           
      * BP136888 20/06/2017 FNP1 CATER FOR SAP CASES                *           
      * BP137281 17/05/2018 FNP1 ADD CHECKING OF ELIG SCH FOR SAP   *           
      * BP138148 06/10/2020 KR13 CATER FOR ELIG-SCH 'PAC'           *           
      * BP139545 02/11/2023 SC45 POLICY CHANGE STARTING FROM 202310 *           
      * =========================================================== *           
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F800  ASSIGN        TO BP13F800.                          
           SELECT BP13KH10  ASSIGN        TO BP13KH10                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KH10-KEY-FLD                       
                            FILE STATUS   IS BP13KH10-STATUS.                   
           SELECT BP13K595  ASSIGN        TO BP13K595                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K595-KEY-FLD                       
                            FILE STATUS   IS BP13K595-STATUS.                   
           SELECT BP13KH15  ASSIGN        TO BP13KH15                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KH15-KEY-FLD                       
                            ALTERNATE KEY IS KH15-ALT-KEY                       
                            FILE STATUS   IS BP13KH15-STATUS.                   
           SELECT BP13K268  ASSIGN        TO BP13K268                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K268-KEY-FLD                       
                            ALTERNATE KEY IS K268-NUM-REGN                      
                            FILE STATUS   IS BP13K268-STATUS.                   
           SELECT P13LH09A  ASSIGN        TO P13LH09A.                          
           SELECT P13LH09B  ASSIGN        TO P13LH09B.                          
                                                                                
      ** CR - BP139545 START                                                    
           SELECT P13LH09C  ASSIGN        TO P13LH09C.                          
           SELECT P13LH09D  ASSIGN        TO P13LH09D.                          
      ** CR - BP139545 END.                                                     
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
       FD  BP13F800       BLOCK  CONTAINS 0 RECORDS                             
                          RECORD CONTAINS 2000 CHARACTERS                       
                          LABEL RECORDS ARE STANDARD                            
                          RECORDING MODE IS F.                                  
       COPY BP13F800.                                                           
                                                                                
       FD   BP13KH10                                                            
            RECORD CONTAINS  2000 CHARACTERS.                                   
       COPY BP13KH10.                                                           
                                                                                
       FD   BP13K595                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K595.                                                           
                                                                                
       FD   BP13KH15                                                            
            RECORD CONTAINS  200 CHARACTERS.                                    
       COPY BP13KH15.                                                           
                                                                                
       FD  BP13K268                                                             
           RECORD CONTAINS 200 CHARACTERS.                                      
       COPY BP13K268.                                                           
                                                                                
       FD   P13LH09A                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F.                                                
       01   P13LH09A-REC           PIC X(132).                                  
                                                                                
       FD   P13LH09B                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F.                                                
       01   P13LH09B-REC           PIC X(132).                                  
                                                                                
      ** CR - BP139545 START                                                    
                                                                                
       FD   P13LH09C                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F.                                                
       01   P13LH09C-REC           PIC X(132).                                  
                                                                                
       FD   P13LH09D                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F.                                                
       01   P13LH09D-REC           PIC X(132).                                  
                                                                                
      ** CR - BP139545 END.                                                     
                                                                                
       WORKING-STORAGE SECTION.                                                 
       01 WS-FILE-STATUS.                                                       
          05 BP13K268-STATUS       PIC 9(02)   VALUE ZEROES.                    
          05 BP13KH15-STATUS       PIC 9(02)   VALUE ZEROES.                    
          05 BP13K595-STATUS       PIC 9(02)   VALUE ZEROES.                    
          05 BP13KH10-STATUS       PIC 9(02)   VALUE ZEROES.                    
                                                                                
       01 WS-COUNTERS.                                                          
          05 WS-H09A-SNO           PIC 9(03)   VALUE ZEROES.                    
          05 WS-H09B-SNO           PIC 9(03)   VALUE ZEROES.                    
          05 WS-F800-READ          PIC 9(08)   VALUE ZEROES.                    
          05 WS-H09A-WRITE         PIC 9(08)   VALUE ZEROES.                    
          05 WS-H09B-WRITE         PIC 9(08)   VALUE ZEROES.                    
          05 WS-H09A-PAGECTR       PIC 9(05)   VALUE ZEROES.                    
          05 WS-H09B-PAGECTR       PIC 9(05)   VALUE ZEROES.                    
          05 WS-H09A-LINECTR       PIC 9(02)   VALUE 60.                        
          05 WS-H09B-LINECTR       PIC 9(02)   VALUE 60.                        
                                                                                
      ** CR - BP139545 START                                                    
          05 WS-H09C-SNO           PIC 9(03)   VALUE ZEROES.                    
          05 WS-H09D-SNO           PIC 9(03)   VALUE ZEROES.                    
          05 WS-H09C-WRITE         PIC 9(08)   VALUE ZEROES.                    
          05 WS-H09D-WRITE         PIC 9(08)   VALUE ZEROES.                    
          05 WS-H09C-PAGECTR       PIC 9(05)   VALUE ZEROES.                    
          05 WS-H09D-PAGECTR       PIC 9(05)   VALUE ZEROES.                    
          05 WS-H09C-LINECTR       PIC 9(02)   VALUE 60.                        
          05 WS-H09D-LINECTR       PIC 9(02)   VALUE 60.                        
      ** CR - BP139545 END.                                                     
                                                                                
       01 WS-VARIABLES.                                                         
          05 WS-SUB                PIC 9(02)   VALUE ZEROES.                    
          05 WS-NUM-UIN            PIC X(09)   VALUE SPACES.                    
          05 WS-DTE-BALLOT         PIC X(06)   VALUE SPACES.                    
          05 WS-ALLO-CAT           PIC X(03)   VALUE SPACES.                    
                                                                                
          05 WS-KH10-CNT           PIC 9(02)   VALUE ZEROES.                    
          05 WS-KH10-REC OCCURS 15 TIMES.                                       
             10 WS-KH10-UIN        PIC X(09).                                   
             10 WS-KH10-NS-CNT     PIC X(02).                                   
             10 WS-KH10-REGN       PIC X(08).                                   
             10 WS-KH10-LIMIT      PIC X(06).                                   
                                                                                
      ** CR - BP139545 START                                                    
             10 WS-KH10-FTPMC      PIC X(01).                                   
      ** CR - BP139545 END.                                                     
                                                                                
          05 WS-CDE-HH             PIC X(01)   VALUE SPACE.                     
                                                                                
       01 WS-SWITCHES.                                                          
          05 WS-KH15-FND           PIC X       VALUE 'N'.                       
          05 WS-K268-FND           PIC X       VALUE 'N'.                       
          05 WS-K595-FND           PIC X       VALUE 'N'.                       
          05 WS-END-OF-TABLE       PIC X       VALUE 'N'.                       
             88 END-OF-TABLE                   VALUE 'Y'.                       
                                                                                
       01 WS-TIME-DATES.                                                        
          05 WS-SYSTEM-DATE.                                                    
             10 WS-SYS-CCYY.                                                    
                15 WS-SYS-CC       PIC 9(2).                                    
                15 WS-SYS-YY       PIC 9(2).                                    
             10 WS-SYS-MM          PIC 9(2).                                    
             10 WS-SYS-DD          PIC 9(2).                                    
          05 WS-EDITED-DATE.                                                    
             10 WS-EDITED-DD       PIC X(2)    VALUE SPACES.                    
             10 FILLER             PIC X       VALUE '/'.                       
             10 WS-EDITED-MM       PIC X(2)    VALUE SPACES.                    
             10 FILLER             PIC X       VALUE '/'.                       
             10 WS-EDITED-YY       PIC X(4)    VALUE SPACES.                    
                                                                                
      *============================================================*            
      *         P13LH09A -   R E P O R T    L A Y O U T            *            
      *============================================================*            
                                                                                
       01  H09A-HEADER-01.                                                      
           05  FILLER              PIC X(08)     VALUE 'P13LH09A'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  H09A-RUN-DATE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  H09A-PAGE-NO        PIC ZZZZ9.                                   
                                                                                
       01  H09A-HEADER-02.                                                      
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  FILLER              PIC X(51)     VALUE                          
               'DAILY REPORT ON NOT BOOKED CASES AS PER APPOINTMENT'.           
                                                                                
       01  H09A-HEADER-2A.                                                      
           05  FILLER              PIC X(15)     VALUE 'DATE BALLOT :'.         
           05  H09A-DTE-BALLOT     PIC X(07).                                   
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'MODE :'.                
           05  H09A-MODE           PIC X(03)     VALUE SPACES.                  
                                                                                
       01  H09A-HEADER-03.                                                      
           05  FILLER              PIC X(03)     VALUE 'SNO'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'REGN-NO'.               
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'NT'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'Q-NO'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'CAT/AS/F2T'.            
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'HH'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'BALLOT'.                
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'BK'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'ALC'.                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE 'QUOTA/UNIT '.           
           05  FILLER              PIC X(09)     VALUE 'AVAILABLE'.             
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(13)     VALUE 'NON-SELECTION'.         
                                                                                
      ** CR - BP139545 START                                                    
      *    05  FILLER              PIC X(07)     VALUE SPACES.                  
      *    05  FILLER              PIC X(05)     VALUE 'LIMIT'.                 
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'LMT'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
      ** CR - BP139545 END                                                      
                                                                                
       01  H09A-HEADER-3A.                                                      
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'DATE'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'TIME'.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'BHH'.                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'STAT'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'ST'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'TAG'.                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q1   U1'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q2   U2'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q3   U3'.               
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'UIN'.                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE 'COUNT'.                 
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'REGN'.                  
      ** CR - BP139545 START                                                    
      *    05  FILLER              PIC X(04)     VALUE SPACES.                  
      *    05  FILLER              PIC X(05)     VALUE '> 5% '.                 
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'PMC'.                   
      ** CR - BP139545 END                                                      
                                                                                
       01  H09A-DETAILS.                                                        
           05  H09A-SNO            PIC X(03).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-REGNO          PIC X(08).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-FT             PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-NT             PIC X(03).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09A-QNO            PIC X(05).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-CAT            PIC X(01).                                   
           05  H09A-SLASH1         PIC X(01)     VALUE '/'.                     
           05  H09A-ALLO-SCH       PIC X(03)     VALUE SPACES.                  
           05  H09A-SLASH2         PIC X(01)     VALUE '/'.                     
           05  H09A-FT2T           PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09A-DTE-BK         PIC X(08).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-TME-BK         PIC X(05).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-HHTYP          PIC X(01).                                   
           05  H09A-SLASH3         PIC X(01)     VALUE '/'.                     
           05  H09A-BHH            PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09A-BALOT-STAT     PIC X(01).                                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  H09A-BOOK-STAT      PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-ALLOC-TAG      PIC X(02).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09A-QUOTA1         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-UNIT1          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-QUOTA2         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-UNIT2          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-QUOTA3         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-UNIT3          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09A-NS-UIN         PIC X(09).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  H09A-NS-CNT         PIC X(02).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  H09A-NS-REGN        PIC X(08).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09A-NS-LIMIT       PIC X(01).                                   
      ** CR - BP139545 START                                                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09A-NS-FTPMC       PIC X(01).                                   
      ** CR - BP139545 END.                                                     
                                                                                
      *============================================================*            
      *         P13LH09B -   R E P O R T    L A Y O U T            *            
      *============================================================*            
                                                                                
       01  H09B-HEADER-01.                                                      
           05  FILLER              PIC X(08)     VALUE 'P13LH09B'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  H09B-RUN-DATE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  H09B-PAGE-NO        PIC ZZZZ9.                                   
                                                                                
       01  H09B-HEADER-02.                                                      
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(47)     VALUE                          
               'DAILY REPORT ON BOOKED CASES AS PER APPOINTMENT'.               
                                                                                
       01  H09B-HEADER-2A.                                                      
           05  FILLER              PIC X(14)     VALUE 'DATE BALLOT :'.         
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-DTE-BALLOT     PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'MODE :'.                
           05  H09B-MODE           PIC X(03)     VALUE SPACES.                  
                                                                                
       01  H09B-HEADER-03.                                                      
           05  FILLER              PIC X(03)     VALUE 'SNO'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'REGN-NO'.               
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'NT'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'Q-NO'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'CAT'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'SCHEME ACC'.            
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'HH'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'BALLOT'.                
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'BK'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'ALC'.                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE 'QUOTA/UNIT '.           
           05  FILLER              PIC X(09)     VALUE 'AVAILABLE'.             
      ** CR - BP139545 START                                                    
      *    05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
      ** CR - BP139545 END                                                      
                                                                                
                                                                                
       01  H09B-HEADER-3A.                                                      
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(30)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'DATE'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'TIME'.                  
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'STAT'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'ST'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'TAG'.                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q1   U1'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q2   U2'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q3   U3'.               
      ** CR - BP139545 START                                                    
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'PMC'.                   
      ** CR - BP139545 END                                                      
                                                                                
       01  H09B-DETAILS.                                                        
           05  H09B-SNO            PIC X(03).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09B-REGNO          PIC X(08).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-FT             PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-NT             PIC X(03).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09B-QNO            PIC X(05).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09B-CAT            PIC X(01).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09B-SCHACC         PIC X(11).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  H09B-DTE-BK         PIC X(10).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-TME-BK         PIC X(05).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09B-HHTYP          PIC X(01).                                   
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  H09B-BALOT-STAT     PIC X(01).                                   
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  H09B-BOOK-STAT      PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-ALLOC-TAG      PIC X(02).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09B-QUOTA1         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-UNIT1          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-QUOTA2         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-UNIT2          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-QUOTA3         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-UNIT3          PIC ZZZ9 BLANK WHEN ZEROES.                  
                                                                                
      ** CR -BP139545 START                                                     
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09B-FTPMC          PIC X(01)     VALUE SPACES.                  
                                                                                
      *============================================================*            
      *         P13LH09C -   R E P O R T    L A Y O U T            *            
      *============================================================*            
                                                                                
       01  H09C-HEADER-01.                                                      
           05  FILLER              PIC X(08)     VALUE 'P13LH09C'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  H09C-RUN-DATE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  H09C-PAGE-NO        PIC ZZZZ9.                                   
                                                                                
       01  H09C-HEADER-02.                                                      
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  FILLER              PIC X(51)     VALUE                          
               'DAILY REPORT ON NOT BOOKED CASES AS PER APPOINTMENT'.           
                                                                                
       01  H09C-HEADER-2A.                                                      
           05  FILLER              PIC X(15)     VALUE 'DATE BALLOT :'.         
           05  H09C-DTE-BALLOT     PIC X(07).                                   
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'MODE :'.                
           05  H09C-MODE           PIC X(03)     VALUE SPACES.                  
                                                                                
       01  H09C-HEADER-03.                                                      
           05  FILLER              PIC X(03)     VALUE 'SNO'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'REGN-NO'.               
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'NT'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'Q-NO'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'CAT/AS/F2T'.            
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'HH'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'BALLOT'.                
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'BK'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'ALC'.                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE 'QUOTA/UNIT '.           
           05  FILLER              PIC X(09)     VALUE 'AVAILABLE'.             
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(13)     VALUE 'NON-SELECTION'.         
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'LMT'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
                                                                                
       01  H09C-HEADER-3A.                                                      
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'DATE'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'TIME'.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'BHH'.                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'STAT'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'ST'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'TAG'.                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q1   U1'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q2   U2'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q3   U3'.               
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'UIN'.                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE 'COUNT'.                 
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'REGN'.                  
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'PMC'.                   
                                                                                
       01  H09C-DETAILS.                                                        
           05  H09C-SNO            PIC X(03).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-REGNO          PIC X(08).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-FT             PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-NT             PIC X(03).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09C-QNO            PIC X(05).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-CAT            PIC X(01).                                   
           05  H09C-SLASH1         PIC X(01)     VALUE '/'.                     
           05  H09C-ALLO-SCH       PIC X(03)     VALUE SPACES.                  
           05  H09C-SLASH2         PIC X(01)     VALUE '/'.                     
           05  H09C-FT2T           PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09C-DTE-BK         PIC X(08).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-TME-BK         PIC X(05).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-HHTYP          PIC X(01).                                   
           05  H09C-SLASH3         PIC X(01)     VALUE '/'.                     
           05  H09C-BHH            PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09C-BALOT-STAT     PIC X(01).                                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  H09C-BOOK-STAT      PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-ALLOC-TAG      PIC X(02).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09C-QUOTA1         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-UNIT1          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-QUOTA2         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-UNIT2          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-QUOTA3         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-UNIT3          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09C-NS-UIN         PIC X(09).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  H09C-NS-CNT         PIC X(02).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  H09C-NS-REGN        PIC X(08).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09C-NS-LIMIT       PIC X(01).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09C-NS-FTPMC       PIC X(01).                                   
                                                                                
      *============================================================*            
      *         P13LH09D -   R E P O R T    L A Y O U T            *            
      *============================================================*            
                                                                                
       01  H09D-HEADER-01.                                                      
           05  FILLER              PIC X(08)     VALUE 'P13LH09D'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  H09D-RUN-DATE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  H09D-PAGE-NO        PIC ZZZZ9.                                   
                                                                                
       01  H09D-HEADER-02.                                                      
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(47)     VALUE                          
               'DAILY REPORT ON BOOKED CASES AS PER APPOINTMENT'.               
                                                                                
       01  H09D-HEADER-2A.                                                      
           05  FILLER              PIC X(14)     VALUE 'DATE BALLOT :'.         
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-DTE-BALLOT     PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'MODE :'.                
           05  H09D-MODE           PIC X(03)     VALUE SPACES.                  
                                                                                
       01  H09D-HEADER-03.                                                      
           05  FILLER              PIC X(03)     VALUE 'SNO'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'REGN-NO'.               
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'NT'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'Q-NO'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'CAT'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'SCHEME ACC'.            
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'BOOK'.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'HH'.                    
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'BALLOT'.                
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'BK'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'ALC'.                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE 'QUOTA/UNIT '.           
           05  FILLER              PIC X(09)     VALUE 'AVAILABLE'.             
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'FT'.                    
                                                                                
       01  H09D-HEADER-3A.                                                      
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(30)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'DATE'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'TIME'.                  
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'STAT'.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'ST'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'TAG'.                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q1   U1'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q2   U2'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'Q3   U3'.               
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'PMC'.                   
                                                                                
       01  H09D-DETAILS.                                                        
           05  H09D-SNO            PIC X(03).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09D-REGNO          PIC X(08).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-FT             PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-NT             PIC X(03).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09D-QNO            PIC X(05).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09D-CAT            PIC X(01).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09D-SCHACC         PIC X(11).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  H09D-DTE-BK         PIC X(10).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-TME-BK         PIC X(05).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09D-HHTYP          PIC X(01).                                   
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  H09D-BALOT-STAT     PIC X(01).                                   
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  H09D-BOOK-STAT      PIC X(02).                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-ALLOC-TAG      PIC X(02).                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  H09D-QUOTA1         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-UNIT1          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-QUOTA2         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-UNIT2          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-QUOTA3         PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-UNIT3          PIC ZZZ9 BLANK WHEN ZEROES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  H09D-FTPMC          PIC X(01)     VALUE SPACES.                  
                                                                                
      ** CR - BP139545 END.                                                     
                                                                                
       01  DASH-LINE.                                                           
      ** CR - BP139545 START                                                    
      *    05  FILLER              PIC X(130)    VALUE ALL '-'.                 
           05  FILLER              PIC X(132)    VALUE ALL '-'.                 
      ** CR - BP139545 END.                                                     
                                                                                
      ****************************************************************          
       PROCEDURE DIVISION.                                                      
      ****************************************************************          
       0000-MAIN-ROUTINE.                                                       
      ****************************************************************          
                                                                                
           PERFORM 1000-OPEN-ROUTINE  THRU 1000-EXIT.                           
           PERFORM 2000-READ-F800     THRU 2000-EXIT.                           
           PERFORM 3000-PROCESS       THRU 3000-EXIT                            
              UNTIL F800-NUM-REGN = HIGH-VALUES.                                
           PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       1000-OPEN-ROUTINE.                                                       
      ****************************************************************          
                                                                                
           OPEN INPUT  BP13F800                                                 
                       BP13K268                                                 
                       BP13KH10                                                 
                       BP13KH15                                                 
                       BP13K595                                                 
                OUTPUT P13LH09A                                                 
      ** CR - BP139545 START                                                    
                       P13LH09C                                                 
                       P13LH09D                                                 
      ** CR - BP139545 END.                                                     
                       P13LH09B.                                                
                                                                                
           IF BP13KH10-STATUS  NOT =  00 AND 97                                 
              DISPLAY 'ERROR OPENING - BP13KH10 : ' BP13KH10-STATUS             
              MOVE     BP13KH10-STATUS      TO RETURN-CODE                      
              PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT.                       
           IF BP13K595-STATUS  NOT = 00 AND 97                                  
              DISPLAY 'ERROR OPENING - BP13K595 : ' BP13K595-STATUS             
              MOVE     BP13K595-STATUS      TO RETURN-CODE                      
              PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT.                       
           IF BP13K268-STATUS  NOT =  00 AND 97                                 
              DISPLAY 'ERROR OPENING - BP13K268 : ' BP13K268-STATUS             
              MOVE     BP13K268-STATUS      TO RETURN-CODE                      
              PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT.                       
           IF BP13KH15-STATUS  NOT =  00 AND 97                                 
              DISPLAY 'ERROR OPENING - BP13KH15 : ' BP13KH15-STATUS             
              MOVE     BP13KH15-STATUS      TO RETURN-CODE                      
              PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT.                       
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO WS-SYSTEM-DATE.                  
           MOVE WS-SYS-DD                   TO WS-EDITED-DD.                    
           MOVE WS-SYS-MM                   TO WS-EDITED-MM.                    
           MOVE WS-SYS-CCYY                 TO WS-EDITED-YY.                    
           MOVE WS-EDITED-DATE              TO H09A-RUN-DATE                    
      ** CR - BP139545 START                                                    
                                               H09C-RUN-DATE                    
                                               H09D-RUN-DATE                    
      ** CR - BP139545 END.                                                     
                                               H09B-RUN-DATE.                   
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       2000-READ-F800.                                                          
      *****************************************************************         
                                                                                
           READ BP13F800 AT END MOVE                                            
                HIGH-VALUES TO F800-NUM-REGN                                    
                GO TO 2000-EXIT.                                                
                                                                                
            ADD 1 TO WS-F800-READ.                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3000-PROCESS.                                                            
      *****************************************************************         
                                                                                
           MOVE SPACES                     TO H09A-DETAILS                      
      ** CR - BP139545 START                                                    
                                              H09C-DETAILS                      
                                              H09D-DETAILS                      
      ** CR - BP139545 END.                                                     
                                              H09B-DETAILS.                     
                                                                                
           IF F800-CDE-BALLOT-HOUSEHOLD = SPACES OR LOW-VALUES                  
              MOVE F800-NUM-HOUSEHOLD        TO WS-CDE-HH                       
           ELSE                                                                 
              MOVE F800-CDE-BALLOT-HOUSEHOLD TO WS-CDE-HH                       
           END-IF.                                                              
                                                                                
           PERFORM 4000-PROCESS-K595       THRU 4000-EXIT                       
                                                                                
           IF F800-NUM-SCH-ACC = SPACES    OR LOW-VALUES                        
              PERFORM 5000-READ-KH15       THRU 5000-EXIT                       
              IF WS-KH15-FND = 'Y'                                              
                 MOVE KH15-NUM-BOOK-STATUS TO H09A-BOOK-STAT                    
                                              H09B-BOOK-STAT                    
                                                                                
      ** CR - BP139545 START                                                    
                                              H09C-BOOK-STAT                    
                                              H09D-BOOK-STAT                    
      ** CR - BP139545 END.                                                     
                                                                                
                 PERFORM 6000-PROCESS-KH10 THRU 6000-EXIT                       
                                                                                
      ** CR - BP139545 START                                                    
                 IF F800-NUM-ALLO-CAT = 'BTO'                                   
                    PERFORM 8000-PRINT-H09A   THRU 8000-EXIT                    
                 ELSE                                                           
                    PERFORM 8010-PRINT-H09C   THRU 8010-EXIT                    
                 END-IF                                                         
      ** CR - BP139545 END.                                                     
                                                                                
              END-IF                                                            
           ELSE                                                                 
              PERFORM 7000-READ-K268       THRU 7000-EXIT                       
              IF WS-K268-FND = 'Y'                                              
      ** CR - BP139545 START                                                    
                 IF F800-NUM-ALLO-CAT = 'BTO'                                   
                    PERFORM 8050-PRINT-H09B   THRU 8050-EXIT                    
                 ELSE                                                           
                    PERFORM 8060-PRINT-H09D   THRU 8060-EXIT                    
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
      ** CR - BP139545 END.                                                     
                                                                                
           PERFORM 2000-READ-F800          THRU 2000-EXIT.                      
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4000-PROCESS-K595.                                                       
      *****************************************************************         
                                                                                
           MOVE 'N'             TO WS-K595-FND.                                 
           MOVE '**'            TO H09A-BOOK-STAT                               
                                   H09B-BOOK-STAT                               
                                                                                
           MOVE SPACES          TO K595-KEY-FLD.                                
           MOVE F800-NUM-REGN   TO K595-NUM-REGN-REF.                           
                                                                                
           START BP13K595 KEY >= K595-KEY-FLD.                                  
           EVALUATE BP13K595-STATUS                                             
           WHEN 00                                                              
                PERFORM 4100-READNEXT-BP13K595 THRU 4100-EXIT                   
                   UNTIL K595-NUM-REGN-REF NOT = F800-NUM-REGN                  
                      OR K595-NUM-REGN-REF = HIGH-VALUES                        
           WHEN 10                                                              
           WHEN 23                                                              
                DISPLAY 'BP13K595 RECORD NOT FOUND  = ' K595-KEY-FLD            
           WHEN OTHER                                                           
                DISPLAY 'ERROR START BP13K595, STATUS ' BP13K595-STATUS         
                        ',  REGN ' K595-NUM-REGN-REF                            
                MOVE BP13K595-STATUS         TO RETURN-CODE                     
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4100-READNEXT-BP13K595.                                                  
           READ BP13K595 NEXT RECORD                                            
                     AT END MOVE HIGH-VALUES TO K595-NUM-REGN-REF.              
                                                                                
           EVALUATE BP13K595-STATUS                                             
           WHEN 00                                                              
           WHEN 02                                                              
                IF K595-NUM-REGN-REF = F800-NUM-REGN                            
                   MOVE 'Y'                  TO WS-K595-FND                     
      *            MOVE K595-NUM-BOOK-STATUS TO H09A-BOOK-STAT                  
      *                                         H09B-BOOK-STAT                  
                ELSE                                                            
                   MOVE HIGH-VALUES          TO K595-NUM-REGN-REF               
                END-IF                                                          
           WHEN 10                                                              
           WHEN 23                                                              
                MOVE HIGH-VALUES             TO K595-NUM-REGN-REF               
           WHEN OTHER                                                           
                DISPLAY 'ERROR READING BP13K595, STATUS '                       
                        BP13K595-STATUS ',  REGN ' K595-NUM-REGN-REF            
                MOVE BP13K595-STATUS         TO RETURN-CODE                     
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5000-READ-KH15.                                                          
      *****************************************************************         
                                                                                
           MOVE 'N'           TO WS-KH15-FND.                                   
                                                                                
           MOVE F800-NUM-REGN TO KH15-NUM-REGN.                                 
           READ BP13KH15  KEY IS KH15-ALT-KEY.                                  
                                                                                
           EVALUATE BP13KH15-STATUS                                             
             WHEN 00                                                            
             WHEN 02                                                            
                MOVE 'Y'                  TO WS-KH15-FND                        
             WHEN 23                                                            
                DISPLAY 'REC NOT FOUND IN BP13KH15'                             
                      ', KH15-NUM-REGN: ' KH15-NUM-REGN                         
             WHEN OTHER                                                         
                DISPLAY 'BP13KH15 READ ERROR,STATUS : ' BP13KH15-STATUS         
                      ', KH15 KEY FLD : ' KH15-KEY-FLD                          
                      ', KH15 ALT KEY : ' KH15-ALT-KEY                          
                MOVE BP13KH15-STATUS       TO RETURN-CODE                       
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6000-PROCESS-KH10.                                                       
      *****************************************************************         
                                                                                
           MOVE ZEROES                   TO WS-KH10-CNT                         
           PERFORM VARYING WS-SUB FROM 01 BY 1 UNTIL WS-SUB > 15                
              MOVE SPACES                TO WS-KH10-REC(WS-SUB)                 
           END-PERFORM.                                                         
                                                                                
           IF F800-NUM-NRIC1 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC1        TO WS-NUM-UIN                          
              PERFORM 6100-READ-BP13KH10 THRU 6100-EXIT.                        
                                                                                
           IF F800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC2        TO WS-NUM-UIN                          
              PERFORM 6100-READ-BP13KH10 THRU 6100-EXIT.                        
                                                                                
           IF F800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC3        TO WS-NUM-UIN                          
              PERFORM 6100-READ-BP13KH10 THRU 6100-EXIT.                        
                                                                                
           IF F800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES                        
              MOVE F800-NUM-NRIC4        TO WS-NUM-UIN                          
              PERFORM 6100-READ-BP13KH10 THRU 6100-EXIT.                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       6100-READ-BP13KH10.                                                      
           MOVE WS-NUM-UIN         TO KH10-NUM-UIN.                             
                                                                                
           READ BP13KH10.                                                       
           EVALUATE BP13KH10-STATUS                                             
             WHEN 00                                                            
                MOVE  'N'          TO WS-END-OF-TABLE                           
                PERFORM 6200-CHECK-BP13KH10 THRU 6200-EXIT                      
                   VARYING WS-SUB FROM 01 BY 1                                  
                     UNTIL END-OF-TABLE OR WS-SUB > 15                          
             WHEN 23                                                            
                DISPLAY 'REC NOT FOUND IN BP13KH10'                             
                      ', KH10-NUM-UIN: ' KH10-NUM-UIN                           
             WHEN OTHER                                                         
                DISPLAY 'BP13KH10 READ ERROR,STATUS : ' BP13KH10-STATUS         
                      ', KH10 KEY FLD : ' KH10-KEY-FLD                          
                MOVE BP13KH10-STATUS       TO RETURN-CODE                       
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       6200-CHECK-BP13KH10.                                                     
           IF KH10-NUM-REGN (WS-SUB) =  SPACES OR LOW-VALUES                    
              SET END-OF-TABLE TO TRUE                                          
              GO TO 6200-EXIT.                                                  
                                                                                
           IF KH10-NUM-REGN (WS-SUB) =  F800-NUM-REGN                           
             ADD 1                       TO WS-KH10-CNT                         
             MOVE KH10-NUM-UIN           TO WS-KH10-UIN   (WS-KH10-CNT)         
             MOVE KH10-NUM-REGN (WS-SUB) TO WS-KH10-REGN  (WS-KH10-CNT)         
             MOVE KH10-NUM-WITHIN-LIMIT (WS-SUB)                                
                                         TO WS-KH10-LIMIT (WS-KH10-CNT)         
                                                                                
      ** CR - BP139545 START                                                    
             MOVE KH10-NUM-FTPMC(WS-SUB) TO WS-KH10-FTPMC(WS-KH10-CNT)          
      ** CR - BP139545 END.                                                     
                                                                                
             IF KH10-NUM-HOUSEHOLD(WS-SUB) = 'H' OR 'T'                         
                MOVE 'H'   TO KH10-NUM-HOUSEHOLD(WS-SUB)                        
             END-IF                                                             
                                                                                
             IF KH10-NUM-BALLOT-HOUSEHOLD(WS-SUB)    = 'H' OR 'T'               
                MOVE 'H'   TO KH10-NUM-BALLOT-HOUSEHOLD(WS-SUB)                 
             END-IF                                                             
                                                                                
             IF KH10-NUM-FT2T(WS-SUB) = SPACES OR LOW-VALUES                    
                MOVE F800-NUM-FT2T       TO KH10-NUM-FT2T(WS-SUB)               
             END-IF                                                             
                                                                                
             EVALUATE TRUE                                                      
             WHEN  (KH10-NUM-ALLOC-SCHEME(WS-SUB)  = 'FTS' OR 'STS') OR         
                   ((KH10-NUM-ALLOC-SCHEME(WS-SUB) = 'SAP') AND                 
                   (F800-NUM-ELIG-SCHEME = 'SSC' OR 'JSS' OR 'NCS' OR           
                                           'SSE' OR 'JSE' OR 'NSE'))            
             WHEN  (KH10-NUM-ALLOC-SCHEME(WS-SUB) = 'PA ' AND                   
                    F800-NUM-ELIG-SCHEME = 'PAC')                               
                   MOVE KH10-NUM-NON-SELN-FTS                                   
                     TO WS-KH10-NS-CNT(WS-KH10-CNT)                             
                                                                                
             WHEN  KH10-NUM-HOUSEHOLD(WS-SUB)             = 'H' AND             
                   KH10-NUM-BALLOT-HOUSEHOLD(WS-SUB)      = 'H'                 
                                                                                
      ** CR - BP139545 START                                                    
                   IF KH10-NUM-FTPMC(WS-SUB) NOT = 'N' AND SPACES               
                      MOVE KH10-NUM-NON-SELN-FTPMC                              
                           TO WS-KH10-NS-CNT(WS-KH10-CNT)                       
                   ELSE                                                         
                      MOVE KH10-NUM-NON-SELN-FT                                 
                           TO WS-KH10-NS-CNT(WS-KH10-CNT)                       
                   END-IF                                                       
      ** CR - BP139545 END.                                                     
             WHEN  KH10-NUM-HOUSEHOLD(WS-SUB)             = 'H' AND             
                  (KH10-NUM-BALLOT-HOUSEHOLD(WS-SUB)      = 'G' OR 'N')         
                                                                                
                   MOVE KH10-NUM-NON-SELN-FT                                    
                     TO WS-KH10-NS-CNT(WS-KH10-CNT)                             
             WHEN  KH10-NUM-HOUSEHOLD(WS-SUB)             = 'G' AND             
                   KH10-NUM-BALLOT-HOUSEHOLD(WS-SUB)      = 'F' AND             
                   KH10-NUM-FT2T(WS-SUB)                  = 'Y'                 
                                                                                
      ** CR - BP139545 START                                                    
                   IF KH10-NUM-FTPMC(WS-SUB) NOT = 'N' AND SPACES               
                      MOVE KH10-NUM-NON-SELN-FTPMC                              
                           TO WS-KH10-NS-CNT(WS-KH10-CNT)                       
                   ELSE                                                         
                      MOVE KH10-NUM-NON-SELN-FT                                 
                           TO WS-KH10-NS-CNT(WS-KH10-CNT)                       
                   END-IF                                                       
      ** CR - BP139545 END.                                                     
             WHEN  KH10-NUM-HOUSEHOLD(WS-SUB)             = 'G' AND             
                  (KH10-NUM-BALLOT-HOUSEHOLD(WS-SUB)      = 'G' OR 'N')         
              AND  KH10-NUM-FT2T(WS-SUB)                  = 'Y'                 
                                                                                
                   MOVE KH10-NUM-NON-SELN-FT                                    
                     TO WS-KH10-NS-CNT(WS-KH10-CNT)                             
             WHEN  KH10-NUM-HOUSEHOLD(WS-SUB)             = 'G' AND             
                  (KH10-NUM-BALLOT-HOUSEHOLD(WS-SUB)      = 'G' OR 'N')         
                                                                                
                   MOVE KH10-NUM-NON-SELN-ST                                    
                     TO WS-KH10-NS-CNT(WS-KH10-CNT)                             
             END-EVALUATE.                                                      
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7000-READ-K268.                                                          
      *****************************************************************         
                                                                                
           MOVE 'N'                  TO WS-K268-FND.                            
                                                                                
           MOVE F800-NUM-REGN        TO K268-NUM-REGN.                          
           READ BP13K268         KEY IS K268-NUM-REGN.                          
                                                                                
           EVALUATE BP13K268-STATUS                                             
             WHEN 00                                                            
             WHEN 02                                                            
                MOVE   'Y'           TO WS-K268-FND                             
             WHEN 23                                                            
                DISPLAY 'REC NOT FOUND IN BP13K268'                             
                      ', K268-NUM-REGN: ' K268-NUM-REGN                         
             WHEN OTHER                                                         
                DISPLAY 'BP13K268 READ ERROR,STATUS : ' BP13K268-STATUS         
                      ', K268 KEY FLD : ' K268-KEY-FLD                          
                      ', K268 ALT KEY : ' K268-ALT-KEY                          
                MOVE BP13K268-STATUS       TO RETURN-CODE                       
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8000-PRINT-H09A.                                                         
      *****************************************************************         
                                                                                
           ADD 1                           TO WS-H09A-SNO                       
           MOVE WS-H09A-SNO                TO H09A-SNO                          
           MOVE F800-NUM-REGN              TO H09A-REGNO                        
           IF F800-NUM-GEN3 = 'Y'                                               
              MOVE 'G3'                    TO H09A-FT                           
           ELSE                                                                 
              MOVE F800-NUM-FLAT-TYPE      TO H09A-FT                           
           END-IF                                                               
           MOVE F800-NUM-NEW-TOWN          TO H09A-NT                           
           MOVE F800-NUM-NT-FT-QUEUE       TO H09A-QNO                          
           MOVE F800-NUM-CAT               TO H09A-CAT                          
           MOVE F800-DTE-BK-APPT           TO H09A-DTE-BK                       
           MOVE F800-TME-BK-APPT           TO H09A-TME-BK                       
           MOVE F800-NUM-HOUSEHOLD         TO H09A-HHTYP                        
           MOVE F800-CDE-BALLOT-HOUSEHOLD  TO H09A-BHH                          
           MOVE F800-NUM-BALLOT-STATUS     TO H09A-BALOT-STAT                   
           MOVE F800-NUM-ALLO-SCHEME       TO H09A-ALLO-SCH                     
           MOVE F800-NUM-FT2T              TO H09A-FT2T                         
           MOVE F800-NUM-ALLOC-TAG         TO H09A-ALLOC-TAG                    
           MOVE '/'                        TO H09A-SLASH1                       
                                              H09A-SLASH2                       
                                              H09A-SLASH3                       
                                                                                
           MOVE KH15-NUM-UNIT-AVAIL1       TO H09A-UNIT1                        
           MOVE KH15-NUM-QUOTA-AVAIL1      TO H09A-QUOTA1                       
           MOVE KH15-NUM-UNIT-AVAIL2       TO H09A-UNIT2                        
           MOVE KH15-NUM-QUOTA-AVAIL2      TO H09A-QUOTA2                       
           MOVE KH15-NUM-UNIT-AVAIL3       TO H09A-UNIT3                        
           MOVE KH15-NUM-QUOTA-AVAIL3      TO H09A-QUOTA3                       
                                                                                
           MOVE WS-KH10-UIN   (1)          TO H09A-NS-UIN                       
           MOVE WS-KH10-NS-CNT(1)          TO H09A-NS-CNT                       
           MOVE WS-KH10-REGN  (1)          TO H09A-NS-REGN                      
           MOVE WS-KH10-LIMIT (1)          TO H09A-NS-LIMIT                     
      ** CR - BP139545 START                                                    
           MOVE WS-KH10-FTPMC (1)          TO H09A-NS-FTPMC                     
      ** CR - BP139545 END.                                                     
                                                                                
                                                                                
           IF  WS-H09A-LINECTR       >= 54                                      
              PERFORM 8001-PRINT-H09A-HDR  THRU 8001-EXIT.                      
                                                                                
           WRITE P13LH09A-REC          FROM H09A-DETAILS                        
           ADD                         1 TO WS-H09A-LINECTR                     
                                            WS-H09A-WRITE.                      
                                                                                
           IF WS-KH10-CNT > 01                                                  
              PERFORM VARYING WS-SUB FROM 02 BY 01                              
                 UNTIL WS-SUB > WS-KH10-CNT                                     
                 MOVE SPACES                    TO H09A-DETAILS                 
                 MOVE WS-KH10-UIN   (WS-SUB)    TO H09A-NS-UIN                  
                 MOVE WS-KH10-NS-CNT(WS-SUB)    TO H09A-NS-CNT                  
                 MOVE WS-KH10-REGN  (WS-SUB)    TO H09A-NS-REGN                 
                 MOVE WS-KH10-LIMIT (WS-SUB)    TO H09A-NS-LIMIT                
      ** CR - BP139545 START                                                    
                 MOVE WS-KH10-FTPMC (WS-SUB)     TO H09A-NS-FTPMC               
      ** CR - BP139545 END.                                                     
                                                                                
                 IF  WS-H09A-LINECTR       >= 54                                
                    PERFORM 8001-PRINT-H09A-HDR THRU 8001-EXIT                  
                 END-IF                                                         
                                                                                
                 WRITE P13LH09A-REC             FROM H09A-DETAILS               
                 ADD                            1 TO WS-H09A-LINECTR            
              END-PERFORM.                                                      
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8001-PRINT-H09A-HDR.                                                     
           STRING F800-DTE-BALLOT(1:4) '/'                                      
                  F800-DTE-BALLOT(5:2)                                          
                DELIMITED BY SIZE INTO H09A-DTE-BALLOT.                         
           MOVE F800-NUM-ALLO-CAT   TO H09A-MODE.                               
                                                                                
           ADD                    1 TO WS-H09A-PAGECTR.                         
           MOVE WS-H09A-PAGECTR     TO H09A-PAGE-NO.                            
           WRITE P13LH09A-REC     FROM H09A-HEADER-01 AFTER PAGE.               
           WRITE P13LH09A-REC     FROM H09A-HEADER-02 AFTER 1.                  
           WRITE P13LH09A-REC     FROM H09A-HEADER-2A AFTER 2.                  
           WRITE P13LH09A-REC     FROM H09A-HEADER-03 AFTER 2.                  
           WRITE P13LH09A-REC     FROM H09A-HEADER-3A AFTER 1.                  
           WRITE P13LH09A-REC     FROM DASH-LINE      AFTER 1.                  
           MOVE                   8 TO WS-H09A-LINECTR.                         
       8001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ** CR - BP139545 START                                                    
                                                                                
      *****************************************************************         
       8010-PRINT-H09C.                                                         
      *****************************************************************         
                                                                                
           ADD 1                           TO WS-H09C-SNO                       
           MOVE WS-H09C-SNO                TO H09C-SNO                          
           MOVE F800-NUM-REGN              TO H09C-REGNO                        
           IF F800-NUM-GEN3 = 'Y'                                               
              MOVE 'G3'                    TO H09C-FT                           
           ELSE                                                                 
              MOVE F800-NUM-FLAT-TYPE      TO H09C-FT                           
           END-IF                                                               
           MOVE F800-NUM-NEW-TOWN          TO H09C-NT                           
           MOVE F800-NUM-NT-FT-QUEUE       TO H09C-QNO                          
           MOVE F800-NUM-CAT               TO H09C-CAT                          
           MOVE F800-DTE-BK-APPT           TO H09C-DTE-BK                       
           MOVE F800-TME-BK-APPT           TO H09C-TME-BK                       
           MOVE F800-NUM-HOUSEHOLD         TO H09C-HHTYP                        
           MOVE F800-CDE-BALLOT-HOUSEHOLD  TO H09C-BHH                          
           MOVE F800-NUM-BALLOT-STATUS     TO H09C-BALOT-STAT                   
           MOVE F800-NUM-ALLO-SCHEME       TO H09C-ALLO-SCH                     
           MOVE F800-NUM-FT2T              TO H09C-FT2T                         
           MOVE F800-NUM-ALLOC-TAG         TO H09C-ALLOC-TAG                    
           MOVE '/'                        TO H09C-SLASH1                       
                                              H09C-SLASH2                       
                                              H09C-SLASH3                       
                                                                                
           MOVE KH15-NUM-UNIT-AVAIL1       TO H09C-UNIT1                        
           MOVE KH15-NUM-QUOTA-AVAIL1      TO H09C-QUOTA1                       
           MOVE KH15-NUM-UNIT-AVAIL2       TO H09C-UNIT2                        
           MOVE KH15-NUM-QUOTA-AVAIL2      TO H09C-QUOTA2                       
           MOVE KH15-NUM-UNIT-AVAIL3       TO H09C-UNIT3                        
           MOVE KH15-NUM-QUOTA-AVAIL3      TO H09C-QUOTA3                       
                                                                                
           MOVE WS-KH10-UIN   (1)          TO H09C-NS-UIN                       
           MOVE WS-KH10-NS-CNT(1)          TO H09C-NS-CNT                       
           MOVE WS-KH10-REGN  (1)          TO H09C-NS-REGN                      
           MOVE WS-KH10-LIMIT (1)          TO H09C-NS-LIMIT                     
           MOVE WS-KH10-FTPMC (1)          TO H09C-NS-FTPMC                     
                                                                                
           IF  WS-H09C-LINECTR       >= 54                                      
              PERFORM 8002-PRINT-H09C-HDR  THRU 8002-EXIT.                      
                                                                                
           WRITE P13LH09C-REC          FROM H09C-DETAILS                        
           ADD                         1 TO WS-H09C-LINECTR                     
                                            WS-H09C-WRITE.                      
                                                                                
           IF WS-KH10-CNT > 01                                                  
              PERFORM VARYING WS-SUB FROM 02 BY 01                              
                 UNTIL WS-SUB > WS-KH10-CNT                                     
                 MOVE SPACES                    TO H09C-DETAILS                 
                 MOVE WS-KH10-UIN   (WS-SUB)    TO H09C-NS-UIN                  
                 MOVE WS-KH10-NS-CNT(WS-SUB)    TO H09C-NS-CNT                  
                 MOVE WS-KH10-REGN  (WS-SUB)    TO H09C-NS-REGN                 
                 MOVE WS-KH10-LIMIT (WS-SUB)    TO H09C-NS-LIMIT                
                 MOVE WS-KH10-FTPMC (WS-SUB)    TO H09C-NS-FTPMC                
                                                                                
                 IF  WS-H09C-LINECTR       >= 54                                
                    PERFORM 8002-PRINT-H09C-HDR THRU 8002-EXIT                  
                 END-IF                                                         
                                                                                
                 WRITE P13LH09C-REC             FROM H09C-DETAILS               
                 ADD                            1 TO WS-H09C-LINECTR            
              END-PERFORM.                                                      
                                                                                
       8010-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8002-PRINT-H09C-HDR.                                                     
           STRING F800-DTE-BALLOT(1:4) '/'                                      
                  F800-DTE-BALLOT(5:2)                                          
                DELIMITED BY SIZE INTO H09C-DTE-BALLOT.                         
           MOVE F800-NUM-ALLO-CAT   TO H09C-MODE.                               
                                                                                
           ADD                    1 TO WS-H09C-PAGECTR.                         
           MOVE WS-H09C-PAGECTR     TO H09C-PAGE-NO.                            
           WRITE P13LH09C-REC     FROM H09C-HEADER-01 AFTER PAGE.               
           WRITE P13LH09C-REC     FROM H09C-HEADER-02 AFTER 1.                  
           WRITE P13LH09C-REC     FROM H09C-HEADER-2A AFTER 2.                  
           WRITE P13LH09C-REC     FROM H09C-HEADER-03 AFTER 2.                  
           WRITE P13LH09C-REC     FROM H09C-HEADER-3A AFTER 1.                  
           WRITE P13LH09C-REC     FROM DASH-LINE      AFTER 1.                  
           MOVE                   8 TO WS-H09C-LINECTR.                         
       8002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ** CR - BP139545 END.                                                     
                                                                                
      *****************************************************************         
       8050-PRINT-H09B.                                                         
      *****************************************************************         
                                                                                
           ADD 1                           TO WS-H09B-SNO                       
           MOVE WS-H09B-SNO                TO H09B-SNO                          
           MOVE F800-NUM-REGN              TO H09B-REGNO                        
           IF F800-NUM-GEN3 = 'Y'                                               
              MOVE 'G3'                    TO H09B-FT                           
           ELSE                                                                 
              MOVE F800-NUM-FLAT-TYPE      TO H09B-FT                           
           END-IF                                                               
           MOVE F800-NUM-NEW-TOWN          TO H09B-NT                           
           MOVE F800-NUM-NT-FT-QUEUE       TO H09B-QNO                          
           MOVE F800-NUM-CAT               TO H09B-CAT                          
           MOVE F800-NUM-SCH-ACC           TO H09B-SCHACC                       
           MOVE F800-DTE-BK-APPT           TO H09B-DTE-BK                       
           MOVE F800-TME-BK-APPT           TO H09B-TME-BK                       
           MOVE WS-CDE-HH                  TO H09B-HHTYP                        
           MOVE F800-NUM-BALLOT-STATUS     TO H09B-BALOT-STAT                   
           MOVE F800-NUM-ALLOC-TAG         TO H09B-ALLOC-TAG                    
      ** CR - BP139545 START                                                    
           MOVE F800-NUM-FTPMC             TO H09B-FTPMC                        
      ** CR - BP139545 END.                                                     
           MOVE K268-NUM-UNIT-AVAIL1       TO H09B-UNIT1                        
           MOVE K268-NUM-QUOTA-AVAIL1      TO H09B-QUOTA1                       
           MOVE K268-NUM-UNIT-AVAIL2       TO H09B-UNIT2                        
           MOVE K268-NUM-QUOTA-AVAIL2      TO H09B-QUOTA2                       
           MOVE K268-NUM-UNIT-AVAIL3       TO H09B-UNIT3                        
           MOVE K268-NUM-QUOTA-AVAIL3      TO H09B-QUOTA3                       
                                                                                
           IF  WS-H09B-LINECTR       >= 54                                      
              PERFORM 8051-PRINT-H09B-HDR  THRU 8051-EXIT.                      
                                                                                
           WRITE P13LH09B-REC          FROM H09B-DETAILS                        
           ADD                         1 TO WS-H09B-LINECTR                     
                                            WS-H09B-WRITE.                      
       8050-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8051-PRINT-H09B-HDR.                                                     
           STRING F800-DTE-BALLOT(1:4) '/'                                      
                  F800-DTE-BALLOT(5:2)                                          
                 DELIMITED BY SIZE INTO H09B-DTE-BALLOT                         
           MOVE F800-NUM-ALLO-CAT    TO H09B-MODE                               
                                                                                
           ADD                     1 TO WS-H09B-PAGECTR                         
           MOVE WS-H09B-PAGECTR      TO H09B-PAGE-NO                            
           WRITE P13LH09B-REC      FROM H09B-HEADER-01 AFTER PAGE               
           WRITE P13LH09B-REC      FROM H09B-HEADER-02 AFTER 1                  
           WRITE P13LH09B-REC      FROM H09B-HEADER-2A AFTER 2                  
           WRITE P13LH09B-REC      FROM H09B-HEADER-03 AFTER 2                  
           WRITE P13LH09B-REC      FROM H09B-HEADER-3A                          
           WRITE P13LH09B-REC      FROM DASH-LINE                               
           MOVE                    8 TO WS-H09B-LINECTR.                        
       8051-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ** CR - BP139545 START                                                    
                                                                                
      *****************************************************************         
       8060-PRINT-H09D.                                                         
      *****************************************************************         
                                                                                
           ADD 1                           TO WS-H09D-SNO                       
           MOVE WS-H09D-SNO                TO H09D-SNO                          
           MOVE F800-NUM-REGN              TO H09D-REGNO                        
           IF F800-NUM-GEN3 = 'Y'                                               
              MOVE 'G3'                    TO H09D-FT                           
           ELSE                                                                 
              MOVE F800-NUM-FLAT-TYPE      TO H09D-FT                           
           END-IF                                                               
           MOVE F800-NUM-NEW-TOWN          TO H09D-NT                           
           MOVE F800-NUM-NT-FT-QUEUE       TO H09D-QNO                          
           MOVE F800-NUM-CAT               TO H09D-CAT                          
           MOVE F800-NUM-SCH-ACC           TO H09D-SCHACC                       
           MOVE F800-DTE-BK-APPT           TO H09D-DTE-BK                       
           MOVE F800-TME-BK-APPT           TO H09D-TME-BK                       
           MOVE WS-CDE-HH                  TO H09D-HHTYP                        
           MOVE F800-NUM-BALLOT-STATUS     TO H09D-BALOT-STAT                   
           MOVE F800-NUM-ALLOC-TAG         TO H09D-ALLOC-TAG                    
           MOVE F800-NUM-FTPMC             TO H09D-FTPMC                        
           MOVE K268-NUM-UNIT-AVAIL1       TO H09D-UNIT1                        
           MOVE K268-NUM-QUOTA-AVAIL1      TO H09D-QUOTA1                       
           MOVE K268-NUM-UNIT-AVAIL2       TO H09D-UNIT2                        
           MOVE K268-NUM-QUOTA-AVAIL2      TO H09D-QUOTA2                       
           MOVE K268-NUM-UNIT-AVAIL3       TO H09D-UNIT3                        
           MOVE K268-NUM-QUOTA-AVAIL3      TO H09D-QUOTA3                       
                                                                                
           IF  WS-H09D-LINECTR       >= 54                                      
              PERFORM 8052-PRINT-H09D-HDR  THRU 8052-EXIT.                      
                                                                                
           WRITE P13LH09D-REC          FROM H09D-DETAILS                        
           ADD                         1 TO WS-H09D-LINECTR                     
                                            WS-H09D-WRITE.                      
       8060-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8052-PRINT-H09D-HDR.                                                     
           STRING F800-DTE-BALLOT(1:4) '/'                                      
                  F800-DTE-BALLOT(5:2)                                          
                 DELIMITED BY SIZE INTO H09D-DTE-BALLOT                         
           MOVE F800-NUM-ALLO-CAT    TO H09D-MODE                               
                                                                                
           ADD                     1 TO WS-H09D-PAGECTR                         
           MOVE WS-H09D-PAGECTR      TO H09D-PAGE-NO                            
           WRITE P13LH09D-REC      FROM H09D-HEADER-01 AFTER PAGE               
           WRITE P13LH09D-REC      FROM H09D-HEADER-02 AFTER 1                  
           WRITE P13LH09D-REC      FROM H09D-HEADER-2A AFTER 2                  
           WRITE P13LH09D-REC      FROM H09D-HEADER-03 AFTER 2                  
           WRITE P13LH09D-REC      FROM H09D-HEADER-3A                          
           WRITE P13LH09D-REC      FROM DASH-LINE                               
           MOVE                    8 TO WS-H09D-LINECTR.                        
       8052-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ** CR - BP139545 END.                                                     
                                                                                
      *****************************************************************         
       9000-CLOSE-ROUTINE.                                                      
      *****************************************************************         
                                                                                
           DISPLAY '*-----------  BP13CH09 ------------*'.                      
           DISPLAY ' F800-READ       ' WS-F800-READ.                            
           DISPLAY ' H09A-WRITE      ' WS-H09A-WRITE.                           
           DISPLAY ' H09B-WRITE      ' WS-H09B-WRITE.                           
      ** CR - BP139545 START                                                    
           DISPLAY ' H09C-WRITE      ' WS-H09C-WRITE.                           
           DISPLAY ' H09D-WRITE      ' WS-H09D-WRITE.                           
      ** CR - BP139545 END.                                                     
           CLOSE      BP13F800                                                  
                      BP13K268                                                  
                      BP13KH10                                                  
                      BP13KH15                                                  
                      BP13K595                                                  
                      P13LH09A                                                  
      ** CR - BP139545 START                                                    
                      P13LH09C                                                  
                      P13LH09D                                                  
      ** CR - BP139545 END.                                                     
                      P13LH09B.                                                 
           IF BP13K268-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING - BP13K268 : ' BP13K268-STATUS             
              MOVE BP13K268-STATUS TO RETURN-CODE.                              
           IF BP13KH10-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING - BP13KH10 : ' BP13KH10-STATUS             
              MOVE BP13KH10-STATUS TO RETURN-CODE.                              
           IF BP13KH15-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING - BP13KH15 : ' BP13KH15-STATUS             
              MOVE BP13KH15-STATUS TO RETURN-CODE.                              
           IF BP13K595-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING - BP13K595 : ' BP13K595-STATUS             
              MOVE BP13K595-STATUS TO RETURN-CODE.                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
