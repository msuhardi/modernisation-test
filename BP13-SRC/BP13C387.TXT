      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                         00010061
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C387.                                         00020061
       AUTHOR.        MALC.                                             00030061
       DATE-WRITTEN.  10/01/03.                                         00040081
       DATE-COMPILED.                                                   00050061
                                                                                
      ***************************************************************** 00060061
      *                                                               * 00070061
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                         * 00080061
      *                                                               * 00090061
      *    SYSTEM ID : BP13                                           * 00100061
      *                                                               * 00110061
      *    OBJECTIVE : TO PRINT REQUEST FOR CHANGE OF FAMILY          * 00120061
      *                NUCLEUS VIA INTERNET                           * 00130061
      *                                                               * 00220061
      *     INPUT/OUPUT FILE:                                         * 00180061
      *      1. BP13K796  -  BP13.K796.APPOCC                         * 00190061
      *      2. BP13K060  -  CODE TRANSCRIPTION FILE                  *         
      *                                                               * 00220061
      *     OUPUT FILE:                                               * 00180061
      *      1. BP13L387                                              * 00190061
      *      2. P13L387B                                              * 00190061
      *                                                               * 00210061
      ***************************************************************** 00240061
      * CHGE REQ BY   DATE   DESCRIPTION                              *         
      * -------- ---- ------ ---------------------------------------- *         
      * BP132163 MALC 100103 NEW PROGRAM                              * 00210061
      * BP135527 ESA1 031214 CATER FOR SENDING OF EMAIL INDIVIDUALLY  * 00210061
      * BP135788 ESA1 251115 CATER FOR PRINTING OF FOOTER FOR ADD &   * 00210061
      *                      DELETE ACTION                            *         
      * BP136829 ZS13 220219 ADD CRM NAME                             * 00210061
      ***************************************************************** 00060061
                                                                        00250061
      *-----------------------*                                                 
       ENVIRONMENT DIVISION.                                            00260061
      *-----------------------*                                                 
       CONFIGURATION SECTION.                                           00270061
       SOURCE-COMPUTER. IBM-3090.                                       00280061
       OBJECT-COMPUTER. IBM-3090.                                       00290061
                                                                        00300061
       INPUT-OUTPUT SECTION.                                            00310061
                                                                        00320061
       FILE-CONTROL.                                                    00330061
           SELECT BP13K796 ASSIGN TO BP13K796                           00400061
                  ORGANIZATION       INDEXED                            00410061
                  ACCESS   MODE      SEQUENTIAL                         00420061
                  RECORD   KEY       K796-KEY-FLD                       00430061
                  FILE     STATUS    BP13K796-STATUS.                   00440061
                                                                        00450061
           SELECT BP13K060  ASSIGN       TO BP13K060                            
                            ACCESS       IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K060-KEY-FLD                        
                            FILE STATUS  IS BP13K060-STATUS.                    
                                                                                
           SELECT BP13K022  ASSIGN        TO BP13K022                           
                            ACCESS        IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K022-KEY-FLD                       
                            ALTERNATE KEY IS K022-NUM-REGN                      
                            FILE STATUS   IS BP13K022-STATUS.                   
                                                                                
           SELECT BP13K024  ASSIGN        TO BP13K024                           
                            ACCESS        IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K024-KEY-FLD                       
                            FILE STATUS   IS BP13K024-STATUS.                   
                                                                                
           SELECT BP13L387 ASSIGN TO BP13L387.                                  
                                                                                
           SELECT P13L387B ASSIGN TO P13L387B.                                  
                                                                                
           SELECT P13L387C ASSIGN TO P13L387C.                                  
                                                                                
      *-----------------------*                                                 
       DATA DIVISION.                                                   00520061
      *-----------------------*                                                 
       FILE SECTION.                                                    00530061
                                                                        00540061
       FD   BP13K796                                                    00680061
            RECORD CONTAINS  2000 CHARACTERS.                           00700061
       COPY BP13K796.                                                   00720061
                                                                        00730061
       FD   BP13K060                                                            
            RECORD CONTAINS 25 CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BP13L387                                                            
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC.                                                          
            05 FILLER                  PIC X(132).                              
                                                                                
       FD   P13L387B                                                            
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC-B.                                                        
            05 FILLER                  PIC X(132).                              
                                                                                
       FD   P13L387C                                                            
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC-C.                                                        
            05 FILLER                  PIC X(132).                              
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                         00760061
      *-----------------------*                                                 
                                                                                
       01  WS-TABLE.                                                            
           05 WS-SV-TABLE              OCCURS 12.                               
              10 WS-SV-ACTION          PIC X(1).                                
              10 WS-SV-ROLE            PIC X(5).                                
              10 WS-SV-UIN             PIC X(9).                                
              10 WS-SV-NAME            PIC X(66).                               
              10 WS-SV-SEX             PIC X(3).                                
              10 WS-SV-MARITAL-STATUS  PIC X(3).                                
              10 WS-SV-DTE-BIRTH       PIC X(8).                                
              10 WS-SV-CITIZENSHIP     PIC X(3).                                
              10 WS-SV-RLTNSP-APPLT1   PIC X(2).                                
              10 WS-SV-AMT-INCOME      PIC 9(5).                                
              10 WS-SV-SPOUSE-UIN      PIC X(9).                                
              10 WS-SV-FREEZE-OCCP     PIC X(1).                                
              10 WS-SV-PHONE           PIC X(8).                                
              10 WS-SV-PHONE-OFFICE    PIC X(8).                                
              10 WS-SV-HP-PAGER        PIC X(8).                                
              10 WS-SV-EDN-LVL         PIC X(1).                                
                                                                                
       01  WS-OTHER-VAR.                                                        
           05 WS-CURRENT-DATE          PIC X(8).                                
           05 WS-RELATIONSHIP          PIC X(3)  VALUE SPACES.                  
           05 WS-INCOME-EDIT           PIC $$$$$9.                              
           05 WS-PRINT-ROLE            PIC X(14).                               
           05 WS-PRINT-CITIZENSHIP     PIC X(20).                               
           05 WS-PRINT-REL-MAIN        PIC X(26).                               
           05 WS-STORE-ACTION          PIC X.                                   
           05 WS-STORE-ROLE            PIC X(5).                                
           05 WS-PRINT-MAR-STAT        PIC X(3).                                
           05 WS-REL-MAIN              PIC X(2).                                
           05 WS-SEX                   PIC X(3).                                
           05 WS-CITIZENSHIP           PIC X(3).                                
                                                                                
       01  WS-FILE-ACCESS-STATUS.                                       00770061
           05 BP13K060-STATUS          PIC X(2)  VALUE SPACES.          00780061
           05 BP13K796-STATUS          PIC X(2)  VALUE SPACES.          00780061
           05 BP13K022-STATUS          PIC X(2)  VALUE SPACES.          00780061
           05 BP13K024-STATUS          PIC X(2)  VALUE SPACES.          00780061
                                                                        00820061
       01  WS-SWITCHES.                                                 00830061
           05 WS-K796-EOF              PIC X     VALUE 'N'.             00850079
           05 WS-PRT-DTL               PIC X     VALUE 'N'.             00850079
           05 PRT-NEW-HDG-SW           PIC X     VALUE 'N'.             00850079
           05 WS-ADD-TAG               PIC X     VALUE 'N'.             00850079
           05 WS-DEL-TAG               PIC X     VALUE 'N'.             00850079
                                                                                
       01  WS-COUNTERS.                                                 01020061
           05 WS-K796-REC-PRINT        PIC 9(7)  VALUE ZEROES.          01030061
           05 WS-K796-REC-READ         PIC 9(7)  VALUE ZEROES.          01030061
           05 WS-K796-REC-REWRITE      PIC 9(7)  VALUE ZEROES.          01030061
           05 WS-CTR                   PIC 99    VALUE ZEROES.                  
           05 WS-SV-CTR                PIC 99    VALUE ZEROES.                  
           05 PAGE-CTR                 PIC 9(6)  VALUE ZEROES.                  
           05 LINE-CTR                 PIC 9(5)  VALUE 55.                      
           05 PAGE-CTRL-CTR            PIC 9(6)  VALUE ZEROES.                  
           05 LINE-CTRL-CTR            PIC 9(5)  VALUE 60.                      
                                                                                
      *****  EMAIL HEADER FORMAT*********                                       
       01  L387-HEADER-1.                                                       
           05  FILLER          PIC X(12)  VALUE 'HELO SGPHDB1'.                 
           05  FILLER          PIC X(68)  VALUE SPACES.                         
                                                                                
       01  L387-HEADER-2.                                                       
           05  FILLER          PIC X(11)  VALUE 'MAIL FROM:<'.                  
           05  SEND-ID         PIC X(04)  VALUE 'OPCP'.                         
           05  FILLER          PIC X(09)  VALUE '@SGPHDB1>'.                    
           05  FILLER          PIC X(56)  VALUE SPACES.                         
                                                                                
       01  L387-HEADER-3.                                                       
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  MAIL-RCPT1      PIC X(71)  VALUE                                 
               'scismail@mailbox.hdb.gov.sg>'.                                  
                                                                                
       01  L387-HEADER-4.                                                       
           05  FILLER          PIC X(04)  VALUE 'DATA'.                         
           05  FILLER          PIC X(76)  VALUE SPACES.                         
                                                                                
       01  L387-HEADER-5.                                                       
           05  FILLER          PIC X(05)   VALUE 'FROM:'.                       
           05  MAIL-SENDMAILID PIC X(21)   VALUE                                
               'SOC_SYSTEM@HDB.GOV.SG'.                                         
           05  FILLER          PIC X(106)  VALUE SPACES.                        
                                                                                
       01  L387-HEADER-6.                                                       
           05  FILLER          PIC X(04)  VALUE 'TO:<'.                         
           05  MAIL-RCPT5      PIC X(76)  VALUE                                 
               'scismail@mailbox.hdb.gov.sg>'.                                  
                                                                                
       01  L387-HEADER-7.                                                       
           05  FILLER          PIC X(10)  VALUE 'SUBJECT :'.                    
           05  MAIL-SUBJ       PIC X(76)  VALUE                                 
               'REQUEST FOR CHANGE OF FAMILY NUCLEUS VIA INTERNET'.             
                                                                                
      *****  PRINT FORMAT  **************                                       
                                                                                
       01  L387-PRINT-HDG.                                                      
           05  FILLER              PIC X(8)    VALUE 'BP13L387'.                
           05  FILLER              PIC X(10)   VALUE '      HDB3'.              
           05  FILLER              PIC X(28)   VALUE SPACES.                    
           05  FILLER              PIC X(39)   VALUE                            
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER              PIC X(09)   VALUE SPACES.                    
           05  FILLER              PIC X(7)    VALUE 'DATE : '.                 
           05  L387-CURRENT-DATE   PIC X(10)   VALUE SPACES.                    
           05  FILLER              PIC X(3)    VALUE SPACES.                    
           05  FILLER              PIC X(7)    VALUE 'PAGE : '.                 
           05  L387-PAGE           PIC ZZZZZ9.                                  
                                                                                
       01  L387-HDG1.                                                           
           05  FILLER              PIC X(41) VALUE SPACES.                      
           05  FILLER              PIC X(49) VALUE                              
               'REQUEST FOR CHANGE OF FAMILY NUCLEUS VIA INTERNET'.             
           05  FILLER              PIC X(42) VALUE SPACES.                      
                                                                                
       01  L387-HDG1-LINE.                                                      
           05  FILLER              PIC X(41) VALUE SPACES.                      
           05  FILLER              PIC X(49) VALUE ALL '-'.                     
           05  FILLER              PIC X(42) VALUE SPACES.                      
                                                                                
       01  L387-SUB-HDR1.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(27) VALUE                              
               'SALES REGISTRATION NUMBER: '.                                   
           05  L387-SUB-REGN       PIC X(08) VALUE SPACES.                      
                                                                                
       01  L387-SUB-HDR2.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(17) VALUE                              
               'DATE OF REQUEST: '.                                             
           05  L387-SUB-DTE-REQ    PIC X(10) VALUE SPACES.                      
                                                                                
       01  L387-SUB-HDR3.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(17) VALUE                              
               'TIME OF REQUEST: '.                                             
           05  L387-SUB-TIME-REQ   PIC X(08) VALUE SPACES.                      
                                                                                
       01  L387-SUB-HDR4.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(17) VALUE                              
               'CRM            : '.                                             
           05  L387-SUB-CRM        PIC X(30) VALUE SPACES.                      
                                                                                
      **** ADD HEADER                                                           
       01  L387-ADD-HDG1.                                                       
           05  FILLER              PIC X(23)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'NAME'.                    
           05  FILLER              PIC X(42)   VALUE SPACES.                    
           05  FILLER              PIC X(04)   VALUE 'NRIC'.                    
           05  FILLER              PIC X(07)   VALUE SPACES.                    
           05  FILLER              PIC X(05)   VALUE 'BIRTH'.                   
           05  FILLER              PIC X(04)   VALUE SPACES.                    
           05  FILLER              PIC X(05)   VALUE 'GROSS'.                   
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'MAR'.                     
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE 'SEX'.                     
           05  FILLER              PIC X(05)   VALUE SPACES.                    
           05  FILLER              PIC X(06)   VALUE 'SPOUSE'.                  
                                                                                
       01  L387-ADD-HDG2.                                                       
           05  FILLER              PIC X(80)  VALUE SPACES.                     
           05  FILLER              PIC X(04)  VALUE 'DATE'.                     
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(06)  VALUE 'INCOME'.                   
           05  FILLER              PIC X(02)  VALUE SPACES.                     
           05  FILLER              PIC X(04)  VALUE 'STAT'.                     
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(04)  VALUE 'NRIC'.                     
                                                                                
       01  L387-ADD-HDG3.                                                       
           05  FILLER              PIC X(09)  VALUE SPACES.                     
           05  FILLER              PIC X(09)  VALUE 'EDUCATION'.                
           05  FILLER              PIC X(18)  VALUE SPACES.                     
           05  FILLER              PIC X(11)  VALUE 'CITIZENSHIP'.              
           05  FILLER              PIC X(06)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE 'RELATIONSHIP'.             
           05  FILLER              PIC X(14)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE 'EMPLOY STAT'.              
           05  FILLER              PIC X(03)  VALUE SPACES.                     
           05  FILLER              PIC X(10)  VALUE 'OCCUPATION'.               
           05  FILLER              PIC X(11)  VALUE SPACES.                     
           05  FILLER              PIC X(04)  VALUE 'RACE'.                     
                                                                                
       01  L387-ADD-DTL1.                                                       
           05  L387-NAME           PIC X(59).                                   
           05  FILLER              PIC X(01) VALUE '('.                         
           05  L387-ROLE           PIC X(05).                                   
           05  FILLER              PIC X(01) VALUE ')'.                         
           05  FILLER              PIC X(02) VALUE SPACES.                      
           05  L387-NRIC           PIC X(09).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-BIRTH-DTE      PIC X(10).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-GROSS-INCOME   PIC X(06).                                   
           05  FILLER              PIC X(03) VALUE SPACES.                      
           05  L387-MAR-STAT       PIC X(03).                                   
           05  FILLER              PIC X(03) VALUE SPACES.                      
           05  L387-SEX            PIC X(03).                                   
           05  FILLER              PIC X(04) VALUE SPACES.                      
           05  L387-SPOUSE-NRIC    PIC X(09).                                   
                                                                                
       01  L387-ADD-DTL2.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-EDUC-LVL       PIC X(30).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-CITIZENSHIP    PIC X(20).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-REL-MAIN       PIC X(26).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-EMPLOY-STAT    PIC X(13).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-OCCUPATION     PIC X(20).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-RACE           PIC X(18).                                   
                                                                                
       01  L387-ADD-LINE.                                                       
           05  FILLER              PIC X(132) VALUE ALL '-'.                    
                                                                                
      **** DELETE HEADER                                                        
       01  L387-DELETE-HDG.                                                     
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(04) VALUE 'NAME'.                      
           05  FILLER              PIC X(62) VALUE SPACES.                      
           05  FILLER              PIC X(11) VALUE 'NRIC/UIN NO'.               
                                                                                
       01  L387-DEL-DTL1.                                                       
           05  L387-DEL-NAME       PIC X(66).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-DEL-NRIC       PIC X(09).                                   
                                                                                
      **** TRANSFER HEADER                                                      
       01  L387-TRANSFER-HDG.                                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(04) VALUE 'NAME'.                      
           05  FILLER              PIC X(63) VALUE SPACES.                      
           05  FILLER              PIC X(12) VALUE 'NRIC/UIN NO'.               
           05  FILLER              PIC X(03) VALUE SPACES.                      
           05  FILLER              PIC X(16) VALUE 'CHANGE STATUS TO'.          
                                                                                
       01  L387-TRANSFER-DTL1.                                                  
           05  L387-TRANSFER-NAME  PIC X(66).                                   
           05  FILLER              PIC X(04) VALUE SPACES.                      
           05  L387-TRANSFER-NRIC  PIC X(09).                                   
           05  FILLER              PIC X(06) VALUE SPACES.                      
           05  L387-TRANSFER-ROLE  PIC X(14).                                   
                                                                                
      **** NEW COMPOSITION HEADER                                               
       01  L387-NEW-HDG1.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(06) VALUE 'ROLE'.                      
           05  FILLER              PIC X(08) VALUE SPACES.                      
           05  FILLER              PIC X(04) VALUE 'NAME'.                      
           05  FILLER              PIC X(64) VALUE SPACES.                      
           05  FILLER              PIC X(08) VALUE 'NRIC/UIN'.                  
           05  FILLER              PIC X(02) VALUE SPACES.                      
           05  FILLER              PIC X(07) VALUE 'MARITAL'.                   
                                                                                
       01  L387-NEW-HDG2.                                                       
           05  FILLER              PIC X(85) VALUE SPACES.                      
           05  FILLER              PIC X(03) VALUE 'NO.'.                       
           05  FILLER              PIC X(05) VALUE SPACES.                      
           05  FILLER              PIC X(06) VALUE 'STATUS'.                    
                                                                                
       01  L387-NEW-HDG3.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  FILLER              PIC X(11) VALUE 'CITIZENSHIP'.               
           05  FILLER              PIC X(11) VALUE SPACES.                      
           05  FILLER              PIC X(12) VALUE 'RELATIONSHIP'.              
                                                                                
       01  L387-NEW-DTL1.                                                       
           05  L387-NEW-ROLE       PIC X(14).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-NEW-NAME       PIC X(66).                                   
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-NEW-NRIC       PIC X(09).                                   
           05  FILLER              PIC X(05) VALUE SPACES.                      
           05  L387-NEW-MAR-STAT   PIC X(01).                                   
                                                                                
       01  L387-NEW-DTL2.                                                       
           05  FILLER              PIC X(01) VALUE SPACES.                      
           05  L387-NEW-CITIZEN    PIC X(20).                                   
           05  FILLER              PIC X(02) VALUE SPACES.                      
           05  L387-NEW-REL-MAIN   PIC X(26).                                   
                                                                                
       01  L387-PRINT-STATUS.                                                   
           05  L387-PRT-STAT       PIC X(110) VALUE ZEROES.                     
                                                                                
      **** CONTROL REPORT                                                       
       01  L387-CTRL-HDG.                                                       
           05  FILLER              PIC X(42) VALUE SPACES.                      
           05  FILLER              PIC X(56) VALUE                              
           'CONTROL REPORT ON CHANGE OF FAMILY NUCLEUS VIA INTERNET'.           
           05  FILLER              PIC X(42) VALUE SPACES.                      
                                                                                
       01  L387-HDG-CTRL-LINE.                                                  
           05  FILLER              PIC X(42) VALUE SPACES.                      
           05  FILLER              PIC X(56) VALUE ALL '-'.                     
           05  FILLER              PIC X(42) VALUE SPACES.                      
                                                                                
       01  L387-CTRL-SUB-HDG.                                                   
           05  FILLER              PIC X(05) VALUE SPACES.                      
           05  FILLER              PIC X(60) VALUE                              
               'SERIAL NO     REGN NO      DTE REQ      TME REQ'.               
                                                                                
       01  L387-CTRL-LINE.                                                      
           05  FILLER              PIC X(05) VALUE SPACES.                      
           05  FILLER              PIC X(60) VALUE                              
               '---------     -------      -------      -------'.               
                                                                                
       01  L387-CTRL-DTL.                                                       
           05  FILLER              PIC X(05) VALUE SPACES.                      
           05  L387-SER-NO         PIC ZZ,ZZZ,ZZZ.                              
           05  FILLER              PIC X(04) VALUE SPACES.                      
           05  L387-CTRL-REGN      PIC X(08).                                   
           05  FILLER              PIC X(04) VALUE SPACES.                      
           05  L387-CTRL-DTE-REQ   PIC X(10).                                   
           05  FILLER              PIC X(04) VALUE SPACES.                      
           05  L387-CTRL-TIME-REQ  PIC X(10).                                   
                                                                                
       01  L387-FOOTER1.                                                        
           05  FILLER              PIC X(01)  VALUE '.'.                        
           05  FILLER              PIC X(131) VALUE SPACES.                     
                                                                                
       01  L387-FOOTER2.                                                        
           05  FILLER              PIC X(132) VALUE SPACES.                     
                                                                                
       01  L387-FOOTER1-ADD.                                                    
           05  FILLER              PIC X(56)  VALUE                             
               'We have requested for the following documents from the'.        
           05  FILLER              PIC X(51)  VALUE                             
               'applicant in the e-service  acknowledgement form :'.            
           05  FILLER              PIC X(25)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER2-ADD.                                                    
           05  FILLER              PIC X(29)  VALUE                             
               'Inclusion of child/children :'.                                 
           05  FILLER              PIC X(103) VALUE SPACES.                     
                                                                                
       01  L387-FOOTER3-ADD.                                                    
           05  FILLER              PIC X(46)  VALUE                             
               '- birth certificate of the child/children via '.                
           05  FILLER              PIC X(24)  VALUE                             
               'MyDoc@HDB within 7 days.'.                                      
           05  FILLER              PIC X(62)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER4-ADD.                                                    
           05  FILLER              PIC X(46)  VALUE                             
               'Retention of flat application with new fiance '.                
           05  FILLER              PIC X(09)  VALUE                             
               '/fiancee:'.                                                     
           05  FILLER              PIC X(77)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER5-ADD.                                                    
           05  FILLER              PIC X(49)  VALUE                             
               '- Letter/memo signed by outgoing party conveying '.             
           05  FILLER              PIC X(51)  VALUE                             
               'that he/she agrees to transfer his/her interest in '.           
           05  FILLER              PIC X(20)  VALUE                             
               'the flat application'.                                          
           05  FILLER              PIC X(12)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER6-ADD.                                                    
           05  FILLER              PIC X(33)  VALUE                             
               '  to the retaining party and the '.                             
           05  FILLER              PIC X(51)  VALUE                             
               'new fianc/fiance, and sign the transfer papers in '.            
           05  FILLER              PIC X(37)  VALUE                             
               'due course (if approval is granted);'.                          
           05  FILLER              PIC X(11)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER7-ADD.                                                    
           05  FILLER              PIC X(44)  VALUE                             
               '- Incoming party"s NRIC(front and reverse);'.                   
           05  FILLER              PIC X(88)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER8-ADD.                                                    
           05  FILLER              PIC X(49)  VALUE                             
               '- Retaining and Incoming party"s latest 3 months'.              
           05  FILLER              PIC X(83)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER9-ADD.                                                    
           05  FILLER              PIC X(49)  VALUE                             
               '- Retaining and Incoming partys latest 15 months '.             
           05  FILLER              PIC X(25)  VALUE                             
               'CPF contribution history;'.                                     
           05  FILLER              PIC X(58)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER10-ADD.                                                   
           05  FILLER              PIC X(41)  VALUE                             
               '- The following forms in hardcopy to HDB'.                      
           05  FILLER              PIC X(91)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER11-ADD.                                                   
           05  FILLER              PIC X(42)  VALUE                             
               '- Change of Family Nucleus form (signed);'.                     
           05  FILLER              PIC X(90)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER12-ADD.                                                   
           05  FILLER              PIC X(34)  VALUE                             
               '- Flat Application form (signed).'.                             
           05  FILLER              PIC X(98)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER13-ADD.                                                   
           05  FILLER              PIC X(52)  VALUE                             
               'If HDB do not receive the documents within 7 days, '.           
           05  FILLER              PIC X(32)  VALUE                             
               'this request will be cancelled.'.                               
           05  FILLER              PIC X(48)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER2-DEL.                                                    
           05  FILLER              PIC X(50)  VALUE                             
               'Retention of flat application with child/children '.            
           05  FILLER              PIC X(14)  VALUE                             
               'upon divorce :'.                                                
           05  FILLER              PIC X(68)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER3-DEL.                                                    
           05  FILLER              PIC X(45)  VALUE                             
               'The following documents via MyDOc@HDB within '.                 
           05  FILLER              PIC X(09)  VALUE                             
               '7 days : '.                                                     
           05  FILLER              PIC X(78)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER4-DEL.                                                    
           05  FILLER              PIC X(53)  VALUE                             
               '- Finalised divorce documents (e.g.Interim Judgement '.         
           05  FILLER              PIC X(27)  VALUE                             
               'Final and Order of Court);'.                                    
           05  FILLER              PIC X(78)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER5-DEL.                                                    
           05  FILLER              PIC X(53)  VALUE                             
               '- Child(ren)s birth certificate(s); '.                          
           05  FILLER              PIC X(78)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER6-DEL.                                                    
           05  FILLER              PIC X(55)  VALUE                             
               '- Documents indicating care and control of child(ren);'.        
           05  FILLER              PIC X(77)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER7-DEL.                                                    
           05  FILLER              PIC X(47)  VALUE                             
               '- Retaining party"s latest 3 months payslips; '.                
           05  FILLER              PIC X(85)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER8-DEL.                                                    
           05  FILLER              PIC X(54)  VALUE                             
               '- Retaining party"s latest 15 months CPF contribution '.        
           05  FILLER              PIC X(08)  VALUE                             
               'history;'.                                                      
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER9-DEL.                                                    
           05  FILLER              PIC X(40)  VALUE                             
               'The following forms in hardcopy to HDB:'.                       
           05  FILLER              PIC X(92)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER10-DEL.                                                   
           05  FILLER              PIC X(42)  VALUE                             
               '- Change of Family Nucleus form (signed);'.                     
           05  FILLER              PIC X(90)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER11-DEL.                                                   
           05  FILLER              PIC X(34)  VALUE                             
               '- Flat Application form (signed).'.                             
           05  FILLER              PIC X(98)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER12-DEL.                                                   
           05  FILLER              PIC X(52)  VALUE                             
               'Retention of flat application upon spouses demise :'.           
           05  FILLER              PIC X(80)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER13-DEL.                                                   
           05  FILLER              PIC X(52)  VALUE                             
               'Please submit the following documents via MyDOc@HDB '.          
           05  FILLER              PIC X(80)  VALUE                             
               'within 7 days :'.                                               
                                                                                
       01  L387-FOOTER14-DEL.                                                   
           05  FILLER              PIC X(38)  VALUE                             
               '- Deceased party"s death certificate;'.                         
           05  FILLER              PIC X(94)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER15-DEL.                                                   
           05  FILLER              PIC X(50)  VALUE                             
               '- Petition for Grant of Letters of Administration '.            
           05  FILLER              PIC X(52)  VALUE                             
               'and Grant of Letters of Administration (with Estate '.          
           05  FILLER              PIC X(30)  VALUE SPACES.                     
                                                                                
       01  L387-FOOTER16-DEL.                                                   
           05  FILLER              PIC X(57)  VALUE                             
               'Duty Schedule) or a copy of the Grant of Probate (with'.        
           05  FILLER              PIC X(24)  VALUE                             
               ' Estate Duty Schedule);'.                                       
           05  FILLER              PIC X(51)  VALUE SPACES.                     
                                                                                
      *-----------------------*                                                 
       PROCEDURE DIVISION.                                              01060061
      *-----------------------*                                                 
                                                                        01080061
      *-----------------------*                                                 
       000-MAIN-ROUTINE.                                                01100061
      *-----------------------*                                                 
           PERFORM 100-OPEN-FILES       THRU 100-EXIT.                  01130061
           MOVE ZEROES TO PAGE-CTR.                                             
           PERFORM 200-READ-BP13K796    THRU 200-EXIT                   01640061
                   UNTIL WS-K796-EOF = 'Y'.                                     
                                                                                
           IF WS-K796-REC-PRINT = ZEROES                                        
              MOVE SPACES TO BP13K796-REC                                       
              PERFORM 410-PRINT-HEADING    THRU 410-EXIT                        
                                                                                
              MOVE SPACES TO L387-PRT-STAT                                      
              MOVE '**** NO RECORD(S) TO PRINT ****' TO                         
                   L387-PRT-STAT                                                
              WRITE PRINT-REC   FROM L387-PRINT-STATUS   AFTER 5                
              WRITE PRINT-REC-C FROM L387-PRINT-STATUS                          
              PERFORM 810-PRINT-CTRL-HDG THRU 810-EXIT                          
              WRITE PRINT-REC-B FROM L387-PRINT-STATUS AFTER 5                  
           ELSE                                                                 
              MOVE SPACES TO L387-PRT-STAT                                      
              MOVE '             **** END OF REPORT ****' TO                    
                   L387-PRT-STAT                                                
              WRITE PRINT-REC-B FROM L387-PRINT-STATUS AFTER 2                  
           END-IF.                                                              
                                                                                
           PERFORM 900-CLOSE-ROUTINE    THRU 900-EXIT.                  01300061
                                                                        01320061
       000-EXIT.                                                        01330061
           EXIT.                                                        01340061
                                                                        01350061
                                                                                
      *-----------------------*                                                 
       100-OPEN-FILES.                                                  01380061
      *-----------------------*                                                 
           OPEN INPUT   BP13K060                                        01430061
                        BP13K022                                                
                        BP13K024                                                
                I-O     BP13K796                                        01430061
                OUTPUT  BP13L387                                        01420061
                        P13L387B                                                
                        P13L387C.                                               
                                                                        01440061
           IF BP13K060-STATUS  NOT = '00' AND '97'                      01500099
              DISPLAY 'OPEN ERROR FOR BP13K060 - ' BP13K060-STATUS      01510061
              MOVE BP13K060-STATUS TO RETURN-CODE                       01520061
              GO TO 900-CLOSE-ROUTINE.                                  01530099
                                                                        01540061
           IF BP13K796-STATUS  NOT = '00' AND '97'                      01500099
              DISPLAY 'OPEN ERROR FOR BP13K796 - ' BP13K796-STATUS      01510061
              MOVE BP13K796-STATUS TO RETURN-CODE                       01520061
              GO TO 900-CLOSE-ROUTINE.                                  01530099
                                                                        01540061
           IF BP13K022-STATUS  NOT = '00' AND '97'                      01500099
              DISPLAY 'OPEN ERROR FOR BP13K022 - ' BP13K022-STATUS      01510061
              MOVE BP13K022-STATUS TO RETURN-CODE                       01520061
              GO TO 900-CLOSE-ROUTINE.                                  01530099
                                                                        01540061
           IF BP13K024-STATUS  NOT = '00' AND '97'                      01500099
              DISPLAY 'OPEN ERROR FOR BP13K024 - ' BP13K024-STATUS      01510061
              MOVE BP13K024-STATUS TO RETURN-CODE                       01520061
              GO TO 900-CLOSE-ROUTINE.                                  01530099
                                                                        01540061
       100-EXIT.                                                        01600061
           EXIT.                                                        01610061
                                                                        01620061
                                                                        01620061
      *-----------------------*                                                 
       200-READ-BP13K796.                                               01750061
      *-----------------------*                                                 
           MOVE 55 TO LINE-CTR.                                                 
                                                                                
           READ BP13K796 AT END MOVE 'Y' TO WS-K796-EOF                 01760061
                            GO TO 200-EXIT.                                     
                                                                                
           IF K796-NUM-REGN = LOW-VALUES OR SPACES                              
              GO TO 200-EXIT                                                    
           END-IF.                                                              
                                                                                
           ADD 1                         TO WS-K796-REC-READ.                   
           EVALUATE BP13K796-STATUS                                             
             WHEN '00'                                                          
                IF K796-NUM-PRINTED NOT = 'Y'                                   
                   PERFORM 300-PROCESS-BP13K796 THRU 300-EXIT                   
                END-IF                                                          
             WHEN '10'                                                          
                MOVE 'Y' TO WS-K796-EOF                                         
             WHEN OTHER                                                         
                DISPLAY 'ERROR READING BP13K796 STATUS: '                       
                        BP13K796-STATUS ' KEY - ' K796-NUM-REGN                 
                MOVE BP13K796-STATUS      TO        RETURN-CODE                 
                PERFORM 900-CLOSE-ROUTINE THRU      900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       200-EXIT.                                                        01860061
           EXIT.                                                        01870061
                                                                        01880061
      *-----------------------*                                                 
       210-READ-BP13K022.                                                       
      *-----------------------*                                                 
      *---GETTING OIC               -------------------------------*            
                                                                                
           MOVE SPACES                 TO BP13K022-REC.                         
           MOVE K796-NUM-REGN          TO K022-NUM-REGN.                        
                                                                                
           READ BP13K022  KEY IS K022-NUM-REGN.                                 
                                                                                
           EVALUATE BP13K022-STATUS                                             
           WHEN 00                                                              
                MOVE SPACES          TO BP13K024-REC                            
                IF K022-NUM-OIC-APPL NOT = SPACES AND LOW-VALUES                
                   MOVE K022-NUM-OIC-APPL    TO K024-NUM-OIC                    
                ELSE                                                            
                   MOVE K022-NUM-OIC         TO K024-NUM-OIC                    
                END-IF                                                          
                PERFORM 220-READ-BP13K024   THRU 220-EXIT                       
           WHEN 23                                                              
                MOVE SPACES          TO BP13K024-REC                            
                DISPLAY 'BP13K022 RECORD NOT FOUND :' K022-NUM-REGN             
           WHEN OTHER                                                           
                DISPLAY 'BP13K022 READ FILE ERROR STATUS: '                     
                    BP13K022-STATUS 'KEY - ' K022-KEY-FLD                       
                PERFORM 900-CLOSE-ROUTINE THRU 900-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       210-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-----------------------*                                                 
       220-READ-BP13K024.                                                       
      *-----------------------*                                                 
      *---GETTING OIC full name     -------------------------------*            
                                                                                
           READ BP13K024.                                                       
                                                                                
           EVALUATE BP13K022-STATUS                                             
           WHEN 00                                                              
                continue                                                        
           WHEN 23                                                              
                DISPLAY 'BP13K024 RECORD NOT FOUND :' K024-NUM-oic              
                MOVE SPACES  TO BP13K024-REC                                    
           WHEN OTHER                                                           
                DISPLAY 'BP13K024 READ FILE ERROR STATUS: '                     
                    BP13K024-STATUS 'KEY - ' K024-KEY-FLD                       
                PERFORM 900-CLOSE-ROUTINE THRU 900-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       220-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                        01880061
      *-----------------------*                                                 
       300-PROCESS-BP13K796.                                            01890061
      *-----------------------*                                                 
           MOVE SPACES TO WS-TABLE.                                             
           INITIALIZE     WS-TABLE.                                             
                                                                                
           MOVE 'N'    TO WS-ADD-TAG  WS-DEL-TAG.                               
                                                                                
           PERFORM 310-ARRANGE-TABLE THRU 310-EXIT.                             
                                                                                
      **** WS-SV-CTR = ZEROES NO CHANGE IN FAMILY NUCLEUS                       
           IF WS-SV-CTR > ZEROES                                                
              PERFORM 400-PRINT-RECORD  THRU 400-EXIT                           
           ELSE                                                                 
              ADD 1 TO WS-K796-REC-PRINT                                        
              PERFORM 410-PRINT-HEADING THRU 410-EXIT                           
                                                                                
              MOVE SPACES TO L387-PRT-STAT                                      
              MOVE '**** NO CHANGE IN FAMILY NUCLEUS ****' TO                   
                   L387-PRT-STAT                                                
              WRITE PRINT-REC FROM L387-PRINT-STATUS AFTER 5                    
              WRITE PRINT-REC-C FROM L387-PRINT-STATUS                          
           END-IF.                                                              
                                                                                
           PERFORM 800-PRINT-CTRL-DTL   THRU 800-EXIT.                          
           PERFORM 600-REWRITE-BP13K796 THRU 600-EXIT.                          
                                                                                
       300-EXIT.                                                        02080061
           EXIT.                                                        02090061
                                                                        02100061
                                                                                
      *-----------------------*                                                 
       310-ARRANGE-TABLE.                                                       
      *-----------------------*                                                 
      **** MOVE ALL ACTION = 'A' AT TOP MOST OF THE RECORD                      
           MOVE ZEROES TO WS-SV-CTR.                                            
           PERFORM 320-ARRANGE-TABLE-ADD THRU 320-EXIT                  01900073
                   VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 12.                
                                                                                
      **** MOVE ALL ACTION = 'D' AFTER ACTION = 'A'                             
           IF WS-SV-CTR < 12                                                    
              PERFORM 330-ARRANGE-TABLE-DELETE THRU 330-EXIT            01900073
                   VARYING WS-CTR FROM 1 BY 1 UNTIL                             
                   (WS-CTR > 12 OR WS-SV-CTR = 12)                              
           END-IF.                                                              
                                                                                
      **** MOVE ALL ACTION = 'C' AFTER ACTION = 'A' AND 'D'                     
           IF WS-SV-CTR < 12                                                    
              PERFORM 340-ARRANGE-TABLE-CHANGE THRU 340-EXIT            01900073
                   VARYING WS-CTR FROM 1 BY 1 UNTIL                             
                   (WS-CTR > 12 OR WS-SV-CTR = 12)                              
           END-IF.                                                              
                                                                                
       310-EXIT.                                                        02080061
           EXIT.                                                        02090061
                                                                        02100061
                                                                                
      *-----------------------*                                                 
       320-ARRANGE-TABLE-ADD.                                                   
      *-----------------------*                                                 
           IF K796-NUM-ACTION(WS-CTR) = 'A'                                     
              PERFORM 345-MOVE-K796-SV-VAR THRU 345-EXIT                        
           END-IF.                                                              
                                                                                
       320-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       330-ARRANGE-TABLE-DELETE.                                                
      *-----------------------*                                                 
           IF K796-NUM-ACTION(WS-CTR) = 'D'                                     
              PERFORM 345-MOVE-K796-SV-VAR THRU 345-EXIT                        
           END-IF.                                                              
                                                                                
       330-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       340-ARRANGE-TABLE-CHANGE.                                                
      *-----------------------*                                                 
           IF K796-NUM-ACTION(WS-CTR) = 'C'                                     
              PERFORM 345-MOVE-K796-SV-VAR THRU 345-EXIT                        
           END-IF.                                                              
                                                                                
       340-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       345-MOVE-K796-SV-VAR.                                                    
      *-----------------------*                                                 
           ADD 1 TO WS-SV-CTR.                                                  
           MOVE K796-APPOCC-TABLE(WS-CTR) TO                                    
                WS-SV-TABLE(WS-SV-CTR).                                         
                                                                                
           PERFORM 350-DECODE-SEX-STATUS THRU 350-EXIT.                         
           MOVE WS-PRINT-MAR-STAT TO WS-SV-MARITAL-STATUS(WS-SV-CTR).           
           MOVE WS-SEX            TO WS-SV-SEX(WS-SV-CTR).                      
                                                                                
       345-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       350-DECODE-SEX-STATUS.                                                   
      *-----------------------*                                                 
           EVALUATE K796-NUM-MARITAL-STATUS(WS-CTR)                             
           WHEN '1'                                                             
              MOVE 'S'        TO WS-PRINT-MAR-STAT                              
           WHEN '2'                                                             
              MOVE 'M'        TO WS-PRINT-MAR-STAT                              
           WHEN '3'                                                             
              MOVE 'D'        TO WS-PRINT-MAR-STAT                              
           WHEN '4'                                                             
              MOVE 'W'        TO WS-PRINT-MAR-STAT                              
           WHEN '5'                                                             
              MOVE 'P'        TO WS-PRINT-MAR-STAT                              
           WHEN SPACES                                                          
              MOVE '-'        TO WS-PRINT-MAR-STAT                              
           WHEN OTHER                                                           
              MOVE K796-NUM-MARITAL-STATUS(WS-CTR) TO WS-PRINT-MAR-STAT         
           END-EVALUATE.                                                        
                                                                                
           IF K796-NUM-SEX(WS-CTR) = '1'                                        
              MOVE 'M'        TO WS-SEX                                         
           ELSE                                                                 
              IF K796-NUM-SEX(WS-CTR) = '2'                                     
                 MOVE 'F'     TO WS-SEX                                         
              ELSE                                                              
                 IF K796-NUM-SEX(WS-CTR) = SPACES OR LOW-VALUES                 
                    MOVE '-'                  TO WS-SEX                         
                 ELSE                                                           
                    MOVE K796-NUM-SEX(WS-CTR) TO WS-SEX                         
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       350-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       400-PRINT-RECORD.                                                        
      *-----------------------*                                                 
           ADD 1 TO WS-K796-REC-PRINT.                                          
           PERFORM 210-READ-BP13K022         THRU 210-EXIT.                     
           PERFORM 410-PRINT-HEADING         THRU 410-EXIT.                     
           PERFORM 420-PRINT-SUB-HDG-STATUS  THRU 420-EXIT.                     
           PERFORM 425-PRINT-NEW-COMPOSITION THRU 425-EXIT.                     
                                                                                
            IF WS-ADD-TAG = 'Y' OR WS-DEL-TAG = 'Y'                             
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER1-ADD                          
            END-IF.                                                             
            IF WS-ADD-TAG = 'Y'                                                 
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER2-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER3-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER4-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER5-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER6-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER7-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER8-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER9-ADD                          
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER10-ADD                         
               WRITE PRINT-REC-C FROM L387-FOOTER11-ADD                         
               WRITE PRINT-REC-C FROM L387-FOOTER12-ADD                         
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER13-ADD                         
            END-IF.                                                             
            IF WS-DEL-TAG = 'Y'                                                 
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER2-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER3-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER4-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER5-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER6-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER7-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER8-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER9-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER10-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER11-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER12-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER13-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER14-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER15-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER16-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER7-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER8-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER9-DEL                          
               WRITE PRINT-REC-C FROM L387-FOOTER10-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER11-DEL                         
               WRITE PRINT-REC-C FROM L387-FOOTER2                              
               WRITE PRINT-REC-C FROM L387-FOOTER13-ADD                         
            END-IF.                                                             
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       410-PRINT-HEADING.                                                       
      *-----------------------*                                                 
           IF PAGE-CTR NOT = ZEROES                                             
              WRITE PRINT-REC-C FROM L387-FOOTER1                               
              WRITE PRINT-REC-C FROM L387-FOOTER2                               
           END-IF.                                                              
                                                                                
           ADD 1 TO PAGE-CTR.                                                   
                                                                                
           MOVE SPACES TO L387-SUB-REGN                                         
                          L387-SUB-DTE-REQ                                      
                          L387-SUB-TIME-REQ                                     
                          L387-SUB-CRM.                                         
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE.                  
           STRING WS-CURRENT-DATE(7:2) '/'                                      
                  WS-CURRENT-DATE(5:2) '/'                                      
                  WS-CURRENT-DATE(1:4) DELIMITED BY SIZE                        
                  INTO L387-CURRENT-DATE.                                       
           MOVE PAGE-CTR TO L387-PAGE.                                          
                                                                                
           MOVE  K796-NUM-REGN      TO L387-SUB-REGN.                           
           STRING K796-DTE-REQUESTED(7:2) '/'                                   
                  K796-DTE-REQUESTED(5:2) '/'                                   
                  K796-DTE-REQUESTED(1:4) DELIMITED BY SIZE                     
                  INTO L387-SUB-DTE-REQ.                                        
           STRING K796-TME-REQUESTED(1:2) ':'                                   
                  K796-TME-REQUESTED(3:2) ':'                                   
                  K796-TME-REQUESTED(5:2) DELIMITED BY SIZE                     
                  INTO L387-SUB-TIME-REQ.                                       
           MOVE K024-NME-OIC     TO L387-SUB-CRM.                               
                                                                                
      ****EMAIL HEADER FORMAT ****                                              
           WRITE PRINT-REC-C FROM L387-HEADER-1.                                
           WRITE PRINT-REC-C FROM L387-HEADER-2.                                
           WRITE PRINT-REC-C FROM L387-HEADER-3.                                
           WRITE PRINT-REC-C FROM L387-HEADER-4.                                
           WRITE PRINT-REC-C FROM L387-HEADER-5.                                
           WRITE PRINT-REC-C FROM L387-HEADER-6.                                
           WRITE PRINT-REC-C FROM L387-HEADER-7.                                
                                                                                
           MOVE 1          TO L387-PAGE.                                        
           WRITE PRINT-REC FROM L387-PRINT-HDG  AFTER PAGE.                     
           WRITE PRINT-REC FROM L387-HDG1       AFTER 2.                        
           WRITE PRINT-REC FROM L387-HDG1-LINE  AFTER 1.                        
                                                                                
           WRITE PRINT-REC-C FROM L387-PRINT-HDG.                               
           WRITE PRINT-REC-C FROM L387-HDG1.                                    
           WRITE PRINT-REC-C FROM L387-HDG1-LINE.                               
                                                                                
           IF WS-K796-REC-PRINT > ZEROES                                        
              WRITE PRINT-REC FROM L387-SUB-HDR1   AFTER 2                      
              WRITE PRINT-REC FROM L387-SUB-HDR2   AFTER 1                      
              WRITE PRINT-REC FROM L387-SUB-HDR3   AFTER 1                      
              WRITE PRINT-REC FROM L387-SUB-HDR4   AFTER 1                      
                                                                                
              WRITE PRINT-REC-C FROM L387-SUB-HDR1                              
              WRITE PRINT-REC-C FROM L387-SUB-HDR2                              
              WRITE PRINT-REC-C FROM L387-SUB-HDR3                              
              WRITE PRINT-REC-C FROM L387-SUB-HDR4                              
           END-IF.                                                              
                                                                                
           MOVE  SPACES        TO   PRINT-REC.                                  
           WRITE PRINT-REC AFTER 1.                                             
                                                                                
           MOVE  SPACES        TO   PRINT-REC-C.                                
           WRITE PRINT-REC-C.                                                   
           MOVE  9 TO LINE-CTR.                                                 
                                                                                
       410-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       420-PRINT-SUB-HDG-STATUS.                                                
      *-----------------------*                                                 
           MOVE SPACES TO WS-STORE-ACTION                                       
                          WS-PRT-DTL.                                           
                                                                                
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 12                 
              IF WS-SV-ACTION(WS-CTR) = 'C' OR 'D' OR 'A'                       
                 MOVE 'Y' TO WS-PRT-DTL                                         
                 IF WS-SV-ACTION(WS-CTR) = 'A'                                  
                    MOVE 'Y'      TO  WS-ADD-TAG                                
                 END-IF                                                         
                 IF WS-SV-ACTION(WS-CTR) = 'D'                                  
                    MOVE 'Y'      TO  WS-DEL-TAG                                
                 END-IF                                                         
                 IF WS-SV-ACTION(WS-CTR) NOT = WS-STORE-ACTION                  
                    PERFORM 430-PRT-SUB-HDG THRU 430-EXIT                       
                    MOVE WS-SV-ACTION(WS-CTR) TO WS-STORE-ACTION                
                    PERFORM 500-PRT-DTL     THRU 500-EXIT                       
                 ELSE                                                           
                    PERFORM 500-PRT-DTL     THRU 500-EXIT                       
                 END-IF                                                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       420-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       425-PRINT-NEW-COMPOSITION.                                               
      *-----------------------*                                                 
           MOVE SPACES TO PRT-NEW-HDG-SW                                        
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 12                 
              IF WS-PRT-DTL = 'Y'                                               
                 IF K796-NUM-UIN(WS-CTR) NOT = LOW-VALUES AND SPACES            
                    AND K796-NUM-ACTION(WS-CTR) NOT = 'D'                       
                    IF PRT-NEW-HDG-SW = SPACES                                  
                       PERFORM 540-PRT-NEW-HDG         THRU 540-EXIT            
                       MOVE 'Y' TO PRT-NEW-HDG-SW                               
                    END-IF                                                      
                    PERFORM 550-PRT-NEW-COMPOSITION    THRU 550-EXIT            
                 END-IF                                                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       425-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       430-PRT-SUB-HDG.                                                         
      *-----------------------*                                                 
           EVALUATE WS-SV-ACTION(WS-CTR)                                        
           WHEN 'A'                                                             
              PERFORM 440-PRT-ADD-HDG THRU 440-EXIT                             
           WHEN 'C'                                                             
              PERFORM 450-PRT-CHG-HDG THRU 450-EXIT                             
           WHEN 'D'                                                             
              PERFORM 460-PRT-DEL-HDG THRU 460-EXIT                             
           END-EVALUATE.                                                        
                                                                                
       430-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       440-PRT-ADD-HDG.                                                         
      *-----------------------*                                                 
           MOVE SPACES    TO L387-PRT-STAT.                                     
           MOVE '(A) ADD THE FOLLOWING NAME(S) IN MY APPLICATION'               
                          TO L387-PRT-STAT.                                     
                                                                                
           IF LINE-CTR > 46                                                     
              PERFORM 410-PRINT-HEADING         THRU 410-EXIT                   
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC FROM L387-PRINT-STATUS AFTER 2                       
           WRITE PRINT-REC FROM L387-ADD-HDG1     AFTER 1.                      
           WRITE PRINT-REC FROM L387-ADD-HDG2     AFTER 1.                      
           WRITE PRINT-REC FROM L387-ADD-HDG3     AFTER 1.                      
           WRITE PRINT-REC FROM L387-ADD-LINE     AFTER 1.                      
                                                                                
           WRITE PRINT-REC-C FROM L387-PRINT-STATUS.                            
           WRITE PRINT-REC-C FROM L387-ADD-HDG1.                                
           WRITE PRINT-REC-C FROM L387-ADD-HDG2.                                
           WRITE PRINT-REC-C FROM L387-ADD-HDG3.                                
           WRITE PRINT-REC-C FROM L387-ADD-LINE.                                
                                                                                
           ADD 6 TO LINE-CTR.                                                   
                                                                                
       440-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       450-PRT-CHG-HDG.                                                         
      *-----------------------*                                                 
           MOVE SPACES    TO L387-PRT-STAT.                                     
           MOVE '(C) TRANSFER THE STATUS OF THE FOLLOWING NAME(S) IN MY         
      -         'APPLICATION' TO L387-PRT-STAT.                                 
                                                                                
           IF LINE-CTR > 50                                                     
              PERFORM 410-PRINT-HEADING         THRU 410-EXIT                   
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC FROM L387-PRINT-STATUS AFTER 2                       
           WRITE PRINT-REC FROM L387-TRANSFER-HDG AFTER 1.                      
           WRITE PRINT-REC FROM L387-ADD-LINE     AFTER 1.                      
                                                                                
           WRITE PRINT-REC-C FROM L387-PRINT-STATUS.                            
           WRITE PRINT-REC-C FROM L387-TRANSFER-HDG.                            
           WRITE PRINT-REC-C FROM L387-ADD-LINE.                                
                                                                                
           ADD 4 TO LINE-CTR.                                                   
                                                                                
       450-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       460-PRT-DEL-HDG.                                                         
      *-----------------------*                                                 
           MOVE SPACES    TO L387-PRT-STAT.                                     
           MOVE '(B) DELETE THE FOLLOWING NAME(S) FROM MY APPLICATION'          
                          TO L387-PRT-STAT.                                     
                                                                                
           IF LINE-CTR > 50                                                     
              PERFORM 410-PRINT-HEADING         THRU 410-EXIT                   
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC FROM L387-PRINT-STATUS AFTER 2                       
           WRITE PRINT-REC FROM L387-DELETE-HDG   AFTER 1.                      
           WRITE PRINT-REC FROM L387-ADD-LINE     AFTER 1.                      
                                                                                
           WRITE PRINT-REC-C FROM L387-PRINT-STATUS.                            
           WRITE PRINT-REC-C FROM L387-DELETE-HDG.                              
           WRITE PRINT-REC-C FROM L387-ADD-LINE.                                
                                                                                
           ADD 4 TO LINE-CTR.                                                   
                                                                                
       460-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       500-PRT-DTL.                                                             
      *-----------------------*                                                 
           EVALUATE WS-SV-ACTION(WS-CTR)                                        
           WHEN 'A'                                                             
              PERFORM 510-PRT-DTL-ADD    THRU 510-EXIT                          
           WHEN 'C'                                                             
              PERFORM 520-PRT-DTL-CHANGE THRU 520-EXIT                          
           WHEN 'D'                                                             
              PERFORM 530-PRT-DTL-DELETE THRU 530-EXIT                          
           END-EVALUATE.                                                        
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       510-PRT-DTL-ADD.                                                         
      *-----------------------*                                                 
           MOVE SPACES    TO L387-ROLE                                          
                             L387-NRIC                                          
                             L387-NAME                                          
                             L387-SEX                                           
                             L387-MAR-STAT                                      
                             L387-BIRTH-DTE                                     
                             L387-CITIZENSHIP                                   
                             L387-REL-MAIN                                      
                             L387-GROSS-INCOME                                  
                             L387-SPOUSE-NRIC                                   
                             L387-EDUC-LVL                                      
                             L387-EMPLOY-STAT                                   
                             L387-OCCUPATION                                    
                             L387-RACE.                                         
                                                                                
           IF WS-SV-ROLE(WS-CTR) = LOW-VALUES OR SPACES                         
              MOVE '-'                       TO L387-ROLE                       
           ELSE                                                                 
              MOVE WS-SV-ROLE(WS-CTR)        TO L387-ROLE                       
           END-IF.                                                              
                                                                                
           MOVE WS-SV-UIN(WS-CTR)            TO L387-NRIC.                      
                                                                                
           IF WS-SV-NAME(WS-CTR) = LOW-VALUES OR SPACES                         
              MOVE '-'                       TO L387-NAME                       
           ELSE                                                                 
              MOVE WS-SV-NAME(WS-CTR)        TO L387-NAME                       
           END-IF.                                                              
                                                                                
           MOVE WS-SV-SEX(WS-CTR)            TO L387-SEX.                       
           MOVE WS-SV-MARITAL-STATUS(WS-CTR) TO L387-MAR-STAT.                  
           STRING WS-SV-DTE-BIRTH(WS-CTR) (7:2) '/'                             
                  WS-SV-DTE-BIRTH(WS-CTR) (5:2) '/'                             
                  WS-SV-DTE-BIRTH(WS-CTR) (1:4) '/'                             
                  DELIMITED BY SIZE INTO L387-BIRTH-DTE.                        
                                                                                
      **** FOLLOW DECODING FROM BP13C800 ***                                    
                                                                                
           MOVE WS-SV-SEX(WS-CTR)            TO WS-SEX.                         
           MOVE WS-SV-RLTNSP-APPLT1(WS-CTR)  TO WS-REL-MAIN.                    
           PERFORM 740-DECODE-RELATION       THRU 740-EXIT.                     
           MOVE WS-PRINT-REL-MAIN            TO L387-REL-MAIN.                  
                                                                                
           MOVE WS-SV-CITIZENSHIP(WS-CTR)    TO WS-CITIZENSHIP.                 
           PERFORM 720-CHECK-CITIZENSHIP     THRU 720-EXIT.                     
           MOVE WS-PRINT-CITIZENSHIP         TO L387-CITIZENSHIP.               
                                                                                
           IF WS-SV-AMT-INCOME(WS-CTR) > ZEROES                                 
              MOVE WS-SV-AMT-INCOME(WS-CTR)  TO WS-INCOME-EDIT                  
           ELSE                                                                 
              MOVE ZEROES                    TO WS-INCOME-EDIT                  
           END-IF.                                                              
           MOVE WS-INCOME-EDIT               TO L387-GROSS-INCOME.              
                                                                                
           IF WS-SV-SPOUSE-UIN(WS-CTR) = SPACES OR LOW-VALUES                   
              MOVE '-'                       TO L387-SPOUSE-NRIC                
           ELSE                                                                 
              MOVE WS-SV-SPOUSE-UIN(WS-CTR)  TO L387-SPOUSE-NRIC                
           END-IF.                                                              
                                                                                
           PERFORM 710-CHECK-EDN-LEVEL       THRU 710-EXIT.                     
                                                                                
           MOVE '-'                          TO L387-EMPLOY-STAT                
                                                L387-OCCUPATION                 
                                                L387-RACE.                      
                                                                                
           WRITE PRINT-REC FROM L387-ADD-DTL1 AFTER 2.                          
           WRITE PRINT-REC FROM L387-ADD-DTL2 AFTER 1.                          
                                                                                
           WRITE PRINT-REC-C FROM L387-ADD-DTL1.                                
           WRITE PRINT-REC-C FROM L387-ADD-DTL2.                                
           ADD 3 TO LINE-CTR.                                                   
                                                                                
       510-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       520-PRT-DTL-CHANGE.                                                      
      *-----------------------*                                                 
           MOVE SPACES TO L387-TRANSFER-NRIC                                    
                          L387-TRANSFER-NAME                                    
                          L387-TRANSFER-ROLE.                                   
                                                                                
           MOVE WS-SV-UIN(WS-CTR)            TO L387-TRANSFER-NRIC.             
           MOVE WS-SV-NAME(WS-CTR)           TO L387-TRANSFER-NAME.             
                                                                                
           MOVE WS-SV-ROLE(WS-CTR)           TO WS-STORE-ROLE.                  
           PERFORM 525-DECODE-ROLE           THRU 525-EXIT.                     
           MOVE WS-PRINT-ROLE                TO L387-TRANSFER-ROLE.             
                                                                                
           WRITE PRINT-REC FROM L387-TRANSFER-DTL1 AFTER 1.                     
           WRITE PRINT-REC-C FROM L387-TRANSFER-DTL1.                           
                                                                                
           ADD 1 TO LINE-CTR.                                                   
                                                                                
       520-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       525-DECODE-ROLE.                                                         
      *-----------------------*                                                 
           EVALUATE WS-STORE-ROLE                                               
           WHEN 'APPL'                                                          
               MOVE 'MAIN APPLICANT'         TO WS-PRINT-ROLE                   
           WHEN 'COAPP'                                                         
               MOVE 'CO-APPLICANT'           TO WS-PRINT-ROLE                   
           WHEN 'OCC'                                                           
               MOVE 'OCCUPIER'               TO WS-PRINT-ROLE                   
           WHEN SPACES                                                          
               MOVE '-'                      TO WS-PRINT-ROLE                   
           WHEN OTHER                                                           
               MOVE WS-STORE-ROLE            TO WS-PRINT-ROLE                   
           END-EVALUATE.                                                        
                                                                                
       525-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       530-PRT-DTL-DELETE.                                                      
      *-----------------------*                                                 
           MOVE SPACES TO L387-TRANSFER-NRIC                                    
                          L387-TRANSFER-NAME.                                   
                                                                                
           MOVE WS-SV-UIN(WS-CTR)            TO L387-DEL-NRIC.                  
           MOVE WS-SV-NAME(WS-CTR)           TO L387-DEL-NAME.                  
                                                                                
           WRITE PRINT-REC FROM L387-DEL-DTL1 AFTER 1.                          
           WRITE PRINT-REC-C FROM L387-DEL-DTL1.                                
           ADD 1 TO LINE-CTR.                                                   
                                                                                
       530-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       540-PRT-NEW-HDG.                                                         
      *-----------------------*                                                 
           IF (PRT-NEW-HDG-SW = SPACES OR LINE-CTR > 52)                        
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 540-EXIT                                                    
           END-IF.                                                              
                                                                                
           MOVE SPACES    TO L387-PRT-STAT.                                     
           MOVE '(D) NEW COMPOSITION OF THE APPLICANTS/OCCUPIERS'               
                          TO L387-PRT-STAT.                                     
                                                                                
           IF LINE-CTR > 46                                                     
              PERFORM 410-PRINT-HEADING         THRU 410-EXIT                   
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC FROM L387-PRINT-STATUS AFTER 2                       
           WRITE PRINT-REC FROM L387-NEW-HDG1     AFTER 1.                      
           WRITE PRINT-REC FROM L387-NEW-HDG2     AFTER 1.                      
           WRITE PRINT-REC FROM L387-NEW-HDG3     AFTER 1.                      
           WRITE PRINT-REC FROM L387-ADD-LINE     AFTER 1.                      
                                                                                
           WRITE PRINT-REC-C FROM L387-PRINT-STATUS.                            
           WRITE PRINT-REC-C FROM L387-NEW-HDG1.                                
           WRITE PRINT-REC-C FROM L387-NEW-HDG2.                                
           WRITE PRINT-REC-C FROM L387-NEW-HDG3.                                
           WRITE PRINT-REC-C FROM L387-ADD-LINE.                                
                                                                                
           ADD 6 TO LINE-CTR.                                                   
                                                                                
       540-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       550-PRT-NEW-COMPOSITION.                                                 
      *-----------------------*                                                 
           PERFORM 540-PRT-NEW-HDG THRU 540-EXIT                                
                                                                                
           MOVE SPACES TO L387-NEW-ROLE                                         
                          L387-NEW-NAME                                         
                          L387-NEW-NRIC                                         
                          L387-NEW-MAR-STAT                                     
                          L387-NEW-CITIZEN                                      
                          L387-NEW-REL-MAIN.                                    
                                                                                
           MOVE K796-NUM-ROLE(WS-CTR)           TO WS-STORE-ROLE.               
           PERFORM 525-DECODE-ROLE              THRU 525-EXIT.                  
           MOVE WS-PRINT-ROLE                   TO L387-NEW-ROLE.               
                                                                                
           MOVE K796-NME-OCCP(WS-CTR)           TO L387-NEW-NAME.               
           MOVE K796-NUM-UIN(WS-CTR)            TO L387-NEW-NRIC.               
                                                                                
           PERFORM 350-DECODE-SEX-STATUS        THRU 350-EXIT.                  
           MOVE WS-PRINT-MAR-STAT               TO   L387-NEW-MAR-STAT.         
                                                                                
           MOVE K796-NUM-CITIZENSHIP(WS-CTR)    TO   WS-CITIZENSHIP.            
           PERFORM 720-CHECK-CITIZENSHIP        THRU 720-EXIT.                  
           MOVE WS-PRINT-CITIZENSHIP         TO L387-NEW-CITIZEN.               
                                                                                
           MOVE K796-NUM-RLTNSP-APPLT1(WS-CTR)  TO   WS-REL-MAIN.               
           PERFORM 740-DECODE-RELATION          THRU 740-EXIT.                  
           MOVE WS-PRINT-REL-MAIN               TO   L387-NEW-REL-MAIN.         
                                                                                
           WRITE PRINT-REC      FROM L387-NEW-DTL1 AFTER 2.                     
           WRITE PRINT-REC      FROM L387-NEW-DTL2 AFTER 1.                     
                                                                                
           WRITE PRINT-REC-C    FROM L387-NEW-DTL1.                             
           WRITE PRINT-REC-C    FROM L387-NEW-DTL2.                             
           ADD 3 TO LINE-CTR.                                                   
                                                                                
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       600-REWRITE-BP13K796.                                                    
      *-----------------------*                                                 
           MOVE 'Y' TO K796-NUM-PRINTED.                                        
                                                                                
           REWRITE BP13K796-REC.                                                
                                                                                
           IF BP13K796-STATUS = '00'                                            
              ADD 1       TO WS-K796-REC-REWRITE                                
           ELSE                                                                 
              DISPLAY 'ERROR IN UPDATING FILE BP13K796 STATUS: '                
                      BP13K796-STATUS ' KEY - ' K796-NUM-REGN                   
              MOVE BP13K796-STATUS TO   RETURN-CODE                             
              PERFORM 900-CLOSE-ROUTINE THRU 900-EXIT                           
           END-IF.                                                              
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       700-CHECK-RLTNSP.                                                        
      *-----------------------*                                                 
      *-TO SEGGREGATE RELATIONSHIP BASED ON SEX OF APPLNT/OCCPR--*              
                                                                                
           EVALUATE WS-REL-MAIN                                                 
           WHEN '20'                                                            
           WHEN '20 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'HUSBAND'          TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'WIFE'             TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'HUSBAND/WIFE'     TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
           WHEN '41'                                                            
           WHEN '41 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'SON'              TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'DAUGHTER'         TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'SON/DAUGHTER'     TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
           WHEN '09'                                                            
           WHEN '09 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'FIANCE'           TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'FIANCEE'          TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'FIANCE/FIANCEE'   TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
           WHEN '06'                                                            
           WHEN '06 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'BROTHER'          TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'SISTER'           TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'BROTHER/SISTER'   TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
           WHEN '42'                                                            
           WHEN '42 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'SON-IN-LAW'          TO WS-PRINT-REL-MAIN            
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'DAUGHTER-IN-LAW'     TO WS-PRINT-REL-MAIN            
                WHEN OTHER                                                      
                     MOVE 'SON/DAUGHTER-IN-LAW' TO WS-PRINT-REL-MAIN            
              END-EVALUATE                                                      
           WHEN '01'                                                            
           WHEN '01 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'GRAND-FATHER'        TO WS-PRINT-REL-MAIN            
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'GRAND-MOTHER'        TO WS-PRINT-REL-MAIN            
                WHEN OTHER                                                      
                     MOVE 'GRAND-FATHER/MOTHER' TO WS-PRINT-REL-MAIN            
                END-EVALUATE                                                    
           WHEN '43'                                                            
           WHEN '43 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'GRAND-SON'          TO WS-PRINT-REL-MAIN             
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'GRAND-DAUGHTER'     TO WS-PRINT-REL-MAIN             
                WHEN OTHER                                                      
                     MOVE 'GRAND-SON/DAUGHTER' TO WS-PRINT-REL-MAIN             
                END-EVALUATE                                                    
           WHEN '07'                                                            
           WHEN '07 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'BROTHER-IN-LAW'      TO WS-PRINT-REL-MAIN            
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'SISTER-IN-LAW'       TO WS-PRINT-REL-MAIN            
                WHEN OTHER                                                      
                   MOVE 'BROTHER/SISTER-IN-LAW' TO WS-PRINT-REL-MAIN            
                END-EVALUATE                                                    
           WHEN '03'                                                            
           WHEN '03 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'UNCLE'            TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'AUNT'             TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'UNCLE/AUNT'       TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
           WHEN '21'                                                            
           WHEN '21 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'GRAND-FATHER-IN-LAW' TO WS-PRINT-REL-MAIN            
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'GRAND-MOTHER-IN-LAW' TO WS-PRINT-REL-MAIN            
                WHEN OTHER                                                      
                     MOVE 'GRAND-MOTHER/FATHER-IN-LAW'                          
                                                TO WS-PRINT-REL-MAIN            
                END-EVALUATE                                                    
           WHEN '08'                                                            
           WHEN '08 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'NEPHEW'           TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'NIECE'            TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'NEPHEW/NIECE'     TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
           WHEN '38'                                                            
           WHEN '38 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'ADOPTIVE-FATHER'  TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'ADOPTIVE-MOTHER'  TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'ADOPTIVE-FATHER/MOTHER'                              
                                             TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
           WHEN '39'                                                            
           WHEN '39 '                                                           
                EVALUATE WS-SEX                                                 
                WHEN 'M'                                                        
                WHEN 'M  '                                                      
                     MOVE 'ADOPTED-SON'      TO WS-PRINT-REL-MAIN               
                WHEN 'F'                                                        
                WHEN 'F  '                                                      
                     MOVE 'ADOPTED-DAUGHTER' TO WS-PRINT-REL-MAIN               
                WHEN OTHER                                                      
                     MOVE 'ADOPTED-SON/DAUGHTER'                                
                                             TO WS-PRINT-REL-MAIN               
                END-EVALUATE                                                    
                                                                                
           WHEN '47'                                                            
           WHEN '47 '                                                           
                MOVE 'UNRELATED'             TO WS-PRINT-REL-MAIN               
                                                                                
           WHEN OTHER                                                           
                MOVE K060-DESC               TO WS-PRINT-REL-MAIN               
           END-EVALUATE.                                                        
                                                                                
           IF WS-PRINT-REL-MAIN = SPACES OR LOW-VALUES                          
              MOVE '-' TO WS-PRINT-REL-MAIN                                     
           END-IF.                                                              
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       710-CHECK-EDN-LEVEL.                                                     
      *-----------------------*                                                 
           EVALUATE WS-SV-EDN-LVL(WS-CTR)                                       
           WHEN '0'                                                             
              MOVE 'NO FORMAL EDUCATION'    TO L387-EDUC-LVL                    
           WHEN '1'                                                             
              MOVE 'PRIMARY'                TO L387-EDUC-LVL                    
           WHEN '2'                                                             
              MOVE 'SECONDARY/INST OF TECHNICAL EDUC'                           
                                            TO L387-EDUC-LVL                    
           WHEN '3'                                                             
              MOVE 'PRE UNIVERSITY/JUNIOR COLLEGE'                              
                                            TO L387-EDUC-LVL                    
           WHEN '4'                                                             
              MOVE 'POLYTECHNIC/OTHER DIPLOMA HOLDER'                           
                                            TO L387-EDUC-LVL                    
           WHEN '5'                                                             
              MOVE 'UNIVERSITY/POST GRADUATE'                                   
                                            TO L387-EDUC-LVL                    
           WHEN SPACES                                                          
              MOVE '-'                      TO L387-EDUC-LVL                    
           WHEN OTHER                                                           
              MOVE WS-SV-EDN-LVL(WS-CTR)    TO L387-EDUC-LVL                    
           END-EVALUATE.                                                        
                                                                                
       710-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       720-CHECK-CITIZENSHIP.                                                   
      *-----------------------*                                                 
           MOVE SPACES                      TO    K060-KEY-FLD.                 
           INITIALIZE                             K060-KEY-FLD.                 
                                                                                
           MOVE          25                 TO    K060-SERIAL-NO                
           MOVE WS-CITIZENSHIP              TO    K060-CODE                     
           PERFORM 730-READ-BP13K060        THRU  730-EXIT                      
                                                                                
           IF BP13K060-STATUS = 00                                              
              MOVE K060-DESC                TO   WS-PRINT-CITIZENSHIP           
           ELSE                                                                 
              MOVE '-'                      TO   WS-PRINT-CITIZENSHIP           
           END-IF.                                                              
                                                                                
       720-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       730-READ-BP13K060.                                                       
      *-----------------------*                                                 
      *---GETTING CODE TRANSCRIPTION-------------------------------*            
                                                                                
           READ BP13K060.                                                       
                                                                                
           EVALUATE BP13K060-STATUS                                             
           WHEN 00                                                              
                CONTINUE                                                        
           WHEN 23                                                              
                DISPLAY 'BP13K060 RECORD NOT FOUND :' K060-KEY-FLD              
           WHEN OTHER                                                           
                DISPLAY 'BP13K060 READ FILE ERROR STATUS: '                     
                    BP13K060-STATUS 'KEY - ' K060-KEY-FLD                       
                PERFORM 900-CLOSE-ROUTINE THRU 900-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       730-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       740-DECODE-RELATION.                                                     
      *-----------------------*                                                 
            IF WS-REL-MAIN = SPACES OR LOW-VALUES                               
               MOVE '-'                     TO   WS-PRINT-REL-MAIN              
            ELSE                                                                
               MOVE SPACES                  TO   K060-KEY-FLD                   
               INITIALIZE                        K060-KEY-FLD                   
                                                                                
               MOVE  35                     TO   K060-SERIAL-NO                 
               MOVE WS-REL-MAIN             TO   K060-CODE                      
               PERFORM 730-READ-BP13K060    THRU 730-EXIT                       
               IF BP13K060-STATUS = 00                                          
                  PERFORM 700-CHECK-RLTNSP  THRU 700-EXIT                       
               ELSE                                                             
                  MOVE WS-REL-MAIN          TO   WS-PRINT-REL-MAIN              
               END-IF                                                           
            END-IF.                                                             
                                                                                
       740-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       800-PRINT-CTRL-DTL.                                                      
      *-----------------------*                                                 
           IF LINE-CTRL-CTR > 59                                                
              PERFORM 810-PRINT-CTRL-HDG THRU 810-EXIT                          
           END-IF.                                                              
                                                                                
           MOVE SPACES TO L387-CTRL-REGN                                        
                          L387-CTRL-DTE-REQ                                     
                          L387-CTRL-TIME-REQ                                    
           MOVE ZEROES TO L387-SER-NO.                                          
                                                                                
           MOVE  WS-K796-REC-PRINT  TO L387-SER-NO.                             
           MOVE  K796-NUM-REGN      TO L387-CTRL-REGN.                          
                                                                                
           STRING K796-DTE-REQUESTED(7:2) '/'                                   
                  K796-DTE-REQUESTED(5:2) '/'                                   
                  K796-DTE-REQUESTED(1:4) DELIMITED BY SIZE                     
                  INTO L387-CTRL-DTE-REQ.                                       
                                                                                
           STRING K796-TME-REQUESTED(1:2) ':'                                   
                  K796-TME-REQUESTED(3:2) ':'                                   
                  K796-TME-REQUESTED(5:2) DELIMITED BY SIZE                     
                  INTO L387-CTRL-TIME-REQ.                                      
                                                                                
           WRITE PRINT-REC-B FROM L387-CTRL-DTL  AFTER 1.                       
           ADD   1  TO  LINE-CTRL-CTR.                                          
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       810-PRINT-CTRL-HDG.                                                      
      *-----------------------*                                                 
           ADD  1             TO PAGE-CTRL-CTR.                                 
           MOVE PAGE-CTRL-CTR TO L387-PAGE.                                     
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE.                  
           STRING WS-CURRENT-DATE(7:2) '/'                                      
                  WS-CURRENT-DATE(5:2) '/'                                      
                  WS-CURRENT-DATE(1:4) DELIMITED BY SIZE                        
                  INTO L387-CURRENT-DATE.                                       
                                                                                
           WRITE PRINT-REC-B FROM L387-PRINT-HDG      AFTER PAGE.               
           WRITE PRINT-REC-B FROM L387-CTRL-HDG       AFTER 2.                  
           WRITE PRINT-REC-B FROM L387-HDG-CTRL-LINE  AFTER 1.                  
           WRITE PRINT-REC-B FROM L387-CTRL-SUB-HDG   AFTER 2.                  
           WRITE PRINT-REC-B FROM L387-CTRL-LINE      AFTER 1.                  
                                                                                
           MOVE  SPACES      TO    PRINT-REC-B.                                 
           WRITE PRINT-REC-B AFTER 1.                                           
           MOVE  8           TO    LINE-CTRL-CTR.                               
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-----------------------*                                                 
       900-CLOSE-ROUTINE.                                                       
      *-----------------------*                                                 
           CLOSE    BP13K060                                            02260061
                    BP13K796                                            02260061
                    BP13K022                                                    
                    BP13K024                                                    
                    BP13L387                                            02270061
                    P13L387B                                            02270061
                    P13L387C.                                           02270061
                                                                                
           DISPLAY '****BP13C387 CONTROL REPORT *******'                        
           DISPLAY 'NO OF K796 RECS READ     : ' WS-K796-REC-READ.      02280068
           DISPLAY 'NO OF K796 RECS PRINTED  : ' WS-K796-REC-PRINT.     02280068
           DISPLAY 'NO OF K796 RECS REWRITTEN: ' WS-K796-REC-REWRITE.   02280068
           DISPLAY '***********************************'                        
                                                                                
           IF BP13K060-STATUS NOT = '00'                                02340061
              DISPLAY '***  CLOSING ERROR   BP13K060-STATUS - '         02350061
              BP13K060-STATUS.                                          02360061
                                                                                
           IF BP13K796-STATUS NOT = '00'                                02340061
              DISPLAY '***  CLOSING ERROR   BP13K796-STATUS - '         02350061
              BP13K796-STATUS.                                          02360061
                                                                                
           IF BP13K022-STATUS NOT = '00'                                02340061
              DISPLAY '***  CLOSING ERROR   BP13K022-STATUS - '         02350061
              BP13K022-STATUS.                                          02360061
                                                                                
           IF BP13K024-STATUS NOT = '00'                                02340061
              DISPLAY '***  CLOSING ERROR   BP13K024-STATUS - '         02350061
              BP13K024-STATUS.                                          02360061
                                                                                
           STOP RUN.                                                    02410061
                                                                        02420061
       900-EXIT.                                                        02430061
           EXIT.                                                                
