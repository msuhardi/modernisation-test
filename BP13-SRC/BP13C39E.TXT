       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C39E.                                                 
      *AUTHOR.        LIZ PATIAG.                                               
      *DATE-WRITTEN.  08/08/2016.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      *    OBJECTIVE  :                                            *            
      *        1.  THIS PROGRAMME WILL CREATE THE GL DETAIL        *            
      *            TRANSACTION FILE BP13F180 FOR SERS AND RELOCATION            
      *            GRANT (ON KEY-ISSUED-MONTH)                     *            
      *            FOR LBS AND 2-ROOM FLEXI CASES                  *            
      *     INPUT FILES:  1. BP13F120                              *            
      *                   2. BP13K690 - FOR GRANTS                 *            
      *     OUTPUT FILES: 1. BP13F180                              *            
      *     LISTING:      1. BP13L39E (CONTROL LIST)               *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG-NO   BY   DATE     DESCRIPTION                         *            
      * -------  ---  ------   -----------                         *            
      * BP136398 FNP1 08082016  NEW PGM (SIMILAR TO BP13C39C)      *            
      * BP137219 FNP1 19022018  CATER FOR FSG GRANT                *            
      * BP137181 FNP1 29062018  CHANGE 'FS' TO 'SE' FOR F180-JR-SC *            
      * BP138083 KR13 18012020  ADDED EHG                          *            
      * BP138560 FP6  28122020  ADDED LHG                          *            
      * BP138663 FP6  28062021  CATER FOR AMORTISATION FOR CCA FLAT*            
      * BP138944 FP6  14102021  EXPAND K690 FROM 600 TO 800        *            
      *                         ADDED SUG                          *            
      * ********************************************************** *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F120 ASSIGN TO  BP13F120.                                 
                                                                                
           SELECT SY02F001 ASSIGN TO  SY02F001.                                 
                                                                                
           SELECT BP13F180 ASSIGN TO BP13F180.                                  
                                                                                
           SELECT BP13K690 ASSIGN       TO BP13K690                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K690-KEY-FLD                         
                           FILE STATUS  IS K690-STATUS.                         
                                                                                
           SELECT BP13L39E ASSIGN TO BP13L39E.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F120                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F120.                                                           
                                                                                
       FD  BP13F180                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 120 CHARACTERS                                       
           RECORDING MODE F                                                     
           LABEL RECORDS ARE OMITTED.                                           
       COPY BP13F180.                                                           
                                                                                
       FD  BP13K690                                                             
           RECORD CONTAINS 800 CHARACTERS.                                      
       COPY BP13K690.                                                           
                                                                                
       FD BP13L39E                                                              
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE F                                                     
           DATA RECORD IS BP13L39E-REPORT.                                      
       01  BP13L39E-REPORT               PIC X(132).                            
                                                                                
       COPY SY02F001.                                                           
                                                                                
      *                                                                         
       WORKING-STORAGE SECTION.                                                 
       01  WS-F120-EOF-FLAG               PIC X          VALUE 'N'.             
       01  WS-F180-EOF-FLAG               PIC X          VALUE 'N'.             
       01  K690-STATUS                    PIC 99         VALUE 0.               
       01  WS-K690-FOUND                  PIC X          VALUE 'N'.             
                                                                                
       01  WS-DEFER-INCOME-VARS.                                                
          05  WS-CR-AMORT-AMT-SRG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SRG-CCA     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-REG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-REG-CCA     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-AHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-EHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-EHG-CCA     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-LHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-LHG-CCA     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SUG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SUG-CCA     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-FSG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-SRG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SRG-CCA         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-REG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-REG-CCA         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-AHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-EHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-EHG-CCA         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-LHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-LHG-CCA         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SUG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SUG-CCA         PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-FSG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-GL-SRG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SRG-CCA            PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-REG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-REG-CCA            PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-AHG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-EHG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-EHG-CCA            PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-LHG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-LHG-CCA            PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SUG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SUG-CCA            PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SHG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-FSG                PIC X(13)       VALUE SPACES.         
                                                                                
       01  WS-AMORT-INCOME-VARS.                                                
          05  WS-DR-AMORT-AMT-SRG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SRG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SRG-VRL-CCA PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-REG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-REG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-REG-VRL-CCA PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-AHG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-AHG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-EHG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-EHG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-EHG-VRL-CCA PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-LHG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-LHG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-LHG-VRL-CCA PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SUG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SUG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SUG-VRL-CCA PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SHG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SHG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-FSG-SA      PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-FSG-VRL     PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-SRG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SRG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SRG-VRL-CCA     PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-REG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-REG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-REG-VRL-CCA     PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-AHG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-AHG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-EHG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-EHG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-EHG-VRL-CCA     PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-LHG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-LHG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-LHG-VRL-CCA     PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SUG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SUG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SUG-VRL-CCA     PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SHG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SHG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-FSG-SA          PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-FSG-VRL         PIC 9(3)        VALUE ZEROS.          
          05  WS-GL-SRG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-SRG-VRL               PIC X(13)       VALUE SPACES.         
          05  WS-GL-SRG-VRL-CCA           PIC X(13)       VALUE SPACES.         
          05  WS-GL-REG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-REG-VRL               PIC X(13)       VALUE SPACES.         
          05  WS-GL-REG-VRL-CCA           PIC X(13)       VALUE SPACES.         
          05  WS-GL-AHG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-AHG-VRL               PIC X(13)       VALUE SPACES.         
          05  WS-GL-EHG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-EHG-VRL               PIC X(13)       VALUE SPACES.         
          05  WS-GL-EHG-VRL-CCA           PIC X(13)       VALUE SPACES.         
          05  WS-GL-LHG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-LHG-VRL               PIC X(13)       VALUE SPACES.         
          05  WS-GL-LHG-VRL-CCA           PIC X(13)       VALUE SPACES.         
          05  WS-GL-SUG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-SUG-VRL               PIC X(13)       VALUE SPACES.         
          05  WS-GL-SUG-VRL-CCA           PIC X(13)       VALUE SPACES.         
          05  WS-GL-SHG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-SHG-VRL               PIC X(13)       VALUE SPACES.         
          05  WS-GL-FSG-SA                PIC X(13)       VALUE SPACES.         
          05  WS-GL-FSG-VRL               PIC X(13)       VALUE SPACES.         
                                                                                
       01  WS-CR-TOT                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-DR-TOT                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-CR-CASES                    PIC 9(5)       VALUE ZEROS.           
       01  WS-DR-CASES                    PIC 9(5)       VALUE ZEROS.           
       01  WS-READ-F120-COUNT             PIC 9(5)       VALUE ZEROS.           
       01  WS-WRITE-F180-COUNT            PIC 9(5)       VALUE ZEROS.           
       01  WS-WITH-GRANT                  PIC 9(5)       VALUE ZEROS.           
       01  K690-FND-CNT                   PIC 9(5)       VALUE ZEROS.           
       01  K690-NFND-CNT                  PIC 9(5)       VALUE ZEROS.           
       01  WS-F180-PERIOD                 PIC 9(2)       VALUE ZEROS.           
       01  WS-TOT-F180-CREDIT             PIC 9(5)       VALUE ZEROS.           
       01  WS-TOT-F180-DEBIT              PIC 9(5)       VALUE ZEROS.           
       01  WS-PAGE-COUNT                  PIC 99         VALUE ZEROS.           
       01  WS-YEAR                        PIC 999.                              
       01  WS-LEAP-YEAR                   PIC 99.                               
       01  WS-ODD-MONTH                   PIC 9.                                
       01  WS-MONTH                       PIC X(2).                             
           88  CHECK-MM         VALUE '04' '06' '09' '11'.                      
           88  CHECK-FEB        VALUE '02'.                                     
       01  SY02F001-EOF                   PIC X(01)    VALUE 'N'.               
                                                                                
       01  WS-GL-ACCT-VARS.                                                     
           05 WS-ACC-NO1.                                                       
              10 WS-ACC-LEAD              PIC X(01).                            
              10 WS-ACC-INTERNAL          PIC X(06).                            
              10 WS-ACC-FILLER            PIC X(02).                            
              10 WS-ACC-GL                PIC X(04).                            
                                                                                
      ****************************************************************          
      *    WORKING STORAGE FOR SYSTEM DATE FOR EDITING INTO REPORT   *          
      *    DATE.                                                     *          
      ****************************************************************          
       01  WS-CURRENT-DATE.                                                     
           05 CURRENT-CC                  PIC 99.                               
           05 CURRENT-YY                  PIC 99.                               
           05 CURRENT-MM                  PIC 99.                               
           05 CURRENT-DD                  PIC 99.                               
      ****************************************************************          
      *    GET K160-DTE-OPEN-BF AS GL TRANS DATE FOR MONTH           *          
      ****************************************************************          
       01  WS-F180-TRANS-DATE.                                                  
           05 WS-F180-TRANS-CCYY          PIC 9(4).                             
           05 WS-F180-TRANS-CCYY-N REDEFINES WS-F180-TRANS-CCYY.                
              10 WS-F180-TRANS-CC         PIC 99.                               
              10 WS-F180-TRANS-YY         PIC 99.                               
           05 WS-F180-TRANS-MM            PIC 99.                               
           05 WS-F180-TRANS-DD            PIC 99.                               
                                                                                
      ****************************************************************          
      *    PAGE TITLE FOR REPORT BP13L39E.                           *          
      ****************************************************************          
       01  WS-TITLE-1.                                                          
           05  FILLER               PIC X(8)     VALUE 'BP13L39E'.              
           05  FILLER               PIC X(6)     VALUE SPACES.                  
           05  FILLER               PIC X(4)     VALUE 'HDB3'.                  
           05  FILLER               PIC X(28)    VALUE SPACES.                  
           05  FILLER               PIC X(39)    VALUE                          
           'S Y S T E M   O F   C O M M I T M E N T'.                           
           05  FILLER               PIC X(13)    VALUE SPACES.                  
           05  FILLER               PIC X(7)     VALUE 'DATE : '.               
           05  L39E-EDITED-DATE.                                                
               10  CURRENT-DD       PIC 99.                                     
               10  FILLER           PIC X        VALUE '/'.                     
               10  CURRENT-MM       PIC 99.                                     
               10  FILLER           PIC X        VALUE '/'.                     
               10  CURRENT-CC       PIC 99.                                     
               10  CURRENT-YY       PIC 99.                                     
           05  FILLER               PIC X(3)     VALUE SPACES.                  
           05  FILLER               PIC X(7)     VALUE 'PAGE : '.               
           05  L39E-PAGE            PIC ZZZZ9.                                  
                                                                                
       01  WS-TITLE-2.                                                          
           05  FILLER                     PIC X(37)      VALUE SPACES.          
           05  FILLER                     PIC X(57)      VALUE                  
            'REPORT ON DEBITS AND CREDITS TO AND FROM CLEARING ACCOUNT'.        
           05  FILLER                     PIC X(38)      VALUE SPACES.          
                                                                                
       01  WS-TITLE-3.                                                          
           05  FILLER                     PIC X(48)      VALUE SPACES.          
           05  FILLER                     PIC X(36)      VALUE                  
            'BP13F120 AND GENERAL LEDGER BP13F180'.                             
           05  FILLER                     PIC X(48)      VALUE SPACES.          
                                                                                
      ******************************************************************        
      *    HEADERS FOR TOTAL NUMBER OF RECORDS READ/WRITTEN FROM/TO    *        
      *    FILES BP13F120 AND BP13F180.                                *        
      ******************************************************************        
       01  WS-HEADER-LINE-1.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  L39E-READ-F120-CNT         PIC ZZZZ9.                            
           05  FILLER                     PIC X(44)      VALUE                  
               ' RECORDS READ FROM CLEARING ACCOUNT BP13F120'.                  
           05  FILLER                     PIC X(53)      VALUE SPACES.          
                                                                                
       01  WS-HEADER-LINE-2.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  L39E-WRITE-F180-CNT        PIC ZZZZ9.                            
           05  FILLER                     PIC X(44)      VALUE                  
               ' RECORDS WRITTEN TO GENERAL LEDGER  BP13F180'.                  
           05  FILLER                     PIC X(53)      VALUE SPACES.          
      ******************************************************************        
      *    SUMMARY OF NUMBER OF CREDITS AND DEBITS RECORDS TRANSFERED  *        
      *    ACCORDING TO PAYMENT TYPES.                                 *        
      ******************************************************************        
       01  WS-SUMMARY-HEADER-1.                                                 
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(44)      VALUE                  
               'SUMMARY OF RECORDS WRITTEN TO GENERAL LEDGER'.                  
           05  FILLER                     PIC X(58)      VALUE SPACES.          
                                                                                
       01  WS-SUMMARY-HEADER-2.                                                 
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(20)      VALUE                  
               'PAYMENT TYPE        '.                                          
           05  FILLER                     PIC X(4)       VALUE SPACES.          
           05  FILLER                     PIC X(6)       VALUE                  
               'DEBITS'.                                                        
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(7)       VALUE                  
               'CREDITS'.                                                       
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(15)      VALUE                  
               'AMT DEBITED ($)'.                                               
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(15)      VALUE                  
               'AMT CREDITED($)'.                                               
           05  FILLER                     PIC X(26)      VALUE SPACES.          
                                                                                
       01  WS-SUMMARY-DETAIL-1.                                                 
           05  FILLER                     PIC X(20)      VALUE SPACES.          
           05  L39E-AMORT-DESC1           PIC X(16)      VALUE SPACES.          
           05  FILLER                     PIC X          VALUE '('.             
           05  L39E-DEFER-GL              PIC X(13)      VALUE SPACES.          
           05  FILLER                     PIC X(1)       VALUE ')'.             
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  L39E-DR-CASES              PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L39E-CR-CASES              PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L39E-DR-DEFER-DEBIT        PIC ZZZZZZZZZZ9.99.                   
           05  FILLER                     PIC X(02)      VALUE SPACES.          
           05  L39E-CR-DEFER-CREDIT       PIC ZZZZZZZZZZ9.99.                   
                                                                                
       01  WS-SUMMARY-DETAIL-2.                                                 
           05  FILLER                     PIC X(20)      VALUE SPACES.          
           05  L39E-AMORT-DESC            PIC X(16)      VALUE SPACES.          
           05  FILLER                     PIC X          VALUE '('.             
           05  L39E-AMORT-GL              PIC X(13)      VALUE SPACES.          
           05  FILLER                     PIC X(1)       VALUE ')'.             
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  L39E-DR-AMORT-CASES        PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L39E-CR-AMORT-CASES        PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L39E-DR-AMORT-DEBIT        PIC ZZZZZZZZZZ9.99.                   
           05  FILLER                     PIC X(02)      VALUE SPACES.          
           05  L39E-CR-AMORT-CREDIT       PIC ZZZZZZZZZZ9.99.                   
                                                                                
       01  WS-FOOTER-LINE-1.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(20)      VALUE                  
               'TOTAL               '.                                          
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  L39E-DR-CASES-TOT          PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  L39E-CR-CASES-TOT          PIC ZZZZ9.                            
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  L39E-DR-TOT                PIC ZZZZZZZZZ9.99.                    
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  L39E-CR-TOT                PIC ZZZZZZZZZ9.99.                    
           05  FILLER                     PIC X(26)      VALUE SPACES.          
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       000-MAINT-ROUTINE.                                                       
                                                                                
           PERFORM 100-OPEN-FILE             THRU 100-EXIT.                     
           PERFORM 200-READ-F120             THRU 200-EXIT.                     
           PERFORM 300-PROCESS-GLTRAN-DETAIL THRU 300-EXIT                      
                   UNTIL WS-F120-EOF-FLAG = 'Y'.                                
           PERFORM 700-PRINT-REPORT          THRU 700-EXIT.                     
           PERFORM 999-CLOSE-FILES           THRU 999-EXIT.                     
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ***************************************************************           
      *    OPENING FILES SECTION                                    *           
      ***************************************************************           
       100-OPEN-FILE.                                                           
           OPEN INPUT BP13F120                                                  
                      BP13K690                                                  
                      SY02F001                                                  
               OUTPUT BP13F180                                                  
                      BP13L39E.                                                 
                                                                                
           IF K690-STATUS NOT = 00 AND 97                                       
              MOVE K690-STATUS          TO RETURN-CODE                          
              DISPLAY 'ERROR OPENING BM06K690 FILE ' K690-STATUS                
              GO TO 999-CLOSE-FILES.                                            
                                                                                
           READ SY02F001 AT END MOVE 'Y' TO SY02F001-EOF.                       
           IF SY02F001-EOF = 'Y'                                                
              DISPLAY 'RECORD NOT FOUND IN SY02F001.'                           
              DISPLAY 'PROCESSING TERMINATED.'                                  
              PERFORM 999-CLOSE-FILES                                           
           ELSE                                                                 
              MOVE F001-DTE-CURRENT TO WS-F180-TRANS-DATE                       
           END-IF.                                                              
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    READ FILE BP13F120 FROM THE BEGINING                       *         
      *****************************************************************         
       200-READ-F120.                                                           
                                                                                
           READ BP13F120  AT END                                                
                MOVE 'Y' TO WS-F120-EOF-FLAG                                    
                GO TO 200-EXIT.                                                 
           PERFORM 600-CHK-PERIOD    THRU 600-EXIT.                             
           PERFORM 610-CHK-TRAN-DTE  THRU 610-EXIT.                             
           ADD 1 TO WS-READ-F120-COUNT.                                         
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    CHECKS FOR THE PAYMENT TYPE AND TRANSFER CONTROL TO CHECK   *        
      *    FOR TRANSACTION TYPE.                                       *        
      ******************************************************************        
       300-PROCESS-GLTRAN-DETAIL.                                               
                                                                                
           IF F120-CDE-PAYMENT-TYPE = 'VRL' OR 'SA'                             
              PERFORM 330-READ-BP13K690   THRU 330-EXIT                         
              IF WS-K690-FOUND = 'Y'                                            
                 IF K690-AMT-AHG-GRANT NOT = ZEROES OR                          
                    K690-AMT-EHG-GRANT NOT = ZEROES OR                          
                    K690-AMT-LHG-GRANT NOT = ZEROES OR                          
                    K690-AMT-SHG-GRANT NOT = ZEROES OR                          
                    K690-AMT-SRG-GRANT NOT = ZEROES OR                          
                    K690-AMT-REG-GRANT NOT = ZEROES OR                          
                    K690-AMT-FSG-GRANT NOT = ZEROES OR                          
                    K690-AMT-SUG-GRANT NOT = ZEROES                             
                    ADD 1 TO WS-WITH-GRANT                                      
                    PERFORM 420-CR-GRANT       THRU 420-EXIT                    
                    PERFORM 520-DR-GRANT       THRU 520-EXIT                    
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 200-READ-F120          THRU 200-EXIT.                        
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
      ******************************************************************        
      *    READ BP13K690 TO GET THE AMORT AMOUNT FOR GRANT AND FOR     *        
      *    PREMIUM                                                     *        
      ******************************************************************        
       330-READ-BP13K690.                                                       
                                                                                
           MOVE 'N'               TO WS-K690-FOUND.                             
           MOVE SPACES            TO K690-KEY-FLD.                              
           MOVE F120-NUM-SCH-ACCT TO K690-KEY-FLD.                              
                                                                                
           READ BP13K690.                                                       
                                                                                
           EVALUATE K690-STATUS                                                 
             WHEN 00                                                            
                MOVE 'Y' TO WS-K690-FOUND                                       
                ADD 1 TO K690-FND-CNT                                           
                PERFORM 340-INITIALIZE-FIELDS    THRU 340-EXIT                  
             WHEN 23                                                            
                MOVE 'N' TO WS-K690-FOUND                                       
                ADD 1 TO K690-NFND-CNT                                          
             WHEN OTHER                                                         
                DISPLAY 'BP13K690 READ ERROR, STATUS IS '                       
                       K690-STATUS ' KEY IS ' K690-KEY-FLD                      
                       MOVE K690-STATUS TO RETURN-CODE                          
                PERFORM 999-CLOSE-FILES  THRU 999-EXIT                          
           END-EVALUATE.                                                        
                                                                                
       330-EXIT.                                                                
           EXIT.                                                                
                                                                                
       340-INITIALIZE-FIELDS.                                                   
                                                                                
                                                                                
           IF K690-AMT-AHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-AHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-AHG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-AHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-AHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-EHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-EHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-EHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-EHG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-EHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-EHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-LHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-LHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-LHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-LHG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-LHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-LHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-SHG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-SHG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SHG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SHG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SHG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SHG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-SRG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-SRG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SRG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SRG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SRG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SRG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-REG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-REG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-REG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-REG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-REG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-REG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-FSG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-FSG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-FSG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-FSG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-FSG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-FSG-ACCUM                           
           END-IF.                                                              
                                                                                
           IF K690-AMT-SUG-GRANT       NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-SUG-GRANT                                 
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SUG-MTH   NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SUG-MTH                             
           END-IF.                                                              
                                                                                
           IF K690-AMT-AMORT-SUG-ACCUM NOT NUMERIC                              
              MOVE ZEROES TO K690-AMT-AMORT-SUG-ACCUM                           
           END-IF.                                                              
                                                                                
       340-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *****************************************************************         
      *    SERS, RELOCATION, AHG,EHG, LHG AND SHG GRANT                         
      *****************************************************************         
       420-CR-GRANT.                                                            
                                                                                
      ***SRG GRANT                                                              
           IF K690-AMT-SRG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              COMPUTE F180-CR-AMT = 0 - K690-AMT-SRG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '407300'            TO   WS-ACC-INTERNAL                     
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-SRG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT SRG GRANT OF FLX CCA'                       
                                          TO   F180-TRANS-DESC                  
                    MOVE '3492'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-SRG-CCA              
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-SRG-CCA          
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-SRG-CCA                 
                                               F180-ACC-NO1                     
                 ELSE                                                           
                    MOVE 'SRG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT SRG GRANT OF FLX'                           
                                          TO   F180-TRANS-DESC                  
                    MOVE '3488'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-SRG                  
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-SRG              
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-SRG                     
                                               F180-ACC-NO1                     
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'SRG'            TO   F180-DTE-POST                       
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT SRG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
                 MOVE '3488'           TO   WS-ACC-GL                           
                 ADD   1               TO   WS-CR-AMORT-SRG                     
                 ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-SRG                 
                 MOVE WS-ACC-NO1       TO   WS-CR-GL-SRG                        
                                            F180-ACC-NO1                        
              END-IF                                                            
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF K690-AMT-REG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              COMPUTE F180-CR-AMT = 0 - K690-AMT-REG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '419200'            TO   WS-ACC-INTERNAL                     
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-REG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT REG GRANT OF FLX CCA'                       
                                          TO   F180-TRANS-DESC                  
                    MOVE '3492'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-REG-CCA              
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-REG-CCA          
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-REG-CCA                 
                                               F180-ACC-NO1                     
                 ELSE                                                           
                    MOVE 'REG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT REG GRANT OF FLX'                           
                                          TO   F180-TRANS-DESC                  
                    MOVE '3488'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-REG                  
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-REG              
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-REG                     
                                               F180-ACC-NO1                     
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'REG'            TO   F180-DTE-POST                       
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT REG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
                 MOVE '3488'           TO   WS-ACC-GL                           
                 ADD   1               TO   WS-CR-AMORT-REG                     
                 ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-REG                 
                 MOVE WS-ACC-NO1       TO   WS-CR-GL-REG                        
                                            F180-ACC-NO1                        
              END-IF                                                            
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***AHG GRANT                                                              
           IF K690-AMT-AHG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              MOVE 'AHG'               TO   F180-DTE-POST                       
              COMPUTE F180-CR-AMT = 0 - K690-AMT-AHG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '407000'            TO   WS-ACC-INTERNAL                     
              MOVE '3488'              TO   WS-ACC-GL                           
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 MOVE 'SF'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT AHG GRANT OF FLX'                              
                                       TO   F180-TRANS-DESC                     
              ELSE                                                              
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT AHG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
              END-IF                                                            
              ADD   1                  TO   WS-CR-AMORT-AHG                     
              ADD F180-CR-AMT          TO   WS-CR-AMORT-AMT-AHG                 
              MOVE WS-ACC-NO1          TO   WS-CR-GL-AHG                        
                                            F180-ACC-NO1                        
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***EHG GRANT                                                              
           IF K690-AMT-EHG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              COMPUTE F180-CR-AMT = 0 - K690-AMT-EHG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '407900'            TO   WS-ACC-INTERNAL                     
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-EHG'     TO   F180-DTE-POST                       
                    MOVE 'SF'          TO   F180-JR-SC                          
                    MOVE 'SOC-AMORT EHG GRANT OF FLX CCA'                       
                                       TO   F180-TRANS-DESC                     
                    MOVE '3492'        TO   WS-ACC-GL                           
                    ADD   1            TO   WS-CR-AMORT-EHG-CCA                 
                    ADD F180-CR-AMT    TO   WS-CR-AMORT-AMT-EHG-CCA             
                    MOVE WS-ACC-NO1    TO   WS-CR-GL-EHG-CCA                    
                                            F180-ACC-NO1                        
                 ELSE                                                           
                    MOVE 'EHG'               TO   F180-DTE-POST                 
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT EHG GRANT OF FLX'                           
                                          TO   F180-TRANS-DESC                  
                    MOVE '3488'              TO   WS-ACC-GL                     
                    ADD   1                  TO   WS-CR-AMORT-EHG               
                    ADD F180-CR-AMT          TO   WS-CR-AMORT-AMT-EHG           
                    MOVE WS-ACC-NO1          TO   WS-CR-GL-EHG                  
                                                  F180-ACC-NO1                  
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'EHG'               TO   F180-DTE-POST                    
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT EHG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
                 MOVE '3488'              TO   WS-ACC-GL                        
                 ADD   1                  TO   WS-CR-AMORT-EHG                  
                 ADD F180-CR-AMT          TO   WS-CR-AMORT-AMT-EHG              
                 MOVE WS-ACC-NO1          TO   WS-CR-GL-EHG                     
                                               F180-ACC-NO1                     
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***LHG GRANT                                                              
           IF K690-AMT-LHG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              COMPUTE F180-CR-AMT = 0 - K690-AMT-LHG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '524300'            TO   WS-ACC-INTERNAL                     
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-LHG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT LHG GRANT OF FLX CCA'                       
                                          TO   F180-TRANS-DESC                  
                    MOVE '3492'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-LHG-CCA              
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-LHG-CCA          
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-LHG-CCA                 
                                               F180-ACC-NO1                     
                 ELSE                                                           
                    MOVE 'LHG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT LHG GRANT OF FLX'                           
                                          TO   F180-TRANS-DESC                  
                    MOVE '3488'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-LHG                  
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-LHG              
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-LHG                     
                                               F180-ACC-NO1                     
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'LHG'            TO   F180-DTE-POST                       
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT LHG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
                 MOVE '3488'           TO   WS-ACC-GL                           
                 ADD   1               TO   WS-CR-AMORT-LHG                     
                 ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-LHG                 
                 MOVE WS-ACC-NO1       TO   WS-CR-GL-LHG                        
                                            F180-ACC-NO1                        
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***SHG GRANT                                                              
           IF K690-AMT-SHG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              MOVE 'SHG'               TO   F180-DTE-POST                       
              COMPUTE F180-CR-AMT = 0 - K690-AMT-SHG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '407800'            TO   WS-ACC-INTERNAL                     
              MOVE '3488'              TO   WS-ACC-GL                           
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 MOVE 'SF'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT SHG GRANT OF FLX'                              
                                       TO   F180-TRANS-DESC                     
              ELSE                                                              
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT SHG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
              END-IF                                                            
              ADD   1                  TO   WS-CR-AMORT-SHG                     
              ADD F180-CR-AMT          TO   WS-CR-AMORT-AMT-SHG                 
              MOVE WS-ACC-NO1          TO   WS-CR-GL-SHG                        
                                            F180-ACC-NO1                        
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***FSG GRANT                                                              
           IF K690-AMT-FSG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              MOVE 'FSG'               TO   F180-DTE-POST                       
              COMPUTE F180-CR-AMT = 0 - K690-AMT-FSG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '41FS00'            TO   WS-ACC-INTERNAL                     
              MOVE '3491'              TO   WS-ACC-GL                           
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF F120-CDE-VALID = 'H'                                        
                    MOVE 'SE'             TO   F180-JR-SC                       
                 ELSE                                                           
                    MOVE 'SF'             TO   F180-JR-SC                       
                 END-IF                                                         
                 MOVE 'SOC-AMORT FSG GRANT OF FLX'                              
                                       TO   F180-TRANS-DESC                     
              ELSE                                                              
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT FSG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
              END-IF                                                            
              ADD   1                  TO   WS-CR-AMORT-FSG                     
              ADD F180-CR-AMT          TO   WS-CR-AMORT-AMT-FSG                 
              MOVE WS-ACC-NO1          TO   WS-CR-GL-FSG                        
                                            F180-ACC-NO1                        
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
      ***SUG GRANT                                                              
           IF K690-AMT-SUG-GRANT       NOT = ZEROES                             
              MOVE SPACES              TO   F180-GL-REC                         
              MOVE ZEROES              TO   F180-AMT-GST-RATE                   
              MOVE WS-F180-TRANS-YY    TO   F180-JR-YY F180-TRANS-YY            
              MOVE WS-F180-TRANS-MM    TO   F180-JR-MM F180-TRANS-MM            
              MOVE WS-F180-TRANS-DD    TO   F180-TRANS-DD                       
              MOVE WS-F180-PERIOD      TO   F180-PERIOD                         
              MOVE F120-NUM-SCH-ACCT   TO   F180-NUM-SCH-ACC                    
              COMPUTE F180-CR-AMT = 0 - K690-AMT-SUG-GRANT                      
                                                                                
              MOVE SPACES              TO   WS-ACC-NO1                          
              MOVE '0'                 TO   WS-ACC-LEAD                         
              MOVE '57'                TO   WS-ACC-FILLER                       
              MOVE '418200'            TO   WS-ACC-INTERNAL                     
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-SUG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT SUG GRANT OF FLX CCA'                       
                                          TO   F180-TRANS-DESC                  
                    MOVE '3492'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-SUG-CCA              
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-SUG-CCA          
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-SUG-CCA                 
                                               F180-ACC-NO1                     
                 ELSE                                                           
                    MOVE 'SUG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE 'SOC-AMORT SUG GRANT OF FLX'                           
                                          TO   F180-TRANS-DESC                  
                    MOVE '3488'           TO   WS-ACC-GL                        
                    ADD   1               TO   WS-CR-AMORT-SUG                  
                    ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-SUG              
                    MOVE WS-ACC-NO1       TO   WS-CR-GL-SUG                     
                                               F180-ACC-NO1                     
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'SUG'            TO   F180-DTE-POST                       
                 MOVE 'SA'             TO   F180-JR-SC                          
                 MOVE 'SOC-AMORT SUG GRANT OF SA'                               
                                       TO   F180-TRANS-DESC                     
                 MOVE '3488'           TO   WS-ACC-GL                           
                 ADD   1               TO   WS-CR-AMORT-SUG                     
                 ADD F180-CR-AMT       TO   WS-CR-AMORT-AMT-SUG                 
                 MOVE WS-ACC-NO1       TO   WS-CR-GL-SUG                        
                                            F180-ACC-NO1                        
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                    TO   WS-WRITE-F180-COUNT                 
           END-IF.                                                              
                                                                                
       420-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
      *    SERS AND RELOCATION GRANT                                            
      *****************************************************************         
       520-DR-GRANT.                                                            
                                                                                
      ***SRG GRANT                                                              
           IF K690-AMT-SRG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              COMPUTE F180-CR-AMT = K690-AMT-SRG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '407300'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-SRG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4046'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT SRG GRANT OF FLX CCA'                       
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-SRG-VRL-CCA            
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-SRG-VRL-CCA        
                    MOVE WS-ACC-NO1       TO WS-GL-SRG-VRL-CCA                  
                                             F180-ACC-NO1                       
                 ELSE                                                           
                    MOVE 'SRG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4041'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT SRG GRANT OF FLX'                           
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-SRG-VRL                
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-SRG-VRL            
                    MOVE WS-ACC-NO1       TO WS-GL-SRG-VRL                      
                                             F180-ACC-NO1                       
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'SRG'               TO   F180-DTE-POST                    
                 MOVE 'SA'                TO   F180-JR-SC                       
                 MOVE '4033'              TO WS-ACC-GL                          
                 MOVE 'SOC-AMORT SRG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-SRG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-SRG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-SRG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF K690-AMT-REG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              COMPUTE F180-CR-AMT = K690-AMT-REG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '419200'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-REG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4046'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT REG GRANT OF FLX CCA'                       
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-REG-VRL-CCA            
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-REG-VRL-CCA        
                    MOVE WS-ACC-NO1       TO WS-GL-REG-VRL-CCA                  
                                             F180-ACC-NO1                       
                 ELSE                                                           
                    MOVE 'REG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4041'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT REG GRANT OF FLX'                           
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-REG-VRL                
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-REG-VRL            
                    MOVE WS-ACC-NO1       TO WS-GL-REG-VRL                      
                                             F180-ACC-NO1                       
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'REG'               TO   F180-DTE-POST                    
                 MOVE 'SA'                TO   F180-JR-SC                       
                 MOVE '4033'              TO WS-ACC-GL                          
                 MOVE 'SOC-AMORT REG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-REG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-REG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-REG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***AHG GRANT                                                              
           IF K690-AMT-AHG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              MOVE 'AHG'               TO   F180-DTE-POST                       
              COMPUTE F180-CR-AMT = K690-AMT-AHG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '407000'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 MOVE 'SF'                   TO   F180-JR-SC                    
                 MOVE '4041'                 TO WS-ACC-GL                       
                 MOVE 'SOC-AMORT AHG GRANT OF FLX'                              
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-AHG-VRL                
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-AHG-VRL            
                 MOVE WS-ACC-NO1          TO WS-GL-AHG-VRL                      
                                             F180-ACC-NO1                       
              ELSE                                                              
                 MOVE 'SA'                   TO   F180-JR-SC                    
                 MOVE '4033'                 TO WS-ACC-GL                       
                 MOVE 'SOC-AMORT AHG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-AHG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-AHG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-AHG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***EHG GRANT                                                              
           IF K690-AMT-EHG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              COMPUTE F180-CR-AMT = K690-AMT-EHG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '407900'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-EHG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4046'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT EHG GRANT OF FLX CCA'                       
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-EHG-VRL-CCA            
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-EHG-VRL-CCA        
                    MOVE WS-ACC-NO1       TO WS-GL-EHG-VRL-CCA                  
                                             F180-ACC-NO1                       
                 ELSE                                                           
                    MOVE 'EHG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4041'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT EHG GRANT OF FLX'                           
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-EHG-VRL                
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-EHG-VRL            
                    MOVE WS-ACC-NO1       TO WS-GL-EHG-VRL                      
                                             F180-ACC-NO1                       
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'EHG'               TO   F180-DTE-POST                    
                 MOVE 'SA'                   TO   F180-JR-SC                    
                 MOVE '4033'                 TO WS-ACC-GL                       
                 MOVE 'SOC-AMORT EHG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-EHG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-EHG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-EHG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***LHG GRANT                                                              
           IF K690-AMT-LHG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              COMPUTE F180-CR-AMT = K690-AMT-LHG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '524300'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-LHG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4046'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT LHG GRANT OF FLX CCA'                       
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-LHG-VRL-CCA            
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-LHG-VRL-CCA        
                    MOVE WS-ACC-NO1       TO WS-GL-LHG-VRL-CCA                  
                                             F180-ACC-NO1                       
                 ELSE                                                           
                    MOVE 'LHG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4041'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT LHG GRANT OF FLX'                           
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-LHG-VRL                
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-LHG-VRL            
                    MOVE WS-ACC-NO1       TO WS-GL-LHG-VRL                      
                                             F180-ACC-NO1                       
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'SA'                TO   F180-JR-SC                       
                 MOVE '4033'              TO WS-ACC-GL                          
                 MOVE 'SOC-AMORT LHG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-LHG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-LHG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-LHG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SHG GRANT                                                              
           IF K690-AMT-SHG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              MOVE 'SHG'               TO   F180-DTE-POST                       
              COMPUTE F180-CR-AMT = K690-AMT-SHG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '407800'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 MOVE 'SF'                   TO   F180-JR-SC                    
                 MOVE '4041'                 TO WS-ACC-GL                       
                 MOVE 'SOC-AMORT SHG GRANT OF FLX'                              
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-SHG-VRL                
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-SHG-VRL            
                 MOVE WS-ACC-NO1          TO WS-GL-SHG-VRL                      
                                             F180-ACC-NO1                       
              ELSE                                                              
                 MOVE 'SA'                   TO   F180-JR-SC                    
                 MOVE '4033'                 TO WS-ACC-GL                       
                 MOVE 'SOC-AMORT SHG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-SHG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-SHG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-SHG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***FSG GRANT                                                              
           IF K690-AMT-FSG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              MOVE 'FSG'               TO   F180-DTE-POST                       
              COMPUTE F180-CR-AMT = K690-AMT-FSG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '41FS00'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF F120-CDE-VALID = 'H'                                        
                    MOVE 'SE'                   TO   F180-JR-SC                 
                 ELSE                                                           
                    MOVE 'SF'                   TO   F180-JR-SC                 
                 END-IF                                                         
                 MOVE '4045'                 TO WS-ACC-GL                       
                 MOVE 'SOC-AMORT FSG GRANT OF FLX'                              
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-FSG-VRL                
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-FSG-VRL            
                 MOVE WS-ACC-NO1          TO WS-GL-FSG-VRL                      
                                             F180-ACC-NO1                       
              ELSE                                                              
                 MOVE 'SA'                   TO   F180-JR-SC                    
                 MOVE '4045'                 TO WS-ACC-GL                       
                 MOVE 'SOC-AMORT FSG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-FSG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-FSG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-FSG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SUG GRANT                                                              
           IF K690-AMT-SUG-GRANT       NOT = ZEROES                             
              MOVE SPACES                 TO   F180-GL-REC                      
              MOVE ZEROES                 TO   F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY       TO   F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM       TO   F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD       TO   F180-TRANS-DD                    
              MOVE WS-F180-PERIOD         TO   F180-PERIOD                      
              MOVE F120-NUM-SCH-ACCT      TO   F180-NUM-SCH-ACC                 
              COMPUTE F180-CR-AMT = K690-AMT-SUG-GRANT                          
                                                                                
              MOVE SPACES                 TO WS-ACC-NO1                         
              MOVE '0'                    TO WS-ACC-LEAD                        
              MOVE '57'                   TO WS-ACC-FILLER                      
              MOVE '418200'               TO WS-ACC-INTERNAL                    
              IF F120-CDE-PAYMENT-TYPE = 'VRL'                                  
                 IF K690-CDE-TYP-ACTUSE = '01' AND                              
                    K690-CDE-MODL-DESG  = '74'                                  
                    MOVE 'CCA-SUG'        TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4046'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT SUG GRANT OF FLX CCA'                       
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-SUG-VRL-CCA            
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-SUG-VRL-CCA        
                    MOVE WS-ACC-NO1       TO WS-GL-SUG-VRL-CCA                  
                                             F180-ACC-NO1                       
                 ELSE                                                           
                    MOVE 'SUG'            TO   F180-DTE-POST                    
                    MOVE 'SF'             TO   F180-JR-SC                       
                    MOVE '4041'           TO WS-ACC-GL                          
                    MOVE 'SOC-AMORT SUG GRANT OF FLX'                           
                                          TO F180-TRANS-DESC                    
                    ADD   1               TO WS-DR-AMORT-SUG-VRL                
                    ADD F180-CR-AMT       TO WS-DR-AMORT-AMT-SUG-VRL            
                    MOVE WS-ACC-NO1       TO WS-GL-SUG-VRL                      
                                             F180-ACC-NO1                       
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'SA'                TO   F180-JR-SC                       
                 MOVE '4033'              TO WS-ACC-GL                          
                 MOVE 'SOC-AMORT SUG GRANT OF SA'                               
                                          TO F180-TRANS-DESC                    
                 ADD   1                  TO WS-DR-AMORT-SUG-SA                 
                 ADD F180-CR-AMT          TO WS-DR-AMORT-AMT-SUG-SA             
                 MOVE WS-ACC-NO1          TO WS-GL-SUG-SA                       
                                             F180-ACC-NO1                       
              END-IF                                                            
              WRITE F180-GL-REC                                                 
              ADD 1                       TO   WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
       520-EXIT.                                                                
           EXIT.                                                                
      *****************************************************************         
      *    CORRECTING CALENDAR DATE TO FINANCIAL YEAR PERIOD          *         
      *****************************************************************         
       600-CHK-PERIOD.                                                          
                                                                                
                                                                                
           IF WS-F180-TRANS-MM   < 4                                            
              ADD 9  WS-F180-TRANS-MM  GIVING WS-F180-PERIOD.                   
                                                                                
           IF WS-F180-TRANS-MM   > 3                                            
              SUBTRACT 3 FROM WS-F180-TRANS-MM  GIVING WS-F180-PERIOD.          
                                                                                
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ****************************************************************          
      *    MOVING THE APPROPRIATE MONTH END DATE ACCORDING TO        *          
      *    CALENDAR MONTH AND YEAR                                   *          
      ****************************************************************          
       610-CHK-TRAN-DTE.                                                        
           DIVIDE WS-F180-TRANS-CCYY  BY 4 GIVING WS-YEAR REMAINDER             
                                            WS-LEAP-YEAR.                       
                                                                                
           MOVE WS-F180-TRANS-MM TO WS-MONTH.                                   
           IF WS-F180-TRANS-MM = 2                                              
              IF WS-LEAP-YEAR = 0                                               
                 MOVE 29 TO WS-F180-TRANS-DD                                    
              ELSE                                                              
                 MOVE 28 TO WS-F180-TRANS-DD                                    
           ELSE                                                                 
               IF CHECK-MM                                                      
                  MOVE 30 TO WS-F180-TRANS-DD                                   
               ELSE                                                             
                  MOVE 31 TO WS-F180-TRANS-DD.                                  
                                                                                
                                                                                
       610-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ***************************************************************           
      *     PRINT REPORT OF RECORDS READ AND WRITTEN TO CLEARING    *           
      *     FILE BP13F120 AND GENERAL LEDGER BP13F180 RESPECTIVELY. *           
      ***************************************************************           
       700-PRINT-REPORT.                                                        
           ADD 1 TO WS-PAGE-COUNT.                                              
                                                                                
           MOVE WS-READ-F120-COUNT    TO L39E-READ-F120-CNT.                    
           MOVE WS-WRITE-F180-COUNT   TO L39E-WRITE-F180-CNT.                   
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.                       
           MOVE CORRESPONDING WS-CURRENT-DATE TO L39E-EDITED-DATE.              
           MOVE WS-PAGE-COUNT                 TO L39E-PAGE.                     
                                                                                
           WRITE BP13L39E-REPORT FROM WS-TITLE-1 AFTER PAGE.                    
           WRITE BP13L39E-REPORT FROM WS-TITLE-2 AFTER 2.                       
           WRITE BP13L39E-REPORT FROM WS-TITLE-3 AFTER 2.                       
           WRITE BP13L39E-REPORT FROM WS-HEADER-LINE-1 AFTER 4.                 
           WRITE BP13L39E-REPORT FROM WS-HEADER-LINE-2 AFTER 2.                 
           WRITE BP13L39E-REPORT FROM WS-SUMMARY-HEADER-1 AFTER 4.              
           WRITE BP13L39E-REPORT FROM WS-SUMMARY-HEADER-2 AFTER 2.              
                                                                                
      **PRINT TOTAL FOR SRG GRANT - CR TO 3488                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SRG '               TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-SRG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-SRG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-SRG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SRG GRANT - CCA - CR TO 3492                            
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'CCA-SRG'            TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-SRG-CCA     TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-SRG-CCA  TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-SRG-CCA TO  L39E-CR-DEFER-CREDIT.               
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR REG GRANT - CR TO 3488                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'REG '               TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-REG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-REG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-REG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR REG GRANT - CCA - CR TO 3492                            
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'CCA-REG'            TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-REG-CCA     TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-REG-CCA  TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-REG-CCA TO  L39E-CR-DEFER-CREDIT.               
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AHG GRANT - CR TO 3488                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'AHG '               TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-AHG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-AHG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-AHG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR EHG GRANT - CR TO 3488                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'EHG '               TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-EHG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-EHG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-EHG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR EHG GRANT - CCA - CR TO 3942                            
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'CCA-EHG'            TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-EHG-CCA     TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-EHG-CCA  TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-EHG-CCA TO  L39E-CR-DEFER-CREDIT.               
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR LHG GRANT - CR TO 3488                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'LHG '               TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-LHG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-LHG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-LHG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR LHG GRANT - CCA - CR TO 3492                            
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'CCA-LHG'            TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-LHG-CCA     TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-LHG-CCA  TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-LHG-CCA  TO  L39E-CR-DEFER-CREDIT.              
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SHG GRANT - CR TO 3488                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SHG '               TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-SHG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-SHG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-SHG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SUG GRANT - CR TO 3488                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SUG '               TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-SUG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-SUG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-SUG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SUG GRANT - CCA - CR TO 3492                            
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'CCA-SUG'            TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-SUG-CCA     TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-SUG-CCA  TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-SUG-CCA  TO  L39E-CR-DEFER-CREDIT.              
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR FSG GRANT - CR TO 3491                                  
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'FSH - UFG'          TO  L39E-AMORT-DESC1.                      
           MOVE WS-CR-GL-FSG         TO  L39E-DEFER-GL.                         
           MOVE WS-CR-AMORT-FSG      TO  L39E-CR-CASES.                         
           MOVE WS-CR-AMORT-AMT-FSG  TO  L39E-CR-DEFER-CREDIT.                  
           IF L39E-DEFER-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SRG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SRG - SA'           TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SRG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SRG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SRG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SRG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SRG-SHORT LEASE'    TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SRG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SRG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SRG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SRG GRANT   - VRL - CCA                  
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'CCA-SRG SHRT LSE'   TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SRG-VRL-CCA    TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SRG-VRL-CCA  TO  L39E-DR-AMORT-CASES.               
           MOVE WS-DR-AMORT-AMT-SRG-VRL-CCA  TO L39E-DR-AMORT-DEBIT.            
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - REG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'REG - SA'           TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-REG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-REG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-REG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - REG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'REG-SHORT LEASE'    TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-REG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-REG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-REG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - REG GRANT   - VRL - CCA                  
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'CCA-REG SHRT LSE'   TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-REG-VRL-CCA    TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-REG-VRL-CCA  TO  L39E-DR-AMORT-CASES.               
           MOVE WS-DR-AMORT-AMT-REG-VRL-CCA  TO L39E-DR-AMORT-DEBIT.            
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - AHG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'AHG - SA'           TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-AHG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-AHG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-AHG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - AHG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'AHG-SHORT LEASE'    TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-AHG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-AHG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-AHG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - EHG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'EHG - SA'           TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-EHG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-EHG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-EHG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - EHG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'EHG-SHORT LEASE'    TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-EHG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-EHG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-EHG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - EHG GRANT   - VRL - CCA                  
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'CCA-EHG SHRT LSE'          TO  L39E-AMORT-DESC.                
           MOVE WS-GL-EHG-VRL-CCA           TO  L39E-AMORT-GL.                  
           MOVE WS-DR-AMORT-EHG-VRL-CCA     TO  L39E-DR-AMORT-CASES.            
           MOVE WS-DR-AMORT-AMT-EHG-VRL-CCA TO L39E-DR-AMORT-DEBIT.             
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - LHG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'LHG - SA'           TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-LHG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-LHG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-LHG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - LHG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'LHG-SHORT LEASE'    TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-LHG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-LHG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-LHG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - LHG GRANT   - VRL - CCA                  
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'CCA-LHG SHRT LSE'   TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-LHG-VRL-CCA    TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-LHG-VRL-CCA  TO  L39E-DR-AMORT-CASES.               
           MOVE WS-DR-AMORT-AMT-LHG-VRL-CCA TO L39E-DR-AMORT-DEBIT.             
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SHG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SHG - SA'           TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SHG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SHG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SHG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SHG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SHG-SHORT LEASE'    TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SHG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SHG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SHG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SUG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SUG - SA'           TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SUG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SUG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SUG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SUG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'SUG-SHORT LEASE'    TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SUG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SUG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-SUG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - SUG GRANT   - VRL - CCA                  
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'CCA-SUG SHRT LSE'   TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-SUG-VRL-CCA    TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-SUG-VRL-CCA  TO  L39E-DR-AMORT-CASES.               
           MOVE WS-DR-AMORT-AMT-SUG-VRL-CCA TO L39E-DR-AMORT-DEBIT.             
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - FSG GRANT   - SA                         
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'FSH - UFG'          TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-FSG-SA         TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-FSG-SA   TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-FSG-SA   TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AMORTISATION - FSG GRANT   - VRL                        
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'FSH - UFG'          TO  L39E-AMORT-DESC.                       
           MOVE WS-GL-FSG-VRL        TO  L39E-AMORT-GL.                         
           MOVE WS-DR-AMORT-FSG-VRL  TO  L39E-DR-AMORT-CASES.                   
           MOVE WS-DR-AMORT-AMT-FSG-VRL  TO L39E-DR-AMORT-DEBIT.                
           IF L39E-AMORT-GL NOT = SPACES                                        
              WRITE BP13L39E-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
      *COMPUTE TOTAL DEBIT AND CREDIT AMOUNTS                                   
                                                                                
           COMPUTE WS-DR-TOT =  WS-DR-AMORT-AMT-SRG-SA  +                       
                                WS-DR-AMORT-AMT-SRG-VRL +                       
                                WS-DR-AMORT-AMT-SRG-VRL-CCA +                   
                                WS-DR-AMORT-AMT-REG-SA  +                       
                                WS-DR-AMORT-AMT-REG-VRL +                       
                                WS-DR-AMORT-AMT-REG-VRL-CCA +                   
                                WS-DR-AMORT-AMT-AHG-SA  +                       
                                WS-DR-AMORT-AMT-AHG-VRL +                       
                                WS-DR-AMORT-AMT-EHG-SA  +                       
                                WS-DR-AMORT-AMT-EHG-VRL +                       
                                WS-DR-AMORT-AMT-EHG-VRL-CCA +                   
                                WS-DR-AMORT-AMT-LHG-SA  +                       
                                WS-DR-AMORT-AMT-LHG-VRL +                       
                                WS-DR-AMORT-AMT-LHG-VRL-CCA +                   
                                WS-DR-AMORT-AMT-SHG-SA  +                       
                                WS-DR-AMORT-AMT-SHG-VRL +                       
                                WS-DR-AMORT-AMT-SUG-SA  +                       
                                WS-DR-AMORT-AMT-SUG-VRL +                       
                                WS-DR-AMORT-AMT-SUG-VRL-CCA +                   
                                WS-DR-AMORT-AMT-FSG-SA  +                       
                                WS-DR-AMORT-AMT-FSG-VRL.                        
                                                                                
           COMPUTE WS-CR-TOT =  WS-CR-AMORT-AMT-SRG +                           
                                WS-CR-AMORT-AMT-SRG-CCA +                       
                                WS-CR-AMORT-AMT-REG +                           
                                WS-CR-AMORT-AMT-REG-CCA +                       
                                WS-CR-AMORT-AMT-AHG +                           
                                WS-CR-AMORT-AMT-EHG +                           
                                WS-CR-AMORT-AMT-EHG-CCA +                       
                                WS-CR-AMORT-AMT-LHG +                           
                                WS-CR-AMORT-AMT-LHG-CCA +                       
                                WS-CR-AMORT-AMT-SHG +                           
                                WS-CR-AMORT-AMT-SUG +                           
                                WS-CR-AMORT-AMT-SUG-CCA +                       
                                WS-CR-AMORT-AMT-FSG.                            
                                                                                
           MOVE WS-CR-TOT         TO L39E-CR-TOT.                               
           MOVE WS-DR-TOT         TO L39E-DR-TOT.                               
                                                                                
      *COMPUTE TOTAL CASES OF DEBIT AND CREDIT                                  
                                                                                
           COMPUTE WS-CR-CASES = WS-CR-AMORT-SRG +                              
                                 WS-CR-AMORT-SRG-CCA +                          
                                 WS-CR-AMORT-AHG +                              
                                 WS-CR-AMORT-EHG +                              
                                 WS-CR-AMORT-EHG-CCA +                          
                                 WS-CR-AMORT-LHG +                              
                                 WS-CR-AMORT-LHG-CCA +                          
                                 WS-CR-AMORT-SHG +                              
                                 WS-CR-AMORT-REG +                              
                                 WS-CR-AMORT-REG-CCA +                          
                                 WS-CR-AMORT-SUG +                              
                                 WS-CR-AMORT-SUG-CCA +                          
                                 WS-CR-AMORT-FSG.                               
                                                                                
           COMPUTE WS-DR-CASES = WS-DR-AMORT-SRG-SA  +                          
                                 WS-DR-AMORT-SRG-VRL +                          
                                 WS-DR-AMORT-SRG-VRL-CCA +                      
                                 WS-DR-AMORT-AHG-SA  +                          
                                 WS-DR-AMORT-AHG-VRL +                          
                                 WS-DR-AMORT-EHG-SA  +                          
                                 WS-DR-AMORT-EHG-VRL +                          
                                 WS-DR-AMORT-EHG-VRL-CCA +                      
                                 WS-DR-AMORT-LHG-SA  +                          
                                 WS-DR-AMORT-LHG-VRL +                          
                                 WS-DR-AMORT-LHG-VRL-CCA +                      
                                 WS-DR-AMORT-SHG-SA  +                          
                                 WS-DR-AMORT-SHG-VRL +                          
                                 WS-DR-AMORT-REG-SA  +                          
                                 WS-DR-AMORT-REG-VRL +                          
                                 WS-DR-AMORT-REG-VRL-CCA +                      
                                 WS-DR-AMORT-SUG-SA  +                          
                                 WS-DR-AMORT-SUG-VRL +                          
                                 WS-DR-AMORT-SUG-VRL-CCA +                      
                                 WS-DR-AMORT-FSG-SA  +                          
                                 WS-DR-AMORT-FSG-VRL.                           
                                                                                
                                                                                
           MOVE WS-CR-CASES       TO L39E-CR-CASES-TOT.                         
           MOVE WS-DR-CASES       TO L39E-DR-CASES-TOT.                         
                                                                                
           WRITE BP13L39E-REPORT FROM WS-FOOTER-LINE-1 AFTER 4.                 
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
      ***************************************************************           
      *     CLOSE ALL FILES AND STOP RUN.                           *           
      ***************************************************************           
       999-CLOSE-FILES.                                                         
           DISPLAY '  PROGRAM : BP13C39E      : '.                              
           DISPLAY 'RECORDS READ FROM BP13F120: ' WS-READ-F120-COUNT.           
           DISPLAY 'RECORDS WRITTEN IN BP13F180: ' WS-WRITE-F180-COUNT          
           DISPLAY 'RECORDS FOUND IN BP13K690: ' K690-FND-CNT.                  
           DISPLAY 'RECORDS FOUND WITH GRANTS: ' WS-WITH-GRANT.                 
                                                                                
           CLOSE BP13F120                                                       
                 BP13F180                                                       
                 BP13K690                                                       
                 SY02F001                                                       
                 BP13L39E.                                                      
                                                                                
                                                                                
           IF K690-STATUS NOT = 00 AND 97                                       
              MOVE K690-STATUS          TO RETURN-CODE                          
              DISPLAY 'ERROR CLOSING BM06K690 FILE ' K690-STATUS                
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       999-EXIT.                                                                
           EXIT.                                                                
