       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C373.                                                 
      *AUTHOR. SK.                                                              
      *DATE-WRITTEN.  07/05/2003.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE  : DETAILS OF BALANCE OUTSTANDING               *            
      *                                                            *            
      *  INPUT FILES: 1. BP13F671                                  *            
      *               2. BP13K820                                  *            
      *                                                            *            
      *  OUTPUT FILE: 1. BP13L373                                  *            
      *                                                            *            
      * CHG REF  BY   DATE     DESCRIPTION                         *            
      * -------- ---- -------- -----------                         *            
      * BP132347 SK   20030705 NEW PGM                             *            
      * BP132526 SK   20040618 EXPAND F671 TO 3000 LENGTH          *            
      **********************************************************                
                                                                                
      *--------------------------------------------------------*                
       ENVIRONMENT DIVISION.                                                    
      *--------------------------------------------------------*                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F671 ASSIGN TO BP13F671.                                  
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD                               
                  FILE STATUS     IS WS-K820-STATUS.                            
                                                                                
           SELECT BP13L373 ASSIGN TO BP13L373.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *--------------------------------------------------------*                
                                                                                
       FD  BP13F671                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 3000 CHARACTERS                                      
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F671.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD  BP13L373                                                             
           RECORDING MODE IS F                                                  
           RECORD CONTAINS  132 CHARACTERS.                                     
                                                                                
       01  BP13L373-REC         PIC X(132).                                     
                                                                                
      *--------------------------------------------------------*                
       WORKING-STORAGE SECTION.                                                 
      *--------------------------------------------------------*                
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-F671-EOF             PIC X       VALUE 'N'.                   
           05  WS-K820-FOUND           PIC X       VALUE 'N'.                   
           05  WS-FLAG-REGN            PIC X       VALUE 'N'.                   
           05  WS-FLAG-PRINT           PIC X       VALUE 'N'.                   
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-CNT-F671-READ         PIC 9(8)    VALUE ZEROES.                
           05 WS-CNT-L373-WRITE        PIC 9(8)    VALUE ZEROES.                
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-NRIC                  PIC X(9)    VALUE SPACES.                
           05 WS-REGN-LAST             PIC X(8)    VALUE SPACES.                
           05 WS-K820-STATUS           PIC 9(2)    VALUE ZEROES.                
                                                                                
           05 WS-REGN-TOTAL            PIC 9(9)V99 VALUE 0.                     
           05 WS-GRAND-TOTAL           PIC 9(9)V99 VALUE 0.                     
                                                                                
           05 WS-LINE-CNT              PIC 9(8)    VALUE 66.                    
           05 WS-PAGE-CNT              PIC 9(8)    VALUE 0.                     
           05 WS-CNT-PRINT-L373        PIC 9(8)    VALUE 1.                     
           05 WS-CNT-WRITE-L373        PIC 9(8)    VALUE 0.                     
                                                                                
       01  WS-DATE                     PIC X(8)    VALUE SPACES.                
                                                                                
      *-----------------------------------------------------------*             
      *    WS FOR CONTROL LISTING                                 *             
      *-----------------------------------------------------------*             
       01  L373-PR-HEAD-01.                                                     
           05  FILLER                   PIC X(14) VALUE 'BP13L373'.             
           05  FILLER                   PIC X(8)  VALUE 'HDBCAT 3'.             
           05  FILLER                   PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(13) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  L373-DATE                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'PAGE: '.               
           05  L373-PAGE                PIC ZZZ9.                               
                                                                                
       01  L373-PR-HEAD-02.                                                     
           05  FILLER                   PIC X(34) VALUE SPACES.                 
           05  FILLER                   PIC X(80) VALUE                         
           'BALANCE AMOUNT LEFT FOR BANK LOAN CPF (404151) NOT FULLY UTI        
      -    'LISED'.                                                             
                                                                                
       01  L373-PR-HEAD-03.                                                     
           05  FILLER          PIC X(5)  VALUE ' S-NO'.                         
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(21) VALUE 'REGN NO   SCHEME A/C'.          
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'DATE RECVD'.                    
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(09) VALUE 'NRIC'.                          
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(55) VALUE 'NAME'.                          
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'PYMT TYPE'.                     
           05  FILLER          PIC X(2)  VALUE SPACES.                          
           05  FILLER          PIC X(10) VALUE 'AMOUNT'.                        
                                                                                
       01  L373-PR-HEAD-04.                                                     
           05  FILLER                PIC X(132) VALUE ALL '-'.                  
                                                                                
       01  L373-PR-DETAILS-1.                                                   
           05  L373-NUMBER           PIC ZZZZZ.                                 
           05  FILLER                PIC X(2)  VALUE SPACES.                    
           05  L373-REGN-SCH-ACC     PIC X(21) VALUE SPACES.                    
           05  FILLER                PIC X(2)  VALUE SPACES.                    
           05  L373-DTE-RECVD        PIC X(10) VALUE SPACES.                    
           05  FILLER                PIC X(2)  VALUE SPACES.                    
           05  L373-NRIC             PIC X(09) VALUE SPACES.                    
           05  FILLER                PIC X(2)  VALUE SPACES.                    
           05  L373-NAME             PIC X(55) VALUE SPACES.                    
           05  FILLER                PIC X(2)  VALUE SPACES.                    
           05  L373-TRANS-TYPE       PIC X(10) VALUE SPACES.                    
           05  FILLER                PIC X(2)  VALUE SPACES.                    
           05  L373-AMOUNT           PIC $$$,$$9.99.                            
                                                                                
       01  L373-PR-FOOTER.                                                      
           05  FILLER                PIC X(10) VALUE 'NO CASES :'.              
           05  L373-NO-CASES         PIC ZZZZZ9.                                
           05  FILLER                PIC X(89) VALUE SPACES.                    
           05  FILLER                PIC X(13) VALUE 'GRAND TOTAL :'.           
           05  L373-GRAND-TOTAL      PIC $$$,$$$,$$9.99.                        
                                                                                
       01  L373-PR-SUB-TOTAL.                                                   
           05  FILLER                PIC X(105) VALUE SPACES.                   
           05  FILLER                PIC X(13) VALUE '      TOTAL :'.           
           05  L373-SUB-TOTAL        PIC $$$,$$$,$$9.99.                        
                                                                                
       01  L373-PR-BLANK             PIC X(132) VALUE SPACES.                   
                                                                                
      *--------------------------------------------------------*                
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------*                
                                                                                
       0000-MAIN.                                                               
                                                                                
           PERFORM 1000-OPEN-FILE       THRU 1000-EXIT.                         
           PERFORM 1100-READ-F671       THRU 1100-EXIT.                         
           PERFORM 2000-PROCESS         THRU 2000-EXIT                          
                   UNTIL WS-F671-EOF = 'Y'.                                     
           PERFORM 4200-PRINT-FOOTER    THRU 4200-EXIT.                         
           PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                         
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       1000-OPEN-FILE.                                                          
      *--------------------------------------------------------*                
                                                                                
           OPEN INPUT  BP13F671                                                 
                       BP13K820                                                 
                OUTPUT BP13L373.                                                
                                                                                
           EVALUATE WS-K820-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE WS-K820-STATUS      TO RETURN-CODE                      
                   DISPLAY 'OPEN BP13K820 FAIL. STATUS=' WS-K820-STATUS         
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
           MOVE FUNCTION CURRENT-DATE   TO WS-DATE.                             
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
              DELIMITED BY SIZE INTO L373-DATE.                                 
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       1100-READ-F671.                                                          
      *--------------------------------------------------------*                
                                                                                
           READ BP13F671                                                        
                AT END  MOVE 'Y' TO WS-F671-EOF                                 
                GO TO 1100-EXIT                                                 
           END-READ.                                                            
                                                                                
           ADD 1 TO WS-CNT-F671-READ.                                           
                                                                                
       1100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       2000-PROCESS.                                                            
      *--------------------------------------------------------*                
                                                                                
           PERFORM 3000-CHECK          THRU 3000-EXIT.                          
           PERFORM 1100-READ-F671      THRU 1100-EXIT.                          
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       3000-CHECK.                                                              
      *--------------------------------------------------------*                
           MOVE 'N'  TO WS-FLAG-REGN.                                           
                                                                                
           IF F671-NUM-CPF1-NO NOT = SPACES AND LOW-VALUES                      
                                                                                
              IF WS-FLAG-REGN NOT = 'Y'                                         
                 STRING F671-NUM-REGN '  ' F671-NUM-SCH-ACC                     
                        DELIMITED BY SIZE INTO L373-REGN-SCH-ACC                
                 MOVE WS-CNT-PRINT-L373     TO L373-NUMBER                      
              ELSE                                                              
                 MOVE SPACES                TO L373-REGN-SCH-ACC                
                 MOVE ZEROS                 TO L373-NUMBER                      
              END-IF                                                            
                                                                                
              MOVE F671-NUM-CPF1-NO         TO WS-NRIC L373-NRIC                
                                                                                
              IF (F671-DTE-VALUE-CPF1 NOT = SPACES                              
                                      AND LOW-VALUES AND ALL '0')               
                  STRING F671-DTE-VALUE-CPF1(7:2) '/'                           
                         F671-DTE-VALUE-CPF1(5:2) '/'                           
                         F671-DTE-VALUE-CPF1(1:4)                               
                         DELIMITED BY SIZE INTO L373-DTE-RECVD                  
              ELSE                                                              
                  MOVE SPACES                TO L373-DTE-RECVD                  
              END-IF                                                            
                                                                                
              PERFORM 4400-GET-NAME          THRU 4400-EXIT                     
              PERFORM 3100-WRITE-BP13L373-1  THRU 3100-EXIT                     
           END-IF.                                                              
                                                                                
           IF F671-NUM-CPF2-NO NOT = SPACES AND LOW-VALUES                      
                                                                                
              IF WS-FLAG-REGN NOT = 'Y'                                         
                 STRING F671-NUM-REGN '  ' F671-NUM-SCH-ACC                     
                        DELIMITED BY SIZE INTO L373-REGN-SCH-ACC                
                 MOVE WS-CNT-PRINT-L373     TO L373-NUMBER                      
              ELSE                                                              
                 MOVE SPACES                TO L373-REGN-SCH-ACC                
                 MOVE ZEROS                 TO L373-NUMBER                      
              END-IF                                                            
                                                                                
              MOVE F671-NUM-CPF2-NO         TO WS-NRIC L373-NRIC                
                                                                                
              IF (F671-DTE-VALUE-CPF2 NOT = SPACES                              
                                      AND LOW-VALUES AND ALL '0')               
                  STRING F671-DTE-VALUE-CPF2(7:2) '/'                           
                         F671-DTE-VALUE-CPF2(5:2) '/'                           
                         F671-DTE-VALUE-CPF2(1:4)                               
                         DELIMITED BY SIZE INTO  L373-DTE-RECVD                 
              ELSE                                                              
                  MOVE SPACES                TO  L373-DTE-RECVD                 
              END-IF                                                            
                                                                                
              PERFORM 4400-GET-NAME          THRU 4400-EXIT                     
              PERFORM 3200-WRITE-BP13L373-2  THRU 3200-EXIT                     
           END-IF.                                                              
                                                                                
           IF F671-NUM-CPF3-NO NOT = SPACES AND LOW-VALUES                      
                                                                                
              IF WS-FLAG-REGN NOT = 'Y'                                         
                 STRING F671-NUM-REGN '  ' F671-NUM-SCH-ACC                     
                        DELIMITED BY SIZE INTO L373-REGN-SCH-ACC                
                 MOVE WS-CNT-PRINT-L373     TO L373-NUMBER                      
              ELSE                                                              
                 MOVE SPACES                TO L373-REGN-SCH-ACC                
                 MOVE ZEROS                 TO L373-NUMBER                      
              END-IF                                                            
                                                                                
              MOVE F671-NUM-CPF3-NO         TO WS-NRIC L373-NRIC                
                                                                                
              IF (F671-DTE-VALUE-CPF3 NOT = SPACES                              
                                      AND LOW-VALUES AND ALL '0')               
                  STRING F671-DTE-VALUE-CPF3(7:2) '/'                           
                         F671-DTE-VALUE-CPF3(5:2) '/'                           
                         F671-DTE-VALUE-CPF3(1:4)                               
                         DELIMITED BY SIZE INTO L373-DTE-RECVD                  
              ELSE                                                              
                  MOVE SPACES                TO L373-DTE-RECVD                  
              END-IF                                                            
                                                                                
              PERFORM 4400-GET-NAME         THRU 4400-EXIT                      
              PERFORM 3300-WRITE-BP13L373-3 THRU 3300-EXIT                      
           END-IF.                                                              
                                                                                
           IF F671-NUM-CPF4-NO NOT = SPACES AND LOW-VALUES                      
                                                                                
              IF WS-FLAG-REGN NOT = 'Y'                                         
                 STRING F671-NUM-REGN '  ' F671-NUM-SCH-ACC                     
                        DELIMITED BY SIZE INTO L373-REGN-SCH-ACC                
                 MOVE WS-CNT-PRINT-L373     TO L373-NUMBER                      
              ELSE                                                              
                 MOVE SPACES                TO L373-REGN-SCH-ACC                
                 MOVE ZEROS                 TO L373-NUMBER                      
              END-IF                                                            
                                                                                
              MOVE F671-NUM-CPF4-NO         TO WS-NRIC L373-NRIC                
                                                                                
              IF (F671-DTE-VALUE-CPF4 NOT = SPACES                              
                                      AND LOW-VALUES AND ALL '0')               
                  STRING F671-DTE-VALUE-CPF4(7:2) '/'                           
                         F671-DTE-VALUE-CPF4(5:2) '/'                           
                         F671-DTE-VALUE-CPF4(1:4)                               
                         DELIMITED BY SIZE INTO L373-DTE-RECVD                  
              ELSE                                                              
                  MOVE SPACES                TO L373-DTE-RECVD                  
              END-IF                                                            
                                                                                
              PERFORM 4400-GET-NAME         THRU 4400-EXIT                      
              PERFORM 3400-WRITE-BP13L373-4 THRU 3400-EXIT                      
           END-IF.                                                              
                                                                                
           IF WS-REGN-LAST NOT =  F671-NUM-REGN                                 
                                  AND WS-FLAG-REGN = 'Y'                        
              ADD 1                        TO WS-CNT-PRINT-L373                 
              MOVE F671-NUM-REGN           TO WS-REGN-LAST                      
              PERFORM 4700-PRINT-SUB-TOTAL THRU 4700-EXIT                       
              PERFORM 4600-WRITE-BLANK     THRU 4600-EXIT                       
              MOVE 0                       TO WS-REGN-TOTAL                     
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       3100-WRITE-BP13L373-1.                                                   
      *--------------------------------------------------------*                
                                                                                
           IF F671-AMT-SOC-CPF1-BAL IS NUMERIC                                  
              IF F671-AMT-SOC-CPF1-BAL > 0                                      
                                                                                
                 MOVE 'SOC'   TO L373-TRANS-TYPE                                
                                                                                
                 MOVE F671-AMT-SOC-CPF1-BAL TO L373-AMOUNT                      
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOC-CPF1-BAL                
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOC-CPF1-BAL                
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LUMPSUM-CPF1-BAL IS NUMERIC                              
              IF F671-AMT-LUMPSUM-CPF1-BAL > 0                                  
                                                                                
                 MOVE 'LUMPSUM'   TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LUMPSUM-CPF1-BAL TO L373-AMOUNT                  
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LUMPSUM-CPF1-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LUMPSUM-CPF1-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-STMP-CPF1-BAL IS NUMERIC                             
              IF F671-AMT-LSE-STMP-CPF1-BAL > 0                                 
                                                                                
                 MOVE 'LSE STMP'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-STMP-CPF1-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-STMP-CPF1-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-STMP-CPF1-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SALE-CONVY-CPF1-BAL IS NUMERIC                           
              IF F671-AMT-SALE-CONVY-CPF1-BAL > 0                               
                                                                                
                 MOVE 'SALE CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-SALE-CONVY-CPF1-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SALE-CONVY-CPF1-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SALE-CONVY-CPF1-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-MORT-CONVY-CPF1-BAL IS NUMERIC                           
              IF F671-AMT-MORT-CONVY-CPF1-BAL > 0                               
                                                                                
                 MOVE 'MORT CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-MORT-CONVY-CPF1-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-MORT-CONVY-CPF1-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-MORT-CONVY-CPF1-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SRVY-FEE-CPF1-BAL IS NUMERIC                             
              IF F671-AMT-SRVY-FEE-CPF1-BAL > 0                                 
                                                                                
                 MOVE 'SRVY FEE'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-SRVY-FEE-CPF1-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SRVY-FEE-CPF1-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SRVY-FEE-CPF1-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-ESCR-CPF1-BAL IS NUMERIC                             
              IF F671-AMT-LSE-ESCR-CPF1-BAL > 0                                 
                                                                                
                 MOVE 'LSE ESCR'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-ESCR-CPF1-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-ESCR-CPF1-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-ESCR-CPF1-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-REGN-CPF1-BAL IS NUMERIC                             
              IF F671-AMT-LSE-REGN-CPF1-BAL > 0                                 
                                                                                
                 MOVE 'LSE REGN'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-REGN-CPF1-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-REGN-CPF1-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-REGN-CPF1-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-CAVEAT-REGN-CPF1-BAL IS NUMERIC                          
              IF F671-AMT-CAVEAT-REGN-CPF1-BAL > 0                              
                                                                                
                 MOVE 'CAVT REGN'  TO L373-TRANS-TYPE                           
                                                                                
                 MOVE F671-AMT-CAVEAT-REGN-CPF1-BAL TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-CAVEAT-REGN-CPF1-BAL        
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-CAVEAT-REGN-CPF1-BAL        
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SOLICIT-CPF1-BAL IS NUMERIC                              
              IF F671-AMT-SOLICIT-CPF1-BAL > 0                                  
                                                                                
                 MOVE 'SOLICIT'  TO L373-TRANS-TYPE                             
                                                                                
                 MOVE F671-AMT-SOLICIT-CPF1-BAL     TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOLICIT-CPF1-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOLICIT-CPF1-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       3200-WRITE-BP13L373-2.                                                   
      *--------------------------------------------------------*                
                                                                                
           IF F671-AMT-SOC-CPF2-BAL IS NUMERIC                                  
              IF F671-AMT-SOC-CPF2-BAL > 0                                      
                                                                                
                 MOVE 'SOC'  TO L373-TRANS-TYPE                                 
                                                                                
                 MOVE F671-AMT-SOC-CPF2-BAL TO L373-AMOUNT                      
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOC-CPF2-BAL                
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOC-CPF2-BAL                
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1      TO WS-CNT-L373-WRITE                                
                 MOVE 'Y'   TO WS-FLAG-REGN                                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LUMPSUM-CPF2-BAL IS NUMERIC                              
              IF F671-AMT-LUMPSUM-CPF2-BAL > 0                                  
                                                                                
                 MOVE 'LUMPSUM'   TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LUMPSUM-CPF2-BAL TO L373-AMOUNT                  
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LUMPSUM-CPF2-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LUMPSUM-CPF2-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-STMP-CPF2-BAL IS NUMERIC                             
              IF F671-AMT-LSE-STMP-CPF2-BAL > 0                                 
                                                                                
                 MOVE 'LSE STMP'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-STMP-CPF2-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-STMP-CPF2-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-STMP-CPF2-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SALE-CONVY-CPF2-BAL IS NUMERIC                           
              IF F671-AMT-SALE-CONVY-CPF2-BAL > 0                               
                                                                                
                 MOVE 'SALE CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-SALE-CONVY-CPF2-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SALE-CONVY-CPF2-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SALE-CONVY-CPF2-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-MORT-CONVY-CPF2-BAL IS NUMERIC                           
              IF F671-AMT-MORT-CONVY-CPF2-BAL > 0                               
                                                                                
                 MOVE 'MORT CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-MORT-CONVY-CPF2-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-MORT-CONVY-CPF2-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-MORT-CONVY-CPF2-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SRVY-FEE-CPF2-BAL IS NUMERIC                             
              IF F671-AMT-SRVY-FEE-CPF2-BAL > 0                                 
                                                                                
                 MOVE 'SRVY FEE'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-SRVY-FEE-CPF2-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SRVY-FEE-CPF2-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SRVY-FEE-CPF2-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-ESCR-CPF2-BAL IS NUMERIC                             
              IF F671-AMT-LSE-ESCR-CPF2-BAL > 0                                 
                                                                                
                 MOVE 'LSE ESCR'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-ESCR-CPF2-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-ESCR-CPF2-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-ESCR-CPF2-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-REGN-CPF2-BAL IS NUMERIC                             
              IF F671-AMT-LSE-REGN-CPF2-BAL > 0                                 
                                                                                
                 MOVE 'LSE REGN'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-REGN-CPF2-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-REGN-CPF2-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-REGN-CPF2-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-CAVEAT-REGN-CPF2-BAL IS NUMERIC                          
              IF F671-AMT-CAVEAT-REGN-CPF2-BAL > 0                              
                                                                                
                 MOVE 'CAVT REGN'  TO L373-TRANS-TYPE                           
                                                                                
                 MOVE F671-AMT-CAVEAT-REGN-CPF2-BAL TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-CAVEAT-REGN-CPF2-BAL        
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-CAVEAT-REGN-CPF2-BAL        
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SOLICIT-CPF2-BAL IS NUMERIC                              
              IF F671-AMT-SOLICIT-CPF2-BAL > 0                                  
                                                                                
                 MOVE 'SOLICIT'  TO L373-TRANS-TYPE                             
                                                                                
                 MOVE F671-AMT-SOLICIT-CPF2-BAL     TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOLICIT-CPF2-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOLICIT-CPF2-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       3300-WRITE-BP13L373-3.                                                   
      *--------------------------------------------------------*                
                                                                                
           IF F671-AMT-SOC-CPF3-BAL IS NUMERIC                                  
              IF F671-AMT-SOC-CPF3-BAL > 0                                      
                                                                                
                 MOVE 'SOC'   TO L373-TRANS-TYPE                                
                                                                                
                 MOVE F671-AMT-SOC-CPF3-BAL TO L373-AMOUNT                      
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOC-CPF3-BAL                
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOC-CPF3-BAL                
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LUMPSUM-CPF3-BAL IS NUMERIC                              
              IF F671-AMT-LUMPSUM-CPF3-BAL > 0                                  
                                                                                
                 MOVE 'LUMPSUM'   TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LUMPSUM-CPF3-BAL TO L373-AMOUNT                  
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LUMPSUM-CPF3-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LUMPSUM-CPF3-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-STMP-CPF3-BAL IS NUMERIC                             
              IF F671-AMT-LSE-STMP-CPF3-BAL > 0                                 
                                                                                
                 MOVE 'LSE STMP'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-STMP-CPF3-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-STMP-CPF3-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-STMP-CPF3-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SALE-CONVY-CPF3-BAL IS NUMERIC                           
              IF F671-AMT-SALE-CONVY-CPF3-BAL > 0                               
                                                                                
                 MOVE 'SALE CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-SALE-CONVY-CPF3-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SALE-CONVY-CPF3-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SALE-CONVY-CPF3-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-MORT-CONVY-CPF3-BAL IS NUMERIC                           
              IF F671-AMT-MORT-CONVY-CPF3-BAL > 0                               
                                                                                
                 MOVE 'MORT CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-MORT-CONVY-CPF3-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-MORT-CONVY-CPF3-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-MORT-CONVY-CPF3-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SRVY-FEE-CPF3-BAL IS NUMERIC                             
              IF F671-AMT-SRVY-FEE-CPF3-BAL > 0                                 
                                                                                
                 MOVE 'SRVY FEE'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-SRVY-FEE-CPF3-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SRVY-FEE-CPF3-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SRVY-FEE-CPF3-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-ESCR-CPF3-BAL IS NUMERIC                             
              IF F671-AMT-LSE-ESCR-CPF3-BAL > 0                                 
                                                                                
                 MOVE 'LSE ESCR'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-ESCR-CPF3-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-ESCR-CPF3-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-ESCR-CPF3-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-REGN-CPF3-BAL IS NUMERIC                             
              IF F671-AMT-LSE-REGN-CPF3-BAL > 0                                 
                                                                                
                 MOVE 'LSE REGN'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-REGN-CPF3-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-REGN-CPF3-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-REGN-CPF3-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-CAVEAT-REGN-CPF3-BAL IS NUMERIC                          
              IF F671-AMT-CAVEAT-REGN-CPF3-BAL > 0                              
                                                                                
                 MOVE 'CAVT REGN'  TO L373-TRANS-TYPE                           
                                                                                
                 MOVE F671-AMT-CAVEAT-REGN-CPF3-BAL TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-CAVEAT-REGN-CPF3-BAL        
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-CAVEAT-REGN-CPF3-BAL        
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SOLICIT-CPF3-BAL IS NUMERIC                              
              IF F671-AMT-SOLICIT-CPF3-BAL > 0                                  
                                                                                
                 MOVE 'SOLICIT'  TO L373-TRANS-TYPE                             
                                                                                
                 MOVE F671-AMT-SOLICIT-CPF3-BAL     TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOLICIT-CPF3-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOLICIT-CPF3-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       3400-WRITE-BP13L373-4.                                                   
      *--------------------------------------------------------*                
                                                                                
           IF F671-AMT-SOC-CPF4-BAL IS NUMERIC                                  
              IF F671-AMT-SOC-CPF4-BAL > 0                                      
                                                                                
                 MOVE 'SOC'   TO L373-TRANS-TYPE                                
                                                                                
                 MOVE F671-AMT-SOC-CPF4-BAL TO L373-AMOUNT                      
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOC-CPF4-BAL                
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOC-CPF4-BAL                
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LUMPSUM-CPF4-BAL IS NUMERIC                              
              IF F671-AMT-LUMPSUM-CPF4-BAL > 0                                  
                                                                                
                 MOVE 'LUMPSUM'   TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LUMPSUM-CPF4-BAL TO L373-AMOUNT                  
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LUMPSUM-CPF4-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LUMPSUM-CPF4-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-STMP-CPF4-BAL IS NUMERIC                             
              IF F671-AMT-LSE-STMP-CPF4-BAL > 0                                 
                                                                                
                 MOVE 'LSE STMP'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-STMP-CPF4-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-STMP-CPF4-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-STMP-CPF4-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SALE-CONVY-CPF4-BAL IS NUMERIC                           
              IF F671-AMT-SALE-CONVY-CPF4-BAL > 0                               
                                                                                
                 MOVE 'SALE CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-SALE-CONVY-CPF4-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SALE-CONVY-CPF4-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SALE-CONVY-CPF4-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-MORT-CONVY-CPF4-BAL IS NUMERIC                           
              IF F671-AMT-MORT-CONVY-CPF4-BAL > 0                               
                                                                                
                 MOVE 'MORT CONVY'  TO L373-TRANS-TYPE                          
                                                                                
                 MOVE F671-AMT-MORT-CONVY-CPF4-BAL TO L373-AMOUNT               
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-MORT-CONVY-CPF4-BAL         
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-MORT-CONVY-CPF4-BAL         
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SRVY-FEE-CPF4-BAL IS NUMERIC                             
              IF F671-AMT-SRVY-FEE-CPF4-BAL > 0                                 
                                                                                
                 MOVE 'SRVY FEE'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-SRVY-FEE-CPF4-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SRVY-FEE-CPF4-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SRVY-FEE-CPF4-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-ESCR-CPF4-BAL IS NUMERIC                             
              IF F671-AMT-LSE-ESCR-CPF4-BAL > 0                                 
                                                                                
                 MOVE 'LSE ESCR'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-ESCR-CPF4-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-ESCR-CPF4-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-ESCR-CPF4-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-LSE-REGN-CPF4-BAL IS NUMERIC                             
              IF F671-AMT-LSE-REGN-CPF4-BAL > 0                                 
                                                                                
                 MOVE 'LSE REGN'  TO L373-TRANS-TYPE                            
                                                                                
                 MOVE F671-AMT-LSE-REGN-CPF4-BAL TO L373-AMOUNT                 
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-LSE-REGN-CPF4-BAL           
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-LSE-REGN-CPF4-BAL           
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-CAVEAT-REGN-CPF4-BAL IS NUMERIC                          
              IF F671-AMT-CAVEAT-REGN-CPF4-BAL > 0                              
                                                                                
                 MOVE 'CAVT REGN'  TO L373-TRANS-TYPE                           
                                                                                
                 MOVE F671-AMT-CAVEAT-REGN-CPF4-BAL TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-CAVEAT-REGN-CPF4-BAL        
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-CAVEAT-REGN-CPF4-BAL        
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F671-AMT-SOLICIT-CPF4-BAL IS NUMERIC                              
              IF F671-AMT-SOLICIT-CPF4-BAL > 0                                  
                                                                                
                 MOVE 'SOLICIT'  TO L373-TRANS-TYPE                             
                                                                                
                 MOVE F671-AMT-SOLICIT-CPF4-BAL     TO L373-AMOUNT              
                 COMPUTE WS-REGN-TOTAL  =  WS-REGN-TOTAL  +                     
                                           F671-AMT-SOLICIT-CPF4-BAL            
                 COMPUTE WS-GRAND-TOTAL =  WS-GRAND-TOTAL +                     
                                           F671-AMT-SOLICIT-CPF4-BAL            
                                                                                
                 PERFORM 4000-WRITE-BP13L373    THRU 4000-EXIT                  
                 ADD 1    TO WS-CNT-L373-WRITE                                  
                 MOVE 'Y' TO WS-FLAG-REGN                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4000-WRITE-BP13L373.                                                     
      *----------------------------------------------------------------*        
                                                                                
           IF WS-LINE-CNT > 54                                                  
              PERFORM 4100-PRINT-HEADING THRU 4100-EXIT                         
              MOVE 1  TO WS-LINE-CNT                                            
           END-IF.                                                              
                                                                                
           MOVE SPACES         TO BP13L373-REC.                                 
           INITIALIZE             BP13L373-REC.                                 
                                                                                
           WRITE BP13L373-REC   FROM L373-PR-DETAILS-1 AFTER 1.                 
           ADD   1              TO WS-LINE-CNT.                                 
           MOVE  SPACES         TO L373-PR-DETAILS-1.                           
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4100-PRINT-HEADING.                                                      
      *----------------------------------------------------------------*        
                                                                                
           ADD  1                TO     WS-PAGE-CNT.                            
           MOVE WS-PAGE-CNT      TO     L373-PAGE.                              
                                                                                
           MOVE SPACES           TO     BP13L373-REC.                           
           INITIALIZE                   BP13L373-REC.                           
                                                                                
           WRITE BP13L373-REC    AFTER  PAGE.                                   
           WRITE BP13L373-REC    FROM   L373-PR-HEAD-01 AFTER 1.                
           WRITE BP13L373-REC    FROM   L373-PR-HEAD-02 AFTER 1.                
           WRITE BP13L373-REC    FROM   L373-PR-HEAD-03 AFTER 2.                
           WRITE BP13L373-REC    FROM   L373-PR-HEAD-04 AFTER 1.                
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4200-PRINT-FOOTER.                                                       
      *----------------------------------------------------------------*        
                                                                                
           IF WS-CNT-L373-WRITE < 1                                             
              GO TO 4200-EXIT                                                   
           END-IF.                                                              
                                                                                
           SUBTRACT 1                 FROM  WS-CNT-PRINT-L373.                  
           MOVE WS-GRAND-TOTAL        TO L373-GRAND-TOTAL.                      
           MOVE WS-CNT-PRINT-L373     TO L373-NO-CASES.                         
                                                                                
           MOVE SPACES                TO BP13L373-REC.                          
           INITIALIZE                    BP13L373-REC.                          
                                                                                
           WRITE BP13L373-REC         FROM L373-PR-FOOTER  AFTER 2.             
           WRITE BP13L373-REC         FROM L373-PR-HEAD-04 AFTER 1.             
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       4400-GET-NAME.                                                           
      *--------------------------------------------------------*                
                                                                                
            MOVE 'N'                    TO WS-K820-FOUND.                       
            PERFORM 4500-READ-BP13K820  THRU 4500-EXIT.                         
                                                                                
            IF WS-K820-FOUND = 'Y'                                              
               MOVE K820-NME-OCCP           TO L373-NAME                        
            ELSE                                                                
               MOVE SPACES                  TO L373-NAME                        
            END-IF.                                                             
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       4500-READ-BP13K820.                                                      
      *--------------------------------------------------------*                
                                                                                
           MOVE LOW-VALUES       TO K820-KEY-FLD.                               
           MOVE F671-NUM-REGN    TO K820-NUM-REGN.                              
           MOVE WS-NRIC          TO K820-NUM-NRIC.                              
                                                                                
           READ BP13K820.                                                       
                                                                                
           EVALUATE WS-K820-STATUS                                              
              WHEN 00                                                           
                 MOVE 'Y' TO WS-K820-FOUND                                      
              WHEN 23                                                           
                 MOVE 'N' TO WS-K820-FOUND                                      
                 DISPLAY 'NOT FOUND IN BP13K820. KEY : ' K820-KEY-FLD           
              WHEN OTHER                                                        
                 MOVE WS-K820-STATUS     TO RETURN-CODE                         
                 DISPLAY 'ERROR READING BP13K820, STATUS = '                    
                                        WS-K820-STATUS                          
                 PERFORM 9000-CLOSE-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4600-WRITE-BLANK.                                                        
      *----------------------------------------------------------------*        
                                                                                
           IF WS-LINE-CNT > 54                                                  
              PERFORM 4100-PRINT-HEADING THRU 4100-EXIT                         
              MOVE 1 TO WS-LINE-CNT                                             
           END-IF.                                                              
                                                                                
           MOVE SPACES           TO     BP13L373-REC.                           
           INITIALIZE                   BP13L373-REC.                           
                                                                                
           WRITE BP13L373-REC   FROM L373-PR-BLANK AFTER 1.                     
           ADD   1              TO WS-LINE-CNT.                                 
           MOVE  SPACES         TO L373-PR-DETAILS-1.                           
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4700-PRINT-SUB-TOTAL.                                                    
      *----------------------------------------------------------------*        
                                                                                
           IF WS-LINE-CNT > 54                                                  
              PERFORM 4100-PRINT-HEADING THRU 4100-EXIT                         
              MOVE 1 TO WS-LINE-CNT                                             
           END-IF.                                                              
                                                                                
           MOVE WS-REGN-TOTAL         TO L373-SUB-TOTAL.                        
                                                                                
           MOVE SPACES                TO BP13L373-REC.                          
           INITIALIZE                    BP13L373-REC.                          
                                                                                
           WRITE BP13L373-REC         FROM L373-PR-SUB-TOTAL AFTER 1.           
           ADD   1                    TO WS-LINE-CNT.                           
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       9000-CLOSE-ROUTINE.                                                      
      *--------------------------------------------------------*                
                                                                                
           CLOSE BP13F671                                                       
                 BP13K820                                                       
                 BP13L373.                                                      
                                                                                
           EVALUATE WS-K820-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K820-STATUS TO RETURN-CODE                             
                 DISPLAY 'BP13K820 CLOSE ERROR, STATUS='                        
                                                WS-K820-STATUS                  
           END-EVALUATE.                                                        
                                                                                
           DISPLAY '******  BP13C373 *************'.                            
           DISPLAY 'DATE : ' L373-DATE.                                         
           DISPLAY SPACE.                                                       
           DISPLAY 'NO OF READ (BP13F671) : ' WS-CNT-F671-READ.                 
           DISPLAY 'NO OF RECORDS PRINTED : ' WS-CNT-L373-WRITE.                
           DISPLAY 'NO OF CASES PRINTED   : ' WS-CNT-PRINT-L373.                
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
      *                         END OF PROGRAM                                  
      *--------------------------------------------------------------*          
