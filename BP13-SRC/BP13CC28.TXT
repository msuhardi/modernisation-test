      *************************                                                 
       IDENTIFICATION DIVISION.                                                 
      *************************                                                 
       PROGRAM-ID.    BP13CC28.                                                 
       AUTHOR.        BALA AMUTHAN.                                             
       DATE-WRITTEN.  18/07/06.                                                 
      *****************************************************************         
      * OBJECTIVE - MONTHLY REPORT ON  EW AND ADDITIONAL LOAN GRANTED           
      *             & INTEREST RAISED FOR BOTH CASES.                           
      *                                                                         
      *     INPUT FILE :                                                        
      *                  1. BP13FD38                                            
      *                  2. SY02F001                                            
      *                                                                         
      *     OUTPUT FILE:                                                        
      *                  1. NIL                                                 
      *                                                                         
      *     LISTING:                                                            
      *                  1. BP13L28A (REPORT)                                   
      *                  2. BP13L28B (REPORT)                                   
      *                  2. BP13L28C (REPORT)                                   
      *                                                                         
      *                                                                         
      *----------------------------------------------------------------         
      * REF NO    DATE      BY   AMENDMENTS/ENHANCEMENTS                        
      * -------   --------  ---  ------------------------                       
      * BP132888  18072006  BA2  NEW PROGRAM.                                   
      * BP132888  21112006  BA3  CHECK FOR MULTIPLE RECORD.                     
      *                          REMOVE ADDRESS.                                
      * BP132888  19012007  BA2  TO ADD FLAT TYPE COLUM ON THE REPORT.          
      *           23012007  BA3  EXPAND SEQUENCE NUMBER INTO 5 BYTES.           
      *           28022007  BA2  ADD REPORT BP13L28C, FOR SUMMARY OF            
      *                          NEW/ADDITIONAL DBSS LOAN DISBURSED.            
      * BP132973  09042007  BA3  CHECK FOR FIRST LOAN.                          
      * BP133052  12062007  BA3  PRINT 'NO RECORD' REPORT.                      
      * BP133173  01112007  BA3  INCLUDE LOAN SCHEME INTO THE REPORT.           
      * BP133091  17102007  RB12 EXPAND KD00 LENGTH FROM 1200 TO 1600           
      * BP133115  13032008  JB8  SEPARATE REPORT BY LOAN-SCH                    
      * BP133115  01042008  ED1  ADD WS-PRINT-NONCON TO DETERMINE               
      *                          SUMMARY HDR (CON/NON-CON)                      
      * BP133572  05062009  JB8  TO CATER FOR CASES TRANSFERED TO SMS           
      * BP134089  08022011  PCL3 TO READ BP13KD03                               
      * BP134154  09032011  JB8  TO DOUBLE CHECK NEW LOAN INTEREST              
      *****************************************************************         
                                                                                
                                                                                
      **********************                                                    
       ENVIRONMENT DIVISION.                                                    
      **********************                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT  BP13KD00  ASSIGN        TO BP13KD00                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS KD00-KEY-FLD                      
                             FILE STATUS   IS WS-KD00-STATUS.                   
                                                                                
           SELECT  BP13KD03  ASSIGN        TO BP13KD03                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS KD03-KEY-FLD                      
                             FILE STATUS   IS WS-KD03-STATUS.                   
                                                                                
           SELECT  BP13FD38  ASSIGN        TO BP13FD38.                         
           SELECT  SY02F001  ASSIGN        TO SY02F001.                         
           SELECT  BP13L28A  ASSIGN        TO BP13L28A.                         
           SELECT  BP13L28B  ASSIGN        TO BP13L28B.                         
           SELECT  BP13L28C  ASSIGN        TO BP13L28C.                         
                                                                                
      ***************                                                           
       DATA DIVISION.                                                           
      ***************                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
                                                                                
       FD   BP13KD00                                                            
                                       RECORD CONTAINS 1600 CHARACTERS.         
                                                                                
       COPY BP13KD00.                                                           
                                                                                
       FD   BP13KD03                                                            
                                       RECORD CONTAINS 1600 CHARACTERS.         
                                                                                
       COPY BP13KD03.                                                           
                                                                                
       FD   BP13FD38                   BLOCK CONTAINS 0 RECORDS                 
                                       RECORD CONTAINS 400 CHARACTERS           
                                       LABEL RECORDS ARE STANDARD               
                                       RECORDING MODE IS F.                     
       COPY BP13FD38.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD  BP13L28A                    BLOCK CONTAINS 0 RECORDS                 
                                       RECORD CONTAINS 132 CHARACTERS           
                                       LABEL RECORDS ARE OMITTED                
                                       RECORDING MODE IS F.                     
       01  PRINT-L28A-REC              PIC X(132).                              
                                                                                
       FD  BP13L28B                    BLOCK CONTAINS 0 RECORDS                 
                                       RECORD CONTAINS 132 CHARACTERS           
                                       LABEL RECORDS ARE OMITTED                
                                       RECORDING MODE IS F.                     
       01  PRINT-L28B-REC              PIC X(132).                              
                                                                                
       FD  BP13L28C                    BLOCK CONTAINS 0 RECORDS                 
                                       RECORD CONTAINS 132 CHARACTERS           
                                       LABEL RECORDS ARE OMITTED                
                                       RECORDING MODE IS F.                     
       01  PRINT-L28C-REC              PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
      *                   WORKING-STORAGE AREA                         *        
      ******************************************************************        
       01  WORK-FILE-VARIABLE.                                                  
           05  WS-KD00-STATUS          PIC 9(2)    VALUE 0.                     
           05  WS-KD03-STATUS          PIC 9(2)    VALUE 0.                     
                                                                                
       01  WS-PRINT-NONCON             PIC X     VALUE 'N'.                     
       01  WS-FD38-EOF                 PIC X     VALUE 'N'.                     
       01  WS-REC-FIRST                PIC X     VALUE SPACES.                  
       01  WS-HAS-MUL-REC              PIC X     VALUE 'N'.                     
       01  WS-PREV-REGN                PIC X(08) VALUE SPACES.                  
       01  WS-PREV-FLAT-NEW            PIC X(02) VALUE SPACES.                  
       01  WS-PREV-FLAT-EXIST          PIC X(02) VALUE SPACES.                  
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-CNT-FD38             PIC 9(7) COMP VALUE ZEROES.              
           05  WS-PAGE-CNT-L28A        PIC 9(5) COMP VALUE ZEROES.              
           05  WS-LINE-CNT-28A         PIC 9(2)      VALUE 60.                  
           05  CNT-CASES-L28A          PIC 9(5)      VALUE ZEROES.              
           05  CNT-CASES-L28A-COMP     PIC 9(5)      VALUE ZEROES.              
           05  WS-PAGE-CNT-L28B        PIC 9(5) COMP VALUE ZEROES.              
           05  WS-LINE-CNT-28B         PIC 9(2)      VALUE 60.                  
           05  CNT-CASES-L28B          PIC 9(5)      VALUE ZEROES.              
           05  CNT-CASES-L28B-COMP     PIC 9(5)      VALUE ZEROES.              
           05  CNT-CASES-L28B-COMP-MUL PIC 9(5)      VALUE ZEROES.              
           05  WS-LINE-CNT-28C         PIC 9(2)      VALUE 60.                  
           05  WS-PAGE-CNT-L28C        PIC 9(5) COMP VALUE ZEROES.              
           05  WS-IDX                  PIC 9(2)      VALUE ZEROES.              
                                                                                
       01  WS-GRANT-AMT.                                                        
           05  WS-NEW-TOT-SEL-PRICE    PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-NEW-TOT-SEL-PRICE-ALL                                         
                                       PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-EXIST-TOT-SEL-PRICE  PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-NEW-TOT-LOAN-AMT     PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-NEW-TOT-LOAN-AMT-ALL PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-EXIST-TOT-LOAN-AMT   PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-NEW-TOT-RAISED       PIC 9(7)V99 COMP VALUE ZEROES.           
           05  WS-EXIST-TOT-RAISED     PIC 9(7)V99 COMP VALUE ZEROES.           
           05  WS-TOT-AMT-LOAN-GRANTED PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-SUM-TOT-AC-SELL      PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-TOT-AC-SELL-X    PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-TOT-AC-NEWLOAN   PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-TOT-AC-NEWLOAN-X PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-TOT-AC-GRANT     PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-TOT-AC-GRANT-X   PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-NEW-TOT-SEL-PRICE-X  PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-NEW-TOT-LOAN-AMT-X   PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-TOT-AMT-LOAN-GRANTED-X                                        
                                       PIC 9(9)V99 COMP VALUE ZEROES.           
                                                                                
       01  WS-SUB-AMT.                                                          
           05  WS-NEW-SUB-LOAN-AMT     PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-NEW-SUB-LOAN-AMT-ALL PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-EXIST-SUB-LOAN-AMT   PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-NEW-SUB-SEL-PRICE    PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-NEW-SUB-SEL-PRICE-ALL                                         
                                       PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-EXIST-SUB-SEL-PRICE  PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-NEW-SUB-RAISED       PIC 9(7)V99 COMP VALUE ZEROES.           
           05  WS-EXIST-SUB-RAISED     PIC 9(7)V99 COMP VALUE ZEROES.           
           05  WS-SUM-SUB-AC-SELL      PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-SUB-AC-SELL-X    PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-SUB-AC-NEWLOAN   PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-SUB-AC-NEWLOAN-X PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-SUB-AC-GRANT     PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUM-SUB-AC-GRANT-X   PIC 9(5)    COMP VALUE ZEROES.           
           05  WS-SUB-AMT-LOAN-GRANTED PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-NEW-SUB-SEL-PRICE-X  PIC 9(11)   COMP VALUE ZEROES.           
           05  WS-NEW-SUB-LOAN-AMT-X   PIC 9(9)V99 COMP VALUE ZEROES.           
           05  WS-SUB-AMT-LOAN-GRANTED-X                                        
                                       PIC 9(9)V99 COMP VALUE ZEROES.           
                                                                                
       01  WS-TOTAL.                                                            
           05  WS-FINAL-TOT-AMT        PIC 9(11)V99 COMP VALUE ZEROES.          
           05  WS-FINAL-TOT-INT        PIC 9(07)V99 COMP VALUE ZEROES.          
           05  WS-FINAL-ACCT-NO        PIC 9(5)     COMP VALUE ZEROES.          
                                                                                
       01  WS-CURR-DATE.                                                        
           05  WS-CURR-CCYY            PIC X(4)  VALUE SPACES.                  
           05  WS-CURR-MM              PIC X(2)  VALUE SPACES.                  
           05  WS-CURR-DD              PIC X(2)  VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-01.                                                     
           05  WS-HEAD-RPT-NME         PIC X(8)  VALUE 'BP13L28A'.              
           05  FILLER                  PIC X(4)  VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'HDBCAT3'.               
           05  FILLER                  PIC X(25) VALUE SPACES.                  
           05  FILLER                  PIC X(20) VALUE                          
                                       'S Y S T E M   O F   '.                  
           05  FILLER                  PIC X(19) VALUE                          
                                       'C O M M I T M E N T'.                   
           05  FILLER                  PIC X(15) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'DATE :'.                
           05  LC28-DATE-HD1           PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(4)  VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'PAGE : '.               
           05  LC28-PAGENO             PIC ZZZZ9 .                              
           05  FILLER                  PIC X(1)  VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-02.                                                     
           05  FILLER                  PIC X(30) VALUE SPACES.                  
           05  FILLER                  PIC X(37) VALUE                          
               'MONTHLY REPORT ON NEW LOAN GRANTED & '.                         
           05  FILLER                  PIC X(20) VALUE                          
               'INTEREST RAISED FOR '.                                          
           05  LC28-NEW-HEAD-DTE       PIC X(08) VALUE SPACES.                  
           05  LC28-NEW-LOAN-SCH       PIC X(25) VALUE SPACES.                  
           05  FILLER                  PIC X(12) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-03.                                                     
           05  FILLER                  PIC X(29) VALUE SPACES.                  
           05  FILLER                  PIC X(44) VALUE                          
               'MONTHLY REPORT ON ADDITIONAL LOAN GRANTED & '.                  
           05  FILLER                  PIC X(20) VALUE                          
               'INTEREST RAISED FOR '.                                          
           05  LC28-EXIST-HEAD-DTE     PIC X(08) VALUE SPACES.                  
           05  LC28-EXIST-LOAN-SCH     PIC X(25) VALUE SPACES.                  
           05  FILLER                  PIC X(06) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-04.                                                     
           05  FILLER                  PIC X(39) VALUE SPACES.                  
           05  FILLER                  PIC X(38) VALUE                          
               '   NEW/ADDITIONAL DBSS LOAN DISBURSED '.                        
           05  LC28-SUM-HEAD-DTE       PIC X(08) VALUE SPACES.                  
           05  FILLER                  PIC X(41) VALUE SPACES.                  
                                                                                
       01  LC28-PR-NEW-CASE-HEAD.                                               
           05  FILLER                  PIC X(02)  VALUE SPACES.                 
           05  FILLER                  PIC X(32)  VALUE                         
               'NEW CASES                       '.                              
           05  FILLER                  PIC X(108) VALUE SPACES.                 
                                                                                
       01  LC28-PR-EXIST-CASE-HEAD.                                             
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(44) VALUE                          
               'EXISTING CASES                             '.                   
           05  FILLER                  PIC X(86) VALUE SPACES.                  
                                                                                
       01  LC28-PR-SUB-SUM-HEAD.                                                
           05  FILLER                  PIC X(39) VALUE SPACES.                  
           05  FILLER                  PIC X(44) VALUE                          
               '              (CONCESSIONARY RATE)          '.                  
           05  FILLER                  PIC X(49) VALUE SPACES.                  
                                                                                
       01  LC28-PR-SUB-SUM-HEAD-NCON.                                           
           05  FILLER                  PIC X(39) VALUE SPACES.                  
           05  FILLER                  PIC X(44) VALUE                          
               '              (NON-CONCESSIONARY RATE)      '.                  
           05  FILLER                  PIC X(49) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-NEW.                                                    
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE 'S/N'.                   
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(06) VALUE 'REG-NO'.                
           05  FILLER                  PIC X(05) VALUE SPACES.                  
           05  FILLER                  PIC X(07) VALUE 'HDB-REF'.               
           05  FILLER                  PIC X(05) VALUE SPACES.                  
           05  FILLER                  PIC X(09) VALUE 'FLAT-TYPE'.             
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  FILLER                  PIC X(06) VALUE 'PP-SCH'.                
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(11) VALUE 'SELL-PRICE '.           
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  FILLER                  PIC X(16) VALUE                          
                                      'NEW LOAN-GRANTED'.                       
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(16) VALUE                          
                                      'EFF-DATE-OF-LOAN'.                       
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  FILLER                  PIC X(08) VALUE                          
                                             'LOAN-SCH'.                        
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  FILLER                  PIC X(08) VALUE                          
                                             'INT-RATE'.                        
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  FILLER                  PIC X(10) VALUE                          
                                             'INT-RAISED'.                      
           05  FILLER                  PIC X(01) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-NEW-1.                                                  
           05  FILLER                  PIC X(61) VALUE SPACES.                  
           05  FILLER                  PIC X(16) VALUE                          
                                      '    (DISBURSED) '.                       
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(16) VALUE                          
                                      '  (DUE-DATE)  '.                         
           05  FILLER                  PIC X(24) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-EXIST.                                                  
           05  FILLER                  PIC X(70) VALUE SPACES.                  
           05  FILLER                  PIC X(12) VALUE                          
                                      'ADDITIONAL  '.                           
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(15) VALUE                          
                                      'EFF-DATE-OF-   '.                        
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(5)  VALUE                          
                                      'LOAN-'.                                  
      *    05  FILLER                  PIC X(32) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-EXIST-1.                                                
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE 'S/N'.                   
           05  FILLER                  PIC X(06) VALUE SPACES.                  
           05  FILLER                  PIC X(06) VALUE 'REG-NO'.                
           05  FILLER                  PIC X(05) VALUE SPACES.                  
           05  FILLER                  PIC X(07) VALUE 'HDB-REF'.               
           05  FILLER                  PIC X(07) VALUE SPACES.                  
           05  FILLER                  PIC X(09) VALUE 'FLAT-TYPE'.             
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(06) VALUE 'PP SCH'.                
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(11) VALUE                          
                                      'SELL-PRICE '.                            
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(12) VALUE                          
                                      'LOAN-GRANTED'.                           
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(15) VALUE                          
                                      'ADDITIONAL-LOAN'.                        
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE                          
                                             'SCH'.                             
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(08) VALUE                          
                                             'INT-RATE'.                        
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(10) VALUE                          
                                             'INT-RAISED'.                      
           05  FILLER                  PIC X(08) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-EXIST-2.                                                
           05  FILLER                  PIC X(70) VALUE SPACES.                  
           05  FILLER                  PIC X(12) VALUE                          
                                      '(DISBURSED) '.                           
           05  FILLER                  PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(14) VALUE                          
                                      '  (DUE-DATE) '.                          
           05  FILLER                  PIC X(33) VALUE SPACES.                  
                                                                                
       01  LC28-PR-HEAD-SUM.                                                    
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(09) VALUE 'FLAT TYPE'.             
           05  FILLER                  PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(13) VALUE 'SELLING PRICE'.         
           05  FILLER                  PIC X(06) VALUE SPACES.                  
           05  FILLER                  PIC X(12) VALUE 'LOAN GRANTED'.          
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(18) VALUE                          
                                               'NEW LOAN DISBURSED'.            
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(14) VALUE 'N-CONC SELL PR'.        
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(19)                                
                                           VALUE 'N-CONC LOAN GRANTED'.         
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(25) VALUE                          
                                          'N-CONC NEW LOAN DISBURSED'.          
      *    05  FILLER                  PIC X(64) VALUE SPACES.                  
                                                                                
       01  LC28-PR-ROLL-NEW.                                                    
           05  FILLER                  PIC X(02)  VALUE SPACES.                 
           05  FILLER                  PIC X(126) VALUE ALL '-'.                
           05  FILLER                  PIC X(04)  VALUE SPACES.                 
                                                                                
       01  LC28-PR-ROLL-EXIST.                                                  
           05  FILLER                  PIC X(02)  VALUE SPACES.                 
           05  FILLER                  PIC X(130) VALUE ALL '-'.                
                                                                                
       01  LC28-PR-ROLL-SUM.                                                    
           05  FILLER                  PIC X(02)  VALUE SPACES.                 
           05  FILLER                  PIC X(128)  VALUE ALL '-'.               
                                                                                
       01  LC28-PR-DETAILS-NEW.                                                 
           05  LC28-SNO                PIC ZZZZ9       VALUE ZEROES.            
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  LC28-REG-NO             PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  LC28-HDB-REF            PIC X(13)       VALUE SPACES.            
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  LC28-FLAT-TYPE          PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  LC28-PP-SCH             PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  LC28-SELL-PRICE         PIC $$$,$$$,$$9 VALUE ZEROES.            
           05  FILLER                  PIC X(4)        VALUE SPACES.            
           05  LC28-GRANT-LOAN         PIC $,$$$,$$9.99  VALUE ZEROES.          
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  LC28-NEW-EFF-DTE        PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  LC28-LOAN-SCH           PIC X           VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  LC28-INT-RATE           PIC Z9.99       VALUE ZEROES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  LC28-AMT-RAISED         PIC $$$,$$9.99  VALUE ZEROES.            
           05  FILLER                  PIC X(06)       VALUE SPACES.            
                                                                                
       01  LC28-PR-DETAILS-EXIST.                                               
           05  LC28-SNO-EX             PIC ZZZZ9        VALUE ZEROES.           
           05  FILLER                  PIC X(4)         VALUE SPACES.           
           05  LC28-REG-NO-EX          PIC X(8)         VALUE SPACES.           
           05  FILLER                  PIC X(2)         VALUE SPACES.           
           05  LC28-HDB-REF-EX         PIC X(13)        VALUE SPACES.           
           05  FILLER                  PIC X(8)         VALUE SPACES.           
           05  LC28-FLAT-TYPE-EX       PIC X(2)         VALUE SPACES.           
           05  FILLER                  PIC X(7)         VALUE SPACES.           
           05  LC28-PP-SCH-EX          PIC X(2)         VALUE SPACES.           
           05  FILLER                  PIC X(3)         VALUE SPACES.           
           05  LC28-SELL-PRICE-EX      PIC $$$,$$$,$$9  VALUE ZEROES.           
           05  FILLER                  PIC X(4)         VALUE SPACES.           
           05  LC28-GRANT-LOAN-EX      PIC $,$$$,$$9.99 VALUE ZEROES.           
           05  FILLER                  PIC X(4)         VALUE SPACES.           
           05  LC28-NEW-EFF-DTE-EX     PIC X(10)        VALUE SPACES.           
           05  FILLER                  PIC X(08)        VALUE SPACES.           
           05  LC28-LOAN-SCH-EX        PIC X            VALUE SPACES.           
           05  FILLER                  PIC X(6)         VALUE SPACES.           
           05  LC28-INT-RATE-EX        PIC Z9.99        VALUE ZEROES.           
           05  FILLER                  PIC X(4)         VALUE SPACES.           
           05  LC28-AMT-RAISED-EX      PIC $$$,$$9.99   VALUE ZEROES.           
           05  FILLER                  PIC X(10)        VALUE SPACES.           
                                                                                
       01  LC28-PR-DETAILS-SUM.                                                 
           05  FILLER                  PIC X(2)         VALUE SPACES.           
           05  LC28-FLT-TYP-SUM        PIC X(5)         VALUE SPACES.           
           05  FILLER                  PIC X(06)        VALUE SPACES.           
           05  LC28-SELL-PRICE-SUM     PIC $$$,$$$,$$$,$$9 VALUE ZEROES.        
           05  FILLER                  PIC X(3)         VALUE SPACES.           
           05  LC28-GRANT-LOAN-SUM     PIC $$$$,$$$,$$9.99 VALUE ZEROES.        
           05  FILLER                  PIC X(05)        VALUE SPACES.           
           05  LC28-NEW-LOAN-SUM       PIC $$$$,$$$,$$9.99 VALUE ZEROES.        
           05  FILLER                  PIC X(01)        VALUE SPACES.           
           05  LC28-SELL-PRICE-SUM-X   PIC $$$,$$$,$$$,$$9 VALUE ZEROES.        
           05  FILLER                  PIC X(6)         VALUE SPACES.           
           05  LC28-GRANT-LOAN-SUM-X   PIC $$$$,$$$,$$9.99 VALUE ZEROES.        
           05  FILLER                  PIC X(12)        VALUE SPACES.           
           05  LC28-NEW-LOAN-SUM-X     PIC $$$$,$$$,$$9.99 VALUE ZEROES.        
      *    05  FILLER                  PIC X(58)        VALUE SPACES.           
                                                                                
       01  LC28-PR-DETAILS-SUM-1.                                               
           05  FILLER                  PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(10)       VALUE                    
                                             'NO OF A/CS'.                      
           05  FILLER                  PIC X(12)       VALUE SPACES.            
           05  LC28-TOT-SELL-AC-SUM    PIC ZZZ9        VALUE ZEROES.            
           05  FILLER                  PIC X(14)       VALUE SPACES.            
           05  LC28-TOT-GRANT-AC-SUM   PIC ZZZ9        VALUE ZEROES.            
           05  FILLER                  PIC X(16)       VALUE SPACES.            
           05  LC28-TOT-LOAN-AC-SUM    PIC ZZZ9        VALUE ZEROES.            
           05  FILLER                  PIC X(12)       VALUE SPACES.            
           05  LC28-TOT-SELL-AC-SUM-X  PIC ZZZ9        VALUE ZEROES.            
           05  FILLER                  PIC X(17)       VALUE SPACES.            
           05  LC28-TOT-GRANT-AC-SUM-X PIC ZZZ9        VALUE ZEROES.            
           05  FILLER                  PIC X(23)       VALUE SPACES.            
           05  LC28-TOT-LOAN-AC-SUM-X  PIC ZZZ9        VALUE ZEROES.            
      *    05  FILLER                  PIC X(64)       VALUE SPACES.            
                                                                                
       01  LC28-PRINT-SUB-NEW.                                                  
           05  FILLER                  PIC X(04)        VALUE SPACES.           
           05  FILLER                  PIC X(14)        VALUE                   
                                                     'SUB TOTAL'.               
           05  FILLER                  PIC X(26)           VALUE SPACES.        
           05  LC28-SUB-SEL-PRICE      PIC $$$,$$$,$$$,$$9 VALUE ZEROES.        
           05  FILLER                  PIC X(01)           VALUE SPACES.        
           05  LC28-SUB-GRANT-LOAN     PIC $$$$,$$$,$$9.99 VALUE ZEROES.        
           05  FILLER                  PIC X(36)           VALUE SPACES.        
           05  LC28-SUB-INT-RAISED     PIC $$$,$$$,$$9.99  VALUE ZEROES.        
           05  FILLER                  PIC X(16)           VALUE SPACES.        
                                                                                
       01  LC28-PRINT-SUB-EXIST.                                                
           05  FILLER                  PIC X(04)           VALUE SPACES.        
           05  FILLER                  PIC X(14)           VALUE                
                                                     'SUB TOTAL'.               
           05  FILLER                  PIC X(32)           VALUE SPACES.        
           05  LC28-SUB-SEL-PRICE-EX   PIC $$$,$$$,$$$,$$9 VALUE ZEROES.        
           05  FILLER                  PIC X(01)           VALUE SPACES.        
           05  LC28-SUB-GRANT-LOAN-EX  PIC $$$$,$$$,$$9.99                      
                                                           VALUE ZEROES.        
           05  FILLER                  PIC X(34)           VALUE SPACES.        
           05  LC28-SUB-INT-RAISED-EX  PIC $$$,$$$,$$9.99  VALUE ZEROES.        
      *    05  FILLER                  PIC X(10)           VALUE SPACES.        
                                                                                
       01  LC28-PRINT-GRANT-NEW.                                                
           05  FILLER                  PIC X(04)        VALUE SPACES.           
           05  FILLER                  PIC X(05)        VALUE 'TOTAL'.          
           05  FILLER                  PIC X(35)        VALUE SPACES.           
           05  LC28-TOT-SEL-PRICE      PIC $$$,$$$,$$$,$$9 VALUE ZEROES.        
           05  FILLER                  PIC X(02)           VALUE SPACES.        
           05  LC28-TOT-GRANT-LOAN     PIC $$$,$$$,$$9.99 VALUE ZEROES.         
           05  FILLER                  PIC X(36)        VALUE SPACES.           
           05  LC28-TOT-INT-RAISED     PIC $$$,$$$,$$9.99 VALUE ZEROES.         
           05  FILLER                  PIC X(08)        VALUE SPACES.           
                                                                                
       01  LC28-PRINT-GRANT-EXIST.                                              
           05  FILLER                  PIC X(04)        VALUE SPACES.           
           05  FILLER                  PIC X(05)        VALUE 'TOTAL'.          
           05  FILLER                  PIC X(41)        VALUE SPACES.           
           05  LC28-TOT-SEL-PRICE-EX   PIC $$$,$$$,$$$,$$9 VALUE ZEROES.        
           05  FILLER                  PIC X(02)           VALUE SPACES.        
           05  LC28-TOT-GRANT-LOAN-EX  PIC $$$,$$$,$$9.99 VALUE ZEROES.         
           05  FILLER                  PIC X(34)        VALUE SPACES.           
           05  LC28-TOT-INT-RAISED-EX  PIC $$$,$$$,$$9.99 VALUE ZEROES.         
      *    05  FILLER                  PIC X(13)           VALUE SPACES.        
                                                                                
       01  LC28-PRINT-GRANT-NEW-ROLL.                                           
           05  FILLER                  PIC X(04)        VALUE SPACES.           
           05  FILLER                  PIC X(05)        VALUE ALL '-'.          
           05  FILLER                  PIC X(36)        VALUE SPACES.           
           05  FILLER                  PIC X(14)        VALUE ALL '-'.          
           05  FILLER                  PIC X(02)        VALUE SPACES.           
           05  FILLER                  PIC X(14)        VALUE ALL '-'.          
           05  FILLER                  PIC X(37)        VALUE SPACES.           
           05  FILLER                  PIC X(13)        VALUE ALL '-'.          
           05  FILLER                  PIC X(03)        VALUE SPACES.           
                                                                                
       01  LC28-PRINT-GRANT-EXIST-ROLL.                                         
           05  FILLER                  PIC X(04)        VALUE SPACES.           
           05  FILLER                  PIC X(05)        VALUE ALL '-'.          
           05  FILLER                  PIC X(42)        VALUE SPACES.           
           05  FILLER                  PIC X(14)        VALUE ALL '-'.          
           05  FILLER                  PIC X(02)        VALUE SPACES.           
           05  FILLER                  PIC X(14)        VALUE ALL '-'.          
           05  FILLER                  PIC X(37)        VALUE SPACES.           
           05  FILLER                  PIC X(11)        VALUE ALL '-'.          
      *    05  FILLER                  PIC X(11)        VALUE SPACES.           
                                                                                
       01  LC28-PRINT-TOTAL-HEAD.                                               
           05  FILLER                  PIC X(02)   VALUE SPACES.                
           05  FILLER                  PIC X(07)   VALUE 'SUMMARY'.             
           05  FILLER                  PIC X(60)   VALUE SPACES.                
           05  FILLER                  PIC X(14)   VALUE                        
                                       '  LOAN GRANTED'.                        
           05  FILLER                  PIC X(05)   VALUE SPACES.                
           05  FILLER                  PIC X(10)   VALUE                        
                                       'INT-RAISED'.                            
           05  FILLER                  PIC X(34)   VALUE SPACES.                
                                                                                
       01  LC28-PRINT-TOTAL.                                                    
           05  FILLER                  PIC X(02)   VALUE SPACES.                
           05  LC28-TOT                PIC X(32)   VALUE SPACES.                
           05  LC28-FINAL-ACCT         PIC Z(4)9.                               
           05  FILLER                  PIC X(28)   VALUE SPACES.                
           05  LC28-FINAL-TOT          PIC $$$$,$$$,$$9.99.                     
           05  FILLER                  PIC X(03)   VALUE SPACES.                
           05  LC28-FINAL-INT-AMT      PIC $$$$,$$9.99    VALUE ZEROES.         
           05  FILLER                  PIC X(36)   VALUE SPACES.                
                                                                                
       01  LC28-PRINT-TOTAL-ROLL.                                               
           05  FILLER                  PIC X(02)   VALUE SPACES.                
           05  FILLER                  PIC X(07)   VALUE ALL '-'.               
           05  FILLER                  PIC X(60)   VALUE SPACES.                
           05  FILLER                  PIC X(14)   VALUE ALL '-'.               
           05  FILLER                  PIC X(05)   VALUE SPACES.                
           05  FILLER                  PIC X(10)   VALUE ALL '-'.               
           05  FILLER                  PIC X(34)   VALUE SPACES.                
                                                                                
       01  LC28-PR-SPACES.                                                      
           05  FILLER                  PIC X(132) VALUE SPACES.                 
                                                                                
       01  LC28-NO-RECORD.                                                      
           03  FILLER                  PIC X(14)     VALUE                      
                                                    '*** NO RECORDS'.           
                                                                                
      ******************************************************************        
      *                   P R O G R A M     B O D Y                    *        
      ******************************************************************        
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
                                                                                
      ******************************************************************        
       0000-MAIN-PARA.                                                          
      ******************************************************************        
                                                                                
           PERFORM 1000-START-UP           THRU  1000-EXIT.                     
                                                                                
           PERFORM 1500-READ-SY02F001      THRU  1500-EXIT.                     
                                                                                
           PERFORM 2000-READ-FD38          THRU  2000-EXIT.                     
                                                                                
           PERFORM 2001-DECIDE-LOAN-SCH    THRU  2001-EXIT.                     
                                                                                
           PERFORM 3000-PROCESS-RECORD     THRU  3000-EXIT                      
                   UNTIL WS-FD38-EOF       =     'Y'.                           
                                                                                
           PERFORM 3500-GRANT-PROCESS      THRU  3500-EXIT.                     
                                                                                
           PERFORM 8500-PRINT-EMPTY-REP    THRU  8500-EXIT.                     
                                                                                
           PERFORM 9999-CLOSE-ROUTINE      THRU  9999-EXIT.                     
                                                                                
       0000-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       1000-START-UP.                                                           
      ******************************************************************        
                                                                                
           OPEN INPUT  BP13KD00                                                 
                       BP13FD38                                                 
                       BP13KD03                                                 
                       SY02F001                                                 
                OUTPUT BP13L28A                                                 
                       BP13L28B                                                 
                       BP13L28C.                                                
                                                                                
           IF WS-KD00-STATUS = 97 OR 00                                         
              CONTINUE                                                          
           ELSE                                                                 
              MOVE WS-KD00-STATUS TO RETURN-CODE                                
              DISPLAY 'OPEN BP13KD00 FAIL. STATUS : ' WS-KD00-STATUS            
              PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-KD03-STATUS = 97 OR 00                                         
              CONTINUE                                                          
           ELSE                                                                 
              MOVE WS-KD03-STATUS TO RETURN-CODE                                
              DISPLAY 'OPEN BP13KD03 FAIL. STATUS : ' WS-KD03-STATUS            
              PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                         
           END-IF.                                                              
                                                                                
       1000-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       1500-READ-SY02F001.                                                      
      ******************************************************************        
                                                                                
           READ SY02F001.                                                       
           MOVE F001-DTE-CURRENT      TO WS-CURR-DATE.                          
                                                                                
           STRING WS-CURR-DD '/' WS-CURR-MM '/' WS-CURR-CCYY                    
                  DELIMITED BY SIZE INTO LC28-DATE-HD1.                         
                                                                                
           STRING F001-TXT-PREV-MTH(1:3)  ' '                                   
                  F001-DTE-LAST-DAY-PREV(1:4)                                   
                  DELIMITED BY SIZE INTO LC28-NEW-HEAD-DTE.                     
           MOVE   LC28-NEW-HEAD-DTE  TO  LC28-EXIST-HEAD-DTE                    
                                         LC28-SUM-HEAD-DTE.                     
                                                                                
       1500-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       2000-READ-FD38.                                                          
      ******************************************************************        
                                                                                
           READ BP13FD38           AT   END                                     
                MOVE 'Y'           TO   WS-FD38-EOF                             
                GO                 TO   2000-EXIT.                              
                                                                                
           ADD  1                  TO   WS-CNT-FD38.                            
                                                                                
       2000-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       2001-DECIDE-LOAN-SCH.                                                    
      ******************************************************************        
                                                                                
           IF FD38-NUM-LOAN-SCH = 'P'                                           
              MOVE ' (CONCESSIONARY LOAN)'     TO LC28-EXIST-LOAN-SCH           
                                                  LC28-NEW-LOAN-SCH             
           ELSE                                                                 
              MOVE 'Y'                         TO WS-PRINT-NONCON               
              MOVE ' (NON-CONCESSIONARY LOAN)' TO LC28-EXIST-LOAN-SCH           
                                                  LC28-NEW-LOAN-SCH             
           END-IF.                                                              
                                                                                
                                                                                
       2001-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       2100-READ-BP13KD00.                                                      
      ******************************************************************        
                                                                                
           READ BP13KD00.                                                       
                                                                                
           EVALUATE WS-KD00-STATUS                                              
               WHEN 00                                                          
                   CONTINUE                                                     
               WHEN 10                                                          
               WHEN 23                                                          
                   PERFORM 2200-READ-BP13KD03            THRU 2200-EXIT         
                                                                                
               WHEN OTHER                                                       
                   MOVE WS-KD00-STATUS TO RETURN-CODE                           
                   DISPLAY 'READ ERROR IN BP13KD00 : ' WS-KD00-STATUS           
                   PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       2100-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       2200-READ-BP13KD03.                                                      
      ******************************************************************        
                                                                                
           MOVE SPACES                         TO BP13KD03-REC.                 
           INITIALIZE                             BP13KD03-REC.                 
                                                                                
           MOVE KD00-NUM-REGN                  TO KD03-NUM-REGN.                
                                                                                
           READ BP13KD03.                                                       
                                                                                
           EVALUATE WS-KD03-STATUS                                              
               WHEN 00                                                          
                   MOVE SPACES                 TO BP13KD00-REC                  
                   INITIALIZE                     BP13KD00-REC                  
                                                                                
                   MOVE BP13KD03-REC           TO BP13KD00-REC                  
               WHEN 10                                                          
               WHEN 23                                                          
                   DISPLAY 'REGNO NOT FOUND IN BP13KD00 & BP13KD03 : '          
                                          KD00-NUM-REGN                         
               WHEN OTHER                                                       
                   MOVE WS-KD03-STATUS TO RETURN-CODE                           
                   DISPLAY 'READ ERROR IN BP13KD03 : ' WS-KD03-STATUS           
                   PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       2200-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       3000-PROCESS-RECORD.                                                     
      ******************************************************************        
                                                                                
           IF FD38-AMT-INTEREST-NEWLOAN NOT NUMERIC                             
              MOVE 0                TO FD38-AMT-INTEREST-NEWLOAN                
           END-IF.                                                              
                                                                                
           MOVE 'N'                 TO WS-REC-FIRST.                            
                                                                                
           IF FD38-DTE-DUE(1:6) = F001-DTE-LAST-DAY-PREV(1:6) AND               
              FD38-AMT-INTEREST-NEWLOAN > 0                                     
              IF FD38-NUM-1ST-LOAN = 'Y'                                        
                 MOVE FD38-NUM-REGN TO WS-PREV-REGN                             
                 MOVE 'Y'           TO WS-REC-FIRST                             
                 MOVE 'N'           TO WS-HAS-MUL-REC                           
                 PERFORM 3050-CHECK-MULTIPLE-REGN THRU 3050-EXIT                
                         UNTIL FD38-NUM-REGN NOT = WS-PREV-REGN                 
                         OR WS-FD38-EOF = 'Y'                                   
                 ADD 1              TO CNT-CASES-L28A-COMP                      
                 IF WS-HAS-MUL-REC = 'Y'                                        
                    ADD 1           TO CNT-CASES-L28B-COMP-MUL                  
                 END-IF                                                         
              ELSE                                                              
                    IF FD38-NUM-REGN NOT = WS-PREV-REGN                         
                       MOVE FD38-NUM-REGN TO WS-PREV-REGN                       
                       ADD 1        TO CNT-CASES-L28B-COMP                      
                    END-IF                                                      
                    PERFORM 4100-MOVE-DETAILS-EXIST   THRU 4100-EXIT            
                    PERFORM 6100-PRINT-EXIST-CASE-REC THRU 6100-EXIT            
                    PERFORM 2000-READ-FD38            THRU 2000-EXIT            
              END-IF                                                            
           ELSE                                                                 
              PERFORM 2000-READ-FD38            THRU 2000-EXIT                  
           END-IF.                                                              
                                                                                
       3000-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       3050-CHECK-MULTIPLE-REGN.                                                
      ******************************************************************        
                                                                                
           IF FD38-DTE-DUE(1:6) = F001-DTE-LAST-DAY-PREV(1:6) AND               
              FD38-AMT-INTEREST-NEWLOAN > 0                                     
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 2000-READ-FD38              THRU 2000-EXIT                
              GO TO 3050-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF FD38-NUM-REGN =  WS-PREV-REGN AND                                 
              WS-REC-FIRST  = 'Y'                                               
              PERFORM 4000-MOVE-DETAILS-NEW       THRU 4000-EXIT                
              PERFORM 6000-PRINT-NEW-CASE-REC     THRU 6000-EXIT                
           ELSE                                                                 
              PERFORM 4100-MOVE-DETAILS-EXIST     THRU 4100-EXIT                
              PERFORM 6100-PRINT-EXIST-CASE-REC   THRU 6100-EXIT                
              MOVE 'Y'                              TO WS-HAS-MUL-REC           
           END-IF.                                                              
           MOVE 'N'                                 TO WS-REC-FIRST.            
           PERFORM 2000-READ-FD38                 THRU 2000-EXIT.               
                                                                                
       3050-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       3500-GRANT-PROCESS.                                                      
      ******************************************************************        
                                                                                
           IF CNT-CASES-L28A > ZEROES                                           
              IF WS-NEW-SUB-LOAN-AMT > 0 OR WS-NEW-SUB-RAISED > 0               
                 OR WS-NEW-SUB-SEL-PRICE > 0 OR                                 
                 WS-NEW-SUB-LOAN-AMT-X > 0 OR WS-NEW-SUB-SEL-PRICE-X > 0        
                 PERFORM 7200-PRINT-SUB-TOT-NEW       THRU 7200-EXIT            
                 PERFORM 8000-PRINT-SUMMARY-REPORT    THRU 8000-EXIT            
              END-IF                                                            
              IF WS-SUM-TOT-AC-SELL > 0  OR WS-SUM-TOT-AC-GRANT > 0             
                 OR WS-SUM-TOT-AC-NEWLOAN > 0 OR                                
                 WS-SUM-TOT-AC-SELL-X > 0 OR WS-SUM-TOT-AC-GRANT-X > 0          
                 OR WS-SUM-TOT-AC-NEWLOAN-X > 0                                 
                 PERFORM 8200-PRINT-SUMMARY-TOTAL     THRU 8200-EXIT            
              END-IF                                                            
              IF WS-LINE-CNT-28A > 51                                           
                 PERFORM 7000-PRINT-NEW-CASE-HEAD     THRU 7000-EXIT            
              END-IF                                                            
              PERFORM 6200-PRINT-NEW-CASE-GRANT       THRU 6200-EXIT            
              IF WS-LINE-CNT-28A > 49                                           
                 PERFORM 7000-PRINT-NEW-CASE-HEAD     THRU 7000-EXIT            
              END-IF                                                            
              PERFORM 6400-PRINT-SUMMARY-NEW          THRU 6400-EXIT            
           END-IF.                                                              
                                                                                
           IF CNT-CASES-L28B > ZEROES                                           
              IF WS-EXIST-SUB-LOAN-AMT > 0 OR WS-EXIST-SUB-RAISED > 0           
                 OR WS-EXIST-SUB-SEL-PRICE > 0                                  
                 PERFORM 7300-PRINT-SUB-TOT-EXIST     THRU 7300-EXIT            
              END-IF                                                            
              IF WS-LINE-CNT-28B > 51                                           
                 PERFORM 7100-PRINT-EXIST-CASE-HEAD   THRU 7100-EXIT            
              END-IF                                                            
              PERFORM 6300-PRINT-EXIST-CASE-GRANT     THRU 6300-EXIT            
              IF WS-LINE-CNT-28B > 49                                           
                 PERFORM 7100-PRINT-EXIST-CASE-HEAD   THRU 7100-EXIT            
              END-IF                                                            
              PERFORM 6500-PRINT-SUMMARY-EXIST        THRU 6500-EXIT            
           END-IF.                                                              
                                                                                
       3500-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       4000-MOVE-DETAILS-NEW.                                                   
      ******************************************************************        
           IF WS-PREV-FLAT-NEW NOT = FD38-NUM-FLAT-TYPE AND                     
              WS-PREV-FLAT-NEW NOT = SPACES                                     
              PERFORM 7200-PRINT-SUB-TOT-NEW       THRU 7200-EXIT               
              PERFORM 8000-PRINT-SUMMARY-REPORT    THRU 8000-EXIT               
           END-IF.                                                              
           IF WS-LINE-CNT-28A > 54                                              
              PERFORM 7000-PRINT-NEW-CASE-HEAD     THRU 7000-EXIT               
           END-IF.                                                              
                                                                                
           MOVE SPACES                   TO BP13KD00-REC.                       
           INITIALIZE BP13KD00-REC.                                             
                                                                                
           MOVE FD38-NUM-REGN            TO LC28-REG-NO KD00-NUM-REGN.          
                                                                                
           PERFORM  2100-READ-BP13KD00   THRU 2100-EXIT.                        
           MOVE KD00-AMT-SELL-PRICE      TO LC28-SELL-PRICE.                    
                                                                                
           IF KD00-AMT-SELL-PRICE NOT = 0                                       
              IF FD38-NUM-LOAN-SCH = 'A'                                        
                 ADD +1 TO  WS-SUM-SUB-AC-SELL-X                                
                 ADD +1 TO  WS-SUM-TOT-AC-SELL-X                                
              ELSE                                                              
                 ADD +1 TO  WS-SUM-SUB-AC-SELL                                  
                 ADD +1 TO  WS-SUM-TOT-AC-SELL                                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF KD00-AMT-LOAN-GRANTED NOT = 0                                     
              IF FD38-NUM-LOAN-SCH = 'A'                                        
                 ADD +1 TO  WS-SUM-SUB-AC-GRANT-X                               
                 ADD +1 TO  WS-SUM-TOT-AC-GRANT-X                               
              ELSE                                                              
                 ADD +1 TO  WS-SUM-SUB-AC-GRANT                                 
                 ADD +1 TO  WS-SUM-TOT-AC-GRANT                                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF FD38-NUM-LOAN-SCH = 'A'                                           
              COMPUTE WS-SUB-AMT-LOAN-GRANTED-X =                               
                      WS-SUB-AMT-LOAN-GRANTED-X + KD00-AMT-LOAN-GRANTED         
                                                                                
              COMPUTE WS-TOT-AMT-LOAN-GRANTED-X =                               
                      WS-TOT-AMT-LOAN-GRANTED-X + KD00-AMT-LOAN-GRANTED         
           ELSE                                                                 
              COMPUTE WS-SUB-AMT-LOAN-GRANTED =                                 
                      WS-SUB-AMT-LOAN-GRANTED + KD00-AMT-LOAN-GRANTED           
                                                                                
              COMPUTE WS-TOT-AMT-LOAN-GRANTED =                                 
                      WS-TOT-AMT-LOAN-GRANTED + KD00-AMT-LOAN-GRANTED           
           END-IF.                                                              
                                                                                
           STRING FD38-NUM-SCH-ACC (1:4) '-'                                    
                  FD38-NUM-SCH-ACC (5:4) '-'                                    
                  FD38-NUM-SCH-ACC (09:3)                                       
                  DELIMITED BY SIZE      INTO LC28-HDB-REF.                     
           MOVE FD38-NUM-SCHEDULE        TO LC28-PP-SCH.                        
           MOVE FD38-NUM-FLAT-TYPE       TO LC28-FLAT-TYPE.                     
                                                                                
           IF FD38-AMT-LOAN-NEW          NOT NUMERIC                            
           MOVE ZEROES                   TO  FD38-AMT-LOAN-NEW                  
           END-IF.                                                              
           IF FD38-CDE-INTEREST-RATE     NOT NUMERIC                            
           MOVE ZEROES                   TO  FD38-CDE-INTEREST-RATE             
           END-IF.                                                              
           IF FD38-AMT-INTEREST-NEWLOAN  NOT NUMERIC                            
           MOVE ZEROES                   TO  FD38-AMT-INTEREST-NEWLOAN          
           END-IF.                                                              
                                                                                
           IF FD38-AMT-LOAN-NEW  NOT = 0                                        
              IF FD38-NUM-LOAN-SCH = 'A'                                        
                 ADD +1  TO WS-SUM-SUB-AC-NEWLOAN-X                             
                 ADD +1  TO WS-SUM-TOT-AC-NEWLOAN-X                             
              ELSE                                                              
                 ADD +1  TO WS-SUM-SUB-AC-NEWLOAN                               
                 ADD +1  TO WS-SUM-TOT-AC-NEWLOAN                               
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE FD38-AMT-LOAN-NEW          TO  LC28-GRANT-LOAN.                 
           MOVE FD38-NUM-LOAN-SCH          TO  LC28-LOAN-SCH.                   
           MOVE FD38-CDE-INTEREST-RATE     TO  LC28-INT-RATE.                   
           MOVE FD38-AMT-INTEREST-NEWLOAN  TO  LC28-AMT-RAISED.                 
                                                                                
           IF FD38-DTE-DUE NOT = LOW-VALUES AND ZEROES AND SPACES               
              STRING FD38-DTE-DUE(7:2)   '/'                                    
                     FD38-DTE-DUE(5:2)   '/'                                    
                     FD38-DTE-DUE(1:4)   DELIMITED BY SIZE                      
                     INTO LC28-NEW-EFF-DTE                                      
           ELSE                                                                 
              MOVE   SPACES           TO  LC28-NEW-EFF-DTE                      
           END-IF.                                                              
           MOVE FD38-NUM-FLAT-TYPE TO WS-PREV-FLAT-NEW.                         
                                                                                
       4000-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       4100-MOVE-DETAILS-EXIST.                                                 
      ******************************************************************        
           IF WS-PREV-FLAT-EXIST NOT = FD38-NUM-FLAT-TYPE AND                   
              WS-PREV-FLAT-EXIST NOT = SPACES                                   
              PERFORM 7300-PRINT-SUB-TOT-EXIST     THRU 7300-EXIT               
           END-IF.                                                              
           IF WS-LINE-CNT-28B > 54                                              
              PERFORM 7100-PRINT-EXIST-CASE-HEAD THRU 7100-EXIT                 
           END-IF.                                                              
                                                                                
           MOVE SPACES                   TO BP13KD00-REC.                       
           INITIALIZE BP13KD00-REC.                                             
                                                                                
           MOVE FD38-NUM-REGN            TO LC28-REG-NO-EX                      
                                            KD00-NUM-REGN.                      
                                                                                
           PERFORM  2100-READ-BP13KD00   THRU 2100-EXIT.                        
           MOVE KD00-AMT-SELL-PRICE      TO LC28-SELL-PRICE-EX.                 
                                                                                
           STRING FD38-NUM-SCH-ACC (1:4) '-'                                    
                  FD38-NUM-SCH-ACC (5:4) '-'                                    
                  FD38-NUM-SCH-ACC (09:3)                                       
                  DELIMITED BY SIZE      INTO LC28-HDB-REF-EX.                  
           MOVE FD38-NUM-SCHEDULE        TO LC28-PP-SCH-EX.                     
           MOVE FD38-NUM-FLAT-TYPE       TO LC28-FLAT-TYPE-EX.                  
                                                                                
           IF FD38-AMT-LOAN-NEW          NOT NUMERIC                            
           MOVE ZEROES                   TO  FD38-AMT-LOAN-NEW                  
           END-IF.                                                              
           IF FD38-AMT-INTEREST-NEWLOAN  NOT NUMERIC                            
           MOVE ZEROES                   TO  FD38-AMT-INTEREST-NEWLOAN          
           END-IF.                                                              
           IF FD38-CDE-INTEREST-RATE     NOT NUMERIC                            
           MOVE ZEROES                   TO  FD38-CDE-INTEREST-RATE             
           END-IF.                                                              
           IF FD38-AMT-INTEREST-NEWLOAN  NOT NUMERIC                            
           MOVE ZEROES                   TO  FD38-AMT-INTEREST-NEWLOAN          
           END-IF.                                                              
                                                                                
           MOVE FD38-AMT-LOAN-NEW          TO  LC28-GRANT-LOAN-EX.              
           MOVE FD38-NUM-LOAN-SCH          TO  LC28-LOAN-SCH-EX.                
           MOVE FD38-CDE-INTEREST-RATE     TO  LC28-INT-RATE-EX.                
           MOVE FD38-AMT-INTEREST-NEWLOAN  TO  LC28-AMT-RAISED-EX.              
                                                                                
           IF FD38-DTE-DUE NOT = LOW-VALUES AND ZEROES AND SPACES               
              STRING FD38-DTE-DUE(7:2)   '/'                                    
                     FD38-DTE-DUE(5:2)   '/'                                    
                     FD38-DTE-DUE(1:4)   DELIMITED BY SIZE                      
                     INTO LC28-NEW-EFF-DTE-EX                                   
           ELSE                                                                 
              MOVE   SPACES           TO  LC28-NEW-EFF-DTE-EX                   
           END-IF.                                                              
           MOVE FD38-NUM-FLAT-TYPE    TO  WS-PREV-FLAT-EXIST.                   
                                                                                
       4100-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       6000-PRINT-NEW-CASE-REC.                                                 
      ******************************************************************        
           IF FD38-NUM-LOAN-SCH = 'A'                                           
              COMPUTE WS-NEW-SUB-LOAN-AMT-X =  WS-NEW-SUB-LOAN-AMT-X +          
                                               FD38-AMT-LOAN-NEW                
                                                                                
              COMPUTE WS-NEW-SUB-SEL-PRICE-X = WS-NEW-SUB-SEL-PRICE-X +         
                                               KD00-AMT-SELL-PRICE              
                                                                                
              COMPUTE WS-NEW-TOT-SEL-PRICE-X = KD00-AMT-SELL-PRICE  +           
                                               WS-NEW-TOT-SEL-PRICE-X           
                                                                                
              COMPUTE WS-NEW-TOT-LOAN-AMT-X = WS-NEW-TOT-LOAN-AMT-X +           
                                              FD38-AMT-LOAN-NEW                 
           ELSE                                                                 
              COMPUTE WS-NEW-SUB-LOAN-AMT =  WS-NEW-SUB-LOAN-AMT +              
                                             FD38-AMT-LOAN-NEW                  
                                                                                
              COMPUTE WS-NEW-SUB-SEL-PRICE = WS-NEW-SUB-SEL-PRICE +             
                                             KD00-AMT-SELL-PRICE                
                                                                                
              COMPUTE WS-NEW-TOT-SEL-PRICE = KD00-AMT-SELL-PRICE  +             
                                             WS-NEW-TOT-SEL-PRICE               
                                                                                
              COMPUTE WS-NEW-TOT-LOAN-AMT = WS-NEW-TOT-LOAN-AMT   +             
                                            FD38-AMT-LOAN-NEW                   
           END-IF.                                                              
           COMPUTE WS-NEW-SUB-RAISED    = WS-NEW-SUB-RAISED +                   
                                          FD38-AMT-INTEREST-NEWLOAN.            
                                                                                
           COMPUTE WS-NEW-TOT-RAISED   = WS-NEW-TOT-RAISED     +                
                                       FD38-AMT-INTEREST-NEWLOAN.               
                                                                                
                                                                                
           ADD   1                         TO CNT-CASES-L28A.                   
           MOVE CNT-CASES-L28A             TO LC28-SNO.                         
                                                                                
           WRITE PRINT-L28A-REC            FROM LC28-PR-DETAILS-NEW.            
           WRITE PRINT-L28A-REC            FROM LC28-PR-SPACES.                 
                                                                                
           ADD +2                          TO WS-LINE-CNT-28A.                  
                                                                                
       6000-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       6100-PRINT-EXIST-CASE-REC.                                               
      ******************************************************************        
                                                                                
           COMPUTE WS-EXIST-SUB-LOAN-AMT   =  WS-EXIST-SUB-LOAN-AMT +           
                                              FD38-AMT-LOAN-NEW.                
                                                                                
           COMPUTE WS-EXIST-SUB-SEL-PRICE  =  WS-EXIST-SUB-SEL-PRICE +          
                                              KD00-AMT-SELL-PRICE.              
                                                                                
           COMPUTE WS-EXIST-SUB-RAISED     =  WS-EXIST-SUB-RAISED    +          
                                            FD38-AMT-INTEREST-NEWLOAN.          
                                                                                
           COMPUTE WS-EXIST-TOT-SEL-PRICE  =  WS-EXIST-TOT-SEL-PRICE +          
                                              KD00-AMT-SELL-PRICE.              
                                                                                
           COMPUTE WS-EXIST-TOT-LOAN-AMT = WS-EXIST-TOT-LOAN-AMT +              
                                           FD38-AMT-LOAN-NEW.                   
                                                                                
           COMPUTE WS-EXIST-TOT-RAISED   = WS-EXIST-TOT-RAISED   +              
                                           FD38-AMT-INTEREST-NEWLOAN.           
                                                                                
           ADD   1                         TO CNT-CASES-L28B.                   
           MOVE CNT-CASES-L28B             TO LC28-SNO-EX.                      
                                                                                
           WRITE PRINT-L28B-REC            FROM LC28-PR-DETAILS-EXIST.          
           WRITE PRINT-L28B-REC            FROM LC28-PR-SPACES.                 
                                                                                
           ADD +2                          TO WS-LINE-CNT-28B.                  
                                                                                
       6100-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       6200-PRINT-NEW-CASE-GRANT.                                               
      ******************************************************************        
           COMPUTE WS-NEW-TOT-SEL-PRICE-ALL =                                   
                   WS-NEW-TOT-SEL-PRICE + WS-NEW-TOT-SEL-PRICE-X.               
           MOVE WS-NEW-TOT-SEL-PRICE-ALL   TO LC28-TOT-SEL-PRICE.               
           COMPUTE WS-NEW-TOT-LOAN-AMT-ALL =                                    
                   WS-NEW-TOT-LOAN-AMT + WS-NEW-TOT-LOAN-AMT-X.                 
           MOVE WS-NEW-TOT-LOAN-AMT-ALL TO LC28-TOT-GRANT-LOAN.                 
           MOVE WS-NEW-TOT-RAISED       TO LC28-TOT-INT-RAISED.                 
                                                                                
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-GRANT-NEW-ROLL.         
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-GRANT-NEW.              
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-GRANT-NEW-ROLL.         
                                                                                
       6200-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       6300-PRINT-EXIST-CASE-GRANT.                                             
      ******************************************************************        
           MOVE WS-EXIST-TOT-SEL-PRICE  TO LC28-TOT-SEL-PRICE-EX.               
           MOVE WS-EXIST-TOT-LOAN-AMT   TO LC28-TOT-GRANT-LOAN-EX.              
           MOVE WS-EXIST-TOT-RAISED     TO LC28-TOT-INT-RAISED-EX.              
                                                                                
           WRITE PRINT-L28B-REC         FROM                                    
                                          LC28-PRINT-GRANT-EXIST-ROLL.          
           WRITE PRINT-L28B-REC         FROM LC28-PRINT-GRANT-EXIST.            
           WRITE PRINT-L28B-REC         FROM                                    
                                          LC28-PRINT-GRANT-EXIST-ROLL.          
                                                                                
       6300-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       6400-PRINT-SUMMARY-NEW.                                                  
      ******************************************************************        
      *FOR PRINTING BOTTOM OF THE PAGE                                          
           IF WS-LINE-CNT-28A < 41                                              
              PERFORM VARYING WS-IDX FROM WS-LINE-CNT-28A BY 1                  
                UNTIL WS-IDX > 42                                               
                WRITE PRINT-L28A-REC         FROM LC28-PR-SPACES                
              END-PERFORM                                                       
           END-IF.                                                              
                                                                                
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-TOTAL-HEAD.             
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-TOTAL-ROLL.             
                                                                                
           MOVE SPACES                TO LC28-PRINT-TOTAL.                      
      *NEW LOAN                                                                 
           WRITE PRINT-L28A-REC         FROM LC28-PR-SPACES.                    
           MOVE CNT-CASES-L28A-COMP   TO LC28-FINAL-ACCT.                       
           COMPUTE WS-NEW-TOT-LOAN-AMT-ALL =                                    
                   WS-NEW-TOT-LOAN-AMT + WS-NEW-TOT-LOAN-AMT-X.                 
           MOVE WS-NEW-TOT-LOAN-AMT-ALL  TO LC28-FINAL-TOT.                     
           MOVE WS-NEW-TOT-RAISED     TO LC28-FINAL-INT-AMT.                    
           MOVE  'TOTAL NO. OF NEW ACCOUNTS     : '  TO                         
                   LC28-TOT.                                                    
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-TOTAL.                  
                                                                                
           MOVE SPACES                TO LC28-PRINT-TOTAL.                      
      *EXISTING LOAN                                                            
           WRITE PRINT-L28A-REC         FROM LC28-PR-SPACES.                    
           COMPUTE WS-FINAL-ACCT-NO = CNT-CASES-L28B-COMP +                     
                                      CNT-CASES-L28B-COMP-MUL.                  
           MOVE WS-FINAL-ACCT-NO      TO LC28-FINAL-ACCT.                       
           MOVE WS-EXIST-TOT-LOAN-AMT TO LC28-FINAL-TOT.                        
           MOVE WS-EXIST-TOT-RAISED   TO LC28-FINAL-INT-AMT.                    
           MOVE 'TOTAL NO. OF EXISTING ACCOUNTS : '  TO                         
                   LC28-TOT.                                                    
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-TOTAL.                  
                                                                                
           MOVE SPACES                TO LC28-PRINT-TOTAL.                      
      *TOTAL                                                                    
           WRITE PRINT-L28A-REC         FROM LC28-PR-SPACES.                    
           COMPUTE WS-FINAL-ACCT-NO = CNT-CASES-L28A-COMP +                     
                                      CNT-CASES-L28B-COMP.                      
           MOVE WS-FINAL-ACCT-NO      TO LC28-FINAL-ACCT.                       
           COMPUTE WS-FINAL-TOT-AMT = WS-NEW-TOT-LOAN-AMT +                     
                                      WS-NEW-TOT-LOAN-AMT-X +                   
                                      WS-EXIST-TOT-LOAN-AMT.                    
           MOVE WS-FINAL-TOT-AMT   TO LC28-FINAL-TOT.                           
           COMPUTE WS-FINAL-TOT-INT = WS-NEW-TOT-RAISED   +                     
                                      WS-EXIST-TOT-RAISED.                      
           MOVE WS-FINAL-TOT-INT   TO LC28-FINAL-INT-AMT.                       
           MOVE 'FINAL TOTAL NO. OF ACCOUNTS    : ' TO                          
                   LC28-TOT.                                                    
           WRITE PRINT-L28A-REC         FROM LC28-PRINT-TOTAL.                  
                                                                                
       6400-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       6500-PRINT-SUMMARY-EXIST.                                                
      ******************************************************************        
      *FOR PRINTING BOTTOM OF THE PAGE                                          
           IF WS-LINE-CNT-28B < 41                                              
              PERFORM VARYING WS-IDX FROM WS-LINE-CNT-28B BY 1                  
                UNTIL WS-IDX > 42                                               
                WRITE PRINT-L28B-REC         FROM LC28-PR-SPACES                
              END-PERFORM                                                       
           END-IF.                                                              
                                                                                
           WRITE PRINT-L28B-REC         FROM LC28-PRINT-TOTAL-HEAD.             
           WRITE PRINT-L28B-REC         FROM LC28-PRINT-TOTAL-ROLL.             
                                                                                
           MOVE SPACES                TO LC28-PRINT-TOTAL.                      
      *NEW LOAN                                                                 
           WRITE PRINT-L28B-REC         FROM LC28-PR-SPACES.                    
           MOVE CNT-CASES-L28A-COMP   TO LC28-FINAL-ACCT.                       
           COMPUTE WS-NEW-TOT-LOAN-AMT-ALL =                                    
                   WS-NEW-TOT-LOAN-AMT + WS-NEW-TOT-LOAN-AMT-X.                 
           MOVE WS-NEW-TOT-LOAN-AMT-ALL  TO LC28-FINAL-TOT.                     
           MOVE WS-NEW-TOT-RAISED     TO LC28-FINAL-INT-AMT.                    
           MOVE  'TOTAL NO. OF NEW ACCOUNTS     : '  TO                         
                   LC28-TOT.                                                    
           WRITE PRINT-L28B-REC         FROM LC28-PRINT-TOTAL.                  
                                                                                
           MOVE SPACES                TO LC28-PRINT-TOTAL.                      
      *EXISTING LOAN                                                            
           WRITE PRINT-L28B-REC         FROM LC28-PR-SPACES.                    
           COMPUTE WS-FINAL-ACCT-NO = CNT-CASES-L28B-COMP +                     
                                      CNT-CASES-L28B-COMP-MUL.                  
           MOVE WS-FINAL-ACCT-NO      TO LC28-FINAL-ACCT.                       
           MOVE WS-EXIST-TOT-LOAN-AMT TO LC28-FINAL-TOT.                        
           MOVE WS-EXIST-TOT-RAISED   TO LC28-FINAL-INT-AMT.                    
           MOVE 'TOTAL NO. OF EXISTING ACCOUNTS : '  TO                         
                   LC28-TOT.                                                    
           WRITE PRINT-L28B-REC         FROM LC28-PRINT-TOTAL.                  
                                                                                
           MOVE SPACES                TO LC28-PRINT-TOTAL.                      
      *TOTAL                                                                    
           WRITE PRINT-L28B-REC         FROM LC28-PR-SPACES.                    
           COMPUTE WS-FINAL-ACCT-NO = CNT-CASES-L28A-COMP +                     
                                      CNT-CASES-L28B-COMP                       
           MOVE WS-FINAL-ACCT-NO   TO LC28-FINAL-ACCT.                          
           COMPUTE WS-FINAL-TOT-AMT = WS-NEW-TOT-LOAN-AMT +                     
                                      WS-NEW-TOT-LOAN-AMT-X +                   
                                      WS-EXIST-TOT-LOAN-AMT.                    
           MOVE WS-FINAL-TOT-AMT   TO LC28-FINAL-TOT.                           
           COMPUTE WS-FINAL-TOT-INT = WS-NEW-TOT-RAISED   +                     
                                      WS-EXIST-TOT-RAISED.                      
           MOVE WS-FINAL-TOT-INT   TO LC28-FINAL-INT-AMT.                       
           MOVE 'FINAL TOTAL NO. OF ACCOUNTS    : ' TO                          
                   LC28-TOT.                                                    
           WRITE PRINT-L28B-REC         FROM LC28-PRINT-TOTAL.                  
                                                                                
       6500-EXIT.  EXIT.                                                        
                                                                                
                                                                                
      ******************************************************************        
       7000-PRINT-NEW-CASE-HEAD.                                                
      ******************************************************************        
                                                                                
           MOVE 'BP13L28A'       TO   WS-HEAD-RPT-NME.                          
           ADD 1                 TO   WS-PAGE-CNT-L28A.                         
           MOVE WS-PAGE-CNT-L28A TO LC28-PAGENO.                                
                                                                                
           WRITE PRINT-L28A-REC  FROM LC28-PR-SPACES AFTER PAGE.                
           WRITE PRINT-L28A-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28A-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28A-REC  FROM LC28-PR-HEAD-01.                          
           WRITE PRINT-L28A-REC  FROM LC28-PR-HEAD-02.                          
           WRITE PRINT-L28A-REC  FROM LC28-PR-NEW-CASE-HEAD.                    
           WRITE PRINT-L28A-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28A-REC  FROM LC28-PR-HEAD-NEW.                         
           WRITE PRINT-L28A-REC  FROM LC28-PR-HEAD-NEW-1.                       
           WRITE PRINT-L28A-REC  FROM LC28-PR-ROLL-NEW.                         
           WRITE PRINT-L28A-REC  FROM LC28-PR-SPACES.                           
           MOVE 11               TO   WS-LINE-CNT-28A.                          
                                                                                
       7000-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       7100-PRINT-EXIST-CASE-HEAD.                                              
      ******************************************************************        
                                                                                
           MOVE 'BP13L28B'       TO   WS-HEAD-RPT-NME.                          
           ADD 1                 TO   WS-PAGE-CNT-L28B.                         
           MOVE WS-PAGE-CNT-L28B TO   LC28-PAGENO.                              
                                                                                
           WRITE PRINT-L28B-REC  FROM LC28-PR-SPACES AFTER PAGE.                
           WRITE PRINT-L28B-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28B-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28B-REC  FROM LC28-PR-HEAD-01.                          
           WRITE PRINT-L28B-REC  FROM LC28-PR-HEAD-03.                          
           WRITE PRINT-L28B-REC  FROM LC28-PR-EXIST-CASE-HEAD.                  
           WRITE PRINT-L28B-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28B-REC  FROM LC28-PR-HEAD-EXIST.                       
           WRITE PRINT-L28B-REC  FROM LC28-PR-HEAD-EXIST-1.                     
           WRITE PRINT-L28B-REC  FROM LC28-PR-HEAD-EXIST-2.                     
           WRITE PRINT-L28B-REC  FROM LC28-PR-ROLL-EXIST.                       
           WRITE PRINT-L28B-REC  FROM LC28-PR-SPACES.                           
           MOVE 12               TO   WS-LINE-CNT-28B.                          
                                                                                
       7100-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       7200-PRINT-SUB-TOT-NEW.                                                  
      ******************************************************************        
           COMPUTE WS-NEW-SUB-SEL-PRICE-ALL =                                   
                   WS-NEW-SUB-SEL-PRICE + WS-NEW-SUB-SEL-PRICE-X.               
           MOVE WS-NEW-SUB-SEL-PRICE-ALL TO LC28-SUB-SEL-PRICE.                 
           COMPUTE WS-NEW-SUB-LOAN-AMT-ALL =                                    
                   WS-NEW-SUB-LOAN-AMT + WS-NEW-SUB-LOAN-AMT-X.                 
           MOVE WS-NEW-SUB-LOAN-AMT-ALL TO LC28-SUB-GRANT-LOAN.                 
           MOVE WS-NEW-SUB-RAISED    TO LC28-SUB-INT-RAISED.                    
                                                                                
           WRITE PRINT-L28A-REC  FROM LC28-PRINT-SUB-NEW.                       
                                                                                
           WRITE PRINT-L28A-REC  FROM LC28-PR-SPACES.                           
                                                                                
           ADD  +2               TO   WS-LINE-CNT-28A.                          
                                                                                
       7200-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       7300-PRINT-SUB-TOT-EXIST.                                                
      ******************************************************************        
           MOVE WS-EXIST-SUB-SEL-PRICE TO LC28-SUB-SEL-PRICE-EX.                
           MOVE WS-EXIST-SUB-LOAN-AMT  TO LC28-SUB-GRANT-LOAN-EX.               
           MOVE WS-EXIST-SUB-RAISED    TO LC28-SUB-INT-RAISED-EX.               
                                                                                
           WRITE PRINT-L28B-REC  FROM LC28-PRINT-SUB-EXIST.                     
                                                                                
           WRITE PRINT-L28B-REC  FROM LC28-PR-SPACES.                           
                                                                                
           ADD  +2               TO   WS-LINE-CNT-28B.                          
           MOVE 0 TO WS-EXIST-SUB-LOAN-AMT WS-EXIST-SUB-SEL-PRICE               
                     WS-EXIST-SUB-RAISED.                                       
                                                                                
       7300-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       8000-PRINT-SUMMARY-REPORT.                                               
      ******************************************************************        
           IF WS-LINE-CNT-28C > 54                                              
              PERFORM 8100-PRINT-SUM-CASE-HEAD     THRU 8100-EXIT               
           END-IF.                                                              
                                                                                
           MOVE WS-PREV-FLAT-NEW      TO  LC28-FLT-TYP-SUM.                     
           MOVE WS-SUM-SUB-AC-SELL    TO  LC28-TOT-SELL-AC-SUM.                 
           MOVE WS-SUM-SUB-AC-SELL-X  TO  LC28-TOT-SELL-AC-SUM-X.               
           MOVE WS-SUM-SUB-AC-NEWLOAN TO  LC28-TOT-LOAN-AC-SUM.                 
           MOVE WS-SUM-SUB-AC-NEWLOAN-X   TO LC28-TOT-LOAN-AC-SUM-X.            
           MOVE WS-SUM-SUB-AC-GRANT   TO  LC28-TOT-GRANT-AC-SUM.                
           MOVE WS-SUM-SUB-AC-GRANT-X TO  LC28-TOT-GRANT-AC-SUM-X.              
           MOVE WS-NEW-SUB-SEL-PRICE    TO LC28-SELL-PRICE-SUM.                 
           MOVE WS-NEW-SUB-LOAN-AMT     TO LC28-NEW-LOAN-SUM.                   
           MOVE WS-SUB-AMT-LOAN-GRANTED TO LC28-GRANT-LOAN-SUM.                 
           MOVE WS-NEW-SUB-SEL-PRICE-X  TO LC28-SELL-PRICE-SUM-X.               
           MOVE WS-NEW-SUB-LOAN-AMT-X   TO LC28-NEW-LOAN-SUM-X.                 
           MOVE WS-SUB-AMT-LOAN-GRANTED-X  TO LC28-GRANT-LOAN-SUM-X.            
                                                                                
           WRITE PRINT-L28C-REC  FROM LC28-PR-DETAILS-SUM.                      
           WRITE PRINT-L28C-REC  FROM LC28-PR-DETAILS-SUM-1.                    
           WRITE PRINT-L28C-REC  FROM LC28-PR-SPACES.                           
                                                                                
           ADD  +3               TO   WS-LINE-CNT-28C.                          
           MOVE 0 TO WS-NEW-SUB-LOAN-AMT       WS-NEW-SUB-SEL-PRICE             
                     WS-NEW-SUB-RAISED         WS-SUB-AMT-LOAN-GRANTED          
                     WS-SUM-SUB-AC-SELL        WS-SUM-SUB-AC-NEWLOAN            
                     WS-SUM-SUB-AC-GRANT       WS-NEW-SUB-LOAN-AMT-ALL          
                     WS-NEW-SUB-LOAN-AMT-X     WS-NEW-SUB-SEL-PRICE-ALL         
                     WS-NEW-SUB-SEL-PRICE-X    WS-SUM-SUB-AC-SELL-X             
                     WS-SUB-AMT-LOAN-GRANTED-X WS-SUM-SUB-AC-NEWLOAN-X          
                     WS-SUM-SUB-AC-GRANT-X.                                     
                                                                                
       8000-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       8100-PRINT-SUM-CASE-HEAD.                                                
      ******************************************************************        
                                                                                
           MOVE 'BP13L28C'       TO   WS-HEAD-RPT-NME.                          
           ADD 1                 TO   WS-PAGE-CNT-L28C.                         
           MOVE WS-PAGE-CNT-L28C TO   LC28-PAGENO.                              
                                                                                
           WRITE PRINT-L28C-REC  FROM LC28-PR-SPACES AFTER PAGE.                
           WRITE PRINT-L28C-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28C-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28C-REC  FROM LC28-PR-HEAD-01.                          
           WRITE PRINT-L28C-REC  FROM LC28-PR-HEAD-04.                          
                                                                                
           IF WS-PRINT-NONCON = 'N'                                             
              WRITE PRINT-L28C-REC  FROM LC28-PR-SUB-SUM-HEAD                   
           ELSE                                                                 
              WRITE PRINT-L28C-REC  FROM LC28-PR-SUB-SUM-HEAD-NCON              
           END-IF.                                                              
                                                                                
           WRITE PRINT-L28C-REC  FROM LC28-PR-SPACES.                           
           WRITE PRINT-L28C-REC  FROM LC28-PR-HEAD-SUM.                         
           WRITE PRINT-L28C-REC  FROM LC28-PR-ROLL-SUM.                         
           WRITE PRINT-L28C-REC  FROM LC28-PR-SPACES.                           
           MOVE 10               TO   WS-LINE-CNT-28C.                          
                                                                                
       8100-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       8200-PRINT-SUMMARY-TOTAL.                                                
      ******************************************************************        
           IF WS-LINE-CNT-28C > 54                                              
              PERFORM 8100-PRINT-SUM-CASE-HEAD     THRU 8100-EXIT               
           END-IF.                                                              
                                                                                
           MOVE 'TOTAL'               TO  LC28-FLT-TYP-SUM.                     
           MOVE WS-SUM-TOT-AC-SELL    TO  LC28-TOT-SELL-AC-SUM.                 
           MOVE WS-SUM-TOT-AC-SELL-X  TO  LC28-TOT-SELL-AC-SUM-X.               
           MOVE WS-SUM-TOT-AC-NEWLOAN TO  LC28-TOT-LOAN-AC-SUM.                 
           MOVE WS-SUM-TOT-AC-NEWLOAN-X   TO LC28-TOT-LOAN-AC-SUM-X.            
           MOVE WS-SUM-TOT-AC-GRANT   TO  LC28-TOT-GRANT-AC-SUM.                
           MOVE WS-SUM-TOT-AC-GRANT-X TO  LC28-TOT-GRANT-AC-SUM-X.              
           MOVE WS-NEW-TOT-SEL-PRICE    TO LC28-SELL-PRICE-SUM.                 
           MOVE WS-NEW-TOT-LOAN-AMT     TO LC28-NEW-LOAN-SUM.                   
           MOVE WS-TOT-AMT-LOAN-GRANTED TO LC28-GRANT-LOAN-SUM.                 
           MOVE WS-NEW-TOT-SEL-PRICE-X  TO LC28-SELL-PRICE-SUM-X.               
           MOVE WS-NEW-TOT-LOAN-AMT-X   TO LC28-NEW-LOAN-SUM-X.                 
           MOVE WS-TOT-AMT-LOAN-GRANTED-X  TO LC28-GRANT-LOAN-SUM-X.            
                                                                                
           WRITE PRINT-L28C-REC  FROM LC28-PR-DETAILS-SUM.                      
           WRITE PRINT-L28C-REC  FROM LC28-PR-DETAILS-SUM-1.                    
           WRITE PRINT-L28C-REC  FROM LC28-PR-SPACES.                           
                                                                                
           ADD  +3               TO   WS-LINE-CNT-28C.                          
           MOVE 0 TO WS-NEW-SUB-LOAN-AMT       WS-NEW-SUB-SEL-PRICE             
                     WS-NEW-SUB-RAISED         WS-SUB-AMT-LOAN-GRANTED          
                     WS-SUM-SUB-AC-SELL        WS-SUM-SUB-AC-NEWLOAN            
                     WS-SUM-SUB-AC-GRANT       WS-NEW-SUB-LOAN-AMT-ALL          
                     WS-NEW-SUB-LOAN-AMT-X     WS-NEW-SUB-SEL-PRICE-ALL         
                     WS-NEW-SUB-SEL-PRICE-X    WS-SUM-SUB-AC-SELL-X             
                     WS-SUB-AMT-LOAN-GRANTED-X WS-SUM-SUB-AC-NEWLOAN-X          
                     WS-SUM-SUB-AC-GRANT-X.                                     
                                                                                
       8200-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       8500-PRINT-EMPTY-REP.                                                    
      ******************************************************************        
           IF WS-PAGE-CNT-L28A = ZEROES                                         
              PERFORM 7000-PRINT-NEW-CASE-HEAD   THRU 7000-EXIT                 
              WRITE PRINT-L28A-REC FROM LC28-NO-RECORD AFTER 2                  
           END-IF.                                                              
           IF WS-PAGE-CNT-L28B = ZEROES                                         
              PERFORM 7100-PRINT-EXIST-CASE-HEAD THRU 7100-EXIT                 
              WRITE PRINT-L28B-REC FROM LC28-NO-RECORD AFTER 2                  
           END-IF.                                                              
           IF WS-PAGE-CNT-L28C = ZEROES                                         
              PERFORM 8100-PRINT-SUM-CASE-HEAD   THRU 8100-EXIT                 
              WRITE PRINT-L28C-REC FROM LC28-NO-RECORD AFTER 2                  
           END-IF.                                                              
                                                                                
       8500-EXIT.  EXIT.                                                        
                                                                                
      ******************************************************************        
       9999-CLOSE-ROUTINE.                                                      
      ******************************************************************        
                                                                                
                                                                                
           DISPLAY '******* CONTROL   TOTALS ********'.                         
           DISPLAY 'PROGRAM-ID : BP13CC28'.                                     
           DISPLAY '---------------------'.                                     
           DISPLAY 'NO OF BP13FD38 RECORDS READ..........: '                    
                    WS-CNT-FD38.                                                
           DISPLAY 'NO OF BP13L28A RECORDS WRITTEN.......: '                    
                    CNT-CASES-L28A.                                             
           DISPLAY 'NO OF BP13L28B RECORDS WRITTEN.......: '                    
                    CNT-CASES-L28B.                                             
                                                                                
           CLOSE BP13KD00                                                       
                 BP13KD03                                                       
                 BP13FD38                                                       
                 SY02F001                                                       
                 BP13L28A                                                       
                 BP13L28B                                                       
                 BP13L28C.                                                      
                                                                                
           IF WS-KD00-STATUS = 97 OR 00                                         
              CONTINUE                                                          
           ELSE                                                                 
              MOVE WS-KD00-STATUS TO RETURN-CODE                                
              DISPLAY 'CLOSE BP13KD00 FAIL. STATUS : ' WS-KD00-STATUS           
           END-IF.                                                              
                                                                                
           IF WS-KD03-STATUS = 97 OR 00                                         
              CONTINUE                                                          
           ELSE                                                                 
              MOVE WS-KD03-STATUS TO RETURN-CODE                                
              DISPLAY 'CLOSE BP13KD03 FAIL. STATUS : ' WS-KD03-STATUS           
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.  EXIT.                                                        
