       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C739.                                                 
       AUTHOR.        YPH.                                                      
       DATE-WRITTEN.  15/01/92.                                                 
      *DATE-COMPILED.                                                           
       SKIP3                                                                    
      *REMARKS.                                                                 
      *****************************************************************         
      *                                                               *         
      *   SYSTEM NAME : SYSTEM OF COMMITMENT                          *         
      *                                                               *         
      *   OBJECTIVE   : THIS PROGRAM PRINTS SUMMARY REPORTS ON        *         
      *                 NUMBER OF REQUESTS RECEIVED BY NT, FT &       *         
      *                 ETHNIC GROUP FOR PRIORITY GROUP.              *         
      *                                                               *         
      *   INPUT FILES :                                               *         
      *   1.  BP13F520 -- BALLOT FILE SORTED IN NT AND FLAT TYPE      *         
      *           ORGANISATION  : SEQUENTIAL                          *         
      *           ACCESS MODE   : SEQ                                 *         
      *           RECORD LENGTH : 300                                 *         
      *                                                                         
      *   OUTPUT FILES:                                               *         
      *   1.  BP13L739 -- REPORT FILE                                 *         
      *           ORGANISATION  : SEQ                                 *         
      *           ACCESS MODE   : SEQ                                 *         
      *           RECORD LENGTH : 132                                 *         
      *                                                               *         
      *                                                               *         
      * AMENDMENTS:                                                   *         
      * REF      DATE      BY    DESCRIPTIONS                         *         
      * -------  --------  ----  ------------                         *         
      * C920183  15/01/92  YPH   PRINT REPORT FOR SOC PHASE 7         *         
      * C9204F6  07/05/92  YPH   PRINT REPORT FOR SOC PHASE 7 - RBS   *         
      * C9303B4  26/04/93  LJL   TO INCLUDE RDC SCHEME.               *         
      * I920718  26/04/93  LJL   TO CONVERT TO COBOLII.               *         
      * C940786  23/07/94  TON   TO CATER FOR HOUSEHOLD TYPES , U3    *         
      *                          AND NHT.                             *         
      *BP130652  20/02/99  NOR   EXPAND F520 RECL FROM 300 TO 500     *         
      *****************************************************************         
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F520 ASSIGN TO BP13F520.                                  
                                                                                
           SELECT BP13L739 ASSIGN TO BP13L739.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD BP13F520                                                              
            BLOCK CONTAINS    0 RECORDS                                         
            RECORD CONTAINS  500 CHARACTERS                                     
            LABEL RECORD IS STANDARD.                                           
       COPY BP13F520.                                                           
                                                                                
       FD  BP13L739                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  PRINT-REC               PIC X(132).                                  
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-ALLOCSCH-TYPE        PIC X(3).                                    
           COPY PRIOSCH.                                                        
                                                                                
       01  WS-ASCH                 PIC 9(2).                                    
       01  WS-CATNO-CHAR           PIC X.                                       
       01  WS-CATNO    REDEFINES WS-CATNO-CHAR                                  
                                   PIC 9.                                       
       01  WS-FLATNO               PIC 9.                                       
       01  WS-PREV-NT              PIC X(3)    VALUE SPACES.                    
       01  WS-CNT-PAGE             PIC 9(5)    VALUE ZERO.                      
       01  WS-CNT                  PIC 9(2)    VALUE ZERO.                      
       01  WS-CNT-SCH              PIC 9(2)    VALUE ZERO.                      
       01  WS-CNT-FLAT             PIC 9(2)    VALUE ZERO.                      
       01  WS-CNT-CAT              PIC 9(2)    VALUE ZERO.                      
       01  WS-XCNT                 PIC 9       VALUE ZERO.                      
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-F520-STATUS      PIC X       VALUE 'N'.                       
               88   WS-F520-EOF                VALUE 'Y'.                       
           05  WS-DECODE-STATUS    PIC X       VALUE SPACES.                    
               88   WS-DECODE-ERROR            VALUE 'E'.                       
                                                                                
       01  WS-CUR-DATE.                                                         
           05  WS-YY               PIC 99.                                      
           05  WS-MM               PIC 99.                                      
           05  WS-DD               PIC 99.                                      
                                                                                
       01  WS-EDITED-DATE.                                                      
           05  WS-DD1              PIC 99.                                      
           05  FILLER              PIC X      VALUE '/'.                        
           05  WS-MM1              PIC 99.                                      
           05  FILLER              PIC X      VALUE '/'.                        
           05  WS-YY1              PIC 99.                                      
                                                                                
                                                                                
                                                                                
       01  WS-FLAT-SUMMARY-TABLE.                                               
           05  WS-SCHEME-RECORD OCCURS 29 TIMES.                                
               10  WS-FLAT-TYPE   OCCURS 4 TIMES.                               
                   15  WS-CAT-TYPE  OCCURS 4 TIMES.                             
                       20  WS-CAT-QTY     PIC 9(4).                             
                                                                                
                                                                                
      *  REPORT LAYOUT :                                                        
                                                                                
       01  L739-PRT-HEADING-1.                                                  
           05  FILLER              PIC X(8)      VALUE 'BP13L739'.              
           05  FILLER              PIC X(4)      VALUE SPACES .                 
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                    'S Y S T E M   O F   '.                     
           05  FILLER              PIC X(19)     VALUE                          
                                    'C O M M I T M E N T'.                      
           05  FILLER              PIC X(17)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  L739-DATE           PIC X(8).                                    
           05  FILLER              PIC X(4)      VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'PAGE : '.               
           05  L739-PAGENO         PIC ZZZZ9 .                                  
                                                                                
       01  L739-PRT-HEADING-2.                                                  
           05  FILLER              PIC X(100)    VALUE SPACES.                  
           05  FILLER              PIC X(32)     VALUE                          
               'SALES UNIT (APPLICATION TEAM)'.                                 
                                                                                
       01  L739-PRT-HEADING-3.                                                  
           05  FILLER              PIC X(39)     VALUE SPACES.                  
           05  FILLER              PIC X(50)     VALUE                          
               '       REPORT ON NUMBER OF REQUESTS RECEIVED'.                  
                                                                                
       01  L739-PRT-HEADING-3A.                                                 
           05  FILLER              PIC X(39)     VALUE SPACES.                  
           05  FILLER              PIC X(50)     VALUE                          
               '       BY NEWTOWN, FLAT TYPE AND ETHNIC GROUP'.                 
                                                                                
       01  L739-PRT-HEADING-4.                                                  
           05  FILLER              PIC X(12)     VALUE                          
                                   ' NEW TOWN : '.                              
           05  L739-CDE-NT         PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(100)    VALUE SPACES.                  
                                                                                
       01  L739-PRT-HEADING-5.                                                  
           05  FILLER              PIC X(11)     VALUE                          
               'FLAT TYPE |'.                                                   
           05  HEAD5-DESC1         PIC X(28).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  HEAD5-DESC2         PIC X(28).                                   
           05  FILLER              PIC X         VALUE '|'.                     
           05  HEAD5-DESC3         PIC X(28).                                   
           05  FILLER              PIC X(29)     VALUE                          
               '            TOTAL            '.                                 
                                                                                
       01  L739-PRT-HEADING-6.                                                  
           05  FILLER              PIC X(11)     VALUE                          
               '----------|'.                                                   
           05  FILLER              PIC X(29)     VALUE                          
               '----------------------------|'.                                 
           05  FILLER              PIC X(29)     VALUE                          
               '----------------------------|'.                                 
           05  FILLER              PIC X(29)     VALUE                          
               '----------------------------|'.                                 
           05  FILLER              PIC X(35)     VALUE                          
               ALL '-'.                                                         
                                                                                
       01  L739-PRT-HEADING-7.                                                  
           05  FILLER              PIC X(11)     VALUE                          
               'SCHEME    |'.                                                   
           05  FILLER              PIC X(29)     VALUE                          
               '  CAT1  CAT2  CAT3   TOTAL  |'.                                 
           05  FILLER              PIC X(29)     VALUE                          
               '  CAT1  CAT2  CAT3   TOTAL  |'.                                 
           05  FILLER              PIC X(29)     VALUE                          
               '  CAT1  CAT2  CAT3   TOTAL  |'.                                 
           05  FILLER              PIC X(29)     VALUE                          
               '  CAT1  CAT2  CAT3   TOTAL   '.                                 
                                                                                
       01  L739-PRT-HEADING-8.                                                  
           05  FILLER              PIC X(12).                                   
           05  L739-PRT-DESC-ROW   PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(100)    VALUE SPACES.                  
                                                                                
       01  L739-PRT-DETAILS.                                                    
           05  L739-NME-SCHEME     PIC X(09)     VALUE SPACES .                 
           05  FILLER              PIC X(04)     VALUE SPACES .                 
           05  L739-FLAT-RECORD       OCCURS 4 TIMES.                           
               15  L739-PRT-CAT1   PIC ZZZ9.                                    
               15  FILLER          PIC X(2).                                    
               15  L739-PRT-CAT2   PIC ZZZ9.                                    
               15  FILLER          PIC X(2).                                    
               15  L739-PRT-CAT3   PIC ZZZ9.                                    
               15  FILLER          PIC X(4).                                    
               15  L739-PRT-TOT    PIC ZZZ9.                                    
               15  FILLER          PIC X(5).                                    
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
      **********************************************************                
      *                                                        *                
      *    0000-MAIN-PROCESS                                   *                
      *        2000-PROCESS-BP13F520                           *                
      *            2500-DECODE-ALLOC-FLAT-CAT                  *                
      *                2700-PROCESS-PUBLIC-COHORT              *                
      *            3000-ADD-TO-SUMMARY                         *                
      *            4000-PRINT-NT-SUMMARY                       *                
      *                5000-PRINT-REPORT-HEADING               *                
      *                4100-PRINT-DETAILS-SUMM                 *                
      *                    4200-SETUP-FLAT-TYPE-QTY            *                
      *                                                        *                
      **********************************************************                
                                                                                
      **********************************************************                
       0000-MAIN-PROCESS.                                                       
      **********************************************************                
                                                                                
      **  OPENING FILES :                                                       
                                                                                
           OPEN   INPUT  BP13F520                                               
                  OUTPUT BP13L739.                                              
                                                                                
      **  SET UP CURRENT DATE :                                                 
                                                                                
            ACCEPT WS-CUR-DATE FROM DATE.                                       
            MOVE  WS-YY       TO WS-YY1.                                        
            MOVE  WS-MM       TO WS-MM1.                                        
            MOVE  WS-DD       TO WS-DD1.                                        
            MOVE WS-EDITED-DATE   TO L739-DATE.                                 
                                                                                
      **  READ AND PROCESS RECORD FROM SORTED BP13F520                          
                                                                                
           PERFORM  1000-INITIALISE-TABLE                                       
              THRU  1000-EXIT                                                   
           VARYING WS-CNT-SCH  FROM 1 BY 1                                      
             UNTIL WS-CNT-SCH  > 29                                             
           AFTER   WS-CNT-FLAT FROM 1 BY 1                                      
             UNTIL WS-CNT-FLAT >  4                                             
           AFTER   WS-CNT-CAT  FROM 1 BY 1                                      
             UNTIL WS-CNT-CAT  >  4.                                            
                                                                                
                                                                                
           PERFORM  2000-PROCESS-BP13F520                                       
              THRU  2000-EXIT                                                   
             UNTIL  WS-F520-EOF.                                                
                                                                                
                                                                                
      **  CLOSING FILES :                                                       
                                                                                
           CLOSE  BP13F520                                                      
                  BP13L739.                                                     
                                                                                
                                                                                
       0000-EXIT.                                                               
           STOP RUN.                                                            
                                                                                
                                                                                
      **********************************************************                
       1000-INITIALISE-TABLE.                                                   
      **********************************************************                
                                                                                
           MOVE  ZEROS  TO                                                      
                 WS-CAT-QTY ( WS-CNT-SCH, WS-CNT-FLAT, WS-CNT-CAT).             
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       2000-PROCESS-BP13F520.                                                   
      **********************************************************                
                                                                                
           READ BP13F520 AT END                                                 
               PERFORM 4000-PRINT-NT-SUMMARY                                    
                  THRU 4000-EXIT                                                
                MOVE 'Y' TO WS-F520-STATUS                                      
                GO TO 2000-EXIT.                                                
                                                                                
      *    IF  F520-CDE-SUCC-NT NOT = SPACES AND LOW-VALUES                     
      *        GO TO 2000-EXIT.                                                 
      *                                                                         
           IF  F520-CDE-FLAT-TYPE = '2 ' OR '3 '                                
               GO TO 2000-EXIT.                                                 
                                                                                
           IF WS-F520-STATUS NOT = 'Y'                                          
              IF F520-CDE-FLAT-TYPE = '4 ' OR '5 ' OR 'E '                      
                  MOVE '            4-ROOM          ' TO HEAD5-DESC1            
                  MOVE '            5-ROOM          ' TO HEAD5-DESC2            
                  MOVE '             EXEC           ' TO HEAD5-DESC3            
              ELSE                                                              
                  MOVE '              4D            ' TO HEAD5-DESC1            
                  MOVE '              5D            ' TO HEAD5-DESC2            
                  MOVE '              ED            ' TO HEAD5-DESC3.           
                                                                                
           PERFORM  2500-DECODE-ALLOC-FLAT-CAT                                  
              THRU  2500-EXIT.                                                  
                                                                                
           IF  WS-DECODE-ERROR                                                  
               GO TO  2500-EXIT.                                                
                                                                                
           IF  WS-PREV-NT = SPACES OR LOW-VALUES                                
               MOVE  ZEROS             TO  WS-FLAT-SUMMARY-TABLE                
               MOVE  F520-CDE-NT1      TO  WS-PREV-NT.                          
                                                                                
           IF  F520-CDE-NT1     = WS-PREV-NT                                    
               PERFORM 3000-ADD-TO-SUMMARY                                      
                  THRU 3000-EXIT                                                
           ELSE                                                                 
               PERFORM 4000-PRINT-NT-SUMMARY                                    
                  THRU 4000-EXIT                                                
               MOVE  F520-CDE-NT1      TO  WS-PREV-NT                           
               MOVE  ZEROS             TO  WS-FLAT-SUMMARY-TABLE                
                                                                                
               PERFORM 3000-ADD-TO-SUMMARY                                      
                  THRU 3000-EXIT.                                               
                                                                                
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
                                                                                
      **********************************************************                
       2500-DECODE-ALLOC-FLAT-CAT.                                              
      **********************************************************                
                                                                                
      ***  DECODE  ALLOCATION SCHEME :                                          
                                                                                
           MOVE SPACES  TO WS-DECODE-STATUS.                                    
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
              AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                             
              WHEN F520-CDE-ALLOC-SCH =                                         
                                WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)                 
              MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO                              
                                      WS-ALLOCSCH-TYPE.                         
                                                                                
           IF WS-ALLOCSCH-TYPE = 'XXX'                                          
              DISPLAY '***  INVALID ALLOC SCHEME FOR BP13F520 REC '             
                            F520-NUM-REF                                        
              DISPLAY '***  INVALID APPLN ALLOC SCHEME IS : '                   
                            F520-CDE-ALLOC-SCH                                  
              MOVE 'E'  TO  WS-DECODE-STATUS                                    
              GO TO 2500-EXIT.                                                  
                                                                                
           IF WS-ALLOCSCH-TYPE = 'CCC'                                          
              MOVE 1 TO WS-ASCH                                                 
           ELSE                                                                 
           IF WS-ALLOCSCH-TYPE = 'SFF'                                          
              MOVE 2 TO WS-ASCH                                                 
           ELSE                                                                 
           IF WS-ALLOCSCH-TYPE = 'RH '                                          
              MOVE 3 TO WS-ASCH                                                 
           ELSE                                                                 
           IF WS-ALLOCSCH-TYPE = 'REN'                                          
              MOVE 4 TO WS-ASCH                                                 
           ELSE                                                                 
           IF WS-ALLOCSCH-TYPE = 'MTF'                                          
              IF F520-CDE-ALLOC-SCH = 'MT ' OR 'MTS'                            
                 MOVE 5 TO WS-ASCH                                              
              ELSE                                                              
      *       IF WS-ALLOCSCH-TYPE = 'TCP'                                       
                 MOVE 6 TO WS-ASCH                                              
           ELSE                                                                 
           IF WS-ALLOCSCH-TYPE = 'RDC'                                          
              MOVE 7 TO WS-ASCH                                                 
           ELSE                                                                 
           IF WS-ALLOCSCH-TYPE = 'PA '                                          
                                                                                
              PERFORM  2700-PROCESS-PUBLIC-COHORT                               
                 THRU  2700-EXIT                                                
                                                                                
           ELSE                                                                 
              DISPLAY '*** UNRECOGNISED ALLOC TYPE ' WS-ALLOCSCH-TYPE           
                      ' FOUND IN PRIOSCH  AT RECORD ' F520-NUM-REF              
              MOVE 'E'  TO  WS-DECODE-STATUS.                                   
                                                                                
      ***  DECODE  CATEGORY NO.  :                                              
                                                                                
           MOVE F520-CDE-CATEGORY TO WS-CATNO-CHAR.                             
                                                                                
           IF (WS-CATNO = 0) OR (WS-CATNO > 4)                                  
              DISPLAY '*** RECORD ' F520-NUM-REF ' WITH INVALID'                
                      ' CATEGORY NO. = ' WS-CATNO                               
              MOVE 'E'  TO  WS-DECODE-STATUS                                    
              GO TO 2500-EXIT.                                                  
                                                                                
           IF WS-CATNO = 4                                                      
              MOVE 3 TO WS-CATNO.                                               
                                                                                
                                                                                
                                                                                
      ***  DECODE  FLAT TYPE  :                                                 
                                                                                
           IF F520-CDE-FLAT-TYPE = '4 ' OR '4D'                                 
              MOVE  1  TO  WS-FLATNO                                            
           ELSE                                                                 
           IF F520-CDE-FLAT-TYPE = '5 ' OR '5D'                                 
              MOVE  2  TO  WS-FLATNO                                            
           ELSE                                                                 
           IF F520-CDE-FLAT-TYPE = 'E ' OR 'ED'                                 
              MOVE  3  TO  WS-FLATNO                                            
           ELSE                                                                 
              DISPLAY '*** INVALID FLAT TYPE : ' F520-CDE-FLAT-TYPE             
                      ' AT RECORD ' F520-NUM-REF                                
              MOVE 'E' TO  WS-DECODE-STATUS.                                    
                                                                                
       2500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
                                                                                
      **********************************************************                
       2700-PROCESS-PUBLIC-COHORT.                                              
      *--------------------------------------------------------*                
      * PUBLIC APPLICANT DIVIDED INTO:                         *                
      *                                                        *                
      *   TRANSITIONAL STAGE :                                 *                
      *         BAND 1   (WAIT-TIME : 31 - 33 MTHS)            *                
      *         BAND 2   (WAIT-TIME : 28 - 30 MTHS)            *                
      *         BAND 3   (WAIT-TIME : 25 - 27 MTHS)            *                
      *         BAND 4   (WAIT-TIME : 22 - 24 MTHS)            *                
      *   *XX   BAND 5   (WAIT-TIME : 19 - 21 MTHS)            *                
      *   *XX   BAND 6   (WAIT-TIME : 16 - 18 MTHS)            *                
      *                                                        *                
      *   NEW HOUSEHOLD TYPE :                                 *                
      *         BAND 1   (WAIT-TIME : 18 - 21 MTHS & 33        *                
      *         BAND 2   (WAIT-TIME : 15 - 18 MTHS & 30)       *                
      *         BAND 3   (WAIT-TIME : 12 - 15 MTHS & 27)       *                
      *         BAND 4   (WAIT-TIME :  9 - 12 MTHS & 24)       *                
      *         BAND 5   (WAIT-TIME :  8 -  9 MTHS)& 21)       *                
      *                                                        *                
      *   OTHERS :                                             *                
      *         COHORT 8                                       *                
      *         COHORT 7                                       *                
      *         COHORT 6                                       *                
      *         COHORT 5                                       *                
      *         COHORT 4                                       *                
      *         COHORT 3                                       *                
      *         COHORT 2                                       *                
      *         COHORT 1                                       *                
      *                                                        *                
      *--------------------------------------------------------*                
                                                                                
           IF F520-NUM-WAIT-TIME > '33'                                         
              IF F520-NUM-WAIT-TIME > '30'                                      
                 MOVE  9  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > '27'                                      
                 MOVE  10 TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > '24'                                      
                 MOVE 11  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > '21'                                      
                 MOVE 12  TO WS-ASCH                                            
                 GO TO 2700-EXIT.                                               
                                                                                
                                                                                
      * ACTUAL COMPUTATION.                                                     
      * NHH1     N:5          U:9                                               
      * NHH2     N:4          U:8                                               
      * NHH3     N:3          U:7                                               
      * CH4      N:2          U:6                                               
      * CH3      N:1 OR 0     U:4 + 5                                           
      * CH2      -            U:2 + 3                                           
      * CH1      -            U:1                                               
      *                               NHH            UPG                        
      *         BAND 1   (WAIT-TIME : 21 - 24 MTHS & 33        *                
      *         BAND 2   (WAIT-TIME : 18 - 21 MTHS & 30)       *                
      *         BAND 3   (WAIT-TIME : 15 - 18 MTHS & 27)       *                
      *         BAND 4   (WAIT-TIME : 12 - 15 MTHS & 24)       *                
      *         BAND 5   (WAIT-TIME :  9 - 12 MTHS)& 21)       *                
      *         CH   4   (WAIT-TIME :  6 - 9  MTHS & 18        *                
      *         CH   3   (WAIT-TIME :  0 - 3  MTHS & 12 - 15   *                
      *         CH   2   (WAIT-TIME :                6 - 9     *                
      *         CH   1   (WAIT-TIME :                1-3       *                
                                                                                
      * TO CATER FOR 3 MORE MTHS WHEN APPL SUBMIT NEXT QTR.                     
           IF F520-CDE-HOUSEHOLD = 'H'                                          
              IF F520-NUM-WAIT-TIME > 20                                        
                 MOVE 14  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 17                                        
                 MOVE 15  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 14                                        
                 MOVE 16  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 11                                        
                 MOVE 17  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 7                                         
                 MOVE 18  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
      *       COHORT 4                                                          
              IF F520-NUM-WAIT-TIME > 5                                         
                 MOVE 24  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
      *       COHORT 3                                                          
              IF F520-NUM-WAIT-TIME >= ZEROS                                    
                 MOVE 25  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              END-IF                                                            
           ELSE                                                                 
           IF F520-CDE-HOUSEHOLD = 'T'                                          
              IF F520-NUM-WAIT-TIME > 17                                        
                 MOVE 14  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 14                                        
                 MOVE 15  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 11                                        
                 MOVE 16  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 8                                         
                 MOVE 17  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 5                                         
                 MOVE 18  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
      *       COHORT 4                                                          
              IF F520-NUM-WAIT-TIME >= ZEROS                                    
                 MOVE 24  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              END-IF                                                            
           ELSE                                                                 
           IF F520-CDE-HOUSEHOLD = '3'                                          
              IF F520-NUM-WAIT-TIME > 26                                        
                 MOVE 14  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 23                                        
                 MOVE 15  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 20                                        
                 MOVE 16  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 17                                        
                 MOVE 17  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 14                                        
                 MOVE 18  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
      *    IF F520-CDE-COHORT    = '04'                                         
              IF F520-NUM-WAIT-TIME > 11                                        
              MOVE 24  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
      *    IF F520-CDE-COHORT    = '03'                                         
              IF F520-NUM-WAIT-TIME > 5                                         
              MOVE 25  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
      *    IF F520-CDE-COHORT    = '02'                                         
              IF F520-NUM-WAIT-TIME >= ZEROS                                    
              MOVE 26  TO WS-ASCH                                               
                 GO TO 2700-EXIT.                                               
                                                                                
      *       IF F520-NUM-UNSUCC-REQUEST = '02'                                 
      *          MOVE 23  TO WS-ASCH                                            
      *          GO TO 2700-EXIT                                                
      *       ELSE                                                              
      *       IF F520-NUM-UNSUCC-REQUEST = '01' OR '00'                         
      *          MOVE 24  TO WS-ASCH                                            
      *          GO TO 2700-EXIT                                                
                                                                                
      *                                                                         
      *       FOR UPGRADER TO BE IN THE SAME BAND AS NEW-HOUSEHOLD              
      *                                                                         
                                                                                
      *       IF F520-NUM-UNSUCC-REQUEST = '06'                                 
              IF F520-NUM-WAIT-TIME > 32                                        
                 MOVE 14  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 29                                        
                 MOVE 15  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 26                                        
                 MOVE 16  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 23                                        
                 MOVE 17  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
              ELSE                                                              
              IF F520-NUM-WAIT-TIME > 20                                        
                 MOVE 18  TO WS-ASCH                                            
                 GO TO 2700-EXIT                                                
             ELSE                                                               
           IF F520-CDE-COHORT    = '08'                                         
              MOVE 20  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
           IF F520-CDE-COHORT    = '07'                                         
              MOVE 21  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
           IF F520-CDE-COHORT    = '06'                                         
              MOVE 22  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
           IF F520-CDE-COHORT    = '05'                                         
              MOVE 23  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
      *    IF F520-CDE-COHORT    = '04'                                         
              IF F520-NUM-WAIT-TIME > 17                                        
              MOVE 24  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
      *    IF F520-CDE-COHORT    = '03'                                         
              IF F520-NUM-WAIT-TIME > 11                                        
              MOVE 25  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
      *    IF F520-CDE-COHORT    = '02'                                         
              IF F520-NUM-WAIT-TIME > 05                                        
      *    IF F520-CDE-COHORT    = '02'                                         
              MOVE 26  TO WS-ASCH                                               
                 GO TO 2700-EXIT                                                
           ELSE                                                                 
      *    IF F520-CDE-COHORT    = '01'                                         
              IF F520-NUM-WAIT-TIME >= ZEROS                                    
      *    IF F520-CDE-COHORT    = '01'                                         
              MOVE 27  TO WS-ASCH.                                              
                                                                                
       2700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      **********************************************************                
       3000-ADD-TO-SUMMARY.                                                     
      **********************************************************                
      *--------------------------------------------------------*                
      *  INDIVIDUAL SCHEME, FLAT-TYPE AND CAT TOTALS           *                
      *--------------------------------------------------------*                
           ADD  1  TO WS-CAT-QTY ( WS-ASCH , WS-FLATNO , WS-CATNO).             
           ADD  1  TO WS-CAT-QTY ( WS-ASCH , WS-FLATNO ,     4   ).             
           ADD  1  TO WS-CAT-QTY ( WS-ASCH ,     4     , WS-CATNO).             
           ADD  1  TO WS-CAT-QTY ( WS-ASCH ,     4     ,     4   ).             
                                                                                
      *--------------------------------------------------------*                
      *  SUB-TOTALS                                            *                
      *--------------------------------------------------------*                
           IF WS-ASCH < 8                                                       
           ADD  1  TO WS-CAT-QTY (    8    , WS-FLATNO , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (    8    , WS-FLATNO ,     4   )              
           ADD  1  TO WS-CAT-QTY (    8    ,     4     , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (    8    ,     4     ,     4   )              
                                                                                
           ELSE                                                                 
           IF WS-ASCH < 13                                                      
           ADD  1  TO WS-CAT-QTY (   13    , WS-FLATNO , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (   13    , WS-FLATNO ,     4   )              
           ADD  1  TO WS-CAT-QTY (   13    ,     4     , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (   13    ,     4     ,     4   )              
                                                                                
           ELSE                                                                 
           IF WS-ASCH < 19                                                      
           ADD  1  TO WS-CAT-QTY (   19    , WS-FLATNO , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (   19    , WS-FLATNO ,     4   )              
           ADD  1  TO WS-CAT-QTY (   19    ,     4     , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (   19    ,     4     ,     4   )              
                                                                                
           ELSE                                                                 
           IF WS-ASCH < 28                                                      
           ADD  1  TO WS-CAT-QTY (   28    , WS-FLATNO , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (   28    , WS-FLATNO ,     4   )              
           ADD  1  TO WS-CAT-QTY (   28    ,     4     , WS-CATNO)              
           ADD  1  TO WS-CAT-QTY (   28    ,     4     ,     4   ).             
                                                                                
      *--------------------------------------------------------*                
      *  GRAND TOTAL                                           *                
      *--------------------------------------------------------*                
           ADD  1  TO WS-CAT-QTY (   29    , WS-FLATNO , WS-CATNO).             
           ADD  1  TO WS-CAT-QTY (   29    , WS-FLATNO ,     4   ).             
           ADD  1  TO WS-CAT-QTY (   29    ,     4     , WS-CATNO).             
           ADD  1  TO WS-CAT-QTY (   29    ,     4     ,     4   ).             
                                                                                
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      **********************************************************                
       4000-PRINT-NT-SUMMARY.                                                   
      **********************************************************                
                                                                                
           PERFORM 5000-PRINT-REPORT-HEADING                                    
              THRU 5000-EXIT.                                                   
                                                                                
           MOVE SPACES  TO  L739-PRT-DETAILS.                                   
                                                                                
           PERFORM 4100-PRINT-DETAILS-SUMM                                      
              THRU 4100-EXIT                                                    
           VARYING WS-CNT FROM 1 BY 1                                           
             UNTIL WS-CNT > 29.                                                 
                                                                                
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      **********************************************************                
       4100-PRINT-DETAILS-SUMM.                                                 
      **********************************************************                
                                                                                
           IF  WS-CNT = 1                                                       
               MOVE  'CCC   '    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 2                                                       
               MOVE  'STAFF '    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 3                                                       
               MOVE  'RHO   '    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 4                                                       
               MOVE  'REN   '    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 5                                                       
               MOVE  'MTF    '   TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 6                                                       
               MOVE  'TCP    '   TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 7                                                       
               MOVE  'RDC    '   TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 8                                                       
               MOVE  'SUB-TOTAL' TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 9                                                       
               MOVE  'BAND 1'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 10                                                      
               MOVE  'BAND 2'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 11                                                      
               MOVE  'BAND 3'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 12                                                      
               MOVE  'BAND 4'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 13                                                      
               MOVE  'SUB-TOTAL' TO  L739-NME-SCHEME                            
      *        MOVE  'BAND 5'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 14                                                      
               MOVE  'BAND 1'    TO  L739-NME-SCHEME                            
      *        MOVE  'BAND 6'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 15                                                      
               MOVE  'BAND 2'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 16                                                      
               MOVE  'BAND 3'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 17                                                      
               MOVE  'BAND 4'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 18                                                      
               MOVE  'BAND 5'    TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 19                                                      
               MOVE  'SUB-TOTAL' TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 20                                                      
               MOVE  'COHORT 8'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 21                                                      
               MOVE  'COHORT 7'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 22                                                      
               MOVE  'COHORT 6'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 23                                                      
               MOVE  'COHORT 5'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 24                                                      
               MOVE  'COHORT 4'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 25                                                      
               MOVE  'COHORT 3'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 26                                                      
               MOVE  'COHORT 2'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 27                                                      
               MOVE  'COHORT 1'  TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 28                                                      
               MOVE  'SUB-TOTAL' TO  L739-NME-SCHEME                            
           ELSE                                                                 
           IF  WS-CNT = 29                                                      
               MOVE  'TOTAL    ' TO  L739-NME-SCHEME.                           
                                                                                
           PERFORM 4200-SETUP-FLAT-TYPE-QTY                                     
              THRU 4200-EXIT                                                    
           VARYING WS-XCNT FROM 1 BY 1                                          
             UNTIL WS-XCNT > 4                                                  
                                                                                
      *--------------------------------------------------------*                
      *  PRINT SUB-TOTALS                                      *                
      *--------------------------------------------------------*                
           IF  WS-CNT = 8 OR 15 OR 19 OR 28 OR 29                               
               WRITE PRINT-REC  FROM L739-PRT-DETAILS    AFTER 2                
               MOVE ALL '='     TO   PRINT-REC                                  
               WRITE PRINT-REC                                                  
           ELSE                                                                 
               WRITE PRINT-REC  FROM L739-PRT-DETAILS                           
               MOVE ALL '-'     TO   PRINT-REC                                  
               WRITE PRINT-REC.                                                 
                                                                                
      *--------------------------------------------------------*                
      *  PRINT HEADER FOR DIFFERENT ROWS                       *                
      *--------------------------------------------------------*                
           IF  WS-CNT = 8                                                       
               MOVE 'TRANSITIONAL'  TO   L739-PRT-DESC-ROW                      
               WRITE PRINT-REC      FROM L739-PRT-HEADING-8  AFTER 2            
               MOVE ALL '-'         TO   PRINT-REC                              
               WRITE PRINT-REC                                                  
           ELSE                                                                 
           IF  WS-CNT = 13                                                      
               MOVE 'NHH > 7 MTHS  AND UPG > 20 MTHS'                           
               TO   L739-PRT-DESC-ROW                                           
               WRITE PRINT-REC      FROM L739-PRT-HEADING-8  AFTER 2            
               MOVE ALL '-'         TO   PRINT-REC                              
               WRITE PRINT-REC                                                  
           ELSE                                                                 
           IF  WS-CNT = 19                                                      
               MOVE 'COHORT      '  TO   L739-PRT-DESC-ROW                      
               WRITE PRINT-REC      FROM L739-PRT-HEADING-8  AFTER 4            
               MOVE ALL '-'         TO   PRINT-REC                              
               WRITE PRINT-REC.                                                 
                                                                                
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      **********************************************************                
       4200-SETUP-FLAT-TYPE-QTY.                                                
      **********************************************************                
                                                                                
           MOVE WS-CAT-QTY  ( WS-CNT , WS-XCNT , 1 )                            
                TO  L739-PRT-CAT1 (WS-XCNT).                                    
                                                                                
           MOVE WS-CAT-QTY  ( WS-CNT , WS-XCNT , 2 )                            
                TO  L739-PRT-CAT2 (WS-XCNT).                                    
                                                                                
           MOVE WS-CAT-QTY  ( WS-CNT , WS-XCNT , 3 )                            
                TO  L739-PRT-CAT3 (WS-XCNT).                                    
                                                                                
           MOVE WS-CAT-QTY  ( WS-CNT , WS-XCNT , 4 )                            
                TO  L739-PRT-TOT (WS-XCNT).                                     
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      **********************************************************                
       5000-PRINT-REPORT-HEADING.                                               
      **********************************************************                
                                                                                
                                                                                
            ADD        1       TO WS-CNT-PAGE.                                  
            MOVE  WS-CNT-PAGE  TO L739-PAGENO.                                  
                                                                                
            MOVE WS-PREV-NT TO L739-CDE-NT.                                     
                                                                                
            WRITE PRINT-REC FROM L739-PRT-HEADING-1 AFTER PAGE.                 
            WRITE PRINT-REC FROM L739-PRT-HEADING-2.                            
            WRITE PRINT-REC FROM L739-PRT-HEADING-3  AFTER 2.                   
            WRITE PRINT-REC FROM L739-PRT-HEADING-3A AFTER 1.                   
            WRITE PRINT-REC FROM L739-PRT-HEADING-4  AFTER 2.                   
                                                                                
            MOVE  ALL '-' TO PRINT-REC.                                         
            WRITE PRINT-REC                          AFTER 2.                   
                                                                                
            WRITE PRINT-REC FROM L739-PRT-HEADING-5  AFTER 1.                   
            WRITE PRINT-REC FROM L739-PRT-HEADING-6.                            
            WRITE PRINT-REC FROM L739-PRT-HEADING-7.                            
                                                                                
            MOVE ALL '='         TO   PRINT-REC.                                
            WRITE PRINT-REC.                                                    
            MOVE 'PRIORITY     ' TO   L739-PRT-DESC-ROW.                        
            WRITE PRINT-REC      FROM L739-PRT-HEADING-8  AFTER 2.              
                                                                                
            MOVE  ALL '-' TO PRINT-REC.                                         
            WRITE PRINT-REC.                                                    
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
