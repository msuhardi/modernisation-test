       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CM25.                                                 
       AUTHOR.        CS94317.                                                  
       DATE-WRITTEN.  29/08/23.                                                 
                                                                                
      ******************************************************************        
      *   OBJECTIVE : TO PROCESS FIRST TIMER CASES THAT PASSES THE              
      *               FOLLOWING VALIDATION :                                    
      *               A. FAMILY AND RELATIONSHIP VALIDATION(BP13DM24)           
      *                                                                         
      *               TO DETERMINE FT(PMC) ELIGIBILITY ON CORE NUCLEUS          
      *               PERSON IN THE FLAT APPLICATION FOR RESIDENTIAL            
      *               PROPERTY OWNERSHIP                                        
      *================================================================*        
      * CODE USED :                                                    *        
      * CURR-FLAT-OWNERSHIP                                            *        
      *  1 - NOT RESIDENTIAL PROPERTY OWNER                            *        
      *  2 - OWNER MARRIED WITH SPOUSE                                 *        
      *  3 - OWNER SINGLE WITH PARENT                                  *        
      *  4 - OTHERS                                                    *        
      * EX-FLAT-OWNERSHIP                                              *        
      *  2 - SELLER(S) OF EX-FLAT DIVORCE                              *        
      *  3 - SELLER1 AS EX-FLAT OWNER                                  *        
      *  4 - SELLER1 SINGLE WITH PARENT                                *        
      *  5 - SELLER1 NOT SINGLE                                        *        
      *  6 - SELLER2 AS EX-FLAT OWNER                                  *        
      *  7 - SELLER3 AS EX-FLAT OWNER                                  *        
      *  A - SELLER4 AS EX-FLAT OWNER                                  *        
      *  8 - SELLER2 OR SELLER3 OR SELLER4 IS THE SON OF SELLER1       *        
      *  9 - SELLER1 NOT EX-FLAT OWNER AND OTHERS                      *        
      *  PRIVATE PROPERTY                                              *        
      *  2 - NO BYPASS, IS CURRENT PRIVATE PROPERTY OWNER              *        
      *  3 - NO BYPASS, NO CURRENT, NO EX PROPERTY OWNER (NO PPOS)     *        
      *  4 - DISPOSE <= WS-FROM-DATE                                   *        
      *  5 - DISPOSE <= DTE-HFE-APPLN & > WS-FROM-DATE & BYPASS = Y    *        
      *  6 - OTHERS                                                    *        
      *  7 - EXCEPTION IN COMPUTING DTE-DISPOSAL                       *        
      *  TRANSFER                                                      *        
      *  1 - NO TRANSFEROR                                             *        
      *  2 - SELLER WITH DTE-LEGAL-DOC-SIGN                            *        
      *  SURRENDER                                                     *        
      *  1 - NO SURRENDER                                              *        
      *  2 - SU & WITH DTE-COMPLETION                                  *        
      *  3 - CI & WITH DTE-FLAT-REVEST                                 *        
      *  FTPMC                                                         *        
      *  M - MARRIED WITH CHILD                                        *        
      *  C - COUPLE NO CHILD                                           *        
      *  O - OTHERS                                                    *        
      *  N - NOT ELIGIBLE                                              *        
      *  BLANK - NOT FIRST TIMER / NOT FT2T                            *        
      * ---------------------------------------------------------------*        
      * CHG REF    DATE    BY   DESCRIPTION                            *        
      * -------- -------- ----- -----------                            *        
      * BP139530 21092023 JM23  NEW PROGRAM TO CHECK RESIDENTIAL       *        
      *                         PROPERTIES OWNER -                     *        
      *                         RDB, RSL, PPO, TRF, SLS                *        
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13FIN1 ASSIGN TO BP13FIN1.                                  
                                                                                
           SELECT BB24K520 ASSIGN       TO BB24K520                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K520-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K520-FILE-STATUS.                    
                                                                                
           SELECT BB24K530 ASSIGN       TO BB24K530                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K530-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K530-FILE-STATUS.                    
                                                                                
           SELECT BR10K010 ASSIGN       TO BR10K010                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K010-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K010-FILE-STATUS.                    
                                                                                
           SELECT BR10K080 ASSIGN       TO BR10K080                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K080-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K080-FILE-STATUS.                    
                                                                                
           SELECT BR05K100 ASSIGN       TO BR05K100                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K100-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K100-FILE-STATUS.                    
                                                                                
           SELECT BB13K510 ASSIGN       TO BB13K510                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K510-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K510-FILE-STATUS.                    
                                                                                
           SELECT BB13K500 ASSIGN       TO BB13K500                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K500-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K500-FILE-STATUS.                    
                                                                                
           SELECT BB24K510 ASSIGN       TO BB24K510                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K510-KEY-FLD2                        
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K510-FILE-STATUS2.                   
                                                                                
           SELECT BB24K502 ASSIGN       TO BB24K502                             
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K502-KEY-FLD                         
                           ACCESS MODE  IS DYNAMIC                              
                           FILE STATUS  IS K502-FILE-STATUS.                    
                                                                                
           SELECT BP13FOT1 ASSIGN TO BP13FOT1.                                  
           SELECT BP13FOT2 ASSIGN TO BP13FOT2.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *** INPUT RECORD LAYOUT ***                                               
                                                                                
       FD  BP13FIN1                                                             
           RECORDING MODE IS F                                                  
           LABEL RECORDS STANDARD.                                              
                                                                                
       01  BP13FIN1-REC.                                                        
           05 FIN1-HDR-REC.                                                     
              10 FIN1-HDR-TYPE              PIC X.                              
              10 FIN1-HDR-DTE-BALLOT-QTR    PIC 9(6).                           
              10 FIN1-LOW-VALUES            PIC X(8).                           
              10 FIN1-DTE-CREATE            PIC 9(8).                           
              10 FIN1-TIME-CREATE           PIC 9(6).                           
              10 FIN1-HDR-FILLER            PIC X(72).                          
                                                                                
           05 FIN1-DTL1-REC REDEFINES FIN1-HDR-REC.                             
              10 FIN1-RCD1-TYPE             PIC X.                              
              10 FIN1-DTL-DTE-BALLOT-QTR    PIC 9(6).                           
              10 FIN1-NUM-REGN              PIC X(8).                           
              10 FIN1-CDE-ELIG-SCH          PIC X(3).                           
              10 FIN1-NUM-ALLO-CAT          PIC X(3).                           
              10 FIN1-CDE-HOUSEHOLD         PIC X.                              
              10 FIN1-NUM-FT2T              PIC X.                              
              10 FIN1-DTE-REQUEST           PIC X(8).                           
              10 FIN1-NUM-HFE               PIC X(9).                           
              10 FIN1-DTE-HFE-APPLN         PIC X(8).                           
              10 FIN1-CDE-FAMILY-OUTCOME    PIC X.                              
              10 FIN1-CDE-RES-OUTCOME       PIC X.                              
              10 FIN1-CDE-CURR-OWN          PIC X.                              
              10 FIN1-CDE-EX-FLAT-OWN       PIC X.                              
              10 FIN1-CDE-PTE-PROP-OWN      PIC X.                              
              10 FIN1-CDE-TRANSFER          PIC X.                              
              10 FIN1-CDE-SURRENDER         PIC X.                              
              10 FIN1-CDE-CHANCE-OUTCOME    PIC X.                              
              10 FIN1-CDE-FTPMC             PIC X.                              
              10 FIN1-REMARK                PIC X(30).                          
              10 FIN1-DTL-FILLER            PIC X(14).                          
                                                                                
           05 FIN1-DTL2-REC REDEFINES FIN1-DTL1-REC.                            
              10 FIN1-RCD2-TYPE             PIC X.                              
              10 FIN1-DTL2-DTE-BALLOT-QTR   PIC 9(6).                           
              10 FIN1-NUM-REGN2             PIC X(8).                           
              10 FIN1-NUM-NRIC              PIC X(9).                           
              10 FIN1-NUM-LESSEE-CHECK      PIC X.                              
              10 FIN1-DTL2-FILLER           PIC X(76).                          
                                                                                
           05 FIN1-CTL-REC REDEFINES FIN1-HDR-REC.                              
              10 FIN1-CTL-TYPE              PIC X.                              
              10 FIN1-CTL-DTE-BALLOT-QTR    PIC 9(6).                           
              10 FIN1-HIGH-VALUES           PIC X(8).                           
              10 FIN1-RCD-CNT               PIC 9(8).                           
              10 FIN1-CTL-FILLER            PIC X(78).                          
                                                                                
       FD   BB24K530                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 50 CHARACTERS                                       
            LABEL RECORD IS STANDARD.                                           
       COPY BB24K530.                                                           
                                                                                
       FD   BB24K520                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 1700 CHARACTERS                                     
            LABEL RECORD IS STANDARD.                                           
       COPY BB24K520.                                                           
                                                                                
       FD   BR10K010                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 300 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BR10K010.                                                           
                                                                                
       FD   BR10K080                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 300 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BR10K080.                                                           
                                                                                
       FD   BR05K100                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 100 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BR05K100.                                                           
                                                                                
       FD   BB13K510                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 100 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BB13K510.                                                           
                                                                                
       FD   BB13K500                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 1000 CHARACTERS                                     
            LABEL RECORD IS STANDARD.                                           
       COPY BB13K500.                                                           
                                                                                
       FD   BB24K510                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 50 CHARACTERS                                       
            LABEL RECORD IS STANDARD.                                           
       01   BB24K510-REC.                                                       
            05  K510-KEY-FLD2.                                                  
                10  K510-NUM-UIN2           PIC X(9).                           
                10  K510-NUM-HDB-REF2       PIC X(11).                          
                10  K510-DTE-APPROVAL2      PIC X(8).                           
                10  K510-CDE-STATUS2        PIC X(1).                           
            05  FILLER                      PIC X(5).                           
            05  K510-DTE-UPDATE2            PIC X(8).                           
            05  K510-NUM-USERID2            PIC X(8).                           
      *COPY BB24K510.                                                           
                                                                                
       FD   BB24K502                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 3000 CHARACTERS                                     
            LABEL RECORD IS STANDARD.                                           
       COPY BB24K502.                                                           
                                                                                
       FD  BP13FOT1                                                             
           BLOCK CONTAINS     0 RECORDS                                         
           RECORD CONTAINS  100 CHARACTERS                                      
           RECORDING MODE    IS F                                               
           LABEL RECORD      IS STANDARD.                                       
                                                                                
       01  BP13FOT1-REC.                                                        
           05 FOT1-HDR-REC.                                                     
              10 FOT1-HDR-DTE-BALLOT-QTR PIC 9(6).                              
              10 FOT1-HDR-LOW-VAL        PIC X(8).                              
              10 FOT1-DTE-CREATE         PIC 9(8).                              
              10 FOT1-TIME-CREATE        PIC 9(6).                              
              10 FOT1-HDR-FILLER         PIC X(72).                             
                                                                                
           05 FOT1-DTL-REC REDEFINES FOT1-HDR-REC.                              
              10 FOT1-DTL-DTE-BALLOT-QTR PIC 9(6).                              
              10 FOT1-NUM-REGN           PIC X(8).                              
              10 FOT1-CDE-ELIG-SCH       PIC X(3).                              
              10 FOT1-NUM-ALLO-CAT       PIC X(3).                              
              10 FOT1-CDE-HOUSEHOLD      PIC X.                                 
              10 FOT1-NUM-FT2T           PIC X.                                 
              10 FOT1-DTE-REQUEST        PIC X(8).                              
              10 FOT1-NUM-HFE            PIC X(9).                              
              10 FOT1-DTE-HFE-APPLN      PIC X(8).                              
              10 FOT1-CDE-FAMILY-OUTCOME PIC X.                                 
              10 FOT1-CDE-RES-OUTCOME    PIC X.                                 
              10 FOT1-CDE-CURR-OWN       PIC X.                                 
              10 FOT1-CDE-EX-FLAT-OWN    PIC X.                                 
              10 FOT1-CDE-PTE-PROP-OWN   PIC X.                                 
              10 FOT1-CDE-TRANSFER       PIC X.                                 
              10 FOT1-CDE-SURRENDER      PIC X.                                 
              10 FOT1-CDE-CHANCE-OUTCOME PIC X.                                 
              10 FOT1-CDE-FTPMC          PIC X.                                 
              10 FOT1-REMARK             PIC X(30).                             
              10 FOT1-DTL-FILLER         PIC X(14).                             
                                                                                
           05 FOT1-CTL-REC REDEFINES FOT1-HDR-REC.                              
              10 FOT1-CTL-DTE-BALLOT-QTR PIC 9(6).                              
              10 FOT1-CTL-HIGH-VAL       PIC X(8).                              
              10 FOT1-RCD-CNT            PIC 9(8).                              
              10 FOT1-CTL-FILLER         PIC X(78).                             
                                                                                
       FD  BP13FOT2                                                             
           BLOCK CONTAINS     0 RECORDS                                         
           RECORD CONTAINS  100 CHARACTERS                                      
           RECORDING MODE    IS F                                               
           LABEL RECORD      IS STANDARD.                                       
                                                                                
       01  BP13FOT2-REC.                                                        
           05 FOT2-HDR-REC.                                                     
              10 FOT2-HDR-DTE-BALLOT-QTR PIC 9(6).                              
              10 FOT2-HDR-LOW-VAL        PIC X(8).                              
              10 FOT2-DTE-CREATE         PIC 9(8).                              
              10 FOT2-TIME-CREATE        PIC 9(6).                              
              10 FOT2-HDR-FILLER         PIC X(72).                             
                                                                                
           05 FOT2-DTL-REC REDEFINES FOT2-HDR-REC.                              
              10 FOT2-DTL-DTE-BALLOT-QTR PIC 9(6).                              
              10 FOT2-NUM-REGN           PIC X(8).                              
              10 FOT2-CDE-ELIG-SCH       PIC X(3).                              
              10 FOT2-NUM-ALLO-CAT       PIC X(3).                              
              10 FOT2-CDE-HOUSEHOLD      PIC X.                                 
              10 FOT2-NUM-FT2T           PIC X.                                 
              10 FOT2-DTE-REQUEST        PIC X(8).                              
              10 FOT2-NUM-HFE            PIC X(9).                              
              10 FOT2-DTE-HFE-APPLN      PIC X(8).                              
              10 FOT2-CDE-FAMILY-OUTCOME PIC X.                                 
              10 FOT2-CDE-RES-OUTCOME    PIC X.                                 
              10 FOT2-CDE-CURR-OWN       PIC X.                                 
              10 FOT2-CDE-EX-FLAT-OWN    PIC X.                                 
              10 FOT2-CDE-PTE-PROP-OWN   PIC X.                                 
              10 FOT2-CDE-TRANSFER       PIC X.                                 
              10 FOT2-CDE-SURRENDER      PIC X.                                 
              10 FOT2-CDE-CHANCE-OUTCOME PIC X.                                 
              10 FOT2-CDE-FTPMC          PIC X.                                 
              10 FOT2-REMARK             PIC X(30).                             
              10 FOT2-DTL-FILLER         PIC X(14).                             
                                                                                
           05 FOT2-CTL-REC REDEFINES FOT2-HDR-REC.                              
              10 FOT2-CTL-DTE-BALLOT-QTR PIC 9(6).                              
              10 FOT2-CTL-HIGH-VAL       PIC X(8).                              
              10 FOT2-RCD-CNT            PIC 9(8).                              
              10 FOT2-CTL-FILLER         PIC X(78).                             
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
      *DB2 COPYBOOK                                                             
           EXEC SQL INCLUDE P13EXCPT END-EXEC.                                  
           EXEC SQL INCLUDE P13XPRSN END-EXEC.                                  
           EXEC SQL INCLUDE P13IDNO  END-EXEC.                                  
           EXEC SQL INCLUDE P13CSID  END-EXEC.                                  
           EXEC SQL INCLUDE P13PERSN END-EXEC.                                  
           EXEC SQL INCLUDE P13RSDNT END-EXEC.                                  
           EXEC SQL INCLUDE P13RSROL END-EXEC.                                  
           EXEC SQL INCLUDE SQLCA    END-EXEC.                                  
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-FIN1-EOF                PIC X(1)   VALUE 'N'.                  
           05 WS-FIN2-EOF                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K500                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K520                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K530                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K510                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K502                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K010                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K080                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K100                PIC X(1)   VALUE 'N'.                  
           05 WS-EOF-K510-2              PIC X(1)   VALUE 'N'.                  
           05 WS-K520-KEY-FLD            PIC X(19)  VALUE SPACES.               
           05 WS-K502-KEY-FLD            PIC X(19)  VALUE SPACES.               
           05 WS-K500-KEY-FLD            PIC X(12)  VALUE SPACES.               
           05 WS-CURSOR1-EOF             PIC X      VALUE 'N'.                  
           05 WS-CURSOR2-EOF             PIC X      VALUE 'N'.                  
           05 WS-CURSOR3-EOF             PIC X      VALUE 'N'.                  
           05 WS-SQLCODE                 PIC S9(4)  COMP.                       
           05 WS-SQL-CODES.                                                     
              10 WS-SQL-OK               PIC S9(4)  COMP VALUE +000.            
              10 WS-SQL-NFND             PIC S9(4)  COMP VALUE +100.            
              10 WS-SQL-MORE-ROWS        PIC S9(4)  COMP VALUE -811.            
                                                                                
       01  WS-FILE-STATUS.                                                      
           05 K520-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 K530-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 K510-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 K510-FILE-STATUS2           PIC 9(2)  VALUE ZERO.                 
           05 K502-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 K010-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 K080-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 K500-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 BB24-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
           05 K100-FILE-STATUS            PIC 9(2)  VALUE ZERO.                 
                                                                                
           05 WS-IS-OWNER                PIC X      VALUE SPACE.                
           05 WS-PTE-RES-OWNER           PIC X      VALUE SPACE.                
           05 WS-CDE-TRANSFER            PIC X      VALUE SPACE.                
           05 WS-SINGLE-SDGSD            PIC X      VALUE SPACE.                
           05 WS-FIN1-DET-CNT            PIC 9(6)   VALUE ZERO.                 
           05 WS-MTH-CNT                 PIC 9(6)   VALUE ZERO.                 
           05 WS-MATCH-CNT               PIC 9      VALUE ZERO.                 
           05 WS-FIN1-CNT                PIC 9(6)   VALUE ZERO.                 
           05 WS-PPO-CNT                 PIC 9      VALUE ZERO.                 
           05 WS-I                       PIC 9      VALUE ZERO.                 
           05 WS-FIN1-RCD1-CNT           PIC 9(6)   VALUE ZERO.                 
           05 WS-FIN1-RCD2-CNT           PIC 9(6)   VALUE ZERO.                 
           05 WS-ACP-CNT                 PIC 9(6)   VALUE ZERO.                 
           05 WS-REJ-CNT                 PIC 9(6)   VALUE ZERO.                 
           05 WS-TYP2-BYPASS-CNT         PIC 9(6)   VALUE ZERO.                 
           05 WS-FIN1-TYPE2-CNT          PIC 9(6)   VALUE ZERO.                 
           05 WS-FIN1-READ               PIC X      VALUE SPACES.               
           05 WS-PTE-PROP-BYPASS         PIC X      VALUE SPACES.               
           05 WS-PTE-PROP-TAG            PIC X      VALUE SPACES.               
           05 WS-PTE-PROP-FLAG           PIC X      VALUE SPACES.               
           05 WS-SURRENDER-FLAG          PIC X      VALUE SPACES.               
           05 WS-TRANSFER-FLAG           PIC X      VALUE SPACES.               
           05 WS-EX-FLAT-FLAG            PIC X      VALUE SPACES.               
           05 WS-PTE-PRPTY-BYPASS        PIC X      VALUE SPACES.               
           05 WS-CURR-FLAT-OWNERSHIP     PIC X      VALUE SPACES.               
           05 WS-CDE-SURRENDER           PIC X      VALUE SPACES.               
           05 WS-FLAT-FOUND              PIC X      VALUE SPACES.               
           05 WS-MAIN-LESSEE             PIC X      VALUE SPACES.               
           05 WS-FOT1-NUM-REGN           PIC X(8)   VALUE SPACES.               
           05 WS-FIN1-DTL-DTE-BALLOT-QTR PIC 9(6)   VALUE ZERO.                 
           05 WS-K595-DTE-BALLOT.                                               
              10 WS-K595-DTE-BALLOT-CCYY  PIC 9(4)  VALUE 0.                    
              10 WS-K595-DTE-BALLOT-MM    PIC 9(2)  VALUE 0.                    
           05 WS-FIN1-DTE-REQUEST.                                              
              10 WS-FIN1-DTE-REQUEST-CCYY PIC 9(4)  VALUE 0.                    
              10 WS-FIN1-DTE-REQUEST-MM   PIC 9(2)  VALUE 0.                    
           05 WS-COMPUTE-MTH              PIC X     VALUE SPACES.               
           05 WS-X                        PIC 9     VALUE ZEROES.               
           05 WS-CDE-RES-OUTCOME          PIC X     VALUE SPACES.               
           05 WS-FIN1-NUM-REGN            PIC X(8).                             
           05 WS-FIN1-CDE-ELIG-SCH        PIC X(3).                             
           05 WS-FIN1-NUM-ALLO-CAT        PIC X(3).                             
           05 WS-FIN1-CDE-HOUSEHOLD       PIC X.                                
           05 WS-FIN1-NUM-FT2T            PIC X.                                
           05 WS-FIN1-DATE-REQUEST        PIC X(8).                             
           05 WS-FIN1-NUM-HFE             PIC X(9).                             
           05 WS-FIN1-DTE-HFE-APPLN       PIC X(8).                             
           05 WS-FIN1-CDE-FAMILY-OUTCOME  PIC X.                                
           05 WS-FIN1-CDE-RES-OUTCOME     PIC X.                                
           05 WS-FIN1-CDE-CURR-OWN        PIC X.                                
           05 WS-FIN1-CDE-EX-FLAT-OWN     PIC X.                                
           05 WS-FIN1-CDE-PTE-PROP-OWN    PIC X.                                
           05 WS-FIN1-CDE-SURRENDER       PIC X.                                
           05 WS-FIN1-CDE-TRANSFER        PIC X.                                
           05 WS-FIN1-CDE-CHANCE-OUTCOME  PIC X.                                
           05 WS-FIN1-CDE-FTPMC           PIC X.                                
           05 WS-FIN1-REMARK              PIC X(30).                            
           05 WS-REJ                      PIC X.                                
           05 WS-CURR-DTETIME.                                                  
              10 WS-CURR-CDTE.                                                  
                 15 WS-CURR-CDTE-CCYY     PIC X(04) VALUE SPACES.               
                 15 WS-CURR-CDTE-MM       PIC X(02) VALUE SPACES.               
                 15 WS-CURR-CDTE-DD       PIC X(02) VALUE SPACES.               
              10 WS-CURR-TME              PIC X(06) VALUE SPACES.               
           05 WS-DTE-CURR                 PIC 9(08) VALUE ZEROES.               
           05 WS-TME-CURR                 PIC 9(06) VALUE ZEROES.               
           05 WS-DTE-CREATE               PIC 9(08) VALUE ZEROES.               
           05 WS-TIME-CREATE              PIC 9(06) VALUE ZEROES.               
           05 WS-DTE-BALLOT-QTR           PIC 9(06) VALUE ZEROES.               
           05 WS-CDE-FAMILY-OUTCOME       PIC X     VALUE SPACES.               
           05 WS-ERR-MSG                  PIC X(50) VALUE SPACES.               
           05 WS-REJ-TAG                  PIC X     VALUE SPACES.               
           05 WS-DTE-HFE-APPLN.                                                 
              10 WS-DTE-HFE-APPLN-CCYY    PIC 9(4)  VALUE ZEROES.               
              10 WS-DTE-HFE-APPLN-MM      PIC 9(2)  VALUE ZEROES.               
              10 WS-DTE-HFE-APPLN-DD      PIC 9(2)  VALUE ZEROES.               
           05 WS-REJ-REMARK               PIC X(30) VALUE SPACES.               
           05 WS-CURR-NUM-REGN            PIC X(9)  VALUE SPACES.               
           05 WS-EOF-FIN1                 PIC X     VALUE 'N'.                  
           05 WS-EOF-FIN2                 PIC X     VALUE 'N'.                  
           05 WS-EX-FLAT-OWNERSHIP        PIC X     VALUE SPACES.               
           05 WS-LS-FND                   PIC X     VALUE 'N'.                  
           05 WS-COL-SPS-FND              PIC X     VALUE 'N'.                  
           05 WS-COL-PGP-FND              PIC X     VALUE 'N'.                  
           05 WS-COL-SDIL-FND             PIC X     VALUE 'N'.                  
           05 WS-NUM-SCHEME               PIC X(4) VALUE SPACES.                
           05 WS-NUM-ACNT                 PIC X(5) VALUE SPACES.                
           05 WS-NUM-TNCY                 PIC X(2) VALUE SPACES.                
           05 WS-CURR-SCHEME              PIC X(4) VALUE SPACES.                
           05 WS-CURR-ACNT                PIC X(5) VALUE SPACES.                
           05 WS-CURR-TNCY                PIC X(2) VALUE SPACES.                
           05 WS-NUM-SCHEME1              PIC X(4) VALUE SPACES.                
           05 WS-NUM-ACNT1                PIC X(5) VALUE SPACES.                
           05 WS-NUM-TNCY1                PIC X(2) VALUE SPACES.                
           05 WS-NUM-IDNTY-NO             PIC X(20) VALUE SPACES.               
           05 WS-NUM-IDNTY-NO-TYPE        PIC X(3) VALUE SPACES.                
           05 WS-NUM-ROLE                 PIC X(3) VALUE SPACES.                
           05 WS-NUM-RLTNSP               PIC X(2) VALUE SPACES.                
           05 WS-NUM-MRTL-STATUS          PIC X VALUE SPACES.                   
           05 WS-NUM-APRVL-REF            PIC X(9) VALUE SPACES.                
           05 WS-NUM-ELGBTY-CASE           PIC X(9) VALUE SPACES.               
           05 WS-NUM-EXCPTN-REASON         PIC X(5) VALUE SPACES.               
           05 WS-LS-SCHEME                 PIC X(4) VALUE SPACES.               
           05 WS-LS-NUM-ACNT               PIC X(5) VALUE SPACES.               
           05 WS-LS-NUM-TNCY               PIC X(2) VALUE SPACES.               
           05 WS-LS-NUM-IDNTY-NO           PIC X(20) VALUE SPACES.              
           05 WS-LS-NUM-IDNTY-NO-TYPE      PIC X(3) VALUE SPACES.               
           05 WS-LS-NUM-ROLE               PIC X(3) VALUE SPACES.               
           05 WS-LS-NUM-RLTNSP             PIC X(2) VALUE SPACES.               
           05 WS-LS-NUM-MRTL-STATUS        PIC X VALUE SPACES.                  
           05 WS-COL-SPS-SCHEME            PIC X(4) VALUE SPACES.               
           05 WS-COL-SPS-NUM-ACNT          PIC X(5) VALUE SPACES.               
           05 WS-COL-SPS-NUM-TNCY          PIC X(2) VALUE SPACES.               
           05 WS-COL-SPS-NUM-IDNTY-NO      PIC X(20) VALUE SPACES.              
           05 WS-COL-SPS-NUM-IDNTY-NO-TYPE PIC X(3) VALUE SPACES.               
           05 WS-COL-SPS-NUM-ROLE          PIC X(3) VALUE SPACES.               
           05 WS-COL-SPS-NUM-RLTNSP        PIC X(2) VALUE SPACES.               
           05 WS-COL-SPS-NUM-MRTL-STATUS   PIC X VALUE SPACES.                  
           05 WS-COL-SDGSD OCCURS 3 TIMES.                                      
              10 WS-COL-SDGSD-FND             PIC X    VALUE 'N'.               
              10 WS-COL-SDGSD-SCHEME          PIC X(4) VALUE SPACES.            
              10 WS-COL-SDGSD-NUM-ACNT        PIC X(5) VALUE SPACES.            
              10 WS-COL-SDGSD-NUM-TNCY        PIC X(2) VALUE SPACES.            
              10 WS-COL-SDGSD-NUM-IDNTY-NO     PIC X(20) VALUE SPACES.          
              10 WS-COL-SDGSD-NUM-IDNTY-NO-TYPE  PIC X(3) VALUE SPACES.         
              10 WS-COL-SDGSD-NUM-ROLE           PIC X(3) VALUE SPACES.         
              10 WS-COL-SDGSD-NUM-RLTNSP         PIC X(2) VALUE SPACES.         
              10 WS-COL-SDGSD-NUM-MRTL-STATUS    PIC X VALUE SPACES.            
           05 WS-COL-PGP-SCHEME            PIC X(4) VALUE SPACES.               
           05 WS-COL-PGP-NUM-ACNT          PIC X(5) VALUE SPACES.               
           05 WS-COL-PGP-NUM-TNCY          PIC X(2) VALUE SPACES.               
           05 WS-COL-PGP-NUM-IDNTY-NO      PIC X(20) VALUE SPACES.              
           05 WS-COL-PGP-NUM-IDNTY-NO-TYPE PIC X(3) VALUE SPACES.               
           05 WS-COL-PGP-NUM-ROLE          PIC X(3) VALUE SPACES.               
           05 WS-COL-PGP-NUM-RLTNSP        PIC X(2) VALUE SPACES.               
           05 WS-COL-PGP-NUM-MRTL-STATUS   PIC X VALUE SPACES.                  
           05 WS-COL-SDIL-SCHEME            PIC X(4) VALUE SPACES.              
           05 WS-COL-SDIL-NUM-ACNT          PIC X(5) VALUE SPACES.              
           05 WS-COL-SDIL-NUM-TNCY          PIC X(2) VALUE SPACES.              
           05 WS-COL-SDIL-NUM-IDNTY-NO      PIC X(20) VALUE SPACES.             
           05 WS-COL-SDIL-NUM-IDNTY-NO-TYPE PIC X(3) VALUE SPACES.              
           05 WS-COL-SDIL-NUM-ROLE          PIC X(3) VALUE SPACES.              
           05 WS-COL-SDIL-NUM-RLTNSP        PIC X(2) VALUE SPACES.              
           05 WS-COL-SDIL-NUM-MRTL-STATUS   PIC X VALUE SPACES.                 
           05 WS-YESTERDAY-DTE              PIC 9(8) VALUE 0.                   
           05 WS-SYSTEM-DTE                 PIC 9(8) VALUE 0.                   
           05 WS-FROM-DATE                  PIC X(8).                           
                                                                                
       LINKAGE SECTION.                                                         
                                                                                
       COPY P13CARM.                                                            
                                                                                
       PROCEDURE DIVISION USING P13CARMWR.                                      
                                                                                
      ****************                                                          
       0000-MAIN-PROC.                                                          
      ****************                                                          
           PERFORM 1000-OPEN-FILES       THRU 1000-EXIT                         
           PERFORM 2000-VALIDATE-INPUT   THRU 2000-EXIT                         
           PERFORM 3000-MAIN-PROCESS     THRU 3000-EXIT                         
                   UNTIL WS-FIN1-EOF = 'Y' OR                                   
                         FIN1-NUM-REGN >= HIGH-VALUES                           
           PERFORM 6500-CTL-REC          THRU 6500-EXIT                         
           PERFORM 7000-CTL-SUMMARY      THRU 7000-EXIT                         
           PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                               
           STOP RUN                                                             
           .                                                                    
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *******************************************************                   
       1000-OPEN-FILES.                                                         
      *******************************************************                   
           OPEN INPUT  BP13FIN1                                                 
                       BB24K530                                                 
                       BB24K520                                                 
                       BR10K010                                                 
                       BR10K080                                                 
                       BR05K100                                                 
                       BB13K500                                                 
                       BB13K510                                                 
                       BB24K510                                                 
                       BB24K502                                                 
                                                                                
                OUTPUT BP13FOT1                                                 
                       BP13FOT2                                                 
           .                                                                    
                                                                                
           IF K520-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E01: BB24K520 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E01: BB24K520 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K520-FILE-STATUS :' K520-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K530-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E02: BB24K530 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E02: BB24K530 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K530-FILE-STATUS :' K530-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K010-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E03: BR10K010 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E03: BR10K010 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K010-FILE-STATUS :' K010-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K080-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E04: BR10K080 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E04: BR10K080 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K080-FILE-STATUS :' K080-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K100-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E05: BR05K100 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E05: BR05K100 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K100-FILE-STATUS :' K100-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K500-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E06: BB13K500 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E06: BB13K500 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K500-FILE-STATUS :' K500-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K510-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E07: BB13K510 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E07: BB13K510 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K510-FILE-STATUS :' K510-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K510-FILE-STATUS2 NOT = 00 AND 97                                 
              DISPLAY 'BP13CM25-E08: BB24K510 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E08: BB24K510 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K510-FILE-STATUS :' K510-FILE-STATUS2                    
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
                                                                                
           IF K502-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'BP13CM25-E09: BB13K502 FILE OPENING ERROR'               
              MOVE 'BP13CM25-E09: BB13K502 FILE OPENING ERROR' TO               
                                           WS-ERR-MSG                           
              DISPLAY 'K502-FILE-STATUS :' K502-FILE-STATUS                     
              PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                            
              PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                            
           END-IF                                                               
           .                                                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       2000-VALIDATE-INPUT.                                                     
      **********************                                                    
           READ BP13FIN1                                                        
             AT END                                                             
                DISPLAY 'BP13CM25-E10: BP13FIN1 IS EMPTY'                       
                MOVE 'BP13CM25-E10: BP13FIN1 IS EMPTY' TO WS-ERR-MSG            
                PERFORM 9998-CLOSE-FILE THRU 9998-EXIT                          
                PERFORM 9999-CANCEL-JOB THRU 9999-EXIT                          
             NOT AT END                                                         
                IF FIN1-RCD1-TYPE = 0 AND FIN1-LOW-VALUES = LOW-VALUES          
                   MOVE FIN1-DTE-CREATE         TO FOT1-DTE-CREATE              
                                                   FOT2-DTE-CREATE              
                   MOVE FIN1-TIME-CREATE        TO FOT1-TIME-CREATE             
                                                   FOT2-TIME-CREATE             
                   MOVE FIN1-HDR-DTE-BALLOT-QTR TO                              
                                              FOT1-HDR-DTE-BALLOT-QTR           
                                              FOT2-HDR-DTE-BALLOT-QTR           
                   PERFORM 2300-HDR-REC         THRU 2300-EXIT                  
                   PERFORM 2100-READ-FIN1       THRU 2100-EXIT                  
                   SUBTRACT 1                   FROM WS-FIN1-CNT                
                END-IF                                                          
           END-READ                                                             
                                                                                
           PERFORM 2200-INIT-VALUES       THRU 2200-EXIT                        
           .                                                                    
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************                                                          
       2100-READ-FIN1.                                                          
      ****************                                                          
           READ BP13FIN1                                                        
             AT END                                                             
                MOVE 'Y'              TO WS-FIN1-EOF                            
             NOT AT END                                                         
                ADD 1 TO WS-FIN1-CNT.                                           
           .                                                                    
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************                                                       
       2200-INIT-VALUES.                                                        
      *******************                                                       
           MOVE SPACES            TO WS-FOT1-NUM-REGN                           
                                     WS-FIN1-CDE-ELIG-SCH                       
                                     WS-FIN1-NUM-ALLO-CAT                       
                                     WS-FIN1-CDE-HOUSEHOLD                      
                                     WS-FIN1-NUM-FT2T                           
                                     WS-FIN1-DATE-REQUEST                       
                                     WS-FIN1-NUM-HFE                            
                                     WS-FIN1-DTE-HFE-APPLN                      
                                     WS-FIN1-CDE-FAMILY-OUTCOME                 
                                     WS-FIN1-CDE-RES-OUTCOME                    
                                     WS-FIN1-CDE-CURR-OWN                       
                                     WS-FIN1-CDE-EX-FLAT-OWN                    
                                     WS-FIN1-CDE-PTE-PROP-OWN                   
                                     WS-FIN1-CDE-SURRENDER                      
                                     WS-FIN1-CDE-TRANSFER                       
                                     WS-FIN1-CDE-CHANCE-OUTCOME                 
                                     WS-FIN1-CDE-FTPMC                          
                                     WS-FIN1-REMARK                             
           MOVE 'N'               TO WS-COMPUTE-MTH                             
           MOVE 0                 TO WS-FIN1-DTE-REQUEST                        
           MOVE 0                 TO WS-K595-DTE-BALLOT                         
           MOVE FUNCTION CURRENT-DATE  TO WS-CURR-DTETIME                       
           MOVE WS-CURR-TME            TO WS-TME-CURR                           
           .                                                                    
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************                                                            
       2300-HDR-REC.                                                            
      **************                                                            
           INITIALIZE FOT1-HDR-REC                                              
           INITIALIZE FOT2-HDR-REC                                              
           MOVE LOW-VALUES              TO FOT1-HDR-LOW-VAL                     
                                           FOT2-HDR-LOW-VAL                     
           MOVE FIN1-DTE-CREATE         TO FOT1-DTE-CREATE                      
                                           FOT2-DTE-CREATE                      
           MOVE FIN1-TIME-CREATE        TO FOT1-TIME-CREATE                     
                                           FOT2-TIME-CREATE                     
           MOVE FIN1-HDR-DTE-BALLOT-QTR TO FOT1-HDR-DTE-BALLOT-QTR              
                                           FOT2-HDR-DTE-BALLOT-QTR              
           MOVE SPACES                  TO FOT1-HDR-FILLER                      
                                           FOT2-HDR-FILLER                      
           WRITE BP13FOT1-REC                                                   
           WRITE BP13FOT2-REC                                                   
           .                                                                    
       2300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       2400-PROCESS-CHK-TYPE2.                                                  
      ************************                                                  
           MOVE SPACES              TO WS-CURR-FLAT-OWNERSHIP                   
                                       WS-EX-FLAT-OWNERSHIP                     
                                       WS-PTE-RES-OWNER                         
                                       WS-CDE-SURRENDER                         
                                       WS-CDE-TRANSFER                          
                                                                                
      * PROCESS PERSON                                                          
                                                                                
           IF FIN1-RCD1-TYPE = '2'                                              
              IF FIN1-NUM-REGN = WS-CURR-NUM-REGN                               
                 PERFORM 3200-PROCESS-RCD-TYPE2 THRU 3200-EXIT                  
                     UNTIL FIN1-RCD1-TYPE NOT = '2' OR                          
                         FIN1-NUM-REGN NOT = WS-CURR-NUM-REGN OR                
                         WS-IS-OWNER = 'Y' OR                                   
                         WS-FIN1-EOF = 'Y'                                      
              ELSE                                                              
                 MOVE 'PERSON NOT FOUND'   TO WS-REJ-REMARK                     
                 MOVE 'Y'                  TO WS-REJ                            
              END-IF                                                            
           ELSE                                                                 
              MOVE 'PERSON NOT FOUND'      TO WS-REJ-REMARK                     
              MOVE 'Y'                     TO WS-REJ                            
           END-IF                                                               
                                                                                
           IF WS-IS-OWNER = 'N' AND WS-REJ = 'N'                                
              MOVE WS-FIN1-CDE-CHANCE-OUTCOME TO FOT1-CDE-RES-OUTCOME           
              MOVE WS-FIN1-CDE-CHANCE-OUTCOME TO FOT1-CDE-FTPMC                 
              PERFORM 8000-OUT-ACCEPT      THRU 8000-EXIT                       
           END-IF                                                               
                                                                                
           IF WS-IS-OWNER = 'Y' OR WS-REJ = 'Y'                                 
              MOVE 'N'                     TO FOT2-CDE-RES-OUTCOME              
              MOVE 'N'                     TO FOT2-CDE-FTPMC                    
              PERFORM 9000-OUT-REJECT      THRU 9000-EXIT                       
           END-IF                                                               
           .                                                                    
       2400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *******************                                                       
       3000-MAIN-PROCESS.                                                       
      *******************                                                       
           MOVE SPACE              TO WS-PTE-PROP-BYPASS                        
                                      WS-PTE-PROP-TAG                           
                                      WS-CDE-RES-OUTCOME                        
                                      WS-FIN1-CDE-FTPMC                         
                                      WS-EX-FLAT-OWNERSHIP                      
                                      WS-CURR-FLAT-OWNERSHIP                    
                                      WS-CDE-SURRENDER                          
                                      WS-CDE-TRANSFER                           
                                      WS-LS-SCHEME                              
                                      WS-LS-NUM-ACNT                            
                                      WS-LS-NUM-TNCY                            
                                      WS-LS-NUM-IDNTY-NO                        
                                      WS-LS-NUM-IDNTY-NO-TYPE                   
                                      WS-LS-NUM-ROLE                            
                                      WS-LS-NUM-RLTNSP                          
                                      WS-LS-NUM-MRTL-STATUS                     
                                      WS-COL-SPS-SCHEME                         
                                      WS-COL-SPS-NUM-ACNT                       
                                      WS-COL-SPS-NUM-TNCY                       
                                      WS-COL-SPS-NUM-IDNTY-NO                   
                                      WS-COL-SPS-NUM-IDNTY-NO-TYPE              
                                      WS-COL-SPS-NUM-ROLE                       
                                      WS-COL-SPS-NUM-RLTNSP                     
                                      WS-COL-SPS-NUM-MRTL-STATUS                
                                      WS-COL-PGP-SCHEME                         
                                      WS-COL-PGP-NUM-ACNT                       
                                      WS-COL-PGP-NUM-TNCY                       
                                      WS-COL-PGP-NUM-IDNTY-NO                   
                                      WS-COL-PGP-NUM-IDNTY-NO-TYPE              
                                      WS-COL-PGP-NUM-ROLE                       
                                      WS-COL-PGP-NUM-RLTNSP                     
                                      WS-COL-PGP-NUM-MRTL-STATUS                
                                      WS-COL-SDIL-SCHEME                        
                                      WS-COL-SDIL-NUM-ACNT                      
                                      WS-COL-SDIL-NUM-TNCY                      
                                      WS-COL-SDIL-NUM-IDNTY-NO                  
                                      WS-COL-SDIL-NUM-IDNTY-NO-TYPE             
                                      WS-COL-SDIL-NUM-ROLE                      
                                      WS-COL-SDIL-NUM-RLTNSP                    
                                      WS-COL-SDIL-NUM-MRTL-STATUS               
                                      WS-SURRENDER-FLAG                         
                                      WS-TRANSFER-FLAG                          
                                      WS-REJ-REMARK                             
           MOVE 'N'                TO WS-REJ                                    
                                      WS-CURSOR1-EOF                            
                                      WS-CURSOR2-EOF                            
                                      WS-CURSOR3-EOF                            
                                      WS-LS-FND                                 
                                      WS-COL-SPS-FND                            
                                      WS-COL-PGP-FND                            
                                      WS-COL-SDIL-FND                           
                                      WS-IS-OWNER                               
                                                                                
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 4                      
              ADD  1            TO WS-I                                         
              MOVE SPACES       TO WS-COL-SDGSD-SCHEME(WS-I)                    
                                   WS-COL-SDGSD-NUM-ACNT(WS-I)                  
                                   WS-COL-SDGSD-NUM-TNCY(WS-I)                  
                                   WS-COL-SDGSD-NUM-IDNTY-NO(WS-I)              
                                   WS-COL-SDGSD-NUM-IDNTY-NO-TYPE(WS-I)         
                                   WS-COL-SDGSD-NUM-ROLE(WS-I)                  
                                   WS-COL-SDGSD-NUM-RLTNSP(WS-I)                
                                   WS-COL-SDGSD-NUM-MRTL-STATUS(WS-I)           
              MOVE 'N'          TO WS-COL-SDGSD-FND(WS-I)                       
           END-PERFORM                                                          
                                                                                
           IF FIN1-RCD1-TYPE = '1'                                              
              PERFORM 3100-PROCESS-RCD-TYPE1 THRU 3100-EXIT                     
              ADD 1                     TO WS-FIN1-RCD1-CNT                     
           ELSE                                                                 
              IF FIN1-RCD1-TYPE = '2'                                           
                 ADD 1                  TO WS-TYP2-BYPASS-CNT                   
                 ADD 1                  TO WS-FIN1-RCD2-CNT                     
                 PERFORM 2100-READ-FIN1 THRU 2100-EXIT                          
              END-IF                                                            
           END-IF                                                               
           .                                                                    
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       3100-PROCESS-RCD-TYPE1.                                                  
      ************************                                                  
           MOVE FIN1-DTL-DTE-BALLOT-QTR TO WS-FIN1-DTL-DTE-BALLOT-QTR           
           MOVE FIN1-NUM-REGN           TO WS-CURR-NUM-REGN                     
           MOVE FIN1-NUM-REGN           TO WS-FOT1-NUM-REGN                     
           MOVE FIN1-CDE-ELIG-SCH       TO WS-FIN1-CDE-ELIG-SCH                 
           MOVE FIN1-NUM-ALLO-CAT       TO WS-FIN1-NUM-ALLO-CAT                 
           MOVE FIN1-CDE-HOUSEHOLD      TO WS-FIN1-CDE-HOUSEHOLD                
           MOVE FIN1-NUM-FT2T           TO WS-FIN1-NUM-FT2T                     
           MOVE FIN1-DTE-REQUEST        TO WS-FIN1-DATE-REQUEST                 
                                           WS-FIN1-DTE-REQUEST                  
           MOVE FIN1-NUM-HFE            TO WS-FIN1-NUM-HFE                      
           MOVE FIN1-DTE-HFE-APPLN      TO WS-FIN1-DTE-HFE-APPLN                
           MOVE FIN1-CDE-FAMILY-OUTCOME TO WS-FIN1-CDE-FAMILY-OUTCOME           
           MOVE FIN1-CDE-CHANCE-OUTCOME TO WS-FIN1-CDE-CHANCE-OUTCOME           
                                                                                
           PERFORM 2100-READ-FIN1       THRU 2100-EXIT                          
           PERFORM 2400-PROCESS-CHK-TYPE2 THRU 2400-EXIT                        
           .                                                                    
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       3200-PROCESS-RCD-TYPE2.                                                  
      ************************                                                  
                                                                                
           MOVE SPACES              TO WS-CURR-FLAT-OWNERSHIP                   
                                       WS-EX-FLAT-OWNERSHIP                     
                                       WS-PTE-RES-OWNER                         
                                       WS-CDE-SURRENDER                         
                                       WS-CDE-TRANSFER                          
                                       WS-REJ-REMARK                            
                                                                                
      *-- CHECK EXISTING FLAT OWNERSHIP                                         
                                                                                
           PERFORM 3300-DTRMINE-CURR-FLAT-OWNER  THRU 3300-EXIT                 
           IF WS-IS-OWNER = 'N' AND WS-CURR-FLAT-OWNERSHIP = SPACES             
              MOVE '1'                  TO WS-CURR-FLAT-OWNERSHIP               
           END-IF                                                               
                                                                                
      *-- CHECK EX FLAT OWNERSHIP                                               
                                                                                
           IF WS-IS-OWNER = 'N'                                                 
              PERFORM 3400-DTRMINE-EX-FLAT-OWNER THRU 3400-EXIT                 
                                                                                
              IF WS-IS-OWNER = 'N' AND WS-EX-FLAT-OWNERSHIP = SPACES            
                 MOVE '1'               TO WS-EX-FLAT-OWNERSHIP                 
              END-IF                                                            
                                                                                
              IF WS-IS-OWNER = 'Y'                                              
                 MOVE 'EX FLAT OWNER'   TO WS-REJ-REMARK                        
              END-IF                                                            
           END-IF                                                               
                                                                                
      *-- CHECK PRIVATE PROPERTY                                                
                                                                                
           IF WS-IS-OWNER = 'N'                                                 
              PERFORM 3500-DTRMINE-PTE-PROP-OWNER THRU 3500-EXIT                
                                                                                
              IF WS-IS-OWNER = 'N' AND WS-PTE-RES-OWNER = SPACE                 
                 MOVE '1'                          TO WS-PTE-RES-OWNER          
              END-IF                                                            
           END-IF                                                               
                                                                                
      *-- CHECK TRANSFER                                                        
                                                                                
           IF WS-IS-OWNER = 'N'                                                 
              PERFORM 6010-DTRMNE-TRNSFR-FLAT-ONR THRU 6010-EXIT                
              IF WS-IS-OWNER = 'N' AND WS-CDE-TRANSFER = SPACE                  
                 MOVE '1'                    TO WS-CDE-TRANSFER                 
              END-IF                                                            
                                                                                
              IF WS-IS-OWNER = 'Y'                                              
                 MOVE 'TRANSFER FLAT OWNER'  TO WS-REJ-REMARK                   
              END-IF                                                            
           END-IF                                                               
                                                                                
      *-- CHECK SURRENDER                                                       
                                                                                
           IF WS-IS-OWNER = 'N'                                                 
              PERFORM 6000-DTRMNE-SURRNDER-FLAT-ONR THRU 6000-EXIT              
              IF WS-IS-OWNER = 'N' AND WS-CDE-SURRENDER = SPACE                 
                 MOVE '1'                    TO WS-CDE-SURRENDER                
              END-IF                                                            
                                                                                
              IF WS-IS-OWNER = 'Y'                                              
                 MOVE 'SURRENDER FLAT OWNER' TO WS-REJ-REMARK                   
              END-IF                                                            
           END-IF                                                               
                                                                                
           ADD 1                                  TO WS-FIN1-RCD2-CNT           
           PERFORM 2100-READ-FIN1                 THRU 2100-EXIT                
           .                                                                    
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************************                                           
       3300-DTRMINE-CURR-FLAT-OWNER.                                            
      *******************************                                           
           MOVE 'N'                           TO WS-FLAT-FOUND                  
           MOVE ZEROES                        TO WS-X                           
           MOVE 'N'                           TO WS-SINGLE-SDGSD                
           PERFORM 5000-GET-HDB-REF-BY-NRIC   THRU 5000-EXIT                    
           .                                                                    
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************                                             
       3400-DTRMINE-EX-FLAT-OWNER.                                              
      *****************************                                             
           MOVE 'N'                     TO WS-EX-FLAT-FLAG                      
           MOVE 'N'                     TO WS-EOF-K530                          
                                                                                
           MOVE LOW-VALUES              TO K530-KEY-FLD                         
           MOVE FIN1-NUM-NRIC           TO K530-NUM-UIN                         
           START BB24K530 KEY >= K530-NUM-UIN                                   
                                                                                
           EVALUATE K530-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
                PERFORM 3450-READ-BB24K530   THRU 3450-EXIT                     
                IF K530-NUM-UIN = FIN1-NUM-NRIC                                 
                   PERFORM 3600-PROC-BB24K530   THRU 3600-EXIT                  
                     UNTIL WS-EOF-K530 = 'Y' OR                                 
                           WS-IS-OWNER = 'Y' OR                                 
                           K530-NUM-UIN NOT = FIN1-NUM-NRIC                     
                ELSE                                                            
                   PERFORM 3425-DTRMINE-EX-FLAT-OWNER-2                         
                   THRU    3425-EXIT                                            
                END-IF                                                          
           WHEN 10                                                              
           WHEN 23                                                              
              PERFORM 3425-DTRMINE-EX-FLAT-OWNER-2                              
              THRU    3425-EXIT                                                 
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E11: BB24K530 READING ERROR.'                   
              DISPLAY 'K530-STATUS : ' K530-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       3450-READ-BB24K530.                                                      
      *********************                                                     
           READ BB24K530 NEXT RECORD                                            
              AT END MOVE 'Y' TO WS-EOF-K530.                                   
                                                                                
           EVALUATE K530-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
                CONTINUE                                                        
           WHEN 10                                                              
           WHEN 23                                                              
              PERFORM 3425-DTRMINE-EX-FLAT-OWNER-2                              
              THRU    3425-EXIT                                                 
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E12: BB24K530 READING ERROR.'                   
              DISPLAY 'K530-STATUS : ' K530-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       3450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************                                            
       3500-DTRMINE-PTE-PROP-OWNER.                                             
      ******************************                                            
           MOVE 'N'                      TO WS-PTE-PRPTY-BYPASS                 
           PERFORM 4100-PROC-BR10K010    THRU 4100-EXIT                         
           .                                                                    
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       3600-PROC-BB24K530.                                                      
      *********************                                                     
           IF WS-IS-OWNER = 'N'                                                 
              MOVE SPACE                     TO WS-EX-FLAT-OWNERSHIP            
           END-IF                                                               
                                                                                
           IF K530-CDE-STATUS = 'S' OR                                          
              K530-CDE-STATUS = 'P'                                             
              STRING K530-NUM-HDB-REF DELIMITED BY SIZE                         
                     K530-DTE-APPROVAL DELIMITED BY SIZE                        
                 INTO   WS-K520-KEY-FLD                                         
              END-STRING                                                        
              MOVE WS-K520-KEY-FLD           TO K520-KEY-FLD                    
              PERFORM 3700-PROC-BB24K520     THRU 3700-EXIT                     
           END-IF                                                               
                                                                                
           PERFORM 3450-READ-BB24K530           THRU 3450-EXIT                  
           .                                                                    
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       3700-PROC-BB24K520.                                                      
      *********************                                                     
           READ BB24K520.                                                       
                                                                                
           EVALUATE K520-FILE-STATUS                                            
           WHEN 00                                                              
              PERFORM 3900-EX-FLAT-OWNER-DTL    THRU 3900-EXIT                  
           WHEN 23                                                              
              MOVE 'E'                          TO WS-EX-FLAT-OWNERSHIP         
              MOVE 'Y'                          TO WS-EOF-K520                  
              MOVE 'Y'                          TO WS-IS-OWNER                  
              MOVE 'EX FLAT DETAIL NOT FOUND'   TO WS-REJ-REMARK                
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E13: BB24K520 READING ERROR.'                   
              DISPLAY 'K520-STATUS : ' K520-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       3700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************                                                 
       3900-EX-FLAT-OWNER-DTL.                                                  
      *************************                                                 
           IF (K520-CDE-RESALE-STATUS(1:1) NOT = 'B' AND 'F' AND 'G'            
                                     AND 'M' AND 'P' AND 'R' AND 'V')           
      *FOR VERY OLD COMPLETED CASES                                             
              IF (K520-DTE-COMPLETION NOT = SPACES AND LOW-VALUE AND            
                                           '00010101')                          
                 PERFORM 4000-EX-FLAT-FAMILY-CHECK THRU 4000-EXIT               
              ELSE                                                              
      *FOR COMPLETED CASE                                                       
                 IF (K520-DTE-COMPLETION = SPACES OR LOW-VALUE OR               
                                          '00010101') AND                       
                    (K520-DTE-RESL-EFF = SPACES OR LOW-VALUE OR                 
                                          '00010101')                           
                    PERFORM 4000-EX-FLAT-FAMILY-CHECK THRU 4000-EXIT            
                 ELSE                                                           
                    IF (K520-DTE-COMPLETION = SPACES OR LOW-VALUE OR            
                                          '00010101') AND                       
                        K520-DTE-RESL-EFF < '20040101'                          
                      PERFORM 4000-EX-FLAT-FAMILY-CHECK THRU 4000-EXIT          
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           .                                                                    
       3900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************                                              
       4000-EX-FLAT-FAMILY-CHECK.                                               
      ****************************                                              
                                                                                
           IF WS-EX-FLAT-OWNERSHIP  = SPACES         AND                        
              (K520-NUM-UIN-SELLER1 = FIN1-NUM-NRIC  OR                         
               K520-NUM-UIN-SELLER2 = FIN1-NUM-NRIC  OR                         
               K520-NUM-UIN-SELLER3 = FIN1-NUM-NRIC  OR                         
               K520-NUM-UIN-SELLER4 = FIN1-NUM-NRIC) AND                        
               K520-CDE-DIVORCE-TAG = 'Y'                                       
               MOVE 'N'                      TO WS-IS-OWNER                     
               MOVE '2'                      TO WS-EX-FLAT-OWNERSHIP            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K520-NUM-UIN-SELLER1 = FIN1-NUM-NRIC AND                          
              K520-CDE-MAR-STATUS-SELLER1  = 'M'                                
              IF ((((K520-NUM-UIN-SELLER2 NOT = SPACES AND LOW-VALUES)          
                 AND (K520-CDE-RELATE2-SELLER1 = 'WI' OR 'HU' OR 'EW'))         
                 OR ((K520-NUM-UIN-SELLER3 NOT = SPACES AND LOW-VALUES)         
                 AND (K520-CDE-RELATE3-SELLER1 = 'WI' OR 'HU' OR 'EW'))         
                 OR ((K520-NUM-UIN-SELLER4 NOT = SPACES AND LOW-VALUES)         
                 AND (K520-CDE-RELATE4-SELLER1 = 'WI' OR 'HU' OR 'EW'))         
                OR (K520-NUM-UIN-SPOUSE1 NOT = SPACES AND LOW-VALUES)))         
                 MOVE 'Y'     TO WS-IS-OWNER                                    
                 MOVE '3'     TO WS-EX-FLAT-OWNERSHIP                           
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K520-NUM-UIN-SELLER2 = FIN1-NUM-NRIC AND                          
              K520-CDE-MAR-STATUS-SELLER2 = 'M'                                 
              IF (K520-CDE-RELATE2-SELLER1 = 'WI' OR 'HU' OR 'EW')              
                  MOVE 'Y'                 TO WS-IS-OWNER                       
                  MOVE '6'                 TO WS-EX-FLAT-OWNERSHIP              
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K520-NUM-UIN-SELLER3 = FIN1-NUM-NRIC AND                          
              K520-CDE-MAR-STATUS-SELLER3 = 'M'                                 
              IF (K520-CDE-RELATE3-SELLER1 = 'WI' OR 'HU' OR 'EW')              
                  MOVE 'Y'     TO WS-IS-OWNER                                   
                  MOVE '7'     TO WS-EX-FLAT-OWNERSHIP                          
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K520-NUM-UIN-SELLER4 = FIN1-NUM-NRIC AND                          
              K520-CDE-MAR-STATUS-SELLER4 = 'M'                                 
              IF (K520-CDE-RELATE4-SELLER1 = 'WI' OR 'HU' OR 'EW')              
                  MOVE 'Y'      TO WS-IS-OWNER                                  
                  MOVE 'A'      TO WS-EX-FLAT-OWNERSHIP                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES                                     
              IF K520-NUM-UIN-SELLER1 = FIN1-NUM-NRIC AND                       
                 K520-CDE-MAR-STATUS-SELLER1 = 'S'    AND                       
                 (K520-CDE-RELATE2-SELLER1 = 'FA' OR 'MO' OR 'GR' OR            
                                             'SM') OR                           
                 (K520-CDE-RELATE3-SELLER1 = 'FA' OR 'MO' OR 'GR' OR            
                                             'SM') OR                           
                 (K520-CDE-RELATE4-SELLER1 = 'FA' OR 'MO' OR 'GR' OR            
                                             'SM')                              
                 MOVE 'N'                   TO WS-IS-OWNER                      
                 MOVE '4'                   TO WS-EX-FLAT-OWNERSHIP             
              ELSE                                                              
                 IF K520-NUM-UIN-SELLER1 = FIN1-NUM-NRIC                        
                    MOVE 'Y'                   TO WS-IS-OWNER                   
                    MOVE '5'                   TO WS-EX-FLAT-OWNERSHIP          
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES                                     
              IF K520-NUM-UIN-SELLER1 NOT = FIN1-NUM-NRIC AND                   
                 (K520-NUM-UIN-SELLER2 = FIN1-NUM-NRIC AND                      
                 (K520-CDE-RELATE2-SELLER1 = 'SO' OR 'DA' OR 'GS') AND          
                  K520-CDE-MAR-STATUS-SELLER2 = 'S') OR                         
                 (K520-NUM-UIN-SELLER3 = FIN1-NUM-NRIC AND                      
                 (K520-CDE-RELATE3-SELLER1 = 'SO' OR 'DA' OR 'GS') AND          
                  K520-CDE-MAR-STATUS-SELLER3 = 'S') OR                         
                 (K520-NUM-UIN-SELLER4 = FIN1-NUM-NRIC AND                      
                 (K520-CDE-RELATE4-SELLER1 = 'SO' OR 'DA' OR 'GS') AND          
                 K520-CDE-MAR-STATUS-SELLER4 = 'S')                             
                 MOVE 'N'                    TO WS-IS-OWNER                     
                 MOVE '8'                    TO WS-EX-FLAT-OWNERSHIP            
              ELSE                                                              
                 IF K520-NUM-UIN-SELLER1 NOT = FIN1-NUM-NRIC                    
                    MOVE 'Y'                 TO WS-IS-OWNER                     
                    MOVE '9'                 TO WS-EX-FLAT-OWNERSHIP            
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           .                                                                    
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************************                                           
       3425-DTRMINE-EX-FLAT-OWNER-2.                                            
      *******************************                                           
           MOVE 'N'                     TO WS-EX-FLAT-FLAG                      
           MOVE 'N'                     TO WS-EOF-K510-2                        
                                                                                
           MOVE LOW-VALUES              TO K510-KEY-FLD2                        
           MOVE FIN1-NUM-NRIC           TO K510-NUM-UIN2                        
           START BB24K510 KEY >= K510-NUM-UIN2                                  
                                                                                
           EVALUATE K510-FILE-STATUS2                                           
           WHEN 00                                                              
           WHEN 02                                                              
                PERFORM 3430-READ-BB24K510   THRU 3430-EXIT                     
                IF K510-NUM-UIN2 = FIN1-NUM-NRIC                                
                   PERFORM 3435-PROC-BB24K510   THRU 3435-EXIT                  
                     UNTIL WS-EOF-K510-2 = 'Y' OR                               
                           WS-IS-OWNER = 'Y' OR                                 
                           K510-NUM-UIN2 NOT = FIN1-NUM-NRIC                    
                ELSE                                                            
                   MOVE 'B'                  TO WS-EX-FLAT-OWNERSHIP            
                   MOVE 'Y'                  TO WS-EOF-K510-2                   
                   MOVE 'N'                  TO WS-IS-OWNER                     
                END-IF                                                          
           WHEN 10                                                              
           WHEN 23                                                              
                MOVE 'B'                  TO WS-EX-FLAT-OWNERSHIP               
                MOVE 'Y'                  TO WS-EOF-K510-2                      
                MOVE 'N'                  TO WS-IS-OWNER                        
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E14: BB24K510 READING ERROR.'                   
              DISPLAY 'K510-STATUS : ' K510-FILE-STATUS2                        
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       3425-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       3430-READ-BB24K510.                                                      
      *********************                                                     
           READ BB24K510 NEXT RECORD                                            
              AT END MOVE 'Y' TO WS-EOF-K510-2.                                 
                                                                                
           EVALUATE K510-FILE-STATUS2                                           
           WHEN 00                                                              
           WHEN 02                                                              
                CONTINUE                                                        
           WHEN 10                                                              
           WHEN 23                                                              
                MOVE 'B'                  TO WS-EX-FLAT-OWNERSHIP               
                MOVE 'Y'                  TO WS-EOF-K510-2                      
                MOVE 'N'                  TO WS-IS-OWNER                        
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E15: BB24K510 READING ERROR.'                   
              DISPLAY 'K510-STATUS : ' K510-FILE-STATUS2                        
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       3430-EXIT.                                                               
           EXIT.                                                                
      *********************                                                     
       3435-PROC-BB24K510.                                                      
      *********************                                                     
           IF WS-IS-OWNER = 'N'                                                 
              MOVE SPACE                     TO WS-EX-FLAT-OWNERSHIP            
           END-IF                                                               
                                                                                
           IF K510-CDE-STATUS2 = 'S' OR                                         
              K510-CDE-STATUS2 = 'P'                                            
              STRING K510-NUM-HDB-REF2 DELIMITED BY SIZE                        
                     K510-DTE-APPROVAL2 DELIMITED BY SIZE                       
                 INTO   WS-K502-KEY-FLD                                         
              END-STRING                                                        
              MOVE WS-K502-KEY-FLD           TO K502-KEY-FLD                    
              PERFORM 3440-PROC-BB24K502     THRU 3440-EXIT                     
           END-IF                                                               
                                                                                
           PERFORM 3430-READ-BB24K510           THRU 3430-EXIT                  
           .                                                                    
       3435-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       3440-PROC-BB24K502.                                                      
      *********************                                                     
           READ BB24K502.                                                       
                                                                                
           EVALUATE K502-FILE-STATUS                                            
           WHEN 00                                                              
              PERFORM 3445-EX-FLAT-OWNER-DTL    THRU 3445-EXIT                  
           WHEN 23                                                              
              MOVE 'F'                          TO WS-EX-FLAT-OWNERSHIP         
              MOVE 'Y'                          TO WS-EOF-K502                  
              MOVE 'Y'                          TO WS-IS-OWNER                  
              MOVE 'EX FLAT DETAIL NOT FOUND'   TO WS-REJ-REMARK                
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E16: BB24K502 READING ERROR.'                   
              DISPLAY 'K502-STATUS : ' K502-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       3440-EXIT.                                                               
           EXIT.                                                                
      *************************                                                 
       3445-EX-FLAT-OWNER-DTL.                                                  
      *************************                                                 
           IF (K502-CDE-RESALE-STATUS(1:1) NOT = 'B' AND 'F' AND 'G'            
                                     AND 'M' AND 'P' AND 'R' AND 'V')           
              IF (K502-DTE-COMPLETION NOT = SPACES AND LOW-VALUE AND            
                                           '00010101')                          
                 PERFORM 4010-EX-FLAT-FAMILY-CHECK THRU 4010-EXIT               
              ELSE                                                              
                 IF (K502-DTE-COMPLETION = SPACES OR LOW-VALUE OR               
                                          '00010101') AND                       
                    (K502-DTE-RESL-EFF = SPACES OR LOW-VALUE OR                 
                                          '00010101')                           
                    PERFORM 4010-EX-FLAT-FAMILY-CHECK THRU 4010-EXIT            
                 ELSE                                                           
                    IF (K502-DTE-COMPLETION = SPACES OR LOW-VALUE OR            
                                          '00010101') AND                       
                        K502-DTE-RESL-EFF < '20040101'                          
                      PERFORM 4010-EX-FLAT-FAMILY-CHECK THRU 4010-EXIT          
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           .                                                                    
       3445-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************                                              
       4010-EX-FLAT-FAMILY-CHECK.                                               
      ****************************                                              
           IF WS-EX-FLAT-OWNERSHIP  = SPACES         AND                        
              (K502-NUM-UIN-SELLER1 = FIN1-NUM-NRIC  OR                         
               K502-NUM-UIN-SELLER2 = FIN1-NUM-NRIC  OR                         
               K502-NUM-UIN-SELLER3 = FIN1-NUM-NRIC  OR                         
               K502-NUM-UIN-SELLER4 = FIN1-NUM-NRIC) AND                        
               K502-CDE-DIVORCE-TAG = 'Y'                                       
               MOVE 'N'                      TO WS-IS-OWNER                     
               MOVE 'C'                      TO WS-EX-FLAT-OWNERSHIP            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K502-NUM-UIN-SELLER1 = FIN1-NUM-NRIC AND                          
              K502-CDE-MAR-STATUS-SELLER1  = 'M'                                
              IF ((((K502-NUM-UIN-SELLER2 NOT = SPACES AND LOW-VALUES)          
                 AND (K502-CDE-RELATE2-SELLER1 = 'WI' OR 'HU' OR 'EW'))         
                 OR ((K502-NUM-UIN-SELLER3 NOT = SPACES AND LOW-VALUES)         
                 AND (K502-CDE-RELATE3-SELLER1 = 'WI' OR 'HU' OR 'EW'))         
                 OR ((K502-NUM-UIN-SELLER4 NOT = SPACES AND LOW-VALUES)         
                 AND (K502-CDE-RELATE4-SELLER1 = 'WI' OR 'HU' OR 'EW'))         
                OR (K502-NUM-UIN-SPOUSE1 NOT = SPACES AND LOW-VALUES)))         
                 MOVE 'Y'     TO WS-IS-OWNER                                    
                 MOVE 'D'     TO WS-EX-FLAT-OWNERSHIP                           
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K502-NUM-UIN-SELLER2 = FIN1-NUM-NRIC AND                          
              K502-CDE-MAR-STATUS-SELLER2 = 'M'                                 
              IF (K502-CDE-RELATE2-SELLER1 = 'WI' OR 'HU' OR 'EW')              
                  MOVE 'Y'                 TO WS-IS-OWNER                       
                  MOVE 'I'                 TO WS-EX-FLAT-OWNERSHIP              
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K502-NUM-UIN-SELLER3 = FIN1-NUM-NRIC AND                          
              K502-CDE-MAR-STATUS-SELLER3 = 'M'                                 
              IF (K502-CDE-RELATE3-SELLER1 = 'WI' OR 'HU' OR 'EW')              
                  MOVE 'Y'     TO WS-IS-OWNER                                   
                  MOVE 'J'     TO WS-EX-FLAT-OWNERSHIP                          
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES        AND                          
              K502-NUM-UIN-SELLER4 = FIN1-NUM-NRIC AND                          
              K502-CDE-MAR-STATUS-SELLER4 = 'M'                                 
              IF (K502-CDE-RELATE4-SELLER1 = 'WI' OR 'HU' OR 'EW')              
                  MOVE 'Y'      TO WS-IS-OWNER                                  
                  MOVE 'M'      TO WS-EX-FLAT-OWNERSHIP                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES                                     
              IF K502-NUM-UIN-SELLER1 = FIN1-NUM-NRIC AND                       
                 K502-CDE-MAR-STATUS-SELLER1 = 'S'    AND                       
                 (K502-CDE-RELATE2-SELLER1 = 'FA' OR 'MO' OR 'GR' OR            
                                             'SM') OR                           
                 (K502-CDE-RELATE3-SELLER1 = 'FA' OR 'MO' OR 'GR' OR            
                                             'SM') OR                           
                 (K502-CDE-RELATE4-SELLER1 = 'FA' OR 'MO' OR 'GR' OR            
                                             'SM')                              
                 MOVE 'N'                   TO WS-IS-OWNER                      
                 MOVE 'G'                   TO WS-EX-FLAT-OWNERSHIP             
              ELSE                                                              
                 IF K502-NUM-UIN-SELLER1 = FIN1-NUM-NRIC                        
                    MOVE 'Y'                   TO WS-IS-OWNER                   
                    MOVE 'H'                   TO WS-EX-FLAT-OWNERSHIP          
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF WS-EX-FLAT-OWNERSHIP = SPACES                                     
              IF K502-NUM-UIN-SELLER1 NOT = FIN1-NUM-NRIC AND                   
                 (K502-NUM-UIN-SELLER2 = FIN1-NUM-NRIC AND                      
                 (K502-CDE-RELATE2-SELLER1 = 'SO' OR 'DA' OR 'GS') AND          
                  K502-CDE-MAR-STATUS-SELLER2 = 'S') OR                         
                 (K502-NUM-UIN-SELLER3 = FIN1-NUM-NRIC AND                      
                 (K502-CDE-RELATE3-SELLER1 = 'SO' OR 'DA' OR 'GS') AND          
                  K502-CDE-MAR-STATUS-SELLER3 = 'S') OR                         
                 (K502-NUM-UIN-SELLER4 = FIN1-NUM-NRIC AND                      
                 (K502-CDE-RELATE4-SELLER1 = 'SO' OR 'DA' OR 'GS') AND          
                 K502-CDE-MAR-STATUS-SELLER4 = 'S')                             
                 MOVE 'N'                    TO WS-IS-OWNER                     
                 MOVE 'K'                    TO WS-EX-FLAT-OWNERSHIP            
              ELSE                                                              
                 IF K502-NUM-UIN-SELLER1 NOT = FIN1-NUM-NRIC                    
                    MOVE 'Y'                 TO WS-IS-OWNER                     
                    MOVE 'L'                 TO WS-EX-FLAT-OWNERSHIP            
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           .                                                                    
       4010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       4100-PROC-BR10K010.                                                      
      *********************                                                     
           MOVE SPACES                   TO BR10K010-REC                        
           INITIALIZE BR10K010-REC                                              
           MOVE LOW-VALUES               TO K010-KEY-FLD                        
           MOVE 'N'                      TO WS-EOF-K010                         
           MOVE FIN1-NUM-NRIC            TO K010-NUM-UIN                        
                                                                                
           START BR10K010 KEY >= K010-NUM-UIN                                   
                                                                                
           EVALUATE K010-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              PERFORM 4200-READ-BR10K010       THRU 4200-EXIT                   
              IF K010-NUM-UIN = FIN1-NUM-NRIC                                   
                 PERFORM 4300-PROC-BR10K010-DTL   THRU 4300-EXIT                
                    UNTIL K010-NUM-UIN NOT = FIN1-NUM-NRIC OR                   
                          WS-EOF-K010 = 'Y' OR WS-IS-OWNER = 'Y'                
              ELSE                                                              
                 MOVE 'Y'                      TO WS-EOF-K010                   
                 PERFORM 4400-PROC-BR10K080    THRU 4400-EXIT                   
              END-IF                                                            
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE 'Y'                      TO WS-EOF-K010                      
              PERFORM 4400-PROC-BR10K080    THRU 4400-EXIT                      
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E17: BR10K010 READING ERROR.'                   
              DISPLAY 'K010-STATUS : ' K010-FILE-STATUS                         
              DISPLAY 'NRIC        : ' FIN1-NUM-NRIC                            
              PERFORM 9998-CLOSE-FILE    THRU 9998-EXIT                         
              PERFORM 9999-CANCEL-JOB    THRU 9999-EXIT                         
           END-EVALUATE                                                         
           .                                                                    
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ********************                                                      
       4200-READ-BR10K010.                                                      
      ********************                                                      
           READ BR10K010 NEXT RECORD                                            
              AT END MOVE 'Y' TO WS-EOF-K010.                                   
                                                                                
           EVALUATE K010-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              CONTINUE                                                          
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE 'Y'                      TO WS-EOF-K010                      
              PERFORM 4400-PROC-BR10K080    THRU 4400-EXIT                      
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E18: BR10K010 READING ERROR.'                   
              DISPLAY 'K010-STATUS : ' K010-FILE-STATUS                         
              DISPLAY 'NRIC        : ' FIN1-NUM-NRIC                            
              PERFORM 9998-CLOSE-FILE    THRU 9998-EXIT                         
              PERFORM 9999-CANCEL-JOB    THRU 9999-EXIT                         
           END-EVALUATE                                                         
           .                                                                    
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************                                                 
       4300-PROC-BR10K010-DTL.                                                  
      *************************                                                 
           IF K010-NUM-UIN = FIN1-NUM-NRIC AND                                  
              K010-CDE-PPTY-TYPE(1:1) = 'R'                                     
              PERFORM 4700-CHK-PTE-PROP-BYPASS THRU 4700-EXIT                   
              IF WS-PTE-PRPTY-BYPASS = 'Y'                                      
                 PERFORM 4400-PROC-BR10K080    THRU 4400-EXIT                   
              ELSE                                                              
                 MOVE '2'                      TO WS-PTE-RES-OWNER              
                 MOVE 'Y'                      TO WS-IS-OWNER                   
                 MOVE 'PRIVATE PROPERTY OWNER' TO WS-REJ-REMARK                 
              END-IF                                                            
           END-IF                                                               
           PERFORM 4200-READ-BR10K010          THRU 4200-EXIT                   
           .                                                                    
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       4400-PROC-BR10K080.                                                      
      *********************                                                     
           MOVE SPACES                   TO BR10K080-REC                        
           INITIALIZE BR10K080-REC                                              
           MOVE LOW-VALUES               TO K080-KEY-FLD                        
           MOVE 'N'                      TO WS-EOF-K080                         
           MOVE FIN1-NUM-NRIC            TO K080-NUM-UIN                        
                                                                                
           START BR10K080 KEY >= K080-NUM-UIN                                   
                                                                                
           EVALUATE K080-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              PERFORM 4500-READ-BR10K080       THRU 4500-EXIT                   
              IF K080-NUM-UIN = FIN1-NUM-NRIC                                   
                 PERFORM 4600-PROC-BR10K080-DTL   THRU 4600-EXIT                
                    UNTIL K080-NUM-UIN NOT = FIN1-NUM-NRIC OR                   
                          WS-EOF-K080 = 'Y' OR WS-IS-OWNER = 'Y'                
              ELSE                                                              
                 MOVE 'Y'                   TO WS-EOF-K080                      
                 MOVE 'N'                   TO WS-IS-OWNER                      
                 MOVE '3'                   TO WS-PTE-RES-OWNER                 
              END-IF                                                            
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE 'Y'                   TO WS-EOF-K080                         
              MOVE 'N'                   TO WS-IS-OWNER                         
              MOVE '3'                   TO WS-PTE-RES-OWNER                    
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E19: BR10K080 READING ERROR.'                   
              DISPLAY 'K080-STATUS : ' K080-FILE-STATUS                         
              DISPLAY 'NRIC        : ' FIN1-NUM-NRIC                            
              PERFORM 9998-CLOSE-FILE    THRU 9998-EXIT                         
              PERFORM 9999-CANCEL-JOB    THRU 9999-EXIT                         
           END-EVALUATE                                                         
           .                                                                    
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       4500-READ-BR10K080.                                                      
      *********************                                                     
           READ BR10K080 NEXT RECORD                                            
              AT END MOVE 'Y' TO WS-EOF-K080.                                   
                                                                                
           EVALUATE K080-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              CONTINUE                                                          
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE 'Y'                   TO WS-EOF-K080                         
              MOVE 'N'                   TO WS-IS-OWNER                         
              MOVE '3'                   TO WS-PTE-RES-OWNER                    
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E20: BR10K080 READING ERROR.'                   
              DISPLAY 'K080-STATUS : ' K080-FILE-STATUS                         
              DISPLAY 'NRIC        : ' FIN1-NUM-NRIC                            
              PERFORM 9998-CLOSE-FILE    THRU 9998-EXIT                         
              PERFORM 9999-CANCEL-JOB    THRU 9999-EXIT                         
           END-EVALUATE                                                         
           .                                                                    
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************                                                 
       4600-PROC-BR10K080-DTL.                                                  
      *************************                                                 
           MOVE 0                           TO WS-FROM-DATE                     
           IF K080-NUM-UIN = FIN1-NUM-NRIC AND                                  
              K080-CDE-PPTY-TYPE(1:1) = 'R'                                     
              IF (K080-DTE-DISPOSAL NOT = SPACES AND ZEROES AND                 
                                         '00010101') AND                        
                 (WS-FIN1-DTE-HFE-APPLN NOT = SPACES AND ZEROES AND             
                                         '00010101')                            
                 INITIALIZE P13CARMWR                                           
                 MOVE WS-FIN1-DTE-HFE-APPLN       TO CARM-DATE-IN               
                 MOVE 'S'                         TO CARM-OPR-CODE              
                 MOVE 000                         TO CARM-NO-OF-DAY             
                 MOVE 30                          TO CARM-NO-OF-MONTH           
                 MOVE 00                          TO CARM-NO-OF-YEAR            
                 CALL 'BP13CARM' USING P13CARMWR                                
                 IF CARM-RETURN-CODE = '00'                                     
                    MOVE CARM-DATE-OUT            TO WS-FROM-DATE               
                    PERFORM 4650-CHK-DTE-DISPOSAL THRU 4650-EXIT                
                 ELSE                                                           
                    MOVE 'Y'                      TO WS-IS-OWNER                
                    MOVE '7'                      TO WS-PTE-RES-OWNER           
                    MOVE 'HFE DATE ERROR'         TO WS-REJ-REMARK              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           PERFORM 4500-READ-BR10K080       THRU 4500-EXIT                      
           .                                                                    
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       4650-CHK-DTE-DISPOSAL.                                                   
      ************************                                                  
           IF K080-DTE-DISPOSAL <= WS-FROM-DATE                                 
              MOVE 'Y'                            TO WS-IS-OWNER                
              MOVE '4'                            TO WS-PTE-RES-OWNER           
              MOVE 'PRIVATE PROPERTY OWNER'       TO WS-REJ-REMARK              
           ELSE                                                                 
              IF K080-DTE-DISPOSAL > WS-FROM-DATE AND                           
                 K080-DTE-DISPOSAL <= WS-FIN1-DTE-HFE-APPLN                     
                 PERFORM 4700-CHK-PTE-PROP-BYPASS THRU 4700-EXIT                
                 IF WS-PTE-PRPTY-BYPASS = 'Y'                                   
                    MOVE 'N'                      TO WS-IS-OWNER                
                    MOVE '5'                      TO WS-PTE-RES-OWNER           
                 ELSE                                                           
                    MOVE 'Y'                      TO WS-IS-OWNER                
                    MOVE '6'                      TO WS-PTE-RES-OWNER           
                    MOVE 'PRIVATE PROPERTY OWNER' TO WS-REJ-REMARK              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           .                                                                    
       4650-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************                                               
       4700-CHK-PTE-PROP-BYPASS.                                                
      ***************************                                               
           PERFORM 6100-OPEN-CURSOR     THRU 6100-EXIT                          
           PERFORM 6200-FETCH-CURSOR    THRU 6200-EXIT                          
                   UNTIL WS-CURSOR3-EOF = 'Y'                                   
           PERFORM 6300-CLOSE-CURSOR    THRU 6300-EXIT                          
           .                                                                    
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************************                                               
       5000-GET-HDB-REF-BY-NRIC.                                                
      ***************************                                               
           MOVE 'N'                        TO WS-MAIN-LESSEE                    
           PERFORM 5100-OPEN-CURSOR     THRU 5100-EXIT                          
           PERFORM 5200-FETCH-CURSOR    THRU 5200-EXIT                          
                   UNTIL WS-CURSOR1-EOF = 'Y'                                   
           PERFORM 5300-CLOSE-CURSOR    THRU 5300-EXIT                          
           .                                                                    
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************                                                       
       5100-OPEN-CURSOR.                                                        
      *******************                                                       
           MOVE 'N'                  TO WS-CURSOR1-EOF                          
           MOVE SPACES               TO WS-NUM-SCHEME                           
                                        WS-NUM-ACNT                             
                                        WS-NUM-TNCY                             
           MOVE FIN1-NUM-NRIC        TO NUM-IDNTY-NO OF DCLIDNTY-NO             
                                                                                
           EXEC SQL                                                             
             DECLARE CURSOR-1 CURSOR FOR                                        
               SELECT T4.NUM_SCHEME,                                            
                      T4.NUM_ACNT,                                              
                      T4.NUM_TNCY                                               
               FROM                                                             
                  IDNTY_NO   T1,                                                
                  CSTMR_ID   T2,                                                
                  PERSONS    T3,                                                
                  RSDNT      T4,                                                
                  RSDNT_ROLE T5                                                 
               WHERE                                                            
                  T1.NUM_CSTMR        = T2.NUM_CSTMR        AND                 
                  T2.NUM_CSTMR        = T3.NUM_CSTMR        AND                 
                  T2.NUM_CSTMR_SOURCE = T4.NUM_CSTMR_SOURCE AND                 
                  T5.NUM_CSTMR_SOURCE = T4.NUM_CSTMR_SOURCE AND                 
                  T5.DTE_ROLE_END     = '0001-01-01'        AND                 
                  T1.NUM_IDNTY_NO     = :DCLIDNTY-NO.NUM-IDNTY-NO               
               WITH UR                                                          
           END-EXEC.                                                            
                                                                                
      *******************                                                       
      *  OPEN CURSOR -                                                          
      *******************                                                       
           EXEC SQL                                                             
              OPEN CURSOR-1                                                     
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
              CONTINUE                                                          
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E21: DB2 ERROR OPEN CURSOR-1'                   
              DISPLAY 'SQLCODE : ' SQLCODE                                      
              PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                         
           END-EVALUATE.                                                        
           .                                                                    
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       5200-FETCH-CURSOR.                                                       
      ********************                                                      
           EXEC SQL                                                             
              FETCH CURSOR-1                                                    
              INTO :WS-NUM-SCHEME,                                              
                   :WS-NUM-ACNT,                                                
                   :WS-NUM-TNCY                                                 
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
                MOVE WS-NUM-SCHEME         TO WS-CURR-SCHEME                    
                MOVE WS-NUM-ACNT           TO WS-CURR-ACNT                      
                MOVE WS-NUM-TNCY           TO WS-CURR-TNCY                      
                PERFORM 5250-INIT-CURR-FLAT-LESSEE THRU 5250-EXIT               
                PERFORM 5500-FLAT-PERSON-BY-REF THRU 5500-EXIT                  
           WHEN 100                                                             
                MOVE 'Y'                   TO WS-CURSOR1-EOF                    
           WHEN OTHER                                                           
                DISPLAY 'BP13CM25-E22: DB2 ERROR FETCH CURSOR-1'                
                DISPLAY 'SQLCODE : ' SQLCODE                                    
                PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                       
           END-EVALUATE                                                         
           .                                                                    
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       5300-CLOSE-CURSOR.                                                       
      ********************                                                      
           EXEC SQL                                                             
              CLOSE CURSOR-1                                                    
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
                CONTINUE                                                        
           WHEN OTHER                                                           
                DISPLAY 'BP13CM25-E23: DB2 ERROR CLOSING CURSOR-1'              
                DISPLAY 'SQLCODE : ' SQLCODE                                    
                PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                       
           END-EVALUATE                                                         
           .                                                                    
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************                                                
       5400-CURR-FLAT-OWNR-ELG.                                                 
      **************************                                                
      *LESSEE OWN FLAT WITH CO-LESSEE SPOUSE.                                   
                                                                                
           IF WS-MAIN-LESSEE = 'Y'                                              
              IF WS-CURR-FLAT-OWNERSHIP = SPACE AND                             
                 FIN1-NUM-NRIC          = WS-LS-NUM-IDNTY-NO AND                
                 WS-LS-NUM-MRTL-STATUS  = 'M' AND                               
                 WS-COL-SPS-FND         = 'Y'                                   
                 MOVE 'Y'                   TO WS-IS-OWNER                      
                 MOVE '2'                   TO WS-CURR-FLAT-OWNERSHIP           
                 MOVE 'CURRENT FLAT OWNER' TO WS-REJ-REMARK                     
              ELSE                                                              
                 IF FIN1-NUM-NRIC         = WS-LS-NUM-IDNTY-NO AND              
                    WS-LS-NUM-MRTL-STATUS = 'S' AND                             
                    WS-COL-SPS-FND        = 'N' AND                             
                    WS-COL-PGP-FND        = 'Y'                                 
                    MOVE 'N'                TO WS-IS-OWNER                      
                    MOVE '3'                TO WS-CURR-FLAT-OWNERSHIP           
                 ELSE                                                           
                    MOVE 'Y'                TO WS-IS-OWNER                      
                    MOVE '4'                TO WS-CURR-FLAT-OWNERSHIP           
                    MOVE 'CURRENT FLAT OWNER' TO WS-REJ-REMARK                  
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF WS-CURR-FLAT-OWNERSHIP = SPACE                                 
                 IF FIN1-NUM-NRIC NOT = WS-LS-NUM-IDNTY-NO                      
                    IF WS-SINGLE-SDGSD = 'Y'                                    
                       MOVE 'N'           TO WS-IS-OWNER                        
                       MOVE '5'           TO WS-CURR-FLAT-OWNERSHIP             
                    ELSE                                                        
                       MOVE 'Y'           TO WS-IS-OWNER                        
                       MOVE '6'           TO WS-CURR-FLAT-OWNERSHIP             
                       MOVE 'CURRENT FLAT OWNER' TO WS-REJ-REMARK               
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
           .                                                                    
       5400-EXIT.                                                               
           EXIT.                                                                
      *****************************                                             
       5250-INIT-CURR-FLAT-LESSEE.                                              
      *****************************                                             
           MOVE 'N'              TO WS-LS-FND                                   
                                    WS-MAIN-LESSEE                              
                                    WS-COL-SPS-FND                              
                                    WS-COL-PGP-FND                              
                                    WS-SINGLE-SDGSD                             
           MOVE SPACE            TO WS-LS-SCHEME                                
                                    WS-LS-NUM-ACNT                              
                                    WS-LS-NUM-TNCY                              
                                    WS-LS-NUM-IDNTY-NO                          
                                    WS-LS-NUM-IDNTY-NO-TYPE                     
                                    WS-LS-NUM-ROLE                              
                                    WS-LS-NUM-RLTNSP                            
                                    WS-LS-NUM-MRTL-STATUS                       
                                    WS-COL-SPS-SCHEME                           
                                    WS-COL-SPS-NUM-ACNT                         
                                    WS-COL-SPS-NUM-TNCY                         
                                    WS-COL-SPS-NUM-IDNTY-NO                     
                                    WS-COL-SPS-NUM-IDNTY-NO-TYPE                
                                    WS-COL-SPS-NUM-ROLE                         
                                    WS-COL-SPS-NUM-RLTNSP                       
                                    WS-COL-SPS-NUM-MRTL-STATUS                  
                                    WS-COL-PGP-SCHEME                           
                                    WS-COL-PGP-NUM-ACNT                         
                                    WS-COL-PGP-NUM-TNCY                         
                                    WS-COL-PGP-NUM-IDNTY-NO                     
                                    WS-COL-PGP-NUM-IDNTY-NO-TYPE                
                                    WS-COL-PGP-NUM-ROLE                         
                                    WS-COL-PGP-NUM-RLTNSP                       
                                    WS-COL-PGP-NUM-MRTL-STATUS                  
                                                                                
           MOVE 0               TO WS-I                                         
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 4                      
              ADD  1            TO WS-I                                         
              MOVE SPACES       TO WS-COL-SDGSD-SCHEME(WS-I)                    
                                   WS-COL-SDGSD-NUM-ACNT(WS-I)                  
                                   WS-COL-SDGSD-NUM-TNCY(WS-I)                  
                                   WS-COL-SDGSD-NUM-IDNTY-NO(WS-I)              
                                   WS-COL-SDGSD-NUM-IDNTY-NO-TYPE(WS-I)         
                                   WS-COL-SDGSD-NUM-ROLE(WS-I)                  
                                   WS-COL-SDGSD-NUM-RLTNSP(WS-I)                
                                   WS-COL-SDGSD-NUM-MRTL-STATUS(WS-I)           
              MOVE 'N'          TO WS-COL-SDGSD-FND(WS-I)                       
           END-PERFORM                                                          
           .                                                                    
       5250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************                                                
       5500-FLAT-PERSON-BY-REF.                                                 
      **************************                                                
           PERFORM 5600-OPEN-CURSOR     THRU 5600-EXIT                          
           PERFORM 5700-FETCH-CURSOR    THRU 5700-EXIT                          
                   UNTIL WS-CURSOR2-EOF = 'Y'                                   
           PERFORM 5800-CLOSE-CURSOR    THRU 5800-EXIT                          
           IF WS-FLAT-FOUND = 'Y' AND WS-IS-OWNER = 'N'                         
              PERFORM 5400-CURR-FLAT-OWNR-ELG THRU 5400-EXIT                    
           END-IF                                                               
           .                                                                    
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************                                                       
       5600-OPEN-CURSOR.                                                        
      *******************                                                       
           MOVE 'N'                    TO WS-CURSOR2-EOF                        
           MOVE WS-NUM-SCHEME          TO NUM-SCHEME OF DCLRSDNT-ROLE           
           MOVE WS-NUM-ACNT            TO NUM-ACNT OF DCLRSDNT-ROLE             
           MOVE WS-NUM-TNCY            TO NUM-TNCY OF DCLRSDNT-ROLE             
                                                                                
           EXEC SQL                                                             
             DECLARE CURSOR-2 CURSOR FOR                                        
               SELECT T3.NUM_SCHEME,                                            
                      T3.NUM_ACNT,                                              
                      T3.NUM_TNCY,                                              
                      T1.NUM_IDNTY_NO,                                          
                      T1.NUM_IDNTY_NO_TYPE,                                     
                      T3.NUM_ROLE,                                              
                      T4.NUM_RLTNSP,                                            
                      T5.NUM_MRTL_STATUS                                        
               FROM                                                             
                  IDNTY_NO   T1,                                                
                  CSTMR_ID   T2,                                                
                  RSDNT_ROLE T3,                                                
                  RSDNT      T4,                                                
                  PERSONS    T5                                                 
               WHERE                                                            
                  T4.NUM_SCHEME = T3.NUM_SCHEME AND                             
                  T4.NUM_ACNT   = T3.NUM_ACNT   AND                             
                  T4.NUM_TNCY   = T3.NUM_TNCY   AND                             
                  T4.NUM_CSTMR_SOURCE = T3.NUM_CSTMR_SOURCE AND                 
                  T3.NUM_CSTMR_SOURCE = T2.NUM_CSTMR_SOURCE AND                 
                  T3.DTE_ROLE_END     = '0001-01-01'        AND                 
                  T5.NUM_CSTMR        = T1.NUM_CSTMR        AND                 
                  T2.NUM_CSTMR        = T1.NUM_CSTMR        AND                 
                  T3.NUM_SCHEME       = :DCLRSDNT-ROLE.NUM-SCHEME AND           
                  T3.NUM_ACNT         = :DCLRSDNT-ROLE.NUM-ACNT AND             
                  T3.NUM_TNCY         = :DCLRSDNT-ROLE.NUM-TNCY                 
               WITH UR                                                          
           END-EXEC.                                                            
                                                                                
      *******************                                                       
      *  OPEN CURSOR -                                                          
      *******************                                                       
           EXEC SQL                                                             
              OPEN CURSOR-2                                                     
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
              CONTINUE                                                          
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E24: DB2 ERROR OPEN CURSOR-2'                   
              DISPLAY 'SQLCODE : ' SQLCODE                                      
              DISPLAY 'NRIC    : ' FIN1-NUM-NRIC                                
              DISPLAY 'SCHEME  : ' WS-NUM-SCHEME 'ACNT: ' WS-NUM-ACNT           
      -               ' TNCY   : ' WS-NUM-TNCY                                  
              PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                         
           END-EVALUATE                                                         
           .                                                                    
       5600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       5700-FETCH-CURSOR.                                                       
      ********************                                                      
           EXEC SQL                                                             
              FETCH CURSOR-2                                                    
              INTO :WS-NUM-SCHEME1,                                             
                   :WS-NUM-ACNT1,                                               
                   :WS-NUM-TNCY1,                                               
                   :WS-NUM-IDNTY-NO,                                            
                   :WS-NUM-IDNTY-NO-TYPE,                                       
                   :WS-NUM-ROLE,                                                
                   :WS-NUM-RLTNSP,                                              
                   :WS-NUM-MRTL-STATUS                                          
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
              IF WS-NUM-SCHEME1 = WS-CURR-SCHEME AND                            
                 WS-NUM-ACNT1   = WS-CURR-ACNT   AND                            
                 WS-NUM-TNCY1   = WS-CURR-TNCY                                  
                 PERFORM 5900-POP-CURR-FLAT-LESSEE THRU 5900-EXIT               
              END-IF                                                            
           WHEN 100                                                             
              MOVE 'Y'                       TO WS-CURSOR2-EOF                  
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E25: DB2 ERROR FETCH CURSOR-2'                  
              DISPLAY 'SQLCODE : ' SQLCODE                                      
              DISPLAY 'NRIC    : ' FIN1-NUM-NRIC                                
              DISPLAY 'SCHEME  : ' WS-NUM-SCHEME 'ACNT: ' WS-NUM-ACNT           
      -               ' TNCY   : ' WS-NUM-TNCY                                  
              PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                         
           END-EVALUATE                                                         
           .                                                                    
       5700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       5800-CLOSE-CURSOR.                                                       
      ********************                                                      
           EXEC SQL                                                             
              CLOSE CURSOR-2                                                    
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
                CONTINUE                                                        
           WHEN OTHER                                                           
                DISPLAY 'BP13CM25-E26: DB2 ERROR CLOSING CURSOR-2'              
                DISPLAY 'SQLCODE : ' SQLCODE                                    
                PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                       
           END-EVALUATE                                                         
           .                                                                    
       5800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************                                              
       5900-POP-CURR-FLAT-LESSEE.                                               
      ****************************                                              
           EVALUATE WS-NUM-ROLE                                                 
      ***MAIN LESSEE                                                            
           WHEN '023'                                                           
              IF FIN1-NUM-NRIC = WS-NUM-IDNTY-NO                                
                 MOVE 'Y'                  TO WS-MAIN-LESSEE                    
                 MOVE 'Y'                  TO WS-FLAT-FOUND                     
                 MOVE 'Y'                  TO WS-LS-FND                         
                 MOVE WS-NUM-SCHEME        TO WS-LS-SCHEME                      
                 MOVE WS-NUM-ACNT          TO WS-LS-NUM-ACNT                    
                 MOVE WS-NUM-TNCY          TO WS-LS-NUM-TNCY                    
                 MOVE WS-NUM-IDNTY-NO      TO WS-LS-NUM-IDNTY-NO                
                 MOVE WS-NUM-IDNTY-NO-TYPE TO WS-LS-NUM-IDNTY-NO-TYPE           
                 MOVE WS-NUM-ROLE          TO WS-LS-NUM-ROLE                    
                 MOVE WS-NUM-RLTNSP        TO WS-LS-NUM-RLTNSP                  
                 MOVE WS-NUM-MRTL-STATUS   TO WS-LS-NUM-MRTL-STATUS             
              END-IF                                                            
                                                                                
                                                                                
      ***CO-LESSEES                                                             
           WHEN '024'                                                           
              IF FIN1-NUM-NRIC = WS-NUM-IDNTY-NO                                
                 MOVE 'N'                    TO WS-MAIN-LESSEE                  
                 MOVE 'Y'                    TO WS-FLAT-FOUND                   
              END-IF                                                            
                                                                                
              EVALUATE WS-NUM-RLTNSP                                            
      ***SPOUSE                                                                 
                 WHEN '20'                                                      
                    IF WS-COL-SPS-FND = 'N'                                     
                       MOVE 'Y'                  TO WS-COL-SPS-FND              
                       MOVE WS-NUM-SCHEME        TO                             
                                         WS-COL-SPS-SCHEME                      
                       MOVE WS-NUM-ACNT          TO                             
                                         WS-COL-SPS-NUM-ACNT                    
                       MOVE WS-NUM-TNCY          TO                             
                                         WS-COL-SPS-NUM-TNCY                    
                       MOVE WS-NUM-IDNTY-NO      TO                             
                                         WS-COL-SPS-NUM-IDNTY-NO                
                       MOVE WS-NUM-IDNTY-NO-TYPE TO                             
                                         WS-COL-SPS-NUM-IDNTY-NO-TYPE           
                       MOVE WS-NUM-ROLE          TO                             
                                         WS-COL-SPS-NUM-ROLE                    
                       MOVE WS-NUM-RLTNSP        TO                             
                                         WS-COL-SPS-NUM-RLTNSP                  
                       MOVE WS-NUM-MRTL-STATUS   TO                             
                                         WS-COL-SPS-NUM-MRTL-STATUS             
                    END-IF                                                      
      ***SON OR DAUGHTER                                                        
                 WHEN '40'                                                      
                 WHEN '42'                                                      
                    IF WS-X < 4                                                 
                       ADD 1                 TO WS-X                            
                       MOVE 'Y'              TO WS-COL-SDGSD-FND(WS-X)          
                       MOVE WS-NUM-SCHEME    TO                                 
                                  WS-COL-SDGSD-SCHEME(WS-X)                     
                       MOVE WS-NUM-ACNT      TO                                 
                                  WS-COL-SDGSD-NUM-ACNT(WS-X)                   
                       MOVE WS-NUM-TNCY      TO                                 
                                  WS-COL-SDGSD-NUM-TNCY(WS-X)                   
                       MOVE WS-NUM-IDNTY-NO  TO                                 
                                  WS-COL-SDGSD-NUM-IDNTY-NO(WS-X)               
                       MOVE WS-NUM-IDNTY-NO-TYPE TO                             
                                  WS-COL-SDGSD-NUM-IDNTY-NO-TYPE(WS-X)          
                       MOVE WS-NUM-ROLE          TO                             
                                  WS-COL-SDGSD-NUM-ROLE(WS-X)                   
                       MOVE WS-NUM-RLTNSP        TO                             
                                  WS-COL-SDGSD-NUM-RLTNSP(WS-X)                 
                       MOVE WS-NUM-MRTL-STATUS   TO                             
                                  WS-COL-SDGSD-NUM-MRTL-STATUS(WS-X)            
                    END-IF                                                      
                                                                                
                    IF FIN1-NUM-NRIC = WS-NUM-IDNTY-NO AND                      
                       WS-NUM-MRTL-STATUS = 'S'                                 
                       MOVE 'Y'                  TO WS-SINGLE-SDGSD             
                    END-IF                                                      
                                                                                
      ***PARENT, PARENT-IN-LAW, GRAND PARENT                                    
                 WHEN '01'                                                      
                 WHEN '02'                                                      
                    IF WS-COL-PGP-FND = 'N'                                     
                       MOVE 'Y'                  TO WS-COL-PGP-FND              
                       MOVE WS-NUM-SCHEME        TO                             
                                         WS-COL-PGP-SCHEME                      
                       MOVE WS-NUM-ACNT          TO                             
                                         WS-COL-PGP-NUM-ACNT                    
                       MOVE WS-NUM-TNCY          TO                             
                                         WS-COL-PGP-NUM-TNCY                    
                       MOVE WS-NUM-IDNTY-NO      TO                             
                                         WS-COL-PGP-NUM-IDNTY-NO                
                       MOVE WS-NUM-IDNTY-NO-TYPE TO                             
                                         WS-COL-PGP-NUM-IDNTY-NO-TYPE           
                       MOVE WS-NUM-ROLE          TO                             
                                         WS-COL-PGP-NUM-ROLE                    
                       MOVE WS-NUM-RLTNSP        TO                             
                                         WS-COL-PGP-NUM-RLTNSP                  
                       MOVE WS-NUM-MRTL-STATUS   TO                             
                                         WS-COL-PGP-NUM-MRTL-STATUS             
                    END-IF                                                      
              END-EVALUATE                                                      
           END-EVALUATE                                                         
           .                                                                    
       5900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************************                                          
       6000-DTRMNE-SURRNDER-FLAT-ONR.                                           
      ********************************                                          
           MOVE 'N'                    TO WS-SURRENDER-FLAG                     
           MOVE LOW-VALUES             TO K100-KEY-FLD                          
           MOVE 'N'                    TO WS-EOF-K100                           
           MOVE FIN1-NUM-NRIC          TO K100-NUM-UIN                          
                                                                                
           START BR05K100 KEY >= K100-NUM-UIN                                   
                                                                                
           EVALUATE K100-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              PERFORM 6020-READ-BR05K100   THRU 6020-EXIT                       
              IF K100-NUM-UIN = FIN1-NUM-NRIC                                   
                 PERFORM 6030-PROC-BR05K100   THRU 6030-EXIT                    
                    UNTIL WS-EOF-K100 = 'Y' OR WS-SURRENDER-FLAG = 'Y'          
                    OR K100-NUM-UIN NOT = FIN1-NUM-NRIC                         
              ELSE                                                              
                 MOVE '4'                      TO WS-CDE-SURRENDER              
                 MOVE 'Y'                      TO WS-EOF-K100                   
                 MOVE 'N'                      TO WS-IS-OWNER                   
              END-IF                                                            
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE '4'                          TO WS-CDE-SURRENDER             
              MOVE 'Y'                          TO WS-EOF-K100                  
              MOVE 'N'                          TO WS-IS-OWNER                  
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E27: BR05K100 READING ERROR.'                   
              DISPLAY 'K100-STATUS : ' K100-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************                                            
       6010-DTRMNE-TRNSFR-FLAT-ONR.                                             
      ******************************                                            
           MOVE 'N'                   TO WS-TRANSFER-FLAG                       
           MOVE LOW-VALUES            TO K500-KEY-FLD                           
           MOVE LOW-VALUES            TO K510-KEY-FLD                           
           MOVE 'N'                   TO WS-EOF-K510                            
           MOVE FIN1-NUM-NRIC         TO K510-NUM-UIN                           
                                                                                
           START BB13K510 KEY >= K510-NUM-UIN                                   
                                                                                
           EVALUATE K510-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              PERFORM 6040-READ-BB13K510   THRU 6040-EXIT                       
              IF K510-NUM-UIN = FIN1-NUM-NRIC                                   
                 PERFORM 6050-PROC-BB13K510   THRU 6050-EXIT                    
                    UNTIL WS-EOF-K510 = 'Y' OR WS-TRANSFER-FLAG = 'Y'           
                    OR K510-NUM-UIN NOT = FIN1-NUM-NRIC                         
              ELSE                                                              
                 MOVE '3'                    TO WS-CDE-TRANSFER                 
                 MOVE 'Y'                    TO WS-EOF-K510                     
                 MOVE 'N'                    TO WS-IS-OWNER                     
              END-IF                                                            
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE '3'                       TO WS-CDE-TRANSFER                 
              MOVE 'Y'                       TO WS-EOF-K510                     
              MOVE 'N'                       TO WS-IS-OWNER                     
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E28: BB13K510 READING ERROR.'                   
              DISPLAY 'K510-STATUS : ' K510-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       6010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       6020-READ-BR05K100.                                                      
      *********************                                                     
           READ BR05K100 NEXT RECORD                                            
              AT END MOVE 'Y' TO WS-EOF-K100.                                   
                                                                                
           EVALUATE K100-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              CONTINUE                                                          
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE '4'                          TO WS-CDE-SURRENDER             
              MOVE 'Y'                          TO WS-EOF-K100                  
              MOVE 'N'                          TO WS-IS-OWNER                  
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E29: BR05K100 READING ERROR.'                   
              DISPLAY 'K100-STATUS : ' K100-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       6020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       6030-PROC-BR05K100.                                                      
      *********************                                                     
           IF K100-NUM-SRNDR = 'SU' AND                                         
              (K100-DTE-COMPLETION NOT = SPACES AND ZEROES AND                  
                                         '00010101')                            
              MOVE '2'                 TO WS-CDE-SURRENDER                      
              MOVE 'Y'                 TO WS-IS-OWNER                           
              MOVE 'Y'                 TO WS-SURRENDER-FLAG                     
           ELSE                                                                 
              IF K100-NUM-SRNDR = 'CI'AND                                       
                 (K100-DTE-FLAT-REVEST NOT = SPACES AND ZEROES AND              
                                         '00010101')                            
                 MOVE '3'              TO WS-CDE-SURRENDER                      
                 MOVE 'Y'              TO WS-IS-OWNER                           
                 MOVE 'Y'              TO WS-SURRENDER-FLAG                     
              END-IF                                                            
           END-IF                                                               
           PERFORM 6020-READ-BR05K100       THRU 6020-EXIT                      
           .                                                                    
       6030-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       6040-READ-BB13K510.                                                      
      *********************                                                     
                                                                                
           READ BB13K510 NEXT RECORD                                            
              AT END MOVE 'Y' TO WS-EOF-K510.                                   
                                                                                
           EVALUATE K510-FILE-STATUS                                            
           WHEN 00                                                              
           WHEN 02                                                              
              CONTINUE                                                          
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE '3'                          TO WS-CDE-TRANSFER              
              MOVE 'Y'                          TO WS-EOF-K510                  
              MOVE 'N'                          TO WS-IS-OWNER                  
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E30: BB13K510 READING ERROR.'                   
              DISPLAY 'K510-STATUS : ' K510-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       6040-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       6050-PROC-BB13K510.                                                      
      *********************                                                     
                                                                                
           IF K510-CDE-REC = 'S'                                                
              STRING K510-NUM-HDB-REF DELIMITED BY SIZE                         
                     K510-CDE-REC DELIMITED BY SIZE                             
                     INTO WS-K500-KEY-FLD                                       
              END-STRING                                                        
              MOVE WS-K500-KEY-FLD          TO K500-KEY-FLD                     
              PERFORM 6080-PROC-BB13K500    THRU 6080-EXIT                      
                 UNTIL WS-EOF-K500 = 'Y' OR WS-TRANSFER-FLAG = 'Y' OR           
                       WS-K500-KEY-FLD NOT = K500-KEY-FLD                       
           END-IF                                                               
           PERFORM 6040-READ-BB13K510       THRU 6040-EXIT                      
           .                                                                    
       6050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       6080-PROC-BB13K500.                                                      
      *********************                                                     
           READ BB13K500.                                                       
                                                                                
           EVALUATE K500-FILE-STATUS                                            
           WHEN 00                                                              
              IF WS-K500-KEY-FLD = K500-KEY-FLD                                 
                 IF K500-CDE-REC = 'S' AND                                      
                    (K500-DTE-LEGAL-DOC-SIGN NOT = SPACE AND ZEROES AND         
                                                   '00010101')                  
                    MOVE 'Y'                    TO WS-TRANSFER-FLAG             
                    MOVE 'Y'                    TO WS-IS-OWNER                  
                    MOVE '2'                    TO WS-CDE-TRANSFER              
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'E'                         TO WS-CDE-TRANSFER            
                 MOVE 'Y'                         TO WS-EOF-K500                
                 MOVE 'Y'                         TO WS-IS-OWNER                
                 MOVE 'TRANSFER DETAIL NOT FOUND' TO WS-REJ-REMARK              
              END-IF                                                            
           WHEN 10                                                              
           WHEN 23                                                              
              MOVE 'E'                          TO WS-CDE-TRANSFER              
              MOVE 'Y'                          TO WS-EOF-K500                  
              MOVE 'Y'                          TO WS-IS-OWNER                  
              MOVE 'TRANSFER DETAIL NOT FOUND'  TO WS-REJ-REMARK                
           WHEN OTHER                                                           
              DISPLAY 'BP13CM25-E31: BB13K500 READING ERROR.'                   
              DISPLAY 'K500-STATUS : ' K500-FILE-STATUS                         
              PERFORM 9998-CLOSE-FILE           THRU 9998-EXIT                  
              PERFORM 9999-CANCEL-JOB           THRU 9999-EXIT                  
           END-EVALUATE                                                         
           .                                                                    
       6080-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************                                                       
       6100-OPEN-CURSOR.                                                        
      *******************                                                       
           MOVE WS-FIN1-NUM-HFE TO NUM-ELGBTY-CASE OF                           
                                   DCLFLAT-ELGBTY-CASE-EXCPTN                   
                                                                                
           EXEC SQL                                                             
             DECLARE CURSOR-3 CURSOR FOR                                        
               SELECT A.NUM_APRVL_REF,                                          
                      A.NUM_ELGBTY_CASE,                                        
                      B.NUM_EXCPTN_REASON                                       
               FROM                                                             
                  FLAT_ELGBTY_CASE_EXCPTN A,                                    
                  FLAT_ELGBTY_CASE_EXCPTN_REASON B                              
               WHERE                                                            
                  A.NUM_APRVL_REF = B.NUM_APRVL_REF          AND                
                  (B.NUM_EXCPTN_REASON IN ('S006A','S006B')) AND                
                    A.NUM_ELGBTY_CASE =                                         
                           :DCLFLAT-ELGBTY-CASE-EXCPTN.NUM-ELGBTY-CASE          
               WITH UR                                                          
           END-EXEC.                                                            
                                                                                
      *******************                                                       
      *  OPEN CURSOR -                                                          
      *******************                                                       
           EXEC SQL                                                             
              OPEN CURSOR-3                                                     
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
                CONTINUE                                                        
           WHEN OTHER                                                           
                DISPLAY 'BP13CM25-E32: DB2 ERROR OPEN CURSOR-3'                 
                DISPLAY 'SQLCODE : ' SQLCODE                                    
                DISPLAY 'REGN    : ' FIN1-NUM-REGN                              
                DISPLAY 'HFEN    : ' WS-FIN1-NUM-HFE                            
                PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                       
           END-EVALUATE.                                                        
           .                                                                    
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       6200-FETCH-CURSOR.                                                       
      ********************                                                      
           EXEC SQL                                                             
              FETCH CURSOR-3                                                    
              INTO :WS-NUM-APRVL-REF,                                           
                   :WS-NUM-ELGBTY-CASE,                                         
                   :WS-NUM-EXCPTN-REASON                                        
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
                MOVE 'Y'                   TO WS-PTE-PRPTY-BYPASS               
           WHEN 100                                                             
                MOVE 'Y'                   TO WS-CURSOR3-EOF                    
           WHEN OTHER                                                           
                DISPLAY 'BP13CM25-E33: DB2 ERROR FETCH CURSOR-3'                
                DISPLAY 'SQLCODE : ' SQLCODE                                    
                DISPLAY 'REGN    : ' FIN1-NUM-REGN                              
                DISPLAY 'HFEN    : ' WS-FIN1-NUM-HFE                            
                PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                       
           END-EVALUATE                                                         
           .                                                                    
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       6300-CLOSE-CURSOR.                                                       
      ********************                                                      
           EXEC SQL                                                             
              CLOSE CURSOR-3                                                    
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
           WHEN 0                                                               
                CONTINUE                                                        
           WHEN OTHER                                                           
                DISPLAY 'BP13CM25-E34: DB2 ERROR CLOSING CURSOR-3'              
                DISPLAY 'SQLCODE : ' SQLCODE                                    
                DISPLAY 'REGN    : ' FIN1-NUM-REGN                              
                DISPLAY 'HFEN    : ' WS-FIN1-NUM-HFE                            
                PERFORM 9997-SQL-ERROR     THRU 9997-EXIT                       
           END-EVALUATE                                                         
           .                                                                    
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************                                                           
       6500-CTL-REC.                                                            
      ***************                                                           
           INITIALIZE FOT1-CTL-REC                                              
           INITIALIZE FOT2-CTL-REC                                              
           MOVE FIN1-CTL-DTE-BALLOT-QTR TO FOT1-CTL-DTE-BALLOT-QTR              
                                           FOT2-CTL-DTE-BALLOT-QTR              
           MOVE HIGH-VALUES             TO FOT1-CTL-HIGH-VAL                    
                                           FOT2-CTL-HIGH-VAL                    
           COMPUTE FOT1-RCD-CNT = WS-ACP-CNT                                    
           COMPUTE FOT2-RCD-CNT = WS-REJ-CNT                                    
           MOVE SPACES                  TO FOT1-CTL-FILLER                      
                                           FOT2-CTL-FILLER                      
           WRITE BP13FOT1-REC                                                   
           WRITE BP13FOT2-REC                                                   
           .                                                                    
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************                                                        
       7000-CTL-SUMMARY.                                                        
      ******************                                                        
           DISPLAY 'BP13CM25-I01: CONTROL SUMMARY'                              
           DISPLAY 'BP13FIN1 PROCESS DETAIL CNT :' WS-FIN1-CNT                  
           DISPLAY 'BP13FIN1 TYP1 RCD CNT       :' WS-FIN1-RCD1-CNT             
           DISPLAY 'BP13FIN1 TYP2 RCD CNT       :' WS-FIN1-RCD2-CNT             
           DISPLAY 'BP13FIN1 TYP2 BYPASS CNT    :' WS-TYP2-BYPASS-CNT           
           DISPLAY 'ACCEPTED CNT                :' WS-ACP-CNT                   
           DISPLAY 'REJECTED CNT                :' WS-REJ-CNT                   
           .                                                                    
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************                                                         
       8000-OUT-ACCEPT.                                                         
      *****************                                                         
           MOVE WS-FIN1-DTL-DTE-BALLOT-QTR TO FOT1-DTL-DTE-BALLOT-QTR           
           MOVE WS-FOT1-NUM-REGN           TO FOT1-NUM-REGN                     
           MOVE WS-FIN1-CDE-ELIG-SCH       TO FOT1-CDE-ELIG-SCH                 
           MOVE WS-FIN1-NUM-ALLO-CAT       TO FOT1-NUM-ALLO-CAT                 
           MOVE WS-FIN1-CDE-HOUSEHOLD      TO FOT1-CDE-HOUSEHOLD                
           MOVE WS-FIN1-NUM-FT2T           TO FOT1-NUM-FT2T                     
           MOVE WS-FIN1-DATE-REQUEST       TO FOT1-DTE-REQUEST                  
           MOVE WS-FIN1-NUM-HFE            TO FOT1-NUM-HFE                      
           MOVE WS-FIN1-DTE-HFE-APPLN      TO FOT1-DTE-HFE-APPLN                
           MOVE WS-FIN1-CDE-FAMILY-OUTCOME TO FOT1-CDE-FAMILY-OUTCOME           
           MOVE WS-CURR-FLAT-OWNERSHIP     TO FOT1-CDE-CURR-OWN                 
           MOVE WS-EX-FLAT-OWNERSHIP       TO FOT1-CDE-EX-FLAT-OWN              
           MOVE WS-PTE-RES-OWNER           TO FOT1-CDE-PTE-PROP-OWN             
           MOVE WS-CDE-SURRENDER           TO FOT1-CDE-SURRENDER                
           MOVE WS-CDE-TRANSFER            TO FOT1-CDE-TRANSFER                 
           MOVE WS-FIN1-CDE-CHANCE-OUTCOME TO FOT1-CDE-CHANCE-OUTCOME           
           MOVE WS-FIN1-REMARK             TO FOT1-REMARK                       
           MOVE SPACES                     TO FOT1-DTL-FILLER                   
           ADD  1                          TO WS-ACP-CNT                        
           WRITE BP13FOT1-REC                                                   
           .                                                                    
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************                                                         
       9000-OUT-REJECT.                                                         
      *****************                                                         
           MOVE SPACES                     TO FOT2-REMARK                       
           MOVE WS-FIN1-DTL-DTE-BALLOT-QTR TO FOT2-DTL-DTE-BALLOT-QTR           
           MOVE WS-FOT1-NUM-REGN           TO FOT2-NUM-REGN                     
           MOVE WS-FIN1-CDE-ELIG-SCH       TO FOT2-CDE-ELIG-SCH                 
           MOVE WS-FIN1-NUM-ALLO-CAT       TO FOT2-NUM-ALLO-CAT                 
           MOVE WS-FIN1-CDE-HOUSEHOLD      TO FOT2-CDE-HOUSEHOLD                
           MOVE WS-FIN1-NUM-FT2T           TO FOT2-NUM-FT2T                     
           MOVE WS-FIN1-DATE-REQUEST       TO FOT2-DTE-REQUEST                  
           MOVE WS-FIN1-NUM-HFE            TO FOT2-NUM-HFE                      
           MOVE WS-FIN1-DTE-HFE-APPLN      TO FOT2-DTE-HFE-APPLN                
           MOVE WS-FIN1-CDE-FAMILY-OUTCOME TO FOT2-CDE-FAMILY-OUTCOME           
           MOVE WS-CURR-FLAT-OWNERSHIP     TO FOT2-CDE-CURR-OWN                 
           MOVE WS-EX-FLAT-OWNERSHIP       TO FOT2-CDE-EX-FLAT-OWN              
           MOVE WS-PTE-RES-OWNER           TO FOT2-CDE-PTE-PROP-OWN             
           MOVE WS-CDE-SURRENDER           TO FOT2-CDE-SURRENDER                
           MOVE WS-CDE-TRANSFER            TO FOT2-CDE-TRANSFER                 
           MOVE WS-FIN1-CDE-CHANCE-OUTCOME TO FOT2-CDE-CHANCE-OUTCOME           
           MOVE WS-REJ-REMARK              TO FOT2-REMARK                       
           MOVE SPACES                     TO FOT2-DTL-FILLER                   
           ADD  1                          TO WS-REJ-CNT                        
           WRITE BP13FOT2-REC                                                   
           .                                                                    
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************                                                         
       9997-SQL-ERROR.                                                          
      *****************                                                         
           MOVE SQLCODE               TO WS-SQLCODE                             
           CALL 'DBATIAR' USING SQLCA                                           
           DISPLAY 'ABEND SQLCODE    : ' SQLCODE                                
           EXEC SQL ROLLBACK          END-EXEC                                  
           DISPLAY 'ROLLBACK SQLCODE : ' SQLCODE                                
           PERFORM 9998-CLOSE-FILE    THRU 9998-EXIT                            
           PERFORM 9999-CANCEL-JOB    THRU 9999-EXIT                            
           .                                                                    
       9997-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************                                                         
       9998-CLOSE-FILE.                                                         
      *****************                                                         
           CLOSE BP13FIN1 BB24K520 BB24K530 BR10K010 BR10K080                   
                 BP13FOT1 BP13FOT2 BB24K510 BB24K502                            
           .                                                                    
       9998-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************                                                        
       9999-CANCEL-JOB.                                                         
      ******************                                                        
           MOVE '111' TO RETURN-CODE                                            
           DISPLAY WS-ERR-MSG                                                   
           STOP RUN                                                             
           .                                                                    
       9999-EXIT.                                                               
           EXIT.                                                                
