      **************************                                        00010000
       IDENTIFICATION DIVISION.                                         00020000
      **************************                                        00030000
       PROGRAM-ID.    BP13CB0K.                                         00040000
      *AUTHOR.        MARGE LAM KO.                                     00050000
      *DATE-WRITTEN.  26 APR 2017.                                      00060000
                                                                        00070000
      * =========================================================== *   00080000
      * SYSTEM OF COMMITMENT (BP13)                                 *   00090000
      * =========================================================== *   00100000
      *   OBJECTIVE   : THIS PROGRAM RETRIEVES RECORDS FROM         *   00110000
      *                 BP13FD05 AND BP13K800 TO CREATE RECORDS TO  *   00120000
      *                 GRANT_ASMNT AND GRANT_ASMNT_PERSON          *   00130000
      *                 SO THAT THEY ARE SYNCHRONIZED               *   00140000
      *                 IF THERE IS RECOVERY, WRITE TO GRANT_RCVRY, *   00150000
      *                 EX_GRANT_ASMNT, EX_GRANT_ASMNT_PERSON INSTEAD   00160000
      *                                                             *   00170000
      *   INPUT FILES :                                             *   00180000
      *   1.  BP13FD05                                              *   00190000
      *   2.  BP13K800                                              *   00200000
      *   3.  BP13K820 - TO GET CSTMR SOURCE                        *   00210000
      *   4.  BP13K893 - IF NOT IN K800                             *   00220000
      *   5.  BP13K895 - TO GET CSTMR SOURCE (IF NOT IN K820)       *   00230000
      *                                                             *   00240000
      *                                                             *   00250000
      *   TABLES:                                                   *   00260000
      *   1.  GRANT_ASMNT                                           *   00270000
      *   2.  GRANT_ASMNT_PERSON                                    *   00280000
      *   3.  GRANT_RCVRY                                           *   00290000
      *   4.  EX_GRANT_ASMNT                                        *   00300000
      *   5.  EX_GRANT_ASMNT_PERSON                                 *   00310000
      *   6.  GRANT_UPDATE_LOG                                      *   00320000
      *                                                             *   00330000
      * CHQ REQ     DATE     BY  DESCRIPTIONS                       *   00340000
      * -------- ---------- ---- ---------------------------------- *   00350000
      * BP13     26/04/2017 MRN1 NEW PROGRAM                        *   00360000
      * BP138971 15/12/2021 KR13 CATER FOR NEW FIN SERIES 'M'       *   00361002
      * =========================================================== *   00370000
                                                                        00380000
       ENVIRONMENT DIVISION.                                            00390000
                                                                        00400000
       CONFIGURATION SECTION.                                           00410000
                                                                        00420000
       SOURCE-COMPUTER. IBM-3090.                                       00430000
       OBJECT-COMPUTER. IBM-3090.                                       00440000
                                                                        00450000
       INPUT-OUTPUT SECTION.                                            00460000
                                                                        00470000
       FILE-CONTROL.                                                    00480000
                                                                        00490000
           SELECT BP13FD05 ASSIGN TO BP13FD05.                          00500000
                                                                        00510000
           SELECT BP13K800 ASSIGN TO BP13K800                           00520000
                  ACCESS MODE     IS DYNAMIC                            00530000
                  ORGANIZATION    IS INDEXED                            00540000
                  RECORD KEY      IS K800-NUM-REGN                      00550000
                  FILE STATUS     IS WS-K800-STATUS.                    00560000
                                                                        00570000
           SELECT BP13K820 ASSIGN TO BP13K820                           00580000
                  ACCESS MODE     IS DYNAMIC                            00590000
                  ORGANIZATION    IS INDEXED                            00600000
                  RECORD KEY      IS K820-KEY-FLD                       00610000
                  FILE STATUS     IS WS-K820-STATUS.                    00620000
                                                                        00630000
           SELECT BP13K893 ASSIGN TO BP13K893                           00640000
                  ACCESS MODE     IS DYNAMIC                            00650000
                  ORGANIZATION    IS INDEXED                            00660000
                  RECORD KEY      IS K893-KEY-FLD                       00670000
                  FILE STATUS     IS WS-K893-STATUS.                    00680000
                                                                        00690000
           SELECT BP13K895 ASSIGN TO BP13K895                           00700000
                  ACCESS MODE     IS DYNAMIC                            00710000
                  ORGANIZATION    IS INDEXED                            00720000
                  RECORD KEY      IS K895-KEY-FLD                       00730000
                  FILE STATUS     IS WS-K895-STATUS.                    00740000
                                                                        00750000
       DATA DIVISION.                                                   00760000
                                                                        00770000
       FILE SECTION.                                                    00780000
                                                                        00790000
       FD   BP13FD05                                                    00800000
            RECORD CONTAINS 500 CHARACTERS                              00810000
            LABEL RECORDS ARE OMITTED                                   00820000
            RECORDING MODE IS F.                                        00830000
       COPY BP13KD05.                                                   00840000
                                                                        00850000
       FD   BP13K800                                                    00860000
            RECORD CONTAINS 2000 CHARACTERS.                            00870000
       COPY BP13K800.                                                   00880000
                                                                        00890000
       FD   BP13K820                                                    00900000
            RECORD IS VARYING IN SIZE FROM 01 TO 400.                   00910000
      *     RECORD CONTAINS 400 CHARACTERS.                             00920000
       COPY BP13K820.                                                   00930000
                                                                        00940000
       FD   BP13K893                                                    00950000
            RECORD CONTAINS 2050 CHARACTERS.                            00960000
       COPY BP13K893.                                                   00970000
                                                                        00980000
       FD  BP13K895                                                     00990000
           RECORD CONTAINS 450 CHARACTERS.                              01000000
       COPY BP13K895.                                                   01010000
                                                                        01020000
       COPY AV02COMM.                                                   01030000
                                                                        01040000
      *************************                                         01050000
       WORKING-STORAGE SECTION.                                         01060000
      *************************                                         01070000
                                                                        01080000
       01  WS-K800-STATUS         PIC 9(02) VALUE ZEROES.               01090000
       01  WS-K820-STATUS         PIC 9(02) VALUE ZEROES.               01100000
       01  WS-K893-STATUS         PIC 9(02) VALUE ZEROES.               01110000
       01  WS-K895-STATUS         PIC 9(02) VALUE ZEROES.               01120000
       01  WS-CTR                 PIC 9(02) VALUE ZEROES.               01130000
       01  WS-HGT-CTR             PIC 9(02) VALUE ZEROES.               01140000
       01  WS-TUG-CTR             PIC 9(02) VALUE ZEROES.               01150000
       01  WS-AHG-CTR             PIC 9(02) VALUE ZEROES.               01160000
       01  WS-SHG-CTR             PIC 9(02) VALUE ZEROES.               01170000
       01  WS-SUG-CTR             PIC 9(02) VALUE ZEROES.               01180000
       01  CNT-FD05-READ          PIC 9(06) VALUE ZEROES.               01190000
       01  WS-MATCH-REC           PIC 9(06) VALUE ZEROES.               01200000
       01  WS-NOT-CREATED         PIC 9(06) VALUE ZEROES.               01210000
       01  WS-CREATED             PIC 9(06) VALUE ZEROES.               01220000
       01  CNT-ASMNT-INSERT       PIC 9(06) VALUE ZEROES.               01230000
       01  CNT-PERSN-INSERT       PIC 9(06) VALUE ZEROES.               01240000
       01  CNT-EX-ASMNT-INS       PIC 9(06) VALUE ZEROES.               01250000
       01  CNT-EX-PERSN-INS       PIC 9(06) VALUE ZEROES.               01260000
       01  CNT-RCVRY-INSERT       PIC 9(06) VALUE ZEROES.               01270000
       01  WS-GRNT-UPD-LOG        PIC 9(06) VALUE ZEROES.               01280000
       01  WS-SNO1                PIC 9(06) VALUE ZEROES.               01290000
       01  WS-SNO2                PIC 9(06) VALUE ZEROES.               01300000
       01  WS-CNT-GRANT           PIC 9(06) VALUE ZEROES.               01310000
       01  WS-CNT-PERSON          PIC 9(06) VALUE ZEROES.               01320000
       01  WS-CNT-EXGRANT         PIC 9(06) VALUE ZEROES.               01330000
       01  WS-CNT-EXPERSON        PIC 9(06) VALUE ZEROES.               01340000
       01  WS-CNT-RCVRY           PIC 9(06) VALUE ZEROES.               01350000
       01  WS-EOF-FD05            PIC X     VALUE SPACE.                01360000
       01  WS-EOF-K828            PIC X(01) VALUE 'N'.                  01370000
       01  WS-EOF-K895            PIC X(01) VALUE 'N'.                  01380000
       01  WS-FND-K800            PIC X(01) VALUE 'N'.                  01390000
       01  WS-FND-K893            PIC X(01) VALUE 'N'.                  01400000
       01  WS-GRANT-ASMNT-FND     PIC X     VALUE SPACE.                01410000
       01  WS-GRANT-PRSN-FND      PIC X     VALUE SPACE.                01420000
       01  WS-PERSN-FND           PIC X     VALUE SPACE.                01430000
       01  WS-RCVRY-FND           PIC X     VALUE SPACE.                01440000
       01  WS-EX-GRANT-ASMNT-FND  PIC X     VALUE SPACE.                01450000
       01  WS-EX-GRANT-PRSN-FND   PIC X     VALUE SPACE.                01460000
       01  WS-GRANT-RCVRY-FND     PIC X     VALUE SPACE.                01470000
       01  WS-HGT-RCVRY           PIC X     VALUE SPACE.                01480000
       01  WS-AHG-RCVRY           PIC X     VALUE SPACE.                01490000
       01  WS-SHG-RCVRY           PIC X     VALUE SPACE.                01500000
       01  WS-SUG-RCVRY           PIC X     VALUE SPACE.                01510000
       01  WS-HGT                 PIC X     VALUE SPACE.                01520000
       01  WS-TUG                 PIC X     VALUE SPACE.                01530000
       01  WS-AHG                 PIC X     VALUE SPACE.                01540000
       01  WS-SHG                 PIC X     VALUE SPACE.                01550000
       01  WS-SUG                 PIC X     VALUE SPACE.                01560000
       01  WS-EX-INSERT           PIC X     VALUE SPACE.                01570000
       01  WS-DATE                PIC X(08) VALUE SPACES.               01580000
       01  WS-TIMESTAMP           PIC X(26) VALUE SPACES.               01590000
       01  WS-GRANT-TYPE          PIC X(3)  VALUE SPACES.               01600000
       01  WS-NUM-REGN            PIC X(8)  VALUE SPACES.               01610000
       01  WS-NUM-NRIC            PIC X(9)  VALUE SPACES.               01620000
       01  WS-PREV-REGN           PIC X(8)  VALUE SPACES.               01630000
       01  WS-SQLCODE             PIC ---9.                             01640000
       01  WS-RETURN-CODE         PIC 9(02) VALUE ZEROES.               01650000
       01  WS-C-SRC               PIC X(09) VALUE SPACES.               01660000
       01  WS-RECORD-COUNT        PIC S9(06) COMP VALUE ZEROES.         01670000
       01  WS-DTE-CCYYMMDD.                                             01680000
           05 WS-DTE-CCYY                   PIC X(04) VALUE SPACES.     01690000
           05 WS-DTE-MM                     PIC X(02) VALUE SPACES.     01700000
           05 WS-DTE-DD                     PIC X(02) VALUE SPACES.     01710000
       01  WS-TIME-HHMMSS.                                              01720000
           05 WS-TIME-HH                    PIC X(02) VALUE SPACES.     01730000
           05 WS-TIME-MM                    PIC X(02) VALUE SPACES.     01740000
           05 WS-TIME-SS                    PIC X(02) VALUE SPACES.     01750000
           05 WS-TIME-MS                    PIC X(02) VALUE SPACES.     01760000
                                                                        01770000
       01  WS-LOG-VARIABLE.                                             01780000
           05  WS-BEFORE-IMAGE        PIC X(600).                       01790000
           05  WS-AFTER-IMAGE         PIC X(600).                       01800000
           05  WS-SOURCE              PIC X(30).                        01810000
           05  WS-RGSTRN              PIC X(8).                         01820000
           05  WS-ACTION              PIC X(1).                         01830000
           05  WS-GRNT-TYPE           PIC X(6).                         01840000
           05  WS-TIMESTAMP-LOG       PIC X(26) VALUE SPACES.           01850000
                                                                        01860000
       01  WS-SQL-STATUS.                                               01870000
           05 WS-SQL-OK                PIC S9(03) VALUE +000.           01880000
           05 WS-SQL-NFND              PIC S9(03) VALUE +100.           01890000
           05 WS-SQL-DUPREC            PIC S9(03) VALUE -803.           01900000
           05 WS-SQL-MORE-ROWS         PIC S9(03) VALUE -811.           01910000
                                                                        01920000
       01  WS-K800-K893-FIELDS.                                         01930000
           05 WS-NUM-AHG                   PIC X(3).                    01940000
           05 WS-NUM-AHG-STATUS            PIC X(1).                    01950000
           05 WS-DTE-AHG-PROCESS           PIC X(8).                    01960000
           05 WS-DTE-NOAPPLY-AHG-PRT       PIC X(8).                    01970000
           05 WS-NUM-NOAHG-REASON          PIC X(3).                    01980000
           05 WS-DTE-NOAHG-REASON          PIC X(8).                    01990000
           05 WS-DTE-AHG-PAYMENT           PIC X(8).                    02000000
           05 WS-NUM-SHG                   PIC X(3).                    02010000
           05 WS-NUM-SHG-STATUS            PIC X(1).                    02020000
           05 WS-DTE-SHG-PROCESS           PIC X(8).                    02030000
           05 WS-DTE-NOAPPLY-SHG-PRT       PIC X(8).                    02040000
           05 WS-NUM-NOSHG-REASON          PIC X(3).                    02050000
           05 WS-DTE-NOSHG-REASON          PIC X(8).                    02060000
           05 WS-NUM-ALLO-SCHEME           PIC X(3).                    02070000
           05 WS-DTE-CPF-ACK-GRANT         PIC X(8).                    02080000
           05 WS-NUM-SCH                   PIC X(4).                    02090000
           05 WS-NUM-ACNT                  PIC X(5).                    02100000
           05 WS-NUM-LESSEE-CODE           PIC X(2).                    02110000
           05 WS-DTE-AHG-ACK               PIC X(8).                    02120000
           05 WS-DTE-AHG-REQ               PIC X(8).                    02130000
           05 WS-DTE-SHG-REQ               PIC X(8).                    02140000
           05 WS-DTE-AHG-FORM-PRT          PIC X(8).                    02150000
           05 WS-DTE-SHG-FORM-PRT          PIC X(8).                    02160000
           05 WS-NUM-AHG-WITHDRAW          PIC X(3).                    02170000
           05 WS-NUM-SHG-WITHDRAW          PIC X(3).                    02180000
           05 WS-NUM-AHG-DOC-REC           PIC X(1).                    02190000
           05 WS-CDE-CITIZENSHIP-HOUSEHOLD PIC X(3).                    02200000
           05 WS-NUM-GRANT-CREDIT-TAG      PIC X(1).                    02210000
           05 WS-NUM-AHG-REJECT            PIC X(3).                    02220000
           05 WS-NUM-SHG-REJECT            PIC X(3).                    02230000
                                                                        02240000
       01  AHG-RECORD.                                                  02250000
           05 AHG-REC OCCURS 4 TIMES.                                   02260000
              10 AHG-KEY-FLD.                                           02270000
                 15 AHG-NUM-REGN                 PIC X(8).              02280000
                 15 AHG-NUM-NRIC                 PIC X(9).              02290000
              10 FILLER                          PIC X(2).              02300000
              10 AHG-NUM-CPF                     PIC X(9).              02310000
              10 AHG-NME-OCCP                    PIC X(66).             02320000
              10 FILLER                          PIC X(1).              02330000
              10 AHG-NUM-AHG                     PIC X(1).              02340000
              10 AHG-AMT-INCOME-AHG              PIC 9(5).              02350000
              10 AHG-AMT-AHG-GRANT               PIC S9(5)V99.          02360000
              10 AHG-AMT-AHG-USED                PIC S9(5)V99.          02370000
              10 AHG-AMT-AHG-GRANT-RECOVER       PIC S9(5)V99.          02380000
              10 FILLER                          PIC X(9).              02390000
              10 AHG-AMT-HSGNT                   PIC S9(5)V99.          02400000
              10 AHG-AMT-HSGNT-USED              PIC S9(5)V99.          02410000
              10 AHG-AMT-HSGNT-RECOVER           PIC S9(5)V99.          02420000
              10 FILLER                          PIC X(8).              02430000
              10 AHG-AMT-HSGNT-TOPUP             PIC S9(5)V99.          02440000
              10 AHG-NUM-CITIZENSHIP             PIC X(2).              02450000
              10 AHG-NUM-RELATIONSHIP            PIC X(2).              02460000
              10 AHG-NUM-MARITAL-STATUS          PIC X(1).              02470000
              10 AHG-NUM-HA-TAG                  PIC X(1).              02480000
              10 AHG-NUM-AHG-DEBAR               PIC X(1).              02490000
              10 AHG-NUM-SEX                     PIC X(1).              02500000
              10 AHG-NUM-DEBAR-SCSPR             PIC X(2).              02510000
              10 FILLER                          PIC X(1).              02520000
              10 AHG-NUM-CHG-DEBAR               PIC X(1).              02530000
              10 FILLER                          PIC X(73).             02540000
              10 AHG-DTE-HSGNT-ABORTIVE          PIC X(8).              02550000
              10 AHG-AMT-AHG-RECOVER-INT         PIC S9(5)V99.          02560000
              10 AHG-AMT-AHG-RECOVER-USED        PIC S9(5)V99.          02570000
              10 AHG-NUM-TRANSFEROR              PIC X(1).              02580000
              10 FILLER                          PIC X(26).             02590000
              10 AHG-AMT-SHG-GRANT               PIC S9(5)V99.          02600000
              10 AHG-AMT-SHG-USED                PIC S9(5)V99.          02610000
              10 AHG-AMT-SHG-GRANT-RECOVER       PIC S9(5)V99.          02620000
              10 FILLER                          PIC X(8).              02630000
              10 AHG-AMT-SHG-TOPUP               PIC S9(5)V99.          02640000
              10 AHG-AMT-THRESHOLD               PIC 9(5).              02650000
              10 FILLER                          PIC X(05).             02660000
              10 FILLER                          PIC X(1).              02670000
              10 AHG-AMT-SUG-GRANT               PIC S9(5)V99.          02680000
              10 AHG-AMT-SUG-USED                PIC S9(5)V99.          02690000
              10 AHG-AMT-SUG-GRANT-RECOVER       PIC S9(5)V99.          02700000
              10 FILLER                          PIC X(8).              02710000
              10 AHG-AMT-SUG-TOPUP               PIC S9(5)V99.          02720000
              10 FILLER                          PIC X(11).             02730000
              10 AHG-DTE-REQ                     PIC X(8).              02740000
              10 AHG-DTE-RECD                    PIC X(8).              02750000
              10 AHG-DTE-REQ-GRANT-UNUSED        PIC X(8).              02760000
              10 AHG-DTE-REQ-GRANT-USED-HA       PIC X(8).              02770000
              10 AHG-DTE-REQ-GRANT-USED-CPFB     PIC X(8).              02780000
              10 AHG-DTE-RECD-GRANT-UNUSED       PIC X(8).              02790000
              10 AHG-DTE-RECD-GRANT-USED-HA      PIC X(8).              02800000
              10 AHG-DTE-RECD-GRANT-USED-CPFB    PIC X(8).              02810000
              10 AHG-DTE-RECPT-CPFB              PIC X(8).              02820000
              10 AHG-AMT-GRANT-RECOVER-INT       PIC S9(5)V99.          02830000
              10 FILLER                          PIC X(8).              02840000
              10 AHG-NUM-1YR-CONT-EMP            PIC X(1).              02850000
              10 AHG-DTE-REPUDIATION             PIC X(8).              02860000
              10 AHG-DTE-TRANSFER                PIC X(8).              02870000
              10 FILLER                          PIC X(1).              02880000
                                                                        02890000
       01  SHG-RECORD.                                                  02900000
           05 SHG-REC OCCURS 4 TIMES.                                   02910000
              10 SHG-KEY-FLD.                                           02920000
                 15 SHG-NUM-REGN                 PIC X(8).              02930000
                 15 SHG-NUM-NRIC                 PIC X(9).              02940000
              10 FILLER                          PIC X(2).              02950000
              10 SHG-NUM-CPF                     PIC X(9).              02960000
              10 SHG-NME-OCCP                    PIC X(66).             02970000
              10 FILLER                          PIC X(1).              02980000
              10 SHG-NUM-AHG                     PIC X(1).              02990000
              10 SHG-AMT-INCOME-AHG              PIC 9(5).              03000000
              10 SHG-AMT-AHG-GRANT               PIC S9(5)V99.          03010000
              10 SHG-AMT-AHG-USED                PIC S9(5)V99.          03020000
              10 SHG-AMT-AHG-GRANT-RECOVER       PIC S9(5)V99.          03030000
              10 FILLER                          PIC X(9).              03040000
              10 SHG-AMT-HSGNT                   PIC S9(5)V99.          03050000
              10 SHG-AMT-HSGNT-USED              PIC S9(5)V99.          03060000
              10 SHG-AMT-HSGNT-RECOVER           PIC S9(5)V99.          03070000
              10 FILLER                          PIC X(8).              03080000
              10 SHG-AMT-HSGNT-TOPUP             PIC S9(5)V99.          03090000
              10 SHG-NUM-CITIZENSHIP             PIC X(2).              03100000
              10 SHG-NUM-RELATIONSHIP            PIC X(2).              03110000
              10 SHG-NUM-MARITAL-STATUS          PIC X(1).              03120000
              10 SHG-NUM-HA-TAG                  PIC X(1).              03130000
              10 SHG-NUM-AHG-DEBAR               PIC X(1).              03140000
              10 SHG-NUM-SEX                     PIC X(1).              03150000
              10 SHG-NUM-DEBAR-SCSPR             PIC X(2).              03160000
              10 FILLER                          PIC X(1).              03170000
              10 SHG-NUM-CHG-DEBAR               PIC X(1).              03180000
              10 FILLER                          PIC X(73).             03190000
              10 SHG-DTE-HSGNT-ABORTIVE          PIC X(8).              03200000
              10 SHG-AMT-AHG-RECOVER-INT         PIC S9(5)V99.          03210000
              10 SHG-AMT-AHG-RECOVER-USED        PIC S9(5)V99.          03220000
              10 SHG-NUM-TRANSFEROR              PIC X(1).              03230000
              10 FILLER                          PIC X(26).             03240000
              10 SHG-AMT-SHG-GRANT               PIC S9(5)V99.          03250000
              10 SHG-AMT-SHG-USED                PIC S9(5)V99.          03260000
              10 SHG-AMT-SHG-GRANT-RECOVER       PIC S9(5)V99.          03270000
              10 FILLER                          PIC X(8).              03280000
              10 SHG-AMT-SHG-TOPUP               PIC S9(5)V99.          03290000
              10 SHG-AMT-THRESHOLD               PIC 9(5).              03300000
              10 FILLER                          PIC X(05).             03310000
              10 FILLER                          PIC X(1).              03320000
              10 SHG-AMT-SUG-GRANT               PIC S9(5)V99.          03330000
              10 SHG-AMT-SUG-USED                PIC S9(5)V99.          03340000
              10 SHG-AMT-SUG-GRANT-RECOVER       PIC S9(5)V99.          03350000
              10 FILLER                          PIC X(8).              03360000
              10 SHG-AMT-SUG-TOPUP               PIC S9(5)V99.          03370000
              10 FILLER                          PIC X(11).             03380000
              10 SHG-DTE-REQ                     PIC X(8).              03390000
              10 SHG-DTE-RECD                    PIC X(8).              03400000
              10 SHG-DTE-REQ-GRANT-UNUSED        PIC X(8).              03410000
              10 SHG-DTE-REQ-GRANT-USED-HA       PIC X(8).              03420000
              10 SHG-DTE-REQ-GRANT-USED-CPFB     PIC X(8).              03430000
              10 SHG-DTE-RECD-GRANT-UNUSED       PIC X(8).              03440000
              10 SHG-DTE-RECD-GRANT-USED-HA      PIC X(8).              03450000
              10 SHG-DTE-RECD-GRANT-USED-CPFB    PIC X(8).              03460000
              10 SHG-DTE-RECPT-CPFB              PIC X(8).              03470000
              10 SHG-AMT-GRANT-RECOVER-INT       PIC S9(5)V99.          03480000
              10 FILLER                          PIC X(8).              03490000
              10 SHG-NUM-1YR-CONT-EMP            PIC X(1).              03500000
              10 SHG-DTE-REPUDIATION             PIC X(8).              03510000
              10 SHG-DTE-TRANSFER                PIC X(8).              03520000
              10 FILLER                          PIC X(1).              03530000
                                                                        03540000
                                                                        03550000
       01  LB3F-PR-HEAD-01.                                             03560000
           05  FILLER             PIC X(08) VALUE 'BP13LB3F'.           03570000
           05  FILLER             PIC X(05) VALUE SPACES.               03580000
           05  FILLER             PIC X(08) VALUE 'HDBCAT 3'.           03590000
           05  FILLER             PIC X(24) VALUE SPACES.               03600000
           05  FILLER             PIC X(39) VALUE                       03610000
               'S Y S T E M   O F   C O M M I T M E N T'.               03620000
           05  FILLER             PIC X(17) VALUE SPACES.               03630000
           05  FILLER             PIC X(06) VALUE 'DATE: '.             03640000
           05  LB3F-DATE          PIC X(10).                            03650000
           05  FILLER             PIC X(03) VALUE SPACES.               03660000
                                                                        03670000
      *--------------------------------------------------------------*  03680000
      *                          SQLCA                               *  03690000
      *--------------------------------------------------------------*  03700000
           EXEC SQL INCLUDE SQLCA          END-EXEC.                    03710000
           EXEC SQL INCLUDE P13VGASM       END-EXEC.                    03720000
           EXEC SQL INCLUDE P13VGAPN       END-EXEC.                    03730000
           EXEC SQL INCLUDE P13VGRCV       END-EXEC.                    03740000
           EXEC SQL INCLUDE P13VGXAP       END-EXEC.                    03750000
           EXEC SQL INCLUDE P13VGXAS       END-EXEC.                    03760000
           EXEC SQL INCLUDE P13VGUPD       END-EXEC.                    03770000
                                                                        03780000
      ********************                                              03790000
       PROCEDURE DIVISION.                                              03800000
      ********************                                              03810000
                                                                        03820000
      *----------*                                                      03830000
       0000-MAIN.                                                       03840000
      *----------*                                                      03850000
                                                                        03860000
           PERFORM 0500-OPEN-FILES    THRU 0500-EXIT.                   03870000
           PERFORM 1300-READ-BP13FD05 THRU 1300-EXIT.                   03880000
           PERFORM 1500-PROCESS-REC   THRU 1500-EXIT                    03890000
                   UNTIL WS-EOF-FD05 = 'Y'.                             03900000
           PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT.                   03910000
                                                                        03920000
       0000-EXIT.                                                       03930000
           EXIT.                                                        03940000
                                                                        03950000
      *----------------*                                                03960000
       0500-OPEN-FILES.                                                 03970000
      *----------------*                                                03980000
                                                                        03990000
           OPEN INPUT  BP13FD05                                         04000000
                       BP13K800                                         04010000
                       BP13K820                                         04020000
                       BP13K893                                         04030000
                       BP13K895.                                        04040000
                                                                        04050000
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                       04060000
                                                                        04070000
           ACCEPT WS-DTE-CCYYMMDD   FROM   DATE YYYYMMDD.               04080000
           ACCEPT WS-TIME-HHMMSS    FROM   TIME.                        04090000
                                                                        04100000
           PERFORM 1100-SET-DB2-TIMESTAMP THRU 1100-EXIT.               04110000
                                                                        04120000
           IF WS-K800-STATUS NOT = 00 AND 97                            04130000
              DISPLAY 'ERROR OPENING - BP13K800 : ' WS-K800-STATUS      04140000
              MOVE     WS-K800-STATUS    TO    RETURN-CODE              04150000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04160000
           END-IF.                                                      04170000
                                                                        04180000
           IF WS-K820-STATUS NOT = 00 AND 97                            04190000
              DISPLAY 'ERROR OPENING - BP13K820 : ' WS-K820-STATUS      04200000
              MOVE     WS-K820-STATUS    TO    RETURN-CODE              04210000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04220000
           END-IF.                                                      04230000
                                                                        04240000
           IF WS-K893-STATUS NOT = 00 AND 97                            04250000
              DISPLAY 'ERROR OPENING - BP13K893 : ' WS-K893-STATUS      04260000
              MOVE     WS-K893-STATUS    TO    RETURN-CODE              04270000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04280000
           END-IF.                                                      04290000
                                                                        04300000
           IF WS-K895-STATUS NOT = 00 AND 97                            04310000
              DISPLAY 'ERROR OPENING - BP13K895 : ' WS-K895-STATUS      04320000
              MOVE     WS-K895-STATUS    TO    RETURN-CODE              04330000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                04340000
           END-IF.                                                      04350000
                                                                        04360000
           MOVE WS-DATE TO LB3F-DATE.                                   04370000
                                                                        04380000
                                                                        04390000
       0500-EXIT.                                                       04400000
           EXIT.                                                        04410000
                                                                        04420000
      *----------------------------------------------------------------*04430000
       1100-SET-DB2-TIMESTAMP.                                          04440000
      *----------------------------------------------------------------*04450000
            EXEC SQL                                                    04460000
                 SET :WS-TIMESTAMP = CURRENT TIMESTAMP                  04470000
            END-EXEC.                                                   04480000
            IF SQLCODE NOT = 000                                        04490000
               MOVE SQLCODE          TO WS-SQLCODE                      04500000
               DISPLAY 'SQL ERROR SET DB2 TIMESTAMP'                    04510000
               DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE                 04520000
               PERFORM 9999-SQL-ERROR THRU 9999-EXIT                    04530000
            END-IF.                                                     04540000
                                                                        04550000
       1100-EXIT.                                                       04560000
           EXIT.                                                        04570000
                                                                        04580000
      *-------------------*                                             04590000
       1300-READ-BP13FD05.                                              04600000
      *-------------------*                                             04610000
                                                                        04620000
           READ BP13FD05 AT END                                         04630000
                MOVE HIGH-VALUES TO KD05-KEY-FLD                        04640000
                MOVE 'Y' TO WS-EOF-FD05                                 04650000
                GO TO 1300-EXIT.                                        04660000
                                                                        04670000
           PERFORM 1350-CHECK-NUMERIC-FD05 THRU 1350-EXIT.              04680000
           PERFORM 1360-CHECK-FD05-DATES   THRU 1360-EXIT.              04690000
                                                                        04700000
           ADD 1 TO CNT-FD05-READ.                                      04710000
                                                                        04720000
       1300-EXIT.                                                       04730000
           EXIT.                                                        04740000
                                                                        04750000
      *-----------------------*                                         04760000
       1350-CHECK-NUMERIC-FD05.                                         04770000
      *-----------------------*                                         04780000
                                                                        04790000
           IF KD05-AMT-AHG-GRANT IS NOT NUMERIC                         04800000
              MOVE ZEROES TO KD05-AMT-AHG-GRANT                         04810000
           END-IF.                                                      04820000
           IF KD05-AMT-AHG-USED IS NOT NUMERIC                          04830000
              MOVE ZEROES TO KD05-AMT-AHG-USED                          04840000
           END-IF.                                                      04850000
           IF KD05-AMT-AHG-GRANT-RECOVER IS NOT NUMERIC                 04860000
              MOVE ZEROES TO KD05-AMT-AHG-GRANT-RECOVER                 04870000
           END-IF.                                                      04880000
           IF KD05-AMT-HSGNT IS NOT NUMERIC                             04890000
              MOVE ZEROES TO KD05-AMT-HSGNT                             04900000
           END-IF.                                                      04910000
           IF KD05-AMT-HSGNT-USED IS NOT NUMERIC                        04920000
              MOVE ZEROES TO KD05-AMT-HSGNT-USED                        04930000
           END-IF.                                                      04940000
           IF KD05-AMT-HSGNT-RECOVER IS NOT NUMERIC                     04950000
              MOVE ZEROES TO KD05-AMT-HSGNT-RECOVER                     04960000
           END-IF.                                                      04970000
           IF KD05-AMT-HSGNT-TOPUP IS NOT NUMERIC                       04980000
              MOVE ZEROES TO KD05-AMT-HSGNT-TOPUP                       04990000
           END-IF.                                                      05000000
           IF KD05-AMT-AHG-RECOVER-INT IS NOT NUMERIC                   05010000
              MOVE ZEROES TO KD05-AMT-AHG-RECOVER-INT                   05020000
           END-IF.                                                      05030000
           IF KD05-AMT-AHG-RECOVER-USED IS NOT NUMERIC                  05040000
              MOVE ZEROES TO KD05-AMT-AHG-RECOVER-USED                  05050000
           END-IF.                                                      05060000
           IF KD05-AMT-SHG-GRANT IS NOT NUMERIC                         05070000
              MOVE ZEROES TO KD05-AMT-SHG-GRANT                         05080000
           END-IF.                                                      05090000
           IF KD05-AMT-SHG-USED IS NOT NUMERIC                          05100000
              MOVE ZEROES TO KD05-AMT-SHG-USED                          05110000
           END-IF.                                                      05120000
           IF KD05-AMT-SHG-GRANT-RECOVER IS NOT NUMERIC                 05130000
              MOVE ZEROES TO KD05-AMT-SHG-GRANT-RECOVER                 05140000
           END-IF.                                                      05150000
           IF KD05-AMT-SHG-TOPUP IS NOT NUMERIC                         05160000
              MOVE ZEROES TO KD05-AMT-SHG-TOPUP                         05170000
           END-IF.                                                      05180000
           IF KD05-AMT-THRESHOLD IS NOT NUMERIC                         05190000
              MOVE ZEROES TO KD05-AMT-THRESHOLD                         05200000
           END-IF.                                                      05210000
           IF KD05-AMT-SUG-GRANT IS NOT NUMERIC                         05220000
              MOVE ZEROES TO KD05-AMT-SUG-GRANT                         05230000
           END-IF.                                                      05240000
           IF KD05-AMT-SUG-USED IS NOT NUMERIC                          05250000
              MOVE ZEROES TO KD05-AMT-SUG-USED                          05260000
           END-IF.                                                      05270000
           IF KD05-AMT-SUG-GRANT-RECOVER IS NOT NUMERIC                 05280000
              MOVE ZEROES TO KD05-AMT-SUG-GRANT-RECOVER                 05290000
           END-IF.                                                      05300000
           IF KD05-AMT-SUG-TOPUP IS NOT NUMERIC                         05310000
              MOVE ZEROES TO KD05-AMT-SUG-TOPUP                         05320000
           END-IF.                                                      05330000
           IF KD05-AMT-GRANT-RECOVER-INT IS NOT NUMERIC                 05340000
              MOVE ZEROES TO KD05-AMT-GRANT-RECOVER-INT                 05350000
           END-IF.                                                      05360000
       1350-EXIT.                                                       05370000
           EXIT.                                                        05380000
                                                                        05390000
      *-------------------*                                             05400000
       1360-CHECK-FD05-DATES.                                           05410000
      *-------------------*                                             05420000
           MOVE KD05-DTE-AHG-GRANT-RECOVER TO WS-IN-DATE.               05430000
           MOVE 'CD' TO WS-IN-OPTION.                                   05440000
           CALL 'AV02C001' USING LINK-REC                               05450000
           IF WS-RETURN NOT = '000'                                     05460000
              MOVE '00010101' TO KD05-DTE-AHG-GRANT-RECOVER             05470000
           END-IF.                                                      05480000
                                                                        05490000
           MOVE KD05-DTE-HSGNT-RECOVER TO WS-IN-DATE.                   05500000
           MOVE 'CD' TO WS-IN-OPTION.                                   05510000
           CALL 'AV02C001' USING LINK-REC                               05520000
           IF WS-RETURN NOT = '000'                                     05530000
              MOVE '00010101' TO KD05-DTE-HSGNT-RECOVER                 05540000
           END-IF.                                                      05550000
                                                                        05560000
           MOVE KD05-DTE-HSGNT-ABORTIVE TO WS-IN-DATE.                  05570000
           MOVE 'CD' TO WS-IN-OPTION.                                   05580000
           CALL 'AV02C001' USING LINK-REC                               05590000
           IF WS-RETURN NOT = '000'                                     05600000
              MOVE '00010101' TO KD05-DTE-HSGNT-ABORTIVE                05610000
           END-IF.                                                      05620000
                                                                        05630000
           MOVE KD05-DTE-UPDATE TO WS-IN-DATE.                          05640000
           MOVE 'CD' TO WS-IN-OPTION.                                   05650000
           CALL 'AV02C001' USING LINK-REC                               05660000
           IF WS-RETURN NOT = '000'                                     05670000
              MOVE '00010101' TO KD05-DTE-UPDATE                        05680000
           END-IF.                                                      05690000
                                                                        05700000
           MOVE KD05-DTE-SHG-GRANT-RECOVER TO WS-IN-DATE                05710000
           MOVE 'CD' TO WS-IN-OPTION.                                   05720000
           CALL 'AV02C001' USING LINK-REC                               05730000
           IF WS-RETURN NOT = '000'                                     05740000
              MOVE '00010101' TO KD05-DTE-SHG-GRANT-RECOVER             05750000
           END-IF.                                                      05760000
                                                                        05770000
           MOVE KD05-DTE-SUG-GRANT-RECOVER TO WS-IN-DATE                05780000
           MOVE 'CD' TO WS-IN-OPTION.                                   05790000
           CALL 'AV02C001' USING LINK-REC                               05800000
           IF WS-RETURN NOT = '000'                                     05810000
              MOVE '00010101' TO KD05-DTE-SUG-GRANT-RECOVER             05820000
           END-IF.                                                      05830000
                                                                        05840000
           MOVE KD05-DTE-REQ TO WS-IN-DATE                              05850000
           MOVE 'CD' TO WS-IN-OPTION.                                   05860000
           CALL 'AV02C001' USING LINK-REC                               05870000
           IF WS-RETURN NOT = '000'                                     05880000
              MOVE '00010101' TO KD05-DTE-REQ                           05890000
           END-IF.                                                      05900000
                                                                        05910000
           MOVE KD05-DTE-RECD TO WS-IN-DATE                             05920000
           MOVE 'CD' TO WS-IN-OPTION.                                   05930000
           CALL 'AV02C001' USING LINK-REC                               05940000
           IF WS-RETURN NOT = '000'                                     05950000
              MOVE '00010101' TO KD05-DTE-RECD                          05960000
           END-IF.                                                      05970000
                                                                        05980000
           MOVE KD05-DTE-REQ-GRANT-UNUSED TO WS-IN-DATE                 05990000
           MOVE 'CD' TO WS-IN-OPTION.                                   06000000
           CALL 'AV02C001' USING LINK-REC                               06010000
           IF WS-RETURN NOT = '000'                                     06020000
              MOVE '00010101' TO KD05-DTE-REQ-GRANT-UNUSED              06030000
           END-IF.                                                      06040000
                                                                        06050000
           MOVE KD05-DTE-REQ-GRANT-USED-HA TO WS-IN-DATE                06060000
           MOVE 'CD' TO WS-IN-OPTION.                                   06070000
           CALL 'AV02C001' USING LINK-REC                               06080000
           IF WS-RETURN NOT = '000'                                     06090000
              MOVE '00010101' TO KD05-DTE-REQ-GRANT-USED-HA             06100000
           END-IF.                                                      06110000
                                                                        06120000
           MOVE KD05-DTE-REQ-GRANT-USED-CPFB TO WS-IN-DATE              06130000
           MOVE 'CD' TO WS-IN-OPTION.                                   06140000
           CALL 'AV02C001' USING LINK-REC                               06150000
           IF WS-RETURN NOT = '000'                                     06160000
              MOVE '00010101' TO KD05-DTE-REQ-GRANT-USED-CPFB           06170000
           END-IF.                                                      06180000
                                                                        06190000
           MOVE KD05-DTE-RECD-GRANT-UNUSED TO WS-IN-DATE                06200000
           MOVE 'CD' TO WS-IN-OPTION.                                   06210000
           CALL 'AV02C001' USING LINK-REC                               06220000
           IF WS-RETURN NOT = '000'                                     06230000
              MOVE '00010101' TO KD05-DTE-RECD-GRANT-UNUSED             06240000
           END-IF.                                                      06250000
                                                                        06260000
           MOVE KD05-DTE-RECD-GRANT-USED-HA TO WS-IN-DATE               06270000
           MOVE 'CD' TO WS-IN-OPTION.                                   06280000
           CALL 'AV02C001' USING LINK-REC                               06290000
           IF WS-RETURN NOT = '000'                                     06300000
              MOVE '00010101' TO KD05-DTE-RECD-GRANT-USED-HA            06310000
           END-IF.                                                      06320000
                                                                        06330000
           MOVE KD05-DTE-RECD-GRANT-USED-CPFB TO WS-IN-DATE             06340000
           MOVE 'CD' TO WS-IN-OPTION.                                   06350000
           CALL 'AV02C001' USING LINK-REC                               06360000
           IF WS-RETURN NOT = '000'                                     06370000
              MOVE '00010101' TO KD05-DTE-RECD-GRANT-USED-CPFB          06380000
           END-IF.                                                      06390000
                                                                        06400000
           MOVE KD05-DTE-RECPT-CPFB TO WS-IN-DATE                       06410000
           MOVE 'CD' TO WS-IN-OPTION.                                   06420000
           CALL 'AV02C001' USING LINK-REC                               06430000
           IF WS-RETURN NOT = '000'                                     06440000
              MOVE '00010101' TO KD05-DTE-RECPT-CPFB                    06450000
           END-IF.                                                      06460000
                                                                        06470000
           MOVE KD05-DTE-UPD-JV TO WS-IN-DATE                           06480000
           MOVE 'CD' TO WS-IN-OPTION.                                   06490000
           CALL 'AV02C001' USING LINK-REC                               06500000
           IF WS-RETURN NOT = '000'                                     06510000
              MOVE '00010101' TO KD05-DTE-UPD-JV                        06520000
           END-IF.                                                      06530000
                                                                        06540000
           MOVE KD05-DTE-REPUDIATION TO WS-IN-DATE                      06550000
           MOVE 'CD' TO WS-IN-OPTION.                                   06560000
           CALL 'AV02C001' USING LINK-REC                               06570000
           IF WS-RETURN NOT = '000'                                     06580000
              MOVE '00010101' TO KD05-DTE-REPUDIATION                   06590000
           END-IF.                                                      06600000
                                                                        06610000
           MOVE KD05-DTE-TRANSFER TO WS-IN-DATE                         06620000
           MOVE 'CD' TO WS-IN-OPTION.                                   06630000
           CALL 'AV02C001' USING LINK-REC                               06640000
           IF WS-RETURN NOT = '000'                                     06650000
              MOVE '00010101' TO KD05-DTE-TRANSFER                      06660000
           END-IF.                                                      06670000
                                                                        06680000
       1360-EXIT.                                                       06690000
           EXIT.                                                        06700000
                                                                        06710000
      *-------------------*                                             06720000
       1400-READ-BP13K800.                                              06730000
      *-------------------*                                             06740000
           MOVE SPACES             TO BP13K800-MASTER.                  06750000
           INITIALIZE                 BP13K800-MASTER.                  06760000
           MOVE KD05-NUM-REGN      TO K800-NUM-REGN.                    06770000
           MOVE 'N'                TO WS-FND-K800.                      06780000
           MOVE '00010101'         TO WS-DTE-AHG-PROCESS                06790000
                                      WS-DTE-NOAPPLY-AHG-PRT            06800000
                                      WS-DTE-NOAHG-REASON               06810000
                                      WS-DTE-AHG-PAYMENT                06820000
                                      WS-DTE-SHG-PROCESS                06830000
                                      WS-DTE-NOAPPLY-SHG-PRT            06840000
                                      WS-DTE-NOSHG-REASON               06850000
                                      WS-DTE-CPF-ACK-GRANT              06860000
                                      WS-DTE-AHG-ACK                    06870000
                                      WS-DTE-AHG-REQ                    06880000
                                      WS-DTE-SHG-REQ                    06890000
                                      WS-DTE-AHG-FORM-PRT               06900000
                                      WS-DTE-SHG-FORM-PRT.              06910000
                                                                        06920000
           READ BP13K800.                                               06930000
                                                                        06940000
           EVALUATE WS-K800-STATUS                                      06950000
               WHEN 00                                                  06960000
                    MOVE 'Y' TO WS-FND-K800                             06970000
                    PERFORM 1410-CHECK-K800-DATES THRU 1410-EXIT        06980000
                    MOVE K800-NUM-AHG          TO WS-NUM-AHG            06990000
                    MOVE K800-NUM-AHG-STATUS   TO WS-NUM-AHG-STATUS     07000000
                    MOVE K800-DTE-AHG-PROCESS  TO WS-DTE-AHG-PROCESS    07010000
                    MOVE K800-DTE-NOAPPLY-AHG-EHG-PRT                   07020003
                                               TO WS-DTE-NOAPPLY-AHG-PRT07030000
                    MOVE K800-NUM-NOAHG-EHG-REASON                      07040003
                                               TO WS-NUM-NOAHG-REASON   07041003
                    MOVE K800-DTE-NOAHG-EHG-REASON                      07050003
                                               TO WS-DTE-NOAHG-REASON   07051003
                    MOVE K800-DTE-AHG-PAYMENT  TO WS-DTE-AHG-PAYMENT    07060000
                    MOVE K800-NUM-SHG          TO WS-NUM-SHG            07070000
                    MOVE K800-NUM-SHG-STATUS   TO WS-NUM-SHG-STATUS     07080000
                    MOVE K800-DTE-SHG-PROCESS  TO WS-DTE-SHG-PROCESS    07090000
                    MOVE K800-DTE-NOAPPLY-SHG-PRT                       07100000
                                               TO WS-DTE-NOAPPLY-SHG-PRT07110000
                    MOVE K800-NUM-NOSHG-REASON TO WS-NUM-NOSHG-REASON   07120000
                    MOVE K800-DTE-NOSHG-REASON TO WS-DTE-NOSHG-REASON   07130000
                    MOVE K800-NUM-ALLO-SCHEME  TO WS-NUM-ALLO-SCHEME    07140000
                    MOVE K800-DTE-CPF-ACK-GRANT TO WS-DTE-CPF-ACK-GRANT 07150000
                    MOVE K800-NUM-SCH          TO WS-NUM-SCH            07160000
                    MOVE K800-NUM-SCH-ACC(5:5) TO WS-NUM-ACNT           07170000
                    MOVE K800-NUM-LESSEE-CODE  TO WS-NUM-LESSEE-CODE    07180000
                    MOVE K800-DTE-AHG-EHG-ACK  TO WS-DTE-AHG-ACK        07190003
                    MOVE K800-DTE-AHG-EHG-REQ  TO WS-DTE-AHG-REQ        07200003
                    MOVE K800-DTE-SHG-REQ      TO WS-DTE-SHG-REQ        07210000
                    MOVE K800-DTE-AHG-EHG-FORM-PRT                      07220003
                                               TO WS-DTE-AHG-FORM-PRT   07221003
                    MOVE K800-DTE-SHG-FORM-PRT TO WS-DTE-SHG-FORM-PRT   07230000
                    MOVE K800-NUM-AHG-EHG-WITHDRAW                      07240003
                                            TO WS-NUM-AHG-WITHDRAW      07250000
                    MOVE K800-NUM-SHG-WITHDRAW                          07260000
                                            TO WS-NUM-SHG-WITHDRAW      07270000
                    MOVE K800-NUM-AHG-EHG-DOC-REC                       07280003
                                            TO WS-NUM-AHG-DOC-REC       07281003
                    MOVE K800-CDE-CITIZENSHIP-HOUSEHOLD                 07290000
                                      TO WS-CDE-CITIZENSHIP-HOUSEHOLD   07300000
                    MOVE K800-NUM-GRANT-CREDIT-TAG                      07310000
                                      TO WS-NUM-GRANT-CREDIT-TAG        07320000
                    MOVE K800-NUM-AHG-REJECT TO WS-NUM-AHG-REJECT       07330000
                    MOVE K800-NUM-SHG-REJECT TO WS-NUM-SHG-REJECT       07340000
               WHEN 23                                                  07350000
                    PERFORM 1420-START-BP13K893 THRU 1420-EXIT          07360000
               WHEN OTHER                                               07370000
                    DISPLAY 'ERROR READING BP13K800 : ' WS-K800-STATUS  07380000
                            ' REGN = ' K800-NUM-REGN                    07390000
                    MOVE     WS-K800-STATUS    TO    RETURN-CODE        07400000
                    PERFORM  9000-CLOSE-FILES       THRU 9000-EXIT      07410000
           END-EVALUATE.                                                07420000
                                                                        07430000
       1400-EXIT.                                                       07440000
           EXIT.                                                        07450000
                                                                        07460000
      ******************************************************************07470000
       1410-CHECK-K800-DATES.                                           07480000
      ******************************************************************07490000
                                                                        07500000
           MOVE K800-DTE-AHG-PROCESS TO WS-IN-DATE.                     07510000
           MOVE 'CD' TO WS-IN-OPTION.                                   07520000
           CALL 'AV02C001' USING LINK-REC                               07530000
           IF WS-RETURN NOT = '000'                                     07540000
              MOVE '00010101' TO K800-DTE-AHG-PROCESS                   07550000
           END-IF.                                                      07560000
                                                                        07570000
           MOVE K800-DTE-NOAPPLY-AHG-EHG-PRT TO WS-IN-DATE.             07580003
           MOVE 'CD' TO WS-IN-OPTION.                                   07590000
           CALL 'AV02C001' USING LINK-REC                               07600000
           IF WS-RETURN NOT = '000'                                     07610000
              MOVE '00010101' TO K800-DTE-NOAPPLY-AHG-EHG-PRT           07620003
           END-IF.                                                      07630000
                                                                        07640000
           MOVE K800-DTE-NOAHG-EHG-REASON TO WS-IN-DATE.                07650003
           MOVE 'CD' TO WS-IN-OPTION.                                   07660000
           CALL 'AV02C001' USING LINK-REC                               07670000
           IF WS-RETURN NOT = '000'                                     07680000
              MOVE '00010101' TO K800-DTE-NOAHG-EHG-REASON              07690003
           END-IF.                                                      07700000
                                                                        07710000
           MOVE K800-DTE-AHG-PAYMENT TO WS-IN-DATE.                     07720000
           MOVE 'CD' TO WS-IN-OPTION.                                   07730000
           CALL 'AV02C001' USING LINK-REC                               07740000
           IF WS-RETURN NOT = '000'                                     07750000
              MOVE '00010101' TO K800-DTE-AHG-PAYMENT                   07760000
           END-IF.                                                      07770000
                                                                        07780000
           MOVE K800-DTE-SHG-PROCESS TO WS-IN-DATE.                     07790000
           MOVE 'CD' TO WS-IN-OPTION.                                   07800000
           CALL 'AV02C001' USING LINK-REC                               07810000
           IF WS-RETURN NOT = '000'                                     07820000
              MOVE '00010101' TO K800-DTE-SHG-PROCESS                   07830000
           END-IF.                                                      07840000
                                                                        07850000
           MOVE K800-DTE-NOAPPLY-SHG-PRT TO WS-IN-DATE.                 07860000
           MOVE 'CD' TO WS-IN-OPTION.                                   07870000
           CALL 'AV02C001' USING LINK-REC                               07880000
           IF WS-RETURN NOT = '000'                                     07890000
              MOVE '00010101' TO K800-DTE-NOAPPLY-SHG-PRT               07900000
           END-IF.                                                      07910000
                                                                        07920000
           MOVE K800-DTE-NOSHG-REASON TO WS-IN-DATE.                    07930000
           MOVE 'CD' TO WS-IN-OPTION.                                   07940000
           CALL 'AV02C001' USING LINK-REC                               07950000
           IF WS-RETURN NOT = '000'                                     07960000
              MOVE '00010101' TO K800-DTE-NOSHG-REASON                  07970000
           END-IF.                                                      07980000
                                                                        07990000
           MOVE K800-DTE-CPF-ACK-GRANT TO WS-IN-DATE.                   08000000
           MOVE 'CD' TO WS-IN-OPTION.                                   08010000
           CALL 'AV02C001' USING LINK-REC                               08020000
           IF WS-RETURN NOT = '000'                                     08030000
              MOVE '00010101' TO K800-DTE-CPF-ACK-GRANT                 08040000
           END-IF.                                                      08050000
                                                                        08060000
           MOVE K800-DTE-AHG-EHG-ACK TO WS-IN-DATE.                     08070003
           MOVE 'CD' TO WS-IN-OPTION.                                   08080000
           CALL 'AV02C001' USING LINK-REC                               08090000
           IF WS-RETURN NOT = '000'                                     08100000
              MOVE '00010101' TO K800-DTE-AHG-EHG-ACK                   08110003
           END-IF.                                                      08120000
                                                                        08130000
           MOVE K800-DTE-AHG-EHG-REQ TO WS-IN-DATE.                     08140003
           MOVE 'CD' TO WS-IN-OPTION.                                   08150000
           CALL 'AV02C001' USING LINK-REC                               08160000
           IF WS-RETURN NOT = '000'                                     08170000
              MOVE '00010101' TO K800-DTE-AHG-EHG-REQ                   08180003
           END-IF.                                                      08190000
                                                                        08200000
           MOVE K800-DTE-SHG-REQ TO WS-IN-DATE.                         08210000
           MOVE 'CD' TO WS-IN-OPTION.                                   08220000
           CALL 'AV02C001' USING LINK-REC                               08230000
           IF WS-RETURN NOT = '000'                                     08240000
              MOVE '00010101' TO K800-DTE-SHG-REQ                       08250000
           END-IF.                                                      08260000
                                                                        08270000
           MOVE K800-DTE-AHG-EHG-FORM-PRT TO WS-IN-DATE.                08280003
           MOVE 'CD' TO WS-IN-OPTION.                                   08290000
           CALL 'AV02C001' USING LINK-REC                               08300000
           IF WS-RETURN NOT = '000'                                     08310000
              MOVE '00010101' TO K800-DTE-AHG-EHG-FORM-PRT              08320003
           END-IF.                                                      08330000
                                                                        08340000
           MOVE K800-DTE-SHG-FORM-PRT TO WS-IN-DATE.                    08350000
           MOVE 'CD' TO WS-IN-OPTION.                                   08360000
           CALL 'AV02C001' USING LINK-REC                               08370000
           IF WS-RETURN NOT = '000'                                     08380000
              MOVE '00010101' TO K800-DTE-SHG-FORM-PRT                  08390000
           END-IF.                                                      08400000
                                                                        08410000
                                                                        08420000
       1410-EXIT.                                                       08430000
           EXIT.                                                        08440000
                                                                        08450000
      ******************************************************************08460000
       1420-START-BP13K893.                                             08470000
      ******************************************************************08480000
                                                                        08490000
           MOVE SPACES                           TO BP13K893-MASTER.    08500000
           INITIALIZE                               BP13K893-MASTER.    08510000
                                                                        08520000
           MOVE SPACES                           TO K893-KEY-FLD.       08530000
           MOVE KD05-NUM-REGN                    TO K893-NUM-REGN-HIST. 08540000
           MOVE 'N'                              TO WS-EOF-K895         08550000
                                                    WS-FND-K893.        08560000
                                                                        08570000
           START BP13K893 KEY >= K893-KEY-FLD.                          08580000
                                                                        08590000
           EVALUATE WS-K893-STATUS                                      08600000
               WHEN 00                                                  08610000
               WHEN 02                                                  08620000
                    PERFORM 1430-READ-BP13K893    THRU 1430-EXIT        08630000
               WHEN 23                                                  08640000
                    CONTINUE                                            08650000
               WHEN OTHER                                               08660000
                    DISPLAY 'ERROR STARTING BP13K893: ' WS-K893-STATUS  08670000
                            ' REGN = ' K893-NUM-REGN-HIST               08680000
                    MOVE     WS-K893-STATUS    TO    RETURN-CODE        08690000
                    PERFORM 9000-CLOSE-FILES       THRU 9000-EXIT       08700000
           END-EVALUATE.                                                08710000
                                                                        08720000
       1420-EXIT.                                                       08730000
           EXIT.                                                        08740000
                                                                        08750000
      ******************************************************************08760000
       1430-READ-BP13K893.                                              08770000
      ******************************************************************08780000
                                                                        08790000
            READ  BP13K893 NEXT AT END                                  08800000
                  MOVE SPACES               TO K893-KEY-FLD.            08810000
                                                                        08820000
            EVALUATE WS-K893-STATUS                                     08830000
                WHEN 00                                                 08840000
                WHEN 02                                                 08850000
                     IF KD05-NUM-REGN = K893-NUM-REGN-HIST              08860000
                       MOVE 'Y' TO WS-FND-K893                          08870000
                       PERFORM 1440-CHECK-K893-DATES THRU 1440-EXIT     08880000
                       MOVE K893-NUM-AHG          TO WS-NUM-AHG         08890000
                       MOVE K893-NUM-AHG-STATUS   TO WS-NUM-AHG-STATUS  08900000
                       MOVE K893-DTE-AHG-PROCESS  TO WS-DTE-AHG-PROCESS 08910000
                       MOVE K893-DTE-NOAPPLY-AHG-PRT                    08920000
                                               TO WS-DTE-NOAPPLY-AHG-PRT08930000
                       MOVE K893-NUM-NOAHG-REASON                       08940000
                                               TO WS-NUM-NOAHG-REASON   08950000
                       MOVE K893-DTE-NOAHG-REASON TO WS-DTE-NOAHG-REASON08960000
                       MOVE K893-DTE-AHG-PAYMENT  TO WS-DTE-AHG-PAYMENT 08970000
                       MOVE K893-NUM-SHG          TO WS-NUM-SHG         08980000
                       MOVE K893-NUM-SHG-STATUS   TO WS-NUM-SHG-STATUS  08990000
                       MOVE K893-DTE-SHG-PROCESS  TO WS-DTE-SHG-PROCESS 09000000
                       MOVE K893-DTE-NOAPPLY-SHG-PRT                    09010000
                                               TO WS-DTE-NOAPPLY-SHG-PRT09020000
                       MOVE K893-NUM-NOSHG-REASON TO WS-NUM-NOSHG-REASON09030000
                       MOVE K893-DTE-NOSHG-REASON TO WS-DTE-NOSHG-REASON09040000
                       MOVE K893-NUM-ALLO-SCHEME  TO WS-NUM-ALLO-SCHEME 09050000
                       MOVE K893-DTE-CPF-ACK-GRANT                      09060000
                                                TO WS-DTE-CPF-ACK-GRANT 09070000
                       MOVE K893-NUM-SCH          TO WS-NUM-SCH         09080000
                       MOVE K893-NUM-SCH-ACC(5:5) TO WS-NUM-ACNT        09090000
                       MOVE K893-NUM-LESSEE-CODE  TO WS-NUM-LESSEE-CODE 09100000
                       MOVE K893-DTE-AHG-ACK      TO WS-DTE-AHG-ACK     09110000
                       MOVE K893-DTE-AHG-REQ      TO WS-DTE-AHG-REQ     09120000
                       MOVE K893-DTE-SHG-REQ      TO WS-DTE-SHG-REQ     09130000
                       MOVE K893-DTE-AHG-FORM-PRT TO WS-DTE-AHG-FORM-PRT09140000
                       MOVE K893-DTE-SHG-FORM-PRT TO WS-DTE-SHG-FORM-PRT09150000
                       MOVE K893-NUM-AHG-WITHDRAW                       09160000
                                             TO WS-NUM-AHG-WITHDRAW     09170000
                       MOVE K893-NUM-SHG-WITHDRAW                       09180000
                                             TO WS-NUM-SHG-WITHDRAW     09190000
                       MOVE K893-NUM-AHG-DOC-REC TO WS-NUM-AHG-DOC-REC  09200000
                       MOVE K893-CDE-CITIZENSHIP-HOUSEHOLD              09210000
                                      TO WS-CDE-CITIZENSHIP-HOUSEHOLD   09220000
                       MOVE K893-NUM-GRANT-CREDIT-TAG                   09230000
                                      TO WS-NUM-GRANT-CREDIT-TAG        09240000
                       MOVE K893-NUM-AHG-REJECT TO WS-NUM-AHG-REJECT    09250000
                       MOVE K893-NUM-SHG-REJECT TO WS-NUM-SHG-REJECT    09260000
                     ELSE                                               09270000
                       MOVE SPACES TO BP13K893-MASTER                   09280000
                     END-IF                                             09290000
                WHEN 23                                                 09300000
                     DISPLAY KD05-NUM-REGN ' NOT FOUND IN K893'         09310000
                WHEN OTHER                                              09320000
                     DISPLAY 'ERROR READING BP13K893 : ' WS-K893-STATUS 09330000
                             ' REGN = ' K893-NUM-REGN-HIST              09340000
                     MOVE     WS-K893-STATUS    TO    RETURN-CODE       09350000
                     PERFORM 9000-CLOSE-FILES       THRU 9000-EXIT      09360000
            END-EVALUATE.                                               09370000
                                                                        09380000
       1430-EXIT.                                                       09390000
           EXIT.                                                        09400000
                                                                        09410000
      ******************************************************************09420000
       1440-CHECK-K893-DATES.                                           09430000
      ******************************************************************09440000
                                                                        09450000
           MOVE K893-DTE-AHG-PROCESS TO WS-IN-DATE.                     09460000
           MOVE 'CD' TO WS-IN-OPTION.                                   09470000
           CALL 'AV02C001' USING LINK-REC                               09480000
           IF WS-RETURN NOT = '000'                                     09490000
              MOVE '00010101' TO K893-DTE-AHG-PROCESS                   09500000
           END-IF.                                                      09510000
                                                                        09520000
           MOVE K893-DTE-NOAPPLY-AHG-PRT TO WS-IN-DATE.                 09530000
           MOVE 'CD' TO WS-IN-OPTION.                                   09540000
           CALL 'AV02C001' USING LINK-REC                               09550000
           IF WS-RETURN NOT = '000'                                     09560000
              MOVE '00010101' TO K893-DTE-NOAPPLY-AHG-PRT               09570000
           END-IF.                                                      09580000
                                                                        09590000
           MOVE K893-DTE-NOAHG-REASON TO WS-IN-DATE.                    09600000
           MOVE 'CD' TO WS-IN-OPTION.                                   09610000
           CALL 'AV02C001' USING LINK-REC                               09620000
           IF WS-RETURN NOT = '000'                                     09630000
              MOVE '00010101' TO K893-DTE-NOAHG-REASON                  09640000
           END-IF.                                                      09650000
                                                                        09660000
           MOVE K893-DTE-AHG-PAYMENT TO WS-IN-DATE.                     09670000
           MOVE 'CD' TO WS-IN-OPTION.                                   09680000
           CALL 'AV02C001' USING LINK-REC                               09690000
           IF WS-RETURN NOT = '000'                                     09700000
              MOVE '00010101' TO K893-DTE-AHG-PAYMENT                   09710000
           END-IF.                                                      09720000
                                                                        09730000
           MOVE K893-DTE-SHG-PROCESS TO WS-IN-DATE.                     09740000
           MOVE 'CD' TO WS-IN-OPTION.                                   09750000
           CALL 'AV02C001' USING LINK-REC                               09760000
           IF WS-RETURN NOT = '000'                                     09770000
              MOVE '00010101' TO K893-DTE-SHG-PROCESS                   09780000
           END-IF.                                                      09790000
                                                                        09800000
           MOVE K893-DTE-NOAPPLY-SHG-PRT TO WS-IN-DATE.                 09810000
           MOVE 'CD' TO WS-IN-OPTION.                                   09820000
           CALL 'AV02C001' USING LINK-REC                               09830000
           IF WS-RETURN NOT = '000'                                     09840000
              MOVE '00010101' TO K893-DTE-NOAPPLY-SHG-PRT               09850000
           END-IF.                                                      09860000
                                                                        09870000
           MOVE K893-DTE-NOSHG-REASON TO WS-IN-DATE.                    09880000
           MOVE 'CD' TO WS-IN-OPTION.                                   09890000
           CALL 'AV02C001' USING LINK-REC                               09900000
           IF WS-RETURN NOT = '000'                                     09910000
              MOVE '00010101' TO K893-DTE-NOSHG-REASON                  09920000
           END-IF.                                                      09930000
                                                                        09940000
           MOVE K893-DTE-CPF-ACK-GRANT TO WS-IN-DATE.                   09950000
           MOVE 'CD' TO WS-IN-OPTION.                                   09960000
           CALL 'AV02C001' USING LINK-REC                               09970000
           IF WS-RETURN NOT = '000'                                     09980000
              MOVE '00010101' TO K893-DTE-CPF-ACK-GRANT                 09990000
           END-IF.                                                      10000000
                                                                        10010000
           MOVE K893-DTE-AHG-ACK TO WS-IN-DATE.                         10020000
           MOVE 'CD' TO WS-IN-OPTION.                                   10030000
           CALL 'AV02C001' USING LINK-REC                               10040000
           IF WS-RETURN NOT = '000'                                     10050000
              MOVE '00010101' TO K893-DTE-AHG-ACK                       10060000
           END-IF.                                                      10070000
                                                                        10080000
           MOVE K893-DTE-AHG-REQ TO WS-IN-DATE.                         10090000
           MOVE 'CD' TO WS-IN-OPTION.                                   10100000
           CALL 'AV02C001' USING LINK-REC                               10110000
           IF WS-RETURN NOT = '000'                                     10120000
              MOVE '00010101' TO K893-DTE-AHG-REQ                       10130000
           END-IF.                                                      10140000
                                                                        10150000
           MOVE K893-DTE-SHG-REQ TO WS-IN-DATE.                         10160000
           MOVE 'CD' TO WS-IN-OPTION.                                   10170000
           CALL 'AV02C001' USING LINK-REC                               10180000
           IF WS-RETURN NOT = '000'                                     10190000
              MOVE '00010101' TO K893-DTE-SHG-REQ                       10200000
           END-IF.                                                      10210000
                                                                        10220000
           MOVE K893-DTE-SHG-FORM-PRT TO WS-IN-DATE.                    10230000
           MOVE 'CD' TO WS-IN-OPTION.                                   10240000
           CALL 'AV02C001' USING LINK-REC                               10250000
           IF WS-RETURN NOT = '000'                                     10260000
              MOVE '00010101' TO K893-DTE-SHG-FORM-PRT                  10270000
           END-IF.                                                      10280000
                                                                        10290000
           MOVE K893-DTE-AHG-FORM-PRT TO WS-IN-DATE.                    10300000
           MOVE 'CD' TO WS-IN-OPTION.                                   10310000
           CALL 'AV02C001' USING LINK-REC                               10320000
           IF WS-RETURN NOT = '000'                                     10330000
              MOVE '00010101' TO K893-DTE-AHG-FORM-PRT                  10340000
           END-IF.                                                      10350000
                                                                        10360000
       1440-EXIT.                                                       10370000
           EXIT.                                                        10380000
                                                                        10390000
      *-----------------*                                               10400000
       1500-PROCESS-REC.                                                10410000
      *-----------------*                                               10420000
           IF WS-PREV-REGN = SPACES                                     10430000
              CONTINUE                                                  10440000
           ELSE                                                         10450000
              IF WS-PREV-REGN NOT = KD05-NUM-REGN                       10460000
                 PERFORM 1600-CREATE-TO-DB2 THRU 1600-EXIT              10470000
                 MOVE ZEROES TO WS-AHG-CTR WS-SHG-CTR                   10480000
              END-IF                                                    10490000
           END-IF.                                                      10500000
                                                                        10510000
           PERFORM 1550-STORE-VALUES THRU 1550-EXIT.                    10520000
                                                                        10530000
           MOVE KD05-NUM-REGN TO WS-PREV-REGN.                          10540000
           PERFORM 1300-READ-BP13FD05   THRU 1300-EXIT.                 10550000
                                                                        10560000
           IF WS-EOF-FD05 = 'Y'                                         10570000
              PERFORM 1600-CREATE-TO-DB2 THRU 1600-EXIT                 10580000
           END-IF.                                                      10590000
                                                                        10600000
       1500-EXIT.                                                       10610000
           EXIT.                                                        10620000
                                                                        10630000
      *---------------------*                                           10640000
       1550-STORE-VALUES.                                               10650000
      *---------------------*                                           10660000
           PERFORM 1400-READ-BP13K800 THRU 1400-EXIT.                   10670000
                                                                        10680000
           IF WS-NUM-AHG-STATUS NOT = SPACES AND LOW-VALUES AND 'S'     10690000
              ADD 1 TO WS-AHG-CTR                                       10700000
              MOVE 'Y' TO WS-AHG                                        10710000
              MOVE BP13KD05-REC TO AHG-REC(WS-AHG-CTR)                  10720000
              IF KD05-AMT-AHG-GRANT-RECOVER NOT = ZEROES                10730000
                 MOVE 'Y' TO WS-AHG-RCVRY                               10740000
              END-IF                                                    10750000
           END-IF.                                                      10760000
                                                                        10770000
           IF KD05-NUM-REGN(1:1) NOT = '5'                              10780000
              IF WS-NUM-SHG-STATUS NOT = SPACES AND LOW-VALUES AND 'S'  10790000
                 ADD 1 TO WS-SHG-CTR                                    10800000
                 MOVE 'Y' TO WS-SHG                                     10810000
                 MOVE BP13KD05-REC TO SHG-REC(WS-SHG-CTR)               10820000
                 IF KD05-AMT-SHG-GRANT-RECOVER NOT = ZEROES             10830000
                    MOVE 'Y' TO WS-SHG-RCVRY                            10840000
                 END-IF                                                 10850000
              END-IF                                                    10860000
           END-IF.                                                      10870000
                                                                        10880000
       1550-EXIT.                                                       10890000
           EXIT.                                                        10900000
                                                                        10910000
      *-----------------*                                               10920000
       1600-CREATE-TO-DB2.                                              10930000
      *-----------------*                                               10940000
                                                                        10950000
           MOVE 'N' TO WS-EX-INSERT.                                    10960000
           IF WS-AHG-CTR > 0                                            10970000
              PERFORM VARYING WS-CTR FROM 1 BY 1                        10980000
                                           UNTIL WS-CTR > WS-AHG-CTR    10990000
                 PERFORM 2200-PROCESS-AHG THRU 2200-EXIT                11000000
              END-PERFORM                                               11010000
           END-IF.                                                      11020000
                                                                        11030000
           MOVE 'N' TO WS-EX-INSERT.                                    11040000
           IF WS-SHG-CTR > 0                                            11050000
              PERFORM VARYING WS-CTR FROM 1 BY 1                        11060000
                                           UNTIL WS-CTR > WS-SHG-CTR    11070000
                 PERFORM 2300-PROCESS-SHG THRU 2300-EXIT                11080000
              END-PERFORM                                               11090000
           END-IF.                                                      11100000
                                                                        11110000
           IF WS-AHG-CTR = 0 AND WS-SHG-CTR = 0                         11120000
              ADD 1 TO WS-NOT-CREATED                                   11130000
           ELSE                                                         11140000
              ADD 1 TO WS-CREATED                                       11150000
           END-IF.                                                      11160000
                                                                        11170000
           MOVE ZEROES TO WS-AHG-CTR WS-SHG-CTR.                        11180000
           MOVE 'N' TO WS-AHG-RCVRY WS-SHG-RCVRY                        11190000
                       WS-AHG WS-SHG.                                   11200000
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 4          11210000
              INITIALIZE AHG-REC(WS-CTR) SHG-REC(WS-CTR)                11220000
           END-PERFORM.                                                 11230000
                                                                        11240000
       1600-EXIT.                                                       11250000
           EXIT.                                                        11260000
                                                                        11270000
      *-----------------*                                               11280000
       2200-PROCESS-AHG.                                                11290000
      *-----------------*                                               11300000
           MOVE 'AHG' TO WS-GRANT-TYPE.                                 11310000
                                                                        11320000
           IF WS-AHG-RCVRY = 'Y'                                        11330000
              MOVE AHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  11340000
              MOVE AHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  11350000
              PERFORM 5700-READ-GRANT-RCVRY THRU 5700-EXIT              11360000
              IF WS-GRANT-RCVRY-FND NOT = 'Y'                           11370000
                 PERFORM 5730-MOVE-RCVRY-AHG THRU 5730-EXIT             11380000
                 PERFORM 5800-INSERT-GRANT-RCVRY THRU 5800-EXIT         11390000
                 IF WS-EX-INSERT NOT = 'Y'                              11400000
                    PERFORM 6000-READ-EX-GRANT-ASMNT THRU 6000-EXIT     11410000
                    IF WS-EX-GRANT-ASMNT-FND NOT = 'Y'                  11420000
                       PERFORM 3200-MOVE-GRANT-ASMNT-AHG THRU 3200-EXIT 11430000
                       PERFORM 6100-INSERT-EX-GRANT-ASMNT THRU 6100-EXIT11440000
                    END-IF                                              11450000
                 END-IF                                                 11460000
                 PERFORM 6300-READ-EX-GRANT-PRSN THRU 6300-EXIT         11470000
                 IF WS-EX-GRANT-PRSN-FND NOT = 'Y'                      11480000
                    PERFORM 5330-MOVE-GRANT-PRSN-AHG THRU 5330-EXIT     11490000
                    PERFORM 6500-INSERT-EX-GRANT-PRSN THRU 6500-EXIT    11500000
                 END-IF                                                 11510000
              END-IF                                                    11520000
           ELSE                                                         11530000
              PERFORM 5000-READ-GRANT-ASMNT THRU 5000-EXIT              11540000
              IF WS-GRANT-ASMNT-FND NOT = 'Y'                           11550000
                 PERFORM 3200-MOVE-GRANT-ASMNT-AHG THRU 3200-EXIT       11560000
                 PERFORM 5100-INSERT-GRANT-ASMNT THRU 5100-EXIT         11570000
              END-IF                                                    11580000
              MOVE AHG-NUM-NRIC(WS-CTR)                                 11590000
                       TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON         11600000
              PERFORM 5300-READ-GRANT-PRSN THRU 5300-EXIT               11610000
              IF WS-GRANT-PRSN-FND NOT = 'Y'                            11620000
                 PERFORM 5330-MOVE-GRANT-PRSN-AHG THRU 5330-EXIT        11630000
                 PERFORM 5500-INSERT-GRANT-PRSN THRU 5500-EXIT          11640000
              END-IF                                                    11650000
           END-IF.                                                      11660000
                                                                        11670000
       2200-EXIT.                                                       11680000
           EXIT.                                                        11690000
                                                                        11700000
      *-----------------*                                               11710000
       2300-PROCESS-SHG.                                                11720000
      *-----------------*                                               11730000
           MOVE 'SHG' TO WS-GRANT-TYPE.                                 11740000
                                                                        11750000
           IF WS-SHG-RCVRY = 'Y'                                        11760000
              MOVE SHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  11770000
              MOVE SHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  11780000
              PERFORM 5700-READ-GRANT-RCVRY THRU 5700-EXIT              11790000
              IF WS-GRANT-RCVRY-FND NOT = 'Y'                           11800000
                 PERFORM 5740-MOVE-RCVRY-SHG THRU 5740-EXIT             11810000
                 PERFORM 5800-INSERT-GRANT-RCVRY THRU 5800-EXIT         11820000
                 IF WS-EX-INSERT NOT = 'Y'                              11830000
                    PERFORM 6000-READ-EX-GRANT-ASMNT THRU 6000-EXIT     11840000
                    IF WS-EX-GRANT-ASMNT-FND NOT = 'Y'                  11850000
                       PERFORM 3300-MOVE-GRANT-ASMNT-SHG THRU 3300-EXIT 11860000
                       PERFORM 6100-INSERT-EX-GRANT-ASMNT THRU 6100-EXIT11870000
                    END-IF                                              11880000
                 END-IF                                                 11890000
                 PERFORM 6300-READ-EX-GRANT-PRSN THRU 6300-EXIT         11900000
                 IF WS-EX-GRANT-PRSN-FND NOT = 'Y'                      11910000
                    PERFORM 5340-MOVE-GRANT-PRSN-SHG THRU 5340-EXIT     11920000
                    PERFORM 6500-INSERT-EX-GRANT-PRSN THRU 6500-EXIT    11930000
                 END-IF                                                 11940000
              END-IF                                                    11950000
           ELSE                                                         11960000
              PERFORM 5000-READ-GRANT-ASMNT THRU 5000-EXIT              11970000
              IF WS-GRANT-ASMNT-FND NOT = 'Y'                           11980000
                 PERFORM 3300-MOVE-GRANT-ASMNT-SHG THRU 3300-EXIT       11990000
                 PERFORM 5100-INSERT-GRANT-ASMNT THRU 5100-EXIT         12000000
              END-IF                                                    12010000
              MOVE SHG-NUM-NRIC(WS-CTR)                                 12020000
                         TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON       12030000
              PERFORM 5300-READ-GRANT-PRSN THRU 5300-EXIT               12040000
              IF WS-GRANT-PRSN-FND NOT = 'Y'                            12050000
                 PERFORM 5340-MOVE-GRANT-PRSN-SHG THRU 5340-EXIT        12060000
                 PERFORM 5500-INSERT-GRANT-PRSN THRU 5500-EXIT          12070000
              END-IF                                                    12080000
           END-IF.                                                      12090000
                                                                        12100000
       2300-EXIT.                                                       12110000
           EXIT.                                                        12120000
                                                                        12130000
      *-------------------------*                                       12140000
       3200-MOVE-GRANT-ASMNT-AHG.                                       12150000
      *-------------------------*                                       12160000
           IF WS-AHG-RCVRY = 'Y'                                        12170000
              MOVE SPACES                                               12180000
                    TO NUM-ELGBL-GRANT OF DCLEX-GRANT-ASMNT             12190000
              MOVE WS-NUM-AHG-STATUS                                    12200000
                    TO NUM-GRANT-STATUS OF DCLEX-GRANT-ASMNT            12210000
              EVALUATE NUM-GRANT-STATUS OF DCLEX-GRANT-ASMNT            12220000
              WHEN 'S'                                                  12230000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     12240000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     12250000
                        WS-DTE-AHG-PROCESS(7:2)                         12260000
                           DELIMITED BY SIZE                            12270000
                                 INTO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   12280000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLEX-GRANT-ASMNT     12290000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLEX-GRANT-ASMNT   12300000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT   12310000
              WHEN 'A'                                                  12320000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   12330000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     12340000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     12350000
                        WS-DTE-AHG-PROCESS(7:2)                         12360000
                           DELIMITED BY SIZE                            12370000
                                 INTO DTE-APRV OF DCLEX-GRANT-ASMNT     12380000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLEX-GRANT-ASMNT   12390000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT   12400000
              WHEN 'R'                                                  12410000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   12420000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLEX-GRANT-ASMNT     12430000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     12440000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     12450000
                        WS-DTE-AHG-PROCESS(7:2)                         12460000
                           DELIMITED BY SIZE                            12470000
                                 INTO DTE-REJECT OF DCLEX-GRANT-ASMNT   12480000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT   12490000
              WHEN 'W'                                                  12500000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   12510000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLEX-GRANT-ASMNT     12520000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLEX-GRANT-ASMNT   12530000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     12540000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     12550000
                        WS-DTE-AHG-PROCESS(7:2)                         12560000
                           DELIMITED BY SIZE                            12570000
                             INTO DTE-WTHDRW OF DCLEX-GRANT-ASMNT       12580000
              END-EVALUATE                                              12590000
                                                                        12600000
              MOVE WS-NUM-AHG-REJECT                                    12610000
                             TO NUM-RJCTN-REASON OF DCLEX-GRANT-ASMNT   12620000
              MOVE WS-NUM-AHG-WITHDRAW                                  12630000
                             TO NUM-WTDRWL-REASON OF DCLEX-GRANT-ASMNT  12640000
              STRING WS-DTE-AHG-REQ(1:4) '-'                            12650000
                     WS-DTE-AHG-REQ(5:2) '-'                            12660000
                     WS-DTE-AHG-REQ(7:2)                                12670000
                       DELIMITED BY SIZE                                12680000
                      INTO DTE-GRANT-RQST OF DCLEX-GRANT-ASMNT          12690000
              MOVE WS-NUM-AHG-DOC-REC                                   12700000
                             TO NUM-GRANT-DOC-RCV OF DCLEX-GRANT-ASMNT  12710000
              STRING WS-DTE-AHG-ACK(1:4) '-'                            12720000
                     WS-DTE-AHG-ACK(5:2) '-'                            12730000
                     WS-DTE-AHG-ACK(7:2)                                12740000
                       DELIMITED BY SIZE                                12750000
                         INTO DTE-ACK OF DCLEX-GRANT-ASMNT              12760000
              STRING WS-DTE-AHG-FORM-PRT(1:4) '-'                       12770000
                     WS-DTE-AHG-FORM-PRT(5:2) '-'                       12780000
                     WS-DTE-AHG-FORM-PRT(7:2)                           12790000
                        DELIMITED BY SIZE                               12800000
                  INTO DTE-GRANT-FORM-ISSUE OF DCLEX-GRANT-ASMNT        12810000
              STRING WS-DTE-NOAPPLY-AHG-PRT(1:4) '-'                    12820000
                     WS-DTE-NOAPPLY-AHG-PRT(5:2) '-'                    12830000
                     WS-DTE-NOAPPLY-AHG-PRT(7:2)                        12840000
                             DELIMITED BY SIZE                          12850000
               INTO DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLEX-GRANT-ASMNT   12860000
              MOVE WS-NUM-NOAHG-REASON                                  12870000
                   TO NUM-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT     12880000
              STRING WS-DTE-NOAHG-REASON(1:4) '-'                       12890000
                     WS-DTE-NOAHG-REASON(5:2) '-'                       12900000
                     WS-DTE-NOAHG-REASON(7:2)                           12910000
                          DELIMITED BY SIZE                             12920000
                 INTO DTE-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT     12930000
              STRING WS-DTE-AHG-PAYMENT(1:4) '-'                        12940000
                     WS-DTE-AHG-PAYMENT(5:2) '-'                        12950000
                     WS-DTE-AHG-PAYMENT(7:2)                            12960000
                          DELIMITED BY SIZE                             12970000
                              INTO DTE-PYMNT OF DCLEX-GRANT-ASMNT       12980000
              MOVE '00.00.00' TO TME-APNTMT OF DCLEX-GRANT-ASMNT        12990000
              MOVE '0001-01-01' TO DTE-APNTMT OF DCLEX-GRANT-ASMNT      13000000
              MOVE SPACES                                               13010000
                         TO NUM-HALF-GRANT OF DCLEX-GRANT-ASMNT         13020000
           ELSE                                                         13030000
              MOVE SPACES                                               13040000
                    TO NUM-ELGBL-GRANT OF DCLGRANT-ASMNT                13050000
              IF WS-NUM-AHG NOT = SPACES AND LOW-VALUES                 13060000
                 MOVE WS-NUM-AHG                                        13070000
                    TO NUM-GRANT-AMOUNT-ELGBL OF DCLGRANT-ASMNT         13080000
              END-IF                                                    13090000
              IF WS-NUM-AHG-STATUS NOT = SPACES AND LOW-VALUES          13100000
                 MOVE WS-NUM-AHG-STATUS                                 13110000
                    TO NUM-GRANT-STATUS OF DCLGRANT-ASMNT               13120000
              END-IF                                                    13130000
              EVALUATE NUM-GRANT-STATUS OF DCLGRANT-ASMNT               13140000
              WHEN 'S'                                                  13150000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     13160000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     13170000
                        WS-DTE-AHG-PROCESS(7:2)                         13180000
                           DELIMITED BY SIZE                            13190000
                                    INTO DTE-SUBMIT OF DCLGRANT-ASMNT   13200000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLGRANT-ASMNT        13210000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLGRANT-ASMNT      13220000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT      13230000
              WHEN 'A'                                                  13240000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLGRANT-ASMNT      13250000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     13260000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     13270000
                        WS-DTE-AHG-PROCESS(7:2)                         13280000
                         DELIMITED BY SIZE                              13290000
                                    INTO DTE-APRV OF DCLGRANT-ASMNT     13300000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLGRANT-ASMNT      13310000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT      13320000
              WHEN 'R'                                                  13330000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLGRANT-ASMNT      13340000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLGRANT-ASMNT        13350000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     13360000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     13370000
                        WS-DTE-AHG-PROCESS(7:2)                         13380000
                         DELIMITED BY SIZE                              13390000
                                    INTO DTE-REJECT OF DCLGRANT-ASMNT   13400000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT      13410000
              WHEN 'W'                                                  13420000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLGRANT-ASMNT      13430000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLGRANT-ASMNT        13440000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLGRANT-ASMNT      13450000
                 STRING WS-DTE-AHG-PROCESS(1:4) '-'                     13460000
                        WS-DTE-AHG-PROCESS(5:2) '-'                     13470000
                        WS-DTE-AHG-PROCESS(7:2)                         13480000
                         DELIMITED BY SIZE                              13490000
                         INTO DTE-WTHDRW OF DCLGRANT-ASMNT              13500000
              END-EVALUATE                                              13510000
                                                                        13520000
              MOVE WS-NUM-AHG-REJECT                                    13530000
                             TO NUM-RJCTN-REASON OF DCLGRANT-ASMNT      13540000
              MOVE WS-NUM-AHG-WITHDRAW                                  13550000
                             TO NUM-WTDRWL-REASON OF DCLGRANT-ASMNT     13560000
              STRING WS-DTE-AHG-REQ(1:4) '-'                            13570000
                     WS-DTE-AHG-REQ(5:2) '-'                            13580000
                     WS-DTE-AHG-REQ(7:2)                                13590000
                   DELIMITED BY SIZE                                    13600000
                            INTO DTE-GRANT-RQST OF DCLGRANT-ASMNT       13610000
              MOVE WS-NUM-AHG-DOC-REC                                   13620000
                             TO NUM-GRANT-DOC-RCV OF DCLGRANT-ASMNT     13630000
              STRING WS-DTE-AHG-ACK(1:4) '-'                            13640000
                     WS-DTE-AHG-ACK(5:2) '-'                            13650000
                     WS-DTE-AHG-ACK(7:2)                                13660000
                   DELIMITED BY SIZE                                    13670000
                   INTO DTE-ACK OF DCLGRANT-ASMNT                       13680000
              STRING WS-DTE-AHG-FORM-PRT(1:4) '-'                       13690000
                     WS-DTE-AHG-FORM-PRT(5:2) '-'                       13700000
                     WS-DTE-AHG-FORM-PRT(7:2)                           13710000
                        DELIMITED BY SIZE                               13720000
                  INTO DTE-GRANT-FORM-ISSUE OF DCLGRANT-ASMNT           13730000
              STRING WS-DTE-NOAPPLY-AHG-PRT(1:4) '-'                    13740000
                     WS-DTE-NOAPPLY-AHG-PRT(5:2) '-'                    13750000
                     WS-DTE-NOAPPLY-AHG-PRT(7:2)                        13760000
                   DELIMITED BY SIZE                                    13770000
              INTO DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLGRANT-ASMNT       13780000
              MOVE WS-NUM-NOAHG-REASON                                  13790000
                    TO NUM-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT       13800000
              STRING WS-DTE-NOAHG-REASON(1:4) '-'                       13810000
                     WS-DTE-NOAHG-REASON(5:2) '-'                       13820000
                     WS-DTE-NOAHG-REASON(7:2)                           13830000
                        DELIMITED BY SIZE                               13840000
                  INTO DTE-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT       13850000
              STRING WS-DTE-AHG-PAYMENT(1:4) '-'                        13860000
                     WS-DTE-AHG-PAYMENT(5:2) '-'                        13870000
                     WS-DTE-AHG-PAYMENT(7:2)                            13880000
                        DELIMITED BY SIZE                               13890000
                        INTO DTE-PYMNT OF DCLGRANT-ASMNT                13900000
              MOVE '00.00.00' TO TME-APNTMT OF DCLGRANT-ASMNT           13910000
              MOVE '0001-01-01' TO DTE-APNTMT OF DCLGRANT-ASMNT         13920000
              MOVE SPACES TO NUM-HALF-GRANT OF DCLGRANT-ASMNT           13930000
           END-IF.                                                      13940000
                                                                        13950000
       3200-EXIT.                                                       13960000
           EXIT.                                                        13970000
                                                                        13980000
      *-------------------------*                                       13990000
       3300-MOVE-GRANT-ASMNT-SHG.                                       14000000
      *-------------------------*                                       14010000
                                                                        14020000
           IF WS-SHG-RCVRY = 'Y'                                        14030000
              MOVE SPACES     TO NUM-ELGBL-GRANT OF DCLEX-GRANT-ASMNT   14040000
              MOVE WS-NUM-SHG                                           14050000
                         TO NUM-GRANT-AMOUNT-ELGBL OF DCLEX-GRANT-ASMNT 14060000
              MOVE WS-NUM-SHG-STATUS                                    14070000
                         TO NUM-GRANT-STATUS OF DCLEX-GRANT-ASMNT       14080000
              EVALUATE NUM-GRANT-STATUS OF DCLEX-GRANT-ASMNT            14090000
              WHEN 'S'                                                  14100000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     14110000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     14120000
                        WS-DTE-SHG-PROCESS(7:2)                         14130000
                      DELIMITED BY SIZE                                 14140000
                                 INTO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   14150000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLEX-GRANT-ASMNT     14160000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLEX-GRANT-ASMNT   14170000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT   14180000
              WHEN 'A'                                                  14190000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   14200000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     14210000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     14220000
                        WS-DTE-SHG-PROCESS(7:2)                         14230000
                      DELIMITED BY SIZE                                 14240000
                                 INTO DTE-APRV OF DCLEX-GRANT-ASMNT     14250000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLEX-GRANT-ASMNT   14260000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT   14270000
              WHEN 'R'                                                  14280000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   14290000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLEX-GRANT-ASMNT     14300000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     14310000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     14320000
                        WS-DTE-SHG-PROCESS(7:2)                         14330000
                      DELIMITED BY SIZE                                 14340000
                           INTO DTE-REJECT OF DCLEX-GRANT-ASMNT         14350000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLEX-GRANT-ASMNT   14360000
              WHEN 'W'                                                  14370000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLEX-GRANT-ASMNT   14380000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLEX-GRANT-ASMNT     14390000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLEX-GRANT-ASMNT   14400000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     14410000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     14420000
                        WS-DTE-SHG-PROCESS(7:2)                         14430000
                      DELIMITED BY SIZE                                 14440000
                           INTO DTE-WTHDRW OF DCLEX-GRANT-ASMNT         14450000
              END-EVALUATE                                              14460000
                                                                        14470000
              MOVE WS-NUM-SHG-REJECT                                    14480000
                           TO NUM-RJCTN-REASON OF DCLEX-GRANT-ASMNT     14490000
              MOVE WS-NUM-SHG-WITHDRAW                                  14500000
                           TO NUM-WTDRWL-REASON OF DCLEX-GRANT-ASMNT    14510000
              STRING WS-DTE-SHG-REQ(1:4) '-'                            14520000
                     WS-DTE-SHG-REQ(5:2) '-'                            14530000
                     WS-DTE-SHG-REQ(7:2)                                14540000
                   DELIMITED BY SIZE                                    14550000
                          INTO DTE-GRANT-RQST OF DCLEX-GRANT-ASMNT      14560000
              MOVE WS-NUM-AHG-DOC-REC                                   14570000
                           TO NUM-GRANT-DOC-RCV OF DCLEX-GRANT-ASMNT    14580000
              STRING WS-DTE-AHG-ACK(1:4) '-'                            14590000
                     WS-DTE-AHG-ACK(5:2) '-'                            14600000
                     WS-DTE-AHG-ACK(7:2)                                14610000
                   DELIMITED BY SIZE                                    14620000
                              INTO DTE-ACK OF DCLEX-GRANT-ASMNT         14630000
              STRING WS-DTE-SHG-FORM-PRT(1:4) '-'                       14640000
                     WS-DTE-SHG-FORM-PRT(5:2) '-'                       14650000
                     WS-DTE-SHG-FORM-PRT(7:2)                           14660000
                        DELIMITED BY SIZE                               14670000
                  INTO DTE-GRANT-FORM-ISSUE OF DCLEX-GRANT-ASMNT        14680000
              STRING WS-DTE-NOAPPLY-SHG-PRT(1:4) '-'                    14690000
                     WS-DTE-NOAPPLY-SHG-PRT(5:2) '-'                    14700000
                     WS-DTE-NOAPPLY-SHG-PRT(7:2)                        14710000
                   DELIMITED BY SIZE                                    14720000
                  INTO DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLEX-GRANT-ASMNT14730000
              MOVE WS-NUM-NOSHG-REASON                                  14740000
                    TO NUM-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT    14750000
              STRING WS-DTE-NOSHG-REASON(1:4) '-'                       14760000
                     WS-DTE-NOSHG-REASON(5:2) '-'                       14770000
                     WS-DTE-NOSHG-REASON(7:2)                           14780000
                        DELIMITED BY SIZE                               14790000
                 INTO DTE-GRANT-OPT-OUT-REASON OF DCLEX-GRANT-ASMNT     14800000
              MOVE '0001-01-01' TO DTE-PYMNT OF DCLEX-GRANT-ASMNT       14810000
              MOVE '00.00.00' TO TME-APNTMT OF DCLEX-GRANT-ASMNT        14820000
              MOVE '0001-01-01' TO DTE-APNTMT OF DCLEX-GRANT-ASMNT      14830000
              MOVE SPACES TO NUM-HALF-GRANT OF DCLEX-GRANT-ASMNT        14840000
           ELSE                                                         14850000
              MOVE SPACES           TO NUM-ELGBL-GRANT OF DCLGRANT-ASMNT14860000
              MOVE WS-NUM-SHG                                           14870000
                         TO NUM-GRANT-AMOUNT-ELGBL OF DCLGRANT-ASMNT    14880000
              MOVE WS-NUM-SHG-STATUS                                    14890000
                         TO NUM-GRANT-STATUS OF DCLGRANT-ASMNT          14900000
              EVALUATE NUM-GRANT-STATUS OF DCLGRANT-ASMNT               14910000
              WHEN 'S'                                                  14920000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     14930000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     14940000
                        WS-DTE-SHG-PROCESS(7:2)                         14950000
                      DELIMITED BY SIZE                                 14960000
                      INTO DTE-SUBMIT OF DCLGRANT-ASMNT                 14970000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLGRANT-ASMNT        14980000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLGRANT-ASMNT      14990000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT      15000000
              WHEN 'A'                                                  15010000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLGRANT-ASMNT      15020000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     15030000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     15040000
                        WS-DTE-SHG-PROCESS(7:2)                         15050000
                      DELIMITED BY SIZE                                 15060000
                         INTO DTE-APRV OF DCLGRANT-ASMNT                15070000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLGRANT-ASMNT      15080000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT      15090000
              WHEN 'R'                                                  15100000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLGRANT-ASMNT      15110000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLGRANT-ASMNT        15120000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     15130000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     15140000
                        WS-DTE-SHG-PROCESS(7:2)                         15150000
                      DELIMITED BY SIZE                                 15160000
                         INTO DTE-REJECT OF DCLGRANT-ASMNT              15170000
                 MOVE '0001-01-01' TO DTE-WTHDRW OF DCLGRANT-ASMNT      15180000
              WHEN 'W'                                                  15190000
                 MOVE '0001-01-01' TO DTE-SUBMIT OF DCLGRANT-ASMNT      15200000
                 MOVE '0001-01-01' TO DTE-APRV OF DCLGRANT-ASMNT        15210000
                 MOVE '0001-01-01' TO DTE-REJECT OF DCLGRANT-ASMNT      15220000
                 STRING WS-DTE-SHG-PROCESS(1:4) '-'                     15230000
                        WS-DTE-SHG-PROCESS(5:2) '-'                     15240000
                        WS-DTE-SHG-PROCESS(7:2)                         15250000
                      DELIMITED BY SIZE                                 15260000
                      INTO DTE-WTHDRW OF DCLGRANT-ASMNT                 15270000
              END-EVALUATE                                              15280000
              MOVE WS-NUM-SHG-REJECT                                    15290000
                                TO NUM-RJCTN-REASON OF DCLGRANT-ASMNT   15300000
              MOVE WS-NUM-SHG-WITHDRAW                                  15310000
                                TO NUM-WTDRWL-REASON OF DCLGRANT-ASMNT  15320000
              STRING WS-DTE-SHG-REQ(1:4) '-'                            15330000
                     WS-DTE-SHG-REQ(5:2) '-'                            15340000
                     WS-DTE-SHG-REQ(7:2)                                15350000
                      DELIMITED BY SIZE                                 15360000
                   INTO DTE-GRANT-RQST OF DCLGRANT-ASMNT                15370000
              MOVE WS-NUM-AHG-DOC-REC                                   15380000
                                TO NUM-GRANT-DOC-RCV OF DCLGRANT-ASMNT  15390000
              STRING WS-DTE-AHG-ACK(1:4) '-'                            15400000
                     WS-DTE-AHG-ACK(5:2) '-'                            15410000
                     WS-DTE-AHG-ACK(7:2)                                15420000
                   DELIMITED BY SIZE                                    15430000
                   INTO DTE-ACK OF DCLGRANT-ASMNT                       15440000
              STRING WS-DTE-SHG-FORM-PRT(1:4) '-'                       15450000
                     WS-DTE-SHG-FORM-PRT(5:2) '-'                       15460000
                     WS-DTE-SHG-FORM-PRT(7:2)                           15470000
                   DELIMITED BY SIZE                                    15480000
                      INTO DTE-GRANT-FORM-ISSUE OF DCLGRANT-ASMNT       15490000
              STRING WS-DTE-NOAPPLY-SHG-PRT(1:4) '-'                    15500000
                     WS-DTE-NOAPPLY-SHG-PRT(5:2) '-'                    15510000
                     WS-DTE-NOAPPLY-SHG-PRT(7:2)                        15520000
                   DELIMITED BY SIZE                                    15530000
                   INTO DTE-GRANT-OPT-OUT-FORM-ISSUE OF DCLGRANT-ASMNT  15540000
              MOVE WS-NUM-NOSHG-REASON                                  15550000
                    TO NUM-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT       15560000
              STRING WS-DTE-NOSHG-REASON(1:4) '-'                       15570000
                     WS-DTE-NOSHG-REASON(5:2) '-'                       15580000
                     WS-DTE-NOSHG-REASON(7:2)                           15590000
                   DELIMITED BY SIZE                                    15600000
                INTO DTE-GRANT-OPT-OUT-REASON OF DCLGRANT-ASMNT         15610000
              MOVE '0001-01-01' TO DTE-PYMNT OF DCLGRANT-ASMNT          15620000
              MOVE '00.00.00' TO TME-APNTMT OF DCLGRANT-ASMNT           15630000
              MOVE '0001-01-01' TO DTE-APNTMT OF DCLGRANT-ASMNT         15640000
              MOVE SPACES       TO NUM-HALF-GRANT OF DCLGRANT-ASMNT     15650000
           END-IF.                                                      15660000
                                                                        15670000
       3300-EXIT.                                                       15680000
           EXIT.                                                        15690000
                                                                        15700000
      *--------------------*                                            15710000
       5000-READ-GRANT-ASMNT.                                           15720000
      *--------------------*                                            15730000
           MOVE WS-PREV-REGN     TO NUM-RGSTRN OF DCLGRANT-ASMNT.       15740000
           MOVE WS-GRANT-TYPE    TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT.   15750000
                                                                        15760000
           MOVE 'N'              TO WS-GRANT-ASMNT-FND.                 15770000
                                                                        15780000
           EXEC SQL                                                     15790000
              SELECT NUM_RGSTRN,                                        15800000
                     NUM_GRANT_TYPE,                                    15810000
                     NUM_ELGBL_GRANT,                                   15820000
                     NUM_GRANT_AMOUNT_ELGBL,                            15830000
                     NUM_GRANT_STATUS,                                  15840000
                     DTE_APRV,                                          15850000
                     DTE_CANCEL,                                        15860000
                     DTE_REJECT,                                        15870000
                     DTE_SUBMIT,                                        15880000
                     DTE_WTHDRW,                                        15890000
                     NUM_RJCTN_REASON,                                  15900000
                     NUM_WTDRWL_REASON,                                 15910000
                     TXT_CNCLTN_REASON,                                 15920000
                     DTE_GRANT_RQST,                                    15930000
                     NUM_GRANT_DOC_RCV,                                 15940000
                     DTE_ACK,                                           15950000
                     DTE_GRANT_FORM_ISSUE,                              15960000
                     DTE_GRANT_OPT_OUT_FORM_ISSUE,                      15970000
                     NUM_GRANT_OPT_OUT_REASON,                          15980000
                     DTE_GRANT_OPT_OUT_REASON,                          15990000
                     NUM_ALCTN_SCHEME,                                  16000000
                     NUM_HSHLD_CTZNSP,                                  16010000
                     NUM_WRKNG_CHILD_ASMNT,                             16020000
                     QTY_MONTH_WORK,                                    16030000
                     NUM_APPEAL_ATCHMT,                                 16040000
                     NUM_PARENT_ADRS_BLDNG,                             16050000
                     NUM_PARENT_ADRS_LEVEL,                             16060000
                     NUM_PARENT_ADRS_UNIT,                              16070000
                     TXT_PARENT_ADRS1,                                  16080000
                     TXT_PARENT_ADRS2,                                  16090000
                     NUM_PARENT_ADRS_POSTAL,                            16100000
                     DTE_PYMNT,                                         16110000
                     DTE_CPF_ACK_GRANT_RCV,                             16120000
                     NUM_GRANT_CREDIT,                                  16130000
                     TME_APNTMT,                                        16140000
                     DTE_APNTMT,                                        16150000
                     TME_CREATE_ASMNT,                                  16160000
                     NUM_UPDATE_USERID,                                 16170000
                     TME_UPDATE,                                        16180000
                     DTE_UPDATE,                                        16190000
                     NUM_SOURCE_SYSTEM,                                 16200000
                     NUM_ACNT,                                          16210000
                     NUM_SCHEME,                                        16220000
                     NUM_TNCY,                                          16230000
                     NUM_HALF_GRANT                                     16240000
              INTO  :DCLGRANT-ASMNT.NUM-RGSTRN,                         16250000
                    :DCLGRANT-ASMNT.NUM-GRANT-TYPE,                     16260000
                    :DCLGRANT-ASMNT.NUM-ELGBL-GRANT,                    16270000
                    :DCLGRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,             16280000
                    :DCLGRANT-ASMNT.NUM-GRANT-STATUS,                   16290000
                    :DCLGRANT-ASMNT.DTE-APRV,                           16300000
                    :DCLGRANT-ASMNT.DTE-CANCEL,                         16310000
                    :DCLGRANT-ASMNT.DTE-REJECT,                         16320000
                    :DCLGRANT-ASMNT.DTE-SUBMIT,                         16330000
                    :DCLGRANT-ASMNT.DTE-WTHDRW,                         16340000
                    :DCLGRANT-ASMNT.NUM-RJCTN-REASON,                   16350000
                    :DCLGRANT-ASMNT.NUM-WTDRWL-REASON,                  16360000
                    :DCLGRANT-ASMNT.TXT-CNCLTN-REASON,                  16370000
                    :DCLGRANT-ASMNT.DTE-GRANT-RQST,                     16380000
                    :DCLGRANT-ASMNT.NUM-GRANT-DOC-RCV,                  16390000
                    :DCLGRANT-ASMNT.DTE-ACK,                            16400000
                    :DCLGRANT-ASMNT.DTE-GRANT-FORM-ISSUE,               16410000
                    :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,       16420000
                    :DCLGRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,           16430000
                    :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,           16440000
                    :DCLGRANT-ASMNT.NUM-ALCTN-SCHEME,                   16450000
                    :DCLGRANT-ASMNT.NUM-HSHLD-CTZNSP,                   16460000
                    :DCLGRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,              16470000
                    :DCLGRANT-ASMNT.QTY-MONTH-WORK,                     16480000
                    :DCLGRANT-ASMNT.NUM-APPEAL-ATCHMT,                  16490000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,              16500000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,              16510000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-UNIT,               16520000
                    :DCLGRANT-ASMNT.TXT-PARENT-ADRS1,                   16530000
                    :DCLGRANT-ASMNT.TXT-PARENT-ADRS2,                   16540000
                    :DCLGRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,             16550000
                    :DCLGRANT-ASMNT.DTE-PYMNT,                          16560000
                    :DCLGRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,              16570000
                    :DCLGRANT-ASMNT.NUM-GRANT-CREDIT,                   16580000
                    :DCLGRANT-ASMNT.TME-APNTMT,                         16590000
                    :DCLGRANT-ASMNT.DTE-APNTMT,                         16600000
                    :DCLGRANT-ASMNT.TME-CREATE-ASMNT,                   16610000
                    :DCLGRANT-ASMNT.NUM-UPDATE-USERID,                  16620000
                    :DCLGRANT-ASMNT.TME-UPDATE,                         16630000
                    :DCLGRANT-ASMNT.DTE-UPDATE,                         16640000
                    :DCLGRANT-ASMNT.NUM-SOURCE-SYSTEM,                  16650000
                    :DCLGRANT-ASMNT.NUM-ACNT,                           16660000
                    :DCLGRANT-ASMNT.NUM-SCHEME,                         16670000
                    :DCLGRANT-ASMNT.NUM-TNCY,                           16680000
                    :DCLGRANT-ASMNT.NUM-HALF-GRANT                      16690000
              FROM                                                      16700000
                GRANT_ASMNT                                             16710000
              WHERE NUM_RGSTRN       = :DCLGRANT-ASMNT.NUM-RGSTRN       16720000
               AND  NUM_GRANT_TYPE   = :DCLGRANT-ASMNT.NUM-GRANT-TYPE   16730000
           END-EXEC.                                                    16740000
                                                                        16750000
           EVALUATE SQLCODE                                             16760000
           WHEN WS-SQL-OK                                               16770000
                MOVE 'Y' TO WS-GRANT-ASMNT-FND                          16780000
                                                                        16790000
           WHEN WS-SQL-NFND                                             16800000
                MOVE 'N' TO WS-GRANT-ASMNT-FND                          16810000
                                                                        16820000
           WHEN OTHER                                                   16830000
                MOVE SQLCODE   TO WS-SQLCODE                            16840000
                DISPLAY 'ERROR READING GRANT_ASMNT'                     16850000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      16860000
                DISPLAY SPACES                                          16870000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              16880000
           END-EVALUATE.                                                16890000
                                                                        16900000
       5000-EXIT.                                                       16910000
           EXIT.                                                        16920000
                                                                        16930000
      *------------------------*                                        16940000
       5100-INSERT-GRANT-ASMNT.                                         16950000
      *------------------------*                                        16960000
           MOVE WS-PREV-REGN     TO NUM-RGSTRN OF DCLGRANT-ASMNT.       16970000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT.      16980000
           MOVE '0001-01-01' TO DTE-CANCEL OF DCLGRANT-ASMNT.           16990000
           MOVE SPACES TO TXT-CNCLTN-REASON OF DCLGRANT-ASMNT.          17000000
           MOVE WS-NUM-ALLO-SCHEME                                      17010000
                             TO NUM-ALCTN-SCHEME OF DCLGRANT-ASMNT.     17020000
           MOVE WS-CDE-CITIZENSHIP-HOUSEHOLD                            17030000
                 TO NUM-HSHLD-CTZNSP OF DCLGRANT-ASMNT.                 17040000
           MOVE SPACES TO NUM-WRKNG-CHILD-ASMNT OF DCLGRANT-ASMNT.      17050000
           MOVE ZEROES TO QTY-MONTH-WORK OF DCLGRANT-ASMNT.             17060000
           MOVE SPACES TO NUM-APPEAL-ATCHMT OF DCLGRANT-ASMNT.          17070000
           MOVE SPACES                                                  17080000
                    TO NUM-PARENT-ADRS-BLDNG OF DCLGRANT-ASMNT          17090000
                       NUM-PARENT-ADRS-LEVEL OF DCLGRANT-ASMNT          17100000
                       NUM-PARENT-ADRS-UNIT OF DCLGRANT-ASMNT           17110000
                       TXT-PARENT-ADRS1 OF DCLGRANT-ASMNT               17120000
                       TXT-PARENT-ADRS2 OF DCLGRANT-ASMNT               17130000
                       NUM-PARENT-ADRS-POSTAL OF DCLGRANT-ASMNT.        17140000
           STRING WS-DTE-CPF-ACK-GRANT(1:4) '-'                         17150000
                  WS-DTE-CPF-ACK-GRANT(5:2) '-'                         17160000
                  WS-DTE-CPF-ACK-GRANT(7:2)                             17170000
                DELIMITED BY SIZE                                       17180000
                INTO DTE-CPF-ACK-GRANT-RCV OF DCLGRANT-ASMNT.           17190000
           MOVE WS-NUM-GRANT-CREDIT-TAG                                 17200000
                 TO NUM-GRANT-CREDIT OF DCLGRANT-ASMNT.                 17210000
           MOVE WS-TIMESTAMP                                            17220000
                 TO TME-CREATE-ASMNT OF DCLGRANT-ASMNT.                 17230000
           MOVE 'BP13CB0K'                                              17240000
                 TO NUM-UPDATE-USERID OF DCLGRANT-ASMNT.                17250000
                                                                        17260000
           STRING WS-TIME-HHMMSS(1:2) '.'                               17270000
                  WS-TIME-HHMMSS(3:2) '.'                               17280000
                  WS-TIME-HHMMSS(5:2)                                   17290000
                DELIMITED BY SIZE INTO TME-UPDATE OF DCLGRANT-ASMNT.    17300000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              17310000
                  WS-DTE-CCYYMMDD(5:2) '-'                              17320000
                  WS-DTE-CCYYMMDD(7:2)                                  17330000
                DELIMITED BY SIZE INTO DTE-UPDATE OF DCLGRANT-ASMNT.    17340000
                                                                        17350000
           MOVE 'BP13' TO NUM-SOURCE-SYSTEM OF DCLGRANT-ASMNT.          17360000
           MOVE WS-NUM-SCH TO NUM-SCHEME OF DCLGRANT-ASMNT.             17370000
           MOVE WS-NUM-ACNT TO NUM-ACNT OF DCLGRANT-ASMNT.              17380000
           MOVE WS-NUM-LESSEE-CODE TO NUM-TNCY OF DCLGRANT-ASMNT.       17390000
                                                                        17400000
           IF (WS-PREV-REGN = '2929449F' OR '3027209I') AND             17410000
              (WS-GRANT-TYPE = 'AHG')                                   17420000
              MOVE '2014-11-30' TO DTE-APRV OF DCLGRANT-ASMNT           17430000
           END-IF.                                                      17440000
                                                                        17450000
            EXEC SQL                                                    17460000
                 INSERT INTO GRANT_ASMNT                                17470000
                        ( NUM_RGSTRN,                                   17480000
                          NUM_GRANT_TYPE,                               17490000
                          NUM_ELGBL_GRANT,                              17500000
                          NUM_GRANT_AMOUNT_ELGBL,                       17510000
                          NUM_GRANT_STATUS,                             17520000
                          DTE_APRV,                                     17530000
                          DTE_CANCEL,                                   17540000
                          DTE_REJECT,                                   17550000
                          DTE_SUBMIT,                                   17560000
                          DTE_WTHDRW,                                   17570000
                          NUM_RJCTN_REASON,                             17580000
                          NUM_WTDRWL_REASON,                            17590000
                          TXT_CNCLTN_REASON,                            17600000
                          DTE_GRANT_RQST,                               17610000
                          NUM_GRANT_DOC_RCV,                            17620000
                          DTE_ACK,                                      17630000
                          DTE_GRANT_FORM_ISSUE,                         17640000
                          DTE_GRANT_OPT_OUT_FORM_ISSUE,                 17650000
                          NUM_GRANT_OPT_OUT_REASON,                     17660000
                          DTE_GRANT_OPT_OUT_REASON,                     17670000
                          NUM_ALCTN_SCHEME,                             17680000
                          NUM_HSHLD_CTZNSP,                             17690000
                          NUM_WRKNG_CHILD_ASMNT,                        17700000
                          QTY_MONTH_WORK,                               17710000
                          NUM_APPEAL_ATCHMT,                            17720000
                          NUM_PARENT_ADRS_BLDNG,                        17730000
                          NUM_PARENT_ADRS_LEVEL,                        17740000
                          NUM_PARENT_ADRS_UNIT,                         17750000
                          TXT_PARENT_ADRS1,                             17760000
                          TXT_PARENT_ADRS2,                             17770000
                          NUM_PARENT_ADRS_POSTAL,                       17780000
                          DTE_PYMNT,                                    17790000
                          DTE_CPF_ACK_GRANT_RCV,                        17800000
                          NUM_GRANT_CREDIT,                             17810000
                          TME_APNTMT,                                   17820000
                          DTE_APNTMT,                                   17830000
                          TME_CREATE_ASMNT,                             17840000
                          NUM_UPDATE_USERID,                            17850000
                          TME_UPDATE,                                   17860000
                          DTE_UPDATE,                                   17870000
                          NUM_SOURCE_SYSTEM,                            17880000
                          NUM_ACNT,                                     17890000
                          NUM_SCHEME,                                   17900000
                          NUM_TNCY,                                     17910000
                          NUM_HALF_GRANT )                              17920000
                 VALUES ( :DCLGRANT-ASMNT.NUM-RGSTRN,                   17930000
                          :DCLGRANT-ASMNT.NUM-GRANT-TYPE,               17940000
                          :DCLGRANT-ASMNT.NUM-ELGBL-GRANT,              17950000
                          :DCLGRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,       17960000
                          :DCLGRANT-ASMNT.NUM-GRANT-STATUS,             17970000
                          :DCLGRANT-ASMNT.DTE-APRV,                     17980000
                          :DCLGRANT-ASMNT.DTE-CANCEL,                   17990000
                          :DCLGRANT-ASMNT.DTE-REJECT,                   18000000
                          :DCLGRANT-ASMNT.DTE-SUBMIT,                   18010000
                          :DCLGRANT-ASMNT.DTE-WTHDRW,                   18020000
                          :DCLGRANT-ASMNT.NUM-RJCTN-REASON,             18030000
                          :DCLGRANT-ASMNT.NUM-WTDRWL-REASON,            18040000
                          :DCLGRANT-ASMNT.TXT-CNCLTN-REASON,            18050000
                          :DCLGRANT-ASMNT.DTE-GRANT-RQST,               18060000
                          :DCLGRANT-ASMNT.NUM-GRANT-DOC-RCV,            18070000
                          :DCLGRANT-ASMNT.DTE-ACK,                      18080000
                          :DCLGRANT-ASMNT.DTE-GRANT-FORM-ISSUE,         18090000
                          :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE, 18100000
                          :DCLGRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,     18110000
                          :DCLGRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,     18120000
                          :DCLGRANT-ASMNT.NUM-ALCTN-SCHEME,             18130000
                          :DCLGRANT-ASMNT.NUM-HSHLD-CTZNSP,             18140000
                          :DCLGRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,        18150000
                          :DCLGRANT-ASMNT.QTY-MONTH-WORK,               18160000
                          :DCLGRANT-ASMNT.NUM-APPEAL-ATCHMT,            18170000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,        18180000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,        18190000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-UNIT,         18200000
                          :DCLGRANT-ASMNT.TXT-PARENT-ADRS1,             18210000
                          :DCLGRANT-ASMNT.TXT-PARENT-ADRS2,             18220000
                          :DCLGRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,       18230000
                          :DCLGRANT-ASMNT.DTE-PYMNT,                    18240000
                          :DCLGRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,        18250000
                          :DCLGRANT-ASMNT.NUM-GRANT-CREDIT,             18260000
                          :DCLGRANT-ASMNT.TME-APNTMT,                   18270000
                          :DCLGRANT-ASMNT.DTE-APNTMT,                   18280000
                          :DCLGRANT-ASMNT.TME-CREATE-ASMNT,             18290000
                          :DCLGRANT-ASMNT.NUM-UPDATE-USERID,            18300000
                          :DCLGRANT-ASMNT.TME-UPDATE,                   18310000
                          :DCLGRANT-ASMNT.DTE-UPDATE,                   18320000
                          :DCLGRANT-ASMNT.NUM-SOURCE-SYSTEM,            18330000
                          :DCLGRANT-ASMNT.NUM-ACNT,                     18340000
                          :DCLGRANT-ASMNT.NUM-SCHEME,                   18350000
                          :DCLGRANT-ASMNT.NUM-TNCY,                     18360000
                          :DCLGRANT-ASMNT.NUM-HALF-GRANT )              18370000
            END-EXEC.                                                   18380000
                                                                        18390000
            EVALUATE SQLCODE                                            18400000
               WHEN 000                                                 18410000
                    ADD 1                 TO CNT-ASMNT-INSERT           18420000
                    MOVE 'GRANT_ASMNT'  TO WS-SOURCE                    18430000
                    MOVE 'C'            TO WS-ACTION                    18440000
                    MOVE NUM-RGSTRN OF DCLGRANT-ASMNT TO WS-RGSTRN      18450000
                    MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT               18460000
                                                  TO WS-GRNT-TYPE       18470000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           18480000
                    MOVE DCLGRANT-ASMNT TO WS-AFTER-IMAGE               18490000
                    PERFORM 8000-INSERT-TO-LOG THRU 8000-EXIT           18500000
                    PERFORM 9100-COMMIT        THRU 9100-EXIT           18510000
                                                                        18520000
               WHEN -803                                                18530000
                    CONTINUE                                            18540000
                                                                        18550000
               WHEN OTHER                                               18560000
                    MOVE SQLCODE          TO WS-SQLCODE                 18570000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_ASMNT'         18580000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            18590000
                    DISPLAY DCLGRANT-ASMNT                              18600000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          18610000
            END-EVALUATE.                                               18620000
                                                                        18630000
       5100-EXIT.                                                       18640000
           EXIT.                                                        18650000
                                                                        18660000
      *--------------------*                                            18670000
       5300-READ-GRANT-PRSN.                                            18680000
      *--------------------*                                            18690000
           MOVE WS-PREV-REGN TO NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON.    18700000
           MOVE WS-GRANT-TYPE                                           18710000
                           TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON.  18720000
                                                                        18730000
           MOVE 'N'              TO WS-GRANT-PRSN-FND.                  18740000
                                                                        18750000
           EXEC SQL                                                     18760000
              SELECT NUM_RGSTRN,                                        18770000
                     NUM_GRANT_TYPE,                                    18780000
                     NUM_IDNTY_NO,                                      18790000
                     NUM_IDNTY_NO_TYPE,                                 18800000
                     NUM_CSTMR_SOURCE,                                  18810000
                     NUM_CPF_ACNT,                                      18820000
                     AMT_GRANT,                                         18830000
                     AMT_GRANT_USE,                                     18840000
                     NUM_ROLE_TAG,                                      18850000
                     NUM_RLTNSP,                                        18860000
                     NME_PERSON,                                        18870000
                     NUM_GENDER,                                        18880000
                     NUM_CTZNSP,                                        18890000
                     NUM_MRTL_STATUS,                                   18900000
                     AMT_INCOME,                                        18910000
                     NUM_1YR_CNTNS_EMPLY,                               18920000
                     NUM_DEBAR,                                         18930000
                     NUM_DEBAR_REASON,                                  18940000
                     NUM_RCVRY,                                         18950000
                     NUM_UPDATE_USERID,                                 18960000
                     DTE_UPDATE,                                        18970000
                     TME_UPDATE,                                        18980000
                     AMT_GRANT_THRSHD                                   18990000
              INTO  :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN,                  19000000
                    :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE,              19010000
                    :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO,                19020000
                    :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,           19030000
                    :DCLGRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,            19040000
                    :DCLGRANT-ASMNT-PERSON.NUM-CPF-ACNT,                19050000
                    :DCLGRANT-ASMNT-PERSON.AMT-GRANT,                   19060000
                    :DCLGRANT-ASMNT-PERSON.AMT-GRANT-USE,               19070000
                    :DCLGRANT-ASMNT-PERSON.NUM-ROLE-TAG,                19080000
                    :DCLGRANT-ASMNT-PERSON.NUM-RLTNSP,                  19090000
                    :DCLGRANT-ASMNT-PERSON.NME-PERSON,                  19100000
                    :DCLGRANT-ASMNT-PERSON.NUM-GENDER,                  19110000
                    :DCLGRANT-ASMNT-PERSON.NUM-CTZNSP,                  19120000
                    :DCLGRANT-ASMNT-PERSON.NUM-MRTL-STATUS,             19130000
                    :DCLGRANT-ASMNT-PERSON.AMT-INCOME,                  19140000
                    :DCLGRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,         19150000
                    :DCLGRANT-ASMNT-PERSON.NUM-DEBAR,                   19160000
                    :DCLGRANT-ASMNT-PERSON.NUM-DEBAR-REASON,            19170000
                    :DCLGRANT-ASMNT-PERSON.NUM-RCVRY,                   19180000
                    :DCLGRANT-ASMNT-PERSON.NUM-UPDATE-USERID,           19190000
                    :DCLGRANT-ASMNT-PERSON.DTE-UPDATE,                  19200000
                    :DCLGRANT-ASMNT-PERSON.TME-UPDATE,                  19210000
                    :DCLGRANT-ASMNT-PERSON.AMT-GRANT-THRSHD             19220000
              FROM                                                      19230000
                GRANT_ASMNT_PERSON                                      19240000
              WHERE                                                     19250000
                NUM_RGSTRN = :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN AND      19260000
                NUM_GRANT_TYPE = :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE  19270000
               AND  NUM_IDNTY_NO = :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO  19280000
           END-EXEC.                                                    19290000
                                                                        19300000
           EVALUATE SQLCODE                                             19310000
           WHEN WS-SQL-OK                                               19320000
                MOVE 'Y' TO WS-GRANT-PRSN-FND                           19330000
                                                                        19340000
           WHEN WS-SQL-NFND                                             19350000
                MOVE 'N' TO WS-GRANT-PRSN-FND                           19360000
                                                                        19370000
           WHEN OTHER                                                   19380000
                MOVE SQLCODE   TO WS-SQLCODE                            19390000
                DISPLAY 'ERROR READING GRANT_ASMNT_PERSON'              19400000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      19410000
                DISPLAY SPACES                                          19420000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              19430000
           END-EVALUATE.                                                19440000
                                                                        19450000
       5300-EXIT.                                                       19460000
           EXIT.                                                        19470000
                                                                        19480000
      *------------------------*                                        19490000
       5330-MOVE-GRANT-PRSN-AHG.                                        19500000
      *------------------------*                                        19510000
           IF WS-AHG-RCVRY = 'Y'                                        19520000
              MOVE AHG-AMT-AHG-GRANT(WS-CTR)                            19530000
                      TO AMT-GRANT OF DCLEX-GRANT-ASMNT-PERSON          19540000
              MOVE AHG-AMT-AHG-USED(WS-CTR)                             19550000
                      TO AMT-GRANT-USE OF DCLEX-GRANT-ASMNT-PERSON      19560000
              IF AHG-AMT-AHG-GRANT-RECOVER(WS-CTR) NOT = ZEROES         19570000
                 MOVE 'Y' TO NUM-RCVRY OF DCLEX-GRANT-ASMNT-PERSON      19580000
              END-IF                                                    19590000
              MOVE AHG-NUM-NRIC(WS-CTR)                                 19600000
                   TO NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON          19610000
              EVALUATE TRUE                                             19620000
              WHEN AHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               19630000
               MOVE 'UIN'                                               19640000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    19650000
              WHEN AHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        19660001
               MOVE 'FIN'                                               19670000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    19680000
              WHEN OTHER                                                19690000
               MOVE 'XIN'                                               19700000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    19710000
              END-EVALUATE                                              19720000
              MOVE AHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  19730000
              MOVE AHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  19740000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              19750000
              MOVE WS-C-SRC                                             19760000
                    TO NUM-CSTMR-SOURCE OF DCLEX-GRANT-ASMNT-PERSON     19770000
              MOVE AHG-NUM-NRIC(WS-CTR)                                 19780000
                   TO NUM-CPF-ACNT OF DCLEX-GRANT-ASMNT-PERSON          19790000
              MOVE AHG-NUM-HA-TAG(WS-CTR)                               19800000
                   TO NUM-ROLE-TAG OF DCLEX-GRANT-ASMNT-PERSON          19810000
              MOVE AHG-NUM-RELATIONSHIP(WS-CTR)                         19820000
                   TO NUM-RLTNSP OF DCLEX-GRANT-ASMNT-PERSON            19830000
              MOVE AHG-NME-OCCP(WS-CTR)                                 19840000
                   TO NME-PERSON OF DCLEX-GRANT-ASMNT-PERSON            19850000
              MOVE AHG-NUM-SEX(WS-CTR)                                  19860000
                   TO NUM-GENDER OF DCLEX-GRANT-ASMNT-PERSON            19870000
              MOVE AHG-NUM-CITIZENSHIP(WS-CTR)                          19880000
                   TO NUM-CTZNSP OF DCLEX-GRANT-ASMNT-PERSON            19890000
              MOVE AHG-NUM-MARITAL-STATUS(WS-CTR)                       19900000
                   TO NUM-MRTL-STATUS OF DCLEX-GRANT-ASMNT-PERSON       19910000
              MOVE AHG-AMT-INCOME-AHG(WS-CTR)                           19920000
                   TO AMT-INCOME OF DCLEX-GRANT-ASMNT-PERSON            19930000
              MOVE AHG-NUM-1YR-CONT-EMP(WS-CTR)                         19940000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLEX-GRANT-ASMNT-PERSON   19950000
              MOVE AHG-AMT-THRESHOLD(WS-CTR)                            19960000
                   TO AMT-GRANT-THRSHD OF DCLEX-GRANT-ASMNT-PERSON      19970000
              MOVE AHG-NUM-AHG-DEBAR(WS-CTR)                            19980000
                      TO NUM-DEBAR OF DCLEX-GRANT-ASMNT-PERSON          19990000
              MOVE AHG-NUM-DEBAR-SCSPR(WS-CTR)                          20000000
                      TO NUM-DEBAR-REASON OF DCLEX-GRANT-ASMNT-PERSON   20010000
           ELSE                                                         20020000
              MOVE AHG-AMT-AHG-GRANT(WS-CTR)                            20030000
                      TO AMT-GRANT OF DCLGRANT-ASMNT-PERSON             20040000
              MOVE AHG-AMT-AHG-USED(WS-CTR)                             20050000
                      TO AMT-GRANT-USE OF DCLGRANT-ASMNT-PERSON         20060000
              IF AHG-AMT-AHG-GRANT-RECOVER(WS-CTR) NOT = ZEROES         20070000
                 MOVE 'Y' TO NUM-RCVRY OF DCLGRANT-ASMNT-PERSON         20080000
              END-IF                                                    20090000
              MOVE AHG-NUM-NRIC(WS-CTR)                                 20100000
                   TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON             20110000
              EVALUATE TRUE                                             20120000
              WHEN AHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               20130000
               MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 20140000
              WHEN AHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        20150001
               MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 20160000
              WHEN OTHER                                                20170000
               MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 20180000
              END-EVALUATE                                              20190000
              MOVE AHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  20200000
              MOVE AHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  20210000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              20220000
              MOVE WS-C-SRC TO NUM-CSTMR-SOURCE OF DCLGRANT-ASMNT-PERSON20230000
              MOVE AHG-NUM-NRIC(WS-CTR)                                 20240000
                   TO NUM-CPF-ACNT OF DCLGRANT-ASMNT-PERSON             20250000
              MOVE AHG-NUM-HA-TAG(WS-CTR)                               20260000
                   TO NUM-ROLE-TAG OF DCLGRANT-ASMNT-PERSON             20270000
              MOVE AHG-NUM-RELATIONSHIP(WS-CTR)                         20280000
                   TO NUM-RLTNSP OF DCLGRANT-ASMNT-PERSON               20290000
              MOVE AHG-NME-OCCP(WS-CTR)                                 20300000
                   TO NME-PERSON OF DCLGRANT-ASMNT-PERSON               20310000
              MOVE AHG-NUM-SEX(WS-CTR)                                  20320000
                   TO NUM-GENDER OF DCLGRANT-ASMNT-PERSON               20330000
              MOVE AHG-NUM-CITIZENSHIP(WS-CTR)                          20340000
                   TO NUM-CTZNSP OF DCLGRANT-ASMNT-PERSON               20350000
              MOVE AHG-NUM-MARITAL-STATUS(WS-CTR)                       20360000
                   TO NUM-MRTL-STATUS OF DCLGRANT-ASMNT-PERSON          20370000
              MOVE AHG-AMT-INCOME-AHG(WS-CTR)                           20380000
                   TO AMT-INCOME OF DCLGRANT-ASMNT-PERSON               20390000
              MOVE AHG-NUM-1YR-CONT-EMP(WS-CTR)                         20400000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLGRANT-ASMNT-PERSON      20410000
              MOVE AHG-AMT-THRESHOLD(WS-CTR)                            20420000
                   TO AMT-GRANT-THRSHD OF DCLGRANT-ASMNT-PERSON         20430000
              MOVE AHG-NUM-AHG-DEBAR(WS-CTR)                            20440000
                      TO NUM-DEBAR OF DCLGRANT-ASMNT-PERSON             20450000
              MOVE AHG-NUM-DEBAR-SCSPR(WS-CTR)                          20460000
                      TO NUM-DEBAR-REASON OF DCLGRANT-ASMNT-PERSON      20470000
           END-IF.                                                      20480000
                                                                        20490000
       5330-EXIT.                                                       20500000
           EXIT.                                                        20510000
                                                                        20520000
      *------------------------*                                        20530000
       5340-MOVE-GRANT-PRSN-SHG.                                        20540000
      *------------------------*                                        20550000
           IF WS-SHG-RCVRY = 'Y'                                        20560000
              MOVE SHG-AMT-SHG-GRANT(WS-CTR)                            20570000
                      TO AMT-GRANT OF DCLEX-GRANT-ASMNT-PERSON          20580000
              MOVE SHG-AMT-SHG-USED(WS-CTR)                             20590000
                      TO AMT-GRANT-USE OF DCLEX-GRANT-ASMNT-PERSON      20600000
              IF SHG-AMT-SHG-GRANT-RECOVER(WS-CTR) NOT = ZEROES         20610000
                 MOVE 'Y' TO NUM-RCVRY OF DCLEX-GRANT-ASMNT-PERSON      20620000
              END-IF                                                    20630000
              MOVE SHG-NUM-NRIC(WS-CTR)                                 20640000
                   TO NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON          20650000
              EVALUATE TRUE                                             20660000
              WHEN SHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               20670000
               MOVE 'UIN'                                               20680000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    20690000
              WHEN SHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        20700001
               MOVE 'FIN'                                               20710000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    20720000
              WHEN OTHER                                                20730000
               MOVE 'XIN'                                               20740000
                    TO NUM-IDNTY-NO-TYPE OF DCLEX-GRANT-ASMNT-PERSON    20750000
              END-EVALUATE                                              20760000
              MOVE SHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  20770000
              MOVE SHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  20780000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              20790000
              MOVE WS-C-SRC                                             20800000
                    TO NUM-CSTMR-SOURCE OF DCLEX-GRANT-ASMNT-PERSON     20810000
              MOVE SHG-NUM-NRIC(WS-CTR)                                 20820000
                   TO NUM-CPF-ACNT OF DCLEX-GRANT-ASMNT-PERSON          20830000
              MOVE SHG-NUM-HA-TAG(WS-CTR)                               20840000
                   TO NUM-ROLE-TAG OF DCLEX-GRANT-ASMNT-PERSON          20850000
              MOVE SHG-NUM-RELATIONSHIP(WS-CTR)                         20860000
                   TO NUM-RLTNSP OF DCLEX-GRANT-ASMNT-PERSON            20870000
              MOVE SHG-NME-OCCP(WS-CTR)                                 20880000
                   TO NME-PERSON OF DCLEX-GRANT-ASMNT-PERSON            20890000
              MOVE SHG-NUM-SEX(WS-CTR)                                  20900000
                   TO NUM-GENDER OF DCLEX-GRANT-ASMNT-PERSON            20910000
              MOVE SHG-NUM-CITIZENSHIP(WS-CTR)                          20920000
                   TO NUM-CTZNSP OF DCLEX-GRANT-ASMNT-PERSON            20930000
              MOVE SHG-NUM-MARITAL-STATUS(WS-CTR)                       20940000
                   TO NUM-MRTL-STATUS OF DCLEX-GRANT-ASMNT-PERSON       20950000
              MOVE SHG-AMT-INCOME-AHG(WS-CTR)                           20960000
                   TO AMT-INCOME OF DCLEX-GRANT-ASMNT-PERSON            20970000
              MOVE SHG-NUM-1YR-CONT-EMP(WS-CTR)                         20980000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLEX-GRANT-ASMNT-PERSON   20990000
              MOVE SHG-AMT-THRESHOLD(WS-CTR)                            21000000
                   TO AMT-GRANT-THRSHD OF DCLEX-GRANT-ASMNT-PERSON      21010000
              MOVE SHG-NUM-CHG-DEBAR(WS-CTR)                            21020000
                      TO NUM-DEBAR OF DCLEX-GRANT-ASMNT-PERSON          21030000
              MOVE SHG-NUM-DEBAR-SCSPR(WS-CTR)                          21040000
                      TO NUM-DEBAR-REASON OF DCLEX-GRANT-ASMNT-PERSON   21050000
           ELSE                                                         21060000
              MOVE SHG-AMT-SHG-GRANT(WS-CTR)                            21070000
                      TO AMT-GRANT OF DCLGRANT-ASMNT-PERSON             21080000
              MOVE SHG-AMT-SHG-USED(WS-CTR)                             21090000
                      TO AMT-GRANT-USE OF DCLGRANT-ASMNT-PERSON         21100000
              IF SHG-AMT-SHG-GRANT-RECOVER(WS-CTR) NOT = ZEROES         21110000
                 MOVE 'Y' TO NUM-RCVRY OF DCLGRANT-ASMNT-PERSON         21120000
              END-IF                                                    21130000
              MOVE SHG-NUM-NRIC(WS-CTR)                                 21140000
                   TO NUM-IDNTY-NO OF DCLGRANT-ASMNT-PERSON             21150000
              EVALUATE TRUE                                             21160000
              WHEN SHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'               21170000
               MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 21180000
              WHEN SHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'        21190001
               MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 21200000
              WHEN OTHER                                                21210000
               MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-ASMNT-PERSON 21220000
              END-EVALUATE                                              21230000
              MOVE SHG-NUM-REGN(WS-CTR) TO WS-NUM-REGN                  21240000
              MOVE SHG-NUM-NRIC(WS-CTR) TO WS-NUM-NRIC                  21250000
              PERFORM 5600-GET-CSTMR-SOURCE THRU 5600-EXIT              21260000
              MOVE WS-C-SRC TO NUM-CSTMR-SOURCE OF DCLGRANT-ASMNT-PERSON21270000
              MOVE SHG-NUM-NRIC(WS-CTR)                                 21280000
                   TO NUM-CPF-ACNT OF DCLGRANT-ASMNT-PERSON             21290000
              MOVE SHG-NUM-HA-TAG(WS-CTR)                               21300000
                   TO NUM-ROLE-TAG OF DCLGRANT-ASMNT-PERSON             21310000
              MOVE SHG-NUM-RELATIONSHIP(WS-CTR)                         21320000
                   TO NUM-RLTNSP OF DCLGRANT-ASMNT-PERSON               21330000
              MOVE SHG-NME-OCCP(WS-CTR)                                 21340000
                   TO NME-PERSON OF DCLGRANT-ASMNT-PERSON               21350000
              MOVE SHG-NUM-SEX(WS-CTR)                                  21360000
                   TO NUM-GENDER OF DCLGRANT-ASMNT-PERSON               21370000
              MOVE SHG-NUM-CITIZENSHIP(WS-CTR)                          21380000
                   TO NUM-CTZNSP OF DCLGRANT-ASMNT-PERSON               21390000
              MOVE SHG-NUM-MARITAL-STATUS(WS-CTR)                       21400000
                   TO NUM-MRTL-STATUS OF DCLGRANT-ASMNT-PERSON          21410000
              MOVE SHG-AMT-INCOME-AHG(WS-CTR)                           21420000
                   TO AMT-INCOME OF DCLGRANT-ASMNT-PERSON               21430000
              MOVE SHG-NUM-1YR-CONT-EMP(WS-CTR)                         21440000
                   TO NUM-1YR-CNTNS-EMPLY OF DCLGRANT-ASMNT-PERSON      21450000
              MOVE SHG-AMT-THRESHOLD(WS-CTR)                            21460000
                   TO AMT-GRANT-THRSHD OF DCLGRANT-ASMNT-PERSON         21470000
              MOVE SHG-NUM-CHG-DEBAR(WS-CTR)                            21480000
                      TO NUM-DEBAR OF DCLGRANT-ASMNT-PERSON             21490000
              MOVE SHG-NUM-DEBAR-SCSPR(WS-CTR)                          21500000
                      TO NUM-DEBAR-REASON OF DCLGRANT-ASMNT-PERSON      21510000
           END-IF.                                                      21520000
                                                                        21530000
       5340-EXIT.                                                       21540000
           EXIT.                                                        21550000
                                                                        21560000
      *------------------------*                                        21570000
       5500-INSERT-GRANT-PRSN.                                          21580000
      *------------------------*                                        21590000
           MOVE WS-GRANT-TYPE                                           21600000
                   TO NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON.          21610000
           MOVE WS-PREV-REGN TO NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON.    21620000
                                                                        21630000
           MOVE 'BP13CB0K'                                              21640000
                   TO NUM-UPDATE-USERID OF DCLGRANT-ASMNT-PERSON.       21650000
                                                                        21660000
           STRING WS-TIME-HHMMSS(1:2) '.'                               21670000
                  WS-TIME-HHMMSS(3:2) '.'                               21680000
                  WS-TIME-HHMMSS(5:2)                                   21690000
                  DELIMITED BY SIZE                                     21700000
                  INTO TME-UPDATE OF DCLGRANT-ASMNT-PERSON.             21710000
                                                                        21720000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              21730000
                  WS-DTE-CCYYMMDD(5:2) '-'                              21740000
                  WS-DTE-CCYYMMDD(7:2)                                  21750000
                  DELIMITED BY SIZE                                     21760000
                  INTO DTE-UPDATE OF DCLGRANT-ASMNT-PERSON.             21770000
                                                                        21780000
            EXEC SQL                                                    21790000
                 INSERT INTO GRANT_ASMNT_PERSON                         21800000
                        ( NUM_RGSTRN,                                   21810000
                          NUM_GRANT_TYPE,                               21820000
                          NUM_IDNTY_NO,                                 21830000
                          NUM_IDNTY_NO_TYPE,                            21840000
                          NUM_CSTMR_SOURCE,                             21850000
                          NUM_CPF_ACNT,                                 21860000
                          AMT_GRANT,                                    21870000
                          AMT_GRANT_USE,                                21880000
                          NUM_ROLE_TAG,                                 21890000
                          NUM_RLTNSP,                                   21900000
                          NME_PERSON,                                   21910000
                          NUM_GENDER,                                   21920000
                          NUM_CTZNSP,                                   21930000
                          NUM_MRTL_STATUS,                              21940000
                          AMT_INCOME,                                   21950000
                          NUM_1YR_CNTNS_EMPLY,                          21960000
                          NUM_DEBAR,                                    21970000
                          NUM_DEBAR_REASON,                             21980000
                          NUM_RCVRY,                                    21990000
                          NUM_UPDATE_USERID,                            22000000
                          DTE_UPDATE,                                   22010000
                          TME_UPDATE,                                   22020000
                          AMT_GRANT_THRSHD )                            22030000
                 VALUES ( :DCLGRANT-ASMNT-PERSON.NUM-RGSTRN,            22040000
                          :DCLGRANT-ASMNT-PERSON.NUM-GRANT-TYPE,        22050000
                          :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO,          22060000
                          :DCLGRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,     22070000
                          :DCLGRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,      22080000
                          :DCLGRANT-ASMNT-PERSON.NUM-CPF-ACNT,          22090000
                          :DCLGRANT-ASMNT-PERSON.AMT-GRANT,             22100000
                          :DCLGRANT-ASMNT-PERSON.AMT-GRANT-USE,         22110000
                          :DCLGRANT-ASMNT-PERSON.NUM-ROLE-TAG,          22120000
                          :DCLGRANT-ASMNT-PERSON.NUM-RLTNSP,            22130000
                          :DCLGRANT-ASMNT-PERSON.NME-PERSON,            22140000
                          :DCLGRANT-ASMNT-PERSON.NUM-GENDER,            22150000
                          :DCLGRANT-ASMNT-PERSON.NUM-CTZNSP,            22160000
                          :DCLGRANT-ASMNT-PERSON.NUM-MRTL-STATUS,       22170000
                          :DCLGRANT-ASMNT-PERSON.AMT-INCOME,            22180000
                          :DCLGRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,   22190000
                          :DCLGRANT-ASMNT-PERSON.NUM-DEBAR,             22200000
                          :DCLGRANT-ASMNT-PERSON.NUM-DEBAR-REASON,      22210000
                          :DCLGRANT-ASMNT-PERSON.NUM-RCVRY,             22220000
                          :DCLGRANT-ASMNT-PERSON.NUM-UPDATE-USERID,     22230000
                          :DCLGRANT-ASMNT-PERSON.DTE-UPDATE,            22240000
                          :DCLGRANT-ASMNT-PERSON.TME-UPDATE,            22250000
                          :DCLGRANT-ASMNT-PERSON.AMT-GRANT-THRSHD )     22260000
            END-EXEC.                                                   22270000
                                                                        22280000
            EVALUATE SQLCODE                                            22290000
               WHEN 000                                                 22300000
                    ADD 1                 TO CNT-PERSN-INSERT           22310000
                    MOVE 'GRANT_ASMNT_PERSON'  TO WS-SOURCE             22320000
                    MOVE 'C'            TO WS-ACTION                    22330000
                    MOVE NUM-RGSTRN OF DCLGRANT-ASMNT-PERSON            22340000
                                                  TO WS-RGSTRN          22350000
                    MOVE NUM-GRANT-TYPE OF DCLGRANT-ASMNT-PERSON        22360000
                                                  TO WS-GRNT-TYPE       22370000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           22380000
                    MOVE DCLGRANT-ASMNT-PERSON TO WS-AFTER-IMAGE        22390000
                    PERFORM 8000-INSERT-TO-LOG THRU 8000-EXIT           22400000
                    PERFORM 9100-COMMIT        THRU 9100-EXIT           22410000
                                                                        22420000
               WHEN -803                                                22430000
                    CONTINUE                                            22440000
                                                                        22450000
               WHEN OTHER                                               22460000
                    MOVE SQLCODE          TO WS-SQLCODE                 22470000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_ASMNT_PERSON'  22480000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            22490000
                    DISPLAY DCLGRANT-ASMNT-PERSON                       22500000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          22510000
            END-EVALUATE.                                               22520000
                                                                        22530000
       5500-EXIT.                                                       22540000
           EXIT.                                                        22550000
                                                                        22560000
      *-------------------------------------------------------------    22570000
       5600-GET-CSTMR-SOURCE.                                           22580000
      *-------------------------------------------------------------    22590000
                                                                        22600000
           MOVE SPACES                        TO BP13K820-REC.          22610000
           INITIALIZE                            BP13K820-REC.          22620000
                                                                        22630000
           MOVE SPACES                        TO WS-C-SRC.              22640000
           MOVE WS-NUM-REGN                   TO K820-NUM-REGN.         22650000
           MOVE WS-NUM-NRIC                   TO K820-NUM-NRIC.         22660000
                                                                        22670000
           READ BP13K820.                                               22680000
                                                                        22690000
           IF WS-K820-STATUS = 00                                       22700000
              MOVE  K820-NUM-CSTMR-SOURCE     TO WS-C-SRC               22710000
           ELSE                                                         22720000
              IF WS-K820-STATUS = 23                                    22730000
                 PERFORM 5610-STARTBR-BP13K895   THRU 5610-EXIT         22740000
              ELSE                                                      22750000
                 DISPLAY 'ERROR READING BP13K820, STAT ' WS-K820-STATUS 22760000
                         ', KEY-FLD = ' K820-KEY-FLD                    22770000
                 PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT              22780000
              END-IF                                                    22790000
           END-IF.                                                      22800000
                                                                        22810000
       5600-EXIT.                                                       22820000
            EXIT.                                                       22830000
                                                                        22840000
      ************************                                          22850000
       5610-STARTBR-BP13K895.                                           22860000
      ************************                                          22870000
                                                                        22880000
           MOVE SPACES                     TO BP13K895-REC.             22890000
           INITIALIZE                         BP13K895-REC.             22900000
                                                                        22910000
           MOVE 'N'                        TO WS-EOF-K895.              22920000
                                                                        22930000
           MOVE WS-NUM-REGN                TO K895-NUM-REGN-HIST.       22940000
           MOVE WS-NUM-NRIC                TO K895-NUM-NRIC-HIST.       22950000
                                                                        22960000
           START BP13K895 KEY >= K895-KEY-FLD.                          22970000
                                                                        22980000
           EVALUATE WS-K895-STATUS                                      22990000
               WHEN 00                                                  23000000
               WHEN 02                                                  23010000
                    PERFORM 5620-READNEXT-BP13K895 THRU 5620-EXIT       23020000
                    PERFORM 5630-PROCESS-BP13K895  THRU 5630-EXIT       23030000
                      UNTIL WS-EOF-K895 = 'Y'                           23040000
               WHEN 20                                                  23050000
               WHEN 23                                                  23060000
                    CONTINUE                                            23070000
                                                                        23080000
               WHEN OTHER                                               23090000
                  DISPLAY 'START ERROR BP13K895 : ' WS-K895-STATUS      23100000
                          ' REGN : ' K895-NUM-REGN                      23110000
                  MOVE     WS-K895-STATUS    TO    RETURN-CODE          23120000
                  PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT        23130000
           END-EVALUATE.                                                23140000
                                                                        23150000
       5610-EXIT.                                                       23160000
           EXIT.                                                        23170000
                                                                        23180000
      ************************                                          23190000
       5620-READNEXT-BP13K895.                                          23200000
      ************************                                          23210000
                                                                        23220000
           READ BP13K895 NEXT RECORD                                    23230000
                         AT END MOVE 'Y' TO WS-EOF-K895.                23240000
                                                                        23250000
       5620-EXIT.                                                       23260000
           EXIT.                                                        23270000
                                                                        23280000
      ************************                                          23290000
       5630-PROCESS-BP13K895.                                           23300000
      ************************                                          23310000
                                                                        23320000
           IF WS-NUM-REGN = K895-NUM-REGN-HIST AND                      23330000
              WS-NUM-NRIC = K895-NUM-NRIC-HIST                          23340000
              MOVE  K895-NUM-CSTMR-SOURCE     TO WS-C-SRC               23350000
           ELSE                                                         23360000
              MOVE 'Y'                        TO WS-EOF-K895            23370000
           END-IF.                                                      23380000
                                                                        23390000
           PERFORM 5620-READNEXT-BP13K895        THRU 5620-EXIT.        23400000
                                                                        23410000
       5630-EXIT.                                                       23420000
           EXIT.                                                        23430000
                                                                        23440000
      *----------------------*                                          23450000
       5700-READ-GRANT-RCVRY.                                           23460000
      *----------------------*                                          23470000
           MOVE WS-NUM-REGN   TO NUM-RGSTRN OF DCLGRANT-RCVRY.          23480000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-RCVRY.      23490000
           MOVE WS-NUM-NRIC   TO NUM-IDNTY-NO OF DCLGRANT-RCVRY.        23500000
                                                                        23510000
           MOVE 'N'              TO WS-GRANT-RCVRY-FND.                 23520000
                                                                        23530000
           EXEC SQL                                                     23540000
              SELECT NUM_RGSTRN,                                        23550000
                     NUM_GRANT_TYPE,                                    23560000
                     TME_CREATE,                                        23570000
                     NUM_IDNTY_NO,                                      23580000
                     NUM_IDNTY_NO_TYPE,                                 23590000
                     AMT_GRANT_RCVR,                                    23600000
                     AMT_GRANT_RCVR_INTRST,                             23610000
                     DTE_RQST_RCVR,                                     23620000
                     DTE_RCV_RCVR_GRANT,                                23630000
                     DTE_ACK_GRANT_RCVRY_CPF,                           23640000
                     DTE_GRANT_ABORT,                                   23650000
                     DTE_GRANT_RPDT,                                    23660000
                     NUM_TRNSFR,                                        23670000
                     DTE_TRNSFR,                                        23680000
                     NUM_ACNT,                                          23690000
                     NUM_SCHEME,                                        23700000
                     NUM_TNCY,                                          23710000
                     DTE_CPF_GRANT_RQST,                                23720000
                     DTE_CPF_GRANT_RCV,                                 23730000
                     DTE_UNUSED_GRANT_RQST,                             23740000
                     DTE_UNUSED_GRANT_RCV,                              23750000
                     DTE_USED_GRANT_RQST,                               23760000
                     DTE_USED_GRANT_RCV                                 23770000
              INTO  :DCLGRANT-RCVRY.NUM-RGSTRN,                         23780000
                    :DCLGRANT-RCVRY.NUM-GRANT-TYPE,                     23790000
                    :DCLGRANT-RCVRY.TME-CREATE,                         23800000
                    :DCLGRANT-RCVRY.NUM-IDNTY-NO,                       23810000
                    :DCLGRANT-RCVRY.NUM-IDNTY-NO-TYPE,                  23820000
                    :DCLGRANT-RCVRY.AMT-GRANT-RCVR,                     23830000
                    :DCLGRANT-RCVRY.AMT-GRANT-RCVR-INTRST,              23840000
                    :DCLGRANT-RCVRY.DTE-RQST-RCVR,                      23850000
                    :DCLGRANT-RCVRY.DTE-RCV-RCVR-GRANT,                 23860000
                    :DCLGRANT-RCVRY.DTE-ACK-GRANT-RCVRY-CPF,            23870000
                    :DCLGRANT-RCVRY.DTE-GRANT-ABORT,                    23880000
                    :DCLGRANT-RCVRY.DTE-GRANT-RPDT,                     23890000
                    :DCLGRANT-RCVRY.NUM-TRNSFR,                         23900000
                    :DCLGRANT-RCVRY.DTE-TRNSFR,                         23910000
                    :DCLGRANT-RCVRY.NUM-ACNT,                           23920000
                    :DCLGRANT-RCVRY.NUM-SCHEME,                         23930000
                    :DCLGRANT-RCVRY.NUM-TNCY,                           23940000
                    :DCLGRANT-RCVRY.DTE-CPF-GRANT-RQST,                 23950000
                    :DCLGRANT-RCVRY.DTE-CPF-GRANT-RCV,                  23960000
                    :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RQST,              23970000
                    :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RCV,               23980000
                    :DCLGRANT-RCVRY.DTE-USED-GRANT-RQST,                23990000
                    :DCLGRANT-RCVRY.DTE-USED-GRANT-RCV                  24000000
              FROM                                                      24010000
                GRANT_RCVRY                                             24020000
              WHERE                                                     24030000
                NUM_RGSTRN = :DCLGRANT-RCVRY.NUM-RGSTRN AND             24040000
                NUM_GRANT_TYPE = :DCLGRANT-RCVRY.NUM-GRANT-TYPE AND     24050000
                NUM_IDNTY_NO = :DCLGRANT-RCVRY.NUM-IDNTY-NO             24060000
           END-EXEC.                                                    24070000
                                                                        24080000
           EVALUATE SQLCODE                                             24090000
           WHEN WS-SQL-OK                                               24100000
           WHEN WS-SQL-DUPREC                                           24110000
           WHEN WS-SQL-MORE-ROWS                                        24120000
                MOVE 'Y' TO WS-GRANT-RCVRY-FND                          24130000
                                                                        24140000
           WHEN WS-SQL-NFND                                             24150000
                MOVE 'N' TO WS-GRANT-RCVRY-FND                          24160000
                                                                        24170000
           WHEN OTHER                                                   24180000
                MOVE SQLCODE   TO WS-SQLCODE                            24190000
                DISPLAY 'ERROR READING GRANT_RCVRY'                     24200000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      24210000
                DISPLAY SPACES                                          24220000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              24230000
           END-EVALUATE.                                                24240000
                                                                        24250000
       5700-EXIT.                                                       24260000
           EXIT.                                                        24270000
                                                                        24280000
      *-------------------*                                             24290000
       5730-MOVE-RCVRY-AHG.                                             24300000
      *-------------------*                                             24310000
           MOVE AHG-AMT-AHG-GRANT-RECOVER(WS-CTR)                       24320000
                      TO AMT-GRANT-RCVR OF DCLGRANT-RCVRY.              24330000
           MOVE AHG-AMT-AHG-RECOVER-INT(WS-CTR)                         24340000
                      TO AMT-GRANT-RCVR-INTRST OF DCLGRANT-RCVRY.       24350000
           MOVE '0001-01-01' TO DTE-GRANT-ABORT OF DCLGRANT-RCVRY.      24360000
                                                                        24370000
           MOVE WS-PREV-REGN      TO NUM-RGSTRN OF DCLGRANT-RCVRY.      24380000
           MOVE AHG-NUM-NRIC(WS-CTR)                                    24390000
                                  TO NUM-IDNTY-NO OF DCLGRANT-RCVRY.    24400000
           EVALUATE TRUE                                                24410000
           WHEN AHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'                  24420000
             MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          24430000
           WHEN AHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'           24440001
             MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          24450000
           WHEN OTHER                                                   24460000
             MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          24470000
           END-EVALUATE.                                                24480000
           STRING AHG-DTE-REQ(WS-CTR)(1:4) '-'                          24490000
                  AHG-DTE-REQ(WS-CTR)(5:2) '-'                          24500000
                  AHG-DTE-REQ(WS-CTR)(7:2)                              24510000
                DELIMITED BY SIZE                                       24520000
                INTO DTE-RQST-RCVR OF DCLGRANT-RCVRY.                   24530000
                                                                        24540000
           STRING AHG-DTE-RECPT-CPFB(WS-CTR)(1:4) '-'                   24550000
                  AHG-DTE-RECPT-CPFB(WS-CTR)(5:2) '-'                   24560000
                  AHG-DTE-RECPT-CPFB(WS-CTR)(7:2)                       24570000
                DELIMITED BY SIZE                                       24580000
                INTO DTE-ACK-GRANT-RCVRY-CPF OF DCLGRANT-RCVRY.         24590000
           STRING AHG-DTE-REPUDIATION(WS-CTR)(1:4) '-'                  24600000
                  AHG-DTE-REPUDIATION(WS-CTR)(5:2) '-'                  24610000
                  AHG-DTE-REPUDIATION(WS-CTR)(7:2)                      24620000
                DELIMITED BY SIZE                                       24630000
                INTO DTE-GRANT-RPDT OF DCLGRANT-RCVRY.                  24640000
           MOVE AHG-NUM-TRANSFEROR(WS-CTR)                              24650000
                         TO NUM-TRNSFR OF DCLGRANT-RCVRY.               24660000
           STRING AHG-DTE-TRANSFER(WS-CTR)(1:4) '-'                     24670000
                  AHG-DTE-TRANSFER(WS-CTR)(5:2) '-'                     24680000
                  AHG-DTE-TRANSFER(WS-CTR)(7:2)                         24690000
                DELIMITED BY SIZE                                       24700000
                       INTO DTE-TRNSFR OF DCLGRANT-RCVRY.               24710000
           STRING AHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(1:4) '-'          24720000
                  AHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(5:2) '-'          24730000
                  AHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(7:2)              24740000
                DELIMITED BY SIZE                                       24750000
                       INTO DTE-CPF-GRANT-RQST OF DCLGRANT-RCVRY.       24760000
           STRING AHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(1:4) '-'         24770000
                  AHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(5:2) '-'         24780000
                  AHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(7:2)             24790000
                DELIMITED BY SIZE                                       24800000
                       INTO DTE-CPF-GRANT-RCV OF DCLGRANT-RCVRY.        24810000
           STRING AHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(1:4) '-'             24820000
                  AHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(5:2) '-'             24830000
                  AHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(7:2)                 24840000
                DELIMITED BY SIZE                                       24850000
                       INTO DTE-UNUSED-GRANT-RQST OF DCLGRANT-RCVRY.    24860000
           STRING AHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(1:4) '-'            24870000
                  AHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(5:2) '-'            24880000
                  AHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(7:2)                24890000
                DELIMITED BY SIZE                                       24900000
                       INTO DTE-UNUSED-GRANT-RCV OF DCLGRANT-RCVRY.     24910000
           STRING AHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(1:4) '-'            24920000
                  AHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(5:2) '-'            24930000
                  AHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(7:2)                24940000
                DELIMITED BY SIZE                                       24950000
                       INTO DTE-USED-GRANT-RQST OF DCLGRANT-RCVRY.      24960000
           STRING AHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(1:4) '-'           24970000
                  AHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(5:2) '-'           24980000
                  AHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(7:2)               24990000
                DELIMITED BY SIZE                                       25000000
                       INTO DTE-USED-GRANT-RCV OF DCLGRANT-RCVRY.       25010000
                                                                        25020000
       5730-EXIT.                                                       25030000
           EXIT.                                                        25040000
                                                                        25050000
      *-------------------*                                             25060000
       5740-MOVE-RCVRY-SHG.                                             25070000
      *-------------------*                                             25080000
           MOVE SHG-AMT-SHG-GRANT-RECOVER(WS-CTR)                       25090000
                      TO AMT-GRANT-RCVR OF DCLGRANT-RCVRY.              25100000
           MOVE SHG-AMT-GRANT-RECOVER-INT(WS-CTR)                       25110000
                      TO AMT-GRANT-RCVR-INTRST OF DCLGRANT-RCVRY.       25120000
           MOVE '0001-01-01' TO DTE-GRANT-ABORT OF DCLGRANT-RCVRY.      25130000
                                                                        25140000
           MOVE WS-PREV-REGN      TO NUM-RGSTRN OF DCLGRANT-RCVRY.      25150000
           MOVE SHG-NUM-NRIC(WS-CTR)                                    25160000
                                  TO NUM-IDNTY-NO OF DCLGRANT-RCVRY.    25170000
           EVALUATE TRUE                                                25180000
           WHEN SHG-NUM-NRIC(WS-CTR)(1:1) = 'S' OR 'T'                  25190000
             MOVE 'UIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          25200000
           WHEN SHG-NUM-NRIC(WS-CTR)(1:1) = 'F' OR 'G' OR 'M'           25210001
             MOVE 'FIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          25220000
           WHEN OTHER                                                   25230000
             MOVE 'XIN' TO NUM-IDNTY-NO-TYPE OF DCLGRANT-RCVRY          25240000
           END-EVALUATE.                                                25250000
           STRING SHG-DTE-REQ(WS-CTR)(1:4) '-'                          25260000
                  SHG-DTE-REQ(WS-CTR)(5:2) '-'                          25270000
                  SHG-DTE-REQ(WS-CTR)(7:2)                              25280000
                DELIMITED BY SIZE                                       25290000
                   INTO DTE-RQST-RCVR OF DCLGRANT-RCVRY.                25300000
                                                                        25310000
           STRING SHG-DTE-RECPT-CPFB(WS-CTR)(1:4) '-'                   25320000
                  SHG-DTE-RECPT-CPFB(WS-CTR)(5:2) '-'                   25330000
                  SHG-DTE-RECPT-CPFB(WS-CTR)(7:2)                       25340000
                DELIMITED BY SIZE                                       25350000
                   INTO DTE-ACK-GRANT-RCVRY-CPF OF DCLGRANT-RCVRY.      25360000
           STRING SHG-DTE-REPUDIATION(WS-CTR)(1:4) '-'                  25370000
                  SHG-DTE-REPUDIATION(WS-CTR)(5:2) '-'                  25380000
                  SHG-DTE-REPUDIATION(WS-CTR)(7:2)                      25390000
                DELIMITED BY SIZE                                       25400000
                   INTO DTE-GRANT-RPDT OF DCLGRANT-RCVRY.               25410000
           MOVE SHG-NUM-TRANSFEROR(WS-CTR)                              25420000
                         TO NUM-TRNSFR OF DCLGRANT-RCVRY.               25430000
           STRING SHG-DTE-TRANSFER(WS-CTR)(1:4) '-'                     25440000
                  SHG-DTE-TRANSFER(WS-CTR)(5:2) '-'                     25450000
                  SHG-DTE-TRANSFER(WS-CTR)(7:2)                         25460000
                DELIMITED BY SIZE                                       25470000
                   INTO DTE-TRNSFR OF DCLGRANT-RCVRY.                   25480000
           STRING SHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(1:4) '-'          25490000
                  SHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(5:2) '-'          25500000
                  SHG-DTE-REQ-GRANT-USED-CPFB(WS-CTR)(7:2)              25510000
                DELIMITED BY SIZE                                       25520000
                   INTO DTE-CPF-GRANT-RQST OF DCLGRANT-RCVRY.           25530000
           STRING SHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(1:4) '-'         25540000
                  SHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(5:2) '-'         25550000
                  SHG-DTE-RECD-GRANT-USED-CPFB(WS-CTR)(7:2)             25560000
                DELIMITED BY SIZE                                       25570000
                   INTO DTE-CPF-GRANT-RCV OF DCLGRANT-RCVRY.            25580000
           STRING SHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(1:4) '-'             25590000
                  SHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(5:2) '-'             25600000
                  SHG-DTE-REQ-GRANT-UNUSED(WS-CTR)(7:2)                 25610000
                DELIMITED BY SIZE                                       25620000
                   INTO DTE-UNUSED-GRANT-RQST OF DCLGRANT-RCVRY.        25630000
           STRING SHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(1:4) '-'            25640000
                  SHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(5:2) '-'            25650000
                  SHG-DTE-RECD-GRANT-UNUSED(WS-CTR)(7:2)                25660000
                DELIMITED BY SIZE                                       25670000
                   INTO DTE-UNUSED-GRANT-RCV OF DCLGRANT-RCVRY.         25680000
           STRING SHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(1:4) '-'            25690000
                  SHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(5:2) '-'            25700000
                  SHG-DTE-REQ-GRANT-USED-HA(WS-CTR)(7:2)                25710000
                DELIMITED BY SIZE                                       25720000
                   INTO DTE-USED-GRANT-RQST OF DCLGRANT-RCVRY.          25730000
           STRING SHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(1:4) '-'           25740000
                  SHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(5:2) '-'           25750000
                  SHG-DTE-RECD-GRANT-USED-HA(WS-CTR)(7:2)               25760000
                DELIMITED BY SIZE                                       25770000
                   INTO DTE-USED-GRANT-RCV OF DCLGRANT-RCVRY.           25780000
                                                                        25790000
       5740-EXIT.                                                       25800000
           EXIT.                                                        25810000
                                                                        25820000
      *------------------------*                                        25830000
       5800-INSERT-GRANT-RCVRY.                                         25840000
      *------------------------*                                        25850000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-RCVRY.      25860000
           MOVE WS-TIMESTAMP  TO TME-CREATE OF DCLGRANT-RCVRY.          25870000
           MOVE '0001-01-01' TO DTE-RCV-RCVR-GRANT OF DCLGRANT-RCVRY.   25880000
           MOVE WS-NUM-SCH                                              25890000
                         TO NUM-SCHEME OF DCLGRANT-RCVRY.               25900000
           MOVE WS-NUM-ACNT                                             25910000
                         TO NUM-ACNT OF DCLGRANT-RCVRY.                 25920000
           MOVE WS-NUM-LESSEE-CODE                                      25930000
                         TO NUM-TNCY OF DCLGRANT-RCVRY.                 25940000
           MOVE 'BP13CB0K' TO NUM-UPDATE-USERID OF DCLGRANT-RCVRY.      25950000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              25960000
                  WS-DTE-CCYYMMDD(5:2) '-'                              25970000
                  WS-DTE-CCYYMMDD(7:2)                                  25980000
                  DELIMITED BY SIZE                                     25990000
                  INTO DTE-UPDATE OF DCLGRANT-RCVRY.                    26000000
           STRING WS-TIME-HHMMSS(1:2) '.'                               26010000
                  WS-TIME-HHMMSS(3:2) '.'                               26020000
                  WS-TIME-HHMMSS(5:2)                                   26030000
                  DELIMITED BY SIZE                                     26040000
                  INTO TME-UPDATE OF DCLGRANT-RCVRY.                    26050000
                                                                        26060000
            EXEC SQL                                                    26070000
                 INSERT INTO GRANT_RCVRY                                26080000
                        ( NUM_RGSTRN,                                   26090000
                          NUM_GRANT_TYPE,                               26100000
                          TME_CREATE,                                   26110000
                          NUM_IDNTY_NO,                                 26120000
                          NUM_IDNTY_NO_TYPE,                            26130000
                          AMT_GRANT_RCVR,                               26140000
                          AMT_GRANT_RCVR_INTRST,                        26150000
                          DTE_RQST_RCVR,                                26160000
                          DTE_RCV_RCVR_GRANT,                           26170000
                          DTE_ACK_GRANT_RCVRY_CPF,                      26180000
                          DTE_GRANT_ABORT,                              26190000
                          DTE_GRANT_RPDT,                               26200000
                          NUM_TRNSFR,                                   26210000
                          DTE_TRNSFR,                                   26220000
                          NUM_ACNT,                                     26230000
                          NUM_SCHEME,                                   26240000
                          NUM_TNCY,                                     26250000
                          DTE_CPF_GRANT_RQST,                           26260000
                          DTE_CPF_GRANT_RCV,                            26270000
                          DTE_UNUSED_GRANT_RQST,                        26280000
                          DTE_UNUSED_GRANT_RCV,                         26290000
                          DTE_USED_GRANT_RQST,                          26300000
                          DTE_USED_GRANT_RCV,                           26310000
                          NUM_UPDATE_USERID,                            26320000
                          DTE_UPDATE,                                   26330000
                          TME_UPDATE )                                  26340000
                 VALUES ( :DCLGRANT-RCVRY.NUM-RGSTRN,                   26350000
                          :DCLGRANT-RCVRY.NUM-GRANT-TYPE,               26360000
                          :DCLGRANT-RCVRY.TME-CREATE,                   26370000
                          :DCLGRANT-RCVRY.NUM-IDNTY-NO,                 26380000
                          :DCLGRANT-RCVRY.NUM-IDNTY-NO-TYPE,            26390000
                          :DCLGRANT-RCVRY.AMT-GRANT-RCVR,               26400000
                          :DCLGRANT-RCVRY.AMT-GRANT-RCVR-INTRST,        26410000
                          :DCLGRANT-RCVRY.DTE-RQST-RCVR,                26420000
                          :DCLGRANT-RCVRY.DTE-RCV-RCVR-GRANT,           26430000
                          :DCLGRANT-RCVRY.DTE-ACK-GRANT-RCVRY-CPF,      26440000
                          :DCLGRANT-RCVRY.DTE-GRANT-ABORT,              26450000
                          :DCLGRANT-RCVRY.DTE-GRANT-RPDT,               26460000
                          :DCLGRANT-RCVRY.NUM-TRNSFR,                   26470000
                          :DCLGRANT-RCVRY.DTE-TRNSFR,                   26480000
                          :DCLGRANT-RCVRY.NUM-ACNT,                     26490000
                          :DCLGRANT-RCVRY.NUM-SCHEME,                   26500000
                          :DCLGRANT-RCVRY.NUM-TNCY,                     26510000
                          :DCLGRANT-RCVRY.DTE-CPF-GRANT-RQST,           26520000
                          :DCLGRANT-RCVRY.DTE-CPF-GRANT-RCV,            26530000
                          :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RQST,        26540000
                          :DCLGRANT-RCVRY.DTE-UNUSED-GRANT-RCV,         26550000
                          :DCLGRANT-RCVRY.DTE-USED-GRANT-RQST,          26560000
                          :DCLGRANT-RCVRY.DTE-USED-GRANT-RCV,           26570000
                          :DCLGRANT-RCVRY.NUM-UPDATE-USERID,            26580000
                          :DCLGRANT-RCVRY.DTE-UPDATE,                   26590000
                          :DCLGRANT-RCVRY.TME-UPDATE )                  26600000
            END-EXEC.                                                   26610000
                                                                        26620000
            EVALUATE SQLCODE                                            26630000
               WHEN 000                                                 26640000
                    ADD 1                 TO CNT-RCVRY-INSERT           26650000
                    MOVE 'GRANT_RCVRY'  TO WS-SOURCE                    26660000
                    MOVE 'C'            TO WS-ACTION                    26670000
                    MOVE NUM-RGSTRN OF DCLGRANT-RCVRY TO WS-RGSTRN      26680000
                    MOVE NUM-GRANT-TYPE OF DCLGRANT-RCVRY               26690000
                                        TO WS-GRNT-TYPE                 26700000
                    MOVE SPACES         TO WS-BEFORE-IMAGE              26710000
                    MOVE DCLGRANT-RCVRY TO WS-AFTER-IMAGE               26720000
                    PERFORM 8000-INSERT-TO-LOG THRU 8000-EXIT           26730000
                    PERFORM 9100-COMMIT        THRU 9100-EXIT           26740000
                                                                        26750000
               WHEN -803                                                26760000
                    CONTINUE                                            26770000
                                                                        26780000
               WHEN OTHER                                               26790000
                    MOVE SQLCODE          TO WS-SQLCODE                 26800000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_RCVRY'         26810000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            26820000
                    DISPLAY DCLGRANT-RCVRY                              26830000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          26840000
            END-EVALUATE.                                               26850000
                                                                        26860000
       5800-EXIT.                                                       26870000
           EXIT.                                                        26880000
                                                                        26890000
      *-------------------------*                                       26900000
       6000-READ-EX-GRANT-ASMNT.                                        26910000
      *-------------------------*                                       26920000
           MOVE WS-NUM-REGN      TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT.    26930000
           MOVE WS-GRANT-TYPE    TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT.26940000
                                                                        26950000
           MOVE 'N'              TO WS-EX-GRANT-ASMNT-FND.              26960000
                                                                        26970000
           EXEC SQL                                                     26980000
              SELECT NUM_RGSTRN,                                        26990000
                     NUM_GRANT_TYPE,                                    27000000
                     TME_CREATE,                                        27010000
                     NUM_ELGBL_GRANT,                                   27020000
                     NUM_GRANT_AMOUNT_ELGBL,                            27030000
                     NUM_GRANT_STATUS,                                  27040000
                     DTE_APRV,                                          27050000
                     DTE_CANCEL,                                        27060000
                     DTE_REJECT,                                        27070000
                     DTE_SUBMIT,                                        27080000
                     DTE_WTHDRW,                                        27090000
                     NUM_RJCTN_REASON,                                  27100000
                     NUM_WTDRWL_REASON,                                 27110000
                     TXT_CNCLTN_REASON,                                 27120000
                     DTE_GRANT_RQST,                                    27130000
                     NUM_GRANT_DOC_RCV,                                 27140000
                     DTE_ACK,                                           27150000
                     DTE_GRANT_FORM_ISSUE,                              27160000
                     DTE_GRANT_OPT_OUT_FORM_ISSUE,                      27170000
                     NUM_GRANT_OPT_OUT_REASON,                          27180000
                     DTE_GRANT_OPT_OUT_REASON,                          27190000
                     NUM_ALCTN_SCHEME,                                  27200000
                     NUM_HSHLD_CTZNSP,                                  27210000
                     NUM_WRKNG_CHILD_ASMNT,                             27220000
                     QTY_MONTH_WORK,                                    27230000
                     NUM_APPEAL_ATCHMT,                                 27240000
                     NUM_PARENT_ADRS_BLDNG,                             27250000
                     NUM_PARENT_ADRS_LEVEL,                             27260000
                     NUM_PARENT_ADRS_UNIT,                              27270000
                     TXT_PARENT_ADRS1,                                  27280000
                     TXT_PARENT_ADRS2,                                  27290000
                     NUM_PARENT_ADRS_POSTAL,                            27300000
                     DTE_PYMNT,                                         27310000
                     DTE_CPF_ACK_GRANT_RCV,                             27320000
                     NUM_GRANT_CREDIT,                                  27330000
                     TME_APNTMT,                                        27340000
                     DTE_APNTMT,                                        27350000
                     TME_CREATE_ASMNT,                                  27360000
                     NUM_UPDATE_USERID,                                 27370000
                     TME_UPDATE,                                        27380000
                     DTE_UPDATE,                                        27390000
                     NUM_SOURCE_SYSTEM,                                 27400000
                     NUM_ACNT,                                          27410000
                     NUM_SCHEME,                                        27420000
                     NUM_TNCY,                                          27430000
                     NUM_HALF_GRANT                                     27440000
              INTO  :DCLEX-GRANT-ASMNT.NUM-RGSTRN,                      27450000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-TYPE,                  27460000
                    :DCLEX-GRANT-ASMNT.TME-CREATE,                      27470000
                    :DCLEX-GRANT-ASMNT.NUM-ELGBL-GRANT,                 27480000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,          27490000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-STATUS,                27500000
                    :DCLEX-GRANT-ASMNT.DTE-APRV,                        27510000
                    :DCLEX-GRANT-ASMNT.DTE-CANCEL,                      27520000
                    :DCLEX-GRANT-ASMNT.DTE-REJECT,                      27530000
                    :DCLEX-GRANT-ASMNT.DTE-SUBMIT,                      27540000
                    :DCLEX-GRANT-ASMNT.DTE-WTHDRW,                      27550000
                    :DCLEX-GRANT-ASMNT.NUM-RJCTN-REASON,                27560000
                    :DCLEX-GRANT-ASMNT.NUM-WTDRWL-REASON,               27570000
                    :DCLEX-GRANT-ASMNT.TXT-CNCLTN-REASON,               27580000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-RQST,                  27590000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-DOC-RCV,               27600000
                    :DCLEX-GRANT-ASMNT.DTE-ACK,                         27610000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-FORM-ISSUE,            27620000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,    27630000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,        27640000
                    :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,        27650000
                    :DCLEX-GRANT-ASMNT.NUM-ALCTN-SCHEME,                27660000
                    :DCLEX-GRANT-ASMNT.NUM-HSHLD-CTZNSP,                27670000
                    :DCLEX-GRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,           27680000
                    :DCLEX-GRANT-ASMNT.QTY-MONTH-WORK,                  27690000
                    :DCLEX-GRANT-ASMNT.NUM-APPEAL-ATCHMT,               27700000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,           27710000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,           27720000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-UNIT,            27730000
                    :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS1,                27740000
                    :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS2,                27750000
                    :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,          27760000
                    :DCLEX-GRANT-ASMNT.DTE-PYMNT,                       27770000
                    :DCLEX-GRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,           27780000
                    :DCLEX-GRANT-ASMNT.NUM-GRANT-CREDIT,                27790000
                    :DCLEX-GRANT-ASMNT.TME-APNTMT,                      27800000
                    :DCLEX-GRANT-ASMNT.DTE-APNTMT,                      27810000
                    :DCLEX-GRANT-ASMNT.TME-CREATE-ASMNT,                27820000
                    :DCLEX-GRANT-ASMNT.NUM-UPDATE-USERID,               27830000
                    :DCLEX-GRANT-ASMNT.TME-UPDATE,                      27840000
                    :DCLEX-GRANT-ASMNT.DTE-UPDATE,                      27850000
                    :DCLEX-GRANT-ASMNT.NUM-SOURCE-SYSTEM,               27860000
                    :DCLEX-GRANT-ASMNT.NUM-ACNT,                        27870000
                    :DCLEX-GRANT-ASMNT.NUM-SCHEME,                      27880000
                    :DCLEX-GRANT-ASMNT.NUM-TNCY,                        27890000
                    :DCLEX-GRANT-ASMNT.NUM-HALF-GRANT                   27900000
              FROM                                                      27910000
                EX_GRANT_ASMNT                                          27920000
              WHERE NUM_RGSTRN       = :DCLEX-GRANT-ASMNT.NUM-RGSTRN    27930000
               AND  NUM_GRANT_TYPE   = :DCLEX-GRANT-ASMNT.NUM-GRANT-TYPE27940000
           END-EXEC.                                                    27950000
                                                                        27960000
           EVALUATE SQLCODE                                             27970000
           WHEN WS-SQL-OK                                               27980000
                MOVE 'Y' TO WS-EX-GRANT-ASMNT-FND                       27990000
                                                                        28000000
           WHEN WS-SQL-NFND                                             28010000
                MOVE 'N' TO WS-EX-GRANT-ASMNT-FND                       28020000
                                                                        28030000
           WHEN OTHER                                                   28040000
                MOVE SQLCODE   TO WS-SQLCODE                            28050000
                DISPLAY 'ERROR READING EX_GRANT_ASMNT'                  28060000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      28070000
                DISPLAY SPACES                                          28080000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              28090000
           END-EVALUATE.                                                28100000
                                                                        28110000
       6000-EXIT.                                                       28120000
           EXIT.                                                        28130000
                                                                        28140000
      *--------------------------*                                      28150000
       6100-INSERT-EX-GRANT-ASMNT.                                      28160000
      *--------------------------*                                      28170000
           MOVE WS-PREV-REGN  TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT.       28180000
           MOVE WS-GRANT-TYPE TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT.   28190000
           MOVE WS-TIMESTAMP TO TME-CREATE OF DCLEX-GRANT-ASMNT.        28200000
           MOVE '0001-01-01' TO DTE-CANCEL OF DCLEX-GRANT-ASMNT.        28210000
           MOVE 'GR'   TO TXT-CNCLTN-REASON OF DCLEX-GRANT-ASMNT.       28220000
           MOVE WS-NUM-ALLO-SCHEME                                      28230000
                       TO NUM-ALCTN-SCHEME OF DCLEX-GRANT-ASMNT.        28240000
           MOVE WS-CDE-CITIZENSHIP-HOUSEHOLD                            28250000
                 TO NUM-HSHLD-CTZNSP OF DCLEX-GRANT-ASMNT.              28260000
           MOVE SPACES TO NUM-WRKNG-CHILD-ASMNT OF DCLEX-GRANT-ASMNT.   28270000
           MOVE ZEROES TO QTY-MONTH-WORK OF DCLEX-GRANT-ASMNT.          28280000
           MOVE SPACES TO NUM-APPEAL-ATCHMT OF DCLEX-GRANT-ASMNT.       28290000
           MOVE SPACES                                                  28300000
                    TO NUM-PARENT-ADRS-BLDNG OF DCLEX-GRANT-ASMNT       28310000
                       NUM-PARENT-ADRS-LEVEL OF DCLEX-GRANT-ASMNT       28320000
                       NUM-PARENT-ADRS-UNIT OF DCLEX-GRANT-ASMNT        28330000
                       TXT-PARENT-ADRS1 OF DCLEX-GRANT-ASMNT            28340000
                       TXT-PARENT-ADRS2 OF DCLEX-GRANT-ASMNT            28350000
                       NUM-PARENT-ADRS-POSTAL OF DCLEX-GRANT-ASMNT.     28360000
           STRING WS-DTE-CPF-ACK-GRANT(1:4) '-'                         28370000
                  WS-DTE-CPF-ACK-GRANT(5:2) '-'                         28380000
                  WS-DTE-CPF-ACK-GRANT(7:2)                             28390000
                DELIMITED BY SIZE                                       28400000
                   INTO DTE-CPF-ACK-GRANT-RCV OF DCLEX-GRANT-ASMNT.     28410000
           MOVE WS-NUM-GRANT-CREDIT-TAG                                 28420000
                 TO NUM-GRANT-CREDIT OF DCLEX-GRANT-ASMNT.              28430000
           MOVE WS-TIMESTAMP                                            28440000
                 TO TME-CREATE-ASMNT OF DCLEX-GRANT-ASMNT.              28450000
           MOVE 'BP13CB0K'                                              28460000
                 TO NUM-UPDATE-USERID OF DCLEX-GRANT-ASMNT.             28470000
                                                                        28480000
           STRING WS-TIME-HHMMSS(1:2) '.'                               28490000
                  WS-TIME-HHMMSS(3:2) '.'                               28500000
                  WS-TIME-HHMMSS(5:2)                                   28510000
                DELIMITED BY SIZE INTO TME-UPDATE OF DCLEX-GRANT-ASMNT. 28520000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              28530000
                  WS-DTE-CCYYMMDD(5:2) '-'                              28540000
                  WS-DTE-CCYYMMDD(7:2)                                  28550000
                DELIMITED BY SIZE INTO DTE-UPDATE OF DCLEX-GRANT-ASMNT. 28560000
                                                                        28570000
           MOVE 'BP13' TO NUM-SOURCE-SYSTEM OF DCLEX-GRANT-ASMNT.       28580000
           MOVE WS-NUM-SCH TO NUM-SCHEME OF DCLEX-GRANT-ASMNT.          28590000
           MOVE WS-NUM-ACNT TO NUM-ACNT OF DCLEX-GRANT-ASMNT.           28600000
           MOVE WS-NUM-LESSEE-CODE TO NUM-TNCY OF DCLEX-GRANT-ASMNT.    28610000
                                                                        28620000
            EXEC SQL                                                    28630000
                 INSERT INTO EX_GRANT_ASMNT                             28640000
                        ( NUM_RGSTRN,                                   28650000
                          NUM_GRANT_TYPE,                               28660000
                          TME_CREATE,                                   28670000
                          NUM_ELGBL_GRANT,                              28680000
                          NUM_GRANT_AMOUNT_ELGBL,                       28690000
                          NUM_GRANT_STATUS,                             28700000
                          DTE_APRV,                                     28710000
                          DTE_CANCEL,                                   28720000
                          DTE_REJECT,                                   28730000
                          DTE_SUBMIT,                                   28740000
                          DTE_WTHDRW,                                   28750000
                          NUM_RJCTN_REASON,                             28760000
                          NUM_WTDRWL_REASON,                            28770000
                          TXT_CNCLTN_REASON,                            28780000
                          DTE_GRANT_RQST,                               28790000
                          NUM_GRANT_DOC_RCV,                            28800000
                          DTE_ACK,                                      28810000
                          DTE_GRANT_FORM_ISSUE,                         28820000
                          DTE_GRANT_OPT_OUT_FORM_ISSUE,                 28830000
                          NUM_GRANT_OPT_OUT_REASON,                     28840000
                          DTE_GRANT_OPT_OUT_REASON,                     28850000
                          NUM_ALCTN_SCHEME,                             28860000
                          NUM_HSHLD_CTZNSP,                             28870000
                          NUM_WRKNG_CHILD_ASMNT,                        28880000
                          QTY_MONTH_WORK,                               28890000
                          NUM_APPEAL_ATCHMT,                            28900000
                          NUM_PARENT_ADRS_BLDNG,                        28910000
                          NUM_PARENT_ADRS_LEVEL,                        28920000
                          NUM_PARENT_ADRS_UNIT,                         28930000
                          TXT_PARENT_ADRS1,                             28940000
                          TXT_PARENT_ADRS2,                             28950000
                          NUM_PARENT_ADRS_POSTAL,                       28960000
                          DTE_PYMNT,                                    28970000
                          DTE_CPF_ACK_GRANT_RCV,                        28980000
                          NUM_GRANT_CREDIT,                             28990000
                          TME_APNTMT,                                   29000000
                          DTE_APNTMT,                                   29010000
                          TME_CREATE_ASMNT,                             29020000
                          NUM_UPDATE_USERID,                            29030000
                          TME_UPDATE,                                   29040000
                          DTE_UPDATE,                                   29050000
                          NUM_SOURCE_SYSTEM,                            29060000
                          NUM_ACNT,                                     29070000
                          NUM_SCHEME,                                   29080000
                          NUM_TNCY,                                     29090000
                          NUM_HALF_GRANT )                              29100000
                 VALUES ( :DCLEX-GRANT-ASMNT.NUM-RGSTRN,                29110000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-TYPE,            29120000
                          :DCLEX-GRANT-ASMNT.TME-CREATE,                29130000
                          :DCLEX-GRANT-ASMNT.NUM-ELGBL-GRANT,           29140000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-AMOUNT-ELGBL,    29150000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-STATUS,          29160000
                          :DCLEX-GRANT-ASMNT.DTE-APRV,                  29170000
                          :DCLEX-GRANT-ASMNT.DTE-CANCEL,                29180000
                          :DCLEX-GRANT-ASMNT.DTE-REJECT,                29190000
                          :DCLEX-GRANT-ASMNT.DTE-SUBMIT,                29200000
                          :DCLEX-GRANT-ASMNT.DTE-WTHDRW,                29210000
                          :DCLEX-GRANT-ASMNT.NUM-RJCTN-REASON,          29220000
                          :DCLEX-GRANT-ASMNT.NUM-WTDRWL-REASON,         29230000
                          :DCLEX-GRANT-ASMNT.TXT-CNCLTN-REASON,         29240000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-RQST,            29250000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-DOC-RCV,         29260000
                          :DCLEX-GRANT-ASMNT.DTE-ACK,                   29270000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-FORM-ISSUE,      29280000
                        :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-FORM-ISSUE,29290000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-OPT-OUT-REASON,  29300000
                          :DCLEX-GRANT-ASMNT.DTE-GRANT-OPT-OUT-REASON,  29310000
                          :DCLEX-GRANT-ASMNT.NUM-ALCTN-SCHEME,          29320000
                          :DCLEX-GRANT-ASMNT.NUM-HSHLD-CTZNSP,          29330000
                          :DCLEX-GRANT-ASMNT.NUM-WRKNG-CHILD-ASMNT,     29340000
                          :DCLEX-GRANT-ASMNT.QTY-MONTH-WORK,            29350000
                          :DCLEX-GRANT-ASMNT.NUM-APPEAL-ATCHMT,         29360000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-BLDNG,     29370000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-LEVEL,     29380000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-UNIT,      29390000
                          :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS1,          29400000
                          :DCLEX-GRANT-ASMNT.TXT-PARENT-ADRS2,          29410000
                          :DCLEX-GRANT-ASMNT.NUM-PARENT-ADRS-POSTAL,    29420000
                          :DCLEX-GRANT-ASMNT.DTE-PYMNT,                 29430000
                          :DCLEX-GRANT-ASMNT.DTE-CPF-ACK-GRANT-RCV,     29440000
                          :DCLEX-GRANT-ASMNT.NUM-GRANT-CREDIT,          29450000
                          :DCLEX-GRANT-ASMNT.TME-APNTMT,                29460000
                          :DCLEX-GRANT-ASMNT.DTE-APNTMT,                29470000
                          :DCLEX-GRANT-ASMNT.TME-CREATE-ASMNT,          29480000
                          :DCLEX-GRANT-ASMNT.NUM-UPDATE-USERID,         29490000
                          :DCLEX-GRANT-ASMNT.TME-UPDATE,                29500000
                          :DCLEX-GRANT-ASMNT.DTE-UPDATE,                29510000
                          :DCLEX-GRANT-ASMNT.NUM-SOURCE-SYSTEM,         29520000
                          :DCLEX-GRANT-ASMNT.NUM-ACNT,                  29530000
                          :DCLEX-GRANT-ASMNT.NUM-SCHEME,                29540000
                          :DCLEX-GRANT-ASMNT.NUM-TNCY,                  29550000
                          :DCLEX-GRANT-ASMNT.NUM-HALF-GRANT )           29560000
            END-EXEC.                                                   29570000
                                                                        29580000
            EVALUATE SQLCODE                                            29590000
               WHEN 000                                                 29600000
                    MOVE 'Y'               TO WS-EX-INSERT              29610000
                    ADD 1                  TO CNT-EX-ASMNT-INS          29620000
                    MOVE 'EX_GRANT_ASMNT'  TO WS-SOURCE                 29630000
                    MOVE 'C'               TO WS-ACTION                 29640000
                    MOVE NUM-RGSTRN OF DCLEX-GRANT-ASMNT TO WS-RGSTRN   29650000
                    MOVE NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT            29660000
                                                  TO WS-GRNT-TYPE       29670000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           29680000
                    MOVE DCLEX-GRANT-ASMNT TO WS-AFTER-IMAGE            29690000
                    PERFORM 8000-INSERT-TO-LOG   THRU 8000-EXIT         29700000
                    PERFORM 9100-COMMIT          THRU 9100-EXIT         29710000
                                                                        29720000
               WHEN -803                                                29730000
                    CONTINUE                                            29740000
                                                                        29750000
               WHEN OTHER                                               29760000
                    MOVE SQLCODE          TO WS-SQLCODE                 29770000
                    DISPLAY 'SQL ERROR (INSERT) IN EX_GRANT_ASMNT'      29780000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            29790000
                    DISPLAY DCLEX-GRANT-ASMNT                           29800000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          29810000
            END-EVALUATE.                                               29820000
                                                                        29830000
       6100-EXIT.                                                       29840000
           EXIT.                                                        29850000
                                                                        29860000
      *------------------------*                                        29870000
       6300-READ-EX-GRANT-PRSN.                                         29880000
      *------------------------*                                        29890000
           MOVE WS-NUM-REGN TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON.  29900000
           MOVE WS-GRANT-TYPE                                           29910000
                          TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON.29920000
           MOVE WS-NUM-NRIC TO NUM-IDNTY-NO OF DCLEX-GRANT-ASMNT-PERSON.29930000
                                                                        29940000
           MOVE 'N'              TO WS-EX-GRANT-PRSN-FND.               29950000
                                                                        29960000
           EXEC SQL                                                     29970000
              SELECT NUM_RGSTRN,                                        29980000
                     NUM_GRANT_TYPE,                                    29990000
                     TME_CREATE,                                        30000000
                     NUM_IDNTY_NO,                                      30010000
                     NUM_IDNTY_NO_TYPE,                                 30020000
                     NUM_CSTMR_SOURCE,                                  30030000
                     NUM_CPF_ACNT,                                      30040000
                     AMT_GRANT,                                         30050000
                     AMT_GRANT_USE,                                     30060000
                     NUM_ROLE_TAG,                                      30070000
                     NUM_RLTNSP,                                        30080000
                     NME_PERSON,                                        30090000
                     NUM_GENDER,                                        30100000
                     NUM_CTZNSP,                                        30110000
                     NUM_MRTL_STATUS,                                   30120000
                     AMT_INCOME,                                        30130000
                     NUM_1YR_CNTNS_EMPLY,                               30140000
                     NUM_DEBAR,                                         30150000
                     NUM_DEBAR_REASON,                                  30160000
                     NUM_RCVRY,                                         30170000
                     NUM_UPDATE_USERID,                                 30180000
                     DTE_UPDATE,                                        30190000
                     TME_UPDATE,                                        30200000
                     AMT_GRANT_THRSHD                                   30210000
              INTO  :DCLEX-GRANT-ASMNT-PERSON.NUM-RGSTRN,               30220000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-GRANT-TYPE,           30230000
                    :DCLEX-GRANT-ASMNT-PERSON.TME-CREATE,               30240000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO,             30250000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,        30260000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,         30270000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-CPF-ACNT,             30280000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT,                30290000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-USE,            30300000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-ROLE-TAG,             30310000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-RLTNSP,               30320000
                    :DCLEX-GRANT-ASMNT-PERSON.NME-PERSON,               30330000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-GENDER,               30340000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-CTZNSP,               30350000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-MRTL-STATUS,          30360000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-INCOME,               30370000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,      30380000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR,                30390000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR-REASON,         30400000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-RCVRY,                30410000
                    :DCLEX-GRANT-ASMNT-PERSON.NUM-UPDATE-USERID,        30420000
                    :DCLEX-GRANT-ASMNT-PERSON.DTE-UPDATE,               30430000
                    :DCLEX-GRANT-ASMNT-PERSON.TME-UPDATE,               30440000
                    :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-THRSHD          30450000
              FROM                                                      30460000
                EX_GRANT_ASMNT_PERSON                                   30470000
             WHERE                                                      30480000
              NUM_RGSTRN = :DCLEX-GRANT-ASMNT-PERSON.NUM-RGSTRN AND     30490000
              NUM_GRANT_TYPE = :DCLEX-GRANT-ASMNT-PERSON.NUM-GRANT-TYPE 30500000
             AND  NUM_IDNTY_NO = :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO 30510000
           END-EXEC.                                                    30520000
                                                                        30530000
           EVALUATE SQLCODE                                             30540000
           WHEN WS-SQL-OK                                               30550000
                MOVE 'Y' TO WS-EX-GRANT-PRSN-FND                        30560000
                                                                        30570000
           WHEN WS-SQL-NFND                                             30580000
                MOVE 'N' TO WS-EX-GRANT-PRSN-FND                        30590000
                                                                        30600000
           WHEN OTHER                                                   30610000
                MOVE SQLCODE   TO WS-SQLCODE                            30620000
                DISPLAY 'ERROR READING EX_GRANT_ASMNT_PERSON'           30630000
                DISPLAY 'SQLCODE IS : ' WS-SQLCODE                      30640000
                DISPLAY SPACES                                          30650000
                PERFORM 9999-SQL-ERROR      THRU 9999-EXIT              30660000
           END-EVALUATE.                                                30670000
                                                                        30680000
       6300-EXIT.                                                       30690000
           EXIT.                                                        30700000
                                                                        30710000
      *--------------------------*                                      30720000
       6500-INSERT-EX-GRANT-PRSN.                                       30730000
      *--------------------------*                                      30740000
                                                                        30750000
           MOVE WS-PREV-REGN TO NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON. 30760000
           MOVE WS-GRANT-TYPE                                           30770000
                      TO NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON.    30780000
           MOVE 'BP13CB0K'                                              30790000
                      TO NUM-UPDATE-USERID OF DCLEX-GRANT-ASMNT-PERSON. 30800000
                                                                        30810000
           MOVE WS-TIMESTAMP TO TME-CREATE OF DCLEX-GRANT-ASMNT-PERSON. 30820000
                                                                        30830000
           STRING WS-TIME-HHMMSS(1:2) '.'                               30840000
                  WS-TIME-HHMMSS(3:2) '.'                               30850000
                  WS-TIME-HHMMSS(5:2)                                   30860000
                  DELIMITED BY SIZE                                     30870000
                  INTO TME-UPDATE OF DCLEX-GRANT-ASMNT-PERSON.          30880000
                                                                        30890000
           STRING WS-DTE-CCYYMMDD(1:4) '-'                              30900000
                  WS-DTE-CCYYMMDD(5:2) '-'                              30910000
                  WS-DTE-CCYYMMDD(7:2)                                  30920000
                  DELIMITED BY SIZE                                     30930000
                  INTO DTE-UPDATE OF DCLEX-GRANT-ASMNT-PERSON.          30940000
                                                                        30950000
            EXEC SQL                                                    30960000
                 INSERT INTO EX_GRANT_ASMNT_PERSON                      30970000
                        ( NUM_RGSTRN,                                   30980000
                          NUM_GRANT_TYPE,                               30990000
                          TME_CREATE,                                   31000000
                          NUM_IDNTY_NO,                                 31010000
                          NUM_IDNTY_NO_TYPE,                            31020000
                          NUM_CSTMR_SOURCE,                             31030000
                          NUM_CPF_ACNT,                                 31040000
                          AMT_GRANT,                                    31050000
                          AMT_GRANT_USE,                                31060000
                          NUM_ROLE_TAG,                                 31070000
                          NUM_RLTNSP,                                   31080000
                          NME_PERSON,                                   31090000
                          NUM_GENDER,                                   31100000
                          NUM_CTZNSP,                                   31110000
                          NUM_MRTL_STATUS,                              31120000
                          AMT_INCOME,                                   31130000
                          NUM_1YR_CNTNS_EMPLY,                          31140000
                          NUM_DEBAR,                                    31150000
                          NUM_DEBAR_REASON,                             31160000
                          NUM_RCVRY,                                    31170000
                          NUM_UPDATE_USERID,                            31180000
                          DTE_UPDATE,                                   31190000
                          TME_UPDATE,                                   31200000
                          AMT_GRANT_THRSHD )                            31210000
                 VALUES ( :DCLEX-GRANT-ASMNT-PERSON.NUM-RGSTRN,         31220000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-GRANT-TYPE,     31230000
                          :DCLEX-GRANT-ASMNT-PERSON.TME-CREATE,         31240000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO,       31250000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-IDNTY-NO-TYPE,  31260000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CSTMR-SOURCE,   31270000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CPF-ACNT,       31280000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT,          31290000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-USE,      31300000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-ROLE-TAG,       31310000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-RLTNSP,         31320000
                          :DCLEX-GRANT-ASMNT-PERSON.NME-PERSON,         31330000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-GENDER,         31340000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-CTZNSP,         31350000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-MRTL-STATUS,    31360000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-INCOME,         31370000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-1YR-CNTNS-EMPLY,31380000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR,          31390000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-DEBAR-REASON,   31400000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-RCVRY,          31410000
                          :DCLEX-GRANT-ASMNT-PERSON.NUM-UPDATE-USERID,  31420000
                          :DCLEX-GRANT-ASMNT-PERSON.DTE-UPDATE,         31430000
                          :DCLEX-GRANT-ASMNT-PERSON.TME-UPDATE,         31440000
                          :DCLEX-GRANT-ASMNT-PERSON.AMT-GRANT-THRSHD )  31450000
            END-EXEC.                                                   31460000
                                                                        31470000
            EVALUATE SQLCODE                                            31480000
               WHEN 000                                                 31490000
                    ADD 1                 TO CNT-EX-PERSN-INS           31500000
                    MOVE 'EX_GRANT_ASMNT_PERSON'  TO WS-SOURCE          31510000
                    MOVE 'C'            TO WS-ACTION                    31520000
                    MOVE NUM-RGSTRN OF DCLEX-GRANT-ASMNT-PERSON         31530000
                                                  TO WS-RGSTRN          31540000
                    MOVE NUM-GRANT-TYPE OF DCLEX-GRANT-ASMNT-PERSON     31550000
                                                  TO WS-GRNT-TYPE       31560000
                    MOVE SPACES            TO WS-BEFORE-IMAGE           31570000
                    MOVE DCLEX-GRANT-ASMNT-PERSON TO WS-AFTER-IMAGE     31580000
                    PERFORM 8000-INSERT-TO-LOG  THRU 8000-EXIT          31590000
                    PERFORM 9100-COMMIT         THRU 9100-EXIT          31600000
                                                                        31610000
               WHEN -803                                                31620000
                    CONTINUE                                            31630000
                                                                        31640000
               WHEN OTHER                                               31650000
                    MOVE SQLCODE          TO WS-SQLCODE                 31660000
                    DISPLAY 'SQL ERROR (INS) IN EX_GRANT_ASMNT_PERSON'  31670000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            31680000
                    DISPLAY DCLEX-GRANT-ASMNT-PERSON                    31690000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          31700000
            END-EVALUATE.                                               31710000
                                                                        31720000
       6500-EXIT.                                                       31730000
           EXIT.                                                        31740000
                                                                        31750000
      *--------------------*                                            31760000
       8000-INSERT-TO-LOG.                                              31770000
      *--------------------*                                            31780000
            EXEC SQL                                                    31790000
                 SET :WS-TIMESTAMP-LOG = CURRENT TIMESTAMP              31800000
            END-EXEC.                                                   31810000
            IF SQLCODE NOT = 000                                        31820000
               MOVE SQLCODE          TO WS-SQLCODE                      31830000
               DISPLAY 'SQL ERROR SET DB2 TIMESTAMP'                    31840000
               DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE                 31850000
               PERFORM 9999-SQL-ERROR THRU 9999-EXIT                    31860000
            END-IF.                                                     31870000
                                                                        31880000
           MOVE WS-TIMESTAMP-LOG TO TME-UPDATE OF DCLGRANT-UPDATE-LOG.  31890000
           MOVE 'BP13CB0K'  TO NUM-UPDATE-USERID OF DCLGRANT-UPDATE-LOG.31900000
           MOVE WS-SOURCE   TO NUM-SOURCE-RECORD OF DCLGRANT-UPDATE-LOG.31910000
           MOVE WS-ACTION     TO NUM-ACTION OF DCLGRANT-UPDATE-LOG.     31920000
           MOVE WS-RGSTRN     TO NUM-RGSTRN OF DCLGRANT-UPDATE-LOG.     31930000
           MOVE WS-GRNT-TYPE TO NUM-GRANT-TYPE OF DCLGRANT-UPDATE-LOG.  31940000
           MOVE WS-BEFORE-IMAGE TO TXT-BEFORE-IMAGE-TEXT                31950000
                                              OF DCLGRANT-UPDATE-LOG.   31960000
           MOVE LENGTH OF WS-BEFORE-IMAGE TO TXT-BEFORE-IMAGE-LEN       31970000
                                              OF DCLGRANT-UPDATE-LOG.   31980000
           MOVE WS-AFTER-IMAGE TO TXT-AFTER-IMAGE-TEXT                  31990000
                                              OF DCLGRANT-UPDATE-LOG.   32000000
           MOVE LENGTH OF WS-AFTER-IMAGE TO TXT-AFTER-IMAGE-LEN         32010000
                                              OF DCLGRANT-UPDATE-LOG.   32020000
            EXEC SQL                                                    32030000
                 INSERT INTO GRANT_UPDATE_LOG                           32040000
                        ( TME_UPDATE,                                   32050000
                          NUM_UPDATE_USERID,                            32060000
                          NUM_SOURCE_RECORD,                            32070000
                          NUM_ACTION,                                   32080000
                          NUM_RGSTRN,                                   32090000
                          NUM_GRANT_TYPE,                               32100000
                          TXT_BEFORE_IMAGE,                             32110000
                          TXT_AFTER_IMAGE )                             32120000
                 VALUES ( :DCLGRANT-UPDATE-LOG.TME-UPDATE,              32130000
                          :DCLGRANT-UPDATE-LOG.NUM-UPDATE-USERID,       32140000
                          :DCLGRANT-UPDATE-LOG.NUM-SOURCE-RECORD,       32150000
                          :DCLGRANT-UPDATE-LOG.NUM-ACTION,              32160000
                          :DCLGRANT-UPDATE-LOG.NUM-RGSTRN,              32170000
                          :DCLGRANT-UPDATE-LOG.NUM-GRANT-TYPE,          32180000
                          :DCLGRANT-UPDATE-LOG.TXT-BEFORE-IMAGE,        32190000
                          :DCLGRANT-UPDATE-LOG.TXT-AFTER-IMAGE )        32200000
            END-EXEC.                                                   32210000
                                                                        32220000
            EVALUATE SQLCODE                                            32230000
               WHEN 000                                                 32240000
                    ADD 1                 TO WS-GRNT-UPD-LOG            32250000
                                                                        32260000
               WHEN -803                                                32270000
                    CONTINUE                                            32280000
                                                                        32290000
               WHEN OTHER                                               32300000
                    MOVE SQLCODE          TO WS-SQLCODE                 32310000
                    DISPLAY 'SQL ERROR (INSERT) IN GRANT_UPDATE_LOG'    32320000
                    DISPLAY 'SQL ERROR CODE  : '  WS-SQLCODE            32330000
                    PERFORM 9999-SQL-ERROR      THRU 9999-EXIT          32340000
            END-EVALUATE.                                               32350000
                                                                        32360000
       8000-EXIT.                                                       32370000
           EXIT.                                                        32380000
                                                                        32390000
      *-----------------*                                               32400000
       9000-CLOSE-FILES.                                                32410000
      *-----------------*                                               32420000
                                                                        32430000
           DISPLAY '******  BP13CB0K *************'.                    32440000
           DISPLAY 'RECS READ FROM  BP13FD05      : ' CNT-FD05-READ.    32450000
           DISPLAY 'RECS CREATED TO GRANT_ASMNT   : ' CNT-ASMNT-INSERT. 32460000
           DISPLAY 'RECS CREATED TO PERSON TABLE  : ' CNT-PERSN-INSERT. 32470000
           DISPLAY 'RECS CREATED TO GRANT_RCVRY   : ' CNT-RCVRY-INSERT. 32480000
           DISPLAY 'RECS CREATED TO EX_GRANT_ASMNT: ' CNT-EX-ASMNT-INS. 32490000
           DISPLAY 'RECS CREATED TO EX_GRANT_PERSN: ' CNT-EX-PERSN-INS. 32500000
           DISPLAY 'RECS WRITTEN TO UPDATE LOG    : ' WS-GRNT-UPD-LOG.  32510000
                                                                        32520000
           CLOSE BP13FD05                                               32530000
                 BP13K800                                               32540000
                 BP13K820                                               32550000
                 BP13K893                                               32560000
                 BP13K895.                                              32570000
                                                                        32580000
           STOP RUN.                                                    32590000
                                                                        32600000
           IF WS-K800-STATUS NOT = 00 AND 97                            32610000
              DISPLAY 'ERROR CLOSING - BP13K800 : ' WS-K800-STATUS      32620000
              MOVE     WS-K800-STATUS    TO    RETURN-CODE              32630000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                32640000
           END-IF.                                                      32650000
                                                                        32660000
           IF WS-K820-STATUS NOT = 00 AND 97                            32670000
              DISPLAY 'ERROR CLOSING - BP13K820 : ' WS-K820-STATUS      32680000
              MOVE     WS-K820-STATUS    TO    RETURN-CODE              32690000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                32700000
           END-IF.                                                      32710000
                                                                        32720000
           IF WS-K893-STATUS NOT = 00 AND 97                            32730000
              DISPLAY 'ERROR CLOSING - BP13K893 : ' WS-K893-STATUS      32740000
              MOVE     WS-K893-STATUS    TO    RETURN-CODE              32750000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                32760000
           END-IF.                                                      32770000
                                                                        32780000
           IF WS-K895-STATUS NOT = 00 AND 97                            32790000
              DISPLAY 'ERROR CLOSING - BP13K895 : ' WS-K895-STATUS      32800000
              MOVE     WS-K895-STATUS    TO    RETURN-CODE              32810000
              PERFORM  9000-CLOSE-FILES  THRU  9000-EXIT                32820000
           END-IF.                                                      32830000
                                                                        32840000
       9000-EXIT.                                                       32850000
            EXIT.                                                       32860000
                                                                        32870000
      ***************************************************************** 32880000
       9100-COMMIT.                                                     32890000
      ***************************************************************** 32900000
           EXEC SQL                                                     32910000
                COMMIT                                                  32920000
           END-EXEC                                                     32930000
                                                                        32940000
           EVALUATE SQLCODE                                             32950000
           WHEN 000                                                     32960000
                CONTINUE                                                32970000
           WHEN OTHER                                                   32980000
                PERFORM 9999-SQL-ERROR    THRU 9999-EXIT                32990000
           END-EVALUATE.                                                33000000
                                                                        33010000
       9100-EXIT.                                                       33020000
           EXIT.                                                        33030000
                                                                        33040000
      *---------------------------------------------------------------- 33050000
       9999-SQL-ERROR.                                                  33060000
      *---------------------------------------------------------------- 33070000
           CALL 'DBATIAR'  USING SQLCA.                                 33080000
           EXEC SQL ROLLBACK               END-EXEC.                    33090000
           MOVE 99                         TO    RETURN-CODE.           33100000
           PERFORM 9000-CLOSE-FILES        THRU  9000-EXIT.             33110000
                                                                        33120000
       9999-EXIT.                                                       33130000
           EXIT.                                                        33140000
