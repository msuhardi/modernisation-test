       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13C506.                                                  
      *AUTHOR.       ANNALYN BANTA.                                             
      *DATE-WRITTEN. 09.02.94.                                                  
      * ========================================================= *             
      * SYSTEM OF COMMITMENT (BP13)                               *             
      * ========================================================= *             
      *  OBJECTIVE   : TO UPDATE OCCUPIER INFO FROM MHA DATA      *             
      *                                                           *             
      *  BE01F515    : APPLICANT/OCCUPIER INFO FROM MHA           *             
      *  BP13K825    : SOC MASTER'S OCCUPIER FILE                 *             
      *  P13L506A    : LISTING OF SOC OCCUP INFO UPDATES          *             
      *  P13L506B    : ERROR LIST FOR INVALID INFO ENCOUNTERED    *             
      *                                                           *             
      * CHG-NO   BY  DATE    DESCRIPTION                          *             
      * ------   --- ------  ---------------------------------    *             
      * BP130124 SSS 960727  CHG CDATECHK TO AV02C010.            *             
      * BP130418 SSS 980703  CHG AV02C010 TO AV02C001.            *             
      * BP130527 MPA 980717  TO ADD RACE IN ERROR REPORT LIST     *             
      * BP130418 SIA 980722  CATER FOR YR2000                     *             
      * BP130652 NOR 990219  EXPAND K500 & K730 RECL 300 TO 500   *             
      * BP130756 SCK 000110  BLANKING OF MAILING ADDR WHEN SAME   *             
      *                      AS MHA ADDR                          *             
      * BP130788 SB  000211  UPDATE 'P' TO K500,K730 PRINT-STATUS *             
      * BP130979 LSB 010208  UPDATE ADDR USING K830-REGN, ACCEPT  *             
      *                      MHA ADDR-TYPE = B                    *             
      * BP130979 LSB 010208  MHA ADDR-TYPE=B OR D ,NON-HDB-ADDR   *             
      * BP130988 ANC 010403  PRINT TO ERROR REPORT IF DIFFERENT   *             
      *                      NATIONALITY.                         *             
      * BP132059 ANC 020204  TO CATER FOR INVALID/BLANK DOB.      *             
      * BP132121 ANC 020321  TO RETAIN NAME FROM CDB INFO IF FOUND*             
      * BP132313 MJ16 200603  INCLUDE SUBROUTINE BP13SR20 TO CHECK*             
      *                       NATIONALITY & REMOVE BB14K090       *             
      * BP132313 MJ16 090703  REMOVE COMMENTS                     *             
      * BP132376 MJ16 280703 CHECK VALID NATIONALITY,SEX,RACE     *             
      *                      CONVERT NCA CASE TO HDB FORMAT &     *             
      *                      RETRIEVE STREET NAME FROM STREET TABL*             
      * BP132408 SK   170903 INCLUDE PIDB TABLE                   *             
      * BP132538 CKK  100304 TO MOVE NAME DIRECTLY TO K825        *             
      * BP132555 SK   180804 CALL BE01C903 TO GET NAME            *             
      * BP132583 CKK  030904 NEW REPORT                           *             
      * BP133026 BALA 270307 UPDATE BP13K820                      *             
      * BP132887 BA2  110607 TO CHANGE LENGTH OF BE01F515 INTO 580*             
      *                      AND DECODE ETHNIC IF SRC-TAG NOT = I *             
      * BP133107 BA2  180707 CHANGE MOVING LOGIC FOR BLK AND      *             
      *                      SUBBLK                               *             
      * BP133177 BA2  121107 IF OCCUPIER NCA-TYPE-ADDR IS "H",    *             
      *                      CHANGE INTO "S"                      *             
      * BP133107 ZDD1 020609 TO BYPASS PROCESS THAT WILL WRITE TO *             
      *                      F725 ONCE THE RECORD HAS BEEN        *             
      *                      WRITTEN ALREADY                      *             
      * BP136505 SMR2 151116 NEW OUTPUT FILE FOR DECEASED PERSON/S*             
      * BP136762 SMR2 260517 EXPAND BP13L506 FROM 20 TO 50 BYTES  *             
      *                      THEN WRITE SALES MODE & BALLOT QTR   *             
      * BP137016 SMR2 120917 NEW REPORTS (BTO/SBF/ROF) FOR CASES  *             
      *                      WITH CHANGE IN NUM-SEX FIELD         *             
      * BP137048 SMR2 161117 READ BP13K500/BP13K730 TO GET SALES  *             
      *                      MODE AND BALLOT QUARTER              *             
      * BP137786  KV6 240419 CATER FOR OBF REPORT                 *             
      * BP139780 AM25 301123 TO STOP SALES BATCH DETERMINATION    *             
      *                      FOR FIELDS FROM HFE                  *             
      * BP139682 AM25 121223 NEW REPORT FILE IN CSV FORMAT        *             
      * ========================================================= *             
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BE01F515 ASSIGN       TO BE01F515.                            
           SELECT BP13F725 ASSIGN       TO BP13F725.                            
                                                                                
           SELECT BP13K500 ASSIGN       TO BP13K500                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K500-KEY-NEW                         
                           FILE STATUS  IS K500-STATUS.                         
                                                                                
           SELECT BP13K825 ASSIGN       TO BP13K825                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K825-KEY-FLD                         
                           FILE STATUS  IS K825-STATUS.                         
                                                                                
           SELECT BP13K060 ASSIGN       TO BP13K060                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K060-KEY-FLD                         
                           FILE STATUS  IS K060-STATUS.                         
                                                                                
           SELECT BP13K830 ASSIGN       TO BP13K830                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K830-KEY-FLD                         
                           ALTERNATE RECORD KEY                                 
                                        IS K830-NUM-REGN                        
                                           WITH DUPLICATES                      
                           FILE STATUS  IS K830-STATUS.                         
                                                                                
           SELECT BP13K730 ASSIGN       TO BP13K730                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K730-KEY-NEW                         
                           FILE STATUS  IS K730-STATUS.                         
                                                                                
           SELECT BP13K820 ASSIGN       TO BP13K820                             
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K820-KEY-FLD                         
                           FILE STATUS  IS K820-STATUS.                         
                                                                                
           SELECT BP13F500 ASSIGN       TO BP13F500.                            
                                                                                
           SELECT P13L506A ASSIGN       TO P13L506A.                            
                                                                                
           SELECT P13L506B ASSIGN       TO P13L506B.                            
                                                                                
           SELECT P13L506C ASSIGN       TO P13L506C.                            
                                                                                
           SELECT P13L506D ASSIGN       TO P13L506D.                            
                                                                                
           SELECT P13L506E ASSIGN       TO P13L506E.                            
                                                                                
           SELECT P13L506F ASSIGN       TO P13L506F.                            
                                                                                
           SELECT P13L506G ASSIGN       TO P13L506G.                            
                                                                                
           SELECT BP13L506 ASSIGN       TO BP13L506.                            
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD BE01F515                                                              
           BLOCK  CONTAINS 0 RECORDS                                            
           RECORD CONTAINS 580 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       COPY BE01F515.                                                           
                                                                                
       FD BP13F725                                                              
           BLOCK  CONTAINS 0 RECORDS                                            
           RECORD CONTAINS 211 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       COPY BP13F725.                                                           
                                                                                
                                                                                
       FD   BP13K500.                                                           
       COPY BP13K500.                                                           
                                                                                
       FD   BP13K825.                                                           
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K060.                                                           
       COPY BP13K060.                                                           
                                                                                
       FD   BP13K830.                                                           
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K730.                                                           
       COPY BP13K730.                                                           
                                                                                
       FD   BP13K820.                                                           
       COPY BP13K820.                                                           
                                                                                
       FD  BP13F500                                                             
           BLOCK  CONTAINS 0 RECORDS                                            
           RECORD CONTAINS 500 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       COPY BP13F500.                                                           
                                                                                
       FD  P13L506A                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE OMITTED.                                         
       01  P13L506A-REC                 PIC X(132).                             
                                                                                
       FD  P13L506B                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       01  P13L506B-REC                 PIC X(132).                             
                                                                                
       FD  P13L506C                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       01  P13L506C-REC                 PIC X(132).                             
                                                                                
       FD  P13L506D                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       01  P13L506D-REC                 PIC X(132).                             
                                                                                
       FD  P13L506E                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       01  P13L506E-REC                 PIC X(132).                             
                                                                                
       FD  P13L506F                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       01  P13L506F-REC                 PIC X(132).                             
                                                                                
       FD  P13L506G                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 500 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       01  P13L506G-REC                 PIC X(500).                             
                                                                                
       FD  BP13L506                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 50  CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL  RECORDS  ARE STANDARD.                                        
       01  BP13L506-REC.                                                        
           05  L506-NUM-REGN            PIC X(08).                              
           05  L506-NUM-DECEASED-NRIC   PIC X(09).                              
           05  L506-NUM-ALLO-CAT        PIC X(03).                              
           05  L506-DTE-BALLOT          PIC X(06).                              
           05  FILLER                   PIC X(24).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01  WS-FILE-STATUS.                                                      
           05 K060-STATUS               PIC 9(02) VALUE ZERO.                   
           05 K090-STATUS               PIC 9(02) VALUE ZERO.                   
           05 K825-STATUS               PIC 9(02) VALUE ZERO.                   
           05 K830-STATUS               PIC 9(02) VALUE ZERO.                   
           05 K730-STATUS               PIC 9(02) VALUE ZERO.                   
           05 K500-STATUS               PIC 9(02) VALUE ZERO.                   
           05 K820-STATUS               PIC 9(02) VALUE ZERO.                   
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-F515-READ              PIC 9(08) VALUE ZERO.                   
           05 WS-K830-WRITE             PIC 9(08) VALUE ZERO.                   
           05 WS-F500-WRITE             PIC 9(08) VALUE ZERO.                   
           05 WS-L506-WRITE             PIC 9(08) VALUE ZERO.                   
           05 WS-L506G-WRITE            PIC 9(08) VALUE ZERO.                   
           05 WS-K830-REWRITE           PIC 9(08) VALUE ZERO.                   
           05 WS-K500-REWRITE           PIC 9(08) VALUE ZERO.                   
           05 WS-K730-REWRITE           PIC 9(08) VALUE ZERO.                   
           05 WS-REC-NOTFND             PIC 9(08) VALUE ZERO.                   
           05 WS-K820-NOTFND            PIC 9(08) VALUE ZERO.                   
           05 WS-REC-UPDATED            PIC 9(08) VALUE ZERO.                   
           05 WS-K820-UPDATED           PIC 9(08) VALUE ZERO.                   
           05 WS-REC-PRINTED            PIC 9(08) VALUE ZERO.                   
           05 WS-REC-PRINTED-C          PIC 9(08) VALUE ZERO.                   
           05 WS-REC-PRINTED-D          PIC 9(08) VALUE ZERO.                   
           05 WS-REC-PRINTED-E          PIC 9(08) VALUE ZERO.                   
           05 WS-REC-PRINTED-F          PIC 9(08) VALUE ZERO.                   
           05 WS-ERR-CTR                PIC 9(08) VALUE ZERO.                   
           05 WS-ERROR-LCTR             PIC 9(04) VALUE 56.                     
           05 WS-LINE-CTR               PIC 9(04) VALUE 56.                     
           05 WS-LINE-CTR-C             PIC 9(04) VALUE 56.                     
           05 WS-LINE-CTR-D             PIC 9(04) VALUE 56.                     
           05 WS-LINE-CTR-E             PIC 9(04) VALUE 56.                     
           05 WS-LINE-CTR-F             PIC 9(04) VALUE 56.                     
           05 WS-ERROR-PCTR             PIC 9(04) VALUE ZERO.                   
           05 WS-PAGE-CTR               PIC 9(04) VALUE ZERO.                   
           05 WS-PAGE-CTR-C             PIC 9(04) VALUE ZERO.                   
           05 WS-PAGE-CTR-D             PIC 9(04) VALUE ZERO.                   
           05 WS-PAGE-CTR-E             PIC 9(04) VALUE ZERO.                   
           05 WS-PAGE-CTR-F             PIC 9(04) VALUE ZERO.                   
           05 WS-CHR-CNT                PIC 9(01) VALUE ZERO.                   
           05 WS-VAR-2                  PIC 9(01) VALUE ZERO.                   
           05 WS-CTR                    PIC 9(02) VALUE ZERO.                   
           05 WS-W-CTR                  PIC 9(01) VALUE ZERO.                   
           05 WS-HSE-MAIN               PIC X(04) VALUE SPACES.                 
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-ALLO-CAT               PIC X(03) VALUE SPACES.                 
           05 WS-DTE-BAL                PIC X(06) VALUE SPACES.                 
           05 WS-CDE-NT1                PIC X(03) VALUE SPACES.                 
           05 WS-CDE-FLAT-TYPE          PIC X(02) VALUE SPACES.                 
           05 WS-DTE-REQUEST            PIC X(08) VALUE SPACES.                 
                                                                                
       01  WS-STREET-CDE                PIC X(06) VALUE SPACES.                 
       01  WS-BLK-NO                    PIC X(05) VALUE SPACES.                 
       01  WS-BLK-RGHTJUST              PIC X(04) VALUE SPACES                  
                                              JUST RIGHT.                       
       01  WS-UNIT-LEFT-JST             PIC X(04) VALUE SPACES.                 
       01  WS-NUM-FLAT                  PIC X(04) VALUE SPACES.                 
       01  WS-BE01F515-NCA-LEVEL-NO     PIC X(02) VALUE SPACES.                 
                                                                                
       01  WS-SWITCHES.                                                         
           05 F515-EOF                  PIC X(01) VALUE 'N'.                    
           05 K825-FND                  PIC X(01) VALUE 'Y'.                    
           05 F725-WRT                  PIC X(01) VALUE 'N'.                    
           05 WS-L506-FND               PIC X(01) VALUE 'N'.                    
           05 WS-FLAG-WRITE             PIC X(01) VALUE 'N'.                    
                                                                                
       01  WS-CURR-DATE.                                                        
           05 WS-YY                     PIC 9(04).                              
           05 WS-MM                     PIC 9(02).                              
           05 WS-DD                     PIC 9(02).                              
                                                                                
       01  WS-TEMP-VAR.                                                         
           05 WS-TEMP-NUM-REGN          PIC X(8)  VALUE SPACES.                 
           05 WS-TEMP-NUM-NRIC          PIC X(9)  VALUE SPACES.                 
           05 WS-TEMP-NME-OCCP          PIC X(66) VALUE SPACES.                 
           05 WS-TEMP-NUM-ETHNIC        PIC X(1)  VALUE SPACES.                 
           05 WS-TEMP-NUM-SEX           PIC X(1)  VALUE SPACES.                 
           05 WS-TEMP-DTE-BIRTH         PIC X(8)  VALUE SPACES.                 
           05 WS-TEMP-NATION            PIC X(02) VALUE SPACES.                 
                                                                                
       01  WS-NUM-ETHNIC                PIC X(02) VALUE SPACES.                 
       01  WS-SEX                       PIC X(01) VALUE SPACES.                 
       01  WS-UPD-SEX                   PIC X(01) VALUE SPACES.                 
       01  WS-OCCP-SEX                  PIC X(01) VALUE SPACES.                 
       01  WS-MHA-SEX                   PIC X(01) VALUE SPACES.                 
       01  WS-NATION                    PIC X(02) VALUE SPACES.                 
       01  WS-BIRTH-DATE.                                                       
           05 WS-BIRTH-CCYY             PIC X(04) VALUE SPACES.                 
           05 WS-BIRTH-MM               PIC X(02) VALUE SPACES.                 
           05 WS-BIRTH-DD               PIC X(02) VALUE SPACES.                 
       01  WS-REMARKS                   PIC X(30) VALUE SPACES.                 
       01  WS-NUM-NTNLTY                PIC X(2)  VALUE SPACES.                 
                                                                                
       01  WS-REC-VALIDATE              PIC 9(01).                              
           88 VALID-REC                     VALUE ZERO.                         
           88 INVALID-REC                   VALUE 1.                            
                                                                                
       01  WS-SQL-CODES.                                                        
           05  WS-SQL-CDE-OK           PIC S9(4) COMP VALUE +000.               
           05  WS-SQL-CDE-NOTFND       PIC S9(4) COMP VALUE +100.               
           05  WS-SQL-STATUS           PIC 9(3)   VALUE ZEROS.                  
                                                                                
       01  PRINT-VARIABLES.                                                     
           05 P-TITLE-1.                                                        
              10 FILLER                 PIC X(41) VALUE 'P13L506A'.             
              10 FILLER                 PIC X(64) VALUE                         
                'UPDATE OF SOC OCCUPIER INFORMATION (MHA TRANSFER)'.            
              10 FILLER                 PIC X(05) VALUE 'DATE '.                
              10 P-DATE.                                                        
                 15 WS-DD               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-MM               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-YY               PIC 9(04).                              
              10 FILLER                 PIC X(08) VALUE '  PAGE  '.             
              10 P-PAGENO               PIC ZZZ9.                               
           05 P-TITLE-2.                                                        
              10 FILLER                 PIC X(07) VALUE 'S/N'.                  
              10 FILLER                 PIC X(10) VALUE 'REGN'.                 
              10 FILLER                 PIC X(11) VALUE 'NRIC'.                 
              10 FILLER                 PIC X(67) VALUE 'NAME'.                 
              10 FILLER                 PIC X(05) VALUE 'SEX'.                  
              10 FILLER                 PIC X(05) VALUE 'RACE'.                 
              10 FILLER                 PIC X(08) VALUE 'NATNLTY'.              
              10 FILLER                 PIC X(09) VALUE 'DTE BIRTH'.            
           05 P-DETAIL.                                                         
              10 P-SERIAL               PIC ZZZZ9.                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-REGN                 PIC X(08).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-NRIC                 PIC X(09).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-NAME                 PIC X(66).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-SEX                  PIC X(01).                              
              10 FILLER                 PIC X(04) VALUE SPACES.                 
              10 P-RACE                 PIC X(02).                              
              10 FILLER                 PIC X(06) VALUE SPACES.                 
              10 P-NATNLTY              PIC X(02).                              
              10 FILLER                 PIC X(03) VALUE SPACES.                 
              10 P-BIRTH                PIC X(08).                              
           05 P-TITLE-1-C.                                                      
              10 FILLER                 PIC X(41) VALUE 'P13L506C'.             
              10 FILLER                 PIC X(64) VALUE                         
                'REPORT ON OCCUPIER NATIONALITY NOT EQUAL TO SG '.              
              10 FILLER                 PIC X(05) VALUE 'DATE '.                
              10 P-DATE-C.                                                      
                 15 WS-DD               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-MM               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-YY               PIC 9(04).                              
              10 FILLER                 PIC X(08) VALUE '  PAGE  '.             
              10 P-PAGENO-C             PIC ZZZ9.                               
           05 P-TITLE-2-C.                                                      
              10 FILLER                 PIC X(07) VALUE 'S/N'.                  
              10 FILLER                 PIC X(10) VALUE 'REGN'.                 
              10 FILLER                 PIC X(11) VALUE 'NRIC'.                 
              10 FILLER                 PIC X(67) VALUE 'NAME'.                 
              10 FILLER                 PIC X(05) VALUE 'SEX'.                  
              10 FILLER                 PIC X(05) VALUE 'RACE'.                 
              10 FILLER                 PIC X(08) VALUE 'NATNLTY'.              
              10 FILLER                 PIC X(09) VALUE 'DTE BIRTH'.            
           05 P-DETAIL-C.                                                       
              10 P-SERIAL-C             PIC ZZZZ9.                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-REGN-C               PIC X(08).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-NRIC-C               PIC X(09).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-NAME-C               PIC X(66).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-SEX-C                PIC X(01).                              
              10 FILLER                 PIC X(04) VALUE SPACES.                 
              10 P-RACE-C               PIC X(02).                              
              10 FILLER                 PIC X(06) VALUE SPACES.                 
              10 P-NATNLTY-C            PIC X(02).                              
              10 FILLER                 PIC X(03) VALUE SPACES.                 
              10 P-BIRTH-C              PIC X(08).                              
           05 P-TITLE-1-D.                                                      
              10 P-NME-PGM-D            PIC X(08) VALUE SPACES.                 
              10 FILLER                 PIC X(26) VALUE SPACES.                 
              10 FILLER                 PIC X(59) VALUE                         
                'REPORT ON APPLICANT/OCCUPIER GENDER NOT EQUAL TO MHA FI        
      -         'LE ('.                                                         
              10 P-SMODE-D              PIC X(03) VALUE SPACES.                 
              10 FILLER                 PIC X(09) VALUE ')'.                    
              10 FILLER                 PIC X(05) VALUE 'DATE '.                
              10 P-DATE-D.                                                      
                 15 WS-DD               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-MM               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-YY               PIC 9(04).                              
              10 FILLER                 PIC X(08) VALUE '  PAGE  '.             
              10 P-PAGENO-D             PIC ZZZ9.                               
           05 P-TITLE-2-D.                                                      
              10 FILLER                 PIC X(70) VALUE SPACES.                 
              10 FILLER                 PIC X(47) VALUE 'MHA'.                  
              10 FILLER                 PIC X(03) VALUE 'MHA'.                  
           05 P-TITLE-3-D.                                                      
              10 FILLER                 PIC X(07) VALUE 'S/N'.                  
              10 FILLER                 PIC X(10) VALUE 'REGN'.                 
              10 FILLER                 PIC X(11) VALUE 'NRIC'.                 
              10 FILLER                 PIC X(42) VALUE 'NAME'.                 
              10 FILLER                 PIC X(42) VALUE 'NAME'.                 
              10 FILLER                 PIC X(05) VALUE 'SEX'.                  
              10 FILLER                 PIC X(03) VALUE 'SEX'.                  
           05 P-DETAIL-D.                                                       
              10 P-SERIAL-D             PIC ZZZZ9.                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-REGN-D               PIC X(08).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-NRIC-D               PIC X(09).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-OCCP-NAME-D          PIC X(40).                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-MHA-NAME-D           PIC X(40).                              
              10 FILLER                 PIC X(03) VALUE SPACES.                 
              10 P-OCCP-SEX-D           PIC X(01).                              
              10 FILLER                 PIC X(04) VALUE SPACES.                 
              10 P-MHA-SEX-D            PIC X(01).                              
           05 P-ERROR-TITLE-1.                                                  
              10 FILLER                 PIC X(41) VALUE 'P13L506B'.             
              10 FILLER                 PIC X(64) VALUE                         
                'ERROR LIST FOR INVALID INFORMATION ENCOUNTERED'.               
              10 FILLER                 PIC X(05) VALUE 'DATE '.                
              10 P-ERROR-DATE.                                                  
                 15 WS-DD               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-MM               PIC 9(02).                              
                 15 FILLER              PIC X(01) VALUE '/'.                    
                 15 WS-YY               PIC 9(04).                              
              10 FILLER                 PIC X(08) VALUE '  PAGE  '.             
              10 P-ERROR-PAGENO         PIC ZZZ9.                               
           05 P-ERROR-TITLE-2.                                                  
              10 FILLER                 PIC X(07) VALUE 'S/N'.                  
              10 FILLER                 PIC X(10) VALUE 'REGN'.                 
              10 FILLER                 PIC X(11) VALUE 'NRIC'.                 
              10 FILLER                 PIC X(47) VALUE 'NAME'.                 
              10 FILLER                 PIC X(05) VALUE 'SEX'.                  
              10 FILLER                 PIC X(05) VALUE 'RACE'.                 
              10 FILLER                 PIC X(08) VALUE 'NATNLTY'.              
              10 FILLER                 PIC X(09) VALUE 'DTE BIRTH'.            
              10 FILLER                 PIC X(13) VALUE SPACES.                 
              10 FILLER                 PIC X(07) VALUE 'REMARKS'.              
              10 FILLER                 PIC X(10) VALUE SPACES.                 
           05 P-ERROR-DETAIL.                                                   
              10 P-SERIAL-ERR           PIC ZZZZ9.                              
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-REGN-ERR             PIC X(08) VALUE SPACES.                 
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-NRIC-ERR             PIC X(09) VALUE SPACES.                 
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 P-NAME-ERR             PIC X(46) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE SPACES.                 
              10 P-SEX-ERR              PIC X(01) VALUE SPACE.                  
              10 P-SEX-AST              PIC X(01) VALUE SPACE.                  
              10 FILLER                 PIC X(03) VALUE SPACES.                 
              10 P-RACE-ERR             PIC X(02) VALUE SPACE.                  
              10 P-RACE-AST             PIC X(01) VALUE SPACE.                  
              10 FILLER                 PIC X(06) VALUE SPACES.                 
              10 P-NATNLTY-ERR          PIC X(02) VALUE SPACES.                 
              10 P-NATNLTY-AST          PIC X(01) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE SPACES.                 
              10 P-BIRTH-ERR            PIC X(08) VALUE SPACES.                 
              10 P-BIRTH-AST            PIC X(01) VALUE SPACE.                  
              10 P-REMARKS-ERR          PIC X(30) VALUE SPACES.                 
           05 P-TOTAL.                                                          
              10 FILLER                 PIC X(50) VALUE                         
                '** BP13C506 CONTROL TOTALS **********************'.            
           05 P-TOTAL-1.                                                        
              10 FILLER                 PIC X(35) VALUE                         
                'TOTAL RECORDS READ FROM BE01F515 = '.                          
              10 P-F515-READ            PIC ZZZZZZZ9.                           
           05 P-TOTAL-2.                                                        
               10 FILLER                PIC X(35) VALUE                         
                 'TOTAL RECORDS NOTFND IN BP13K825 = '.                         
               10 P-REC-NOTFND         PIC ZZZZZZZ9.                            
           05 P-TOTAL-3.                                                        
              10 FILLER                PIC X(35) VALUE                          
                 'TOTAL RECORDS UPDATED IN BP13K825= '.                         
              10 P-REC-UPDATED         PIC ZZZZZZZ9.                            
           05 P-TOTAL-4.                                                        
              10 FILLER                PIC X(35) VALUE                          
                 'TOTAL RECORDS PRINTED            = '.                         
              10 P-REC-PRINTED         PIC ZZZZZZZ9.                            
           05 P-TOTAL-5.                                                        
              10 FILLER                PIC X(35) VALUE                          
                'TOTAL ERRORS  ENCOUNTERED        = '.                          
              10 P-ERR-ENCTRD          PIC ZZZZZZZ9.                            
           05 P-TOTAL-6.                                                        
              10 FILLER                PIC X(35) VALUE                          
                'TOTAL RECORDS IN K830 WRITTEN    = '.                          
              10 P-K830-WRITE          PIC ZZZZZZZ9.                            
           05 P-TOTAL-7.                                                        
              10 FILLER                PIC X(35) VALUE                          
                'TOTAL RECORDS IN K830 REWRITTEN  = '.                          
              10 P-K830-REWRITE        PIC ZZZZZZZ9.                            
           05 P-TOTAL-8.                                                        
              10 FILLER                PIC X(35) VALUE                          
                'TOTAL RECORDS IN K500 REWRITTEN  = '.                          
              10 P-K500-REWRITE        PIC ZZZZZZZ9.                            
           05 P-TOTAL-9.                                                        
              10 FILLER                PIC X(35) VALUE                          
                'TOTAL RECORDS IN K730 REWRITTEN  = '.                          
              10 P-K730-REWRITE        PIC ZZZZZZZ9.                            
           05 P-TOTAL-10.                                                       
               10 FILLER                PIC X(35) VALUE                         
                 'TOTAL RECORDS NOTFND IN BP13K820 = '.                         
               10 P-K820-NOTFND         PIC ZZZZZZZ9.                           
           05 P-TOTAL-11.                                                       
              10 FILLER                PIC X(35) VALUE                          
                 'TOTAL RECORDS UPDATED IN BP13K820= '.                         
              10 P-K820-UPDATED        PIC ZZZZZZZ9.                            
           05 P-BLANK                  PIC X(132) VALUE SPACES.                 
           05 P-LINE.                                                           
               10 FILLER               PIC X(07) VALUE '-----  '.               
               10 FILLER               PIC X(10) VALUE '--------  '.            
               10 FILLER               PIC X(11) VALUE '---------  '.           
               10 FILLER               PIC X(66) VALUE ALL '-'.                 
               10 FILLER               PIC X(01) VALUE SPACE.                   
               10 FILLER               PIC X(05) VALUE '---  '.                 
               10 FILLER               PIC X(05) VALUE '---- '.                 
               10 FILLER               PIC X(08) VALUE '------- '.              
               10 FILLER               PIC X(10) VALUE '--------- '.            
               10 FILLER               PIC X(09) VALUE '---------'.             
           05 P-LINE-C.                                                         
               10 FILLER               PIC X(07) VALUE '-----  '.               
               10 FILLER               PIC X(10) VALUE '--------  '.            
               10 FILLER               PIC X(11) VALUE '---------  '.           
               10 FILLER               PIC X(66) VALUE ALL '-'.                 
               10 FILLER               PIC X(01) VALUE SPACE.                   
               10 FILLER               PIC X(05) VALUE '---  '.                 
               10 FILLER               PIC X(05) VALUE '---- '.                 
               10 FILLER               PIC X(08) VALUE '------- '.              
               10 FILLER               PIC X(10) VALUE '--------- '.            
               10 FILLER               PIC X(09) VALUE '---------'.             
           05 P-LINE-D.                                                         
               10 FILLER               PIC X(07) VALUE '-----  '.               
               10 FILLER               PIC X(10) VALUE '--------  '.            
               10 FILLER               PIC X(11) VALUE '---------  '.           
               10 FILLER               PIC X(40) VALUE ALL '-'.                 
               10 FILLER               PIC X(02) VALUE SPACES.                  
               10 FILLER               PIC X(40) VALUE ALL '-'.                 
               10 FILLER               PIC X(02) VALUE SPACES.                  
               10 FILLER               PIC X(05) VALUE '---  '.                 
               10 FILLER               PIC X(03) VALUE '---'.                   
           05 P-ERROR-LINE.                                                     
               10 FILLER               PIC X(07) VALUE '-----  '.               
               10 FILLER               PIC X(10) VALUE '--------  '.            
               10 FILLER               PIC X(11) VALUE '---------  '.           
               10 FILLER               PIC X(46) VALUE ALL '-'.                 
               10 FILLER               PIC X(01) VALUE SPACE.                   
               10 FILLER               PIC X(05) VALUE '---  '.                 
               10 FILLER               PIC X(05) VALUE '---- '.                 
               10 FILLER               PIC X(08) VALUE '------- '.              
               10 FILLER               PIC X(10) VALUE '--------- '.            
               10 FILLER               PIC X(09) VALUE '---------'.             
               10 FILLER               PIC X(30) VALUE ALL '-'.                 
           05 P-TITLE-1-G.                                                      
              10 FILLER                 PIC X(08) VALUE 'REGN'.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(10) VALUE 'SALES MODE'.           
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(10) VALUE 'BALLOT QTR'.           
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(03) VALUE 'NT'.                   
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(02) VALUE 'FT'.                   
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(09) VALUE 'APPL DATE'.            
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(09) VALUE 'NRIC'.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(40) VALUE 'NAME'.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(40) VALUE 'MHA NAME'.             
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(03) VALUE 'SEX'.                  
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(07) VALUE 'MHA SEX'.              
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(348) VALUE SPACES.                
           05 P-DETAIL-1-G.                                                     
              10 P-REGN-G               PIC X(08) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-ALLO-CAT-G           PIC X(03) VALUE SPACES.                 
              10 FILLER                 PIC X(07) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-DTE-BAL-G            PIC X(06) VALUE SPACES.                 
              10 FILLER                 PIC X(04) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-CDE-NT1-G            PIC X(03) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-CDE-FLAT-TYPE-G      PIC X(02) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-DTE-REQUEST-G        PIC X(08) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-NRIC-G               PIC X(09) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-OCCP-NAME-G          PIC X(40) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-MHA-NAME-G           PIC X(40) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-OCCP-SEX-G           PIC X(01) VALUE SPACES.                 
              10 FILLER                 PIC X(02) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 P-MHA-SEX-G            PIC X(01) VALUE SPACES.                 
              10 FILLER                 PIC X(06) VALUE SPACES.                 
              10 FILLER                 PIC X(01) VALUE ';'.                    
              10 FILLER                 PIC X(348) VALUE SPACES.                
                                                                                
       01  LINK-VARIABLES.                                                      
           05 WS-LINK-REC.                                                      
              10 WS-IN-OPTION          PIC X(02).                               
              10 WS-IN-GEN.                                                     
                 15 WS-IN-DATE         PIC X(08).                               
              10 WS-RET-GEN.                                                    
                 15 WS-RETURN          PIC X(03).                               
                                                                                
       01  WS-SPACES                   PIC 9(06) VALUE ZERO.                    
                                                                                
      *-----------------------------------------------------------*             
      *   LINK AREA FOR NCA TO HDB ADDR FORMAT CONVERSION                       
      *-----------------------------------------------------------*             
       01  AV02K012-LINK-REC.                                                   
           05  AV02K012-IN-FUNCTION                  PIC X(7).                  
               88  AV02K012-IN-CONV-HDB-NAT-ADDR     VALUE 'HDB-NAT'.           
               88  AV02K012-IN-CONV-NAT-HDB-ADDR     VALUE 'NAT-HDB'.           
           05  AV02K012-IN-REC.                                                 
               10  AV02K012-IN-PARM                  PIC X(100).                
               10  AV02K012-IN-PARM-CONV-HDB-NAT     REDEFINES                  
                   AV02K012-IN-PARM.                                            
                   15  AV02K012-CONV1-IN-BLK-HSE-NO  PIC X(05).                 
                   15  AV02K012-CONV1-IN-CDE-ST      PIC X(06).                 
                   15  AV02K012-CONV1-IN-HSELVL      PIC X(02).                 
                   15  AV02K012-CONV1-IN-HSEMAIN     PIC X(04).                 
                   15  AV02K012-CONV1-IN-HSESUB      PIC X(03).                 
                   15  AV02K012-CONV1-IN-PSTCDE      PIC X(06).                 
                   15  FILLER                        PIC X(74).                 
               10  AV02K012-IN-PARM-CONV-NAT-HDB     REDEFINES                  
                   AV02K012-IN-PARM.                                            
                   15  AV02K012-CONV2-IN-ADDR-TYP    PIC X(01).                 
                   15  AV02K012-CONV2-IN-BLK-HSE-NO  PIC X(10).                 
                   15  AV02K012-CONV2-IN-CDE-ST      PIC X(06).                 
                   15  AV02K012-CONV2-IN-UNIT-LVL    PIC X(03).                 
                   15  AV02K012-CONV2-IN-UNIT-NO     PIC X(05).                 
                   15  AV02K012-CONV2-IN-PSTCDE      PIC X(06).                 
                   15  FILLER                        PIC X(69).                 
           05  AV02K012-OUT-REC.                                                
               10  AV02K012-OUT-PARM                 PIC X(100).                
               10  AV02K012-OUT-PARM-CONV-HDB-NAT    REDEFINES                  
                   AV02K012-OUT-PARM.                                           
                   15  AV02K012-CONV1-OUT-ADDR-TYP   PIC X(01).                 
                   15  AV02K012-CONV1-OUT-BLK-HSE-NO PIC X(10).                 
                   15  AV02K012-CONV1-OUT-CDE-ST     PIC X(06).                 
                   15  AV02K012-CONV1-OUT-UNIT-LVL   PIC X(03).                 
                   15  AV02K012-CONV1-OUT-UNIT-NO    PIC X(05).                 
                   15  AV02K012-CONV1-OUT-PSTCDE     PIC X(06).                 
                   15  FILLER                        PIC X(69).                 
               10  AV02K012-OUT-PARM-CONV-NAT-HDB     REDEFINES                 
                   AV02K012-OUT-PARM.                                           
                   15  AV02K012-CONV2-OUT-BLK-HSE-NO PIC X(05).                 
                   15  AV02K012-CONV2-OUT-CDE-ST     PIC X(06).                 
                   15  AV02K012-CONV2-OUT-HSELVL     PIC X(02).                 
                   15  AV02K012-CONV2-OUT-HSEMAIN    PIC X(04).                 
                   15  AV02K012-CONV2-OUT-HSESUB     PIC X(03).                 
                   15  AV02K012-CONV2-OUT-PSTCDE     PIC X(06).                 
                   15  FILLER                        PIC X(74).                 
               10  AV02K012-OUT-ERROR-MSG.                                      
                   15  AV02K012-OUT-RETURN-CODE      PIC 9(04).                 
                   15  AV02K012-OUT-ERROR-DESC       PIC X(60).                 
           05  FILLER                                PIC X(29).                 
                                                                                
      *COPY AV02COMM.                                                           
       COPY BE01W903.                                                           
                                                                                
           EXEC SQL INCLUDE BP13RACE  END-EXEC.                                 
           EXEC SQL INCLUDE P13VNATL  END-EXEC.                                 
           EXEC SQL INCLUDE BP13STR   END-EXEC.                                 
           EXEC SQL INCLUDE P13VINTF  END-EXEC.                                 
           EXEC SQL INCLUDE SQLCA     END-EXEC.                                 
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN-LOGIC.                                                         
      *-------------------------------------------------------------            
           PERFORM 1000-OPEN-FILES    THRU 1000-EXIT.                           
           PERFORM 2000-READ-F515     THRU 2000-EXIT.                           
           PERFORM 3000-PROCESS-RTN   THRU 3000-EXIT                            
             UNTIL F515-EOF = 'Y'.                                              
           PERFORM 6000-PRINT-TOTAL   THRU 6000-EXIT.                           
           PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       1000-OPEN-FILES.                                                         
      *-------------------------------------------------------------            
           OPEN  INPUT BE01F515                                                 
                       BP13K060                                                 
                   I-O BP13K500                                                 
                       BP13K825                                                 
                       BP13K830                                                 
                       BP13K730                                                 
                       BP13K820                                                 
                OUTPUT BP13F500                                                 
                       P13L506A                                                 
                       P13L506B                                                 
                       P13L506C                                                 
                       P13L506D                                                 
                       P13L506E                                                 
                       P13L506F                                                 
                       P13L506G                                                 
                       BP13L506                                                 
                       BP13F725.                                                
                                                                                
           IF K825-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN OPENING BP13K825 FILE, STATUS IS '            
                       K825-STATUS                                              
              MOVE K825-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES  THRU  9000-EXIT                         
           END-IF                                                               
                                                                                
           IF K060-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN OPENING BP13K060 FILE, STATUS IS '            
                       K060-STATUS                                              
              MOVE K060-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES  THRU  9000-EXIT                         
           END-IF                                                               
                                                                                
           IF K830-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN OPENING BP13K830 FILE, STATUS IS '            
                       K830-STATUS                                              
              MOVE K830-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES  THRU  9000-EXIT                         
           END-IF                                                               
                                                                                
           IF K500-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN OPENING BP13K500 FILE, STATUS IS '            
                       K500-STATUS                                              
              MOVE K500-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES  THRU  9000-EXIT                         
           END-IF                                                               
                                                                                
           IF K730-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN OPENING BP13K730 FILE, STATUS IS '            
                       K730-STATUS                                              
              MOVE K730-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES  THRU  9000-EXIT                         
           END-IF                                                               
                                                                                
           IF K820-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN OPENING BP13K820 FILE, STATUS IS '            
                       K820-STATUS                                              
              MOVE K820-STATUS TO RETURN-CODE                                   
              PERFORM 9000-CLOSE-FILES  THRU  9000-EXIT                         
           END-IF                                                               
                                                                                
           INITIALIZE WS-COUNTERS.                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURR-DATE.                          
           MOVE   CORR WS-CURR-DATE TO   P-DATE.                                
           MOVE   CORR WS-CURR-DATE TO   P-DATE-C.                              
           MOVE   CORR WS-CURR-DATE TO   P-DATE-D.                              
           MOVE   CORR WS-CURR-DATE TO   P-ERROR-DATE.                          
           MOVE   56   TO   WS-LINE-CTR  WS-ERROR-LCTR  WS-LINE-CTR-C.          
                                                                                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       2000-READ-F515.                                                          
      *-------------------------------------------------------------            
           READ BE01F515                                                        
             AT END                                                             
                MOVE 'Y' TO F515-EOF                                            
                GO TO 2000-EXIT                                                 
           END-READ                                                             
                                                                                
           ADD 1 TO WS-F515-READ.                                               
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3000-PROCESS-RTN.                                                        
      *-------------------------------------------------------------            
           MOVE 'N'                        TO  F725-WRT.                        
           MOVE 'Y'                        TO  K825-FND.                        
           MOVE 'N'                        TO  WS-L506-FND.                     
           MOVE SPACES                     TO  WS-ALLO-CAT                      
                                               WS-DTE-BAL                       
                                               WS-CDE-NT1                       
                                               WS-CDE-FLAT-TYPE                 
                                               WS-DTE-REQUEST.                  
                                                                                
           IF BE01F515-SOURCE = 'BP13'                                          
              IF BE01F515-LIVE-STATUS = 'D'                                     
                 MOVE 'Y'                  TO  WS-L506-FND                      
              END-IF                                                            
              PERFORM 3010-READ-BP13K500   THRU 3010-EXIT                       
                                                                                
              MOVE BE01F515-REF-NO(1:8)    TO  K825-NUM-REGN                    
              MOVE BE01F515-IDNO           TO  K825-NUM-NRIC                    
                                                                                
              READ BP13K825                                                     
                                                                                
              EVALUATE K825-STATUS                                              
                WHEN 00                                                         
                   PERFORM 3100-PROCESS-K825      THRU 3100-EXIT                
                WHEN 23                                                         
                  ADD  1  TO  WS-REC-NOTFND                                     
                  DISPLAY 'RECORD NOT FOUND IN BP13K825, KEY IS '               
                         K825-KEY-FLD                                           
                  PERFORM 8530-WRITE-TO-F725      THRU 8530-EXIT                
                  MOVE 'N'                        TO   K825-FND                 
                WHEN OTHER                                                      
                  DISPLAY 'ERROR READING IN BP13K825, STATUS IS '               
                         K825-STATUS                                            
                  PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT                
              END-EVALUATE                                                      
      *       PERFORM 3200-READ-BP13K820          THRU 3200-EXIT                
              PERFORM 3400-WRITE-BP13L506         THRU 3400-EXIT                
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-F515               THRU 2000-EXIT.                 
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3010-READ-BP13K500.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES                      TO BP13K500-REC.                    
           INITIALIZE                          BP13K500-REC.                    
                                                                                
           MOVE BE01F515-REF-NO(1:8)        TO K500-NUM-REGN.                   
                                                                                
           READ BP13K500.                                                       
           EVALUATE K500-STATUS                                                 
           WHEN ZEROES                                                          
                MOVE K500-NUM-ALLO-CAT      TO WS-ALLO-CAT                      
                MOVE K500-DTE-BALLOT        TO WS-DTE-BAL                       
                MOVE K500-CDE-NT1           TO WS-CDE-NT1                       
                MOVE K500-CDE-FLAT-TYPE     TO WS-CDE-FLAT-TYPE                 
                MOVE K500-DTE-REQUEST       TO WS-DTE-REQUEST                   
           WHEN 23                                                              
                PERFORM 3020-READ-BP13K730  THRU 3020-EXIT                      
           WHEN OTHER                                                           
                DISPLAY 'ERROR READING BP13K500, STATUS IS '                    
                        K500-STATUS                                             
                PERFORM 9000-CLOSE-FILES    THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       3010-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3020-READ-BP13K730.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES                      TO BP13K730-REC.                    
           INITIALIZE                          BP13K730-REC.                    
                                                                                
           MOVE BE01F515-REF-NO(1:8)        TO K730-NUM-REGN.                   
                                                                                
           READ BP13K730.                                                       
           EVALUATE K730-STATUS                                                 
           WHEN ZEROES                                                          
                MOVE K730-NUM-ALLO-CAT      TO WS-ALLO-CAT                      
                MOVE K730-DTE-BALLOT        TO WS-DTE-BAL                       
                MOVE K730-CDE-NT1           TO WS-CDE-NT1                       
                MOVE K730-CDE-FLAT-TYPE     TO WS-CDE-FLAT-TYPE                 
                MOVE K730-DTE-REQUEST       TO WS-DTE-REQUEST                   
           WHEN 23                                                              
                DISPLAY 'RECORD NOT FOUND IN K500/K730 ' K730-NUM-REGN          
           WHEN OTHER                                                           
                DISPLAY 'ERROR READING BP13K730, STATUS IS '                    
                        K730-STATUS                                             
                PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       3020-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3100-PROCESS-K825.                                                       
      *-------------------------------------------------------------            
           MOVE  K825-NUM-REGN          TO  WS-TEMP-NUM-REGN.                   
           MOVE  K825-NUM-NRIC          TO  WS-TEMP-NUM-NRIC.                   
           MOVE  K825-NME-OCCP          TO  WS-TEMP-NME-OCCP.                   
           MOVE  K825-NUM-ETHNIC        TO  WS-TEMP-NUM-ETHNIC.                 
           MOVE  K825-NUM-SEX           TO  WS-TEMP-NUM-SEX.                    
           MOVE  K825-DTE-BIRTH         TO  WS-TEMP-DTE-BIRTH.                  
           MOVE  K825-NUM-NATIONALITY   TO  WS-TEMP-NATION.                     
                                                                                
           PERFORM 4000-VALIDATION                THRU 4000-EXIT                
                                                                                
           IF INVALID-REC                                                       
            PERFORM 4500-PRINT-ERROR            THRU 4500-EXIT                  
           END-IF                                                               
                                                                                
           PERFORM 7000-MOVE-OCCP                 THRU 7000-EXIT                
           PERFORM 3500-REWRITE-K825              THRU 3500-EXIT                
           IF K825-NUM-RELATIONSHIP EQUAL '00'                                  
            PERFORM 8000-WRITE-BP13K830-REC THRU 8000-EXIT                      
           ELSE                                                                 
            PERFORM 8530-WRITE-TO-F725             THRU 8530-EXIT               
           END-IF                                                               
           PERFORM 8700-REWRITE-K500-REC          THRU 8700-EXIT                
           IF WS-FLAG-WRITE = 'Y'                                               
              EVALUATE WS-ALLO-CAT                                              
              WHEN 'BTO'                                                        
                   PERFORM 5700-PRINT-DETAIL-D    THRU 5700-EXIT                
              WHEN 'SBF'                                                        
                   PERFORM 5800-PRINT-DETAIL-E    THRU 5800-EXIT                
              WHEN 'ROF'                                                        
              WHEN 'OBF'                                                        
                   PERFORM 5900-PRINT-DETAIL-F    THRU 5900-EXIT                
              END-EVALUATE                                                      
           END-IF.                                                              
           PERFORM 5000-PRINT-DETAIL              THRU 5000-EXIT                
           IF K825-NUM-NATIONALITY NOT = 'SG'                                   
              PERFORM 5500-PRINT-DETAIL-C            THRU 5500-EXIT             
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3200-READ-BP13K820.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES                     TO  BP13K820-REC.                    
           MOVE BE01F515-REF-NO(1:8)       TO  K820-NUM-REGN.                   
           MOVE BE01F515-IDNO              TO  K820-NUM-NRIC.                   
                                                                                
           READ BP13K820.                                                       
                                                                                
           EVALUATE K820-STATUS                                                 
             WHEN 00                                                            
                PERFORM 3300-PROCESS-K820         THRU 3300-EXIT                
             WHEN 23                                                            
               ADD     1  TO  WS-K820-NOTFND                                    
               DISPLAY 'RECORD NOT FOUND IN BP13K820, KEY IS '                  
                      K820-KEY-FLD                                              
               IF F725-WRT = 'N'                                                
                  PERFORM 8530-WRITE-TO-F725      THRU 8530-EXIT                
               END-IF                                                           
             WHEN OTHER                                                         
               DISPLAY 'ERROR READING IN BP13K825, STATUS IS '                  
                      K825-STATUS                                               
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT                
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3300-PROCESS-K820.                                                       
      *-------------------------------------------------------------            
           IF K825-FND = 'N'                                                    
              MOVE K820-NUM-REGN        TO  WS-TEMP-NUM-REGN                    
              MOVE K820-NUM-NRIC        TO  WS-TEMP-NUM-NRIC                    
              MOVE K820-NME-OCCP        TO  WS-TEMP-NME-OCCP                    
              MOVE K820-NUM-ETHNIC      TO  WS-TEMP-NUM-ETHNIC                  
              MOVE K820-NUM-SEX         TO  WS-TEMP-NUM-SEX                     
              MOVE K820-DTE-BIRTH       TO  WS-TEMP-DTE-BIRTH                   
              MOVE K820-NUM-NATIONALITY TO  WS-TEMP-NATION                      
                                                                                
              PERFORM 4000-VALIDATION             THRU 4000-EXIT                
                                                                                
              IF INVALID-REC                                                    
                 PERFORM 4500-PRINT-ERROR         THRU 4500-EXIT                
              END-IF                                                            
                                                                                
              IF K820-NUM-RELATIONSHIP EQUAL '00'                               
               PERFORM 8000-WRITE-BP13K830-REC    THRU 8000-EXIT                
              ELSE                                                              
               IF F725-WRT = 'N'                                                
                  PERFORM 8530-WRITE-TO-F725      THRU 8530-EXIT                
               END-IF                                                           
              END-IF                                                            
                                                                                
              PERFORM 8700-REWRITE-K500-REC       THRU 8700-EXIT                
              PERFORM 5000-PRINT-DETAIL           THRU 5000-EXIT                
                                                                                
              IF K820-NUM-NATIONALITY NOT = 'SG'                                
                 PERFORM 5500-PRINT-DETAIL-C      THRU 5500-EXIT                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 7100-MOVE-OCCP-K820            THRU 7100-EXIT.               
           PERFORM 3600-REWRITE-K820              THRU 3600-EXIT.               
           IF K825-FND = 'N'                                                    
              IF WS-FLAG-WRITE = 'Y'                                            
                 EVALUATE WS-ALLO-CAT                                           
                 WHEN 'BTO'                                                     
                      PERFORM 5700-PRINT-DETAIL-D THRU 5700-EXIT                
                 WHEN 'SBF'                                                     
                      PERFORM 5800-PRINT-DETAIL-E THRU 5800-EXIT                
                 WHEN 'ROF'                                                     
                 WHEN 'OBF'                                                     
                      PERFORM 5900-PRINT-DETAIL-F THRU 5900-EXIT                
                 END-EVALUATE                                                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3400-WRITE-BP13L506.                                                     
      *-------------------------------------------------------------            
           IF WS-L506-FND = 'Y'                                                 
              MOVE SPACES               TO  BP13L506-REC                        
              MOVE BE01F515-REF-NO(1:8) TO  L506-NUM-REGN                       
              MOVE BE01F515-IDNO        TO  L506-NUM-DECEASED-NRIC              
              MOVE WS-ALLO-CAT          TO  L506-NUM-ALLO-CAT                   
              MOVE WS-DTE-BAL           TO  L506-DTE-BALLOT                     
              WRITE BP13L506-REC                                                
              ADD 1                     TO  WS-L506-WRITE                       
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3500-REWRITE-K825.                                                       
      *-------------------------------------------------------------            
           REWRITE BP13K825-REC.                                                
                                                                                
           IF K825-STATUS = '00'                                                
              ADD  1                     TO WS-REC-UPDATED                      
           ELSE                                                                 
              DISPLAY 'ERROR REWRITING IN BP13K825, STATUS IS '                 
                       K825-STATUS                                              
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       3600-REWRITE-K820.                                                       
      *-------------------------------------------------------------            
           REWRITE BP13K820-REC.                                                
                                                                                
           IF K820-STATUS = '00'                                                
              ADD  1                     TO WS-K820-UPDATED                     
           ELSE                                                                 
              DISPLAY 'ERROR REWRITING IN BP13K820, STATUS IS '                 
                       K820-STATUS                                              
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                           
           END-IF.                                                              
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       4000-VALIDATION.                                                         
      *-------------------------------------------------------------            
           MOVE SPACES                   TO WS-REMARKS.                         
           MOVE ZERO                     TO WS-REC-VALIDATE.                    
           MOVE SPACE                    TO P-BIRTH-AST                         
                                            P-SEX-AST                           
                                            P-NATNLTY-AST                       
                                            P-RACE-AST.                         
                                                                                
           PERFORM 4100-VALIDATE-BIRTH THRU 4100-EXIT.                          
                                                                                
           MOVE 22                       TO K060-SERIAL-NO.                     
           MOVE BE01F515-SEX             TO K060-CODE WS-SEX.                   
           PERFORM 4200-READ-K060        THRU 4200-EXIT.                        
                                                                                
           IF K060-STATUS NOT = 00                                              
              MOVE '*'    TO    P-SEX-AST                                       
              MOVE ' SEX NOT VALID               ' TO  WS-REMARKS               
              MOVE  SPACES                         TO  WS-SEX                   
           END-IF.                                                              
                                                                                
           PERFORM 4300-CHK-NATIONALITY THRU 4300-EXIT.                         
                                                                                
           IF BE01F515-SRC-TAG = 'I'                                            
              MOVE BE01F515-RACE        TO WS-NUM-ETHNIC                        
           ELSE                                                                 
              PERFORM 4400-CHK-RACE     THRU 4400-EXIT                          
           END-IF.                                                              
                                                                                
           IF WS-NATION NOT = WS-TEMP-NATION                                    
              MOVE  1              TO WS-REC-VALIDATE                           
              MOVE '*'             TO P-NATNLTY-AST                             
              MOVE ' DIFFERENT NATIONALITY       ' TO  WS-REMARKS               
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       4100-VALIDATE-BIRTH.                                                     
      *-------------------------------------------------------------            
           MOVE 'CD'                     TO  WS-IN-OPTION.                      
                                                                                
           STRING BE01F515-DATE-BIRTH(1:4)                                      
                  BE01F515-DATE-BIRTH(6:2)                                      
                  BE01F515-DATE-BIRTH(9:2)                                      
                  DELIMITED BY SIZE INTO WS-IN-DATE.                            
                                                                                
           MOVE WS-IN-DATE TO WS-BIRTH-DATE.                                    
                                                                                
           CALL 'AV02C001' USING WS-LINK-REC.                                   
                                                                                
           IF WS-RETURN NOT = '000'                                             
              MOVE 1                     TO  WS-REC-VALIDATE                    
              MOVE '*'                   TO  P-BIRTH-AST                        
              MOVE ' INVALID BIRTH DATE          ' TO  WS-REMARKS               
              IF WS-BIRTH-CCYY NOT = SPACES AND LOW-VALUES AND '0000'           
                 IF WS-BIRTH-MM = '00' AND WS-BIRTH-DD = '00'                   
                    MOVE '01'                      TO WS-BIRTH-MM               
                    MOVE '01'                      TO WS-BIRTH-DD               
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES                       TO  WS-BIRTH-DATE            
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       4200-READ-K060.                                                          
      *-------------------------------------------------------------            
           READ BP13K060.                                                       
                                                                                
           EVALUATE K060-STATUS                                                 
           WHEN 00                                                              
                CONTINUE                                                        
           WHEN 23                                                              
                MOVE   1     TO WS-REC-VALIDATE                                 
                MOVE  SPACES TO K060-DESC                                       
           WHEN OTHER                                                           
                 DISPLAY 'ERROR READING IN BP13K060, STATUS IS '                
                          K060-STATUS                                           
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       4300-CHK-NATIONALITY.                                                    
      *-------------------------------------------------------------            
                                                                                
           MOVE BE01F515-NATNLTY     TO WS-NUM-NTNLTY WS-NATION.                
            EXEC SQL                                                            
                 SELECT NME_NTNLTY                                              
                  INTO :DCLNATIONALITY.NME-NTNLTY                               
                  FROM  NATIONALITY                                             
                  WHERE NUM_NTNLTY  = :WS-NUM-NTNLTY                            
                  AND NUM_CODE_STATUS = 'A'                                     
            END-EXEC.                                                           
                                                                                
           EVALUATE SQLCODE                                                     
               WHEN 000                                                         
                    CONTINUE                                                    
               WHEN 100                                                         
                MOVE  1              TO WS-REC-VALIDATE                         
                MOVE '*'             TO P-NATNLTY-AST                           
                MOVE ' NATIONALITY INVALID         ' TO  WS-REMARKS             
                MOVE  SPACES                         TO  WS-NATION              
                DISPLAY  "REC. NOT FOUND IN NATIONALITY TABLE :"                
                           WS-NUM-NTNLTY                                        
               WHEN OTHER                                                       
                DISPLAY 'SQL ERROR IN NATIONALITY TABLE    '                    
                DISPLAY 'WS-NUM-NTNLTY    :  ' WS-NUM-NTNLTY                    
                DISPLAY 'SQL ERROR CODE  :  '  SQLCODE                          
                DISPLAY SPACES                                                  
                PERFORM 9999-SQL-ERROR  THRU 9999-EXIT                          
           END-EVALUATE.                                                        
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       4400-CHK-RACE.                                                           
      *-------------------------------------------------------------            
      *-----------------------------------------------------------*             
      *  EXTRACT THE RACE ETHNIC GROUP FROM RACE ETHNIC TABLE                   
      *-----------------------------------------------------------*             
           MOVE SPACES         TO NUM-ETHNIC-GROUP                              
                                  NUM-RACE.                                     
           MOVE BE01F515-RACE  TO NUM-RACE.                                     
                                                                                
           EXEC SQL SELECT NUM_ETHNIC_GROUP                                     
                      INTO :DCLRACE-ETHNIC.NUM-ETHNIC-GROUP                     
                      FROM RACE_ETHNIC                                          
                     WHERE NUM_RACE = :NUM-RACE                                 
                       AND NUM_CODE_STATUS = 'A'                                
           END-EXEC.                                                            
                                                                                
           IF SQLCODE = WS-SQL-CDE-NOTFND                                       
              MOVE SQLCODE        TO WS-SQL-STATUS                              
              DISPLAY 'RACE ETHNIC CDE NOT FOUND IN TABLE: '                    
                                     BE01F515-RACE                              
              MOVE '*'               TO P-RACE-AST                              
              MOVE SPACES            TO WS-NUM-ETHNIC                           
              MOVE  1                TO WS-REC-VALIDATE                         
              MOVE ' RACE INVALID                ' TO  WS-REMARKS               
              GO TO 4400-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE NUM-ETHNIC-GROUP  TO WS-NUM-ETHNIC.                             
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       4500-PRINT-ERROR.                                                        
      *-------------------------------------------------------------            
            IF WS-ERROR-LCTR > 54                                               
               PERFORM 4600-PRINT-ERROR-HDG  THRU  4600-EXIT                    
            END-IF.                                                             
                                                                                
            ADD   1                        TO WS-ERR-CTR.                       
            MOVE  WS-ERR-CTR               TO P-SERIAL-ERR.                     
            MOVE  WS-TEMP-NUM-REGN         TO P-REGN-ERR.                       
            MOVE  WS-TEMP-NUM-NRIC         TO P-NRIC-ERR.                       
            MOVE  WS-TEMP-NME-OCCP         TO P-NAME-ERR.                       
            MOVE  BE01F515-SEX             TO P-SEX-ERR.                        
                                                                                
            IF P-RACE-AST = '*'                                                 
               MOVE  BE01F515-RACE         TO P-RACE-ERR                        
            ELSE                                                                
               MOVE  WS-NUM-ETHNIC         TO P-RACE-ERR.                       
                                                                                
            MOVE  BE01F515-NATNLTY         TO P-NATNLTY-ERR.                    
                                                                                
            STRING BE01F515-DATE-BIRTH(1:4)                                     
                  BE01F515-DATE-BIRTH(6:2)                                      
                  BE01F515-DATE-BIRTH(9:2)                                      
                  DELIMITED BY SIZE INTO P-BIRTH-ERR                            
            END-STRING.                                                         
                                                                                
            MOVE  WS-REMARKS               TO P-REMARKS-ERR.                    
                                                                                
            WRITE P13L506B-REC   FROM P-ERROR-DETAIL AFTER 1.                   
            ADD   1                        TO WS-ERROR-LCTR.                    
                                                                                
       4500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       4600-PRINT-ERROR-HDG.                                                    
      *-------------------------------------------------------------            
            ADD   1              TO WS-ERROR-PCTR.                              
            MOVE  WS-ERROR-PCTR  TO P-ERROR-PAGENO.                             
            WRITE P13L506B-REC FROM P-ERROR-TITLE-1 AFTER ADVANCING PAGE        
            WRITE P13L506B-REC FROM P-ERROR-TITLE-2 AFTER ADVANCING 2.          
            WRITE P13L506B-REC FROM P-ERROR-LINE    AFTER ADVANCING 1.          
            WRITE P13L506B-REC FROM P-BLANK         AFTER ADVANCING 1.          
            MOVE  5              TO WS-ERROR-LCTR.                              
                                                                                
       4600-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       5000-PRINT-DETAIL.                                                       
      *-------------------------------------------------------------            
           IF WS-LINE-CTR > 54 OR WS-REC-PRINTED = 0                            
              PERFORM 5100-PRINT-HEADING THRU 5100-EXIT                         
           END-IF.                                                              
                                                                                
           ADD  1                        TO WS-REC-PRINTED                      
           MOVE WS-REC-PRINTED           TO P-SERIAL.                           
           MOVE WS-TEMP-NUM-REGN         TO P-REGN.                             
           MOVE WS-TEMP-NUM-NRIC         TO P-NRIC.                             
           MOVE WS-TEMP-NME-OCCP         TO P-NAME.                             
           MOVE WS-TEMP-NUM-SEX          TO P-SEX.                              
           MOVE WS-NUM-ETHNIC            TO P-RACE.                             
           MOVE WS-TEMP-NATION           TO P-NATNLTY.                          
           MOVE WS-TEMP-DTE-BIRTH        TO P-BIRTH.                            
                                                                                
           WRITE P13L506A-REC FROM P-DETAIL AFTER ADVANCING 1.                  
           ADD   1                       TO WS-LINE-CTR.                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5100-PRINT-HEADING.                                                      
      *-------------------------------------------------------------            
           ADD   1              TO WS-PAGE-CTR.                                 
           MOVE  WS-PAGE-CTR    TO P-PAGENO.                                    
           WRITE P13L506A-REC FROM P-TITLE-1 AFTER ADVANCING PAGE.              
           WRITE P13L506A-REC FROM P-TITLE-2 AFTER ADVANCING 2.                 
           WRITE P13L506A-REC FROM P-LINE    AFTER ADVANCING 1.                 
           WRITE P13L506A-REC FROM P-BLANK   AFTER ADVANCING 1.                 
           MOVE  5              TO WS-LINE-CTR.                                 
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       5500-PRINT-DETAIL-C.                                                     
      *-------------------------------------------------------------            
           IF WS-LINE-CTR-C > 54 OR WS-REC-PRINTED-C = 0                        
              PERFORM 5600-PRINT-HEADING-C THRU 5600-EXIT                       
           END-IF.                                                              
                                                                                
           ADD  1                        TO WS-REC-PRINTED-C                    
           MOVE WS-REC-PRINTED-C         TO P-SERIAL-C.                         
           MOVE WS-TEMP-NUM-REGN         TO P-REGN-C.                           
           MOVE WS-TEMP-NUM-REGN         TO P-REGN-C.                           
           MOVE WS-TEMP-NUM-NRIC         TO P-NRIC-C.                           
           MOVE WS-TEMP-NME-OCCP         TO P-NAME-C.                           
           MOVE WS-TEMP-NUM-SEX          TO P-SEX-C.                            
           MOVE WS-NUM-ETHNIC            TO P-RACE-C.                           
           MOVE WS-TEMP-NATION           TO P-NATNLTY-C.                        
           MOVE WS-TEMP-DTE-BIRTH        TO P-BIRTH-C.                          
                                                                                
           WRITE P13L506C-REC FROM P-DETAIL-C AFTER ADVANCING 1.                
           ADD   1                       TO WS-LINE-CTR-C.                      
                                                                                
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5600-PRINT-HEADING-C.                                                    
      *-------------------------------------------------------------            
           ADD   1              TO WS-PAGE-CTR-C.                               
           MOVE  WS-PAGE-CTR-C  TO P-PAGENO-C.                                  
           WRITE P13L506C-REC FROM P-TITLE-1-C AFTER ADVANCING PAGE.            
           WRITE P13L506C-REC FROM P-TITLE-2-C AFTER ADVANCING 2.               
           WRITE P13L506C-REC FROM P-LINE-C    AFTER ADVANCING 1.               
           WRITE P13L506C-REC FROM P-BLANK     AFTER ADVANCING 1.               
           MOVE  5              TO WS-LINE-CTR-C.                               
                                                                                
       5600-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5700-PRINT-DETAIL-D.                                                     
      *-------------------------------------------------------------            
           IF WS-LINE-CTR-D > 54 OR WS-REC-PRINTED-D = 0                        
              PERFORM 5750-PRINT-HEADING-D THRU 5750-EXIT                       
           END-IF.                                                              
                                                                                
           ADD  1                        TO WS-REC-PRINTED-D                    
           MOVE WS-REC-PRINTED-D         TO P-SERIAL-D.                         
           MOVE WS-TEMP-NUM-REGN         TO P-REGN-D.                           
           MOVE WS-TEMP-NUM-NRIC         TO P-NRIC-D.                           
           MOVE WS-TEMP-NME-OCCP         TO P-OCCP-NAME-D.                      
           MOVE BE01W903-OUT-NME-PERSON  TO P-MHA-NAME-D.                       
           MOVE WS-OCCP-SEX              TO P-OCCP-SEX-D.                       
           MOVE WS-MHA-SEX               TO P-MHA-SEX-D.                        
                                                                                
           WRITE P13L506D-REC FROM P-DETAIL-D AFTER ADVANCING 1.                
           ADD   1                       TO WS-LINE-CTR-D.                      
                                                                                
           PERFORM 5990-PRINT-L506G THRU 5990-EXIT.                             
                                                                                
       5700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5750-PRINT-HEADING-D.                                                    
      *-------------------------------------------------------------            
           MOVE 'P13L506D'      TO P-NME-PGM-D.                                 
           MOVE 'BTO'           TO P-SMODE-D.                                   
           ADD   1              TO WS-PAGE-CTR-D.                               
           MOVE  WS-PAGE-CTR-D  TO P-PAGENO-D.                                  
           WRITE P13L506D-REC FROM P-TITLE-1-D AFTER ADVANCING PAGE.            
           WRITE P13L506D-REC FROM P-TITLE-2-D AFTER ADVANCING 2.               
           WRITE P13L506D-REC FROM P-TITLE-3-D AFTER ADVANCING 1.               
           WRITE P13L506D-REC FROM P-LINE-D    AFTER ADVANCING 1.               
           MOVE  5              TO WS-LINE-CTR-D.                               
                                                                                
       5750-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5800-PRINT-DETAIL-E.                                                     
      *-------------------------------------------------------------            
           IF WS-LINE-CTR-E > 54 OR WS-REC-PRINTED-E = 0                        
              PERFORM 5850-PRINT-HEADING-E THRU 5850-EXIT                       
           END-IF.                                                              
                                                                                
           ADD  1                        TO WS-REC-PRINTED-E                    
           MOVE WS-REC-PRINTED-E         TO P-SERIAL-D.                         
           MOVE WS-TEMP-NUM-REGN         TO P-REGN-D.                           
           MOVE WS-TEMP-NUM-NRIC         TO P-NRIC-D.                           
           MOVE WS-TEMP-NME-OCCP         TO P-OCCP-NAME-D.                      
           MOVE BE01W903-OUT-NME-PERSON  TO P-MHA-NAME-D.                       
           MOVE WS-OCCP-SEX              TO P-OCCP-SEX-D.                       
           MOVE WS-MHA-SEX               TO P-MHA-SEX-D.                        
                                                                                
           WRITE P13L506E-REC FROM P-DETAIL-D AFTER ADVANCING 1.                
           ADD   1                       TO WS-LINE-CTR-E.                      
                                                                                
           PERFORM 5990-PRINT-L506G THRU 5990-EXIT.                             
                                                                                
       5800-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5850-PRINT-HEADING-E.                                                    
      *-------------------------------------------------------------            
           MOVE 'P13L506E'      TO P-NME-PGM-D.                                 
           MOVE 'SBF'           TO P-SMODE-D.                                   
           ADD   1              TO WS-PAGE-CTR-E.                               
           MOVE  WS-PAGE-CTR-E  TO P-PAGENO-D.                                  
           WRITE P13L506E-REC FROM P-TITLE-1-D AFTER ADVANCING PAGE.            
           WRITE P13L506E-REC FROM P-TITLE-2-D AFTER ADVANCING 2.               
           WRITE P13L506E-REC FROM P-TITLE-3-D AFTER ADVANCING 1.               
           WRITE P13L506E-REC FROM P-LINE-D    AFTER ADVANCING 1.               
           MOVE  5              TO WS-LINE-CTR-E.                               
                                                                                
       5850-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5900-PRINT-DETAIL-F.                                                     
      *-------------------------------------------------------------            
           IF WS-LINE-CTR-F > 54 OR WS-REC-PRINTED-F = 0                        
              PERFORM 5950-PRINT-HEADING-F THRU 5950-EXIT                       
           END-IF.                                                              
                                                                                
           ADD  1                        TO WS-REC-PRINTED-F                    
           MOVE WS-REC-PRINTED-F         TO P-SERIAL-D.                         
           MOVE WS-TEMP-NUM-REGN         TO P-REGN-D.                           
           MOVE WS-TEMP-NUM-NRIC         TO P-NRIC-D.                           
           MOVE WS-TEMP-NME-OCCP         TO P-OCCP-NAME-D.                      
           MOVE BE01W903-OUT-NME-PERSON  TO P-MHA-NAME-D.                       
           MOVE WS-OCCP-SEX              TO P-OCCP-SEX-D.                       
           MOVE WS-MHA-SEX               TO P-MHA-SEX-D.                        
                                                                                
           WRITE P13L506F-REC FROM P-DETAIL-D AFTER ADVANCING 1.                
           ADD   1                       TO WS-LINE-CTR-F.                      
                                                                                
           PERFORM 5990-PRINT-L506G THRU 5990-EXIT.                             
                                                                                
       5900-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5950-PRINT-HEADING-F.                                                    
      *-------------------------------------------------------------            
           MOVE 'P13L506F'      TO P-NME-PGM-D.                                 
           IF WS-ALLO-CAT = 'ROF'                                               
              MOVE 'ROF'        TO P-SMODE-D                                    
           ELSE                                                                 
              MOVE 'OBF'        TO P-SMODE-D                                    
           END-IF                                                               
           ADD   1              TO WS-PAGE-CTR-F.                               
           MOVE  WS-PAGE-CTR-F  TO P-PAGENO-D.                                  
           WRITE P13L506F-REC FROM P-TITLE-1-D AFTER ADVANCING PAGE.            
           WRITE P13L506F-REC FROM P-TITLE-2-D AFTER ADVANCING 2.               
           WRITE P13L506F-REC FROM P-TITLE-3-D AFTER ADVANCING 1.               
           WRITE P13L506F-REC FROM P-LINE-D    AFTER ADVANCING 1.               
           MOVE  5              TO WS-LINE-CTR-F.                               
                                                                                
       5950-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       5990-PRINT-L506G.                                                        
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES                  TO P13L506G-REC.                        
                                                                                
           IF WS-L506G-WRITE = ZEROES                                           
              WRITE P13L506G-REC FROM P-TITLE-1-G                               
           END-IF.                                                              
                                                                                
           MOVE P-REGN-D                TO P-REGN-G.                            
           MOVE WS-ALLO-CAT             TO P-ALLO-CAT-G.                        
           MOVE WS-DTE-BAL              TO P-DTE-BAL-G.                         
           MOVE WS-CDE-NT1              TO P-CDE-NT1-G.                         
           MOVE WS-CDE-FLAT-TYPE        TO P-CDE-FLAT-TYPE-G.                   
           MOVE WS-DTE-REQUEST          TO P-DTE-REQUEST-G.                     
           MOVE P-NRIC-D                TO P-NRIC-G.                            
           MOVE P-OCCP-NAME-D           TO P-OCCP-NAME-G.                       
           MOVE P-MHA-NAME-D            TO P-MHA-NAME-G.                        
           MOVE P-OCCP-SEX-D            TO P-OCCP-SEX-G.                        
           MOVE P-MHA-SEX-D             TO P-MHA-SEX-G.                         
                                                                                
           WRITE P13L506G-REC FROM P-DETAIL-1-G.                                
           ADD 1                        TO WS-L506G-WRITE.                      
                                                                                
       5990-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       6000-PRINT-TOTAL.                                                        
      *-------------------------------------------------------------            
           MOVE WS-F515-READ             TO P-F515-READ.                        
           MOVE WS-REC-NOTFND            TO P-REC-NOTFND.                       
           MOVE WS-K820-NOTFND           TO P-K820-NOTFND.                      
           MOVE WS-REC-UPDATED           TO P-REC-UPDATED.                      
           MOVE WS-K820-UPDATED          TO P-K820-UPDATED.                     
           MOVE WS-REC-PRINTED           TO P-REC-PRINTED.                      
           MOVE WS-ERR-CTR               TO P-ERR-ENCTRD.                       
           MOVE WS-K830-WRITE            TO P-K830-WRITE.                       
           MOVE WS-K830-REWRITE          TO P-K830-REWRITE.                     
           MOVE WS-K500-REWRITE          TO P-K500-REWRITE.                     
           MOVE WS-K730-REWRITE          TO P-K730-REWRITE.                     
                                                                                
           IF WS-LINE-CTR > 50                                                  
              WRITE P13L506A-REC FROM P-TOTAL AFTER PAGE                        
           END-IF.                                                              
                                                                                
           WRITE P13L506A-REC FROM P-TOTAL-1  AFTER ADVANCING 2.                
           WRITE P13L506A-REC FROM P-TOTAL-2  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-3  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-4  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-5  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-6  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-7  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-8  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-9  AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-10 AFTER ADVANCING 1.                
           WRITE P13L506A-REC FROM P-TOTAL-11 AFTER ADVANCING 1.                
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       7000-MOVE-OCCP.                                                          
      *-------------------------------------------------------------            
           MOVE SPACES                    TO WS-OCCP-SEX                        
                                             WS-MHA-SEX                         
                                             WS-UPD-SEX.                        
           MOVE 'N'                       TO WS-FLAG-WRITE.                     
                                                                                
      *** WHEN WS-SEX IS BLANK IT MEANS BE01F515-SEX IS NOT FOUND IN            
      *** BP13K060 USING SERIAL-NO '22' OR VALUE IS INVALID                     
           IF WS-SEX = SPACES                                                   
              CONTINUE                                                          
           ELSE                                                                 
              IF BE01F515-SEX IS NOT NUMERIC                                    
                 MOVE 43                  TO K060-SERIAL-NO                     
                 MOVE BE01F515-SEX        TO K060-CODE                          
                 PERFORM 4200-READ-K060   THRU 4200-EXIT                        
                 MOVE K060-DESC(1:1)      TO WS-UPD-SEX                         
                 MOVE BE01F515-SEX        TO WS-MHA-SEX                         
              ELSE                                                              
                 MOVE 43                  TO K060-SERIAL-NO                     
                 MOVE BE01F515-SEX        TO K060-CODE                          
                 PERFORM 4200-READ-K060   THRU 4200-EXIT                        
                 MOVE BE01F515-SEX        TO WS-UPD-SEX                         
                 MOVE K060-DESC(1:1)      TO WS-MHA-SEX                         
              END-IF                                                            
              IF WS-TEMP-NUM-SEX IS NUMERIC                                     
                 MOVE 43                  TO K060-SERIAL-NO                     
                 MOVE WS-TEMP-NUM-SEX     TO K060-CODE                          
                 PERFORM 4200-READ-K060   THRU 4200-EXIT                        
                 MOVE K060-DESC(1:1)      TO WS-OCCP-SEX                        
              ELSE                                                              
                 MOVE WS-TEMP-NUM-SEX     TO WS-OCCP-SEX                        
              END-IF                                                            
                                                                                
              IF WS-TEMP-NUM-SEX NOT = WS-UPD-SEX                               
      *          MOVE WS-UPD-SEX          TO K825-NUM-SEX                       
                 MOVE 'Y'                 TO WS-FLAG-WRITE                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
            MOVE 42                   TO K060-SERIAL-NO.                        
            MOVE WS-NUM-ETHNIC        TO K060-CODE.                             
            PERFORM 4200-READ-K060    THRU 4200-EXIT.                           
      *     MOVE K060-DESC            TO K825-NUM-ETHNIC.                       
                                                                                
           IF K825-NUM-RELATIONSHIP EQUAL '97'                                  
              IF BE01F515-SEX EQUAL 'M'                                         
      *          MOVE '22'               TO  K825-NUM-RELATIONSHIP              
                 CONTINUE                                                       
              END-IF                                                            
              IF BE01F515-SEX EQUAL 'F'                                         
      *          MOVE '32'               TO  K825-NUM-RELATIONSHIP              
                 CONTINUE                                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K825-NUM-RELATIONSHIP EQUAL '98'                                  
              IF BE01F515-SEX EQUAL 'M'                                         
      *          MOVE '02'               TO  K825-NUM-RELATIONSHIP              
                 CONTINUE                                                       
              END-IF                                                            
              IF BE01F515-SEX EQUAL 'F'                                         
      *          MOVE '12'               TO  K825-NUM-RELATIONSHIP              
                 CONTINUE                                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 7500-CALL-BE01C903    THRU 7500-EXIT.                        
      *    MOVE BE01W903-OUT-NME-PERSON  TO  K825-NME-OCCP.                     
                                                                                
      *    MOVE WS-BIRTH-DATE            TO  K825-DTE-BIRTH.                    
           MOVE WS-NATION                TO  K825-NUM-NATIONALITY.              
                                                                                
       7000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       7100-MOVE-OCCP-K820.                                                     
      *-------------------------------------------------------------            
           MOVE SPACES                    TO WS-OCCP-SEX                        
                                             WS-MHA-SEX                         
                                             WS-UPD-SEX.                        
           MOVE 'N'                       TO WS-FLAG-WRITE.                     
                                                                                
      *** WHEN WS-SEX IS BLANK IT MEANS BE01F515-SEX IS NOT FOUND IN            
      *** BP13K060 USING SERIAL-NO '22' OR VALUE IS INVALID                     
           IF WS-SEX = SPACES                                                   
              CONTINUE                                                          
           ELSE                                                                 
              IF BE01F515-SEX IS NOT NUMERIC                                    
                 MOVE 43                  TO K060-SERIAL-NO                     
                 MOVE BE01F515-SEX        TO K060-CODE                          
                 PERFORM 4200-READ-K060   THRU 4200-EXIT                        
                 MOVE K060-DESC(1:1)      TO WS-UPD-SEX                         
                 MOVE BE01F515-SEX        TO WS-MHA-SEX                         
              ELSE                                                              
                 MOVE 43                  TO K060-SERIAL-NO                     
                 MOVE BE01F515-SEX        TO K060-CODE                          
                 PERFORM 4200-READ-K060   THRU 4200-EXIT                        
                 MOVE BE01F515-SEX        TO WS-UPD-SEX                         
                 MOVE K060-DESC(1:1)      TO WS-MHA-SEX                         
              END-IF                                                            
              IF WS-TEMP-NUM-SEX IS NUMERIC                                     
                 MOVE 43                  TO K060-SERIAL-NO                     
                 MOVE WS-TEMP-NUM-SEX     TO K060-CODE                          
                 PERFORM 4200-READ-K060   THRU 4200-EXIT                        
                 MOVE K060-DESC(1:1)      TO WS-OCCP-SEX                        
              ELSE                                                              
                 MOVE WS-TEMP-NUM-SEX     TO WS-OCCP-SEX                        
              END-IF                                                            
                                                                                
              IF WS-TEMP-NUM-SEX NOT = WS-UPD-SEX                               
                 MOVE WS-UPD-SEX          TO K820-NUM-SEX                       
                 MOVE 'Y'                 TO WS-FLAG-WRITE                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
            MOVE 42                   TO K060-SERIAL-NO.                        
            MOVE WS-NUM-ETHNIC        TO K060-CODE.                             
            PERFORM 4200-READ-K060    THRU 4200-EXIT.                           
            MOVE K060-DESC            TO K820-NUM-ETHNIC.                       
                                                                                
           IF K820-NUM-RELATIONSHIP EQUAL '97'                                  
              IF BE01F515-SEX EQUAL 'M'                                         
                 MOVE '22'               TO  K820-NUM-RELATIONSHIP              
              END-IF                                                            
              IF BE01F515-SEX EQUAL 'F'                                         
                 MOVE '32'               TO  K820-NUM-RELATIONSHIP              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K820-NUM-RELATIONSHIP EQUAL '98'                                  
              IF BE01F515-SEX EQUAL 'M'                                         
                 MOVE '02'               TO  K820-NUM-RELATIONSHIP              
              END-IF                                                            
              IF BE01F515-SEX EQUAL 'F'                                         
                 MOVE '12'               TO  K820-NUM-RELATIONSHIP              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 7500-CALL-BE01C903    THRU 7500-EXIT.                        
           MOVE BE01W903-OUT-NME-PERSON  TO  K820-NME-OCCP                      
                                                                                
           MOVE WS-BIRTH-DATE            TO  K820-DTE-BIRTH.                    
           MOVE WS-NATION                TO  K820-NUM-NATIONALITY.              
                                                                                
       7100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       7500-CALL-BE01C903.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES                 TO BE01W903-COMMAREA                     
           INITIALIZE                     BE01W903-COMMAREA                     
                                                                                
           MOVE 66                     TO BE01W903-IN-NME-LENGTH                
           MOVE BE01F515-NAME                                                   
                                       TO BE01W903-IN-NME-PRNCPL                
           MOVE BE01F515-HANYUPINYIN-NAME                                       
                                       TO BE01W903-IN-NME-HANYU-PINYIN          
           MOVE BE01F515-ALIAS-NAME                                             
                                       TO BE01W903-IN-NME-ALIAS                 
           MOVE BE01F515-HANYUPINYIN-ALIAS                                      
                                       TO BE01W903-IN-NME-HANYU-ALIAS           
           MOVE BE01F515-MARRIED-NAME                                           
                                       TO BE01W903-IN-NME-MARRIED               
           CALL 'BE01C903' USING BE01W903-COMMAREA.                             
                                                                                
       7500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8000-WRITE-BP13K830-REC.                                                 
      *-------------------------------------------------------------            
            MOVE  SPACES                     TO  K830-KEY-FLD.                  
            MOVE  BE01F515-REF-NO(1:8)       TO  K830-KEY-FLD.                  
            READ BP13K830.                                                      
                                                                                
            EVALUATE K830-STATUS                                                
            WHEN 00                                                             
                 PERFORM 8500-MOVE-TO-K830 THRU 8500-EXIT                       
                 REWRITE BP13K830-REC                                           
                 EVALUATE K830-STATUS                                           
                 WHEN 00                                                        
                      ADD   1                TO WS-K830-REWRITE                 
                 WHEN OTHER                                                     
                      DISPLAY 'ERROR REWRITING  BP13K830, STATUS IS '           
                               K830-STATUS ' ' K830-KEY-FLD ' '                 
                               BE01F515-REF-NO(1:8)                             
                      PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                  
                 END-EVALUATE                                                   
            WHEN 23                                                             
                 PERFORM  8100-READ-ALT-KEY   THRU 8100-EXIT                    
                 DISPLAY 'READING ALTERNATE KEY, KEY IS '                       
                          BE01F515-REF-NO(1:8)                                  
            WHEN OTHER                                                          
                 DISPLAY 'ERROR WRITING BP13K830, STATUS IS '                   
                          K830-STATUS                                           
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                       
            END-EVALUATE.                                                       
                                                                                
       8000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8100-READ-ALT-KEY.                                                       
      *-------------------------------------------------------------            
            INITIALIZE                          BP13K830-REC.                   
            MOVE  BE01F515-REF-NO(1:8)       TO K830-NUM-REGN.                  
                                                                                
            READ BP13K830                                                       
                 KEY IS K830-NUM-REGN                                           
            END-READ.                                                           
                                                                                
            EVALUATE K830-STATUS                                                
            WHEN 00                                                             
            WHEN 02                                                             
                 PERFORM 8500-MOVE-TO-K830 THRU 8500-EXIT                       
                 REWRITE BP13K830-REC                                           
                 EVALUATE K830-STATUS                                           
                 WHEN 00                                                        
                      ADD   1                TO WS-K830-REWRITE                 
                 WHEN OTHER                                                     
                      DISPLAY 'ERROR REWRITING  BP13K830, STATUS IS '           
                               K830-STATUS ' ' K830-KEY-FLD ' '                 
                               BE01F515-REF-NO(1:8)                             
                      PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                  
                 END-EVALUATE                                                   
            WHEN 10                                                             
                 DISPLAY 'END OF FILE   BP18K830, STATUS IS '                   
                          K830-STATUS                                           
            WHEN 23                                                             
                 DISPLAY 'RECORD NOT FOUND IN BP13K830   KEY IS '               
                          K830-NUM-REGN                                         
            WHEN OTHER                                                          
                 DISPLAY 'ERROR WRITING BP13K830, STATUS IS '                   
                          K830-STATUS                                           
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                       
            END-EVALUATE.                                                       
                                                                                
       8100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8500-MOVE-TO-K830.                                                       
      *-------------------------------------------------------------            
                                                                                
           IF BE01F515-ADDRESS-INDICATOR = 'Z' OR 'C'                           
                                                                                
             IF BE01F515-MHA-TYPE-ADDR = 'H'                                    
               MOVE 'H'                           TO K830-NUM-ADDR-TYPE         
               MOVE 'BLK '                        TO K830-NUM-BLK-HDR           
             ELSE                                                               
               MOVE 'N'                           TO K830-NUM-ADDR-TYPE         
             END-IF                                                             
                                                                                
             MOVE BE01F515-MHA-BLK-HSE-NO(1:4) TO K830-NUM-MAIN-BLK(1:4)        
             MOVE BE01F515-MHA-BLK-HSE-NO(5:1) TO K830-NUM-BLK-DASH(1:1)        
             MOVE BE01F515-MHA-BLK-HSE-NO(6:1) TO K830-NUM-SUB-BLK(1:1)         
                                                                                
             IF BE01F515-MHA-FLR-NO > SPACES                                    
                STRING '#'              DELIMITED BY SIZE                       
                   BE01F515-MHA-FLR-NO  DELIMITED BY SIZE                       
                   '-'                  DELIMITED BY SIZE                       
                   BE01F515-MHA-UNIT-NO DELIMITED BY SIZE                       
                   INTO  K830-NUM-FLAT                                          
                END-STRING                                                      
             END-IF                                                             
                                                                                
             MOVE  BE01F515-MHA-BLDG-NAME      TO K830-NME-BLDG                 
             MOVE  BE01F515-MHA-POSTAL-CODE    TO K830-NUM-POSTAL               
             MOVE  BE01F515-MHA-STREET-NAME    TO K830-NME-STREET               
             PERFORM 8510-WRITE-F725-MHA       THRU 8510-EXIT                   
           ELSE                                                                 
            IF BE01F515-ADDRESS-INDICATOR = ' '                                 
               IF BE01F515-SRC-TAG = 'I'                                        
                 PERFORM 8620-DIRECT-NCA-TO-HDB        THRU 8620-EXIT           
                 PERFORM 8650-CONVERT-NCA-TO-HDB-F725  THRU 8650-EXIT           
               ELSE                                                             
                 PERFORM 8600-CONVERT-NCA-TO-HDB       THRU 8600-EXIT           
               END-IF                                                           
               PERFORM 8520-WRITE-F725-NCA      THRU 8520-EXIT                  
            END-IF                                                              
           END-IF.                                                              
                                                                                
           MOVE   WS-CURR-DATE              TO K830-DTE-UPDATE.                 
            MOVE  'P13C506'                  TO K830-NUM-USERID.                
                                                                                
            IF (K830-NUM-MAIN-BLK = K830-NUM-MAIL-MAIN-BLK) AND                 
               (K830-NUM-LVL-NUM = K830-NUM-MAIL-LVL-NUM) AND                   
               (K830-NUM-HSEMAIN = K830-NUM-MAIL-HSEMAIN) AND                   
               (K830-NUM-POSTAL = K830-NUM-MAIL-POSTAL)                         
               MOVE SPACES TO K830-NUM-MAIL-ADDR                                
               ADD 1 TO WS-SPACES                                               
            END-IF.                                                             
                                                                                
       8500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8510-WRITE-F725-MHA.                                                     
      *-------------------------------------------------------------            
            MOVE SPACES               TO  BP13F725-REC.                         
            MOVE BE01F515-REF-NO(1:8) TO  F725-NUM-REGN.                        
            MOVE BE01F515-IDNO        TO  F725-NUM-NRIC.                        
                                                                                
            STRING BE01F515-DATE-BIRTH(1:4) BE01F515-DATE-BIRTH(6:2)            
                   BE01F515-DATE-BIRTH(9:2) DELIMITED BY SIZE INTO              
                   F725-DTE-OF-BIRTH                                            
            END-STRING.                                                         
                                                                                
            MOVE BE01F515-NATNLTY             TO  F725-NUM-NATIONALITY.         
            MOVE BE01F515-SEX                 TO  F725-NUM-SEX.                 
            MOVE BE01F515-RACE                TO  F725-NUM-RACE.                
            MOVE BE01F515-MHA-TYPE-ADDR       TO  F725-NUM-ADDR-TYPE.           
            MOVE BE01F515-MHA-BLK-HSE-NO(1:5) TO  F725-NUM-BLK-HSE.             
            MOVE BE01F515-MHA-STREET-NAME     TO  F725-NME-STREET.              
            MOVE BE01F515-MHA-FLR-NO          TO  F725-NUM-STOREY.              
            MOVE BE01F515-MHA-UNIT-NO         TO  F725-NUM-UNIT.                
            MOVE BE01F515-MHA-BLDG-NAME       TO  F725-NME-BLDG.                
            STRING BE01F515-DTE-PARTR-CHG(1:4)                                  
                   BE01F515-DTE-PARTR-CHG(6:2)                                  
                   BE01F515-DTE-PARTR-CHG(9:2)                                  
                   DELIMITED BY SIZE INTO F725-DTE-1ST-REG                      
            END-STRING.                                                         
            MOVE BE01F515-NAME                TO  F725-NME-PRINCIPAL.           
            MOVE BE01F515-MHA-POSTAL-CODE     TO  F725-CDE-POSTAL.              
            WRITE BP13F725-REC.                                                 
                                                                                
       8510-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8520-WRITE-F725-NCA.                                                     
      *-------------------------------------------------------------            
            MOVE BE01F515-REF-NO(1:8) TO  F725-NUM-REGN.                        
            MOVE BE01F515-IDNO        TO  F725-NUM-NRIC.                        
                                                                                
            STRING BE01F515-DATE-BIRTH(1:4) BE01F515-DATE-BIRTH(6:2)            
                   BE01F515-DATE-BIRTH(9:2) DELIMITED BY SIZE INTO              
                   F725-DTE-OF-BIRTH                                            
            END-STRING.                                                         
                                                                                
            MOVE BE01F515-NATNLTY             TO  F725-NUM-NATIONALITY.         
            MOVE BE01F515-SEX                 TO  F725-NUM-SEX.                 
            MOVE BE01F515-RACE                TO  F725-NUM-RACE.                
            IF F725-NUM-ADDR-TYPE =  SPACES                                     
              MOVE BE01F515-NCA-TYPE-ADDR       TO  F725-NUM-ADDR-TYPE          
            END-IF.                                                             
            MOVE BE01F515-NCA-BLK-HSE-NO(1:5) TO  F725-NUM-BLK-HSE.             
            MOVE NME-STREET OF DCLSTREET      TO  F725-NME-STREET.              
            MOVE BE01F515-NCA-LEVEL-NO(1:2)   TO  F725-NUM-STOREY.              
            MOVE BE01F515-NCA-UNIT-NO         TO  F725-NUM-UNIT.                
            MOVE SPACES                       TO  F725-NME-BLDG.                
            STRING BE01F515-DTE-PARTR-CHG(1:4)                                  
                   BE01F515-DTE-PARTR-CHG(6:2)                                  
                   BE01F515-DTE-PARTR-CHG(9:2)                                  
                   DELIMITED BY SIZE INTO F725-DTE-1ST-REG                      
            END-STRING.                                                         
            MOVE BE01F515-NAME                TO  F725-NME-PRINCIPAL.           
            MOVE BE01F515-NCA-POSTAL-CODE     TO  F725-CDE-POSTAL.              
            WRITE BP13F725-REC.                                                 
                                                                                
            MOVE 'Y' TO F725-WRT.                                               
                                                                                
       8520-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8530-WRITE-TO-F725.                                                      
      *-------------------------------------------------------------            
                                                                                
           IF F725-WRT NOT  = 'Y'                                               
             IF BE01F515-ADDRESS-INDICATOR = 'Z' OR 'C'                         
                PERFORM 8510-WRITE-F725-MHA       THRU 8510-EXIT                
             ELSE                                                               
                IF BE01F515-ADDRESS-INDICATOR = ' '                             
                   PERFORM 8650-CONVERT-NCA-TO-HDB-F725 THRU 8650-EXIT          
                   PERFORM 8520-WRITE-F725-NCA    THRU 8520-EXIT                
                END-IF                                                          
             END-IF                                                             
             MOVE 'Y'                             TO   F725-WRT                 
           END-IF.                                                              
                                                                                
       8530-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8600-CONVERT-NCA-TO-HDB.                                                 
      *-------------------------------------------------------------            
                                                                                
           MOVE 'NAT-HDB'                TO AV02K012-IN-FUNCTION.               
           MOVE BE01F515-NCA-TYPE-ADDR   TO AV02K012-CONV2-IN-ADDR-TYP.         
           MOVE BE01F515-NCA-BLK-HSE-NO  TO                                     
                                         AV02K012-CONV2-IN-BLK-HSE-NO.          
                                                                                
           MOVE BE01F515-NCA-UNIT-NO     TO AV02K012-CONV2-IN-UNIT-NO.          
           MOVE BE01F515-NCA-LEVEL-NO    TO AV02K012-CONV2-IN-UNIT-LVL.         
           MOVE BE01F515-NCA-STREET-CODE TO AV02K012-CONV2-IN-CDE-ST.           
           MOVE BE01F515-NCA-POSTAL-CODE TO AV02K012-CONV2-IN-PSTCDE.           
                                                                                
           CALL 'AV02C012' USING AV02K012-IN-FUNCTION                           
                                 AV02K012-IN-PARM.                              
           MOVE AV02K012-CONV2-OUT-BLK-HSE-NO(1:4)  TO                          
                                             K830-NUM-MAIN-BLK.                 
                                                                                
           IF  AV02K012-CONV2-OUT-BLK-HSE-NO(5:1) > SPACES                      
                  MOVE '-'                         TO K830-NUM-BLK-DASH         
                  MOVE AV02K012-CONV2-OUT-BLK-HSE-NO(5:1)  TO                   
                                                    K830-NUM-SUB-BLK            
           ELSE                                                                 
                  MOVE SPACES                    TO K830-NUM-BLK-DASH           
                  MOVE SPACES                    TO K830-NUM-SUB-BLK            
           END-IF.                                                              
                                                                                
           IF AV02K012-CONV2-OUT-HSELVL > SPACES                                
            MOVE '#'                           TO K830-NUM-LVL-CHAR             
            MOVE AV02K012-CONV2-OUT-HSELVL     TO K830-NUM-LVL-NUM              
           ELSE                                                                 
            MOVE SPACES                        TO K830-NUM-LVL-CHAR             
                                                  K830-NUM-LVL-NUM              
           END-IF.                                                              
                                                                                
           IF AV02K012-CONV2-OUT-HSEMAIN > SPACES                               
            MOVE '-'                           TO K830-NUM-LVL-DASH             
            MOVE SPACES                        TO WS-HSE-MAIN                   
            MOVE AV02K012-CONV2-OUT-HSEMAIN    TO WS-HSE-MAIN                   
            MOVE ZEROES TO WS-W-CTR                                             
            PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 4                 
             IF WS-HSE-MAIN(WS-CTR:1) IS NUMERIC                                
              ADD  1 TO WS-W-CTR                                                
              MOVE WS-HSE-MAIN(WS-CTR:1) TO K830-NUM-HSEMAIN(WS-W-CTR:1)        
             END-IF                                                             
            END-PERFORM                                                         
           ELSE                                                                 
            MOVE SPACES  TO        K830-NUM-LVL-DASH K830-NUM-HSEMAIN           
           END-IF.                                                              
                                                                                
           MOVE AV02K012-CONV2-OUT-HSESUB     TO K830-NUM-HSESUB.               
           MOVE AV02K012-CONV2-OUT-PSTCDE     TO K830-NUM-POSTAL.               
                                                                                
      *-----------------------------------------------------------*             
      *  EXTRACT THE STREET NAME FROM STREET TABLE                              
      *-----------------------------------------------------------*             
           MOVE SPACES      TO NME-STREET OF DCLSTREET.                         
           MOVE SPACES      TO BP13F725-REC.                                    
                                                                                
           EXEC SQL SELECT NME_STREET                                           
                      INTO :DCLSTREET.NME-STREET                                
                      FROM STREET                                               
                     WHERE CDE_ST = :AV02K012-CONV2-OUT-CDE-ST                  
           END-EXEC.                                                            
                                                                                
           MOVE NME-STREET OF DCLSTREET   TO K830-NME-STREET.                   
                                                                                
      *---------------------------------------------------*                     
      *   CHECK FOR MATCHING REC IN PIDB. IF FOUND        *                     
      *   GET STREET NAME FROM TABLE USING STREET CODE    *                     
      *   FOR NEW NCA ADDRESS                             *                     
      *---------------------------------------------------*                     
                                                                                
           EXEC SQL                                                             
              SELECT NME_STREET                                                 
              INTO   :DCLPIDB-INTERFACE.NME-STREET                              
              FROM   PIDB_INTERFACE                                             
              WHERE NUM_BLK       = :AV02K012-CONV2-OUT-BLK-HSE-NO              
                AND CDE_ST        = :AV02K012-CONV2-OUT-CDE-ST                  
                AND NUM_LEVEL     = :AV02K012-CONV2-OUT-HSELVL                  
                AND NUM_UNIT      = :AV02K012-CONV2-OUT-HSEMAIN                 
                AND BLDG_CDE_STAT = 'A'                                         
                AND ACNT_CDE_STAT = 'A'                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
              WHEN 00                                                           
                MOVE 'H'                       TO K830-NUM-ADDR-TYPE            
                MOVE 'BLK '                    TO K830-NUM-BLK-HDR              
              WHEN 100                                                          
                MOVE 'N'                       TO K830-NUM-ADDR-TYPE            
                MOVE SPACES                    TO K830-NUM-BLK-HDR              
              WHEN OTHER                                                        
                DISPLAY 'SQL ERROR IN PIDB TABLE'                               
                DISPLAY 'SQL ERROR CODE  :  '  SQLCODE                          
                DISPLAY SPACES                                                  
                PERFORM 9999-SQL-ERROR  THRU 9999-EXIT                          
           END-EVALUATE.                                                        
                                                                                
       8600-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8620-DIRECT-NCA-TO-HDB.                                                  
      *-------------------------------------------------------------            
                                                                                
           IF BE01F515-NCA-TYPE-ADDR = 'H'                                      
              MOVE 'H'                        TO K830-NUM-ADDR-TYPE             
              MOVE 'BLK '                     TO K830-NUM-BLK-HDR               
           ELSE                                                                 
              MOVE 'N'                        TO K830-NUM-ADDR-TYPE             
           END-IF.                                                              
                                                                                
           MOVE BE01F515-NCA-BLK-HSE-NO(1:4) TO K830-NUM-MAIN-BLK(1:4).         
           MOVE BE01F515-NCA-BLK-HSE-NO(5:1) TO K830-NUM-BLK-DASH(1:1).         
           MOVE BE01F515-NCA-BLK-HSE-NO(6:1) TO K830-NUM-SUB-BLK(1:1).          
                                                                                
           IF BE01F515-NCA-LEVEL-NO > SPACES                                    
              MOVE BE01F515-NCA-LEVEL-NO(1:2) TO                                
                                                WS-BE01F515-NCA-LEVEL-NO        
              STRING '#'                  DELIMITED BY SIZE                     
                 WS-BE01F515-NCA-LEVEL-NO DELIMITED BY SIZE                     
                 '-'                      DELIMITED BY SIZE                     
                 BE01F515-NCA-UNIT-NO     DELIMITED BY SIZE                     
                 INTO  K830-NUM-FLAT                                            
              END-STRING                                                        
           END-IF.                                                              
                                                                                
           MOVE BE01F515-NCA-POSTAL-CODE TO K830-NUM-POSTAL.                    
                                                                                
      *-----------------------------------------------------------*             
      *  EXTRACT THE STREET NAME FROM STREET TABLE                              
      *-----------------------------------------------------------*             
           MOVE SPACES      TO NME-STREET OF DCLSTREET.                         
           MOVE BE01F515-NCA-STREET-CODE TO WS-STREET-CDE.                      
           MOVE SPACES      TO BP13F725-REC.                                    
                                                                                
           EXEC SQL SELECT NME_STREET                                           
                      INTO :DCLSTREET.NME-STREET                                
                      FROM STREET                                               
                      WHERE CDE_ST = :WS-STREET-CDE                             
           END-EXEC                                                             
                                                                                
           EVALUATE SQLCODE                                                     
              WHEN 00                                                           
                MOVE NME-STREET OF DCLSTREET   TO K830-NME-STREET               
              WHEN 100                                                          
                DISPLAY 'STREET CODE NOT FOUND IN STREET TABLE - '              
                                               BE01F515-NCA-STREET-CODE         
              WHEN OTHER                                                        
                DISPLAY 'SQL ERROR IN PIDB TABLE'                               
                DISPLAY 'SQL ERROR CODE  :  '  SQLCODE                          
                DISPLAY SPACES                                                  
                PERFORM 9999-SQL-ERROR  THRU 9999-EXIT                          
           END-EVALUATE.                                                        
                                                                                
       8620-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8650-CONVERT-NCA-TO-HDB-F725.                                            
      *-------------------------------------------------------------            
                                                                                
           MOVE 'NAT-HDB'                TO AV02K012-IN-FUNCTION.               
           IF BE01F515-NCA-TYPE-ADDR = 'H'                                      
               MOVE 'S'                  TO                                     
                                            AV02K012-CONV2-IN-ADDR-TYP          
           ELSE                                                                 
               MOVE BE01F515-NCA-TYPE-ADDR   TO                                 
                                            AV02K012-CONV2-IN-ADDR-TYP          
           END-IF.                                                              
                                                                                
           MOVE BE01F515-NCA-BLK-HSE-NO  TO                                     
                                         AV02K012-CONV2-IN-BLK-HSE-NO.          
                                                                                
           MOVE BE01F515-NCA-UNIT-NO     TO AV02K012-CONV2-IN-UNIT-NO.          
           MOVE BE01F515-NCA-LEVEL-NO    TO AV02K012-CONV2-IN-UNIT-LVL.         
           MOVE BE01F515-NCA-STREET-CODE TO AV02K012-CONV2-IN-CDE-ST.           
           MOVE BE01F515-NCA-POSTAL-CODE TO AV02K012-CONV2-IN-PSTCDE.           
                                                                                
           CALL 'AV02C012' USING AV02K012-IN-FUNCTION                           
                                 AV02K012-IN-PARM.                              
                                                                                
      *-----------------------------------------------------------*             
      *  EXTRACT THE STREET NAME FROM STREET TABLE                              
      *-----------------------------------------------------------*             
           MOVE SPACES      TO NME-STREET OF DCLSTREET.                         
           MOVE SPACES      TO BP13F725-REC.                                    
                                                                                
           EXEC SQL SELECT NME_STREET                                           
                      INTO :DCLSTREET.NME-STREET                                
                      FROM STREET                                               
                     WHERE CDE_ST = :AV02K012-CONV2-OUT-CDE-ST                  
           END-EXEC.                                                            
                                                                                
      *---------------------------------------------------*                     
      *   CHECK FOR MATCHING REC IN PIDB. IF FOUND        *                     
      *   GET STREET NAME FROM TABLE USING STREET CODE    *                     
      *   FOR NEW NCA ADDRESS                             *                     
      *---------------------------------------------------*                     
                                                                                
           EXEC SQL                                                             
              SELECT NME_STREET                                                 
              INTO   :DCLPIDB-INTERFACE.NME-STREET                              
              FROM   PIDB_INTERFACE                                             
              WHERE NUM_BLK       = :AV02K012-CONV2-OUT-BLK-HSE-NO              
                AND CDE_ST        = :AV02K012-CONV2-OUT-CDE-ST                  
                AND NUM_LEVEL     = :AV02K012-CONV2-OUT-HSELVL                  
                AND NUM_UNIT      = :AV02K012-CONV2-OUT-HSEMAIN                 
                AND BLDG_CDE_STAT = 'A'                                         
                AND ACNT_CDE_STAT = 'A'                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
              WHEN 00                                                           
                MOVE 'A'                       TO F725-NUM-ADDR-TYPE            
              WHEN 100                                                          
                MOVE 'B'                       TO F725-NUM-ADDR-TYPE            
              WHEN OTHER                                                        
                DISPLAY 'SQL ERROR IN PIDB TABLE'                               
                DISPLAY 'SQL ERROR CODE  :  '  SQLCODE                          
                DISPLAY SPACES                                                  
                PERFORM 9999-SQL-ERROR  THRU 9999-EXIT                          
           END-EVALUATE.                                                        
                                                                                
       8650-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8700-REWRITE-K500-REC.                                                   
      *-------------------------------------------------------------            
           MOVE SPACES                       TO BP13K500-REC.                   
           MOVE BE01F515-REF-NO(1:8)         TO K500-NUM-REGN.                  
           READ BP13K500.                                                       
                                                                                
           EVALUATE K500-STATUS                                                 
           WHEN 00                                                              
                MOVE  'P'                   TO K500-CDE-PRINT-STATUS            
                REWRITE BP13K500-REC                                            
                EVALUATE K500-STATUS                                            
                WHEN 00                                                         
                     WRITE BP13F500-REC     FROM BP13K500-REC                   
                     ADD   1                TO WS-K500-REWRITE                  
                                               WS-F500-WRITE                    
                WHEN OTHER                                                      
                     DISPLAY 'ERROR REWRITING  BP13K500, STATUS IS '            
                              K500-STATUS                                       
                     PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                   
                END-EVALUATE                                                    
           WHEN 23                                                              
                PERFORM 8750-REWRITE-K730      THRU 8750-EXIT                   
           WHEN OTHER                                                           
                DISPLAY 'ERROR READING BP13K500, STATUS IS '                    
                         K500-STATUS                                            
                PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       8700-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8750-REWRITE-K730.                                                       
      *-------------------------------------------------------------            
           MOVE SPACES                  TO BP13K730-REC.                        
           MOVE BE01F515-REF-NO(1:8)    TO K730-NUM-REGN.                       
           READ BP13K730.                                                       
                                                                                
           EVALUATE K730-STATUS                                                 
           WHEN 00                                                              
                MOVE  'P'                   TO K730-CDE-PRINT-STATUS            
                REWRITE BP13K730-REC                                            
                EVALUATE K730-STATUS                                            
                WHEN 00                                                         
                     WRITE BP13F500-REC     FROM BP13K730-REC                   
                     ADD   1                TO WS-K730-REWRITE                  
                                               WS-F500-WRITE                    
                WHEN OTHER                                                      
                     DISPLAY 'ERROR REWRITING  BP13K730, STATUS IS '            
                              K730-STATUS                                       
                     PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                   
                END-EVALUATE                                                    
           WHEN 23                                                              
                DISPLAY 'RECORD NOT FOUND IN K730 ' K730-NUM-REGN               
           WHEN OTHER                                                           
                DISPLAY 'ERROR READING BP13K730, STATUS IS '                    
                         K730-STATUS                                            
                PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       8750-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       9000-CLOSE-FILES.                                                        
      *-------------------------------------------------------------            
           DISPLAY '  '.                                                        
           DISPLAY 'BP13C506 CONTROL TOTALS'.                                   
           DISPLAY '--------------------------------------------'.              
           DISPLAY 'TOTAL RECORDS READ FROM BE01F515 = ' WS-F515-READ.          
           DISPLAY 'TOTAL RECORDS NOTFND IN BP13K825 = ' WS-REC-NOTFND.         
           DISPLAY 'TOTAL RECORDS NOTFND IN BP13K820 = ' WS-K820-NOTFND.        
           DISPLAY 'TOTAL RECORDS UPDATED-BP13K825   = ' WS-REC-UPDATED.        
           DISPLAY 'TOTAL RECORDS UPDATED-BP13K820   = '                        
                                                     WS-K820-UPDATED.           
           DISPLAY 'TOTAL RECORDS PRINTED            = ' WS-REC-PRINTED.        
           DISPLAY 'TOTAL ERRORS  ENCOUNTERED        = ' WS-ERR-CTR.            
           DISPLAY 'TOTAL K830 RECORDS WRITTEN       = ' WS-K830-WRITE.         
           DISPLAY 'TOTAL K830 RECORDS RE-WRITTEN    = '                        
                    WS-K830-REWRITE.                                            
           DISPLAY 'TOTAL K500 RECORDS RE-WRITTEN    = '                        
                    WS-K500-REWRITE.                                            
           DISPLAY 'TOTAL K730 RECORDS RE-WRITTEN    = '                        
                    WS-K730-REWRITE.                                            
           DISPLAY 'TOTAL RECS WITH MAIL-ADDR BLANK  = '                        
                    WS-SPACES.                                                  
           DISPLAY 'TOTAL F500 RECORDS WRITTEN       = ' WS-F500-WRITE.         
           DISPLAY 'TOTAL L506 RECORDS WRITTEN       = ' WS-L506-WRITE.         
           DISPLAY 'TOTAL L506G RECORDS WRITTEN      = ' WS-L506G-WRITE.        
                                                                                
           CLOSE BE01F515                                                       
                 BP13K825                                                       
                 BP13K060                                                       
                 BP13K830                                                       
                 BP13K500                                                       
                 BP13K730                                                       
                 BP13K820                                                       
                 BP13F500                                                       
                 P13L506A                                                       
                 P13L506B                                                       
                 P13L506C                                                       
                 P13L506D                                                       
                 P13L506E                                                       
                 P13L506F                                                       
                 P13L506G                                                       
                 BP13L506                                                       
                 BP13F725.                                                      
                                                                                
           IF K825-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN CLOSING BP13K825 FILE, STATUS IS '            
                       K825-STATUS                                              
              MOVE K825-STATUS   TO  RETURN-CODE                                
           END-IF                                                               
           IF K060-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN CLOSING BP13K060 FILE, STATUS IS '            
                       K060-STATUS                                              
              MOVE K060-STATUS   TO  RETURN-CODE                                
           END-IF                                                               
           IF K830-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN CLOSING BP13K830 FILE, STATUS IS '            
                       K830-STATUS                                              
              MOVE K830-STATUS   TO  RETURN-CODE                                
           END-IF                                                               
           IF K730-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN CLOSING BP13K730 FILE, STATUS IS '            
                       K730-STATUS                                              
              MOVE K730-STATUS   TO  RETURN-CODE                                
           END-IF                                                               
           IF K500-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN CLOSING BP13K500 FILE, STATUS IS '            
                       K500-STATUS                                              
              MOVE K500-STATUS   TO  RETURN-CODE                                
           END-IF                                                               
                                                                                
           IF K820-STATUS NOT = 0 AND 97                                        
              DISPLAY '* ERROR IN CLOSING BP13K820 FILE, STATUS IS '            
                       K820-STATUS                                              
              MOVE K820-STATUS   TO  RETURN-CODE                                
           END-IF                                                               
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       9999-SQL-ERROR.                                                          
      *****************************************************************         
                                                                                
           DISPLAY ' *****   BP13C506 ABEND   *****'.                           
                                                                                
           CALL 'DBATIAR'  USING SQLCA.                                         
           EXEC SQL   ROLLBACK   END-EXEC.                                      
           PERFORM SQL-INITIAL UNTIL SQL-INIT-DONE                              
           EVALUATE SQLCODE                                                     
               WHEN 0                                                           
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ROLLBACK FAILED, SQLCODE IS : ' SQLCODE            
           END-EVALUATE.                                                        
                                                                                
           MOVE 12                        TO   RETURN-CODE.                     
           PERFORM 9000-CLOSE-FILES       THRU 9000-EXIT.                       
                                                                                
       9999-EXIT.                                                               
            EXIT.                                                               
