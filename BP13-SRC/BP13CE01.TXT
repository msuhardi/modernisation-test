       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CE01.                                                 
      *AUTHOR.        YCH.                                                      
      *DATE-WRITTEN.  05/11/2008.                                               
      *========================================================*                
      * SYSTEM OF COMMITMENT (BP13)                            *                
      *========================================================*                
      *    OBJECTIVE :                                         *                
      *      1.  USE NRIC IN REQUEST FILE                      *                
      *          MATCH WITH PPOS, SMS AND RESALE               *                
      *                                                        *                
      *--------------------------------------------------------*                
      * CHG-NO    BY  DATE    DESCRIPTION                      *                
      * -------  ---  ------  -----------                      *                
      * BP134285 YCH2 061108  PRINT EXCEPTIONAL REPORT BEFORE  *                
      *                       BALLOT COMMENCE                  *                
      *                       UPDATE LOAN-TAG                  *                
      * BP135904 ZDD1 210815  CHANGE 8000 TO 10000             *                
      * BP135904 ZDD1 250815  CHANGE 10000 TO 12000            *                
      * BP138047 KAC1 251119  RECOMPILE FOR BP27 COPYBOOK UPDATE                
      * BP139605 KAC1 090523  RECOMPILE TO CATER FOR BP27K820 UPDTE             
      *                       TO CATER FOR POLICY CHANGES WITH *                
      *                       IMPLEMENTATION OF HFE.           *                
      *========================================================*                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F800 ASSIGN TO BP13F800.                                  
                                                                                
           SELECT BP13K730 ASSIGN TO BP13K730                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K730-NUM-REGN                              
                  FILE STATUS     IS WS-BP13K730-STATUS.                        
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K800-NUM-REGN                              
                  FILE STATUS     IS WS-BP13K800-STATUS.                        
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD OF                            
                                     BP13K820-REC                               
                  FILE STATUS     IS WS-BP13K820-STATUS.                        
                                                                                
           SELECT BP13KB20 ASSIGN TO BP13KB20                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS KB20-KEY-FLD                               
                  FILE STATUS     IS WS-BP13KB20-STATUS.                        
                                                                                
           SELECT BP13K060 ASSIGN TO BP13K060                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K060-KEY-FLD                               
                  FILE STATUS     IS WS-BP13K060-STATUS.                        
                                                                                
           SELECT P04K010  ASSIGN TO P04K010                                    
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K010-PRIME-KEY                             
                  FILE STATUS     IS WS-P04K010-STATUS.                         
                                                                                
           SELECT BR10K010 ASSIGN TO BR10K010                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K010-KEY-FLD                               
                  FILE STATUS     IS WS-BR10K010-STATUS.                        
                                                                                
           SELECT BR10K080 ASSIGN TO BR10K080                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K080-KEY-FLD                               
                  FILE STATUS     IS WS-BR10K080-STATUS.                        
                                                                                
           SELECT BP27K800 ASSIGN TO BP27K800                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K800-NUM-HLA OF                            
                                     BP27K800-MASTER                            
                  FILE STATUS     IS WS-BP27K800-STATUS.                        
                                                                                
           SELECT BP27K870 ASSIGN TO BP27K870                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K870-KEY-FLD                               
                  FILE STATUS     IS WS-BP27K870-STATUS.                        
                                                                                
           SELECT BP27K820 ASSIGN TO BP27K820                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD OF                            
                                     BP27K820-REC                               
                  ALTERNATE KEY   IS K820-NUM-NRIC OF                           
                                     BP27K820-REC                               
                                     WITH DUPLICATES                            
                  FILE STATUS     IS WS-BP27K820-STATUS.                        
                                                                                
           SELECT P13LE01A ASSIGN TO P13LE01A.                                  
           SELECT P13LE01B ASSIGN TO P13LE01B.                                  
           SELECT P13LE01C ASSIGN TO P13LE01C.                                  
           SELECT P13LE01D ASSIGN TO P13LE01D.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F800                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            BLOCK  CONTAINS 0   RECORDS                                         
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       COPY BP13F800.                                                           
                                                                                
       FD   BP13K730                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K730.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13KB20                                                            
            RECORD CONTAINS 3300 CHARACTERS.                                    
       COPY BP13KB20.                                                           
                                                                                
       FD   BP13K060                                                            
            RECORD CONTAINS 25  CHARACTERS.                                     
       COPY BP13K060.                                                           
                                                                                
       FD   P04K010                                                             
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY P04K010.                                                            
                                                                                
       FD   BR10K010                                                            
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY BR10K010.                                                           
                                                                                
       FD   BR10K080                                                            
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY BR10K080.                                                           
                                                                                
       FD   BP27K800                                                            
            RECORD CONTAINS 1200 CHARACTERS.                                    
       COPY BP27K800.                                                           
                                                                                
       FD   BP27K870                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP27K870.                                                           
                                                                                
       FD   BP27K820                                                            
            RECORD VARYING IN SIZE FROM 1 TO 1200.                              
       COPY BP27K820.                                                           
                                                                                
       FD   P13LE01A                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       01   P13LE01A-REC            PIC X(132).                                 
                                                                                
       FD   P13LE01B                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       01   P13LE01B-REC            PIC X(132).                                 
                                                                                
       FD   P13LE01C                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       01   P13LE01C-REC            PIC X(132).                                 
                                                                                
       FD   P13LE01D                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       01   P13LE01D-REC            PIC X(132).                                 
                                                                                
       WORKING-STORAGE SECTION.                                                 
       01  WS-FILE-STATUS.                                                      
           05  WS-BR10K010-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BR10K080-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP13K730-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP13K800-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP13K820-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP13KB20-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP13K060-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-P04K010-STATUS    PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP27K800-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP27K870-STATUS   PIC 9(2)    VALUE ZEROES.                   
           05  WS-BP27K820-STATUS   PIC 9(2)    VALUE ZEROES.                   
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-F800-READ          PIC 9(6)    VALUE ZEROES.                   
           05 WS-K800-UPD           PIC 9(6)    VALUE ZEROES.                   
           05 WS-KB20-UPD           PIC 9(6)    VALUE ZEROES.                   
           05 WS-RECS-65YR          PIC 9(6)    VALUE ZEROES.                   
           05 WS-RECS-EC            PIC 9(6)    VALUE ZEROES.                   
           05 WS-RECS-PPO           PIC 9(6)    VALUE ZEROES.                   
           05 WS-RECS-PPOS          PIC 9(6)    VALUE ZEROES.                   
           05 WS-WRT-LE01A          PIC 9(6)    VALUE ZEROES.                   
           05 WS-WRT-LE01B          PIC 9(6)    VALUE ZEROES.                   
           05 WS-WRT-LE01C          PIC 9(6)    VALUE ZEROES.                   
           05 WS-WRT-LE01D          PIC 9(6)    VALUE ZEROES.                   
           05 WS-TOT-A              PIC 9(6)    VALUE ZEROES.                   
           05 WS-TOT-B              PIC 9(6)    VALUE ZEROES.                   
           05 WS-TOT-C              PIC 9(6)    VALUE ZEROES.                   
           05 WS-TOT-D              PIC 9(6)    VALUE ZEROES.                   
           05 WS-BYPASS             PIC 9(6)    VALUE ZEROES.                   
           05 WS-OTHER-LOAN-TAG     PIC 9(6)    VALUE ZEROES.                   
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-DEB-FND           PIC X(1)     VALUE SPACES.                  
           05  WS-PPO-FND           PIC X(1)     VALUE SPACES.                  
           05  WS-PPOS-FND          PIC X(1)     VALUE SPACES.                  
           05  WS-PPOH-FND          PIC X(1)     VALUE SPACES.                  
           05  WS-AGE-FND           PIC X(1)     VALUE SPACES.                  
           05  WS-LEAS-FND          PIC X(1)     VALUE SPACES.                  
           05  WS-EC-FND            PIC X(1)     VALUE SPACES.                  
           05  WS-8K-INC            PIC X(1)     VALUE SPACES.                  
                                                                                
       01  WS-WORKING-FIELDS.                                                   
           05  WS-NUM-REGN          PIC X(8)     VALUE SPACES.                  
           05  WS-NUM-NRIC          PIC X(9)     VALUE SPACES.                  
           05  WS-SMS-HDBREF        PIC X(11)    VALUE SPACES.                  
           05  WS-DATE              PIC X(8)     VALUE SPACES.                  
           05  WS-PREV-REGN         PIC X(8)     VALUE SPACES.                  
           05  WS-HH-INC            PIC 9(6)     VALUE ZEROES.                  
           05  WS-SNO-A             PIC 9(5)     VALUE ZEROES.                  
           05  WS-PAGE-A            PIC 9(5)     VALUE ZEROES.                  
           05  WS-LINE-A            PIC 9(2)     VALUE 66.                      
           05  WS-SNO-B             PIC 9(5)     VALUE ZEROES.                  
           05  WS-PAGE-B            PIC 9(5)     VALUE ZEROES.                  
           05  WS-LINE-B            PIC 9(2)     VALUE 66.                      
           05  WS-SNO-C             PIC 9(5)     VALUE ZEROES.                  
           05  WS-PAGE-C            PIC 9(5)     VALUE ZEROES.                  
           05  WS-LINE-C            PIC 9(2)     VALUE 66.                      
           05  WS-SNO-D             PIC 9(5)     VALUE ZEROES.                  
           05  WS-PAGE-D            PIC 9(5)     VALUE ZEROES.                  
           05  WS-LINE-D            PIC 9(2)     VALUE 66.                      
           05  WS-SNO-1             PIC X(5)     VALUE SPACES.                  
           05  WS-RELATION          PIC X(10)    VALUE SPACES.                  
           05  WS-BP27-REASON       PIC X(04)    VALUE SPACES.                  
           05  WS-BEF-TAG           PIC X(01)    VALUE SPACES.                  
           05  WS-AFT-TAG           PIC X(01)    VALUE SPACES.                  
           05  WS-FOUND-K800        PIC X(01)    VALUE SPACES.                  
           05  WS-VALID-REWRITE     PIC X(01)    VALUE SPACES.                  
           05  WS-HLA               PIC X(09)    VALUE SPACES.                  
           05  WS-STATUS            PIC X(09)    VALUE SPACES.                  
                                                                                
       01  WS-DTE-REQUEST.                                                      
           05  WS-REQUEST-CYM       PIC 9(6)  VALUE ZEROES.                     
           05  WS-REQUEST-DD        PIC 9(2)  VALUE ZEROES.                     
       01  WS-DTE-BIRTH.                                                        
           05  WS-BIRTH-CYM         PIC 9(6)  VALUE ZEROES.                     
           05  WS-BIRTH-DD          PIC 9(2)  VALUE ZEROES.                     
       01  WS-AGE                   PIC 9(6)  VALUE ZEROES.                     
       01  WS-NUM-AGE REDEFINES WS-AGE.                                         
           05 WS-APPLN-AGE          PIC 9(4).                                   
           05 WS-NUM-REMNG          PIC 9(2).                                   
                                                                                
                                                                                
       01  WS-EOF-SWITCHES.                                                     
           05  EOF-BP13F800         PIC X        VALUE 'N'.                     
           05  EOF-P04K010          PIC X        VALUE 'N'.                     
           05  EOF-BR10K010         PIC X        VALUE 'N'.                     
           05  EOF-BR10K080         PIC X        VALUE 'N'.                     
           05  EOF-BP27K820         PIC X        VALUE 'N'.                     
           05  EOF-BP27K870         PIC X        VALUE 'N'.                     
           05  EOF-BP13K820         PIC X        VALUE 'N'.                     
                                                                                
       01  WS-K010-REASON           PIC X(2)    VALUE SPACES.                   
      * EC REASON                                                               
           88 VALID-REASON          VALUE 'CG' 'EC' 'EG' 'EG'                   
                                          'EJ' 'EM' 'EO' 'EQ'                   
                                          'ES' 'EU' 'GR'                        
      * RL REASON                                                               
                                          'RL'.                                 
                                                                                
      *============================================================*            
      *         BP13LE01 -   R E P O R T    L A Y O U T            *            
      *============================================================*            
                                                                                
       01  LE01-HDG1.                                                           
           05  FILLER              PIC X(08)     VALUE 'BP13LE01'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  LE01-RUN-DATE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LE01-PAGE-NO        PIC ZZZZ9 .                                  
                                                                                
       01  LE01-HDG2.                                                           
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(46)     VALUE                          
           '      D B S S    A P P L I C A T I O N     '.                       
           05  LE01-ALLO-CAT       PIC X(3)      VALUE SPACES.                  
                                                                                
       01  LE01-HDG3.                                                           
           05  FILLER              PIC X(80)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'AGE'.                   
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'DECL'.                  
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE 'LEAS-'.                 
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(17)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'LOAN TAG'.              
                                                                                
       01  LE01-HDG3A.                                                          
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE ' S/N '.                 
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'REGN'.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(15)     VALUE 'NAME'.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE 'NRIC'.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'RELATION  '.            
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'HH INC'.                
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'APPT DTE  '.            
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'B-DTE   '.              
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE '>65'.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'PPOS'.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'PPO '.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'EC'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'RL'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'REASON'.                
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE 'HLA      '.             
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE 'ST '.                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'RQ'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'OG'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'BF'.                    
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE 'AF'.                    
                                                                                
       01  LE01-HDG4.                                                           
           05  FILLER              PIC X(132)    VALUE ALL '-'.                 
                                                                                
       01  LE01-DETAIL.                                                         
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-SNO            PIC ZZZZ9.                                   
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-REGN           PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-NAME           PIC X(15)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-NRIC           PIC X(09)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-REL            PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-HH-INC         PIC ZZZZZ9.                                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-APPT-DTE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-BDATE          PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-AGE            PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-PPOS           PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-PPOS-DECL      PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-EC             PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-RL             PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-LEAS           PIC X(01)     VALUE SPACES.                  
           05  LE01-DASH           PIC X(01)     VALUE SPACES.                  
           05  LE01-REASON         PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-HLA            PIC X(09)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-STAT           PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-LOAN-RQ        PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-LOAN-OG        PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-BEF-TAG        PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  LE01-AFT-TAG        PIC X(02)     VALUE SPACES.                  
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *------------------------------------------------------------             
       0000-MAIN.                                                               
      *------------------------------------------------------------             
                                                                                
           OPEN INPUT  BP13F800                                                 
                       BR10K010                                                 
                       BR10K080                                                 
                       P04K010                                                  
                       BP13K730                                                 
                       BP13K820                                                 
                       BP13K060                                                 
                       BP27K800                                                 
                       BP27K870                                                 
                       BP27K820                                                 
                I-O    BP13K800                                                 
                       BP13KB20                                                 
                OUTPUT P13LE01A                                                 
                       P13LE01B                                                 
                       P13LE01C                                                 
                       P13LE01D.                                                
                                                                                
           IF WS-BP13K730-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP13K730 OPEN ERROR'  WS-BP13K730-STATUS            
              MOVE WS-BP13K730-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BP13K820-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP13K820 OPEN ERROR'  WS-BP13K820-STATUS            
              MOVE WS-BP13K820-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BP13KB20-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP13KB20 OPEN ERROR'  WS-BP13KB20-STATUS            
              MOVE WS-BP13KB20-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BP13K060-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP13K060 OPEN ERROR'  WS-BP13K060-STATUS            
              MOVE WS-BP13K060-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BR10K010-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BR10K010 OPEN ERROR'  WS-BR10K010-STATUS            
              MOVE WS-BR10K010-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BR10K080-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BR10K080 OPEN ERROR'  WS-BR10K080-STATUS            
              MOVE WS-BR10K080-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-P04K010-STATUS NOT = ZEROS AND 97                              
              DISPLAY 'FILE P04K010  OPEN ERROR' WS-P04K010-STATUS              
              MOVE WS-P04K010-STATUS TO RETURN-CODE                             
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BP27K800-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP27K800 OPEN ERROR'  WS-BP27K800-STATUS            
              MOVE WS-BP27K800-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BP27K870-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP27K870 OPEN ERROR'  WS-BP27K870-STATUS            
              MOVE WS-BP27K870-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BP27K820-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP27K820 OPEN ERROR'  WS-BP27K820-STATUS            
              MOVE WS-BP27K820-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-BP13K800-STATUS NOT = 0 AND 97                                 
              DISPLAY 'FILE BP13K800 OPEN ERROR'  WS-BP13K800-STATUS            
              MOVE WS-BP13K800-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO WS-DATE.                         
                                                                                
           STRING WS-DATE(7:2) '/'                                              
                  WS-DATE(5:2) '/'                                              
                  WS-DATE(1:4)                                                  
                  DELIMITED BY SIZE                                             
             INTO LE01-RUN-DATE                                                 
                                                                                
           PERFORM 1000-READ-F800-REC THRU 1000-EXIT.                           
           PERFORM 2000-PROCESS-REC   THRU 2000-EXIT                            
                   UNTIL EOF-BP13F800 = 'Y'.                                    
           PERFORM 9000-CLOSE-ROUTINE.                                          
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       1000-READ-F800-REC.                                                      
      *------------------------------------------------------------             
                                                                                
           READ BP13F800 AT END MOVE 'Y' TO EOF-BP13F800                        
                GO TO 1000-EXIT.                                                
                                                                                
           ADD 1 TO WS-F800-READ.                                               
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2000-PROCESS-REC.                                                        
      *------------------------------------------------------------             
           MOVE SPACES        TO WS-DEB-FND                                     
                                 WS-PPO-FND                                     
                                 WS-PPOS-FND                                    
                                 WS-PPOH-FND                                    
                                 WS-AGE-FND                                     
                                 WS-EC-FND                                      
                                 WS-LEAS-FND                                    
                                 WS-RELATION                                    
                                 WS-BEF-TAG                                     
                                 WS-AFT-TAG                                     
                                 WS-VALID-REWRITE                               
                                 WS-8K-INC.                                     
                                                                                
           MOVE F800-NUM-REGN TO WS-NUM-REGN.                                   
           MOVE SPACES        TO WS-PREV-REGN                                   
                                                                                
           PERFORM 2400-READ-BP13K800  THRU 2400-EXIT.                          
                                                                                
           PERFORM 2200-READ-BP13K730  THRU 2200-EXIT.                          
                                                                                
           PERFORM 8500-CHECK-AGE-HA   THRU 8500-EXIT                           
                                                                                
           PERFORM 2300-READ-BP13K820  THRU 2300-EXIT.                          
                                                                                
           IF WS-VALID-REWRITE = 'Y'                                            
              IF WS-BEF-TAG  = 'B' OR 'N'                                       
                   CONTINUE                                                     
              ELSE                                                              
                 IF F800-AMT-HSE-INCOME = ZEROES OR SPACES OR                   
                                          LOW-VALUES                            
                    MOVE 'B' TO K800-NUM-LOAN-TAG OF BP13K800-MASTER            
                 ELSE                                                           
                    MOVE 'B' TO K800-NUM-LOAN-TAG OF BP13K800-MASTER            
                           K800-NUM-ORIG-LOAN-TAG OF BP13K800-MASTER            
                 END-IF                                                         
                 PERFORM 2450-UPDATE-BP13K800  THRU 2450-EXIT                   
                 PERFORM 2460-READ-BP13KB20    THRU 2460-EXIT                   
                 MOVE 'B'                     TO KB20-NUM-LOAN-TAG              
                                                 KB20-NUM-ORIG-LOAN-TAG         
                 PERFORM 2470-REWRITE-BP13KB20  THRU 2470-EXIT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F800-NUM-ORIG-LOAN-TAG = 'B' OR 'N'                               
             IF K730-NUM-APPL-LOAN-REQ = 'H'                                    
               IF F800-NUM-LOAN-TAG = 'H' OR 'P'                                
                  MOVE F800-NUM-ORIG-LOAN-TAG                                   
                          TO K800-NUM-LOAN-TAG OF BP13K800-MASTER               
                  PERFORM 2450-UPDATE-BP13K800  THRU 2450-EXIT                  
                  PERFORM 2460-READ-BP13KB20    THRU 2460-EXIT                  
                  MOVE F800-NUM-ORIG-LOAN-TAG TO KB20-NUM-LOAN-TAG              
                 PERFORM 2470-REWRITE-BP13KB20  THRU 2470-EXIT                  
               END-IF                                                           
             END-IF                                                             
           END-IF.                                                              
                                                                                
           PERFORM 1000-READ-F800-REC  THRU 1000-EXIT.                          
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2100-PROCESS-CASE.                                                       
      *------------------------------------------------------------             
                                                                                
           PERFORM 3000-CHECK-P04K010  THRU 3000-EXIT                           
                                                                                
           PERFORM 4000-CHECK-BP27K820 THRU 4000-EXIT                           
                                                                                
           PERFORM 5000-CHECK-BP13K060 THRU 5000-EXIT                           
                                                                                
           PERFORM 6000-CHECK-BR10K010 THRU 6000-EXIT                           
                                                                                
           PERFORM 7000-CHECK-BR10K080 THRU 7000-EXIT                           
                                                                                
           EVALUATE WS-BEF-TAG                                                  
              WHEN 'H'                                                          
              WHEN 'P'                                                          
                PERFORM 8000-PRINT-DETAIL-REPORT-A   THRU 8000-EXIT             
              WHEN 'B'                                                          
                PERFORM 8100-PRINT-DETAIL-REPORT-B   THRU 8100-EXIT             
              WHEN 'N'                                                          
                PERFORM 8200-PRINT-DETAIL-REPORT-C   THRU 8200-EXIT             
           END-EVALUATE.                                                        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2200-READ-BP13K730.                                                      
      *------------------------------------------------------------             
            MOVE WS-NUM-REGN      TO K730-NUM-REGN.                             
                                                                                
            READ BP13K730.                                                      
                                                                                
            EVALUATE WS-BP13K730-STATUS                                         
              WHEN 00                                                           
                   IF K730-NUM-PPO = 'Y'                                        
                      MOVE 'Y' TO WS-PPO-FND                                    
                   END-IF                                                       
                                                                                
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'K730 - REC NOT FND  ' K730-NUM-REGN                 
                   MOVE SPACES   TO BP13K730-REC                                
              WHEN OTHER                                                        
                   DISPLAY 'READ BP13K730 ERROR ' WS-BP13K730-STATUS            
                   MOVE WS-BP13K730-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2300-READ-BP13K820.                                                      
      *------------------------------------------------------------             
            MOVE WS-NUM-REGN      TO K820-NUM-REGN.                             
            MOVE SPACES           TO WS-NUM-NRIC.                               
            MOVE 'N'              TO EOF-BP13K820.                              
                                                                                
            START BP13K820 KEY >= K820-NUM-REGN.                                
                                                                                
            EVALUATE WS-BP13K820-STATUS                                         
              WHEN 00                                                           
              WHEN 02                                                           
                 IF WS-BEF-TAG NOT = 'B' AND 'N' AND 'H' AND 'P'                
                    ADD 1 TO WS-OTHER-LOAN-TAG                                  
                 END-IF                                                         
                 PERFORM 2350-READNEXT-BP13K820  THRU 2350-EXIT                 
                    UNTIL K820-NUM-REGN NOT = WS-NUM-REGN                       
                     OR EOF-BP13K820 = 'Y'                                      
                                                                                
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'REC NOT FOUND - K820-' K820-NUM-REGN                
                   ADD 1 TO WS-BYPASS                                           
              WHEN OTHER                                                        
                   DISPLAY 'READ BP13K730 ERROR ' WS-BP13K730-STATUS            
                   MOVE WS-BP13K730-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       2300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2350-READNEXT-BP13K820.                                                  
      *------------------------------------------------------------             
            READ BP13K820 NEXT.                                                 
                                                                                
            EVALUATE WS-BP13K820-STATUS                                         
              WHEN 00                                                           
              WHEN 02                                                           
                   IF K820-NUM-REGN    = WS-NUM-REGN                            
                     MOVE  K820-NUM-NRIC OF BP13K820-REC  TO                    
                           WS-NUM-NRIC                                          
                     PERFORM 2100-PROCESS-CASE THRU 2100-EXIT                   
                   END-IF                                                       
              WHEN 23                                                           
                   CONTINUE                                                     
              WHEN 10                                                           
                   MOVE 'Y' TO   EOF-BP13K820                                   
              WHEN OTHER                                                        
                  DISPLAY 'READNEXT BP13K820 ERROR ' WS-BP13K820-STATUS         
                  MOVE WS-BP13K820-STATUS           TO RETURN-CODE              
                  PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                     
            END-EVALUATE.                                                       
                                                                                
       2350-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2360-READ-BP13K820-A.                                                    
      *------------------------------------------------------------             
                                                                                
            READ BP13K820.                                                      
                                                                                
            EVALUATE WS-BP13K820-STATUS                                         
              WHEN 00                                                           
                   CONTINUE                                                     
                                                                                
              WHEN 10                                                           
              WHEN 23                                                           
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   DISPLAY 'READ BP13K820 ERROR ' WS-BP13K820-STATUS            
                   MOVE WS-BP13K820-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       2360-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2400-READ-BP13K800.                                                      
      *------------------------------------------------------------             
            MOVE SPACES           TO BP13K800-MASTER.                           
            MOVE WS-NUM-REGN      TO K800-NUM-REGN OF BP13K800-MASTER           
                                                                                
            READ BP13K800.                                                      
                                                                                
            EVALUATE WS-BP13K800-STATUS                                         
              WHEN 00                                                           
                   MOVE K800-NUM-LOAN-TAG OF BP13K800-MASTER                    
                        TO WS-BEF-TAG                                           
                   MOVE 'Y'    TO WS-FOUND-K800                                 
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'REC NOT FOUND IN BP13K800 - ' K800-NUM-REGN         
                           OF BP13K800-MASTER                                   
                   MOVE 'N'    TO WS-FOUND-K800                                 
              WHEN OTHER                                                        
                   DISPLAY 'READ BP13K800 ERROR ' WS-BP13K800-STATUS            
                   MOVE WS-BP13K800-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       2400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2450-UPDATE-BP13K800.                                                    
      *------------------------------------------------------------             
                                                                                
            REWRITE BP13K800-MASTER.                                            
                                                                                
            EVALUATE WS-BP13K800-STATUS                                         
              WHEN 00                                                           
                   ADD 1 TO WS-K800-UPD                                         
                                                                                
              WHEN OTHER                                                        
                   DISPLAY 'REWRITE BP13K800 ERROR ' WS-BP13K800-STATUS         
                   MOVE WS-BP13K800-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       2450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2460-READ-BP13KB20.                                                      
      *------------------------------------------------------------             
            MOVE SPACES           TO BP13KB20-REC.                              
            MOVE WS-NUM-REGN      TO KB20-NUM-REGN                              
                                                                                
            READ BP13KB20.                                                      
                                                                                
            EVALUATE WS-BP13KB20-STATUS                                         
              WHEN 00                                                           
                   CONTINUE                                                     
                                                                                
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'REC NOT FOUND IN BP13KB20 - ' KB20-NUM-REGN         
              WHEN OTHER                                                        
                   DISPLAY 'READ BP13KB20 ERROR ' WS-BP13KB20-STATUS            
                   MOVE WS-BP13KB20-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       2460-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       2470-REWRITE-BP13KB20.                                                   
      *------------------------------------------------------------             
                                                                                
           REWRITE BP13KB20-REC                                                 
                                                                                
           IF WS-BP13KB20-STATUS NOT = 00                                       
              DISPLAY 'READ BP13KB20 ERROR '                                    
              WS-BP13KB20-STATUS                                                
              MOVE WS-BP13KB20-STATUS          TO RETURN-CODE                   
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           ADD 1 TO WS-KB20-UPD.                                                
       2470-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       3000-CHECK-P04K010.                                                      
      *------------------------------------------------------------             
            MOVE SPACES           TO WS-DEB-FND.                                
            MOVE SPACES           TO K010-PRIME-KEY.                            
            MOVE 'N'              TO EOF-P04K010.                               
            MOVE WS-NUM-NRIC      TO K010-NUM-UINFIN.                           
                                                                                
            START P04K010 KEY >= K010-NUM-UINFIN.                               
                                                                                
            EVALUATE WS-P04K010-STATUS                                          
              WHEN 00                                                           
                   PERFORM 3100-READNEXT-P04K010    THRU 3100-EXIT              
                     UNTIL K010-NUM-UINFIN NOT = WS-NUM-NRIC                    
                       OR   WS-DEB-FND  = 'Y'                                   
                       OR   EOF-P04K010 = 'Y'                                   
              WHEN 23                                                           
                   DISPLAY 'NOT FND BP04K010 NRIC  ' K010-NUM-UINFIN            
              WHEN OTHER                                                        
                   DISPLAY 'START P04K010 ERROR ' WS-P04K010-STATUS             
                   MOVE WS-P04K010-STATUS           TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       3100-READNEXT-P04K010.                                                   
      *------------------------------------------------------------             
            READ P04K010 NEXT.                                                  
                                                                                
            EVALUATE WS-P04K010-STATUS                                          
              WHEN 00                                                           
                   IF K010-NUM-UINFIN  = WS-NUM-NRIC                            
                      MOVE K010-REASON-CODE TO WS-K010-REASON                   
                      IF VALID-REASON                                           
                         MOVE 'Y' TO WS-DEB-FND                                 
                      END-IF                                                    
                   END-IF                                                       
              WHEN 23                                                           
                   CONTINUE                                                     
              WHEN 10                                                           
                   MOVE 'Y' TO EOF-P04K010                                      
              WHEN OTHER                                                        
                   DISPLAY 'READNEXT P04K010 ERROR ' WS-P04K010-STATUS          
                   MOVE WS-P04K010-STATUS           TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4000-CHECK-BP27K820.                                                     
      *------------------------------------------------------------             
            MOVE SPACES           TO WS-LEAS-FND.                               
            MOVE SPACES           TO BP27K820-REC                               
                                     WS-BP27-REASON                             
                                     WS-HLA                                     
                                     WS-STATUS.                                 
            MOVE 'N'              TO EOF-BP27K820.                              
            MOVE WS-NUM-NRIC      TO                                            
                                     K820-NUM-NRIC OF BP27K820-REC.             
                                                                                
            START BP27K820 KEY >= K820-NUM-NRIC OF BP27K820-REC.                
                                                                                
            EVALUATE WS-BP27K820-STATUS                                         
              WHEN 00                                                           
              WHEN 02                                                           
                   PERFORM 4100-READNEXT-BP27K820   THRU 4100-EXIT              
                     UNTIL  WS-LEAS-FND  = 'Y'                                  
                       OR   EOF-BP27K820 = 'Y'                                  
                       OR  WS-NUM-NRIC NOT =                                    
                        K820-NUM-NRIC OF BP27K820-REC                           
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'NOT FND BP27K800 NRIC  '                            
                           K820-NUM-NRIC OF BP27K820-REC                        
              WHEN OTHER                                                        
                   DISPLAY 'START BP27K820 ERROR ' WS-BP27K820-STATUS           
                   MOVE WS-BP27K820-STATUS           TO RETURN-CODE             
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4100-READNEXT-BP27K820.                                                  
      *------------------------------------------------------------             
            READ BP27K820 NEXT.                                                 
                                                                                
            EVALUATE WS-BP27K820-STATUS                                         
              WHEN 00                                                           
              WHEN 02                                                           
                  IF WS-NUM-NRIC =  K820-NUM-NRIC OF BP27K820-REC               
                     MOVE K820-NUM-HLA OF BP27K820-REC TO WS-HLA                
                     PERFORM 4200-READ-BP27K800   THRU 4200-EXIT                
                  END-IF                                                        
              WHEN 23                                                           
              WHEN 10                                                           
                  MOVE 'Y' TO EOF-BP27K820                                      
              WHEN OTHER                                                        
                  DISPLAY 'READNEXT BP27K820 ERROR ' WS-BP27K820-STATUS         
                  MOVE WS-BP27K820-STATUS           TO RETURN-CODE              
                  PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                     
            END-EVALUATE.                                                       
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4200-READ-BP27K800.                                                      
      *------------------------------------------------------------             
            MOVE SPACES           TO BP27K800-MASTER                            
                                     WS-BP27-REASON.                            
                                                                                
            MOVE K820-NUM-HLA OF BP27K820-REC                                   
                                  TO K800-NUM-HLA OF BP27K800-MASTER.           
                                                                                
            READ BP27K800.                                                      
                                                                                
            EVALUATE WS-BP27K800-STATUS                                         
              WHEN 00                                                           
                MOVE K800-NUM-CASE-STATUS OF BP27K800-MASTER                    
                      TO WS-STATUS                                              
                PERFORM 4300-CHECK-BP27K870  THRU 4300-EXIT                     
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'REC NOT FOUND - BP27K800-'                          
                      K800-NUM-HLA OF BP27K800-MASTER                           
                   MOVE SPACES   TO WS-STATUS                                   
              WHEN OTHER                                                        
                   DISPLAY 'READ BP27K800 ERROR ' WS-BP27K800-STATUS            
                   MOVE WS-BP27K800-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4300-CHECK-BP27K870.                                                     
      *------------------------------------------------------------             
            MOVE SPACES           TO BP27K870-REC                               
                                     WS-BP27-REASON                             
                                     WS-LEAS-FND.                               
            MOVE 'N'              TO EOF-BP27K870.                              
            MOVE K820-NUM-HLA OF BP27K820-REC TO K870-NUM-HLA.                  
                                                                                
            START BP27K870 KEY >= K870-KEY-FLD                                  
                                                                                
            EVALUATE WS-BP27K870-STATUS                                         
              WHEN 00                                                           
              WHEN 02                                                           
                   PERFORM 4400-READNEXT-BP27K870   THRU 4400-EXIT              
                     UNTIL  WS-LEAS-FND  = 'Y'                                  
                       OR   EOF-BP27K870 = 'Y'                                  
                       OR  K820-NUM-HLA OF BP27K820-REC NOT =                   
                        K870-NUM-HLA                                            
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'NOT FND BP27K870 HLA   '                            
                           K820-NUM-HLA OF BP27K820-REC                         
              WHEN OTHER                                                        
                   DISPLAY 'START BP27K870 ERROR ' WS-BP27K870-STATUS           
                   MOVE WS-BP27K870-STATUS           TO RETURN-CODE             
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       4400-READNEXT-BP27K870.                                                  
      *------------------------------------------------------------             
            READ BP27K870 NEXT.                                                 
                                                                                
            EVALUATE WS-BP27K870-STATUS                                         
              WHEN 00                                                           
              WHEN 02                                                           
                  IF K870-NUM-HLA =  K820-NUM-HLA OF BP27K820-REC               
                     MOVE K870-NUM-APPEAL-RSN      TO WS-BP27-REASON            
                     MOVE 'Y'                      TO WS-LEAS-FND               
                  END-IF                                                        
              WHEN 23                                                           
              WHEN 10                                                           
                  MOVE 'Y' TO EOF-BP27K870                                      
              WHEN OTHER                                                        
                  DISPLAY 'READNEXT BP27K870 ERROR ' WS-BP27K870-STATUS         
                  MOVE WS-BP27K870-STATUS           TO RETURN-CODE              
                  PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                     
            END-EVALUATE.                                                       
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       5000-CHECK-BP13K060.                                                     
      *------------------------------------------------------------             
            MOVE SPACES                 TO BP13K060-REC.                        
            MOVE '35'                   TO K060-SERIAL-NO.                      
            MOVE K820-NUM-RELATIONSHIP  OF BP13K820-REC                         
                                        TO K060-CODE.                           
                                                                                
            READ BP13K060.                                                      
                                                                                
            EVALUATE WS-BP13K060-STATUS                                         
              WHEN 00                                                           
                   MOVE K060-DESC      TO WS-RELATION                           
                                                                                
              WHEN 10                                                           
              WHEN 23                                                           
                   DISPLAY 'REC NOT FOUND - K060-' K060-KEY-FLD                 
              WHEN OTHER                                                        
                   DISPLAY 'READ BP13K060 ERROR ' WS-BP13K060-STATUS            
                   MOVE WS-BP13K060-STATUS          TO RETURN-CODE              
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
            END-EVALUATE.                                                       
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       6000-CHECK-BR10K010.                                                     
      *------------------------------------------------------------             
           MOVE SPACES          TO WS-PPOS-FND.                                 
           MOVE SPACES          TO K010-KEY-FLD.                                
           MOVE 'N'             TO EOF-BR10K010.                                
           MOVE WS-NUM-NRIC     TO K010-NUM-UIN.                                
                                                                                
           START BR10K010 KEY > K010-KEY-FLD.                                   
                                                                                
           EVALUATE WS-BR10K010-STATUS                                          
             WHEN   00                                                          
             WHEN   02                                                          
                    PERFORM 6100-READNEXT-BR10K010 THRU 6100-EXIT               
                      UNTIL K010-NUM-UIN NOT = WS-NUM-NRIC                      
                         OR EOF-BR10K010 = 'Y'                                  
                         OR WS-PPOS-FND = 'Y'                                   
             WHEN   23                                                          
             WHEN   10                                                          
                    CONTINUE                                                    
             WHEN   OTHER                                                       
                    DISPLAY 'BR10K010 START ERROR ' WS-BR10K010-STATUS          
                    DISPLAY 'BR10K010 RECORD KEY IS ' K010-KEY-FLD              
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       6100-READNEXT-BR10K010.                                                  
      *------------------------------------------------------------             
           READ BR10K010 NEXT.                                                  
                                                                                
           EVALUATE WS-BR10K010-STATUS                                          
              WHEN  00                                                          
              WHEN  02                                                          
                    IF K010-NUM-UIN = WS-NUM-NRIC                               
                       IF K010-CDE-PPTY-TYPE NOT = 'HLQTR' AND                  
                                                   'HLUSH' AND                  
                                                   'HSHSH'                      
                          MOVE 'Y' TO WS-PPOS-FND                               
                          DISPLAY ' NRIC - ' WS-NUM-NRIC                        
                                  ' REGN - ' WS-NUM-REGN                        
                                  ' PPO  - ' K010-CDE-PPTY-TYPE                 
                       END-IF                                                   
                    END-IF                                                      
              WHEN  23                                                          
              WHEN  10                                                          
                    MOVE 'Y'  TO EOF-BR10K010                                   
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BR10K010 ERROR ' WS-BR10K010-STATUS           
                    MOVE WS-BR10K010-STATUS TO RETURN-CODE                      
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       7000-CHECK-BR10K080.                                                     
      *------------------------------------------------------------             
           MOVE SPACES          TO K080-KEY-FLD.                                
           MOVE SPACES          TO WS-PPOH-FND.                                 
           MOVE 'N'             TO EOF-BR10K080.                                
           MOVE WS-NUM-NRIC     TO K080-NUM-UIN OF BR10K080-REC.                
                                                                                
           START BR10K080 KEY > K080-KEY-FLD.                                   
                                                                                
           EVALUATE WS-BR10K080-STATUS                                          
             WHEN   00                                                          
             WHEN   02                                                          
                    PERFORM 7100-READNEXT-BR10K080 THRU 7100-EXIT               
                      UNTIL K080-NUM-UIN OF BR10K080-REC NOT =                  
                                       WS-NUM-NRIC                              
                         OR EOF-BR10K080 = 'Y'                                  
                         OR WS-PPOH-FND = 'Y'                                   
             WHEN   23                                                          
                    CONTINUE                                                    
             WHEN   OTHER                                                       
                    DISPLAY 'BR10K080 START ERROR ' WS-BR10K080-STATUS          
                    DISPLAY 'BR10K080 RECORD KEY IS ' K010-KEY-FLD              
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       7100-READNEXT-BR10K080.                                                  
      *------------------------------------------------------------             
           READ BR10K080 NEXT.                                                  
                                                                                
           EVALUATE WS-BR10K080-STATUS                                          
              WHEN  00                                                          
              WHEN  02                                                          
                    IF K080-NUM-UIN OF BR10K080-REC = WS-NUM-NRIC               
                       IF K080-CDE-PPTY-TYPE NOT = 'HLQTR' AND                  
                                                   'HLUSH' AND                  
                                                   'HSHSH'                      
                          MOVE 'Y' TO WS-PPOH-FND                               
                       END-IF                                                   
                    END-IF                                                      
              WHEN  23                                                          
              WHEN  10                                                          
                    MOVE 'Y'  TO EOF-BR10K080                                   
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BR10K080 ERROR ' WS-BR10K080-STATUS           
                    MOVE WS-BR10K080-STATUS TO RETURN-CODE                      
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8000-PRINT-DETAIL-REPORT-A.                                              
                                                                                
           MOVE SPACES       TO LE01-DETAIL.                                    
                                                                                
           IF WS-PREV-REGN = SPACES                                             
              ADD 1                    TO WS-SNO-A                              
                                          WS-TOT-A                              
              MOVE WS-SNO-A            TO LE01-SNO                              
              MOVE WS-NUM-REGN         TO LE01-REGN                             
              MOVE F800-AMT-HSE-INCOME TO LE01-HH-INC                           
              IF F800-AMT-HSE-INCOME > 8000                                     
                 MOVE 'Y'              TO WS-8K-INC                             
              ELSE                                                              
               IF F800-AMT-HSE-INCOME = ZEROES OR LOW-VALUES OR SPACES          
                 MOVE 'Y'              TO WS-8K-INC                             
               END-IF                                                           
              END-IF                                                            
              STRING F800-DTE-BK-APPT(7:2)'/' F800-DTE-BK-APPT(5:2)             
                  '/' F800-DTE-BK-APPT(1:4) DELIMITED BY SIZE INTO              
                  LE01-APPT-DTE                                                 
              MOVE WS-NUM-REGN         TO WS-PREV-REGN                          
           END-IF.                                                              
                                                                                
           MOVE WS-PPO-FND             TO LE01-PPOS-DECL.                       
           IF WS-PPO-FND = 'Y'                                                  
              ADD   1                  TO WS-RECS-PPO                           
           END-IF.                                                              
           MOVE K820-NME-OCCP          OF BP13K820-REC                          
                                       TO LE01-NAME.                            
           MOVE K820-NUM-NRIC          OF BP13K820-REC                          
                                       TO LE01-NRIC.                            
           MOVE WS-RELATION            TO LE01-REL.                             
           MOVE K820-DTE-BIRTH         OF BP13K820-REC                          
                                       TO LE01-BDATE.                           
           MOVE WS-BEF-TAG             TO LE01-BEF-TAG.                         
                                                                                
           IF K820-DTE-BIRTH OF BP13K820-REC                                    
                             = SPACES OR LOW-VALUES                             
              MOVE ZEROES              TO WS-DTE-BIRTH                          
           ELSE                                                                 
              MOVE K820-DTE-BIRTH      OF BP13K820-REC                          
                                       TO WS-DTE-BIRTH                          
           END-IF                                                               
           IF F800-DTE-REGN = SPACES OR LOW-VALUES                              
              MOVE ZEROES              TO  WS-DTE-REQUEST                       
           ELSE                                                                 
              MOVE F800-DTE-REGN       TO WS-DTE-REQUEST                        
           END-IF.                                                              
                                                                                
           MOVE WS-STATUS              TO LE01-STAT                             
           COMPUTE WS-AGE = WS-REQUEST-CYM - WS-BIRTH-CYM                       
                                                                                
           IF WS-APPLN-AGE > 65                                                 
              MOVE 'Y'                 TO LE01-AGE                              
              ADD 1                    TO WS-RECS-65YR                          
           END-IF.                                                              
                                                                                
           IF WS-BP27-REASON NOT = SPACES AND LOW-VALUES                        
              MOVE 'Y'                 TO LE01-LEAS                             
              MOVE WS-BP27-REASON      TO LE01-REASON                           
              MOVE '-'                      TO LE01-DASH                        
           END-IF.                                                              
                                                                                
           IF WS-PPOH-FND = 'Y'  OR  WS-PPOS-FND  = 'Y'                         
              MOVE 'Y'                 TO LE01-PPOS                             
              ADD 1                    TO WS-RECS-PPOS                          
           END-IF.                                                              
           IF WS-DEB-FND  = 'Y'                                                 
             IF WS-K010-REASON = 'RL'                                           
                MOVE 'Y'               TO LE01-RL                               
             ELSE                                                               
                MOVE 'Y'               TO WS-EC-FND                             
                MOVE 'Y'               TO LE01-EC                               
                ADD 1                  TO WS-RECS-EC                            
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE WS-HLA                 TO LE01-HLA.                             
           IF F800-AMT-HSE-INCOME > 12000                                       
              MOVE 'B' TO LE01-LOAN-OG                                          
           ELSE                                                                 
              MOVE F800-NUM-ORIG-LOAN-TAG  TO LE01-LOAN-OG                      
           END-IF                                                               
           MOVE K730-NUM-APPL-LOAN-REQ TO LE01-LOAN-RQ.                         
                                                                                
                                                                                
           IF ((WS-PPO-FND = 'Y') OR                                            
              (WS-PPOH-FND = 'Y') OR                                            
              (WS-PPOS-FND = 'Y') OR                                            
              (WS-EC-FND   = 'Y') OR                                            
              (WS-AGE-FND  = 'Y') OR                                            
              (WS-8K-INC   = 'Y'))                                              
                IF WS-BEF-TAG = 'B' OR 'N'                                      
                   MOVE SPACE          TO LE01-AFT-TAG                          
                ELSE                                                            
                   MOVE 'B'            TO LE01-AFT-TAG                          
                END-IF                                                          
                MOVE 'Y'   TO WS-VALID-REWRITE                                  
           END-IF.                                                              
                                                                                
           IF WS-LINE-A > 60                                                    
              ADD  1                   TO WS-PAGE-A                             
              MOVE WS-PAGE-A           TO LE01-PAGE-NO                          
              WRITE P13LE01A-REC     FROM LE01-HDG1                             
              WRITE P13LE01A-REC     FROM LE01-HDG2                             
              WRITE P13LE01A-REC     FROM LE01-HDG3                             
              WRITE P13LE01A-REC     FROM LE01-HDG3A                            
              WRITE P13LE01A-REC     FROM LE01-HDG4                             
              MOVE 1                   TO WS-LINE-A                             
           END-IF.                                                              
                                                                                
           WRITE P13LE01A-REC        FROM LE01-DETAIL                           
           ADD 1                       TO WS-WRT-LE01A.                         
           ADD 1                       TO WS-LINE-A.                            
                                                                                
           IF WS-PPO-FND = 'Y'                                                  
              PERFORM 8300-PRINT-DETAIL-REPORT-D   THRU 8300-EXIT               
           END-IF.                                                              
                                                                                
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8100-PRINT-DETAIL-REPORT-B.                                              
                                                                                
           MOVE SPACES                 TO LE01-DETAIL.                          
                                                                                
           IF WS-PREV-REGN = SPACES                                             
              ADD 1                    TO WS-SNO-B                              
                                          WS-TOT-B                              
              MOVE WS-SNO-B            TO LE01-SNO                              
              MOVE WS-NUM-REGN         TO LE01-REGN                             
              MOVE F800-AMT-HSE-INCOME TO LE01-HH-INC                           
              IF F800-AMT-HSE-INCOME > 8000                                     
                 MOVE 'Y'              TO WS-8K-INC                             
              ELSE                                                              
               IF F800-AMT-HSE-INCOME = ZEROES OR LOW-VALUES OR SPACES          
                 MOVE 'Y'              TO WS-8K-INC                             
               END-IF                                                           
              END-IF                                                            
              STRING F800-DTE-BK-APPT(7:2)'/' F800-DTE-BK-APPT(5:2)             
                  '/' F800-DTE-BK-APPT(1:4) DELIMITED BY SIZE INTO              
                  LE01-APPT-DTE                                                 
              MOVE WS-NUM-REGN         TO WS-PREV-REGN                          
           END-IF.                                                              
                                                                                
           MOVE WS-PPO-FND             TO LE01-PPOS-DECL.                       
           IF WS-PPO-FND = 'Y'                                                  
              ADD   1                  TO WS-RECS-PPO                           
           END-IF.                                                              
           MOVE K820-NME-OCCP          OF BP13K820-REC                          
                                       TO LE01-NAME.                            
           MOVE K820-NUM-NRIC          OF BP13K820-REC                          
                                       TO LE01-NRIC.                            
           MOVE WS-RELATION            TO LE01-REL.                             
           MOVE K820-DTE-BIRTH         OF BP13K820-REC                          
                                       TO LE01-BDATE.                           
           MOVE WS-BEF-TAG             TO LE01-BEF-TAG.                         
                                                                                
           IF K820-DTE-BIRTH OF BP13K820-REC                                    
                             = SPACES OR LOW-VALUES                             
              MOVE ZEROES              TO WS-DTE-BIRTH                          
           ELSE                                                                 
              MOVE K820-DTE-BIRTH      OF BP13K820-REC                          
                                       TO WS-DTE-BIRTH                          
           END-IF                                                               
           IF F800-DTE-REGN = SPACES OR LOW-VALUES                              
              MOVE ZEROES              TO  WS-DTE-REQUEST                       
           ELSE                                                                 
              MOVE F800-DTE-REGN       TO WS-DTE-REQUEST                        
           END-IF.                                                              
                                                                                
           MOVE WS-STATUS              TO LE01-STAT                             
           COMPUTE WS-AGE = WS-REQUEST-CYM - WS-BIRTH-CYM                       
                                                                                
           IF WS-APPLN-AGE > 65                                                 
              MOVE 'Y'                 TO LE01-AGE                              
              ADD 1                    TO WS-RECS-65YR                          
           END-IF.                                                              
                                                                                
           IF WS-BP27-REASON NOT = SPACES AND LOW-VALUES                        
              MOVE 'Y'                 TO LE01-LEAS                             
              MOVE WS-BP27-REASON      TO LE01-REASON                           
              MOVE '-'                      TO LE01-DASH                        
           END-IF.                                                              
                                                                                
           IF WS-PPOH-FND = 'Y'  OR  WS-PPOS-FND  = 'Y'                         
              MOVE 'Y'                 TO LE01-PPOS                             
              ADD 1                    TO WS-RECS-PPOS                          
           END-IF.                                                              
                                                                                
           IF WS-DEB-FND  = 'Y'                                                 
             IF WS-K010-REASON = 'RL'                                           
                MOVE 'Y'               TO LE01-RL                               
             ELSE                                                               
                MOVE 'Y'               TO WS-EC-FND                             
                MOVE 'Y'               TO LE01-EC                               
                ADD 1                  TO WS-RECS-EC                            
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE WS-HLA                 TO LE01-HLA.                             
           MOVE K800-NUM-ORIG-LOAN-TAG OF BP13K800-MASTER                       
                                       TO LE01-LOAN-OG.                         
           MOVE K730-NUM-APPL-LOAN-REQ TO LE01-LOAN-RQ.                         
                                                                                
                                                                                
           IF ((WS-PPO-FND = 'Y') OR                                            
              (WS-PPOH-FND = 'Y') OR                                            
              (WS-PPOS-FND = 'Y') OR                                            
              (WS-EC-FND   = 'Y') OR                                            
              (WS-AGE-FND  = 'Y') OR                                            
              (WS-8K-INC   = 'Y'))                                              
                IF WS-BEF-TAG = 'B' OR 'N'                                      
                   MOVE SPACE          TO LE01-AFT-TAG                          
                ELSE                                                            
                   MOVE 'B'            TO LE01-AFT-TAG                          
                END-IF                                                          
           END-IF.                                                              
                                                                                
                                                                                
           IF WS-LINE-B > 60                                                    
              ADD  1                   TO WS-PAGE-B                             
              MOVE WS-PAGE-B           TO LE01-PAGE-NO                          
              WRITE P13LE01B-REC     FROM LE01-HDG1                             
              WRITE P13LE01B-REC     FROM LE01-HDG2                             
              WRITE P13LE01B-REC     FROM LE01-HDG3                             
              WRITE P13LE01B-REC     FROM LE01-HDG3A                            
              WRITE P13LE01B-REC     FROM LE01-HDG4                             
              MOVE 1                   TO WS-LINE-B                             
           END-IF.                                                              
                                                                                
           WRITE P13LE01B-REC        FROM LE01-DETAIL                           
           ADD 1                       TO WS-WRT-LE01B.                         
           ADD 1                       TO WS-LINE-B.                            
                                                                                
           IF WS-PPO-FND  = 'Y'                                                 
              PERFORM 8300-PRINT-DETAIL-REPORT-D   THRU 8300-EXIT               
           END-IF.                                                              
                                                                                
                                                                                
       8100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8200-PRINT-DETAIL-REPORT-C.                                              
                                                                                
           MOVE SPACES                 TO LE01-DETAIL.                          
                                                                                
           IF WS-PREV-REGN = SPACES                                             
              ADD 1                    TO WS-SNO-C                              
                                          WS-TOT-C                              
              MOVE WS-SNO-C            TO LE01-SNO                              
              MOVE WS-NUM-REGN         TO LE01-REGN                             
              MOVE F800-AMT-HSE-INCOME TO LE01-HH-INC                           
              IF F800-AMT-HSE-INCOME > 8000                                     
                 MOVE 'Y'              TO WS-8K-INC                             
              ELSE                                                              
               IF F800-AMT-HSE-INCOME = ZEROES OR LOW-VALUES OR SPACES          
                 MOVE 'Y'              TO WS-8K-INC                             
               END-IF                                                           
              END-IF                                                            
              STRING F800-DTE-BK-APPT(7:2)'/' F800-DTE-BK-APPT(5:2)             
                  '/' F800-DTE-BK-APPT(1:4) DELIMITED BY SIZE INTO              
                  LE01-APPT-DTE                                                 
              MOVE WS-NUM-REGN         TO WS-PREV-REGN                          
           END-IF.                                                              
                                                                                
           MOVE WS-PPO-FND             TO LE01-PPOS-DECL.                       
           IF WS-PPO-FND = 'Y'                                                  
              ADD   1                  TO WS-RECS-PPO                           
           END-IF.                                                              
           MOVE K820-NME-OCCP          OF BP13K820-REC                          
                                       TO LE01-NAME.                            
           MOVE K820-NUM-NRIC          OF BP13K820-REC                          
                                       TO LE01-NRIC.                            
           MOVE WS-RELATION            TO LE01-REL.                             
           MOVE K820-DTE-BIRTH         OF BP13K820-REC                          
                                       TO LE01-BDATE.                           
           MOVE WS-BEF-TAG             TO LE01-BEF-TAG.                         
                                                                                
           IF K820-DTE-BIRTH OF BP13K820-REC                                    
                             = SPACES OR LOW-VALUES                             
              MOVE ZEROES              TO WS-DTE-BIRTH                          
           ELSE                                                                 
              MOVE K820-DTE-BIRTH      OF BP13K820-REC                          
                                       TO WS-DTE-BIRTH                          
           END-IF                                                               
           IF F800-DTE-REGN = SPACES OR LOW-VALUES                              
              MOVE ZEROES              TO  WS-DTE-REQUEST                       
           ELSE                                                                 
              MOVE F800-DTE-REGN       TO WS-DTE-REQUEST                        
           END-IF.                                                              
                                                                                
           MOVE WS-STATUS              TO LE01-STAT                             
           COMPUTE WS-AGE = WS-REQUEST-CYM - WS-BIRTH-CYM                       
                                                                                
           IF WS-APPLN-AGE > 65                                                 
              MOVE 'Y'                 TO LE01-AGE                              
              ADD 1                    TO WS-RECS-65YR                          
           END-IF.                                                              
                                                                                
           IF WS-BP27-REASON NOT = SPACES AND LOW-VALUES                        
              MOVE 'Y'                 TO LE01-LEAS                             
              MOVE WS-BP27-REASON      TO LE01-REASON                           
              MOVE '-'                      TO LE01-DASH                        
           END-IF.                                                              
                                                                                
           IF WS-PPOH-FND = 'Y'  OR  WS-PPOS-FND  = 'Y'                         
              MOVE 'Y'                 TO LE01-PPOS                             
              ADD 1                    TO WS-RECS-PPOS                          
           END-IF.                                                              
           IF WS-DEB-FND  = 'Y'                                                 
             IF WS-K010-REASON = 'RL'                                           
                MOVE 'Y'               TO LE01-RL                               
             ELSE                                                               
                MOVE 'Y'               TO WS-EC-FND                             
                MOVE 'Y'               TO LE01-EC                               
                ADD 1                  TO WS-RECS-EC                            
             END-IF                                                             
           END-IF.                                                              
                                                                                
           MOVE WS-HLA                 TO LE01-HLA.                             
           MOVE K800-NUM-ORIG-LOAN-TAG OF BP13K800-MASTER                       
                                       TO LE01-LOAN-OG.                         
           MOVE K730-NUM-APPL-LOAN-REQ TO LE01-LOAN-RQ.                         
                                                                                
                                                                                
           IF ((WS-PPO-FND = 'Y') OR                                            
              (WS-PPOH-FND = 'Y') OR                                            
              (WS-PPOS-FND = 'Y') OR                                            
              (WS-EC-FND   = 'Y') OR                                            
              (WS-AGE-FND  = 'Y') OR                                            
              (WS-8K-INC   = 'Y'))                                              
                IF WS-BEF-TAG = 'B' OR 'N'                                      
                   MOVE SPACE          TO LE01-AFT-TAG                          
                ELSE                                                            
                   MOVE 'B'            TO LE01-AFT-TAG                          
                END-IF                                                          
           END-IF.                                                              
                                                                                
                                                                                
           IF WS-LINE-C > 60                                                    
              ADD  1                   TO WS-PAGE-C                             
              MOVE WS-PAGE-C           TO LE01-PAGE-NO                          
              WRITE P13LE01C-REC     FROM LE01-HDG1                             
              WRITE P13LE01C-REC     FROM LE01-HDG2                             
              WRITE P13LE01C-REC     FROM LE01-HDG3                             
              WRITE P13LE01C-REC     FROM LE01-HDG3A                            
              WRITE P13LE01C-REC     FROM LE01-HDG4                             
              MOVE 1                   TO WS-LINE-C                             
           END-IF.                                                              
                                                                                
           WRITE P13LE01C-REC        FROM LE01-DETAIL                           
           ADD 1                       TO WS-WRT-LE01C.                         
           ADD 1                       TO WS-LINE-C.                            
                                                                                
           IF WS-PPO-FND  = 'Y'                                                 
              PERFORM 8300-PRINT-DETAIL-REPORT-D   THRU 8300-EXIT               
           END-IF.                                                              
                                                                                
                                                                                
       8200-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8300-PRINT-DETAIL-REPORT-D.                                              
                                                                                
            IF LE01-REGN NOT = SPACES                                           
              ADD 1                    TO WS-SNO-D                              
                                          WS-TOT-D                              
              MOVE WS-SNO-D            TO LE01-SNO                              
            END-IF.                                                             
                                                                                
           IF WS-LINE-D > 60                                                    
              ADD  1                   TO WS-PAGE-D                             
              MOVE WS-PAGE-D           TO LE01-PAGE-NO                          
              WRITE P13LE01D-REC     FROM LE01-HDG1                             
              WRITE P13LE01D-REC     FROM LE01-HDG2                             
              WRITE P13LE01D-REC     FROM LE01-HDG3                             
              WRITE P13LE01D-REC     FROM LE01-HDG3A                            
              WRITE P13LE01D-REC     FROM LE01-HDG4                             
              MOVE 1                   TO WS-LINE-D                             
           END-IF.                                                              
                                                                                
           WRITE P13LE01D-REC        FROM LE01-DETAIL                           
           ADD 1                       TO WS-WRT-LE01D.                         
           ADD 1                       TO WS-LINE-D.                            
                                                                                
       8300-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8500-CHECK-AGE-HA.                                                       
                                                                                
           MOVE SPACES             TO BP13K820-REC.                             
           MOVE WS-NUM-REGN        TO K820-NUM-REGN OF BP13K820-REC.            
           MOVE F800-NUM-NRIC1     TO K820-NUM-NRIC OF BP13K820-REC.            
           PERFORM 2360-READ-BP13K820-A   THRU 2360-EXIT.                       
           PERFORM 8600-COMPUTE-AGE       THRU 8600-EXIT.                       
                                                                                
           IF WS-APPLN-AGE > 65                                                 
              MOVE 'Y'                 TO WS-AGE-FND                            
           ELSE                                                                 
              MOVE SPACES              TO WS-AGE-FND                            
              GO  TO 8500-EXIT                                                  
           END-IF.                                                              
                                                                                
           IF F800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES                        
             MOVE SPACES             TO BP13K820-REC                            
             MOVE WS-NUM-REGN        TO K820-NUM-REGN OF BP13K820-REC           
             MOVE F800-NUM-NRIC2     TO K820-NUM-NRIC OF BP13K820-REC           
             PERFORM 2360-READ-BP13K820-A   THRU 2360-EXIT                      
             PERFORM 8600-COMPUTE-AGE       THRU 8600-EXIT                      
                                                                                
             IF WS-APPLN-AGE > 65                                               
                MOVE 'Y'                 TO WS-AGE-FND                          
             ELSE                                                               
                MOVE SPACES              TO WS-AGE-FND                          
                GO  TO 8500-EXIT                                                
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF F800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES                        
             MOVE SPACES             TO BP13K820-REC                            
             MOVE WS-NUM-REGN        TO K820-NUM-REGN OF BP13K820-REC           
             MOVE F800-NUM-NRIC3     TO K820-NUM-NRIC OF BP13K820-REC           
             PERFORM 2360-READ-BP13K820-A   THRU 2360-EXIT                      
             PERFORM 8600-COMPUTE-AGE       THRU 8600-EXIT                      
                                                                                
             IF WS-APPLN-AGE > 65                                               
                MOVE 'Y'                 TO WS-AGE-FND                          
             ELSE                                                               
                MOVE SPACES              TO WS-AGE-FND                          
                GO  TO 8500-EXIT                                                
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF F800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES                        
             MOVE SPACES             TO BP13K820-REC                            
             MOVE WS-NUM-REGN        TO K820-NUM-REGN OF BP13K820-REC           
             MOVE F800-NUM-NRIC4     TO K820-NUM-NRIC OF BP13K820-REC           
             PERFORM 2360-READ-BP13K820-A   THRU 2360-EXIT                      
             PERFORM 8600-COMPUTE-AGE       THRU 8600-EXIT                      
                                                                                
             IF WS-APPLN-AGE > 65                                               
                MOVE 'Y'                 TO WS-AGE-FND                          
             ELSE                                                               
                MOVE SPACES              TO WS-AGE-FND                          
                GO  TO 8500-EXIT                                                
             END-IF                                                             
           END-IF.                                                              
                                                                                
       8500-EXIT.                                                               
           EXIT.                                                                
                                                                                
       8600-COMPUTE-AGE.                                                        
                                                                                
           IF K820-DTE-BIRTH OF BP13K820-REC                                    
                             = SPACES OR LOW-VALUES                             
              MOVE ZEROES              TO WS-DTE-BIRTH                          
           ELSE                                                                 
              MOVE K820-DTE-BIRTH      OF BP13K820-REC                          
                                       TO WS-DTE-BIRTH                          
           END-IF                                                               
           IF F800-DTE-REGN = SPACES OR LOW-VALUES                              
              MOVE ZEROES              TO  WS-DTE-REQUEST                       
           ELSE                                                                 
              MOVE F800-DTE-REGN       TO WS-DTE-REQUEST                        
           END-IF.                                                              
                                                                                
           COMPUTE WS-AGE = WS-REQUEST-CYM - WS-BIRTH-CYM.                      
                                                                                
       8600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------             
       9000-CLOSE-ROUTINE.                                                      
      *------------------------------------------------------------             
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY 'BP13CE01            CURR-DATE : ' WS-DATE.                  
           DISPLAY '*-----------------------------------------------*'.         
           DISPLAY 'EXCEPTIONAL REPORT BEFORE BALLOT COMMENCE'.                 
           DISPLAY '*-----------------------------------------------*'.         
           DISPLAY 'NO OF RECORDS READ FROM F800   ' WS-F800-READ.              
           DISPLAY 'NO OF RECORDS UPD  FROM K800   ' WS-K800-UPD.               
           DISPLAY 'NO OF RECORDS UPD  FROM KB20   ' WS-KB20-UPD.               
           DISPLAY 'NO OF PPOS-DECL    RECORD      ' WS-RECS-PPO.               
           DISPLAY 'NO OF PPOS         RECORD      ' WS-RECS-PPOS.              
           DISPLAY 'NO OF AGE>65       RECORD      ' WS-RECS-65YR.              
           DISPLAY 'NO OF EC           RECORD      ' WS-RECS-EC.                
           DISPLAY ' '.                                                         
           DISPLAY 'NO OF CASES BYPASS LN TAG=OTHR ' WS-OTHER-LOAN-TAG.         
           DISPLAY 'NO OF CASES WRT ON A TAG= H/P  ' WS-TOT-A.                  
           DISPLAY 'NO OF CASES WRT ON B TAG= B    ' WS-TOT-B.                  
           DISPLAY 'NO OF CASES WRT ON C TAG= N    ' WS-TOT-C.                  
           DISPLAY 'NO OF CASES WRT ON D           ' WS-TOT-D.                  
           DISPLAY 'NO OF CASES NOT FND BP13K820   ' WS-BYPASS.                 
           DISPLAY ' '.                                                         
           DISPLAY 'NO OF NRIC  WRITTEN ON LE01A   ' WS-WRT-LE01A.              
           DISPLAY 'NO OF NRIC  WRITTEN ON LE01B   ' WS-WRT-LE01B.              
           DISPLAY 'NO OF NRIC  WRITTEN ON LE01C   ' WS-WRT-LE01C.              
           DISPLAY 'NO OF NRIC  WRITTEN ON LE01D   ' WS-WRT-LE01D.              
                                                                                
           CLOSE BP13F800                                                       
                 BP13K730                                                       
                 BP13K820                                                       
                 BP13KB20                                                       
                 P04K010                                                        
                 BR10K010                                                       
                 BR10K080                                                       
                 BP27K800                                                       
                 BP27K870                                                       
                 BP27K820                                                       
                 BP13K800                                                       
                 P13LE01A                                                       
                 P13LE01B                                                       
                 P13LE01C                                                       
                 P13LE01D.                                                      
                                                                                
           IF  WS-BP13K820-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BP13K820-STATUS ' WS-BP13K820-STATUS.                
                                                                                
           IF  WS-BP13KB20-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BP13KB20-STATUS ' WS-BP13KB20-STATUS.                
                                                                                
           IF  WS-BP13K730-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BP13K730-STATUS ' WS-BP13K730-STATUS.                
                                                                                
           IF  WS-P04K010-STATUS NOT = ZEROS AND 97                             
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-P04K010-STATUS ' WS-P04K010-STATUS.                  
                                                                                
           IF  WS-BR10K010-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BR10K010-STATUS ' WS-BR10K010-STATUS.                
                                                                                
           IF  WS-BR10K080-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BR10K080-STATUS ' WS-BR10K080-STATUS.                
                                                                                
           IF  WS-BP27K800-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BP27K800-STATUS ' WS-BP27K800-STATUS.                
                                                                                
           IF  WS-BP27K820-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BP27K820-STATUS ' WS-BP27K820-STATUS.                
                                                                                
           IF  WS-BP27K870-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BP27K870-STATUS ' WS-BP27K870-STATUS.                
                                                                                
           IF  WS-BP13K800-STATUS NOT = ZEROS AND 97                            
               DISPLAY 'CLOSING ERROR '                                         
               DISPLAY 'WS-BP13K800-STATUS ' WS-BP13K800-STATUS.                
                                                                                
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
